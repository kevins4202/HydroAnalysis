index,text
3795,karst plant habitats are generally harsh and vulnerable to climate and human interferences restoration of karst vegetation and its effect on water resources are affected not only by climate and anthropological interferences but also by different bedrock lithologies in this study changes to climatic factors vegetation indices of the normalized difference vegetation index ndvi the leaf area index lai and runoff during 1982 2015 were statistically identified over the yangchang river basin yrb with two contrasting bedrock lithologies carbonate rock and detrital rock in southwest china the budyko equation and the hydrological model in lpj the lund potsdam jena dynamic global vegetation model were calibrated and improved to separate runoff change that could be attributed to climate and vegetation changes during 1982 2015 lpj was used to predict the potential vegetation for natural recovery without human interference and its effect on the hydrological budget in yrb results reveal that the execution of the major ecological restoration project the grain for green project in yrb since the early 2000 s has significantly increased ndvi and lai even in the drier period of 2004 2015 however the human effort of vegetation restoration only reaches about 25 of the potential capacity in the whole study area the reforestation in yrb could decrease runoff by about 7 0 to 7 6 in the period from 2004 to 2015 and 11 2 in the future when vegetation shifts from artificial to natural vegetation recovery meanwhile thick soil in the non carbonate area can store more water to support a large proportion of forest and raise drought resistance however the limited water holding capacity of weathered bedrock in the carbonate area restricts large tree growth and thus reduces drought resistance these results point a need for consideration of how bedrock geology influences available water limitations when designing suitable reforestation strategies in southwest china keywords vegetation recovery karst hydrological model budyko hypothesis climate change 1 introduction karst landscapes cover about 15 of the world s land area or about 22 million km2 yuan and chai 1988 one of the largest continuous karst areas in the world is located at yunnan guizhou plateau of southwest china with a population of 100 million people carbonate rocks occupy 41 31 of the total area 730 6 103 km2 karst plant habitats are extremely harsh and vulnerable to climate and human interferences extensive deforestation and agricultural development since the beginning of china s economic reforms in 1978 once led to rock desertification whereby a large karst area formerly covered by soil and vegetation was transformed into a rocky landscape or lithologic desert almost devoid of soil and vegetation yuan 1997 the rock desertification resulted in serious soil erosion and loss of water by increased surface runoff since the government run grain for green project ggp in 1999 intended to halt soil erosion and desertification vegetation recovery has been detected using remote sensing satellite imagery across a large region of southwestern china tong et al 2017 however it is reported that the degree of vegetation recovery varies across the region with some areas still exhibiting vegetation degradation even though human interference has been reduced or completely ceased tong et al 2017 differences of the vegetation cover changes may possibly be related to the degree of bedrock weathering human interference and or climate change until now there has been a lack of systematic evaluation of vegetation and associated hydrological changes attributed to human interference and climate change in an area with different bedrocks carbonate and non carbonate recent studies have suggested that plant use of moisture from weathered bedrock could fundamentally impact the hydrologic cycle dictate plant community distribution and regulate plant sensitivity to drought dawson et al 2020 in carbonate rock regions the bedrock compositions strongly influence regolith properties that in turn might play the primary role in plant growth and hydrological processes liu et al 2019 cai et al 2014 buss et al 2017 jiang et al 2020 because the uppermost soil layer is usually thin e g 30 50 cm and the exposed rocks are distributed everywhere the epikarst zone the near surface weathered zone of the exposed carbonates plays a key role on maintaining vegetation growth such as allowing tree roots to penetrate into deep fractures liu et al 2019 and uptake deep water in the drought periods jiang et al 2020 wang et al 2008 cai et al 2014 rong et al 2011 meanwhile strong weathered bedrocks can inhibit vegetation growth because of the high regolith water loss rate due to rapid deep percolation after rainfall jiang et al 2020 as the forest becomes progressively replaced by thorn shrubland and dry grassland when degraded natural restoration of the degraded forests becomes difficult due to the rock covered habitat with less soil and the lack of a viable forest seed bank in such poor soil e g wang et al 2004 any sustained drought could postpone and even stop vegetation recovery in karst areas for instance extensive vegetation degradation happened in the severe drought period from august 2009 through march 2010 in southwest china wang et al 2010 therefore knowledge of historical change in vegetation and driving forces and potential natural vegetation across different regolith materials is imperative when implementing revegetation to mitigate land degradation and promote sustainable land management peng and li 2018 if natural restoration is successful how does it affect hydrological responses through wetter or drier climates the objective of this study is to quantify the impacts of climate change and reforestation on streamflow in the yangchang river basin yrb with two contrasting bedrock lithologies carbonate rock and detrital rock in southwest china historical changes in vegetation and rainfall streamflow response are identified using the mann kendall statistical test on the annual hydro meteorological time series and annual vegetation cover maps during 1982 2015 then the budyko hypothesis is applied to estimate changes in annual streamflow attributed to de reforestation and climate change in the entire basin a distributed hydrological model is calibrated and validated for estimating changes in streamflow under different combinations of climate and landscape during 1982 2015 comparison of the modeling results from the two models gives some uncertainty bounds for the estimations potential change of vegetation and hydrological response to climate change without human interference are predicted by the lund potsdam jena dynamic global vegetation model lpj smith 2001 with the parameterized distributed hydrological model differences of the modelled hydrological budgets between the history and potential vegetation dynamics give additional plant water consumptions in the future when vegetation recovers to the climax species 2 study area and data the study area of the yangchang river basin yrb is located at the upper and middle sancha river basin in the east of the yunnan guizhou plateau in china fig 1 a this basin has an area of 2696 km2 the climate is controlled by subtropical monsoon with mean annual precipitation of 1000 mm and mean annual temperature of 14 about 95 4 of rainfall occurs between may and december jiao et al 2013 according to the topography dem data with a spatial resolution of 30 m http www gscloud cn table 1 the basin elevation ranges from 1342 to 2887 m declining towards the outlet in the southeast fig 1a 2 1 geological features and soil properties the yrb is a typical karst landscape fig 1b the dominant lithology of rocks is formed in the permian and triassic strata in this study the entire basin is divided into the carbonate area and the non carbonate area the carbonate rocks mainly consist of highly dissolved limestone and dolomite 64 of the basin area the non carbonate rocks consist of solid rocks of sandstone conglomerate and shale and marl which occupy 36 of the basin area table 2 the soils in the yrb are mainly silty clay according to the food and agriculture organization fao soil dataset zobler 1986 table 1 the spatial distribution of soil thickness fig 1c is interpolated in terms of the terrain attributes of slope and elevation zhang et al 2011 1 d d min d max 0 7 1 slope slope max 0 25 0 3 1 elevation elevation max 0 25 where d is the soil thickness elevation and slope are the elevation and slope respectively derived from dem at grids of 30 m resolution the subscripts of max and min represent the maximum and minimum values for each variable soil depths of various lithologic areas have been assessed in various field surveys in the southwest karst region the carbonate area is mostly located on hillslopes with a slope greater than 50 spatially varying in a wide range from 0 198 cm with a mean depth of about 52 cm zhou and luo 2017 yang et al 2014 zhang et al 2020 the non carbonate area is more commonly located at low elevations fig 1a and b and has a large proportion of cultivated land table 2 in depression and cultivated areas soils are thicker than 60 cm and the thickest is more than 2 m li et al 2004 chen and wang 2008 zhang et al 2020 hence the minimum and maximum soil depths are set to 0 and 198 cm respectively i e dmin 0 and dmax 198 cm in eq 1 for the carbonate area and 60 cm and 300 cm respectively i e dmin 60 cm and dmax 300 cm for the non carbonate area the dmin and dmax are used for interpolating the spatial distribution of soil thickness d with eq 1 the interpolated soil thickness d in the study area is shown in fig 1c and mean soil thickness in the two contrasting areas and the entire catchment is listed in table 2 because vegetation can uptake moisture from the underlying rock fractures in the area with thin soils the underlying epikarst thickness is set to 2 m in the carbonate area the root zone is classified into the soil and epikarst layers in the non carbonate area the root zone in thick soils is divided into the upper soil layer with a thickness of 0 5 m and the lower soil layer which extends to the total thickness in fig 2 b assumed to be the bedrock interface minus 0 5 m in the cropland area the root zone is divided into the rooted zone and the lower zone between actual rooting depth and the maximum rooting depth of mature crop which is set to 1 2 m in this study 2 2 vegetation coverage vegetation coverage is represented by the normalized difference vegetation index ndvi and the leaf area index lai ndvi data were obtained from the product of noaa global inventory monitoring and modeling system http nex nasa gov nex table 1 the temporal resolution of the product is bi monthly and the spatial resolution is 1 12 of a degree the leaf area index lai was obtained from the national earth system science data center and national science technology infrastructure of china http www geodata cn with a temporal resolution of 8 days and the spatial resolution is 0 05 according to 1 1000000 chinese vegetation atlas the vegetation species fig 1d are composed of forest temperature needle leaved evergreen tene 7 72 temperature broad leaved evergreen tebe 0 53 and temperature broad leaved summer green tebs 0 96 shrub 39 23 grass c3 32 21 and cultivated land for crops mainly potato and corn 19 35 in the whole yrb table 2 compared with the carbonate area 14 51 the non carbonate area 29 21 has a larger proportion of cultivated land table 2 as reported earlier 89 of coarse roots are concentrated in the top 20 cm the carbonate area nie et al 2014 so the fraction of roots in the upper soil and lower epikarst layers f 1 and f 2 in table 3 is set to 0 9 and 0 1 respectively for the woodland and shrub land because of short roots for grass the grass roots are assumed to be distributed in the soil layer i e f 1 1 in the non carbonate area f 1 and f 2 are set in terms of the suggested fraction of each plant functional type pft root sitch et al 2003 in the cropland crop roots are within the rooting zone i e f 1 1 2 3 climate and hydrological data climate data was obtained from the cru ts4 01 dataset including monthly precipitation mean temperature rainy day frequency cloud cover at 0 5 0 5 resolution during 1982 2015 daily precipitation temperature vapour pressure wind speed and sunshine duration at a finer resolution of 0 1 0 1 china was obtained from meteorological forcing dataset 1982 2015 additionally there were six rainfall stations in the yrb recording daily precipitation from 1982 to 2015 this data was used to correct precipitation at 0 1 0 1 resolution in terms of relationship of annual mean rainfall with altitude latitude and longitude in this study all raster data were interpolated into the finer resolution of 1 1 km used for the distributed model implementation atmospheric co2 concentration data were obtained from the ice core fusion data set of the scripps co2 program table 1 streamflow during 1982 2015 was recorded at the catchment outlet station the observed streamflow was converted to runoff for both annual and monthly time steps 3 methodology 3 1 1 trend and change point tests of annual series the rank based non parametric mann kendall test kendall 1975 mann 1945 was used to detect trends of hydrological and ndvi series at the significance level of 0 05 mann kendall abrupt change analysis is applied to detect change points in climatic and hydrological series according to the statistic sequence of forward ufk and backward ubk ufk for a given time series x 1 x 2 x n if the intersection of two curves ufk and ubk falls within the acceptance region of a significant level e g 0 05 there is a sudden change trend at the intersection time details refer to hamed and rao 1998 according to the detected mutation points the study period can be divided into a baseline period period 1 and a mutation period period 2 3 2 the budyko hypothesis the budyko hypothesis budyko 1974 assumes that the ratio of actual evapotranspiration to precipitation is a function of the aridity index the budyko based functions are used to explore hydrothermal coupled equilibrium in annual or multiyear scale one popularly used function is expressed as mezentsev 1955 yang et al 2008 2 e p e 0 p n e 0 n 1 n where e and e 0 are mean annual actual and potential evaporation respectively p is mean annual precipitation and n is the parameter representing the catchment landscape characteristics mainly related to soil topography and vegetation yang et al 2008 the long term catchment water balance equation is 3 r p e where r is mean annual runoff substituting eq 2 into eq 3 gives 4 r p p e 0 p n e 0 n 1 n if eq 4 is written as r p e0 n the total differential of r dr can be written as 5 dr f p d p f e 0 d e 0 f n d n or 6 dr r ε p dp p ε e 0 d e 0 e 0 ε n dn n where ε p dr r dp p defined as the precipitation elasticity of runoff ε e 0 dr r d e 0 e 0 defined as the potential evaporation elasticity of runoff ε n dr r dn n defined as the catchment property elasticity of runoff schaake 1990 ε p ε e 0 and ε n can be calculated in terms of eq 4 given p e0 and n 3 3 lpj model and water budget module 3 3 1 description of lpj model and improvement the lund potsdam jena dynamic global vegetation model lpj combines process based large scale representations of terrestrial vegetation dynamics and land atmosphere carbon and water exchanges in a modular framework smith 2001 the model is mostly implemented at 0 5 latitude and longitude resolution the original lpj described by sitch et al 2003 focused on modelling the growth and geographical distribution of natural plant functional types pfts and the associated biogeochemical processes by building on the improved representation of the water balance gerten et al 2004 a number of further specific model developments and applications have been published such as the lpjml model that represents crop functional types cfts and provides the foundation for explicitly simulating agricultural production in a changing climate and for quantifying the impacts of agricultural activities on the terrestrial carbon and water cycle bondeau et al 2007 as the model becomes increasingly complicated determination of the model parameters is difficult particularly for the strong heterogeneity of karst landscapes in this study we selected the well documented lpj model sitch et al 2003 to incorporate agricultural vegetation functions e g wofost world food studies van diepen et al 1989 similar with the crop functions in lpjml wofost is a mechanistic dynamic model that explains daily crop growth on the basis of the underlying processes such as photosynthesis respiration and how these processes are influenced by environmental conditions blanco et al 2017 in particular the model is implemented in a catchment scale with the finer resolution data 1 km 1 km of input and output and an appropriate set of hydrological and plant dynamic parameters in the karst area on the other hand the simulated results by lpj represent the potential vegetation and hydrological budget without any anthropogenic interferences the historical records of runoff and vegetation dynamics represent the states affected by climate change and anthropogenic interferences in order to identify effects of vegetation change on runoff with anthropogenic interferences during 1982 2015 lpj was modified by replacing the function of terrestrial vegetation dynamics with the remote sensing based vegetation indexes e g lai and fv the fraction of the grid cell covered by vegetation the hydrological model incorporating wofost can directly estimate effects of agricultural activities on runoff with the irrigation scheme e g gradual increase from 50 mm in 1980 s to 80 mm in 2000 s in this study lei et al 2016 the hydrological model with the remote sensing based natural vegetation index series and the simulated agricultural vegetation by wofost can estimate runoff response to change in vegetation coverage driven by climate and anthropologic interference 3 3 2 the water budget module in lpj the original lpj adopts a simple grid based hydrological model based on water balance in the root zone divided into two layers smith 2001 water content of both layers is updated daily taking account of snowmelt m precipitation p canopy interception e i transpiration e t and soil evaporation e t percolation through the layers p and runoff r 7 δ w 1 p m e i e t 1 e s p 1 r 1 8 δ w 2 p 1 e t 2 p 2 r 2 where δ w is the daily change of soil water content mm and the subscript 1 and 2 represent the variables in upper and lower layers respectively the percolation p i is 9 p i k w i 2 where k is the texture dependent conductivity mm d and w i is volumetric water content of the i layer which is equal to 10 w i w i fwhc i d i where w i is soil water content of the i layer mm fwhc i is the available volumetric water content of i layer d i is the soil thickness of the i layer the amount of water percolating through the second layer p2 is simply assumed to be deep groundwater flow within the model the sum of the three runoff components r1 r2 p2 is used as catchment total runoff there is no routing in the stream network as the effects of river routing time delays on streamflow can be neglected for model output on annual and monthly time steps the water balance terms evapotranspiration runoff storage change as a function of geography can explain the hydrological differences in different geographic regions lohmann et al 2004 daily interception loss ei is then given by 11 e i e q α w e t where α is priestley taylor coefficient with values that may vary from 1 26 for well watered land to 1 4 for dry land wet represents the fraction of day time that the canopy is wet defined as follows kergoat 1998 12 wet m i n s i e q α 1 where si is canopy storage capacity and e q is daily equilibrium evapotranspiration rate given by 13 e q δ δ γ r n l where r n j m 2d 1 refers to net radiation calculated from latitude day of the year sunshine hours and air temperature δ is the rate of saturation vapor pressure increase with temperature γ pa k 1 and l j kg 1 are the psychrometer constant of air 65 pa k 1 and the latent heat of water 2 5 10 6 j k g 1 vaporization adjusted by daily temperature respectively canopy storage capacity si is defined as a function of biome leaf area index lai and precipitation amount p mm d following the approach of kergoat 1998 14 s i m i n p p l a i i f v where fv denotes the fraction of the grid cell covered by vegetation taking account of daily phenology which is estimated from ndvi gutman and ignatov 1998 the factor i is the coefficient for calculation of interception transpiration e t is modeled as the lesser of an atmosphere controlled demand function d and a plant controlled supply function s as proposed by 15 e t m i n s d f v the maximum daily transpiration rate e max mm is used to simulate the water supply function s mm through the following expression 16 s e max w r where wr dimensionless is relative soil moisture affected by the fraction of roots in two soil layers given by 17 wr w 1 f 1 w 2 f 2 where f 1 and f 2 are the fraction of vegetation roots in the upper and lower layer respectively daily demand d is a hyperbolic function of canopy conductance 18 d 1 w e t e q α m 1 g m g p where α m is the maximum priestley taylor coefficient 1 391 g m is a scaling conductance 3 26 m m s g p is the potential canopy conductance that can be achieved when there is no water limitation g p is directly related to the photosynthesis rate as follows 19 g p 1 6 a dt c a 1 λ g m i n where g m i n is a pft specific minimum canopy conductance that accounts for plant water loss not directly linked to photosynthesis which is a parameter that can be directly obtained and is only related to the vegetation function type gerten et al 2004 a dt is the day time net photosynthesis g c d 1 m 2 gerten et al 2004 c a is the ambient mole fraction of co2 the data comes from ice core fusion data set of the scripps co2 program as shown in fig 3 λ constant 0 8 is the stomata controlled ratio of intercellular to ambient co2 concentration in the absence of water limitation wofost runs were based on selecting the production level and input data sets on crop soil weather crop calendar hydrological field conditions soil fertility parameters and the output options physical soil characteristics of soil moisture content of saturated soil at field capacity and wilting point and hydraulic conductivity are used in the calculation of the daily water balance of the soil needed to simulate water limited growth and to determine the optimal sowing date the calculations on the water fluxes in two soil compartments for wofost are similar with eqs 7 and 8 the simulated results of wofost give the water fluxes in wofost including transpiration evaporation from soil surface water percolated to deep soil not available for plant growth and surface runoff as well as the growth and production of annual field crops during simulation period 3 3 3 model parameter determination because of different hydrological functions in the carbonate and non carbonate areas as shown in fig 2 the model parameters are set or calibrated separately in the two geological units and cropland table 4 the hydraulic conductivity k of the epikarst is greater than 1 10 3m s 86400 mm d zhang et al 2011b which is 1 to 2 orders of magnitude greater than that of the soil layer the available volumetric water content fwhc in the soil layer ranges 0 113 0 191 according to the soil texture silty clay schaphoff et al 2018 sitch et al 2003 the fracture porosity in the epikarst layer ranges from 0 9 7 6 based on the field surveys in the karst area zhang et al 2011a and 0 48 3 2 according to 6 limestone samples weighted in the fully saturated and driest states used as the fwhc in the epikarst layer the estimated storage capacity fwhc multiplying the thickness ranges 5 6 64 mm this range covers the moisture storage capacity of about 40 mm from field investigations and water balance estimations fu et al 2016a b much less than the soil moisture storage capacity of 80 120 mm in the non karst areas under a similar climate brocca et al 2012 jayawardena and zhou 2000 xiang et al 2017 additionally the priestley taylor coefficient α ranges 1 26 1 4 tang and bartlein 2012 given the ranges of the parameter values for k fwhc and α in the carbonate and non carbonate areas the final values of these parameters table 4 are calibrated by the trial and error method targeting on that the simulated streamflow best matches with the observed streamflow in the first 24 years 1982 2005 the model performance is validated against the observations in the recent 10 years 2006 2015 the performance of the calibration and validation was evaluated by graphic comparison and some statistical indices nash sutcliff efficiency nse the coefficient of determination r2 and the relative error er additionally the production of field crops from wofost simulation was validated against the yield of crops from the statistical yearbooks 3 4 separation of runoff change attributed to climate and land use cover given a catchment change in mean annual runoff between two independent periods e g periods 1 and 2 according to the detected mutation points is 20 δ r r 2 r 1 where δ r is change in mean annual runoff r 1 and r 2 are mean annual observation runoff in the periods 1 and 2 respectively the change in mean annual runoff δ r can be separated by 21 δ r δ r cp δ r clim where δ r cp indicates the runoff change caused by change in catchment properties such as vegetation coverage between the two periods δ r clim is the streamflow change induced by climate change between the two periods δ r clim is composed of change by precipitation δ r p and potential evapotranspiration δ r e 0 in terms of the budyko derived eq 6 δ r p δ r e 0 and δ r cp are equal to ε p r p δ p ε e 0 r e 0 δ e 0 and ε n q n δ n respectively where δ p δ r e 0 and δ n represent changes in mean annual precipitation potential evaporation and vegetation cover between two periods in terms of the calibrated hydrological model in eqs 14 17 δ r cp can be estimated by the difference of the simulated runoff r in the two periods with different vegetation covers under a same climate force i e r clim1 n2 r clim1 n1 where clim and veg refer to inputs of climate and vegetation cover from the sensing based vegetation indexes e g lai and fv and the subscript 1 and 2 refer to the period 1 and 2 respectively δ r clim is the difference of the simulated runoff r in the two periods with different climate forces under a same vegetation cover i e r clim2 n2 r clim1 n2 δ r clim can be further separated into δ r p and δ r e 0 according to the difference of the simulated δ r clim in the two periods under combinations of climate factors of p and e0 4 results 4 1 changes of annual precipitation potential evapotranspiration and runoff the annual series of precipitation p potential evapotranspiration e0 calculated using the priestley taylor formula eq 13 and runoff r during 1982 2015 are shown in fig 4 annual p shows significantly decreasing during 1982 2015 z 1 971 for the mk trend test p 0 05 with a rate of 5 2 mm a by contrast annual e0 significantly increases z 2 062 p 0 05 with a rate of 1 mm a as a result the annual r decreases insignificantly z 1 439 p greater than 0 05 with a rate of 3 56 mm a fig 4 based on the mk abrupt change test on annual series of p and r in the study basin the calculated statistical values ufk and ubk of annual p and r and their boundary lines with a confidence of 0 05 are shown in fig 5 the change points for both annual p and r series are detected in the years of 1991 and 2004 according to the intersections of two curves ufk and ubk falling within the boundary lines so the whole study period is divided into the three periods t1 1982 1991 and t2 1992 2003 and t3 2004 2015 the mean annual p e 0 r and runoff coefficient r c defined as r p in the three periods are provided in table 5 the mean p and r values change in a same order in the three periods largest in the t2 period and smallest in the t3 period correspondingly the mean runoff coefficient r c is largest in the middle period i e 0 51 in the t2 period it means more runoff generation for unit precipitation in the t2 period than in the t1 and t3 periods in contrast the mean e0 and the dryness index e0 p show a consecutive increase in three periods particularly climate was driest in the recent period t3 when p reduced to be smallest and e 0 increased to be largest the mean p e 0 and q in the two contrasting areas carbonate vs non carbonate changes similarly in the three periods the mean p is a little larger in the carbonate area than in the non carbonate area in the three periods table 5 4 2 change of vegetation coverage the annual lai and ndvi increase during 1982 2015 tested to be significant for lai z 4 906 p 0 05 and insignificant for ndvi z 1 264 p greater than 0 05 fig 6 the mean lai is 1 27 1 33 and 1 55 in the t1 t2 and t3 periods respectively table 5 thus a rapid increase can be found in the recent period interestingly ndvi and lai in the carbonate area are higher than those in the non carbonate area as shown in table 5 the mean value of lai in the carbonate area is 1 31 1 38 and 1 59 in the t1 t2 and t3 periods larger than the respective values of 1 20 1 22 and 1 47 in the non carbonate area a reasonable explanation is that a large portion of the area in the non carbonated area has been extensively disturbed by human activities such as a high proportion of crops about 29 21 in table 2 and a low proportion of forest the inconsistence of decreased ndvi and increased lai from t1 to t2 periods in table 5 is attributed to increased cropland and improved agricultural productivity according to land use data from the resource and environment science and data center during the middle of 1990 s 2000 the cultivated land area increased about 21 km2 0 78 of the entire area while woodland and grassland areas decreased about 6 km2 0 22 of the entire area and 15 km2 0 56 of the entire area respectively as woodland and grassland with high ndvi 0 514 and 0 496 respectively shifted to cultivated land with low ndvi 0 495 ndvi reduced in the whole area meanwhile there have been major yield increases particularly for corn and potato according to statistical data from guizhou province of southwest china the corn yield increased from 2985 kg hm2 in the 1980 s to 4899 kg hm2 in the 2000 s and potato yield increased from 1917 kg hm2 in the 1980 s to 2499 kg hm2 in the 2000 s wang and ma 2015 the increase of crop yield mostly attributed to improved agronomic practice leads to dense vegetation and thus an increase of lai despite a of ndvi kang et al 2016 also reported inconsistency in the lai ndvi relationship in agricultural settings due to different leaf area development patterns in different years since the early 2000 s when the grain for green project ggp started cultivated land has decreased and agricultural productivity has remained stable or increased jiang et al 2021 which leads to consecutive increases of lai and ndvi 4 3 the estimated runoff change attributed to climate change and land use cover 4 3 1 the budyko approach given mean annual p and e0 in the entire period 1982 2015 the parameter n in the budyko equation is calibrated in terms of the multiyear mean r estimated from eq 11 equal to the observed r in the three periods of t1 t2 and t3 respectively the calibrated n value in table 6 is lowest in the t2 period suggesting higher runoff produced in the t2 period than in the t1 and t3 periods under a same climate forcing the runoff change caused by precipitation potential evaporation and catchment property is calculated in terms of δ r p ε p r p δ p δ r e 0 ε e 0 r e 0 δ e 0 and δ r n ε n r n δ n respectively table 6 and 7 here the mean of ε p ε e 0 and ε n can be calculated by the respective average in the two periods or recalibrated based on water balance calculation using the two period data e g the t1 t2 period 1982 2003 or the t2 t3 period 1992 2015 as shown in table 6 εp is 1 72 1 55 and 1 68 in the t1 t2 and t3 periods respectively which obtains an average of 1 63 and 1 61 in the periods of t1 t2 and t2 t3 respectively the recalibrated value using data in the periods of t1 t2 and t2 t3 is 1 62 and 1 61 respectively table 6 thus the average value in the two periods is nearly same as the recalibrated value from the t1 to t2 period mean annual p and e0 increased by 14 4 mm and 21 1 mm table 6 causing 11 2 mm increase and 8 1 mm decrease in runoff respectively table 7 as a result the climate induced increase in runoff δrclim was only 3 1 mm 4 6 of the total runoff increase much smaller than the landscape induced increase in runoff δrn 66 1 mm or 95 4 of the total runoff increase this increased amount was about 13 7 of runoff in the t1 period 1982 1991 thus runoff increase was mainly caused by a shift of forest and grass to crops from the early 1990 s to the early 2000 s from the period t2 to t3 climate tended to be drier indicated by a 133 3 mm decrease in mean annual precipitation and a slight increase of e0 2 mm as a result the climate induced decrease in runoff δrclim 102 8 mm or 76 6 of the total runoff reduction was mostly attributed to the precipitation induced decrease in runoff 102 3 mm by contrast the reforestation induced decrease in runoff δrn was 31 5 mm or 23 4 of the total runoff reduction this decreased amount was only about 7 6 of runoff in the t3 period 2004 2015 thus the decrease of runoff was mainly due to the drier climate since the early 2000 s 4 3 2 the hydrological modeling 1 the model calibration and validation the calibrated parameters of k fwhc and α were listed in table 4 the simulated annual runoff matches the observations fig 7 for the annual series nse is 0 8 the coefficient of determination r2 is 0 8 and the relative error er is 0 29 over the calibration period nse is 0 88 r2 is 0 89 and er is 1 74 over the validation period due to lack of monthly streamflow observation data before 2006 the monthly simulation results are validated only based on the observation data in the period of 2006 2015 the monthly nse is 0 68 r2 is 0 79 and er is 1 74 the yields simulated by wofost from 1982 to 2015 were 4143 kg hm2 and 2369 kg hm2 for corn and potato respectively which is close to the statistical yields of corn and potato in guizhou province 3932 kg hm2 and 2351 kg hm2 respectively wang and ma 2015 thus the modeling is acceptable for the scenario simulations 2 separating impact of vegetation and climate changes on runoff in the whole ybr the calibrated model can be used to simulate annual runoff under different combinations of climate and landscape in any two periods the alternative uses of climate and vegetation coverage in the two periods need a same length of data thus in this study the use of the hydrological model to separate landscape and climate induced changes in runoff is only carried out in the two periods t2 1992 2003 and t3 2004 2015 with a same length of 12 years the combinations of climate and vegetation changes in the two periods are set as climate and vegetation coverage in t2 s1 in table 8 climate in t2 and vegetation coverage in t3 s2 climate in t3 and vegetation coverage in t2 s3 and climate and vegetation coverage in t3 s4 therefore the simulated difference of runoff between s2 and s1 depicts the impact of land cover change on runoff and the simulated difference of runoff between s3 and s1 reveals the impact of climate change on runoff as shown in table 7 the climate and vegetation changes result in a 110 6 mm decrease of runoff this decrease of runoff is attributed to 26 3 vegetation induced decrease of runoff the contrast between s1 and s2 in table 8 and 73 7 climate induced decrease of runoff the contrast between s1 and s3 in table 8 this vegetation induced decrease of runoff was about 7 0 of runoff in the t3 period 2004 2015 the hydrological modeling results are close to the estimations by the budyko formula 76 6 and 23 4 for climate and vegetation induced decreases of runoff respectively in table 7 3 impact of vegetation and climate changes on runoff in the carbonate and the non carbonate areas the hydrological modelling results for runoff in the carbonate and the non carbonate areas in the two periods are given in table 8 the mean precipitation from the period t2 to t3 was the same for both carbonate and non carbonate areas however the decrease of runoff δ r in table 8 is different in the carbonate and the non carbonate areas the total runoff decreased by 113 8 mm in the carbonate area compared to 100 6 mm in the non carbonate area the runoff decrease is attributed to the drier climate δ r clim and vegetation recovery δ r cp δ r clim accounts for 91 9 and 60 8 mm while δ r cp is 23 6 and 39 8 mm in the carbonate and the non carbonate areas respectively thus the reforestation induced decrease δ r cp for the unit area in the carbonate area 23 6 mm or 20 4 of δ r is smaller than in the non carbonate area 39 8 mm or 39 5 of δ r because of a greater rate of annual lai increase e g 0 025 in the non carbonate area vs 0 021 in the carbonate area from the period t2 to t3 the ratio of reforestation induced decrease to the total decrease of runoff δ r cp δ r is much smaller than the ratio of the drier climate induced change δ r clim δ r in each geological unit table 8 so the climate drier from t2 to t3 takes a greater effect on runoff decrease comparatively the drier climate induced runoff decreases in the carbonate area 91 9 mm or 79 6 of δ r was greater than that in the non carbonate area 60 8 mm or 60 5 of δ r 4 4 the predicted change of potential vegetation and its effect on runoff the calibrated lpj model runs 1000 years to predict the potential vegetation dynamics in response to climate under equilibrium of various carbon pools in soils and terrestrial carbon cycle sitch et al 2003 as shown in table 9 in the entire basin the potential vegetation species are composed of tene 24 3 tebe 1 9 tebs 35 6 grass 15 5 and shrub 22 7 compared to the present vegetation distribution fig 1d the potential vegetation in fig 8 suggests that crop and a portion of shrub in the middle and east areas are replaced by forest of tebs and tene the carbonate area is occupied by 57 forest the total of 16 5 tene 0 1 tebe and 40 4 tebs 17 6 grass and 25 3 shrub by contrast the non carbonate area has 70 forest the total of 39 3 tene 4 7 tebe and 26 tebs 12 grass and 18 shrub thus the non carbonate area potentially has a larger percentage of forest and smaller percentages of grass and shrub the simulated potential lai in the period of 1982 2015 is shown in fig 9 mean potential lai is 5 57 which is 4 times higher than that in the present lai under strong human activities as expected the potential vegetation coverage decreases significantly as climate became drier during 1982 2015 in particular after the early 2000 s meanwhile the potential lai is higher in the non carbonate area than in the non carbonate area and the decrease rate of lai 0 0451 a in the non carbonate area smaller than 0 0493 a in the carbonate area in response to drier climate thus the vegetation in the non carbonate area has higher resilience on drier climate than that in the carbonate area according to the predicted evapotranspiration epot and runoff rpot under potential vegetation state as summarized in table 10 the higher forest cover in the non carbonate area consumes more water i e higher epot and thus results in less runoff rpot in the three periods in the entire basin the additional consumption epot epre is 49 mm which leads to 54 mm decrease of runoff about 11 2 of the present available runoff especially in the drier period of t3 runoff would decrease by 57 mm 13 6 of the present available runoff the increased evapotranspiration loss and thus decreased runoff 65 and 69 mm for e and r respectively in the non carbonate area are much greater than the respective values in the carbonate area 32 and 46 mm for e and r respectively 5 discussion 5 1 change of vegetation under artificial and natural forces vegetation coverage in the southwest karst region of china generally increased after the early 2000 s mostly attributed to artificial reforestation even though annual precipitation decreased tong et al 2018 however the artificial reforestation is not effective in some of areas under climate warming and drying because of the rock covered habitat with less soil cover and low water holding capacity in the parts of central sichuan central chongqing and central and eastern yunnan ndvi still represents a downward trend during 1998 2012 liu et al 2018 gao et al 2019 it was reported that after the implementation of ecological restoration projects the annual ndvi improved and the change rates are negatively related to the proportion of karst landscapes lian et al 2020 this study shows that annual lai has increased at a higher rate in the non carbonate area than in the carbonate area 0 025 vs 0 021 from t2 1992 2003 to t3 2004 2015 table 5 however the vegetation coverage in the non carbonate area still did not reach that in the carbonate area because of strong human activities in the non carbonated area such as a high proportion of crops and a low proportion of forest at present drought could strongly affect vegetation coverage in the non carbonated area where crop and grass are more sensitive to drought compared to forest in the southwest karst region wang et al 2010 however the future vegetation recovery without anthropogenic interferences could make the non carbonated area more resilient to drought since the thick soils in the area have capacity to store more precipitation and thus support a larger percentage of forest by contrast the weathered carbonate bedrock has limited water holding capacity in the root zone which restricts large tree growth jiang et al 2020 thus plants in the carbonated area could be very sensitive to drought as demonstrated by the dramatic decline of the simulated potential lai during 1999 2005 when annual precipitation decreases and temperature rises particularly in the most severe drought years from september 2009 until march 2010 fig 9 if anthropogenic interferences cease the non carbonated area has higher capacity to naturally restore the degraded forests e g over 70 than the carbonated area according to the predicted plant species and lai in the two areas this contrast of the present and potential lai in response to climate indicates that human induced vegetation change has reduced the land cover resilience to climate change 5 2 effects of vegetation recovery on water budget as expected vegetation recovery consumes more water for evapotranspiration and thus decreases runoff which has been reported in the karst and non karst areas for example in the non karst basin of the meijiang 6983 20 km2 situated in the upper reach of the poyang river basin of jiangxi province in southeast china the average annual runoff decreased about 17 12 mm accounting for 49 3 of annual runoff decrease caused by forest coverage increase from 40 in 1985 to 71 in 2006 using the sensitivity based approach liu et al 2015 for the karst basin of longjiang 16 878 km2 in guizhou and guangxi provinces of southwest china runoff during 2003 2015 decreased by 19 6 compared with that during 1991 2002 about 51 4 of this runoff decrease was attributed to the mean annual ndvi increase from 0 669 during 1991 2002 to 0 699 during 2003 2015 lian et al 2020 this study demonstrates that in the whole basin of yrb shifts of forest and grass to crops from 1980 s to 1990 s in the wetting periods could significantly increase runoff e g 13 7 of runoff in the period of 1982 1991 since 2000 however significant vegetation restoration has reduced runoff as the climate was drier after 2000 runoff decrease induced by vegetation restoration is only about 23 4 26 3 of the total runoff decrease or 7 0 7 6 of runoff in the period of 2004 2015 the present vegetation coverage in the carbonate area consumes more water due to greater forest cover and larger area compared to the non carbonate area in future as the mean potential lai could increase by up to 4 times the present state fig 6 and fig 9 it results in an 11 7 decrease of runoff for the whole area 5 3 uncertainties of the simulated results there are uncertainties of the separated amount of runoff change attributed to landscape and climate change due to data errors different methods and co dependence of climate and vegetation this study shows that runoff decrease attributed to vegetation recovery from the hydrological model is smaller than that from the budyko equation in the study basin the budyko equation is based on multi year water and energy balance analysis which does not account for annual scale change in moisture and vegetation dynamics by contrast the hydrological method runs on a daily timescale which accounts for effects of moisture regulations and vegetation dynamics on runoff the differences using the two methods are also found in other studies using the elastic coefficient method and hydrological models xu et al 2013 assessed the contributions of climate variability to runoff change are 47 2 and 45 1 respectively in the luan river basin of inner mongolia and hebei province in china during 1956 2005 zhang et al 2016 obtained the contributions of climate change to runoff change are 41 1 and 34 8 respectively in beiluo river basin of shanxi province in china during 1960 2010 6 conclusion in the southwest karst region vegetation coverage has changed from decrease due to strong interferences of human activities to artificial and natural recovery after controls have been implemented human activities changed the effects of regolith properties on vegetation coverage and runoff such as high lai and ndvi and more water uptake in the carbonated area compared to the non carbonated area the artificial recovery measures have altered the vegetation dynamics in response to climate such as increased vegetation coverage in the drier climate condition however under both present changes and the predicted potential change in future the non carbonated area has a greater capacity to maintain higher vegetation coverage and more forest e g over 70 than the carbonated area the future vegetation recovery could make the non carbonated area more resilient to drought since the thick soils in the area have capacity to store more water and support a larger percentage of forest in future the mean potential lai could increase by 4 times higher than that in the present state leading to a predicted 11 2 decrease of runoff larger than 7 0 7 6 decrease of runoff in the present reforestation period of 2004 2015 these findings are beneficial for designing reforestation strategies that take into account geological and available water limitations in southwest china credit authorship contribution statement lianbin cai data curation investigation methodology visualization writing original draft xi chen conceptualization formal analysis funding acquisition writing review editing richao huang data curation project administration validation keith smettem supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the national natural scientific foundation of china 42030506 we thank the two anonymous reviewers and the editor for their constructive comments which significantly improved the manuscript 
3795,karst plant habitats are generally harsh and vulnerable to climate and human interferences restoration of karst vegetation and its effect on water resources are affected not only by climate and anthropological interferences but also by different bedrock lithologies in this study changes to climatic factors vegetation indices of the normalized difference vegetation index ndvi the leaf area index lai and runoff during 1982 2015 were statistically identified over the yangchang river basin yrb with two contrasting bedrock lithologies carbonate rock and detrital rock in southwest china the budyko equation and the hydrological model in lpj the lund potsdam jena dynamic global vegetation model were calibrated and improved to separate runoff change that could be attributed to climate and vegetation changes during 1982 2015 lpj was used to predict the potential vegetation for natural recovery without human interference and its effect on the hydrological budget in yrb results reveal that the execution of the major ecological restoration project the grain for green project in yrb since the early 2000 s has significantly increased ndvi and lai even in the drier period of 2004 2015 however the human effort of vegetation restoration only reaches about 25 of the potential capacity in the whole study area the reforestation in yrb could decrease runoff by about 7 0 to 7 6 in the period from 2004 to 2015 and 11 2 in the future when vegetation shifts from artificial to natural vegetation recovery meanwhile thick soil in the non carbonate area can store more water to support a large proportion of forest and raise drought resistance however the limited water holding capacity of weathered bedrock in the carbonate area restricts large tree growth and thus reduces drought resistance these results point a need for consideration of how bedrock geology influences available water limitations when designing suitable reforestation strategies in southwest china keywords vegetation recovery karst hydrological model budyko hypothesis climate change 1 introduction karst landscapes cover about 15 of the world s land area or about 22 million km2 yuan and chai 1988 one of the largest continuous karst areas in the world is located at yunnan guizhou plateau of southwest china with a population of 100 million people carbonate rocks occupy 41 31 of the total area 730 6 103 km2 karst plant habitats are extremely harsh and vulnerable to climate and human interferences extensive deforestation and agricultural development since the beginning of china s economic reforms in 1978 once led to rock desertification whereby a large karst area formerly covered by soil and vegetation was transformed into a rocky landscape or lithologic desert almost devoid of soil and vegetation yuan 1997 the rock desertification resulted in serious soil erosion and loss of water by increased surface runoff since the government run grain for green project ggp in 1999 intended to halt soil erosion and desertification vegetation recovery has been detected using remote sensing satellite imagery across a large region of southwestern china tong et al 2017 however it is reported that the degree of vegetation recovery varies across the region with some areas still exhibiting vegetation degradation even though human interference has been reduced or completely ceased tong et al 2017 differences of the vegetation cover changes may possibly be related to the degree of bedrock weathering human interference and or climate change until now there has been a lack of systematic evaluation of vegetation and associated hydrological changes attributed to human interference and climate change in an area with different bedrocks carbonate and non carbonate recent studies have suggested that plant use of moisture from weathered bedrock could fundamentally impact the hydrologic cycle dictate plant community distribution and regulate plant sensitivity to drought dawson et al 2020 in carbonate rock regions the bedrock compositions strongly influence regolith properties that in turn might play the primary role in plant growth and hydrological processes liu et al 2019 cai et al 2014 buss et al 2017 jiang et al 2020 because the uppermost soil layer is usually thin e g 30 50 cm and the exposed rocks are distributed everywhere the epikarst zone the near surface weathered zone of the exposed carbonates plays a key role on maintaining vegetation growth such as allowing tree roots to penetrate into deep fractures liu et al 2019 and uptake deep water in the drought periods jiang et al 2020 wang et al 2008 cai et al 2014 rong et al 2011 meanwhile strong weathered bedrocks can inhibit vegetation growth because of the high regolith water loss rate due to rapid deep percolation after rainfall jiang et al 2020 as the forest becomes progressively replaced by thorn shrubland and dry grassland when degraded natural restoration of the degraded forests becomes difficult due to the rock covered habitat with less soil and the lack of a viable forest seed bank in such poor soil e g wang et al 2004 any sustained drought could postpone and even stop vegetation recovery in karst areas for instance extensive vegetation degradation happened in the severe drought period from august 2009 through march 2010 in southwest china wang et al 2010 therefore knowledge of historical change in vegetation and driving forces and potential natural vegetation across different regolith materials is imperative when implementing revegetation to mitigate land degradation and promote sustainable land management peng and li 2018 if natural restoration is successful how does it affect hydrological responses through wetter or drier climates the objective of this study is to quantify the impacts of climate change and reforestation on streamflow in the yangchang river basin yrb with two contrasting bedrock lithologies carbonate rock and detrital rock in southwest china historical changes in vegetation and rainfall streamflow response are identified using the mann kendall statistical test on the annual hydro meteorological time series and annual vegetation cover maps during 1982 2015 then the budyko hypothesis is applied to estimate changes in annual streamflow attributed to de reforestation and climate change in the entire basin a distributed hydrological model is calibrated and validated for estimating changes in streamflow under different combinations of climate and landscape during 1982 2015 comparison of the modeling results from the two models gives some uncertainty bounds for the estimations potential change of vegetation and hydrological response to climate change without human interference are predicted by the lund potsdam jena dynamic global vegetation model lpj smith 2001 with the parameterized distributed hydrological model differences of the modelled hydrological budgets between the history and potential vegetation dynamics give additional plant water consumptions in the future when vegetation recovers to the climax species 2 study area and data the study area of the yangchang river basin yrb is located at the upper and middle sancha river basin in the east of the yunnan guizhou plateau in china fig 1 a this basin has an area of 2696 km2 the climate is controlled by subtropical monsoon with mean annual precipitation of 1000 mm and mean annual temperature of 14 about 95 4 of rainfall occurs between may and december jiao et al 2013 according to the topography dem data with a spatial resolution of 30 m http www gscloud cn table 1 the basin elevation ranges from 1342 to 2887 m declining towards the outlet in the southeast fig 1a 2 1 geological features and soil properties the yrb is a typical karst landscape fig 1b the dominant lithology of rocks is formed in the permian and triassic strata in this study the entire basin is divided into the carbonate area and the non carbonate area the carbonate rocks mainly consist of highly dissolved limestone and dolomite 64 of the basin area the non carbonate rocks consist of solid rocks of sandstone conglomerate and shale and marl which occupy 36 of the basin area table 2 the soils in the yrb are mainly silty clay according to the food and agriculture organization fao soil dataset zobler 1986 table 1 the spatial distribution of soil thickness fig 1c is interpolated in terms of the terrain attributes of slope and elevation zhang et al 2011 1 d d min d max 0 7 1 slope slope max 0 25 0 3 1 elevation elevation max 0 25 where d is the soil thickness elevation and slope are the elevation and slope respectively derived from dem at grids of 30 m resolution the subscripts of max and min represent the maximum and minimum values for each variable soil depths of various lithologic areas have been assessed in various field surveys in the southwest karst region the carbonate area is mostly located on hillslopes with a slope greater than 50 spatially varying in a wide range from 0 198 cm with a mean depth of about 52 cm zhou and luo 2017 yang et al 2014 zhang et al 2020 the non carbonate area is more commonly located at low elevations fig 1a and b and has a large proportion of cultivated land table 2 in depression and cultivated areas soils are thicker than 60 cm and the thickest is more than 2 m li et al 2004 chen and wang 2008 zhang et al 2020 hence the minimum and maximum soil depths are set to 0 and 198 cm respectively i e dmin 0 and dmax 198 cm in eq 1 for the carbonate area and 60 cm and 300 cm respectively i e dmin 60 cm and dmax 300 cm for the non carbonate area the dmin and dmax are used for interpolating the spatial distribution of soil thickness d with eq 1 the interpolated soil thickness d in the study area is shown in fig 1c and mean soil thickness in the two contrasting areas and the entire catchment is listed in table 2 because vegetation can uptake moisture from the underlying rock fractures in the area with thin soils the underlying epikarst thickness is set to 2 m in the carbonate area the root zone is classified into the soil and epikarst layers in the non carbonate area the root zone in thick soils is divided into the upper soil layer with a thickness of 0 5 m and the lower soil layer which extends to the total thickness in fig 2 b assumed to be the bedrock interface minus 0 5 m in the cropland area the root zone is divided into the rooted zone and the lower zone between actual rooting depth and the maximum rooting depth of mature crop which is set to 1 2 m in this study 2 2 vegetation coverage vegetation coverage is represented by the normalized difference vegetation index ndvi and the leaf area index lai ndvi data were obtained from the product of noaa global inventory monitoring and modeling system http nex nasa gov nex table 1 the temporal resolution of the product is bi monthly and the spatial resolution is 1 12 of a degree the leaf area index lai was obtained from the national earth system science data center and national science technology infrastructure of china http www geodata cn with a temporal resolution of 8 days and the spatial resolution is 0 05 according to 1 1000000 chinese vegetation atlas the vegetation species fig 1d are composed of forest temperature needle leaved evergreen tene 7 72 temperature broad leaved evergreen tebe 0 53 and temperature broad leaved summer green tebs 0 96 shrub 39 23 grass c3 32 21 and cultivated land for crops mainly potato and corn 19 35 in the whole yrb table 2 compared with the carbonate area 14 51 the non carbonate area 29 21 has a larger proportion of cultivated land table 2 as reported earlier 89 of coarse roots are concentrated in the top 20 cm the carbonate area nie et al 2014 so the fraction of roots in the upper soil and lower epikarst layers f 1 and f 2 in table 3 is set to 0 9 and 0 1 respectively for the woodland and shrub land because of short roots for grass the grass roots are assumed to be distributed in the soil layer i e f 1 1 in the non carbonate area f 1 and f 2 are set in terms of the suggested fraction of each plant functional type pft root sitch et al 2003 in the cropland crop roots are within the rooting zone i e f 1 1 2 3 climate and hydrological data climate data was obtained from the cru ts4 01 dataset including monthly precipitation mean temperature rainy day frequency cloud cover at 0 5 0 5 resolution during 1982 2015 daily precipitation temperature vapour pressure wind speed and sunshine duration at a finer resolution of 0 1 0 1 china was obtained from meteorological forcing dataset 1982 2015 additionally there were six rainfall stations in the yrb recording daily precipitation from 1982 to 2015 this data was used to correct precipitation at 0 1 0 1 resolution in terms of relationship of annual mean rainfall with altitude latitude and longitude in this study all raster data were interpolated into the finer resolution of 1 1 km used for the distributed model implementation atmospheric co2 concentration data were obtained from the ice core fusion data set of the scripps co2 program table 1 streamflow during 1982 2015 was recorded at the catchment outlet station the observed streamflow was converted to runoff for both annual and monthly time steps 3 methodology 3 1 1 trend and change point tests of annual series the rank based non parametric mann kendall test kendall 1975 mann 1945 was used to detect trends of hydrological and ndvi series at the significance level of 0 05 mann kendall abrupt change analysis is applied to detect change points in climatic and hydrological series according to the statistic sequence of forward ufk and backward ubk ufk for a given time series x 1 x 2 x n if the intersection of two curves ufk and ubk falls within the acceptance region of a significant level e g 0 05 there is a sudden change trend at the intersection time details refer to hamed and rao 1998 according to the detected mutation points the study period can be divided into a baseline period period 1 and a mutation period period 2 3 2 the budyko hypothesis the budyko hypothesis budyko 1974 assumes that the ratio of actual evapotranspiration to precipitation is a function of the aridity index the budyko based functions are used to explore hydrothermal coupled equilibrium in annual or multiyear scale one popularly used function is expressed as mezentsev 1955 yang et al 2008 2 e p e 0 p n e 0 n 1 n where e and e 0 are mean annual actual and potential evaporation respectively p is mean annual precipitation and n is the parameter representing the catchment landscape characteristics mainly related to soil topography and vegetation yang et al 2008 the long term catchment water balance equation is 3 r p e where r is mean annual runoff substituting eq 2 into eq 3 gives 4 r p p e 0 p n e 0 n 1 n if eq 4 is written as r p e0 n the total differential of r dr can be written as 5 dr f p d p f e 0 d e 0 f n d n or 6 dr r ε p dp p ε e 0 d e 0 e 0 ε n dn n where ε p dr r dp p defined as the precipitation elasticity of runoff ε e 0 dr r d e 0 e 0 defined as the potential evaporation elasticity of runoff ε n dr r dn n defined as the catchment property elasticity of runoff schaake 1990 ε p ε e 0 and ε n can be calculated in terms of eq 4 given p e0 and n 3 3 lpj model and water budget module 3 3 1 description of lpj model and improvement the lund potsdam jena dynamic global vegetation model lpj combines process based large scale representations of terrestrial vegetation dynamics and land atmosphere carbon and water exchanges in a modular framework smith 2001 the model is mostly implemented at 0 5 latitude and longitude resolution the original lpj described by sitch et al 2003 focused on modelling the growth and geographical distribution of natural plant functional types pfts and the associated biogeochemical processes by building on the improved representation of the water balance gerten et al 2004 a number of further specific model developments and applications have been published such as the lpjml model that represents crop functional types cfts and provides the foundation for explicitly simulating agricultural production in a changing climate and for quantifying the impacts of agricultural activities on the terrestrial carbon and water cycle bondeau et al 2007 as the model becomes increasingly complicated determination of the model parameters is difficult particularly for the strong heterogeneity of karst landscapes in this study we selected the well documented lpj model sitch et al 2003 to incorporate agricultural vegetation functions e g wofost world food studies van diepen et al 1989 similar with the crop functions in lpjml wofost is a mechanistic dynamic model that explains daily crop growth on the basis of the underlying processes such as photosynthesis respiration and how these processes are influenced by environmental conditions blanco et al 2017 in particular the model is implemented in a catchment scale with the finer resolution data 1 km 1 km of input and output and an appropriate set of hydrological and plant dynamic parameters in the karst area on the other hand the simulated results by lpj represent the potential vegetation and hydrological budget without any anthropogenic interferences the historical records of runoff and vegetation dynamics represent the states affected by climate change and anthropogenic interferences in order to identify effects of vegetation change on runoff with anthropogenic interferences during 1982 2015 lpj was modified by replacing the function of terrestrial vegetation dynamics with the remote sensing based vegetation indexes e g lai and fv the fraction of the grid cell covered by vegetation the hydrological model incorporating wofost can directly estimate effects of agricultural activities on runoff with the irrigation scheme e g gradual increase from 50 mm in 1980 s to 80 mm in 2000 s in this study lei et al 2016 the hydrological model with the remote sensing based natural vegetation index series and the simulated agricultural vegetation by wofost can estimate runoff response to change in vegetation coverage driven by climate and anthropologic interference 3 3 2 the water budget module in lpj the original lpj adopts a simple grid based hydrological model based on water balance in the root zone divided into two layers smith 2001 water content of both layers is updated daily taking account of snowmelt m precipitation p canopy interception e i transpiration e t and soil evaporation e t percolation through the layers p and runoff r 7 δ w 1 p m e i e t 1 e s p 1 r 1 8 δ w 2 p 1 e t 2 p 2 r 2 where δ w is the daily change of soil water content mm and the subscript 1 and 2 represent the variables in upper and lower layers respectively the percolation p i is 9 p i k w i 2 where k is the texture dependent conductivity mm d and w i is volumetric water content of the i layer which is equal to 10 w i w i fwhc i d i where w i is soil water content of the i layer mm fwhc i is the available volumetric water content of i layer d i is the soil thickness of the i layer the amount of water percolating through the second layer p2 is simply assumed to be deep groundwater flow within the model the sum of the three runoff components r1 r2 p2 is used as catchment total runoff there is no routing in the stream network as the effects of river routing time delays on streamflow can be neglected for model output on annual and monthly time steps the water balance terms evapotranspiration runoff storage change as a function of geography can explain the hydrological differences in different geographic regions lohmann et al 2004 daily interception loss ei is then given by 11 e i e q α w e t where α is priestley taylor coefficient with values that may vary from 1 26 for well watered land to 1 4 for dry land wet represents the fraction of day time that the canopy is wet defined as follows kergoat 1998 12 wet m i n s i e q α 1 where si is canopy storage capacity and e q is daily equilibrium evapotranspiration rate given by 13 e q δ δ γ r n l where r n j m 2d 1 refers to net radiation calculated from latitude day of the year sunshine hours and air temperature δ is the rate of saturation vapor pressure increase with temperature γ pa k 1 and l j kg 1 are the psychrometer constant of air 65 pa k 1 and the latent heat of water 2 5 10 6 j k g 1 vaporization adjusted by daily temperature respectively canopy storage capacity si is defined as a function of biome leaf area index lai and precipitation amount p mm d following the approach of kergoat 1998 14 s i m i n p p l a i i f v where fv denotes the fraction of the grid cell covered by vegetation taking account of daily phenology which is estimated from ndvi gutman and ignatov 1998 the factor i is the coefficient for calculation of interception transpiration e t is modeled as the lesser of an atmosphere controlled demand function d and a plant controlled supply function s as proposed by 15 e t m i n s d f v the maximum daily transpiration rate e max mm is used to simulate the water supply function s mm through the following expression 16 s e max w r where wr dimensionless is relative soil moisture affected by the fraction of roots in two soil layers given by 17 wr w 1 f 1 w 2 f 2 where f 1 and f 2 are the fraction of vegetation roots in the upper and lower layer respectively daily demand d is a hyperbolic function of canopy conductance 18 d 1 w e t e q α m 1 g m g p where α m is the maximum priestley taylor coefficient 1 391 g m is a scaling conductance 3 26 m m s g p is the potential canopy conductance that can be achieved when there is no water limitation g p is directly related to the photosynthesis rate as follows 19 g p 1 6 a dt c a 1 λ g m i n where g m i n is a pft specific minimum canopy conductance that accounts for plant water loss not directly linked to photosynthesis which is a parameter that can be directly obtained and is only related to the vegetation function type gerten et al 2004 a dt is the day time net photosynthesis g c d 1 m 2 gerten et al 2004 c a is the ambient mole fraction of co2 the data comes from ice core fusion data set of the scripps co2 program as shown in fig 3 λ constant 0 8 is the stomata controlled ratio of intercellular to ambient co2 concentration in the absence of water limitation wofost runs were based on selecting the production level and input data sets on crop soil weather crop calendar hydrological field conditions soil fertility parameters and the output options physical soil characteristics of soil moisture content of saturated soil at field capacity and wilting point and hydraulic conductivity are used in the calculation of the daily water balance of the soil needed to simulate water limited growth and to determine the optimal sowing date the calculations on the water fluxes in two soil compartments for wofost are similar with eqs 7 and 8 the simulated results of wofost give the water fluxes in wofost including transpiration evaporation from soil surface water percolated to deep soil not available for plant growth and surface runoff as well as the growth and production of annual field crops during simulation period 3 3 3 model parameter determination because of different hydrological functions in the carbonate and non carbonate areas as shown in fig 2 the model parameters are set or calibrated separately in the two geological units and cropland table 4 the hydraulic conductivity k of the epikarst is greater than 1 10 3m s 86400 mm d zhang et al 2011b which is 1 to 2 orders of magnitude greater than that of the soil layer the available volumetric water content fwhc in the soil layer ranges 0 113 0 191 according to the soil texture silty clay schaphoff et al 2018 sitch et al 2003 the fracture porosity in the epikarst layer ranges from 0 9 7 6 based on the field surveys in the karst area zhang et al 2011a and 0 48 3 2 according to 6 limestone samples weighted in the fully saturated and driest states used as the fwhc in the epikarst layer the estimated storage capacity fwhc multiplying the thickness ranges 5 6 64 mm this range covers the moisture storage capacity of about 40 mm from field investigations and water balance estimations fu et al 2016a b much less than the soil moisture storage capacity of 80 120 mm in the non karst areas under a similar climate brocca et al 2012 jayawardena and zhou 2000 xiang et al 2017 additionally the priestley taylor coefficient α ranges 1 26 1 4 tang and bartlein 2012 given the ranges of the parameter values for k fwhc and α in the carbonate and non carbonate areas the final values of these parameters table 4 are calibrated by the trial and error method targeting on that the simulated streamflow best matches with the observed streamflow in the first 24 years 1982 2005 the model performance is validated against the observations in the recent 10 years 2006 2015 the performance of the calibration and validation was evaluated by graphic comparison and some statistical indices nash sutcliff efficiency nse the coefficient of determination r2 and the relative error er additionally the production of field crops from wofost simulation was validated against the yield of crops from the statistical yearbooks 3 4 separation of runoff change attributed to climate and land use cover given a catchment change in mean annual runoff between two independent periods e g periods 1 and 2 according to the detected mutation points is 20 δ r r 2 r 1 where δ r is change in mean annual runoff r 1 and r 2 are mean annual observation runoff in the periods 1 and 2 respectively the change in mean annual runoff δ r can be separated by 21 δ r δ r cp δ r clim where δ r cp indicates the runoff change caused by change in catchment properties such as vegetation coverage between the two periods δ r clim is the streamflow change induced by climate change between the two periods δ r clim is composed of change by precipitation δ r p and potential evapotranspiration δ r e 0 in terms of the budyko derived eq 6 δ r p δ r e 0 and δ r cp are equal to ε p r p δ p ε e 0 r e 0 δ e 0 and ε n q n δ n respectively where δ p δ r e 0 and δ n represent changes in mean annual precipitation potential evaporation and vegetation cover between two periods in terms of the calibrated hydrological model in eqs 14 17 δ r cp can be estimated by the difference of the simulated runoff r in the two periods with different vegetation covers under a same climate force i e r clim1 n2 r clim1 n1 where clim and veg refer to inputs of climate and vegetation cover from the sensing based vegetation indexes e g lai and fv and the subscript 1 and 2 refer to the period 1 and 2 respectively δ r clim is the difference of the simulated runoff r in the two periods with different climate forces under a same vegetation cover i e r clim2 n2 r clim1 n2 δ r clim can be further separated into δ r p and δ r e 0 according to the difference of the simulated δ r clim in the two periods under combinations of climate factors of p and e0 4 results 4 1 changes of annual precipitation potential evapotranspiration and runoff the annual series of precipitation p potential evapotranspiration e0 calculated using the priestley taylor formula eq 13 and runoff r during 1982 2015 are shown in fig 4 annual p shows significantly decreasing during 1982 2015 z 1 971 for the mk trend test p 0 05 with a rate of 5 2 mm a by contrast annual e0 significantly increases z 2 062 p 0 05 with a rate of 1 mm a as a result the annual r decreases insignificantly z 1 439 p greater than 0 05 with a rate of 3 56 mm a fig 4 based on the mk abrupt change test on annual series of p and r in the study basin the calculated statistical values ufk and ubk of annual p and r and their boundary lines with a confidence of 0 05 are shown in fig 5 the change points for both annual p and r series are detected in the years of 1991 and 2004 according to the intersections of two curves ufk and ubk falling within the boundary lines so the whole study period is divided into the three periods t1 1982 1991 and t2 1992 2003 and t3 2004 2015 the mean annual p e 0 r and runoff coefficient r c defined as r p in the three periods are provided in table 5 the mean p and r values change in a same order in the three periods largest in the t2 period and smallest in the t3 period correspondingly the mean runoff coefficient r c is largest in the middle period i e 0 51 in the t2 period it means more runoff generation for unit precipitation in the t2 period than in the t1 and t3 periods in contrast the mean e0 and the dryness index e0 p show a consecutive increase in three periods particularly climate was driest in the recent period t3 when p reduced to be smallest and e 0 increased to be largest the mean p e 0 and q in the two contrasting areas carbonate vs non carbonate changes similarly in the three periods the mean p is a little larger in the carbonate area than in the non carbonate area in the three periods table 5 4 2 change of vegetation coverage the annual lai and ndvi increase during 1982 2015 tested to be significant for lai z 4 906 p 0 05 and insignificant for ndvi z 1 264 p greater than 0 05 fig 6 the mean lai is 1 27 1 33 and 1 55 in the t1 t2 and t3 periods respectively table 5 thus a rapid increase can be found in the recent period interestingly ndvi and lai in the carbonate area are higher than those in the non carbonate area as shown in table 5 the mean value of lai in the carbonate area is 1 31 1 38 and 1 59 in the t1 t2 and t3 periods larger than the respective values of 1 20 1 22 and 1 47 in the non carbonate area a reasonable explanation is that a large portion of the area in the non carbonated area has been extensively disturbed by human activities such as a high proportion of crops about 29 21 in table 2 and a low proportion of forest the inconsistence of decreased ndvi and increased lai from t1 to t2 periods in table 5 is attributed to increased cropland and improved agricultural productivity according to land use data from the resource and environment science and data center during the middle of 1990 s 2000 the cultivated land area increased about 21 km2 0 78 of the entire area while woodland and grassland areas decreased about 6 km2 0 22 of the entire area and 15 km2 0 56 of the entire area respectively as woodland and grassland with high ndvi 0 514 and 0 496 respectively shifted to cultivated land with low ndvi 0 495 ndvi reduced in the whole area meanwhile there have been major yield increases particularly for corn and potato according to statistical data from guizhou province of southwest china the corn yield increased from 2985 kg hm2 in the 1980 s to 4899 kg hm2 in the 2000 s and potato yield increased from 1917 kg hm2 in the 1980 s to 2499 kg hm2 in the 2000 s wang and ma 2015 the increase of crop yield mostly attributed to improved agronomic practice leads to dense vegetation and thus an increase of lai despite a of ndvi kang et al 2016 also reported inconsistency in the lai ndvi relationship in agricultural settings due to different leaf area development patterns in different years since the early 2000 s when the grain for green project ggp started cultivated land has decreased and agricultural productivity has remained stable or increased jiang et al 2021 which leads to consecutive increases of lai and ndvi 4 3 the estimated runoff change attributed to climate change and land use cover 4 3 1 the budyko approach given mean annual p and e0 in the entire period 1982 2015 the parameter n in the budyko equation is calibrated in terms of the multiyear mean r estimated from eq 11 equal to the observed r in the three periods of t1 t2 and t3 respectively the calibrated n value in table 6 is lowest in the t2 period suggesting higher runoff produced in the t2 period than in the t1 and t3 periods under a same climate forcing the runoff change caused by precipitation potential evaporation and catchment property is calculated in terms of δ r p ε p r p δ p δ r e 0 ε e 0 r e 0 δ e 0 and δ r n ε n r n δ n respectively table 6 and 7 here the mean of ε p ε e 0 and ε n can be calculated by the respective average in the two periods or recalibrated based on water balance calculation using the two period data e g the t1 t2 period 1982 2003 or the t2 t3 period 1992 2015 as shown in table 6 εp is 1 72 1 55 and 1 68 in the t1 t2 and t3 periods respectively which obtains an average of 1 63 and 1 61 in the periods of t1 t2 and t2 t3 respectively the recalibrated value using data in the periods of t1 t2 and t2 t3 is 1 62 and 1 61 respectively table 6 thus the average value in the two periods is nearly same as the recalibrated value from the t1 to t2 period mean annual p and e0 increased by 14 4 mm and 21 1 mm table 6 causing 11 2 mm increase and 8 1 mm decrease in runoff respectively table 7 as a result the climate induced increase in runoff δrclim was only 3 1 mm 4 6 of the total runoff increase much smaller than the landscape induced increase in runoff δrn 66 1 mm or 95 4 of the total runoff increase this increased amount was about 13 7 of runoff in the t1 period 1982 1991 thus runoff increase was mainly caused by a shift of forest and grass to crops from the early 1990 s to the early 2000 s from the period t2 to t3 climate tended to be drier indicated by a 133 3 mm decrease in mean annual precipitation and a slight increase of e0 2 mm as a result the climate induced decrease in runoff δrclim 102 8 mm or 76 6 of the total runoff reduction was mostly attributed to the precipitation induced decrease in runoff 102 3 mm by contrast the reforestation induced decrease in runoff δrn was 31 5 mm or 23 4 of the total runoff reduction this decreased amount was only about 7 6 of runoff in the t3 period 2004 2015 thus the decrease of runoff was mainly due to the drier climate since the early 2000 s 4 3 2 the hydrological modeling 1 the model calibration and validation the calibrated parameters of k fwhc and α were listed in table 4 the simulated annual runoff matches the observations fig 7 for the annual series nse is 0 8 the coefficient of determination r2 is 0 8 and the relative error er is 0 29 over the calibration period nse is 0 88 r2 is 0 89 and er is 1 74 over the validation period due to lack of monthly streamflow observation data before 2006 the monthly simulation results are validated only based on the observation data in the period of 2006 2015 the monthly nse is 0 68 r2 is 0 79 and er is 1 74 the yields simulated by wofost from 1982 to 2015 were 4143 kg hm2 and 2369 kg hm2 for corn and potato respectively which is close to the statistical yields of corn and potato in guizhou province 3932 kg hm2 and 2351 kg hm2 respectively wang and ma 2015 thus the modeling is acceptable for the scenario simulations 2 separating impact of vegetation and climate changes on runoff in the whole ybr the calibrated model can be used to simulate annual runoff under different combinations of climate and landscape in any two periods the alternative uses of climate and vegetation coverage in the two periods need a same length of data thus in this study the use of the hydrological model to separate landscape and climate induced changes in runoff is only carried out in the two periods t2 1992 2003 and t3 2004 2015 with a same length of 12 years the combinations of climate and vegetation changes in the two periods are set as climate and vegetation coverage in t2 s1 in table 8 climate in t2 and vegetation coverage in t3 s2 climate in t3 and vegetation coverage in t2 s3 and climate and vegetation coverage in t3 s4 therefore the simulated difference of runoff between s2 and s1 depicts the impact of land cover change on runoff and the simulated difference of runoff between s3 and s1 reveals the impact of climate change on runoff as shown in table 7 the climate and vegetation changes result in a 110 6 mm decrease of runoff this decrease of runoff is attributed to 26 3 vegetation induced decrease of runoff the contrast between s1 and s2 in table 8 and 73 7 climate induced decrease of runoff the contrast between s1 and s3 in table 8 this vegetation induced decrease of runoff was about 7 0 of runoff in the t3 period 2004 2015 the hydrological modeling results are close to the estimations by the budyko formula 76 6 and 23 4 for climate and vegetation induced decreases of runoff respectively in table 7 3 impact of vegetation and climate changes on runoff in the carbonate and the non carbonate areas the hydrological modelling results for runoff in the carbonate and the non carbonate areas in the two periods are given in table 8 the mean precipitation from the period t2 to t3 was the same for both carbonate and non carbonate areas however the decrease of runoff δ r in table 8 is different in the carbonate and the non carbonate areas the total runoff decreased by 113 8 mm in the carbonate area compared to 100 6 mm in the non carbonate area the runoff decrease is attributed to the drier climate δ r clim and vegetation recovery δ r cp δ r clim accounts for 91 9 and 60 8 mm while δ r cp is 23 6 and 39 8 mm in the carbonate and the non carbonate areas respectively thus the reforestation induced decrease δ r cp for the unit area in the carbonate area 23 6 mm or 20 4 of δ r is smaller than in the non carbonate area 39 8 mm or 39 5 of δ r because of a greater rate of annual lai increase e g 0 025 in the non carbonate area vs 0 021 in the carbonate area from the period t2 to t3 the ratio of reforestation induced decrease to the total decrease of runoff δ r cp δ r is much smaller than the ratio of the drier climate induced change δ r clim δ r in each geological unit table 8 so the climate drier from t2 to t3 takes a greater effect on runoff decrease comparatively the drier climate induced runoff decreases in the carbonate area 91 9 mm or 79 6 of δ r was greater than that in the non carbonate area 60 8 mm or 60 5 of δ r 4 4 the predicted change of potential vegetation and its effect on runoff the calibrated lpj model runs 1000 years to predict the potential vegetation dynamics in response to climate under equilibrium of various carbon pools in soils and terrestrial carbon cycle sitch et al 2003 as shown in table 9 in the entire basin the potential vegetation species are composed of tene 24 3 tebe 1 9 tebs 35 6 grass 15 5 and shrub 22 7 compared to the present vegetation distribution fig 1d the potential vegetation in fig 8 suggests that crop and a portion of shrub in the middle and east areas are replaced by forest of tebs and tene the carbonate area is occupied by 57 forest the total of 16 5 tene 0 1 tebe and 40 4 tebs 17 6 grass and 25 3 shrub by contrast the non carbonate area has 70 forest the total of 39 3 tene 4 7 tebe and 26 tebs 12 grass and 18 shrub thus the non carbonate area potentially has a larger percentage of forest and smaller percentages of grass and shrub the simulated potential lai in the period of 1982 2015 is shown in fig 9 mean potential lai is 5 57 which is 4 times higher than that in the present lai under strong human activities as expected the potential vegetation coverage decreases significantly as climate became drier during 1982 2015 in particular after the early 2000 s meanwhile the potential lai is higher in the non carbonate area than in the non carbonate area and the decrease rate of lai 0 0451 a in the non carbonate area smaller than 0 0493 a in the carbonate area in response to drier climate thus the vegetation in the non carbonate area has higher resilience on drier climate than that in the carbonate area according to the predicted evapotranspiration epot and runoff rpot under potential vegetation state as summarized in table 10 the higher forest cover in the non carbonate area consumes more water i e higher epot and thus results in less runoff rpot in the three periods in the entire basin the additional consumption epot epre is 49 mm which leads to 54 mm decrease of runoff about 11 2 of the present available runoff especially in the drier period of t3 runoff would decrease by 57 mm 13 6 of the present available runoff the increased evapotranspiration loss and thus decreased runoff 65 and 69 mm for e and r respectively in the non carbonate area are much greater than the respective values in the carbonate area 32 and 46 mm for e and r respectively 5 discussion 5 1 change of vegetation under artificial and natural forces vegetation coverage in the southwest karst region of china generally increased after the early 2000 s mostly attributed to artificial reforestation even though annual precipitation decreased tong et al 2018 however the artificial reforestation is not effective in some of areas under climate warming and drying because of the rock covered habitat with less soil cover and low water holding capacity in the parts of central sichuan central chongqing and central and eastern yunnan ndvi still represents a downward trend during 1998 2012 liu et al 2018 gao et al 2019 it was reported that after the implementation of ecological restoration projects the annual ndvi improved and the change rates are negatively related to the proportion of karst landscapes lian et al 2020 this study shows that annual lai has increased at a higher rate in the non carbonate area than in the carbonate area 0 025 vs 0 021 from t2 1992 2003 to t3 2004 2015 table 5 however the vegetation coverage in the non carbonate area still did not reach that in the carbonate area because of strong human activities in the non carbonated area such as a high proportion of crops and a low proportion of forest at present drought could strongly affect vegetation coverage in the non carbonated area where crop and grass are more sensitive to drought compared to forest in the southwest karst region wang et al 2010 however the future vegetation recovery without anthropogenic interferences could make the non carbonated area more resilient to drought since the thick soils in the area have capacity to store more precipitation and thus support a larger percentage of forest by contrast the weathered carbonate bedrock has limited water holding capacity in the root zone which restricts large tree growth jiang et al 2020 thus plants in the carbonated area could be very sensitive to drought as demonstrated by the dramatic decline of the simulated potential lai during 1999 2005 when annual precipitation decreases and temperature rises particularly in the most severe drought years from september 2009 until march 2010 fig 9 if anthropogenic interferences cease the non carbonated area has higher capacity to naturally restore the degraded forests e g over 70 than the carbonated area according to the predicted plant species and lai in the two areas this contrast of the present and potential lai in response to climate indicates that human induced vegetation change has reduced the land cover resilience to climate change 5 2 effects of vegetation recovery on water budget as expected vegetation recovery consumes more water for evapotranspiration and thus decreases runoff which has been reported in the karst and non karst areas for example in the non karst basin of the meijiang 6983 20 km2 situated in the upper reach of the poyang river basin of jiangxi province in southeast china the average annual runoff decreased about 17 12 mm accounting for 49 3 of annual runoff decrease caused by forest coverage increase from 40 in 1985 to 71 in 2006 using the sensitivity based approach liu et al 2015 for the karst basin of longjiang 16 878 km2 in guizhou and guangxi provinces of southwest china runoff during 2003 2015 decreased by 19 6 compared with that during 1991 2002 about 51 4 of this runoff decrease was attributed to the mean annual ndvi increase from 0 669 during 1991 2002 to 0 699 during 2003 2015 lian et al 2020 this study demonstrates that in the whole basin of yrb shifts of forest and grass to crops from 1980 s to 1990 s in the wetting periods could significantly increase runoff e g 13 7 of runoff in the period of 1982 1991 since 2000 however significant vegetation restoration has reduced runoff as the climate was drier after 2000 runoff decrease induced by vegetation restoration is only about 23 4 26 3 of the total runoff decrease or 7 0 7 6 of runoff in the period of 2004 2015 the present vegetation coverage in the carbonate area consumes more water due to greater forest cover and larger area compared to the non carbonate area in future as the mean potential lai could increase by up to 4 times the present state fig 6 and fig 9 it results in an 11 7 decrease of runoff for the whole area 5 3 uncertainties of the simulated results there are uncertainties of the separated amount of runoff change attributed to landscape and climate change due to data errors different methods and co dependence of climate and vegetation this study shows that runoff decrease attributed to vegetation recovery from the hydrological model is smaller than that from the budyko equation in the study basin the budyko equation is based on multi year water and energy balance analysis which does not account for annual scale change in moisture and vegetation dynamics by contrast the hydrological method runs on a daily timescale which accounts for effects of moisture regulations and vegetation dynamics on runoff the differences using the two methods are also found in other studies using the elastic coefficient method and hydrological models xu et al 2013 assessed the contributions of climate variability to runoff change are 47 2 and 45 1 respectively in the luan river basin of inner mongolia and hebei province in china during 1956 2005 zhang et al 2016 obtained the contributions of climate change to runoff change are 41 1 and 34 8 respectively in beiluo river basin of shanxi province in china during 1960 2010 6 conclusion in the southwest karst region vegetation coverage has changed from decrease due to strong interferences of human activities to artificial and natural recovery after controls have been implemented human activities changed the effects of regolith properties on vegetation coverage and runoff such as high lai and ndvi and more water uptake in the carbonated area compared to the non carbonated area the artificial recovery measures have altered the vegetation dynamics in response to climate such as increased vegetation coverage in the drier climate condition however under both present changes and the predicted potential change in future the non carbonated area has a greater capacity to maintain higher vegetation coverage and more forest e g over 70 than the carbonated area the future vegetation recovery could make the non carbonated area more resilient to drought since the thick soils in the area have capacity to store more water and support a larger percentage of forest in future the mean potential lai could increase by 4 times higher than that in the present state leading to a predicted 11 2 decrease of runoff larger than 7 0 7 6 decrease of runoff in the present reforestation period of 2004 2015 these findings are beneficial for designing reforestation strategies that take into account geological and available water limitations in southwest china credit authorship contribution statement lianbin cai data curation investigation methodology visualization writing original draft xi chen conceptualization formal analysis funding acquisition writing review editing richao huang data curation project administration validation keith smettem supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the national natural scientific foundation of china 42030506 we thank the two anonymous reviewers and the editor for their constructive comments which significantly improved the manuscript 
3796,flash flood warning ffw systems play a fundamental role in flood hazard prevention and mitigation in this study we propose the first deep learning based approach for large scale ffw and demonstrate the application of this approach to mountainous and hilly areas of china specifically the time series of precipitation before flash floods and three spatial features maximum daily precipitation curve number and slope are selected as predictors a long short term memory lstm based approach is adopted to predict the occurrence of flash floods and we compare this approach with two widely used ffw methods namely the rainfall triggering index rti and flash flood guidance ffg the results demonstrate the following 1 the lstm based approach provided a reliable ffw 1 day ahead with a hit rate hr of 0 84 and false alarm rate far of 0 09 it demonstrated moderate warning performance 2 days before flash floods with an hr of 0 66 and far of 0 21 2 the lstm based approach outperformed the benchmark rti and ffg methods achieving the highest critical success index csi of 0 77 the ffg also provided satisfactory performance with a csi of 0 71 and the rti demonstrated the lowest performance csi 0 68 3 the lstm based approach provides better results csi 0 75 than rti csi 0 68 when only the time series of precipitation is used for prediction the performance of the lstm based approach can be improved by considering the spatial features and a long time series of precipitation during model development 4 the proposed approach did not exacerbate the effect of precipitation uncertainty on the flash flood warning and we suggest using ensemble results for ffw to reduce the uncertainty caused by small or unbalanced learning samples we conclude that the proposed approach is a valid method for large scale ffw without using commercially sensitive observations and can improve the capabilities of flood disaster mitigation particularly in ungauged areas keywords flash flood warning deep learning mountainous and hilly areas china 1 introduction flash floods are one of the most destructive natural hazards that have induced significant economic loss and casualties worldwide over the past two decades aroca jiménez et al 2018 diakakis et al 2020 gaume et al 2009 the flash flood hazard in china is serious particularly in mountainous and hilly areas with steep topographic slopes liu et al 2018 wang et al 2021 according to li et al 2019 statistics flash floods became the main threat to humans and property in china between 1990 and 2005 causing about 1 000 deaths per year flash flood warning ffw systems have become an important component of flood forecasting providing alerts that flash flooding may occur imminently in a specific area since 2006 the damage caused by flash floods in china has significantly decreased with the help of the development of a large scale ffw system li et al 2019 liu et al 2018 sun et al 2012 recently large scale ffw systems have been developed for flood hazard prevention and mitigation not only in china but throughout the world alfieri and thielen 2015 nieland and mushtaq 2016 schroeder et al 2016 traditional flood forecasting predicts quantitative hydrological variables e g discharge or water level for periods ranging from a few hours to several days ahead in recent decades different types of hydrological models have been proposed and have already achieved reliable results in forecasting of river floods jain et al 2018 however flash floods typically occur within a short time and in small or medium sized catchments less than 100 km2 which makes it more difficult to provide quantitative predictions than for river floods corral et al 2019 hapuarachchi et al 2011 with a deeper understanding of the physical process of flash floods some physical based hydrological models were developed and started to be used in flash flood forecasting in some regional studies luong et al 2021 miao et al 2016 norbiato et al 2008 younis et al 2008 the main difficulty in applying a physical based model for flash flood forecasting on a large scale is the absence of hydrological observations fleeting flash floods typically occur in poorly gauged catchments which amplifies the difficulties in rainfall and discharge data collection the mechanisms of flash floods are still poorly understood because of this data scarcity issue kastridis et al 2020 additionally the mechanisms of flash flood hazards significantly change under different geographic conditions and climate types which makes the applicability of a regional hydrological model at the national or continental scale challenging liu et al 2018 wang et al 2020 currently flash flood forecasting on a large scale relies on ffw systems that predict the occurrence of flash floods rather than quantitative hydrological variables li et al 2018 putra et al 2020 the most widely used ffw approach on a large scale is based on the critical threshold of rainfall indices such as the rainfall triggering index rti and antecedent precipitation index api cannon et al 2008 ma et al 2020 zhao et al 2019a these indices only focus on the driving factor of flash floods rainfall characteristics and ignore the spatial geographic and hydrological conditions to address this limitation flash flood guidance ffg considering the rainfall runoff process was proposed and successfully applied for large scale ffw worldwide georgakakos 2018 the main idea of ffg is to derive the critical rainfall threshold that causes the bankfull discharge at the catchment outlet using a lumped or distributed rainfall runoff model for example a gridded ffg was proposed by schmidt et al 2007 and successfully applied in the conterminous us clark et al 2014 the critical rainfall threshold in this gridded ffg is derived using a distributed scs cn rainfall runoff model and the bankfull discharge is set to the estimated 2 year return period flow the first official ffg in china was developed in 2006 based on an empirical rational equation and water level observations at the county level liu et al 2018 with the help of this ffg more than 21 million people in china were successfully evacuated from flash flood hazards between 2011 and 2015 li et al 2019 recently ffg has been improved in data rich countries using precise large scale hydrological modelling these improved ffgs need a large amount of data e g high resolution rainfall long term discharge soil parameters for model development and calibration and are therefore difficult to apply for data sparse areas in recent decades machine learning ml has been applied as an effective alternative to the traditional hydrological model in flood variable forecasting and flood susceptibility assessment ml based approaches have demonstrated advantages in predicting flood variables e g water level discharge in several large scale studies as they do not require a large amount of data for model development mosavi et al 2018 compared with flood variable forecasting this study uses an ml model to predict whether flash flooding will occur imminently in a specific area which can be regarded as a binary problem previously ml models have been successfully used to assess the binary problem of flood susceptibility for example zhao et al 2018 compared three widely used ml models artificial neural network support vector machine and random forest model for flood susceptibility assessments and demonstrated the use of these approaches in mountainous areas of china the flood susceptibility maps predict the spatial occurrence of floods under a particular scenario fang et al 2020 khosravi et al 2020 panahi et al 2021 but it is difficult to provide temporal predictions ahead of a flash flooding event based on the research of zhao et al 2018 this study extends the application of ml models to large scale ffw by predicting the occurrence of flash floods 1 day ahead recently advanced ml models such as deep learning dl have achieved promising results in temporal forecasting and spatial assessment of flood hazard from the regional to continental scale fang et al 2020 khosravi et al 2020 kratzert et al 2018 panahi et al 2021 pham et al 2020 among all dl models the long short term memory model lstm has been demonstrated to be a better architecture for flood prediction than traditional ml models without explicit cell architecture kratzert et al 2018 kratzert et al 2019 through the designed cell architecture the lstm model can extract information from a long time series e g the antecedent precipitation information which in theory is very suitable for dynamic ffw the lstm model has been successfully applied in flood related topics on a large scale such as precipitation estimation wu et al 2020 rainfall runoff modelling kratzert et al 2018 and river flood forecasting kratzert et al 2019 le et al 2019 to the best of our knowledge this is the first study to adopt the lstm model or any form of deep learning model for ffw on a large scale compared with the traditional ffg and rti methods the proposed lstm based approach can provide dynamic ffw 1 day ahead by automatically extracting useful information from antecedent precipitation series and other related spatial features and does not need detailed discharge or water level observations for hydrological model development the aim of this study is to propose a new large scale flash flood warning ffw system based on deep learning and demonstrate the proposed approach in mountainous and hilly areas of china additionally we compare the proposed approach with two widely used benchmark methods rti and ffg and then test the influence of the lead warning time split samples and error of precipitation on the lstm results the paper is structured as follows in sect 2 we describe the study area and the data used for model development in sect 3 we briefly describe the mechanisms of the lstm rti and ffg methods and the indices used for model evaluation in sect 4 we present the results of model comparisons predictors selection and the model accuracy under different warning lead times in sect 5 we discuss the impact of split samples and precipitation errors on the model results we summarise the conclusion in sect 6 2 study areas and data 2 1 study area the study area mainly focuses on the mountainous and hilly areas of china we delineated the mountainous and hilly areas based on the criterion proposed by kapos 2000 and sayre et al 2014 respectively the criterion considers local elevation in addition to slope and has been successfully applied to extract mountainous and hilly areas in several countries including china nogués bravo et al 2007 schuler et al 2004 zhao et al 2018 mountainous and hilly areas of china require effective protection because of their important hydrological functions and intensive human activities li et al 2017 the mountains are the source of several major rivers in china and mountain ecosystems are vulnerable to disturbance from external pressures liu et al 2015 recently flash floods have caused major disasters in the mountainous and hilly areas of china resulting in approximately 70 deaths and usd 260 million of damage to property each year li et al 2018 zhai et al 2021a to reduce the negative impacts of flash floods different non structural measures have been adopted by the chinese government in the study area affecting a population of 560 million in 103 counties of china sun et al 2012 2 2 flash flood inventory the flash flood inventory included 961 historical flash flood events that occurred in the mountainous and hilly areas of china between 2011 and 2016 this inventory was first built by he et al 2018 and further updated and validated by ma et al 2018 who collected historical flash flood records from the ministry of water resources and local governmental departments in china the distribution of the 961 historical flash flood events is shown in fig 1 we found that a small percentage of observed flash flood events are occurred out of the delineated study area with exactly 3 this is mainly because the mountainous and hilly areas derived from a global merit dem yamazaki et al 2017 that can have errors when describing particular regional studies and lead to this small inconsistency the inventory records the date and location of flash flood events and we assigned these flooded dates events as the class 1 we generated the same number of non flooded events based on the api series as shown in the fig 2 1 we calculated the 15 day api before the recorded flooded date 2 we selected the non flooded date at the minimal api value within the 15 days 3 we assigned these non flooded dates as the class 0 the api can be calculated as follows 1 api t k api t δ t p δ t where api t is the api at time t k is the recession coefficient and set to 0 84 as recommended by crozier and eyles 1980 p δ t is the total precipitation during time δ t and δ t is set as 1 day the api represents a combination of the daily precipitation at day t and antecedent precipitation information before day t it has been widely used to identify rainfall triggered hazards such as landslides and flash floods ramos filho et al 2020 zhao et al 2019b finally we collected 1 922 learning samples and randomly selected 70 and 30 of the samples for model training and testing respectively 2 3 description of predictors the model inputs include the time series of antecedent precipitation ap and three spatial hydrological features shf the ap describes the temporal change in precipitation before the flooded or non flooded date and can be described as eq 2 2 ap p t i p t i 1 p t i 2 p t i w 1 where p is the daily precipitation mm t is the flooded or non flooded date in the inventory i is the warning lead time day and is set to 1 in this study 1 day ffw and w is the length of the antecedent precipitation series lap we selected the three shf called maximum daily precipitation mp curve number cn and slope sl to describe the spatial change of precipitation runoff capacity and geographic condition respectively between different sites the mp is the average value of the annual mp series between 2011 and 2016 we derived the ap and mp from the fusion product 0 1 0 1 of cmorph satellite precipitation estimates joyce et al 2004 and observed data from more than 30 000 stations in china this product is obtained from the china meteorological data service centre http data cma cn the cn is an empirical parameter that reflects the runoff capacity in data sparse areas in theory surface runoff is more likely to occur as the cn increases we extracted the cn data in china from an nrcs cn global dataset developed by zeng et al 2017 which uses the latest moderate resolution imaging spectroradiometer land cover and the harmonized world soil database the sl represents the maximum change of elevation between the centre grid and its eight surrounding neighbours it is derived on the basis of the merit dem yamazaki et al 2017 a steep sl in mountainous and hilly areas reduces the infiltration time increases the speed of flow and increases the risk of flash flood hazard we resampled the cn and sl data to a resolution of 0 1 0 1 using arcgis software 3 methodology the flowchart for this study is displayed in fig 3 stage a covers the preparation of learning samples as described in section 2 stage b involves model evaluation and comparison in this stage we compare the ffw performance of the proposed lstm based approach with that of two benchmarks ffg and rti using data from mountainous and hilly areas of china section 4 1 in stage c we investigate the influence of the various predictors section 4 2 and the warning lead time section 4 2 on the lstm approach and further analyse the model uncertainty caused by how the samples are split and the errors in the precipitation series section 5 3 1 lstm model the lstm model is an improved form of the recurrent neural network rnn architecture and has been widely used in sequence related problems yu et al 2019 by introducing different types of cell gates the lstm overcomes the vanishing gradient problem in conventional rnns and uses long term dependency information easily gers et al 1999 fig 4 a describes the inner structure of one unit u in the lstm layer for the unit ut the forget gate f t potential update vector c t and input gate i t are first computed as eq 3 5 3 f t σ w f h t 1 x t b f 4 c t t a n h w c h t 1 x t b c 5 i t σ w i h t 1 x t b i where x t denotes the model inputs at time t h t 1 is the hidden output from ut 1 w and b are trainable weights in neural networks σ represents the logistic sigmoid function and tanh is the hyperbolic tangent additionally the cell state c t is updated by eq 6 6 c t f t c t 1 i t c t finally the output gate o t and hidden output h t of the ut can be computed as eq 7 and 8 respectively 7 o t σ w o h t 1 x t b o 8 h t o t t a n h c t where w and b are trainable weights in neural networks σ represents the logistic sigmoid function h t 1 is the hidden output of ut 1 and tanh is the hyperbolic tangent a more detailed description of the structure of lstm can be found in kratzert et al 2018 the architecture of the lstm model used in this study was proposed by zhang et al 2018 and is presented in fig 4 b it mainly involves three layers one lstm layer one fully connected layer and one binary output layer the model inputs involve the time series of ap and three at site shfs which are described in section 2 3 the number of hidden units of the lstm layer is set to 120 using a trial and error method the hidden output from the last lstm unit is connected with the fully connected layer considering the dropout strategy dropout rate is set to 0 2 this architecture helps to maintain previous information and avoid overfitting during the training period zhang et al 2018 the output is the predicted probability pp which takes a value between 0 and 1 pp values below the threshold of 0 5 indicate non flood events whereas values greater than or equal to 0 5 indicate that flood events are predicted the lstm model is implemented using the deep learning toolbox in matlab 2020a https www mathworks com products deep learning html 3 2 benchmark methods two widely used ffw approaches namely rti and ffg are used for comparison the main idea of rti and ffg is to define a rainfall threshold prior to the occurrence of flash floods this threshold indicates the total amount of rainfall before the given lead time which is sufficient to cause flash flooding the methods predict a flood event class 1 if the past rainfall exceeds the threshold and a non flood event class 0 otherwise the rainfall thresholds in rti and ffg are described in the following sections 3 2 1 critical rti threshold the critical rti threshold is a simple rainfall indicator and has been successfully applied to flash flood and debris flow warning chen et al 2013 ma et al 2020 nam et al 2019 as described in eq 9 the rti includes information about both the cumulative rainfall of the past 7 days and the intensive precipitation at day t 9 rti t i t i t 7 i t 1 cr i where rti t is the rainfall trigger index at day t i t is the total rainfall at day t cr is the cumulative daily rainfall from day t 7 to day t 1 the rti threshold can be derived using a trial and error method as follows a calculate different percentiles of the rtit series rti p p 60 65 70 75 80 85 90 as eq 10 b use each rti p as the rti threshold and use it for the ffw and c select the rti threshold from the best model performance in the training period see table a 1 in the appendix 10 rti p p e r c e n t i l e r t i t t 1 2 n where rti p is the percentile value of time series rti t 3 2 2 flash flood guidance ffg in china the ffg is an official method for national ffw in china liu et al 2018 it was gradually established between 2006 and 2012 by collecting the rainfall threshold from 2 058 counties in china for each county the rainfall threshold was calculated on the basis of a reserved empirical rational equation in 11 11 i c q a where i is the rainfall threshold for ffw a is the catchment area q is the bankfull discharge and c is the runoff coefficient the q in ffg is derived on the basis of the observed bankfull water level and water level discharge curve at the catchment outlet the runoff coefficient c in eq 11 is defined by the hydrological handbooks in china at the county level the rainfall threshold in ffg is provided by different lead times of 1 3 6 and 24 h we compared the proposed lstm model with the 24 h rainfall threshold map a more detailed description of the ffg can be found in liu et al 2018 3 3 evaluation indices we adopted three widely used indices in ffw that is the hit rate hr false alarm rate far and critical success index csi for model evaluation clark et al 2014 we calculated three evaluation indices using the contingency table see table a 2 in the appendix and eqs 12 14 12 hr hits hits m i s s e s 13 far falsealarms hits f a l s e a l a r m s 14 csi hits hits f a l s e a l a r m s m i s s e s where hits is the number of observed flooded events correctly predicted misses is the number of observed flood events incorrectly predicted as non flooded events and false alarms is the number of observed non flooded events incorrectly predicted as flooded events 4 results 4 1 approach comparison we first compare the proposed lstm based approach with the rti and ffg methods for use in mountainous and hilly areas of china as presented in table 1 the proposed approach outperformed the two benchmarks with the highest csi of 0 76 and 0 77 in the training and testing periods respectively the ffg provided satisfactory performance with a csi of 0 71 in the testing period and the rti provided the lowest performance with a csi of 0 68 in the testing period the ffg methods demonstrated similar satisfactory performance to the lstm method for the hr this shows that more than 80 flooded events were successfully detected by the lstm and ffg methods however more than 15 of non flooded events were false alarmed using the ffg method the rti method performed better in terms of the far than the ffg method but the hr was lower than 0 75 in both the training and testing periods fig 5 shows the spatial distribution of hits and misses for the three methods in the study area the proposed lstm model outperformed the rti and ffg methods with the highest number of hits 807 sites the rti method yielded the lowest number of hits 721 sites among all methods this can be expected as the rti method only considered the driving rainfall factors for model development the spatial change of hydrological conditions such as runoff capacity cannot be reflected within the rti method compared with the ffg method the lstm model significantly improved the hr in the northeast mountainous and hilly areas in china we found that the performance of the lstm and the other two methods was limited in arid and semi arid areas of china this is likely to be a result of dryer regions being more heterogeneous salinas et al 2013 and this is difficult to accurately represent at the current resolution 0 1 of features in addition to achieving the highest accuracy the proposed lstm model has an advantage over the rti method that it can detect useful information from various predictors automatically this avoids the complicated threshold selection process in rti method additionally it does not need detailed discharge or water level observations for hydrological model development in ffg and is very suitable for ffw for ungauged or data sparse areas therefore we conclude that the lstm model is a valid and simple approach for large scale ffw 4 2 influence of predictors in this section we further test the influence of temporal and spatial predictors on the performance of the proposed lstm as shown in fig 6 the lstm considering both shf and ap outperformed the model only considering ap about 5 improvement was achieved by considering shf both in the training and testing periods in terms of different laps this can be expected as ap only describes the temporal change of precipitation before the flooded or non flooded date we did not consider the spatial variations between different sites when training the lstm model using only ap compared with the rti method see table 1 the lstm ap model provides better predictions when only rainfall data are used for model development this is mainly because the rti method only considers the cumulative rainfall over the past 7 days and the daily precipitation 1 day ahead whereas the lstm model automatically identifies useful information from a long time series of precipitation the lap describes the amount of ap information used for model development we found that the lap is a sensitive factor for the lstm model the csi of lstm ap and lstm ap shf ranged from 0 69 to 0 75 and 0 71 to 0 78 respectively in the testing period the performance of the lstm model improved as the lap increased and became stable when the lap was larger than 15 days this demonstrates that the occurrence of a flash flood is strongly determined by the past 15 days precipitation the best combination of predictors for this study ap shf and lap 25 was selected according to the highest csi value in the training period 4 3 influence on warning lead time providing an earlier warning can leave more time for decision makers to prepare for emergencies and react in this section we test the influence of different warning lead times on lstm model performance fig 7 shows the performance of the lstm based approach in terms of different warning lead times we found that model performance decayed quickly as the lead time increased the best lstm model was achieved with the highest csi of 0 86 in the testing period when the lead time was set to 0 days this reveals that the proposed lstm model is a promising tool for real time predictions to use this real time model to achieve earlier warnings decision makers need quantitative precipitation forecasts prior to the occurrence of flash flooding when the lead time was set to 1 day the lstm model provided accurate results with an hr of 0 84 and far of 0 09 in the testing period this demonstrates that the proposed lstm model provided a reliable warning 1 day ahead using the historical ap series and shfs the lstm model still had some degree of prediction capacity when the lead time was set to 2 days with a moderate performance for an hr of 0 66 and far of 0 21 this 2 day ahead warning will give decision makers more time to prepare flood mitigation and evacuation the csi was lower than 0 50 when the lead time was larger than 3 which demonstrates that we do not suggest using the model for a mid term ffw of more than 3 days 5 discussion a common problem in flood modelling is that the consistency and coverage of the hazard inventory remain inadequate cutter et al 2008 we now discuss the influence of taking a random split of all data samples on lstm model accuracy we regard the lstm model validated above as the base model to test the influence of random split samples on the model results we randomly selected training samples 30 times from the entire leaning samples and then trained 30 lstm models based on the different split subsets fig 8 a shows the pps given by the base model versus the pps from 30 lstm models trained by different splits of the data samples we found that the selection of training samples had a large impact on the model results and the hr performance ranged from 0 73 to 0 86 these results demonstrate that current learning samples may not have been sufficiently representative for training and testing therefore we suggest using ensemble results from several lstm models trained by different split training subsets to reduce the influence of small or unbalanced inventories on the ffw although advanced rainfall products are gradually released at the national scale the uncertainty of prediction is still high maggioni and massari 2018 sun et al 2018 and this will inevitably affect the warning performances we now analyse the influence of precipitation errors on the model results we generated 30 training subsets by randomly adding 20 bias to the series of ap series we then retrained 30 lstm models on the basis of the same samples with different biased ap series fig 6 b shows the pps given by the base model versus the pps from 30 lstm models trained by different biased ap series the hr ranges between 0 82 and 0 85 which demonstrates that the lstm model did not exacerbate the effect of precipitation errors on the ffw although some individual large error points exist in fig 8 b the proposed method provided a valuable ffw for decision makers even though the precipitation data were slightly disturbed 6 conclusions flash floods induced by intensive rainfall are widespread in mountainous and hilly areas in this study we proposed an lstm based approach for an ffw system on a large scale this approach can reliably predict the occurrence of flash floods 1 day ahead without using detailed water level or discharge observations we compared the proposed approach with two benchmarks ffg and rti methods for use in mountainous and hilly areas of china the good result of this study reveals that the proposed deep learning based approach can be used as one of candidate tools for large scale ffw the main conclusions are summarised as follows 1 the proposed lstm model outperformed rti and ffg methods in the study area with the highest csi of 0 76 and 0 77 in the training and testing periods respectively the ffg provided satisfactory performance with a csi of 0 71 in the testing period and the rti provided the lowest performance with a csi of 0 69 in the testing period 2 we tested the influence of various predictors on the lstm model performance the lstm model provides better results csi 0 75 than rti csi 0 69 when only the time series of ap is used for prediction the lstm model can be improved by considering spatial hydrological features in the model development stage the performance of the lstm model was found to become stable when the length of the ap series is greater than 15 days 3 the lstm model performance decayed quickly as the warning lead time increased the lstm model provided a reliable prediction 1 day ahead of the flash floods with an hr of 0 84 and far of 0 09 in the testing period its performance was moderate for prediction 2 days ahead and we do not suggest using the proposed approach for ffw of more than 3 days ahead 4 we discussed the influence of split samples and precipitation errors on model accuracy the lstm model demonstrated a moderate uncertainty hr from 0 73 to 0 86 when we used different split samples for training and we suggest using ensemble results for ffw in applications the performance of the lstm model varied little when different biased precipitations were used which demonstrates that it did not exacerbate the effect of precipitation uncertainty on the ffw this study has demonstrated the use of the proposed deep learning based approach in mountainous and hilly areas of china as the performances of deep learning model are highly depended on the representation of the training samples this approach may not be quite widely applicable to some areas such as tibetan plateau without sufficient flash flood records this study is a novel attempt to introduce an lstm model to ffw systems on a national scale based on daily rainfall series and spatial hydrological features at a resolution of 0 1 0 1 flash flooding exhibits significant heterogeneity over china because of the diverse hydro meteorological conditions that occur across the country zhai et al 2021a the current spatiotemporal resolution of the predictors and the fixed architecture of lstm makes it difficult to accurately capture various types of flash floods over the mountainous and hilly areas of china lovat et al 2019 zhai et al 2021b advanced satellite products are now able to provide high resolution spatiotemporal observations e g rainfall elevation vegetation with global coverage mccabe et al 2017 moreover other deep learning models such as convolutional neural networks and recurrent neural networks have shown advantages in processing temporal and spatial datasets for flood forecasting kratzert et al 2019 pham et al 2020 future efforts will explore the application of high resolution data and various deep learning models to ffw systems on a national scale 7 data availability the precipitation data is freely available at http data cma cn data cdcdetail datacode sevp cli chn merge cmp pre hour grid 0 10 html the data source of curve number is described at https doi org 10 1080 2150704x 2017 1297544 the adopted terrain data is the merit dem at http hydro iis u tokyo ac jp yamadai merit dem the flood inventory and official flash flood guide in china are obtained from the ministry of water resources in china http www mwr gov cn english credit authorship contribution statement gang zhao conceptualization methodology software writing original draft ronghua liu project administration supervision writing review editing mingxiang yang visualization software investigation tongbi tu validation supervision writing review editing meihong ma conceptualization writing original draft funding acquisition yang hong supervision writing review editing xiekang wang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments ronghua liu is supported by the national key research and development program of china 2019yfc1510605 meihong ma is supported by the national natural science foundation of china 42101086 and key research and development program of heibei province key technology research 19275403d mingxiang yang is supported by national natural science foundation of china u1865102 and open research fund of state key laboratory of simulation and regulation of water cycle in river basin skl2020ts01 tongbi tu is supported by the national natural science foundation of china 52109046 the national key research and development program of china 2021yfc3001000 and fundamental research funds for the central universities sun yat sen university 2021qntd15 we thank emmanouil anagnostou emad hasan and three reviewers for their helpful comments which significantly improved this paper we also thank maxine garcia phd from liwen bianji edanz group china www liwenbianji cn ac for editing the english text of a draft of this manuscript appendix 
3796,flash flood warning ffw systems play a fundamental role in flood hazard prevention and mitigation in this study we propose the first deep learning based approach for large scale ffw and demonstrate the application of this approach to mountainous and hilly areas of china specifically the time series of precipitation before flash floods and three spatial features maximum daily precipitation curve number and slope are selected as predictors a long short term memory lstm based approach is adopted to predict the occurrence of flash floods and we compare this approach with two widely used ffw methods namely the rainfall triggering index rti and flash flood guidance ffg the results demonstrate the following 1 the lstm based approach provided a reliable ffw 1 day ahead with a hit rate hr of 0 84 and false alarm rate far of 0 09 it demonstrated moderate warning performance 2 days before flash floods with an hr of 0 66 and far of 0 21 2 the lstm based approach outperformed the benchmark rti and ffg methods achieving the highest critical success index csi of 0 77 the ffg also provided satisfactory performance with a csi of 0 71 and the rti demonstrated the lowest performance csi 0 68 3 the lstm based approach provides better results csi 0 75 than rti csi 0 68 when only the time series of precipitation is used for prediction the performance of the lstm based approach can be improved by considering the spatial features and a long time series of precipitation during model development 4 the proposed approach did not exacerbate the effect of precipitation uncertainty on the flash flood warning and we suggest using ensemble results for ffw to reduce the uncertainty caused by small or unbalanced learning samples we conclude that the proposed approach is a valid method for large scale ffw without using commercially sensitive observations and can improve the capabilities of flood disaster mitigation particularly in ungauged areas keywords flash flood warning deep learning mountainous and hilly areas china 1 introduction flash floods are one of the most destructive natural hazards that have induced significant economic loss and casualties worldwide over the past two decades aroca jiménez et al 2018 diakakis et al 2020 gaume et al 2009 the flash flood hazard in china is serious particularly in mountainous and hilly areas with steep topographic slopes liu et al 2018 wang et al 2021 according to li et al 2019 statistics flash floods became the main threat to humans and property in china between 1990 and 2005 causing about 1 000 deaths per year flash flood warning ffw systems have become an important component of flood forecasting providing alerts that flash flooding may occur imminently in a specific area since 2006 the damage caused by flash floods in china has significantly decreased with the help of the development of a large scale ffw system li et al 2019 liu et al 2018 sun et al 2012 recently large scale ffw systems have been developed for flood hazard prevention and mitigation not only in china but throughout the world alfieri and thielen 2015 nieland and mushtaq 2016 schroeder et al 2016 traditional flood forecasting predicts quantitative hydrological variables e g discharge or water level for periods ranging from a few hours to several days ahead in recent decades different types of hydrological models have been proposed and have already achieved reliable results in forecasting of river floods jain et al 2018 however flash floods typically occur within a short time and in small or medium sized catchments less than 100 km2 which makes it more difficult to provide quantitative predictions than for river floods corral et al 2019 hapuarachchi et al 2011 with a deeper understanding of the physical process of flash floods some physical based hydrological models were developed and started to be used in flash flood forecasting in some regional studies luong et al 2021 miao et al 2016 norbiato et al 2008 younis et al 2008 the main difficulty in applying a physical based model for flash flood forecasting on a large scale is the absence of hydrological observations fleeting flash floods typically occur in poorly gauged catchments which amplifies the difficulties in rainfall and discharge data collection the mechanisms of flash floods are still poorly understood because of this data scarcity issue kastridis et al 2020 additionally the mechanisms of flash flood hazards significantly change under different geographic conditions and climate types which makes the applicability of a regional hydrological model at the national or continental scale challenging liu et al 2018 wang et al 2020 currently flash flood forecasting on a large scale relies on ffw systems that predict the occurrence of flash floods rather than quantitative hydrological variables li et al 2018 putra et al 2020 the most widely used ffw approach on a large scale is based on the critical threshold of rainfall indices such as the rainfall triggering index rti and antecedent precipitation index api cannon et al 2008 ma et al 2020 zhao et al 2019a these indices only focus on the driving factor of flash floods rainfall characteristics and ignore the spatial geographic and hydrological conditions to address this limitation flash flood guidance ffg considering the rainfall runoff process was proposed and successfully applied for large scale ffw worldwide georgakakos 2018 the main idea of ffg is to derive the critical rainfall threshold that causes the bankfull discharge at the catchment outlet using a lumped or distributed rainfall runoff model for example a gridded ffg was proposed by schmidt et al 2007 and successfully applied in the conterminous us clark et al 2014 the critical rainfall threshold in this gridded ffg is derived using a distributed scs cn rainfall runoff model and the bankfull discharge is set to the estimated 2 year return period flow the first official ffg in china was developed in 2006 based on an empirical rational equation and water level observations at the county level liu et al 2018 with the help of this ffg more than 21 million people in china were successfully evacuated from flash flood hazards between 2011 and 2015 li et al 2019 recently ffg has been improved in data rich countries using precise large scale hydrological modelling these improved ffgs need a large amount of data e g high resolution rainfall long term discharge soil parameters for model development and calibration and are therefore difficult to apply for data sparse areas in recent decades machine learning ml has been applied as an effective alternative to the traditional hydrological model in flood variable forecasting and flood susceptibility assessment ml based approaches have demonstrated advantages in predicting flood variables e g water level discharge in several large scale studies as they do not require a large amount of data for model development mosavi et al 2018 compared with flood variable forecasting this study uses an ml model to predict whether flash flooding will occur imminently in a specific area which can be regarded as a binary problem previously ml models have been successfully used to assess the binary problem of flood susceptibility for example zhao et al 2018 compared three widely used ml models artificial neural network support vector machine and random forest model for flood susceptibility assessments and demonstrated the use of these approaches in mountainous areas of china the flood susceptibility maps predict the spatial occurrence of floods under a particular scenario fang et al 2020 khosravi et al 2020 panahi et al 2021 but it is difficult to provide temporal predictions ahead of a flash flooding event based on the research of zhao et al 2018 this study extends the application of ml models to large scale ffw by predicting the occurrence of flash floods 1 day ahead recently advanced ml models such as deep learning dl have achieved promising results in temporal forecasting and spatial assessment of flood hazard from the regional to continental scale fang et al 2020 khosravi et al 2020 kratzert et al 2018 panahi et al 2021 pham et al 2020 among all dl models the long short term memory model lstm has been demonstrated to be a better architecture for flood prediction than traditional ml models without explicit cell architecture kratzert et al 2018 kratzert et al 2019 through the designed cell architecture the lstm model can extract information from a long time series e g the antecedent precipitation information which in theory is very suitable for dynamic ffw the lstm model has been successfully applied in flood related topics on a large scale such as precipitation estimation wu et al 2020 rainfall runoff modelling kratzert et al 2018 and river flood forecasting kratzert et al 2019 le et al 2019 to the best of our knowledge this is the first study to adopt the lstm model or any form of deep learning model for ffw on a large scale compared with the traditional ffg and rti methods the proposed lstm based approach can provide dynamic ffw 1 day ahead by automatically extracting useful information from antecedent precipitation series and other related spatial features and does not need detailed discharge or water level observations for hydrological model development the aim of this study is to propose a new large scale flash flood warning ffw system based on deep learning and demonstrate the proposed approach in mountainous and hilly areas of china additionally we compare the proposed approach with two widely used benchmark methods rti and ffg and then test the influence of the lead warning time split samples and error of precipitation on the lstm results the paper is structured as follows in sect 2 we describe the study area and the data used for model development in sect 3 we briefly describe the mechanisms of the lstm rti and ffg methods and the indices used for model evaluation in sect 4 we present the results of model comparisons predictors selection and the model accuracy under different warning lead times in sect 5 we discuss the impact of split samples and precipitation errors on the model results we summarise the conclusion in sect 6 2 study areas and data 2 1 study area the study area mainly focuses on the mountainous and hilly areas of china we delineated the mountainous and hilly areas based on the criterion proposed by kapos 2000 and sayre et al 2014 respectively the criterion considers local elevation in addition to slope and has been successfully applied to extract mountainous and hilly areas in several countries including china nogués bravo et al 2007 schuler et al 2004 zhao et al 2018 mountainous and hilly areas of china require effective protection because of their important hydrological functions and intensive human activities li et al 2017 the mountains are the source of several major rivers in china and mountain ecosystems are vulnerable to disturbance from external pressures liu et al 2015 recently flash floods have caused major disasters in the mountainous and hilly areas of china resulting in approximately 70 deaths and usd 260 million of damage to property each year li et al 2018 zhai et al 2021a to reduce the negative impacts of flash floods different non structural measures have been adopted by the chinese government in the study area affecting a population of 560 million in 103 counties of china sun et al 2012 2 2 flash flood inventory the flash flood inventory included 961 historical flash flood events that occurred in the mountainous and hilly areas of china between 2011 and 2016 this inventory was first built by he et al 2018 and further updated and validated by ma et al 2018 who collected historical flash flood records from the ministry of water resources and local governmental departments in china the distribution of the 961 historical flash flood events is shown in fig 1 we found that a small percentage of observed flash flood events are occurred out of the delineated study area with exactly 3 this is mainly because the mountainous and hilly areas derived from a global merit dem yamazaki et al 2017 that can have errors when describing particular regional studies and lead to this small inconsistency the inventory records the date and location of flash flood events and we assigned these flooded dates events as the class 1 we generated the same number of non flooded events based on the api series as shown in the fig 2 1 we calculated the 15 day api before the recorded flooded date 2 we selected the non flooded date at the minimal api value within the 15 days 3 we assigned these non flooded dates as the class 0 the api can be calculated as follows 1 api t k api t δ t p δ t where api t is the api at time t k is the recession coefficient and set to 0 84 as recommended by crozier and eyles 1980 p δ t is the total precipitation during time δ t and δ t is set as 1 day the api represents a combination of the daily precipitation at day t and antecedent precipitation information before day t it has been widely used to identify rainfall triggered hazards such as landslides and flash floods ramos filho et al 2020 zhao et al 2019b finally we collected 1 922 learning samples and randomly selected 70 and 30 of the samples for model training and testing respectively 2 3 description of predictors the model inputs include the time series of antecedent precipitation ap and three spatial hydrological features shf the ap describes the temporal change in precipitation before the flooded or non flooded date and can be described as eq 2 2 ap p t i p t i 1 p t i 2 p t i w 1 where p is the daily precipitation mm t is the flooded or non flooded date in the inventory i is the warning lead time day and is set to 1 in this study 1 day ffw and w is the length of the antecedent precipitation series lap we selected the three shf called maximum daily precipitation mp curve number cn and slope sl to describe the spatial change of precipitation runoff capacity and geographic condition respectively between different sites the mp is the average value of the annual mp series between 2011 and 2016 we derived the ap and mp from the fusion product 0 1 0 1 of cmorph satellite precipitation estimates joyce et al 2004 and observed data from more than 30 000 stations in china this product is obtained from the china meteorological data service centre http data cma cn the cn is an empirical parameter that reflects the runoff capacity in data sparse areas in theory surface runoff is more likely to occur as the cn increases we extracted the cn data in china from an nrcs cn global dataset developed by zeng et al 2017 which uses the latest moderate resolution imaging spectroradiometer land cover and the harmonized world soil database the sl represents the maximum change of elevation between the centre grid and its eight surrounding neighbours it is derived on the basis of the merit dem yamazaki et al 2017 a steep sl in mountainous and hilly areas reduces the infiltration time increases the speed of flow and increases the risk of flash flood hazard we resampled the cn and sl data to a resolution of 0 1 0 1 using arcgis software 3 methodology the flowchart for this study is displayed in fig 3 stage a covers the preparation of learning samples as described in section 2 stage b involves model evaluation and comparison in this stage we compare the ffw performance of the proposed lstm based approach with that of two benchmarks ffg and rti using data from mountainous and hilly areas of china section 4 1 in stage c we investigate the influence of the various predictors section 4 2 and the warning lead time section 4 2 on the lstm approach and further analyse the model uncertainty caused by how the samples are split and the errors in the precipitation series section 5 3 1 lstm model the lstm model is an improved form of the recurrent neural network rnn architecture and has been widely used in sequence related problems yu et al 2019 by introducing different types of cell gates the lstm overcomes the vanishing gradient problem in conventional rnns and uses long term dependency information easily gers et al 1999 fig 4 a describes the inner structure of one unit u in the lstm layer for the unit ut the forget gate f t potential update vector c t and input gate i t are first computed as eq 3 5 3 f t σ w f h t 1 x t b f 4 c t t a n h w c h t 1 x t b c 5 i t σ w i h t 1 x t b i where x t denotes the model inputs at time t h t 1 is the hidden output from ut 1 w and b are trainable weights in neural networks σ represents the logistic sigmoid function and tanh is the hyperbolic tangent additionally the cell state c t is updated by eq 6 6 c t f t c t 1 i t c t finally the output gate o t and hidden output h t of the ut can be computed as eq 7 and 8 respectively 7 o t σ w o h t 1 x t b o 8 h t o t t a n h c t where w and b are trainable weights in neural networks σ represents the logistic sigmoid function h t 1 is the hidden output of ut 1 and tanh is the hyperbolic tangent a more detailed description of the structure of lstm can be found in kratzert et al 2018 the architecture of the lstm model used in this study was proposed by zhang et al 2018 and is presented in fig 4 b it mainly involves three layers one lstm layer one fully connected layer and one binary output layer the model inputs involve the time series of ap and three at site shfs which are described in section 2 3 the number of hidden units of the lstm layer is set to 120 using a trial and error method the hidden output from the last lstm unit is connected with the fully connected layer considering the dropout strategy dropout rate is set to 0 2 this architecture helps to maintain previous information and avoid overfitting during the training period zhang et al 2018 the output is the predicted probability pp which takes a value between 0 and 1 pp values below the threshold of 0 5 indicate non flood events whereas values greater than or equal to 0 5 indicate that flood events are predicted the lstm model is implemented using the deep learning toolbox in matlab 2020a https www mathworks com products deep learning html 3 2 benchmark methods two widely used ffw approaches namely rti and ffg are used for comparison the main idea of rti and ffg is to define a rainfall threshold prior to the occurrence of flash floods this threshold indicates the total amount of rainfall before the given lead time which is sufficient to cause flash flooding the methods predict a flood event class 1 if the past rainfall exceeds the threshold and a non flood event class 0 otherwise the rainfall thresholds in rti and ffg are described in the following sections 3 2 1 critical rti threshold the critical rti threshold is a simple rainfall indicator and has been successfully applied to flash flood and debris flow warning chen et al 2013 ma et al 2020 nam et al 2019 as described in eq 9 the rti includes information about both the cumulative rainfall of the past 7 days and the intensive precipitation at day t 9 rti t i t i t 7 i t 1 cr i where rti t is the rainfall trigger index at day t i t is the total rainfall at day t cr is the cumulative daily rainfall from day t 7 to day t 1 the rti threshold can be derived using a trial and error method as follows a calculate different percentiles of the rtit series rti p p 60 65 70 75 80 85 90 as eq 10 b use each rti p as the rti threshold and use it for the ffw and c select the rti threshold from the best model performance in the training period see table a 1 in the appendix 10 rti p p e r c e n t i l e r t i t t 1 2 n where rti p is the percentile value of time series rti t 3 2 2 flash flood guidance ffg in china the ffg is an official method for national ffw in china liu et al 2018 it was gradually established between 2006 and 2012 by collecting the rainfall threshold from 2 058 counties in china for each county the rainfall threshold was calculated on the basis of a reserved empirical rational equation in 11 11 i c q a where i is the rainfall threshold for ffw a is the catchment area q is the bankfull discharge and c is the runoff coefficient the q in ffg is derived on the basis of the observed bankfull water level and water level discharge curve at the catchment outlet the runoff coefficient c in eq 11 is defined by the hydrological handbooks in china at the county level the rainfall threshold in ffg is provided by different lead times of 1 3 6 and 24 h we compared the proposed lstm model with the 24 h rainfall threshold map a more detailed description of the ffg can be found in liu et al 2018 3 3 evaluation indices we adopted three widely used indices in ffw that is the hit rate hr false alarm rate far and critical success index csi for model evaluation clark et al 2014 we calculated three evaluation indices using the contingency table see table a 2 in the appendix and eqs 12 14 12 hr hits hits m i s s e s 13 far falsealarms hits f a l s e a l a r m s 14 csi hits hits f a l s e a l a r m s m i s s e s where hits is the number of observed flooded events correctly predicted misses is the number of observed flood events incorrectly predicted as non flooded events and false alarms is the number of observed non flooded events incorrectly predicted as flooded events 4 results 4 1 approach comparison we first compare the proposed lstm based approach with the rti and ffg methods for use in mountainous and hilly areas of china as presented in table 1 the proposed approach outperformed the two benchmarks with the highest csi of 0 76 and 0 77 in the training and testing periods respectively the ffg provided satisfactory performance with a csi of 0 71 in the testing period and the rti provided the lowest performance with a csi of 0 68 in the testing period the ffg methods demonstrated similar satisfactory performance to the lstm method for the hr this shows that more than 80 flooded events were successfully detected by the lstm and ffg methods however more than 15 of non flooded events were false alarmed using the ffg method the rti method performed better in terms of the far than the ffg method but the hr was lower than 0 75 in both the training and testing periods fig 5 shows the spatial distribution of hits and misses for the three methods in the study area the proposed lstm model outperformed the rti and ffg methods with the highest number of hits 807 sites the rti method yielded the lowest number of hits 721 sites among all methods this can be expected as the rti method only considered the driving rainfall factors for model development the spatial change of hydrological conditions such as runoff capacity cannot be reflected within the rti method compared with the ffg method the lstm model significantly improved the hr in the northeast mountainous and hilly areas in china we found that the performance of the lstm and the other two methods was limited in arid and semi arid areas of china this is likely to be a result of dryer regions being more heterogeneous salinas et al 2013 and this is difficult to accurately represent at the current resolution 0 1 of features in addition to achieving the highest accuracy the proposed lstm model has an advantage over the rti method that it can detect useful information from various predictors automatically this avoids the complicated threshold selection process in rti method additionally it does not need detailed discharge or water level observations for hydrological model development in ffg and is very suitable for ffw for ungauged or data sparse areas therefore we conclude that the lstm model is a valid and simple approach for large scale ffw 4 2 influence of predictors in this section we further test the influence of temporal and spatial predictors on the performance of the proposed lstm as shown in fig 6 the lstm considering both shf and ap outperformed the model only considering ap about 5 improvement was achieved by considering shf both in the training and testing periods in terms of different laps this can be expected as ap only describes the temporal change of precipitation before the flooded or non flooded date we did not consider the spatial variations between different sites when training the lstm model using only ap compared with the rti method see table 1 the lstm ap model provides better predictions when only rainfall data are used for model development this is mainly because the rti method only considers the cumulative rainfall over the past 7 days and the daily precipitation 1 day ahead whereas the lstm model automatically identifies useful information from a long time series of precipitation the lap describes the amount of ap information used for model development we found that the lap is a sensitive factor for the lstm model the csi of lstm ap and lstm ap shf ranged from 0 69 to 0 75 and 0 71 to 0 78 respectively in the testing period the performance of the lstm model improved as the lap increased and became stable when the lap was larger than 15 days this demonstrates that the occurrence of a flash flood is strongly determined by the past 15 days precipitation the best combination of predictors for this study ap shf and lap 25 was selected according to the highest csi value in the training period 4 3 influence on warning lead time providing an earlier warning can leave more time for decision makers to prepare for emergencies and react in this section we test the influence of different warning lead times on lstm model performance fig 7 shows the performance of the lstm based approach in terms of different warning lead times we found that model performance decayed quickly as the lead time increased the best lstm model was achieved with the highest csi of 0 86 in the testing period when the lead time was set to 0 days this reveals that the proposed lstm model is a promising tool for real time predictions to use this real time model to achieve earlier warnings decision makers need quantitative precipitation forecasts prior to the occurrence of flash flooding when the lead time was set to 1 day the lstm model provided accurate results with an hr of 0 84 and far of 0 09 in the testing period this demonstrates that the proposed lstm model provided a reliable warning 1 day ahead using the historical ap series and shfs the lstm model still had some degree of prediction capacity when the lead time was set to 2 days with a moderate performance for an hr of 0 66 and far of 0 21 this 2 day ahead warning will give decision makers more time to prepare flood mitigation and evacuation the csi was lower than 0 50 when the lead time was larger than 3 which demonstrates that we do not suggest using the model for a mid term ffw of more than 3 days 5 discussion a common problem in flood modelling is that the consistency and coverage of the hazard inventory remain inadequate cutter et al 2008 we now discuss the influence of taking a random split of all data samples on lstm model accuracy we regard the lstm model validated above as the base model to test the influence of random split samples on the model results we randomly selected training samples 30 times from the entire leaning samples and then trained 30 lstm models based on the different split subsets fig 8 a shows the pps given by the base model versus the pps from 30 lstm models trained by different splits of the data samples we found that the selection of training samples had a large impact on the model results and the hr performance ranged from 0 73 to 0 86 these results demonstrate that current learning samples may not have been sufficiently representative for training and testing therefore we suggest using ensemble results from several lstm models trained by different split training subsets to reduce the influence of small or unbalanced inventories on the ffw although advanced rainfall products are gradually released at the national scale the uncertainty of prediction is still high maggioni and massari 2018 sun et al 2018 and this will inevitably affect the warning performances we now analyse the influence of precipitation errors on the model results we generated 30 training subsets by randomly adding 20 bias to the series of ap series we then retrained 30 lstm models on the basis of the same samples with different biased ap series fig 6 b shows the pps given by the base model versus the pps from 30 lstm models trained by different biased ap series the hr ranges between 0 82 and 0 85 which demonstrates that the lstm model did not exacerbate the effect of precipitation errors on the ffw although some individual large error points exist in fig 8 b the proposed method provided a valuable ffw for decision makers even though the precipitation data were slightly disturbed 6 conclusions flash floods induced by intensive rainfall are widespread in mountainous and hilly areas in this study we proposed an lstm based approach for an ffw system on a large scale this approach can reliably predict the occurrence of flash floods 1 day ahead without using detailed water level or discharge observations we compared the proposed approach with two benchmarks ffg and rti methods for use in mountainous and hilly areas of china the good result of this study reveals that the proposed deep learning based approach can be used as one of candidate tools for large scale ffw the main conclusions are summarised as follows 1 the proposed lstm model outperformed rti and ffg methods in the study area with the highest csi of 0 76 and 0 77 in the training and testing periods respectively the ffg provided satisfactory performance with a csi of 0 71 in the testing period and the rti provided the lowest performance with a csi of 0 69 in the testing period 2 we tested the influence of various predictors on the lstm model performance the lstm model provides better results csi 0 75 than rti csi 0 69 when only the time series of ap is used for prediction the lstm model can be improved by considering spatial hydrological features in the model development stage the performance of the lstm model was found to become stable when the length of the ap series is greater than 15 days 3 the lstm model performance decayed quickly as the warning lead time increased the lstm model provided a reliable prediction 1 day ahead of the flash floods with an hr of 0 84 and far of 0 09 in the testing period its performance was moderate for prediction 2 days ahead and we do not suggest using the proposed approach for ffw of more than 3 days ahead 4 we discussed the influence of split samples and precipitation errors on model accuracy the lstm model demonstrated a moderate uncertainty hr from 0 73 to 0 86 when we used different split samples for training and we suggest using ensemble results for ffw in applications the performance of the lstm model varied little when different biased precipitations were used which demonstrates that it did not exacerbate the effect of precipitation uncertainty on the ffw this study has demonstrated the use of the proposed deep learning based approach in mountainous and hilly areas of china as the performances of deep learning model are highly depended on the representation of the training samples this approach may not be quite widely applicable to some areas such as tibetan plateau without sufficient flash flood records this study is a novel attempt to introduce an lstm model to ffw systems on a national scale based on daily rainfall series and spatial hydrological features at a resolution of 0 1 0 1 flash flooding exhibits significant heterogeneity over china because of the diverse hydro meteorological conditions that occur across the country zhai et al 2021a the current spatiotemporal resolution of the predictors and the fixed architecture of lstm makes it difficult to accurately capture various types of flash floods over the mountainous and hilly areas of china lovat et al 2019 zhai et al 2021b advanced satellite products are now able to provide high resolution spatiotemporal observations e g rainfall elevation vegetation with global coverage mccabe et al 2017 moreover other deep learning models such as convolutional neural networks and recurrent neural networks have shown advantages in processing temporal and spatial datasets for flood forecasting kratzert et al 2019 pham et al 2020 future efforts will explore the application of high resolution data and various deep learning models to ffw systems on a national scale 7 data availability the precipitation data is freely available at http data cma cn data cdcdetail datacode sevp cli chn merge cmp pre hour grid 0 10 html the data source of curve number is described at https doi org 10 1080 2150704x 2017 1297544 the adopted terrain data is the merit dem at http hydro iis u tokyo ac jp yamadai merit dem the flood inventory and official flash flood guide in china are obtained from the ministry of water resources in china http www mwr gov cn english credit authorship contribution statement gang zhao conceptualization methodology software writing original draft ronghua liu project administration supervision writing review editing mingxiang yang visualization software investigation tongbi tu validation supervision writing review editing meihong ma conceptualization writing original draft funding acquisition yang hong supervision writing review editing xiekang wang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments ronghua liu is supported by the national key research and development program of china 2019yfc1510605 meihong ma is supported by the national natural science foundation of china 42101086 and key research and development program of heibei province key technology research 19275403d mingxiang yang is supported by national natural science foundation of china u1865102 and open research fund of state key laboratory of simulation and regulation of water cycle in river basin skl2020ts01 tongbi tu is supported by the national natural science foundation of china 52109046 the national key research and development program of china 2021yfc3001000 and fundamental research funds for the central universities sun yat sen university 2021qntd15 we thank emmanouil anagnostou emad hasan and three reviewers for their helpful comments which significantly improved this paper we also thank maxine garcia phd from liwen bianji edanz group china www liwenbianji cn ac for editing the english text of a draft of this manuscript appendix 
3797,assessments of the regional terrestrial water variabilities are important for improving our knowledges of the complex hydroclimate system and providing scientific information in regional water resource management under a changing environment due to climate change and intensified human activities the aral sea basin has experienced a serious ecological crisis which is majorly caused by the water resources due to the excessive water utilization therefore in this study we examine the long term linear trend and variability of the terrestrial water cycle components based on multiple datasets over the aral sea basin during 2003 2016 the terrestrial water cycle components include precipitation evapotranspiration et terrestrial water storage anomaly twsa terrestrial water storage change twsc runoff r soil moisture sm and groundwater major results show that increased trends of the annual precipitation and et are observed during 2003 2016 for twsa gravity recovery and climate experiment grace derived datasets have significantly decreased trends with the values from 0 47 mm mon to 0 29 mm mon which reveal the serious terrestrial water depletion runoff soil moisture and groundwater have the decreasing linear trends derived from multiple datasets for the impacts of the climate factors on twsa and twsc precipitation is the main climate factor with the significantly positive impacts these results help us to have a better understanding of the complex hydrological process over the aral sea basin and provide a reliable scientific basic for police maker in the water resource management to achieve a sustainable development goal over the regions of the one belt and one road keywords aral sea basin terrestrial water component grace satellite dataset long term linear trend and variability influence of climate factors 1 introduction located in the heart of central asia aral sea basin consists of the drainage area of the two major rivers amu darya and syr darya which descend from the slopes of the tien shan mountains and the pamirs mountains they run through afghanistan tajikistan kyrgyzstan turkmenistan uzbekistan and kazakhstan micklin et al 2014 fao water report 2013 with the longest river syr darya and the largest lake aral sea in central asia the aral sea basin have the most surface water resources the volume about 1165 108 m3 over central asia in the upper reaches of aral sea basin tajikistan and kyrgyzstan have the richest surface water resource served as the central asia water tower which provides about 59 water resource for the five countries in the agriculture irrigation industrial and domestic water demand to support the livelihoods of more than 40 million of people in central asia deng et al 2010 deng and long 2011 with the rapide increase of the population from 15 million in 1960 to 46 million in 2006 sokolov 2009 the irrigated water use increased from 561 5 108 m3 in 1960 to 930 108 m3 in 2004 over the aral sea basin unece 2004 the average area and average volume of the aral sea were drastically shrank from the 66900 km2 and 1090 103 m3 in 1960 to the 36 500 km2 and 330 103 m3 in 1990 as splitting into large aral and small aral spoor 1998 nihoul et al 2004 usha 2016 these have resulted in a global ecological and social disaster the aral sea crisis which has directly and indirectly led to an array of severe problems in the aral sea basin such as desiccation of the aral sea and biodiversity degradation nihoul et al 2004 water food ecology energy problems ma et al 2021 su et al 2021 wu et al 2020 to save the aral sea many international organizations have been established among the five counties and the united nations to take huge of measures and actions and to reach agreements in reducing the water consumption and increasing the water inflow to the aral sea such as the interstate commission on water coordination icwc international fund for saving the aral sea ifas and the aral sea basin program asbp food and agriculture organization of the united nations fao water report 2013 in fact the key issue of the water resources in the aral sea basin is the sustainable management and development therefore it is necessary and urgent to explore the dynamic variations of the terrestrial water cycle components over the aral sea basin which will not only have a better understanding of the surface water cycle and complex hydrological process but also provide the sound knowledge and scientific information to achieve the sustainable development goal of the water resources addressing the dynamical variations of hydrological processes the terrestrial water variables are usually explored at the regional and global scales which include the terrestrial water storage anomaly twsa terrestrial water storage change twsc runoff soil moisture and groundwater rodell et al 2018 wang et al 2018 gu et al 2019 hu et al 2021a 2021b hu et al 2019 constrained by the in situ observations the spatial and temporal dynamical variations of the terrestrial water variables are analyzed by the satellite datasets e g grace gravity recovery and climate experiment and global hydrological models e g gldas global land data assimilation system rodell et al 2009 doll et al 2014 long et al 2017 scanlon et al 2018 according to the grace dataset and hydrological models the global endorheic system experienced a widespread water loss of about 106 3 gt yr 1 which is attributed to comparable losses in surface water soil moisture and groundwater wang et al 2018 moreover the global models underestimate the large decadal declining and rising water storage trends relative to grace satellite data which is caused by the failure simulation about the complex hydrological processes by the models the global soil moisture drying is quantified from the human activities gu et al 2019 and the complex partitioning of the water cycle by the surface soil moisture storage layer contributes to the lower groundwater storage over arid regions mccoll et al 2017 although the low spatial resolution of grace it can monitor the recent temporal dynamics of groundwater depletion and related water abstractions doll et al 2014 in this study to detect the dynamics of the terrestrial water and to have a better understand the complex hydrological processes over the aral sea basin the follow questions should be addressed 1 whether there exists the depletion tendency of the terrestrial water resources over the aral sea basin since the 21st century 2 what are the spatial differences of the terrestrial water resources and 3 what are the major climate factors influencing on the terrestrial water components to address the above questions comprehensively our objectives focus on 1 exploring the long term linear trend and temporal variabilities of the twsa twsc runoff soil moisture and groundwater 2 analyzing the spatial patterns of the terrestrial water resources and 3 detecting the relationships between the climate factors and the terrestrial water components in order to decrease the uncertainty of the main results obtained by one source dataset multiple datasets including the satellite products gldas and global hydrological model are employed 2 study area dataset and methodology 2 1 study area the aral sea basin with the total area more than 1 6 million km2 is a transboundary river basin at the heart of the eurasian continent consisting of the drainage area of the two major rivers amu darya and syr darya and geographically covers the territory of tajikistan uzbekistan major part of turkmenistan part of kyrgyzstan southern part of kazakhstan and northern part of afghanistan fig 1 the territory can be divided to three main zones on the conditions of formation and transformation of the surface flow in the region 1 zone where the flow is formed area of feeding in mountainous regions high mountains of the tien shan and pamir ranges 2 zone of transit and dispersion of flow and 3 delta zones http www cawater info net aral water e htm characterized with the arid and semi arid climate the average temperatures of aral sea basin range from 0 4 c in january and 28 32 c in july murray rust et al 2003 annual precipitation in the lowlands and valleys is between 80 and 200 mm concentrated in the winter and spring while on the foothills precipitation is between 300 and 400 mm and the largest precipitation with the value between 600 and 800 mm appears on the southern and southwestern sides of the mountain http www cawater info net aral water e htm water resources of the aral sea basin are formed in surface and underground sources and glaciers surface waters are mainly concentrated in the basins of the two main rivers of the region amu darya and syr darya fig 1 originating among the glaciers and snowfields of the pamir mountains of tajikistan kyrgyzstan and afghanistan amu darya is the largest river in central asia its length from the headwater of the river pyandzh is 2540 km and the area of basin is 309 thousand square km syr darya is the second on water content and the greatest on length river of central asia it is formed by confluence of naryn and kara darya in east part of fergana valley the length of the river from the headstream of the naryn is 3 019 km and the basin area is 219 thousand square km http www cawater info net aral water e htm the glacier deposits located in the mountainous areas of central asia and kazakhstan are the most important sources and longstanding reserve of clean fresh water producing melted water in the hottest time of the year when the supply of seasonal snow is nearly exhausted they compensate the deficit of irrigation water in time of the highest demand http ec ifas waterunites ca org aral basin 66 the aral sea basin html pritchard 2019 glaciers in tajikistan and kyrgyzstan play an important role in forming of amudarya and syrdarya rivers which are the largest water arteries of the aral sea basin the groundwater is composted the third component of water resources in the aral sea basin with the approved regional deposits of 31 17 km3 an important role in the hydrogeology of the aral sea basin is played by groundwater which saturates alluvial sediments in the valleys and which is adopted to channel terrace and delta deposits in the desert plain areas where salinized groundwater prevails filtration of alluvial water creates desalted zones which can be several kilometers wide http www cawater info net aral groundwater e htm 2 2 datasets the datasets used in this study include the climate factor datasets and the terrestrial water components datasets constrained by the limited observed record in aral sea basin the temperature and precipitation of climatic research unit dataset cru are employed which have high performance against the meteorological data based on some previous studies hu et al 2014 2016 2017 chen et al 2018 the evapotranspiration et data is sourced from 1 et zhang with the spatial resolution of 0 08 0 08 during 1982 2013 2 global land data assimilation system gldas noah 2 1 hereafter noah 2 1 with the spatial resolution of 1 1 during 2000 2017 and 3 global land evaporation amsterdam model gleam 3 3a with the spatial resolution of 0 5 0 5 during 1980 2018 table 1 in this study the terrestrial water storage anomaly twsa terrestrial water storage change twsc runoff soil moisture and groundwater are selected as the terrestrial water components twsa and twsc data are derived from the release 5 rl05 dataset of the monthly grace tellus level 3 products of the centre for space research csr the geoforschungszentrum gfz the jet propulsion laboratory jpl csr grace rl05 mascons hereafter csr mascon and grctellus jpl rl06 mascons hereafter jpl mascon the runoff datasets include the noah 2 1 data with the spatial resolution of 1 1 during 2000 2017 climate data record cdr data with the spatial resolution of 0 5 0 5 during 1984 2010 and global runoff reconstruction grun data based on some previous literatures gu et al 2019 hu et al 2019 2021a 2021b gldas noah 2 1 can represent the soil moisture variations over globe and central asia then the soil moisture is employed from the gldas noah 2 1 for the groundwater datasets until now there exist limited groundwater observation wells across the aral sea basin which results in the impossible to use the observed groundwater in analyzing the groundwater variations therefore to address this issue the groundwater data used in this study is from the water global assessment and prognosis water gap global hydrology model wghm 2 2 a doll et al 2014 the details of the datasets are demonstrated in the text s1 of the supplementary materials 2 3 methodology 2 3 1 seasonal decomposition of time series by loess seasonal trend decomposition based on the loess stl filtering method was utilized for the time series analysis stl is a filtering procedure for decomposing a time series which decomposes the time series into three components as follows s total s long term s seasonal s residual where the original signal stotal is decomposed into long term seasonal and residual components based on procedures outlined in previous studies cleveland et al 1990 humphrey et al 2016 scanlon et al 2018 hu et al 2021a the long term signal can further be decomposed into linear and non linear interannual components by fitting a trend using least squares linear regression and attributing the remaining long term signal to interannual signal the residuals reflect subseasonal signal and noise therefore in this study we only focus on the long term trends which refer to the linear trends estimated from the long term signal of the monthly hydroclimate variables after stl analysis as defined in previous studies scanlon et al 2018 hu et al 2021a the significance of the linear trends is tested by the studenet s test at the 95 or 99 confidence level p 0 05 or p 0 01 since the multiple datasets have different periods the long term components and the corresponding long term trends of the monthly variables are computed during the period of 2003 2016 if the periods of the monthly variables do not cover the above period the long term components are computed from the start year of 2003 to the end year of their own end years for example the long term component and long term trend of et zhang are obtained by the stl approach during 2003 2013 it should be noted that the long term trends are obtained from the long term components of the monthly datasets after stl analysis for the annual data the linear trend is computed using the linear least square method directly 2 3 2 intra annual variation analysis of the hydroclimate variables intra annual values are averaged the multi annual monthly data which display the variabilities among different months to compare with the intra annual variations of the same variables from different datasets the intra annual values are computed from 2003 to 2016 if the data is available for a hydroclimate variable if the different datasets have different periods the intra annual values are based on the short period starting from 2003 for example for the et variable the intra annual values are computed from 2003 to 2013 although et zhang noah 2 1 and gleam 3 3a have the different periods table 1 3 result in this section the major results of the dynamical variabilities of the hydrological process and relationships between the terrestrial water cycle components and the climate factors are displayed over aral sea basin for a better understanding the hydrological process the climate backgrounds over aral sea basin during the period of 1901 2016 are analyzed the long term trends and variabilities of the water components are explored using the stl approach in the end the water budget is discussed using the ensemble variables i e p et and r and grace dataset which can reveal the spatial characteristics of the water resources and provide important scientific information for the water resource management over aral sea basin to investigate the roles of the climate factors temperature precipitation and evapotranspiration on the terrestrial water components the correlations between the climate factors and the terrestrial water components are measured by the correlation coefficient cc values which are tested by the student s t test at the 95 confidence level for each factor the ensemble data is averaged from all the datasets when there are mor than one dataset moreover the time lag cc values are computed from lag 0 to lag 11 to explore the time lag responses of the terrestrial water components to the variations of the climate factors 3 1 long term linear trends and variabilities of twsa as the depletion of twsa over central asia hu et al 2019 significantly twsa depletion of the aral sea basin is observed from the negative trends of the five grace datasets csr gfz jpl csr mascon and jpl mascon with the rates of 0 47 mm month 0 31 mm month 0 45 mm month 0 38 mm month and 0 29 mm month respectively fig 2 a the five datasets have the same temporal variabilities with a sharp decreasing from jun 2005 to jun 2014 and then appearing the increasing tendency till 2016 for the intra annual variabilities the spring months i e march to may have the largest twsa values and the twsa is decreased from the largest twsa at april to the smallest twsa at october the autumn i e september to november has the smallest negative twsa value among the four seasons which indicates the water depletion over the aral sea basin fig 2b moreover compared with the intra annual variability of precipitation twsa obviously has a lag 1 month than the precipitation variations such as the largest values of precipitation at march and twsa at april and the smallest values of precipitation at september and twsa at october fig s2b fig 2b for the spatial distributions of the long term linear trends of twsa except jpl mascon all the datasets show the same negative spatial patterns which indicates the water resource depletion over the aral sea basin especially the depletion center over the surrounding regions of aral sea and the turan plain fig 3 a 3d csr and csr mascon have the significant negative trends over all the aral sea basin and the significant negative trends of gfz and jpl are distributed over more than 91 areas for jpl mascon the areas of the significant negative trends account for 76 3 of the aral sea basin and the depletion centers appear at fergana valley and part of north aral sea basin fig 3e 3 2 long term linear trends and variabilities of twsc to have a further understanding the dynamical variations of twsa the long term linear trends and variabilities of twsc defined as the difference between the two consecutive months of twsa are investigated in fig 4 and fig 5 during 2003 2016 the long term components of the five grace datasets have large fluctuations with an obvious decreasing from 2003 to 2008 a periodic fluctuation from 2008 to 2013 and then having an increasing tendency till 2016 fig 4a for the intra annual variabilities twsc is decreased from the largest positive value at february to the smallest negative value at august and then appearing an increasing tendency fig 4b which are fitting the twsa variations fig 2a for the spatial distributions of long term linear trends csr gfz jpl and csr mascon have the similar patterns with the positive trends along the syr darya and the negative trends along the amu darya fig 5a 5d among the four datasets gfz has the largest areas with the significant positive trends over the north of the aral sea basin i e part of kazakhstan in the aral sea basin accounting for 22 22 areas fig 5b followed by jpl with 18 52 areas across the north syr darya fig 5c and the significant positive areas of csr and csr mascon is only less than 5 fig 5a 5d for the significant negative trends gfz also has the largest areas accounting for 28 89 of the aral sea basin followed by jpl 28 15 both distributed in the arm darya and the area percentages of csr and csr mascon are 14 07 and 25 19 for the last dataset jpl mascon it displays the positive trends over most part of the study area with the 51 85 significant areas mostly distributed over the aral sea and turan plain and the significant negative trend areas only account for 5 93 over the north afghanistan fig 5e 3 3 long term linear trends and variabilities of runoff in this section three datasets including noah 2 1 cdr and grun are employed to investigate the long term linear trends and variabilities of runoff across the aral sea basin the long term components of noah 2 1 have remarkable fluctuations during 2003 2016 with a significant decreasing in the period of january 2003 may 2008 k 0 06 mm month p 0 01 and r2 0 43 and a significant increasing from june 2008 to december 2016 k 0 03 mm month p 0 01 and r2 0 36 fig 6 a a sharp significant decrease trend of cdr is observed with the rate of 0 06 mm month during 2003 2010 p 0 01 r2 0 69 compared with cdr the temporal variations of grun are more similar with noah 2 1 and the significant negative trend is 0 01 mm month at the 99 confidence level p 0 01 r2 0 12 during 2003 2014 fig 6a for the intra annual variabilities of noah 2 1 and cdr the long term components are increased from january to the peak value in april and followed a decrease till december fig 6b the peak value of grun appears at may which is a lag 1 month compared with noah 2 1 and cdr for the spatial distributions of the long term linear trends of noah 2 1 31 85 areas have the significant positive trends mainly distributed over the upper reaches of syr darya and amu darya and part of turan plain and the significant negative areas account for 48 89 which are majorly distributed over the middle and lower reaches of the two rivers fig 7 a for cdr 76 3 areas have the significant negative trends with the negative centers over the fergana valley regions and the significant positive trends account for 14 07 areas during 2003 2010 fig 7b except the smaller negative trend centers the spatial distributions of grun during 2003 2014 and 2003 2010 are similar as cdr with the significant negative areas accounting for 64 44 and 78 52 fig 7 c and 7e for noah 2 1 in 2003 2010 the areas with positive areas in 2003 2016 become into the negative trend areas and the significant negative areas account for 69 63 fig 7d the differences of the long term linear trends of the runoff obtained from the different datasets are majorly determined by the different model structure and model input datasets which are same as the factors in the differences among grace global hydrological model and land surface model discussed in hu et al 2021a 3 4 long term linear trends and variabilities of soil moisture and groundwater for the soil moisture a significant negative trend k 0 09 mm month p 0 01 r2 0 1 is obtained from the long term components of noah 2 1 fig s6a the monthly soil moisture is increased from january to the peak value at april followed by the decrease to september and increasing to december fig s6b moreover the spring months have the largest soil moisture which is same as twsa and one month is delayed the precipitation the smallest soil moisture appears from august september and october which has one month lag the precipitation i e from july to september and is one month advance the twsa i e from september to november figs s2b and 2b for the spatial distributions of the long term linear trends the positive trends account for 25 19 areas mainly distributed at the upper reaches of the syr darya and amu darya e g fergana valley fig s7 the significant negative trends with the area percentage of 57 04 mainly appear over the middle reaches and the regions surrounding the aral sea according to the wghm 2 2 groundwater long term component has the significant decreasing trend with the rate of 0 003 mm month at the 95 confidence level p 0 05 during 2003 2014 for the period of january 2003 to may 2008 a significant decreasing is detected with the rate of 0 037 mm month p 0 05 r2 0 81 and an increase tendency is observed with the rate of 0 024 mm month p 0 05 r2 0 72 fig s8a the temporal variations of the wghm 2 2 groundwater are same to the precipitation of the three gridded datasets cru ts v4 01 global precipitation climatology centre gpcc v8 and trmm 3b43 fig s2a and the noah 2 1 runoff fig 6a which illustrates that the groundwater over the aral sea basin is highly correlated with the precipitation and runoff for the intra annual variability the wghm 2 2 groundwater is increased from january to the peak value at march and decreased to the smallest value at september and increased till december fig s8b which fits the variations of the precipitation soil moisture and twsa figs s2b 2b and s6b the long term linear trends of the monthly wghm 2 2 groundwater have the 28 89 areas with the significant positive rates mainly distributed over the north afghanistan and large part of turan plain and 45 19 areas with the significant negative rates across the syr darya and part of center of the aral sea basin fig s9 3 5 the impacts of the climate factors on twsa and twsc the climate factors have positive roles on the twsa variations from the positive cc values in fig 8 in particularly the cc values between em t and em twsa from lag 0 to lag 11 are similar with the average value of 0 31 which indicates that the positive impacts of the temperature on the twsa are same across the whole year fig 8a and 8d for the spatial distributions of the lag 2 cc values except the negative values over the south and south east of the aral sea basin the other regions have the significant positive lag 2 cc values between em t and em twsa that suggests the twsa is positively correlated with the temperature fig 9 a the positive impacts of the precipitation are obviously observed from the similar variations between the precipitation and twsa fig 8b it has an increased cc values from lag 0 with the value of 0 18 to lag 8 with the largest value of 0 61 and the residual cc values are about 0 59 which indicates that these impacts of the precipitation are persistent across the whole year fig 8d the significant positive lag 8 cc values are distributed over the whole basin fig 9b the increased et over the aral sea basin is mainly caused by the increased temperature and precipitation fig s1 which is consistent with the conclusion in hu et al 2019 therefore em twsa is positively correlated with the em et which is obtained from the similar variations as the em et and the positive cc values fig 8c and 8d the lag n n 0 1 11 cc values between em et and em twsa are same as these between em p and em twsa with the first largest value of 0 56 at lag 8 which suggests that the positive impacts of the et on the twsa is also persistent though the whole year the distributions of the lag 8 cc values are same as the values between the em p and em twsa except some negative values in fragment areas from fig 9c since the twsc is the change of twsa the roles of the climate factors on the twsc are related to the roles on the twsa the cc values between em t and em twsc are from positive to negative at lag 3 and keep the negative values till to lag 11 fig 10 a 10d most areas have the positive cc values with the significant values at the north and center aral sea basin fig 11 a the precipitation and et have the persistent significant positive roles on the twsc with the values larger than 0 3 from lag 0 to lag 11 fig 10b 10c and 10d the positive cc values at lag 7 and lag 3 for em p and em et are distributed over the aral sea basin as twsa fig 11b 11c according to the latest study hu et al 2021a central asia has a complex terrestrial water component circulation the effects of climate factors on twsa have time lags for temperature increased temperatures lead to accelerated snow melting and glacier retreat which result in terrestrial water storage depletions throughout central asia brun et al 2017 yang et al 2017 wang et al 2018 for precipitation it needs time for the increased precipitation transformed into the soil moisture groundwater snow ice and glacier et is majorly controlled by temperature and precipitation its lagged impacts on the twsa and twsc are determined by temperature and precipitation therefore the climate factors have the lagged effects on twsa and twsc for the attributed factors of the terrestrial water storage variations recent researches indicates that the terrestrial water storage depletion in central asia has largely been impacted by the combination of climate factors and intensified human activities especially in the aral sea basin deng and chen 2017 hu et al 2021a su et al 2021 therefore the control factors of the twsa and twsc should have a further investigation 3 6 the impacts of the climate factors on soil moisture runoff and groundwater to further investigate the impacts of the climate factors on the water circulation components in this section we analyze the roles of the temperature precipitation and et on the inter annual variations of the runoff soil moisture and groundwater the three climate factors have positive impacts on the inter annual variations of the soil moisture fig 12 specifically the impacts of the temperature on the soil moisture are decreased with the increasing of the time lags precipitation has the significantly positive impacts on the soil moisture variations with these strong persistent positive impacts across the whole year cc values larger than 0 58 fig 12b and 12d obviously due to the relationship between precipitation and et the et also has the significantly positive impacts on the inter annual variations of soil moisture which are persistent during the whole year fig 12c and 12d the largest time lag cc values of the three climate factors with soil moisture are lag 0 lag 5 and lag 3 for temperature precipitation and et respectively fig 12d the spatial distributions show that almost all the aral sea basin has the significantly positive cc values for the temperature precipitation and et fig 13 for the runoff temperature has no relationship with the inter annual variations which can be obtained from the small cc values figs s10a and s10d while the inter annual variations of the runoff are highly agreement with the precipitation and et with the large positive cc values figs s10b s10c and s10d for the spatial distributions of the largest time lag cc values almost all the areas have the significantly positive values for precipitation and et except the temperature fig s11 there is also no obvious impact of the temperature on the inter annual variations of groundwater as on the runoff fig s10a and fig s12a although the time lag cc values are negative fig s12d as the positive impacts on the soil moisture and runoff the precipitation and et have significantly positive impacts on the inter annual variations of groundwater with these persistent impacts across the whole year figs s12b s12c and s12d most areas show the significantly negative cc values for the temperature in fig s13a for the largest time lag cc values in lag 5 of precipitation and et the significantly positive cc values are distributed over most areas of the aral sea basin except the significantly negative values over some north and south part of this basin for et figs s13b and s13c 4 discussion 4 1 comparison of the long term trends of climatic and hydrological variables of four river lake basins over central asia in this section the long term trends of the hydrological variables over aral sea basin are compared with these of the other three river lake basins over central asia during 2003 2016 they include balkhash lake basin balkhash issyk kul lake basin issyk kul tarrim river basin tarrim and the climatic and hydrological variables are temperature t precipitation p evapotranspiration et terrestrial water storage anomaly twsa runoff and soil moisture sm each of these variables are averaged from the different sources at the same period table s1 the long term trends are based on the long term time series derived from the stl method firstly the climatic backgrounds of the four basins are compared all the four basins have been experienced significant warm trends at a 99 confidence level with the largest value of 0 12 c decade at issyk kul lake basin followed by tarrim river basin 0 1 c decade balkhash lake basin 0 08 c decade and aral sea basin 0 06 c decade table 2 for precipitation two significant increasing trends are observed for balkhash lake basin 0 037 mm month and issyk kul lake basin 0 018 mm month at the 99 and 95 confidence levels respectively aral sea basin has a weak increasing trend and tarrim river basin has a weak decreasing trend compared with the et trend of the other basins aral sea basin has the significant positive trend of 0 008 mm month which is the smallest table 2 for the hydrological variables aral sea basin has the largest water depletion with the t3wsa trend value of 0 38 mm month than the other basins followed by issyk kul lake basin 0 19 mm month and balkhash lake basin 0 08 mm month during 2003 2016 the negative twsa trend of tarrim river basin is weak which indicates the small water depletion for the runoff changes significant negative trends are obtained at a 99 confidence level over the four basins with the value of 0 007 mm month 0 006 mm month 0 024 mm month and 0 017 mm month for aral sea basin balkhash lake basin issyk kul lake basin and tarrim river basin respectively for soil moisture only aral sea basin has the significant negative trend 0 09 mm month at a 99 confidence level and the other basins have the significant positive trends with the largest trend over tarrim river basin 0 28 mm month table 2 for the relationships between the climate variables and the hydrological variables the climate changes have large contributions to the terrestrial water depletion over the aral sea basin human activities also have serious impacts on the water resources such as the aral sea shrinking deng et al 2010 for the other basins the decreasing twsa and runoff are caused by the climate variations however for soil moisture it is the significant increasing trend which may be caused by the ice and snow melting over the surrounding mountainous areas hu et al 2019 moreover we explore the variations of the climatic and hydrological variables over casnw i e including the five states of central asia and the northwest of china significant increasing trends of temperature and precipitation are obtained and et has a remarkable increasing trend for the three hydrological variables twsa and runoff are significantly decreased with values of 0 25 mm month and 0 005 mm month at a 99 confidence level a weak decreasing trend is observed for soil moisture 4 2 assessments of the water budget of aral sea basin quantifying the water budget or water balance is essential for improving our understanding of the coupled hydrological system including the characteristics of key water and energy components and the comprehensive picture of how the water cycle is changing sahoo et al 2011 munier and aires 2018 according to the water balance of a closed basin sahoo et al 2011 yang et al 2015 xie et al 2019 twsc for a given basin are obtained as twsc p et r which is noted as twscp et r twsc derived from grace data is assumed as the difference of twsa in two successive months that is noted as twscgrace in this study the differences between p et r and the twsc derived from grace dataset are explored to display the water budget variations over the aral sea basin since no dataset can be considered as perfect different available datasets within water budget experiments should be combined lorenz et al 2014 munier and aires 2018 xie et al 2019 the precipitation data used in the water balance is ensemble mean from the cru ts v4 01 gpcc v8 and trmm 3b43 during 2003 2016 et data is the ensemble mean from the et zhang noah 2 1 and gleam 3 3a runoff data is the ensemble mean from the noah 2 1 cdr and grun the twsc data is computed from the ensemble mean of five twsa dataset derived from the five grace datasets there are favorable agreements between the grace derived and water flux derived twsc fig s16 the correlation coefficient cc between twscgrace and twscp et r is 0 69 with p 0 001 which is similar with the result in tarrim river basin as documented in yang et al 2015 this indicates that twsc derived from grace corresponds well with the water flux derived twsc from precipitation et and runoff and water balance in the aria sea basin can be closed potentially using grace twsc and water flux p et r the absolute error ae value is 2 86 mm indicating an overestimation of the grace twsc compared with the water flux p et r the root mean square error rmse value is 17 04 mm the positive ae is caused by the underestimated precipitation of the aria sea basin from cru gpcc and trmm datasets hu et al 2016 2018 the large uncertainties of the terrestrial water budget components precipitation et groundwater and runoff from grace gldas and the other water flux data result in the mismatch between twscgrace and twscp et r yang et al 2015 munier and aires 2018 overall grace and the other water flux datasets used in our study can be used in water balance analysis over the aria sea basin to have a further assessment and comprehensive exploration of the water balance for each water budget components and water cycle parameters new datasets from in situ or remote sensing observations or a combination of both and from hydrological models or reanalysis datasets are needed especially for the groundwater and runoff 5 conclusion assessments of the terrestrial water component variations are important for strengthening our knowledges of the complex hydroclimatic system such as understanding the characteristics of the water cycle components improving our predictions of weather and climate and providing significant information in the management and utilization of the regional water resource in a changing environment due to climate change and intensified human activities the aral sea basin has been experiencing a series of serious ecological issues which are majorly caused by the scare water resources therefore in this study we explored the long term linear trend and variability of the terrestrial water cycle components using multiple datasets and analyzed the impacts of the climate factors on the terrestrial water cycle components major results are concluded as follows 1 in 1901 2016 increasing trends of the annual precipitation from cru gpcc v8 and trmm 3b43 are observed over the aral sea basin at different periods which is consistent with the precipitation variation over central asia the annual et has the larger trend than precipitation at the same period especially at 2003 2016 except et zhang after the stl decomposition the three datasets have the similar variations of long term components with a significant decreasing in jau 2003 feb 2008 and a remarkable increased trend during mar 2008 dec 2016 for the intra annual variability most part of precipitation appears from nov to may and very small precipitation are in jul aug and sep 2 for twsa the five grace derived datasets have the consistent significant decreasing trends with the values from 0 58 mm yr to 0 36 mm yr which indicates the serious terrestrial water depletion during 2003 2016 after removing the seasonal effects the long term components have significant decreasing trends the monthly twsa has the largest positive values in spring i e from mar to may and the smallest values in autumn i e from sep to oct which are consistent with the precipitation variations moreover one month time lag of twsa is observed comparing with precipitation which indicates the time lag impacts of precipitation on the terrestrial water resources over the aria sea basin 3 runoff soil moisture and groundwater have the decreasing long term component trends derived from multiple datasets the intra annual variabilities of soil moisture and groundwater are similar with twsa and precipitation 4 precipitation is the major impacted climate factor on the inter annual variations of the terrestrial water cycle components twsa twsc soil moisture runoff and groundwater the influences of et on the terrestrial water cycle components are factually based on the precipitation 5 compared with the other major basins over central asia i e balkhash lake basin issyk kul lake basin and tarrim river basin during 2003 2016 the aria sea basin has the most serious terrestrial water depletion with the largest depletion trend of twsa which has been caused by the intensify human activities such as huge irrigation 6 the grace derived twsc has the potential application in the water budget analysis over the aral sea basin which helps us have a better understanding the complex hydrological circulation overall serious water depletion of aral sea basin is observed according to the results of terrestrial water cycle components which can provide significant information for the water resource management in order to deeply explore the complex hydrological system more datasets and further analysis should be employed such as the in situ measurements of groundwater and et and the study in detecting the factors contributing to the terrestrial water variations credit authorship contribution statement zengyun hu conceptualization data curation formal analysis xi chen conceptualization data curation formal analysis qiming zhou conceptualization formal analysis gang yin data curation formal analysis jun liu data curation formal analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the strategic priority research program of chinese academy of sciences pan third pole environment study for a green silk road pan tpexda20060303 the western scholars of the chinese academy of sciences 2020 xbqnxz 010 national natural science foundation of p r china e1190301 41971386 general research fund hkbu 12301820 grace data is from https grace jpl nasa gov data get data global hydrological model data pcr wghm 2 2 are downloaded from https surfdrive surf nl files index php s kbgl5xyzudpviht and https hessenbox a10 rz uni frankfurt de dl fi5edqjrumuyp9bx6vahohbm totalwaterstorage wg2 2c wfdei gpcc 1958 2014 monthly nc4 noah data from gldas 1 and gldas 2 1 are downloaded from https search earthdata nasa gov cru ts v 4 01 is from https crudata uea ac uk cru data hrg appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 127270 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3797,assessments of the regional terrestrial water variabilities are important for improving our knowledges of the complex hydroclimate system and providing scientific information in regional water resource management under a changing environment due to climate change and intensified human activities the aral sea basin has experienced a serious ecological crisis which is majorly caused by the water resources due to the excessive water utilization therefore in this study we examine the long term linear trend and variability of the terrestrial water cycle components based on multiple datasets over the aral sea basin during 2003 2016 the terrestrial water cycle components include precipitation evapotranspiration et terrestrial water storage anomaly twsa terrestrial water storage change twsc runoff r soil moisture sm and groundwater major results show that increased trends of the annual precipitation and et are observed during 2003 2016 for twsa gravity recovery and climate experiment grace derived datasets have significantly decreased trends with the values from 0 47 mm mon to 0 29 mm mon which reveal the serious terrestrial water depletion runoff soil moisture and groundwater have the decreasing linear trends derived from multiple datasets for the impacts of the climate factors on twsa and twsc precipitation is the main climate factor with the significantly positive impacts these results help us to have a better understanding of the complex hydrological process over the aral sea basin and provide a reliable scientific basic for police maker in the water resource management to achieve a sustainable development goal over the regions of the one belt and one road keywords aral sea basin terrestrial water component grace satellite dataset long term linear trend and variability influence of climate factors 1 introduction located in the heart of central asia aral sea basin consists of the drainage area of the two major rivers amu darya and syr darya which descend from the slopes of the tien shan mountains and the pamirs mountains they run through afghanistan tajikistan kyrgyzstan turkmenistan uzbekistan and kazakhstan micklin et al 2014 fao water report 2013 with the longest river syr darya and the largest lake aral sea in central asia the aral sea basin have the most surface water resources the volume about 1165 108 m3 over central asia in the upper reaches of aral sea basin tajikistan and kyrgyzstan have the richest surface water resource served as the central asia water tower which provides about 59 water resource for the five countries in the agriculture irrigation industrial and domestic water demand to support the livelihoods of more than 40 million of people in central asia deng et al 2010 deng and long 2011 with the rapide increase of the population from 15 million in 1960 to 46 million in 2006 sokolov 2009 the irrigated water use increased from 561 5 108 m3 in 1960 to 930 108 m3 in 2004 over the aral sea basin unece 2004 the average area and average volume of the aral sea were drastically shrank from the 66900 km2 and 1090 103 m3 in 1960 to the 36 500 km2 and 330 103 m3 in 1990 as splitting into large aral and small aral spoor 1998 nihoul et al 2004 usha 2016 these have resulted in a global ecological and social disaster the aral sea crisis which has directly and indirectly led to an array of severe problems in the aral sea basin such as desiccation of the aral sea and biodiversity degradation nihoul et al 2004 water food ecology energy problems ma et al 2021 su et al 2021 wu et al 2020 to save the aral sea many international organizations have been established among the five counties and the united nations to take huge of measures and actions and to reach agreements in reducing the water consumption and increasing the water inflow to the aral sea such as the interstate commission on water coordination icwc international fund for saving the aral sea ifas and the aral sea basin program asbp food and agriculture organization of the united nations fao water report 2013 in fact the key issue of the water resources in the aral sea basin is the sustainable management and development therefore it is necessary and urgent to explore the dynamic variations of the terrestrial water cycle components over the aral sea basin which will not only have a better understanding of the surface water cycle and complex hydrological process but also provide the sound knowledge and scientific information to achieve the sustainable development goal of the water resources addressing the dynamical variations of hydrological processes the terrestrial water variables are usually explored at the regional and global scales which include the terrestrial water storage anomaly twsa terrestrial water storage change twsc runoff soil moisture and groundwater rodell et al 2018 wang et al 2018 gu et al 2019 hu et al 2021a 2021b hu et al 2019 constrained by the in situ observations the spatial and temporal dynamical variations of the terrestrial water variables are analyzed by the satellite datasets e g grace gravity recovery and climate experiment and global hydrological models e g gldas global land data assimilation system rodell et al 2009 doll et al 2014 long et al 2017 scanlon et al 2018 according to the grace dataset and hydrological models the global endorheic system experienced a widespread water loss of about 106 3 gt yr 1 which is attributed to comparable losses in surface water soil moisture and groundwater wang et al 2018 moreover the global models underestimate the large decadal declining and rising water storage trends relative to grace satellite data which is caused by the failure simulation about the complex hydrological processes by the models the global soil moisture drying is quantified from the human activities gu et al 2019 and the complex partitioning of the water cycle by the surface soil moisture storage layer contributes to the lower groundwater storage over arid regions mccoll et al 2017 although the low spatial resolution of grace it can monitor the recent temporal dynamics of groundwater depletion and related water abstractions doll et al 2014 in this study to detect the dynamics of the terrestrial water and to have a better understand the complex hydrological processes over the aral sea basin the follow questions should be addressed 1 whether there exists the depletion tendency of the terrestrial water resources over the aral sea basin since the 21st century 2 what are the spatial differences of the terrestrial water resources and 3 what are the major climate factors influencing on the terrestrial water components to address the above questions comprehensively our objectives focus on 1 exploring the long term linear trend and temporal variabilities of the twsa twsc runoff soil moisture and groundwater 2 analyzing the spatial patterns of the terrestrial water resources and 3 detecting the relationships between the climate factors and the terrestrial water components in order to decrease the uncertainty of the main results obtained by one source dataset multiple datasets including the satellite products gldas and global hydrological model are employed 2 study area dataset and methodology 2 1 study area the aral sea basin with the total area more than 1 6 million km2 is a transboundary river basin at the heart of the eurasian continent consisting of the drainage area of the two major rivers amu darya and syr darya and geographically covers the territory of tajikistan uzbekistan major part of turkmenistan part of kyrgyzstan southern part of kazakhstan and northern part of afghanistan fig 1 the territory can be divided to three main zones on the conditions of formation and transformation of the surface flow in the region 1 zone where the flow is formed area of feeding in mountainous regions high mountains of the tien shan and pamir ranges 2 zone of transit and dispersion of flow and 3 delta zones http www cawater info net aral water e htm characterized with the arid and semi arid climate the average temperatures of aral sea basin range from 0 4 c in january and 28 32 c in july murray rust et al 2003 annual precipitation in the lowlands and valleys is between 80 and 200 mm concentrated in the winter and spring while on the foothills precipitation is between 300 and 400 mm and the largest precipitation with the value between 600 and 800 mm appears on the southern and southwestern sides of the mountain http www cawater info net aral water e htm water resources of the aral sea basin are formed in surface and underground sources and glaciers surface waters are mainly concentrated in the basins of the two main rivers of the region amu darya and syr darya fig 1 originating among the glaciers and snowfields of the pamir mountains of tajikistan kyrgyzstan and afghanistan amu darya is the largest river in central asia its length from the headwater of the river pyandzh is 2540 km and the area of basin is 309 thousand square km syr darya is the second on water content and the greatest on length river of central asia it is formed by confluence of naryn and kara darya in east part of fergana valley the length of the river from the headstream of the naryn is 3 019 km and the basin area is 219 thousand square km http www cawater info net aral water e htm the glacier deposits located in the mountainous areas of central asia and kazakhstan are the most important sources and longstanding reserve of clean fresh water producing melted water in the hottest time of the year when the supply of seasonal snow is nearly exhausted they compensate the deficit of irrigation water in time of the highest demand http ec ifas waterunites ca org aral basin 66 the aral sea basin html pritchard 2019 glaciers in tajikistan and kyrgyzstan play an important role in forming of amudarya and syrdarya rivers which are the largest water arteries of the aral sea basin the groundwater is composted the third component of water resources in the aral sea basin with the approved regional deposits of 31 17 km3 an important role in the hydrogeology of the aral sea basin is played by groundwater which saturates alluvial sediments in the valleys and which is adopted to channel terrace and delta deposits in the desert plain areas where salinized groundwater prevails filtration of alluvial water creates desalted zones which can be several kilometers wide http www cawater info net aral groundwater e htm 2 2 datasets the datasets used in this study include the climate factor datasets and the terrestrial water components datasets constrained by the limited observed record in aral sea basin the temperature and precipitation of climatic research unit dataset cru are employed which have high performance against the meteorological data based on some previous studies hu et al 2014 2016 2017 chen et al 2018 the evapotranspiration et data is sourced from 1 et zhang with the spatial resolution of 0 08 0 08 during 1982 2013 2 global land data assimilation system gldas noah 2 1 hereafter noah 2 1 with the spatial resolution of 1 1 during 2000 2017 and 3 global land evaporation amsterdam model gleam 3 3a with the spatial resolution of 0 5 0 5 during 1980 2018 table 1 in this study the terrestrial water storage anomaly twsa terrestrial water storage change twsc runoff soil moisture and groundwater are selected as the terrestrial water components twsa and twsc data are derived from the release 5 rl05 dataset of the monthly grace tellus level 3 products of the centre for space research csr the geoforschungszentrum gfz the jet propulsion laboratory jpl csr grace rl05 mascons hereafter csr mascon and grctellus jpl rl06 mascons hereafter jpl mascon the runoff datasets include the noah 2 1 data with the spatial resolution of 1 1 during 2000 2017 climate data record cdr data with the spatial resolution of 0 5 0 5 during 1984 2010 and global runoff reconstruction grun data based on some previous literatures gu et al 2019 hu et al 2019 2021a 2021b gldas noah 2 1 can represent the soil moisture variations over globe and central asia then the soil moisture is employed from the gldas noah 2 1 for the groundwater datasets until now there exist limited groundwater observation wells across the aral sea basin which results in the impossible to use the observed groundwater in analyzing the groundwater variations therefore to address this issue the groundwater data used in this study is from the water global assessment and prognosis water gap global hydrology model wghm 2 2 a doll et al 2014 the details of the datasets are demonstrated in the text s1 of the supplementary materials 2 3 methodology 2 3 1 seasonal decomposition of time series by loess seasonal trend decomposition based on the loess stl filtering method was utilized for the time series analysis stl is a filtering procedure for decomposing a time series which decomposes the time series into three components as follows s total s long term s seasonal s residual where the original signal stotal is decomposed into long term seasonal and residual components based on procedures outlined in previous studies cleveland et al 1990 humphrey et al 2016 scanlon et al 2018 hu et al 2021a the long term signal can further be decomposed into linear and non linear interannual components by fitting a trend using least squares linear regression and attributing the remaining long term signal to interannual signal the residuals reflect subseasonal signal and noise therefore in this study we only focus on the long term trends which refer to the linear trends estimated from the long term signal of the monthly hydroclimate variables after stl analysis as defined in previous studies scanlon et al 2018 hu et al 2021a the significance of the linear trends is tested by the studenet s test at the 95 or 99 confidence level p 0 05 or p 0 01 since the multiple datasets have different periods the long term components and the corresponding long term trends of the monthly variables are computed during the period of 2003 2016 if the periods of the monthly variables do not cover the above period the long term components are computed from the start year of 2003 to the end year of their own end years for example the long term component and long term trend of et zhang are obtained by the stl approach during 2003 2013 it should be noted that the long term trends are obtained from the long term components of the monthly datasets after stl analysis for the annual data the linear trend is computed using the linear least square method directly 2 3 2 intra annual variation analysis of the hydroclimate variables intra annual values are averaged the multi annual monthly data which display the variabilities among different months to compare with the intra annual variations of the same variables from different datasets the intra annual values are computed from 2003 to 2016 if the data is available for a hydroclimate variable if the different datasets have different periods the intra annual values are based on the short period starting from 2003 for example for the et variable the intra annual values are computed from 2003 to 2013 although et zhang noah 2 1 and gleam 3 3a have the different periods table 1 3 result in this section the major results of the dynamical variabilities of the hydrological process and relationships between the terrestrial water cycle components and the climate factors are displayed over aral sea basin for a better understanding the hydrological process the climate backgrounds over aral sea basin during the period of 1901 2016 are analyzed the long term trends and variabilities of the water components are explored using the stl approach in the end the water budget is discussed using the ensemble variables i e p et and r and grace dataset which can reveal the spatial characteristics of the water resources and provide important scientific information for the water resource management over aral sea basin to investigate the roles of the climate factors temperature precipitation and evapotranspiration on the terrestrial water components the correlations between the climate factors and the terrestrial water components are measured by the correlation coefficient cc values which are tested by the student s t test at the 95 confidence level for each factor the ensemble data is averaged from all the datasets when there are mor than one dataset moreover the time lag cc values are computed from lag 0 to lag 11 to explore the time lag responses of the terrestrial water components to the variations of the climate factors 3 1 long term linear trends and variabilities of twsa as the depletion of twsa over central asia hu et al 2019 significantly twsa depletion of the aral sea basin is observed from the negative trends of the five grace datasets csr gfz jpl csr mascon and jpl mascon with the rates of 0 47 mm month 0 31 mm month 0 45 mm month 0 38 mm month and 0 29 mm month respectively fig 2 a the five datasets have the same temporal variabilities with a sharp decreasing from jun 2005 to jun 2014 and then appearing the increasing tendency till 2016 for the intra annual variabilities the spring months i e march to may have the largest twsa values and the twsa is decreased from the largest twsa at april to the smallest twsa at october the autumn i e september to november has the smallest negative twsa value among the four seasons which indicates the water depletion over the aral sea basin fig 2b moreover compared with the intra annual variability of precipitation twsa obviously has a lag 1 month than the precipitation variations such as the largest values of precipitation at march and twsa at april and the smallest values of precipitation at september and twsa at october fig s2b fig 2b for the spatial distributions of the long term linear trends of twsa except jpl mascon all the datasets show the same negative spatial patterns which indicates the water resource depletion over the aral sea basin especially the depletion center over the surrounding regions of aral sea and the turan plain fig 3 a 3d csr and csr mascon have the significant negative trends over all the aral sea basin and the significant negative trends of gfz and jpl are distributed over more than 91 areas for jpl mascon the areas of the significant negative trends account for 76 3 of the aral sea basin and the depletion centers appear at fergana valley and part of north aral sea basin fig 3e 3 2 long term linear trends and variabilities of twsc to have a further understanding the dynamical variations of twsa the long term linear trends and variabilities of twsc defined as the difference between the two consecutive months of twsa are investigated in fig 4 and fig 5 during 2003 2016 the long term components of the five grace datasets have large fluctuations with an obvious decreasing from 2003 to 2008 a periodic fluctuation from 2008 to 2013 and then having an increasing tendency till 2016 fig 4a for the intra annual variabilities twsc is decreased from the largest positive value at february to the smallest negative value at august and then appearing an increasing tendency fig 4b which are fitting the twsa variations fig 2a for the spatial distributions of long term linear trends csr gfz jpl and csr mascon have the similar patterns with the positive trends along the syr darya and the negative trends along the amu darya fig 5a 5d among the four datasets gfz has the largest areas with the significant positive trends over the north of the aral sea basin i e part of kazakhstan in the aral sea basin accounting for 22 22 areas fig 5b followed by jpl with 18 52 areas across the north syr darya fig 5c and the significant positive areas of csr and csr mascon is only less than 5 fig 5a 5d for the significant negative trends gfz also has the largest areas accounting for 28 89 of the aral sea basin followed by jpl 28 15 both distributed in the arm darya and the area percentages of csr and csr mascon are 14 07 and 25 19 for the last dataset jpl mascon it displays the positive trends over most part of the study area with the 51 85 significant areas mostly distributed over the aral sea and turan plain and the significant negative trend areas only account for 5 93 over the north afghanistan fig 5e 3 3 long term linear trends and variabilities of runoff in this section three datasets including noah 2 1 cdr and grun are employed to investigate the long term linear trends and variabilities of runoff across the aral sea basin the long term components of noah 2 1 have remarkable fluctuations during 2003 2016 with a significant decreasing in the period of january 2003 may 2008 k 0 06 mm month p 0 01 and r2 0 43 and a significant increasing from june 2008 to december 2016 k 0 03 mm month p 0 01 and r2 0 36 fig 6 a a sharp significant decrease trend of cdr is observed with the rate of 0 06 mm month during 2003 2010 p 0 01 r2 0 69 compared with cdr the temporal variations of grun are more similar with noah 2 1 and the significant negative trend is 0 01 mm month at the 99 confidence level p 0 01 r2 0 12 during 2003 2014 fig 6a for the intra annual variabilities of noah 2 1 and cdr the long term components are increased from january to the peak value in april and followed a decrease till december fig 6b the peak value of grun appears at may which is a lag 1 month compared with noah 2 1 and cdr for the spatial distributions of the long term linear trends of noah 2 1 31 85 areas have the significant positive trends mainly distributed over the upper reaches of syr darya and amu darya and part of turan plain and the significant negative areas account for 48 89 which are majorly distributed over the middle and lower reaches of the two rivers fig 7 a for cdr 76 3 areas have the significant negative trends with the negative centers over the fergana valley regions and the significant positive trends account for 14 07 areas during 2003 2010 fig 7b except the smaller negative trend centers the spatial distributions of grun during 2003 2014 and 2003 2010 are similar as cdr with the significant negative areas accounting for 64 44 and 78 52 fig 7 c and 7e for noah 2 1 in 2003 2010 the areas with positive areas in 2003 2016 become into the negative trend areas and the significant negative areas account for 69 63 fig 7d the differences of the long term linear trends of the runoff obtained from the different datasets are majorly determined by the different model structure and model input datasets which are same as the factors in the differences among grace global hydrological model and land surface model discussed in hu et al 2021a 3 4 long term linear trends and variabilities of soil moisture and groundwater for the soil moisture a significant negative trend k 0 09 mm month p 0 01 r2 0 1 is obtained from the long term components of noah 2 1 fig s6a the monthly soil moisture is increased from january to the peak value at april followed by the decrease to september and increasing to december fig s6b moreover the spring months have the largest soil moisture which is same as twsa and one month is delayed the precipitation the smallest soil moisture appears from august september and october which has one month lag the precipitation i e from july to september and is one month advance the twsa i e from september to november figs s2b and 2b for the spatial distributions of the long term linear trends the positive trends account for 25 19 areas mainly distributed at the upper reaches of the syr darya and amu darya e g fergana valley fig s7 the significant negative trends with the area percentage of 57 04 mainly appear over the middle reaches and the regions surrounding the aral sea according to the wghm 2 2 groundwater long term component has the significant decreasing trend with the rate of 0 003 mm month at the 95 confidence level p 0 05 during 2003 2014 for the period of january 2003 to may 2008 a significant decreasing is detected with the rate of 0 037 mm month p 0 05 r2 0 81 and an increase tendency is observed with the rate of 0 024 mm month p 0 05 r2 0 72 fig s8a the temporal variations of the wghm 2 2 groundwater are same to the precipitation of the three gridded datasets cru ts v4 01 global precipitation climatology centre gpcc v8 and trmm 3b43 fig s2a and the noah 2 1 runoff fig 6a which illustrates that the groundwater over the aral sea basin is highly correlated with the precipitation and runoff for the intra annual variability the wghm 2 2 groundwater is increased from january to the peak value at march and decreased to the smallest value at september and increased till december fig s8b which fits the variations of the precipitation soil moisture and twsa figs s2b 2b and s6b the long term linear trends of the monthly wghm 2 2 groundwater have the 28 89 areas with the significant positive rates mainly distributed over the north afghanistan and large part of turan plain and 45 19 areas with the significant negative rates across the syr darya and part of center of the aral sea basin fig s9 3 5 the impacts of the climate factors on twsa and twsc the climate factors have positive roles on the twsa variations from the positive cc values in fig 8 in particularly the cc values between em t and em twsa from lag 0 to lag 11 are similar with the average value of 0 31 which indicates that the positive impacts of the temperature on the twsa are same across the whole year fig 8a and 8d for the spatial distributions of the lag 2 cc values except the negative values over the south and south east of the aral sea basin the other regions have the significant positive lag 2 cc values between em t and em twsa that suggests the twsa is positively correlated with the temperature fig 9 a the positive impacts of the precipitation are obviously observed from the similar variations between the precipitation and twsa fig 8b it has an increased cc values from lag 0 with the value of 0 18 to lag 8 with the largest value of 0 61 and the residual cc values are about 0 59 which indicates that these impacts of the precipitation are persistent across the whole year fig 8d the significant positive lag 8 cc values are distributed over the whole basin fig 9b the increased et over the aral sea basin is mainly caused by the increased temperature and precipitation fig s1 which is consistent with the conclusion in hu et al 2019 therefore em twsa is positively correlated with the em et which is obtained from the similar variations as the em et and the positive cc values fig 8c and 8d the lag n n 0 1 11 cc values between em et and em twsa are same as these between em p and em twsa with the first largest value of 0 56 at lag 8 which suggests that the positive impacts of the et on the twsa is also persistent though the whole year the distributions of the lag 8 cc values are same as the values between the em p and em twsa except some negative values in fragment areas from fig 9c since the twsc is the change of twsa the roles of the climate factors on the twsc are related to the roles on the twsa the cc values between em t and em twsc are from positive to negative at lag 3 and keep the negative values till to lag 11 fig 10 a 10d most areas have the positive cc values with the significant values at the north and center aral sea basin fig 11 a the precipitation and et have the persistent significant positive roles on the twsc with the values larger than 0 3 from lag 0 to lag 11 fig 10b 10c and 10d the positive cc values at lag 7 and lag 3 for em p and em et are distributed over the aral sea basin as twsa fig 11b 11c according to the latest study hu et al 2021a central asia has a complex terrestrial water component circulation the effects of climate factors on twsa have time lags for temperature increased temperatures lead to accelerated snow melting and glacier retreat which result in terrestrial water storage depletions throughout central asia brun et al 2017 yang et al 2017 wang et al 2018 for precipitation it needs time for the increased precipitation transformed into the soil moisture groundwater snow ice and glacier et is majorly controlled by temperature and precipitation its lagged impacts on the twsa and twsc are determined by temperature and precipitation therefore the climate factors have the lagged effects on twsa and twsc for the attributed factors of the terrestrial water storage variations recent researches indicates that the terrestrial water storage depletion in central asia has largely been impacted by the combination of climate factors and intensified human activities especially in the aral sea basin deng and chen 2017 hu et al 2021a su et al 2021 therefore the control factors of the twsa and twsc should have a further investigation 3 6 the impacts of the climate factors on soil moisture runoff and groundwater to further investigate the impacts of the climate factors on the water circulation components in this section we analyze the roles of the temperature precipitation and et on the inter annual variations of the runoff soil moisture and groundwater the three climate factors have positive impacts on the inter annual variations of the soil moisture fig 12 specifically the impacts of the temperature on the soil moisture are decreased with the increasing of the time lags precipitation has the significantly positive impacts on the soil moisture variations with these strong persistent positive impacts across the whole year cc values larger than 0 58 fig 12b and 12d obviously due to the relationship between precipitation and et the et also has the significantly positive impacts on the inter annual variations of soil moisture which are persistent during the whole year fig 12c and 12d the largest time lag cc values of the three climate factors with soil moisture are lag 0 lag 5 and lag 3 for temperature precipitation and et respectively fig 12d the spatial distributions show that almost all the aral sea basin has the significantly positive cc values for the temperature precipitation and et fig 13 for the runoff temperature has no relationship with the inter annual variations which can be obtained from the small cc values figs s10a and s10d while the inter annual variations of the runoff are highly agreement with the precipitation and et with the large positive cc values figs s10b s10c and s10d for the spatial distributions of the largest time lag cc values almost all the areas have the significantly positive values for precipitation and et except the temperature fig s11 there is also no obvious impact of the temperature on the inter annual variations of groundwater as on the runoff fig s10a and fig s12a although the time lag cc values are negative fig s12d as the positive impacts on the soil moisture and runoff the precipitation and et have significantly positive impacts on the inter annual variations of groundwater with these persistent impacts across the whole year figs s12b s12c and s12d most areas show the significantly negative cc values for the temperature in fig s13a for the largest time lag cc values in lag 5 of precipitation and et the significantly positive cc values are distributed over most areas of the aral sea basin except the significantly negative values over some north and south part of this basin for et figs s13b and s13c 4 discussion 4 1 comparison of the long term trends of climatic and hydrological variables of four river lake basins over central asia in this section the long term trends of the hydrological variables over aral sea basin are compared with these of the other three river lake basins over central asia during 2003 2016 they include balkhash lake basin balkhash issyk kul lake basin issyk kul tarrim river basin tarrim and the climatic and hydrological variables are temperature t precipitation p evapotranspiration et terrestrial water storage anomaly twsa runoff and soil moisture sm each of these variables are averaged from the different sources at the same period table s1 the long term trends are based on the long term time series derived from the stl method firstly the climatic backgrounds of the four basins are compared all the four basins have been experienced significant warm trends at a 99 confidence level with the largest value of 0 12 c decade at issyk kul lake basin followed by tarrim river basin 0 1 c decade balkhash lake basin 0 08 c decade and aral sea basin 0 06 c decade table 2 for precipitation two significant increasing trends are observed for balkhash lake basin 0 037 mm month and issyk kul lake basin 0 018 mm month at the 99 and 95 confidence levels respectively aral sea basin has a weak increasing trend and tarrim river basin has a weak decreasing trend compared with the et trend of the other basins aral sea basin has the significant positive trend of 0 008 mm month which is the smallest table 2 for the hydrological variables aral sea basin has the largest water depletion with the t3wsa trend value of 0 38 mm month than the other basins followed by issyk kul lake basin 0 19 mm month and balkhash lake basin 0 08 mm month during 2003 2016 the negative twsa trend of tarrim river basin is weak which indicates the small water depletion for the runoff changes significant negative trends are obtained at a 99 confidence level over the four basins with the value of 0 007 mm month 0 006 mm month 0 024 mm month and 0 017 mm month for aral sea basin balkhash lake basin issyk kul lake basin and tarrim river basin respectively for soil moisture only aral sea basin has the significant negative trend 0 09 mm month at a 99 confidence level and the other basins have the significant positive trends with the largest trend over tarrim river basin 0 28 mm month table 2 for the relationships between the climate variables and the hydrological variables the climate changes have large contributions to the terrestrial water depletion over the aral sea basin human activities also have serious impacts on the water resources such as the aral sea shrinking deng et al 2010 for the other basins the decreasing twsa and runoff are caused by the climate variations however for soil moisture it is the significant increasing trend which may be caused by the ice and snow melting over the surrounding mountainous areas hu et al 2019 moreover we explore the variations of the climatic and hydrological variables over casnw i e including the five states of central asia and the northwest of china significant increasing trends of temperature and precipitation are obtained and et has a remarkable increasing trend for the three hydrological variables twsa and runoff are significantly decreased with values of 0 25 mm month and 0 005 mm month at a 99 confidence level a weak decreasing trend is observed for soil moisture 4 2 assessments of the water budget of aral sea basin quantifying the water budget or water balance is essential for improving our understanding of the coupled hydrological system including the characteristics of key water and energy components and the comprehensive picture of how the water cycle is changing sahoo et al 2011 munier and aires 2018 according to the water balance of a closed basin sahoo et al 2011 yang et al 2015 xie et al 2019 twsc for a given basin are obtained as twsc p et r which is noted as twscp et r twsc derived from grace data is assumed as the difference of twsa in two successive months that is noted as twscgrace in this study the differences between p et r and the twsc derived from grace dataset are explored to display the water budget variations over the aral sea basin since no dataset can be considered as perfect different available datasets within water budget experiments should be combined lorenz et al 2014 munier and aires 2018 xie et al 2019 the precipitation data used in the water balance is ensemble mean from the cru ts v4 01 gpcc v8 and trmm 3b43 during 2003 2016 et data is the ensemble mean from the et zhang noah 2 1 and gleam 3 3a runoff data is the ensemble mean from the noah 2 1 cdr and grun the twsc data is computed from the ensemble mean of five twsa dataset derived from the five grace datasets there are favorable agreements between the grace derived and water flux derived twsc fig s16 the correlation coefficient cc between twscgrace and twscp et r is 0 69 with p 0 001 which is similar with the result in tarrim river basin as documented in yang et al 2015 this indicates that twsc derived from grace corresponds well with the water flux derived twsc from precipitation et and runoff and water balance in the aria sea basin can be closed potentially using grace twsc and water flux p et r the absolute error ae value is 2 86 mm indicating an overestimation of the grace twsc compared with the water flux p et r the root mean square error rmse value is 17 04 mm the positive ae is caused by the underestimated precipitation of the aria sea basin from cru gpcc and trmm datasets hu et al 2016 2018 the large uncertainties of the terrestrial water budget components precipitation et groundwater and runoff from grace gldas and the other water flux data result in the mismatch between twscgrace and twscp et r yang et al 2015 munier and aires 2018 overall grace and the other water flux datasets used in our study can be used in water balance analysis over the aria sea basin to have a further assessment and comprehensive exploration of the water balance for each water budget components and water cycle parameters new datasets from in situ or remote sensing observations or a combination of both and from hydrological models or reanalysis datasets are needed especially for the groundwater and runoff 5 conclusion assessments of the terrestrial water component variations are important for strengthening our knowledges of the complex hydroclimatic system such as understanding the characteristics of the water cycle components improving our predictions of weather and climate and providing significant information in the management and utilization of the regional water resource in a changing environment due to climate change and intensified human activities the aral sea basin has been experiencing a series of serious ecological issues which are majorly caused by the scare water resources therefore in this study we explored the long term linear trend and variability of the terrestrial water cycle components using multiple datasets and analyzed the impacts of the climate factors on the terrestrial water cycle components major results are concluded as follows 1 in 1901 2016 increasing trends of the annual precipitation from cru gpcc v8 and trmm 3b43 are observed over the aral sea basin at different periods which is consistent with the precipitation variation over central asia the annual et has the larger trend than precipitation at the same period especially at 2003 2016 except et zhang after the stl decomposition the three datasets have the similar variations of long term components with a significant decreasing in jau 2003 feb 2008 and a remarkable increased trend during mar 2008 dec 2016 for the intra annual variability most part of precipitation appears from nov to may and very small precipitation are in jul aug and sep 2 for twsa the five grace derived datasets have the consistent significant decreasing trends with the values from 0 58 mm yr to 0 36 mm yr which indicates the serious terrestrial water depletion during 2003 2016 after removing the seasonal effects the long term components have significant decreasing trends the monthly twsa has the largest positive values in spring i e from mar to may and the smallest values in autumn i e from sep to oct which are consistent with the precipitation variations moreover one month time lag of twsa is observed comparing with precipitation which indicates the time lag impacts of precipitation on the terrestrial water resources over the aria sea basin 3 runoff soil moisture and groundwater have the decreasing long term component trends derived from multiple datasets the intra annual variabilities of soil moisture and groundwater are similar with twsa and precipitation 4 precipitation is the major impacted climate factor on the inter annual variations of the terrestrial water cycle components twsa twsc soil moisture runoff and groundwater the influences of et on the terrestrial water cycle components are factually based on the precipitation 5 compared with the other major basins over central asia i e balkhash lake basin issyk kul lake basin and tarrim river basin during 2003 2016 the aria sea basin has the most serious terrestrial water depletion with the largest depletion trend of twsa which has been caused by the intensify human activities such as huge irrigation 6 the grace derived twsc has the potential application in the water budget analysis over the aral sea basin which helps us have a better understanding the complex hydrological circulation overall serious water depletion of aral sea basin is observed according to the results of terrestrial water cycle components which can provide significant information for the water resource management in order to deeply explore the complex hydrological system more datasets and further analysis should be employed such as the in situ measurements of groundwater and et and the study in detecting the factors contributing to the terrestrial water variations credit authorship contribution statement zengyun hu conceptualization data curation formal analysis xi chen conceptualization data curation formal analysis qiming zhou conceptualization formal analysis gang yin data curation formal analysis jun liu data curation formal analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the strategic priority research program of chinese academy of sciences pan third pole environment study for a green silk road pan tpexda20060303 the western scholars of the chinese academy of sciences 2020 xbqnxz 010 national natural science foundation of p r china e1190301 41971386 general research fund hkbu 12301820 grace data is from https grace jpl nasa gov data get data global hydrological model data pcr wghm 2 2 are downloaded from https surfdrive surf nl files index php s kbgl5xyzudpviht and https hessenbox a10 rz uni frankfurt de dl fi5edqjrumuyp9bx6vahohbm totalwaterstorage wg2 2c wfdei gpcc 1958 2014 monthly nc4 noah data from gldas 1 and gldas 2 1 are downloaded from https search earthdata nasa gov cru ts v 4 01 is from https crudata uea ac uk cru data hrg appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 127270 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3798,suspended sediment is of importance in river and dam engineering due to its high nonlinearity and stochasticity sediment prediction by conventional methods is a challenging task consequently this paper establishes a new hybrid model for an improved forecast of suspended sediment concentration ssc it is a nonlinear autoregressive network with exogenous inputs narx integrated with a data pre processing framework thereafter inarx in this model wavelet transformation wt is used for time series decomposition and multigene genetic programing mggp for details scaling the two incorporated modules improve time and frequency domain analysis allowing the network to unveil the embedded characteristics and capture the non stationarity at a hydrological station on the upper reaches of the yangtze river the records of daily water stage flow discharge and suspended sediment are collected and refer to a nine year period during 2004 2012 the data are used to evaluate the models several wavelets are explored showing that the coif3 leads to the most accurate prediction compared to the sediment rating curve src the conventional mggp multilayer perceptron neural network mlpnn and narx the inarx demonstrates the best forecast performance its mean coefficient of determination cd increases by 7 7 38 6 and the root mean squared error rmse reduces by 15 1 54 5 the inarx with the coif3 wavelet is further evaluated for flood events and multistep forecasts under flood conditions the model generates satisfactory results with cd 0 83 and 84 7 of the simulated data falling within the 0 1 kg m3 error for the multistep forecast at a one week lead time the network also yields predictions with acceptable accuracy mean cd 0 78 the model performance deteriorates if the lead time becomes larger the established framework is robust and reliable for real time and multistep ssc forecasts and provides reference for time series modeling e g streamflow river temperature and salinity keywords river suspended sediment wavelet transformation multigene genetic programing multilayer perceptron neural network inarx 1 introduction the presence of suspended sediment in river flows is an essential issue in terms of water quality river geological and geographical settings channel navigability operation of hydraulic structures river aesthetics and fish habitats kişi 2006 for instance from the perspective of water resources exploitation suspended sediment with high turbidity in river flows is a physical pollutant which may act as a chemical pollutant when carrying chemicals such as phosphorous and heavy metals doğan et al 2007 the transport of suspended sediment also affects erosion and deposition leading to river morphological changes liu et al 2013 defined as the ratio of sediment mass to volume of a sediment laden mixture suspended sediment concentration ssc characterizes a sediment transport process zheng et al 2011 accurate predictions of the ssc are of practical implications in a wide range of hydraulic issues including design of the reservoir dead storage environmental impact assessment and prediction of aggradation and degradation around bridge piers afan et al 2016 however the transport is a complex phenomenon involving both the flow and sediment motions and their interactions from the initial detachment of sediment particles to their deposition every stage is characterized by high nonlinearity and interplay processes rendering the ssc forecast a challenging task conventionally the ssc in a stream is determined via either direct field measurements or already established sediment transport equations bayram et al 2012 the former is an accurate approach with however some practical and cost disadvantages the latter refers to the use of the relationship between the ssc and flow properties including flow velocity discharge etc the approaches are usually developed based on simplified partial differential equations assumptions and empirical correlations for erosive effects of rainfall and flow aytek and kişi 2008 karim and kennedy 1990 mcbean and al nassri 1988 some sediment curves are also proposed for the estimation of ssc crowder et al 2007 petersen øverleir 2004 which are theoretically adequate to cope with the variations in catchment properties and uneven distribution of precipitation and evapotranspiration aytek and kişi 2008 however due to the scarcity of detailed spatial and temporal hydrological data applications of those methods suffer from limitations kisi et al 2012 moreover despite several established empirical models choosing an appropriate one for a specific scenario is difficult which is the reason why many of them do not gain expected acceptance afan et al 2016 some researchers even indicate that the sediment curves are misleading and the high goodness of fit is spurious mcbean and al nassri 1988 as a result efforts have been devoted to develop reliable methods for ssc predictions machine learning modeling offers an alternative in comparison with process driven methods machine learning models gain superiority in dealing with nonlinear issues and handling a large quantity of data with the help of artificial intelligence ai they demonstrate a great potential in mapping data with high complexity dynamism and non stationarity e g ssc time series the recent years have witnessed a rapid growth of ai based approaches in studying the ssc one of the first applications is made by jain 2001 where an integrated relation among water stage flow discharge and ssc is established using a feedforward neural network ffnn the resulting model leads to better predictions than the conventional curve fitting approach and is capable of modeling the hysteresis effects caused by unsteady flows in channels alp and cigizoglu 2007 examine the performance of the ffnn and radial basis function neural network rbfnn in sediment load estimations the combination of rainfall and flow data generates as predictors accurate results the two evaluated models exhibit insignificant differences melesse et al 2011 adopt a multilayer perceptron neural network mlpnn and use precipitation river flow and antecedent sediment data to predict the suspended sediment in three major u s rivers mississippi missouri and rio grande compared with the multiple linear and nonlinear regressions and autoregressive integrated moving average the mlpnn produces more satisfactory results demirci and baltaci 2013 explore the efficiency of fuzzy logic models in ssc estimations concluding that they behave better than the multiple linear regression method ehteram et al 2021 use the whale algorithm particle swarm optimization and bat algorithm to optimize the performance of an artificial neural network ann the hybrid models cut down the error up to 80 relative to the standard one doroudi et al 2021 integrate the observer teacher learner based optimization method into a support vector machine which outperforms all the evaluated ones afan et al 2016 provide a partial review of the relevant studies in the area due to its stochastic temporal variations time series modeling is a challenging task direct simulations might be inadequate to capture its features in both time and frequency domains consequently for better representation data pre processing techniques e g sampling transformation de noising and normalization are suggested to reformulate and reshape the raw signals in a rainfall forecast study mehr et al 2019 remove the non stationary features by performing square root and standardization of the original data such a procedure produces a weak stationary signal that is easy to model as the trend in the mean is separated and the variance is suppressed for better estimation of water table fluctuations jeong and park 2019 suggest a framework for detrending deseasonalization normalization and outlier exclusion this method by assuming consistency of the trends and stationarity of seasonal variability detects in an effective way the process changes that occur in a groundwater system if coupled with machine learning models it improves the efficiency of the standalone ones liu et al 2013 apply a wavelet for signal decomposition and integrate it with an ann for ssc forecast showing that wavelet helps better capture highly nonlinear and non stationary ssc a similar study by rajaee et al 2011 illustrates that the model is capable of obtaining useful information on various resolution levels shiri and kişi 2012 combine wavelet with gene expression programming gep neuro fuzzy nf and ann for sediment load prediction it is concluded that the wavelet based models significantly increase the accuracy of single ones these papers demonstrate the importance of data pre processing for time series modeling in most works the main regressors are static models e g ann and nf they are suitable for fitting problems and a more robust model is required for time series forecast nanda et al 2016 for a better ssc estimation this paper establishes a nonlinear auto regressive with external inputs narx network and couples it with a new wavelet based data pre processing module the narx a dynamic recurrent neural network is a superior network for handling non stationary issues the data pre processing framework takes the advantage of the discrete wavelet transformation for time and frequency analysis and the multigene genetic programming mggp for feature selection expecting to generate informative and noise free inputs for the regressor time series data of daily discharge water level and ssc during 2004 2012 collected at the cuntan station on the upper reaches of the yangtze river are used to test the proposed integrated narx inarx its performance is assessed statistically and compared with that of empirical and conventional data driven models the objective of this study is to put forward an improved neural network for real time and multistep forecasts of the river suspended sediment a robust prediction framework has profound engineering implications 2 methodology two static models mlpnn and mggp are first introduced as an essential element in the inarx wavelet transformation wt is described the inarx is established by integrating the wt and mggp to the narx allowing improved multistep forecasts the evaluation criteria are finally stated 2 1 multilayer perceptron neural network mlpnn an ann is a commonly used intelligent method in addressing various issues particularly for nonlinear systems an mlpnn is a popular type of ann in hydrological applications fig 1 presents its typical architecture the neurons are interconnected to each other between the layers with weight w and bias b at the input layer one neuron corresponds to one predictor at the output layer one neuron represents one response at the hidden layer the number of neurons depends on the complexity of the problem the signals are transferred in the forward direction without a loop the network is developed by minimizing the error between the network output y and target z through the adjustment of w and b the input x is first processed by an identity function and its outcome is then fed to the neurons at the hidden layer bishop 1995 for instance the signal netj that the j th hidden neuron receives from the input layer is expressed by 1 ne t j i 1 p x i w ij b j in which xi i th input variable wij weight between the i th input neuron and the j th hidden neuron bj bias at the j th hidden neuron and p number of inputs the net value netj is then processed by an activation function which generates a new signal and feeds into the output layer its value yj from the j th hidden neuron is computed by 2 y j f 1 n e t j f 1 i 1 p x i w ij b j where f 1 functional symbol the same technique is employed for both the hidden and the output layer the net weighted signal netk entering into the output layer is given by 3 ne t k j 1 q f 2 y j w jk b k j 1 q w jk f 2 i 1 p x i w ij b j b k where bk bias at the k th output neuron q number of hidden neurons and f 2 functional symbol in the end the outcome yk from the k th output neuron is calculated by 4 y k f 3 ne t k f 3 j 1 q w jk f 2 i 1 p x i w ij b j b k where f 3 functional symbol by updating w and b the algorithm iterates until it reaches the pre defined error limit 2 2 multigene genetic programing mggp the mggp model is a supervised evolutionary learning algorithm which adopts the concept of survival of the fittest khozani et al 2020 it combines linearly the low depth gene programing gp and creates a simplified solution with improved fitness a gp gene is a tree structured computer program with linking branches root inner and terminal nodes as shown in fig 2 this three level gene comprises one root node three inner nodes and four terminal nodes which are connected by linking branches mathematical operators the evolution of the mggp method starts from the creation of chromosomes which are then used as parents to produce offspring three genetic operations are involved in this process reproduction crossover and mutation in the reproduction the parent reproduces an offspring by solely copying itself thus no additional gene information is created in the crossover two new genes are generated by exchanging materials between their parents fig 3 a in the mutation a new gene is produced by replacing its sub tree structure with a random one controlled by the pre defined operation parameters fig 3b jamei et al 2020 summarize the primary development procedures in a mggp model define initial parameters functions sets population size number of generation rate of genetic operation and maximum number of genes generate a population of genes and create a solution with a number of them examine the model efficiency based on the objective function and produce new genes using the genetic operations and repeat the last step if the stopping criteria are not met in the end the mggp solution is constructed with low depth gp genes 5 y i 1 n g c i g i c where c constant ci i th gene weight of i th gene gi and ng number of survived genes both c and ci are determined by the least squares method 2 3 wavelet transformation wt the essential information of temporal data is usually veiled in the frequency domain and is not readily available in the time domain shoaib et al 2015 to reveal the key features of a time series data transformation is often performed the fourier transformation ft is one of the earliest methods used for frequency contents extraction however the time information is lost if transformed from the time to the frequency domain as an improvement the wt captures simultaneously the time and frequency information the wavelet in a wt refers to the finite length and oscillatory window function as its width varies with the transformation for every single spectral component the wt is particularly useful for feature extraction for time series data whose patterns are not apparent in its raw form the wt generates a time scale representation of the non stationary data and their relationships thus revealing their trends breakdown points and discontinuities singh 2012 specifically the original signal is decomposed into low and high frequency elements and is analyzed in the time and frequency domain this processing technique allows one to examine the unseen details of the raw data hence improving the computational accuracy of the data mining models jamei et al 2020 a wt is classified into continuous wt cwt and discrete wt dwt the major difference between them is how the scale parameters are discretized the cwt wa b t of a time series f t is expressed as 6 w a b t f t 1 a ψ t b a d t where t time ψ complex conjugate of the wavelet function or the mother wavelet ψ a dilation scale parameter and b translation position parameter the computation of the cwt coefficients at each a and b leads to a large number of data as an alternative the dwt employs the scaling low pass filter and wavelet high pass filter functions the scales and positions are based on the power of two dyadic scales and positions the w a b d in the dwt is given by 7 w a b d 2 j 2 1 j ψ 2 j 2 k f t d t where j and k real integers through the low and high pass filter the time series data are decomposed into two parts approximation a and details di the former represents the low frequency and high scale component and the latter the high frequency and low scale one the low and high frequency contents are analyzed by the low and high pass filters respectively the low frequency part reveals the identity of the signal and the high frequency one affects its flavor in this way the background information is captured by a and the trivial attributes of interpretational value are characterized by di tiwari and chatterjee 2010 the temporal data after the dwt are expressed by 8 f t a n i 1 n d i where n number of decomposition level 2 4 integrated nonlinear autoregressive network with exogenous inputs inarx as the core of our study the inarx is a recurrent network based model that couples with a data pre processing module shown in fig 4 this scheme is composed of three phases starting from the decomposition of signals by the dwt after division the choice of the dwt over the cwt is favored by high computational efficiency and easy implementation as suggested by kisi 2011 after the transformation the raw data are decomposed into two components approximation and details if the raw data include m elements and each of them is decomposed into l levels the total number of sub signals approximation and details after the dwt becomes m ml however not all of them are equally informative khan et al 2020 in the second phase the details are fed into the mggp to remove the redundant inputs that may deteriorate the model performance the mggp generates an explicit expression which consists of the inputs and indicates their contributions to the target although the mggp alone can act as a machine learning model it is employed as a selection tool to scale the details successful mggp applications as a selection tool are found in hadi and tombul 2018 and mehr and nourani 2017 as it combines linearly the gp trees to solely improve the fitness based on the objective function tends to yield a complex evolved solution which is likely to result in horizontal bloat and overfitting to cope with this the pareto front pf method is used to optimize the model in terms of both accuracy and complexity based on the concept of dominance with the pf at any instant consisting of non dominated solutions it is a multi objective optimization technique smits and kotanchek 2005 given a population of models the pf is composed of the members that outperform others in the pre defined criteria the methodological procedures are summarized as follows limiting the maximum number of genes to reduce the model complexity and overfitting risks calculating the expressional complexity of all evolved potential solutions comparing the model complexity of the whole population against their goodness of fit measure identifying the models that gain by comparison in terms of both accuracy and simplicity pareto front members selecting the scaled detail ds the one with the highest contribution to the target from the best model in the third phase the approximation and scaled details are used as inputs for the nonlinear auto regressive with external input narx network this dynamic network is composed of three layers similar to the mlpnn with recurrent connections from the past outputs which allows multistep forecast it is mathematically formulated as 9 y t f a t 1 a t δ t 1 d s t 1 d s t δ t 1 y t 1 y t δ t 2 in which y a and ds output approximation and scaled details t time δt 1 input delay δt 2 feedback delay and f functional symbol the delayed y is automatically fed backwards to the input layer thus the prediction is dependent on not only the exogenous parameters a and ds but also the previous output signals the delays in the external and feedback inputs sever as a short time memory of the network they also represent vectors that each signal must pass through after which all signals are available as an input for the next unit for a number of time steps the network is in a closed loop which may deteriorate computational efficiency and accuracy for a given training set the true outputs observations are available hence one can open the loop by feeding back the delayed observations instead of the estimated values as more accurate inputs are used the procedure leads to better predictions it also saves computational costs as the resulting network is in a simple feedforward architecture and static backpropagation is applied for model development in applications the network is in a closed loop for multistep ahead estimation the training of the network is achieved using the levenberg marquardt lm algorithm which is a combination of the steepest descent first order and gauss newton second order method the resulting configuration improves the computational speed of the former and enhances the numerical stability of the latter samarasinghe 2016 the weight update we 1 of the lm at e 1 epoch is defined by 10 w e 1 w e h e λ i 1 j e r e where e epoch number h hessian matrix λ variable scalar i identity matrix j jacobian matrix and r residual error vector the presence of j and the diagonal term λi leads to a positive definite h which shortens remarkably the computational time yu and wilamowski 2011 this fast and reliable second order local method has been successfully implemented in many studies e g adamowski and chan 2011 and daliakopoulos et al 2005 2 5 evaluation metrics for any prediction model its performance is statistically assessed in terms of coefficient of determination cd nash sutcliffe coefficient nsc root mean squared error rmse and mean absolute error mae the first two describe the goodness of fit and the last two quantify the estimation error these indices are usually used in the evaluation of machine learning models adamowski and chan 2011 dayev 2020 the cd index indicates how well the observed observation o is replicated by the simulation s 11 cd i 1 n o i o s i s i 1 n o i o 2 i 1 n s i s 2 2 where oi i th observation si i th simulation o mean of observations s mean of simulations and n number of data cd 1 0 represents a perfect fit and cd 0 75 is often considered a satisfactory result motovilov et al 1999 the nsc index assesses the predictive skill of a hydrological model defined as 12 nsc 1 i 1 n o i s i 2 i 1 n o i o 2 nsc 1 0 corresponds to an ideal estimation a negative nsc value occurs if the simulation error variance is significantly larger than the observation one nsc 0 75 is generally an acceptable result moriasi et al 2007 the rmse index measures the discrepancy between the modeled and observed values given by 13 rmse i 1 n o i s i 2 n it ranges from zero to infinitive with rmse 0 indicating a perfect match between the observation and estimation conversely a large rmse value indicates the inadequacy of the prediction model the mae index shows the mean of all individual errors computed by 14 mae 1 n i 1 n o i s i the rmse and mae are error statistics and are case dependent the closer to zero the better 3 study site and data source 3 1 study site to evaluate the developed inarx model the cuntan hydrological station on the upper reaches of the yangtze river is chosen as the study site the river basin covers an area of 1 8 106 km2 accounting for approximately one fifth of the land area of china fig 5 originating in the qinghai tibet plateau about 5100 m above the mean sea level the river flows eastwards through a number of major cities including chongqing and finally into the east china sea in shanghai globally it ranks third in length 6300 km fourth in sediment flux 470 mt year and fifth in flow discharge 900 km3 year yang et al 2018 the cuntan station 106 60 e 29 62 n is situated downtown in chongqing city some 606 km upstream of the well known three gorges dam its catchment area is 8 67 105 km2 it is one of the major measurement stations on the upper river reaches with daily records of flow sediment water quality and other parameters a few kilometers up and downstream of the station the river course is slightly curved in planform however without significant variations in cross section measured at the normal water levels the river width ranges between 500 and 600 m the average water depth amounts to 20 m during a year the river runoff varies considerably the multi year average runoff is 3 40 1011 m3 the river flow carries sediment in form of both bedload and suspended load on a multi year average basis the total sediment flux amounts to 3 74 108 t with ssc 1 09 kg m3 the bedload mainly composed of cobbles and sand is limited in amount only 2 50 104 t year 3 2 data source the study is based upon the daily hydrological records from january 1 2004 to december 31 2012 collected from the yangtze water resources commission www cjw gov cn the data refer to flow discharge q water level elevation z and the ssc for the q measurement an acoustic doppler current profiler adcp attached to a customized motorboat with gps positioning measures water depth and flow velocity at the pre determined cross section the boat goes perpendicular to the stream at a constant cruising speed the velocity measurement error is 5 cm s pressure sensors monitor the water depth with 1 cm accuracy the relative q error is by estimate below 5 to measure the ssc along the transection plumb lines are first positioned the number of which depends on the river width along each line the suspended load is with point integrative water samplers sampled at several equidistant positions and the corresponding flow velocities are also measured with the velocity and ssc the cross sectional sediment flux is calculated with the elapse of time the measurement techniques are upgraded at regular intervals some manual undertakings are replaced by automatic procedures at the station the collected daily series amount to a total of 3289 data sets and are divided into training and testing data with a ratio of 7 3 table 1 presents the statistics of the field data at both stages in which sd standard deviation and cv coefficient of variation 4 results and discussion with the time series of the hydrological data the mlpnn mggp and inarx models are assessed and compared in the first two methods a short term memory structure is used to improve their learning performance with signal decomposition by wavelet functions and details scaling by the mggp the proposed inarx model that combines a feedforward neural network with a non linear auto regressive model provides improved river sediment forecasts all the models are coded in matlab version r2021a on a pc model dell precision 7872 tower processor inter r xeon r gold 5215 cpu 2 5 ghz 4 1 the mlpnn and mggp models 4 1 1 memory depth the stand alone mlpnn and mggp models are first established for ssc forecasts as benchmarks as the former is a well known model and the latter is a component of the proposed framework to utilize the temporal information of the time series data a short term memory structure is suggested in the input layer achieved by feeding the network with lagged data this is an essential step for the development of hydrological models as the system response is inherently dependent on its past states consequently a memory structure would help encode the temporal features and improve the learning performance the selection of the time lag or memory depth is a vital yet challenging task for which there are mainly two approaches one employs the auto correlation function acf and partial auto correlation function pacf to obtain suitable input vectors sudheer et al 2002 despite their wide use some argue that those functions are incapable of capturing the nonlinear features of hydrological systems and fail to discover their full relationship nayak et al 2004 senthil kumar et al 2005 the other is the so called window sliding method moosavi et al 2013 riad et al 2004 in which the initial input sequence comprises the data with a lag of one time step and is then adjusted by successively adding longer lag up to a specific value the optimal lag is based on the estimation accuracy determined by a trial and error method in this study the two methods are combined to select an appropriate memory depth to identify the dominant input space vectors the acf and pacf are performed to analyze the ssc time series shown in fig 6 the former demonstrates an oscillating pattern and annual periodicity of the ssc data similar to the year to year dependency of the rainfall and streamflow series aksoy and dahamsheh 2009 rahmani rezaeieh et al 2020 the latter shows that the current time system state is closely correlated with the ones with one and three day lag a larger time lag exhibits limited impacts accordingly predictors with those lags are used for the ssc prediction e g s t f 1 iv t 1 iv t 3 in which iv input vector and f 1 functional symbol it should be noted that the iv consists of z or q or both for the window sliding method time lags starting from one day up to five days are considered the resulting input configurations m1 m12 from both methods are listed in table 2 4 1 2 model application the mlpnn features a supervised learning process the lagged predictors are used as the input and the current time observations as the target the lm algorithm is employed to train the network the simulation error is propagated backwards to adjust the network weights and biases the network has sigmoid hidden neurons and linear output neurons with the optimal number of hidden neurons attained by a trial and error procedure the mean squared error mse is set as the fitness function the calculation is terminated if the training reaches a maximum of 10 000 epochs or the mse drops below the threshold 0 01 table 3 in the mggp model the number of genes is limited to five and each has a maximum depth of four the initial population size is 300 and the maximum number of generations is 150 after some trials the reproduction crossover and mutation rate are adjusted to 0 2 0 84 and 0 14 respectively in search for accurate models the function sets i e addition subtraction multiplication division square root and sine are found effective the simulation is run multiple times to achieve high generalization with a total number of 1500 potential solutions generated for each input scenario the model setups are summarized in table 4 the performance metrics of the mlpnn and mggp models are shown in tables 5 and 6 respectively for both models the use of only one and three day lagged water level m1 seems to fail to generate accurate results which is presumably due to the lack of informative features compared to m1 the m2 prediction exhibits remarkable improvement indicative of the significance of the discharge from a physical point of view the discharge affects directly the ssc its presence provides essential information for the learning of system behaviors a combination of multiple past states helps better interpret the temporal ssc variations thus leading to high accuracy m3 as given only one specific lagged time e g one day delay m4 m8 show a less satisfactory behavior in comparison with m3 with the lag enlarged from one m4 to five days m8 the forecasting ability deteriorates for both mlpnn and mggp the average cd values training and testing become for instance 21 lower the rmse values are 15 higher for the former and 20 higher for the latter among all the tested ones the m10 input vector produces the most accurate estimation it is also noted that enlarging the lags would worsen its performance m11 m12 which is presumably attributed to the redundancy of those temporal series that are not much inherently correlative with the ssc fig 7 compares in form of daily time series of the ssc the best predicted results with the measured ones both models are capable of capturing its seasonal variations at low values however at high ssc values neither model produces acceptable outcomes fig 7a it is also noted that both models somewhat underestimate the ssc fig 7b the overall model performance especially for predictions of ssc peaks needs to be improved 4 2 the inarx model 4 2 1 wavelet function and decomposition level the established inarx model starts from the decomposition of the raw time series by the dwt the wavelet function and decomposition level are its two major attributes and need to be properly selected five common types of mother wavelets are the haar wavelet daubechies wavelet db coiflets coif symlets sym and the discrete meyer approximation dmey a wavelet function is characterized by its region of support and the number of vanishing moments the former is related to the wavelet span length which has an effect on the feature localization possessions of a signal the latter limits the wavelet s ability to represent the polynomial behavior or information of a signal shoaib et al 2016 for example the wavelet db4 represents a four coefficient polynomial that encodes a process with a constant a linear a quadratic and a cubic signal component in this study these five wavelets with different support regions and vanishing moments are employed for signal decomposition the haar and dmey have only one member each the other three are irregular wavelets addison paul 2002 the decomposition level l of a dwt is deemed as a major step for wavelet based models as it is associated with the decoding of the embedded seasonal and periodic variations in the time series shoaib et al 2014 for instance a signal at l 3 is composed of an approximation a 3 and three sub surmises d 1 d 2 and d 3 sub surmise d 1 captures the features of the raw signal up to 2 days d 2 and d 3 up to 2 4 and 4 8 days respectively the level l is determined by either trial and error kisi and shiri 2011 or an empirical approach nourani et al 2009 the latter is given by l int log n the expression considers only the length of the data series and is suitable for fully auto regressive data as the seasonal hydrological process is disregarded shoaib et al 2014 shoaib et al 2015 through trial and error graf et al 2019 and shoaib et al 2016 find that the model efficiency has a positive correlation with l as a result the signals are decomposed at their maximum possible level lm log2 n shoaib et al 2016 fig 8 exhibits the original discharge time series and its decomposed signals by coif3 with l 11 4 2 2 details scaling depending on l the dwt transforms a signal into a number of sub signals in the time and the frequency domain although the decomposition helps extract the hidden features of the time series it might also generate redundant inputs for machine learning models thus limiting their forecast performance and increasing computational costs hadi and tombul 2018 taormina et al 2016 a selection procedure is often desirable to remove the insignificant information for example khan et al 2020 suggest a correlation analysis between the details and the target those with low correlations below the average are eliminated this study proposes an intelligent approach to scale the details taking into consideration their overall effects on the target first the mggp uses all the details as inputs to evolve a population of potential solutions secondly with the identified pareto front members a comparative study is performed to determine the most effective solution and its corresponding dominant gene scaled detail to make a fair comparison between the proposed inarx and the stand alone mggp the model parameters adopted here for details scaling are the same as for the latter in section 4 1 as an example the water level data decomposed by the haar are used to demonstrate the creation of a new detail the original details are employed as predictors and their response as the observed ssc in the mggp modeling the risk exists in acquiring genes that are either performance neutral or offer little improvement on the performance in this case the resulting model becomes complex to identify and remove the horizontal bloat fig 9 depicts all the constructed potential solutions and the pareto optimal members in terms of the goodness of fit and model complexity the complexity is defined as the total number of nodes in the constituent trees of a solution for a single tree it is the sum of its own node count and all possible full sub trees a leaf node is also considered a full sub tree searson 2015 fig 10 shows an example of the calculation of the complexity of a simple three node gene this gene centric visualization allows to optimize the solution by selecting one with favorable simplicity and accuracy for instance among the pareto optimal models the one with the highest nse value green marked base model shows no advantage over others in simplicity and exhibits a comparative level of accuracy with some members fig 9 consequently it is replaced by a simple one without a significant loss in accuracy table 7 presents comparisons among the pareto optimal models with the base solution where δ complexity relative reduction in model complexity and δ nse relative loss in model accuracy from model 1 to 5 the nse value drops by only 4 8 while the simplicity gains significantly by 52 9 a further reduction in simplicity leads to an evident loss in model performance model 6 accordingly model 5 is treated as the optimal solution in which the gene weights are 0 068 0 631 0 089 0 067 and 0 045 respectively the second gene in this solution survives and is the most informative scaled detail 4 2 3 ssc forecast after decomposition and scaling the approximation and scaled details are transferred to the network for the prediction of ssc the narx network can be described as a combination of a feedforward neural network e g mlpnn and a linear auto regressive model with exogenous input this unique architecture generates a global feedback connection between the input and output layers enhancing model performance with respect to mapping non linear long term time series in a complex and dynamic environment to achieve faster convergence and better generalization the network is developed in an open loop mode where the observed ssc is given as the feedback input for multistep prediction the network is converted to a closed loop in which the predicted outputs are returned to the input layer three parameters input delay feedback delay and the number of hidden neurons affect the network efficiency however no rule of thumb are available to determine their values which are often attained by trial and error based on the results from the mlpnn and mggp section 4 1 the predictors with a three day lag give an acceptable estimation accordingly the input and feedback delay are set at three days the number of hidden neurons is adjusted multiple times the one producing the lowest errors remains similar to the mlpnn the inarx network is trained using the lm algorithm with the objective function of mse the forecast is considered convergent if the calculation reaches a maximum of 10 000 epochs or the mse drops below the threshold 0 01 table 8 presents the ssc predictions by the machine learning models and the empirical approach the former refers to the best performed mlpnn and mggp narx and the proposed inarx with the selected wavelets the latter refers to the sediment rating curve src the src is a simple and easy to implement approach for ssc estimations expressed in the form of s αqβ α and β are coefficients walling 1978 the training data in the machine learning modeling are employed to derive the src resulting in α 1 10 8 and β 1 82 for both the training and testing phases the src indicates cd values below 0 7 also with the highest estimation error rmse and mae among the evaluated models its negative nsc value suggests that the error variance is remarkably higher than that of the observations because of its oversimplified form the src approach fails to capture the nonlinear behaviors of the system thanks to its recursive network architecture the narx obtains automatically essential information from the historical features thus it demonstrates better estimation capability than the static mlpnn and mggp the inarx models generate the best prediction among all with an average nse 0 88 and 0 82 at the training and testing stage respectively their high performance is attributed to the combination of the wt and details scaling which facilitate noise reduction and feature extraction considering the overall performance the inarx with the coif3 wavelet ranks first with the best forecast results nse 0 86 and rmse 0 15 average of both stages while the one with the haar wavelet ranks last with nse 0 82 and rmse 0 17 the coif is constructed in such a way that both the wavelet and scaling function have vanishing moments allowing more accurate approximation of polynomial functions at different resolutions shoaib et al 2014 consequently the resulting model well captures the temporal features the haar is a single peaked wavelet suitable for time series approximated as a single peaked event e g runoff nourani et al 2011 as the ssc is by nature characterized by multiple peaks with varying durations the resulting model performs unsatisfactorily to further evaluate their performance the best behaved model in each category is assessed with all field data fig 11 compares the observed against the predicted results in the form of scatter plot and boxplot the former presents the difference between the two and the latter displays their statistics for the src although the data points scatter almost evenly around the perfect line green the dispersion is significant with large deviations which is evidenced by the nsc negative table 8 the mlpnn and mggp exhibit comparative prediction capability in comparison with the observed data the prediction has a smaller range and mean indicative of underestimation the inarx generates the most accurate forecast with the data statistics mean median range and interquartile close to those of the observations meanwhile all datasets lie closely around the perfect line in time series modeling error correlation is a proxy for model robustness appraisal describing how the forecast errors are related in time for perfect fitting there should be only one non zero value equals to the mse occurring at zero lag fig 12 shows error correlations of the best inarx model except for the one at zero lag they fall approximately within the 95 confidence bounds around zero this indicates that the estimation errors are completely uncorrelated with each other white noise and the model is adequately accurate 4 2 4 under flood conditions a robust model is expected to make accurate ssc forecasts in various circumstances even under extreme flow conditions during flood seasons the rapid flow changes in both time and magnitude render the ssc prediction a challenging task to evaluate the model capability three years with extreme floods 2004 2010 and 2012 are selected their peak flows are 53700 62400 and 63200 m3 s respectively often with short durations in 2004 for instance one flood event is formed within only three days with a peak discharge almost 30 times that of the pre flood days demonstrating better performance than others the inarx is chosen here for further evaluation the three years are treated as separate scenarios with the model re calibrated using the observed daily data fig 13 compares the measured and simulated ssc time series during the wet seasons june to september both the flow and sediment exhibit drastic daily variations as seen in the enlarged views fig 12b d and f the inarx provides reasonable ssc forecasts even with pronounced variations in magnitude and a short data length one year at both high and low ssc the predicted results are in good agreement with the observed ones for the three years the cd is equal to 0 86 0 83 and 0 85 respectively compared with the nine year ssc simulation 2004 2012 the model with one year input shows negligible deterioration in accuracy this is presumably attributed to the dynamic process of feeding back the network with past features thus allowing the network to uncover the connections between the historical and current system states therefore even under extreme conditions and with a limited length of data series the model is still adequate to capture the system behaviors based on the historical characteristic data as illustrated in the histograms in fig 14 most predictions fall within the 0 075 kg m3 error range for the selected years the portion of data within the 0 1 kg m3 error is 85 2 84 9 and 84 7 respectively in all scenarios the 0 2 kg m3 error range contains 95 of the data the errors follow a normal distribution except for some overestimation in 2004 where the data falling within 0 0 15 kg m3 are 7 9 more than within 0 15 0 kg m3 with its high adaptability the inarx is a powerful tool in applications with significant temporal changes 4 2 5 multistep prediction for decision making it is desirable to obtain predictions multiple steps ahead to evaluate the model ability of multistep forecasts a lead time lt from one week up to one month is set ssc fluctuations are dissimilar under different conditions and it is relatively easy to produce accurate results during the ssc stable seasons again the 2004 2010 and 2012 flood seasons are selected as the scenarios these settings aim to assess the network s capability for ssc forecast from a short to a long lt in different seasons for multistep predictions fig 15 presents the statistical indicators from june to september in the three years in almost all months the model accuracy declines as the lt becomes longer which is associated with the network s closed loop structure if the input layer were fed with the predicted results instead of the field data the prediction errors would accumulate with an increasing lt the errors become significant to achieve better forecast it is advisable to update the network with observed data as long as they are available in this paper an nsc 0 75 is considered a satisfactory result as suggested by moriasi et al 2007 at lt 1 week the nsc values are over 0 75 in nearly all months with an average of 0 78 at lt 2 weeks the predictions are acceptable only in a limited number of months e g in august and september 2010 with an nse mean of 0 62 at lt 2 weeks the network fails to generate accurate results with nsc 0 75 in all months therefore the model is capable of producing reliable ssc forecasts with lt 1 week a longer lt would give rise to lower model performance due to the accumulated errors the rmse grows with an increase in lt at the beginning of the flood season june the ssc is relatively stable for which the prediction error is low if the ssc fluctuations are significant e g in july and august it becomes demanding to capture the variations in september 2012 the low rmse values are possibly related to the single ssc peak during this period making it easier to map even with significant variations consequently it is concluded that the established inarx model is appropriate for multistep predictions with a one week lead time 4 3 discussion in a fluvial system ssc forecast is essential to understand its flow and sediment dynamics the conventional src method depends merely on the correlation between the discharge and the concentration which is inadequate for flows with high non linearity and non stationarity liu et al 2013 as demonstrated in previous studies the advances in machine learning provide an effective approach for the ssc forecast bayram et al 2012 lafdani et al 2013 liu et al 2013 one of its advantages and also challenges is to capture the characteristics in both time and frequency domains to this end this study suggests a hybrid dynamic neural network that couples with a data pre preprocessing framework as compared to the src approach the model offers a significant improvement in the ssc predictions in the testing phase the cd improves by 30 and the rmse reduces by 60 which demonstrates the superiority of soft computing methods liu et al 2013 rajaee et al 2009 the hybrid model also outperforms the stand alone mlpnn mggp and narx a combination of individual models is often beneficial to overcome their weakness thus generating better results graf et al 2019 khan et al 2020 tiwari and chatterjee 2010 consistent with jamei et al 2020 and liu et al 2013 the study manifests the effectiveness of wavelet decomposition in time series simulations in summary the proposed inarx is a reliable framework for real time and multistep forecast even under flood conditions despite its popular use in hydrological studies graf et al 2019 nanda et al 2016 shoaib et al 2015 singh 2012 dwt based models need to be carefully developed in order for real world applications as suggested by quilty and adamowski 2018 errors might be introduced if dwt is improperly used some common aspects include selection of decomposition levels and wavelet filters partition of calibration and validation data and inclusion of future information the first two issues can be addressed by using trial and error method or recommendations from previous studies the third one is certainly a limitation of dwt to minimize the errors a more robust approach is required in future research possible solutions include the use of maximal overlap discrete wavelet transform modwt quilty and adamowski 2018 in a natural river multiple factors affect the sediment dynamics inclusive of vegetation grain size soil conservation measures geographical properties etc fang et al 2011 yan and xu 2010 in the study only the flow discharge and water level are considered if possible one should take into account other governing factors to improve the model performance without any guidelines to follow the determination of the optimal number of hidden neurons remains a challenging task and also a trade off for a neural network a too large number of hidden neurons would exaggerate the overfitting risks while a too small number would circumscribe the model capability moreover the relationship between the hidden layer size and model performance is ambiguous which makes the search for its optimal value by trial and error a time consuming process therefore principles for this task should be developed in future studies 5 conclusions for the improved forecast of suspended sediment in river flows this study establishes a hybrid dynamic neural network denoted as inarx it is a nonlinear autoregressive network with exogenous inputs narx coupled with a data pre processing module the time series data are decomposed by wavelet transformation wt resulting in two types of subcomponents approximation and details the latter is processed by a multigene genetic programing mggp model to remove redundancy and construct informative ones the approximation and scaled details are then fed into the narx the resulting model is evaluated employing the daily hydrological records over a nine year period collected on the upper reaches of the yangtze river it is also compared with the sediment rating curve src approach and several conventional machine learning methods due to its oversimplified form the src method fails to capture the pattern of the ssc time series if high nonlinearity is present the mlpnn and mggp demonstrate a comparative level of capability comparisons between the modeled and observed ssc reveal that both methods generate reasonable estimations at low concentrations high concentrations during flood seasons are underestimated the narx s recursive network structure permits it to search for informative characteristics from the past system states consequently compared with the static mlpnn and mggp its accuracy averaged cd value is improved by 14 and 16 respectively as the wt helps decode the hidden information in the raw signals and the mggp removes non essential features the established inarx approach produces the best forecast the effects of different wavelet functions are examined which shows that the coif3 and haar wavelets generate the most and least accurate results with an average cd 0 87 and 0 82 the inarx with coif3 is further evaluated for ssc predictions in extreme flood events and for multistep forecast the 2004 2010 and 2012 years of high floods are chosen as independent scenarios under flood conditions the results indicate an average cd 0 86 0 83 and 0 85 the portion of data within the 0 1 kg m3 error range is 85 2 84 9 and 84 7 respectively for the multistep forecast the model performance at a lead time lt from one week to one month is explored during the wet seasons june september the model is capable of generate acceptable forecast at lt 1 week average cd 0 78 a larger lt leads to significant errors thanks to its unique architecture with data decomposition and details scaling that improves modeling robustness and adaptability the integrated dynamic neural network is a reliable option for more accurate predictions of river suspended sediment the suggested approach of data pre processing also provides reference for similar forecasts of hydrological events e g streamflow and rainfall runoff credit authorship contribution statement shicheng li conceptualization methodology validation formal analysis investigation writing original draft qiancheng xie data acquisition writing review editing james yang funding acquisition supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement as part of research projects at kth two phase flow modeling evaluations and simulations for safer spillway discharge and quality and trust of numerical modeling of water air flows for safe spillway discharge this study is funded by the swedish hydropower center svc and supervised by james yang and anders ansell svc has been established by the swedish energy agency energiforsk and svenska kraftnät together with luleå university of technology ltu royal institute of technology kth chalmers university of technology cth and uppsala university uu participating companies and industry associations include afry andritz hydro boliden fortum generation holmen energi jämtkraft karlstads energi lkab mälarenergi norconsult rainpower skellefteå kraft sollefteåforsens statkraft sverige sweco energuide sweco infrastructure tekniska verken i linköping uniper vattenfall r d vattenfall vattenkraft voith hydro wsp sverige and zinkgruvan the research project within river flow and sediment transport carried out by the second author q x is financed by the chinese scholarship council csc and the swedish standup for energy project and supervised by t staffan lundström and james yang 
3798,suspended sediment is of importance in river and dam engineering due to its high nonlinearity and stochasticity sediment prediction by conventional methods is a challenging task consequently this paper establishes a new hybrid model for an improved forecast of suspended sediment concentration ssc it is a nonlinear autoregressive network with exogenous inputs narx integrated with a data pre processing framework thereafter inarx in this model wavelet transformation wt is used for time series decomposition and multigene genetic programing mggp for details scaling the two incorporated modules improve time and frequency domain analysis allowing the network to unveil the embedded characteristics and capture the non stationarity at a hydrological station on the upper reaches of the yangtze river the records of daily water stage flow discharge and suspended sediment are collected and refer to a nine year period during 2004 2012 the data are used to evaluate the models several wavelets are explored showing that the coif3 leads to the most accurate prediction compared to the sediment rating curve src the conventional mggp multilayer perceptron neural network mlpnn and narx the inarx demonstrates the best forecast performance its mean coefficient of determination cd increases by 7 7 38 6 and the root mean squared error rmse reduces by 15 1 54 5 the inarx with the coif3 wavelet is further evaluated for flood events and multistep forecasts under flood conditions the model generates satisfactory results with cd 0 83 and 84 7 of the simulated data falling within the 0 1 kg m3 error for the multistep forecast at a one week lead time the network also yields predictions with acceptable accuracy mean cd 0 78 the model performance deteriorates if the lead time becomes larger the established framework is robust and reliable for real time and multistep ssc forecasts and provides reference for time series modeling e g streamflow river temperature and salinity keywords river suspended sediment wavelet transformation multigene genetic programing multilayer perceptron neural network inarx 1 introduction the presence of suspended sediment in river flows is an essential issue in terms of water quality river geological and geographical settings channel navigability operation of hydraulic structures river aesthetics and fish habitats kişi 2006 for instance from the perspective of water resources exploitation suspended sediment with high turbidity in river flows is a physical pollutant which may act as a chemical pollutant when carrying chemicals such as phosphorous and heavy metals doğan et al 2007 the transport of suspended sediment also affects erosion and deposition leading to river morphological changes liu et al 2013 defined as the ratio of sediment mass to volume of a sediment laden mixture suspended sediment concentration ssc characterizes a sediment transport process zheng et al 2011 accurate predictions of the ssc are of practical implications in a wide range of hydraulic issues including design of the reservoir dead storage environmental impact assessment and prediction of aggradation and degradation around bridge piers afan et al 2016 however the transport is a complex phenomenon involving both the flow and sediment motions and their interactions from the initial detachment of sediment particles to their deposition every stage is characterized by high nonlinearity and interplay processes rendering the ssc forecast a challenging task conventionally the ssc in a stream is determined via either direct field measurements or already established sediment transport equations bayram et al 2012 the former is an accurate approach with however some practical and cost disadvantages the latter refers to the use of the relationship between the ssc and flow properties including flow velocity discharge etc the approaches are usually developed based on simplified partial differential equations assumptions and empirical correlations for erosive effects of rainfall and flow aytek and kişi 2008 karim and kennedy 1990 mcbean and al nassri 1988 some sediment curves are also proposed for the estimation of ssc crowder et al 2007 petersen øverleir 2004 which are theoretically adequate to cope with the variations in catchment properties and uneven distribution of precipitation and evapotranspiration aytek and kişi 2008 however due to the scarcity of detailed spatial and temporal hydrological data applications of those methods suffer from limitations kisi et al 2012 moreover despite several established empirical models choosing an appropriate one for a specific scenario is difficult which is the reason why many of them do not gain expected acceptance afan et al 2016 some researchers even indicate that the sediment curves are misleading and the high goodness of fit is spurious mcbean and al nassri 1988 as a result efforts have been devoted to develop reliable methods for ssc predictions machine learning modeling offers an alternative in comparison with process driven methods machine learning models gain superiority in dealing with nonlinear issues and handling a large quantity of data with the help of artificial intelligence ai they demonstrate a great potential in mapping data with high complexity dynamism and non stationarity e g ssc time series the recent years have witnessed a rapid growth of ai based approaches in studying the ssc one of the first applications is made by jain 2001 where an integrated relation among water stage flow discharge and ssc is established using a feedforward neural network ffnn the resulting model leads to better predictions than the conventional curve fitting approach and is capable of modeling the hysteresis effects caused by unsteady flows in channels alp and cigizoglu 2007 examine the performance of the ffnn and radial basis function neural network rbfnn in sediment load estimations the combination of rainfall and flow data generates as predictors accurate results the two evaluated models exhibit insignificant differences melesse et al 2011 adopt a multilayer perceptron neural network mlpnn and use precipitation river flow and antecedent sediment data to predict the suspended sediment in three major u s rivers mississippi missouri and rio grande compared with the multiple linear and nonlinear regressions and autoregressive integrated moving average the mlpnn produces more satisfactory results demirci and baltaci 2013 explore the efficiency of fuzzy logic models in ssc estimations concluding that they behave better than the multiple linear regression method ehteram et al 2021 use the whale algorithm particle swarm optimization and bat algorithm to optimize the performance of an artificial neural network ann the hybrid models cut down the error up to 80 relative to the standard one doroudi et al 2021 integrate the observer teacher learner based optimization method into a support vector machine which outperforms all the evaluated ones afan et al 2016 provide a partial review of the relevant studies in the area due to its stochastic temporal variations time series modeling is a challenging task direct simulations might be inadequate to capture its features in both time and frequency domains consequently for better representation data pre processing techniques e g sampling transformation de noising and normalization are suggested to reformulate and reshape the raw signals in a rainfall forecast study mehr et al 2019 remove the non stationary features by performing square root and standardization of the original data such a procedure produces a weak stationary signal that is easy to model as the trend in the mean is separated and the variance is suppressed for better estimation of water table fluctuations jeong and park 2019 suggest a framework for detrending deseasonalization normalization and outlier exclusion this method by assuming consistency of the trends and stationarity of seasonal variability detects in an effective way the process changes that occur in a groundwater system if coupled with machine learning models it improves the efficiency of the standalone ones liu et al 2013 apply a wavelet for signal decomposition and integrate it with an ann for ssc forecast showing that wavelet helps better capture highly nonlinear and non stationary ssc a similar study by rajaee et al 2011 illustrates that the model is capable of obtaining useful information on various resolution levels shiri and kişi 2012 combine wavelet with gene expression programming gep neuro fuzzy nf and ann for sediment load prediction it is concluded that the wavelet based models significantly increase the accuracy of single ones these papers demonstrate the importance of data pre processing for time series modeling in most works the main regressors are static models e g ann and nf they are suitable for fitting problems and a more robust model is required for time series forecast nanda et al 2016 for a better ssc estimation this paper establishes a nonlinear auto regressive with external inputs narx network and couples it with a new wavelet based data pre processing module the narx a dynamic recurrent neural network is a superior network for handling non stationary issues the data pre processing framework takes the advantage of the discrete wavelet transformation for time and frequency analysis and the multigene genetic programming mggp for feature selection expecting to generate informative and noise free inputs for the regressor time series data of daily discharge water level and ssc during 2004 2012 collected at the cuntan station on the upper reaches of the yangtze river are used to test the proposed integrated narx inarx its performance is assessed statistically and compared with that of empirical and conventional data driven models the objective of this study is to put forward an improved neural network for real time and multistep forecasts of the river suspended sediment a robust prediction framework has profound engineering implications 2 methodology two static models mlpnn and mggp are first introduced as an essential element in the inarx wavelet transformation wt is described the inarx is established by integrating the wt and mggp to the narx allowing improved multistep forecasts the evaluation criteria are finally stated 2 1 multilayer perceptron neural network mlpnn an ann is a commonly used intelligent method in addressing various issues particularly for nonlinear systems an mlpnn is a popular type of ann in hydrological applications fig 1 presents its typical architecture the neurons are interconnected to each other between the layers with weight w and bias b at the input layer one neuron corresponds to one predictor at the output layer one neuron represents one response at the hidden layer the number of neurons depends on the complexity of the problem the signals are transferred in the forward direction without a loop the network is developed by minimizing the error between the network output y and target z through the adjustment of w and b the input x is first processed by an identity function and its outcome is then fed to the neurons at the hidden layer bishop 1995 for instance the signal netj that the j th hidden neuron receives from the input layer is expressed by 1 ne t j i 1 p x i w ij b j in which xi i th input variable wij weight between the i th input neuron and the j th hidden neuron bj bias at the j th hidden neuron and p number of inputs the net value netj is then processed by an activation function which generates a new signal and feeds into the output layer its value yj from the j th hidden neuron is computed by 2 y j f 1 n e t j f 1 i 1 p x i w ij b j where f 1 functional symbol the same technique is employed for both the hidden and the output layer the net weighted signal netk entering into the output layer is given by 3 ne t k j 1 q f 2 y j w jk b k j 1 q w jk f 2 i 1 p x i w ij b j b k where bk bias at the k th output neuron q number of hidden neurons and f 2 functional symbol in the end the outcome yk from the k th output neuron is calculated by 4 y k f 3 ne t k f 3 j 1 q w jk f 2 i 1 p x i w ij b j b k where f 3 functional symbol by updating w and b the algorithm iterates until it reaches the pre defined error limit 2 2 multigene genetic programing mggp the mggp model is a supervised evolutionary learning algorithm which adopts the concept of survival of the fittest khozani et al 2020 it combines linearly the low depth gene programing gp and creates a simplified solution with improved fitness a gp gene is a tree structured computer program with linking branches root inner and terminal nodes as shown in fig 2 this three level gene comprises one root node three inner nodes and four terminal nodes which are connected by linking branches mathematical operators the evolution of the mggp method starts from the creation of chromosomes which are then used as parents to produce offspring three genetic operations are involved in this process reproduction crossover and mutation in the reproduction the parent reproduces an offspring by solely copying itself thus no additional gene information is created in the crossover two new genes are generated by exchanging materials between their parents fig 3 a in the mutation a new gene is produced by replacing its sub tree structure with a random one controlled by the pre defined operation parameters fig 3b jamei et al 2020 summarize the primary development procedures in a mggp model define initial parameters functions sets population size number of generation rate of genetic operation and maximum number of genes generate a population of genes and create a solution with a number of them examine the model efficiency based on the objective function and produce new genes using the genetic operations and repeat the last step if the stopping criteria are not met in the end the mggp solution is constructed with low depth gp genes 5 y i 1 n g c i g i c where c constant ci i th gene weight of i th gene gi and ng number of survived genes both c and ci are determined by the least squares method 2 3 wavelet transformation wt the essential information of temporal data is usually veiled in the frequency domain and is not readily available in the time domain shoaib et al 2015 to reveal the key features of a time series data transformation is often performed the fourier transformation ft is one of the earliest methods used for frequency contents extraction however the time information is lost if transformed from the time to the frequency domain as an improvement the wt captures simultaneously the time and frequency information the wavelet in a wt refers to the finite length and oscillatory window function as its width varies with the transformation for every single spectral component the wt is particularly useful for feature extraction for time series data whose patterns are not apparent in its raw form the wt generates a time scale representation of the non stationary data and their relationships thus revealing their trends breakdown points and discontinuities singh 2012 specifically the original signal is decomposed into low and high frequency elements and is analyzed in the time and frequency domain this processing technique allows one to examine the unseen details of the raw data hence improving the computational accuracy of the data mining models jamei et al 2020 a wt is classified into continuous wt cwt and discrete wt dwt the major difference between them is how the scale parameters are discretized the cwt wa b t of a time series f t is expressed as 6 w a b t f t 1 a ψ t b a d t where t time ψ complex conjugate of the wavelet function or the mother wavelet ψ a dilation scale parameter and b translation position parameter the computation of the cwt coefficients at each a and b leads to a large number of data as an alternative the dwt employs the scaling low pass filter and wavelet high pass filter functions the scales and positions are based on the power of two dyadic scales and positions the w a b d in the dwt is given by 7 w a b d 2 j 2 1 j ψ 2 j 2 k f t d t where j and k real integers through the low and high pass filter the time series data are decomposed into two parts approximation a and details di the former represents the low frequency and high scale component and the latter the high frequency and low scale one the low and high frequency contents are analyzed by the low and high pass filters respectively the low frequency part reveals the identity of the signal and the high frequency one affects its flavor in this way the background information is captured by a and the trivial attributes of interpretational value are characterized by di tiwari and chatterjee 2010 the temporal data after the dwt are expressed by 8 f t a n i 1 n d i where n number of decomposition level 2 4 integrated nonlinear autoregressive network with exogenous inputs inarx as the core of our study the inarx is a recurrent network based model that couples with a data pre processing module shown in fig 4 this scheme is composed of three phases starting from the decomposition of signals by the dwt after division the choice of the dwt over the cwt is favored by high computational efficiency and easy implementation as suggested by kisi 2011 after the transformation the raw data are decomposed into two components approximation and details if the raw data include m elements and each of them is decomposed into l levels the total number of sub signals approximation and details after the dwt becomes m ml however not all of them are equally informative khan et al 2020 in the second phase the details are fed into the mggp to remove the redundant inputs that may deteriorate the model performance the mggp generates an explicit expression which consists of the inputs and indicates their contributions to the target although the mggp alone can act as a machine learning model it is employed as a selection tool to scale the details successful mggp applications as a selection tool are found in hadi and tombul 2018 and mehr and nourani 2017 as it combines linearly the gp trees to solely improve the fitness based on the objective function tends to yield a complex evolved solution which is likely to result in horizontal bloat and overfitting to cope with this the pareto front pf method is used to optimize the model in terms of both accuracy and complexity based on the concept of dominance with the pf at any instant consisting of non dominated solutions it is a multi objective optimization technique smits and kotanchek 2005 given a population of models the pf is composed of the members that outperform others in the pre defined criteria the methodological procedures are summarized as follows limiting the maximum number of genes to reduce the model complexity and overfitting risks calculating the expressional complexity of all evolved potential solutions comparing the model complexity of the whole population against their goodness of fit measure identifying the models that gain by comparison in terms of both accuracy and simplicity pareto front members selecting the scaled detail ds the one with the highest contribution to the target from the best model in the third phase the approximation and scaled details are used as inputs for the nonlinear auto regressive with external input narx network this dynamic network is composed of three layers similar to the mlpnn with recurrent connections from the past outputs which allows multistep forecast it is mathematically formulated as 9 y t f a t 1 a t δ t 1 d s t 1 d s t δ t 1 y t 1 y t δ t 2 in which y a and ds output approximation and scaled details t time δt 1 input delay δt 2 feedback delay and f functional symbol the delayed y is automatically fed backwards to the input layer thus the prediction is dependent on not only the exogenous parameters a and ds but also the previous output signals the delays in the external and feedback inputs sever as a short time memory of the network they also represent vectors that each signal must pass through after which all signals are available as an input for the next unit for a number of time steps the network is in a closed loop which may deteriorate computational efficiency and accuracy for a given training set the true outputs observations are available hence one can open the loop by feeding back the delayed observations instead of the estimated values as more accurate inputs are used the procedure leads to better predictions it also saves computational costs as the resulting network is in a simple feedforward architecture and static backpropagation is applied for model development in applications the network is in a closed loop for multistep ahead estimation the training of the network is achieved using the levenberg marquardt lm algorithm which is a combination of the steepest descent first order and gauss newton second order method the resulting configuration improves the computational speed of the former and enhances the numerical stability of the latter samarasinghe 2016 the weight update we 1 of the lm at e 1 epoch is defined by 10 w e 1 w e h e λ i 1 j e r e where e epoch number h hessian matrix λ variable scalar i identity matrix j jacobian matrix and r residual error vector the presence of j and the diagonal term λi leads to a positive definite h which shortens remarkably the computational time yu and wilamowski 2011 this fast and reliable second order local method has been successfully implemented in many studies e g adamowski and chan 2011 and daliakopoulos et al 2005 2 5 evaluation metrics for any prediction model its performance is statistically assessed in terms of coefficient of determination cd nash sutcliffe coefficient nsc root mean squared error rmse and mean absolute error mae the first two describe the goodness of fit and the last two quantify the estimation error these indices are usually used in the evaluation of machine learning models adamowski and chan 2011 dayev 2020 the cd index indicates how well the observed observation o is replicated by the simulation s 11 cd i 1 n o i o s i s i 1 n o i o 2 i 1 n s i s 2 2 where oi i th observation si i th simulation o mean of observations s mean of simulations and n number of data cd 1 0 represents a perfect fit and cd 0 75 is often considered a satisfactory result motovilov et al 1999 the nsc index assesses the predictive skill of a hydrological model defined as 12 nsc 1 i 1 n o i s i 2 i 1 n o i o 2 nsc 1 0 corresponds to an ideal estimation a negative nsc value occurs if the simulation error variance is significantly larger than the observation one nsc 0 75 is generally an acceptable result moriasi et al 2007 the rmse index measures the discrepancy between the modeled and observed values given by 13 rmse i 1 n o i s i 2 n it ranges from zero to infinitive with rmse 0 indicating a perfect match between the observation and estimation conversely a large rmse value indicates the inadequacy of the prediction model the mae index shows the mean of all individual errors computed by 14 mae 1 n i 1 n o i s i the rmse and mae are error statistics and are case dependent the closer to zero the better 3 study site and data source 3 1 study site to evaluate the developed inarx model the cuntan hydrological station on the upper reaches of the yangtze river is chosen as the study site the river basin covers an area of 1 8 106 km2 accounting for approximately one fifth of the land area of china fig 5 originating in the qinghai tibet plateau about 5100 m above the mean sea level the river flows eastwards through a number of major cities including chongqing and finally into the east china sea in shanghai globally it ranks third in length 6300 km fourth in sediment flux 470 mt year and fifth in flow discharge 900 km3 year yang et al 2018 the cuntan station 106 60 e 29 62 n is situated downtown in chongqing city some 606 km upstream of the well known three gorges dam its catchment area is 8 67 105 km2 it is one of the major measurement stations on the upper river reaches with daily records of flow sediment water quality and other parameters a few kilometers up and downstream of the station the river course is slightly curved in planform however without significant variations in cross section measured at the normal water levels the river width ranges between 500 and 600 m the average water depth amounts to 20 m during a year the river runoff varies considerably the multi year average runoff is 3 40 1011 m3 the river flow carries sediment in form of both bedload and suspended load on a multi year average basis the total sediment flux amounts to 3 74 108 t with ssc 1 09 kg m3 the bedload mainly composed of cobbles and sand is limited in amount only 2 50 104 t year 3 2 data source the study is based upon the daily hydrological records from january 1 2004 to december 31 2012 collected from the yangtze water resources commission www cjw gov cn the data refer to flow discharge q water level elevation z and the ssc for the q measurement an acoustic doppler current profiler adcp attached to a customized motorboat with gps positioning measures water depth and flow velocity at the pre determined cross section the boat goes perpendicular to the stream at a constant cruising speed the velocity measurement error is 5 cm s pressure sensors monitor the water depth with 1 cm accuracy the relative q error is by estimate below 5 to measure the ssc along the transection plumb lines are first positioned the number of which depends on the river width along each line the suspended load is with point integrative water samplers sampled at several equidistant positions and the corresponding flow velocities are also measured with the velocity and ssc the cross sectional sediment flux is calculated with the elapse of time the measurement techniques are upgraded at regular intervals some manual undertakings are replaced by automatic procedures at the station the collected daily series amount to a total of 3289 data sets and are divided into training and testing data with a ratio of 7 3 table 1 presents the statistics of the field data at both stages in which sd standard deviation and cv coefficient of variation 4 results and discussion with the time series of the hydrological data the mlpnn mggp and inarx models are assessed and compared in the first two methods a short term memory structure is used to improve their learning performance with signal decomposition by wavelet functions and details scaling by the mggp the proposed inarx model that combines a feedforward neural network with a non linear auto regressive model provides improved river sediment forecasts all the models are coded in matlab version r2021a on a pc model dell precision 7872 tower processor inter r xeon r gold 5215 cpu 2 5 ghz 4 1 the mlpnn and mggp models 4 1 1 memory depth the stand alone mlpnn and mggp models are first established for ssc forecasts as benchmarks as the former is a well known model and the latter is a component of the proposed framework to utilize the temporal information of the time series data a short term memory structure is suggested in the input layer achieved by feeding the network with lagged data this is an essential step for the development of hydrological models as the system response is inherently dependent on its past states consequently a memory structure would help encode the temporal features and improve the learning performance the selection of the time lag or memory depth is a vital yet challenging task for which there are mainly two approaches one employs the auto correlation function acf and partial auto correlation function pacf to obtain suitable input vectors sudheer et al 2002 despite their wide use some argue that those functions are incapable of capturing the nonlinear features of hydrological systems and fail to discover their full relationship nayak et al 2004 senthil kumar et al 2005 the other is the so called window sliding method moosavi et al 2013 riad et al 2004 in which the initial input sequence comprises the data with a lag of one time step and is then adjusted by successively adding longer lag up to a specific value the optimal lag is based on the estimation accuracy determined by a trial and error method in this study the two methods are combined to select an appropriate memory depth to identify the dominant input space vectors the acf and pacf are performed to analyze the ssc time series shown in fig 6 the former demonstrates an oscillating pattern and annual periodicity of the ssc data similar to the year to year dependency of the rainfall and streamflow series aksoy and dahamsheh 2009 rahmani rezaeieh et al 2020 the latter shows that the current time system state is closely correlated with the ones with one and three day lag a larger time lag exhibits limited impacts accordingly predictors with those lags are used for the ssc prediction e g s t f 1 iv t 1 iv t 3 in which iv input vector and f 1 functional symbol it should be noted that the iv consists of z or q or both for the window sliding method time lags starting from one day up to five days are considered the resulting input configurations m1 m12 from both methods are listed in table 2 4 1 2 model application the mlpnn features a supervised learning process the lagged predictors are used as the input and the current time observations as the target the lm algorithm is employed to train the network the simulation error is propagated backwards to adjust the network weights and biases the network has sigmoid hidden neurons and linear output neurons with the optimal number of hidden neurons attained by a trial and error procedure the mean squared error mse is set as the fitness function the calculation is terminated if the training reaches a maximum of 10 000 epochs or the mse drops below the threshold 0 01 table 3 in the mggp model the number of genes is limited to five and each has a maximum depth of four the initial population size is 300 and the maximum number of generations is 150 after some trials the reproduction crossover and mutation rate are adjusted to 0 2 0 84 and 0 14 respectively in search for accurate models the function sets i e addition subtraction multiplication division square root and sine are found effective the simulation is run multiple times to achieve high generalization with a total number of 1500 potential solutions generated for each input scenario the model setups are summarized in table 4 the performance metrics of the mlpnn and mggp models are shown in tables 5 and 6 respectively for both models the use of only one and three day lagged water level m1 seems to fail to generate accurate results which is presumably due to the lack of informative features compared to m1 the m2 prediction exhibits remarkable improvement indicative of the significance of the discharge from a physical point of view the discharge affects directly the ssc its presence provides essential information for the learning of system behaviors a combination of multiple past states helps better interpret the temporal ssc variations thus leading to high accuracy m3 as given only one specific lagged time e g one day delay m4 m8 show a less satisfactory behavior in comparison with m3 with the lag enlarged from one m4 to five days m8 the forecasting ability deteriorates for both mlpnn and mggp the average cd values training and testing become for instance 21 lower the rmse values are 15 higher for the former and 20 higher for the latter among all the tested ones the m10 input vector produces the most accurate estimation it is also noted that enlarging the lags would worsen its performance m11 m12 which is presumably attributed to the redundancy of those temporal series that are not much inherently correlative with the ssc fig 7 compares in form of daily time series of the ssc the best predicted results with the measured ones both models are capable of capturing its seasonal variations at low values however at high ssc values neither model produces acceptable outcomes fig 7a it is also noted that both models somewhat underestimate the ssc fig 7b the overall model performance especially for predictions of ssc peaks needs to be improved 4 2 the inarx model 4 2 1 wavelet function and decomposition level the established inarx model starts from the decomposition of the raw time series by the dwt the wavelet function and decomposition level are its two major attributes and need to be properly selected five common types of mother wavelets are the haar wavelet daubechies wavelet db coiflets coif symlets sym and the discrete meyer approximation dmey a wavelet function is characterized by its region of support and the number of vanishing moments the former is related to the wavelet span length which has an effect on the feature localization possessions of a signal the latter limits the wavelet s ability to represent the polynomial behavior or information of a signal shoaib et al 2016 for example the wavelet db4 represents a four coefficient polynomial that encodes a process with a constant a linear a quadratic and a cubic signal component in this study these five wavelets with different support regions and vanishing moments are employed for signal decomposition the haar and dmey have only one member each the other three are irregular wavelets addison paul 2002 the decomposition level l of a dwt is deemed as a major step for wavelet based models as it is associated with the decoding of the embedded seasonal and periodic variations in the time series shoaib et al 2014 for instance a signal at l 3 is composed of an approximation a 3 and three sub surmises d 1 d 2 and d 3 sub surmise d 1 captures the features of the raw signal up to 2 days d 2 and d 3 up to 2 4 and 4 8 days respectively the level l is determined by either trial and error kisi and shiri 2011 or an empirical approach nourani et al 2009 the latter is given by l int log n the expression considers only the length of the data series and is suitable for fully auto regressive data as the seasonal hydrological process is disregarded shoaib et al 2014 shoaib et al 2015 through trial and error graf et al 2019 and shoaib et al 2016 find that the model efficiency has a positive correlation with l as a result the signals are decomposed at their maximum possible level lm log2 n shoaib et al 2016 fig 8 exhibits the original discharge time series and its decomposed signals by coif3 with l 11 4 2 2 details scaling depending on l the dwt transforms a signal into a number of sub signals in the time and the frequency domain although the decomposition helps extract the hidden features of the time series it might also generate redundant inputs for machine learning models thus limiting their forecast performance and increasing computational costs hadi and tombul 2018 taormina et al 2016 a selection procedure is often desirable to remove the insignificant information for example khan et al 2020 suggest a correlation analysis between the details and the target those with low correlations below the average are eliminated this study proposes an intelligent approach to scale the details taking into consideration their overall effects on the target first the mggp uses all the details as inputs to evolve a population of potential solutions secondly with the identified pareto front members a comparative study is performed to determine the most effective solution and its corresponding dominant gene scaled detail to make a fair comparison between the proposed inarx and the stand alone mggp the model parameters adopted here for details scaling are the same as for the latter in section 4 1 as an example the water level data decomposed by the haar are used to demonstrate the creation of a new detail the original details are employed as predictors and their response as the observed ssc in the mggp modeling the risk exists in acquiring genes that are either performance neutral or offer little improvement on the performance in this case the resulting model becomes complex to identify and remove the horizontal bloat fig 9 depicts all the constructed potential solutions and the pareto optimal members in terms of the goodness of fit and model complexity the complexity is defined as the total number of nodes in the constituent trees of a solution for a single tree it is the sum of its own node count and all possible full sub trees a leaf node is also considered a full sub tree searson 2015 fig 10 shows an example of the calculation of the complexity of a simple three node gene this gene centric visualization allows to optimize the solution by selecting one with favorable simplicity and accuracy for instance among the pareto optimal models the one with the highest nse value green marked base model shows no advantage over others in simplicity and exhibits a comparative level of accuracy with some members fig 9 consequently it is replaced by a simple one without a significant loss in accuracy table 7 presents comparisons among the pareto optimal models with the base solution where δ complexity relative reduction in model complexity and δ nse relative loss in model accuracy from model 1 to 5 the nse value drops by only 4 8 while the simplicity gains significantly by 52 9 a further reduction in simplicity leads to an evident loss in model performance model 6 accordingly model 5 is treated as the optimal solution in which the gene weights are 0 068 0 631 0 089 0 067 and 0 045 respectively the second gene in this solution survives and is the most informative scaled detail 4 2 3 ssc forecast after decomposition and scaling the approximation and scaled details are transferred to the network for the prediction of ssc the narx network can be described as a combination of a feedforward neural network e g mlpnn and a linear auto regressive model with exogenous input this unique architecture generates a global feedback connection between the input and output layers enhancing model performance with respect to mapping non linear long term time series in a complex and dynamic environment to achieve faster convergence and better generalization the network is developed in an open loop mode where the observed ssc is given as the feedback input for multistep prediction the network is converted to a closed loop in which the predicted outputs are returned to the input layer three parameters input delay feedback delay and the number of hidden neurons affect the network efficiency however no rule of thumb are available to determine their values which are often attained by trial and error based on the results from the mlpnn and mggp section 4 1 the predictors with a three day lag give an acceptable estimation accordingly the input and feedback delay are set at three days the number of hidden neurons is adjusted multiple times the one producing the lowest errors remains similar to the mlpnn the inarx network is trained using the lm algorithm with the objective function of mse the forecast is considered convergent if the calculation reaches a maximum of 10 000 epochs or the mse drops below the threshold 0 01 table 8 presents the ssc predictions by the machine learning models and the empirical approach the former refers to the best performed mlpnn and mggp narx and the proposed inarx with the selected wavelets the latter refers to the sediment rating curve src the src is a simple and easy to implement approach for ssc estimations expressed in the form of s αqβ α and β are coefficients walling 1978 the training data in the machine learning modeling are employed to derive the src resulting in α 1 10 8 and β 1 82 for both the training and testing phases the src indicates cd values below 0 7 also with the highest estimation error rmse and mae among the evaluated models its negative nsc value suggests that the error variance is remarkably higher than that of the observations because of its oversimplified form the src approach fails to capture the nonlinear behaviors of the system thanks to its recursive network architecture the narx obtains automatically essential information from the historical features thus it demonstrates better estimation capability than the static mlpnn and mggp the inarx models generate the best prediction among all with an average nse 0 88 and 0 82 at the training and testing stage respectively their high performance is attributed to the combination of the wt and details scaling which facilitate noise reduction and feature extraction considering the overall performance the inarx with the coif3 wavelet ranks first with the best forecast results nse 0 86 and rmse 0 15 average of both stages while the one with the haar wavelet ranks last with nse 0 82 and rmse 0 17 the coif is constructed in such a way that both the wavelet and scaling function have vanishing moments allowing more accurate approximation of polynomial functions at different resolutions shoaib et al 2014 consequently the resulting model well captures the temporal features the haar is a single peaked wavelet suitable for time series approximated as a single peaked event e g runoff nourani et al 2011 as the ssc is by nature characterized by multiple peaks with varying durations the resulting model performs unsatisfactorily to further evaluate their performance the best behaved model in each category is assessed with all field data fig 11 compares the observed against the predicted results in the form of scatter plot and boxplot the former presents the difference between the two and the latter displays their statistics for the src although the data points scatter almost evenly around the perfect line green the dispersion is significant with large deviations which is evidenced by the nsc negative table 8 the mlpnn and mggp exhibit comparative prediction capability in comparison with the observed data the prediction has a smaller range and mean indicative of underestimation the inarx generates the most accurate forecast with the data statistics mean median range and interquartile close to those of the observations meanwhile all datasets lie closely around the perfect line in time series modeling error correlation is a proxy for model robustness appraisal describing how the forecast errors are related in time for perfect fitting there should be only one non zero value equals to the mse occurring at zero lag fig 12 shows error correlations of the best inarx model except for the one at zero lag they fall approximately within the 95 confidence bounds around zero this indicates that the estimation errors are completely uncorrelated with each other white noise and the model is adequately accurate 4 2 4 under flood conditions a robust model is expected to make accurate ssc forecasts in various circumstances even under extreme flow conditions during flood seasons the rapid flow changes in both time and magnitude render the ssc prediction a challenging task to evaluate the model capability three years with extreme floods 2004 2010 and 2012 are selected their peak flows are 53700 62400 and 63200 m3 s respectively often with short durations in 2004 for instance one flood event is formed within only three days with a peak discharge almost 30 times that of the pre flood days demonstrating better performance than others the inarx is chosen here for further evaluation the three years are treated as separate scenarios with the model re calibrated using the observed daily data fig 13 compares the measured and simulated ssc time series during the wet seasons june to september both the flow and sediment exhibit drastic daily variations as seen in the enlarged views fig 12b d and f the inarx provides reasonable ssc forecasts even with pronounced variations in magnitude and a short data length one year at both high and low ssc the predicted results are in good agreement with the observed ones for the three years the cd is equal to 0 86 0 83 and 0 85 respectively compared with the nine year ssc simulation 2004 2012 the model with one year input shows negligible deterioration in accuracy this is presumably attributed to the dynamic process of feeding back the network with past features thus allowing the network to uncover the connections between the historical and current system states therefore even under extreme conditions and with a limited length of data series the model is still adequate to capture the system behaviors based on the historical characteristic data as illustrated in the histograms in fig 14 most predictions fall within the 0 075 kg m3 error range for the selected years the portion of data within the 0 1 kg m3 error is 85 2 84 9 and 84 7 respectively in all scenarios the 0 2 kg m3 error range contains 95 of the data the errors follow a normal distribution except for some overestimation in 2004 where the data falling within 0 0 15 kg m3 are 7 9 more than within 0 15 0 kg m3 with its high adaptability the inarx is a powerful tool in applications with significant temporal changes 4 2 5 multistep prediction for decision making it is desirable to obtain predictions multiple steps ahead to evaluate the model ability of multistep forecasts a lead time lt from one week up to one month is set ssc fluctuations are dissimilar under different conditions and it is relatively easy to produce accurate results during the ssc stable seasons again the 2004 2010 and 2012 flood seasons are selected as the scenarios these settings aim to assess the network s capability for ssc forecast from a short to a long lt in different seasons for multistep predictions fig 15 presents the statistical indicators from june to september in the three years in almost all months the model accuracy declines as the lt becomes longer which is associated with the network s closed loop structure if the input layer were fed with the predicted results instead of the field data the prediction errors would accumulate with an increasing lt the errors become significant to achieve better forecast it is advisable to update the network with observed data as long as they are available in this paper an nsc 0 75 is considered a satisfactory result as suggested by moriasi et al 2007 at lt 1 week the nsc values are over 0 75 in nearly all months with an average of 0 78 at lt 2 weeks the predictions are acceptable only in a limited number of months e g in august and september 2010 with an nse mean of 0 62 at lt 2 weeks the network fails to generate accurate results with nsc 0 75 in all months therefore the model is capable of producing reliable ssc forecasts with lt 1 week a longer lt would give rise to lower model performance due to the accumulated errors the rmse grows with an increase in lt at the beginning of the flood season june the ssc is relatively stable for which the prediction error is low if the ssc fluctuations are significant e g in july and august it becomes demanding to capture the variations in september 2012 the low rmse values are possibly related to the single ssc peak during this period making it easier to map even with significant variations consequently it is concluded that the established inarx model is appropriate for multistep predictions with a one week lead time 4 3 discussion in a fluvial system ssc forecast is essential to understand its flow and sediment dynamics the conventional src method depends merely on the correlation between the discharge and the concentration which is inadequate for flows with high non linearity and non stationarity liu et al 2013 as demonstrated in previous studies the advances in machine learning provide an effective approach for the ssc forecast bayram et al 2012 lafdani et al 2013 liu et al 2013 one of its advantages and also challenges is to capture the characteristics in both time and frequency domains to this end this study suggests a hybrid dynamic neural network that couples with a data pre preprocessing framework as compared to the src approach the model offers a significant improvement in the ssc predictions in the testing phase the cd improves by 30 and the rmse reduces by 60 which demonstrates the superiority of soft computing methods liu et al 2013 rajaee et al 2009 the hybrid model also outperforms the stand alone mlpnn mggp and narx a combination of individual models is often beneficial to overcome their weakness thus generating better results graf et al 2019 khan et al 2020 tiwari and chatterjee 2010 consistent with jamei et al 2020 and liu et al 2013 the study manifests the effectiveness of wavelet decomposition in time series simulations in summary the proposed inarx is a reliable framework for real time and multistep forecast even under flood conditions despite its popular use in hydrological studies graf et al 2019 nanda et al 2016 shoaib et al 2015 singh 2012 dwt based models need to be carefully developed in order for real world applications as suggested by quilty and adamowski 2018 errors might be introduced if dwt is improperly used some common aspects include selection of decomposition levels and wavelet filters partition of calibration and validation data and inclusion of future information the first two issues can be addressed by using trial and error method or recommendations from previous studies the third one is certainly a limitation of dwt to minimize the errors a more robust approach is required in future research possible solutions include the use of maximal overlap discrete wavelet transform modwt quilty and adamowski 2018 in a natural river multiple factors affect the sediment dynamics inclusive of vegetation grain size soil conservation measures geographical properties etc fang et al 2011 yan and xu 2010 in the study only the flow discharge and water level are considered if possible one should take into account other governing factors to improve the model performance without any guidelines to follow the determination of the optimal number of hidden neurons remains a challenging task and also a trade off for a neural network a too large number of hidden neurons would exaggerate the overfitting risks while a too small number would circumscribe the model capability moreover the relationship between the hidden layer size and model performance is ambiguous which makes the search for its optimal value by trial and error a time consuming process therefore principles for this task should be developed in future studies 5 conclusions for the improved forecast of suspended sediment in river flows this study establishes a hybrid dynamic neural network denoted as inarx it is a nonlinear autoregressive network with exogenous inputs narx coupled with a data pre processing module the time series data are decomposed by wavelet transformation wt resulting in two types of subcomponents approximation and details the latter is processed by a multigene genetic programing mggp model to remove redundancy and construct informative ones the approximation and scaled details are then fed into the narx the resulting model is evaluated employing the daily hydrological records over a nine year period collected on the upper reaches of the yangtze river it is also compared with the sediment rating curve src approach and several conventional machine learning methods due to its oversimplified form the src method fails to capture the pattern of the ssc time series if high nonlinearity is present the mlpnn and mggp demonstrate a comparative level of capability comparisons between the modeled and observed ssc reveal that both methods generate reasonable estimations at low concentrations high concentrations during flood seasons are underestimated the narx s recursive network structure permits it to search for informative characteristics from the past system states consequently compared with the static mlpnn and mggp its accuracy averaged cd value is improved by 14 and 16 respectively as the wt helps decode the hidden information in the raw signals and the mggp removes non essential features the established inarx approach produces the best forecast the effects of different wavelet functions are examined which shows that the coif3 and haar wavelets generate the most and least accurate results with an average cd 0 87 and 0 82 the inarx with coif3 is further evaluated for ssc predictions in extreme flood events and for multistep forecast the 2004 2010 and 2012 years of high floods are chosen as independent scenarios under flood conditions the results indicate an average cd 0 86 0 83 and 0 85 the portion of data within the 0 1 kg m3 error range is 85 2 84 9 and 84 7 respectively for the multistep forecast the model performance at a lead time lt from one week to one month is explored during the wet seasons june september the model is capable of generate acceptable forecast at lt 1 week average cd 0 78 a larger lt leads to significant errors thanks to its unique architecture with data decomposition and details scaling that improves modeling robustness and adaptability the integrated dynamic neural network is a reliable option for more accurate predictions of river suspended sediment the suggested approach of data pre processing also provides reference for similar forecasts of hydrological events e g streamflow and rainfall runoff credit authorship contribution statement shicheng li conceptualization methodology validation formal analysis investigation writing original draft qiancheng xie data acquisition writing review editing james yang funding acquisition supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement as part of research projects at kth two phase flow modeling evaluations and simulations for safer spillway discharge and quality and trust of numerical modeling of water air flows for safe spillway discharge this study is funded by the swedish hydropower center svc and supervised by james yang and anders ansell svc has been established by the swedish energy agency energiforsk and svenska kraftnät together with luleå university of technology ltu royal institute of technology kth chalmers university of technology cth and uppsala university uu participating companies and industry associations include afry andritz hydro boliden fortum generation holmen energi jämtkraft karlstads energi lkab mälarenergi norconsult rainpower skellefteå kraft sollefteåforsens statkraft sverige sweco energuide sweco infrastructure tekniska verken i linköping uniper vattenfall r d vattenfall vattenkraft voith hydro wsp sverige and zinkgruvan the research project within river flow and sediment transport carried out by the second author q x is financed by the chinese scholarship council csc and the swedish standup for energy project and supervised by t staffan lundström and james yang 
3799,lake bathymetry which provides crucial information for water resource management has been widely used in hydrological ecological and geomorphological studies restricted by the high cost of conventional full covered lake field surveys and the large uncertainty of spatial prediction method that models lake underwater depths from the surrounding exposed terrains the knowledge on lake bathymetry worldwide is scarce and inconsistent this study aims to solve the problem by investigating how the optimized spatial prediction methods are developed by combining limited field survey data two methods namely the skeleton based interpolation method that extends the exposed topography toward the lake underwater area with a constraint of field surveys and the machine learning method xgboost that establishes the decision rule between measured water depths and multiple geospatial variables to predict depths of unknown underwater areas were developed and tested in twelve representative lakes in the tibetan plateau our results suggest that both methods can provide acceptable estimations of underwater topography by comparing with measured data with the mean r2 of 0 70 approximately the overall performance of the machine learning method xgboost is more reliable with the biases less than 20 in water volume estimates for all lake cases in comparison the skeleton based interpolation method outperforms lakes in long and narrow shapes this study is expected to provide an efficient approach for modeling lake bathymetry and to improve the monitoring capacity of freshwater mass changes especially for ungauged lakes in harsh environments keywords lake bathymetry water storage dem field survey spatial prediction machine learning 1 introduction lakes holding 87 of earth s surface liquid freshwater serve as primary water sources for human activities and provide critical ecosystem services downing et al 2006 verpoorter et al 2014 woolway et al 2020 the essential roles of lakes in climate and biogeochemical cycling are intimately related to their surface area shoreline and bathymetry as a key component of lake properties lake bathymetry determines the depth and stored water volume of a lake chen et al 2022 messager et al 2016 qiao et al 2017 and involves various studies such as lake eutrophication control qin et al 2020 lake hydrodynamic modeling dargahi setegn 2011 and submerged aquatic assessment zhang et al 2015 the most accurate and reliable way to generate a bathymetry map is through hydrologic surveys using sonar mounted on a boat qiao et al 2017 or controlled by an unmanned aerial vehicle bandini et al 2018 however such a time consuming and labor intensive method is hard to be applied for large scale investigations airborne lidar is an effective technology for water depth mapping using a green wavelength laser to penetrate the water column saylam et al 2017 tonina et al 2019 currently bathymetric lidar systems are widely used in shallow and favorable water conditions e g river and coastal zone kasvi et al 2019 nevertheless the maximum depth of airborne lidar is usually less than two times the secchi depth measurement preventing its application in inland water with high depth and turbidity bandini et al 2018 a few studies have recently focused on satellite estimation of lake bathymetry using optical images and satellite altimetry ma et al 2019 2020 pereira et al 2019 satellite based bathymetric mapping has been proven effective in intermittently inundated areas however obtaining topographic information in permanently standing water areas remains challenging some spatial prediction and modeling methods are also proposed to overcome such difficulties mentioned above by predicting underwater bathymetry using lake surrounding exposed terrains the relationships between topographic variables and lake bathymetry including lake depth and lake volume have been investigated thoroughly supporting the establishment of a geostatistical model for lake water depth and volume estimation at regional or even global scales cael et al 2017 messager et al 2016 these estimates are generally acceptable for large scale studies because of the offset effect of underestimation and overestimation however the uncertainty and potential bias of specific lakes or local scales cannot be ignored as for lake individuals the linear extrapolation of lakes surrounding topographic slopes can be a simple solution to derive lake bathymetry in which the bottom topography is defined by the intersection of all extrapolated lines satellite altimetry is applied to calibrate elevation values within the water fluctuating region armon et al 2020 li et al 2020 however the predicted bathymetry of permanently inundated area is usually unrealistic unless the raw digital terrain model dem is acquired during a low water level period li et al 2021 zhang et al 2016 few studies suggest that a small number of in situ measurements of lake water depth can be indispensable for constraining extrapolation accuracy getirana et al 2018 therefore an effective spatial modeling approach with an optimized topographic variable set at a feasible condition of obtaining limited field surveys should be determined in this study we aim to develop two methods for robust modeling of lake bathymetry based only on one or two routes of water depth surveys instead of full coverage lake water depth measurements these methods can considerably save labor and economic cost for regional lake investigation particularly for remote access locations and areas with harsh environments tibetan plateau tp hosts a large number of lakes accounting for approximately 60 of china s lake area however few measured data of lakes in tp have been collected because of high altitude and poor accessibility in this study 12 lakes in tp with different sizes climates underlying surface of catchments and geomorphological and topographic features were chosen to assess the performances of our proposed approaches comprehensive analyses and discussions regarding depth prediction accuracy influences of key model parameters and the application potential of modeled lake bathymetry were provided 2 study sites and datasets 2 1 study sites tp owns 1600 lakes 1 km2 covering an area of 5 104 km2 zhang et al 2019a 2019b however the bathymetric data for most tp lakes are lacking an ongoing project is conducted to estimate the absolute lake volume with low uncertainty by obtaining bathymetric data covering 100 large lakes 10 km2 liu et al 2021 zhang et al 2020 as introduced in the preceding section 12 lake cases in the tp were studied for modeling test the bathymetric data for these 12 testing lakes are available from historical surveys as detailed in table 1 all selected lakes with different sizes ranging from 99 75 km2 to 967 77 km2 are distributed at the high altitude region 4000 m the selected lakes represent various characteristics in terms of lake area shape surrounding terrains and mean lake depth to verify the application robustness of our proposed methods all the basic information of the selected lakes is listed in table 1 2 2 study materials in situ water depth data are required to implement the proposed approach in this study we collected survey data or bathymetric maps from published literatures table 1 for example qiao et al 2017 released the bathymetric maps of four lakes on the northwestern tp which were measured using a boat mounted sounder after digitizing isobaths for each lake we derived their lake bathymetry as shown in fig 1 b 1d the full captured bathymetries of the selected lakes provided the in situ data according to the planned survey route the derived bathymetry was also regarded as a reference for the evaluation of predicted result accuracy besides the in situ underwater topographic measurements the dem data describing the exposed terrains surrounding the lake were applied for the spatial prediction and extrapolation in this study among all the open access dems merit dem yamazaki et al 2017 was selected because of its three advantages first the data source of merit dem is mainly from srtm dem which was captured in 2000 as most lakes in tp experienced a dramatic expansion trend since 2000 luo et al 2021 song et al 2013 srtm dem and its improved version merit dem can capture more exposed areas second the high accuracy of merit dem in tp has been proven in previous studies liu et al 2019 with a low value of root mean square error rmse 8 60 m and few void filling anomalies third merit dem data format is in floating point type which can avoid the data precision loss comparing with the integer type as the spatial resolution of the merit dem is 3 arcsec 90 m at the equator all raster data used or generated in this study were resampled to the 90 m cell size 3 methodology 3 1 basic idea the proposed methods for modeling the lake bathymetry were based on the underlying assumption that the lake underwater topography could be considered a spatial extension of the surrounding exposed terrains with the long term tectonic and geophysical evolution processes xiong et al 2021 for example the exposed areas surrounding the modern lake shoreline were inundated areas in the period of great lake jia et al 2001 hence the topographic variables within the lake surrounding areas i e slope elevation difference can be used to predict lake bathymetry heathcote et al 2015 however the majority of modern lakes possess a deep water and flattened bottom area with a bowl like shape because of the historical sediment accumulation messager et al 2016 the depth of sedimentation layers brings large uncertainty to lake bathymetry estimation zhu et al 2019 thus developing a field survey independent approach for lake bathymetry reconstruction is still challenging especially for a deep lake field investigation of the lake bottom s water depth is crucial to constraining topographic extrapolation or prediction the main objective of this study is to determine how underwater topography can be modeled with a minimal sample of water depth survey two different strategies were designed and compared the first one is skeleton based interpolation method which directly extends the surrounding terrains toward the underwater area through cross section profiles the other is based on a machine learning algorithm that identifies the hidden rules between multiple variables and sampling water depth this strategy applies these rules to predict unmeasured areas the details of the two methods are illustrated as follows 3 2 implementation of the skeleton based interpolation method a straightforward way to generate lake bathymetry is to extend the exposed topography around the lake s toward the lake underwater area both extrapolation and interpolation methods have been applied in the previous studies to rebuild the lake including reservoir bathymetry getirana et al 2018 li et al 2019 liu et al 2020 tseng et al 2016 in this study we designed the skeleton based interpolation method by integrating the lake surrounding terrains and field measurements including two key steps step 1 generalization of key lake geometric features the first step involves generalizing the lake geometric features which provide the terrain skeleton for bathymetry reconstruction in detail the terrain skeleton consists of two parts one centerline along the lake major axis which is recommended as the water depth survey route and multiple cross sections extended from two sided lake surrounding terrains the lake centerline can be generated by determining the start point and endpoint on both sides of the long axis the two survey points split the lake boundary into two arcs subsequently euclidean allocation algorithm was applied to identifies the cells that are to be allocated to an arc based on closest proximity after turning proximity regions into polygons lake centerline was determined as shared boundary compared with the densely deployed survey routes in previous studies the required in situ measurements only along the lake centerline in this method can essentially reduce the cost of fieldwork for each sampling pixel along the lake shoreline its closest pixel along the lake centerline can be searched after connecting two pixels and extending toward the exposed lake terrains within one certain buffering distance a series of cross sections approximately perpendicular to the centerline can be generated two parameters may influence cross section generation the cross section interval and the buffering distance from the shoreline cross section interval determines the density of the predicted points and the buffering distance from the shoreline determines the widths of the referenced terrain zone in which topographic variations are calculated for predicting lake depth in this study cross section intervals were initially set to 10 pixels and buffer distances were approximately equal to 600 m other settings were also discussed in section 4 2 fig 2 a illustrates the extracted lake centerline and cross sections with the example of longmu co step 2 spatial prediction of water depth the second step of skeleton based interpolation method is the water depth prediction of non measured sampling pixels along the constructed cross sections as shown in fig 2b one cross section consists of three types of pixels exposed terrain pixels within the buffer zone underwater pixels to be predicted and the centerline pixel with known water depth predicting underwater pixels with unknown depth includes two substeps extrapolation of terrain extended slope areas and determination of near flattened bottom areas fig 2c first we assumed that the slope value of the lake surrounding terrain could be roughly recognized as that of the inundated area the polynomial fitting of the land pixels was established to calculate the gradient within the buffer zone the calculated gradient was used to predict the elevation profile along the cross sections however the vertical extension of the step was constrained by the depth of measured pixels thus in the second step the predicted value below the measured value was truncated to comply with the flat shape geometry the two step prediction of cross section is not suitable for all cases if the measured pixel is lower than all the predicted pixels along the cross section the valley side generation should be replaced using the linear interpolation of land pixels and the measured pixel 3 3 implementation of machine learning method skeleton based interpolation method requires the delineation of lake centerline thus it is also easily influenced by lake morphology an approach widely oriented for lakes with various morphologic characteristics is of great significance thus we developed a machine learning based novel method to model lake bathymetry by establishing the decision rules between the pixels with known water depths and multiple associated geospatial variables two main steps are included in the implementation of this method step 1 construction of training and predicting samples the measured pixels along the water depth survey route were regarded as the training data different from the skeleton based interpolation method the machine learning method does not require the survey route along the lake long axis in the modeling test the same survey routes were used for the two methods for comparative experiments the influence of different survey route settings on the bathymetry reconstruction for the machine learning method is further discussed in section 4 3 the predicting data were generated to improve the performance efficiency by sampling with a distance interval fig 2d shows that the predicting pixels are spatially compressed with an interval of 10 pixels step 2 establishment of a prediction model base on xgboost algorithm as one of the most widely used and efficient machine learning algorithms extreme gradient boosting method xgboost was used to predict underwater topography xgboost one of the boosting tree models integrating many regression trees i e decision trees where the values of target variable are continuous to construct a robust classifier has good prediction accuracy in machine learning cao et al 2020 fan et al 2021 zhu et al 2020 the algorithm iteratively adds trees to achieve feature splitting each tree has several leaf nodes each leaf node corresponds to a score finally the sum of the corresponding score in each tree is the prediction from a mathematical perspective the addition of a tree generates a novel function to fit the residual error of the last tree 1 obj i 1 n l m i p i k 1 k ω f k 2 ω f k γ t 1 2 λ ω 2 where l mi pi is the difference value between the predicted value and the true value n is the number of sampling points in the training dataset ω fk is the complexity of decision trees where k is the tree number γ and λ represent the regularization coefficients t and ω represent the number of leaves and the leaf weights respectively the input variables of the prediction model include two parts spatial distance of each training or predicting pixel to lake shoreline and topographic variables within the buffer zone of exposed terrains fig 2e and 2f illustrate that searching the pixel along the lake shoreline closest to each training and predicting pixels are critical prerequisites of input variable construction the underlying assumption lies in that the underwater topography is spatially related to the nearby region in particular the closer the locations the more similar are the terrains in total 10 variables were designed and calculated the distance to the closest shoreline pixel three topographic variables including average slope average elevation difference and the elevation gradient for each of the three different settings of buffer zone widths 300 600 and 1200 m it should be noted that the generated buffer zone is not always equal to the target buffer width due to the dem resolution and rasterization processing in this study we generated the buffer zone by extending from the lake shoreline toward land area until the distance is closest to the target buffer width in addition several hyperparameters including learning rate maximum tree depth subsample rate and regularization should be tuned to determine the xgboost model structure a step by step tuning with a grid search strategy was used to determine the hyperparameters of the xgboost model fig 3 cao et al 2020 ding et al 2020 3 4 evaluation procedure after obtaining the elevation values for each predicted point a tin based surface was constructed and further converted to gridded lake bathymetry dem using natural neighbor interpolation the water depths derived from the field measurements were applied for all 12 lakes to assess the accuracy of the modeled bathymetry derived from the two proposed approaches for each lake approximately 1000 points pixels were randomly selected as the validation datasets based on the sampled water depth dataset two metrics were calculated to assess the vertical accuracy of the predicted bathymetry including mean absolute error mae and rmse eqs 3 and 4 besides the evaluation of lake bathymetry another two metrics bais d and bais v were used to assess the relative biases of the total lake water storage and mean depth based on the modeled bathymetry bais d is defined as the ratio of averaged depth differences of all validation points to the lake mean depth and bais v is defined as the bias between lake water storages estimated from our modeled and field measured bathymetry 3 mae i 1 n x i y i n 4 rmse i 1 n x i y i 2 n where n is the number of sampling points x is the modeled bathymetry value and y is the elevation value from reference data 4 results and discussions 4 1 evaluation of the performances of lake bathymetry reconstruction the performances of the reconstructed lake bathymetry by our proposed methods were evaluated as discussed in this section fig 4 shows that the patterns of the predicted depth in the bathymetry maps of all 12 lakes obtained using machine learning method are smoother than those obtained using skeleton based method the visual performance differences between the two methods are mainly attributed to their different sampling approaches the prediction pixels in skeleton based method are sampled along the cross sections varying with irregular lake morphology thus they exhibit uneven distributions along different sections and the centerline by contrast the machine learning method generates the predicted pixels in a homogeneous distribution by sampling over lakes the accuracy metrics mae and rmse were further calculated for a quantitative assessment see fig 4 in general machine learning method has lower errors than skeleton based method in most lake cases except for three lakes tangra yumco donggecuona lake and zharinam co the mae and rmse for donggecuona lake and zharinam co obtained using the skeleton based method are only slightly lower than those obtained using machine learning method the exception is observed in tangra yumco for which the mae of skeleton based method 19 04 m is obviously lower than that of the machine learning method 29 90 m this finding can be largely attributed to the basic idea that skeleton based method has an advantage in modeling lakes with long and narrow shape the influence of lake morphology on two different methods can also be proven by linear regression analysis between the measured and predicted depths fig 5 compared with those from machine learning method the bathymetries derived from skeleton based interpolation method for lakes with elongated shorelines are in better agreement with in situ measurements such typical cases are kusai lake and tangra yumco the r2 values of skeleton based method in kusai lake 0 83 and tangra yumco 0 82 are higher than those of machine learning method 0 79 and 0 65 respectively by contrast the r2 values of eling lake and manasarovar lake further confirm that machine learning method is more suitable for processing lakes with high roundness than skeleton based method another two metrics bias d and bias v were employed to assess the applicability of the reconstructed bathymetry in lake volume estimation as the overestimated and underestimated depths from modeled bathymetry may be offset the relative accuracy of lake storage and mean depth estimates are more acceptable for most lakes the absolute biases of the estimated water volumes using machine learning method are all less than 20 ranging from 1 38 to 19 49 the biases using skeleton based method are relatively higher than those using machine learning method the estimated water volume of chibuzhang co is highly overestimated with a relative bias of 24 57 by contrast the bias v of guozha co is 34 33 indicating a large underestimation all accuracy metrics including bias d bias v and slope value of the linear fitting equation indicate that bathymetries reconstructed by machine learning are likely to be underestimated this result can be explained by the inaccurate definition of the deepest lake underwater areas leading to an underrepresentation of the training dataset 4 2 influences of parameters selection in skeleton based interpolation method as introduced in the method section skeleton based interpolation method involves two parameters buffer distance around the lake and the interval between two cross sections fig 6 a and 6b illustrate that the buffer distance determines the width of the exposed terrains around a lake used for spatial extrapolation and the interval between two cross sections is associated with the density of the predicted points in this study the previous results were all generated using static parameters with a buffer size of 600 m and an interval of 10 pixels we generated lake bathymetries with different parameter combinations to assess the influence of parameter selection on the bathymetry reconstruction buffer size ranges from 300 m to 1500 m and intervals change from 2 pixels to 22 pixels fig 7 shows that the influence of buffer size varies considerably among different lakes the rmse values of aksai chin lake zharinam co and tangra yumco show increased trends when large buffer zones are adopted in bathymetry reconstruction by contrast the error metrics of guozha co and longmu co represent reverse trends when the buffer sizes increase guozha co is a typical case that demonstrates the influence of buffer size on the predicted accuracy the bathymetry of guozha co obtained using skeleton based interpolation method is not satisfactory the bais v is less than 30 indicating that the underwater topography was largely underestimated when the buffer size was set to 600 m given that high mountains surround lake guozha co an enlarged buffer size can generate a predicted profile with an increased slope leading to a decreased underestimation of underwater topography the influence of cross section interval is also illustrated in fig 8 the rmse values of most lakes experienced a decreased trend with the increase of cross section intervals the decline trends are very significant among chibuzhang co eling lake taruo co and kusai lake by contrast donggecuona lake and tangra yumco exhibited a reverse trend this phenomenon is associated with cross section generation which is featured by a concave up shape in this case the sampling of predicted points may cause the loss of some depth information leading to an underestimation compared with the results using all the points as the skeleton based method exhibits an overall overestimation in this study the increase of cross section interval will reduce the predicted lake depth and further increase modeled accuracy 4 3 influence of the survey route selection in machine learning method water depth constraints from the limited set of in situ underwater topographic measurements are crucial to guarantee the modeling accuracy of the proposed method in this study the lake centerline along with the long axis was regarded as the field survey route one survey route along the lake centerline can greatly reduce field measurement costs however further investigation is required to determine whether other designs of field survey routes can work more efficiently for lakes under such a harsh environment than the field survey route in the proposed method for example the originally designed survey route for tangra yumco is 70 km along the centerline this survey route is very time consuming for bathymetric measurement machine learning method does not require the training samples along the centerline thus we designed the field measurements along the other short axis over the lake to evaluate the influence of survey route selection on the bathymetry reconstruction fig 9 shows that 10 potential survey routes of each lake along its short axis were generated by taking tangra yumco manasarovar lake and longmu co as examples which can be divided into two groups at the two ends of the centerline direction each training dataset contains two randomly selected survey routes from each group the experiments were conducted 25 times using different survey route combinations the total lengths of two short axis survey routs are obviously less than those along lake centerlines except the manasarovar lake due to its high roundness fig 10 a the changes in the survey strategy have reduced the fieldwork significantly and bring the uncertainty of the modeled performance the distribution of biases for estimated volumes is shown in the violin plot in fig 10b the biases of estimated volumes are less than 25 for most lake cases considering the survey length of most lakes has been mainly reduced compared with the lake centerline the limited accuracy loss can be acceptable the experiments prove the flexibility of robustness of the machine learning method which is well balanced in situ efficiency and modeled accuracy it should be noted that the unignorable influences of survey route design can be proven in few cases for example guozha co is easily underestimated using specific in situ measurements although there is no reliable method for survey routes design we strongly recommend avoiding placing the survey routes at the corners of lake extent where is far from the lake center region 4 4 case study on tracking lake storage variation based on our reconstructed bathymetry much effort has been previously devoted to providing long term multiscale investigations on the changes in water inundation area water level and storage variations for lakes in tp using various remote sensing technologies including optical and radar images altimetry and gravimetry measurements however water storage estimation on most lakes in tp remains challenging because bathymetric measurements are lacking this problem may considerably impede the acquisition of the total lake water mass estimate and other related limnologic studies such as the influencing mechanisms of lake water volume on thermal energy storage or water salinity changes after the reconstruction of lake bathymetry a comprehensive analysis of lake change can be conducted combined with the annual lake extents of zharinam co derived from gsw dataset the results show that the lake area of zharinam co had expanded from 984 20 km2 to 1053 35 km2 during the period 1990 2020 we also calculated the total lake volume with the reconstructed bathymetry and input lake level the long term estimation shows that the total lake volume of zharinam co generally experienced three distinct periods fig 11 in the 1990s lake volume decreased from 18 22 gt to 17 18 gt with an approximate 6 loss of water storage after achieving the minimum value around 2000 lake volume increased slowly from 2000 to 2016 at an average rate of 0 15 gt y since 2016 a rapid increase in lake volume has been observed at an average rate of 0 75 gt y the lake volume increased by 25 in the past 30 years such a substantial increase in water mass inevitably led to remarkable changes in water chemistry such as the dilution of dissolved salts over the past decades according to the measurements in the 1980s wang and dou 1998 and our fieldwork in august 2020 the salinity of zharinam co has dropped by 24 at the same period with the measured salinity changing from 11 64 g l to 8 61 g l the long term reconstruction of lake volume can understand deeply how water salinity responds to water storage variations 5 conclusions in this study we aim to solve the challenge of lake bathymetric measurements troubled by high cost and low efficacy two novel methods namely skeleton based interpolation method and machine learning method were designed to model lake bathymetry with the constraint of a small number of water depth measurements although their implementation techniques are different both methods lie in the geomorphological similarity between underwater topography and exposed landscape around the lake skeleton based interpolation method predicts underwater topography by extending the lakeside slope toward the underwater region by contrast the spatial prediction of underwater topography in machine learning method is implemented by establishing a prediction model that utilizes the hidden rules between the measured water depths and their corresponding geospatial variables the performances of the proposed methods were tested on 12 typical lakes in tp with harsh field survey environments both methods can produce acceptable lake bathymetry maps with the mean r2 of 0 70 approximately compared with skeleton based interpolation method machine learning method is highly recommended because of its better performances in most lake cases the availability of the predicted bathymetries in lake volume estimations was also investigated the experiments indicated that all the estimated lake volume owns a bias of less than 20 showing the promising potential of machine learning method in large scale lake volume estimation however skeleton based interpolation method will not be completely surpassed by machine learning method skeleton based method is proven to be more effective than machine learning method for lakes with a long and narrow shape this study provides a practical approach for lake bathymetry reconstruction particularly in remote and data scarce areas in general lakes in remote locations and areas with harsh environments can act as sentinels of climate change because of minimal disturbances from human activities adrian et al 2009 tracking and quantifying lake changes e g lake area lake level and lake volume in this region can considerably improve our global understanding of lake responses to climatic change luo et al 2021 ryan et al 2020 in situ lake bathymetry or information on lake depth in harsh environments is scarce and inconsistent restricting scientific research and water resource management the predicted bathymetric data are expected to improve the long term and high frequency water storage monitoring capacity for the ungauged lakes considerably credit authorship contribution statement kai liu conceptualization formal analysis investigation methodology resources software validation visualization writing original draft chunqiao song conceptualization funding acquisition methodology project administration resources supervision validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was partly funded by the national natural science foundation of china grant no 41971403 42171421 and 41930102 the second tibetan plateau scientific expedition and research step grant no 2019qzkk0202 the national key research and development program of china grant nos 2018yfd0900804 and 2019yfa0607101 and the strategic priority research program of the chinese academy of sciences grant no xda23100102 
3799,lake bathymetry which provides crucial information for water resource management has been widely used in hydrological ecological and geomorphological studies restricted by the high cost of conventional full covered lake field surveys and the large uncertainty of spatial prediction method that models lake underwater depths from the surrounding exposed terrains the knowledge on lake bathymetry worldwide is scarce and inconsistent this study aims to solve the problem by investigating how the optimized spatial prediction methods are developed by combining limited field survey data two methods namely the skeleton based interpolation method that extends the exposed topography toward the lake underwater area with a constraint of field surveys and the machine learning method xgboost that establishes the decision rule between measured water depths and multiple geospatial variables to predict depths of unknown underwater areas were developed and tested in twelve representative lakes in the tibetan plateau our results suggest that both methods can provide acceptable estimations of underwater topography by comparing with measured data with the mean r2 of 0 70 approximately the overall performance of the machine learning method xgboost is more reliable with the biases less than 20 in water volume estimates for all lake cases in comparison the skeleton based interpolation method outperforms lakes in long and narrow shapes this study is expected to provide an efficient approach for modeling lake bathymetry and to improve the monitoring capacity of freshwater mass changes especially for ungauged lakes in harsh environments keywords lake bathymetry water storage dem field survey spatial prediction machine learning 1 introduction lakes holding 87 of earth s surface liquid freshwater serve as primary water sources for human activities and provide critical ecosystem services downing et al 2006 verpoorter et al 2014 woolway et al 2020 the essential roles of lakes in climate and biogeochemical cycling are intimately related to their surface area shoreline and bathymetry as a key component of lake properties lake bathymetry determines the depth and stored water volume of a lake chen et al 2022 messager et al 2016 qiao et al 2017 and involves various studies such as lake eutrophication control qin et al 2020 lake hydrodynamic modeling dargahi setegn 2011 and submerged aquatic assessment zhang et al 2015 the most accurate and reliable way to generate a bathymetry map is through hydrologic surveys using sonar mounted on a boat qiao et al 2017 or controlled by an unmanned aerial vehicle bandini et al 2018 however such a time consuming and labor intensive method is hard to be applied for large scale investigations airborne lidar is an effective technology for water depth mapping using a green wavelength laser to penetrate the water column saylam et al 2017 tonina et al 2019 currently bathymetric lidar systems are widely used in shallow and favorable water conditions e g river and coastal zone kasvi et al 2019 nevertheless the maximum depth of airborne lidar is usually less than two times the secchi depth measurement preventing its application in inland water with high depth and turbidity bandini et al 2018 a few studies have recently focused on satellite estimation of lake bathymetry using optical images and satellite altimetry ma et al 2019 2020 pereira et al 2019 satellite based bathymetric mapping has been proven effective in intermittently inundated areas however obtaining topographic information in permanently standing water areas remains challenging some spatial prediction and modeling methods are also proposed to overcome such difficulties mentioned above by predicting underwater bathymetry using lake surrounding exposed terrains the relationships between topographic variables and lake bathymetry including lake depth and lake volume have been investigated thoroughly supporting the establishment of a geostatistical model for lake water depth and volume estimation at regional or even global scales cael et al 2017 messager et al 2016 these estimates are generally acceptable for large scale studies because of the offset effect of underestimation and overestimation however the uncertainty and potential bias of specific lakes or local scales cannot be ignored as for lake individuals the linear extrapolation of lakes surrounding topographic slopes can be a simple solution to derive lake bathymetry in which the bottom topography is defined by the intersection of all extrapolated lines satellite altimetry is applied to calibrate elevation values within the water fluctuating region armon et al 2020 li et al 2020 however the predicted bathymetry of permanently inundated area is usually unrealistic unless the raw digital terrain model dem is acquired during a low water level period li et al 2021 zhang et al 2016 few studies suggest that a small number of in situ measurements of lake water depth can be indispensable for constraining extrapolation accuracy getirana et al 2018 therefore an effective spatial modeling approach with an optimized topographic variable set at a feasible condition of obtaining limited field surveys should be determined in this study we aim to develop two methods for robust modeling of lake bathymetry based only on one or two routes of water depth surveys instead of full coverage lake water depth measurements these methods can considerably save labor and economic cost for regional lake investigation particularly for remote access locations and areas with harsh environments tibetan plateau tp hosts a large number of lakes accounting for approximately 60 of china s lake area however few measured data of lakes in tp have been collected because of high altitude and poor accessibility in this study 12 lakes in tp with different sizes climates underlying surface of catchments and geomorphological and topographic features were chosen to assess the performances of our proposed approaches comprehensive analyses and discussions regarding depth prediction accuracy influences of key model parameters and the application potential of modeled lake bathymetry were provided 2 study sites and datasets 2 1 study sites tp owns 1600 lakes 1 km2 covering an area of 5 104 km2 zhang et al 2019a 2019b however the bathymetric data for most tp lakes are lacking an ongoing project is conducted to estimate the absolute lake volume with low uncertainty by obtaining bathymetric data covering 100 large lakes 10 km2 liu et al 2021 zhang et al 2020 as introduced in the preceding section 12 lake cases in the tp were studied for modeling test the bathymetric data for these 12 testing lakes are available from historical surveys as detailed in table 1 all selected lakes with different sizes ranging from 99 75 km2 to 967 77 km2 are distributed at the high altitude region 4000 m the selected lakes represent various characteristics in terms of lake area shape surrounding terrains and mean lake depth to verify the application robustness of our proposed methods all the basic information of the selected lakes is listed in table 1 2 2 study materials in situ water depth data are required to implement the proposed approach in this study we collected survey data or bathymetric maps from published literatures table 1 for example qiao et al 2017 released the bathymetric maps of four lakes on the northwestern tp which were measured using a boat mounted sounder after digitizing isobaths for each lake we derived their lake bathymetry as shown in fig 1 b 1d the full captured bathymetries of the selected lakes provided the in situ data according to the planned survey route the derived bathymetry was also regarded as a reference for the evaluation of predicted result accuracy besides the in situ underwater topographic measurements the dem data describing the exposed terrains surrounding the lake were applied for the spatial prediction and extrapolation in this study among all the open access dems merit dem yamazaki et al 2017 was selected because of its three advantages first the data source of merit dem is mainly from srtm dem which was captured in 2000 as most lakes in tp experienced a dramatic expansion trend since 2000 luo et al 2021 song et al 2013 srtm dem and its improved version merit dem can capture more exposed areas second the high accuracy of merit dem in tp has been proven in previous studies liu et al 2019 with a low value of root mean square error rmse 8 60 m and few void filling anomalies third merit dem data format is in floating point type which can avoid the data precision loss comparing with the integer type as the spatial resolution of the merit dem is 3 arcsec 90 m at the equator all raster data used or generated in this study were resampled to the 90 m cell size 3 methodology 3 1 basic idea the proposed methods for modeling the lake bathymetry were based on the underlying assumption that the lake underwater topography could be considered a spatial extension of the surrounding exposed terrains with the long term tectonic and geophysical evolution processes xiong et al 2021 for example the exposed areas surrounding the modern lake shoreline were inundated areas in the period of great lake jia et al 2001 hence the topographic variables within the lake surrounding areas i e slope elevation difference can be used to predict lake bathymetry heathcote et al 2015 however the majority of modern lakes possess a deep water and flattened bottom area with a bowl like shape because of the historical sediment accumulation messager et al 2016 the depth of sedimentation layers brings large uncertainty to lake bathymetry estimation zhu et al 2019 thus developing a field survey independent approach for lake bathymetry reconstruction is still challenging especially for a deep lake field investigation of the lake bottom s water depth is crucial to constraining topographic extrapolation or prediction the main objective of this study is to determine how underwater topography can be modeled with a minimal sample of water depth survey two different strategies were designed and compared the first one is skeleton based interpolation method which directly extends the surrounding terrains toward the underwater area through cross section profiles the other is based on a machine learning algorithm that identifies the hidden rules between multiple variables and sampling water depth this strategy applies these rules to predict unmeasured areas the details of the two methods are illustrated as follows 3 2 implementation of the skeleton based interpolation method a straightforward way to generate lake bathymetry is to extend the exposed topography around the lake s toward the lake underwater area both extrapolation and interpolation methods have been applied in the previous studies to rebuild the lake including reservoir bathymetry getirana et al 2018 li et al 2019 liu et al 2020 tseng et al 2016 in this study we designed the skeleton based interpolation method by integrating the lake surrounding terrains and field measurements including two key steps step 1 generalization of key lake geometric features the first step involves generalizing the lake geometric features which provide the terrain skeleton for bathymetry reconstruction in detail the terrain skeleton consists of two parts one centerline along the lake major axis which is recommended as the water depth survey route and multiple cross sections extended from two sided lake surrounding terrains the lake centerline can be generated by determining the start point and endpoint on both sides of the long axis the two survey points split the lake boundary into two arcs subsequently euclidean allocation algorithm was applied to identifies the cells that are to be allocated to an arc based on closest proximity after turning proximity regions into polygons lake centerline was determined as shared boundary compared with the densely deployed survey routes in previous studies the required in situ measurements only along the lake centerline in this method can essentially reduce the cost of fieldwork for each sampling pixel along the lake shoreline its closest pixel along the lake centerline can be searched after connecting two pixels and extending toward the exposed lake terrains within one certain buffering distance a series of cross sections approximately perpendicular to the centerline can be generated two parameters may influence cross section generation the cross section interval and the buffering distance from the shoreline cross section interval determines the density of the predicted points and the buffering distance from the shoreline determines the widths of the referenced terrain zone in which topographic variations are calculated for predicting lake depth in this study cross section intervals were initially set to 10 pixels and buffer distances were approximately equal to 600 m other settings were also discussed in section 4 2 fig 2 a illustrates the extracted lake centerline and cross sections with the example of longmu co step 2 spatial prediction of water depth the second step of skeleton based interpolation method is the water depth prediction of non measured sampling pixels along the constructed cross sections as shown in fig 2b one cross section consists of three types of pixels exposed terrain pixels within the buffer zone underwater pixels to be predicted and the centerline pixel with known water depth predicting underwater pixels with unknown depth includes two substeps extrapolation of terrain extended slope areas and determination of near flattened bottom areas fig 2c first we assumed that the slope value of the lake surrounding terrain could be roughly recognized as that of the inundated area the polynomial fitting of the land pixels was established to calculate the gradient within the buffer zone the calculated gradient was used to predict the elevation profile along the cross sections however the vertical extension of the step was constrained by the depth of measured pixels thus in the second step the predicted value below the measured value was truncated to comply with the flat shape geometry the two step prediction of cross section is not suitable for all cases if the measured pixel is lower than all the predicted pixels along the cross section the valley side generation should be replaced using the linear interpolation of land pixels and the measured pixel 3 3 implementation of machine learning method skeleton based interpolation method requires the delineation of lake centerline thus it is also easily influenced by lake morphology an approach widely oriented for lakes with various morphologic characteristics is of great significance thus we developed a machine learning based novel method to model lake bathymetry by establishing the decision rules between the pixels with known water depths and multiple associated geospatial variables two main steps are included in the implementation of this method step 1 construction of training and predicting samples the measured pixels along the water depth survey route were regarded as the training data different from the skeleton based interpolation method the machine learning method does not require the survey route along the lake long axis in the modeling test the same survey routes were used for the two methods for comparative experiments the influence of different survey route settings on the bathymetry reconstruction for the machine learning method is further discussed in section 4 3 the predicting data were generated to improve the performance efficiency by sampling with a distance interval fig 2d shows that the predicting pixels are spatially compressed with an interval of 10 pixels step 2 establishment of a prediction model base on xgboost algorithm as one of the most widely used and efficient machine learning algorithms extreme gradient boosting method xgboost was used to predict underwater topography xgboost one of the boosting tree models integrating many regression trees i e decision trees where the values of target variable are continuous to construct a robust classifier has good prediction accuracy in machine learning cao et al 2020 fan et al 2021 zhu et al 2020 the algorithm iteratively adds trees to achieve feature splitting each tree has several leaf nodes each leaf node corresponds to a score finally the sum of the corresponding score in each tree is the prediction from a mathematical perspective the addition of a tree generates a novel function to fit the residual error of the last tree 1 obj i 1 n l m i p i k 1 k ω f k 2 ω f k γ t 1 2 λ ω 2 where l mi pi is the difference value between the predicted value and the true value n is the number of sampling points in the training dataset ω fk is the complexity of decision trees where k is the tree number γ and λ represent the regularization coefficients t and ω represent the number of leaves and the leaf weights respectively the input variables of the prediction model include two parts spatial distance of each training or predicting pixel to lake shoreline and topographic variables within the buffer zone of exposed terrains fig 2e and 2f illustrate that searching the pixel along the lake shoreline closest to each training and predicting pixels are critical prerequisites of input variable construction the underlying assumption lies in that the underwater topography is spatially related to the nearby region in particular the closer the locations the more similar are the terrains in total 10 variables were designed and calculated the distance to the closest shoreline pixel three topographic variables including average slope average elevation difference and the elevation gradient for each of the three different settings of buffer zone widths 300 600 and 1200 m it should be noted that the generated buffer zone is not always equal to the target buffer width due to the dem resolution and rasterization processing in this study we generated the buffer zone by extending from the lake shoreline toward land area until the distance is closest to the target buffer width in addition several hyperparameters including learning rate maximum tree depth subsample rate and regularization should be tuned to determine the xgboost model structure a step by step tuning with a grid search strategy was used to determine the hyperparameters of the xgboost model fig 3 cao et al 2020 ding et al 2020 3 4 evaluation procedure after obtaining the elevation values for each predicted point a tin based surface was constructed and further converted to gridded lake bathymetry dem using natural neighbor interpolation the water depths derived from the field measurements were applied for all 12 lakes to assess the accuracy of the modeled bathymetry derived from the two proposed approaches for each lake approximately 1000 points pixels were randomly selected as the validation datasets based on the sampled water depth dataset two metrics were calculated to assess the vertical accuracy of the predicted bathymetry including mean absolute error mae and rmse eqs 3 and 4 besides the evaluation of lake bathymetry another two metrics bais d and bais v were used to assess the relative biases of the total lake water storage and mean depth based on the modeled bathymetry bais d is defined as the ratio of averaged depth differences of all validation points to the lake mean depth and bais v is defined as the bias between lake water storages estimated from our modeled and field measured bathymetry 3 mae i 1 n x i y i n 4 rmse i 1 n x i y i 2 n where n is the number of sampling points x is the modeled bathymetry value and y is the elevation value from reference data 4 results and discussions 4 1 evaluation of the performances of lake bathymetry reconstruction the performances of the reconstructed lake bathymetry by our proposed methods were evaluated as discussed in this section fig 4 shows that the patterns of the predicted depth in the bathymetry maps of all 12 lakes obtained using machine learning method are smoother than those obtained using skeleton based method the visual performance differences between the two methods are mainly attributed to their different sampling approaches the prediction pixels in skeleton based method are sampled along the cross sections varying with irregular lake morphology thus they exhibit uneven distributions along different sections and the centerline by contrast the machine learning method generates the predicted pixels in a homogeneous distribution by sampling over lakes the accuracy metrics mae and rmse were further calculated for a quantitative assessment see fig 4 in general machine learning method has lower errors than skeleton based method in most lake cases except for three lakes tangra yumco donggecuona lake and zharinam co the mae and rmse for donggecuona lake and zharinam co obtained using the skeleton based method are only slightly lower than those obtained using machine learning method the exception is observed in tangra yumco for which the mae of skeleton based method 19 04 m is obviously lower than that of the machine learning method 29 90 m this finding can be largely attributed to the basic idea that skeleton based method has an advantage in modeling lakes with long and narrow shape the influence of lake morphology on two different methods can also be proven by linear regression analysis between the measured and predicted depths fig 5 compared with those from machine learning method the bathymetries derived from skeleton based interpolation method for lakes with elongated shorelines are in better agreement with in situ measurements such typical cases are kusai lake and tangra yumco the r2 values of skeleton based method in kusai lake 0 83 and tangra yumco 0 82 are higher than those of machine learning method 0 79 and 0 65 respectively by contrast the r2 values of eling lake and manasarovar lake further confirm that machine learning method is more suitable for processing lakes with high roundness than skeleton based method another two metrics bias d and bias v were employed to assess the applicability of the reconstructed bathymetry in lake volume estimation as the overestimated and underestimated depths from modeled bathymetry may be offset the relative accuracy of lake storage and mean depth estimates are more acceptable for most lakes the absolute biases of the estimated water volumes using machine learning method are all less than 20 ranging from 1 38 to 19 49 the biases using skeleton based method are relatively higher than those using machine learning method the estimated water volume of chibuzhang co is highly overestimated with a relative bias of 24 57 by contrast the bias v of guozha co is 34 33 indicating a large underestimation all accuracy metrics including bias d bias v and slope value of the linear fitting equation indicate that bathymetries reconstructed by machine learning are likely to be underestimated this result can be explained by the inaccurate definition of the deepest lake underwater areas leading to an underrepresentation of the training dataset 4 2 influences of parameters selection in skeleton based interpolation method as introduced in the method section skeleton based interpolation method involves two parameters buffer distance around the lake and the interval between two cross sections fig 6 a and 6b illustrate that the buffer distance determines the width of the exposed terrains around a lake used for spatial extrapolation and the interval between two cross sections is associated with the density of the predicted points in this study the previous results were all generated using static parameters with a buffer size of 600 m and an interval of 10 pixels we generated lake bathymetries with different parameter combinations to assess the influence of parameter selection on the bathymetry reconstruction buffer size ranges from 300 m to 1500 m and intervals change from 2 pixels to 22 pixels fig 7 shows that the influence of buffer size varies considerably among different lakes the rmse values of aksai chin lake zharinam co and tangra yumco show increased trends when large buffer zones are adopted in bathymetry reconstruction by contrast the error metrics of guozha co and longmu co represent reverse trends when the buffer sizes increase guozha co is a typical case that demonstrates the influence of buffer size on the predicted accuracy the bathymetry of guozha co obtained using skeleton based interpolation method is not satisfactory the bais v is less than 30 indicating that the underwater topography was largely underestimated when the buffer size was set to 600 m given that high mountains surround lake guozha co an enlarged buffer size can generate a predicted profile with an increased slope leading to a decreased underestimation of underwater topography the influence of cross section interval is also illustrated in fig 8 the rmse values of most lakes experienced a decreased trend with the increase of cross section intervals the decline trends are very significant among chibuzhang co eling lake taruo co and kusai lake by contrast donggecuona lake and tangra yumco exhibited a reverse trend this phenomenon is associated with cross section generation which is featured by a concave up shape in this case the sampling of predicted points may cause the loss of some depth information leading to an underestimation compared with the results using all the points as the skeleton based method exhibits an overall overestimation in this study the increase of cross section interval will reduce the predicted lake depth and further increase modeled accuracy 4 3 influence of the survey route selection in machine learning method water depth constraints from the limited set of in situ underwater topographic measurements are crucial to guarantee the modeling accuracy of the proposed method in this study the lake centerline along with the long axis was regarded as the field survey route one survey route along the lake centerline can greatly reduce field measurement costs however further investigation is required to determine whether other designs of field survey routes can work more efficiently for lakes under such a harsh environment than the field survey route in the proposed method for example the originally designed survey route for tangra yumco is 70 km along the centerline this survey route is very time consuming for bathymetric measurement machine learning method does not require the training samples along the centerline thus we designed the field measurements along the other short axis over the lake to evaluate the influence of survey route selection on the bathymetry reconstruction fig 9 shows that 10 potential survey routes of each lake along its short axis were generated by taking tangra yumco manasarovar lake and longmu co as examples which can be divided into two groups at the two ends of the centerline direction each training dataset contains two randomly selected survey routes from each group the experiments were conducted 25 times using different survey route combinations the total lengths of two short axis survey routs are obviously less than those along lake centerlines except the manasarovar lake due to its high roundness fig 10 a the changes in the survey strategy have reduced the fieldwork significantly and bring the uncertainty of the modeled performance the distribution of biases for estimated volumes is shown in the violin plot in fig 10b the biases of estimated volumes are less than 25 for most lake cases considering the survey length of most lakes has been mainly reduced compared with the lake centerline the limited accuracy loss can be acceptable the experiments prove the flexibility of robustness of the machine learning method which is well balanced in situ efficiency and modeled accuracy it should be noted that the unignorable influences of survey route design can be proven in few cases for example guozha co is easily underestimated using specific in situ measurements although there is no reliable method for survey routes design we strongly recommend avoiding placing the survey routes at the corners of lake extent where is far from the lake center region 4 4 case study on tracking lake storage variation based on our reconstructed bathymetry much effort has been previously devoted to providing long term multiscale investigations on the changes in water inundation area water level and storage variations for lakes in tp using various remote sensing technologies including optical and radar images altimetry and gravimetry measurements however water storage estimation on most lakes in tp remains challenging because bathymetric measurements are lacking this problem may considerably impede the acquisition of the total lake water mass estimate and other related limnologic studies such as the influencing mechanisms of lake water volume on thermal energy storage or water salinity changes after the reconstruction of lake bathymetry a comprehensive analysis of lake change can be conducted combined with the annual lake extents of zharinam co derived from gsw dataset the results show that the lake area of zharinam co had expanded from 984 20 km2 to 1053 35 km2 during the period 1990 2020 we also calculated the total lake volume with the reconstructed bathymetry and input lake level the long term estimation shows that the total lake volume of zharinam co generally experienced three distinct periods fig 11 in the 1990s lake volume decreased from 18 22 gt to 17 18 gt with an approximate 6 loss of water storage after achieving the minimum value around 2000 lake volume increased slowly from 2000 to 2016 at an average rate of 0 15 gt y since 2016 a rapid increase in lake volume has been observed at an average rate of 0 75 gt y the lake volume increased by 25 in the past 30 years such a substantial increase in water mass inevitably led to remarkable changes in water chemistry such as the dilution of dissolved salts over the past decades according to the measurements in the 1980s wang and dou 1998 and our fieldwork in august 2020 the salinity of zharinam co has dropped by 24 at the same period with the measured salinity changing from 11 64 g l to 8 61 g l the long term reconstruction of lake volume can understand deeply how water salinity responds to water storage variations 5 conclusions in this study we aim to solve the challenge of lake bathymetric measurements troubled by high cost and low efficacy two novel methods namely skeleton based interpolation method and machine learning method were designed to model lake bathymetry with the constraint of a small number of water depth measurements although their implementation techniques are different both methods lie in the geomorphological similarity between underwater topography and exposed landscape around the lake skeleton based interpolation method predicts underwater topography by extending the lakeside slope toward the underwater region by contrast the spatial prediction of underwater topography in machine learning method is implemented by establishing a prediction model that utilizes the hidden rules between the measured water depths and their corresponding geospatial variables the performances of the proposed methods were tested on 12 typical lakes in tp with harsh field survey environments both methods can produce acceptable lake bathymetry maps with the mean r2 of 0 70 approximately compared with skeleton based interpolation method machine learning method is highly recommended because of its better performances in most lake cases the availability of the predicted bathymetries in lake volume estimations was also investigated the experiments indicated that all the estimated lake volume owns a bias of less than 20 showing the promising potential of machine learning method in large scale lake volume estimation however skeleton based interpolation method will not be completely surpassed by machine learning method skeleton based method is proven to be more effective than machine learning method for lakes with a long and narrow shape this study provides a practical approach for lake bathymetry reconstruction particularly in remote and data scarce areas in general lakes in remote locations and areas with harsh environments can act as sentinels of climate change because of minimal disturbances from human activities adrian et al 2009 tracking and quantifying lake changes e g lake area lake level and lake volume in this region can considerably improve our global understanding of lake responses to climatic change luo et al 2021 ryan et al 2020 in situ lake bathymetry or information on lake depth in harsh environments is scarce and inconsistent restricting scientific research and water resource management the predicted bathymetric data are expected to improve the long term and high frequency water storage monitoring capacity for the ungauged lakes considerably credit authorship contribution statement kai liu conceptualization formal analysis investigation methodology resources software validation visualization writing original draft chunqiao song conceptualization funding acquisition methodology project administration resources supervision validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was partly funded by the national natural science foundation of china grant no 41971403 42171421 and 41930102 the second tibetan plateau scientific expedition and research step grant no 2019qzkk0202 the national key research and development program of china grant nos 2018yfd0900804 and 2019yfa0607101 and the strategic priority research program of the chinese academy of sciences grant no xda23100102 
