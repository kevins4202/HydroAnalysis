index,text
150,our understanding and modelling of flow instabilities e g viscous gravitational in the presence of geological heterogeneity is limited by a lack of experimental observations at relevant scales in consolidated media typically small sample sizes 50 mm diameter restrict the scale of heterogeneity and the development of unstable fingers may be damped by the sample boundaries furthermore there is a lack of 3d dynamic data resolved at a level to observe finger growth and interaction to this end we conduct a series of drainage imbibition fluid flow experiments with nitrogen and brine in meter long 100 mm diameter bentheimer and boise sandstone samples using an advanced high pressure setup with medical x ray ct xct imaging using novel beam hardening and noise removal methods we can resolve fluid distributions with a spatial resolution of 1 2 mm3 and temporal resolution of 90 s the mobility m regime in each case is weakly unstable m 0 5 5 with flow velocities equivalent to field scale injection rates in the case of the weakly heterogeneous bentheimer sample porosity 0 26 0 025 we find the plume migration is mainly controlled by buoyancy on the other hand the fluid distribution in the boise sample is controlled by the strong unstructured heterogeneity porosity 0 3 0 1 the heterogeneity increases the gas trapping as less of the core is ultimately bypassed and residual gas saturation increases behind local capillary barriers we see little viscous instability in each experiment despite the unstable regime structural heterogeneity and buoyancy largely control the flow under these field relevant conditions the meter scale 3d experimental dataset is provided open access and represents an ideal benchmark to calibrate and improve multiphase flow models and upscaling methods keywords co2 storage flow instability rock heterogeneity capillary heterogeneity viscous fingering 1 introduction immiscible fluid displacement occurs in many natural and engineered subsurface porous systems such as non aqueous contaminant remediation and carbon sequestration carbon sequestration involves the injection and storage of supercritical co2 in porous underground formations generally known as carbon capture and storage or ccs and is well documented as a viable technique for large scale abatement of greenhouse gases the co2 is injected into deep saline aquifers and permanently stored via a series of mechanisms including structural trapping residual trapping dissolution trapping and mineral trapping metz et al 2005 due to the critical role of underground co2 storage in reducing co2 emissions to the atmosphere a substantial amount of research has been conducted to understand co2 flow behaviour in saline aquifers in the storage operation co2 from injection wells displaces the brine originally saturating the pore space of the reservoir building up a plume that moves outwards from the well and upwards owing to buoyancy forces brine may re imbibe at the trailing edge of the moving plume and in the vicinity of the well after injection is stopped the flow paths taken by the gas through the aquifer volume and the spatial distribution of saturations that result from drainage and imbibition are a function of competition between capillary viscous and gravity forces as well as reservoir rock heterogeneities and the shock front mobility ratio the relative importance of capillary and viscous forces can be identified via the dimensionless capillary number virnovsky et al 2004 defined the continuum scale capillary number as 1 n c d p l d p c l where the dp is the pressure gradient across length l dpc is the capillary pressure gradient and l is the length scale of capillary heterogeneities capillary heterogeneities arise from variations in the underlying pore structure and composition of the rock and can exist from mm to km scale virnovsky and reynolds and krevor virnovsky et al 2004 reynolds and krevor1 2015 have shown that when nc 1 the flow is capillary dominated and therefore capillary heterogeneities control the gas flow path and spatial distributions the relative impacts of gravity and viscous forces on spatial gas distribution are described by the continuum scale gravity number defined by zhou et al 1994 as 2 n g δ ρ g h k t v μ n w l where δρ is the density difference between the phases h and l are the length scales in the principal and transverse direction g is the acceleration due to gravity kt is the rock permeability transverse to direction flow μ nw is the viscosity of the non wetting phase gas and v is the total fluid velocity in the principal direction when ng 1 gravitational forces are stronger than viscous forces it is expected that gas tends to flow faster toward the top of the formation and lateral flow of the gas in the main reservoir body is more limited this leads to less gas trapping and negatively impacts the storage capacity the relative strength of gravitational forces driving upwards migration and capillary forces that resist the gas flow into narrow pore openings can also be compared using a bond number 3 n b δ ρ g l d p c further to the scalings above the stability of the interfacial displacement is largely controlled by the shock front mobility ratio at the continuum scale m defined by ott et al as ott et al 2012 4 m k r g a s s w f μ g a s k r b r i n e s w 1 μ b r i n e where k r gas sw f is the gas relative permeability at the value of the water saturation prevailing at the position of the gas brine front μ gas is the gas viscosity k r brine sw 1 is the brine relative permeability at sw 1 and μ brine is the brine viscosity for m 1 we have a front that is stable with respect to viscous forces balance and we would not expect any viscous fingering and when m 1 the displacement process is unstable and the occurrence of viscous fingering is expected the growth and wavelength of characteristic fingers are largely controlled by the capillary number with capillary forces damping the instabilities in analogy to transverse dispersion in miscible systems grosfils and boon 2003 while fingering can occur even in homogeneous systems in reality the presence of geological heterogeneity strongly impacts the initialization and growth of the fingers it has been postulated that in consolidated porous media moderate interfacial tensions typical of subsurface fluids i e 20 80 mn m will damp the formation of fingers in almost any realistic subsurface setting ott et al 2012 however new evidence using high order dynamic mesh numerical simulations has shown the formation of 3d fingers with realistic viscosity and ift values high accuracy numerics and problem initiation were key to successful modelling kampitsis et al 2020 to what extent viscous fingering occurs in real geological settings remains an open question potentially impacting many subsurface flow processes the need for rigorous experimental data at large scale in consolidated media is paramount the majority of previous experiments especially in relation to co2 storage have been conducted on samples with a small size 38 mm diameter is a standard size for core plugs this is primarily due to the ease of running small scale experiments and availability of suitable sample material however the one dimensional confinement of flow in such small cores undermines the development of different types of flow instability in particular the potential growth and interaction of complex multi scale viscous fingers further from this large scale heterogeneities of order centimetre to metre cannot be captured using these small cores while these smaller experiments have been key to understanding certain small scale phenomena their manifestation at large scale has yet to be experimentally observed in consolidated media to the best of our knowledge there are few core flooding studies conducted at meter scale to study gas water flow behaviour holbrook and botset studied the permeability saturation relation in a large consolidated sandstone core 136 6 cm in length and 10 2 cm in diameter they found that cementation and grain size distribution have impacts on equilibrium saturation permeability saturation relation and gas sweep efficiency they concluded that the ultimate recovery from a consolidated sand will be in general lower than that of an unconsolidated sand of the same permeability ranathunga et al 2015 and de silva and ranjith 2013 studied the permeability behaviour of a large coal specimens 203 mm in diameter and 1000 mm in length for sub critical and super critical co2 flow their results are applicable for co2 storage in coal bed methane reservoirs and not saline aquifers to address this knowledge gap in this study we assess the interplay between flow instabilities and rock heterogeneities on gas plume migration spatial distribution and trapping at large field relevant scales using a novel experimental setup we use outcrop samples of sandstone one metre long and 100 mm in diameter and dynamically track the gas plume migration and saturation distribution in each rock using medical x ray ct imaging drainage and imbibition experiments are presented at flow velocities equivalent to pertinent field settings e g pilot to industrial scale co2 storage injection rates at weakly unstable mobility ratios using two different rock types one with strong heterogeneity and one with weak heterogeneity we quantify the extent to which flow instability and rock heterogeneity control the plume migration spatial distribution of gas saturation the effective usage of pore space and the distribution and efficiency of gas trapping 2 materials and methods 2 1 rock samples bentheimer sandstone and boise sandstone cores obtained from outcrops sourced by kocurek industries were used in this study bentheimer sandstone has been widely used by researchers primarily for conducting 38 mm coreflood experiments to study water gas relative permeability for co2 underground storage application reynolds and krevor1 2015 alizadeh and piri 2014 jackson et al 2018 quantitative x ray diffraction analysis of the bentheimer indicates that the rock is made of almost 95 wt quartz 2 6 wt microcline 1 1 wt hematite and the rest are kaolinite and albite boise sandstone is made of around 43 wt quartz 28 9 wt albite 7 8 wt microcline 12 2 wt orthoclase 3 9 wt zeolites and the rest are mica and hematite dimensions absolute permeabilities and porosities of these cores are reported in table 1 fig 1 compares the size of the 100 mm diameter boise core used in this study with a 38 mm diameter sandstone core which has the typical size of cores being used in the majority of published core flooding studies the cores absolute permeabilities were measured by injecting a brine with the composition shown in table 2 to the cores at several flow rates under experimental conditions the experimental conditions are pore pressure of 500 psi net effective stress of 2000 psi and room temperature 23 c the cores average porosities were calculated based on the ct data of the cores at dry and water saturated states using the equation below akin and kovscek 2003 5 p o r o s i t y p h i c t b r i n e s a t u r a t e d s t a t e c t d r y s t a t e c t b r i n e c t a i r 2 2 fluids brine with the ionic composition shown in table 2 and a total salinity of 75554 ppm was used in this study the brine density at 3447 kpa and 296 15 k is 1 056e 3 kg m3 and its viscosity is 1 01e 3 pa s nai was used to improve the x ray ct attenuation contrast between the phases brine and gas inside the cores for the core flooding tests n2 with a purity of 99 99 mol was used n2 was used instead of co2 to avoid the complexity of co2 dissolution in brine and consequent fluid rock geochemical reactions at test conditions the n2 density and viscosity are 39 9 kg m3 and 18 1e 6 pa s respectively 2 3 coreflooding system the coreflooding setup is shown in fig 2 the main components of the setup are a high pressure and temperature x ray transparent coreholder pressure transducers a differential pressure transducer high precision high pressure injection and retraction pumps a two phase acoustic separator a medical x ray ct scanner siemens somatom definition as 64 slice helical mode and a computerized data logging and control system a retraction system equipped with a 2 phase separator and high precision retraction pumps was used instead of a backpressure regulator to have better control over outlet pressure furthermore the rig can be remotely controlled which enabled us to scan the meter long cores under high pressure and temperature conditions during the experiment this feature helped us to monitor the plume during each experiment dynamically 2 4 drainage and imbibition experiments cores were initially scanned at dry n2 and brine saturated states respectively next the absolute permeabilities of cores to the brine were measured using several flow rates the water saturated cores were then subject to n2 flooding at three different flow rates of 10 30 and 50 cm3 min followed by waterflooding wf at the rate of 10 cm3 min the injection was performed horizontally n2 displacement is analogous to the immiscible displacement during the primary drainage phase of co2 injection each stage of injection was continued until there was negligible production of the displaced phase the injected pore volumes are reported in table 3 during the first stage of n2 injection rate 10 cm3 min the core was dynamically scanned at a lower signal to noise 140 kv 300 ma exposure using a lower signal to noise ratio enabled us to image the large cores in a single scan taking less than 90 s whilst alleviating x ray tube overheating as such we could dynamically track the gas plume migration inside the cores during flooding furthermore at the end of each injection stage the cores were scanned with 1000 ma exposure to get higher signal to noise ratio using oversampling with helical scanning as much more heat is generated in the x ray tube the high signal to noise scans were obtained in four intervals along the core length with a pause for cooling between each interval we overlapped the images by one slice to enable registration and merging into a single full core 3d image since scanning the whole cores with the highest image quality setting takes around 20 mins these scans were conducted at static conditions i e no fluids flow in the cores and only at the end of each stage when a steady state condition was achieved it should be noted that from the experience of doing more of these types of tests in house we have learned that the fluid redistribution over the time scale of our scan 20 min is negligible the high quality scans were used to calculate 3d fluids saturation distributions and porosity maps the low quality scans were used to image the dynamics of the displacement process and estimation of saturation from that data is less accurate so we used it only qualitatively the porosity value of each voxel was computed using eq 4 and saturation was obtained by 6 s g c t b r i n e s a t u r a t e d s t a t e c t p a r t i a l l y s a t u r a t e d s t a t e c t b r i n e s a t u r a t e d s t a t e c t g a s s a t u r a t e d s t a t e the 3d saturation and porosity maps were calculated using an in house developed workflow in python during all the flooding stages the differential pressure dp across the length of the cores was measured and logged 2 5 beam hardening correction the x ray transparent coreholder is specifically designed to remove the low energy x ray energy and minimize beam hardening in typical porous rock samples however when the core is fully saturated with brine containing a high concentration of nai beam hardening does occur this is due to the high atomic number of the tracer and the large diameter of the sample which makes the path length of the beam long because the x ray beam is hardened by passing through the core outer area the mean photon energy detected will be higher for paths through the core central area this leads to brightening of the outer part of the core and relative darkening of the central part of the core in back projected reconstructions if uncorrected beam hardening will lead to errors in both porosity and saturation however since the saturation is obtained from the ratio of partially brine saturated core and brine saturated core refer to eq 5 the beam hardening effects are largely cancelled out apart from at extremes of saturation which we do not encounter in our experiments here as such the beam hardening correction in this study is only applied for porosity map calculation it should be noted in addition to beam hardening rock heterogeneities will also impact the attenuation profile these are real features to be preserved as such extra care must be taken not to remove or smooth these heterogeneities when removing beam hardening one of the standard techniques for beam hardening correction is to calculate the radial average of the attenuation values as a function of the distance r from the centre of the rock for each slice romano et al 2019 an exponential function can then fit this average radial profile 7 b h a e b r c the fitted function can be used to remove the beam hardening noise from the pixels of each slice at a given value of r alternatively we could apply this method for the average of all slices and find a global average radial profile and a global correction function for the whole core however this method is only suitable for homogeneous samples therefore a new method for beam hardening correction of brine saturated core data is developed and used in this study which is based on using dry core ct data as explained above the aluminium body of the coreholder is specifically designed to reduce the beam hardening in the core and the reconstruction algorithm reduces it further we indeed observe minimum beam hardening for the dry ct data as seen in fig 3 the δct in fig 3 is obtained from reducing the global average intensity of the central pixels from the global average intensity of all pixels at a given r indeed an opposite behaviour of beam hardening effects for the global average radial profile of dry boise core is observed which is attributed to its heterogeneities at the same time the classical beam hardening effect on the water saturated trend is evident in fig 3 to remove the beam hardening artefacts from the water saturated data sw 1 for any given r a correction factor α r is defined 8 α r δ c t s w 1 r δ c t d r y r note that α is a function of radius for a particular rock sample by subtracting α from the pixels of the water saturated data at a given r we could remove the beam hardening noise however via this method the mean ct of the water saturated slice will be decreased while that of the dry slice will remain unchanged this leads to an incorrect porosity map note that when the x ray beam passes through the core outer areas in the water saturated state the beam is hardened due to more substantial attenuation in these areas stronger attenuation in the core outer areas leads to higher ct numbers for these areas at the same time core inner areas are being met by a hardened beam and therefore the attenuation will be smaller than what it should be which gives us a lower ct number for these areas the net effects of these higher and lower attenuations should not alter the mean ct of the slice as such we need to keep the mean ct of the slice constant when removing the beam hardening artefacts since we know the number of pixels in a slice n and the amount of reduction in the mean ct of a slice when applying the above correction eq 4 we can correct α r by 9 α r α r β n where β is the reduction in mean ct when applying α r correction factor and α r is the final beam hardening correction factor that keeps the mean ct of a slice constant we coded this methodology in python and its outcome is a global beam hardening filter shown in fig 4 the global filter can be reduced from all the slices of the water saturated core to remove the beam hardening artefacts the uncorrected and corrected data are shown in fig 5 the same technique can be used to find the filter for each core slice however it will be more computationally heavy note that since this method is based on using dry data the rock heterogeneities will not be damped by the correction as opposed to the conventional average radial profile method for beam hardening correction furthermore correcting water saturated data based on dry data will not impact the porosity map even if the dry data has some degree of beam hardening this is because for porosity calculations water saturated data will be in a ratio with the dry data and therefore the potential beam hardening effects will cancel out 2 6 heterogeneity characterization several studies reynolds and krevor1 2015 kuo and benson 2015 reynolds et al 2018 boon and benson 2021 anto darkwah et al 2021 moreno and rabinovich 2021 have shown that in a capillary dominated regime heterogeneities in the pore size distribution from place to place control the spatial gas distribution and gas flow path in rocks these so called capillary heterogeneities may be hard to detect from just the porosity distribution available from medical resolution ct images and are better seen through their effects on the gas distribution following a core flood pini et al pini et al 2013 pini and benson 2017 2013 pini et al 2012 and krause et al 2013 developed a technique for characterizing capillary heterogeneity from core floods imaged by xct this method is most suitable for smaller cores when the majority of the rock volume is at least partly drained during low flow rate gas injection owing to lateral confinement of gas flow paths even in a horizontal flood for 100 mm diameter cores due to gravity effects and 3d heterogeneity layers or patches of low capillary entry pressure most of the sample volume could remain un invaded as shown in the following sections furthermore this method is based on the assumption that fluids saturations in pores are in capillary equilibrium gravity and viscous forces are negligible in the current study we use the 3d porosity to analyse the heterogeneity of the samples although the porosity is not always in perfect correlation with capillary or permeability heterogeneity krause et al 2013 generally areas of high porosity correspond to areas of low entry pressure and high permeability results from pini and benson study pini and benson 2017 showed that this assumption to a good extent is valid in sandstones fig 6 presents the 2d porosity map of the vertical centre plane along the length of boise and bentheimer as seen from fig 6 boise is very heterogeneous and its spatial heterogeneity distribution is unstructured on the other hand bentheimer is almost homogeneous and only has a weak layered heterogeneity along the core length parallel to the direction of flow the length scales of porosity heterogeneities for boise and bentheimer were identified by analysing their 3d porosity maps and are reported in table 4 the reported length scales are based on 2 5 change in porosity to find these length scales we developed a simple code by which we replaced the value of the most similar neighbourhood voxels in 3d 0 025 change in porosity with specific values this made the visual investigation of the length scales of porosity heterogeneities in x y and z directions much easier a simplified image of the porosity map of a slice of the core by the code is shown in the appendix refer to fig a11 the data in table 4 emphasize that 38 mm core plugs are too small present the large scale heterogeneity of boise 3 results and discussion 3 1 heterogeneity effects on plume migration and drainage fig 7 compares the gas migration and dynamic changes in fluid distributions inside the bentheimer and boise cores imaged on the vertical centre plane during the first drainage step rate 10 cm3 min the direction of injection is from right to left and gravity forces g are from top to bottom as shown in the figure the low ct number areas indicate the areas where gas flowed in the water saturated rocks the streaks along the centre plane of the bentheimer are the imaging artefacts we report raw ct numbers here since at the fastest scan rate the noise levels are quite high and saturation predictions are unreliable the raw ct values show areas of n2 invaded rock as dark regions as seen from fig 7 for the case of bentheimer sandstone soon after the gas entered the core at the inlet face strong gravitational forces pushed the gas toward the top of the rock on the other hand for boise sandstone strong rock heterogeneities controlled the gas flow path and gas flowed in low capillary entry pressure high permeability areas of the rock along its entire length note that as heterogeneity is unstructured in boise the spatial gas distribution is also unstructured with respect to core position and gravity as the injection continued for the case of bentheimer the gas spread as a rather thin layer towards the top of the core and adjacent edges and flowed toward the core outlet face the experiment shows the very strong adverse effects of gravitational forces on gas areal sweep efficiency when they are dominant and the consequential early gas breakthrough the gas breakthrough in bentheimer occurred after around 24 min of injection 0 13 pvi on the other hand for boise the strong rock heterogeneities controlled the gas flow paths and the final spatial distribution of gas saturation inside the rock this led to a more substantial lateral flow of the gas and consequently a later gas breakthrough time in boise than bentheimer the gas breakthrough time for boise was around 40 min 0 19 pvi which is almost two times higher than that of bentheimer since the flow paths are more tortuous and ramified in both rocks after the gas breakthrough as the injection continued gas was able to displace more water adjacent to the already established gas flow path for bentheimer this led to a slight increase in the thickness of the gas layer underneath the top of the rock the gas saturation distributions in the centre plane of boise and bentheimer by the end of all drainage stages are shown in fig 8 the increase in gas injection rate from 10 to 30 and then 50 cm3 min caused the gas to invade water occupied pores with high capillary entry pressures adjacent to the flow gas path that had been established at the lowest rate of 10 cm3 min the order of invasion is based on the order of capillary entry pressure of each pore starting with the lowest capillary entry pressure ones or big pores a comparison of the gas saturation distributions plume migration trends and gas breakthrough times of bentheimer and boise sandstones reveals that strong capillary heterogeneities can have a significant positive impact on a storage operation it should be noted that from the experimental studies distinguishing the impacts of capillary and permeability heterogeneities from each other on gas flow path is not possible as shown by ott et al 2012 this can only be done via modelling approaches based on their study a two phase flow property i e capillary heterogeneity controls the gas flow path rather than permeability heterogeneity strong capillary heterogeneity can lead to a more lateral gas flow and wider spatial gas distribution in the reservoir this leads to more trapping in the body of the reservoir and less structural trapping under the top seal as such the risk of co2 leakage via the seal will be reduced and the critical co2 height will be achieved at later times of injection it should be noted that the error range in saturation values reported in this study can be as large as 10 of the reported values the inheritance error from ct causes some uncertainty in voxel saturation data that is typically being minimized by upscaling the voxel sizes since in this study we are more focused on monitoring the gas migration path and trapping in the rock at the highest possible resolution we did not upscale the voxel sizes and kept them at 1 2 mm3 here we only used a global 3d filter to reduce the ct noises the 3d gas saturation distributions in boise and bentheimer at the end of each drainage stage are shown in fig 9 note that for the 3d data only voxels with gas saturation above 0 45 are shown with the more water saturated rendered transparent to aid visualization of the main gas flow pathways it is evident that buoyancy forces dominated the gas flow in bentheimer and pushed the gas toward the top of the rock this reveals that in weakly heterogeneous rocks like bentheimer the dominant force on gas plume migration and spatial distribution is gravitational forces we believe due to the almost 1d nature of the flow in 38 mm coreflooding experiments the effect of gravitational forces on the spatial gas distribution is often suppressed owing to the limited vertical dimension as such even a small degree of capillary heterogeneity shows a considerable impact on spatial gas distribution and therefore gas flow characteristics reynolds and krevor1 2015 reynolds et al 2018 our results reveal that this is not the case on a larger scale demonstrating the value of 100 mm coreflooding experiments over traditional 38 mm experiments to investigate the interplay of the three primary forces viscous capillary and gravitational see for example cinar and riaz 2014 in contrast to bentheimer in the boise sandstone rock heterogeneities were the controlling factor on spatial gas distribution and plume migration to better distinguish the relative importance of capillary viscous and gravity forces on spatial gas distribution in both rocks the capillary and gravity numbers are calculated and reported in table 5 note that since we do not have the capillary heterogeneity maps of the rocks for the capillary heterogeneity length scale we used the largest porosity heterogeneity length scale found from assessing each slice bedding structure refer to table 4 for the dpc of bentheimer we used the data reported by jackson et al 2018 on the same rock type as for dpc for boise there is no reported data from the literature however based on the gas saturation and porosity distributions data we expect the dpc of boise to be larger than that of bentheimer as such for boise we estimated capillary and gravity numbers using dpc values that are equal to and two times larger than the dpc of bentheimer which gives a conservative range of values as seen from table 5 for both rock samples and in all drainage stages nc 1 this shows that the flow is capillary dominated and capillary force impacts on gas saturation distributions are stronger than viscous forces as shown by the modelling work of jackson and krevor 2020 the flow will transit from the viscous dominated regime to the capillary dominated regime within a short distance from the injection wells this is attributed to the radial nature of the flow from the wells therefore the flow regime in the bulk of storage sites is capillary dominated as such our observations in this study are applicable to the main reservoir body of a storage site interestingly for bentheimer although the gravity number at the rate of 10 cm3 min is slightly larger than 1 moderately strong upward migration of the gas was still observed this shows the important impact of gravitation forces even when ng 1 note that as we increased the injection rate ng value decreased to below 1 however the effect of the gravitational forces on spatial gas distribution is still evident this is because the gas main flow path had already been established at the lower rate of 10 cm3 min when ng 1 therefore although the increase in rate helps the gas to further invade the water occupied pores it could not significantly change the gas main flow path once it had been established 3 2 viscous fingering vs heterogeneity control during gas injection into bentheimer channelling was evident in the flow paths fig 10 shows the gas saturation distribution in a horizontal plane along the length of the bentheimer core to distinguish between viscous fingering and channelling caused by heterogeneity the shock front mobility ratio m was calculated using eq 3 we utilize two methods firstly the pressure data from the transient experiment can be used to assess the relative permeability this is a core average result and represents a lower bound on the expected permeability for the front saturation secondly we can use the measured front saturation and previously published well known relative permeability data across a range of saturations to infer the localized relative permeability at the front using our measurements and the data from the work of reynolds et al reynolds and krevor1 2015 we estimate m is in the range of 0 05 5 representing a weakly unstable regime of fluid displacement in drainage this likely represents a lower bound on the stability in our experiments since our experimental pressure data is a core average and the pressure gradient driving viscous forces would be higher at the front nonetheless it highlights the fact that viscous fingers could form and grow in an unstable regime however by analysing the porosity map in fig 6 we find the channels are largely aligned with high porosity regions which likely have low entry pressure promoting the front movement indeed in the preliminary experimental and modelling work presented by jackson et al 2020 on the same bentheimer core it was shown that layered capillary heterogeneities created by direct correlation with the porosity permeability map could channel gas preferentially along the sides of the core note that gas channelling in a symmetric form was observed in bentheimer but did not occur in boise this is attributed to the unstructured heterogeneity type of boise as opposed to parallel layering heterogeneity in bentheimer figs 8 and 9 show that gas channelling also occurred in the bottom portion of the bentheimer core where a high permeability layer having low capillary entry pressure was present note that the gas channelled in this high permeability low capillary entry pressure layer remained there for the rest of the gas injection figs 7 and 8 gravitational forces could not move this gas toward the top of the rock this is attributed to the presence of a layer with somewhat lower permeability and with a high capillary entry pressure in the centre of the core that could trap the tongue of gas in the more permeable layer underneath it this type of heterogeneity configuration horizontal sedimentary stratification and baffle structures is favourable for enhancing flow laterally in the reservoir body and leads to invasion of more of the available pore space baffles and thin barriers in a co2 storage site can prevent the plume moving rapidly toward the top of the formation and so while there is some flow by passing they enhance both trapping efficiency and escape of the plume laterally away from the injection location as seen from fig 8 as the gas injection rate increased the size of the gas channels at the bottom and top sides of the bentheimer increased however these two flow paths never merged showing that the capillary barrier in the middle layer albeit weak was not overcome by the viscous and secondary capillary forces mobilized in the higher rate flow stages 3 3 heterogeneity effects on gas trapping the trapped gas saturation distributions in the vertical centre plane of bentheimer and boise after 0 8 pvi waterflooding wf are presented in fig 11 although the imbibition displacement process is hydrodynamically stable dark fingers a few cm across with an almost symmetric pattern are observed near to the water injection point in both cores the gas saturation in these fingers is very low we believe as the injected water was not saturated with the nitrogen gas the injected water displaced and also slightly dissolved the gas in the near inlet region of both cores as the water became saturated with the gas the dissolution became weaker and therefore we have less dissolution effect for the rest of the core this is consistent with the observations of ott et al 2012 the brine fingers had a more symmetric shape in the bentheimer than in the boise sandstone this could be attributed to the impacts of heterogeneity more evidence regarding this shape difference is provided in the supplementary information refer to figures a1 a2 a3 and a4 the maximum length of these fingers in boise sandstone is around 10 cm we have seen similar brine fingers with a characteristically smooth outline and regular spacing of a few cm in other large format experiments when injecting brine to saturate initially dry cores of sandstone compared to the bentheimer for boise the trapped gas saturation is not very uniform and there are several areas shown in circles in fig 11 that have higher trapped gas saturation this is attributed to the capillary heterogeneity that led to a stronger trapping of the non wetting phase this observation is consistent with the results reported by krevor et al 2011 and pentland et al 2011 note that the gas trapped by capillary heterogeneity is mobile this is confirmed by comparing the observed differential pressure dp responses during the imbibition stage in both rocks as seen from fig 12 compared to the observed dp responses during waterflooding in bentheimer the dp during waterflooding stage in boise had stronger fluctuations after the water breakthrough which continued up to the end of the experiment this is due to the slight movements of the mobile gas in the porous medium that can negatively affect the water conductivity the trapping induced by capillary heterogeneity is different from snap off trapping in which the trapped gas is immobile based on these observations capillary heterogeneity can enhance the gas trapping in the body of the reservoir gas can be trapped underneath high capillary entry pressure layers until its saturation goes beyond a critical saturation at which the upward buoyancy forces can overcome the high capillary entry pressure barrier note that even then only a part of the gas pool will pass through the barrier and the rest will remain structurally trapped this is shown by the experimental study of trevisan et al pini and benson 2017 in which a large hele shaw cell equipped with a medical ct was used for direct visualization of plume migration fig 13 shows the voxel and slice average initial gas saturations vs voxel and slice average trapped gas saturations for bentheimer and boise note that the reported trapped gas saturations are not the residual gas saturations as the part of the trapped gas is either bypassed by water due to heterogeneity and gravity effects dissolved in water or is remaining gas extra care must be taken to do not confuse the remaining gas with the residual gas this is because part of the remaining gas is still mobile using the land model defined in eq 10 we managed to fit the majority of the slice average data except for some shown in the oval areas the data shown in ovals belongs to the inlet slices where the dissolution occurred during the imbibition process fig 11 which led to lower trapped gas saturation note that in fig 13 we used four land trapping models for each core to highlight trapping variability 10 s g r s g i 1 c s g i 4 conclusions by conducting large scale coreflooding experiments using two sandstones with different degrees and types of heterogeneity we quantified the effects of flow instabilities viscous and gravitational and rock heterogeneities on gas plume migration spatial distribution of gas saturation and ultimate trapping according to our observations and using dimensional analysis we found that gravitational forces in the absence of strong heterogeneity play the dominant role in gas plume migration distribution areal sweep and trapping on the other hand in the presence of strong heterogeneity contrast in capillary entry pressure plays as important a role as gravitational forces furthermore our experimental observations reveal that despite the unstable regime m 1 viscous instability is not the dominant mechanism according to our results capillary heterogeneities can lead to i more substantial lateral flow of the plume rather than upward migration driven by gravitational forces ii more effective usage of pore space iii gas channelling iv stronger gas trapping in the body of the reservoir and suppression of gravity plume escapes upwards and laterally each of these four effects is a function of heterogeneity type orientation in the case of layered heterogeneity and spatial distribution therefore in underground co2 storage project an accurate characterization of host formation heterogeneities is crucial to assess their effects on flow patterns in order to predict their ultimate consequences this improves screening storage sites and can even point to ways of utilizing the heterogeneities to improve storage efficiency our study demonstrates the value of large scale experiments compared to conventional 38 mm coreflood experiments large scale experiments enable us to i capture large scale rock heterogeneities and quantify their effects on gas plume migration and trapping ii quantify the effects of flow instabilities on gas plume migration which otherwise are largely damped by the boundaries of 38 mm core samples iii assess the interplay between rock heterogeneities and flow instabilities iv study the transition from unsteady state to steady state flow conditions in 38 mm coreflood experiments the system rapidly reaches steady state condition sometimes within a few seconds of changing boundary flow rates the flow pattern in 100 mm coreflooding experiment takes at least several minutes to reach equilibrium enabling the dynamics of the transition to be imaged with medical ct scanning this transient nature of the flow also occurs during co2 injection in saline aquifers in particular at the co2 flood front results from 100 mm coreflood experiments are valuable for benchmarking transient simulations so that the correct configurations and parameterization can be passed to field scale models data accessibility all medical ct data are uploaded to https data csiro au collection csiro 53975 credit authorship contribution statement mojtaba seyyedi conceptualization data curation formal analysis investigation visualization methodology writing original draft writing review editing michael benedict clennell conceptualization methodology formal analysis writing review editing samuel j jackson conceptualization methodology formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the first author would like to express his appreciation for the valuable feedbacks and comments from dr steffen berg on the area of gas trapping and dissolution during imbibition appendix fig a1 below indicates the 2d porosity and gas saturation maps during drainage and imbibition stages for several slices along the length of bentheimer substantial negative impacts of gravitational forces on upward migration of the gas and distribution of the gas in each slice is clear also the role of heterogeneity leading to the channelling of the gas in the bottom of each slice is evident furthermore fingers formed during the imbibition near the core inlet face is noticeable in slice 10 of fig a1 and also in fig a2 gravity segregation effect on water flow path is apparent in fig a2 fig a3 indicates the 2d porosity and gas saturation maps during drainage and imbibition stages for several slices along the length of boise as opposed to bentheimer for boise gas saturation distribution is a strong function of heterogeneity in the rock note that for all the applied rates heterogeneity controls the gas saturation distribution in each slice this shows that we are in capillary dominated flow as confirmed by the nc values reported in table 5 of the manuscript also capillary heterogeneity led to higher gas trapping during the imbibition stage as shown by oval areas in fig a3 fig a4 shows the gas saturation distribution in boise s inlet slices by the end of the imbibition stage differential pressure responses the differential pressure dp trends across the length of bentheimer and boise during various drainage stages are shown in fig a5 and fig a6 respectively for the case of bentheimer during n2 flooding at the rate of 10 cm3 min the differential pressure logging system faced a technical issue and could not log the data for the time intervals of 30 70 min and 110 156 min the same issue occurred for a short interval during n2 flooding at the rate of 50 cm3 min as seen from fig a5 for the rate of 10 cm3 min during the period of 90 to 112 min strong dp fluctuations in the size of around 3 5 kpa were observed to have a closer look at the dp fluctuations in any specific time interval the noise in dp was computed by reducing the dp at time t from dp average of that specific time interval and its histogram is shown in fig a6 a distribution fitted the histogram as seen from fig a6 the observed dp noise for the time interval of 90 112 min during the first drainage stage cannot be fitted with distribution and the noise range and its standard deviation are pretty significant this shows that these dp fluctuations are not random noise and indeed they may indicate the intermittency in the gas flow path recently spurin et al 2020 have shown intermittency at pore scale for the gas water system during the transition to steady state and at the steady state condition and how it is explained by recurrent breakage and reconnection of the flow path of the gas along pore networks more complexity and dynamic gas phase interfaces during transient flows are expected than in steady state conditions spurin et al 2020 this could be the reason for the strong dp fluctuations for the time interval of 90 112 min at the rate of 10 cm3 min note that the fluctuations in dp at higher gas flow rates of 30 and 50 cm3 min are smaller than those observed for the rate of 10 cm3 min however since we could not record the last dp data points at the rate of 10 cm3 min from 110 to 156 min we are not sure if this is related to the rate effect change in the capillary number or is a consequence of reaching pseudo steady state conditions note that the consistent strong drops and increases in dp at the rate of 50 cm3 min are due to rapid switches between retraction pumps at the high injection rate furthermore as seen in fig a6 the dp noise range and standard deviation by the end of waterflooding are very small the histogram can almost well fit with the gaussian distribution showing these are primarily random noise coming from the rig note that the dp during waterflooding wf even after 0 84 pvi is yet not at a plateau and it is decreasing this could be due to the displacement and dissolution of the trapped gas in the rock by injected brine as seen in fig a7 and fig a8 for boise before the gas breakthrough time time 40 min the fluctuations in dp are strong and the dp noise s histogram shows almost a bimodal behaviour this could be an indication of rapid pore filling events occurring during drainage berg et al 2013 have shown that these strong fluctuations in dp during drainage at unsteady state condition is due to haines jump where gas cascade through several pores in one event leading to significant energy dissipation the energy dissipation will show itself in the form of a sharp drop in dp note that such strong fluctuations before the gas breakthrough time were not observed for bentheimer we believe the reason for the multiple haines jump events in boise is the strong capillary heterogeneity in boise as gas flows in boise and meets the higher capillary entry pressure pores barriers the dp started to increase until it passes their capillary entry pressures and then gas rapidly fills several pores and dp sharply drops a closer look at these dp fluctuations is presented in the supplementary information section as the gas injection at the rate of 10 cm3 min continued the dp noise range and standard deviation decreased refer to fig a8 and the histogram fitted better with the gaussian distribution these indicate the gas flow path is established in the pore space and we move from an unsteady state condition towards the steady state from 80 mins onward a few strong changes in dp are introduced by the retraction system and does not represent pore events note that dp noise range by the end of gas flooding at the rate of 10 cm3 min is larger than those of rates of 30 and 50 cm3 min this could indicate that the gas main flow path is well established and we have less intermittency effects fig a9 shows the dp fluctuations before the gas breakthrough time in boise the gas breakthrough time is indicated by the blue dashed line in the figure the substantial increase and sharp decrease in dp is the signature of haines jump fig a10 shows the histogram of porosity in used sandstones 
150,our understanding and modelling of flow instabilities e g viscous gravitational in the presence of geological heterogeneity is limited by a lack of experimental observations at relevant scales in consolidated media typically small sample sizes 50 mm diameter restrict the scale of heterogeneity and the development of unstable fingers may be damped by the sample boundaries furthermore there is a lack of 3d dynamic data resolved at a level to observe finger growth and interaction to this end we conduct a series of drainage imbibition fluid flow experiments with nitrogen and brine in meter long 100 mm diameter bentheimer and boise sandstone samples using an advanced high pressure setup with medical x ray ct xct imaging using novel beam hardening and noise removal methods we can resolve fluid distributions with a spatial resolution of 1 2 mm3 and temporal resolution of 90 s the mobility m regime in each case is weakly unstable m 0 5 5 with flow velocities equivalent to field scale injection rates in the case of the weakly heterogeneous bentheimer sample porosity 0 26 0 025 we find the plume migration is mainly controlled by buoyancy on the other hand the fluid distribution in the boise sample is controlled by the strong unstructured heterogeneity porosity 0 3 0 1 the heterogeneity increases the gas trapping as less of the core is ultimately bypassed and residual gas saturation increases behind local capillary barriers we see little viscous instability in each experiment despite the unstable regime structural heterogeneity and buoyancy largely control the flow under these field relevant conditions the meter scale 3d experimental dataset is provided open access and represents an ideal benchmark to calibrate and improve multiphase flow models and upscaling methods keywords co2 storage flow instability rock heterogeneity capillary heterogeneity viscous fingering 1 introduction immiscible fluid displacement occurs in many natural and engineered subsurface porous systems such as non aqueous contaminant remediation and carbon sequestration carbon sequestration involves the injection and storage of supercritical co2 in porous underground formations generally known as carbon capture and storage or ccs and is well documented as a viable technique for large scale abatement of greenhouse gases the co2 is injected into deep saline aquifers and permanently stored via a series of mechanisms including structural trapping residual trapping dissolution trapping and mineral trapping metz et al 2005 due to the critical role of underground co2 storage in reducing co2 emissions to the atmosphere a substantial amount of research has been conducted to understand co2 flow behaviour in saline aquifers in the storage operation co2 from injection wells displaces the brine originally saturating the pore space of the reservoir building up a plume that moves outwards from the well and upwards owing to buoyancy forces brine may re imbibe at the trailing edge of the moving plume and in the vicinity of the well after injection is stopped the flow paths taken by the gas through the aquifer volume and the spatial distribution of saturations that result from drainage and imbibition are a function of competition between capillary viscous and gravity forces as well as reservoir rock heterogeneities and the shock front mobility ratio the relative importance of capillary and viscous forces can be identified via the dimensionless capillary number virnovsky et al 2004 defined the continuum scale capillary number as 1 n c d p l d p c l where the dp is the pressure gradient across length l dpc is the capillary pressure gradient and l is the length scale of capillary heterogeneities capillary heterogeneities arise from variations in the underlying pore structure and composition of the rock and can exist from mm to km scale virnovsky and reynolds and krevor virnovsky et al 2004 reynolds and krevor1 2015 have shown that when nc 1 the flow is capillary dominated and therefore capillary heterogeneities control the gas flow path and spatial distributions the relative impacts of gravity and viscous forces on spatial gas distribution are described by the continuum scale gravity number defined by zhou et al 1994 as 2 n g δ ρ g h k t v μ n w l where δρ is the density difference between the phases h and l are the length scales in the principal and transverse direction g is the acceleration due to gravity kt is the rock permeability transverse to direction flow μ nw is the viscosity of the non wetting phase gas and v is the total fluid velocity in the principal direction when ng 1 gravitational forces are stronger than viscous forces it is expected that gas tends to flow faster toward the top of the formation and lateral flow of the gas in the main reservoir body is more limited this leads to less gas trapping and negatively impacts the storage capacity the relative strength of gravitational forces driving upwards migration and capillary forces that resist the gas flow into narrow pore openings can also be compared using a bond number 3 n b δ ρ g l d p c further to the scalings above the stability of the interfacial displacement is largely controlled by the shock front mobility ratio at the continuum scale m defined by ott et al as ott et al 2012 4 m k r g a s s w f μ g a s k r b r i n e s w 1 μ b r i n e where k r gas sw f is the gas relative permeability at the value of the water saturation prevailing at the position of the gas brine front μ gas is the gas viscosity k r brine sw 1 is the brine relative permeability at sw 1 and μ brine is the brine viscosity for m 1 we have a front that is stable with respect to viscous forces balance and we would not expect any viscous fingering and when m 1 the displacement process is unstable and the occurrence of viscous fingering is expected the growth and wavelength of characteristic fingers are largely controlled by the capillary number with capillary forces damping the instabilities in analogy to transverse dispersion in miscible systems grosfils and boon 2003 while fingering can occur even in homogeneous systems in reality the presence of geological heterogeneity strongly impacts the initialization and growth of the fingers it has been postulated that in consolidated porous media moderate interfacial tensions typical of subsurface fluids i e 20 80 mn m will damp the formation of fingers in almost any realistic subsurface setting ott et al 2012 however new evidence using high order dynamic mesh numerical simulations has shown the formation of 3d fingers with realistic viscosity and ift values high accuracy numerics and problem initiation were key to successful modelling kampitsis et al 2020 to what extent viscous fingering occurs in real geological settings remains an open question potentially impacting many subsurface flow processes the need for rigorous experimental data at large scale in consolidated media is paramount the majority of previous experiments especially in relation to co2 storage have been conducted on samples with a small size 38 mm diameter is a standard size for core plugs this is primarily due to the ease of running small scale experiments and availability of suitable sample material however the one dimensional confinement of flow in such small cores undermines the development of different types of flow instability in particular the potential growth and interaction of complex multi scale viscous fingers further from this large scale heterogeneities of order centimetre to metre cannot be captured using these small cores while these smaller experiments have been key to understanding certain small scale phenomena their manifestation at large scale has yet to be experimentally observed in consolidated media to the best of our knowledge there are few core flooding studies conducted at meter scale to study gas water flow behaviour holbrook and botset studied the permeability saturation relation in a large consolidated sandstone core 136 6 cm in length and 10 2 cm in diameter they found that cementation and grain size distribution have impacts on equilibrium saturation permeability saturation relation and gas sweep efficiency they concluded that the ultimate recovery from a consolidated sand will be in general lower than that of an unconsolidated sand of the same permeability ranathunga et al 2015 and de silva and ranjith 2013 studied the permeability behaviour of a large coal specimens 203 mm in diameter and 1000 mm in length for sub critical and super critical co2 flow their results are applicable for co2 storage in coal bed methane reservoirs and not saline aquifers to address this knowledge gap in this study we assess the interplay between flow instabilities and rock heterogeneities on gas plume migration spatial distribution and trapping at large field relevant scales using a novel experimental setup we use outcrop samples of sandstone one metre long and 100 mm in diameter and dynamically track the gas plume migration and saturation distribution in each rock using medical x ray ct imaging drainage and imbibition experiments are presented at flow velocities equivalent to pertinent field settings e g pilot to industrial scale co2 storage injection rates at weakly unstable mobility ratios using two different rock types one with strong heterogeneity and one with weak heterogeneity we quantify the extent to which flow instability and rock heterogeneity control the plume migration spatial distribution of gas saturation the effective usage of pore space and the distribution and efficiency of gas trapping 2 materials and methods 2 1 rock samples bentheimer sandstone and boise sandstone cores obtained from outcrops sourced by kocurek industries were used in this study bentheimer sandstone has been widely used by researchers primarily for conducting 38 mm coreflood experiments to study water gas relative permeability for co2 underground storage application reynolds and krevor1 2015 alizadeh and piri 2014 jackson et al 2018 quantitative x ray diffraction analysis of the bentheimer indicates that the rock is made of almost 95 wt quartz 2 6 wt microcline 1 1 wt hematite and the rest are kaolinite and albite boise sandstone is made of around 43 wt quartz 28 9 wt albite 7 8 wt microcline 12 2 wt orthoclase 3 9 wt zeolites and the rest are mica and hematite dimensions absolute permeabilities and porosities of these cores are reported in table 1 fig 1 compares the size of the 100 mm diameter boise core used in this study with a 38 mm diameter sandstone core which has the typical size of cores being used in the majority of published core flooding studies the cores absolute permeabilities were measured by injecting a brine with the composition shown in table 2 to the cores at several flow rates under experimental conditions the experimental conditions are pore pressure of 500 psi net effective stress of 2000 psi and room temperature 23 c the cores average porosities were calculated based on the ct data of the cores at dry and water saturated states using the equation below akin and kovscek 2003 5 p o r o s i t y p h i c t b r i n e s a t u r a t e d s t a t e c t d r y s t a t e c t b r i n e c t a i r 2 2 fluids brine with the ionic composition shown in table 2 and a total salinity of 75554 ppm was used in this study the brine density at 3447 kpa and 296 15 k is 1 056e 3 kg m3 and its viscosity is 1 01e 3 pa s nai was used to improve the x ray ct attenuation contrast between the phases brine and gas inside the cores for the core flooding tests n2 with a purity of 99 99 mol was used n2 was used instead of co2 to avoid the complexity of co2 dissolution in brine and consequent fluid rock geochemical reactions at test conditions the n2 density and viscosity are 39 9 kg m3 and 18 1e 6 pa s respectively 2 3 coreflooding system the coreflooding setup is shown in fig 2 the main components of the setup are a high pressure and temperature x ray transparent coreholder pressure transducers a differential pressure transducer high precision high pressure injection and retraction pumps a two phase acoustic separator a medical x ray ct scanner siemens somatom definition as 64 slice helical mode and a computerized data logging and control system a retraction system equipped with a 2 phase separator and high precision retraction pumps was used instead of a backpressure regulator to have better control over outlet pressure furthermore the rig can be remotely controlled which enabled us to scan the meter long cores under high pressure and temperature conditions during the experiment this feature helped us to monitor the plume during each experiment dynamically 2 4 drainage and imbibition experiments cores were initially scanned at dry n2 and brine saturated states respectively next the absolute permeabilities of cores to the brine were measured using several flow rates the water saturated cores were then subject to n2 flooding at three different flow rates of 10 30 and 50 cm3 min followed by waterflooding wf at the rate of 10 cm3 min the injection was performed horizontally n2 displacement is analogous to the immiscible displacement during the primary drainage phase of co2 injection each stage of injection was continued until there was negligible production of the displaced phase the injected pore volumes are reported in table 3 during the first stage of n2 injection rate 10 cm3 min the core was dynamically scanned at a lower signal to noise 140 kv 300 ma exposure using a lower signal to noise ratio enabled us to image the large cores in a single scan taking less than 90 s whilst alleviating x ray tube overheating as such we could dynamically track the gas plume migration inside the cores during flooding furthermore at the end of each injection stage the cores were scanned with 1000 ma exposure to get higher signal to noise ratio using oversampling with helical scanning as much more heat is generated in the x ray tube the high signal to noise scans were obtained in four intervals along the core length with a pause for cooling between each interval we overlapped the images by one slice to enable registration and merging into a single full core 3d image since scanning the whole cores with the highest image quality setting takes around 20 mins these scans were conducted at static conditions i e no fluids flow in the cores and only at the end of each stage when a steady state condition was achieved it should be noted that from the experience of doing more of these types of tests in house we have learned that the fluid redistribution over the time scale of our scan 20 min is negligible the high quality scans were used to calculate 3d fluids saturation distributions and porosity maps the low quality scans were used to image the dynamics of the displacement process and estimation of saturation from that data is less accurate so we used it only qualitatively the porosity value of each voxel was computed using eq 4 and saturation was obtained by 6 s g c t b r i n e s a t u r a t e d s t a t e c t p a r t i a l l y s a t u r a t e d s t a t e c t b r i n e s a t u r a t e d s t a t e c t g a s s a t u r a t e d s t a t e the 3d saturation and porosity maps were calculated using an in house developed workflow in python during all the flooding stages the differential pressure dp across the length of the cores was measured and logged 2 5 beam hardening correction the x ray transparent coreholder is specifically designed to remove the low energy x ray energy and minimize beam hardening in typical porous rock samples however when the core is fully saturated with brine containing a high concentration of nai beam hardening does occur this is due to the high atomic number of the tracer and the large diameter of the sample which makes the path length of the beam long because the x ray beam is hardened by passing through the core outer area the mean photon energy detected will be higher for paths through the core central area this leads to brightening of the outer part of the core and relative darkening of the central part of the core in back projected reconstructions if uncorrected beam hardening will lead to errors in both porosity and saturation however since the saturation is obtained from the ratio of partially brine saturated core and brine saturated core refer to eq 5 the beam hardening effects are largely cancelled out apart from at extremes of saturation which we do not encounter in our experiments here as such the beam hardening correction in this study is only applied for porosity map calculation it should be noted in addition to beam hardening rock heterogeneities will also impact the attenuation profile these are real features to be preserved as such extra care must be taken not to remove or smooth these heterogeneities when removing beam hardening one of the standard techniques for beam hardening correction is to calculate the radial average of the attenuation values as a function of the distance r from the centre of the rock for each slice romano et al 2019 an exponential function can then fit this average radial profile 7 b h a e b r c the fitted function can be used to remove the beam hardening noise from the pixels of each slice at a given value of r alternatively we could apply this method for the average of all slices and find a global average radial profile and a global correction function for the whole core however this method is only suitable for homogeneous samples therefore a new method for beam hardening correction of brine saturated core data is developed and used in this study which is based on using dry core ct data as explained above the aluminium body of the coreholder is specifically designed to reduce the beam hardening in the core and the reconstruction algorithm reduces it further we indeed observe minimum beam hardening for the dry ct data as seen in fig 3 the δct in fig 3 is obtained from reducing the global average intensity of the central pixels from the global average intensity of all pixels at a given r indeed an opposite behaviour of beam hardening effects for the global average radial profile of dry boise core is observed which is attributed to its heterogeneities at the same time the classical beam hardening effect on the water saturated trend is evident in fig 3 to remove the beam hardening artefacts from the water saturated data sw 1 for any given r a correction factor α r is defined 8 α r δ c t s w 1 r δ c t d r y r note that α is a function of radius for a particular rock sample by subtracting α from the pixels of the water saturated data at a given r we could remove the beam hardening noise however via this method the mean ct of the water saturated slice will be decreased while that of the dry slice will remain unchanged this leads to an incorrect porosity map note that when the x ray beam passes through the core outer areas in the water saturated state the beam is hardened due to more substantial attenuation in these areas stronger attenuation in the core outer areas leads to higher ct numbers for these areas at the same time core inner areas are being met by a hardened beam and therefore the attenuation will be smaller than what it should be which gives us a lower ct number for these areas the net effects of these higher and lower attenuations should not alter the mean ct of the slice as such we need to keep the mean ct of the slice constant when removing the beam hardening artefacts since we know the number of pixels in a slice n and the amount of reduction in the mean ct of a slice when applying the above correction eq 4 we can correct α r by 9 α r α r β n where β is the reduction in mean ct when applying α r correction factor and α r is the final beam hardening correction factor that keeps the mean ct of a slice constant we coded this methodology in python and its outcome is a global beam hardening filter shown in fig 4 the global filter can be reduced from all the slices of the water saturated core to remove the beam hardening artefacts the uncorrected and corrected data are shown in fig 5 the same technique can be used to find the filter for each core slice however it will be more computationally heavy note that since this method is based on using dry data the rock heterogeneities will not be damped by the correction as opposed to the conventional average radial profile method for beam hardening correction furthermore correcting water saturated data based on dry data will not impact the porosity map even if the dry data has some degree of beam hardening this is because for porosity calculations water saturated data will be in a ratio with the dry data and therefore the potential beam hardening effects will cancel out 2 6 heterogeneity characterization several studies reynolds and krevor1 2015 kuo and benson 2015 reynolds et al 2018 boon and benson 2021 anto darkwah et al 2021 moreno and rabinovich 2021 have shown that in a capillary dominated regime heterogeneities in the pore size distribution from place to place control the spatial gas distribution and gas flow path in rocks these so called capillary heterogeneities may be hard to detect from just the porosity distribution available from medical resolution ct images and are better seen through their effects on the gas distribution following a core flood pini et al pini et al 2013 pini and benson 2017 2013 pini et al 2012 and krause et al 2013 developed a technique for characterizing capillary heterogeneity from core floods imaged by xct this method is most suitable for smaller cores when the majority of the rock volume is at least partly drained during low flow rate gas injection owing to lateral confinement of gas flow paths even in a horizontal flood for 100 mm diameter cores due to gravity effects and 3d heterogeneity layers or patches of low capillary entry pressure most of the sample volume could remain un invaded as shown in the following sections furthermore this method is based on the assumption that fluids saturations in pores are in capillary equilibrium gravity and viscous forces are negligible in the current study we use the 3d porosity to analyse the heterogeneity of the samples although the porosity is not always in perfect correlation with capillary or permeability heterogeneity krause et al 2013 generally areas of high porosity correspond to areas of low entry pressure and high permeability results from pini and benson study pini and benson 2017 showed that this assumption to a good extent is valid in sandstones fig 6 presents the 2d porosity map of the vertical centre plane along the length of boise and bentheimer as seen from fig 6 boise is very heterogeneous and its spatial heterogeneity distribution is unstructured on the other hand bentheimer is almost homogeneous and only has a weak layered heterogeneity along the core length parallel to the direction of flow the length scales of porosity heterogeneities for boise and bentheimer were identified by analysing their 3d porosity maps and are reported in table 4 the reported length scales are based on 2 5 change in porosity to find these length scales we developed a simple code by which we replaced the value of the most similar neighbourhood voxels in 3d 0 025 change in porosity with specific values this made the visual investigation of the length scales of porosity heterogeneities in x y and z directions much easier a simplified image of the porosity map of a slice of the core by the code is shown in the appendix refer to fig a11 the data in table 4 emphasize that 38 mm core plugs are too small present the large scale heterogeneity of boise 3 results and discussion 3 1 heterogeneity effects on plume migration and drainage fig 7 compares the gas migration and dynamic changes in fluid distributions inside the bentheimer and boise cores imaged on the vertical centre plane during the first drainage step rate 10 cm3 min the direction of injection is from right to left and gravity forces g are from top to bottom as shown in the figure the low ct number areas indicate the areas where gas flowed in the water saturated rocks the streaks along the centre plane of the bentheimer are the imaging artefacts we report raw ct numbers here since at the fastest scan rate the noise levels are quite high and saturation predictions are unreliable the raw ct values show areas of n2 invaded rock as dark regions as seen from fig 7 for the case of bentheimer sandstone soon after the gas entered the core at the inlet face strong gravitational forces pushed the gas toward the top of the rock on the other hand for boise sandstone strong rock heterogeneities controlled the gas flow path and gas flowed in low capillary entry pressure high permeability areas of the rock along its entire length note that as heterogeneity is unstructured in boise the spatial gas distribution is also unstructured with respect to core position and gravity as the injection continued for the case of bentheimer the gas spread as a rather thin layer towards the top of the core and adjacent edges and flowed toward the core outlet face the experiment shows the very strong adverse effects of gravitational forces on gas areal sweep efficiency when they are dominant and the consequential early gas breakthrough the gas breakthrough in bentheimer occurred after around 24 min of injection 0 13 pvi on the other hand for boise the strong rock heterogeneities controlled the gas flow paths and the final spatial distribution of gas saturation inside the rock this led to a more substantial lateral flow of the gas and consequently a later gas breakthrough time in boise than bentheimer the gas breakthrough time for boise was around 40 min 0 19 pvi which is almost two times higher than that of bentheimer since the flow paths are more tortuous and ramified in both rocks after the gas breakthrough as the injection continued gas was able to displace more water adjacent to the already established gas flow path for bentheimer this led to a slight increase in the thickness of the gas layer underneath the top of the rock the gas saturation distributions in the centre plane of boise and bentheimer by the end of all drainage stages are shown in fig 8 the increase in gas injection rate from 10 to 30 and then 50 cm3 min caused the gas to invade water occupied pores with high capillary entry pressures adjacent to the flow gas path that had been established at the lowest rate of 10 cm3 min the order of invasion is based on the order of capillary entry pressure of each pore starting with the lowest capillary entry pressure ones or big pores a comparison of the gas saturation distributions plume migration trends and gas breakthrough times of bentheimer and boise sandstones reveals that strong capillary heterogeneities can have a significant positive impact on a storage operation it should be noted that from the experimental studies distinguishing the impacts of capillary and permeability heterogeneities from each other on gas flow path is not possible as shown by ott et al 2012 this can only be done via modelling approaches based on their study a two phase flow property i e capillary heterogeneity controls the gas flow path rather than permeability heterogeneity strong capillary heterogeneity can lead to a more lateral gas flow and wider spatial gas distribution in the reservoir this leads to more trapping in the body of the reservoir and less structural trapping under the top seal as such the risk of co2 leakage via the seal will be reduced and the critical co2 height will be achieved at later times of injection it should be noted that the error range in saturation values reported in this study can be as large as 10 of the reported values the inheritance error from ct causes some uncertainty in voxel saturation data that is typically being minimized by upscaling the voxel sizes since in this study we are more focused on monitoring the gas migration path and trapping in the rock at the highest possible resolution we did not upscale the voxel sizes and kept them at 1 2 mm3 here we only used a global 3d filter to reduce the ct noises the 3d gas saturation distributions in boise and bentheimer at the end of each drainage stage are shown in fig 9 note that for the 3d data only voxels with gas saturation above 0 45 are shown with the more water saturated rendered transparent to aid visualization of the main gas flow pathways it is evident that buoyancy forces dominated the gas flow in bentheimer and pushed the gas toward the top of the rock this reveals that in weakly heterogeneous rocks like bentheimer the dominant force on gas plume migration and spatial distribution is gravitational forces we believe due to the almost 1d nature of the flow in 38 mm coreflooding experiments the effect of gravitational forces on the spatial gas distribution is often suppressed owing to the limited vertical dimension as such even a small degree of capillary heterogeneity shows a considerable impact on spatial gas distribution and therefore gas flow characteristics reynolds and krevor1 2015 reynolds et al 2018 our results reveal that this is not the case on a larger scale demonstrating the value of 100 mm coreflooding experiments over traditional 38 mm experiments to investigate the interplay of the three primary forces viscous capillary and gravitational see for example cinar and riaz 2014 in contrast to bentheimer in the boise sandstone rock heterogeneities were the controlling factor on spatial gas distribution and plume migration to better distinguish the relative importance of capillary viscous and gravity forces on spatial gas distribution in both rocks the capillary and gravity numbers are calculated and reported in table 5 note that since we do not have the capillary heterogeneity maps of the rocks for the capillary heterogeneity length scale we used the largest porosity heterogeneity length scale found from assessing each slice bedding structure refer to table 4 for the dpc of bentheimer we used the data reported by jackson et al 2018 on the same rock type as for dpc for boise there is no reported data from the literature however based on the gas saturation and porosity distributions data we expect the dpc of boise to be larger than that of bentheimer as such for boise we estimated capillary and gravity numbers using dpc values that are equal to and two times larger than the dpc of bentheimer which gives a conservative range of values as seen from table 5 for both rock samples and in all drainage stages nc 1 this shows that the flow is capillary dominated and capillary force impacts on gas saturation distributions are stronger than viscous forces as shown by the modelling work of jackson and krevor 2020 the flow will transit from the viscous dominated regime to the capillary dominated regime within a short distance from the injection wells this is attributed to the radial nature of the flow from the wells therefore the flow regime in the bulk of storage sites is capillary dominated as such our observations in this study are applicable to the main reservoir body of a storage site interestingly for bentheimer although the gravity number at the rate of 10 cm3 min is slightly larger than 1 moderately strong upward migration of the gas was still observed this shows the important impact of gravitation forces even when ng 1 note that as we increased the injection rate ng value decreased to below 1 however the effect of the gravitational forces on spatial gas distribution is still evident this is because the gas main flow path had already been established at the lower rate of 10 cm3 min when ng 1 therefore although the increase in rate helps the gas to further invade the water occupied pores it could not significantly change the gas main flow path once it had been established 3 2 viscous fingering vs heterogeneity control during gas injection into bentheimer channelling was evident in the flow paths fig 10 shows the gas saturation distribution in a horizontal plane along the length of the bentheimer core to distinguish between viscous fingering and channelling caused by heterogeneity the shock front mobility ratio m was calculated using eq 3 we utilize two methods firstly the pressure data from the transient experiment can be used to assess the relative permeability this is a core average result and represents a lower bound on the expected permeability for the front saturation secondly we can use the measured front saturation and previously published well known relative permeability data across a range of saturations to infer the localized relative permeability at the front using our measurements and the data from the work of reynolds et al reynolds and krevor1 2015 we estimate m is in the range of 0 05 5 representing a weakly unstable regime of fluid displacement in drainage this likely represents a lower bound on the stability in our experiments since our experimental pressure data is a core average and the pressure gradient driving viscous forces would be higher at the front nonetheless it highlights the fact that viscous fingers could form and grow in an unstable regime however by analysing the porosity map in fig 6 we find the channels are largely aligned with high porosity regions which likely have low entry pressure promoting the front movement indeed in the preliminary experimental and modelling work presented by jackson et al 2020 on the same bentheimer core it was shown that layered capillary heterogeneities created by direct correlation with the porosity permeability map could channel gas preferentially along the sides of the core note that gas channelling in a symmetric form was observed in bentheimer but did not occur in boise this is attributed to the unstructured heterogeneity type of boise as opposed to parallel layering heterogeneity in bentheimer figs 8 and 9 show that gas channelling also occurred in the bottom portion of the bentheimer core where a high permeability layer having low capillary entry pressure was present note that the gas channelled in this high permeability low capillary entry pressure layer remained there for the rest of the gas injection figs 7 and 8 gravitational forces could not move this gas toward the top of the rock this is attributed to the presence of a layer with somewhat lower permeability and with a high capillary entry pressure in the centre of the core that could trap the tongue of gas in the more permeable layer underneath it this type of heterogeneity configuration horizontal sedimentary stratification and baffle structures is favourable for enhancing flow laterally in the reservoir body and leads to invasion of more of the available pore space baffles and thin barriers in a co2 storage site can prevent the plume moving rapidly toward the top of the formation and so while there is some flow by passing they enhance both trapping efficiency and escape of the plume laterally away from the injection location as seen from fig 8 as the gas injection rate increased the size of the gas channels at the bottom and top sides of the bentheimer increased however these two flow paths never merged showing that the capillary barrier in the middle layer albeit weak was not overcome by the viscous and secondary capillary forces mobilized in the higher rate flow stages 3 3 heterogeneity effects on gas trapping the trapped gas saturation distributions in the vertical centre plane of bentheimer and boise after 0 8 pvi waterflooding wf are presented in fig 11 although the imbibition displacement process is hydrodynamically stable dark fingers a few cm across with an almost symmetric pattern are observed near to the water injection point in both cores the gas saturation in these fingers is very low we believe as the injected water was not saturated with the nitrogen gas the injected water displaced and also slightly dissolved the gas in the near inlet region of both cores as the water became saturated with the gas the dissolution became weaker and therefore we have less dissolution effect for the rest of the core this is consistent with the observations of ott et al 2012 the brine fingers had a more symmetric shape in the bentheimer than in the boise sandstone this could be attributed to the impacts of heterogeneity more evidence regarding this shape difference is provided in the supplementary information refer to figures a1 a2 a3 and a4 the maximum length of these fingers in boise sandstone is around 10 cm we have seen similar brine fingers with a characteristically smooth outline and regular spacing of a few cm in other large format experiments when injecting brine to saturate initially dry cores of sandstone compared to the bentheimer for boise the trapped gas saturation is not very uniform and there are several areas shown in circles in fig 11 that have higher trapped gas saturation this is attributed to the capillary heterogeneity that led to a stronger trapping of the non wetting phase this observation is consistent with the results reported by krevor et al 2011 and pentland et al 2011 note that the gas trapped by capillary heterogeneity is mobile this is confirmed by comparing the observed differential pressure dp responses during the imbibition stage in both rocks as seen from fig 12 compared to the observed dp responses during waterflooding in bentheimer the dp during waterflooding stage in boise had stronger fluctuations after the water breakthrough which continued up to the end of the experiment this is due to the slight movements of the mobile gas in the porous medium that can negatively affect the water conductivity the trapping induced by capillary heterogeneity is different from snap off trapping in which the trapped gas is immobile based on these observations capillary heterogeneity can enhance the gas trapping in the body of the reservoir gas can be trapped underneath high capillary entry pressure layers until its saturation goes beyond a critical saturation at which the upward buoyancy forces can overcome the high capillary entry pressure barrier note that even then only a part of the gas pool will pass through the barrier and the rest will remain structurally trapped this is shown by the experimental study of trevisan et al pini and benson 2017 in which a large hele shaw cell equipped with a medical ct was used for direct visualization of plume migration fig 13 shows the voxel and slice average initial gas saturations vs voxel and slice average trapped gas saturations for bentheimer and boise note that the reported trapped gas saturations are not the residual gas saturations as the part of the trapped gas is either bypassed by water due to heterogeneity and gravity effects dissolved in water or is remaining gas extra care must be taken to do not confuse the remaining gas with the residual gas this is because part of the remaining gas is still mobile using the land model defined in eq 10 we managed to fit the majority of the slice average data except for some shown in the oval areas the data shown in ovals belongs to the inlet slices where the dissolution occurred during the imbibition process fig 11 which led to lower trapped gas saturation note that in fig 13 we used four land trapping models for each core to highlight trapping variability 10 s g r s g i 1 c s g i 4 conclusions by conducting large scale coreflooding experiments using two sandstones with different degrees and types of heterogeneity we quantified the effects of flow instabilities viscous and gravitational and rock heterogeneities on gas plume migration spatial distribution of gas saturation and ultimate trapping according to our observations and using dimensional analysis we found that gravitational forces in the absence of strong heterogeneity play the dominant role in gas plume migration distribution areal sweep and trapping on the other hand in the presence of strong heterogeneity contrast in capillary entry pressure plays as important a role as gravitational forces furthermore our experimental observations reveal that despite the unstable regime m 1 viscous instability is not the dominant mechanism according to our results capillary heterogeneities can lead to i more substantial lateral flow of the plume rather than upward migration driven by gravitational forces ii more effective usage of pore space iii gas channelling iv stronger gas trapping in the body of the reservoir and suppression of gravity plume escapes upwards and laterally each of these four effects is a function of heterogeneity type orientation in the case of layered heterogeneity and spatial distribution therefore in underground co2 storage project an accurate characterization of host formation heterogeneities is crucial to assess their effects on flow patterns in order to predict their ultimate consequences this improves screening storage sites and can even point to ways of utilizing the heterogeneities to improve storage efficiency our study demonstrates the value of large scale experiments compared to conventional 38 mm coreflood experiments large scale experiments enable us to i capture large scale rock heterogeneities and quantify their effects on gas plume migration and trapping ii quantify the effects of flow instabilities on gas plume migration which otherwise are largely damped by the boundaries of 38 mm core samples iii assess the interplay between rock heterogeneities and flow instabilities iv study the transition from unsteady state to steady state flow conditions in 38 mm coreflood experiments the system rapidly reaches steady state condition sometimes within a few seconds of changing boundary flow rates the flow pattern in 100 mm coreflooding experiment takes at least several minutes to reach equilibrium enabling the dynamics of the transition to be imaged with medical ct scanning this transient nature of the flow also occurs during co2 injection in saline aquifers in particular at the co2 flood front results from 100 mm coreflood experiments are valuable for benchmarking transient simulations so that the correct configurations and parameterization can be passed to field scale models data accessibility all medical ct data are uploaded to https data csiro au collection csiro 53975 credit authorship contribution statement mojtaba seyyedi conceptualization data curation formal analysis investigation visualization methodology writing original draft writing review editing michael benedict clennell conceptualization methodology formal analysis writing review editing samuel j jackson conceptualization methodology formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the first author would like to express his appreciation for the valuable feedbacks and comments from dr steffen berg on the area of gas trapping and dissolution during imbibition appendix fig a1 below indicates the 2d porosity and gas saturation maps during drainage and imbibition stages for several slices along the length of bentheimer substantial negative impacts of gravitational forces on upward migration of the gas and distribution of the gas in each slice is clear also the role of heterogeneity leading to the channelling of the gas in the bottom of each slice is evident furthermore fingers formed during the imbibition near the core inlet face is noticeable in slice 10 of fig a1 and also in fig a2 gravity segregation effect on water flow path is apparent in fig a2 fig a3 indicates the 2d porosity and gas saturation maps during drainage and imbibition stages for several slices along the length of boise as opposed to bentheimer for boise gas saturation distribution is a strong function of heterogeneity in the rock note that for all the applied rates heterogeneity controls the gas saturation distribution in each slice this shows that we are in capillary dominated flow as confirmed by the nc values reported in table 5 of the manuscript also capillary heterogeneity led to higher gas trapping during the imbibition stage as shown by oval areas in fig a3 fig a4 shows the gas saturation distribution in boise s inlet slices by the end of the imbibition stage differential pressure responses the differential pressure dp trends across the length of bentheimer and boise during various drainage stages are shown in fig a5 and fig a6 respectively for the case of bentheimer during n2 flooding at the rate of 10 cm3 min the differential pressure logging system faced a technical issue and could not log the data for the time intervals of 30 70 min and 110 156 min the same issue occurred for a short interval during n2 flooding at the rate of 50 cm3 min as seen from fig a5 for the rate of 10 cm3 min during the period of 90 to 112 min strong dp fluctuations in the size of around 3 5 kpa were observed to have a closer look at the dp fluctuations in any specific time interval the noise in dp was computed by reducing the dp at time t from dp average of that specific time interval and its histogram is shown in fig a6 a distribution fitted the histogram as seen from fig a6 the observed dp noise for the time interval of 90 112 min during the first drainage stage cannot be fitted with distribution and the noise range and its standard deviation are pretty significant this shows that these dp fluctuations are not random noise and indeed they may indicate the intermittency in the gas flow path recently spurin et al 2020 have shown intermittency at pore scale for the gas water system during the transition to steady state and at the steady state condition and how it is explained by recurrent breakage and reconnection of the flow path of the gas along pore networks more complexity and dynamic gas phase interfaces during transient flows are expected than in steady state conditions spurin et al 2020 this could be the reason for the strong dp fluctuations for the time interval of 90 112 min at the rate of 10 cm3 min note that the fluctuations in dp at higher gas flow rates of 30 and 50 cm3 min are smaller than those observed for the rate of 10 cm3 min however since we could not record the last dp data points at the rate of 10 cm3 min from 110 to 156 min we are not sure if this is related to the rate effect change in the capillary number or is a consequence of reaching pseudo steady state conditions note that the consistent strong drops and increases in dp at the rate of 50 cm3 min are due to rapid switches between retraction pumps at the high injection rate furthermore as seen in fig a6 the dp noise range and standard deviation by the end of waterflooding are very small the histogram can almost well fit with the gaussian distribution showing these are primarily random noise coming from the rig note that the dp during waterflooding wf even after 0 84 pvi is yet not at a plateau and it is decreasing this could be due to the displacement and dissolution of the trapped gas in the rock by injected brine as seen in fig a7 and fig a8 for boise before the gas breakthrough time time 40 min the fluctuations in dp are strong and the dp noise s histogram shows almost a bimodal behaviour this could be an indication of rapid pore filling events occurring during drainage berg et al 2013 have shown that these strong fluctuations in dp during drainage at unsteady state condition is due to haines jump where gas cascade through several pores in one event leading to significant energy dissipation the energy dissipation will show itself in the form of a sharp drop in dp note that such strong fluctuations before the gas breakthrough time were not observed for bentheimer we believe the reason for the multiple haines jump events in boise is the strong capillary heterogeneity in boise as gas flows in boise and meets the higher capillary entry pressure pores barriers the dp started to increase until it passes their capillary entry pressures and then gas rapidly fills several pores and dp sharply drops a closer look at these dp fluctuations is presented in the supplementary information section as the gas injection at the rate of 10 cm3 min continued the dp noise range and standard deviation decreased refer to fig a8 and the histogram fitted better with the gaussian distribution these indicate the gas flow path is established in the pore space and we move from an unsteady state condition towards the steady state from 80 mins onward a few strong changes in dp are introduced by the retraction system and does not represent pore events note that dp noise range by the end of gas flooding at the rate of 10 cm3 min is larger than those of rates of 30 and 50 cm3 min this could indicate that the gas main flow path is well established and we have less intermittency effects fig a9 shows the dp fluctuations before the gas breakthrough time in boise the gas breakthrough time is indicated by the blue dashed line in the figure the substantial increase and sharp decrease in dp is the signature of haines jump fig a10 shows the histogram of porosity in used sandstones 
151,the process of ph dependent adsorption desorption controls the transport of solutes in reactive porous media the greater the adsorption the slower the solute migration earlier works show that in the presence of longitudinal hydrodynamic dispersion and ph dependent adsorption a fast solute transport phenomenon may arise however the effect of transverse dispersion on this fast transport phenomenon has not been investigated yet in this paper we report an experimental and modeling work on the fast transport of strontium sr 2 through a reactive porous medium made of sand and hydrous ferric oxide hfo coated sand where both longitudinal and transverse dispersion were important a reactive transport model for an incompressible fluid was developed combining surface complexation with mass conservation equations for a solute and the acidity difference between the concentration of total proton and hydroxide ions the model was used to design and describe experiments run in a column flood system and in a two dimensional 2d bead pack results show that when an alkaline solution containing sr 2 is injected into a 2d bead pack containing hfo coated sand and equilibrated with an acidic solution a sr 2 plume forms which comprises i a retarded front due to the adsorption of sr 2 onto the porous medium ii a fast wave or pulse ahead of the retarded front due to longitudinal dispersion and traveling at the average fluid velocity and iii a continuous leakage from the retarded front due to transverse dispersion the results of this work confirm that ph dependent adsorption desorption process in conjunction with longitudinal dispersion causes fast wave i e a solute migration which is faster than expected if the interplay between ph and dispersion is neglected furthermore transverse dispersion in the presence of a ph gradient gives rise to a plume composed of a leakage from the retarded front connected to the fast wave keywords hydrodynamic dispersion hydrous ferric oxide hfo ph dependent adsorption desorption reactive transport in porous media strontium transverse dispersion 1 introduction fast migration of toxic compounds in porous media is ascribed to either colloid facilitated transport telfeyan et al 2020 yang et al 2021 flow in fractures zhang et al 2022 adsorption desorption process stachowicz et al 2008 appelo et al 2010 cogorno et al 2022 or even a combination of them tang and weisbrod 2009 wolfsberg et al 2017 in this paper we focus on adsorption desorption process and in particular on the case of the ph dependent adsorption desorption the adsorption desorption process controls the transport of solutes in the subsurface lake et al 2002 zhang et al 2007 chilakapati et al 2000 vanduijn et al 1993 in the presence of hydrophilic minerals ph can significantly influence the adsorption desorption of cations onto mineral surfaces as hydrogen ions h compete for the same available surface sites mcneece and hesse 2016a b voegelin et al 2000 scheidegger et al 1994 as an alkaline solution rich in cations moves through a porous medium containing an acidic solution and made of hydrophilic mineral surface cation adsorption onto the surface is expected to be favored and the migration of the cation is expected to be retarded lichtner 1996 however if hydrodynamic dispersion is present a mixing zone between the injected and the initial pore fluid forms ahead of the retarded front rolle et al 2009 dentz et al 2011 if within the mixing zone the ph is acidic cation adsorption may no longer be favored therefore a pulse arises and it travels ahead of the retarded front at the average fluid velocity prigiobbe et al 2012a kohler et al 1996 previous works prigiobbe et al 2012b 2013 prigiobbe and bryant 2014 investigated the combined effect of ph dependent adsorption and hydrodynamic dispersion on strontium sr 2 transport through a porous medium made of hydrous ferric oxide hfo in one dimensional 1d systems experiments and simulations show that when a solution of ph 8 containing sr 2 is injected into a porous medium with hfo coated surface initially stabilized with a solution of ph 3 without sr 2 longitudinal dispersion creates an acidic mixing zone within the mixing zone sr 2 adsorption is negligible and a pulse of sr 2 forms the pulse travels without retardation at the average flow velocity this phenomenon operates independently of other modes of rapid transport such as e g colloid facilitated transport and flow in fractures it was found that the following conditions need to be established in order for this phenomenon to occur ph dependent adsorption hydrodynamic dispersion initial fluid with acidic ph corresponding to negligible adsorption and injected fluid with alkaline ph which determines significant adsorption although a comprehensive analysis of the conditions favorable for the formation of the fast pulse was carried out in 1d systems with a finite amount of longitudinal dispersion no investigations had been carried out in two dimensional 2d systems where both longitudinal and transverse hydrodynamic dispersion are present leaving unsolved the role of the latter previous works show the importance of transverse dispersion on establishing ph gradient perpendicular to the flow direction zhou et al 2019 cirpka et al 2006 rahman et al 2005 kent et al 2000 the work by kent et al 2000 reports field observations of zinc zn 2 transport through an aquifer with hydrophilic minerals zn 2 was released with the disposal of alkaline wastewater data and calculations showed the formation of ph gradient perpendicular to the flow direction and a plume of zn 2 with a retardation increasing with depth the retardation of the plume increased alongside with the ph because the adsorption of the cation onto the mineral surface was favored at alkaline ph the plume was characterized by a fast traveling front in the low ph upper region of the aquifer and a retarded front in the high ph lower region the plume structure suggests that transverse dispersion favored mixing along the vertical direction creating a continuous leakage of zn 2 from the alkaline retarded front into the acidic solution within the aquifer pore space in the presence of a horizontal ph gradient created by longitudinal dispersion a fast pulse may also have had formed ahead of the retarded front the combined effect of longitudinal and transverse dispersion on solute transport through hydrophilic porous media was not however addressed in that work in this paper we present an experimental and modeling work to analyze the role of transverse dispersion in conjunction with longitudinal dispersion and ph dependent adsorption desorption on sr 2 transport in a reactive porous medium made of sand and hfo coated sand 2d reactive transport model was developed and used to design and describe the experiments and simulate the spread of the plume 2 materials and methods 2 1 analytical measurements the granular materials were characterized using x ray powder diffraction ultima iv rigaku u s a scanning electron microscopy energy dispersive x ray spectroscopy sem eds zeiss u s a and brunauer emmett teller bet surface area quantachrome instrument version 11 0 u s a the liquid samples were analyzed using ion chromatography ic 1100 fisher scientific u s a 2 2 coating procedure natural sand sio2 sakrete u s a with median diameter of 0 55 mm was used in this work part of sand was coated with hydrous ferric oxide hfo following the literature scheidegger et al 1993 jerez et al 2006 and used for transport tests briefly a mass of 40 g of fe no 3 9h 2 o fisher chemical u s a was initially dissolved into 500 ml of di water then a volume of 330 ml of 1 228 m of koh fisher scientific u s a was added to the previous solution to reach final ph between 7 and 8 the suspension was stirred for 30 min and dialyzed until the conductivity became less than 5 μ s cm hfo coated sand was prepared by adding 550 g of sand to the hfo suspension for three days the ph was adjusted to maintain a value equal to 7 5 the material was finally washed three times with 1 m hno 3 sigma aldrich u s a and 10 m naoh fisher chemical u s a the measured bet specific surface area for the material was equal to 4 140 m 2 g the produced material was characterized using sem eds fig 1 shows the image recorded during the analyses 2 3 column flood system and experiments transport experiments using a column flood system part a of fig 2 were performed by supplying a solution to a vertical column of 2 7 cm of diameter and 22 9 cm of length omnifit diba u s a through a peristaltic pump masterflex l s u s a the column was filled with natural sand and hfo coated sand sensors of ph and temperature with a datalogger liquiline cm442 endress hauser u s a were installed at the outlet of the column to measure continuously the flow stream the concentration in the outlet was continuously analyzed with the ic located inline with outflow stream a solution of 25 μ m in volume was sampled every 6 min to determine highly resolved breakthrough curves during the tests the column was initially flooded with a solution of ph 3 adjusted by using hcl after the column stabilized at that ph another solution containing sr 2 at given concentration and ph 8 was supplied to the column with a flow rate equal to 1 ml min the concentration of sr 2 was selected in order to avoid supersaturation with respect to strontianite srco 3 the maximum saturation index si of srco 3 was calculated using the open source geochemical software phreeqc usgs 2016 and resulted to be as large as 0 28 at ph 8 50 the porosity of the porous medium was determined gravimetrically preliminary tests using a tracer nacl were carried out to determine the longitudinal hydrodynamic dispersion in particular the values of d l were determined by fitting a front of na with the analytic solution of the 1d advection dispersion equation fetter 1993 under conditions where negligible na adsorption onto the porous medium surface occurs the analytical solution is reported in section 1 of the supporting information si document 2 4 2d bead pack and experiments to study the impact of transverse spread of the plume which is due to transverse dispersion on the longitudinal spreading of the plume transport experiments were run using a 2d bead pack the box had 17 4 cm of height 96 cm of length and 2 cm of width a schematic of the set up is shown in part b of fig 2 the bead pack was filled with uncoated sand and hfo coated sand beads a number of 12 inlet and outlet ports were used to supply and withdraw the solution using a multi channel peristaltic pump ismatec mod ism942 cole parmer u s a at the constant flow rate of 0 325 ml min per channel grab samples were collected at the outlet to measure ph and the concentration of sr 2 and na cations during the tests the bead pack was initially equilibrated at ph 3 once stabilized it was flooded with two different solutions in particular through the six inlets at the bottom half of the set up an alkaline solution of ph 8 containing a given concentration of sr 2 was injected and through the six inlets at the top half of the set up the initial solution was continued to be supplied 3 modeling a reactive transport model was implemented assuming single phase incompressible flow in local chemical equilibrium knapp 1989 lichtner 1996 the model was used to study the transport of three components sr 2 acidity and na through a reactive porous medium the model combines conservation law of the fluid mass 1 q k h with the mass conservation laws of ions in solution 2 c s t ε z s t c s q d c s 0 3 c h t t ε z h t c h t q d c h t 0 4 c n t c n q d c n 0 for t 0 where q is the darcy flux m s k is the hydraulic conductivity coefficient m s h is the hydraulic head m c s c h t and c n are the concentration in solution for sr 2 acidity and na mol kg z s and z h are the adsorbed concentration of sr 2 and h mol m 3 given by the adsorption isotherms in eq 8 and 9 ε is the dimensionless ratio of solid to fluid volume defined as ε 1 ϕ ϕ with ϕ the porosity and d is the hydrodynamic dispersion tensor m 2 s baer and cheng 2010 5 d ϕ d m i α l α t q q q α t q i where d m is the molecular diffusion m 2 s i is the identity matrix α l and α t are the longitudinal and transverse dispersivities m in 2d flow conditions d is a 2 2 tensor which is diagonal in the selected coordinate system and has as coefficients the longitudinal and transverse dispersion coefficients namely d l and d t respectively 6 d l ϕ d m α l q 7 d t ϕ d m α t q eq 2 through 4 are coupled through the adsorbed concentrations given by the adsorption isotherms for sr 2 and h correspondingly 8 z s c s k s z t 1 0 5 c h t c h t 2 4 k w k h c s k s 9 z h 0 5 c h t c h t 2 4 k w k h z t 1 0 5 c h t c h t 2 4 k w k h c s k s where k s and k h are the equilibrium constants of the adsorption reactions of sr 2 and h onto the hfo mineral surface k w is the equilibrium constant for the hydrolysis of water and z t is the total concentration of reactive sites on the hfo mineral surface further details regarding the derivation of eqs 8 and 9 are available in prigiobbe et al 2013 the model was discretized with an implicit finite difference scheme implemented in matlab mat 2021 and solved with the newton raphson method iteratively the length of the 1d transport domain was divided into 100 intervals while the 2d domain was divided into 500 and 12 intervals longitudinally and transversely respectively with no discretization of the depth in both cases the initial time step was set equal to 0 01 s since implicit schemes are unconditionally stable and there is no cfl courant friedrichs lewy condition on the size of the time step typically used for explicit schemes in the model the time steps were selected in a dynamic fashion in order to ensure convergence if the iteration had not converged in ten iterations then the time step was decreased by a factor two so that the original time step was split into two sub time steps if the interaction still did not converge in less than ten iterations the original time step was split into four sub time steps and so on upon convergence the time step was set again equal to the initial selected value tracer tests were carried out before each experiment and the analytical solutions of the 1d and 2d advection dispersion equations fetter 1993 leij and dane 1990 were inverted on the tracer na curves to determine d the 1d and 2d advection dispersion equations are reported in sections 1 and 2 of the si document the values of z t k s and k h for sand and hfo coated sand were adjusted to match the measured breakthrough curves of sr 2 using the optimization function nlinfit in matlab mat 2021 and the initial guess for each parameter was taken from the literature carroll et al 2008 dzombak and morel 1990 4 results and discussion 4 1 measurements and simulations of the column flood experiments in table 1 the experimental conditions of the transport tests carried out with the column flood system exp 1 through 4 are listed together with the estimated model parameters the minor differences between the estimated values in exp 1 and 2 and exp 3 and 4 are due to the change of the material within the column slight variation of the solution composition and experimental errors those differences are however negligible given the complexity of the experiments and they do not affect the reproducibility of the transport phenomenon as can be observed below the measurements of the solute concentration are shown as a function of pore volume injected i e pv q t v ϕ with v the total volume of the granular material within the column the time corresponding to 1 pv in these experiments is equal to approximately 1 hr the values of ϕ and d l were determined through preliminary tracer tests performed before injecting the solution containing sr 2 tracer breakthrough curves were fitted with the analytical solution of the advection dispersion equation and the results are shown in the table within the corresponding columns the péclet number pe v l d l with l the length of the column for each experiment was also calculated pe numbers were equal to 13650 3680 92 and 83 for exp 1 through 4 respectively the decrease of pe in the experiments with hfo coated sand may be due to the coating of the grains that increases porosity and dispersion figs 3 and 4 show measured and modeled breakthrough curves of sr 2 for experiments where the column was filled with uncoated sand and hfo coated sand respectively as mentioned in section 3 the measurements were used to adjust the literature values of the model parameters associated with the adsorption of the ions onto the mineral surface sand and hfo coated sand namely z t k s and k h the sr 2 concentration fronts in fig 3 are characterized by a slightly retarded front which starts to arise at 6 pvs indicating negligible adsorption of the cation onto the mineral surface as expected carroll et al 2008 despite of the negligible adsorption when the initial acidic solution was re injected into the column around 16 18 pvs a sr 2 concentration peak forms due to the release of the adsorbed cation from the mineral surface fig 4 shows the measured and modeled breakthrough curves for exp 3 and 4 where hfo coated sand was used here a much more retarded front of sr 2 can be noticed which starts to arise around 40 pvs such a retardation is due to the significant adsorption of sr 2 onto the mineral surface ahead of the retarded front there is a pulse which breaks through the column approximately at 1 pv indicating that it travels at the average flow velocity without retardation the fast pulse resembles that already observed in our previous works for several alkaline earth elements traveling through media containing hydrophilic minerals such as hfo and hydrous manganese oxide hmo prigiobbe et al 2012b prigiobbe and bryant 2014 ye and prigiobbe 2020 these results therefore confirm the reactivity of hfo coated sand synthesized in this work experiments at different péclet numbers were carried out in an earlier publication of our group prigiobbe et al 2012b it was observed that at the limit of negligible dispersion i e large pe along longitudinal direction there is no formation of the mixing zone therefore the fast pulse cannot occur dispersion is necessary for the formation of the mixing zone but it is not sufficient for the phenomenon to happen because ph dependent adsorption and peculiar initial and injected conditions as specified above are required the model and the data agree well although the model slightly anticipates the break through of the pulse this could be due to a slightly smaller adsorption calculated by the model which translates into a marginally faster migration of the pulse 4 2 measurements and simulations of the experiments run using the 2d bead pack table 2 reports the experimental conditions of the transport tests carried out with the 2d bead pack exp 5 through 9 together with the estimated model parameters in these experiments the time corresponding to 1 pv was equal to 4 5 and 5 hr for exp 5 7 and 8 9 respectively the minor difference between the estimated values of d t in exp 5 and 6 are due to the change of the material within the bead pack this difference is negligible given the complexity of the experiment and it does not affect the reproducibility of the transport phenomenon as can be observed in fig 7 preliminary tracer tests exp 5 6 and 8 were performed to determine the values of ϕ d l and d t by matching the analytical solution of the 2d advection dispersion equation leij and dane 1990 with the breakthrough curves measured at each port of the 2d bead pack part b of fig 2 the hydraulic conductivity k was calculated using the kozeny carman equation as explained in section 3 of the si document figs 5 and 6 show the comparison between the normalized tracer concentrations and the analytical solution for bead pack filled with sand and hfo coated sand respectively the estimated values upon fitting are listed in table 2 the comparison of the measurements with the analytical solution for exp 6 is reported in figure 1 of the si document the péclet number related to estimated longitudinal dispersion pe l for tests run with sand was equal to 2 7 104 and for those run with hfo coated sand was equal to 1 3 104 the péclet number related to the estimated transverse dispersion pe t for tests run with sand was between 1 4 105 and to 2 8 105 and equal to 9 4 104 for those run with hfo coated sand figs 7 and 8 show the comparison between the measured and modeled sr 2 and na concentrations and ph for the tests run using sand and hfo coated sand respectively the scattering of the data in ports 6 through 9 in figs 5 and 6 might be due to measurements errors however the majority of the data are well described by the theory so we considered the estimated transverse dispersion representative of the 2d bead pack the transport behavior of sr 2 shown in fig 7 from ports 1 to port 6 resembles that observed in the 1d transport tests of sr 2 through sand here a retarded front of sr 2 starts to arise around 35 40 h approximately 6 folds the retention time ion concentration and ph decrease across the ports because the alkaline solution containing sr 2 and na is injected only into the first six ports due to transverse dispersion the concentration however decreases smoothly reaching zero at the outflows of port 8 through 12 the ph measurements and simulations do not match very well this can be ascribed to the simplified geochemistry considered in this work a more complex geochemical model of the aqueous speciation would have helped to describe better the data nevertheless the simple model implemented in this work can catch well the dominant mechanism of fast migration of sr 2 due to ph dependent adsorption a different transport behavior can be observed for sr 2 in fig 8 measurements of sr 2 concentration in the outflow from port 1 through 6 show a fast pulse ahead of a retarded front that breaks through around 40 pvs the fast pulse breaks through the bead pack at 1 pv together with the tracer na and the ph front the concentration of sr 2 decreases from port 1 to port 12 but it never becomes zeros contrarily to exp 7 this is due to the effect of transverse dispersion and ph dependent adsorption that favored the mixing between the alkaline solution containing sr 2 injected into the lower part of the bead pack through port 1 to 6 and the acidic solution injected into the upper part of the bead pack through port 7 to 12 the mixing zone had a ph equal to 3 as it is possible to see in the ph measurements at port 5 reported in the figure at this acidic ph sr 2 adsorption onto hfo is negligible therefore the solute within the mixing zone moves without retardation with the flow if the fast pulse is limited to the part of the domain where the alkaline solution is injected port 1 to 6 because it is due to the presence of longitudinal dispersion the leakage occupies the all perpendicular direction to flow to show the structure of the plume simulations were run and the concentration patterns resulting from them are presented below it is important to point out that the simulations in figs 7 and 8 were run by setting the model parameters equal to the values estimated in the experiments presented above i e exp 1 through 4 for z t k s and k h and exp 5 6 and 8 for ϕ d l and d t 4 3 simulations of the plume structure in this section the simulations of the transport of sr 2 ph and na are reported the results are shown as a function of the longitudinal and vertical directions after 30 min since the beginning of the injection five types of initial and boundary conditions were selected namely i acidic initial condition and injection of an acidic solution containing sr 2 ii initial alkaline condition and injection of an alkaline solution containing sr 2 iii initial acidic condition and injection of an alkaline solution containing sr 2 in the lower part of the domain port 1 through 6 iv as in iii but the alkaline condition was injected through the all domain height and v as in iii but the alkaline condition was only injected through the middle of the domain height when the initial and injected solutions regardless of the sr 2 content are acidic fig 9 the sr 2 plume part a moves through the system without retardation as the tracer part b if instead the initial and injected solutions are alkaline fig 10 the sr 2 plume part a is retarded and migrates at much lower speed than the tracer part b with the ph front part c if the conditions as in exp 9 are applied a plume of sr 2 forms fig 11 with a structure that consists of three parts i a retarded front due to the adsorption of sr 2 onto hfo ii a fast wave ahead of the retarded front due to longitudinal dispersion and traveling at the average fluid velocity with the tracer and iii a continuous leakage from the retarded front due to transverse dispersion such a plume structure resembles the observations and calculations made by kent et al 2000 for the case of zn 2 transport through a sand and gravel aquifer however the authors did not observe the fast wave possibly because of the much lower concentration of the that part of the plume it is important to point out that heterogeneity would only modify the shape of the plume but not its structure in addition if the alkaline solution containing sr 2 is injected through the all domain height only the fast pulse forms ahead of the retarded sr 2 front fig 12 this is because transverse dispersion does not create a mixing zone where the chemical conditions are favorable for leakage finally when the injection of the alkaline solution is only through the middle of the domain height the mixing between the retarded front and the initial acidic solution is significantly enhanced and favors a faster spreading of sr 2 through the domain fig 13 the plume consists of a fast pulse traveling with the flow in the middle of the domain and a continuous leakage of sr 2 from the entire extension of the retarded front this distinguishes from the simulation results shown in fig 11 where only the upper part of the retarded sr 2 front was influenced by leakage in summary this paper presents an extension of previous works carried out by the group where the formation of the fast pulse was studied in 1d systems prigiobbe et al 2012a b 2013 prigiobbe and bryant 2014 in those works we considered a 1d system containing a porous medium with a hydrophilic mineral surface i e hfo initially at acidic conditions only longitudinal dispersion was present the work presented here focuses on 2d systems where there is an interplay between longitudinal and transverse dispersion the porous medium and the conditions applied in the 2d system are very similar to those applied in our earlier works the porous medium was initially stabilized at ph 3 with a solution not containing sr 2 then an alkaline solution was injected to highlight the effect of transverse dispersion the injection of the alkaline solution was only through the lower part of the domain while through the upper part of the domain the same initial acidic solution was still injected longitudinal dispersion favored the formation of the fast pulse as in the 1d case and transverse dispersion causes a mixing zone between the lower and upper parts of the domain transverse mixing between the injected solutions creates a region where the ph is lower than that favorable for the adsorption of sr 2 onto hfo i e larger than 7 8 therefore as sr 2 enters the mixing zone it gets transported downstream with the flow creating a continuous leakage the ph in the mixing zone ports 5 to 7 in fig 8 is approximately 3 sr 2 is not adsorbed onto the mineral surface and travels with the flow at the interstitial velocity since transverse mixing establishes simultaneously with longitudinal mixing a plume made of a continuous leakage connected with the fast pulse forms the analysis of the phenomena in a three dimensional 3d is beyond the scope of this work however we expect the phenomena still stand within a 3d system as long as favorable conditions are established for instance if radial transverse dispersion creates a mixing zone with unfavorable adsorption of a solute on the mineral surface then a fast transport as regarded in this manuscript will be occur this could be caused by stabilizing initially a porous medium domain with hydrophilic mineral surface at acidic conditions and then by injecting the same acidic solution into a half of the injection area and an alkaline solution with the cation into the other half mixing will occur favoring the fast migration of the solute into the acidic zone radially and transversal to the radial direction 5 conclusions in this paper the effect of hydrodynamic dispersion on ph dependent transport was studied the migration of sr 2 through sand and hfo coated sand was analyzed with experiments run with a column flood and a 2d bead pack systems a model was implemented to describe the measurements and predict the spread of the solute plume results show that if the adsorption of a solute is favored over protons and an alkaline solution is injected into an acidic aquifer with hydrophilic mineral surface a plume will form and will comprise i a retarded front ii a fast pulse ahead of the front due to longitudinal dispersion and iii a continuous leakage from the retarded front due to transverse dispersion overall this work shows the important interplay of hydrodynamic dispersion and ph dependent adsorption on the fast migration of solutes other than sr 2 through hfo coated sand as investigated in this work the findings of this work are relevant to the interpretation of chemical measurements of solution composition in the laboratory and in the field this fast transport process together with colloid facilitated transport and flow in fractures can help to explain the fast spread of contaminants in the subsurface credit authorship contribution statement dong zhang measurements methodology ting liu conceptualization measurements methodology valentina prigiobbe conceptualization modeling simulation software validation supervision writing editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research project used microscope resources partially funded by the national science foundation united states via grant dmr 0922522 the authors would also like to thank douglas mending in the davidson laboratory at stevens institute of technology for his help in the construction of the bead pack system and the graduate students kaiqi wang wenkai nie and shugeng qian that helped to run some of the experiments reported in this work the authors would like to thank the anonymous reviewers that with their comments helped to improve the manuscript appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j advwatres 2022 104195 appendix a supplementary data the following is the supplementary material related to this article mmc s1 mmc s2 tracer test results and analytical solutions 
151,the process of ph dependent adsorption desorption controls the transport of solutes in reactive porous media the greater the adsorption the slower the solute migration earlier works show that in the presence of longitudinal hydrodynamic dispersion and ph dependent adsorption a fast solute transport phenomenon may arise however the effect of transverse dispersion on this fast transport phenomenon has not been investigated yet in this paper we report an experimental and modeling work on the fast transport of strontium sr 2 through a reactive porous medium made of sand and hydrous ferric oxide hfo coated sand where both longitudinal and transverse dispersion were important a reactive transport model for an incompressible fluid was developed combining surface complexation with mass conservation equations for a solute and the acidity difference between the concentration of total proton and hydroxide ions the model was used to design and describe experiments run in a column flood system and in a two dimensional 2d bead pack results show that when an alkaline solution containing sr 2 is injected into a 2d bead pack containing hfo coated sand and equilibrated with an acidic solution a sr 2 plume forms which comprises i a retarded front due to the adsorption of sr 2 onto the porous medium ii a fast wave or pulse ahead of the retarded front due to longitudinal dispersion and traveling at the average fluid velocity and iii a continuous leakage from the retarded front due to transverse dispersion the results of this work confirm that ph dependent adsorption desorption process in conjunction with longitudinal dispersion causes fast wave i e a solute migration which is faster than expected if the interplay between ph and dispersion is neglected furthermore transverse dispersion in the presence of a ph gradient gives rise to a plume composed of a leakage from the retarded front connected to the fast wave keywords hydrodynamic dispersion hydrous ferric oxide hfo ph dependent adsorption desorption reactive transport in porous media strontium transverse dispersion 1 introduction fast migration of toxic compounds in porous media is ascribed to either colloid facilitated transport telfeyan et al 2020 yang et al 2021 flow in fractures zhang et al 2022 adsorption desorption process stachowicz et al 2008 appelo et al 2010 cogorno et al 2022 or even a combination of them tang and weisbrod 2009 wolfsberg et al 2017 in this paper we focus on adsorption desorption process and in particular on the case of the ph dependent adsorption desorption the adsorption desorption process controls the transport of solutes in the subsurface lake et al 2002 zhang et al 2007 chilakapati et al 2000 vanduijn et al 1993 in the presence of hydrophilic minerals ph can significantly influence the adsorption desorption of cations onto mineral surfaces as hydrogen ions h compete for the same available surface sites mcneece and hesse 2016a b voegelin et al 2000 scheidegger et al 1994 as an alkaline solution rich in cations moves through a porous medium containing an acidic solution and made of hydrophilic mineral surface cation adsorption onto the surface is expected to be favored and the migration of the cation is expected to be retarded lichtner 1996 however if hydrodynamic dispersion is present a mixing zone between the injected and the initial pore fluid forms ahead of the retarded front rolle et al 2009 dentz et al 2011 if within the mixing zone the ph is acidic cation adsorption may no longer be favored therefore a pulse arises and it travels ahead of the retarded front at the average fluid velocity prigiobbe et al 2012a kohler et al 1996 previous works prigiobbe et al 2012b 2013 prigiobbe and bryant 2014 investigated the combined effect of ph dependent adsorption and hydrodynamic dispersion on strontium sr 2 transport through a porous medium made of hydrous ferric oxide hfo in one dimensional 1d systems experiments and simulations show that when a solution of ph 8 containing sr 2 is injected into a porous medium with hfo coated surface initially stabilized with a solution of ph 3 without sr 2 longitudinal dispersion creates an acidic mixing zone within the mixing zone sr 2 adsorption is negligible and a pulse of sr 2 forms the pulse travels without retardation at the average flow velocity this phenomenon operates independently of other modes of rapid transport such as e g colloid facilitated transport and flow in fractures it was found that the following conditions need to be established in order for this phenomenon to occur ph dependent adsorption hydrodynamic dispersion initial fluid with acidic ph corresponding to negligible adsorption and injected fluid with alkaline ph which determines significant adsorption although a comprehensive analysis of the conditions favorable for the formation of the fast pulse was carried out in 1d systems with a finite amount of longitudinal dispersion no investigations had been carried out in two dimensional 2d systems where both longitudinal and transverse hydrodynamic dispersion are present leaving unsolved the role of the latter previous works show the importance of transverse dispersion on establishing ph gradient perpendicular to the flow direction zhou et al 2019 cirpka et al 2006 rahman et al 2005 kent et al 2000 the work by kent et al 2000 reports field observations of zinc zn 2 transport through an aquifer with hydrophilic minerals zn 2 was released with the disposal of alkaline wastewater data and calculations showed the formation of ph gradient perpendicular to the flow direction and a plume of zn 2 with a retardation increasing with depth the retardation of the plume increased alongside with the ph because the adsorption of the cation onto the mineral surface was favored at alkaline ph the plume was characterized by a fast traveling front in the low ph upper region of the aquifer and a retarded front in the high ph lower region the plume structure suggests that transverse dispersion favored mixing along the vertical direction creating a continuous leakage of zn 2 from the alkaline retarded front into the acidic solution within the aquifer pore space in the presence of a horizontal ph gradient created by longitudinal dispersion a fast pulse may also have had formed ahead of the retarded front the combined effect of longitudinal and transverse dispersion on solute transport through hydrophilic porous media was not however addressed in that work in this paper we present an experimental and modeling work to analyze the role of transverse dispersion in conjunction with longitudinal dispersion and ph dependent adsorption desorption on sr 2 transport in a reactive porous medium made of sand and hfo coated sand 2d reactive transport model was developed and used to design and describe the experiments and simulate the spread of the plume 2 materials and methods 2 1 analytical measurements the granular materials were characterized using x ray powder diffraction ultima iv rigaku u s a scanning electron microscopy energy dispersive x ray spectroscopy sem eds zeiss u s a and brunauer emmett teller bet surface area quantachrome instrument version 11 0 u s a the liquid samples were analyzed using ion chromatography ic 1100 fisher scientific u s a 2 2 coating procedure natural sand sio2 sakrete u s a with median diameter of 0 55 mm was used in this work part of sand was coated with hydrous ferric oxide hfo following the literature scheidegger et al 1993 jerez et al 2006 and used for transport tests briefly a mass of 40 g of fe no 3 9h 2 o fisher chemical u s a was initially dissolved into 500 ml of di water then a volume of 330 ml of 1 228 m of koh fisher scientific u s a was added to the previous solution to reach final ph between 7 and 8 the suspension was stirred for 30 min and dialyzed until the conductivity became less than 5 μ s cm hfo coated sand was prepared by adding 550 g of sand to the hfo suspension for three days the ph was adjusted to maintain a value equal to 7 5 the material was finally washed three times with 1 m hno 3 sigma aldrich u s a and 10 m naoh fisher chemical u s a the measured bet specific surface area for the material was equal to 4 140 m 2 g the produced material was characterized using sem eds fig 1 shows the image recorded during the analyses 2 3 column flood system and experiments transport experiments using a column flood system part a of fig 2 were performed by supplying a solution to a vertical column of 2 7 cm of diameter and 22 9 cm of length omnifit diba u s a through a peristaltic pump masterflex l s u s a the column was filled with natural sand and hfo coated sand sensors of ph and temperature with a datalogger liquiline cm442 endress hauser u s a were installed at the outlet of the column to measure continuously the flow stream the concentration in the outlet was continuously analyzed with the ic located inline with outflow stream a solution of 25 μ m in volume was sampled every 6 min to determine highly resolved breakthrough curves during the tests the column was initially flooded with a solution of ph 3 adjusted by using hcl after the column stabilized at that ph another solution containing sr 2 at given concentration and ph 8 was supplied to the column with a flow rate equal to 1 ml min the concentration of sr 2 was selected in order to avoid supersaturation with respect to strontianite srco 3 the maximum saturation index si of srco 3 was calculated using the open source geochemical software phreeqc usgs 2016 and resulted to be as large as 0 28 at ph 8 50 the porosity of the porous medium was determined gravimetrically preliminary tests using a tracer nacl were carried out to determine the longitudinal hydrodynamic dispersion in particular the values of d l were determined by fitting a front of na with the analytic solution of the 1d advection dispersion equation fetter 1993 under conditions where negligible na adsorption onto the porous medium surface occurs the analytical solution is reported in section 1 of the supporting information si document 2 4 2d bead pack and experiments to study the impact of transverse spread of the plume which is due to transverse dispersion on the longitudinal spreading of the plume transport experiments were run using a 2d bead pack the box had 17 4 cm of height 96 cm of length and 2 cm of width a schematic of the set up is shown in part b of fig 2 the bead pack was filled with uncoated sand and hfo coated sand beads a number of 12 inlet and outlet ports were used to supply and withdraw the solution using a multi channel peristaltic pump ismatec mod ism942 cole parmer u s a at the constant flow rate of 0 325 ml min per channel grab samples were collected at the outlet to measure ph and the concentration of sr 2 and na cations during the tests the bead pack was initially equilibrated at ph 3 once stabilized it was flooded with two different solutions in particular through the six inlets at the bottom half of the set up an alkaline solution of ph 8 containing a given concentration of sr 2 was injected and through the six inlets at the top half of the set up the initial solution was continued to be supplied 3 modeling a reactive transport model was implemented assuming single phase incompressible flow in local chemical equilibrium knapp 1989 lichtner 1996 the model was used to study the transport of three components sr 2 acidity and na through a reactive porous medium the model combines conservation law of the fluid mass 1 q k h with the mass conservation laws of ions in solution 2 c s t ε z s t c s q d c s 0 3 c h t t ε z h t c h t q d c h t 0 4 c n t c n q d c n 0 for t 0 where q is the darcy flux m s k is the hydraulic conductivity coefficient m s h is the hydraulic head m c s c h t and c n are the concentration in solution for sr 2 acidity and na mol kg z s and z h are the adsorbed concentration of sr 2 and h mol m 3 given by the adsorption isotherms in eq 8 and 9 ε is the dimensionless ratio of solid to fluid volume defined as ε 1 ϕ ϕ with ϕ the porosity and d is the hydrodynamic dispersion tensor m 2 s baer and cheng 2010 5 d ϕ d m i α l α t q q q α t q i where d m is the molecular diffusion m 2 s i is the identity matrix α l and α t are the longitudinal and transverse dispersivities m in 2d flow conditions d is a 2 2 tensor which is diagonal in the selected coordinate system and has as coefficients the longitudinal and transverse dispersion coefficients namely d l and d t respectively 6 d l ϕ d m α l q 7 d t ϕ d m α t q eq 2 through 4 are coupled through the adsorbed concentrations given by the adsorption isotherms for sr 2 and h correspondingly 8 z s c s k s z t 1 0 5 c h t c h t 2 4 k w k h c s k s 9 z h 0 5 c h t c h t 2 4 k w k h z t 1 0 5 c h t c h t 2 4 k w k h c s k s where k s and k h are the equilibrium constants of the adsorption reactions of sr 2 and h onto the hfo mineral surface k w is the equilibrium constant for the hydrolysis of water and z t is the total concentration of reactive sites on the hfo mineral surface further details regarding the derivation of eqs 8 and 9 are available in prigiobbe et al 2013 the model was discretized with an implicit finite difference scheme implemented in matlab mat 2021 and solved with the newton raphson method iteratively the length of the 1d transport domain was divided into 100 intervals while the 2d domain was divided into 500 and 12 intervals longitudinally and transversely respectively with no discretization of the depth in both cases the initial time step was set equal to 0 01 s since implicit schemes are unconditionally stable and there is no cfl courant friedrichs lewy condition on the size of the time step typically used for explicit schemes in the model the time steps were selected in a dynamic fashion in order to ensure convergence if the iteration had not converged in ten iterations then the time step was decreased by a factor two so that the original time step was split into two sub time steps if the interaction still did not converge in less than ten iterations the original time step was split into four sub time steps and so on upon convergence the time step was set again equal to the initial selected value tracer tests were carried out before each experiment and the analytical solutions of the 1d and 2d advection dispersion equations fetter 1993 leij and dane 1990 were inverted on the tracer na curves to determine d the 1d and 2d advection dispersion equations are reported in sections 1 and 2 of the si document the values of z t k s and k h for sand and hfo coated sand were adjusted to match the measured breakthrough curves of sr 2 using the optimization function nlinfit in matlab mat 2021 and the initial guess for each parameter was taken from the literature carroll et al 2008 dzombak and morel 1990 4 results and discussion 4 1 measurements and simulations of the column flood experiments in table 1 the experimental conditions of the transport tests carried out with the column flood system exp 1 through 4 are listed together with the estimated model parameters the minor differences between the estimated values in exp 1 and 2 and exp 3 and 4 are due to the change of the material within the column slight variation of the solution composition and experimental errors those differences are however negligible given the complexity of the experiments and they do not affect the reproducibility of the transport phenomenon as can be observed below the measurements of the solute concentration are shown as a function of pore volume injected i e pv q t v ϕ with v the total volume of the granular material within the column the time corresponding to 1 pv in these experiments is equal to approximately 1 hr the values of ϕ and d l were determined through preliminary tracer tests performed before injecting the solution containing sr 2 tracer breakthrough curves were fitted with the analytical solution of the advection dispersion equation and the results are shown in the table within the corresponding columns the péclet number pe v l d l with l the length of the column for each experiment was also calculated pe numbers were equal to 13650 3680 92 and 83 for exp 1 through 4 respectively the decrease of pe in the experiments with hfo coated sand may be due to the coating of the grains that increases porosity and dispersion figs 3 and 4 show measured and modeled breakthrough curves of sr 2 for experiments where the column was filled with uncoated sand and hfo coated sand respectively as mentioned in section 3 the measurements were used to adjust the literature values of the model parameters associated with the adsorption of the ions onto the mineral surface sand and hfo coated sand namely z t k s and k h the sr 2 concentration fronts in fig 3 are characterized by a slightly retarded front which starts to arise at 6 pvs indicating negligible adsorption of the cation onto the mineral surface as expected carroll et al 2008 despite of the negligible adsorption when the initial acidic solution was re injected into the column around 16 18 pvs a sr 2 concentration peak forms due to the release of the adsorbed cation from the mineral surface fig 4 shows the measured and modeled breakthrough curves for exp 3 and 4 where hfo coated sand was used here a much more retarded front of sr 2 can be noticed which starts to arise around 40 pvs such a retardation is due to the significant adsorption of sr 2 onto the mineral surface ahead of the retarded front there is a pulse which breaks through the column approximately at 1 pv indicating that it travels at the average flow velocity without retardation the fast pulse resembles that already observed in our previous works for several alkaline earth elements traveling through media containing hydrophilic minerals such as hfo and hydrous manganese oxide hmo prigiobbe et al 2012b prigiobbe and bryant 2014 ye and prigiobbe 2020 these results therefore confirm the reactivity of hfo coated sand synthesized in this work experiments at different péclet numbers were carried out in an earlier publication of our group prigiobbe et al 2012b it was observed that at the limit of negligible dispersion i e large pe along longitudinal direction there is no formation of the mixing zone therefore the fast pulse cannot occur dispersion is necessary for the formation of the mixing zone but it is not sufficient for the phenomenon to happen because ph dependent adsorption and peculiar initial and injected conditions as specified above are required the model and the data agree well although the model slightly anticipates the break through of the pulse this could be due to a slightly smaller adsorption calculated by the model which translates into a marginally faster migration of the pulse 4 2 measurements and simulations of the experiments run using the 2d bead pack table 2 reports the experimental conditions of the transport tests carried out with the 2d bead pack exp 5 through 9 together with the estimated model parameters in these experiments the time corresponding to 1 pv was equal to 4 5 and 5 hr for exp 5 7 and 8 9 respectively the minor difference between the estimated values of d t in exp 5 and 6 are due to the change of the material within the bead pack this difference is negligible given the complexity of the experiment and it does not affect the reproducibility of the transport phenomenon as can be observed in fig 7 preliminary tracer tests exp 5 6 and 8 were performed to determine the values of ϕ d l and d t by matching the analytical solution of the 2d advection dispersion equation leij and dane 1990 with the breakthrough curves measured at each port of the 2d bead pack part b of fig 2 the hydraulic conductivity k was calculated using the kozeny carman equation as explained in section 3 of the si document figs 5 and 6 show the comparison between the normalized tracer concentrations and the analytical solution for bead pack filled with sand and hfo coated sand respectively the estimated values upon fitting are listed in table 2 the comparison of the measurements with the analytical solution for exp 6 is reported in figure 1 of the si document the péclet number related to estimated longitudinal dispersion pe l for tests run with sand was equal to 2 7 104 and for those run with hfo coated sand was equal to 1 3 104 the péclet number related to the estimated transverse dispersion pe t for tests run with sand was between 1 4 105 and to 2 8 105 and equal to 9 4 104 for those run with hfo coated sand figs 7 and 8 show the comparison between the measured and modeled sr 2 and na concentrations and ph for the tests run using sand and hfo coated sand respectively the scattering of the data in ports 6 through 9 in figs 5 and 6 might be due to measurements errors however the majority of the data are well described by the theory so we considered the estimated transverse dispersion representative of the 2d bead pack the transport behavior of sr 2 shown in fig 7 from ports 1 to port 6 resembles that observed in the 1d transport tests of sr 2 through sand here a retarded front of sr 2 starts to arise around 35 40 h approximately 6 folds the retention time ion concentration and ph decrease across the ports because the alkaline solution containing sr 2 and na is injected only into the first six ports due to transverse dispersion the concentration however decreases smoothly reaching zero at the outflows of port 8 through 12 the ph measurements and simulations do not match very well this can be ascribed to the simplified geochemistry considered in this work a more complex geochemical model of the aqueous speciation would have helped to describe better the data nevertheless the simple model implemented in this work can catch well the dominant mechanism of fast migration of sr 2 due to ph dependent adsorption a different transport behavior can be observed for sr 2 in fig 8 measurements of sr 2 concentration in the outflow from port 1 through 6 show a fast pulse ahead of a retarded front that breaks through around 40 pvs the fast pulse breaks through the bead pack at 1 pv together with the tracer na and the ph front the concentration of sr 2 decreases from port 1 to port 12 but it never becomes zeros contrarily to exp 7 this is due to the effect of transverse dispersion and ph dependent adsorption that favored the mixing between the alkaline solution containing sr 2 injected into the lower part of the bead pack through port 1 to 6 and the acidic solution injected into the upper part of the bead pack through port 7 to 12 the mixing zone had a ph equal to 3 as it is possible to see in the ph measurements at port 5 reported in the figure at this acidic ph sr 2 adsorption onto hfo is negligible therefore the solute within the mixing zone moves without retardation with the flow if the fast pulse is limited to the part of the domain where the alkaline solution is injected port 1 to 6 because it is due to the presence of longitudinal dispersion the leakage occupies the all perpendicular direction to flow to show the structure of the plume simulations were run and the concentration patterns resulting from them are presented below it is important to point out that the simulations in figs 7 and 8 were run by setting the model parameters equal to the values estimated in the experiments presented above i e exp 1 through 4 for z t k s and k h and exp 5 6 and 8 for ϕ d l and d t 4 3 simulations of the plume structure in this section the simulations of the transport of sr 2 ph and na are reported the results are shown as a function of the longitudinal and vertical directions after 30 min since the beginning of the injection five types of initial and boundary conditions were selected namely i acidic initial condition and injection of an acidic solution containing sr 2 ii initial alkaline condition and injection of an alkaline solution containing sr 2 iii initial acidic condition and injection of an alkaline solution containing sr 2 in the lower part of the domain port 1 through 6 iv as in iii but the alkaline condition was injected through the all domain height and v as in iii but the alkaline condition was only injected through the middle of the domain height when the initial and injected solutions regardless of the sr 2 content are acidic fig 9 the sr 2 plume part a moves through the system without retardation as the tracer part b if instead the initial and injected solutions are alkaline fig 10 the sr 2 plume part a is retarded and migrates at much lower speed than the tracer part b with the ph front part c if the conditions as in exp 9 are applied a plume of sr 2 forms fig 11 with a structure that consists of three parts i a retarded front due to the adsorption of sr 2 onto hfo ii a fast wave ahead of the retarded front due to longitudinal dispersion and traveling at the average fluid velocity with the tracer and iii a continuous leakage from the retarded front due to transverse dispersion such a plume structure resembles the observations and calculations made by kent et al 2000 for the case of zn 2 transport through a sand and gravel aquifer however the authors did not observe the fast wave possibly because of the much lower concentration of the that part of the plume it is important to point out that heterogeneity would only modify the shape of the plume but not its structure in addition if the alkaline solution containing sr 2 is injected through the all domain height only the fast pulse forms ahead of the retarded sr 2 front fig 12 this is because transverse dispersion does not create a mixing zone where the chemical conditions are favorable for leakage finally when the injection of the alkaline solution is only through the middle of the domain height the mixing between the retarded front and the initial acidic solution is significantly enhanced and favors a faster spreading of sr 2 through the domain fig 13 the plume consists of a fast pulse traveling with the flow in the middle of the domain and a continuous leakage of sr 2 from the entire extension of the retarded front this distinguishes from the simulation results shown in fig 11 where only the upper part of the retarded sr 2 front was influenced by leakage in summary this paper presents an extension of previous works carried out by the group where the formation of the fast pulse was studied in 1d systems prigiobbe et al 2012a b 2013 prigiobbe and bryant 2014 in those works we considered a 1d system containing a porous medium with a hydrophilic mineral surface i e hfo initially at acidic conditions only longitudinal dispersion was present the work presented here focuses on 2d systems where there is an interplay between longitudinal and transverse dispersion the porous medium and the conditions applied in the 2d system are very similar to those applied in our earlier works the porous medium was initially stabilized at ph 3 with a solution not containing sr 2 then an alkaline solution was injected to highlight the effect of transverse dispersion the injection of the alkaline solution was only through the lower part of the domain while through the upper part of the domain the same initial acidic solution was still injected longitudinal dispersion favored the formation of the fast pulse as in the 1d case and transverse dispersion causes a mixing zone between the lower and upper parts of the domain transverse mixing between the injected solutions creates a region where the ph is lower than that favorable for the adsorption of sr 2 onto hfo i e larger than 7 8 therefore as sr 2 enters the mixing zone it gets transported downstream with the flow creating a continuous leakage the ph in the mixing zone ports 5 to 7 in fig 8 is approximately 3 sr 2 is not adsorbed onto the mineral surface and travels with the flow at the interstitial velocity since transverse mixing establishes simultaneously with longitudinal mixing a plume made of a continuous leakage connected with the fast pulse forms the analysis of the phenomena in a three dimensional 3d is beyond the scope of this work however we expect the phenomena still stand within a 3d system as long as favorable conditions are established for instance if radial transverse dispersion creates a mixing zone with unfavorable adsorption of a solute on the mineral surface then a fast transport as regarded in this manuscript will be occur this could be caused by stabilizing initially a porous medium domain with hydrophilic mineral surface at acidic conditions and then by injecting the same acidic solution into a half of the injection area and an alkaline solution with the cation into the other half mixing will occur favoring the fast migration of the solute into the acidic zone radially and transversal to the radial direction 5 conclusions in this paper the effect of hydrodynamic dispersion on ph dependent transport was studied the migration of sr 2 through sand and hfo coated sand was analyzed with experiments run with a column flood and a 2d bead pack systems a model was implemented to describe the measurements and predict the spread of the solute plume results show that if the adsorption of a solute is favored over protons and an alkaline solution is injected into an acidic aquifer with hydrophilic mineral surface a plume will form and will comprise i a retarded front ii a fast pulse ahead of the front due to longitudinal dispersion and iii a continuous leakage from the retarded front due to transverse dispersion overall this work shows the important interplay of hydrodynamic dispersion and ph dependent adsorption on the fast migration of solutes other than sr 2 through hfo coated sand as investigated in this work the findings of this work are relevant to the interpretation of chemical measurements of solution composition in the laboratory and in the field this fast transport process together with colloid facilitated transport and flow in fractures can help to explain the fast spread of contaminants in the subsurface credit authorship contribution statement dong zhang measurements methodology ting liu conceptualization measurements methodology valentina prigiobbe conceptualization modeling simulation software validation supervision writing editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research project used microscope resources partially funded by the national science foundation united states via grant dmr 0922522 the authors would also like to thank douglas mending in the davidson laboratory at stevens institute of technology for his help in the construction of the bead pack system and the graduate students kaiqi wang wenkai nie and shugeng qian that helped to run some of the experiments reported in this work the authors would like to thank the anonymous reviewers that with their comments helped to improve the manuscript appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j advwatres 2022 104195 appendix a supplementary data the following is the supplementary material related to this article mmc s1 mmc s2 tracer test results and analytical solutions 
152,saline intrusion si in coastal aquifers is a global problem with the potential to contaminate groundwater used by over a billion people numerical modelling of si in coastal aquifers is a key tool for risk assessment aquifer management and resource regulation but is extremely challenging because the mixing zone across the saline front is often very narrow extending over metres or 10 s metres yet the saline front itself may extend laterally over a large i e many km three dimensional 3d domain moreover the aquifer may be highly heterogeneous further complicating the movement and geometry of the front we test here the use of dynamic mesh optimization dmo in a parallel computational framework to simulate si with higher accuracy and lower computational cost compared to fixed mesh approaches the framework uses a double control volume finite element dcvfe method and is implemented in the open source imperial college finite element reservoir simulator ic ferst but could be implemented in other fe based simulators we confirm accuracy and convergence using test cases based on the classic henry si problem demonstrating that solutions obtained using dmo require significantly fewer elements and therefore have much lower computational cost compared to equivalent fixed mesh solutions we apply the framework to a realistic 3d case study simulating saline intrusion in a heterogeneous chalk aquifer demonstrating simulation speed up in excess of 120 we suggest that parallelized dmo offers significant advantages over existing methods to simulate si keywords coastal aquifers saline intrusion numerical modelling unstructured mesh dynamic mesh optimization computational cost 1 introduction groundwater is the primary source of water for human consumption in most countries arfib and charlier 2016 bakalowicz 2015 demand is particularly high in coastal regions custodio 2010 over 1 2 billion people live within 100 km of a coastline and population densities in these areas are around three times the global average small and nicholls 2003 increased groundwater abstraction in response to urbanization uddameri et al 2014 boretti and rosa 2019 combined with natural phenomena such as rising sea levels due to climate change masciopinto and liso 2016 ketabchi et al 2016 or storm surges cardenas et al 2015 klassen and allen 2017 can affect the balance between freshwater discharging to the sea and the inland movement of saline water ferguson and gleeson 2012 this imbalance typically results in saline intrusion si a dynamic inland movement of saline water that can lead to contamination of freshwater resources with major economic health and social consequences arfib and charlier 2016 morgan and werner 2015 si can be particularly pronounced in fractured or highly permeable or heterogeneous aquifers de filippis et al 2016 especially when subject to marked increases in groundwater abstraction or sudden and substantial changes in sea level such as storm surges klassen and allen 2017 such conditions can lead to highly dynamic changes in the sharp saline freshwater interface graham et al 2018 with important consequences for the management of coastal groundwater resources monitoring si using for example measurements of groundwater level and electrical conductivity as a proxy for salinity requires multiple boreholes while geophysical monitoring requires surface and or borehole equipment that can be logistically challenging to install and or prohibitively expensive macallister et al 2018 monitoring alone shows only the current extent of the intruding seawater and cannot predict future si or its response to changes in abstraction or sea level consequently risk assessment aquifer management and resource regulation are typically based on the predictions of computational groundwater models that solve the coupled density dependent flow and solute transport equations numerical simulation of si however is extremely challenging particularly where the mixing zone is very narrow huyakorn et al 1996 younes et al 2009 isa abadi et al 2020 and dynamic graham et al 2018 in such cases the transition from saline to freshwater may occur over metres or 10 s of metres whereas the saline front and associated aquifer may extend inland and along the coast over several km high grid or mesh resolution is essential to resolve accurately the location and movement of the saline front but the combination of high resolution and large model domain is computationally challenging voss and souza 1987 souza and voss 1987 huyakorn et al 1996 roy and datta 2018 one of the key constraints on accurately modelling dynamic saline intrusion is the use static or fixed meshes whether structured e g seawat langevin et al 2007 or unstructured e g femwater lin et al 1997 sutra voss and provost 1984 hydrogeosphere therrien et al 2010 pflotran lichtner et al 2015 min3p hpc su et al 2021 comsol koohbor et al 2019 although some of these codes make use of parallel processing that can speed up the computation process e g hydrogeosphere plotran min3p hpc comsol many do not hwang et al 2014 as a result fixed mesh constraints are such that many si simulations are simplified to two rather than three dimensions 3d this can significantly reduce their practical applicability and predictive capabilities for tackling real world problems kerrou and renard 2010 rajabi and ataie ashtiani 2014 graham et al 2018 koohbora et al 2019 here we test the use of dynamic mesh optimization dmo in conjunction with parallel computing to increase the speed and accuracy of groundwater flow and transport modelling with specific application to si dmo allows the geometry and resolution of an unstructured mesh to change during a simulation typically to place higher and often anisotropic mesh resolution in parts of the domain where there are steep gradients in the solution and lower resolution elsewhere dmo allows solutions with high accuracy to be obtained at lower computational cost compared to using a fixed mesh and has been widely applied in other areas of cfd alauzet and loseille 2016 xie et al 2014 hu et al 2018 there are however very few applications of dmo in porous media flow modelling because extension to heterogeneous porous media is non trivial given the requirement to include and preserve the spatially complex material properties associated with geologic heterogeneity jackson et al 2014 2015 jacquemyn et al 2019 osman et al 2021 the dmo algorithm reported here allows elements within an unstructured mesh to be split or amalgamated h adaptivity or element vertices to be moved r adaptivity it differs significantly from the related concept of adaptive grid refinement agr which has previously been applied to model reservoir flows although not to the specific problem of si agr utilizes only h adaptivity and cartesian grids grid cells are split by adding cell boundaries schmidt and jacobs 1988 dahle et al 1990 1992 hornung and trangenstein 1997 trangenstein 2002 wolff et al 2013 fig 1 early applications of h adaptivity in reservoir modelling neglected geologic heterogeneity schmidt and jacobs 1988 dahle et al 1990 1992 later studies included heterogeneity but started with a fine scale geologic model as input grid refinement in such models is straightforward as daughter cells simply inherit the hydrological properties of the parent cell however the minimum grid resolution remains fixed by the initial fine scale model which means the computational cost can only increase as new cells are added coarsening the initial grid to reduce cost requires the hydrological properties such as porosity and permeability to be upscaled onto the coarser grid hornung and trangenstein 1997 trangenstein 2002 wolff et al 2013 this upscaling of permeability can impose a significant computational cost trangenstein 2002 gerritsen and lambers 2008 wolff et al 2013 in an attempt to circumvent this problem some studies upscaled the fine scale hydrological properties to a range of pre selected coarse grid cell sizes prior to simulating flow trangenstein 2002 wolff et al 2013 the pre calculated values were then assigned to the adaptively sized coarse cells during simulation however the flexibility of h adaptivity is compromised by the requirement to pre select a range of cell sizes moreover extension of such approaches to the more complex mesh geometries required to represent many geologic heterogeneities is non trivial no general methods for upscaling permeability on arbitrary meshes have yet been developed finally most published studies deploying agr for reservoir flows consider 2d models only trangenstein 2002 gerritsen and lambers 2008 wolff et al 2013 the approach adopted here allows dmo to be applied in 3d numerical simulations of flow and transport in complex geologic porous media and is computationally efficient because it does not require the hydrological properties to be up cross or downscaled each time the mesh is optimized or to be calculated a priori efficient application of dmo for aquifer and reservoir modelling is facilitated by use of surface based geologic modelling sbgm jackson et al 2014 jacquemyn et al 2019 salinas et al 2021 sbgm is an approach whereby all geological heterogeneity whether it is structural stratigraphic sedimentological or diagenetic in origin is represented by surfaces that enclose discrete rock volumes termed geological domains jackson et al 2014 hydrogeological properties are homogeneous within these geological domains models can therefore be created without reference to an underlying grid or mesh jackson et al 2014 previous work has shown that the correlated heterogeneity captured by these domains and by similar concepts such as lithofacies modelling has the most significant impact on flow the element to element or cell to cell scale variability in hydrogeological properties often produced by point or cell based reservoir modelling approaches can be neglected willis and white 2000 feyen and caers 2006 bianchi and zheng 2016 osman et al 2021 an initial mesh is created only when required for numerical calculations this mesh is as coarse as possible whilst preserving the geologic surface architecture within a target error the initial mesh defines master nodes that represent the surfaces and cannot be modified by dmo sbgm is therefore compatible with dmo because surfaces are preserved during mesh adaptivity through the use of the master nodes moreover because petrophysical properties are defined with domains there is no need to up cross or downscale hydrogeological properties such as permeability onto the new mesh after it has been modified by dmo jackson et al 2015 new elements simply inherit the hydrogeological properties of the parent domain to quantify the benefits of dmo in conjunction with parallel computing for si modelling we extend an existing framework for porous media flow with dmo to include for the first time salt transport and associated density driven flows and demonstrate dmo for heterogeneous porous media flow in a parallel computational framework the framework is implemented in the open source imperial college finite element reservoir simulator ic ferst see http multifluids github io but the approach we report could be implemented in other codes using the control volume finite element method cvfem previous work using our framework without the parallel implementation reported here includes simulation of two phase flow in petroleum reservoirs jackson et al 2015 and during viscous fingering kampitsis et al 2020 the related problem of heat transport and associated density driven flow in geothermal reservoirs salinas et al 2021 and solid fluid coupling for flow in fractures obeysekara et al 2018 there are no previous applications of dmo to the coupled density dependent flow and solute transport problem of interest here we begin by outlining the framework and its extension to solute transport and parallel dmo we then demonstrate accuracy and convergence of the extended framework against benchmark solutions based on the classic henry si problem henry 1964 we finish by demonstrating practical application of the framework including parallel scaling performance to a realistic 3d case study simulating saline intrusion in a heterogeneous chalk aquifer modelled using sbgm the main aim of the work is to test the hypothesis that dmo in a parallel framework can yield significant computational speedup when simulating si in realistic 3d models the novelty lies partly in the extension of an existing computational framework for porous media flow and dmo to include salt transport in a parallel framework but primarily in the first application of dmo to the problem of modelling si in heterogeneous 3d aquifers 2 methodology 2 1 governing equations for a density dependent flow in porous media the water flux is given by darcy s equation which for single phase flow where depth is positive is written as 1 q k μ p ρ g combining this with the conservation of mass i e continuity equation gives 2 ϕ ρ t ϕ ρ v 0 where q is the darcy velocity vector m s defined as q ϕ v in which ϕ is the effective porosity and v is the mean pore water velocity vector m s k denotes the intrinsic permeability tensor of the porous medium m 2 μ and ρ denote dynamic viscosity pa s and fluid density kg m 3 respectively p is fluid pressure p a and g is the gravitational field tensor m s 2 the effect of fluid and porous medium compressibility can be combined into a single parameter the specific storage coefficient s 0 m 1 giving 3 s 0 g p t ϕ ρ v 0 for saline intrusion modelling a transport equation for the salt mass is also required 4 ϕ c t ϕ v c ϕ d m i d c where c is the solute contaminant concentration kg m 3 i is the identity tensor d m is the molecular diffusion coefficient m 2 s and d is the mechanical dispersion tensor m 2 s the typical solute concentration of seawater c s is around 35 kg m 3 croucher and o sullivan 1995 which gives a fluid density of 1025 kg m 3 a linear relationship is assumed between density and concentration croucher and o sullivan 1995 fahs et al 2016 5 ρ ρ 0 1 β c where ρ 0 1000 kg m 3 is the corresponding reference density at c 0 and β 0 7143 1 0 3 m 3 kg this means eqs 3 and 4 are coupled and must be solved simultaneously we express results in terms of solute mass fraction relative to seawater c defined as 6 c c c s an isotropic representation is assumed to approximate the mechanical dispersion component of the salt transport thus d is a symmetric tensor defined as 7 d d x x d x y d x z d y x d y y d y z d z x d z y d z z where d x y d y x d x z d z x and d y z d z y the diagonal components in eq 7 are defined as 8 d x x 1 v 2 d l v x 2 d t v y 2 d t v z 2 9 d y y 1 v 2 d t v x 2 d l v y 2 d t v z 2 10 d z z 1 v 2 d t v x 2 d t v y 2 d l v z 2 where v denotes the magnitude of the velocity vector and v x v y and v z represent the magnitude of the velocity components in the x y and z directions respectively d l and d t are longitudinal and transverse dispersion coefficients m 2 s respectively the off diagonal elements in 7 are 11 d i j d l d t v 2 v i v j where i j and i j x y z the dispersion coefficients are dependent on the absolute magnitude of the local velocity and are defined as 12 d l α l v 13 d t α t v where α l and α t are the longitudinal and transverse dispersivities m of the porous medium respectively 2 2 discretization the double control volume finite element method dcvfem used here is discussed in detail elsewhere salinas et al 2017b so we provide only a brief summary the method is applied on fully unstructured triangular and tetrahedral 2d and 3d meshes velocity is discretized conventionally using discontinuous galerkin dg finite elements fe in the element mesh but unlike conventional cvfem pressure is discretized using control volumes cvs in the dual mesh created by connecting the barycentres of the elements fig 2 the dcvfem was specifically developed to improve convergence rate and success in models with poor quality meshes typically containing elements with large internal angles that are easily created in models of heterogeneous aquifers containing high aspect ratio geological features extending the approach to solute transport concentration is discretized using cvs rock porosity and permeability are piecewise constant within fes while fluid density and viscosity are piecewise constant within cvs here we use the element pair p 0 d g p 1 c v in which velocity is discontinuous and is represented element wise with a discretization order of 0 constant within elements while pressure and concentration are continuous and are represented cv wise with a discretization order of 1 linear variation within elements fig 2 space and time are discretized using higher order methods to increase solution accuracy stabilization methods are implemented to ensure monotonic solutions when dealing with high courant friedrichs lewy or peclet numbers the flux at the interface between two control volumes c v i and c v j sharing the same edge is computed as 14 v σ 1 1 2 σ i v i σ j v j where σ μ k 1 and the tilde symbol denotes the value at the interface of i and j to compute a high order approximation of the flux at the interface the limited value of the concentration at the interface c is first computed using central differences and limited using a normalized variable diagram nvd scheme following the upwind direction then c is used to compute σ using a second order taylor expansion series 15 σ σ c c k σ c k 1 2 c c k 2 σ c k σ c l c k c l where k and l swap the control volumes they represent either i or j depending on the velocity direction thus if n v 0 then k i l j conversely if n v 0 then k j l i finally v n is bounded by v i n and v j n the same flux is used for both control volumes sharing the interface ensuring local conservation of mass time is discretized using an implicit θ method where θ varies between 0 5 crank nicholson and 1 implicit euler θ is controlled by a total variation diminishing tvd scheme to ensure that the time integration is stable regardless of the time step size gomes et al 2017 2 3 numerical solution a picard iterative method anderson 1965 is used to solve the coupled system of discretized equations as described by salinas et al 2017a the picard solver iterates the coupled solutions for pressure and concentration until the concentration field has converged within a user defined tolerance between two consecutive non linear iterations 1 pressure is calculated by combining eqs 1 and 3 considering the solute concentration to be fixed 2 an updated velocity field is obtained from darcy s law eq 1 3 from the updated pressure and velocity fields an updated solute concentration is computed using eq 4 4 density is recomputed with the updated solute concentration using eq 5 when this is done time advances by one time level until the final time is reached in the examples shown here the convergence criteria is the infinite norm of the concentration field is 0 03 with a maximum of 15 non linear iterations per time level for the henry problem test cases and 50 non linear iterations for the si example case the system of linear equations to be solved at each step pressure or concentration is solved using the petsc framework balay et al 1997 a generalized minimal residual gmres method with 30 restart iterations and a multigrid based preconditioner hypre falgout 2005 is used to reduce the initial residual by ten orders of magnitude use of this solver in combination with the dcvfe formulation ensures that the system can be solved regardless of the time step size and mesh quality to reduce computational time a proportional integral derivative pid adaptive method is used to control the time step size depending on the number of non linear iterations and the error in the non linear solver akakpo and gildin 2017 16 d t n 1 1 e n k i e n 1 e n k p e n 1 2 e n e n 2 k d where n denotes the time level k i k p and k d are constants controlling the behaviour of the pid controller with values 1 34 0 001 and 0 01 respectively taken from akakpo gilden 2017 the pid controller minimizes the overall error function e defined as 17 e e e e i 2 m a x e e e i where e i is the ratio between the target number of non linear iterations and that required by the non linear solver to converge for the time level n and e e is the ratio of the target error and the error of the non linear solver e r which is defined as the infinite norm of the difference between two non linear iterations 18 e r c m c m 1 i n f in which m is the non linear iteration number and c is the concentration field the pid controller adjusts the time step size to minimize e thus minimizing the discrepancy between the target error and the target number of non linear iterations once a new time step is obtained its increase or decrease is limited to less than x1 5 or x2 0 respectively the previous time step 2 4 dynamic mesh optimization an advanced anisotropic dmo approach is used which allows mesh elements to be split or amalgamated element edges swapped or element vertices moved pain et al 2001 the dmo procedure starts by calculating the l 2 norm of the local interpolation error introduced by the fe representation using the weighted norm of the hessian matrix h of the specified field s any cv based solution fields are interpolated into the fe mesh using a conservative galerkin projection farrell et al 2009 adam et al 2016 the quality of the mesh i is defined as 19 i i e d g e s e i t e e i 1 2 20 e i j det h 1 2 γ δ h i j ε in which e is a matrix composed of entries e i j e i denotes the edges connecting the vertices of the mesh ε is a user defined adaptivity tolerance to the chosen solution field s γ is the polynomial degree of the norm used and δ is the problem dimension salinas et al 2018 dmo applies the mesh operations sequentially to create a new mesh with an approximately uniform quality while honouring a set of user defined criteria such as maximum number of elements maximum and minimum edge length mesh gradation and mesh anisotropy the master nodes defining the architecture of the sbgm remain fixed once the new mesh is generated the solution fields from the old mesh are interpolated to the new mesh using the conservative galerkin projection adam et al 2016 here dmo adapts the mesh to the salt concentration field for the henry problem test cases and to the salt concentration and pressure fields for the si example cases dmo adapts the mesh to minimize error metrics defined for both fields in this latter case maintaining solution quality for both but at the cost of using a larger number of elements if the fields are only loosely coupled such that high resolution is required in some parts of the domain for one field but not the other and vice versa 2 5 parallel implementation parallelization during dmo is based on the well known distributed memory paradigm using the message passing interface mpi library halos containing duplicate nodes at the interface between two processor domains are generated to ensure a consistent communication parallel implementation of dmo requires additional steps compared to a fixed mesh to balance the computational cost across different processors dynamic domain decomposition is required in which balanced domains are created each time the mesh is adapted gorman et al 2012 the approach involves the following steps 1 the given mesh is partitioned into sub domains using a parallel graph partitioner in this case parmetis is used schloegel et al 2002 the partitioning is performed with the objective of minimizing memory exchange between processors 2 the mesh is adapted within each sub domain while locking the nodes in the halos at the boundaries with the neighbouring sub domains fig 3a locking the boundary nodes yields a globally conforming mesh the resulting mesh however is sub optimal because the locked nodes have not been optimized by dmo 3 the mesh is repartitioned to create new sub domains fig 3b with different locked boundary nodes so previously locked nodes can be optimized 4 the process is repeated a number of times typically three to ensure that all nodes are optimized applying dmo in parallel computations and heterogeneous porous media introduces additional constraints on the dmo algorithm by requiring the master nodes and the halo nodes to remain fixed this can sometimes mean that the dmo algorithm fails to create a new mesh with a higher quality than the old mesh if this happens the old mesh is re used for the next timestep and dmo is re applied to the new solution 3 method evaluation we begin by verifying that the numerical framework produces accurate results for salt transport and si modelling by comparing results against theoretical and numerical studies the henry problem henry 1964 considers the steady state location of a dispersive saline wedge in a confined aquifer henry reduced the saline intrusion problem to a 2d rectangular geometry with sealed no flow or transport upper and lower boundaries fig 4a for model properties see table 1 hydrostatic pressure along with a dirichlet condition for transport c 1 is imposed at the right seawater boundary while freshwater discharge with salt mass fraction of zero c 0 is imposed on the left inland boundary initially the domain is filled with freshwater this configuration leads to a saline intrusion wedge penetrating towards the freshwater boundary along the lower boundary of the aquifer e g fig 4 henry provided a semi analytical solution involving a double set of fourier coefficients which needed to be truncated to obtain a solution zidane et al 2012 due to numerical issues with this method an additional numerical solution reported by held et al 2005 and the more recent semi analytical solution of fahs et al 2016 for velocity dependent dispersion are used here for comparison we examine and verify the performance of the method using the original henry problem case 1 with no mechanical dispersion and five variants with different values of diffusion longitudinal and transverse dispersion permeability and permeability anisotropy table 1 a minimum element edge length of 8 0 mm is used for all test cases compared to the domain dimensions of 1 2 m fig 4 where applied dmo imposes an absolute error tolerance of ε 0 001 for the salt mass fraction the dynamic time stepping has an initial time step of δ t 0 01 s and a maximum time step of δ t 300 s the time step quickly reached its maximum value with relatively limited fluctuation around this value for all test cases 3 1 comparison against benchmark solutions isolines of salt mass fraction c 0 1 0 9 for all test cases table 1 simulated with and without dmo show a good match with the published benchmark results fig 4b g for the original henry problem case 1 a relatively diffuse interface with a wide mixing zone l s as defined in fig 4b is formed between the freshwater and saltwater consistent with earlier observations croucher and o sullivan 1995 held et al 2005 increasing the aquifer permeability in case 2 results in a deeper intrusion of saline water fig 4c because the saltwater can move further towards the freshwater side driven by the fixed hydrostatic seawater boundary pressure held et al 2005 consequently case 2 has a longer wedge toe length l t o e as defined in fig 4b compared to the original henry case 1 fig 5a reducing the diffusion coefficient but adding velocity dependent dispersion in cases 3 and 4 reduces the width of the mixing zone while increasing the wedge toe length fig 5a case 4 has a longer wedge toe length compared to case 3 because the former has anisotropic permeability fig 4 shows our approach captures the salt concentration in cases with velocity dependent dispersion and anisotropic permeability with good accuracy with and without dmo compared to the numerical predictions of held et al 2005 reducing further the diffusion coefficient in case 5 and then reducing the longitudinal and transverse dispersivities by two orders of magnitude in case 6 yields an increase in the wedge toe length fig 5a and a narrower mixing zone which becomes extremely narrow for the lowest dispersivities tested in case 6 fig 4g these observations are in very close agreement with those of fahs et al 2016 in addition the parameter values chosen for case 6 are comparable with and for longitudinal dispersivity the same as those used by robinson et al 2015 to simulate observations of saline intrusion obtained from a benchtop scale experimental representation of the henry problem the salt concentration fig 4 and wedge toe length results fig 5a demonstrate that simulations with dmo produce comparable results to those obtained using a fixed mesh and reported in the literature however dmo requires significantly fewer elements so the computational cost is much lower fig 5b all test cases with dmo start from an extremely coarse initial grid with only 44 elements because there is no geological heterogeneity that must be captured fig 6 as the saline front moves into the domain the mesh refines to capture the front and then moves with the front coarsening behind it where high resolution is no longer required fig 6 shows the time evolution of case 6 which is of particular interest since its relatively narrow sharp mixing zone is comparable to those typically observed in real life saline intrusion problems where l s the scale of the aquifer domain as a result the elements in the mixing zone become highly anisotropic to capture the interface geometry and associated steep gradients in salt concentration the dcvfem formulation used here ensures very good numerical accuracy and avoids spurious oscillations despite the presence of these highly anisotropic elements 3 2 convergence and speedup the comparisons between our simulation results and the benchmark solutions shown in the previous section were qualitative here we provide a quantitative convergence test for the most challenging test case 6 with the sharpest saline front all simulations here were conducted for a duration of 3600 s with a fixed courant number of 0 9 to allow direct comparison between cases with different spatial resolution the solution error is measured using the relative l2 norm r n defined as 21 r n n 1 n p c 0 n c n 2 n 1 n p c 0 n 2 where n p denotes the number of test points and 0 denotes the reference value of the salt concentration at a given test point obtained from a very fine fixed mesh simulation using triangular elements with an edge length of 4 mm fixed i e static mesh cases show approximately linear convergence reduction in error with increasing resolution similar to that found previously for the dcvfem applied to other problems salinas et al 2017 fig 7a dmo however shows much more rapid convergence and an equivalent simulation error using a much lower number of elements than required with a fixed mesh the use of fewer elements with dmo yields a reduction in simulation time with speed up of order 5 for the finest mesh fig 7b the offset between the ratio of cell numbers and simulation times in fig 7b represents the cost of dmo and is of order 10 percent of the cost of the equivalent fixed mesh case the cost of dmo is significantly outweighed by its benefit even though we generate a new mesh and new matrices it is clear that dmo is more effective in reducing the simulation time when the domain contains a larger number of elements which suggests dmo will yield even better speed up for 3d cases 4 application saline intrusion modelling this section demonstrates the value of dmo for modelling si in large kilometre scale groundwater models with realistic boundary conditions and heterogeneous geology the test case is based on the uk chalk aquifer an important groundwater resource for southern and eastern england including london the area of interest is located on the south coast of the uk where the chalk provides groundwater to the city of brighton and surrounding area the data used in the modelling were obtained from the saltdean observation borehole obh which is located approximately 1 8 km from the coast a map of the saltdean study area and schematic of the saltdean obh can be found in graham et al 2018 the saltdean obh is now used only for observation the borehole extends to around 60 m below ground level and intersects a series of chalk marl and hardground layers within the cretaceous seaford and lewes nodular chalks fig 8 a the strata dip towards the coast at an angle of approximately 5 graham et al 2018 the hydraulic conductivity in the aquifer generally decreases with depth recharge estimates given by graham et al 2018 for the saltdean area are about 490 mm year here we make use of two years monitoring data acquired by macallister et al 2018 vertical profiling of fluid electrical conductivity in the borehole over several tidal cycles during a period of si showed upwards and downwards movement of a sharp saline interface with saline water interpreted to be entering and leaving the borehole via a high permeability zone at its base macallister et al 2018 this high permeability feature most likely reflects the presence of a fracture horizon jones and robins 1999 macallister et al 2018 graham et al 2018 measured self potential sp in the borehole could only be matched by models with a very sharp saline interface and overall the borehole data are consistent with the presence of a sharp saline interface in the vicinity of the borehole macallister et al 2018 graham et al 2018 graham et al 2018 conducted numerical simulations using a widely applied code but the inability to simulate at high resolution in a large domain meant that they were not able to produce a saline freshwater wedge that was sharp enough to match the data the interface had to be artificially sharpened in a post processing step essentially the numerical model results were adjusted to give the desired concentration field in the vicinity of the interface graham et al 2018 such an approach has little value for prediction or management of the aquifer response to si we consider two models of the saltdean obh and associated saline interface based on the model presented by graham et al 2018 the first is a pseudo 2d model in the x horizontal and z vertical directions as there is only one element of 20 m in the y orthogonal horizontal direction and no variation of any parameter or variable in that direction this model is small enough that dmo can be benchmarked against fixed mesh cases the second is a fully 3d model and is computationally tractable only through use of dmo and or parallel computation a simple implementation of sbgm was used to create the models the chalk marl and hardground layers penetrated by the saltdean obh are interpreted to be laterally extensive and the model captures their interpreted seaward dip jones and robins 1999 macallister et al 2018 graham et al 2018 fig 8 a there are known to be other heterogeneous layers present in the stratigraphy above and below the interval penetrated by the saltdean obh but these were not included by graham et al 2018 because the model was designed to focus on the movement of the saline front in the vicinity of the saltdean obh surfaces were created using the sbgm approach of jacquemyn et al 2019 to represent the boundaries between the modelled layers petrophysical properties based on core and well data were assigned to each layer table 2 the permeability tensor in each geological layer is anisotropic with vertical permeability 30 lower than horizontal permeability macdonald and allen 2001 butler et al 2009 the upper boundary condition comprises freshwater recharge with a salt mass fraction of zero c 0 imposed along the top right of the domain dotted line in fig 8a while the top left boundary continuous line is a hydrostatic pressure distribution of the overlying seawater with a dirichlet condition for transport c 1 the left seaward right inland and bottom boundaries are zero flux for both flow and transport initially the model is filled with seawater 4 1 pseudo 2d model of saline intrusion the effect of fixed and dmo mesh resolution was tested in the pseudo 2d model using three different minimum edge lengths 1 5 m 1 m and 0 5 m the initial mesh used in the dmo cases contains 1378 elements and defines the master nodes that represent the geologic surfaces dmo was applied every two time steps with an absolute tolerance of ε 0 001 for salt concentration and a relative tolerance of ε 50 000 pa for pressure dynamic time stepping was used with no minimum or maximum time step enforced typical values were approximately 45 min and 200 days respectively the model was run for a simulation model time of 1000 years pseudo equilibrium was obtained after approximately 350 years fig 8b shows salt mass fraction isolines for both fixed and dmo meshes simulated using a minimum edge length of z m i n 0 5 m the mixing zone here defined as the distance between c 0 1 and c 0 9 normal to the slope of c 0 5 has a width of just 4 m consistent in both the fixed and dmo simulations confirming the challenge of resolving such a sharp saline front in a large km scale domain a slight change in the width of the mixing zone occurs at the boundary between the seaford chalk and the lewes nodular chalk consistent with the change in permeability across these units table 2 the results with and without dmo are in close agreement the accuracy of the match is demonstrated in fig 8c which shows the variation of the mean proportional absolute error e between fixed and dmo simulation results versus the minimum edge length e is defined as 22 e 1 n p n 1 n p c 0 n c n c 0 n where n p denotes the number of test locations and the 0 subscript denotes the reference value of the salt concentration the reference values are taken from the finest static grid simulation with z m i n 0 5 m the saline wedge is captured by dmo with high accuracy when compared to the high resolution fixed grid as the maximum error obtained for z m i n 1 5 m remains below 3 this accuracy is achieved using significantly fewer elements compared to the equivalent fixed mesh yielding a simulation speed up in excess of 11 for the most accurate finest mesh case fig 8d 4 2 3d model of saline intrusion here we test the use of dmo in 3d modelling of saline intrusion the pseudo 2d model is extruded into the 3rd dimension so the model width becomes 50 m we also explicitly model the saltdean obh and associated adit see schematic of the saltdean obh in graham et al 2018 the borehole domain is modelled using a porosity of 1 and a permeability of 7 92 1 0 6 m 2 following graham et al 2018 only dmo simulations were conducted for this 3d case because even with dmo the number of elements required was approximately 260000 a fixed mesh with the resolution required to deliver comparable solution accuracy contains over 9000000 elements numerical simulation of this case would require several 100s of cores and a simulation time of order weeks in common with many groups modelling saline intrusion we did not have access in this research to the high performance computing facilities required to run such a large long time varying 3d case on a fixed mesh the value of dmo in facilitating numerical simulation of such a case is clear all model settings were the same as in the pseudo 2d case except dmo was triggered every 10 time steps and the minimum time step was t 86400 s 1 day the minimum edge length was z m i n 1 m in the vertical direction in the middle of the range tested in the pseudo 2d model the initial mesh contained approximately 51000 elements the simulation was run in parallel on 30 cores thus demonstrating the use of dmo in conjunction with parallel processing we discuss the parallel scaling performance in the next section fig 9 shows the time evolution of salt concentration along with the adapting mesh during the early stages of wedge growth t 0 s to t 40 years dmo captures the steep concentration gradient at the moving saline freshwater interface but maintains a coarse mesh elsewhere the narrow and highly dynamic saline front has a width of ca 5 m consistent with the value obtained in the pseudo 2d model for the same minimum edge length the front is therefore well captured we discuss the computational cost in the next section 4 3 parallel performance the parallel computing capability of the computational framework was tested using the same 3d si model presented in the previous section fig 10 purely to compare the scaling on a consistent number of elements the model was discretized using 2 5m elements for both fixed and dmo cases the scaling was tested against a reference case with 2 cores cpu to account for the added cost of distributed memory the number of elements per core is always larger than the minimum required for good parallel performance which is of order 15k the parallel performance was tested by executing 10 time steps with a fixed time step of 1 month with dmo applied every two timesteps all other settings were the same as in the previous section the strong scaling was tested with the number of cores increasing from two to 30 the scaling performance was evaluated using 23 η w r e f n r e f w n n n where w r e f and n r e f are the walltime of the reference simulation and the reference number of cores used here n r e f 2 likewise w n denotes the walltime using n n cores the scaling in both fixed and dmo cases is very similar and shows good performance falling to 0 7 at 30 cores i e the speed up is x0 7 of the ideal perfect speed up the results confirm that application of dmo does not compromise the efficiency of parallel scaling in these scaling results dmo is used to change the mesh but the number of elements remains fixed to ensure a fair comparison with the fixed mesh results in real world simulations the dmo performance varies more because the number of elements varies so the parallel partitioning may become more challenging as the mesh changes owing to changes in the size of the halos and the element size varies which impacts on the dynamic time stepping we tested the real world scaling of the saltdean model using dmo and allowing the number of elements to vary over a simulation period of ten years as expected the scaling is less stable oscillates more than the cases with a fixed number of elements but the overall scaling performance is comparable showing that dmo in parallel yields significant speed up compared to using a fixed mesh in serial 5 discussion we demonstrate here practical use of dynamic mesh optimization in a parallel computational framework to reduce simulation cost while maintaining solution accuracy in modelling saline intrusion dmo allows key solution features such as the saline front to be resolved at high resolution in a large 3d model domain at much lower computational cost than fixed mesh simulations with comparable accuracy we measure the computational advantage of dmo by comparing against equivalent fixed mesh solutions here we could do this only in 2d models in the 3d example shown we could not simulate the equivalent fixed mesh case at sufficient resolution because of the high computational cost we can however estimate the computational advantage of simulating this 3d model in parallel and with dmo versus a single core and a fixed mesh with the same resolution we obtained a 11 5 speed up in the 3d model through use of multiple cores and dmo fig 10 in the equivalent 2d model we obtained 10 75 speed up using dmo compared to an equivalent fixed mesh fig 9d it is reasonable to assume that use of dmo yields a similar speed up in the 3d model compared to the equivalent fixed mesh indeed the advantage of dmo is typically greater in 3d as the volume of the model domain and hence the total number of fixed mesh elements required scales as l 3 where l is the model size but the area of the saline front where dmo is required scales as l 2 combining these two speed ups suggests that dmo and parallelization yielded a reduction in computational cost in excess of 120 for the 3d saline intrusion problem tested here compared to a fixed mesh case with equivalent resolution simulated on a single core as is typical in current si intrusion models this clearly demonstrates the significant computational opportunities that the parallelized adaptive meshing framework presented here can bring to the field of groundwater modelling we tested the parallel scaling of dmo only to 30 cores we are aware that high performance computing hpc allows access to many more cores and the parallel scaling of numerical codes that use fixed or adaptive meshes has been tested to many more cores hammond et al 2014 wei et al 2015 although we are not aware of any studies that have tested the parallel scaling of numerical methods and codes used for si we restricted the scaling to 30 cores because as we show here dmo for si modelling provides similar accuracy to fixed mesh codes using of order 10 fewer elements a dmo model with sufficient elements to merit parallel simulation on several thousand cores would require several tens of millions of elements and yield similar accuracy to a fixed mesh simulation with several hundreds of millions of elements we do not anticipate a demand for such large models of si rather we argue that dmo enables practitioners to simulate heterogeneous 3d si problems on a desktop multi core machine which would otherwise require hundreds of millions of fixed elements on a hpc facility we have demonstrated dmo in parallel using a 3d model of a heterogeneous chalk aquifer containing laterally extensive marls and hardgrounds that are just a few metres in thickness the layers have very high aspect ratio and contrasting permeability hence this is a challenging example case we have also demonstrated benefits of dmo for flow problems although not si in other aquifer types using sbgm to model geological features such as inclined intersecting faults growth faults folded strata and complex stratigraphy and complex intersecting fractures jackson et al 2015 jacquemyn et al 2019 salinas et al 2021 in the models presented here smaller scale variability within the layers is neglected but this is not essential to sbgm and dmo it is possible to include for example finer scale stratigraphy in sbgms jacquemyn et al 2019 dmo works efficiently in sbgms that neglect the cell to cell scale variability often observed in pixel or grid based models but this has been shown to have a negligible impact on flow osman et al 2021 it is capturing and preserving the spatially correlated heterogeneity and connectivity of geological flow zones and flow barriers that is key to predict accurately flow and transport note that this does not mean that sbgms must be deterministic surfaces representing key correlated heterogeneity can be created stochastically jacquemyn et al 2019 and conditioned to borehole data titus et al 2021 we see significant value in dmo for modelling si in reducing simulation cost such that computational resources can be used to run many models or cases simulations of many models or cases are often required to explore and quantify the impact of uncertain aquifer architecture and hydrological properties on si to optimize well placement completion depth and operation in aquifers at risk of si and for model calibration against measured data kerrou et al 2013 rajabi and ataie ashtiani 2014 rajabi et al 2015 koohbora et al 2019 yang et al 2021 dmo can also ensure sufficient resolution is maintained in models irrespective of the dynamics of the saline front when the aquifer architecture or properties change in a sensitivity analysis or optimization process the saline front geometry or thickness may vary such that a fixed mesh resolution previously identified to have sufficient resolution may no longer be appropriate 6 conclusions groundwater is an increasingly important water resource but its long term viability is under threat due to over extraction contamination or both in many cases these threats are being exacerbated by climate change understanding of subsurface geological structures along with their parameterization and associated uncertainties is steadily improving due to the plethora of geophysical tools now available and there is a need to maximize the benefits these additional data provide to achieve this a new generation of numerical models which can readily accommodate geological complexity in a highly efficient computational framework is required here we present a framework for use of dynamic mesh optimization dmo which respects geological heterogeneity to simulate complex flow and transport problems in a parallel framework exemplified here through saline intrusion modelling in a highly efficient manner we suggest that parallelized dmo provides opportunities for ultra high resolution modelling of complex contaminant transport problems with sufficient rapidity that multiple 3d realizations to assess and quantify model and data uncertainty are not only desirable but also achievable credit authorship contribution statement a hamzehloo methodology software visualization validation writing original draft m l bahlali methodology software visualization validation writing original draft p salinas conceptualization methodology software writing review editing c jacquemyn methodology software c c pain methodology software a p butler writing original draft writing review editing supervision funding m d jackson conceptualization writing original draft writing review editing supervision funding declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to thank the uk engineering and physical sciences research council epsrc for supporting this work by grant ep r01938x 1 under project salina saline intrusion in coastal aquifers hydrodynamic assessment and prediction of dynamic response the authors would also like to thank members of the novel reservoir modelling and simulation norms group at imperial college london for many valuable discussions the authors have no conflicts of interest to declare all data reported here were created using the imperial college finite element reservoir simulator ic ferst which is available under the open source affero general purpose licence v 3 0 agpl v 3 0 at the ic ferst github repository http multifuids github io 
152,saline intrusion si in coastal aquifers is a global problem with the potential to contaminate groundwater used by over a billion people numerical modelling of si in coastal aquifers is a key tool for risk assessment aquifer management and resource regulation but is extremely challenging because the mixing zone across the saline front is often very narrow extending over metres or 10 s metres yet the saline front itself may extend laterally over a large i e many km three dimensional 3d domain moreover the aquifer may be highly heterogeneous further complicating the movement and geometry of the front we test here the use of dynamic mesh optimization dmo in a parallel computational framework to simulate si with higher accuracy and lower computational cost compared to fixed mesh approaches the framework uses a double control volume finite element dcvfe method and is implemented in the open source imperial college finite element reservoir simulator ic ferst but could be implemented in other fe based simulators we confirm accuracy and convergence using test cases based on the classic henry si problem demonstrating that solutions obtained using dmo require significantly fewer elements and therefore have much lower computational cost compared to equivalent fixed mesh solutions we apply the framework to a realistic 3d case study simulating saline intrusion in a heterogeneous chalk aquifer demonstrating simulation speed up in excess of 120 we suggest that parallelized dmo offers significant advantages over existing methods to simulate si keywords coastal aquifers saline intrusion numerical modelling unstructured mesh dynamic mesh optimization computational cost 1 introduction groundwater is the primary source of water for human consumption in most countries arfib and charlier 2016 bakalowicz 2015 demand is particularly high in coastal regions custodio 2010 over 1 2 billion people live within 100 km of a coastline and population densities in these areas are around three times the global average small and nicholls 2003 increased groundwater abstraction in response to urbanization uddameri et al 2014 boretti and rosa 2019 combined with natural phenomena such as rising sea levels due to climate change masciopinto and liso 2016 ketabchi et al 2016 or storm surges cardenas et al 2015 klassen and allen 2017 can affect the balance between freshwater discharging to the sea and the inland movement of saline water ferguson and gleeson 2012 this imbalance typically results in saline intrusion si a dynamic inland movement of saline water that can lead to contamination of freshwater resources with major economic health and social consequences arfib and charlier 2016 morgan and werner 2015 si can be particularly pronounced in fractured or highly permeable or heterogeneous aquifers de filippis et al 2016 especially when subject to marked increases in groundwater abstraction or sudden and substantial changes in sea level such as storm surges klassen and allen 2017 such conditions can lead to highly dynamic changes in the sharp saline freshwater interface graham et al 2018 with important consequences for the management of coastal groundwater resources monitoring si using for example measurements of groundwater level and electrical conductivity as a proxy for salinity requires multiple boreholes while geophysical monitoring requires surface and or borehole equipment that can be logistically challenging to install and or prohibitively expensive macallister et al 2018 monitoring alone shows only the current extent of the intruding seawater and cannot predict future si or its response to changes in abstraction or sea level consequently risk assessment aquifer management and resource regulation are typically based on the predictions of computational groundwater models that solve the coupled density dependent flow and solute transport equations numerical simulation of si however is extremely challenging particularly where the mixing zone is very narrow huyakorn et al 1996 younes et al 2009 isa abadi et al 2020 and dynamic graham et al 2018 in such cases the transition from saline to freshwater may occur over metres or 10 s of metres whereas the saline front and associated aquifer may extend inland and along the coast over several km high grid or mesh resolution is essential to resolve accurately the location and movement of the saline front but the combination of high resolution and large model domain is computationally challenging voss and souza 1987 souza and voss 1987 huyakorn et al 1996 roy and datta 2018 one of the key constraints on accurately modelling dynamic saline intrusion is the use static or fixed meshes whether structured e g seawat langevin et al 2007 or unstructured e g femwater lin et al 1997 sutra voss and provost 1984 hydrogeosphere therrien et al 2010 pflotran lichtner et al 2015 min3p hpc su et al 2021 comsol koohbor et al 2019 although some of these codes make use of parallel processing that can speed up the computation process e g hydrogeosphere plotran min3p hpc comsol many do not hwang et al 2014 as a result fixed mesh constraints are such that many si simulations are simplified to two rather than three dimensions 3d this can significantly reduce their practical applicability and predictive capabilities for tackling real world problems kerrou and renard 2010 rajabi and ataie ashtiani 2014 graham et al 2018 koohbora et al 2019 here we test the use of dynamic mesh optimization dmo in conjunction with parallel computing to increase the speed and accuracy of groundwater flow and transport modelling with specific application to si dmo allows the geometry and resolution of an unstructured mesh to change during a simulation typically to place higher and often anisotropic mesh resolution in parts of the domain where there are steep gradients in the solution and lower resolution elsewhere dmo allows solutions with high accuracy to be obtained at lower computational cost compared to using a fixed mesh and has been widely applied in other areas of cfd alauzet and loseille 2016 xie et al 2014 hu et al 2018 there are however very few applications of dmo in porous media flow modelling because extension to heterogeneous porous media is non trivial given the requirement to include and preserve the spatially complex material properties associated with geologic heterogeneity jackson et al 2014 2015 jacquemyn et al 2019 osman et al 2021 the dmo algorithm reported here allows elements within an unstructured mesh to be split or amalgamated h adaptivity or element vertices to be moved r adaptivity it differs significantly from the related concept of adaptive grid refinement agr which has previously been applied to model reservoir flows although not to the specific problem of si agr utilizes only h adaptivity and cartesian grids grid cells are split by adding cell boundaries schmidt and jacobs 1988 dahle et al 1990 1992 hornung and trangenstein 1997 trangenstein 2002 wolff et al 2013 fig 1 early applications of h adaptivity in reservoir modelling neglected geologic heterogeneity schmidt and jacobs 1988 dahle et al 1990 1992 later studies included heterogeneity but started with a fine scale geologic model as input grid refinement in such models is straightforward as daughter cells simply inherit the hydrological properties of the parent cell however the minimum grid resolution remains fixed by the initial fine scale model which means the computational cost can only increase as new cells are added coarsening the initial grid to reduce cost requires the hydrological properties such as porosity and permeability to be upscaled onto the coarser grid hornung and trangenstein 1997 trangenstein 2002 wolff et al 2013 this upscaling of permeability can impose a significant computational cost trangenstein 2002 gerritsen and lambers 2008 wolff et al 2013 in an attempt to circumvent this problem some studies upscaled the fine scale hydrological properties to a range of pre selected coarse grid cell sizes prior to simulating flow trangenstein 2002 wolff et al 2013 the pre calculated values were then assigned to the adaptively sized coarse cells during simulation however the flexibility of h adaptivity is compromised by the requirement to pre select a range of cell sizes moreover extension of such approaches to the more complex mesh geometries required to represent many geologic heterogeneities is non trivial no general methods for upscaling permeability on arbitrary meshes have yet been developed finally most published studies deploying agr for reservoir flows consider 2d models only trangenstein 2002 gerritsen and lambers 2008 wolff et al 2013 the approach adopted here allows dmo to be applied in 3d numerical simulations of flow and transport in complex geologic porous media and is computationally efficient because it does not require the hydrological properties to be up cross or downscaled each time the mesh is optimized or to be calculated a priori efficient application of dmo for aquifer and reservoir modelling is facilitated by use of surface based geologic modelling sbgm jackson et al 2014 jacquemyn et al 2019 salinas et al 2021 sbgm is an approach whereby all geological heterogeneity whether it is structural stratigraphic sedimentological or diagenetic in origin is represented by surfaces that enclose discrete rock volumes termed geological domains jackson et al 2014 hydrogeological properties are homogeneous within these geological domains models can therefore be created without reference to an underlying grid or mesh jackson et al 2014 previous work has shown that the correlated heterogeneity captured by these domains and by similar concepts such as lithofacies modelling has the most significant impact on flow the element to element or cell to cell scale variability in hydrogeological properties often produced by point or cell based reservoir modelling approaches can be neglected willis and white 2000 feyen and caers 2006 bianchi and zheng 2016 osman et al 2021 an initial mesh is created only when required for numerical calculations this mesh is as coarse as possible whilst preserving the geologic surface architecture within a target error the initial mesh defines master nodes that represent the surfaces and cannot be modified by dmo sbgm is therefore compatible with dmo because surfaces are preserved during mesh adaptivity through the use of the master nodes moreover because petrophysical properties are defined with domains there is no need to up cross or downscale hydrogeological properties such as permeability onto the new mesh after it has been modified by dmo jackson et al 2015 new elements simply inherit the hydrogeological properties of the parent domain to quantify the benefits of dmo in conjunction with parallel computing for si modelling we extend an existing framework for porous media flow with dmo to include for the first time salt transport and associated density driven flows and demonstrate dmo for heterogeneous porous media flow in a parallel computational framework the framework is implemented in the open source imperial college finite element reservoir simulator ic ferst see http multifluids github io but the approach we report could be implemented in other codes using the control volume finite element method cvfem previous work using our framework without the parallel implementation reported here includes simulation of two phase flow in petroleum reservoirs jackson et al 2015 and during viscous fingering kampitsis et al 2020 the related problem of heat transport and associated density driven flow in geothermal reservoirs salinas et al 2021 and solid fluid coupling for flow in fractures obeysekara et al 2018 there are no previous applications of dmo to the coupled density dependent flow and solute transport problem of interest here we begin by outlining the framework and its extension to solute transport and parallel dmo we then demonstrate accuracy and convergence of the extended framework against benchmark solutions based on the classic henry si problem henry 1964 we finish by demonstrating practical application of the framework including parallel scaling performance to a realistic 3d case study simulating saline intrusion in a heterogeneous chalk aquifer modelled using sbgm the main aim of the work is to test the hypothesis that dmo in a parallel framework can yield significant computational speedup when simulating si in realistic 3d models the novelty lies partly in the extension of an existing computational framework for porous media flow and dmo to include salt transport in a parallel framework but primarily in the first application of dmo to the problem of modelling si in heterogeneous 3d aquifers 2 methodology 2 1 governing equations for a density dependent flow in porous media the water flux is given by darcy s equation which for single phase flow where depth is positive is written as 1 q k μ p ρ g combining this with the conservation of mass i e continuity equation gives 2 ϕ ρ t ϕ ρ v 0 where q is the darcy velocity vector m s defined as q ϕ v in which ϕ is the effective porosity and v is the mean pore water velocity vector m s k denotes the intrinsic permeability tensor of the porous medium m 2 μ and ρ denote dynamic viscosity pa s and fluid density kg m 3 respectively p is fluid pressure p a and g is the gravitational field tensor m s 2 the effect of fluid and porous medium compressibility can be combined into a single parameter the specific storage coefficient s 0 m 1 giving 3 s 0 g p t ϕ ρ v 0 for saline intrusion modelling a transport equation for the salt mass is also required 4 ϕ c t ϕ v c ϕ d m i d c where c is the solute contaminant concentration kg m 3 i is the identity tensor d m is the molecular diffusion coefficient m 2 s and d is the mechanical dispersion tensor m 2 s the typical solute concentration of seawater c s is around 35 kg m 3 croucher and o sullivan 1995 which gives a fluid density of 1025 kg m 3 a linear relationship is assumed between density and concentration croucher and o sullivan 1995 fahs et al 2016 5 ρ ρ 0 1 β c where ρ 0 1000 kg m 3 is the corresponding reference density at c 0 and β 0 7143 1 0 3 m 3 kg this means eqs 3 and 4 are coupled and must be solved simultaneously we express results in terms of solute mass fraction relative to seawater c defined as 6 c c c s an isotropic representation is assumed to approximate the mechanical dispersion component of the salt transport thus d is a symmetric tensor defined as 7 d d x x d x y d x z d y x d y y d y z d z x d z y d z z where d x y d y x d x z d z x and d y z d z y the diagonal components in eq 7 are defined as 8 d x x 1 v 2 d l v x 2 d t v y 2 d t v z 2 9 d y y 1 v 2 d t v x 2 d l v y 2 d t v z 2 10 d z z 1 v 2 d t v x 2 d t v y 2 d l v z 2 where v denotes the magnitude of the velocity vector and v x v y and v z represent the magnitude of the velocity components in the x y and z directions respectively d l and d t are longitudinal and transverse dispersion coefficients m 2 s respectively the off diagonal elements in 7 are 11 d i j d l d t v 2 v i v j where i j and i j x y z the dispersion coefficients are dependent on the absolute magnitude of the local velocity and are defined as 12 d l α l v 13 d t α t v where α l and α t are the longitudinal and transverse dispersivities m of the porous medium respectively 2 2 discretization the double control volume finite element method dcvfem used here is discussed in detail elsewhere salinas et al 2017b so we provide only a brief summary the method is applied on fully unstructured triangular and tetrahedral 2d and 3d meshes velocity is discretized conventionally using discontinuous galerkin dg finite elements fe in the element mesh but unlike conventional cvfem pressure is discretized using control volumes cvs in the dual mesh created by connecting the barycentres of the elements fig 2 the dcvfem was specifically developed to improve convergence rate and success in models with poor quality meshes typically containing elements with large internal angles that are easily created in models of heterogeneous aquifers containing high aspect ratio geological features extending the approach to solute transport concentration is discretized using cvs rock porosity and permeability are piecewise constant within fes while fluid density and viscosity are piecewise constant within cvs here we use the element pair p 0 d g p 1 c v in which velocity is discontinuous and is represented element wise with a discretization order of 0 constant within elements while pressure and concentration are continuous and are represented cv wise with a discretization order of 1 linear variation within elements fig 2 space and time are discretized using higher order methods to increase solution accuracy stabilization methods are implemented to ensure monotonic solutions when dealing with high courant friedrichs lewy or peclet numbers the flux at the interface between two control volumes c v i and c v j sharing the same edge is computed as 14 v σ 1 1 2 σ i v i σ j v j where σ μ k 1 and the tilde symbol denotes the value at the interface of i and j to compute a high order approximation of the flux at the interface the limited value of the concentration at the interface c is first computed using central differences and limited using a normalized variable diagram nvd scheme following the upwind direction then c is used to compute σ using a second order taylor expansion series 15 σ σ c c k σ c k 1 2 c c k 2 σ c k σ c l c k c l where k and l swap the control volumes they represent either i or j depending on the velocity direction thus if n v 0 then k i l j conversely if n v 0 then k j l i finally v n is bounded by v i n and v j n the same flux is used for both control volumes sharing the interface ensuring local conservation of mass time is discretized using an implicit θ method where θ varies between 0 5 crank nicholson and 1 implicit euler θ is controlled by a total variation diminishing tvd scheme to ensure that the time integration is stable regardless of the time step size gomes et al 2017 2 3 numerical solution a picard iterative method anderson 1965 is used to solve the coupled system of discretized equations as described by salinas et al 2017a the picard solver iterates the coupled solutions for pressure and concentration until the concentration field has converged within a user defined tolerance between two consecutive non linear iterations 1 pressure is calculated by combining eqs 1 and 3 considering the solute concentration to be fixed 2 an updated velocity field is obtained from darcy s law eq 1 3 from the updated pressure and velocity fields an updated solute concentration is computed using eq 4 4 density is recomputed with the updated solute concentration using eq 5 when this is done time advances by one time level until the final time is reached in the examples shown here the convergence criteria is the infinite norm of the concentration field is 0 03 with a maximum of 15 non linear iterations per time level for the henry problem test cases and 50 non linear iterations for the si example case the system of linear equations to be solved at each step pressure or concentration is solved using the petsc framework balay et al 1997 a generalized minimal residual gmres method with 30 restart iterations and a multigrid based preconditioner hypre falgout 2005 is used to reduce the initial residual by ten orders of magnitude use of this solver in combination with the dcvfe formulation ensures that the system can be solved regardless of the time step size and mesh quality to reduce computational time a proportional integral derivative pid adaptive method is used to control the time step size depending on the number of non linear iterations and the error in the non linear solver akakpo and gildin 2017 16 d t n 1 1 e n k i e n 1 e n k p e n 1 2 e n e n 2 k d where n denotes the time level k i k p and k d are constants controlling the behaviour of the pid controller with values 1 34 0 001 and 0 01 respectively taken from akakpo gilden 2017 the pid controller minimizes the overall error function e defined as 17 e e e e i 2 m a x e e e i where e i is the ratio between the target number of non linear iterations and that required by the non linear solver to converge for the time level n and e e is the ratio of the target error and the error of the non linear solver e r which is defined as the infinite norm of the difference between two non linear iterations 18 e r c m c m 1 i n f in which m is the non linear iteration number and c is the concentration field the pid controller adjusts the time step size to minimize e thus minimizing the discrepancy between the target error and the target number of non linear iterations once a new time step is obtained its increase or decrease is limited to less than x1 5 or x2 0 respectively the previous time step 2 4 dynamic mesh optimization an advanced anisotropic dmo approach is used which allows mesh elements to be split or amalgamated element edges swapped or element vertices moved pain et al 2001 the dmo procedure starts by calculating the l 2 norm of the local interpolation error introduced by the fe representation using the weighted norm of the hessian matrix h of the specified field s any cv based solution fields are interpolated into the fe mesh using a conservative galerkin projection farrell et al 2009 adam et al 2016 the quality of the mesh i is defined as 19 i i e d g e s e i t e e i 1 2 20 e i j det h 1 2 γ δ h i j ε in which e is a matrix composed of entries e i j e i denotes the edges connecting the vertices of the mesh ε is a user defined adaptivity tolerance to the chosen solution field s γ is the polynomial degree of the norm used and δ is the problem dimension salinas et al 2018 dmo applies the mesh operations sequentially to create a new mesh with an approximately uniform quality while honouring a set of user defined criteria such as maximum number of elements maximum and minimum edge length mesh gradation and mesh anisotropy the master nodes defining the architecture of the sbgm remain fixed once the new mesh is generated the solution fields from the old mesh are interpolated to the new mesh using the conservative galerkin projection adam et al 2016 here dmo adapts the mesh to the salt concentration field for the henry problem test cases and to the salt concentration and pressure fields for the si example cases dmo adapts the mesh to minimize error metrics defined for both fields in this latter case maintaining solution quality for both but at the cost of using a larger number of elements if the fields are only loosely coupled such that high resolution is required in some parts of the domain for one field but not the other and vice versa 2 5 parallel implementation parallelization during dmo is based on the well known distributed memory paradigm using the message passing interface mpi library halos containing duplicate nodes at the interface between two processor domains are generated to ensure a consistent communication parallel implementation of dmo requires additional steps compared to a fixed mesh to balance the computational cost across different processors dynamic domain decomposition is required in which balanced domains are created each time the mesh is adapted gorman et al 2012 the approach involves the following steps 1 the given mesh is partitioned into sub domains using a parallel graph partitioner in this case parmetis is used schloegel et al 2002 the partitioning is performed with the objective of minimizing memory exchange between processors 2 the mesh is adapted within each sub domain while locking the nodes in the halos at the boundaries with the neighbouring sub domains fig 3a locking the boundary nodes yields a globally conforming mesh the resulting mesh however is sub optimal because the locked nodes have not been optimized by dmo 3 the mesh is repartitioned to create new sub domains fig 3b with different locked boundary nodes so previously locked nodes can be optimized 4 the process is repeated a number of times typically three to ensure that all nodes are optimized applying dmo in parallel computations and heterogeneous porous media introduces additional constraints on the dmo algorithm by requiring the master nodes and the halo nodes to remain fixed this can sometimes mean that the dmo algorithm fails to create a new mesh with a higher quality than the old mesh if this happens the old mesh is re used for the next timestep and dmo is re applied to the new solution 3 method evaluation we begin by verifying that the numerical framework produces accurate results for salt transport and si modelling by comparing results against theoretical and numerical studies the henry problem henry 1964 considers the steady state location of a dispersive saline wedge in a confined aquifer henry reduced the saline intrusion problem to a 2d rectangular geometry with sealed no flow or transport upper and lower boundaries fig 4a for model properties see table 1 hydrostatic pressure along with a dirichlet condition for transport c 1 is imposed at the right seawater boundary while freshwater discharge with salt mass fraction of zero c 0 is imposed on the left inland boundary initially the domain is filled with freshwater this configuration leads to a saline intrusion wedge penetrating towards the freshwater boundary along the lower boundary of the aquifer e g fig 4 henry provided a semi analytical solution involving a double set of fourier coefficients which needed to be truncated to obtain a solution zidane et al 2012 due to numerical issues with this method an additional numerical solution reported by held et al 2005 and the more recent semi analytical solution of fahs et al 2016 for velocity dependent dispersion are used here for comparison we examine and verify the performance of the method using the original henry problem case 1 with no mechanical dispersion and five variants with different values of diffusion longitudinal and transverse dispersion permeability and permeability anisotropy table 1 a minimum element edge length of 8 0 mm is used for all test cases compared to the domain dimensions of 1 2 m fig 4 where applied dmo imposes an absolute error tolerance of ε 0 001 for the salt mass fraction the dynamic time stepping has an initial time step of δ t 0 01 s and a maximum time step of δ t 300 s the time step quickly reached its maximum value with relatively limited fluctuation around this value for all test cases 3 1 comparison against benchmark solutions isolines of salt mass fraction c 0 1 0 9 for all test cases table 1 simulated with and without dmo show a good match with the published benchmark results fig 4b g for the original henry problem case 1 a relatively diffuse interface with a wide mixing zone l s as defined in fig 4b is formed between the freshwater and saltwater consistent with earlier observations croucher and o sullivan 1995 held et al 2005 increasing the aquifer permeability in case 2 results in a deeper intrusion of saline water fig 4c because the saltwater can move further towards the freshwater side driven by the fixed hydrostatic seawater boundary pressure held et al 2005 consequently case 2 has a longer wedge toe length l t o e as defined in fig 4b compared to the original henry case 1 fig 5a reducing the diffusion coefficient but adding velocity dependent dispersion in cases 3 and 4 reduces the width of the mixing zone while increasing the wedge toe length fig 5a case 4 has a longer wedge toe length compared to case 3 because the former has anisotropic permeability fig 4 shows our approach captures the salt concentration in cases with velocity dependent dispersion and anisotropic permeability with good accuracy with and without dmo compared to the numerical predictions of held et al 2005 reducing further the diffusion coefficient in case 5 and then reducing the longitudinal and transverse dispersivities by two orders of magnitude in case 6 yields an increase in the wedge toe length fig 5a and a narrower mixing zone which becomes extremely narrow for the lowest dispersivities tested in case 6 fig 4g these observations are in very close agreement with those of fahs et al 2016 in addition the parameter values chosen for case 6 are comparable with and for longitudinal dispersivity the same as those used by robinson et al 2015 to simulate observations of saline intrusion obtained from a benchtop scale experimental representation of the henry problem the salt concentration fig 4 and wedge toe length results fig 5a demonstrate that simulations with dmo produce comparable results to those obtained using a fixed mesh and reported in the literature however dmo requires significantly fewer elements so the computational cost is much lower fig 5b all test cases with dmo start from an extremely coarse initial grid with only 44 elements because there is no geological heterogeneity that must be captured fig 6 as the saline front moves into the domain the mesh refines to capture the front and then moves with the front coarsening behind it where high resolution is no longer required fig 6 shows the time evolution of case 6 which is of particular interest since its relatively narrow sharp mixing zone is comparable to those typically observed in real life saline intrusion problems where l s the scale of the aquifer domain as a result the elements in the mixing zone become highly anisotropic to capture the interface geometry and associated steep gradients in salt concentration the dcvfem formulation used here ensures very good numerical accuracy and avoids spurious oscillations despite the presence of these highly anisotropic elements 3 2 convergence and speedup the comparisons between our simulation results and the benchmark solutions shown in the previous section were qualitative here we provide a quantitative convergence test for the most challenging test case 6 with the sharpest saline front all simulations here were conducted for a duration of 3600 s with a fixed courant number of 0 9 to allow direct comparison between cases with different spatial resolution the solution error is measured using the relative l2 norm r n defined as 21 r n n 1 n p c 0 n c n 2 n 1 n p c 0 n 2 where n p denotes the number of test points and 0 denotes the reference value of the salt concentration at a given test point obtained from a very fine fixed mesh simulation using triangular elements with an edge length of 4 mm fixed i e static mesh cases show approximately linear convergence reduction in error with increasing resolution similar to that found previously for the dcvfem applied to other problems salinas et al 2017 fig 7a dmo however shows much more rapid convergence and an equivalent simulation error using a much lower number of elements than required with a fixed mesh the use of fewer elements with dmo yields a reduction in simulation time with speed up of order 5 for the finest mesh fig 7b the offset between the ratio of cell numbers and simulation times in fig 7b represents the cost of dmo and is of order 10 percent of the cost of the equivalent fixed mesh case the cost of dmo is significantly outweighed by its benefit even though we generate a new mesh and new matrices it is clear that dmo is more effective in reducing the simulation time when the domain contains a larger number of elements which suggests dmo will yield even better speed up for 3d cases 4 application saline intrusion modelling this section demonstrates the value of dmo for modelling si in large kilometre scale groundwater models with realistic boundary conditions and heterogeneous geology the test case is based on the uk chalk aquifer an important groundwater resource for southern and eastern england including london the area of interest is located on the south coast of the uk where the chalk provides groundwater to the city of brighton and surrounding area the data used in the modelling were obtained from the saltdean observation borehole obh which is located approximately 1 8 km from the coast a map of the saltdean study area and schematic of the saltdean obh can be found in graham et al 2018 the saltdean obh is now used only for observation the borehole extends to around 60 m below ground level and intersects a series of chalk marl and hardground layers within the cretaceous seaford and lewes nodular chalks fig 8 a the strata dip towards the coast at an angle of approximately 5 graham et al 2018 the hydraulic conductivity in the aquifer generally decreases with depth recharge estimates given by graham et al 2018 for the saltdean area are about 490 mm year here we make use of two years monitoring data acquired by macallister et al 2018 vertical profiling of fluid electrical conductivity in the borehole over several tidal cycles during a period of si showed upwards and downwards movement of a sharp saline interface with saline water interpreted to be entering and leaving the borehole via a high permeability zone at its base macallister et al 2018 this high permeability feature most likely reflects the presence of a fracture horizon jones and robins 1999 macallister et al 2018 graham et al 2018 measured self potential sp in the borehole could only be matched by models with a very sharp saline interface and overall the borehole data are consistent with the presence of a sharp saline interface in the vicinity of the borehole macallister et al 2018 graham et al 2018 graham et al 2018 conducted numerical simulations using a widely applied code but the inability to simulate at high resolution in a large domain meant that they were not able to produce a saline freshwater wedge that was sharp enough to match the data the interface had to be artificially sharpened in a post processing step essentially the numerical model results were adjusted to give the desired concentration field in the vicinity of the interface graham et al 2018 such an approach has little value for prediction or management of the aquifer response to si we consider two models of the saltdean obh and associated saline interface based on the model presented by graham et al 2018 the first is a pseudo 2d model in the x horizontal and z vertical directions as there is only one element of 20 m in the y orthogonal horizontal direction and no variation of any parameter or variable in that direction this model is small enough that dmo can be benchmarked against fixed mesh cases the second is a fully 3d model and is computationally tractable only through use of dmo and or parallel computation a simple implementation of sbgm was used to create the models the chalk marl and hardground layers penetrated by the saltdean obh are interpreted to be laterally extensive and the model captures their interpreted seaward dip jones and robins 1999 macallister et al 2018 graham et al 2018 fig 8 a there are known to be other heterogeneous layers present in the stratigraphy above and below the interval penetrated by the saltdean obh but these were not included by graham et al 2018 because the model was designed to focus on the movement of the saline front in the vicinity of the saltdean obh surfaces were created using the sbgm approach of jacquemyn et al 2019 to represent the boundaries between the modelled layers petrophysical properties based on core and well data were assigned to each layer table 2 the permeability tensor in each geological layer is anisotropic with vertical permeability 30 lower than horizontal permeability macdonald and allen 2001 butler et al 2009 the upper boundary condition comprises freshwater recharge with a salt mass fraction of zero c 0 imposed along the top right of the domain dotted line in fig 8a while the top left boundary continuous line is a hydrostatic pressure distribution of the overlying seawater with a dirichlet condition for transport c 1 the left seaward right inland and bottom boundaries are zero flux for both flow and transport initially the model is filled with seawater 4 1 pseudo 2d model of saline intrusion the effect of fixed and dmo mesh resolution was tested in the pseudo 2d model using three different minimum edge lengths 1 5 m 1 m and 0 5 m the initial mesh used in the dmo cases contains 1378 elements and defines the master nodes that represent the geologic surfaces dmo was applied every two time steps with an absolute tolerance of ε 0 001 for salt concentration and a relative tolerance of ε 50 000 pa for pressure dynamic time stepping was used with no minimum or maximum time step enforced typical values were approximately 45 min and 200 days respectively the model was run for a simulation model time of 1000 years pseudo equilibrium was obtained after approximately 350 years fig 8b shows salt mass fraction isolines for both fixed and dmo meshes simulated using a minimum edge length of z m i n 0 5 m the mixing zone here defined as the distance between c 0 1 and c 0 9 normal to the slope of c 0 5 has a width of just 4 m consistent in both the fixed and dmo simulations confirming the challenge of resolving such a sharp saline front in a large km scale domain a slight change in the width of the mixing zone occurs at the boundary between the seaford chalk and the lewes nodular chalk consistent with the change in permeability across these units table 2 the results with and without dmo are in close agreement the accuracy of the match is demonstrated in fig 8c which shows the variation of the mean proportional absolute error e between fixed and dmo simulation results versus the minimum edge length e is defined as 22 e 1 n p n 1 n p c 0 n c n c 0 n where n p denotes the number of test locations and the 0 subscript denotes the reference value of the salt concentration the reference values are taken from the finest static grid simulation with z m i n 0 5 m the saline wedge is captured by dmo with high accuracy when compared to the high resolution fixed grid as the maximum error obtained for z m i n 1 5 m remains below 3 this accuracy is achieved using significantly fewer elements compared to the equivalent fixed mesh yielding a simulation speed up in excess of 11 for the most accurate finest mesh case fig 8d 4 2 3d model of saline intrusion here we test the use of dmo in 3d modelling of saline intrusion the pseudo 2d model is extruded into the 3rd dimension so the model width becomes 50 m we also explicitly model the saltdean obh and associated adit see schematic of the saltdean obh in graham et al 2018 the borehole domain is modelled using a porosity of 1 and a permeability of 7 92 1 0 6 m 2 following graham et al 2018 only dmo simulations were conducted for this 3d case because even with dmo the number of elements required was approximately 260000 a fixed mesh with the resolution required to deliver comparable solution accuracy contains over 9000000 elements numerical simulation of this case would require several 100s of cores and a simulation time of order weeks in common with many groups modelling saline intrusion we did not have access in this research to the high performance computing facilities required to run such a large long time varying 3d case on a fixed mesh the value of dmo in facilitating numerical simulation of such a case is clear all model settings were the same as in the pseudo 2d case except dmo was triggered every 10 time steps and the minimum time step was t 86400 s 1 day the minimum edge length was z m i n 1 m in the vertical direction in the middle of the range tested in the pseudo 2d model the initial mesh contained approximately 51000 elements the simulation was run in parallel on 30 cores thus demonstrating the use of dmo in conjunction with parallel processing we discuss the parallel scaling performance in the next section fig 9 shows the time evolution of salt concentration along with the adapting mesh during the early stages of wedge growth t 0 s to t 40 years dmo captures the steep concentration gradient at the moving saline freshwater interface but maintains a coarse mesh elsewhere the narrow and highly dynamic saline front has a width of ca 5 m consistent with the value obtained in the pseudo 2d model for the same minimum edge length the front is therefore well captured we discuss the computational cost in the next section 4 3 parallel performance the parallel computing capability of the computational framework was tested using the same 3d si model presented in the previous section fig 10 purely to compare the scaling on a consistent number of elements the model was discretized using 2 5m elements for both fixed and dmo cases the scaling was tested against a reference case with 2 cores cpu to account for the added cost of distributed memory the number of elements per core is always larger than the minimum required for good parallel performance which is of order 15k the parallel performance was tested by executing 10 time steps with a fixed time step of 1 month with dmo applied every two timesteps all other settings were the same as in the previous section the strong scaling was tested with the number of cores increasing from two to 30 the scaling performance was evaluated using 23 η w r e f n r e f w n n n where w r e f and n r e f are the walltime of the reference simulation and the reference number of cores used here n r e f 2 likewise w n denotes the walltime using n n cores the scaling in both fixed and dmo cases is very similar and shows good performance falling to 0 7 at 30 cores i e the speed up is x0 7 of the ideal perfect speed up the results confirm that application of dmo does not compromise the efficiency of parallel scaling in these scaling results dmo is used to change the mesh but the number of elements remains fixed to ensure a fair comparison with the fixed mesh results in real world simulations the dmo performance varies more because the number of elements varies so the parallel partitioning may become more challenging as the mesh changes owing to changes in the size of the halos and the element size varies which impacts on the dynamic time stepping we tested the real world scaling of the saltdean model using dmo and allowing the number of elements to vary over a simulation period of ten years as expected the scaling is less stable oscillates more than the cases with a fixed number of elements but the overall scaling performance is comparable showing that dmo in parallel yields significant speed up compared to using a fixed mesh in serial 5 discussion we demonstrate here practical use of dynamic mesh optimization in a parallel computational framework to reduce simulation cost while maintaining solution accuracy in modelling saline intrusion dmo allows key solution features such as the saline front to be resolved at high resolution in a large 3d model domain at much lower computational cost than fixed mesh simulations with comparable accuracy we measure the computational advantage of dmo by comparing against equivalent fixed mesh solutions here we could do this only in 2d models in the 3d example shown we could not simulate the equivalent fixed mesh case at sufficient resolution because of the high computational cost we can however estimate the computational advantage of simulating this 3d model in parallel and with dmo versus a single core and a fixed mesh with the same resolution we obtained a 11 5 speed up in the 3d model through use of multiple cores and dmo fig 10 in the equivalent 2d model we obtained 10 75 speed up using dmo compared to an equivalent fixed mesh fig 9d it is reasonable to assume that use of dmo yields a similar speed up in the 3d model compared to the equivalent fixed mesh indeed the advantage of dmo is typically greater in 3d as the volume of the model domain and hence the total number of fixed mesh elements required scales as l 3 where l is the model size but the area of the saline front where dmo is required scales as l 2 combining these two speed ups suggests that dmo and parallelization yielded a reduction in computational cost in excess of 120 for the 3d saline intrusion problem tested here compared to a fixed mesh case with equivalent resolution simulated on a single core as is typical in current si intrusion models this clearly demonstrates the significant computational opportunities that the parallelized adaptive meshing framework presented here can bring to the field of groundwater modelling we tested the parallel scaling of dmo only to 30 cores we are aware that high performance computing hpc allows access to many more cores and the parallel scaling of numerical codes that use fixed or adaptive meshes has been tested to many more cores hammond et al 2014 wei et al 2015 although we are not aware of any studies that have tested the parallel scaling of numerical methods and codes used for si we restricted the scaling to 30 cores because as we show here dmo for si modelling provides similar accuracy to fixed mesh codes using of order 10 fewer elements a dmo model with sufficient elements to merit parallel simulation on several thousand cores would require several tens of millions of elements and yield similar accuracy to a fixed mesh simulation with several hundreds of millions of elements we do not anticipate a demand for such large models of si rather we argue that dmo enables practitioners to simulate heterogeneous 3d si problems on a desktop multi core machine which would otherwise require hundreds of millions of fixed elements on a hpc facility we have demonstrated dmo in parallel using a 3d model of a heterogeneous chalk aquifer containing laterally extensive marls and hardgrounds that are just a few metres in thickness the layers have very high aspect ratio and contrasting permeability hence this is a challenging example case we have also demonstrated benefits of dmo for flow problems although not si in other aquifer types using sbgm to model geological features such as inclined intersecting faults growth faults folded strata and complex stratigraphy and complex intersecting fractures jackson et al 2015 jacquemyn et al 2019 salinas et al 2021 in the models presented here smaller scale variability within the layers is neglected but this is not essential to sbgm and dmo it is possible to include for example finer scale stratigraphy in sbgms jacquemyn et al 2019 dmo works efficiently in sbgms that neglect the cell to cell scale variability often observed in pixel or grid based models but this has been shown to have a negligible impact on flow osman et al 2021 it is capturing and preserving the spatially correlated heterogeneity and connectivity of geological flow zones and flow barriers that is key to predict accurately flow and transport note that this does not mean that sbgms must be deterministic surfaces representing key correlated heterogeneity can be created stochastically jacquemyn et al 2019 and conditioned to borehole data titus et al 2021 we see significant value in dmo for modelling si in reducing simulation cost such that computational resources can be used to run many models or cases simulations of many models or cases are often required to explore and quantify the impact of uncertain aquifer architecture and hydrological properties on si to optimize well placement completion depth and operation in aquifers at risk of si and for model calibration against measured data kerrou et al 2013 rajabi and ataie ashtiani 2014 rajabi et al 2015 koohbora et al 2019 yang et al 2021 dmo can also ensure sufficient resolution is maintained in models irrespective of the dynamics of the saline front when the aquifer architecture or properties change in a sensitivity analysis or optimization process the saline front geometry or thickness may vary such that a fixed mesh resolution previously identified to have sufficient resolution may no longer be appropriate 6 conclusions groundwater is an increasingly important water resource but its long term viability is under threat due to over extraction contamination or both in many cases these threats are being exacerbated by climate change understanding of subsurface geological structures along with their parameterization and associated uncertainties is steadily improving due to the plethora of geophysical tools now available and there is a need to maximize the benefits these additional data provide to achieve this a new generation of numerical models which can readily accommodate geological complexity in a highly efficient computational framework is required here we present a framework for use of dynamic mesh optimization dmo which respects geological heterogeneity to simulate complex flow and transport problems in a parallel framework exemplified here through saline intrusion modelling in a highly efficient manner we suggest that parallelized dmo provides opportunities for ultra high resolution modelling of complex contaminant transport problems with sufficient rapidity that multiple 3d realizations to assess and quantify model and data uncertainty are not only desirable but also achievable credit authorship contribution statement a hamzehloo methodology software visualization validation writing original draft m l bahlali methodology software visualization validation writing original draft p salinas conceptualization methodology software writing review editing c jacquemyn methodology software c c pain methodology software a p butler writing original draft writing review editing supervision funding m d jackson conceptualization writing original draft writing review editing supervision funding declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to thank the uk engineering and physical sciences research council epsrc for supporting this work by grant ep r01938x 1 under project salina saline intrusion in coastal aquifers hydrodynamic assessment and prediction of dynamic response the authors would also like to thank members of the novel reservoir modelling and simulation norms group at imperial college london for many valuable discussions the authors have no conflicts of interest to declare all data reported here were created using the imperial college finite element reservoir simulator ic ferst which is available under the open source affero general purpose licence v 3 0 agpl v 3 0 at the ic ferst github repository http multifuids github io 
153,vertical recirculation wells used for remediation or heat recovery induce drawdown distribution that varies for confined unconfined leaky and reservoir covered aquifers a recirculation well with arbitrary arrangement of extraction and injection screen intervals is simulated with the general well function of perina and lee 2006 and perina 2014 after a minor modification distribution of radial flux along the screen intervals is determined as part of the solution for the mixed boundary condition along the well aquifer interface drawdown distribution reaches steady state with the transient period lasting over one year for unconfined aquifer and less than one hour for the other three aquifer types in the example considered the drawdown distribution varies by aquifer type and shows sensitivity to aquifer hydraulic properties and well construction suggesting that a recirculation well offers an effective and economical alternative to pumping tests for characterization of aquifer hydraulic properties keywords vertical recirculation well unconfined aquifer confined aquifer leaky aquifer analytical solution data availability statement there are no data sharing issues because no field observations or data were used in this manuscript the simulations presented may be recreated with published analytical models from the description of the example problems 1 introduction vertical recirculation wells with extraction and re injection screens separated by seals or packers are used for remediation of contaminated groundwater or for heat recovery drawdown distribution near a recirculation well installed in a confined unconfined leaky or reservoir covered aquifer can be simulated using an existing semi analytical model that treats the aquifer well interface as a mixed boundary condition accurate representation of the well face boundary is more important for a recirculation well than for a single screen pumping well vertical recirculation wells have long been used for the cleanup of contaminated aquifers u s epa 1998 recirculation wells instrumented with pumps have been used to deliver surfactants knox et al 1997 introduce partitioning tracers chen and knox 1997 and stimulate in situ biodegradation lakhwala et al 1998 an alternative design is the in situ stripping well in which water flow is induced by air lift i e rising gas bubbles within the well that also remove volatile contaminants from the water herrling and buermann 1990 gvirtzman and gorelick 1992 katz and gvirtzman 2000 some remediation systems utilize combinations of two or more vertical recirculation wells cirpka and kitanidis 2001 wu et al 2008 vertical recirculation wells are also used in combination with heat pumps to provide heating and or cooling for buildings xu and rybach 2003 rode et al 2015 rybach 2015 wu et al 2015 zeng et al 2017 kabala 1993 proposed a single well dipole flow test to create flowfield with significant vertical flow component near the test well that will allow estimating the vertical distribution of both the horizontal and vertical hydraulic conductivity k r and k z along the screen the test utilizes a packer assembly that isolates two sections of the well screen that are operated as a vertical recirculation well for a long screen well this assembly may be installed at varying depths to characterize the vertical k z profile he noted that the maximum sensitivity of drawdown to k z is near the pumping well one of the notable advantages of the dipole flow test is that it eliminates the need for potentially costly disposal of extracted water sutton et al 2000 combined the dipole flow test with a single borehole forced gradient tracer test for estimating the longitudinal dispersivity as well as k r and k z using a similar packer assembly paradis and lefebvre 2013 conducted single well interference slug tests to obtain a depth profile of horizontal and vertical hydraulic conductivity a vertical recirculation well has a minimum of two screen intervals separated by a section of blank casing and sealed off with a packer groundwater is typically pumped from one screen and re injected back into the aquifer via the second screen but multiple screen configurations are possible some applications use nested wells instead of a single casing well operation of a recirculation well does not remove groundwater from the aquifer and thus conserves groundwater as a resource and saves disposal costs and or replenishment fees recirculation wells used for remediation are operated to establish a flow pattern such that most of the reinjected water is recaptured this is to establish a mixing zone around the well but in many cases also to satisfy regulatory requirements low vertical to horizontal hydraulic conductivity ratio often caused by the presence of thin fine grained lenses can prevent the establishment of the recirculation pattern and render the well ineffective u s epa 1998 on the other hand such a low anisotropy ratio is desirable for a heat recovery recirculation well because it increases energy efficiency numerical models are generally necessary to simulate solute gandhi et al 2002 or heat transport near a recirculation well but the drawdown distribution in a uniform aquifer may be simulated by an analytical model while a steady state flow model is adequate for simulating the long term performance of a recirculation well a transient flow model is applicable when using the initial phase of operation as a pumping test to estimate hydraulic properties of the aquifer or to calculate the time necessary to reach steady state drawdown distribution it will be shown here that steady state conditions in an unconfined aquifer are reached after a long period of operation 1 1 previous approaches for modeling groundwater flow near a recirculation well kabala 1993 derived an analytical model for a dipole flow test in a confined or leaky aquifer from the superimposition of hantush s 1961 1964 solutions written for the pumping and injection wells zlotnik and ledder 1996 developed an analytical model for a dipole flow test in an infinite and semi infinite aquifer with the well screens represented by point or line sources van peursem et al 1999 derived an analytical model in which the extraction and injection screens of the well are modeled as uniformly distributed cylindrical sinks and sources respectively and analyzed the effects of finite thickness skin ni et al 2011 modeled the drawdown distribution near a recirculation well by superposition of the hantush 1961 solution for a partially penetrating well in a confined aquifer kabala 2021 showed that ni et al 2011 repeated some of the results from kabala 1993 tu et al 2020 derived an analytical solution for steady and transient flow near a recirculation well of zero diameter in a confined aquifer of finite thickness and with uniform gradient along the well screens the solution is equivalent to the superposition of the hantush 1961 solution kabala 2021 showed that tu et al 2020 did not present a new model but repeated both ni et al 2011 and kabala 1993 tu et al 2021 responded to kabala s 2021 comment without fully addressing the concerns raised morozov 2021 derived a semi analytical solution for flow near a vertical recirculation well with two screens in a confined aquifer using a discretization scheme hayashi et al 1987 chang and chen 2003 perina and lee 2006 for the mixed boundary condition along the well aquifer interface and included a skin factor all of the models cited are for constant flowrate an air lift operated well is neither flowrate controlled e g a well instrumented with a rate controlled pump nor drawdown controlled i e well instrumented such that it is pumped at specified drawdown francois et al 1996 developed a steady state one dimensional model for air lift induced flow inside a vertical pipe that includes non linear dependence between air and water flows and air pressure and indicates an upper limit on the induced water flow the model assumes constant submergence of the pipe and constant lift and does not account for the flow from and into the aquifer the linkage between groundwater flow in the aquifer and the multiphase flow inside the air lift well leads to a highly non linear boundary condition for the well aquifer model and is not considered here if flowrate measurements are available the air lift recirculation well can be treated as flowrate controlled 1 2 boundary condition along the well aquifer interface flow toward a partially penetrating well has usually been treated with the simplifying assumption of a uniform radial flux along the well screen for the development of analytical solutions hantush 1961 neuman 1974 moench 1997 lee 1999 although a mixed type boundary condition with specified drawdown along the screen and zero flux elsewhere is more appropriate because head variations inside the well are much smaller than the head gradients in the aquifer muskat 1937 hantush 1961 bear 1979 hyder et al 1994 cassiani and kabala 1998 hemker 1999 chang and chen 2003 perina and lee 2006 perina 2014 the boundary condition at the well face is of mixed type for either drawdown controlled or flowrate controlled wells a drawdown controlled well is an artesian flowing well or a well that has been instrumented such that it is pumped at specified drawdown as it is often done for dewatering or remediation the resulting transient flowrate varies with time a flowrate controlled well equipped with a pump set at specified discharge rate is perhaps the most common mode of pumping both specified drawdown and specified flowrate may be time dependent the relation between the drawdown in the extraction well and the pumping rate becomes linear in the laplace domain and solutions for drawdown during specified flowrate pumping and specified drawdown pumping can be derived from a single formulation perina and lee 2006 analytical and semi analytical models that solve the mixed boundary problem to account for nonuniform radial flux along the extraction well screen are referred to here as nonuniform flux models kirkham 1959 derived an analytical solution for steady state flow toward a partially penetrating well dagan 1978 haitjema and kraemer 1988 cole and zlotnik 1994 and tartakovsky et al 2000 presented semianalytical solutions for various steady state mixed type boundary value problems hayashi et al 1987 discretized the integral along the screen interval to simulate transient inflow distribution along screen in an isotropic medium tarshish 1993 used point sinks and image theory to model steady nonuniform inflows into a well in a confined aquifer accounting for energy losses and momentum flux along the screen to assess inflow velocity for analysis of sanding and corrosion cassiani and kabala 1998 presented a solution for a flowing partially penetrating well in a confined aquifer of semi infinite vertical extent hemker 1999 presented a hybrid analytical numerical solution for flow in a layered aquifer toward a well operated at a specified discharge and with uniform drawdown along the screen zhan and zlotnik 2002 simulated the two types of boundary condition for a horizontal well with a numerical model and concluded that for screen length nearly twice the aquifer thickness the error from the uniform flux model was small chang and chen 2003 derived a solution for a constant drawdown pumping test conducted on a well partially penetrating a confined aquifer of finite thickness perina and lee 2005 2007 developed nonuniform flux analytical solutions for a very similar problem of soil vapor extraction perina and lee 2006 developed a general well function for specified flowrate or specified drawdown pumping from a confined unconfined neuman 1972 1974 or leaky aquifer the general well function represents the leaky boundary flux aquifer of lee 1999 where drawdown dependent leakage occurs at the top or bottom of the aquifer rather than being represented by a lumped volumetric water production term hantush 1964 perina 2014 extended the general well function to pumping from a reservoir covered aquifer with a constant head boundary at the top and to soil vapor extraction the general well function can represent an extraction well with multiple screen intervals separated by blank casing and calculates the inflow distribution along the screens as part of the solution therefore it can be easily adapted for a recirculation well with an arbitrary arrangement of extraction and injection screens for a well in a confined aquifer the error of the uniform flux model decreases with the distance from the pumping well and is inversely proportional to the ratio of the screen length to its radius haitjema and kraemer 1988 cole and zlotnik 1994 cassiani and kabala 1998 tartakovsky et al 2000 zhan and zlotnik 2002 perina and lee 2006 showed that for unconfined and leaky aquifers the uniform flux model error increases with the length of the pumping well screen perina 2014 demonstrated that the flow allocation for a multi screen extraction well is in general not proportional to the screen lengths the distribution of radial influx along the screen varies with the screen s position s type of aquifer and time since the start of pumping for the majority of pumping tests conducted on single screen extraction wells observation wells are located far enough for the error of the uniform flux model to be negligible then the discretization approach used to solve the mixed boundary condition hayashi et al 1987 chang and chen 2003 perina and lee 2006 morozov 2021 allows the flexibility of changing the nonuniform flux model to the uniform flux model by simply assigning just one screen segment the computational effort reduces substantially for the uniform flux model most notably for an unconfined aquifer perina and lee 2006 at high flow rates frictional losses due to flow along the casing and across the screens result in non uniform drawdown distribution along screens for steady state flow the losses and resulting head distribution inside the well can be calculated following the approach of vonhofe and helweg 1998 although the resulting drawdown distribution could be assigned to the general well function in a two step approach it is not considered here frictional losses across the screen can however be simply added to the drawdown calculated within the wellbore perina 2014 2 aquifer types considered the general well function is applicable to four types of uniform horizontally infinite aquifers confined unconfined leaky and reservoir covered no flow is assumed across the bottom and the aquifer types differ only by the top boundary condition the unconfined aquifer includes instantaneous release of water from storage at the water table neuman 1972 the leaky aquifer includes drawdown dependent leakage across the top or bottom lee 1999 this is a more realistic representation of flow near the pumping well than the approximation of leakage by a volumetric production term hantush 1964 for a confined aquifer there is no flow across the top boundary the reservoir covered aquifer represents a saturated layer overlaid by a water reservoir so that the aquifer top is represented by a constant head boundary this boundary condition is applicable for soil vapor extraction from a vadose zone with no ground cover and the soil vapor extraction model is obtained from the general well function by a change of variables perina 2014 3 general well function for vertical recirculation well the recirculation well has at least two screens with one used to extract groundwater and the other to inject the extracted water in a general case there may be multiple extraction and injection screens arbitrarily arranged and positioned without overlapping between the aquifer top and bottom all extraction screens are assumed to be in hydraulic communication inside the well and so are all injection screens i e the screens are connected by piping and extraction screens are hydraulically isolated from injection screens the well has a finite radius of casing and is surrounded by a concentric shell of material that may have different hydraulic properties than the aquifer this shell may represent low permeability well skin or high permeability sand pack and over developed zone when the shell material is assigned the same properties as the aquifer the model reduces to a no skin model the well schematic is shown in fig 1 the derivation of the general well function perina and lee 2006 perina 2014 is summarized in appendix as shown in the appendix a minor modification of the general well function makes it applicable to a recirculation well the recirculation well is a special case of a multi screen pumping well 4 example simulations the example recirculation well problem described in tu et al 2020 is revisited the aquifer is 40 m thick the well extraction screen depth interval is 25 40 m and the injection screen interval is 0 15 m below the aquifer top the well has zero radius and is pumped at 60 m3 h the horizontal hydraulic conductivity of the aquifer is 0 1 m h vertical to horizontal anisotropy is 0 1 and specific storage is 2 5 10 6 m 1 tu et al 2020 used specific storage of 10 4 m 1 the observation location is a point at a radial distance r 5 m and depth z 25 m the general well function is defined for non zero screen radius for this simulation the radius was set to a low value of 0 01 m to approximate a well of infinitesimal screen radius for simulating the aquifer as unconfined the specific yield s y was set to 0 25 and for simulating a leaky aquifer the leakance coefficient c v was set to 10 2 h 1 comparison of drawdown in a confined aquifer calculated using uniform flux and nonuniform flux models fig 2 for the example in tu et al 2020 shows that the error in the drawdown calculated by the uniform flux model is about 0 5 m 6 4 at steady state the drawdown simulated by the uniform flux model can be recreated by superposition of extraction and injection wells calculated by a uniform flux model for this example the hantush 1961 solution in commercial software aqtesolv was used for the nonuniform flux model each screen interval was discretized into 10 segments the inflow distribution along the screen calculated by the nonuniform flux model has the highest inflow near the top of the extraction screen and the highest outflow near the bottom of the injection well screen fig 3 shows the distribution of flows q j into the screen segments j at steady state q j 0 fig 4 shows the difference in drawdown for different types of aquifers drawdown reaches steady state for all aquifer types the confined and reservoir covered aquifers reach steady state most rapidly while the drawdown in the unconfined aquifer reaches steady state after more than one year of operation the steady state drawdown in confined and unconfined aquifers is the same but the transient drawdown differs by over 1 5 m after several hours of operation for decreasing s y unconfined aquifer response approaches that of a confined aquifer leaky aquifer response approaches that of confined and reservoir covered aquifers for decreasing and increasing c v respectively this is because the confined and reservoir covered aquifers are special cases of the leaky boundary flux aquifer the response in the aquifer differs significantly with the observation point location fig 5 shows the responses in different types of aquifers at a point that is at the same distance but shallower depth z 15 m the drawdown is negative because the observation location is near the bottom of the injection screen the transient drawdown in confined and unconfined aquifers differs by more than 2 m steady state is reached at similar times as at the first observation location fig 3 the error in late time drawdown calculated by the uniform flux model at a point r 5 m z 15 m in a confined unconfined and leaky aquifer is about 6 7 and 4 respectively fig 6 drawdown distribution calculated over an r z cross section for the example from tu et al 2020 shows substantial differences for the four aquifer types fig 7 the difference between the nonuniform flux and uniform flux models on the cross sections appears relatively minor compared to the time drawdown curves fig 6 as a demonstration of an arbitrary screen arrangement fig 8 shows drawdown distribution and flow vectors near a hypothetical remediation recirculation well with one extraction screen and two injection screens arranged asymmetrically about the mid depth of a leaky aquifer the drawdown contours indicate greater gradients between the bottom of the extraction screen and top of the deep injection screen than between the bottom of the shallow injection screen and top of the extraction screen the flow vectors indicate that some of the injected water is lost across the leaky aquitard at the top the flow vectors also suggest almost complete re capture of the injected water within the zone r b the capture zone would change with the anisotropy ratio the extraction rate is constant at 60 m3 h and the model allocates the injection rate at 21 6 m3 h to the top screen and 38 4 m3 h to the bottom screen the distribution of radial fluxes along the screen intervals is irregular with highest flux magnitude near the screen ends except for the bottom of the deep injection screen positioned at the impermeable aquifer bottom fig 9 5 conclusions the general well function can be used to model a vertical recirculation well with arbitrary screen arrangement installed in a confined unconfined leaky or reservoir covered aquifer using an existing model eliminates the need to solve the governing partial differential equation specifically for this flow problem the simulated drawdown reaches steady state distribution for all four aquifer types for an unconfined aquifer steady state is reached after a long time of operation more than one year while for the other types of aquifer steady state is reached much earlier in less than an hour in the hypothetical example considered the drawdown distribution near a recirculation well varies with the type of aquifer and its properties the time drawdown curves also vary significantly depending on the location of the observation point in the aquifer these findings suggest that operation of a recirculation well may be treated as a field test for determining the aquifer type and for estimating aquifer properties by fitting transient and or steady drawdown recorded at observation wells the affected aquifer zone is smaller for a recirculation well than for a pumping well and this may be a limitation or benefit depending on the test objectives the representation of the aquifer well interface as a mixed boundary condition is important to avoid systematic errors in calculated drawdown near a recirculation well this work did not aim to find configurations of the well screen and observation locations where this error is the largest the effect of fitting the uniform flux or nonuniform flux model to drawdown observations on estimated aquifer properties should be evaluated in the future however it is important to note that aquifer heterogeneities would have far greater effect on the drawdown distribution in the aquifer and distribution of radial fluxes along the well screens than the chosen representation of the well boundary condition the dipole flow test kabala 1993 especially when observation wells are available offers an effective and economical alternative to pumping tests for characterization of aquifer hydraulic properties the main problem for the dipole flow test conducted on a long screen well instrumented with packers is the shortcutting of flow through the annular backfill material and possibly through an over developed zone in the aquifer kabala 1993 the general well function can simulate vertical flow through this zone as shown in the appendix frictional well losses may be added to the calculated in well drawdown for the dipole flow test declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments i wish to thank zbigniew j kabala duke university keith j halford u s geological survey and an anonymous reviewer for their thorough review and helpful comments water resources research rejected a draft of this paper without review in 2021 appendix derivation of general well function the following is a summary of the derivation of the solutions presented in perina and lee 2006 and perina 2014 with addition of the special case of a recirculation well separate solution for a confined aquifer multi screen observation well and more detailed frictional loss term a 1 boundary initial value problem consider an aquifer of thickness b hydraulic conductivity in the radial direction k r a and in the vertical direction k z a and specific storage s s a its properties k r a k z a s s a and b are uniform within the zone influenced by the pumping the pumping or test well has a finite diameter and partially penetrates the aquifer the aquifer well schematic for a well configured for recirculation operation is shown in fig 1 for pumping or injection the well may have multiple screens but is not instrumented with a packer and all screens are in hydraulic communication i e for extraction flow is into the well through all screens the test is conducted under the condition of either specified flowrate or specified drawdown instantaneously applied at the extraction well at time zero the term specified as used here implies that the quantity be known or measured it does not have to be constant in time or even controlled examples of specified flowrate pumping and specified drawdown pumping are a constant rate pumping test and an artesian flowing well respectively a finite thickness skin with properties k r s k z s and s s s extending from r w to r s r s r w is considered this concentric shell can represent any material with properties different from those of the aquifer such as low permeability skin or high permeability over developed zone superscripts a and s used to designate the properties of the aquifer and skin respectively are omitted in relations that hold for both regions the governing partial differential equation for density independent groundwater flow in the aquifer and skin is 1 k r 2 s r 2 1 r s r k z 2 s z 2 s s s t where s is the drawdown as a function of time t radial distance r and depth z the general well face boundary condition is 2 q π r c 2 s w t 2 π r w k r s z t z b s r d z at r r w where q is the pumping rate positive for extraction r w is the well screen radius r c is the well casing radius s w is the drawdown within the extraction well and z t and z b are depths to the top and bottom of the well screen respectively the z coordinate is downward positive it is convenient to re write the well face boundary condition 2 as 3 q 2 π r w k r s s s r at r r w where q is the yet unknown radial flux per unit screen length and satisfy the condition for wellbore storage by 4 q π r c 2 s w t z t z b q d z condition 4 applies to both flow controlled and drawdown controlled well prescribing a known function of time for example a constant for either q or s w in 4 changes the flow problem to specified flowrate or specified drawdown pumping respectively the groundwater flow region is divided into two zones in the radial direction r s r for flow in the aquifer and r w r r s for flow within the skin to impose continuity of drawdown and flux at the joint boundary at r s the drawdown in the aquifer s a and within the skin s s are related by interface conditions 5 s s s a at r r s and 6 k r s r s s k r a r s a at r r s the top boundary condition at z 0 differs depending on the type of aquifer for an unconfined aquifer with instantaneous release of water from storage neuman 1972 the top boundary condition is 7 k z s z s y s t for a leaky aquifer the top boundary condition changes to a drawdown dependent boundary flux condition lee 1999 8 k z a s z c v s where the vertical leakance 9 c v k c b c represents the leakage from a confining layer of thickness b c with vertical hydraulic conductivity k c mcdonald and harbaugh 1988 lee 1999 the solution by integral transforms requires that s y and c v be the same for both the aquifer and skin regions for a confined aquifer there is no flow across the top boundary 10 s z 0 for a reservoir covered aquifer the aquifer top is represented by a constant head boundary perina 2014 11 s 0 the confined and reservoir covered aquifers are special cases of the leaky aquifer with very low and very high c v respectively they can be represented by the leaky aquifer model but computation is faster for the integral transforms applicable to the special cases there is no flow across the bottom of the aquifer this condition may be changed to a constant head boundary or leaky boundary flux boundary as remarked later the pumping test problem is defined by the governing eq 1 subject to the initial condition of zero drawdown 12 s 0 at t 0 boundary conditions 13 s z 0 at z b 14 s a 0 as r the appropriate top boundary condition 7 to 11 well face condition 3 and wellbore storage condition 4 a 2 solution the boundary initial value problem 1 to 14 is solved using the laplace transform in t snedon 1951 and a finite fourier transform in z appropriate for the top boundary condition the finite fourier transform of the mixed boundary condition at the pumping well leads to fredholm integral equation that is solved for the unknown fluxes by discretization of the well screen interval the generalized finite fourier cosine transform churchill 1972 is applicable for an unconfined or leaky aquifer the finite fourier cosine transform churchill 1972 is applicable for a confined aquifer and the modified finite fourier sine transform churchill 1972 is applicable for a reservoir covered aquifer the finite cosine transforms are defined as 15 g n f g x 0 1 g x cos λ n x d x where the eigenvalues λ n n 0 1 2 3 for the generalized finite fourier cosine transform are the roots of 16 tan y a y with 17 a s y p b k z a for unconfined aquifer and 18 a c v b k z a for leaky aquifer and λ n n π for the finite fourier cosine transform the modified sine transform is defined as 19 g n f g x 0 1 g x sin λ n x d x where λ n 2 n 1 π 2 n 1 2 3 the inverse generalized finite fourier cosine transform is 20 g x f g n 2 a n 0 g n cos λ n x a sin 2 λ n the inverse cosine transform is 21 g x f g n g 0 2 n 1 g n cos n π x and the inverse modified sine transform is 22 g x f g n 2 n 1 g n sin λ n x churchill 1972 for the convenience of the finite transforms defined on the interval 0 η 1 introduce a dimensionless variable 23 η b z b for the generalized finite fourier cosine transform and 24 η z b for the finite fourier cosine and modified finite fourier sine transforms applying the appropriate integral transform and its operational properties churchill 1972 to 1 13 and the appropriate top boundary condition results in an ordinary modified bessel differential equation in r 25 2 s n r 2 1 r s n r k z b 2 λ n 2 k r s s p k r s n 0 where the n th term of the transform s n is a function of p and λ n solving eq 25 subject to 14 and transformed 5 and 6 yields 26 s n a c n k 0 ξ n a r and 27 s n s b n k 0 ξ n s r a n i 0 ξ n s r where 28 ξ n a λ n 2 k z a k r a s s a p k r a 29 ξ n s λ n 2 k z s k r s s s s p k r s 30 c n b n k 0 ξ n s r s k 0 ξ n a r s a n i 0 ξ n s r s k 0 ξ n a r s 31 a n b n g n 32 g n k r s ξ n s k 1 ξ n s r s k 0 ξ n a r s k r a ξ n a k 0 ξ n s r s k 1 ξ n a r s k r s ξ n s k 0 ξ n a r s i 1 ξ n s r s k r a ξ n a i 0 ξ n s r s k 1 ξ n a r s and i 0 k 0 i 1 and k 1 are the modified bessel functions of the first and second kinds and zeroth and first order coefficient b n is evaluated from laplace fourier transformed condition 3 for the cosine transforms it is written as 33 b n 0 1 q cos λ n η d η 2 π r w k r s ξ n s k 1 ξ n s r w g n i 1 ξ n s r w the cosine term in the numerator is replaced by sine for the modified sine transform eq 33 containing the unknown flux q under the integral is solved by discretizing the well screen interval into n segments of length δ η j that are sufficiently small such that q j representing the radial flux per unit screen length from the aquifer into the well segment j may be considered constant for each segment the segments may be of equal or unequal length for example shorter segments may be used near screen ends for higher resolution of q j then the integral in 33 can be replaced by the summation 34 b n 1 2 π r w k r s λ n ξ n s k 1 ξ n s r w g n i 1 ξ n s r w j 1 n q j sin λ n η j sin λ n η j where η j η j δ η j 2 η j η j δ η j 2 and δ η j η j η j a corresponding result is obtained for the modified sine transform now the appropriate inverse fourier transform is applied to 26 and 27 for example the inverse generalized finite fourier cosine transform applicable to unconfined or leaky aquifers is 35 s a 2 a n 0 b n k 0 ξ n s r s k 0 ξ n a r s g n i 0 ξ n s r s k 0 ξ n a r s k 0 ξ n a r cos λ n η a sin 2 λ n and 36 s s 2 a n 0 b n k 0 ξ n s r g n i 0 ξ n s r cos λ n η a sin 2 λ n eqs 35 and 36 still contain the unknown radial fluxes q j the solution for q j is subject to the condition that the average drawdown at r r w for every segment i is equal to s w 37 s w 1 δ η i η i η i s s d η at r r w substitution from 36 leads to 38 s w 2 a δ η i n 0 b n k 0 ξ n s r w g n i 0 ξ n s r w a sin 2 λ n sin λ n η i sin λ n η i λ n the extraction well screen may be interrupted by sections of blank casing the flow distribution among multiple screens subject to the condition of uniform drawdown inside the well is readily computed by including integrals for all screens in 37 and extending the system of eqs 38 the system of eqs 38 relates the unknown fluxes q j to the drawdown in the extraction well s w for all segments for a drawdown controlled well specified drawdown pumping 39 s w j 1 n q j ψ i j which written in matrix form is 40 ψ 1 1 ψ 1 2 ψ 1 n ψ 2 1 ψ 2 2 ψ 2 n ψ n 1 ψ n 2 ψ n n q 1 q 2 q n 1 1 1 s w where 41 ψ i j a π r w k r s δ η i n 0 k 0 ξ n s r w g n i 0 ξ n s r w ξ n s k 1 ξ n s r w g n i 1 ξ n s r w ψ i j a sin 2 λ n and 42 ψ i j sin λ n η j sin λ n η j sin λ n η i sin λ n η i λ n 2 to compute the drawdown in the aquifer during specified s w pumping eq 40 is solved for q j and the resulted fluxes are substituted into 35 the flowrate during specified drawdown pumping is computed from the laplace transform of the discretized form of 4 43 q α s w b j 1 n δ η j q j where 44 α π r c 2 p the term 44 may be modified to account for the radius r p of the discharge pipe 45 α π r c 2 r p 2 p the solution given by 40 and 43 is also applicable to a well with infinitesimal or zero casing diameter imposing condition 43 on 39 yields the system of equations for a flow controlled well specified flowrate pumping with non zero casing diameter 46 q j 1 n q j α ψ i j b δ η j in matrix form 47 b δ η 1 α ψ 1 1 b δ η 2 α ψ 1 2 b δ η n α ψ 1 n b δ η 1 α ψ 2 1 b δ η 2 α ψ 2 2 b δ η n α ψ 2 n b δ η 1 α ψ n 1 b δ η 2 α ψ n 2 b δ η n α ψ n n q 1 q 2 q n 1 1 1 q the drawdown in the aquifer is again computed using 35 and within the skin using 36 the drawdown within the pumping well is computed using 43 although the radius of casing is non zero for a physical well a solution for zero radius casing can be used to separate the wellbore storage effect or to compare the calculated drawdown with drawdown computed using existing line source solutions e g hantush 1964 neuman 1974 setting r c to zero in 44 requires that the system of eqs 47 be augmented by 43 to obtain 48 ψ 1 1 ψ 1 2 ψ 1 n 1 ψ 2 1 ψ 2 2 ψ 2 n 1 ψ n 1 ψ n 2 ψ n n 1 b δ η 1 b δ η 2 b δ η n α q 1 q 2 q n s w 0 0 q the drawdown in the pumping well is obtained as the last element of the vector of unknowns the drawdown in the aquifer is again computed using 35 and within the skin using 36 both q and h may have arbitrary time dependence subject to the limitations of the numerical inverse laplace transform used the most common aquifer test types are constant flowrate 49 q q c p where q c is the constant flowrate from the extraction well constant drawdown or flowing artesian well 50 s w s c p where s c is the constant drawdown applied at the extraction well and slug test 51 q π r c 2 s d where s d is the initial displacement linear superposition in time of 49 or 50 can be used for step wise representation of arbitrarily variable pumping injection and recovery a 3 drawdown in observation well drawdown in an observation well may be affected by wellbore storage and low permeability skin the drawdown s os in an observation well of casing radius r oc screen radius r ow skin radius r os and skin conductivity k os is derived from a difference approximation of flow across the skin zone 52 π r oc 2 s ow t 2 π k os r ow r os 2 z ob z ot s ow s os r os r ow and averaging aquifer drawdown between the top z ot and bottom z ob of the screen along the skin aquifer interface to get perina and lee 2006 53 s ow a 1 1 ζ ow π r oc 2 p η 2 ow η 1 ow η 1 ow η 2 ow s a d η where 54 ζ ow r os r ow π k os r ow r os z ob z ot this approach may be extended to an observation well with n s screen intervals separated by sections of blank casing the i th screen interval is z t o p i to z b o t i and their corresponding dimensionless depths are η 1 i to η 2 i then the wellbore condition becomes 55 π r oc 2 s ow t i 1 n s 2 π k os r ow r os 2 z b o t i z t o p i s ow s i r os r ow and the averaged laplace domain drawdown is 56 s ow k os i 1 n s z b o t i z t o p i s i r oc 2 p r os r ow r ow r os k os i 1 n s z b o t i z t o p i where 57 s i 1 η 2 i η 1 i η 1 i η 2 i s a d η the integrals in 53 and 56 only require integration of the cosine term in 35 and are evaluated in closed form not shown a 4 recirculation well the well operates at rate q positive for extraction negative for injection that may be time dependent there is no delay between extraction and injection so that the extraction and injection rates are equal at all times the model accounts for wellbore storage separately for the injection and extraction portions of the well the laplace transformed drawdown in the extraction screen s is s e and in the re injection screen s it is s r with s e 0 and s r 0 the system of eqs 39 relating the unknown fluxes to the drawdown in the well changes to 58 s i j 1 n q j ψ i j where the laplace space drawdown in the extraction screen s is s i s e and in the re injection screen s it is s i s r and q j are positive for extraction and negative for injection then 40 becomes 59 ψ 1 1 ψ 1 2 ψ 1 n ψ 2 1 ψ 2 2 ψ 2 n ψ n 1 ψ n 2 ψ n n q 1 q 2 q n s 1 s 2 s n because a recirculation well is flowrate controlled the system of equations must be augmented by imposing the flowrate constraint with a modification of 43 to define the conditions for extraction screens 60 q α s e b j e 1 n δ η j q j and re injection screens 61 q α s r b j r 1 n δ η j q j where the subscripts e and r imply that the summations are only carried over the extraction and re injection screen segments respectively the casing radius included in the term α to account for wellbore storage is taken to be the same for the extraction and injection screens but 60 and 61 can be easily modified to account for different casing radii and or discharge piping inside the well depending on the packer assembly open water level may not be present in either the extraction or injection chamber consequently the wellbore storage becomes a function of water compressibility as in the case of a shut in slug test butler 1998 and conditions 2 and 4 must be modified accordingly the augmented system of equations for the unknown q j s e and s r then becomes 62 ψ 1 1 ψ 1 2 ψ 1 n 0 1 ψ 2 1 ψ 2 2 ψ 2 n 0 1 ψ i 1 ψ i 2 ψ i j ψ i j 1 ψ i n 1 0 ψ i 1 1 ψ i 1 2 ψ i 1 j ψ i 1 j 1 ψ i 1 n 1 0 ψ n 1 ψ n 2 ψ n n 0 1 0 0 b δ η j b δ η j 1 0 α 0 b δ η 1 b δ η 2 0 0 b δ η n 0 α q 1 q 2 q i q i 1 q n s e s r 0 0 0 0 0 q q in the example eq 62 rows 1 2 and n are for re injection screen segments and rows i and i 1 are for extraction screen segments any configuration of extraction and re injection screens can be represented in 62 when the number of screen segments is specified as 1 for each screen the solution reduces to a uniform flux model however if there are more than one extraction and one injection screens 62 allocates flow to the screens as part of the solution even if each screen is represented by one segment with the radial fluxes computed by 62 the drawdown at a point in the aquifer and in an observation well is calculated using 35 and 53 respectively a 5 steady state eqs 62 40 and 47 apply to both transient in the laplace domain and steady state flow steady state conditions are obtained as lim p 0 p s and the terms containing the laplace variable p change as described in perina and lee 2006 and perina 2014 for confined and unconfined aquifers steady state is reached for a recirculation well only because steady state drawdown distribution for unconfined and confined aquifers is the same the general well function may be evaluated for a confined aquifer at a lower computational effort for a recirculation well operating at steady state in a confined aquifer the 0 th term of the inverse finite fourier cosine transform is zero a 6 fully penetrating well for a fully penetrating extraction well the well face boundary becomes specified drawdown first type boundary condition and the integral transform approach leads to a solution that does not require discretization perina and lee 2006 perina 2014 this case is obviously not applicable to a vertical recirculation well a 7 non zero flux bottom boundary condition the bottom boundary condition of zero flux may be changed to a constant head boundary or leaky boundary flux boundary if desired necessitating the use of a generalized integral transform in z ozisik 1989 for the leaky aquifer a simple change of the vertical coordinate results in leakage across the aquifer bottom instead of the top lee 1999 a 8 frictional well loss well loss is traditionally separated into linear components including aquifer loss i e drawdown and skin loss and nonlinear component of frictional loss kawecki 1995 both linear well losses are accounted for in 43 well loss s f due to friction for flow across the screen and flow along the screen casing inside the well does not affect drawdown in the aquifer and consequently does not have to be included in the well face boundary condition these conditions are not satisfied for high capacity pumping wells with large losses due to flow along the screen interval inside the well well loss s f during specified flowrate pumping can be added in the time domain as a flowrate only dependent component to the calculated drawdown in the extraction well on the other hand frictional well loss during specified drawdown pumping such as for a flowing artesian well varies over time with the flowrate and must be calculated separately wendland 2008 this time varying loss is subtracted from the drawdown measured at the wellhead to represent the drawdown at the well screen and its time dependence may be treated by superposition in time perina 2021 the frictional loss is 63 s f c c q 2 c s j 1 n b δ η j q j 2 where the first term represents losses due to flow along the casing inside the well the second term represents losses due to flow across the screen and c c and c s are friction coefficients the value of the exponent is taken here to be 2 based on the darcy weisbach formula the two frictional loss components are defined separately instead of being lumped into one term perina 2014 because the second term increases with time as wellbore storage effect diminishes the q j in 63 are the time domain fluxes calculated by numerical inverse laplace transform of 47 and q is the time variable or constant pumping rate a 9 soil vapor extraction with appropriate variable substitutions the model can represent soil vapor extraction and re injection in a vadose zone with leaky cover or no cover perina 2014 a 10 numerical evaluation the roots of 16 must be evaluated to high precision by a root finding technique with bracketing perina and lee 2006 the series in 35 36 and 41 converge oscillatorily to a final value the minimum required number of terms in the oscillatory series is determined through rewriting the terms using trigonometric identities and comparison of short and long wavelength components perina and lee 2006 perina 2014 the summation may then be terminated after a number of terms that represents a single cycle of the low frequency component the required number of summation terms is inversely proportional to the length of the shortest screen segment δ η j the results shown in figs 2 to 7 were computed using 53 summation terms and the results shown in figs 8 to 9 were computed using 160 summation terms the inverse laplace transform was evaluated by the stehfest 1970 method with 10 summation coefficients the stehfest 1970 method is applicable to laplace transforms of monotonic functions in time but it has been shown to be accurate for some non monotonic functions for example the response to a slug test in an observation well butler 1998 paradis and lefebvre 2013 was evaluated using the hyder et al 1994 model with the stehfest 1970 algorithm the well function of perina and lee 2006 produces the same result for a slug test as the hyder et al 1994 model other examples of non monotonic functions evaluated using the stehfest 1970 algorithm include calculation of groundwater velocity near a pumping well zlotnik et al 1997 radial flux near a pressurized borehole deturnay and cheng 1988 diffusion flux kuhlman 2013 mass transport in gas wojcik et al 2015 and fluid flow in a fractal reservoir zhao and zheng 2011 the comparison with a superposition of the time domain hantush 1961 solution in fig 2 serves as a check on the accuracy of the general well function for a recirculation well evaluated with the stehfest 1970 method the stehfest 1970 method however limits the allowable time dependency of the specified flowrate or specified drawdown to an instantaneous impulse constant linearly decreasing increasing or exponentially decreasing some of these limitations could be avoided by using the de hoog et al 1982 algorithm at the cost of increased execution time however arbitrarily variable flowrate or specified drawdown for a flowing well can be represented by superposition in time of constant or linearly varying mishra et al 2013 pumping steps the stehfest 1970 method also becomes inaccurate for well functions evaluated at very small times generally t 1 s and very large times generally t 100 y the computation time is the shortest for confined and reservoir covered aquifers longer for a leaky aquifer and the longest for an unconfined aquifer the difference arises from the need to evaluate the eigenvalues of the inverse fourier transform by a root finding technique for the leaky aquifer and by the necessity of repeating the root finding for every term of the numerical inverse laplace transform for the unconfined aquifer 
153,vertical recirculation wells used for remediation or heat recovery induce drawdown distribution that varies for confined unconfined leaky and reservoir covered aquifers a recirculation well with arbitrary arrangement of extraction and injection screen intervals is simulated with the general well function of perina and lee 2006 and perina 2014 after a minor modification distribution of radial flux along the screen intervals is determined as part of the solution for the mixed boundary condition along the well aquifer interface drawdown distribution reaches steady state with the transient period lasting over one year for unconfined aquifer and less than one hour for the other three aquifer types in the example considered the drawdown distribution varies by aquifer type and shows sensitivity to aquifer hydraulic properties and well construction suggesting that a recirculation well offers an effective and economical alternative to pumping tests for characterization of aquifer hydraulic properties keywords vertical recirculation well unconfined aquifer confined aquifer leaky aquifer analytical solution data availability statement there are no data sharing issues because no field observations or data were used in this manuscript the simulations presented may be recreated with published analytical models from the description of the example problems 1 introduction vertical recirculation wells with extraction and re injection screens separated by seals or packers are used for remediation of contaminated groundwater or for heat recovery drawdown distribution near a recirculation well installed in a confined unconfined leaky or reservoir covered aquifer can be simulated using an existing semi analytical model that treats the aquifer well interface as a mixed boundary condition accurate representation of the well face boundary is more important for a recirculation well than for a single screen pumping well vertical recirculation wells have long been used for the cleanup of contaminated aquifers u s epa 1998 recirculation wells instrumented with pumps have been used to deliver surfactants knox et al 1997 introduce partitioning tracers chen and knox 1997 and stimulate in situ biodegradation lakhwala et al 1998 an alternative design is the in situ stripping well in which water flow is induced by air lift i e rising gas bubbles within the well that also remove volatile contaminants from the water herrling and buermann 1990 gvirtzman and gorelick 1992 katz and gvirtzman 2000 some remediation systems utilize combinations of two or more vertical recirculation wells cirpka and kitanidis 2001 wu et al 2008 vertical recirculation wells are also used in combination with heat pumps to provide heating and or cooling for buildings xu and rybach 2003 rode et al 2015 rybach 2015 wu et al 2015 zeng et al 2017 kabala 1993 proposed a single well dipole flow test to create flowfield with significant vertical flow component near the test well that will allow estimating the vertical distribution of both the horizontal and vertical hydraulic conductivity k r and k z along the screen the test utilizes a packer assembly that isolates two sections of the well screen that are operated as a vertical recirculation well for a long screen well this assembly may be installed at varying depths to characterize the vertical k z profile he noted that the maximum sensitivity of drawdown to k z is near the pumping well one of the notable advantages of the dipole flow test is that it eliminates the need for potentially costly disposal of extracted water sutton et al 2000 combined the dipole flow test with a single borehole forced gradient tracer test for estimating the longitudinal dispersivity as well as k r and k z using a similar packer assembly paradis and lefebvre 2013 conducted single well interference slug tests to obtain a depth profile of horizontal and vertical hydraulic conductivity a vertical recirculation well has a minimum of two screen intervals separated by a section of blank casing and sealed off with a packer groundwater is typically pumped from one screen and re injected back into the aquifer via the second screen but multiple screen configurations are possible some applications use nested wells instead of a single casing well operation of a recirculation well does not remove groundwater from the aquifer and thus conserves groundwater as a resource and saves disposal costs and or replenishment fees recirculation wells used for remediation are operated to establish a flow pattern such that most of the reinjected water is recaptured this is to establish a mixing zone around the well but in many cases also to satisfy regulatory requirements low vertical to horizontal hydraulic conductivity ratio often caused by the presence of thin fine grained lenses can prevent the establishment of the recirculation pattern and render the well ineffective u s epa 1998 on the other hand such a low anisotropy ratio is desirable for a heat recovery recirculation well because it increases energy efficiency numerical models are generally necessary to simulate solute gandhi et al 2002 or heat transport near a recirculation well but the drawdown distribution in a uniform aquifer may be simulated by an analytical model while a steady state flow model is adequate for simulating the long term performance of a recirculation well a transient flow model is applicable when using the initial phase of operation as a pumping test to estimate hydraulic properties of the aquifer or to calculate the time necessary to reach steady state drawdown distribution it will be shown here that steady state conditions in an unconfined aquifer are reached after a long period of operation 1 1 previous approaches for modeling groundwater flow near a recirculation well kabala 1993 derived an analytical model for a dipole flow test in a confined or leaky aquifer from the superimposition of hantush s 1961 1964 solutions written for the pumping and injection wells zlotnik and ledder 1996 developed an analytical model for a dipole flow test in an infinite and semi infinite aquifer with the well screens represented by point or line sources van peursem et al 1999 derived an analytical model in which the extraction and injection screens of the well are modeled as uniformly distributed cylindrical sinks and sources respectively and analyzed the effects of finite thickness skin ni et al 2011 modeled the drawdown distribution near a recirculation well by superposition of the hantush 1961 solution for a partially penetrating well in a confined aquifer kabala 2021 showed that ni et al 2011 repeated some of the results from kabala 1993 tu et al 2020 derived an analytical solution for steady and transient flow near a recirculation well of zero diameter in a confined aquifer of finite thickness and with uniform gradient along the well screens the solution is equivalent to the superposition of the hantush 1961 solution kabala 2021 showed that tu et al 2020 did not present a new model but repeated both ni et al 2011 and kabala 1993 tu et al 2021 responded to kabala s 2021 comment without fully addressing the concerns raised morozov 2021 derived a semi analytical solution for flow near a vertical recirculation well with two screens in a confined aquifer using a discretization scheme hayashi et al 1987 chang and chen 2003 perina and lee 2006 for the mixed boundary condition along the well aquifer interface and included a skin factor all of the models cited are for constant flowrate an air lift operated well is neither flowrate controlled e g a well instrumented with a rate controlled pump nor drawdown controlled i e well instrumented such that it is pumped at specified drawdown francois et al 1996 developed a steady state one dimensional model for air lift induced flow inside a vertical pipe that includes non linear dependence between air and water flows and air pressure and indicates an upper limit on the induced water flow the model assumes constant submergence of the pipe and constant lift and does not account for the flow from and into the aquifer the linkage between groundwater flow in the aquifer and the multiphase flow inside the air lift well leads to a highly non linear boundary condition for the well aquifer model and is not considered here if flowrate measurements are available the air lift recirculation well can be treated as flowrate controlled 1 2 boundary condition along the well aquifer interface flow toward a partially penetrating well has usually been treated with the simplifying assumption of a uniform radial flux along the well screen for the development of analytical solutions hantush 1961 neuman 1974 moench 1997 lee 1999 although a mixed type boundary condition with specified drawdown along the screen and zero flux elsewhere is more appropriate because head variations inside the well are much smaller than the head gradients in the aquifer muskat 1937 hantush 1961 bear 1979 hyder et al 1994 cassiani and kabala 1998 hemker 1999 chang and chen 2003 perina and lee 2006 perina 2014 the boundary condition at the well face is of mixed type for either drawdown controlled or flowrate controlled wells a drawdown controlled well is an artesian flowing well or a well that has been instrumented such that it is pumped at specified drawdown as it is often done for dewatering or remediation the resulting transient flowrate varies with time a flowrate controlled well equipped with a pump set at specified discharge rate is perhaps the most common mode of pumping both specified drawdown and specified flowrate may be time dependent the relation between the drawdown in the extraction well and the pumping rate becomes linear in the laplace domain and solutions for drawdown during specified flowrate pumping and specified drawdown pumping can be derived from a single formulation perina and lee 2006 analytical and semi analytical models that solve the mixed boundary problem to account for nonuniform radial flux along the extraction well screen are referred to here as nonuniform flux models kirkham 1959 derived an analytical solution for steady state flow toward a partially penetrating well dagan 1978 haitjema and kraemer 1988 cole and zlotnik 1994 and tartakovsky et al 2000 presented semianalytical solutions for various steady state mixed type boundary value problems hayashi et al 1987 discretized the integral along the screen interval to simulate transient inflow distribution along screen in an isotropic medium tarshish 1993 used point sinks and image theory to model steady nonuniform inflows into a well in a confined aquifer accounting for energy losses and momentum flux along the screen to assess inflow velocity for analysis of sanding and corrosion cassiani and kabala 1998 presented a solution for a flowing partially penetrating well in a confined aquifer of semi infinite vertical extent hemker 1999 presented a hybrid analytical numerical solution for flow in a layered aquifer toward a well operated at a specified discharge and with uniform drawdown along the screen zhan and zlotnik 2002 simulated the two types of boundary condition for a horizontal well with a numerical model and concluded that for screen length nearly twice the aquifer thickness the error from the uniform flux model was small chang and chen 2003 derived a solution for a constant drawdown pumping test conducted on a well partially penetrating a confined aquifer of finite thickness perina and lee 2005 2007 developed nonuniform flux analytical solutions for a very similar problem of soil vapor extraction perina and lee 2006 developed a general well function for specified flowrate or specified drawdown pumping from a confined unconfined neuman 1972 1974 or leaky aquifer the general well function represents the leaky boundary flux aquifer of lee 1999 where drawdown dependent leakage occurs at the top or bottom of the aquifer rather than being represented by a lumped volumetric water production term hantush 1964 perina 2014 extended the general well function to pumping from a reservoir covered aquifer with a constant head boundary at the top and to soil vapor extraction the general well function can represent an extraction well with multiple screen intervals separated by blank casing and calculates the inflow distribution along the screens as part of the solution therefore it can be easily adapted for a recirculation well with an arbitrary arrangement of extraction and injection screens for a well in a confined aquifer the error of the uniform flux model decreases with the distance from the pumping well and is inversely proportional to the ratio of the screen length to its radius haitjema and kraemer 1988 cole and zlotnik 1994 cassiani and kabala 1998 tartakovsky et al 2000 zhan and zlotnik 2002 perina and lee 2006 showed that for unconfined and leaky aquifers the uniform flux model error increases with the length of the pumping well screen perina 2014 demonstrated that the flow allocation for a multi screen extraction well is in general not proportional to the screen lengths the distribution of radial influx along the screen varies with the screen s position s type of aquifer and time since the start of pumping for the majority of pumping tests conducted on single screen extraction wells observation wells are located far enough for the error of the uniform flux model to be negligible then the discretization approach used to solve the mixed boundary condition hayashi et al 1987 chang and chen 2003 perina and lee 2006 morozov 2021 allows the flexibility of changing the nonuniform flux model to the uniform flux model by simply assigning just one screen segment the computational effort reduces substantially for the uniform flux model most notably for an unconfined aquifer perina and lee 2006 at high flow rates frictional losses due to flow along the casing and across the screens result in non uniform drawdown distribution along screens for steady state flow the losses and resulting head distribution inside the well can be calculated following the approach of vonhofe and helweg 1998 although the resulting drawdown distribution could be assigned to the general well function in a two step approach it is not considered here frictional losses across the screen can however be simply added to the drawdown calculated within the wellbore perina 2014 2 aquifer types considered the general well function is applicable to four types of uniform horizontally infinite aquifers confined unconfined leaky and reservoir covered no flow is assumed across the bottom and the aquifer types differ only by the top boundary condition the unconfined aquifer includes instantaneous release of water from storage at the water table neuman 1972 the leaky aquifer includes drawdown dependent leakage across the top or bottom lee 1999 this is a more realistic representation of flow near the pumping well than the approximation of leakage by a volumetric production term hantush 1964 for a confined aquifer there is no flow across the top boundary the reservoir covered aquifer represents a saturated layer overlaid by a water reservoir so that the aquifer top is represented by a constant head boundary this boundary condition is applicable for soil vapor extraction from a vadose zone with no ground cover and the soil vapor extraction model is obtained from the general well function by a change of variables perina 2014 3 general well function for vertical recirculation well the recirculation well has at least two screens with one used to extract groundwater and the other to inject the extracted water in a general case there may be multiple extraction and injection screens arbitrarily arranged and positioned without overlapping between the aquifer top and bottom all extraction screens are assumed to be in hydraulic communication inside the well and so are all injection screens i e the screens are connected by piping and extraction screens are hydraulically isolated from injection screens the well has a finite radius of casing and is surrounded by a concentric shell of material that may have different hydraulic properties than the aquifer this shell may represent low permeability well skin or high permeability sand pack and over developed zone when the shell material is assigned the same properties as the aquifer the model reduces to a no skin model the well schematic is shown in fig 1 the derivation of the general well function perina and lee 2006 perina 2014 is summarized in appendix as shown in the appendix a minor modification of the general well function makes it applicable to a recirculation well the recirculation well is a special case of a multi screen pumping well 4 example simulations the example recirculation well problem described in tu et al 2020 is revisited the aquifer is 40 m thick the well extraction screen depth interval is 25 40 m and the injection screen interval is 0 15 m below the aquifer top the well has zero radius and is pumped at 60 m3 h the horizontal hydraulic conductivity of the aquifer is 0 1 m h vertical to horizontal anisotropy is 0 1 and specific storage is 2 5 10 6 m 1 tu et al 2020 used specific storage of 10 4 m 1 the observation location is a point at a radial distance r 5 m and depth z 25 m the general well function is defined for non zero screen radius for this simulation the radius was set to a low value of 0 01 m to approximate a well of infinitesimal screen radius for simulating the aquifer as unconfined the specific yield s y was set to 0 25 and for simulating a leaky aquifer the leakance coefficient c v was set to 10 2 h 1 comparison of drawdown in a confined aquifer calculated using uniform flux and nonuniform flux models fig 2 for the example in tu et al 2020 shows that the error in the drawdown calculated by the uniform flux model is about 0 5 m 6 4 at steady state the drawdown simulated by the uniform flux model can be recreated by superposition of extraction and injection wells calculated by a uniform flux model for this example the hantush 1961 solution in commercial software aqtesolv was used for the nonuniform flux model each screen interval was discretized into 10 segments the inflow distribution along the screen calculated by the nonuniform flux model has the highest inflow near the top of the extraction screen and the highest outflow near the bottom of the injection well screen fig 3 shows the distribution of flows q j into the screen segments j at steady state q j 0 fig 4 shows the difference in drawdown for different types of aquifers drawdown reaches steady state for all aquifer types the confined and reservoir covered aquifers reach steady state most rapidly while the drawdown in the unconfined aquifer reaches steady state after more than one year of operation the steady state drawdown in confined and unconfined aquifers is the same but the transient drawdown differs by over 1 5 m after several hours of operation for decreasing s y unconfined aquifer response approaches that of a confined aquifer leaky aquifer response approaches that of confined and reservoir covered aquifers for decreasing and increasing c v respectively this is because the confined and reservoir covered aquifers are special cases of the leaky boundary flux aquifer the response in the aquifer differs significantly with the observation point location fig 5 shows the responses in different types of aquifers at a point that is at the same distance but shallower depth z 15 m the drawdown is negative because the observation location is near the bottom of the injection screen the transient drawdown in confined and unconfined aquifers differs by more than 2 m steady state is reached at similar times as at the first observation location fig 3 the error in late time drawdown calculated by the uniform flux model at a point r 5 m z 15 m in a confined unconfined and leaky aquifer is about 6 7 and 4 respectively fig 6 drawdown distribution calculated over an r z cross section for the example from tu et al 2020 shows substantial differences for the four aquifer types fig 7 the difference between the nonuniform flux and uniform flux models on the cross sections appears relatively minor compared to the time drawdown curves fig 6 as a demonstration of an arbitrary screen arrangement fig 8 shows drawdown distribution and flow vectors near a hypothetical remediation recirculation well with one extraction screen and two injection screens arranged asymmetrically about the mid depth of a leaky aquifer the drawdown contours indicate greater gradients between the bottom of the extraction screen and top of the deep injection screen than between the bottom of the shallow injection screen and top of the extraction screen the flow vectors indicate that some of the injected water is lost across the leaky aquitard at the top the flow vectors also suggest almost complete re capture of the injected water within the zone r b the capture zone would change with the anisotropy ratio the extraction rate is constant at 60 m3 h and the model allocates the injection rate at 21 6 m3 h to the top screen and 38 4 m3 h to the bottom screen the distribution of radial fluxes along the screen intervals is irregular with highest flux magnitude near the screen ends except for the bottom of the deep injection screen positioned at the impermeable aquifer bottom fig 9 5 conclusions the general well function can be used to model a vertical recirculation well with arbitrary screen arrangement installed in a confined unconfined leaky or reservoir covered aquifer using an existing model eliminates the need to solve the governing partial differential equation specifically for this flow problem the simulated drawdown reaches steady state distribution for all four aquifer types for an unconfined aquifer steady state is reached after a long time of operation more than one year while for the other types of aquifer steady state is reached much earlier in less than an hour in the hypothetical example considered the drawdown distribution near a recirculation well varies with the type of aquifer and its properties the time drawdown curves also vary significantly depending on the location of the observation point in the aquifer these findings suggest that operation of a recirculation well may be treated as a field test for determining the aquifer type and for estimating aquifer properties by fitting transient and or steady drawdown recorded at observation wells the affected aquifer zone is smaller for a recirculation well than for a pumping well and this may be a limitation or benefit depending on the test objectives the representation of the aquifer well interface as a mixed boundary condition is important to avoid systematic errors in calculated drawdown near a recirculation well this work did not aim to find configurations of the well screen and observation locations where this error is the largest the effect of fitting the uniform flux or nonuniform flux model to drawdown observations on estimated aquifer properties should be evaluated in the future however it is important to note that aquifer heterogeneities would have far greater effect on the drawdown distribution in the aquifer and distribution of radial fluxes along the well screens than the chosen representation of the well boundary condition the dipole flow test kabala 1993 especially when observation wells are available offers an effective and economical alternative to pumping tests for characterization of aquifer hydraulic properties the main problem for the dipole flow test conducted on a long screen well instrumented with packers is the shortcutting of flow through the annular backfill material and possibly through an over developed zone in the aquifer kabala 1993 the general well function can simulate vertical flow through this zone as shown in the appendix frictional well losses may be added to the calculated in well drawdown for the dipole flow test declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments i wish to thank zbigniew j kabala duke university keith j halford u s geological survey and an anonymous reviewer for their thorough review and helpful comments water resources research rejected a draft of this paper without review in 2021 appendix derivation of general well function the following is a summary of the derivation of the solutions presented in perina and lee 2006 and perina 2014 with addition of the special case of a recirculation well separate solution for a confined aquifer multi screen observation well and more detailed frictional loss term a 1 boundary initial value problem consider an aquifer of thickness b hydraulic conductivity in the radial direction k r a and in the vertical direction k z a and specific storage s s a its properties k r a k z a s s a and b are uniform within the zone influenced by the pumping the pumping or test well has a finite diameter and partially penetrates the aquifer the aquifer well schematic for a well configured for recirculation operation is shown in fig 1 for pumping or injection the well may have multiple screens but is not instrumented with a packer and all screens are in hydraulic communication i e for extraction flow is into the well through all screens the test is conducted under the condition of either specified flowrate or specified drawdown instantaneously applied at the extraction well at time zero the term specified as used here implies that the quantity be known or measured it does not have to be constant in time or even controlled examples of specified flowrate pumping and specified drawdown pumping are a constant rate pumping test and an artesian flowing well respectively a finite thickness skin with properties k r s k z s and s s s extending from r w to r s r s r w is considered this concentric shell can represent any material with properties different from those of the aquifer such as low permeability skin or high permeability over developed zone superscripts a and s used to designate the properties of the aquifer and skin respectively are omitted in relations that hold for both regions the governing partial differential equation for density independent groundwater flow in the aquifer and skin is 1 k r 2 s r 2 1 r s r k z 2 s z 2 s s s t where s is the drawdown as a function of time t radial distance r and depth z the general well face boundary condition is 2 q π r c 2 s w t 2 π r w k r s z t z b s r d z at r r w where q is the pumping rate positive for extraction r w is the well screen radius r c is the well casing radius s w is the drawdown within the extraction well and z t and z b are depths to the top and bottom of the well screen respectively the z coordinate is downward positive it is convenient to re write the well face boundary condition 2 as 3 q 2 π r w k r s s s r at r r w where q is the yet unknown radial flux per unit screen length and satisfy the condition for wellbore storage by 4 q π r c 2 s w t z t z b q d z condition 4 applies to both flow controlled and drawdown controlled well prescribing a known function of time for example a constant for either q or s w in 4 changes the flow problem to specified flowrate or specified drawdown pumping respectively the groundwater flow region is divided into two zones in the radial direction r s r for flow in the aquifer and r w r r s for flow within the skin to impose continuity of drawdown and flux at the joint boundary at r s the drawdown in the aquifer s a and within the skin s s are related by interface conditions 5 s s s a at r r s and 6 k r s r s s k r a r s a at r r s the top boundary condition at z 0 differs depending on the type of aquifer for an unconfined aquifer with instantaneous release of water from storage neuman 1972 the top boundary condition is 7 k z s z s y s t for a leaky aquifer the top boundary condition changes to a drawdown dependent boundary flux condition lee 1999 8 k z a s z c v s where the vertical leakance 9 c v k c b c represents the leakage from a confining layer of thickness b c with vertical hydraulic conductivity k c mcdonald and harbaugh 1988 lee 1999 the solution by integral transforms requires that s y and c v be the same for both the aquifer and skin regions for a confined aquifer there is no flow across the top boundary 10 s z 0 for a reservoir covered aquifer the aquifer top is represented by a constant head boundary perina 2014 11 s 0 the confined and reservoir covered aquifers are special cases of the leaky aquifer with very low and very high c v respectively they can be represented by the leaky aquifer model but computation is faster for the integral transforms applicable to the special cases there is no flow across the bottom of the aquifer this condition may be changed to a constant head boundary or leaky boundary flux boundary as remarked later the pumping test problem is defined by the governing eq 1 subject to the initial condition of zero drawdown 12 s 0 at t 0 boundary conditions 13 s z 0 at z b 14 s a 0 as r the appropriate top boundary condition 7 to 11 well face condition 3 and wellbore storage condition 4 a 2 solution the boundary initial value problem 1 to 14 is solved using the laplace transform in t snedon 1951 and a finite fourier transform in z appropriate for the top boundary condition the finite fourier transform of the mixed boundary condition at the pumping well leads to fredholm integral equation that is solved for the unknown fluxes by discretization of the well screen interval the generalized finite fourier cosine transform churchill 1972 is applicable for an unconfined or leaky aquifer the finite fourier cosine transform churchill 1972 is applicable for a confined aquifer and the modified finite fourier sine transform churchill 1972 is applicable for a reservoir covered aquifer the finite cosine transforms are defined as 15 g n f g x 0 1 g x cos λ n x d x where the eigenvalues λ n n 0 1 2 3 for the generalized finite fourier cosine transform are the roots of 16 tan y a y with 17 a s y p b k z a for unconfined aquifer and 18 a c v b k z a for leaky aquifer and λ n n π for the finite fourier cosine transform the modified sine transform is defined as 19 g n f g x 0 1 g x sin λ n x d x where λ n 2 n 1 π 2 n 1 2 3 the inverse generalized finite fourier cosine transform is 20 g x f g n 2 a n 0 g n cos λ n x a sin 2 λ n the inverse cosine transform is 21 g x f g n g 0 2 n 1 g n cos n π x and the inverse modified sine transform is 22 g x f g n 2 n 1 g n sin λ n x churchill 1972 for the convenience of the finite transforms defined on the interval 0 η 1 introduce a dimensionless variable 23 η b z b for the generalized finite fourier cosine transform and 24 η z b for the finite fourier cosine and modified finite fourier sine transforms applying the appropriate integral transform and its operational properties churchill 1972 to 1 13 and the appropriate top boundary condition results in an ordinary modified bessel differential equation in r 25 2 s n r 2 1 r s n r k z b 2 λ n 2 k r s s p k r s n 0 where the n th term of the transform s n is a function of p and λ n solving eq 25 subject to 14 and transformed 5 and 6 yields 26 s n a c n k 0 ξ n a r and 27 s n s b n k 0 ξ n s r a n i 0 ξ n s r where 28 ξ n a λ n 2 k z a k r a s s a p k r a 29 ξ n s λ n 2 k z s k r s s s s p k r s 30 c n b n k 0 ξ n s r s k 0 ξ n a r s a n i 0 ξ n s r s k 0 ξ n a r s 31 a n b n g n 32 g n k r s ξ n s k 1 ξ n s r s k 0 ξ n a r s k r a ξ n a k 0 ξ n s r s k 1 ξ n a r s k r s ξ n s k 0 ξ n a r s i 1 ξ n s r s k r a ξ n a i 0 ξ n s r s k 1 ξ n a r s and i 0 k 0 i 1 and k 1 are the modified bessel functions of the first and second kinds and zeroth and first order coefficient b n is evaluated from laplace fourier transformed condition 3 for the cosine transforms it is written as 33 b n 0 1 q cos λ n η d η 2 π r w k r s ξ n s k 1 ξ n s r w g n i 1 ξ n s r w the cosine term in the numerator is replaced by sine for the modified sine transform eq 33 containing the unknown flux q under the integral is solved by discretizing the well screen interval into n segments of length δ η j that are sufficiently small such that q j representing the radial flux per unit screen length from the aquifer into the well segment j may be considered constant for each segment the segments may be of equal or unequal length for example shorter segments may be used near screen ends for higher resolution of q j then the integral in 33 can be replaced by the summation 34 b n 1 2 π r w k r s λ n ξ n s k 1 ξ n s r w g n i 1 ξ n s r w j 1 n q j sin λ n η j sin λ n η j where η j η j δ η j 2 η j η j δ η j 2 and δ η j η j η j a corresponding result is obtained for the modified sine transform now the appropriate inverse fourier transform is applied to 26 and 27 for example the inverse generalized finite fourier cosine transform applicable to unconfined or leaky aquifers is 35 s a 2 a n 0 b n k 0 ξ n s r s k 0 ξ n a r s g n i 0 ξ n s r s k 0 ξ n a r s k 0 ξ n a r cos λ n η a sin 2 λ n and 36 s s 2 a n 0 b n k 0 ξ n s r g n i 0 ξ n s r cos λ n η a sin 2 λ n eqs 35 and 36 still contain the unknown radial fluxes q j the solution for q j is subject to the condition that the average drawdown at r r w for every segment i is equal to s w 37 s w 1 δ η i η i η i s s d η at r r w substitution from 36 leads to 38 s w 2 a δ η i n 0 b n k 0 ξ n s r w g n i 0 ξ n s r w a sin 2 λ n sin λ n η i sin λ n η i λ n the extraction well screen may be interrupted by sections of blank casing the flow distribution among multiple screens subject to the condition of uniform drawdown inside the well is readily computed by including integrals for all screens in 37 and extending the system of eqs 38 the system of eqs 38 relates the unknown fluxes q j to the drawdown in the extraction well s w for all segments for a drawdown controlled well specified drawdown pumping 39 s w j 1 n q j ψ i j which written in matrix form is 40 ψ 1 1 ψ 1 2 ψ 1 n ψ 2 1 ψ 2 2 ψ 2 n ψ n 1 ψ n 2 ψ n n q 1 q 2 q n 1 1 1 s w where 41 ψ i j a π r w k r s δ η i n 0 k 0 ξ n s r w g n i 0 ξ n s r w ξ n s k 1 ξ n s r w g n i 1 ξ n s r w ψ i j a sin 2 λ n and 42 ψ i j sin λ n η j sin λ n η j sin λ n η i sin λ n η i λ n 2 to compute the drawdown in the aquifer during specified s w pumping eq 40 is solved for q j and the resulted fluxes are substituted into 35 the flowrate during specified drawdown pumping is computed from the laplace transform of the discretized form of 4 43 q α s w b j 1 n δ η j q j where 44 α π r c 2 p the term 44 may be modified to account for the radius r p of the discharge pipe 45 α π r c 2 r p 2 p the solution given by 40 and 43 is also applicable to a well with infinitesimal or zero casing diameter imposing condition 43 on 39 yields the system of equations for a flow controlled well specified flowrate pumping with non zero casing diameter 46 q j 1 n q j α ψ i j b δ η j in matrix form 47 b δ η 1 α ψ 1 1 b δ η 2 α ψ 1 2 b δ η n α ψ 1 n b δ η 1 α ψ 2 1 b δ η 2 α ψ 2 2 b δ η n α ψ 2 n b δ η 1 α ψ n 1 b δ η 2 α ψ n 2 b δ η n α ψ n n q 1 q 2 q n 1 1 1 q the drawdown in the aquifer is again computed using 35 and within the skin using 36 the drawdown within the pumping well is computed using 43 although the radius of casing is non zero for a physical well a solution for zero radius casing can be used to separate the wellbore storage effect or to compare the calculated drawdown with drawdown computed using existing line source solutions e g hantush 1964 neuman 1974 setting r c to zero in 44 requires that the system of eqs 47 be augmented by 43 to obtain 48 ψ 1 1 ψ 1 2 ψ 1 n 1 ψ 2 1 ψ 2 2 ψ 2 n 1 ψ n 1 ψ n 2 ψ n n 1 b δ η 1 b δ η 2 b δ η n α q 1 q 2 q n s w 0 0 q the drawdown in the pumping well is obtained as the last element of the vector of unknowns the drawdown in the aquifer is again computed using 35 and within the skin using 36 both q and h may have arbitrary time dependence subject to the limitations of the numerical inverse laplace transform used the most common aquifer test types are constant flowrate 49 q q c p where q c is the constant flowrate from the extraction well constant drawdown or flowing artesian well 50 s w s c p where s c is the constant drawdown applied at the extraction well and slug test 51 q π r c 2 s d where s d is the initial displacement linear superposition in time of 49 or 50 can be used for step wise representation of arbitrarily variable pumping injection and recovery a 3 drawdown in observation well drawdown in an observation well may be affected by wellbore storage and low permeability skin the drawdown s os in an observation well of casing radius r oc screen radius r ow skin radius r os and skin conductivity k os is derived from a difference approximation of flow across the skin zone 52 π r oc 2 s ow t 2 π k os r ow r os 2 z ob z ot s ow s os r os r ow and averaging aquifer drawdown between the top z ot and bottom z ob of the screen along the skin aquifer interface to get perina and lee 2006 53 s ow a 1 1 ζ ow π r oc 2 p η 2 ow η 1 ow η 1 ow η 2 ow s a d η where 54 ζ ow r os r ow π k os r ow r os z ob z ot this approach may be extended to an observation well with n s screen intervals separated by sections of blank casing the i th screen interval is z t o p i to z b o t i and their corresponding dimensionless depths are η 1 i to η 2 i then the wellbore condition becomes 55 π r oc 2 s ow t i 1 n s 2 π k os r ow r os 2 z b o t i z t o p i s ow s i r os r ow and the averaged laplace domain drawdown is 56 s ow k os i 1 n s z b o t i z t o p i s i r oc 2 p r os r ow r ow r os k os i 1 n s z b o t i z t o p i where 57 s i 1 η 2 i η 1 i η 1 i η 2 i s a d η the integrals in 53 and 56 only require integration of the cosine term in 35 and are evaluated in closed form not shown a 4 recirculation well the well operates at rate q positive for extraction negative for injection that may be time dependent there is no delay between extraction and injection so that the extraction and injection rates are equal at all times the model accounts for wellbore storage separately for the injection and extraction portions of the well the laplace transformed drawdown in the extraction screen s is s e and in the re injection screen s it is s r with s e 0 and s r 0 the system of eqs 39 relating the unknown fluxes to the drawdown in the well changes to 58 s i j 1 n q j ψ i j where the laplace space drawdown in the extraction screen s is s i s e and in the re injection screen s it is s i s r and q j are positive for extraction and negative for injection then 40 becomes 59 ψ 1 1 ψ 1 2 ψ 1 n ψ 2 1 ψ 2 2 ψ 2 n ψ n 1 ψ n 2 ψ n n q 1 q 2 q n s 1 s 2 s n because a recirculation well is flowrate controlled the system of equations must be augmented by imposing the flowrate constraint with a modification of 43 to define the conditions for extraction screens 60 q α s e b j e 1 n δ η j q j and re injection screens 61 q α s r b j r 1 n δ η j q j where the subscripts e and r imply that the summations are only carried over the extraction and re injection screen segments respectively the casing radius included in the term α to account for wellbore storage is taken to be the same for the extraction and injection screens but 60 and 61 can be easily modified to account for different casing radii and or discharge piping inside the well depending on the packer assembly open water level may not be present in either the extraction or injection chamber consequently the wellbore storage becomes a function of water compressibility as in the case of a shut in slug test butler 1998 and conditions 2 and 4 must be modified accordingly the augmented system of equations for the unknown q j s e and s r then becomes 62 ψ 1 1 ψ 1 2 ψ 1 n 0 1 ψ 2 1 ψ 2 2 ψ 2 n 0 1 ψ i 1 ψ i 2 ψ i j ψ i j 1 ψ i n 1 0 ψ i 1 1 ψ i 1 2 ψ i 1 j ψ i 1 j 1 ψ i 1 n 1 0 ψ n 1 ψ n 2 ψ n n 0 1 0 0 b δ η j b δ η j 1 0 α 0 b δ η 1 b δ η 2 0 0 b δ η n 0 α q 1 q 2 q i q i 1 q n s e s r 0 0 0 0 0 q q in the example eq 62 rows 1 2 and n are for re injection screen segments and rows i and i 1 are for extraction screen segments any configuration of extraction and re injection screens can be represented in 62 when the number of screen segments is specified as 1 for each screen the solution reduces to a uniform flux model however if there are more than one extraction and one injection screens 62 allocates flow to the screens as part of the solution even if each screen is represented by one segment with the radial fluxes computed by 62 the drawdown at a point in the aquifer and in an observation well is calculated using 35 and 53 respectively a 5 steady state eqs 62 40 and 47 apply to both transient in the laplace domain and steady state flow steady state conditions are obtained as lim p 0 p s and the terms containing the laplace variable p change as described in perina and lee 2006 and perina 2014 for confined and unconfined aquifers steady state is reached for a recirculation well only because steady state drawdown distribution for unconfined and confined aquifers is the same the general well function may be evaluated for a confined aquifer at a lower computational effort for a recirculation well operating at steady state in a confined aquifer the 0 th term of the inverse finite fourier cosine transform is zero a 6 fully penetrating well for a fully penetrating extraction well the well face boundary becomes specified drawdown first type boundary condition and the integral transform approach leads to a solution that does not require discretization perina and lee 2006 perina 2014 this case is obviously not applicable to a vertical recirculation well a 7 non zero flux bottom boundary condition the bottom boundary condition of zero flux may be changed to a constant head boundary or leaky boundary flux boundary if desired necessitating the use of a generalized integral transform in z ozisik 1989 for the leaky aquifer a simple change of the vertical coordinate results in leakage across the aquifer bottom instead of the top lee 1999 a 8 frictional well loss well loss is traditionally separated into linear components including aquifer loss i e drawdown and skin loss and nonlinear component of frictional loss kawecki 1995 both linear well losses are accounted for in 43 well loss s f due to friction for flow across the screen and flow along the screen casing inside the well does not affect drawdown in the aquifer and consequently does not have to be included in the well face boundary condition these conditions are not satisfied for high capacity pumping wells with large losses due to flow along the screen interval inside the well well loss s f during specified flowrate pumping can be added in the time domain as a flowrate only dependent component to the calculated drawdown in the extraction well on the other hand frictional well loss during specified drawdown pumping such as for a flowing artesian well varies over time with the flowrate and must be calculated separately wendland 2008 this time varying loss is subtracted from the drawdown measured at the wellhead to represent the drawdown at the well screen and its time dependence may be treated by superposition in time perina 2021 the frictional loss is 63 s f c c q 2 c s j 1 n b δ η j q j 2 where the first term represents losses due to flow along the casing inside the well the second term represents losses due to flow across the screen and c c and c s are friction coefficients the value of the exponent is taken here to be 2 based on the darcy weisbach formula the two frictional loss components are defined separately instead of being lumped into one term perina 2014 because the second term increases with time as wellbore storage effect diminishes the q j in 63 are the time domain fluxes calculated by numerical inverse laplace transform of 47 and q is the time variable or constant pumping rate a 9 soil vapor extraction with appropriate variable substitutions the model can represent soil vapor extraction and re injection in a vadose zone with leaky cover or no cover perina 2014 a 10 numerical evaluation the roots of 16 must be evaluated to high precision by a root finding technique with bracketing perina and lee 2006 the series in 35 36 and 41 converge oscillatorily to a final value the minimum required number of terms in the oscillatory series is determined through rewriting the terms using trigonometric identities and comparison of short and long wavelength components perina and lee 2006 perina 2014 the summation may then be terminated after a number of terms that represents a single cycle of the low frequency component the required number of summation terms is inversely proportional to the length of the shortest screen segment δ η j the results shown in figs 2 to 7 were computed using 53 summation terms and the results shown in figs 8 to 9 were computed using 160 summation terms the inverse laplace transform was evaluated by the stehfest 1970 method with 10 summation coefficients the stehfest 1970 method is applicable to laplace transforms of monotonic functions in time but it has been shown to be accurate for some non monotonic functions for example the response to a slug test in an observation well butler 1998 paradis and lefebvre 2013 was evaluated using the hyder et al 1994 model with the stehfest 1970 algorithm the well function of perina and lee 2006 produces the same result for a slug test as the hyder et al 1994 model other examples of non monotonic functions evaluated using the stehfest 1970 algorithm include calculation of groundwater velocity near a pumping well zlotnik et al 1997 radial flux near a pressurized borehole deturnay and cheng 1988 diffusion flux kuhlman 2013 mass transport in gas wojcik et al 2015 and fluid flow in a fractal reservoir zhao and zheng 2011 the comparison with a superposition of the time domain hantush 1961 solution in fig 2 serves as a check on the accuracy of the general well function for a recirculation well evaluated with the stehfest 1970 method the stehfest 1970 method however limits the allowable time dependency of the specified flowrate or specified drawdown to an instantaneous impulse constant linearly decreasing increasing or exponentially decreasing some of these limitations could be avoided by using the de hoog et al 1982 algorithm at the cost of increased execution time however arbitrarily variable flowrate or specified drawdown for a flowing well can be represented by superposition in time of constant or linearly varying mishra et al 2013 pumping steps the stehfest 1970 method also becomes inaccurate for well functions evaluated at very small times generally t 1 s and very large times generally t 100 y the computation time is the shortest for confined and reservoir covered aquifers longer for a leaky aquifer and the longest for an unconfined aquifer the difference arises from the need to evaluate the eigenvalues of the inverse fourier transform by a root finding technique for the leaky aquifer and by the necessity of repeating the root finding for every term of the numerical inverse laplace transform for the unconfined aquifer 
154,solubility trapping of carbon dioxide co 2 in deep saline aquifers is considered an effective mechanism of carbon storage the dissolution of co 2 in aquifer brine may result in gravitational instability which triggers convective mixing similar to the well known rayleigh bénard convection problem the process starts with the diffusion of co 2 into the brine followed by the onset of convection t c which may be followed by the constant flux regime f f c where f is the dissolution flux scaling t c and f c with characteristic measures such as rayleigh number as a measure of buoyancy to diffusive driving forces is important for the characterization of co 2 injection at a large scale previously natural complexities such as hydrodynamic dispersion permeability anisotropy and geochemical interactions have been neglected in the scaling relations of convective mixing this work explores the effects of such simplifications on the scaling relations of convective mixing using high resolution 2d numerical simulations our results provide new insights from revisiting the convective mixing scaling we show that the sherwood number sh depends on the domain height in the presence of the hydrodynamic dispersion in line with such findings we show that sh rayleigh scaling prefactor is directly related to longitudinal dispersivity α l moreover we show that increasing the permeability in each direction is beneficial for the process by decreasing convection onset time t c and increasing the dissolution flux f smaller permeability anisotropy ratio defined as the ratio of vertical to horizontal permeability k z k x results in earlier onset time and higher dissolution flux which scales with 0 54 and 0 21 compared to convection diffusion respectively finally our simulation results show that earlier t c and higher f are expected due to carbonate geochemical reactions the scaling relations of convective mixing in deep saline aquifers guide prioritization and selection of appropriate aquifers for geological co2 storage and designing efficient injection schemes keywords carbon storage convective mixing scaling relations dispersion permeability anisotropy geochemistry 1 introduction net zero target refers to achieving a balance between the amount of greenhouse gas emissions produced and the amount removed from the atmosphere this target aims to deliver the objectives of the paris agreement adopted by 196 parties at cop 21 in paris on 12 december 2015 rogelj et al 2016 extensive carbon capturing and geological storage ccs is one of the pathways to partially achieve the net zero target deep saline aquifers have the greatest importance as their available storage capacity is almost two orders of magnitude higher than depleted oil and gas reservoirs additionally they are more widely spread around the globe firoozabadi and myint 2010 celia 2017 godec et al 2011 orr 2009 zahasky and krevor 2020 nooraiepour et al 2018 erfani gahrooei and joonaki 2018 erfani et al 2020b for ccs co 2 is separated from emission sources and injected into geological formations careful selection of the storage sites is crucial for sustainable long term carbon sequestration ideally the aquifer pressure will be sufficient to keep co 2 at supercritical conditions sc in such conditions the scco 2 density and viscosity are around 260 760 kg m 3 and 0 02 0 06 cp respectively main co 2 trapping mechanisms during this process are structural trapping residual capillary trapping solubility trapping and mineralization emami meybodi et al 2015 de silva et al 2015 soltanian et al 2019 joekar niasar et al 2013 erfani et al 2020a fazeli et al 2019 an et al 2020 when scco 2 is injected into an aquifer it will eventually override the aquifer brine due to its lower density and viscosity until it reaches the impermeable caprock then co 2 will dissolve into the underneath brine resulting in an unstable configuration of a denser phase roughly 1 being on top of a less dense and miscible fluid i e known as rayleigh bénard instability getling 1998 such an instability promotes convective mixing which is beneficial for further solubility trapping of co2 emami meybodi et al 2015 beyond carbon storage convective mixing is relevant to a wide range of natural and industrial applications e g fluid mixing in the earth s mantle gurnis 1986 saltwater intrusion into coastal aquifers diersch 1988 anderson et al 1979 enhanced oil recovery james et al 2007 kahrobaei et al 2012 enhanced heat transfer li et al 2003 guo et al 1998 lister 1990 and chemical production wylock et al 2014 2017 the natural convection for ccs starts with the diffusion of co2 into the domain from the top boundary which creates a diffusive layer the convection becomes important once the diffusive layer is sufficiently thick so that the rayleigh ℛ number representing the ratio of buoyancy forces to the diffusive force exceeds a critical value tilton et al 2013 the time that this instability initiates t c is called the onset of instability after some time the instabilities become macroscopic with the formation of co 2 plumes which enhance the dissolution onset of convection therefore the rate of solute dissolution increases until it reaches a maximum then the process stabilizes in a constant flux dissolution regime after which the domain starts to become saturated and the dissolution flux declines in a convection shutdown regime slim 2014 erfani et al 2021 in fact the constant flux regime is only significant if the ℛ number is sufficiently high o ℛ 3 hassanzadeh et al 2007 emami meybodi and hassanzadeh 2013 neufeld et al 2010 pau et al 2010 dissolution flux f mol m 2 s 1 is the most practically significant measure of the convection process which can be defined as 1 f t 1 a d m tot d t where m tot stands for the total sequestered carbon in case of reactive transport simulations the summation of solubility and mineralogically trapped carbon a is the aquifer area perpendicular to the flow direction i e z direction and t is time fig 1 shows the time evolution of the dissolution flux for different ℛ numbers on which different events are marked for each simulation case moreover fig a 1 shows the effect of boundary concentration perturbation on co2 dissolution flux and the average domain concentration for three different ℛ numbers as mentioned a constant flux regime exists for high ℛ numbers and can be characterized by the sherwood sh number which is a dimensionless ratio of convective mass transfer rate to the diffusive mass transfer rate for the constant flux regime where f f c sh is defined as 2 s h h d ρ w ϕ δ c f c where h m is the domain height d m 2 s 1 is the diffusion coefficient ϕ is the domain porosity and δ c mol kg w 1 is the co2 concentration difference between the upper boundary co2 saturated water and the aquifer brine at the start of the simulation ρ w denotes the density of water kg m 3 most studies provided the scaling relations of convective mixing for ideal conditions and ignored the interplay of factors such as hydrodynamic dispersion permeability anisotropy and geochemistry and a systematic study on the impact of such complexities on a wide range of domain properties i e rayleigh numbers is still missing which is addressed in this study in this paper we aim to answer the following research questions to fill the existing gaps concerning scaling the convective mixing process 1 how does the hydrodynamic dispersion change the onset of convection and co 2 dissolution flux over a wide range of rayleigh numbers 2 how does the impact of permeability anisotropy change with the rayleigh number what is the exponent of permeability anisotropy ratio in the scaling relations over a wide range of domain permeability 3 what is the impact of typical carbonate geochemical interactions on the t c ℛ and s h ℛ scaling the manuscript is organized as follows in section 2 the simulation domain and the governing equations of reactive convective mixing will be presented then in section 3 the scaling relations and literature survey will be presented section 4 provides the simulation results and related discussions in the end a summary and concluding remarks will be provided 2 modelling 2 1 domain boundaries and assumptions full details of the governing equations assumptions and numerical scheme have been presented previously in erfani et al 2021 2020a here we briefly review the mathematical foundation of the model a 2d rectangular domain with the length of l m and height of h m was assumed to represent a confined isothermal aquifer saturated with brine aquifer brine was assumed to be in equilibrium condition with primary minerals at the aquifer temperature i e 80 sainz garcia et al 2017 hellevang et al 2013 all domain boundaries were assumed to be closed and additional assumptions are as follow the top co2 brine interface is assumed to be sharp and fixed with a constant co 2 concentration in the brine scco2 does not enter the simulation domain rather than the solute form dissolved in the brine the pressure change due to dissolution is neglected since the top boundary is assumed as an infinite source of co2 ennis king and paterson 2005 islam et al 2013 gaseous scco2 has no interaction with the rock gaus 2010 balashov et al 2013 homogeneous porosity across the aquifer was assumed permeability k field was assumed to be homogeneous but anisotropic k z k x the oberbeck boussinesq approximation including the density variation only in the buoyancy term spiegel and veronis 1960 valori et al 2017 and darcy s law were assumed valid and laminar flow was assumed landman and schotting 2007 sheremet et al 2015 erfani 2020 noteworthy we perturbed the co 2 concentration at the top boundary by a random noise of 0 5 for all simulation cases to initiate the instability the model adopted still represents a simplified form of a real geological formation e g 3d effects are not included although it has been shown the role of 3d motions is crucial in determining the dissolution rate pirozzoli et al 2021 fu et al 2013 dhar et al 2021 2 2 governing equations the governing equations of flow and species transport are a continuity equation 3 u 0 b darcy s law 4 u x k x μ p x u z k z μ p z ρ g where u u x u z m s 1 is the velocity vector x and z denote horizontal and vertical axis p is pressure ρ kg m 3 is density μ kg m 1 s 1 is viscosity and g m s 2 is the gravitational acceleration c reactive transport of chemical species 5 ϕ c i t u c i ϕ d c i s i reactions where c mol kg w 1 is solute concentration and s i denotes the sink source term of the species i due to the geochemical interactions the use of diffusion coefficient in the simulation of convective mixing is conventional while some researchers hidalgo and carrera 2009 chevalier et al 2015 tried to relax this assumption by including the hydrodynamic dispersion d m 2 s 1 is hydrodynamic dispersion tensor and is defined as 6 d d i j α t u δ i j α l α t u i u j u d i where α l m and α t m denote longitudinal and transversal dispersivities respectively δ i j is kronecker delta is the euclidean norm of a vector d m 2 s 1 is the effective molecular diffusion for the porous medium and i is the identity matrix the dispersion was implemented based on the finite difference formulation presented in zheng and wang 1999 d density change due to species concentration 7 ρ ρ 0 1 n 1 n s β i c i c 0 i where ρ 0 and c 0 are reference density and concentration n s denotes the total number of species and β i is defined as the coefficient of density change for species i as β i 1 ρ 0 ρ c i t c j i we defined a reference coefficient of density change β r with respect to carbon pseudo component and wrote eq 7 in its differential form 8 ρ x ρ 0 β r i 1 n p s β i β r c i x 2 3 dimensionless governing equations to take into account the aqueous phase density change and simplifying the governing equations we lump different species with the same component into pseudo components i e c mg c mg 2 c mgoh c mghco 3 the rayleigh ℛ number is also defined based on the diffusion coefficient and the coefficient of density change for the co 2 component at the top boundary as 9 ℛ δ ρ g k 0 h ϕ d μ δ ρ g k 0 h ϕ d r μ where k 0 is the domain vertical permeability d r is the reference i e in this work co 2 is chosen as the reference component diffusion coefficient horne 1979 has shown that introducing a vector potential of the form u ψ into the formulation results in a faster and more stable numerical solution for the problem it has also been shown aziz and hellums 1967 hirasaki and hellums 1968 that the velocity and potential are solenoidal incompressible flow so ψ 0 to derive a dimensionless form of the equations we define the permeability ratio as k z k x and aspect ratio as χ h l with other dimensionless variables defined as x x χ l z z h c c c 0 c r c 0 u x χ l u x ϕ d r u z h u z ϕ d r d d d r β β β c ψ ψ ϕ d r t d r t h 2 u ψ z ψ x then one can derive the following equations the details of the derivation can be found in erfani et al 2020a 2021 10a 2 ψ ℛ i 1 n ps β i δ c i δ c c c i x 10b c i t u c i d i c i s i reactions where u stands for the dimensionless velocity vector 2 4 geochemistry in this work geochemistry was modelled by coupling phreeqcrm charlton and parkhurst 2011 parkhurst and wissmeier 2015 with an in house developed advection dispersion transport simulator geochemical reactions were coupled with flow equations by a sequential non iterative approach snia charlton and parkhurst 2011 farajzadeh et al 2012 kanney et al 2003 carrayrou et al 2004 erfani et al 2020a 2019 an et al 2021 as the carbonate mineral reactions were fast compared to the flow the local equilibrium approach lea was followed for all geochemical reactions including solid and aqueous phase reactions the validity of lea assumption was examined by erfani et al 2021 for the same set of minerals and geochemical setup the considered primary minerals were calcite dolomite and gypsum as typical minerals in a carbonate aquifer moreover all aqueous phase interactions between different species were considered to represent a complementary modelling framework of rock fluid and fluid fluid interactions fu et al 2015 sainz garcia et al 2017 erfani et al 2020a ceriotti et al 2021 table a 2 summarizes all considered solid and aqueous phase reactions noteworthy the reaction equilibrium constants were taken from literature and temperature dependency was modelled by the analytical five term formulation or arrhenius equation in case the analytical coefficients were not available parkhurst and appelo 1999 blanc et al 2012 laidler 1984 based on the provided reactions 20 species as well as 6 pseudo components were defined in the model the geochemical equilibrium between primary minerals and brine was considered to initialize the simulations the porosity and permeability change due to geochemical interactions were previously shown not to be significant enough to change the hydrodynamics of the flow in this setup erfani et al 2021 3 scaling relations and literature survey the main function of scaling relations in the context of convection is relating behavioural characteristics of the process i e instability onset convection onset maximum flux and sherwood number to physical properties of the domain i e domain permeability concentration difference diffusion coefficient etc as an example the linear stability analysis suggests the following relation to scale the dimensional onset of instability t c ennis king and paterson 2005 11 t c a 1 μ ϕ d k δ ρ g 2 where a 1 is the coefficient for the onset of instability eq 11 can be applied to the convection onset with a larger prefactor i e a 2 compared to the onset of instability which is not only more practical but also easier to quantify note in this study we try to apply the scaling relation to the onset of convection not the onset of instability similar relations are proposed for scaling the sherwood sh number for different simulation cases as 12 s h c 1 k δ ρ g h d ϕ μ n 1 where c 1 and n 1 are the coefficient and exponent of the sherwood scaling by definition of the dimensionless time t and ℛ number the scaling relation of t c and sh can be rearranged as t c a 1 ℛ 2 and s h c 1 ℛ n 1 therefore the instability onset is independent of the domain height also the stabilized dissolution flux can be independent of the domain height in the case of linear scaling n 1 1 which gives eq 2 the coefficients a 1 a 2 and c 1 and the exponent n 1 can depend on the numerical scheme for simulating the convective mixing as well as the type and magnitude of the introduced perturbation to the boundary condition or domain properties another important factor in obtaining a 1 coefficient is the method of quantifying the onset of instability i e onset of instability and onset of convection table 1 summarizes the reported coefficients and exponents for the convection onset time and s h ℛ scaling relations in the literature by numerical simulation or experimental studies interestingly the range of the prefactors is wide i e 850 a 2 6155 if we exclude mahmoodpour et al 2019a study as it is noticeably higher than other studies we did not include linear stability analysis lsa studies as they are suitable to study the instability onset time and the associated wave number emami meybodi et al 2015 in the same way the coefficient c 1 ranges between 0 017 c 1 0 357 in most of the studies moreover some studies mostly experimental predicted sub linear i e n 1 1 relations for s h ℛ scaling while most of the studies maintained the linear relation meaning the independence of the dissolution flux in the constant flux regime to the domain height some remarks regarding these studies will be discussed in section 4 4 results and discussion in this section we provide the numerical simulation results for different simulation scenarios along with relevant discussions about relevant literature results first we discuss the base case which was considered as the non reactive isotropic case without longitudinal dispersion afterwards we present the effect of hydrodynamic dispersion then we study the effect of permeability anisotropy on simulation results and scaling relations the effect of carbonate geochemical interactions on scaling relations is subsequently studied lastly we provide the stability map for a typical aquifer as well as the amount of co2 dissolution flux based on the presented results and derived equations in earlier subsections 4 1 base case in this section the results of the base case non reactive non dispersive α l 0 with isotropic permeability 1 simulations and their scaling are presented fig 2 presents the time evolution of carbon pseudo component concentration in the simulation domain for ℛ 12 000 and fig 3 a presents the temporal change of the dissolution flux f for different ℛ numbers corresponding to different domain permeabilities ranging from 6 md to 1 6 d the mentioned regimes and events can be seen in the behaviour of the dissolution flux as discussed in section 1 see fig 1 notably the constant flux regime exists in the simulation cases with o ℛ 3 and it is more distinct in higher ℛ numbers fig 3 b shows that a 2 2540 has been resulted from the simulations to scale the convection onset time based on eq 11 the obtained coefficient is comparable to reported values by other researchers as mentioned in table 1 such as amooie et al 2018 even though the r 2 is very close to 1 the onset times slightly deviate from the fitted equation for high ℛ numbers this shows that eq 11 is valid for a narrower range of rayleigh numbers moreover the same observation was reported by the experimental work of rasmusson et al 2017 as their data were associated with high rayleigh numbers as well as a better fit to the data has been obtained from the simulations to scale t c 244 r a 1 734 we suggest using a 2 parameter power equation for scaling the convection onset time over a wide range of rayleigh numbers another interesting point is the dependence of the convection onset time to the perturbation as expected stronger perturbation of the boundary condition results in earlier onset time and consequently smaller a 2 prefactor compared to relying on the numerical errors for example ghesmat et al 2011b imposed 5 concentration perturbation on the upper boundary which resulted in a 2 850 in this study we have imposed a random perturbation of 0 5 to the boundary concentration for s h ℛ scaling we obtained c 1 0 014 and n 1 1 the simulation results show a linear dependence of the sherwood number in the constant flux region to the rayleigh number and the fitted line shows a good agreement with the data the obtained value falls in the range of other experimental and numerical studies moreover we have performed multi species simulations where the effect of all species on the density is considered so the different prefactor for sherwood rayleigh scaling can also be due to the multi species nature of the present simulations where each species has its own coefficient of density change β and diffusion coefficient d noteworthy the developed code was previously compared to slim 2014 for the single component case erfani et al 2021 it is worth mentioning that some of the reported numerical neufeld et al 2010 farajzadeh et al 2013 amooie et al 2018 and experimental backhaus et al 2011 tsai et al 2013 seyyedi et al 2014 nazari moghaddam et al 2015 wang et al 2016 studies of table 1 provided sub linear scaling relations for s h ℛ scaling in the linear s h ℛ scaling the dimensional constant flux is independent of the domain height as the constant flux regime occurs before the convective fingers reach the bottom of the domain we expect the system to behave like an infinite system the independence of sherwood number sh to domain height in the obtained scaling relation fig 3 b satisfies such independence which is based on the physics of the process unless the simulation experiment domain is not tall enough that the fingers interact with the bottom boundary before establishing the constant flux regime in the case of a co 2 water system the density is a linear function of the co 2 concentration while some experimental studies neufeld et al 2010 backhaus et al 2011 tsai et al 2013 wang et al 2016 used analogous fluids methanol and ethylene glycol known as meg and propylene glycol ppg with non monotonic density effects so the sublinear scaling of the mentioned experimental studies can be attributed to a different choice of fluid compared to simulations as well as the existing limitations in the experimental setup height jafari raad and hassanzadeh 2015 moreover in the experimental results provided by liyanage et al 2019 2020 the complexity of the experimental domain geometry choice of a bowl as the domain adds to the complexity of the obtained results even though they suggest a linear s h ℛ scaling recently de paoli et al 2020 performed free flow hele shaw experiments using an aqueous solution of potassium permanganate kmno 4 to eliminate the non monotonic density change profile they varied the width of the cell to study the limitations of such experiments and the validity of the darcy s law they showed that the width of the hele shaw cell should be small enough for the darcy s law to be valid and hence linear sherwood rayleigh scaling to work they concluded that in large rayleigh numbers and large cell widths non darcy flow and dispersion effects can result in non linear sherwood rayleigh scaling relations 4 2 effect of dispersion on scaling relations in this section we study the effects of hydrodynamic dispersion on the scaling of convective mixing in porous media many studies have investigated the effects of dispersion on this process while none of them quantified the effect of dispersion on the scaling relations hidalgo and carrera 2009 chevalier et al 2015 xie et al 2011 ghesmat et al 2011a wen et al 2018 liang et al 2018 dhar et al 2021 letelier et al 2019 hidalgo and carrera 2009 focused on the effect of hydrodynamic dispersion on the convection onset while they only studied two ℛ numbers of 1000 and 2000 they showed that the increase of longitudinal dispersivity α l decreases the convection onset time linearly ghesmat et al 2011a studied the dynamics of the process at 500 ℛ 2000 and concluded that the existence of dispersion destabilizes the diffusive boundary layer and stimulates the convection onset and the dissolution flux wen et al 2018 described the interplay between molecular diffusion and mechanical dispersion over a wide range of ℛ and hydrodynamic dispersion coefficients they stated that in low ℛ numbers the molecular diffusion is the controlling parameter while at high dispersivities and high rayleigh numbers the impact of mechanical dispersion is more important they mentioned the validity of the existing scaling equations in the presence of hydrodynamic dispersion while they did not provide the prefactors although they provided an equation to calculate the dissolution flux with the assumption of ℛ h α l as f 0 46 h α l 0 74 0 08 h α l 0 51 ℛ to study the effect of hydrodynamic dispersion on existing scaling relations of the convective mixing we performed simulations with 12 k 400 md corresponding to 750 ℛ 24 000 with four different longitudinal dispersivities of α l 0 1 1 5 and 10 m the choice of different longitudinal dispersivities is due to the wide range of observations in different scales see fig a 2 fig 4 shows the dissolution fluxes for different simulation cases erfani et al 2021 discussed the phenomenological change of the flow and finger propagation due to the existence of hydrodynamic dispersion in line with the findings of other researchers the existence of hydrodynamic dispersion in the model enhances the co2 dissolution and results in earlier convection onset as well moreover the impact of dispersion is more pronounced in higher ℛ numbers in high ℛ numbers and longitudinal dispersivities α l h 0 1 the finger propagation patterns and interaction are changed substantially so the dissolution flux shows a different behaviour and the constant flux regime is no longer visible same pattern behaviour was observed by ghesmat et al 2011a and wen et al 2018 as well in such condition a distinctive characteristic of the dissolution flux is the maximum dissolution flux f m a x and corresponding sh m a x which can be scaled with eq 12 with rayleigh number emami meybodi et al 2015 hassanzadeh et al 2007 fig 5 presents the dimensionless convection onset time t c and maximum sherwood number sh m a x for different ℛ numbers at different α l noteworthy the accuracy of the presented scaling equations decreases with the increase of the longitudinal dispersivity for example in the case of sh m a x the simulation cases with α l h 5 1 0 2 and 10 1 exhibit a slightly superlinear behaviour especially in high ℛ numbers and the best fit can be obtained by s h m a x 0 01 r a 1 17 and sh m a x 0 019 r a 1 135 respectively a similar phenomenon was observed experimentally by liang et al 2018 in packed hele shaw experiments moreover de paoli et al 2020 experimentally showed that the existence of hydrodynamic dispersion results in the deviation of sherwood rayleigh scaling from the linear behaviour 4 3 effect of permeability anisotropy on scaling relations in geological formations heterogeneity exists in all length scales from pore to aquifer scale such heterogeneity can have significant impacts on convective mixing especially when its scale is comparable to convection length scales i e layer thickness and plume dimensions emami meybodi et al 2015 it is obvious from the scaling relations of convection onset time eq 11 and s h ℛ eq 12 that the spatial variations of properties like permeability porosity and effective diffusion coefficient will change the characteristics of the natural convection process in geological formations permeability usually varies up to orders of magnitude while the changes of porosity and effective diffusion coefficient are less therefore permeability is usually used to introduce heterogeneity in studies of fluid flow a simplified method of representing a layered formation is to model it using a homogeneous but anisotropic k z k x permeability field in such an approach the permeability ratio is usually defined as k z k x 1 which is due to the layered nature of natural formations i e k x k z it was previously showed in the literature ennis king et al 2005 ennis king and paterson 2005 xu et al 2006 cheng et al 2012 green and ennis king 2014 2018 de paoli et al 2017 2016 that if one of the permeabilities is used in natural scales k z in this study then the scaling relations can be rewritten as 13 t c a μ ϕ d k z δ ρ g 2 s h c k z δ ρ g h d ϕ μ and in dimensionless form t c a ℛ 2 and s h c ℛ table 2 presents the reported scaling relations in the literature considering the permeability anisotropy effect in summary all of the studies suggest earlier onset and higher dissolution flux for lower anisotropy ratio while keeping the rayleigh number constant i e keeping k z constant and increasing k x ennis king et al 2005 studied the effect of anisotropy on the onset of instability using linear and global stability analysis they showed that a decrease in by keeping the horizontal permeability constant and decreasing the vertical permeability results in stabilizing the process and hinders the onset of instability note that the correlation length of horizontal permeability is larger than that of vertical permeability thus keeping the horizontal permeability constant is more in agreement with the geological setting similar conclusions were made by other researchers as well hong and kim 2008 xu et al 2006 ennis king and paterson 2005 rapaka et al 2009 cheng et al 2012 xu et al 2006 studied both cases of increasing vertical permeability and increasing horizontal permeability while keeping the other one constant they concluded that increasing permeability in either direction destabilizes the solute interface and results in earlier instability onset time they concluded that irrespective of the manner of changing the power law dependency of critical onset time to anisotropy ratio can be concluded refer to table 2 unlike the presented results by ennis king et al 2005 ennis king and paterson 2005 xu et al 2006 and cheng et al 2012 for the dependency of critical onset time on anisotropy ratio which are in a very good agreement with each other the provided results by chen et al 2013 and green and ennis king 2014 present different dependency of onset time on i e 0 09 and 0 4 and higher prefactor in the case of green and ennis king 2014 a 2 3081 0 4 the observed difference can be due to different numerical schemes as both of these studies used direct numerical simulation and as discussed earlier the observed onset of convection occurs much later than the onset of instability the results of direct numerical simulation green and ennis king 2014 2018 de paoli et al 2016 2017 cheng et al 2012 further showed higher dissolution flux in the steady flux regime for lower anisotropy ratio obtained by increasing the horizontal permeability while keeping the vertical permeability constant fig 6 shows the temporal behaviour of carbon dissolution flux and average dimensionless concentration versus dimensionless time in these simulations the vertical permeability k z was kept constant and the permeability ratio was lowered by increasing the horizontal permeability k x the simulation results show that increasing horizontal permeability i e lowering the permeability ratio results in earlier onset of convection and higher dissolution flux in the constant flux regime fig 6 a consequently the simulations with lower permeability ratio exhibit higher average carbon concentration in the simulation domain fig 6 b fig 7 shows the temporal evolution of carbon pseudo component concentration in the simulation domain for domain vertical permeability of k z 200 md corresponding to ℛ 12 000 for three different anisotropy ratios of 0 75 0 2 and 0 1 fig 8 shows the obtained simulation results for the ratio of the onset time and dissolution flux for the cases with different anisotropy ratios and domain vertical permeability k z compared to the base case simulations presented in section 4 1 the simulation results show that increasing the permeability in each direction is beneficial for the process i e resulting in earlier onset time and higher co2 dissolution flux decreasing the anisotropy ratio for a constant vertical permeability i e increasing horizontal permeability results in earlier onset of convection and higher dissolution flux which is in line with the presented literature results of table 2 fig 8 a shows that decreasing the anisotropy ratio decreases the convection onset time with the rate of 0 54 even though we have performed our simulation over a wider range of rayleigh numbers this is in the range of the obtained coefficients by other researchers xu et al 2006 cheng et al 2012 green and ennis king 2014 conversely fig 8 b shows a lower dependency of dissolution flux f on anisotropy ratio 0 21 compared to the results presented by green and ennis king 2014 2018 and de paoli et al 2017 noteworthy they have performed simulations on a single rayleigh number ℛ 20 000 7000 and 5000 respectively which was lower compared to our range of rayleigh numbers moreover fig 8 b shows a higher impact of permeability anisotropy on the simulation results in lower rayleigh numbers another approach for scaling the convection onset time and sherwood number for anisotropic simulations are using eqs 11 and 12 with an effective permeability for the domain defined based on the horizontal k x and vertical k z permeabilities the same approach was followed by green and ennis king 2014 where they used k z k x as the effective permeability of the domain following the same idea we can define a modified rayleigh number as ℛ to scale the convection onset time and the sherwood number fig 9 provides the results of such approach based on which we can conclude that in anisotropic simulations the sherwood number fairly scales linearly with the modified rayleigh number sh max 0 0217 ℛ while in the case of convection onset time t c the exponent of the obtained scaling relation with the modified rayleigh number is not equal to 2 see fig 9 a so we suggest t c 2540 0 54 ℛ 2 to for scaling the convection onset time 4 4 geochemical reactions and practical implications the effects of geochemical reactions on the dynamics of the convection process and involving mechanisms were discussed earlier in erfani et al 2021 as the co2 enters the domain through diffusion it increases the aquifer brine ph and disturbs the geochemical equilibrium and triggers rock fluid and fluid fluid reactions the rock dissolution is the dominant mechanism in reactive co2 convection in carbonate aquifers while such a mechanism decreases the amount of stored carbon in the diffusion dominant regime it stimulates the convection onset time and the amount of the total flux after the onset time it was shown that the calcium and dolomite dissolution from the rock into the brine and gypsum precipitation are the main mechanisms which result in rock mineralogical changes in short the geochemical reactions result in earlier convection onset time and a higher carbon dissolution rate for detailed discussions of the effects of geochemical interactions on co2 convective mixing in carbonate aquifers the readers are referred to erfani et al 2021 and sainz garcia et al 2017 to revisit the scaling equation of convection onset time eq 11 and sherwood number in the steady flux regime eq 12 we performed multicomponent reactive convection diffusion numerical simulation at different rayleigh numbers fig 10 presents the obtained convection onset time and steady state sherwood number at different rayleigh numbers and the fitted scaling equations the scaling equations of t c 2197 ℛ 2 and s h 0 0164 ℛ were obtained in a good agreement with the simulation data compared to the obtained scaling equations in section 4 1 the a 2 and c 1 prefactors were changed the a 2 is higher for the case of reactive simulations conversely the obtained c 1 prefactor is increased due to geochemical interactions and enhanced convective mixing in the convection dominant regime then we study the convection onset time t c and carbon dissolution flux f for a typical carbonate aquifer we assume that the aquifer height is equal to 100 m porosity is equal to ϕ 0 15 the temperature is 80 c and we assume the longitudinal dispersivity of α l 5 m i e α l h 0 05 and k x 2k z i e 0 5 in such conditions based on the results and discussions provided the scaling equations in dimensionless and dimensional forms read as 14a t c 781 8 ℛ 2 s h 0 032 ℛ 14b t c 781 8 μ ϕ d k z δ ρ g 2 f c 0 032 δ c k z δ ρ g μ fig 11 shows the stability map for the aquifer with mentioned characteristics versus domain vertical permeability and co 2 solubility typical co 2 density versus pressure and co 2 solubility versus temperature and brine salinity are shown in figs a 3 and a 4 respectively the details of all numerical simulations are presented in table a 1 5 summary and conclusions this study presented high resolution 2d numerical simulations of multicomponent reactive density driven co 2 mixing in deep saline aquifers to obtain scaling relations for the onset of convection and the sherwood number the hydrodynamic dispersion permeability anisotropy and a complex set of carbonate geochemical reactions over a wide range of rayleigh numbers ℛ were considered in the scaling relations which to our best knowledge have not been studied all together in former studies following conclusions can be drawn based on the simulation results in multicomponent convection diffusion simulations it was shown that a constant flux regime exists for o ℛ 3 which is more distinct in higher ℛ numbers moreover the dimensionless convection onset time t c and sherwood number sh scale with the equations of t c 2540 ℛ 2 and s h 0 014 ℛ for the range of 350 ℛ 100 000 respectively in such conditions the dimensional onset time and the dissolution flux f are independent of the domain height if the domain is large enough the resulted scaling equations and conclusion made were in line with the findings of other researchers hydrodynamic dispersion decreased the convection onset time and increased the dissolution flux the effect of dispersion on the process dynamics was discussed in detail by erfani et al 2021 in short in high ℛ numbers and longitudinal dispersivities α l h 0 1 the finger propagation patterns and interactions were changed substantially so the dissolution flux showed a different behaviour and the constant flux regime was no longer visible additionally we showed that in the case of α l h 5 1 0 2 and 10 1 the sherwood rayleigh scaling showed superlinear behaviour especially in high ℛ numbers for these cases the best fit can be obtained by sh m a x 0 01 ℛ 1 17 and sh m a x 0 019 ℛ 1 135 respectively which shows the dependence of dissolution flux to the domain height the higher the permeability in either vertical or horizontal directions is the earlier convection onset time and higher dissolution flux will be to study the effect of permeability anisotropy k z k x 1 we performed simulations with constant vertical permeability while increasing the horizontal permeability to obtain different anisotropy ratios 0 1 1 we showed that the convection onset time t c and dissolution flux f scale with t c t c 1 0 54 and f f 1 0 21 respectively notably the presented results showed that the effect of the anisotropy ratio on dissolution flux is more significant in lower rayleigh numbers which can be the reason behind higher dependencies obtained by other researchers i e 0 5 scaling between the convection onset time and sherwood number by a modified rayleigh number based on the effective permeability of the domain ℛ showed fairly an accurate linear relation sh max 0 0217 ℛ while the dimensionless onset time scaled with the exponent of 1 766 t c 437 37 ℛ 1 766 instead of 2 for the case of geochemical reactions similar scaling relations with different prefactors are expected for the reactive simulations the convection onset time and sherwood number scale with rayleigh number as t c 2197 ℛ 2 and s h 0 016 ℛ respectively credit authorship contribution statement hamidreza erfani investigation methodology software data curation writing original draft masoud babaei investigation methodology writing review editing carl fredrik berg writing review editing vahid niasar supervision conceptualization methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to acknowledge the university of manchester for providing the phd funding for hamidreza erfani through the president s doctoral scholarship pds award this study was partially funded by the research council of norway centers of excellence funding scheme project number 262644 porelab appendix see tables a 1 and a 2 and figs a 1 a 4 
154,solubility trapping of carbon dioxide co 2 in deep saline aquifers is considered an effective mechanism of carbon storage the dissolution of co 2 in aquifer brine may result in gravitational instability which triggers convective mixing similar to the well known rayleigh bénard convection problem the process starts with the diffusion of co 2 into the brine followed by the onset of convection t c which may be followed by the constant flux regime f f c where f is the dissolution flux scaling t c and f c with characteristic measures such as rayleigh number as a measure of buoyancy to diffusive driving forces is important for the characterization of co 2 injection at a large scale previously natural complexities such as hydrodynamic dispersion permeability anisotropy and geochemical interactions have been neglected in the scaling relations of convective mixing this work explores the effects of such simplifications on the scaling relations of convective mixing using high resolution 2d numerical simulations our results provide new insights from revisiting the convective mixing scaling we show that the sherwood number sh depends on the domain height in the presence of the hydrodynamic dispersion in line with such findings we show that sh rayleigh scaling prefactor is directly related to longitudinal dispersivity α l moreover we show that increasing the permeability in each direction is beneficial for the process by decreasing convection onset time t c and increasing the dissolution flux f smaller permeability anisotropy ratio defined as the ratio of vertical to horizontal permeability k z k x results in earlier onset time and higher dissolution flux which scales with 0 54 and 0 21 compared to convection diffusion respectively finally our simulation results show that earlier t c and higher f are expected due to carbonate geochemical reactions the scaling relations of convective mixing in deep saline aquifers guide prioritization and selection of appropriate aquifers for geological co2 storage and designing efficient injection schemes keywords carbon storage convective mixing scaling relations dispersion permeability anisotropy geochemistry 1 introduction net zero target refers to achieving a balance between the amount of greenhouse gas emissions produced and the amount removed from the atmosphere this target aims to deliver the objectives of the paris agreement adopted by 196 parties at cop 21 in paris on 12 december 2015 rogelj et al 2016 extensive carbon capturing and geological storage ccs is one of the pathways to partially achieve the net zero target deep saline aquifers have the greatest importance as their available storage capacity is almost two orders of magnitude higher than depleted oil and gas reservoirs additionally they are more widely spread around the globe firoozabadi and myint 2010 celia 2017 godec et al 2011 orr 2009 zahasky and krevor 2020 nooraiepour et al 2018 erfani gahrooei and joonaki 2018 erfani et al 2020b for ccs co 2 is separated from emission sources and injected into geological formations careful selection of the storage sites is crucial for sustainable long term carbon sequestration ideally the aquifer pressure will be sufficient to keep co 2 at supercritical conditions sc in such conditions the scco 2 density and viscosity are around 260 760 kg m 3 and 0 02 0 06 cp respectively main co 2 trapping mechanisms during this process are structural trapping residual capillary trapping solubility trapping and mineralization emami meybodi et al 2015 de silva et al 2015 soltanian et al 2019 joekar niasar et al 2013 erfani et al 2020a fazeli et al 2019 an et al 2020 when scco 2 is injected into an aquifer it will eventually override the aquifer brine due to its lower density and viscosity until it reaches the impermeable caprock then co 2 will dissolve into the underneath brine resulting in an unstable configuration of a denser phase roughly 1 being on top of a less dense and miscible fluid i e known as rayleigh bénard instability getling 1998 such an instability promotes convective mixing which is beneficial for further solubility trapping of co2 emami meybodi et al 2015 beyond carbon storage convective mixing is relevant to a wide range of natural and industrial applications e g fluid mixing in the earth s mantle gurnis 1986 saltwater intrusion into coastal aquifers diersch 1988 anderson et al 1979 enhanced oil recovery james et al 2007 kahrobaei et al 2012 enhanced heat transfer li et al 2003 guo et al 1998 lister 1990 and chemical production wylock et al 2014 2017 the natural convection for ccs starts with the diffusion of co2 into the domain from the top boundary which creates a diffusive layer the convection becomes important once the diffusive layer is sufficiently thick so that the rayleigh ℛ number representing the ratio of buoyancy forces to the diffusive force exceeds a critical value tilton et al 2013 the time that this instability initiates t c is called the onset of instability after some time the instabilities become macroscopic with the formation of co 2 plumes which enhance the dissolution onset of convection therefore the rate of solute dissolution increases until it reaches a maximum then the process stabilizes in a constant flux dissolution regime after which the domain starts to become saturated and the dissolution flux declines in a convection shutdown regime slim 2014 erfani et al 2021 in fact the constant flux regime is only significant if the ℛ number is sufficiently high o ℛ 3 hassanzadeh et al 2007 emami meybodi and hassanzadeh 2013 neufeld et al 2010 pau et al 2010 dissolution flux f mol m 2 s 1 is the most practically significant measure of the convection process which can be defined as 1 f t 1 a d m tot d t where m tot stands for the total sequestered carbon in case of reactive transport simulations the summation of solubility and mineralogically trapped carbon a is the aquifer area perpendicular to the flow direction i e z direction and t is time fig 1 shows the time evolution of the dissolution flux for different ℛ numbers on which different events are marked for each simulation case moreover fig a 1 shows the effect of boundary concentration perturbation on co2 dissolution flux and the average domain concentration for three different ℛ numbers as mentioned a constant flux regime exists for high ℛ numbers and can be characterized by the sherwood sh number which is a dimensionless ratio of convective mass transfer rate to the diffusive mass transfer rate for the constant flux regime where f f c sh is defined as 2 s h h d ρ w ϕ δ c f c where h m is the domain height d m 2 s 1 is the diffusion coefficient ϕ is the domain porosity and δ c mol kg w 1 is the co2 concentration difference between the upper boundary co2 saturated water and the aquifer brine at the start of the simulation ρ w denotes the density of water kg m 3 most studies provided the scaling relations of convective mixing for ideal conditions and ignored the interplay of factors such as hydrodynamic dispersion permeability anisotropy and geochemistry and a systematic study on the impact of such complexities on a wide range of domain properties i e rayleigh numbers is still missing which is addressed in this study in this paper we aim to answer the following research questions to fill the existing gaps concerning scaling the convective mixing process 1 how does the hydrodynamic dispersion change the onset of convection and co 2 dissolution flux over a wide range of rayleigh numbers 2 how does the impact of permeability anisotropy change with the rayleigh number what is the exponent of permeability anisotropy ratio in the scaling relations over a wide range of domain permeability 3 what is the impact of typical carbonate geochemical interactions on the t c ℛ and s h ℛ scaling the manuscript is organized as follows in section 2 the simulation domain and the governing equations of reactive convective mixing will be presented then in section 3 the scaling relations and literature survey will be presented section 4 provides the simulation results and related discussions in the end a summary and concluding remarks will be provided 2 modelling 2 1 domain boundaries and assumptions full details of the governing equations assumptions and numerical scheme have been presented previously in erfani et al 2021 2020a here we briefly review the mathematical foundation of the model a 2d rectangular domain with the length of l m and height of h m was assumed to represent a confined isothermal aquifer saturated with brine aquifer brine was assumed to be in equilibrium condition with primary minerals at the aquifer temperature i e 80 sainz garcia et al 2017 hellevang et al 2013 all domain boundaries were assumed to be closed and additional assumptions are as follow the top co2 brine interface is assumed to be sharp and fixed with a constant co 2 concentration in the brine scco2 does not enter the simulation domain rather than the solute form dissolved in the brine the pressure change due to dissolution is neglected since the top boundary is assumed as an infinite source of co2 ennis king and paterson 2005 islam et al 2013 gaseous scco2 has no interaction with the rock gaus 2010 balashov et al 2013 homogeneous porosity across the aquifer was assumed permeability k field was assumed to be homogeneous but anisotropic k z k x the oberbeck boussinesq approximation including the density variation only in the buoyancy term spiegel and veronis 1960 valori et al 2017 and darcy s law were assumed valid and laminar flow was assumed landman and schotting 2007 sheremet et al 2015 erfani 2020 noteworthy we perturbed the co 2 concentration at the top boundary by a random noise of 0 5 for all simulation cases to initiate the instability the model adopted still represents a simplified form of a real geological formation e g 3d effects are not included although it has been shown the role of 3d motions is crucial in determining the dissolution rate pirozzoli et al 2021 fu et al 2013 dhar et al 2021 2 2 governing equations the governing equations of flow and species transport are a continuity equation 3 u 0 b darcy s law 4 u x k x μ p x u z k z μ p z ρ g where u u x u z m s 1 is the velocity vector x and z denote horizontal and vertical axis p is pressure ρ kg m 3 is density μ kg m 1 s 1 is viscosity and g m s 2 is the gravitational acceleration c reactive transport of chemical species 5 ϕ c i t u c i ϕ d c i s i reactions where c mol kg w 1 is solute concentration and s i denotes the sink source term of the species i due to the geochemical interactions the use of diffusion coefficient in the simulation of convective mixing is conventional while some researchers hidalgo and carrera 2009 chevalier et al 2015 tried to relax this assumption by including the hydrodynamic dispersion d m 2 s 1 is hydrodynamic dispersion tensor and is defined as 6 d d i j α t u δ i j α l α t u i u j u d i where α l m and α t m denote longitudinal and transversal dispersivities respectively δ i j is kronecker delta is the euclidean norm of a vector d m 2 s 1 is the effective molecular diffusion for the porous medium and i is the identity matrix the dispersion was implemented based on the finite difference formulation presented in zheng and wang 1999 d density change due to species concentration 7 ρ ρ 0 1 n 1 n s β i c i c 0 i where ρ 0 and c 0 are reference density and concentration n s denotes the total number of species and β i is defined as the coefficient of density change for species i as β i 1 ρ 0 ρ c i t c j i we defined a reference coefficient of density change β r with respect to carbon pseudo component and wrote eq 7 in its differential form 8 ρ x ρ 0 β r i 1 n p s β i β r c i x 2 3 dimensionless governing equations to take into account the aqueous phase density change and simplifying the governing equations we lump different species with the same component into pseudo components i e c mg c mg 2 c mgoh c mghco 3 the rayleigh ℛ number is also defined based on the diffusion coefficient and the coefficient of density change for the co 2 component at the top boundary as 9 ℛ δ ρ g k 0 h ϕ d μ δ ρ g k 0 h ϕ d r μ where k 0 is the domain vertical permeability d r is the reference i e in this work co 2 is chosen as the reference component diffusion coefficient horne 1979 has shown that introducing a vector potential of the form u ψ into the formulation results in a faster and more stable numerical solution for the problem it has also been shown aziz and hellums 1967 hirasaki and hellums 1968 that the velocity and potential are solenoidal incompressible flow so ψ 0 to derive a dimensionless form of the equations we define the permeability ratio as k z k x and aspect ratio as χ h l with other dimensionless variables defined as x x χ l z z h c c c 0 c r c 0 u x χ l u x ϕ d r u z h u z ϕ d r d d d r β β β c ψ ψ ϕ d r t d r t h 2 u ψ z ψ x then one can derive the following equations the details of the derivation can be found in erfani et al 2020a 2021 10a 2 ψ ℛ i 1 n ps β i δ c i δ c c c i x 10b c i t u c i d i c i s i reactions where u stands for the dimensionless velocity vector 2 4 geochemistry in this work geochemistry was modelled by coupling phreeqcrm charlton and parkhurst 2011 parkhurst and wissmeier 2015 with an in house developed advection dispersion transport simulator geochemical reactions were coupled with flow equations by a sequential non iterative approach snia charlton and parkhurst 2011 farajzadeh et al 2012 kanney et al 2003 carrayrou et al 2004 erfani et al 2020a 2019 an et al 2021 as the carbonate mineral reactions were fast compared to the flow the local equilibrium approach lea was followed for all geochemical reactions including solid and aqueous phase reactions the validity of lea assumption was examined by erfani et al 2021 for the same set of minerals and geochemical setup the considered primary minerals were calcite dolomite and gypsum as typical minerals in a carbonate aquifer moreover all aqueous phase interactions between different species were considered to represent a complementary modelling framework of rock fluid and fluid fluid interactions fu et al 2015 sainz garcia et al 2017 erfani et al 2020a ceriotti et al 2021 table a 2 summarizes all considered solid and aqueous phase reactions noteworthy the reaction equilibrium constants were taken from literature and temperature dependency was modelled by the analytical five term formulation or arrhenius equation in case the analytical coefficients were not available parkhurst and appelo 1999 blanc et al 2012 laidler 1984 based on the provided reactions 20 species as well as 6 pseudo components were defined in the model the geochemical equilibrium between primary minerals and brine was considered to initialize the simulations the porosity and permeability change due to geochemical interactions were previously shown not to be significant enough to change the hydrodynamics of the flow in this setup erfani et al 2021 3 scaling relations and literature survey the main function of scaling relations in the context of convection is relating behavioural characteristics of the process i e instability onset convection onset maximum flux and sherwood number to physical properties of the domain i e domain permeability concentration difference diffusion coefficient etc as an example the linear stability analysis suggests the following relation to scale the dimensional onset of instability t c ennis king and paterson 2005 11 t c a 1 μ ϕ d k δ ρ g 2 where a 1 is the coefficient for the onset of instability eq 11 can be applied to the convection onset with a larger prefactor i e a 2 compared to the onset of instability which is not only more practical but also easier to quantify note in this study we try to apply the scaling relation to the onset of convection not the onset of instability similar relations are proposed for scaling the sherwood sh number for different simulation cases as 12 s h c 1 k δ ρ g h d ϕ μ n 1 where c 1 and n 1 are the coefficient and exponent of the sherwood scaling by definition of the dimensionless time t and ℛ number the scaling relation of t c and sh can be rearranged as t c a 1 ℛ 2 and s h c 1 ℛ n 1 therefore the instability onset is independent of the domain height also the stabilized dissolution flux can be independent of the domain height in the case of linear scaling n 1 1 which gives eq 2 the coefficients a 1 a 2 and c 1 and the exponent n 1 can depend on the numerical scheme for simulating the convective mixing as well as the type and magnitude of the introduced perturbation to the boundary condition or domain properties another important factor in obtaining a 1 coefficient is the method of quantifying the onset of instability i e onset of instability and onset of convection table 1 summarizes the reported coefficients and exponents for the convection onset time and s h ℛ scaling relations in the literature by numerical simulation or experimental studies interestingly the range of the prefactors is wide i e 850 a 2 6155 if we exclude mahmoodpour et al 2019a study as it is noticeably higher than other studies we did not include linear stability analysis lsa studies as they are suitable to study the instability onset time and the associated wave number emami meybodi et al 2015 in the same way the coefficient c 1 ranges between 0 017 c 1 0 357 in most of the studies moreover some studies mostly experimental predicted sub linear i e n 1 1 relations for s h ℛ scaling while most of the studies maintained the linear relation meaning the independence of the dissolution flux in the constant flux regime to the domain height some remarks regarding these studies will be discussed in section 4 4 results and discussion in this section we provide the numerical simulation results for different simulation scenarios along with relevant discussions about relevant literature results first we discuss the base case which was considered as the non reactive isotropic case without longitudinal dispersion afterwards we present the effect of hydrodynamic dispersion then we study the effect of permeability anisotropy on simulation results and scaling relations the effect of carbonate geochemical interactions on scaling relations is subsequently studied lastly we provide the stability map for a typical aquifer as well as the amount of co2 dissolution flux based on the presented results and derived equations in earlier subsections 4 1 base case in this section the results of the base case non reactive non dispersive α l 0 with isotropic permeability 1 simulations and their scaling are presented fig 2 presents the time evolution of carbon pseudo component concentration in the simulation domain for ℛ 12 000 and fig 3 a presents the temporal change of the dissolution flux f for different ℛ numbers corresponding to different domain permeabilities ranging from 6 md to 1 6 d the mentioned regimes and events can be seen in the behaviour of the dissolution flux as discussed in section 1 see fig 1 notably the constant flux regime exists in the simulation cases with o ℛ 3 and it is more distinct in higher ℛ numbers fig 3 b shows that a 2 2540 has been resulted from the simulations to scale the convection onset time based on eq 11 the obtained coefficient is comparable to reported values by other researchers as mentioned in table 1 such as amooie et al 2018 even though the r 2 is very close to 1 the onset times slightly deviate from the fitted equation for high ℛ numbers this shows that eq 11 is valid for a narrower range of rayleigh numbers moreover the same observation was reported by the experimental work of rasmusson et al 2017 as their data were associated with high rayleigh numbers as well as a better fit to the data has been obtained from the simulations to scale t c 244 r a 1 734 we suggest using a 2 parameter power equation for scaling the convection onset time over a wide range of rayleigh numbers another interesting point is the dependence of the convection onset time to the perturbation as expected stronger perturbation of the boundary condition results in earlier onset time and consequently smaller a 2 prefactor compared to relying on the numerical errors for example ghesmat et al 2011b imposed 5 concentration perturbation on the upper boundary which resulted in a 2 850 in this study we have imposed a random perturbation of 0 5 to the boundary concentration for s h ℛ scaling we obtained c 1 0 014 and n 1 1 the simulation results show a linear dependence of the sherwood number in the constant flux region to the rayleigh number and the fitted line shows a good agreement with the data the obtained value falls in the range of other experimental and numerical studies moreover we have performed multi species simulations where the effect of all species on the density is considered so the different prefactor for sherwood rayleigh scaling can also be due to the multi species nature of the present simulations where each species has its own coefficient of density change β and diffusion coefficient d noteworthy the developed code was previously compared to slim 2014 for the single component case erfani et al 2021 it is worth mentioning that some of the reported numerical neufeld et al 2010 farajzadeh et al 2013 amooie et al 2018 and experimental backhaus et al 2011 tsai et al 2013 seyyedi et al 2014 nazari moghaddam et al 2015 wang et al 2016 studies of table 1 provided sub linear scaling relations for s h ℛ scaling in the linear s h ℛ scaling the dimensional constant flux is independent of the domain height as the constant flux regime occurs before the convective fingers reach the bottom of the domain we expect the system to behave like an infinite system the independence of sherwood number sh to domain height in the obtained scaling relation fig 3 b satisfies such independence which is based on the physics of the process unless the simulation experiment domain is not tall enough that the fingers interact with the bottom boundary before establishing the constant flux regime in the case of a co 2 water system the density is a linear function of the co 2 concentration while some experimental studies neufeld et al 2010 backhaus et al 2011 tsai et al 2013 wang et al 2016 used analogous fluids methanol and ethylene glycol known as meg and propylene glycol ppg with non monotonic density effects so the sublinear scaling of the mentioned experimental studies can be attributed to a different choice of fluid compared to simulations as well as the existing limitations in the experimental setup height jafari raad and hassanzadeh 2015 moreover in the experimental results provided by liyanage et al 2019 2020 the complexity of the experimental domain geometry choice of a bowl as the domain adds to the complexity of the obtained results even though they suggest a linear s h ℛ scaling recently de paoli et al 2020 performed free flow hele shaw experiments using an aqueous solution of potassium permanganate kmno 4 to eliminate the non monotonic density change profile they varied the width of the cell to study the limitations of such experiments and the validity of the darcy s law they showed that the width of the hele shaw cell should be small enough for the darcy s law to be valid and hence linear sherwood rayleigh scaling to work they concluded that in large rayleigh numbers and large cell widths non darcy flow and dispersion effects can result in non linear sherwood rayleigh scaling relations 4 2 effect of dispersion on scaling relations in this section we study the effects of hydrodynamic dispersion on the scaling of convective mixing in porous media many studies have investigated the effects of dispersion on this process while none of them quantified the effect of dispersion on the scaling relations hidalgo and carrera 2009 chevalier et al 2015 xie et al 2011 ghesmat et al 2011a wen et al 2018 liang et al 2018 dhar et al 2021 letelier et al 2019 hidalgo and carrera 2009 focused on the effect of hydrodynamic dispersion on the convection onset while they only studied two ℛ numbers of 1000 and 2000 they showed that the increase of longitudinal dispersivity α l decreases the convection onset time linearly ghesmat et al 2011a studied the dynamics of the process at 500 ℛ 2000 and concluded that the existence of dispersion destabilizes the diffusive boundary layer and stimulates the convection onset and the dissolution flux wen et al 2018 described the interplay between molecular diffusion and mechanical dispersion over a wide range of ℛ and hydrodynamic dispersion coefficients they stated that in low ℛ numbers the molecular diffusion is the controlling parameter while at high dispersivities and high rayleigh numbers the impact of mechanical dispersion is more important they mentioned the validity of the existing scaling equations in the presence of hydrodynamic dispersion while they did not provide the prefactors although they provided an equation to calculate the dissolution flux with the assumption of ℛ h α l as f 0 46 h α l 0 74 0 08 h α l 0 51 ℛ to study the effect of hydrodynamic dispersion on existing scaling relations of the convective mixing we performed simulations with 12 k 400 md corresponding to 750 ℛ 24 000 with four different longitudinal dispersivities of α l 0 1 1 5 and 10 m the choice of different longitudinal dispersivities is due to the wide range of observations in different scales see fig a 2 fig 4 shows the dissolution fluxes for different simulation cases erfani et al 2021 discussed the phenomenological change of the flow and finger propagation due to the existence of hydrodynamic dispersion in line with the findings of other researchers the existence of hydrodynamic dispersion in the model enhances the co2 dissolution and results in earlier convection onset as well moreover the impact of dispersion is more pronounced in higher ℛ numbers in high ℛ numbers and longitudinal dispersivities α l h 0 1 the finger propagation patterns and interaction are changed substantially so the dissolution flux shows a different behaviour and the constant flux regime is no longer visible same pattern behaviour was observed by ghesmat et al 2011a and wen et al 2018 as well in such condition a distinctive characteristic of the dissolution flux is the maximum dissolution flux f m a x and corresponding sh m a x which can be scaled with eq 12 with rayleigh number emami meybodi et al 2015 hassanzadeh et al 2007 fig 5 presents the dimensionless convection onset time t c and maximum sherwood number sh m a x for different ℛ numbers at different α l noteworthy the accuracy of the presented scaling equations decreases with the increase of the longitudinal dispersivity for example in the case of sh m a x the simulation cases with α l h 5 1 0 2 and 10 1 exhibit a slightly superlinear behaviour especially in high ℛ numbers and the best fit can be obtained by s h m a x 0 01 r a 1 17 and sh m a x 0 019 r a 1 135 respectively a similar phenomenon was observed experimentally by liang et al 2018 in packed hele shaw experiments moreover de paoli et al 2020 experimentally showed that the existence of hydrodynamic dispersion results in the deviation of sherwood rayleigh scaling from the linear behaviour 4 3 effect of permeability anisotropy on scaling relations in geological formations heterogeneity exists in all length scales from pore to aquifer scale such heterogeneity can have significant impacts on convective mixing especially when its scale is comparable to convection length scales i e layer thickness and plume dimensions emami meybodi et al 2015 it is obvious from the scaling relations of convection onset time eq 11 and s h ℛ eq 12 that the spatial variations of properties like permeability porosity and effective diffusion coefficient will change the characteristics of the natural convection process in geological formations permeability usually varies up to orders of magnitude while the changes of porosity and effective diffusion coefficient are less therefore permeability is usually used to introduce heterogeneity in studies of fluid flow a simplified method of representing a layered formation is to model it using a homogeneous but anisotropic k z k x permeability field in such an approach the permeability ratio is usually defined as k z k x 1 which is due to the layered nature of natural formations i e k x k z it was previously showed in the literature ennis king et al 2005 ennis king and paterson 2005 xu et al 2006 cheng et al 2012 green and ennis king 2014 2018 de paoli et al 2017 2016 that if one of the permeabilities is used in natural scales k z in this study then the scaling relations can be rewritten as 13 t c a μ ϕ d k z δ ρ g 2 s h c k z δ ρ g h d ϕ μ and in dimensionless form t c a ℛ 2 and s h c ℛ table 2 presents the reported scaling relations in the literature considering the permeability anisotropy effect in summary all of the studies suggest earlier onset and higher dissolution flux for lower anisotropy ratio while keeping the rayleigh number constant i e keeping k z constant and increasing k x ennis king et al 2005 studied the effect of anisotropy on the onset of instability using linear and global stability analysis they showed that a decrease in by keeping the horizontal permeability constant and decreasing the vertical permeability results in stabilizing the process and hinders the onset of instability note that the correlation length of horizontal permeability is larger than that of vertical permeability thus keeping the horizontal permeability constant is more in agreement with the geological setting similar conclusions were made by other researchers as well hong and kim 2008 xu et al 2006 ennis king and paterson 2005 rapaka et al 2009 cheng et al 2012 xu et al 2006 studied both cases of increasing vertical permeability and increasing horizontal permeability while keeping the other one constant they concluded that increasing permeability in either direction destabilizes the solute interface and results in earlier instability onset time they concluded that irrespective of the manner of changing the power law dependency of critical onset time to anisotropy ratio can be concluded refer to table 2 unlike the presented results by ennis king et al 2005 ennis king and paterson 2005 xu et al 2006 and cheng et al 2012 for the dependency of critical onset time on anisotropy ratio which are in a very good agreement with each other the provided results by chen et al 2013 and green and ennis king 2014 present different dependency of onset time on i e 0 09 and 0 4 and higher prefactor in the case of green and ennis king 2014 a 2 3081 0 4 the observed difference can be due to different numerical schemes as both of these studies used direct numerical simulation and as discussed earlier the observed onset of convection occurs much later than the onset of instability the results of direct numerical simulation green and ennis king 2014 2018 de paoli et al 2016 2017 cheng et al 2012 further showed higher dissolution flux in the steady flux regime for lower anisotropy ratio obtained by increasing the horizontal permeability while keeping the vertical permeability constant fig 6 shows the temporal behaviour of carbon dissolution flux and average dimensionless concentration versus dimensionless time in these simulations the vertical permeability k z was kept constant and the permeability ratio was lowered by increasing the horizontal permeability k x the simulation results show that increasing horizontal permeability i e lowering the permeability ratio results in earlier onset of convection and higher dissolution flux in the constant flux regime fig 6 a consequently the simulations with lower permeability ratio exhibit higher average carbon concentration in the simulation domain fig 6 b fig 7 shows the temporal evolution of carbon pseudo component concentration in the simulation domain for domain vertical permeability of k z 200 md corresponding to ℛ 12 000 for three different anisotropy ratios of 0 75 0 2 and 0 1 fig 8 shows the obtained simulation results for the ratio of the onset time and dissolution flux for the cases with different anisotropy ratios and domain vertical permeability k z compared to the base case simulations presented in section 4 1 the simulation results show that increasing the permeability in each direction is beneficial for the process i e resulting in earlier onset time and higher co2 dissolution flux decreasing the anisotropy ratio for a constant vertical permeability i e increasing horizontal permeability results in earlier onset of convection and higher dissolution flux which is in line with the presented literature results of table 2 fig 8 a shows that decreasing the anisotropy ratio decreases the convection onset time with the rate of 0 54 even though we have performed our simulation over a wider range of rayleigh numbers this is in the range of the obtained coefficients by other researchers xu et al 2006 cheng et al 2012 green and ennis king 2014 conversely fig 8 b shows a lower dependency of dissolution flux f on anisotropy ratio 0 21 compared to the results presented by green and ennis king 2014 2018 and de paoli et al 2017 noteworthy they have performed simulations on a single rayleigh number ℛ 20 000 7000 and 5000 respectively which was lower compared to our range of rayleigh numbers moreover fig 8 b shows a higher impact of permeability anisotropy on the simulation results in lower rayleigh numbers another approach for scaling the convection onset time and sherwood number for anisotropic simulations are using eqs 11 and 12 with an effective permeability for the domain defined based on the horizontal k x and vertical k z permeabilities the same approach was followed by green and ennis king 2014 where they used k z k x as the effective permeability of the domain following the same idea we can define a modified rayleigh number as ℛ to scale the convection onset time and the sherwood number fig 9 provides the results of such approach based on which we can conclude that in anisotropic simulations the sherwood number fairly scales linearly with the modified rayleigh number sh max 0 0217 ℛ while in the case of convection onset time t c the exponent of the obtained scaling relation with the modified rayleigh number is not equal to 2 see fig 9 a so we suggest t c 2540 0 54 ℛ 2 to for scaling the convection onset time 4 4 geochemical reactions and practical implications the effects of geochemical reactions on the dynamics of the convection process and involving mechanisms were discussed earlier in erfani et al 2021 as the co2 enters the domain through diffusion it increases the aquifer brine ph and disturbs the geochemical equilibrium and triggers rock fluid and fluid fluid reactions the rock dissolution is the dominant mechanism in reactive co2 convection in carbonate aquifers while such a mechanism decreases the amount of stored carbon in the diffusion dominant regime it stimulates the convection onset time and the amount of the total flux after the onset time it was shown that the calcium and dolomite dissolution from the rock into the brine and gypsum precipitation are the main mechanisms which result in rock mineralogical changes in short the geochemical reactions result in earlier convection onset time and a higher carbon dissolution rate for detailed discussions of the effects of geochemical interactions on co2 convective mixing in carbonate aquifers the readers are referred to erfani et al 2021 and sainz garcia et al 2017 to revisit the scaling equation of convection onset time eq 11 and sherwood number in the steady flux regime eq 12 we performed multicomponent reactive convection diffusion numerical simulation at different rayleigh numbers fig 10 presents the obtained convection onset time and steady state sherwood number at different rayleigh numbers and the fitted scaling equations the scaling equations of t c 2197 ℛ 2 and s h 0 0164 ℛ were obtained in a good agreement with the simulation data compared to the obtained scaling equations in section 4 1 the a 2 and c 1 prefactors were changed the a 2 is higher for the case of reactive simulations conversely the obtained c 1 prefactor is increased due to geochemical interactions and enhanced convective mixing in the convection dominant regime then we study the convection onset time t c and carbon dissolution flux f for a typical carbonate aquifer we assume that the aquifer height is equal to 100 m porosity is equal to ϕ 0 15 the temperature is 80 c and we assume the longitudinal dispersivity of α l 5 m i e α l h 0 05 and k x 2k z i e 0 5 in such conditions based on the results and discussions provided the scaling equations in dimensionless and dimensional forms read as 14a t c 781 8 ℛ 2 s h 0 032 ℛ 14b t c 781 8 μ ϕ d k z δ ρ g 2 f c 0 032 δ c k z δ ρ g μ fig 11 shows the stability map for the aquifer with mentioned characteristics versus domain vertical permeability and co 2 solubility typical co 2 density versus pressure and co 2 solubility versus temperature and brine salinity are shown in figs a 3 and a 4 respectively the details of all numerical simulations are presented in table a 1 5 summary and conclusions this study presented high resolution 2d numerical simulations of multicomponent reactive density driven co 2 mixing in deep saline aquifers to obtain scaling relations for the onset of convection and the sherwood number the hydrodynamic dispersion permeability anisotropy and a complex set of carbonate geochemical reactions over a wide range of rayleigh numbers ℛ were considered in the scaling relations which to our best knowledge have not been studied all together in former studies following conclusions can be drawn based on the simulation results in multicomponent convection diffusion simulations it was shown that a constant flux regime exists for o ℛ 3 which is more distinct in higher ℛ numbers moreover the dimensionless convection onset time t c and sherwood number sh scale with the equations of t c 2540 ℛ 2 and s h 0 014 ℛ for the range of 350 ℛ 100 000 respectively in such conditions the dimensional onset time and the dissolution flux f are independent of the domain height if the domain is large enough the resulted scaling equations and conclusion made were in line with the findings of other researchers hydrodynamic dispersion decreased the convection onset time and increased the dissolution flux the effect of dispersion on the process dynamics was discussed in detail by erfani et al 2021 in short in high ℛ numbers and longitudinal dispersivities α l h 0 1 the finger propagation patterns and interactions were changed substantially so the dissolution flux showed a different behaviour and the constant flux regime was no longer visible additionally we showed that in the case of α l h 5 1 0 2 and 10 1 the sherwood rayleigh scaling showed superlinear behaviour especially in high ℛ numbers for these cases the best fit can be obtained by sh m a x 0 01 ℛ 1 17 and sh m a x 0 019 ℛ 1 135 respectively which shows the dependence of dissolution flux to the domain height the higher the permeability in either vertical or horizontal directions is the earlier convection onset time and higher dissolution flux will be to study the effect of permeability anisotropy k z k x 1 we performed simulations with constant vertical permeability while increasing the horizontal permeability to obtain different anisotropy ratios 0 1 1 we showed that the convection onset time t c and dissolution flux f scale with t c t c 1 0 54 and f f 1 0 21 respectively notably the presented results showed that the effect of the anisotropy ratio on dissolution flux is more significant in lower rayleigh numbers which can be the reason behind higher dependencies obtained by other researchers i e 0 5 scaling between the convection onset time and sherwood number by a modified rayleigh number based on the effective permeability of the domain ℛ showed fairly an accurate linear relation sh max 0 0217 ℛ while the dimensionless onset time scaled with the exponent of 1 766 t c 437 37 ℛ 1 766 instead of 2 for the case of geochemical reactions similar scaling relations with different prefactors are expected for the reactive simulations the convection onset time and sherwood number scale with rayleigh number as t c 2197 ℛ 2 and s h 0 016 ℛ respectively credit authorship contribution statement hamidreza erfani investigation methodology software data curation writing original draft masoud babaei investigation methodology writing review editing carl fredrik berg writing review editing vahid niasar supervision conceptualization methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to acknowledge the university of manchester for providing the phd funding for hamidreza erfani through the president s doctoral scholarship pds award this study was partially funded by the research council of norway centers of excellence funding scheme project number 262644 porelab appendix see tables a 1 and a 2 and figs a 1 a 4 
