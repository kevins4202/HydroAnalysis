index,text
22520,a numerical variational procedure is described for the design of a non axisymmetric stator the auxiliary function is constructed with the vortex lattice lifting line representations of propeller and stator so that optimum circulation distribution can be determined on each individual blade of the non axisymmetric stator as well as on the propeller the number and locations of stator blades could be varied and decided by inspecting the individual blade loading suited to the characteristics of the ship wake field in the example design for a large container vessel the design has been validated through force measurements for the propeller stator and rudder in cavitation tunnel experiments comparative estimations for the delivered powers are presented and an emphasis is put on the inclusion of rudder force in the final efficiency assessment in an additional experiment induced drag reduction was achieved with the attachment of winglets to the stator blades keywords stator propeller lifting line variational optimum 1 introduction stators have been found in a variety of marine applications in front of or behind a propeller they have been developed to generate favorable interactions with the propeller a nine bladed non axisymmetric stator was designed to reduce a once per revolution tangential velocity fluctuation in the inclined shaft configuration bowling 1987 neely and chen 1991 neely et al 1993 designed fixed preswirl stator vanes in an attempt to solve the problem regarding blade root cavitation erosion of a propeller for patrol boats arrangement of a stator with rotor in a shroud has been commonly used for the balance of the torques between them by rectifying swirl from the rotor of a pumpjet propulsor suryanarayana et al 2010 recent demands on energy savings have increased applications of stators in commercial vessels for the improvement of propulsive efficiency a design procedure for propellers in combination of stators based on lifting line theory was developed and applied in the design example involving a trawler and a tanker çelik and guner 2007 in which the number of stator blades and axial separation of propeller and stator were optimized for the gain in propulsive efficiency a preswirl stator was designed for a single screw container vessel and estimates were made for the energy saving potential of stators applied to twin screw ships zondervan et al 2011 the working principles of pre ducts in combination with stators and the scale effect on the performance of them were discussed in depth with rans simulations schuiling and van terwisga 2016 2017 in the present study a numerical method is demonstrated on the design of a non axisymmetric preswirl stator as an energy saving device the problem of finding optimum distribution of circulation is solved based on a numerical variational procedure an auxiliary function is formed so that nonaxisymmetric circulation distributions could be sought with lifting line models of blades a two component optimization for propeller stator combination given in kerwin et al 1986 was based on an assumption of axisymmetry a set of pre swirl stator blades was chosen by investigating loading distributions on individual blades in the example design for a large container vessel force measurements were conducted in a cavitation tunnel for the validation of the design the delivered power has been analyzed in connection with the measured forces on stator and propeller including rudder the importance of rudder force has been revealed for the proper estimation of the stator performance the pressure distribution on rudder was examined through rans simulation in connection with the experimental results in an additional experiment induced drag reduction was achieved with the attachment of winglets to the tip of stator blades 2 design method a numerical procedure is adopted which was introduced first by kerwin et al 1986 and utilized by the author for the preliminary design of an energy recovering turbine lee et al 2014 the blades of propeller and stator are represented by straight radial lifting lines the trailing vortex sheet is replaced with helical vortices trailing after the endpoints of the blade line segment for a propeller and straight semi infinite line vortices for a stator the auxiliary function h becomes simplified as there is no rotation of the stator blades and therefore no power applied to the stator the problem is stated as to find the circulation distribution that minimizes the power absorbed by the propeller when the system delivers a prescribed thrust c t r 1 h π j s c q p λ c t p j 1 n b c t j c t r where the subscript p denotes the propeller and j each blade of a stator which has n b blades j s is the advance coefficient based on ship speed v s the lagrange multiplier λ is introduced in the minimization problem to treat the constraint that thrust on propeller and stator should develop a prescribed value this formulation permits that an individual stator blade can have arbitrary circumferential location not in axisymmetric configuration the force coefficients are presented on the basis of ship speed v s and the radius of propeller r c t p and c q p are nondimensionalized thrust t and torque q of propeller respectively and c t j thrust on j th blade of stator c t p t 1 2 ρ v s 2 π r 2 4 z m 1 m p v t m π r m j s u t m g m δ r m 2 c q p q 1 2 ρ v s 2 π r 3 4 z m 1 m p v a m u a m g m r m δ r m c t j 4 m 1 m j v t m u t m g m δ r m where z is the number of blade of propeller v a and v t the axial and tangential inflow velocity g m γ m 2 π r v s is the nondimensionalized horseshoe vortex strength γ surrounding a control point at r m of propeller or stator blade the numbers of blade lattices on propeller and stator are m p and m j respectively and δ r m is the radial distance between the two lattice points u a u t are the velocities induced on m th control point expanding h with the expressions for the thrust and torque and setting its partial derivatives with respect to the g m s and the lagrange multiplier λ equal to zero gives us a nonlinear system of equations for the circulations and the lagrange multiplier h g p m π j s c q p g p m λ c t p g p m j 1 n b c t j g p m 3 h g k m π j s c q p g k m λ c t p g k m j 1 n b c t j g k m k 1 2 n b h λ c t p j 1 n b c t j c t r 0 the system can be linearized in each iteration step if the lagrange multiplier is assumed to be known constant where it is involved in quadratic terms with the unknown circulations and the induced velocities of the constraint equations are also assumed to be known the assumptions can be realized by taking the values from the previous iteration except the initial condition at an initial step the induced velocities are set to zero and the multiplier is set to 1 during the solution of the linear system of equations the trailing wake geometries for the propeller are frozen aligned with the updated hydrodynamic pitch angle β i from the previously obtained induced velocities the preceding formulation without restriction in axisymmetry has an advantage in finding optimum angular location of each stator blade in a nonuniform ship wake near the propeller each non rotating stator blade is optimized for the radial distribution of inflow at specific angular position whereas the circumferential mean inflow is generally considered for the rotating blades the method was applied to the stator design for a 14 000teu container vessel the nominal wake field of which is given in figs 1 and 2 for axial and tangential components respectively the angular position of stator blade is indicated in the contour plot of the axial component the angle is defined from the 12 o clock in the counterclockwise direction when looking upstream fig 3 shows circulation distributions optimized in the wake of the container vessel it is noted that loadings at the hub and tip are assigned zero in the figure the three blades located in the portside at 30 70 and 110 have quite amount of circulation over the entire span while the blade on starboard at 260 does not the different individual circulations are related with the non uniformity of the ship wake as the circulations would be identical on all blades if they are optimized in an axisymmetric wake the mean tangential velocities induced far downstream by the propeller and stator are presented in fig 4 note that the optimized circulations of the stator induce opposite swirl enough for canceling the tangential flow by the propeller it is also shown in the figure that the swirl added by the blade at 260 is negligible which is the consequence of its circulation distribution close to zero except at inner radii a properly designed preswirl stator blade induces swirl flow into a propeller and at the same time produces lift in the same direction as propeller rotation as depicted schematically in fig 5 the upward tangential wake of the vessel is thought favorable for the generation of upward lift in the port however it is considered that the optimization for downward lift in the starboard results in the small circulation of the blade and its negligible induction of swirl in this context local downward flow around a strong bilge vortex observed frequently in the wake of a hull with large block coefficient could be effective for a stator action in the starboard side the stator design for a ship has different aspect than airplane wing in the point that airplane wing is usually designed symmetrically on both sides of an airplane fuselage while the stator can have asymmetric configuration as the starboard blade turned out to have little contribution the final design adopted the three portside blades only the stator blade geometry is determined to produce the radial loading distribution through the relation between the local lift coefficient c l r and the nondimensional circulation g r epps and kimball 2013 c l r 2 π g r u v s c r d where u is the total inflow including velocity induced by propeller and stator c r is the chord length and d is the diameter of the propeller table 1 gives the forces for the designed propeller stator the propeller and stator are separated axially by 20 of the propeller diameter the circulation of stator has sign opposite that of the propeller and the stator generate drag rather than thrust a propeller design operating alone under the same condition is compared efficiencies are also presented in the table the efficiency of a propeller stator is defined here to be 4 η t p v a p j 1 n b t j v a j ω q p k t p v a p v s j 1 n b k t j v a j v s 2 π j s k q p where v a p is the volumetric mean effective inflow at the propeller v a j mean inflow over the span of the stator blade note that the propeller stator is predicted to be 5 5 more efficient than the single propeller the efficiency improvement of the stator was validated in a model scale experiment described in the next section 3 validation experiments force measurements for experimental verification were conducted in the cavitation tunnel of samsung ship model basin ssmb the overall geometry and principal particulars of the tunnel are presented in fig 6 and table 2 respectively the working section of the water tunnel has rectangular cross section of 3 0 m width and 1 4 m height the 12 0 m long test section provides the capability to install the entire wetted hull model of the 14 000teu container vessel fig 7 shows the model ship installation inside the test section the hull model was fastened on the top clamping system at the water line corresponding to design draught wooden plates were covered between the lip of the hole over the test section and the model ship to suppress the interaction of flow with the water filled in the test top inside the ship a crp contra rotating propeller dynamometer cussons model r700 was installed for measurements of forces on propeller and stator the dynamometer is mechanically designed to have separate contra rotating inner and outer propeller shafts but timing belt and pulleys for outer shaft was intentionally disconnected to measure the forces on the stator while the propeller forces are measured through inner shaft module a three component rudder balance cussons model g102 was mounted on the stern bed and connected to the rudder stock to measure forces on the rudder the overall device set up is depicted in fig 8 the 250 mm diameter model propeller was made of aluminum alloy a section of stern boss and the stator blades are manufactured in one piece of aluminum alloy a dummy section of stern boss without blades was separately prepared for the test of bare hull cavitation tunnel experiments have been performed basically on the principle of thrust identity at a particular propulsion operating point such as at a normal continuous rating power in design draught the tunnel flow conditions of this operating point are set to achieve a prescribed set of parameters including thrust coefficient k t in the present measurements forces were measured over a range of propeller rotation speed embracing the operating point the flow speed was kept approximately constant at 6 5 m s throughout the measurement corresponding to reynolds number of order 1 0 6 on the propeller blade and rudder 1 0 5 on the stator in model scale it was picked up from the pitot tube at the entrance of the test section the test section pressure was controlled to remain atmospheric condition the propeller thrust and torque data with or without stator are compared in fig 9 and the rudder and stator forces are shown in fig 10 measurement results are presented in values nondimensionalized by rotation speed n and the diameter d of the propeller 5 j v n d k t t ρ n 2 d 4 k q q ρ n 2 d 5 6 k r d r ρ n 2 d 4 k s d s ρ n 2 d 4 where v is the water speed t the propeller thrust q the propeller torque d r the drag of rudder d s the drag of stator and ρ the density of the water it is noted that the rated maximum thrust of the crp dynamometer limited measurement for advance coefficient less than 0 77 with the stator the stator forces were measured close to zero when the dummy stern boss bare hull connected on the outer shaft of the dynamometer the increase in propeller thrust and torque with the stator is clearly seen in fig 9 this could be attributed to the swirl flow induced by the stator opposite to the propeller rotation it is noticeable that a significant increase of rudder drag was measured when the rudder was in the flow having passed through the stator and the propeller compared to the rudder drag in propeller only action the amount of increase appears to exceed the drag developed on the stator so it is expected that the rudder force could have an undesirable effect on the propulsion performance in order to assess the energy saving allowing for the change of rudder drag the delivered powers to the propeller are considered for selective summation of axial forces on stator propeller and rudder the net axial force is defined as 7 f x t d s d r fig 11 is a plot of the delivered power to the propeller with neglecting the rudder force in the net axial forces the fitting curves through measured points are shown together the dashed line corresponds to the propeller thrust when the thrust identity was reached in the bare hull configuration the delivered powers are read from the curves when t b a r e h u l l t d s s t a t o r h u l l and summarized in table 3 the power saving of the propeller and stator combination amounts to 4 9 in ratio to bare hull which is considered compatible with 5 5 of efficiency improvement predicted by the preliminary design in the previous section an interesting point has been noticed when the rudder force is accounted for in the above estimation the delivered powers related with the axial force including rudder are shown in fig 12 the power increments to overcome rudder drag are seen in the figure compared with the curves in fig 11 the delivered powers are extracted from the curves in fig 12 when t d r b a r e h u l l t d s d r s t a t o r h u l l and tabulated in table 3 the power saving with the stator is computed to be 3 1 losing 1 8 points more 4 9 3 1 from the estimation excluding rudder this can be attributed to the increase of rudder drag which is not considered in the lifting line calculation it is an experimental evidence of the correction commented in zondervan et al 2011 in which rudder forces were computed with or without the pre swirl stator and the reduction of the gain about 1 5 was adopted it was explained that the rudder delivered a different longitudinal force due to the change in the rotational flow with the pre swirl stator it can be thought that propeller and stator together minimizes rotational loss but at the same time the flow through them makes a condition for rudder to develop larger drag it is considered that the optimization has a chance to be formulated to include a rudder as one component of propulsor in order to look more closely into the increase in rudder drag for the stator rans simulations were performed with a commercial software star ccm which is recently in wide use for assessing hydrodynamic performance of ships the cavitation tunnel was modeled as elongated test section so that the inlet and outlet boundaries of the computational domain are located a length of model ship away from the forward and aft perpendiculars respectively the rotational motion of propeller was directly simulated with a sliding mesh technique fig 13 shows pressure distributions over the rudder surface in cases with and without the stator it is observed that the stagnation pressure shifts toward the center of rudder when the stator is in action the movement of stagnation pressure can be seen more clearly in fig 14 in which pressure distribution at the height of 70 span of the rudder is shown it can be deduced from the figure that an incident angle to the rudder is reduced due to the preswirl flow produced by the stator in the opposite direction of propeller induced flow in the lower part of the rudder however the stagnation pressure barely moves as the blade of stator is mainly located in the upper region table 4 summarizes rudder forces decomposed into pressure and friction components it is found that the increase of pressure component is more prevalent than friction which implies that the decrease of incident angle to the rudder plays a major role in the increase of rudder force while hull force was not measured in the experiments hull resistance has been further investigated with the results from the rans calculations fig 15 presents a contour plot on hull surface for the difference of pressure coefficients c p stator c p bare where c p p p 0 5 ρ v s 2 the negative value for the difference above propeller indicates that the presence of the stator results in lower ambient pressure than without the stator the suction pressure on the upper surface of stator interacts with flow around hull and appears to prevent the recovery of pressure in the stern region the recovery of pressure along a ship hull from midship to stern has a considerable effect on the hull force it can be concluded from these qualitative observations on cfd results that the resistance of hull is increased along with the drag of rudder and stator itself it is noted that the increase in resistance is expected to affect the thrust deduction and change the value of hull efficiency the force measurements were conducted in series for another model of a stator with winglets the winglet stator was prepared for the prevention of tip vortex cavitation fig 16 shows shape of the winglet stator it is noted that the radial distribution of chord length was modified for the attachment of winglet around the blade tip force measurement results are compared with the original stator in fig 17 the reduction of stator drag was measured without noticeable change in the rudder drag the delivered power curve for the winglet stator is also shown in fig 12 the power at the prescribed net axial force is appended in table 3 it has been widely studied in the aerodynamics that an additional drag component on a finite wing called induced drag can be reduced by the use of winglets additional power saving of 0 5 points with winglet stator could be explained in the same principle 4 conclusion a procedure for the optimization of preswirl stator as an esd has been developed based on numerical variational method and applied to the stator for a large container vessel the method is formulated and solved in such a way that each blade of a stator can be optimized in nonuniform ship wake the angular location of a stator blade could be selected or discarded by taking a look at the loading distribution of each blade the stator design has been validated through model scale force measurements in the cavitation tunnel the quantitative estimation of power saving with the stator has been made from the experiments including the increase of drag for stator and rudder on thrust identity base a focus has been given on how the rudder force has an effect on the performance determination it is investigated through rans calculation that increase of rudder drag with the stator comes from the considerable change in pressure distribution the change in hull pressure with the stator is also investigated qualitatively from the cfd simulation and it is observed that the hull resistance experiences a substantial change with the stator an analysis on thrust deduction and hull efficiency associated with the hull resistance will be needed for a complete evaluation of stator performance the work will be continued by the authors on the issue it is proved from the experiments that the winglet is an successful modification for additional improvement 
22520,a numerical variational procedure is described for the design of a non axisymmetric stator the auxiliary function is constructed with the vortex lattice lifting line representations of propeller and stator so that optimum circulation distribution can be determined on each individual blade of the non axisymmetric stator as well as on the propeller the number and locations of stator blades could be varied and decided by inspecting the individual blade loading suited to the characteristics of the ship wake field in the example design for a large container vessel the design has been validated through force measurements for the propeller stator and rudder in cavitation tunnel experiments comparative estimations for the delivered powers are presented and an emphasis is put on the inclusion of rudder force in the final efficiency assessment in an additional experiment induced drag reduction was achieved with the attachment of winglets to the stator blades keywords stator propeller lifting line variational optimum 1 introduction stators have been found in a variety of marine applications in front of or behind a propeller they have been developed to generate favorable interactions with the propeller a nine bladed non axisymmetric stator was designed to reduce a once per revolution tangential velocity fluctuation in the inclined shaft configuration bowling 1987 neely and chen 1991 neely et al 1993 designed fixed preswirl stator vanes in an attempt to solve the problem regarding blade root cavitation erosion of a propeller for patrol boats arrangement of a stator with rotor in a shroud has been commonly used for the balance of the torques between them by rectifying swirl from the rotor of a pumpjet propulsor suryanarayana et al 2010 recent demands on energy savings have increased applications of stators in commercial vessels for the improvement of propulsive efficiency a design procedure for propellers in combination of stators based on lifting line theory was developed and applied in the design example involving a trawler and a tanker çelik and guner 2007 in which the number of stator blades and axial separation of propeller and stator were optimized for the gain in propulsive efficiency a preswirl stator was designed for a single screw container vessel and estimates were made for the energy saving potential of stators applied to twin screw ships zondervan et al 2011 the working principles of pre ducts in combination with stators and the scale effect on the performance of them were discussed in depth with rans simulations schuiling and van terwisga 2016 2017 in the present study a numerical method is demonstrated on the design of a non axisymmetric preswirl stator as an energy saving device the problem of finding optimum distribution of circulation is solved based on a numerical variational procedure an auxiliary function is formed so that nonaxisymmetric circulation distributions could be sought with lifting line models of blades a two component optimization for propeller stator combination given in kerwin et al 1986 was based on an assumption of axisymmetry a set of pre swirl stator blades was chosen by investigating loading distributions on individual blades in the example design for a large container vessel force measurements were conducted in a cavitation tunnel for the validation of the design the delivered power has been analyzed in connection with the measured forces on stator and propeller including rudder the importance of rudder force has been revealed for the proper estimation of the stator performance the pressure distribution on rudder was examined through rans simulation in connection with the experimental results in an additional experiment induced drag reduction was achieved with the attachment of winglets to the tip of stator blades 2 design method a numerical procedure is adopted which was introduced first by kerwin et al 1986 and utilized by the author for the preliminary design of an energy recovering turbine lee et al 2014 the blades of propeller and stator are represented by straight radial lifting lines the trailing vortex sheet is replaced with helical vortices trailing after the endpoints of the blade line segment for a propeller and straight semi infinite line vortices for a stator the auxiliary function h becomes simplified as there is no rotation of the stator blades and therefore no power applied to the stator the problem is stated as to find the circulation distribution that minimizes the power absorbed by the propeller when the system delivers a prescribed thrust c t r 1 h π j s c q p λ c t p j 1 n b c t j c t r where the subscript p denotes the propeller and j each blade of a stator which has n b blades j s is the advance coefficient based on ship speed v s the lagrange multiplier λ is introduced in the minimization problem to treat the constraint that thrust on propeller and stator should develop a prescribed value this formulation permits that an individual stator blade can have arbitrary circumferential location not in axisymmetric configuration the force coefficients are presented on the basis of ship speed v s and the radius of propeller r c t p and c q p are nondimensionalized thrust t and torque q of propeller respectively and c t j thrust on j th blade of stator c t p t 1 2 ρ v s 2 π r 2 4 z m 1 m p v t m π r m j s u t m g m δ r m 2 c q p q 1 2 ρ v s 2 π r 3 4 z m 1 m p v a m u a m g m r m δ r m c t j 4 m 1 m j v t m u t m g m δ r m where z is the number of blade of propeller v a and v t the axial and tangential inflow velocity g m γ m 2 π r v s is the nondimensionalized horseshoe vortex strength γ surrounding a control point at r m of propeller or stator blade the numbers of blade lattices on propeller and stator are m p and m j respectively and δ r m is the radial distance between the two lattice points u a u t are the velocities induced on m th control point expanding h with the expressions for the thrust and torque and setting its partial derivatives with respect to the g m s and the lagrange multiplier λ equal to zero gives us a nonlinear system of equations for the circulations and the lagrange multiplier h g p m π j s c q p g p m λ c t p g p m j 1 n b c t j g p m 3 h g k m π j s c q p g k m λ c t p g k m j 1 n b c t j g k m k 1 2 n b h λ c t p j 1 n b c t j c t r 0 the system can be linearized in each iteration step if the lagrange multiplier is assumed to be known constant where it is involved in quadratic terms with the unknown circulations and the induced velocities of the constraint equations are also assumed to be known the assumptions can be realized by taking the values from the previous iteration except the initial condition at an initial step the induced velocities are set to zero and the multiplier is set to 1 during the solution of the linear system of equations the trailing wake geometries for the propeller are frozen aligned with the updated hydrodynamic pitch angle β i from the previously obtained induced velocities the preceding formulation without restriction in axisymmetry has an advantage in finding optimum angular location of each stator blade in a nonuniform ship wake near the propeller each non rotating stator blade is optimized for the radial distribution of inflow at specific angular position whereas the circumferential mean inflow is generally considered for the rotating blades the method was applied to the stator design for a 14 000teu container vessel the nominal wake field of which is given in figs 1 and 2 for axial and tangential components respectively the angular position of stator blade is indicated in the contour plot of the axial component the angle is defined from the 12 o clock in the counterclockwise direction when looking upstream fig 3 shows circulation distributions optimized in the wake of the container vessel it is noted that loadings at the hub and tip are assigned zero in the figure the three blades located in the portside at 30 70 and 110 have quite amount of circulation over the entire span while the blade on starboard at 260 does not the different individual circulations are related with the non uniformity of the ship wake as the circulations would be identical on all blades if they are optimized in an axisymmetric wake the mean tangential velocities induced far downstream by the propeller and stator are presented in fig 4 note that the optimized circulations of the stator induce opposite swirl enough for canceling the tangential flow by the propeller it is also shown in the figure that the swirl added by the blade at 260 is negligible which is the consequence of its circulation distribution close to zero except at inner radii a properly designed preswirl stator blade induces swirl flow into a propeller and at the same time produces lift in the same direction as propeller rotation as depicted schematically in fig 5 the upward tangential wake of the vessel is thought favorable for the generation of upward lift in the port however it is considered that the optimization for downward lift in the starboard results in the small circulation of the blade and its negligible induction of swirl in this context local downward flow around a strong bilge vortex observed frequently in the wake of a hull with large block coefficient could be effective for a stator action in the starboard side the stator design for a ship has different aspect than airplane wing in the point that airplane wing is usually designed symmetrically on both sides of an airplane fuselage while the stator can have asymmetric configuration as the starboard blade turned out to have little contribution the final design adopted the three portside blades only the stator blade geometry is determined to produce the radial loading distribution through the relation between the local lift coefficient c l r and the nondimensional circulation g r epps and kimball 2013 c l r 2 π g r u v s c r d where u is the total inflow including velocity induced by propeller and stator c r is the chord length and d is the diameter of the propeller table 1 gives the forces for the designed propeller stator the propeller and stator are separated axially by 20 of the propeller diameter the circulation of stator has sign opposite that of the propeller and the stator generate drag rather than thrust a propeller design operating alone under the same condition is compared efficiencies are also presented in the table the efficiency of a propeller stator is defined here to be 4 η t p v a p j 1 n b t j v a j ω q p k t p v a p v s j 1 n b k t j v a j v s 2 π j s k q p where v a p is the volumetric mean effective inflow at the propeller v a j mean inflow over the span of the stator blade note that the propeller stator is predicted to be 5 5 more efficient than the single propeller the efficiency improvement of the stator was validated in a model scale experiment described in the next section 3 validation experiments force measurements for experimental verification were conducted in the cavitation tunnel of samsung ship model basin ssmb the overall geometry and principal particulars of the tunnel are presented in fig 6 and table 2 respectively the working section of the water tunnel has rectangular cross section of 3 0 m width and 1 4 m height the 12 0 m long test section provides the capability to install the entire wetted hull model of the 14 000teu container vessel fig 7 shows the model ship installation inside the test section the hull model was fastened on the top clamping system at the water line corresponding to design draught wooden plates were covered between the lip of the hole over the test section and the model ship to suppress the interaction of flow with the water filled in the test top inside the ship a crp contra rotating propeller dynamometer cussons model r700 was installed for measurements of forces on propeller and stator the dynamometer is mechanically designed to have separate contra rotating inner and outer propeller shafts but timing belt and pulleys for outer shaft was intentionally disconnected to measure the forces on the stator while the propeller forces are measured through inner shaft module a three component rudder balance cussons model g102 was mounted on the stern bed and connected to the rudder stock to measure forces on the rudder the overall device set up is depicted in fig 8 the 250 mm diameter model propeller was made of aluminum alloy a section of stern boss and the stator blades are manufactured in one piece of aluminum alloy a dummy section of stern boss without blades was separately prepared for the test of bare hull cavitation tunnel experiments have been performed basically on the principle of thrust identity at a particular propulsion operating point such as at a normal continuous rating power in design draught the tunnel flow conditions of this operating point are set to achieve a prescribed set of parameters including thrust coefficient k t in the present measurements forces were measured over a range of propeller rotation speed embracing the operating point the flow speed was kept approximately constant at 6 5 m s throughout the measurement corresponding to reynolds number of order 1 0 6 on the propeller blade and rudder 1 0 5 on the stator in model scale it was picked up from the pitot tube at the entrance of the test section the test section pressure was controlled to remain atmospheric condition the propeller thrust and torque data with or without stator are compared in fig 9 and the rudder and stator forces are shown in fig 10 measurement results are presented in values nondimensionalized by rotation speed n and the diameter d of the propeller 5 j v n d k t t ρ n 2 d 4 k q q ρ n 2 d 5 6 k r d r ρ n 2 d 4 k s d s ρ n 2 d 4 where v is the water speed t the propeller thrust q the propeller torque d r the drag of rudder d s the drag of stator and ρ the density of the water it is noted that the rated maximum thrust of the crp dynamometer limited measurement for advance coefficient less than 0 77 with the stator the stator forces were measured close to zero when the dummy stern boss bare hull connected on the outer shaft of the dynamometer the increase in propeller thrust and torque with the stator is clearly seen in fig 9 this could be attributed to the swirl flow induced by the stator opposite to the propeller rotation it is noticeable that a significant increase of rudder drag was measured when the rudder was in the flow having passed through the stator and the propeller compared to the rudder drag in propeller only action the amount of increase appears to exceed the drag developed on the stator so it is expected that the rudder force could have an undesirable effect on the propulsion performance in order to assess the energy saving allowing for the change of rudder drag the delivered powers to the propeller are considered for selective summation of axial forces on stator propeller and rudder the net axial force is defined as 7 f x t d s d r fig 11 is a plot of the delivered power to the propeller with neglecting the rudder force in the net axial forces the fitting curves through measured points are shown together the dashed line corresponds to the propeller thrust when the thrust identity was reached in the bare hull configuration the delivered powers are read from the curves when t b a r e h u l l t d s s t a t o r h u l l and summarized in table 3 the power saving of the propeller and stator combination amounts to 4 9 in ratio to bare hull which is considered compatible with 5 5 of efficiency improvement predicted by the preliminary design in the previous section an interesting point has been noticed when the rudder force is accounted for in the above estimation the delivered powers related with the axial force including rudder are shown in fig 12 the power increments to overcome rudder drag are seen in the figure compared with the curves in fig 11 the delivered powers are extracted from the curves in fig 12 when t d r b a r e h u l l t d s d r s t a t o r h u l l and tabulated in table 3 the power saving with the stator is computed to be 3 1 losing 1 8 points more 4 9 3 1 from the estimation excluding rudder this can be attributed to the increase of rudder drag which is not considered in the lifting line calculation it is an experimental evidence of the correction commented in zondervan et al 2011 in which rudder forces were computed with or without the pre swirl stator and the reduction of the gain about 1 5 was adopted it was explained that the rudder delivered a different longitudinal force due to the change in the rotational flow with the pre swirl stator it can be thought that propeller and stator together minimizes rotational loss but at the same time the flow through them makes a condition for rudder to develop larger drag it is considered that the optimization has a chance to be formulated to include a rudder as one component of propulsor in order to look more closely into the increase in rudder drag for the stator rans simulations were performed with a commercial software star ccm which is recently in wide use for assessing hydrodynamic performance of ships the cavitation tunnel was modeled as elongated test section so that the inlet and outlet boundaries of the computational domain are located a length of model ship away from the forward and aft perpendiculars respectively the rotational motion of propeller was directly simulated with a sliding mesh technique fig 13 shows pressure distributions over the rudder surface in cases with and without the stator it is observed that the stagnation pressure shifts toward the center of rudder when the stator is in action the movement of stagnation pressure can be seen more clearly in fig 14 in which pressure distribution at the height of 70 span of the rudder is shown it can be deduced from the figure that an incident angle to the rudder is reduced due to the preswirl flow produced by the stator in the opposite direction of propeller induced flow in the lower part of the rudder however the stagnation pressure barely moves as the blade of stator is mainly located in the upper region table 4 summarizes rudder forces decomposed into pressure and friction components it is found that the increase of pressure component is more prevalent than friction which implies that the decrease of incident angle to the rudder plays a major role in the increase of rudder force while hull force was not measured in the experiments hull resistance has been further investigated with the results from the rans calculations fig 15 presents a contour plot on hull surface for the difference of pressure coefficients c p stator c p bare where c p p p 0 5 ρ v s 2 the negative value for the difference above propeller indicates that the presence of the stator results in lower ambient pressure than without the stator the suction pressure on the upper surface of stator interacts with flow around hull and appears to prevent the recovery of pressure in the stern region the recovery of pressure along a ship hull from midship to stern has a considerable effect on the hull force it can be concluded from these qualitative observations on cfd results that the resistance of hull is increased along with the drag of rudder and stator itself it is noted that the increase in resistance is expected to affect the thrust deduction and change the value of hull efficiency the force measurements were conducted in series for another model of a stator with winglets the winglet stator was prepared for the prevention of tip vortex cavitation fig 16 shows shape of the winglet stator it is noted that the radial distribution of chord length was modified for the attachment of winglet around the blade tip force measurement results are compared with the original stator in fig 17 the reduction of stator drag was measured without noticeable change in the rudder drag the delivered power curve for the winglet stator is also shown in fig 12 the power at the prescribed net axial force is appended in table 3 it has been widely studied in the aerodynamics that an additional drag component on a finite wing called induced drag can be reduced by the use of winglets additional power saving of 0 5 points with winglet stator could be explained in the same principle 4 conclusion a procedure for the optimization of preswirl stator as an esd has been developed based on numerical variational method and applied to the stator for a large container vessel the method is formulated and solved in such a way that each blade of a stator can be optimized in nonuniform ship wake the angular location of a stator blade could be selected or discarded by taking a look at the loading distribution of each blade the stator design has been validated through model scale force measurements in the cavitation tunnel the quantitative estimation of power saving with the stator has been made from the experiments including the increase of drag for stator and rudder on thrust identity base a focus has been given on how the rudder force has an effect on the performance determination it is investigated through rans calculation that increase of rudder drag with the stator comes from the considerable change in pressure distribution the change in hull pressure with the stator is also investigated qualitatively from the cfd simulation and it is observed that the hull resistance experiences a substantial change with the stator an analysis on thrust deduction and hull efficiency associated with the hull resistance will be needed for a complete evaluation of stator performance the work will be continued by the authors on the issue it is proved from the experiments that the winglet is an successful modification for additional improvement 
22521,in this paper the mechanical model and governing equations for the recoil response of deepwater drilling riser are established based on the mass spring damping system with three degrees of freedom the direct acting tensioner dat and axial elongation of riser before disconnection the are taken as the boundary condition and initial condition of the mechanical model respectively the model can consider the influence of frictional resistance induced by drilling mud discharge and elastic potential energy due to axial elongation on the recoil response the clearance between the low marine riser package lmrp and the blowout preventer bop after disconnection is figured out through solving the governing equations then the parameter sensitivity analysis is given to present a comprehensive understanding of the recoil response analysis results show that the phase difference has a significant influence on the recoil response the most favorable phase difference is 60 the possibility of collision between the lmrp and the bop increases with water depth and amplitude of the dat the top tensioner has an optimal heave motion frequency which is the most advantageous for implementing riser emergency disconnection corresponding measures should be taken to prevent spring stiffness of the dat from decreasing besides riser with large diameter and wall thickness is conducive to a safe disconnection keywords deepwater drilling riser emergency disconnection recoil response mechanical characteristics influence factors control measures 1 introduction in deepwater drilling emergency disconnection of riser between the lmrp and bop is necessary under extreme marine environment before disconnection elastic potential energy has been stored in riser due to the axial elongation in normal drilling so the riser will move upward like a spring after the disconnection which is called recoil response if the recoil control is improper the drilling platform yang 2013 the riser and the subsea wellhead miller et al 1998 gao and wang 2016 will be threatened therefore the recoil response of emergency disconnection is an important issue for the safety of deepwater drilling in the stipulation of the american bureau of shipping abs the recoil analysis should cover the following issues abs 2017 i establish the initial riser overpull tension and recoil settings so that the lmrp will be able to clear the bop stack for a specific wave condition ii establish the riser tension and recoil and or anti recoil settings so that the continuous riser movement will not cause the total collapse of the telescopic joint slacked wire tensioners or compressed direct acting tensioners negative tension along the riser string or impact back to bop stack for a specific wave condition iii establish a set of recoil control parameters for a range of environmental conditions if required therefore a large number of scholars have done studies on the recoil analysis young et al 1992a and 1992b have described an analysis method to deal with the recoil problem and how to design an anti recoil system puccio et al 1998 have illustrated some significant variables affecting the velocity and displacement of the riser string and lmrp during an emergency disconnect sequence matthew et al 2004 have proposed a recoil analysis of riser in a 4 308 ft water depth to determine the appropriate drilling riser configurations grytoyr et al 2009 2010 and 2011 have presented a methodology for the dynamic analysis of marine drilling riser disconnect and recoil using the finite element fe programs lang et al 2009 have described the development of a disconnect and recoil analysis software tool some industrial standard iso tr 13624 2 2009 has also involved the riser recoil response which has provided reference and guidance of the recoil analysis brynestad 2012 has investigated the drive off and weak link of disconnection riser with pipe in pipe model ma et al 2013 have presented the behavior of a 12 000 ft drilling riser during an emergency disconnection based on a 3 d nonlinear fe model grønevik 2013 has carried out recoil analyses using the computer program riflex zhang 2014 have analyzed the main factors that affect the recoil response and given simulations of a 1 500m riser with ansys software wang et al 2018 have given recoil response simulation of 1 500m riser with ansys aqwa and discussed the influence of mud discharge on the recoil characteristics due to the importance of the top tensioner in the riser recoil response many scholars have studied the mechanical characteristics of the tensioner dyngvold 2011 has proposed a mathematical model to analyze a wireline riser tensioner system and investigated the response of the system under different load cases zhang et al 2013a b have presented some simulations on the dat based on the ame sim framework pestana et al 2016 have studied the tensioner behavior during riser emergency disconnection using nonlinear parallel spring damper scalar elements in orcaflex software besides some studies have been done with consideration of the influence of mud discharge on the recoil response li et al 2015 and 2016 have given a numerical procedure to simulate the mud discharge and seawater refilling and given some discussion through a case study meng et al 2018 have studied the recoil response of a deepwater drilling riser through a mass spring damping system with two degrees of freedom hock and young 1993 2000 have presented the design installation and testing procedures of an anti recoil system in 6 000 ft water depth he et al 2016 have analyzed the composition of recoil control system and proposed a control method through taking the dat as the research objective at present some progress has been made in the recoil research however published results under different methods and assumptions are very different and the detailed solution process has not been reported until now therefore a new recoil analysis model has been established based on the previous study meng et al 2018 the mechanical behavior and key influence factors of the recoil response have been obtained with consideration of the drilling mud discharge and heave motion of the dat this research can provide reference for the optimal design of the dat and emergency disconnection control the remainder of the paper is organized as follows the coordinate system and mechanical models include the drilling mud discharge model the dat model and the recoil response model are introduced in section 2 the detailed model solution process is presented in section 3 the case study and parameters sensitivity analysis are shown in section 4 the conclusions drawn and suggestions on the further study are given in section 5 2 mechanical models in normal operation deepwater drilling riser will generate axial elongation due to the top tension gravity and buoyancy the elongation begins to spring back when the emergency disconnection occurs considering the heave movement of the top tensioner the recoil response belongs to the forced vibration of an elastic body with infinite degrees of freedom under initial displacement the following assumptions are accepted in order to establish the analysis model in this paper i since the riser recoil response is far stronger than its lateral characteristics it is considered that only axial vibration exists during the recoil ii the influence of buoyancy modules on the riser stiffness is ignored iii the drill pipe and the riser are concentric during the recoil response accordingly the mechanical model and the coordinate system of the recoil analysis are shown in fig 1 as shown in fig 1 the coordinate system of x 1 o 1 y 1 represents the riser axial elongation where the origin of the coordinate is chosen at the connection point of the top tensioner and the riser the coordinate system of x 2 o 2 y 2 stands for the clearance between the lmrp and the bop during recoil where the origin of the coordinate is selected as the joint point of the lmrp and the bop the coordinate system of x 3 t represents the motion of the piston in dat l 0 is the maximum clearance between lmrp and bop in the following sections a prime stands for x and an overdot represents t where t is time unless otherwise specified all parameters in this paper are in the international system of units 2 1 model of mud discharge during the recoil the drilling mud is discharged downward and the riser is refilled by seawater which makes the riser be subjected to the frictional resistance accurate calculation of the frictional resistance is the requirement for the recoil response in the actual configuration riser is often equipped with fill up valves although the opening of one valve is usually small compared to the internal diameter of the riser the number of valves and total volume flowing into the riser can guarantee that the mud is replaced by seawater at the same volumetric rate this is a basic requirement to prevent the riser from being collapse so the whole fluid column model wfcm as shown in fig 2 is used to describe the mud discharge process grønevik 2013 meng et al 2018 in this paper the influence of drill pipe in the riser on the frictional resistance is considered which is a significant different from the previous work according to the newton s second law the dynamic equilibrium equation of the drilling mud can be written as 1 m w l w m m l m a d g w g m f t o p f p f r 1 f r 2 f d 1 f d 2 f p 1 f p 2 f e n d where m w is the mass of seawater in riser per length m m is the mass of drilling mud in riser per length l w is the length of seawater in riser l m is the length of drilling mud in riser a d is the acceleration of the whole fluid column g w is the weight of seawater in the riser g m is the weight of drilling mud in the riser f t o p is the force on the top of seawater from the fill up valves f p is the force on the bottom of drilling mud f e n d is the frontal force on the bottom of the drilling mud due to the water hammer effect based on bernoulli s equation f r 1 is the frictional resistance between the seawater and the riser inner wall f r 2 is the frictional resistance between the drilling mud and the riser inner wall f d 1 is the frictional resistance between the seawater and the outer wall of the drill pipe f d 2 is the frictional resistance between the drilling mud and the outer wall of the drill pipe f p 1 is the frictional resistance between the seawater and the inner wall of the drill pipe f p 2 is the frictional resistance between the drilling mud and the inner wall of the drill pipe therefore the total frictional force on riser inner wall f f can be written as 2 f f f r 1 f r 2 the detailed derivation process of eq 2 is presented in appendix a 2 2 model of the dat the heave motion and stiffness of the top tensioner must be obtained to analyze the boundary conditions of the recoil response in this paper the dat is taken as the research object which working principle zhao et al 2010 is shown in fig 3 the tension force is provided by the pressure difference in the cylinder the bottom of the rod end is connected to the tensioner ring where the hydraulic pressure is provided by the high pressure accumulator the accumulator can store and convert the energy produced by heave motion of the piston which can maintain the stability of the tension force the rear end is connected to the low pressure npv the tension force generated by a single tensioner f t can be calculated by 3 f t p h i v h i n v h i a r x p n a r p l i v l i n v l i a p x p n a p where p h i is the initial pressure of the rod end p l i is the initial pressure of the rear end v h i is the initial volume of the rod end v l i is the initial volume of the rear end n is the gas constan and 1 3 is selected in this paper a r is the area of the rod end a p is the area of the rear end x p is the piston displacement relative to the cylinder the stiffness of a single tensioner can be obtained by taking the derivative of the tension force with respect to the relative displacement which is 4 k t n d f t d x p where n is the total number of the tensioner in the tension system the detailed derivation process of eq 3 and eq 4 is shown in appendix b 2 3 model of recoil response in this paper the riser is regarded as a spring mass damping system with three degrees of freedom in addition the following assumptions are accepted which are i the buoyancy is uniform distributed along the riser axial direction ii the discrete riser segments have the same axial stiffness iii the frictional resistance is evenly distributed over the three mass blocks the recoil analysis model is shown in fig 4 the whole riser is discretized into three mass blocks with m 1 m 2 and m 3 k t is the spring stiffness of top tensioner k r is the axial stiffness of the riser which derivation process is presented in appendix c f 1 f 2 and f 3 are the external force acting on the three mass blocks c 1 c 2 and c 3 are the damping coefficients of the three mass blocks x 0 t is the heave motion displacement of the piston x 1 x 2 and x 3 are the vibration displacement of the three mass blocks during recoil during actual recoil response process the tensioner has damping effect to preventing the riser from rising too fast however it is difficult to accurately estimate the damping effect of tensioner so the damping effect of tensioner is neglected in this paper the tensioner is idealized as a spring without damping the top boundary condition of the recoil response is the tension force generated by the tension system so the recoil response results calculated by this assumption may be some faster than that the damping effect of tensioner is considered therefore the control equation of the three mass blocks can be written as 5 m 1 x 1 f 1 k t x 1 c 1 x 1 k r x 2 x 1 c 2 x 2 x 1 m 2 x 2 f 2 k r x 2 x 1 c 2 x 2 x 1 c 3 x 3 x 2 k r x 3 x 2 m 3 x 3 f 3 k r x 3 x 2 c 3 x 3 x 2 the mass of the three blocks can be calculated by 6 m 1 m s l m b l b 3 m tensioner m 2 m s l m b l b 3 m 3 m s l m b l b 3 m lmrp where m s is the mass of riser per length in seawater l is the length of riser which equals to the water depth in this paper m b is the mass of buoyance module per length in seawater l b is the length of buoyance module m tensioner is the mass of top tension system which is the total mass of rod and piston of all tensioners m lmrp is the mass of the lmrp in seawater the external force on the three mass blocks can be written as 7 f 1 m 1 g f f 3 f d 1 f 2 m 2 g f f 3 f d 2 f 3 m 3 g f f 3 f d 3 f end where f end 1 2 ρ m a i n a a v 2 f d i i 1 2 3 is the damping force on the mass blocks induced by seawater which can be calculated by gobat 2006 meng et al 2018 8 f d i π 2 ρ w d r o c t x i x i i 1 2 3 where c t is the tangential drag coefficient and 0 015 is selected in this paper according to the published literature gobat 2006 meng et al 2018 since the recoil velocity is time varying the drag force on riser also changes with time in this paper the frictional resistance in the following discrete time is calculated by substituting the velocity in the previous discrete time into eq 8 the linear damping model is adopted and the damping coefficients on the three mass blocks are considered to be the same so the damping coefficients of the three mass blocks can be figured out through dividing the damping force by the length of the riser and the velocity of the recoil the matrix form of eq 5 is 9 m x c x k x f where m m 1 m 2 m 3 is the global mass matrix c c 1 c 2 c 2 0 c 2 c 2 c 3 c 3 0 c 3 c 3 is the global damping matrix k k t k r k r 0 k r k t k r k r 0 k r k r is the global stiffness matrix f f 1 f 2 f 3 t is the global force matrix 3 model solution this section presents the detailed solving process of eq 9 the eigenmatrix of eq 9 can be written as 10 b k ζ 2 m if the natural frequency is ζ one obtains 11 k ζ 2 m 0 that is 12 k t k r ζ 2 m 1 k r 0 k r k t k r ζ 2 m 2 k r 0 k r k r ζ 2 m 3 0 the three natural frequency ζ 1 ζ 2 and ζ 3 can be obtained after solving eq 12 the adjoint matrix of the eigenmatrix can be written as 13 adj b k t k r ζ 2 m 2 k r ζ 2 m 3 k r 2 k r k r ζ 2 m 3 k r 2 k r k r ζ 2 m 3 k t k r ζ 2 m 1 k r ζ 2 m 3 k r k t k r ζ 2 m 1 k r 2 k r k t k r ζ 2 m 1 k t k r ζ 2 m 1 k t k r ζ 2 m 2 k r 2 the three principal modes a 1 a 2 and a 3 can be figured out after substituting the three natural frequency into the adjoint matrix of the eigenmatrix then the principal mode matrix can be written as 14 a ζ a 1 a 2 a 3 due to the orthogonality of the mass matrix and stiffness matrix one obtains 15 a ζ t μ a ζ μ ζ a ζ t k a ζ k ζ where μ ζ diag m ζ 1 m ζ 2 m ζ 3 is the principal mass matrix k ζ diag k ζ 1 k ζ 2 k ζ 3 is the principal stiffness matrix thus the normal modes of the system can be written as 16 a n i 1 m ζ i a i i 1 2 3 so the modal matrix can be represented by 17 a n a n 1 a n 2 a n 3 before riser disconnection the three mass blocks have an initial displacement due to the axial elongation besides the initial velocity of the three mass blocks is 0 so the initial conditions of the recoil response are 18 x 0 0 δ l 2 δ l t x 0 0 0 0 t according to the mechanics of vibration the decoupled differential equation can be obtained through substitute x a n x n into the initial conditions which is 19 x n i 2 δ i ζ i x n i ζ i 2 x n i q n i sin ω t t i 1 2 3 where δ i is the damping ratios of each modes ω t is the heave motion frequency of the top tensioner q n i a n i t f i then the response of the system in the normal coordinates can be written as 20 x n i b n i sin ω t t ϕ i i 1 2 3 where ϕ i is the phase difference between the heave motion and the riser disconnection 21 b n i q n i ζ i 2 1 1 λ i 2 2 2 δ i λ i 2 λ i ω t ζ i ϕ i arctan 2 δ i λ i 1 λ i 2 therefore the recoil response the three mass blocks can be calculated by 22 x a n 1 x n 1 a n 2 x n 2 a n 3 x n 3 4 case study and analysis 4 1 results of the top tensioner taking an actual deepwater drilling as an example the calculation data are shown in table 1 in the case it is assumed that there is no phase difference between the heave motion and the disconnection moment besides the piston is in harmonic motion around its initial equilibrium position then the variation of the tension force and the stiffness calculated are shown in fig 5 and fig 6 respectively as shown in fig 5 the tension force varies approximately linearly with the piston displacement when the piston displacement is negative the riser moves downward the tension force and stiffness provided by the tensioner is maximum because the tensioner needs to provide more force to pull the riser up the stiffness of the tensioner decreases first and then increases with the piston displacement as shown in fig 6 the difficulty of riser moving downward increases if the piston displacement is negative further study shows that the measures which can increase the stiffness include reducing the diameter of the piston rod or increasing the diameter of the piston increasing the initial pressure of the rear end or increasing the initial pressure of the rod end reducing the volume of the rod end however the frequency has almost no influence on the tension force and stiffness this means that if the configuration of the tension system is given the tension force and stiffness are constant when the piston moves to a certain position which is not affected by the velocity and acceleration of the piston passing through this point 4 2 results of the mud discharge in wfcm the frictional resistance is needed firstly to calculate the whole column velocity while the whole column velocity is prerequisite to calculate the frictional resistance therefore in this paper an initial timestep usually less than 0 001s is given firstly during this timestep the whole fluid column is discharged only under the force of gravity the discharge velocity acceleration and the length of the column can be figured at the end of the initial timestep the results of the previous timesteps are imputed as the initial calculation conditions of the next timestep then the discharge parameters velocity acceleration length of the column and the frictional resistance in each timestep can be calculated according to eq a 1 to a 3 the calculation is completed until the length of the column is 0 according to this analysis procedure the calculation results of mud discharge are shown in fig 7 as shown in fig 7 the whole discharge process can be divided into two phases when the column is beginning to discharge the first phase the frictional resistance generated by the drilling mud dominates because the column length is maximum the acceleration is also the maximum as shown in fig 7 b as the discharge continues the velocity and frictional resistance increase as shown in fig 7 c and fig 7 a which makes the acceleration decrease as shown in fig 7 b however the acceleration is always downward in the first phase which results in the frictional resistance and velocity increase gradually when the frictional resistance increases to a certain value the discharge moves into the second phase during this phase the frictional resistance generated by seawater dominants due to the difference of seawater and drilling mud the frictional resistance of the whole column decreases however the discharge velocity still increases slowly as shown in fig 7 c during the whole process the length of drilling mud approximately decreases linearly in this example the whole discharge time is 157 5s the discharge time under different water depths is shown in table 2 then curve fitting is needed to get the analytical expression of the frictional resistance which is shown in fig 8 the sum of six sine expressions is used to fit the calculated frictional resistance on riser more sinusoidal expressions will bring higher precision certainly while the time and amount of computation needed increase also then the external forces on the three mass blocks can be obtained through substituting eq 6 eq 8 and the fitted frictional resistance into eq 7 4 3 results of the clearance between lmrp and bop according to the mechanical model and solving approach proposed in this paper calculation result of the clearance between the lmrp and the bop is shown in fig 9 as shown in fig 9 the riser moves upward under the combined action of elastic potential energy and the frictional resistance after disconnection as the recoil continues the elastic potential energy is gradually released the riser is compressed upward to the maximum position and then it starts to move downward due to the damping effect the recoil response is in form of attenuation vibration and will be weakened gradually the maximum clearance between the lmrp and the bop is 7 254m which occurs at 4 8s after disconnection the minimum clearance is 0 1172m occurs at 9 7s after disconnection which means that there is possibility of lmrp colliding with bop the final clearance between them equals to the axial elongation of the riser in static 4 4 sensitive analysis the riser recoil response is a complex vibration process which can be affected by many factors so parameter sensitivity analysis is helpful for a comprehensive understanding of the mechanical phenomenon and can provide countermeasures for optimization of the anti recoil system to ensure the safety of riser emergency disconnection 4 4 1 phase difference as mentioned above the heave motion of the dat is the boundary condition of the recoil response in this paper the heave motion is sinusoidal which is shown in fig 5 however the moment of disconnection and heave motion does not take place at the same time so there is a phase difference between them the clearance between the lmrp and the bop is shown is fig 10 if the phase difference changes from 0 to 330 as shown in fig 10 the phase difference has a significant influence on the recoil response for deepwater drilling it is indispensable to avoid the collision between the released lmrp and the bop to ensure the safety of the subsea wellhead therefore the minimum clearance between them is the most important issue table 3 presents the maximum and minimum clearance and the occurrence time under different phase difference as shown in table 3 when the phase difference is 60 the riser has the maximum upward displacement which is 15 12m occurring at 1 4s after disconnection when the phase difference is 180 it has the minimum upward displacement which is 7 22m occurring at 24 8s after disconnection when the phase difference is 90 it has the maximum downward displacement which is 10 25m occurring at 6 9s after disconnection when the phase difference is 60 it has the minimum upward displacement which is 1 67m occurring at 14 6s after disconnection therefore from the perspective of avoiding collision between the lmrp and the bop the most advantageous phase difference is 60 4 4 2 water depth emergency disconnection operations can be implemented in different ocean environment the recoil response of riser under different water depth when the phase difference is 0 is shown in fig 11 as shown in fig 11 with the increase of water depth the upward maximum and minimum clearance between the lmrp and bop gradually increase specifically when the water depth is 500m the vibration displacement of the lmrp is always above the bop the minimum clearance between them gradually decreases as the water depth increases when the water depth increases to 3000m the lmrp will vibrate below the bop this means that the deeper the water depth is the greater the possibility of collision between the lmrp and bop is 4 4 3 amplitude of the heave motion after emergency disconnection the riser top is still connected to the piston rod of the tensioner as shown in fig 3 it is forced to vibrate under the heave motion of the piston rod when the amplitude of the heave motion changes the clearance between them is shown in fig 12 as can be seen from fig 12 with increase of the amplitude both the maximum and the minimum clearance between them increase but the moment when the peak value appears is not changed however the peak value is very sensitive to the amplitude of the heave motion in this case when the amplitude increases from 2 21m to 13 26m the maximum clearance increases from 6 22m 4 8s after disconnection to 18 69m 4 8s after disconnection and the minimum clearance decreases from 1 24m 9 7s after disconnection to 10 36m 9 7s after disconnection therefore effective countermeasures should be taken to control the amplitude of heave motion to ensure the safety of the emergency disconnection 4 4 4 frequency of the heave motion the frequency is also a key parameter affecting the heave motion when the frequency changes from π 20 to π 2 the clearance between the lmrp and bop is shown in fig 13 as shown in fig 13 with the increase of frequency the maximum clearance decreases first and then increases while the minimum clearance increases and then decrease which means there is an optimal frequency making the lmrp be most unlikely collision with the bop the optimal frequency is codetermined by the riser configuration and the parameters of the top tension system 4 4 5 stiffness of the dat in the above analysis the heave motion of the dat is simplified as a spring and the maximum spring stiffness is chosen to analyze the recoil response the clearance between the lmrp and the bop is shown in fig 14 under different situations of spring stiffness as shown in fig 14 when the dat stiffness increases from k to 4 k the variation of the clearance changes slightly however when the stiffness decreases from k to k 2 the maximum clearance increases form 7 25m 16 84m and the minimum clearance decrease from 0 12m to 7 51m so strict control measures should be taken to ensure the stability of stiffness 4 4 6 riser geometric size the riser geometric size will not only change the mass of the three blocks but also affect the frictional resistance which has a comprehensive influence on the recoil response fig 15 shows the response curve under the different conditions of riser outer diameter and wall thickness as shown in fig 15 riser geometric size has a slight influence on the clearance between the lmrp and the bop specifically under the condition of the same outer diameter the greater the wall thickness is the smaller the maximum clearance is when the wall thickness is constant the larger the outer diameter is the smaller the maximum clearance is 5 conclusions and further study 1 in this paper the mechanical model of mass spring damping system with three degrees of freedom has been established to analyze the riser recoil response the model can consider the influence of the frictional resistance during mud discharge and the elastic potential energy stored in the riser the clearance between the lmrp and bop after disconnection has been figured out 2 the phase difference has a significant influence on the recoil response the most favorable phase difference is 60 the possibility of collision between the lmrp and the bop increases with water depth and amplitude of the dat the top tensioner has an optimal heave motion frequency which is the most advantageous for implementing riser emergency disconnection corresponding measures should be taken to prevent spring stiffness of the dat from decreasing besides riser with large diameter and wall thickness is conducive to a safe disconnection 3 this paper can provide reference for the study on riser recoil response however further study should be implemented to obtain a comprehensive understanding of this mechanical phenomenon which include the fitting curve should be studied further to improve the accuracy of the frictional resistance during mud discharge innovative mechanical model should be established with consideration of the mass spring damping system with infinite degrees of freedom the mechanical state of riser after disconnection should be studied through 3 d dynamic model with consideration of the wave current effect to ensure no mechanical failure will occur in addition the safety of the moon pool is also needed to be assessed during the recoil response acknowledgements the authors gratefully acknowledge the financial support from the natural science foundation of china grant numbers 51804321 51821092 u1762214 and 51734010 this research is also supported by science foundation of china university of petroleum beijing no 00000 and also supported by other projects grant numbers 2017zx05005 005 007 2017zx05009 003 2016yfc0303303 and 2018yfb0605502 appendix d supplementary data the following is the supplementary data to this article oe d 19 00106 dataprofile oe d 19 00106 dataprofile appendix d supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 106406 appendix a the appendix shows the solving process of the frictional resistance on the riser inner wall during mud discharge the frictional resistance caused by drilling mud and seawater can be expressed as a 1 f r 1 δ p r 1 a a f r 2 δ p r 2 a a f d 1 δ p d 1 a a f d 2 δ p d 2 a a f p 1 δ p p 1 a i n f p 2 δ p p 2 a i n where δ p r 1 is the pressure drop between seawater and riser inner wall δ p r 2 is the pressure drop between drilling mud and riser inner wall δ p d 1 is the pressure drop between seawater and drill pipe outer wall δ p d 2 is the pressure drop between drilling mud and drill pipe outer wall δ p p 1 is the pressure drop between seawater and drill pipe inner wall δ p p 2 is the pressure drop between drilling mud and drill pipe inner wall a a π r r i 2 r s o 2 is the annular cross sectional area between riser and drill pipe r r i is the inner radius of riser r s o is the outer radius of riser a i n π r s i 2 is the inner area of drill pipe r s i is the inner radius of drill pipe according to the darcy weisbach equation the pressure drops can be calculated by a 2 δ p r 1 ρ w v 2 f w c 1 l w 2 r r i r s o δ p r 2 ρ m v 2 f m c 1 l m 2 r r i r s o δ p d 1 ρ w v 2 f w c 2 l w 2 r r i r s o δ p d 2 ρ m v 2 f m c 2 l m 2 r r i r s o δ p p 1 ρ w v 2 f w c 3 l w 4 r s i δ p p 2 ρ w v 2 f m c 3 l m 4 r s i where ρ w is the density of seawater ρ m is the density of drilling mud v is the discharge velocity of the whole column f w c 1 f w c 2 f w c 3 f m c 1 f m c 2 and f m c 3 are dimensionless coefficients which can be described by the haaland formula as shown in eq a 3 a 3 1 f w c 1 1 8 log 6 9 r e w ε 1 3 7 1 11 1 f w m 1 1 8 log 6 9 r e m ε 1 3 7 1 11 1 f w c 2 1 8 log 6 9 r e w ε 2 3 7 1 11 1 f w m 2 1 8 log 6 9 r e m ε 2 3 7 1 11 1 f w c 3 1 8 log 6 9 r e w ε 3 3 7 1 11 1 f w m 3 1 8 log 6 9 r e m ε 3 3 7 1 11 where r e w and r e m are reynolds number of seawater and drilling mud respectively ε 1 ε 2 and ε 3 are the relative roughness of riser inner wall riser outer wall and drill pipe inner wall considering that the riser outer wall is surrounded by seawater the pressure difference on the top and bottom surfaces of the whole column can be calculated by a 4 f t o p f p ρ m ρ w g l m in this paper we assume that the mud is discharged directly through the lmrp so the frontal force rinaldi and paȉ doussis 2010 can be written as a 5 f e n d 1 2 ρ m a a a i n v 2 appendix b the appendix presents the detailed derivation process of eq 3 and eq 4 the analysis model of tension force and stiffness is shown in fig b 1 the following assumptions are accepted to analyze the tension force and stiffness of the dat which are i it is assumed that the gas in the tension system conforms to the rule of adiabatic state ii the tension force is far greater than the weight of piston and piston rod so the weight of them is neglected iii the liquid in the hydraulic cylinder is incompressible and the leakage of it is ignored iv the damping effect of the piston is also neglected fig b 1 the analysis model of tension force and stiffness fig b 1 when the piston has displacement x p relative to the cylinder the volume of the rod end v h is b 1 v h v h i a r x p the volume of the rear end v l is b 2 v l v l i a p x p according to the first assumption one obtains b 3 p h i v h i n p h v h i a r x p n p l i v l i n p l v l i a p x p n so the tension force on the piston rod can be written as b 4 f t p h a r p l a p eq 3 can be obtained through substituting eq b 3 into eq b 4 the stiffness of a single tensioner can be obtained through taking derivative of the tension force with respect to the relative displacement in eq b 4 assume that all the tensioners are connected to the tensioner ring the model which is shown in fig b 2can be regarded as parallel springs with number of n fig b 2 the stiffness analysis model for parallel springs 2 fig b 2 supposing that the stiffness of each tensioner spring is k 1 k 2 k n and the elongation under the external force is x 0 then the external force can be written as b 5 f i 1 n k i x 0 therefore the total stiffness of the tension system is b 6 k t i 1 n k i x 0 x 0 i 1 n k i since the structure and parameters of each tensioner are the same the spring stiffness of each tensioner is the same accordingly so the total stiffness of the tension system can be obtained as shown in eq 4 appendix c this appendix shows the determination procedure of the riser axial stiffness the axial stiffness of the riser can be calculated according to the work of the external force equaling to the elastic strain energy which is c 1 0 l n 2 x 2 e a d x 1 2 k e δ l 2 where δ l is the total elongation of riser n x is the axial tension force along riser e is the elastic modulus of riser a is the cross sectional area of riser k e is the equivalent stiffness of the riser the axial tension force can be calculated by c 2 n x f 0 ω x where f 0 is the top tension which is 1 35 times the total weight of riser in sea water ω m s g ω b is the per length weight of riser in sea water ω b is the buoyancy so the axial elongation can be written as c 3 δ l 0 l n x e a d x then the axial stiffness can be obtained after substituting eq c 2 and eq c 3 into eq c 1 which is c 4 k e e a f 0 2 l ω 2 l 3 f 0 ω f 0 ω l 2 2 if γ represents the over tension coefficient of riser eq c 4 can be written as c 5 k e γ 2 γ 1 3 γ 2 γ 1 4 e a l in this paper the mechanical model of stiffness is obtained through dividing the whole riser into 2 parallel segments which is shown in fig c 1 fig c 1 the analysis model for riser axial stiffness 3 fig c 1 since the axial force is evenly distributed along riser one obtains c 6 n 1 n 3 2 k e n 1 n 2 2 k r n 2 n 3 2 k r where n 1 n 2 and n 3 are the external force on the three mass blocks according to eq c 6 one obtains c 7 k r n 1 2 n 2 n 3 n 1 n 3 k e due to f 0 1 γ ω l n 1 1 γ ω l n 2 1 2 γ ω l and n 3 γ ω l thus the axial stiffness of each segment can be written as c 8 k r 1 γ 2 1 2 γ γ 1 γ γ k e 2 k e 
22521,in this paper the mechanical model and governing equations for the recoil response of deepwater drilling riser are established based on the mass spring damping system with three degrees of freedom the direct acting tensioner dat and axial elongation of riser before disconnection the are taken as the boundary condition and initial condition of the mechanical model respectively the model can consider the influence of frictional resistance induced by drilling mud discharge and elastic potential energy due to axial elongation on the recoil response the clearance between the low marine riser package lmrp and the blowout preventer bop after disconnection is figured out through solving the governing equations then the parameter sensitivity analysis is given to present a comprehensive understanding of the recoil response analysis results show that the phase difference has a significant influence on the recoil response the most favorable phase difference is 60 the possibility of collision between the lmrp and the bop increases with water depth and amplitude of the dat the top tensioner has an optimal heave motion frequency which is the most advantageous for implementing riser emergency disconnection corresponding measures should be taken to prevent spring stiffness of the dat from decreasing besides riser with large diameter and wall thickness is conducive to a safe disconnection keywords deepwater drilling riser emergency disconnection recoil response mechanical characteristics influence factors control measures 1 introduction in deepwater drilling emergency disconnection of riser between the lmrp and bop is necessary under extreme marine environment before disconnection elastic potential energy has been stored in riser due to the axial elongation in normal drilling so the riser will move upward like a spring after the disconnection which is called recoil response if the recoil control is improper the drilling platform yang 2013 the riser and the subsea wellhead miller et al 1998 gao and wang 2016 will be threatened therefore the recoil response of emergency disconnection is an important issue for the safety of deepwater drilling in the stipulation of the american bureau of shipping abs the recoil analysis should cover the following issues abs 2017 i establish the initial riser overpull tension and recoil settings so that the lmrp will be able to clear the bop stack for a specific wave condition ii establish the riser tension and recoil and or anti recoil settings so that the continuous riser movement will not cause the total collapse of the telescopic joint slacked wire tensioners or compressed direct acting tensioners negative tension along the riser string or impact back to bop stack for a specific wave condition iii establish a set of recoil control parameters for a range of environmental conditions if required therefore a large number of scholars have done studies on the recoil analysis young et al 1992a and 1992b have described an analysis method to deal with the recoil problem and how to design an anti recoil system puccio et al 1998 have illustrated some significant variables affecting the velocity and displacement of the riser string and lmrp during an emergency disconnect sequence matthew et al 2004 have proposed a recoil analysis of riser in a 4 308 ft water depth to determine the appropriate drilling riser configurations grytoyr et al 2009 2010 and 2011 have presented a methodology for the dynamic analysis of marine drilling riser disconnect and recoil using the finite element fe programs lang et al 2009 have described the development of a disconnect and recoil analysis software tool some industrial standard iso tr 13624 2 2009 has also involved the riser recoil response which has provided reference and guidance of the recoil analysis brynestad 2012 has investigated the drive off and weak link of disconnection riser with pipe in pipe model ma et al 2013 have presented the behavior of a 12 000 ft drilling riser during an emergency disconnection based on a 3 d nonlinear fe model grønevik 2013 has carried out recoil analyses using the computer program riflex zhang 2014 have analyzed the main factors that affect the recoil response and given simulations of a 1 500m riser with ansys software wang et al 2018 have given recoil response simulation of 1 500m riser with ansys aqwa and discussed the influence of mud discharge on the recoil characteristics due to the importance of the top tensioner in the riser recoil response many scholars have studied the mechanical characteristics of the tensioner dyngvold 2011 has proposed a mathematical model to analyze a wireline riser tensioner system and investigated the response of the system under different load cases zhang et al 2013a b have presented some simulations on the dat based on the ame sim framework pestana et al 2016 have studied the tensioner behavior during riser emergency disconnection using nonlinear parallel spring damper scalar elements in orcaflex software besides some studies have been done with consideration of the influence of mud discharge on the recoil response li et al 2015 and 2016 have given a numerical procedure to simulate the mud discharge and seawater refilling and given some discussion through a case study meng et al 2018 have studied the recoil response of a deepwater drilling riser through a mass spring damping system with two degrees of freedom hock and young 1993 2000 have presented the design installation and testing procedures of an anti recoil system in 6 000 ft water depth he et al 2016 have analyzed the composition of recoil control system and proposed a control method through taking the dat as the research objective at present some progress has been made in the recoil research however published results under different methods and assumptions are very different and the detailed solution process has not been reported until now therefore a new recoil analysis model has been established based on the previous study meng et al 2018 the mechanical behavior and key influence factors of the recoil response have been obtained with consideration of the drilling mud discharge and heave motion of the dat this research can provide reference for the optimal design of the dat and emergency disconnection control the remainder of the paper is organized as follows the coordinate system and mechanical models include the drilling mud discharge model the dat model and the recoil response model are introduced in section 2 the detailed model solution process is presented in section 3 the case study and parameters sensitivity analysis are shown in section 4 the conclusions drawn and suggestions on the further study are given in section 5 2 mechanical models in normal operation deepwater drilling riser will generate axial elongation due to the top tension gravity and buoyancy the elongation begins to spring back when the emergency disconnection occurs considering the heave movement of the top tensioner the recoil response belongs to the forced vibration of an elastic body with infinite degrees of freedom under initial displacement the following assumptions are accepted in order to establish the analysis model in this paper i since the riser recoil response is far stronger than its lateral characteristics it is considered that only axial vibration exists during the recoil ii the influence of buoyancy modules on the riser stiffness is ignored iii the drill pipe and the riser are concentric during the recoil response accordingly the mechanical model and the coordinate system of the recoil analysis are shown in fig 1 as shown in fig 1 the coordinate system of x 1 o 1 y 1 represents the riser axial elongation where the origin of the coordinate is chosen at the connection point of the top tensioner and the riser the coordinate system of x 2 o 2 y 2 stands for the clearance between the lmrp and the bop during recoil where the origin of the coordinate is selected as the joint point of the lmrp and the bop the coordinate system of x 3 t represents the motion of the piston in dat l 0 is the maximum clearance between lmrp and bop in the following sections a prime stands for x and an overdot represents t where t is time unless otherwise specified all parameters in this paper are in the international system of units 2 1 model of mud discharge during the recoil the drilling mud is discharged downward and the riser is refilled by seawater which makes the riser be subjected to the frictional resistance accurate calculation of the frictional resistance is the requirement for the recoil response in the actual configuration riser is often equipped with fill up valves although the opening of one valve is usually small compared to the internal diameter of the riser the number of valves and total volume flowing into the riser can guarantee that the mud is replaced by seawater at the same volumetric rate this is a basic requirement to prevent the riser from being collapse so the whole fluid column model wfcm as shown in fig 2 is used to describe the mud discharge process grønevik 2013 meng et al 2018 in this paper the influence of drill pipe in the riser on the frictional resistance is considered which is a significant different from the previous work according to the newton s second law the dynamic equilibrium equation of the drilling mud can be written as 1 m w l w m m l m a d g w g m f t o p f p f r 1 f r 2 f d 1 f d 2 f p 1 f p 2 f e n d where m w is the mass of seawater in riser per length m m is the mass of drilling mud in riser per length l w is the length of seawater in riser l m is the length of drilling mud in riser a d is the acceleration of the whole fluid column g w is the weight of seawater in the riser g m is the weight of drilling mud in the riser f t o p is the force on the top of seawater from the fill up valves f p is the force on the bottom of drilling mud f e n d is the frontal force on the bottom of the drilling mud due to the water hammer effect based on bernoulli s equation f r 1 is the frictional resistance between the seawater and the riser inner wall f r 2 is the frictional resistance between the drilling mud and the riser inner wall f d 1 is the frictional resistance between the seawater and the outer wall of the drill pipe f d 2 is the frictional resistance between the drilling mud and the outer wall of the drill pipe f p 1 is the frictional resistance between the seawater and the inner wall of the drill pipe f p 2 is the frictional resistance between the drilling mud and the inner wall of the drill pipe therefore the total frictional force on riser inner wall f f can be written as 2 f f f r 1 f r 2 the detailed derivation process of eq 2 is presented in appendix a 2 2 model of the dat the heave motion and stiffness of the top tensioner must be obtained to analyze the boundary conditions of the recoil response in this paper the dat is taken as the research object which working principle zhao et al 2010 is shown in fig 3 the tension force is provided by the pressure difference in the cylinder the bottom of the rod end is connected to the tensioner ring where the hydraulic pressure is provided by the high pressure accumulator the accumulator can store and convert the energy produced by heave motion of the piston which can maintain the stability of the tension force the rear end is connected to the low pressure npv the tension force generated by a single tensioner f t can be calculated by 3 f t p h i v h i n v h i a r x p n a r p l i v l i n v l i a p x p n a p where p h i is the initial pressure of the rod end p l i is the initial pressure of the rear end v h i is the initial volume of the rod end v l i is the initial volume of the rear end n is the gas constan and 1 3 is selected in this paper a r is the area of the rod end a p is the area of the rear end x p is the piston displacement relative to the cylinder the stiffness of a single tensioner can be obtained by taking the derivative of the tension force with respect to the relative displacement which is 4 k t n d f t d x p where n is the total number of the tensioner in the tension system the detailed derivation process of eq 3 and eq 4 is shown in appendix b 2 3 model of recoil response in this paper the riser is regarded as a spring mass damping system with three degrees of freedom in addition the following assumptions are accepted which are i the buoyancy is uniform distributed along the riser axial direction ii the discrete riser segments have the same axial stiffness iii the frictional resistance is evenly distributed over the three mass blocks the recoil analysis model is shown in fig 4 the whole riser is discretized into three mass blocks with m 1 m 2 and m 3 k t is the spring stiffness of top tensioner k r is the axial stiffness of the riser which derivation process is presented in appendix c f 1 f 2 and f 3 are the external force acting on the three mass blocks c 1 c 2 and c 3 are the damping coefficients of the three mass blocks x 0 t is the heave motion displacement of the piston x 1 x 2 and x 3 are the vibration displacement of the three mass blocks during recoil during actual recoil response process the tensioner has damping effect to preventing the riser from rising too fast however it is difficult to accurately estimate the damping effect of tensioner so the damping effect of tensioner is neglected in this paper the tensioner is idealized as a spring without damping the top boundary condition of the recoil response is the tension force generated by the tension system so the recoil response results calculated by this assumption may be some faster than that the damping effect of tensioner is considered therefore the control equation of the three mass blocks can be written as 5 m 1 x 1 f 1 k t x 1 c 1 x 1 k r x 2 x 1 c 2 x 2 x 1 m 2 x 2 f 2 k r x 2 x 1 c 2 x 2 x 1 c 3 x 3 x 2 k r x 3 x 2 m 3 x 3 f 3 k r x 3 x 2 c 3 x 3 x 2 the mass of the three blocks can be calculated by 6 m 1 m s l m b l b 3 m tensioner m 2 m s l m b l b 3 m 3 m s l m b l b 3 m lmrp where m s is the mass of riser per length in seawater l is the length of riser which equals to the water depth in this paper m b is the mass of buoyance module per length in seawater l b is the length of buoyance module m tensioner is the mass of top tension system which is the total mass of rod and piston of all tensioners m lmrp is the mass of the lmrp in seawater the external force on the three mass blocks can be written as 7 f 1 m 1 g f f 3 f d 1 f 2 m 2 g f f 3 f d 2 f 3 m 3 g f f 3 f d 3 f end where f end 1 2 ρ m a i n a a v 2 f d i i 1 2 3 is the damping force on the mass blocks induced by seawater which can be calculated by gobat 2006 meng et al 2018 8 f d i π 2 ρ w d r o c t x i x i i 1 2 3 where c t is the tangential drag coefficient and 0 015 is selected in this paper according to the published literature gobat 2006 meng et al 2018 since the recoil velocity is time varying the drag force on riser also changes with time in this paper the frictional resistance in the following discrete time is calculated by substituting the velocity in the previous discrete time into eq 8 the linear damping model is adopted and the damping coefficients on the three mass blocks are considered to be the same so the damping coefficients of the three mass blocks can be figured out through dividing the damping force by the length of the riser and the velocity of the recoil the matrix form of eq 5 is 9 m x c x k x f where m m 1 m 2 m 3 is the global mass matrix c c 1 c 2 c 2 0 c 2 c 2 c 3 c 3 0 c 3 c 3 is the global damping matrix k k t k r k r 0 k r k t k r k r 0 k r k r is the global stiffness matrix f f 1 f 2 f 3 t is the global force matrix 3 model solution this section presents the detailed solving process of eq 9 the eigenmatrix of eq 9 can be written as 10 b k ζ 2 m if the natural frequency is ζ one obtains 11 k ζ 2 m 0 that is 12 k t k r ζ 2 m 1 k r 0 k r k t k r ζ 2 m 2 k r 0 k r k r ζ 2 m 3 0 the three natural frequency ζ 1 ζ 2 and ζ 3 can be obtained after solving eq 12 the adjoint matrix of the eigenmatrix can be written as 13 adj b k t k r ζ 2 m 2 k r ζ 2 m 3 k r 2 k r k r ζ 2 m 3 k r 2 k r k r ζ 2 m 3 k t k r ζ 2 m 1 k r ζ 2 m 3 k r k t k r ζ 2 m 1 k r 2 k r k t k r ζ 2 m 1 k t k r ζ 2 m 1 k t k r ζ 2 m 2 k r 2 the three principal modes a 1 a 2 and a 3 can be figured out after substituting the three natural frequency into the adjoint matrix of the eigenmatrix then the principal mode matrix can be written as 14 a ζ a 1 a 2 a 3 due to the orthogonality of the mass matrix and stiffness matrix one obtains 15 a ζ t μ a ζ μ ζ a ζ t k a ζ k ζ where μ ζ diag m ζ 1 m ζ 2 m ζ 3 is the principal mass matrix k ζ diag k ζ 1 k ζ 2 k ζ 3 is the principal stiffness matrix thus the normal modes of the system can be written as 16 a n i 1 m ζ i a i i 1 2 3 so the modal matrix can be represented by 17 a n a n 1 a n 2 a n 3 before riser disconnection the three mass blocks have an initial displacement due to the axial elongation besides the initial velocity of the three mass blocks is 0 so the initial conditions of the recoil response are 18 x 0 0 δ l 2 δ l t x 0 0 0 0 t according to the mechanics of vibration the decoupled differential equation can be obtained through substitute x a n x n into the initial conditions which is 19 x n i 2 δ i ζ i x n i ζ i 2 x n i q n i sin ω t t i 1 2 3 where δ i is the damping ratios of each modes ω t is the heave motion frequency of the top tensioner q n i a n i t f i then the response of the system in the normal coordinates can be written as 20 x n i b n i sin ω t t ϕ i i 1 2 3 where ϕ i is the phase difference between the heave motion and the riser disconnection 21 b n i q n i ζ i 2 1 1 λ i 2 2 2 δ i λ i 2 λ i ω t ζ i ϕ i arctan 2 δ i λ i 1 λ i 2 therefore the recoil response the three mass blocks can be calculated by 22 x a n 1 x n 1 a n 2 x n 2 a n 3 x n 3 4 case study and analysis 4 1 results of the top tensioner taking an actual deepwater drilling as an example the calculation data are shown in table 1 in the case it is assumed that there is no phase difference between the heave motion and the disconnection moment besides the piston is in harmonic motion around its initial equilibrium position then the variation of the tension force and the stiffness calculated are shown in fig 5 and fig 6 respectively as shown in fig 5 the tension force varies approximately linearly with the piston displacement when the piston displacement is negative the riser moves downward the tension force and stiffness provided by the tensioner is maximum because the tensioner needs to provide more force to pull the riser up the stiffness of the tensioner decreases first and then increases with the piston displacement as shown in fig 6 the difficulty of riser moving downward increases if the piston displacement is negative further study shows that the measures which can increase the stiffness include reducing the diameter of the piston rod or increasing the diameter of the piston increasing the initial pressure of the rear end or increasing the initial pressure of the rod end reducing the volume of the rod end however the frequency has almost no influence on the tension force and stiffness this means that if the configuration of the tension system is given the tension force and stiffness are constant when the piston moves to a certain position which is not affected by the velocity and acceleration of the piston passing through this point 4 2 results of the mud discharge in wfcm the frictional resistance is needed firstly to calculate the whole column velocity while the whole column velocity is prerequisite to calculate the frictional resistance therefore in this paper an initial timestep usually less than 0 001s is given firstly during this timestep the whole fluid column is discharged only under the force of gravity the discharge velocity acceleration and the length of the column can be figured at the end of the initial timestep the results of the previous timesteps are imputed as the initial calculation conditions of the next timestep then the discharge parameters velocity acceleration length of the column and the frictional resistance in each timestep can be calculated according to eq a 1 to a 3 the calculation is completed until the length of the column is 0 according to this analysis procedure the calculation results of mud discharge are shown in fig 7 as shown in fig 7 the whole discharge process can be divided into two phases when the column is beginning to discharge the first phase the frictional resistance generated by the drilling mud dominates because the column length is maximum the acceleration is also the maximum as shown in fig 7 b as the discharge continues the velocity and frictional resistance increase as shown in fig 7 c and fig 7 a which makes the acceleration decrease as shown in fig 7 b however the acceleration is always downward in the first phase which results in the frictional resistance and velocity increase gradually when the frictional resistance increases to a certain value the discharge moves into the second phase during this phase the frictional resistance generated by seawater dominants due to the difference of seawater and drilling mud the frictional resistance of the whole column decreases however the discharge velocity still increases slowly as shown in fig 7 c during the whole process the length of drilling mud approximately decreases linearly in this example the whole discharge time is 157 5s the discharge time under different water depths is shown in table 2 then curve fitting is needed to get the analytical expression of the frictional resistance which is shown in fig 8 the sum of six sine expressions is used to fit the calculated frictional resistance on riser more sinusoidal expressions will bring higher precision certainly while the time and amount of computation needed increase also then the external forces on the three mass blocks can be obtained through substituting eq 6 eq 8 and the fitted frictional resistance into eq 7 4 3 results of the clearance between lmrp and bop according to the mechanical model and solving approach proposed in this paper calculation result of the clearance between the lmrp and the bop is shown in fig 9 as shown in fig 9 the riser moves upward under the combined action of elastic potential energy and the frictional resistance after disconnection as the recoil continues the elastic potential energy is gradually released the riser is compressed upward to the maximum position and then it starts to move downward due to the damping effect the recoil response is in form of attenuation vibration and will be weakened gradually the maximum clearance between the lmrp and the bop is 7 254m which occurs at 4 8s after disconnection the minimum clearance is 0 1172m occurs at 9 7s after disconnection which means that there is possibility of lmrp colliding with bop the final clearance between them equals to the axial elongation of the riser in static 4 4 sensitive analysis the riser recoil response is a complex vibration process which can be affected by many factors so parameter sensitivity analysis is helpful for a comprehensive understanding of the mechanical phenomenon and can provide countermeasures for optimization of the anti recoil system to ensure the safety of riser emergency disconnection 4 4 1 phase difference as mentioned above the heave motion of the dat is the boundary condition of the recoil response in this paper the heave motion is sinusoidal which is shown in fig 5 however the moment of disconnection and heave motion does not take place at the same time so there is a phase difference between them the clearance between the lmrp and the bop is shown is fig 10 if the phase difference changes from 0 to 330 as shown in fig 10 the phase difference has a significant influence on the recoil response for deepwater drilling it is indispensable to avoid the collision between the released lmrp and the bop to ensure the safety of the subsea wellhead therefore the minimum clearance between them is the most important issue table 3 presents the maximum and minimum clearance and the occurrence time under different phase difference as shown in table 3 when the phase difference is 60 the riser has the maximum upward displacement which is 15 12m occurring at 1 4s after disconnection when the phase difference is 180 it has the minimum upward displacement which is 7 22m occurring at 24 8s after disconnection when the phase difference is 90 it has the maximum downward displacement which is 10 25m occurring at 6 9s after disconnection when the phase difference is 60 it has the minimum upward displacement which is 1 67m occurring at 14 6s after disconnection therefore from the perspective of avoiding collision between the lmrp and the bop the most advantageous phase difference is 60 4 4 2 water depth emergency disconnection operations can be implemented in different ocean environment the recoil response of riser under different water depth when the phase difference is 0 is shown in fig 11 as shown in fig 11 with the increase of water depth the upward maximum and minimum clearance between the lmrp and bop gradually increase specifically when the water depth is 500m the vibration displacement of the lmrp is always above the bop the minimum clearance between them gradually decreases as the water depth increases when the water depth increases to 3000m the lmrp will vibrate below the bop this means that the deeper the water depth is the greater the possibility of collision between the lmrp and bop is 4 4 3 amplitude of the heave motion after emergency disconnection the riser top is still connected to the piston rod of the tensioner as shown in fig 3 it is forced to vibrate under the heave motion of the piston rod when the amplitude of the heave motion changes the clearance between them is shown in fig 12 as can be seen from fig 12 with increase of the amplitude both the maximum and the minimum clearance between them increase but the moment when the peak value appears is not changed however the peak value is very sensitive to the amplitude of the heave motion in this case when the amplitude increases from 2 21m to 13 26m the maximum clearance increases from 6 22m 4 8s after disconnection to 18 69m 4 8s after disconnection and the minimum clearance decreases from 1 24m 9 7s after disconnection to 10 36m 9 7s after disconnection therefore effective countermeasures should be taken to control the amplitude of heave motion to ensure the safety of the emergency disconnection 4 4 4 frequency of the heave motion the frequency is also a key parameter affecting the heave motion when the frequency changes from π 20 to π 2 the clearance between the lmrp and bop is shown in fig 13 as shown in fig 13 with the increase of frequency the maximum clearance decreases first and then increases while the minimum clearance increases and then decrease which means there is an optimal frequency making the lmrp be most unlikely collision with the bop the optimal frequency is codetermined by the riser configuration and the parameters of the top tension system 4 4 5 stiffness of the dat in the above analysis the heave motion of the dat is simplified as a spring and the maximum spring stiffness is chosen to analyze the recoil response the clearance between the lmrp and the bop is shown in fig 14 under different situations of spring stiffness as shown in fig 14 when the dat stiffness increases from k to 4 k the variation of the clearance changes slightly however when the stiffness decreases from k to k 2 the maximum clearance increases form 7 25m 16 84m and the minimum clearance decrease from 0 12m to 7 51m so strict control measures should be taken to ensure the stability of stiffness 4 4 6 riser geometric size the riser geometric size will not only change the mass of the three blocks but also affect the frictional resistance which has a comprehensive influence on the recoil response fig 15 shows the response curve under the different conditions of riser outer diameter and wall thickness as shown in fig 15 riser geometric size has a slight influence on the clearance between the lmrp and the bop specifically under the condition of the same outer diameter the greater the wall thickness is the smaller the maximum clearance is when the wall thickness is constant the larger the outer diameter is the smaller the maximum clearance is 5 conclusions and further study 1 in this paper the mechanical model of mass spring damping system with three degrees of freedom has been established to analyze the riser recoil response the model can consider the influence of the frictional resistance during mud discharge and the elastic potential energy stored in the riser the clearance between the lmrp and bop after disconnection has been figured out 2 the phase difference has a significant influence on the recoil response the most favorable phase difference is 60 the possibility of collision between the lmrp and the bop increases with water depth and amplitude of the dat the top tensioner has an optimal heave motion frequency which is the most advantageous for implementing riser emergency disconnection corresponding measures should be taken to prevent spring stiffness of the dat from decreasing besides riser with large diameter and wall thickness is conducive to a safe disconnection 3 this paper can provide reference for the study on riser recoil response however further study should be implemented to obtain a comprehensive understanding of this mechanical phenomenon which include the fitting curve should be studied further to improve the accuracy of the frictional resistance during mud discharge innovative mechanical model should be established with consideration of the mass spring damping system with infinite degrees of freedom the mechanical state of riser after disconnection should be studied through 3 d dynamic model with consideration of the wave current effect to ensure no mechanical failure will occur in addition the safety of the moon pool is also needed to be assessed during the recoil response acknowledgements the authors gratefully acknowledge the financial support from the natural science foundation of china grant numbers 51804321 51821092 u1762214 and 51734010 this research is also supported by science foundation of china university of petroleum beijing no 00000 and also supported by other projects grant numbers 2017zx05005 005 007 2017zx05009 003 2016yfc0303303 and 2018yfb0605502 appendix d supplementary data the following is the supplementary data to this article oe d 19 00106 dataprofile oe d 19 00106 dataprofile appendix d supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 106406 appendix a the appendix shows the solving process of the frictional resistance on the riser inner wall during mud discharge the frictional resistance caused by drilling mud and seawater can be expressed as a 1 f r 1 δ p r 1 a a f r 2 δ p r 2 a a f d 1 δ p d 1 a a f d 2 δ p d 2 a a f p 1 δ p p 1 a i n f p 2 δ p p 2 a i n where δ p r 1 is the pressure drop between seawater and riser inner wall δ p r 2 is the pressure drop between drilling mud and riser inner wall δ p d 1 is the pressure drop between seawater and drill pipe outer wall δ p d 2 is the pressure drop between drilling mud and drill pipe outer wall δ p p 1 is the pressure drop between seawater and drill pipe inner wall δ p p 2 is the pressure drop between drilling mud and drill pipe inner wall a a π r r i 2 r s o 2 is the annular cross sectional area between riser and drill pipe r r i is the inner radius of riser r s o is the outer radius of riser a i n π r s i 2 is the inner area of drill pipe r s i is the inner radius of drill pipe according to the darcy weisbach equation the pressure drops can be calculated by a 2 δ p r 1 ρ w v 2 f w c 1 l w 2 r r i r s o δ p r 2 ρ m v 2 f m c 1 l m 2 r r i r s o δ p d 1 ρ w v 2 f w c 2 l w 2 r r i r s o δ p d 2 ρ m v 2 f m c 2 l m 2 r r i r s o δ p p 1 ρ w v 2 f w c 3 l w 4 r s i δ p p 2 ρ w v 2 f m c 3 l m 4 r s i where ρ w is the density of seawater ρ m is the density of drilling mud v is the discharge velocity of the whole column f w c 1 f w c 2 f w c 3 f m c 1 f m c 2 and f m c 3 are dimensionless coefficients which can be described by the haaland formula as shown in eq a 3 a 3 1 f w c 1 1 8 log 6 9 r e w ε 1 3 7 1 11 1 f w m 1 1 8 log 6 9 r e m ε 1 3 7 1 11 1 f w c 2 1 8 log 6 9 r e w ε 2 3 7 1 11 1 f w m 2 1 8 log 6 9 r e m ε 2 3 7 1 11 1 f w c 3 1 8 log 6 9 r e w ε 3 3 7 1 11 1 f w m 3 1 8 log 6 9 r e m ε 3 3 7 1 11 where r e w and r e m are reynolds number of seawater and drilling mud respectively ε 1 ε 2 and ε 3 are the relative roughness of riser inner wall riser outer wall and drill pipe inner wall considering that the riser outer wall is surrounded by seawater the pressure difference on the top and bottom surfaces of the whole column can be calculated by a 4 f t o p f p ρ m ρ w g l m in this paper we assume that the mud is discharged directly through the lmrp so the frontal force rinaldi and paȉ doussis 2010 can be written as a 5 f e n d 1 2 ρ m a a a i n v 2 appendix b the appendix presents the detailed derivation process of eq 3 and eq 4 the analysis model of tension force and stiffness is shown in fig b 1 the following assumptions are accepted to analyze the tension force and stiffness of the dat which are i it is assumed that the gas in the tension system conforms to the rule of adiabatic state ii the tension force is far greater than the weight of piston and piston rod so the weight of them is neglected iii the liquid in the hydraulic cylinder is incompressible and the leakage of it is ignored iv the damping effect of the piston is also neglected fig b 1 the analysis model of tension force and stiffness fig b 1 when the piston has displacement x p relative to the cylinder the volume of the rod end v h is b 1 v h v h i a r x p the volume of the rear end v l is b 2 v l v l i a p x p according to the first assumption one obtains b 3 p h i v h i n p h v h i a r x p n p l i v l i n p l v l i a p x p n so the tension force on the piston rod can be written as b 4 f t p h a r p l a p eq 3 can be obtained through substituting eq b 3 into eq b 4 the stiffness of a single tensioner can be obtained through taking derivative of the tension force with respect to the relative displacement in eq b 4 assume that all the tensioners are connected to the tensioner ring the model which is shown in fig b 2can be regarded as parallel springs with number of n fig b 2 the stiffness analysis model for parallel springs 2 fig b 2 supposing that the stiffness of each tensioner spring is k 1 k 2 k n and the elongation under the external force is x 0 then the external force can be written as b 5 f i 1 n k i x 0 therefore the total stiffness of the tension system is b 6 k t i 1 n k i x 0 x 0 i 1 n k i since the structure and parameters of each tensioner are the same the spring stiffness of each tensioner is the same accordingly so the total stiffness of the tension system can be obtained as shown in eq 4 appendix c this appendix shows the determination procedure of the riser axial stiffness the axial stiffness of the riser can be calculated according to the work of the external force equaling to the elastic strain energy which is c 1 0 l n 2 x 2 e a d x 1 2 k e δ l 2 where δ l is the total elongation of riser n x is the axial tension force along riser e is the elastic modulus of riser a is the cross sectional area of riser k e is the equivalent stiffness of the riser the axial tension force can be calculated by c 2 n x f 0 ω x where f 0 is the top tension which is 1 35 times the total weight of riser in sea water ω m s g ω b is the per length weight of riser in sea water ω b is the buoyancy so the axial elongation can be written as c 3 δ l 0 l n x e a d x then the axial stiffness can be obtained after substituting eq c 2 and eq c 3 into eq c 1 which is c 4 k e e a f 0 2 l ω 2 l 3 f 0 ω f 0 ω l 2 2 if γ represents the over tension coefficient of riser eq c 4 can be written as c 5 k e γ 2 γ 1 3 γ 2 γ 1 4 e a l in this paper the mechanical model of stiffness is obtained through dividing the whole riser into 2 parallel segments which is shown in fig c 1 fig c 1 the analysis model for riser axial stiffness 3 fig c 1 since the axial force is evenly distributed along riser one obtains c 6 n 1 n 3 2 k e n 1 n 2 2 k r n 2 n 3 2 k r where n 1 n 2 and n 3 are the external force on the three mass blocks according to eq c 6 one obtains c 7 k r n 1 2 n 2 n 3 n 1 n 3 k e due to f 0 1 γ ω l n 1 1 γ ω l n 2 1 2 γ ω l and n 3 γ ω l thus the axial stiffness of each segment can be written as c 8 k r 1 γ 2 1 2 γ γ 1 γ γ k e 2 k e 
22522,this paper addresses the problem of enabling a constant velocity observer to track a maneuvering target using inequality constraints in this paper an observer measures the bearing of sound emitted from the target at each time step we consider an observer which can access the inequality constraints imposed on target s speed range target s course or target location as far as we know this paper is unique in making a constant velocity observer which measures the bearing angle of a maneuvering target track the target assisted by range course speed or target location constraints the observer restarts the filter using inequality constraints to reduce the estimation error considerably even after the filter diverges as the observer restarts the filter stored target information is reused by running the filter backward in time we verify the effectiveness of our filter restart approach by comparing it with the interacting multiple model imm kalman filter using matlab simulations keywords target tracking inequality constraints maneuvering target tracking bearings only target motion analysis 1 introduction this paper addresses the problem of enabling a constant velocity observer to track a maneuvering target using inequality constraints in underwater environments radio signal is easily dissipated but sound energy is not thus an observer measures the bearing of sound emitted from the target at each time step as an observer we can consider an autonomous underwater vehicle equipped with sonar systems to measure the bearing of sound emitted from a target e g ship or submarine this paper handles the case where inequality constraints are used for the target trajectory estimation in the case where an observer uses bearing measurements only this problem is called the bearing only target motion analysis botma and arises in various military applications related to target tracking this paper assumes that the target and the observer are constrained to stay on the 2d plane since this 2d assumption is usually used in underwater botma problems karlsson and gustafsson 2005 peach 1995 clark et al 2007 aidala and hammel 1983 kim et al 2017 botma problem handles the situation where the distance between the target and the observer is not known initially 1 1 as a method to reduce the initial range estimation error efficiently the range parameterized extended kalman filter rpekf was developed karlsson and gustafsson 2005 peach 1995 the rpekf consists of a number of independent ekfs in the cartesian coordinates each with a different initial range estimate and the combined estimate is obtained as a weighted sum of individual ekf outputs peach 1995 karlsson and gustafsson 2005 however reducing the initial range estimation error is not within the scope of this paper the botma is a nonlinear estimation problem as such requires various nonlinear filtering techniques for its solution clark et al 2007 wan et al 2010a jiang and cai 2017 simon 2006 aidala and hammel 1983 kim et al 2017 kim 2019a ristic 2019 in the botma problem it is commonly assumed that a target moves with a constant velocity cv karlsson and gustafsson 2005 as the target maneuvers a tracking filter assuming a cv target diverges tracking a maneuvering target using bearing measurements such as sonar is a challenging problem kim and hong 2004 wan et al 2010a wang et al 2011 yang et al 2016 liang qun et al 2015 quan et al 2014 martino et al 2018 andrieu et al 2010 bazzani et al 2009 kim 2019a interacting multiple model imm kalman filters were commonly used for tracking a maneuvering target kim and hong 2004 wan et al 2010a yuan et al 2015 bi and ren 2008 however in the case where the target estimation has not converged to the true target position before the target maneuver the imm kalman filter cannot track the target after the target maneuvers in this case the imm filter diverges after the target maneuvers considering the botma problem without the observer s maneuver the target maneuver may make the filter diverged once the filter diverges a common approach of the observer is to reinitialize the filter however restarting the filter does not lead to reliable target estimation since we consider an observer which does not maneuver it is well known that the observer s maneuver is required to derive reliable target estimation in botma problems karlsson and gustafsson 2005 le cadre and gauvrit 1996 logothetis et al 1997 in this paper we consider an observer which moves with a constant velocity we assume that the observer can access several inequality constraints on target states target s speed range target s course or target location in order to make the target estimation reliable even after the target maneuvers we apply inequality constraints on target states we introduce constraints on target states which are available to the observer we assume that the observer can access the inequality constraints imposed on target s speed or range the constraint on a target s range is that it is lower or upper bounded by the minimum or maximum sensing range of the observer s bearing sensor the maximum sensing range information can be derived using the ray tracing simulation in underwater environments collins 1995 jensen et al 2011 kim 2019b suppose that the observer has a prior information on the relationship between the propeller frequency and the speed of the target ship this information can be obtained during the exercise of the target ship then by analyzing the frequency of the propeller the speed of the target can be conjectured furthermore the observer can access the inequality constraints imposed on target s location or target s course for example considering the case where the target is a ship the target cannot exist on land also consider the case where the observer knows that the target moves towards its goal which is accessible by the observer in this case it is highly probable that the target heads towards its goal in other words the target s course can be conjectured constrained filtering is a problem of correcting the filter update to account for known constraints on target states the variable structure multiple model particle filtering approach for state estimation of road constrained targets was addressed in cheng and singh 2007 martino et al 2017 however one of the major concerns of the application of particle filters to target tracking is its computational expense cheng and singh 2007 boers and driessen 2003 wang and han 2013 radosavljevic et al 2015 li and chang 2018 thus particle filters are not suitable for the case where the observer needs to track many targets simultaneously also particle filters are not suitable for a small embedded system such as a small unmanned underwater vehicle uuv a kalman filter for state estimation is well known for its efficiency with low computational load ristic et al 2004 simon 2006 hence this paper presents constrained filtering based on kalman filters several researchers suggested the use of a pdf truncation method that updates the kalman filter with the mean and covariance of the region of the pdf that lies outside of the constraint hyperplanes tully et al 2011 shimada et al 1998 simon and simon 2010 kim et al 2015 however in the case where there are many inequality constraints there is no efficient way to apply all the constraints together using the pdf truncation method thus kim et al 2015 tully et al 2011 simon and simon 2010 applied each constraint one by one in sequence in other words the estimate obtained after applying the i th constraint was used as the new prior applying the i 1 th constraint correcting the kalman filter requires constrained optimization which can be computationally heavy considering the botma problem without observer maneuver the target estimation may become unreliable after the target maneuvers correcting the filter estimate which is not reliable using hard constraints leads to filter divergence in the worst case this divergence problem motivated the development of filter restart strategy introduced in this paper in this paper we present a filter restart strategy to track a maneuvering target assisted by inequality constraints we do not correct the kalman filter update accounting for inequality constraints as in tully et al 2011 simon and simon 2010 kim et al 2015 our approach is to let the observer restart the filter using the inequality constraints which are available to the observer as the observer restarts the filter stored target information is reused by running the filter backward in time our filter restart approach does not lead to filter divergence even if the constraints are applied at the instant after the estimate has already diverged as far as we know this paper is unique in making a constant velocity observer which measures the bearing angle of a maneuvering target track the target assisted by range course speed or target location constraints we verify the effectiveness of our filter restart approach by comparing it with the imm kalman filter using matlab simulations the paper is organized as follows section 2 discusses preliminary information related to our paper section 3 states the problem tackled in our paper section 4 introduces our inequality constrained tracking approach section 5 introduces matlab simulations to verify our approach section 6 provides conclusions 2 preliminary information 2 1 extended kalman filter ekf the extended kalman filter ekf is the nonlinear version of the kalman filter which linearizes about an estimate of the current mean and covariance simon 2006 ristic et al 2004 in the ekf the state transition and observation models don t need to be linear functions of the state but may instead be differentiable functions simon 2006 ristic et al 2004 the state space models for the ekf are as follows process model 1 x k 1 f x k n k measurement model 2 z k h x k m k here k is time index x k denotes the state vector at time step k also n k and m k denote process noise and measurement noise respectively with following properties n k n 0 q k and m k n 0 r k here n a b is the traditional symbol for gaussian distribution with mean a and covariance b let d k z 1 z 2 z k the ekf provides the method to calculate the mean x k and the covariance of x k at each time step k the method is composed of the following two steps prediction and measurement update 2 1 1 prediction consider the case where the time index is k assume p x k 1 d k 1 n x k 1 k 1 p k 1 k 1 is known we predict x k k 1 as follows 3 x k k 1 f x k 1 k 1 4 p k k 1 f k 1 p k 1 k 1 f k 1 t q k 1 where f k 1 x f x x x k 1 k 1 is the jacobian matrix of f evaluated with current estimate x x k 1 k 1 2 1 2 measurement update we update both state vector and covariance as 5 x k k x k k 1 k k z k h x k k 1 6 p k k i k k h k p k k 1 i k k h k t k k r k k k t where 7 k k p k k 1 h k t h k p k k 1 h k t r k 1 in 6 and 7 h k x h x x x k k 1 is the jacobian matrix of h evaluated at the predicted state vector x x k k 1 3 problem statement 3 1 system models we introduce a botma problem which is to estimate the position and velocity of a target using bearing measurements we use x k x k y k x k y k t representing the relative state vector this system model is commonly used for target tracking karlsson and gustafsson 2005 ristic et al 2004 the cartesian coordinate uses the target s relative position x y relative velocity x y as the filter states we introduce several concepts before presenting our models in detail t is the sampling interval and 0 α β denotes a α β zero matrix and d α β denotes a diagonal matrix with diagonal elements α β in this order σ a is the symbol for the standard deviation of a the target s state vector position and velocity at time step k is represented as x k t x k t y k t x k t y k t t as a motion model of the target we have 8 x k 1 t f x k t n k where n k g a x a y t and n k n 0 4 1 q k here q k g d σ a x 2 σ a y 2 g t in 8 f 1 0 t 0 0 1 0 t 0 0 1 0 0 0 0 1 and g t 2 2 0 0 t 2 2 t 0 0 t note that 8 is the process model presented in karlsson and gustafsson 2005 in 8 the target s unknown acceleration is defined as a x a y t karlsson and gustafsson 2005 hence a x a y t represents the manoeuvrability of the target karlsson and gustafsson 2005 for long range applications where the target is assumed not to have detected the observer it is commonly assumed that a target moves with a constant velocity karlsson and gustafsson 2005 for maneuvering targets a higher value of the process noise can be used but this will degrade performance karlsson and gustafsson 2005 let x k o x k o y k o x k o y k o t represent the position x k o y k o and velocity x k o y k o of the observer at time step k we define the relative state vector x k x k y k x k y k t as 9 x k x k t x k o using 8 and 9 our process model is 10 x k 1 f x k x k o x k 1 o n k the measurement model is 11 b k h x k m k b where h x k tan 1 y k x k and m k b n 0 σ b 2 11 is the measurement model presented in karlsson and gustafsson 2005 note that process noise and measurement noise are not correlated to each other in our models see that measurement models are nonlinear using the cartesian coordinate system we next present models for our inequality constraints we introduce several notations beforehand θ 1 k tan 1 y k x k θ 2 k x k 2 y k 2 θ 3 k tan 1 y k t x k t and θ 4 k x k t 2 y k t 2 represent bearing range target course and target speed respectively suppose that our inequality constraints at time step k are set as follows at time step k the target range exists between r t 1 and r t 2 in other words we use range constraints as 12 r t 1 θ 2 k r t 2 at time step k the target speed exists between s t 1 and s t 2 in other words we use speed constraints as 13 s t 1 θ 4 k s t 2 at time step k the target course is between c t 1 and c t 2 in other words we use course constraints as 14 c t 1 θ 3 k c t 2 here c t 1 is a constant between π and π also c t 2 is a constant between π and π in this way the target course exists between π and π 3 2 kalman filter initialization our filter initialization strategy is to set the initial estimate of the target s velocity as the observer s velocity the authors of peach 1995 mentioned that this avoids the divergent behavior since the implied bearing rate is zero we initialize the ekf as follows 15 x 0 0 r 0 e sin b 0 r 0 e cos b 0 0 0 t 16 p 0 0 r 0 0 d σ b 2 δ r 2 v m a x 2 3 v m a x 2 3 r 0 0 t where r 0 0 r 0 e cos b 0 sin b 0 0 0 r 0 e sin b 0 cos b 0 0 0 0 0 1 0 0 0 0 1 in 16 δ r s m a x 2 s m a x is the maximum sensing range of the bearing sensor also r 0 e is the estimated target range at time step 0 we use r 0 e since the true target range is unknown to the observer in 16 v m a x is the maximum speed of the target which is assumed to be known 3 3 assumption suppose that the observer restarts the filter at time step k note that the filter may have already diverged at time step k it is common that the observer restarts the filter once the tracking filter has already diverged since the filter at time step k may not be reliable we do not reuse the filter state at time step k as we restart the filter we have the assumption called the constant velocity assumption as follows the target has been moving with a constant velocity speed and course for recent q time steps this implies that the target has been moving with a constant velocity from k q to k time steps note that the target may have maneuvered before k q time steps this assumption is reasonable in practice for long range applications where the target is assumed not to have detected the observer a common model used is to assume a constant velocity cv target karlsson and gustafsson 2005 under our filter restart strategy we store recent bearing measurements from k q to k time steps in the case where there are inequality constraints at time step k we rerun the filter using the following bearing measurements b k q b k q 1 b k this implies that as we restart the filter at time step k we reuse target data b k q b k q 1 b k that are assumed to be reliable considering the target s cv motion model in the case where we consider a target which maneuvers frequently we can set q as a small constant close to zero in the case where we consider a constant velocity target we can simply set q k this implies that the target has been moving with a constant velocity from 0 to k time steps considering a constant velocity target we use all bearing measurements as we rerun the filter this implies that as we restart the filter at time step k we reuse all target data b 1 b 2 b k that are assumed to be reliable considering the target s cv motion model 4 inequality constrained tracking using the brcs coordinate system in our ekf model we use the cartesian coordinate system for prediction steps in prediction steps the process model is linear as presented in 10 thus we do not need linearization methods such as jacobian matrix in prediction steps by applying our process model 10 to 3 we perform kalman filter prediction 17 x k k 1 f x k 1 k 1 x k 1 o x k o by applying 10 to 4 we predict the covariance as 18 p k k 1 f p k 1 k 1 f t q k 1 we introduce a new coordinate system called the brcs bearing range course and speed coordinate system as its name suggests this brcs coordinate system includes bearing range target course and target speed as its four states in this order we introduce a method to transform our coordinate system from the cartesian coordinate to the brcs coordinate after the prediction step at time step k we have x k k 1 and p k k 1 in the cartesian coordinate let x k k 1 x k k 1 y k k 1 x k k 1 y k k 1 t for convenience also let x k k 1 t x k k 1 x k o we use x k k 1 t x k o x k k 1 and y k k 1 t y k o y k k 1 furthermore we introduce several notations θ 1 k p tan 1 y k k 1 x k k 1 θ 2 k p x k k 1 2 y k k 1 2 θ 3 k p tan 1 y k k 1 t x k k 1 t and θ 4 k p x k k 1 t 2 y k k 1 t 2 then the states in the brcs coordinate system at time step k are 19 x k k 1 μ θ 1 k p θ 2 k p θ 3 k p θ 4 k p t we perform measurement updates in the brcs coordinate system the brcs coordinate system uses the following four states bearing θ 1 k p range θ 2 k p target course θ 3 k p and target speed θ 4 k p thus if bearing range target course or target speed input is available then this input can be used to update the filter linearly in the brcs coordinate system this implies that we do not need linearization methods such as jacobian matrix in the measurement updates of bearing range target course or target speed for instance consider the case where a bearing measurement b k is available at time step k the measurement model for b k in the brcs coordinate system is 20 b k l k x k k μ m k b where 21 l k 1 0 0 0 and m k b n 0 σ b 2 l k 1 0 0 0 since the first state in x k k μ represents the bearing state θ 1 k p see that 20 is linear in the brcs coordinate system the covariance matrix in the brcs coordinate system at time step k is 22 p k k 1 μ j p k k 1 j t where j y k k 1 r k k 1 2 x k k 1 r k k 1 2 0 0 x k k 1 r k k 1 y k k 1 r k k 1 0 0 0 0 y k k 1 t v k k 1 t 2 x k k 1 t v k k 1 t 2 0 0 x k k 1 t v k k 1 t y k k 1 t v k k 1 t in j r k k 1 x k k 1 2 y k k 1 2 and v k k 1 t x k k 1 t 2 y k k 1 t 2 we acknowledge that linearization is used in the covariance matrix transformation between the cartesian coordinate and the brcs coordinate we next perform the measurement update as follows in the case where we have a bearing measurement b k we set the associated measurement matrix in the measurement update as 21 similarly to 7 we derive the optimal kalman gain as 23 k k p k k 1 μ l k t l k p k k 1 μ l k t r k 1 thereafter we update both the estimate and its covariance as 24 x k k μ x k k 1 μ k k z k l k x k k 1 μ 25 p k k μ i k k l k p k k 1 μ i k k l k t k k r k k k t we next transform our coordinate system from the brcs coordinate back to the cartesian coordinate this transformation is the inverse process of both 22 and 19 we acknowledge that linearization is used in the covariance matrix transformation between the cartesian coordinate and the brcs coordinate 4 1 considering inequality constraints consider the case where the observer restarts the filter at time step k using the constant velocity assumption the target has been moving with a constant velocity from time step k q to k while obeying the constraints assume that 1 r t 1 r t 2 is the probability that the true target range is a certain value in the interval r t 1 r t 2 in other words we assume uniform probability distribution of target range similarly 1 s t 1 s t 2 is the probability that the true target speed is a certain value in the interval s t 1 s t 2 moreover 1 c t 1 c t 2 is the probability that the true target course is a certain value in the interval c t 1 c t 2 under the above assumptions on probability distribution we estimate the target range as r t c r t 1 r t 2 2 also estimate the target speed as s t c s t 1 s t 2 2 we further estimate the target course as c t c c t 1 c t 2 2 next derive the covariance of the range estimate as 26 v a r r e r 2 r t c 2 r r t 1 r r t 2 r 2 r t 1 r t 2 r t c 2 this leads to 27 v a r r r t 1 2 r t 1 r t 2 r t 2 2 3 r t c 2 using speed constraints we can derive the covariance of the speed estimate as 28 v a r s s t 1 2 s t 1 s t 2 s t 2 2 3 s t c 2 using course constraints we can obtain the covariance of the course estimate as 29 v a r c c t 1 2 c t 1 c t 2 c t 2 2 3 c t c 2 recall that we store recent bearing measurements b k q b k q 1 b k at time step k the target is located on the bearing line associated to b k we re initialize the target estimate at time step k using both b k and constraints speed range and course constraints starting from time step k we run the kalman filter in time reverse order to estimate the target information at time step k q here we run the kalman filter in time reverse order using stored bearing measurements b k q b k q 1 b k once we estimate the target information at time step k q then we rerun the filter using stored bearing measurements to estimate the target information at time step k again since the bearing measurements b k q b k q 1 b k are used two times the uncertainty of the estimate may decrease further than the case where the bearing measurements b k q b k q 1 b k are used only once to handle this problem we increase the process noise covariance q k in 18 slightly as we run the kalman filter in time reverse order using b k q b k q 1 b k using the inequality constraints we re initialize the filter at time step k in the brcs coordinate 30 x k k μ b k r t c c t c s t c t here c t c is used instead of c t c this is to update the filter using virtual time reversed measurements which will be presented in section 4 1 1 considering the inequality constraints at time step k the covariance matrix in the brcs coordinate system at time step k is reset as 31 p k k μ d σ b 2 v a r r v a r c v a r s here 27 28 and 29 are used there may be a case where a range constraint is not set at time step k in this case the following default constraints are utilized r t 1 0 and r t 2 r m a x also there may be a case where a course constraint is not set at time step k in this case we use the following default constraints c t 1 π and c t 2 π since the target course must exist between π and π there may be a case where a speed constraint is not set at time step k in this case we use the following default constraints s t 1 0 and s t 2 v m a x 4 1 1 estimate the target information at time step k q we present how to estimate the target information at time step k q we consider virtual time reversed measurements as follows b k q b k q where q q we update the filter sequentially using virtual measurements b k 1 b k 2 b k q in this order recall that we increase the process noise covariance q k in 4 slightly as we run the kalman filter in time reverse order using b k 1 b k 2 b k q initially we have x k k μ and p k k μ that are reinitialized using constraints see 30 and 31 after updating the filter using b k 1 we derive x k 1 k μ and p k 1 k μ here is marked to indicate that virtual measurements are used to update the filter then we update the filter using b k 2 to derive x k 2 k μ and p k 2 k μ as we update the filter using b k 1 b k 2 b k 3 b k q in this order then we get both x k q k μ and p k q k μ since we updated the filter using time reversed measurements we set x k q k μ x k q k μ and p k q k μ p k q k μ 4 1 2 estimate the target information at time step k once the target information at time step k q is estimated then we rerun the filter using stored bearing measurements b k q b k q 1 b k to estimate the target position at time step k again initially we have both x k q k μ and p k q k μ that are derived in section 4 1 1 let x k q k μ i denote the i th element in x k q k μ we change the sign of x k q k μ 3 by multiplying 1 to x k q k μ 3 in other words we set x k q k μ 3 x k q k μ 3 this is to update the filter using true time sequential measurements initially we have x k q k μ and p k q k μ after updating the filter using b k q we derive x k q 1 k μ and p k q 1 k μ then we update the filter using b k q 1 to derive x k q 2 k μ and p k q 2 k μ after updating the filter using b k q b k q 1 b k q 2 b k in this order we get x k k μ and p k k μ by transforming the coordinate system from the brcs coordinate to the cartesian coordinate we get x k k and p k k again this transformation is the inverse process of both 22 and 19 we acknowledge that linearization is used in the covariance matrix transformation between the cartesian coordinate and the brcs coordinate 4 2 constraints imposed on target location suppose that we can access the feasible location of the target let a t denote the area where the target can exist for instance a t is the sea surface considering the case where the target is a ship in this case the boundary of a t is a coastline let l k denote the line associated to the bearing measurement b k such that its length is bounded by s m a x here s m a x is the maximum sensing range of the bearing sensor associated to b k note that the target exists on l k while transmitting sound to the observer directly consider the case where l k intersects the boundary of a t at one or more points among multiple intersection points we select the point say p which is the closest to x k o y k o recall that x k o y k o is the observer position at time step k then the feasible target range is upper bounded by x k o y k o p we can apply inequality range constraints at time step k using the approach in section 4 1 we set r t 1 0 and r t 2 x k o y k o p 5 matlab simulations we introduce matlab simulations to verify our approach the simulation scenario is as follows the maximum sensing range is s m a x 30000 meters for filter initialization we used both 15 and 16 initially the observer is at the origin and the velocity of the observer is 3 0 in m s since the observer moves with a constant velocity the target state is not observable using bearings only measurements aidala and hammel 1983 le cadre and gauvrit 1996 logothetis et al 1997 the target motion model is as follows 32 x k t 1 x k 1 t 1 v k 1 t cos φ k 1 t x k t 2 x k 1 t 2 v k 1 t sin φ k 1 t φ k φ k 1 r a t e k 1 a t v k t v k 1 t r a t e k 1 s t here x k t 1 x k t 2 is the 2d position of the target at time step k φ k denotes the heading angle of the target at time step k v k t is the speed of the target at time step k r a t e k a is the heading change rate at time step k r a t e k s is the speed change rate at time step k at time step 0 the target s position is 15000 0 we set r 0 e 20000 meters despite the fact that the true target range is 15000 m at time step 0 due to this initial estimation error a kalman filter has difficulty in tracking the target as long as the observer does not properly maneuver the sampling interval for bearing measurements is 1 s the scenario runs for 60 min we set q 50 this implies that the observer stores data associated to recent 50 time steps in the process model see 10 we set up the parameters as follows σ a x σ a y 0 1 in the simulations the measurement model in 11 was used in the measurement model see 11 the bearing measurement noise is set as σ b 0 5 degrees for comparison we use the interacting multiple model imm kalman filter yuan et al 2015 imm kalman filters use multiple target motion models such as constant acceleration ca model and constant velocity cv model followed by merging the motion models to estimate the target state even in the case where the target maneuvers bi and ren 2008 yuan et al 2015 wan et al 2010b in the imm kalman filter we use three motion models the constant velocity model the constant acceleration model left turn maneuver and the constant acceleration model right turn maneuver we already presented the constant velocity model in 10 for the constant acceleration model right turn maneuver 10 uses f as 33 f 1 0 sin w t w cos w t 1 w 0 1 1 cos w t w sin w t w 0 0 cos w t sin w t 0 0 sin w t cos w t here w is the turn rate of the target the turn rate is set as 3 per second for the constant acceleration model left turn we set w 3 degrees per second the model transition probability is set as p i j 0 9 0 05 0 05 0 1 0 8 0 1 0 05 0 15 0 8 we implemented m c 200 monte carlo simulations to verify the performance of our method rigorously let e k t where t m c denote the target s position estimate at time step k using the tth monte carlo simulation e k t e k denotes the error of the target estimate at time step k we use the following rmse in meters 34 r m s e k t 1 m c e k t e k 2 m c fig 1 shows the scenario considered in the simulations before 500 s the velocity of the target is 0 3 in m s between 500 and 520 s the target changes its heading with heading change rate r a t e k a 7 degrees per second also between 1200 and 1230 s the target changes its heading with heading change rate r a t e k a 5 degrees per second in fig 1 the trajectory of the target is depicted with the red curve and the trajectory of the observer is depicted with the blue curve 5 1 applying no constraints for comparison we use the interacting multiple model imm kalman filter fig 2 shows the change of r m s e k with respect to k for this imm kalman filter r m s e k increases after the target maneuvers despite the fact that we use the imm kalman filter to track a maneuvering target to run 200 monte carlo simulations using the imm kalman filter it takes 366 s 5 2 applying both the range and the speed constraints consider the scenario where the observer applies both the range and the speed constraints at time steps 1000 and 1500 at time step k 1000 the speed constraints are applied as follows the true target speed exists within the interval 2 10 in m s moreover at time step k 1500 the speed constraints are applied as follows the true target speed exists within the interval 3 10 in m s the first range constraints are as follows the true target range at time step k 1000 exists within the interval r 1000 t 3000 r 1000 t 2000 in meters also the second range constraints are as follows the true target range at time step k 1500 exists within the interval r 1500 t 2000 r 1500 t 3000 in meters fig 3 shows the change of r m s e k with respect to k for this scenario r m s e decreases sharply at time step 1000 the target state is not observable without observer maneuvers in botma problems aidala and hammel 1983 logothetis et al 1997 le cadre and gauvrit 1996 thus r m s e k slowly increases as k increases over 1000 we can see that inequality constraints decrease the rmse considerably compared to the case where the imm kalman filter is used to run 200 monte carlo simulation using both the range and the speed constraints it takes 126 s this implies that our approach runs much faster than the imm kalman filter we conjecture the reason is that our filter uses one kalman filter instead of three kalman filters which are used in the imm kalman filter due to low computational load our strategy is suitable for a small unmanned underwater vehicle 5 3 applying the range constraints consider the scenario where the observer applies the range constraints at time steps 1000 and 1500 the first range constraints are as follows the true target range at time step k 1000 exists within the interval r 1000 t 3000 r 1000 t 2000 in meters also the second range constraints are as follows the true target range at time step k 1500 exists within the interval r 1500 t 2000 r 1500 t 3000 in meters fig 4 shows the change of r m s e k with respect to k for this scenario r m s e decreases sharply at time steps 1000 and 1500 the target state is not observable without observer maneuvers in botma problems aidala and hammel 1983 le cadre and gauvrit 1996 logothetis et al 1997 hence r m s e k increases as k increases over 1500 to run 200 monte carlo simulations using the range constraints it takes 110 s 6 conclusions in this paper an observer measures the bearing of sound emitted from the target at each time step this problem is called the botma problem moreover the observer can access the inequality constraints imposed on target s speed range target s course or target location as far as we know this paper is unique in making a constant velocity observer which measures the bearing angle of a maneuvering target track the target assisted by range course speed or target location constraints this paper presents a filter restart strategy to make a constant velocity observer track a maneuvering target using inequality constraints as the observer restarts the filter stored target information is reused by running the filter backward in time we verify the effectiveness of our filter restart approach by comparing it with the imm kalman filter using matlab simulations the botma arises in various aerial applications such as target tracking using passive ir sensor or optical sensor in aerial environments signal characteristics are different from sonar measurements in underwater environment however the proposed botma under inequality constraints can still be applied in aerial applications acknowledgement national research foundation nrf of korea 2019057282 
22522,this paper addresses the problem of enabling a constant velocity observer to track a maneuvering target using inequality constraints in this paper an observer measures the bearing of sound emitted from the target at each time step we consider an observer which can access the inequality constraints imposed on target s speed range target s course or target location as far as we know this paper is unique in making a constant velocity observer which measures the bearing angle of a maneuvering target track the target assisted by range course speed or target location constraints the observer restarts the filter using inequality constraints to reduce the estimation error considerably even after the filter diverges as the observer restarts the filter stored target information is reused by running the filter backward in time we verify the effectiveness of our filter restart approach by comparing it with the interacting multiple model imm kalman filter using matlab simulations keywords target tracking inequality constraints maneuvering target tracking bearings only target motion analysis 1 introduction this paper addresses the problem of enabling a constant velocity observer to track a maneuvering target using inequality constraints in underwater environments radio signal is easily dissipated but sound energy is not thus an observer measures the bearing of sound emitted from the target at each time step as an observer we can consider an autonomous underwater vehicle equipped with sonar systems to measure the bearing of sound emitted from a target e g ship or submarine this paper handles the case where inequality constraints are used for the target trajectory estimation in the case where an observer uses bearing measurements only this problem is called the bearing only target motion analysis botma and arises in various military applications related to target tracking this paper assumes that the target and the observer are constrained to stay on the 2d plane since this 2d assumption is usually used in underwater botma problems karlsson and gustafsson 2005 peach 1995 clark et al 2007 aidala and hammel 1983 kim et al 2017 botma problem handles the situation where the distance between the target and the observer is not known initially 1 1 as a method to reduce the initial range estimation error efficiently the range parameterized extended kalman filter rpekf was developed karlsson and gustafsson 2005 peach 1995 the rpekf consists of a number of independent ekfs in the cartesian coordinates each with a different initial range estimate and the combined estimate is obtained as a weighted sum of individual ekf outputs peach 1995 karlsson and gustafsson 2005 however reducing the initial range estimation error is not within the scope of this paper the botma is a nonlinear estimation problem as such requires various nonlinear filtering techniques for its solution clark et al 2007 wan et al 2010a jiang and cai 2017 simon 2006 aidala and hammel 1983 kim et al 2017 kim 2019a ristic 2019 in the botma problem it is commonly assumed that a target moves with a constant velocity cv karlsson and gustafsson 2005 as the target maneuvers a tracking filter assuming a cv target diverges tracking a maneuvering target using bearing measurements such as sonar is a challenging problem kim and hong 2004 wan et al 2010a wang et al 2011 yang et al 2016 liang qun et al 2015 quan et al 2014 martino et al 2018 andrieu et al 2010 bazzani et al 2009 kim 2019a interacting multiple model imm kalman filters were commonly used for tracking a maneuvering target kim and hong 2004 wan et al 2010a yuan et al 2015 bi and ren 2008 however in the case where the target estimation has not converged to the true target position before the target maneuver the imm kalman filter cannot track the target after the target maneuvers in this case the imm filter diverges after the target maneuvers considering the botma problem without the observer s maneuver the target maneuver may make the filter diverged once the filter diverges a common approach of the observer is to reinitialize the filter however restarting the filter does not lead to reliable target estimation since we consider an observer which does not maneuver it is well known that the observer s maneuver is required to derive reliable target estimation in botma problems karlsson and gustafsson 2005 le cadre and gauvrit 1996 logothetis et al 1997 in this paper we consider an observer which moves with a constant velocity we assume that the observer can access several inequality constraints on target states target s speed range target s course or target location in order to make the target estimation reliable even after the target maneuvers we apply inequality constraints on target states we introduce constraints on target states which are available to the observer we assume that the observer can access the inequality constraints imposed on target s speed or range the constraint on a target s range is that it is lower or upper bounded by the minimum or maximum sensing range of the observer s bearing sensor the maximum sensing range information can be derived using the ray tracing simulation in underwater environments collins 1995 jensen et al 2011 kim 2019b suppose that the observer has a prior information on the relationship between the propeller frequency and the speed of the target ship this information can be obtained during the exercise of the target ship then by analyzing the frequency of the propeller the speed of the target can be conjectured furthermore the observer can access the inequality constraints imposed on target s location or target s course for example considering the case where the target is a ship the target cannot exist on land also consider the case where the observer knows that the target moves towards its goal which is accessible by the observer in this case it is highly probable that the target heads towards its goal in other words the target s course can be conjectured constrained filtering is a problem of correcting the filter update to account for known constraints on target states the variable structure multiple model particle filtering approach for state estimation of road constrained targets was addressed in cheng and singh 2007 martino et al 2017 however one of the major concerns of the application of particle filters to target tracking is its computational expense cheng and singh 2007 boers and driessen 2003 wang and han 2013 radosavljevic et al 2015 li and chang 2018 thus particle filters are not suitable for the case where the observer needs to track many targets simultaneously also particle filters are not suitable for a small embedded system such as a small unmanned underwater vehicle uuv a kalman filter for state estimation is well known for its efficiency with low computational load ristic et al 2004 simon 2006 hence this paper presents constrained filtering based on kalman filters several researchers suggested the use of a pdf truncation method that updates the kalman filter with the mean and covariance of the region of the pdf that lies outside of the constraint hyperplanes tully et al 2011 shimada et al 1998 simon and simon 2010 kim et al 2015 however in the case where there are many inequality constraints there is no efficient way to apply all the constraints together using the pdf truncation method thus kim et al 2015 tully et al 2011 simon and simon 2010 applied each constraint one by one in sequence in other words the estimate obtained after applying the i th constraint was used as the new prior applying the i 1 th constraint correcting the kalman filter requires constrained optimization which can be computationally heavy considering the botma problem without observer maneuver the target estimation may become unreliable after the target maneuvers correcting the filter estimate which is not reliable using hard constraints leads to filter divergence in the worst case this divergence problem motivated the development of filter restart strategy introduced in this paper in this paper we present a filter restart strategy to track a maneuvering target assisted by inequality constraints we do not correct the kalman filter update accounting for inequality constraints as in tully et al 2011 simon and simon 2010 kim et al 2015 our approach is to let the observer restart the filter using the inequality constraints which are available to the observer as the observer restarts the filter stored target information is reused by running the filter backward in time our filter restart approach does not lead to filter divergence even if the constraints are applied at the instant after the estimate has already diverged as far as we know this paper is unique in making a constant velocity observer which measures the bearing angle of a maneuvering target track the target assisted by range course speed or target location constraints we verify the effectiveness of our filter restart approach by comparing it with the imm kalman filter using matlab simulations the paper is organized as follows section 2 discusses preliminary information related to our paper section 3 states the problem tackled in our paper section 4 introduces our inequality constrained tracking approach section 5 introduces matlab simulations to verify our approach section 6 provides conclusions 2 preliminary information 2 1 extended kalman filter ekf the extended kalman filter ekf is the nonlinear version of the kalman filter which linearizes about an estimate of the current mean and covariance simon 2006 ristic et al 2004 in the ekf the state transition and observation models don t need to be linear functions of the state but may instead be differentiable functions simon 2006 ristic et al 2004 the state space models for the ekf are as follows process model 1 x k 1 f x k n k measurement model 2 z k h x k m k here k is time index x k denotes the state vector at time step k also n k and m k denote process noise and measurement noise respectively with following properties n k n 0 q k and m k n 0 r k here n a b is the traditional symbol for gaussian distribution with mean a and covariance b let d k z 1 z 2 z k the ekf provides the method to calculate the mean x k and the covariance of x k at each time step k the method is composed of the following two steps prediction and measurement update 2 1 1 prediction consider the case where the time index is k assume p x k 1 d k 1 n x k 1 k 1 p k 1 k 1 is known we predict x k k 1 as follows 3 x k k 1 f x k 1 k 1 4 p k k 1 f k 1 p k 1 k 1 f k 1 t q k 1 where f k 1 x f x x x k 1 k 1 is the jacobian matrix of f evaluated with current estimate x x k 1 k 1 2 1 2 measurement update we update both state vector and covariance as 5 x k k x k k 1 k k z k h x k k 1 6 p k k i k k h k p k k 1 i k k h k t k k r k k k t where 7 k k p k k 1 h k t h k p k k 1 h k t r k 1 in 6 and 7 h k x h x x x k k 1 is the jacobian matrix of h evaluated at the predicted state vector x x k k 1 3 problem statement 3 1 system models we introduce a botma problem which is to estimate the position and velocity of a target using bearing measurements we use x k x k y k x k y k t representing the relative state vector this system model is commonly used for target tracking karlsson and gustafsson 2005 ristic et al 2004 the cartesian coordinate uses the target s relative position x y relative velocity x y as the filter states we introduce several concepts before presenting our models in detail t is the sampling interval and 0 α β denotes a α β zero matrix and d α β denotes a diagonal matrix with diagonal elements α β in this order σ a is the symbol for the standard deviation of a the target s state vector position and velocity at time step k is represented as x k t x k t y k t x k t y k t t as a motion model of the target we have 8 x k 1 t f x k t n k where n k g a x a y t and n k n 0 4 1 q k here q k g d σ a x 2 σ a y 2 g t in 8 f 1 0 t 0 0 1 0 t 0 0 1 0 0 0 0 1 and g t 2 2 0 0 t 2 2 t 0 0 t note that 8 is the process model presented in karlsson and gustafsson 2005 in 8 the target s unknown acceleration is defined as a x a y t karlsson and gustafsson 2005 hence a x a y t represents the manoeuvrability of the target karlsson and gustafsson 2005 for long range applications where the target is assumed not to have detected the observer it is commonly assumed that a target moves with a constant velocity karlsson and gustafsson 2005 for maneuvering targets a higher value of the process noise can be used but this will degrade performance karlsson and gustafsson 2005 let x k o x k o y k o x k o y k o t represent the position x k o y k o and velocity x k o y k o of the observer at time step k we define the relative state vector x k x k y k x k y k t as 9 x k x k t x k o using 8 and 9 our process model is 10 x k 1 f x k x k o x k 1 o n k the measurement model is 11 b k h x k m k b where h x k tan 1 y k x k and m k b n 0 σ b 2 11 is the measurement model presented in karlsson and gustafsson 2005 note that process noise and measurement noise are not correlated to each other in our models see that measurement models are nonlinear using the cartesian coordinate system we next present models for our inequality constraints we introduce several notations beforehand θ 1 k tan 1 y k x k θ 2 k x k 2 y k 2 θ 3 k tan 1 y k t x k t and θ 4 k x k t 2 y k t 2 represent bearing range target course and target speed respectively suppose that our inequality constraints at time step k are set as follows at time step k the target range exists between r t 1 and r t 2 in other words we use range constraints as 12 r t 1 θ 2 k r t 2 at time step k the target speed exists between s t 1 and s t 2 in other words we use speed constraints as 13 s t 1 θ 4 k s t 2 at time step k the target course is between c t 1 and c t 2 in other words we use course constraints as 14 c t 1 θ 3 k c t 2 here c t 1 is a constant between π and π also c t 2 is a constant between π and π in this way the target course exists between π and π 3 2 kalman filter initialization our filter initialization strategy is to set the initial estimate of the target s velocity as the observer s velocity the authors of peach 1995 mentioned that this avoids the divergent behavior since the implied bearing rate is zero we initialize the ekf as follows 15 x 0 0 r 0 e sin b 0 r 0 e cos b 0 0 0 t 16 p 0 0 r 0 0 d σ b 2 δ r 2 v m a x 2 3 v m a x 2 3 r 0 0 t where r 0 0 r 0 e cos b 0 sin b 0 0 0 r 0 e sin b 0 cos b 0 0 0 0 0 1 0 0 0 0 1 in 16 δ r s m a x 2 s m a x is the maximum sensing range of the bearing sensor also r 0 e is the estimated target range at time step 0 we use r 0 e since the true target range is unknown to the observer in 16 v m a x is the maximum speed of the target which is assumed to be known 3 3 assumption suppose that the observer restarts the filter at time step k note that the filter may have already diverged at time step k it is common that the observer restarts the filter once the tracking filter has already diverged since the filter at time step k may not be reliable we do not reuse the filter state at time step k as we restart the filter we have the assumption called the constant velocity assumption as follows the target has been moving with a constant velocity speed and course for recent q time steps this implies that the target has been moving with a constant velocity from k q to k time steps note that the target may have maneuvered before k q time steps this assumption is reasonable in practice for long range applications where the target is assumed not to have detected the observer a common model used is to assume a constant velocity cv target karlsson and gustafsson 2005 under our filter restart strategy we store recent bearing measurements from k q to k time steps in the case where there are inequality constraints at time step k we rerun the filter using the following bearing measurements b k q b k q 1 b k this implies that as we restart the filter at time step k we reuse target data b k q b k q 1 b k that are assumed to be reliable considering the target s cv motion model in the case where we consider a target which maneuvers frequently we can set q as a small constant close to zero in the case where we consider a constant velocity target we can simply set q k this implies that the target has been moving with a constant velocity from 0 to k time steps considering a constant velocity target we use all bearing measurements as we rerun the filter this implies that as we restart the filter at time step k we reuse all target data b 1 b 2 b k that are assumed to be reliable considering the target s cv motion model 4 inequality constrained tracking using the brcs coordinate system in our ekf model we use the cartesian coordinate system for prediction steps in prediction steps the process model is linear as presented in 10 thus we do not need linearization methods such as jacobian matrix in prediction steps by applying our process model 10 to 3 we perform kalman filter prediction 17 x k k 1 f x k 1 k 1 x k 1 o x k o by applying 10 to 4 we predict the covariance as 18 p k k 1 f p k 1 k 1 f t q k 1 we introduce a new coordinate system called the brcs bearing range course and speed coordinate system as its name suggests this brcs coordinate system includes bearing range target course and target speed as its four states in this order we introduce a method to transform our coordinate system from the cartesian coordinate to the brcs coordinate after the prediction step at time step k we have x k k 1 and p k k 1 in the cartesian coordinate let x k k 1 x k k 1 y k k 1 x k k 1 y k k 1 t for convenience also let x k k 1 t x k k 1 x k o we use x k k 1 t x k o x k k 1 and y k k 1 t y k o y k k 1 furthermore we introduce several notations θ 1 k p tan 1 y k k 1 x k k 1 θ 2 k p x k k 1 2 y k k 1 2 θ 3 k p tan 1 y k k 1 t x k k 1 t and θ 4 k p x k k 1 t 2 y k k 1 t 2 then the states in the brcs coordinate system at time step k are 19 x k k 1 μ θ 1 k p θ 2 k p θ 3 k p θ 4 k p t we perform measurement updates in the brcs coordinate system the brcs coordinate system uses the following four states bearing θ 1 k p range θ 2 k p target course θ 3 k p and target speed θ 4 k p thus if bearing range target course or target speed input is available then this input can be used to update the filter linearly in the brcs coordinate system this implies that we do not need linearization methods such as jacobian matrix in the measurement updates of bearing range target course or target speed for instance consider the case where a bearing measurement b k is available at time step k the measurement model for b k in the brcs coordinate system is 20 b k l k x k k μ m k b where 21 l k 1 0 0 0 and m k b n 0 σ b 2 l k 1 0 0 0 since the first state in x k k μ represents the bearing state θ 1 k p see that 20 is linear in the brcs coordinate system the covariance matrix in the brcs coordinate system at time step k is 22 p k k 1 μ j p k k 1 j t where j y k k 1 r k k 1 2 x k k 1 r k k 1 2 0 0 x k k 1 r k k 1 y k k 1 r k k 1 0 0 0 0 y k k 1 t v k k 1 t 2 x k k 1 t v k k 1 t 2 0 0 x k k 1 t v k k 1 t y k k 1 t v k k 1 t in j r k k 1 x k k 1 2 y k k 1 2 and v k k 1 t x k k 1 t 2 y k k 1 t 2 we acknowledge that linearization is used in the covariance matrix transformation between the cartesian coordinate and the brcs coordinate we next perform the measurement update as follows in the case where we have a bearing measurement b k we set the associated measurement matrix in the measurement update as 21 similarly to 7 we derive the optimal kalman gain as 23 k k p k k 1 μ l k t l k p k k 1 μ l k t r k 1 thereafter we update both the estimate and its covariance as 24 x k k μ x k k 1 μ k k z k l k x k k 1 μ 25 p k k μ i k k l k p k k 1 μ i k k l k t k k r k k k t we next transform our coordinate system from the brcs coordinate back to the cartesian coordinate this transformation is the inverse process of both 22 and 19 we acknowledge that linearization is used in the covariance matrix transformation between the cartesian coordinate and the brcs coordinate 4 1 considering inequality constraints consider the case where the observer restarts the filter at time step k using the constant velocity assumption the target has been moving with a constant velocity from time step k q to k while obeying the constraints assume that 1 r t 1 r t 2 is the probability that the true target range is a certain value in the interval r t 1 r t 2 in other words we assume uniform probability distribution of target range similarly 1 s t 1 s t 2 is the probability that the true target speed is a certain value in the interval s t 1 s t 2 moreover 1 c t 1 c t 2 is the probability that the true target course is a certain value in the interval c t 1 c t 2 under the above assumptions on probability distribution we estimate the target range as r t c r t 1 r t 2 2 also estimate the target speed as s t c s t 1 s t 2 2 we further estimate the target course as c t c c t 1 c t 2 2 next derive the covariance of the range estimate as 26 v a r r e r 2 r t c 2 r r t 1 r r t 2 r 2 r t 1 r t 2 r t c 2 this leads to 27 v a r r r t 1 2 r t 1 r t 2 r t 2 2 3 r t c 2 using speed constraints we can derive the covariance of the speed estimate as 28 v a r s s t 1 2 s t 1 s t 2 s t 2 2 3 s t c 2 using course constraints we can obtain the covariance of the course estimate as 29 v a r c c t 1 2 c t 1 c t 2 c t 2 2 3 c t c 2 recall that we store recent bearing measurements b k q b k q 1 b k at time step k the target is located on the bearing line associated to b k we re initialize the target estimate at time step k using both b k and constraints speed range and course constraints starting from time step k we run the kalman filter in time reverse order to estimate the target information at time step k q here we run the kalman filter in time reverse order using stored bearing measurements b k q b k q 1 b k once we estimate the target information at time step k q then we rerun the filter using stored bearing measurements to estimate the target information at time step k again since the bearing measurements b k q b k q 1 b k are used two times the uncertainty of the estimate may decrease further than the case where the bearing measurements b k q b k q 1 b k are used only once to handle this problem we increase the process noise covariance q k in 18 slightly as we run the kalman filter in time reverse order using b k q b k q 1 b k using the inequality constraints we re initialize the filter at time step k in the brcs coordinate 30 x k k μ b k r t c c t c s t c t here c t c is used instead of c t c this is to update the filter using virtual time reversed measurements which will be presented in section 4 1 1 considering the inequality constraints at time step k the covariance matrix in the brcs coordinate system at time step k is reset as 31 p k k μ d σ b 2 v a r r v a r c v a r s here 27 28 and 29 are used there may be a case where a range constraint is not set at time step k in this case the following default constraints are utilized r t 1 0 and r t 2 r m a x also there may be a case where a course constraint is not set at time step k in this case we use the following default constraints c t 1 π and c t 2 π since the target course must exist between π and π there may be a case where a speed constraint is not set at time step k in this case we use the following default constraints s t 1 0 and s t 2 v m a x 4 1 1 estimate the target information at time step k q we present how to estimate the target information at time step k q we consider virtual time reversed measurements as follows b k q b k q where q q we update the filter sequentially using virtual measurements b k 1 b k 2 b k q in this order recall that we increase the process noise covariance q k in 4 slightly as we run the kalman filter in time reverse order using b k 1 b k 2 b k q initially we have x k k μ and p k k μ that are reinitialized using constraints see 30 and 31 after updating the filter using b k 1 we derive x k 1 k μ and p k 1 k μ here is marked to indicate that virtual measurements are used to update the filter then we update the filter using b k 2 to derive x k 2 k μ and p k 2 k μ as we update the filter using b k 1 b k 2 b k 3 b k q in this order then we get both x k q k μ and p k q k μ since we updated the filter using time reversed measurements we set x k q k μ x k q k μ and p k q k μ p k q k μ 4 1 2 estimate the target information at time step k once the target information at time step k q is estimated then we rerun the filter using stored bearing measurements b k q b k q 1 b k to estimate the target position at time step k again initially we have both x k q k μ and p k q k μ that are derived in section 4 1 1 let x k q k μ i denote the i th element in x k q k μ we change the sign of x k q k μ 3 by multiplying 1 to x k q k μ 3 in other words we set x k q k μ 3 x k q k μ 3 this is to update the filter using true time sequential measurements initially we have x k q k μ and p k q k μ after updating the filter using b k q we derive x k q 1 k μ and p k q 1 k μ then we update the filter using b k q 1 to derive x k q 2 k μ and p k q 2 k μ after updating the filter using b k q b k q 1 b k q 2 b k in this order we get x k k μ and p k k μ by transforming the coordinate system from the brcs coordinate to the cartesian coordinate we get x k k and p k k again this transformation is the inverse process of both 22 and 19 we acknowledge that linearization is used in the covariance matrix transformation between the cartesian coordinate and the brcs coordinate 4 2 constraints imposed on target location suppose that we can access the feasible location of the target let a t denote the area where the target can exist for instance a t is the sea surface considering the case where the target is a ship in this case the boundary of a t is a coastline let l k denote the line associated to the bearing measurement b k such that its length is bounded by s m a x here s m a x is the maximum sensing range of the bearing sensor associated to b k note that the target exists on l k while transmitting sound to the observer directly consider the case where l k intersects the boundary of a t at one or more points among multiple intersection points we select the point say p which is the closest to x k o y k o recall that x k o y k o is the observer position at time step k then the feasible target range is upper bounded by x k o y k o p we can apply inequality range constraints at time step k using the approach in section 4 1 we set r t 1 0 and r t 2 x k o y k o p 5 matlab simulations we introduce matlab simulations to verify our approach the simulation scenario is as follows the maximum sensing range is s m a x 30000 meters for filter initialization we used both 15 and 16 initially the observer is at the origin and the velocity of the observer is 3 0 in m s since the observer moves with a constant velocity the target state is not observable using bearings only measurements aidala and hammel 1983 le cadre and gauvrit 1996 logothetis et al 1997 the target motion model is as follows 32 x k t 1 x k 1 t 1 v k 1 t cos φ k 1 t x k t 2 x k 1 t 2 v k 1 t sin φ k 1 t φ k φ k 1 r a t e k 1 a t v k t v k 1 t r a t e k 1 s t here x k t 1 x k t 2 is the 2d position of the target at time step k φ k denotes the heading angle of the target at time step k v k t is the speed of the target at time step k r a t e k a is the heading change rate at time step k r a t e k s is the speed change rate at time step k at time step 0 the target s position is 15000 0 we set r 0 e 20000 meters despite the fact that the true target range is 15000 m at time step 0 due to this initial estimation error a kalman filter has difficulty in tracking the target as long as the observer does not properly maneuver the sampling interval for bearing measurements is 1 s the scenario runs for 60 min we set q 50 this implies that the observer stores data associated to recent 50 time steps in the process model see 10 we set up the parameters as follows σ a x σ a y 0 1 in the simulations the measurement model in 11 was used in the measurement model see 11 the bearing measurement noise is set as σ b 0 5 degrees for comparison we use the interacting multiple model imm kalman filter yuan et al 2015 imm kalman filters use multiple target motion models such as constant acceleration ca model and constant velocity cv model followed by merging the motion models to estimate the target state even in the case where the target maneuvers bi and ren 2008 yuan et al 2015 wan et al 2010b in the imm kalman filter we use three motion models the constant velocity model the constant acceleration model left turn maneuver and the constant acceleration model right turn maneuver we already presented the constant velocity model in 10 for the constant acceleration model right turn maneuver 10 uses f as 33 f 1 0 sin w t w cos w t 1 w 0 1 1 cos w t w sin w t w 0 0 cos w t sin w t 0 0 sin w t cos w t here w is the turn rate of the target the turn rate is set as 3 per second for the constant acceleration model left turn we set w 3 degrees per second the model transition probability is set as p i j 0 9 0 05 0 05 0 1 0 8 0 1 0 05 0 15 0 8 we implemented m c 200 monte carlo simulations to verify the performance of our method rigorously let e k t where t m c denote the target s position estimate at time step k using the tth monte carlo simulation e k t e k denotes the error of the target estimate at time step k we use the following rmse in meters 34 r m s e k t 1 m c e k t e k 2 m c fig 1 shows the scenario considered in the simulations before 500 s the velocity of the target is 0 3 in m s between 500 and 520 s the target changes its heading with heading change rate r a t e k a 7 degrees per second also between 1200 and 1230 s the target changes its heading with heading change rate r a t e k a 5 degrees per second in fig 1 the trajectory of the target is depicted with the red curve and the trajectory of the observer is depicted with the blue curve 5 1 applying no constraints for comparison we use the interacting multiple model imm kalman filter fig 2 shows the change of r m s e k with respect to k for this imm kalman filter r m s e k increases after the target maneuvers despite the fact that we use the imm kalman filter to track a maneuvering target to run 200 monte carlo simulations using the imm kalman filter it takes 366 s 5 2 applying both the range and the speed constraints consider the scenario where the observer applies both the range and the speed constraints at time steps 1000 and 1500 at time step k 1000 the speed constraints are applied as follows the true target speed exists within the interval 2 10 in m s moreover at time step k 1500 the speed constraints are applied as follows the true target speed exists within the interval 3 10 in m s the first range constraints are as follows the true target range at time step k 1000 exists within the interval r 1000 t 3000 r 1000 t 2000 in meters also the second range constraints are as follows the true target range at time step k 1500 exists within the interval r 1500 t 2000 r 1500 t 3000 in meters fig 3 shows the change of r m s e k with respect to k for this scenario r m s e decreases sharply at time step 1000 the target state is not observable without observer maneuvers in botma problems aidala and hammel 1983 logothetis et al 1997 le cadre and gauvrit 1996 thus r m s e k slowly increases as k increases over 1000 we can see that inequality constraints decrease the rmse considerably compared to the case where the imm kalman filter is used to run 200 monte carlo simulation using both the range and the speed constraints it takes 126 s this implies that our approach runs much faster than the imm kalman filter we conjecture the reason is that our filter uses one kalman filter instead of three kalman filters which are used in the imm kalman filter due to low computational load our strategy is suitable for a small unmanned underwater vehicle 5 3 applying the range constraints consider the scenario where the observer applies the range constraints at time steps 1000 and 1500 the first range constraints are as follows the true target range at time step k 1000 exists within the interval r 1000 t 3000 r 1000 t 2000 in meters also the second range constraints are as follows the true target range at time step k 1500 exists within the interval r 1500 t 2000 r 1500 t 3000 in meters fig 4 shows the change of r m s e k with respect to k for this scenario r m s e decreases sharply at time steps 1000 and 1500 the target state is not observable without observer maneuvers in botma problems aidala and hammel 1983 le cadre and gauvrit 1996 logothetis et al 1997 hence r m s e k increases as k increases over 1500 to run 200 monte carlo simulations using the range constraints it takes 110 s 6 conclusions in this paper an observer measures the bearing of sound emitted from the target at each time step this problem is called the botma problem moreover the observer can access the inequality constraints imposed on target s speed range target s course or target location as far as we know this paper is unique in making a constant velocity observer which measures the bearing angle of a maneuvering target track the target assisted by range course speed or target location constraints this paper presents a filter restart strategy to make a constant velocity observer track a maneuvering target using inequality constraints as the observer restarts the filter stored target information is reused by running the filter backward in time we verify the effectiveness of our filter restart approach by comparing it with the imm kalman filter using matlab simulations the botma arises in various aerial applications such as target tracking using passive ir sensor or optical sensor in aerial environments signal characteristics are different from sonar measurements in underwater environment however the proposed botma under inequality constraints can still be applied in aerial applications acknowledgement national research foundation nrf of korea 2019057282 
22523,concentrated on the problem of steady state oscillation of the traditional extremum seeking algorithm esa that it is not beneficial to the speed optimization of unmanned sailboat a novel speed optimization scheme with feedforward of unmanned sailboat via extremum seeking without steady state oscillation eswso is proposed this scheme consists of feedforward and feedback control the feedforward part firstly presets the initial sail angle of attack according to an approximate piecewise constant function of the sailing speed polar diagram its main function is avoid the large deviation of the longitudinal speed from the optimal value subsequently the feedback part fine tunes the speed to reach the optimal value through the extremum seeking es control in the process of continuously optimizing longitudinal speed a functional relationship between the excitation signal amplitude and the extremum estimation error is constructed to eliminate the steady state oscillation besides the rigorous stability proof of the scheme is given finally taking a 12 m class unmanned sailboat as the simulation object the results show that the optimization scheme can effectively eliminate steady state oscillation and enable the sailing speed to reach the ideal optimal value as well as has a high control accuracy and strong robustness keywords unmanned sailboat speed optimization speed polar diagram extremum seeking steady state oscillation 1 introduction as intelligent vehicles on the sea unmanned sailboats have shown unique advantages in marine data collection environmental monitoring and marine surveillance and other aspects neal 2006 unmanned sailboat uses wind energy as the main power source which is not limited by carrying fuel extends the cruise time effectively improves the scope of maritime monitoring and greatly saves resources thus has a good application prospect plumet et al 2015 the extensive research on unmanned sailboats began in the 1990s which can be divided into hard sail and soft sail sailboats according to the sail type elkaim 2006 since 2008 the world robotic sailing championship and international robotic sailing conference wrsc irsc have been held regularly every year providing a good platform for relevant international exchanges rynne and von ellenrieder 2009 in contrast domestic research on unmanned sailboats lags behind seriously the complete autonomous control of unmanned sailboats is a challenging task involving many factors in complex sea conditions the rudder needs to be controlled to keep the sailboat tracking the desired heading at the same time a reasonable sail control strategy is needed to obtain the maximum propulsion force so as to optimize the longitudinal speed in recent years many scholars at home and abroad have conducted in depth study on unmanned sailboats and sailing strategies in the study of heading control for unmanned sailboats a classical pid heading controller for a 2 m class autonomous sailboat is designed in emami et al 2013 melin et al 2016 designed the rudder angle controller of the sailboat based on p pd and sinusoidal control methods combined with saturation function stelzer et al 2007 modeled a sailboat in a complex environment and proposed an experience based fuzzy control method for sailboat saoud et al 2015a b used the three degree of freedom sailboat model as the research object and designed the heading controller by using the backstepping method and the switching function based on the fossen modeling idea xiao and jouffroy 2014 designed a nonlinear heading controller for the four degree of freedom mathematical model of sailboat by using the backstepping method wille et al 2016 established a four degree of freedom sailing mathematical model considering external environmental disturbances the heading controller was designed by state feedback linearization and the leeway angle was introduced as a correction term to reduce the heading control error stelzer and proll 2008 developed appropriate navigation routes according to different environmental conditions and reached the specified goals through the autonomous control of sailboat on the basis of heading control scholars have carried out a series of studies on how to reasonably control sail and optimize sailing speed saoud et al 2015a b proposed a method to calculate the optimal sail angle of a sailboat by numerical simulation method this method keeps the sailing speed in the best navigation state by limiting the roll angle based on the three degree of freedom ship mathematical model herrero et al 2010 first used the quantified set inversion and feedback linearization techniques to optimize the sailing speed however modeling error may be encountered due to the obvious nonlinear time varying performance of the ship viola and flay 2012 designed the open loop speed optimization model based on the sail polar but it lacks the speed feedback link which fails to make the sailboat obtain the maximum speed kai and jouffroy 2010 used an esa to optimize the sailing speed which can be controlled by an adaptive model free feedback method the above studies on sailing speed optimization are mainly focused on open loop control based on the speed polar diagram the closed loop model based control and the model free online optimization control above three methods have their own limitations if can combine their own characteristics to design an adaptive control scheme it will play an important role in enhancing the overall performance of sailboat in recent years the esa has attracted the attention of scholars due to its unique ability to track the extremum of an unknown time varying performance function guay and zhang 2003 among them the perturbation based esa and the sliding mode based esa are the most basic and evolve from the initial single parameter to the multi parameter esa theory as well as involve continuous and discrete time systems the esa have been widely used in system optimization design such as automobile unmanned sailboat aircraft fuel cell wireless sensor and other fields adetola and guay 2007 proposed a model free adaptive es control method which guaranteed the convergence of parameters and small steady state error and verified the effectiveness of the method through simulation examples dingmen and altinel 2016 designed an es optimization control in the vehicle anti lock braking system but the presence of high frequency oscillation will affect the wide application in the system xiao et al 2012 proposed a non perturbation based esa which only needs to use the function gradient optimization knowledge to optimize the sailing speed by continuously adjusting the sail angle corno et al 2016 designed an online speed es optimization system based on the sailing speed polar diagram the system is not affected by modeling errors and overcomes the limitations of traditional speed optimization based on sail polar in the above applications of esa have a problem with steady state oscillation which seriously affects the real time online application of esa zhang and ordonez 2007 proposed a numerical optimization based esa which successfully eliminated the adverse effect of steady state oscillation but its convergence speed is slower and the design of parameters is more complicated deng et al 2019 combined the esa with the self tuning fuzzy logic system to design a speed optimization scheme for sail assisted ships after adequate online learning and training the fuzzy logic system is capable to maximize the sailing speed with less oscillation but it may fall into local extremum wang et al 2016 used the pre demodulation signal to adaptively adjust the excitation signal amplitude to realize the design of the perturbation based eswso it can enlarge the search area to avoid falling to the local on the basis of wang et al 2016 wang et al 2014 further proposed an eswso based on demodulated signal the improved algorithm has a stronger adaptive ability to extremum estimation error and a faster convergence speed chen et al 2016 proposed a novel switching based es control scheme which overcomes the steady state oscillation in the traditional esa and maintains a faster convergence speed inspired by the above studies this paper aims to make full use of wind energy to obtain the maximum speed of unmanned sailboat concentrates on the problem of steady state oscillation of the es speed optimization scheme in corno et al 2016 proposes an novel online speed optimization scheme via eswso the scheme consists of feedforward block and feedback control specifically the feedforward part firstly uses an approximate piecewise constant function of the sailing speed polar diagram to obtain the initial sail angle of attack the feedback part according to the longitudinal speed of the sailboat the optimal sail angle of attack is fed back by es control the initial sail angle of attack and the optimal value are superimposed to obtain the actual sail angle of attack so that the sail angle is calculated and acts on the unmanned sailboat to form a closed loop control to continuously optimize the longitudinal speed besides a rigorous proof process is given for the stability of the eswso scheme finally based on a 12 m class unmanned sailboat model simulation studies are carried out to verify the effectiveness of the optimization scheme the novelty of this paper can be concluded as follows 1 the eswso speed optimization scheme contains a feedforward block to preset the sail angle of attack its function consists in avoiding the large deviation of the speed output from the optimal value on this basis the es control is used to fine tune the sailing speed to reach the optimal value 2 the eswso speed optimization scheme is adopted to search the optimal speed of unmanned sailboat to eliminate steady state oscillation in corno et al 2016 we construct a functional relationship between the excitation signal amplitude and the extremum estimation error in the process of speed optimization the optimization scheme can eliminate the steady state oscillation in that the excitation signal amplitude will fast converge to zero with the decrease of the extremum estimation error the remainder of this paper is organized as follows section 2 introduces preliminaries and problem formulation section 3 presents the design of eswso speed optimization scheme section 4 devotes the stability analysis section 5 exhibits simulation and comparison results section 6 concludes the entire work 2 preliminaries and problem formulation 2 1 preliminaries in the following a nonlinear dynamic model of the unmanned sailboat is introduced let us define an inertial reference frame o x y z and a body fixed reference frame o x y z as shown in fig 1 o is the starting position o x points to the north o y points to the east o z points to the center of the earth o is the center of the line between the head and tail of sailboat o x points to the bow along the central axis of the sailboat o y points to the starboard o z points to the bottom of sailboat the force analysis of the sail is shown in fig 2 which establishes a rectangular coordinate system with the center of gravity of sailboat as the origin and defines the bow direction as the x axis positive direction and the right side of the longitudinal axis as the y axis positive direction the true wind is observed in the inertial reference frame the true wind speed is represented by v tw and the true wind angle is represented by α tw the apparent wind is observed in the body fixed reference frame v aw is the apparent wind speed and α aw is the apparent wind angle it is prescribed that the wind on the port side is positive the sail angle δ s defined as the angle between the sail chord and the longitudinal axis of sailboat α is the angle between the apparent wind and the sail chord called the sail angle of attack the angle between the heading and the longitudinal axis of sailboat is the leeway angle recorded as θ v is the actual sailing speed u is the longitudinal speed v is the lateral speed which satisfies v 2 u 2 v 2 l s is the sail lift force d s is the sail drag force δ r is the rudder angle in xiao and jouffroy 2014 the sailboat is separated into four parts the sail rudder keel and hull the hydrodynamic theory and aerodynamic theory are used to analyze the force of each part and the function expression of each part is obtained a four degree of freedom sailboat dynamic model is established the model does not consider the influence of external disturbances so this paper adds external disturbances such as waves or winds and expresses the four degree of freedom dynamic model of sailboat as 1 x 1 u cos ψ v sin ψ cos φ y 1 u sin ψ v cos ψ cos φ φ p ψ r 1 cos φ u m y v v r 1 f x k f x h f x s f x r x wave m x u 1 v m x u u r 1 f y k f y h f y s f y r y wave m y v 1 p m r φ m x k m x h m x s m x r m φ d φ k wave i x x k p 1 r 1 x u y v u ν m z k m z h m z s m z r m ψ d ψ cos φ n wave i z z n r 1 where x 1 and y 1 are the actual positions of sailboat in the inertial reference frame φ is the roll angle ψ is the yaw angle u is the longitudinal speed v is the lateral speed p is the roll angular velocity and r 1 is the yaw angular velocity f x s f y s m x s m z s are the forces and moments on the sail f x r f y r m x r m z r are the forces and moments on the rudder f x k f y k m x k m z k are the forces and moments the keel f x h f y h m x h m z h are the hull resistance forces and moments m ψ d ψ is the yaw damping matrix m φ d φ is the heel damping matrix and m r φ is the static righting moment m is the mass of the sailboat i x x is the principle moment of inertia about the x axis in the body fixed reference frame i z z is the principle moment of inertia about the z axis in the body fixed reference frame x u y v k p n r are the added mass coefficients and the specific expressions of forces and moments each part are detailed in reference xiao and jouffroy 2014 in eq 1 x wave y wave k wave n wave are the forces and moments generated by wave disturbance and the specific expressions are as follows x wave 2 a 1 b sin b sin c c s t y wave 2 a 1 l sin b sin c b s t k wave 1 2 ρ water g m h c k 1 a a sin μ e k t 2 sin ω e t n wave a 1 k b 2 sin b c cos c sin c c 2 l 2 sin c b cos b sin b b 2 ξ t where l is the length of the sailboat b is the width of the sailboat a a is the sail area t is the draft k 1 is the wave number ρ water is the density of the seawater g is the acceleration of gravity h c is the initial metacentric height represents the distance from the center of gravity to the metacenter of sailboat a 1 ρ water g 1 e k 1 t k 1 2 b k 1 l 2 cos μ c k 1 b 2 sin μ ξ t h 1 2 cos ω e t s t k 1 h 1 2 sin ω e t μ is the wave direction angle ω e is the encounter frequency h 1 is the significant wave height 2 2 problem formulation from the four degree of freedom sailboat mathematical model eq 1 it is known that the mathematical model of sailing speed is 2 u f 1 u v p r 1 δ s in eq 2 f 1 m y v v r 1 f x k f x h f x s f x r x wave m x u 1 when analyzing the es control of the speed optimization system the optimization object can be regarded as a square system as long as the input and output of the system are clear it can be optimized so the mathematical model of sailing speed eq 2 can be approximated to the general nonlinear system 3 x f x δ s u h x where x r n is the system state the sail angle δ s r is the system input the longitudinal speed of sailboat u r is the system output f and h are the system state equation and the output equation respectively and both are smooth functions suppose there is the following control law with the optimal sail angle of attack δ α as the scalar parameter 4 δ s α aw α 0 δ α α x δ α bringing eq 4 into eq 3 the closed loop system 5 x f x α x δ α the following assumptions are made regarding this closed loop system assumption 1 there is a smooth function l r r n f x α x δ α 0 is true if and only if x l δ α assumption 2 for any δ α r the equilibrium x l δ α of the closed loop system eq 5 is local exponentially stable this assumption is not a requirement only means that the closed loop system can be locally stable by designing the control law even without understanding the model knowledge f x δ s or l δ α assumption 3 there exists δ α r such that u h l δ α 0 u h l δ α 0 this assumption ensures the function u h l δ α has a maximum longitudinal velocity value at a certain sail angle of attack optimum δ α in conclusion the control objective of system can be described as for the optimization object of es control eq 5 satisfies the above three assumptions the optimal sail angle of attack value δ α completes the tracking of the unknown optimum δ α in the sailing speed optimization process so that the system output u maintains the optimal sailing speed 3 eswso speed optimization the point of view from the control system designer the unmanned sailboat is a square system with two inputs sail angle and rudder angle and two outputs longitudinal speed and heading the system maintains the heading by controlling the rudder and the speed controller changes the sail angle to optimize longitudinal speed using a simple feedback linearization and pd controller in xiao and jouffroy 2014 the desired heading can be well tracked aiming at the problem that the es speed optimization control contains steady state oscillation in corno et al 2016 this paper will improve it and propose an online speed optimization scheme for unmanned sailboat based on eswso the control scheme is shown in fig 3 the sailing speed optimization system consists of two parts the feedforward part based on the approximate piecewise constant function of the sailing speed polar diagram and the es feedback part in the feedforward part the initial sail angle of attack value α 0 is calculated in advance by classical statistical optimization technology the basic idea is to choose an angle of attack according to the apparent wind angle that yields the maximum longitudinal force f x s the closed loop nature of the system allows for a crude calculation of α 0 a piecewise constant function that is approximated by the sailing speed polar diagram information is shown in fig 4 this piecewise constant function roughly fitted according to the corresponding relationship between the apparent wind angle and the sail angle of attack when the sailing speed reaches the steady state maximum value in different headings then the sail angle can be adjusted in real time based on this piecewise constant function and the apparent wind angle so that the most efficiency use of wind energy to optimize the longitudinal speed of the sailboat as shown in fig 4 when the sailboat is sailing upwind the apparent wind angle is 0 30 loose the sail rope and make the sail angle of attack 0 when sailing in the crosswind the apparent wind angle is 30 50 tight the sail to make the sail angle of attack 30 when sailing in crosswind the apparent wind angle is 50 75 the sail is operated to make the sail angle of attack 40 when sailing in the crosswind the apparent wind angle is 75 160 the sail is operated to make the sail angle of attack 65 when sailing downwind the apparent wind angle is 160 180 manipulate the sail to make the sail angle of attack 90 for the sailing speed es feedback control firstly the direct current part of longitudinal sailing speed signal n is filtered by the high pass filter after the demodulation signal sin ω t is used the approximate gradient information ξ of functional relationship between u and α can be obtained and then the estimated value δ ˆ α is obtained through the integral link δ ˆ α and a s i n ω t are superimposed to get the optimal sail angle of attack δ α finally the actual sail angle of attack α is obtained by combining the initial sail angle of attack α 0 the actual control variable of the sailboat is not the sail angle of attack but the sail angle δ s the sail angle is calculated from formula δ s α aw α and acts on the sailboat to form a closed loop control the sail angle of attack variable is continuously optimized until the input and output function relationship between the longitudinal speed and the sail angle of attack reaches the extreme point and the maximum sailing speed is obtained due to the optimal sail angle of attack contains excitation signal a sin ω t there is a steady state oscillation in the system so construct a proportional functional relationship between the excitation signal amplitude a and the square of extremum estimation error when the speed es control system asymptotically converges the gradient information ξ will approach zero and the excitation signal amplitude a also gradually decreases to zero thus eliminating steady state oscillation in fig 3 r k ω ω l ω h are the design parameters of the es algorithm r is the constant gain the sign of is designed according to the maximum value or the minimum value of the algorithm search so that the excitation signal amplitude a is always positive r can also be used to adjust the convergence speed and has a certain influence on the steady state accuracy k is the integral gain the higher gain the faster the convergence to the optimal value but the less robust to disturbance and noise and the excessive gain will affect the stability of system ω is the angular frequency of excitation signal and demodulation signal ω l and ω h are the cutoff frequency of low pass filter and high pass filter respectively the angular frequency and the cutoff frequency do not affect the steady state accuracy of the algorithm but have a small effect on the convergence speed of the algorithm the frequency also should not be too large which will adversely affect the robustness of the algorithm 4 stability analysis the sailing speed optimization closed loop system shown in fig 3 can be written as 6 x f x α x δ ˆ α a sin ω t δ ˆ α k u n sin ω t a ω l a r ω l u n n ω h n ω h u introduce the new coordinates 7 δ α δ ˆ α δ α n n h l δ α and get 8 x f x α x δ α δ α a sin ω t δ α k h x n h l δ α sin ω t a ω l a r ω l h x n h l δ α n ω h n ω h h x h l δ α where δ α is the sail angle of attack estimation error n is the longitudinal speed estimation error to further analyze the system eq 8 the design parameters are selected as 9 ω h ω ω h ω δ ω h ω l ω ω l ω δ ω l k ω k ω δ k where ω and δ are small positive constants ω h ω l and k are positive constants of the order of magnitude ω δ in the time scale τ ω t the system eq 8 is rewritten as 10 ω d x d τ f x α x δ α δ α a sin τ 11 d d τ δ α a n δ k h x n h l δ α sin τ ω l a r ω l h x n h l δ α ω h n ω h h x h l δ α the system eq 10 eq 11 is in standard singular perturbation form where the perturbation parameter is ω applying the singular perturbation theory the stability of the system depends on the stability of its boundary layer system and reduced system rayguru and kar 2017 according to the analysis of the above system the following theorem can be obtained theorem 1 consider the closed loop system eq 6 under assumptions 1 3 there is a neighborhood of the point x δ ˆ α a n l δ α δ α 0 h l δ α and constants ω and δ such that for all ω 0 ω and δ 0 δ the solution x t δ ˆ α t a t n t converges exponentially to the point that is when the speed es control system asymptotically converges the gradient information ξ will approach zero and the estimated value δ ˆ α tends to a certain optimum δ α namely the estimation error δ α tends to zero and the excitation signal amplitude a also gradually decreases to zero thus the closed loop system is stable and eliminate the steady state oscillation the longitudinal sailing speed output u t converges to the maximum steady state sailing speed h l δ α proof the stability of the reduced system is studied firstly we freeze x at x l δ α δ α a sin τ to get the reduced system in the time scale τ ω t as 12 d d τ δ α r a r n r δ k v δ α r a r sin τ n r sin τ ω l a r r ω l v δ α r a r sin τ n r ω h n r ω h v δ α r a r sin τ where v δ α r a r sin τ h l δ α δ α r a r sin τ h l δ α under assumption 3 we can obtain 13 v 0 0 14 v 0 h l δ α 0 15 v 0 h l δ α 0 the form of the system eq 12 can be analyzed using the averaging method gama et al 2011 the average system of eq 12 is 16 d d τ δ α r a a r a n r a δ k 2 π 0 2 π v δ α r a a r a sin σ sin σ d σ ω l a r a r ω l n r a r ω l 2 π 0 2 π v δ α r a a r a sin σ d σ ω h n r a ω h 2 π 0 2 π v δ α r a a r a sin σ d σ the equilibrium of average system eq 16 meets following condition 17 0 2 π v δ α r a e a r a e sin σ sin σ d σ 0 r 2 π 0 2 π v δ α r a e a r a e sin σ d σ a r a e r n r a e 1 2 π 0 2 π v δ α r a e a r a e sin σ d σ n r a e through solving the equations in 17 the equilibrium of the system is the origin 0 0 0 can be obtained the jacobian matrix of system eq 16 at equilibrium 0 0 0 is 18 a δ 0 0 0 0 ω l r ω l 0 0 ω h it can be seen that the jacobian matrix of the system eq 16 has a zero eigenvalue and two negative eigenvalues so the local stability of the system eq 16 at the origin can be analyzed using the central manifold theorem according to the central manifold theorem given in liu et al 2000 the system eq 16 can be expressed as follows 19 y d δ α r a d τ a 1 y g 1 y z δ k 2 π 0 2 π v δ α r a a r a sin σ sin σ d σ 20 z d d τ a r a n r a a 2 z g 2 y z where y δ α r a z a r a n r a a 1 0 g 1 y z δ k 2 π 0 2 π v δ α r a a r a sin σ sin σ d σ a 2 δ ω l r ω l 0 ω h and g 2 y z δ r ω l 2 π 0 2 π v δ α r a a r a sin σ d σ ω h 2 π 0 2 π v δ α r a a r a sin σ d σ it can be seen that g 1 and g 2 are twice continuously differentiable and 21 g i 0 0 0 g i y 0 0 0 g i z 0 0 0 where i 1 2 so there are a constant ρ 0 and a continuously differentiable function p y for all δ α r a ρ such that z p y is a center manifold for system eq 19 eq 20 the function z p y satisfies 22 p 0 0 d p d y 0 0 therefore eq 19 can be expressed as 23 δ α r a δ k 2 π 0 2 π v δ α r a p δ α r a sin σ sin σ d σ where δ α r a and p δ α r a are positive we can know from the central manifold theorem that by analyzing the stability of the system eq 23 the local stability of the systems eq 19 eq 20 at the equilibrium 0 0 0 can be obtained the stability of the system eq 23 can be analyzed by using lyapunov direct method so select the function 24 v δ α r a 1 2 0 2 π v δ α r a p δ α r a sin σ sin σ d σ 2 0 as a candidate lyapunov function for system eq 23 taking the derivative of v δ α r a along system eq 23 in time scale τ ω t we get 25 v δ α r a δ k 2 π 0 2 π v δ α r a p δ α r a sin σ sin σ d σ 2 0 2 π v δ α r a p δ α r a sin σ sin σ d σ where δ k 2 π 0 2 π v δ α r a p δ α r a sin σ sin σ d σ 2 0 applying formula of integration by parts we can get 26 0 2 π v δ α r a p δ α r a sin σ sin σ d σ p δ α r a 0 2 π v δ α r a p δ α r a sin σ cos 2 σ d σ eq 15 guarantees eq 26 is negative therefore we can get 27 v δ α r a 0 then the system eq 23 is asymptotically stable at the origin in order to further study the exponential stability of the system eq 23 applying the taylor series expansion for v δ α r a p δ α r a sin σ in eq 23 and get v δ α r a p δ α r a sin σ v 0 v 0 δ α r a p δ α r a sin σ v 0 2 δ α r a p δ α r a sin σ 2 r v 0 2 δ α r a p δ α r a sin σ 2 r where v 0 v 0 0 r r σ δ α r a is a high order term containing s i n σ the high order term r can be ignored when analyzing the local stability of the system so get 28 δ α r a δ k 2 π 0 2 π v 0 2 δ α r a p δ α r a sin σ 2 sin σ d σ δ k v 0 2 p δ α r a δ α r a where δ k v 0 p δ α r a is negative so the system eq 23 is local exponentially stable at the origin applying the central manifold theorem given in liu et al 2000 there is a constant ρ 0 for all δ α r a ρ systems eq 19 eq 20 i e system eq 16 is local exponentially stable at the origin since the system eq 16 is obtained by averaging the system eq 12 therefore apply the averaging method to analyze the stability of reduced system eq 12 at the origin combining the above conclusions it is known that there exist positive constants δ and ρ so that for all 0 δ δ δ α r a ρ system eq 12 is local exponentially stable at the equilibrium point in order to complete the singular perturbation analysis the boundary layer system at time scale t τ ω is also studied 29 d x d t f x α x δ α where δ α δ α δ α a sin τ should be viewed as a parameter independent of the time variable t introduce the new coordinate 30 x x b l δ α and the boundary layer system eq 29 can be expressed as 31 d x b d t f x b l δ α α x b l δ α δ α because f l δ α α l δ α δ α 0 x b 0 is an equilibrium of the system eq 31 it can be obtained from assumption 2 that this equilibrium is local exponentially stable in summary the reduced system eq 12 and the boundary layer system eq 31 are local exponentially stable at the equilibrium and apply the singular perturbation theory in rayguru and kar 2017 theorem 1 can be proven the stability proof is completed 5 simulation results a 12 m class unmanned sailboat dynamic model derived in xiao and jouffroy 2014 as the simulation object to evaluate the performance of the eswso speed optimization scheme model parameters as follows m 25900 kg l 12 m b 3 21 m i x x 133690 kg m 2 i zz 24760 kg m 2 with detailed parameters of the sailboat reference xiao and jouffroy 2014 in the simulation process it is assumed that external disturbance parameters are t 2 15 m k 1 1 μ 2 h 1 1 15 m ω e 0 65 hz ρ water 1025 kg m 3 this is equivalent to a small wave generated under the action of about level 3 wind the wavelength is still short but the waveform is significant under the condition that the model is known by means of simulation the rudder is first controlled to maintain the heading and then the sail angle is constantly adjusted to obtain the theoretical maximum speed which is called model based optimal speed which can be used to evaluate the performance of the es sailing speed optimization scheme a kind of es speed optimization scheme proposed in corno et al 2016 is different from the eswso which is called the classical es in this paper the effectiveness of the eswso optimization scheme is verified by comparing with model based optimal speed and the classical es speed 5 1 simulation without external disturbance in the case of no external disturbance the initial position of the unmanned sailboat is set as the origin 0 0 the initial heading is 0 the desired heading is 110 the initial sailboat speed is 2 m s the true wind speed is 5 m s and the wind is assumed to be coming from the north the parameters of the eswso algorithm are selected as r 0 08 k 0 2 ω 2 6 ω l 0 5 ω h 1 2 the simulation results are shown in figs 5 9 as shown in fig 5 the actual heading of the sailboat can track the desired heading figs 6 8 are curves of apparent wind angle sail angle of attack and sail angle respectively and satisfy the relationship of δ s α aw α during the es control process the sail angle of attack is continuously optimized to adjust the sail to the optimal position so that the effective thrust of sail by wind is the maximum that is the longitudinal sailing speed is the largest as shown in fig 9 the maximum speed at steady state is about 3 832 m s as shown in fig 7 the sail angle of attack contains larger steady state oscillation in the classical es speed optimization scheme but in the eswso speed optimization scheme when the system asymptotically converges the excitation signal amplitude a will gradually decrease the sail angle of attack will converge to the optimal value and eliminate steady state oscillation fig 9 shows the comparison between model based optimal speed the classical es speed and the eswso speed value the simulation results show that both speed optimization values based on the esa can track model based optimal speed it can be seen from the local enlarged image that the eswso optimization scheme not only eliminates the steady state oscillation existing in the classical es but also has extremely high steady state accuracy and improves the convergence speed so the performance of the improved speed optimizer is good 5 2 simulation with external disturbance by further considering the presence of external disturbance the robustness of the proposed optimization scheme can be evaluated change the desired heading to 70 and the other parameters remain unchanged add the wave disturbance to simulate the results are shown in figs 10 14 the simulation results are shown in figs 12 14 the influence of external disturbance on the classical es is more obvious when the closed loop system tends to be stable the sail angle and the sail angle of attack all have larger steady state oscillations and the large and frequent change of sail angle will affect the stability of the system which is not suitable for practical online application the eswso speed optimization scheme has stronger robustness to external disturbance and the sail angle and sail angle of attack gradually tend to be stable as shown in fig 14 the eswso speed optimization value is superior to the classical es speed optimization value and closer to model based optimal speed so the improved scheme has better convergence speed and stability than the classical es scheme and has a strong robustness to uncertain time varying factors 5 3 sailing speed polar diagram simulation the above simulation results show that the proposed speed optimization scheme works well and has strong robustness next the eswso speed optimization results are compared with the model based optimal speed values in different headings to evaluate the control accuracy of the speed optimizer the sailing speed polar diagram describes the maximum steady state speed of a sailboat model in different headings under a certain wind direction and strength when the model is known the maximum sailing speed of the sailboat can be obtained through the simulation environment specifically the red arrow represents the direction of the true wind and the wind speed is 5 m s on different headings π π first control the rudder to determine the heading then adjust the sail angle to optimize the longitudinal speed of the sailboat to obtain the maximum value and draw the maximum speed to the polar diagram as shown in fig 15 blue curve there is an obvious no go zone in the direction of upwind that is an approximate area between 45 and 45 under the influence of external environmental forces it is difficult to keep the sailboat on the original course even if it is full rudder in the no go area as shown in fig 15 the comparison between the model based speed polar diagram blue curve and the optimal speed value red mark based on eswso is given although they have individual speed values that are not match in the figure fine tuning the parameters in the eswso optimizer may yield better performance since the optimal speed values of the eswso in most headings are matched with the model based optimal speed value it means that the proposed speed optimizer ensures good control accuracy and the sailing speed reaches the optimal navigation state 6 conclusion in order to make full use of wind energy to obtain the maximum sailing speed of unmanned sailboat aiming at the problem of the classical es with steady state oscillation this paper proposes an speed optimization scheme based on the eswso the scheme consists of feedforward and feedback control the feedforward part directly obtains the initial sail angle of attack by using the approximate piecewise constant function of sailing speed polar diagram which is equivalent to the control variable given according to expert experience the feedback control part continuously optimizes the sail angle of attack variable by the es control until the function relationship between the longitudinal speed and the sail angle of attack reaches the extreme point that is the maximum speed is obtained the rigorous stability proof of the improved scheme is given in detail simulation results show that the optimized sailing speed can reach the ideal maximum value the eswso speed optimization scheme eliminates the steady state oscillation in classical es scheme and has higher control accuracy and strong robustness acknowledgments this work is supported by national natural science foundation of china 51809028 51879027 51579024 and fundamental research funds for the central universities under grant 3132019109 and 3132019318 
22523,concentrated on the problem of steady state oscillation of the traditional extremum seeking algorithm esa that it is not beneficial to the speed optimization of unmanned sailboat a novel speed optimization scheme with feedforward of unmanned sailboat via extremum seeking without steady state oscillation eswso is proposed this scheme consists of feedforward and feedback control the feedforward part firstly presets the initial sail angle of attack according to an approximate piecewise constant function of the sailing speed polar diagram its main function is avoid the large deviation of the longitudinal speed from the optimal value subsequently the feedback part fine tunes the speed to reach the optimal value through the extremum seeking es control in the process of continuously optimizing longitudinal speed a functional relationship between the excitation signal amplitude and the extremum estimation error is constructed to eliminate the steady state oscillation besides the rigorous stability proof of the scheme is given finally taking a 12 m class unmanned sailboat as the simulation object the results show that the optimization scheme can effectively eliminate steady state oscillation and enable the sailing speed to reach the ideal optimal value as well as has a high control accuracy and strong robustness keywords unmanned sailboat speed optimization speed polar diagram extremum seeking steady state oscillation 1 introduction as intelligent vehicles on the sea unmanned sailboats have shown unique advantages in marine data collection environmental monitoring and marine surveillance and other aspects neal 2006 unmanned sailboat uses wind energy as the main power source which is not limited by carrying fuel extends the cruise time effectively improves the scope of maritime monitoring and greatly saves resources thus has a good application prospect plumet et al 2015 the extensive research on unmanned sailboats began in the 1990s which can be divided into hard sail and soft sail sailboats according to the sail type elkaim 2006 since 2008 the world robotic sailing championship and international robotic sailing conference wrsc irsc have been held regularly every year providing a good platform for relevant international exchanges rynne and von ellenrieder 2009 in contrast domestic research on unmanned sailboats lags behind seriously the complete autonomous control of unmanned sailboats is a challenging task involving many factors in complex sea conditions the rudder needs to be controlled to keep the sailboat tracking the desired heading at the same time a reasonable sail control strategy is needed to obtain the maximum propulsion force so as to optimize the longitudinal speed in recent years many scholars at home and abroad have conducted in depth study on unmanned sailboats and sailing strategies in the study of heading control for unmanned sailboats a classical pid heading controller for a 2 m class autonomous sailboat is designed in emami et al 2013 melin et al 2016 designed the rudder angle controller of the sailboat based on p pd and sinusoidal control methods combined with saturation function stelzer et al 2007 modeled a sailboat in a complex environment and proposed an experience based fuzzy control method for sailboat saoud et al 2015a b used the three degree of freedom sailboat model as the research object and designed the heading controller by using the backstepping method and the switching function based on the fossen modeling idea xiao and jouffroy 2014 designed a nonlinear heading controller for the four degree of freedom mathematical model of sailboat by using the backstepping method wille et al 2016 established a four degree of freedom sailing mathematical model considering external environmental disturbances the heading controller was designed by state feedback linearization and the leeway angle was introduced as a correction term to reduce the heading control error stelzer and proll 2008 developed appropriate navigation routes according to different environmental conditions and reached the specified goals through the autonomous control of sailboat on the basis of heading control scholars have carried out a series of studies on how to reasonably control sail and optimize sailing speed saoud et al 2015a b proposed a method to calculate the optimal sail angle of a sailboat by numerical simulation method this method keeps the sailing speed in the best navigation state by limiting the roll angle based on the three degree of freedom ship mathematical model herrero et al 2010 first used the quantified set inversion and feedback linearization techniques to optimize the sailing speed however modeling error may be encountered due to the obvious nonlinear time varying performance of the ship viola and flay 2012 designed the open loop speed optimization model based on the sail polar but it lacks the speed feedback link which fails to make the sailboat obtain the maximum speed kai and jouffroy 2010 used an esa to optimize the sailing speed which can be controlled by an adaptive model free feedback method the above studies on sailing speed optimization are mainly focused on open loop control based on the speed polar diagram the closed loop model based control and the model free online optimization control above three methods have their own limitations if can combine their own characteristics to design an adaptive control scheme it will play an important role in enhancing the overall performance of sailboat in recent years the esa has attracted the attention of scholars due to its unique ability to track the extremum of an unknown time varying performance function guay and zhang 2003 among them the perturbation based esa and the sliding mode based esa are the most basic and evolve from the initial single parameter to the multi parameter esa theory as well as involve continuous and discrete time systems the esa have been widely used in system optimization design such as automobile unmanned sailboat aircraft fuel cell wireless sensor and other fields adetola and guay 2007 proposed a model free adaptive es control method which guaranteed the convergence of parameters and small steady state error and verified the effectiveness of the method through simulation examples dingmen and altinel 2016 designed an es optimization control in the vehicle anti lock braking system but the presence of high frequency oscillation will affect the wide application in the system xiao et al 2012 proposed a non perturbation based esa which only needs to use the function gradient optimization knowledge to optimize the sailing speed by continuously adjusting the sail angle corno et al 2016 designed an online speed es optimization system based on the sailing speed polar diagram the system is not affected by modeling errors and overcomes the limitations of traditional speed optimization based on sail polar in the above applications of esa have a problem with steady state oscillation which seriously affects the real time online application of esa zhang and ordonez 2007 proposed a numerical optimization based esa which successfully eliminated the adverse effect of steady state oscillation but its convergence speed is slower and the design of parameters is more complicated deng et al 2019 combined the esa with the self tuning fuzzy logic system to design a speed optimization scheme for sail assisted ships after adequate online learning and training the fuzzy logic system is capable to maximize the sailing speed with less oscillation but it may fall into local extremum wang et al 2016 used the pre demodulation signal to adaptively adjust the excitation signal amplitude to realize the design of the perturbation based eswso it can enlarge the search area to avoid falling to the local on the basis of wang et al 2016 wang et al 2014 further proposed an eswso based on demodulated signal the improved algorithm has a stronger adaptive ability to extremum estimation error and a faster convergence speed chen et al 2016 proposed a novel switching based es control scheme which overcomes the steady state oscillation in the traditional esa and maintains a faster convergence speed inspired by the above studies this paper aims to make full use of wind energy to obtain the maximum speed of unmanned sailboat concentrates on the problem of steady state oscillation of the es speed optimization scheme in corno et al 2016 proposes an novel online speed optimization scheme via eswso the scheme consists of feedforward block and feedback control specifically the feedforward part firstly uses an approximate piecewise constant function of the sailing speed polar diagram to obtain the initial sail angle of attack the feedback part according to the longitudinal speed of the sailboat the optimal sail angle of attack is fed back by es control the initial sail angle of attack and the optimal value are superimposed to obtain the actual sail angle of attack so that the sail angle is calculated and acts on the unmanned sailboat to form a closed loop control to continuously optimize the longitudinal speed besides a rigorous proof process is given for the stability of the eswso scheme finally based on a 12 m class unmanned sailboat model simulation studies are carried out to verify the effectiveness of the optimization scheme the novelty of this paper can be concluded as follows 1 the eswso speed optimization scheme contains a feedforward block to preset the sail angle of attack its function consists in avoiding the large deviation of the speed output from the optimal value on this basis the es control is used to fine tune the sailing speed to reach the optimal value 2 the eswso speed optimization scheme is adopted to search the optimal speed of unmanned sailboat to eliminate steady state oscillation in corno et al 2016 we construct a functional relationship between the excitation signal amplitude and the extremum estimation error in the process of speed optimization the optimization scheme can eliminate the steady state oscillation in that the excitation signal amplitude will fast converge to zero with the decrease of the extremum estimation error the remainder of this paper is organized as follows section 2 introduces preliminaries and problem formulation section 3 presents the design of eswso speed optimization scheme section 4 devotes the stability analysis section 5 exhibits simulation and comparison results section 6 concludes the entire work 2 preliminaries and problem formulation 2 1 preliminaries in the following a nonlinear dynamic model of the unmanned sailboat is introduced let us define an inertial reference frame o x y z and a body fixed reference frame o x y z as shown in fig 1 o is the starting position o x points to the north o y points to the east o z points to the center of the earth o is the center of the line between the head and tail of sailboat o x points to the bow along the central axis of the sailboat o y points to the starboard o z points to the bottom of sailboat the force analysis of the sail is shown in fig 2 which establishes a rectangular coordinate system with the center of gravity of sailboat as the origin and defines the bow direction as the x axis positive direction and the right side of the longitudinal axis as the y axis positive direction the true wind is observed in the inertial reference frame the true wind speed is represented by v tw and the true wind angle is represented by α tw the apparent wind is observed in the body fixed reference frame v aw is the apparent wind speed and α aw is the apparent wind angle it is prescribed that the wind on the port side is positive the sail angle δ s defined as the angle between the sail chord and the longitudinal axis of sailboat α is the angle between the apparent wind and the sail chord called the sail angle of attack the angle between the heading and the longitudinal axis of sailboat is the leeway angle recorded as θ v is the actual sailing speed u is the longitudinal speed v is the lateral speed which satisfies v 2 u 2 v 2 l s is the sail lift force d s is the sail drag force δ r is the rudder angle in xiao and jouffroy 2014 the sailboat is separated into four parts the sail rudder keel and hull the hydrodynamic theory and aerodynamic theory are used to analyze the force of each part and the function expression of each part is obtained a four degree of freedom sailboat dynamic model is established the model does not consider the influence of external disturbances so this paper adds external disturbances such as waves or winds and expresses the four degree of freedom dynamic model of sailboat as 1 x 1 u cos ψ v sin ψ cos φ y 1 u sin ψ v cos ψ cos φ φ p ψ r 1 cos φ u m y v v r 1 f x k f x h f x s f x r x wave m x u 1 v m x u u r 1 f y k f y h f y s f y r y wave m y v 1 p m r φ m x k m x h m x s m x r m φ d φ k wave i x x k p 1 r 1 x u y v u ν m z k m z h m z s m z r m ψ d ψ cos φ n wave i z z n r 1 where x 1 and y 1 are the actual positions of sailboat in the inertial reference frame φ is the roll angle ψ is the yaw angle u is the longitudinal speed v is the lateral speed p is the roll angular velocity and r 1 is the yaw angular velocity f x s f y s m x s m z s are the forces and moments on the sail f x r f y r m x r m z r are the forces and moments on the rudder f x k f y k m x k m z k are the forces and moments the keel f x h f y h m x h m z h are the hull resistance forces and moments m ψ d ψ is the yaw damping matrix m φ d φ is the heel damping matrix and m r φ is the static righting moment m is the mass of the sailboat i x x is the principle moment of inertia about the x axis in the body fixed reference frame i z z is the principle moment of inertia about the z axis in the body fixed reference frame x u y v k p n r are the added mass coefficients and the specific expressions of forces and moments each part are detailed in reference xiao and jouffroy 2014 in eq 1 x wave y wave k wave n wave are the forces and moments generated by wave disturbance and the specific expressions are as follows x wave 2 a 1 b sin b sin c c s t y wave 2 a 1 l sin b sin c b s t k wave 1 2 ρ water g m h c k 1 a a sin μ e k t 2 sin ω e t n wave a 1 k b 2 sin b c cos c sin c c 2 l 2 sin c b cos b sin b b 2 ξ t where l is the length of the sailboat b is the width of the sailboat a a is the sail area t is the draft k 1 is the wave number ρ water is the density of the seawater g is the acceleration of gravity h c is the initial metacentric height represents the distance from the center of gravity to the metacenter of sailboat a 1 ρ water g 1 e k 1 t k 1 2 b k 1 l 2 cos μ c k 1 b 2 sin μ ξ t h 1 2 cos ω e t s t k 1 h 1 2 sin ω e t μ is the wave direction angle ω e is the encounter frequency h 1 is the significant wave height 2 2 problem formulation from the four degree of freedom sailboat mathematical model eq 1 it is known that the mathematical model of sailing speed is 2 u f 1 u v p r 1 δ s in eq 2 f 1 m y v v r 1 f x k f x h f x s f x r x wave m x u 1 when analyzing the es control of the speed optimization system the optimization object can be regarded as a square system as long as the input and output of the system are clear it can be optimized so the mathematical model of sailing speed eq 2 can be approximated to the general nonlinear system 3 x f x δ s u h x where x r n is the system state the sail angle δ s r is the system input the longitudinal speed of sailboat u r is the system output f and h are the system state equation and the output equation respectively and both are smooth functions suppose there is the following control law with the optimal sail angle of attack δ α as the scalar parameter 4 δ s α aw α 0 δ α α x δ α bringing eq 4 into eq 3 the closed loop system 5 x f x α x δ α the following assumptions are made regarding this closed loop system assumption 1 there is a smooth function l r r n f x α x δ α 0 is true if and only if x l δ α assumption 2 for any δ α r the equilibrium x l δ α of the closed loop system eq 5 is local exponentially stable this assumption is not a requirement only means that the closed loop system can be locally stable by designing the control law even without understanding the model knowledge f x δ s or l δ α assumption 3 there exists δ α r such that u h l δ α 0 u h l δ α 0 this assumption ensures the function u h l δ α has a maximum longitudinal velocity value at a certain sail angle of attack optimum δ α in conclusion the control objective of system can be described as for the optimization object of es control eq 5 satisfies the above three assumptions the optimal sail angle of attack value δ α completes the tracking of the unknown optimum δ α in the sailing speed optimization process so that the system output u maintains the optimal sailing speed 3 eswso speed optimization the point of view from the control system designer the unmanned sailboat is a square system with two inputs sail angle and rudder angle and two outputs longitudinal speed and heading the system maintains the heading by controlling the rudder and the speed controller changes the sail angle to optimize longitudinal speed using a simple feedback linearization and pd controller in xiao and jouffroy 2014 the desired heading can be well tracked aiming at the problem that the es speed optimization control contains steady state oscillation in corno et al 2016 this paper will improve it and propose an online speed optimization scheme for unmanned sailboat based on eswso the control scheme is shown in fig 3 the sailing speed optimization system consists of two parts the feedforward part based on the approximate piecewise constant function of the sailing speed polar diagram and the es feedback part in the feedforward part the initial sail angle of attack value α 0 is calculated in advance by classical statistical optimization technology the basic idea is to choose an angle of attack according to the apparent wind angle that yields the maximum longitudinal force f x s the closed loop nature of the system allows for a crude calculation of α 0 a piecewise constant function that is approximated by the sailing speed polar diagram information is shown in fig 4 this piecewise constant function roughly fitted according to the corresponding relationship between the apparent wind angle and the sail angle of attack when the sailing speed reaches the steady state maximum value in different headings then the sail angle can be adjusted in real time based on this piecewise constant function and the apparent wind angle so that the most efficiency use of wind energy to optimize the longitudinal speed of the sailboat as shown in fig 4 when the sailboat is sailing upwind the apparent wind angle is 0 30 loose the sail rope and make the sail angle of attack 0 when sailing in the crosswind the apparent wind angle is 30 50 tight the sail to make the sail angle of attack 30 when sailing in crosswind the apparent wind angle is 50 75 the sail is operated to make the sail angle of attack 40 when sailing in the crosswind the apparent wind angle is 75 160 the sail is operated to make the sail angle of attack 65 when sailing downwind the apparent wind angle is 160 180 manipulate the sail to make the sail angle of attack 90 for the sailing speed es feedback control firstly the direct current part of longitudinal sailing speed signal n is filtered by the high pass filter after the demodulation signal sin ω t is used the approximate gradient information ξ of functional relationship between u and α can be obtained and then the estimated value δ ˆ α is obtained through the integral link δ ˆ α and a s i n ω t are superimposed to get the optimal sail angle of attack δ α finally the actual sail angle of attack α is obtained by combining the initial sail angle of attack α 0 the actual control variable of the sailboat is not the sail angle of attack but the sail angle δ s the sail angle is calculated from formula δ s α aw α and acts on the sailboat to form a closed loop control the sail angle of attack variable is continuously optimized until the input and output function relationship between the longitudinal speed and the sail angle of attack reaches the extreme point and the maximum sailing speed is obtained due to the optimal sail angle of attack contains excitation signal a sin ω t there is a steady state oscillation in the system so construct a proportional functional relationship between the excitation signal amplitude a and the square of extremum estimation error when the speed es control system asymptotically converges the gradient information ξ will approach zero and the excitation signal amplitude a also gradually decreases to zero thus eliminating steady state oscillation in fig 3 r k ω ω l ω h are the design parameters of the es algorithm r is the constant gain the sign of is designed according to the maximum value or the minimum value of the algorithm search so that the excitation signal amplitude a is always positive r can also be used to adjust the convergence speed and has a certain influence on the steady state accuracy k is the integral gain the higher gain the faster the convergence to the optimal value but the less robust to disturbance and noise and the excessive gain will affect the stability of system ω is the angular frequency of excitation signal and demodulation signal ω l and ω h are the cutoff frequency of low pass filter and high pass filter respectively the angular frequency and the cutoff frequency do not affect the steady state accuracy of the algorithm but have a small effect on the convergence speed of the algorithm the frequency also should not be too large which will adversely affect the robustness of the algorithm 4 stability analysis the sailing speed optimization closed loop system shown in fig 3 can be written as 6 x f x α x δ ˆ α a sin ω t δ ˆ α k u n sin ω t a ω l a r ω l u n n ω h n ω h u introduce the new coordinates 7 δ α δ ˆ α δ α n n h l δ α and get 8 x f x α x δ α δ α a sin ω t δ α k h x n h l δ α sin ω t a ω l a r ω l h x n h l δ α n ω h n ω h h x h l δ α where δ α is the sail angle of attack estimation error n is the longitudinal speed estimation error to further analyze the system eq 8 the design parameters are selected as 9 ω h ω ω h ω δ ω h ω l ω ω l ω δ ω l k ω k ω δ k where ω and δ are small positive constants ω h ω l and k are positive constants of the order of magnitude ω δ in the time scale τ ω t the system eq 8 is rewritten as 10 ω d x d τ f x α x δ α δ α a sin τ 11 d d τ δ α a n δ k h x n h l δ α sin τ ω l a r ω l h x n h l δ α ω h n ω h h x h l δ α the system eq 10 eq 11 is in standard singular perturbation form where the perturbation parameter is ω applying the singular perturbation theory the stability of the system depends on the stability of its boundary layer system and reduced system rayguru and kar 2017 according to the analysis of the above system the following theorem can be obtained theorem 1 consider the closed loop system eq 6 under assumptions 1 3 there is a neighborhood of the point x δ ˆ α a n l δ α δ α 0 h l δ α and constants ω and δ such that for all ω 0 ω and δ 0 δ the solution x t δ ˆ α t a t n t converges exponentially to the point that is when the speed es control system asymptotically converges the gradient information ξ will approach zero and the estimated value δ ˆ α tends to a certain optimum δ α namely the estimation error δ α tends to zero and the excitation signal amplitude a also gradually decreases to zero thus the closed loop system is stable and eliminate the steady state oscillation the longitudinal sailing speed output u t converges to the maximum steady state sailing speed h l δ α proof the stability of the reduced system is studied firstly we freeze x at x l δ α δ α a sin τ to get the reduced system in the time scale τ ω t as 12 d d τ δ α r a r n r δ k v δ α r a r sin τ n r sin τ ω l a r r ω l v δ α r a r sin τ n r ω h n r ω h v δ α r a r sin τ where v δ α r a r sin τ h l δ α δ α r a r sin τ h l δ α under assumption 3 we can obtain 13 v 0 0 14 v 0 h l δ α 0 15 v 0 h l δ α 0 the form of the system eq 12 can be analyzed using the averaging method gama et al 2011 the average system of eq 12 is 16 d d τ δ α r a a r a n r a δ k 2 π 0 2 π v δ α r a a r a sin σ sin σ d σ ω l a r a r ω l n r a r ω l 2 π 0 2 π v δ α r a a r a sin σ d σ ω h n r a ω h 2 π 0 2 π v δ α r a a r a sin σ d σ the equilibrium of average system eq 16 meets following condition 17 0 2 π v δ α r a e a r a e sin σ sin σ d σ 0 r 2 π 0 2 π v δ α r a e a r a e sin σ d σ a r a e r n r a e 1 2 π 0 2 π v δ α r a e a r a e sin σ d σ n r a e through solving the equations in 17 the equilibrium of the system is the origin 0 0 0 can be obtained the jacobian matrix of system eq 16 at equilibrium 0 0 0 is 18 a δ 0 0 0 0 ω l r ω l 0 0 ω h it can be seen that the jacobian matrix of the system eq 16 has a zero eigenvalue and two negative eigenvalues so the local stability of the system eq 16 at the origin can be analyzed using the central manifold theorem according to the central manifold theorem given in liu et al 2000 the system eq 16 can be expressed as follows 19 y d δ α r a d τ a 1 y g 1 y z δ k 2 π 0 2 π v δ α r a a r a sin σ sin σ d σ 20 z d d τ a r a n r a a 2 z g 2 y z where y δ α r a z a r a n r a a 1 0 g 1 y z δ k 2 π 0 2 π v δ α r a a r a sin σ sin σ d σ a 2 δ ω l r ω l 0 ω h and g 2 y z δ r ω l 2 π 0 2 π v δ α r a a r a sin σ d σ ω h 2 π 0 2 π v δ α r a a r a sin σ d σ it can be seen that g 1 and g 2 are twice continuously differentiable and 21 g i 0 0 0 g i y 0 0 0 g i z 0 0 0 where i 1 2 so there are a constant ρ 0 and a continuously differentiable function p y for all δ α r a ρ such that z p y is a center manifold for system eq 19 eq 20 the function z p y satisfies 22 p 0 0 d p d y 0 0 therefore eq 19 can be expressed as 23 δ α r a δ k 2 π 0 2 π v δ α r a p δ α r a sin σ sin σ d σ where δ α r a and p δ α r a are positive we can know from the central manifold theorem that by analyzing the stability of the system eq 23 the local stability of the systems eq 19 eq 20 at the equilibrium 0 0 0 can be obtained the stability of the system eq 23 can be analyzed by using lyapunov direct method so select the function 24 v δ α r a 1 2 0 2 π v δ α r a p δ α r a sin σ sin σ d σ 2 0 as a candidate lyapunov function for system eq 23 taking the derivative of v δ α r a along system eq 23 in time scale τ ω t we get 25 v δ α r a δ k 2 π 0 2 π v δ α r a p δ α r a sin σ sin σ d σ 2 0 2 π v δ α r a p δ α r a sin σ sin σ d σ where δ k 2 π 0 2 π v δ α r a p δ α r a sin σ sin σ d σ 2 0 applying formula of integration by parts we can get 26 0 2 π v δ α r a p δ α r a sin σ sin σ d σ p δ α r a 0 2 π v δ α r a p δ α r a sin σ cos 2 σ d σ eq 15 guarantees eq 26 is negative therefore we can get 27 v δ α r a 0 then the system eq 23 is asymptotically stable at the origin in order to further study the exponential stability of the system eq 23 applying the taylor series expansion for v δ α r a p δ α r a sin σ in eq 23 and get v δ α r a p δ α r a sin σ v 0 v 0 δ α r a p δ α r a sin σ v 0 2 δ α r a p δ α r a sin σ 2 r v 0 2 δ α r a p δ α r a sin σ 2 r where v 0 v 0 0 r r σ δ α r a is a high order term containing s i n σ the high order term r can be ignored when analyzing the local stability of the system so get 28 δ α r a δ k 2 π 0 2 π v 0 2 δ α r a p δ α r a sin σ 2 sin σ d σ δ k v 0 2 p δ α r a δ α r a where δ k v 0 p δ α r a is negative so the system eq 23 is local exponentially stable at the origin applying the central manifold theorem given in liu et al 2000 there is a constant ρ 0 for all δ α r a ρ systems eq 19 eq 20 i e system eq 16 is local exponentially stable at the origin since the system eq 16 is obtained by averaging the system eq 12 therefore apply the averaging method to analyze the stability of reduced system eq 12 at the origin combining the above conclusions it is known that there exist positive constants δ and ρ so that for all 0 δ δ δ α r a ρ system eq 12 is local exponentially stable at the equilibrium point in order to complete the singular perturbation analysis the boundary layer system at time scale t τ ω is also studied 29 d x d t f x α x δ α where δ α δ α δ α a sin τ should be viewed as a parameter independent of the time variable t introduce the new coordinate 30 x x b l δ α and the boundary layer system eq 29 can be expressed as 31 d x b d t f x b l δ α α x b l δ α δ α because f l δ α α l δ α δ α 0 x b 0 is an equilibrium of the system eq 31 it can be obtained from assumption 2 that this equilibrium is local exponentially stable in summary the reduced system eq 12 and the boundary layer system eq 31 are local exponentially stable at the equilibrium and apply the singular perturbation theory in rayguru and kar 2017 theorem 1 can be proven the stability proof is completed 5 simulation results a 12 m class unmanned sailboat dynamic model derived in xiao and jouffroy 2014 as the simulation object to evaluate the performance of the eswso speed optimization scheme model parameters as follows m 25900 kg l 12 m b 3 21 m i x x 133690 kg m 2 i zz 24760 kg m 2 with detailed parameters of the sailboat reference xiao and jouffroy 2014 in the simulation process it is assumed that external disturbance parameters are t 2 15 m k 1 1 μ 2 h 1 1 15 m ω e 0 65 hz ρ water 1025 kg m 3 this is equivalent to a small wave generated under the action of about level 3 wind the wavelength is still short but the waveform is significant under the condition that the model is known by means of simulation the rudder is first controlled to maintain the heading and then the sail angle is constantly adjusted to obtain the theoretical maximum speed which is called model based optimal speed which can be used to evaluate the performance of the es sailing speed optimization scheme a kind of es speed optimization scheme proposed in corno et al 2016 is different from the eswso which is called the classical es in this paper the effectiveness of the eswso optimization scheme is verified by comparing with model based optimal speed and the classical es speed 5 1 simulation without external disturbance in the case of no external disturbance the initial position of the unmanned sailboat is set as the origin 0 0 the initial heading is 0 the desired heading is 110 the initial sailboat speed is 2 m s the true wind speed is 5 m s and the wind is assumed to be coming from the north the parameters of the eswso algorithm are selected as r 0 08 k 0 2 ω 2 6 ω l 0 5 ω h 1 2 the simulation results are shown in figs 5 9 as shown in fig 5 the actual heading of the sailboat can track the desired heading figs 6 8 are curves of apparent wind angle sail angle of attack and sail angle respectively and satisfy the relationship of δ s α aw α during the es control process the sail angle of attack is continuously optimized to adjust the sail to the optimal position so that the effective thrust of sail by wind is the maximum that is the longitudinal sailing speed is the largest as shown in fig 9 the maximum speed at steady state is about 3 832 m s as shown in fig 7 the sail angle of attack contains larger steady state oscillation in the classical es speed optimization scheme but in the eswso speed optimization scheme when the system asymptotically converges the excitation signal amplitude a will gradually decrease the sail angle of attack will converge to the optimal value and eliminate steady state oscillation fig 9 shows the comparison between model based optimal speed the classical es speed and the eswso speed value the simulation results show that both speed optimization values based on the esa can track model based optimal speed it can be seen from the local enlarged image that the eswso optimization scheme not only eliminates the steady state oscillation existing in the classical es but also has extremely high steady state accuracy and improves the convergence speed so the performance of the improved speed optimizer is good 5 2 simulation with external disturbance by further considering the presence of external disturbance the robustness of the proposed optimization scheme can be evaluated change the desired heading to 70 and the other parameters remain unchanged add the wave disturbance to simulate the results are shown in figs 10 14 the simulation results are shown in figs 12 14 the influence of external disturbance on the classical es is more obvious when the closed loop system tends to be stable the sail angle and the sail angle of attack all have larger steady state oscillations and the large and frequent change of sail angle will affect the stability of the system which is not suitable for practical online application the eswso speed optimization scheme has stronger robustness to external disturbance and the sail angle and sail angle of attack gradually tend to be stable as shown in fig 14 the eswso speed optimization value is superior to the classical es speed optimization value and closer to model based optimal speed so the improved scheme has better convergence speed and stability than the classical es scheme and has a strong robustness to uncertain time varying factors 5 3 sailing speed polar diagram simulation the above simulation results show that the proposed speed optimization scheme works well and has strong robustness next the eswso speed optimization results are compared with the model based optimal speed values in different headings to evaluate the control accuracy of the speed optimizer the sailing speed polar diagram describes the maximum steady state speed of a sailboat model in different headings under a certain wind direction and strength when the model is known the maximum sailing speed of the sailboat can be obtained through the simulation environment specifically the red arrow represents the direction of the true wind and the wind speed is 5 m s on different headings π π first control the rudder to determine the heading then adjust the sail angle to optimize the longitudinal speed of the sailboat to obtain the maximum value and draw the maximum speed to the polar diagram as shown in fig 15 blue curve there is an obvious no go zone in the direction of upwind that is an approximate area between 45 and 45 under the influence of external environmental forces it is difficult to keep the sailboat on the original course even if it is full rudder in the no go area as shown in fig 15 the comparison between the model based speed polar diagram blue curve and the optimal speed value red mark based on eswso is given although they have individual speed values that are not match in the figure fine tuning the parameters in the eswso optimizer may yield better performance since the optimal speed values of the eswso in most headings are matched with the model based optimal speed value it means that the proposed speed optimizer ensures good control accuracy and the sailing speed reaches the optimal navigation state 6 conclusion in order to make full use of wind energy to obtain the maximum sailing speed of unmanned sailboat aiming at the problem of the classical es with steady state oscillation this paper proposes an speed optimization scheme based on the eswso the scheme consists of feedforward and feedback control the feedforward part directly obtains the initial sail angle of attack by using the approximate piecewise constant function of sailing speed polar diagram which is equivalent to the control variable given according to expert experience the feedback control part continuously optimizes the sail angle of attack variable by the es control until the function relationship between the longitudinal speed and the sail angle of attack reaches the extreme point that is the maximum speed is obtained the rigorous stability proof of the improved scheme is given in detail simulation results show that the optimized sailing speed can reach the ideal maximum value the eswso speed optimization scheme eliminates the steady state oscillation in classical es scheme and has higher control accuracy and strong robustness acknowledgments this work is supported by national natural science foundation of china 51809028 51879027 51579024 and fundamental research funds for the central universities under grant 3132019109 and 3132019318 
22524,flow past three circular cylinders in an equilateral triangular configuration is simulated for reynolds numbers 200 re 3900 and spacing ratios 1 25 l d 4 0 where l is the center to center distance between each two cylinders and d is the diameter of the cylinder five different flow regimes are identified proximity with deflected flow p d proximity with flip flop flow p f dual vortex shedding dv transition between dual vortex shedding and triple vortex shedding dv tv triple vortex shedding tv the boundary spacing ratios between the five regimes are affected by the reynolds number with the increase of the spacing ratio or the reynolds number the three dimensionality of the wake flow becomes stronger mode b flow pattern with streamwise vortices is found at l d 1 25 3 5 and 4 0 for re 1500 and l d 1 25 for 3900 the pressure coefficient on the surface of the downstream cylinder c3 is significantly different from that on a single cylinder leading to significant reduction of the mean drag coefficient on c3 for all the studied spacing ratios and reynolds numbers the strouhal numbers of c1 and c3 are the same and smaller than that of c2 in dv and tv regimes keywords three cylinders equilateral triangular configuration spacing ratio reynolds number flow regimes force coefficient 1 introduction flow around multiple cylinders has been investigated extensively due to its significance both in engineering applications and fundamental fluid mechanics in many engineering practice cylindrical structures are often in groups e g groups of chimneys chemical reaction towers tension leg offshore platforms and heat exchanger tube three cylinders arranged in an equilateral triangular configuration are widely applied in heat exchangers cooling systems for nuclear power plants offshore and ocean engineering bouris and bergeles 1999 ozgoren 2013 a deep understanding of the flow pattern vortex shedding and fluid force of two and three cylinders in either side by side or tandem configuration in flow has been achieved zdravkovich 1977 1987 igarashi 1981 williamson 1985 sumner et al 1999 sumner 2010 however the studies of complex interference among three cylinders in an equilateral triangle configuration in flow are rare if two cylinders are in side by side or tandem arrangement in a fluid flow depending on the distance between the two cylinders the flow pattern can be classified into three different flow regimes proximity interference wake interference and the combination of the proximity and wake interference zdravkovich 1977 1987 the three regimes for flow past two tandem cylinder classified by williamson 1996 are proximity regime at small gaps where the two cylinders behave as one single body reattachment regime at intermediate gaps where the shear layers from the upstream cylinder reattach to the surface of the downstream cylinder either permanently or intermittently and co shedding regime at large gaps where vortex shedding occurs from both cylinders the detailed review of the effects of the reynolds number and the spacing ratio on the wake flow structures behind two tandem cylinders can be found in the review article by sumner 2010 it has been well known that the jet flow through the gap between two side by side cylinders with a small gap between them biases towards one cylinder forming a deflected gap flow pattern if the direction of the deflected gap flow changes from one cylinder to another intermittently the gap flow is called flip flop gap flow williamson 1988 the flow patterns pressure distributions and velocity characteristics for an array of three cylinders in side by side and tandem configurations have also been investigated guillaume and larue 1999 zhang and zhou 2001 harichandan and roy 2010 flow past three cylinders in an equilateral triangle arrangement is more complicated than three cylinders in tandem sayers 1987 1990 carried out experimental studies on flow past three and four cylinders at various spacing ratios the spacing ratio is defined as l d where d and l are the diameter of the cylinders and the center to center distance between the cylinders respectively the results showed that the flow direction has a significant effect on the force coefficients of the cylinders lam and cheung 1988 investigated flow interference of three cylinders in an equilateral triangle arrangement at reynolds numbers of 2 1 103 and 3 5 103 the bistable flow characteristic is found to be strongly depended on the initial condition moreover if l d 4 65 and the flow approaching angle is between 8 and 27 the vortex shedding behind the upstream cylinder is suppressed by the downstream cylinder tatsuno et al 1998 found that the effect of flow interference among three cylinders on the pressure on cylinder surfaces is strong when the spacing ratio is small gu and sun 2001 performed an experimental study of flow past three cylinders at re 1 4 104 it was found that the direction angle of the flow has strong effects on the pressure distribution on the cylinders and four different flow regions are identified with variation of spacing ratios pouryoussefi et al 2011 experimentally investigated the mean force coefficients and strouhal numbers for three cylinders in an equilateral triangle arrangement at 1 26 104 and 6 08 104 numerical studies of flow past three cylinders in an equilateral triangle arrangement were mainly conducted using two dimensional 2 d numerical models bao et al 2010 conducted a 2 d numerical investigation on the effects of spacing ratios and incident angles on flow characteristics behind three cylinders in an equilateral triangular configuration at a low reynolds number re 100 through numerical simulations at re 100 and 200 and various of spacing ratios and incident angles zheng et al 2016 identified three distinct flow patterns wu et al 2006 investigated the effect of lateral channel walls on flow and heat transfer of three circular cylinders in a horizontal channel the existing experimental studies of flow past three cylinders are mainly focused on the fluid force pressure distribution and vortex shedding frequency and very limited flow visualization in addition the 2 d numerical models are not capable to model the intrinsic three dimensional 3 d flow characteristics around the cylinders at large reynolds numbers in the turbulent flow regime moreover little attention has been paid on the combined effect of spacing ratio and reynolds number on the three dimensional flow characteristics behind three cylinders in an equilateral triangle configuration the principal aim of the present work is to gain a better understanding of the three dimensional flow characteristics behind three cylinders in an equilateral triangle configuration as shown in fig 1 through 3 d numerical simulations two of the three cylinders c1 and c3 are in a tandem arrangement and the third cylinder c3 is on their side it is expected that the flow has the combined characteristics of flow past two side by side cylinders and flow past two tandem cylinders the classification of the wake flow pattern and the correlation between the wake flow pattern and the forces on the cylinders are discussed in detail 2 numerical method 2 1 governing equations a cartesian coordinate system is defined with its origin located at the center of the three cylinder system and its x axis in the incoming flow direction as shown in fig 1 direct numerical simulation dns is adopted to simulate flow past three cylinders at a low reynolds number of re 200 and the 3 d reynolds averaged navier stokes rans model is used to simulate the flow at large reynolds numbers of re 1500 and 3900 dns is used for re 200 the critical reynolds number for wake flow transitioning from 2 d to 3 d zhao et al 2013 because obtaining accurate numerical results using dns for such low reynolds number is achievable the shear stress transport sst k ω turbulent model is used to simulate the turbulence the sst k ω model is found to be suitable to simulate complex boundary layer flows with adverse pressure gradient and separation menter et al 2003 tomboulides et al 2018 the 3 d rans equations for conservation of mass and momentum can be written as 1 u i x i 0 2 u i t x j u i u j 1 ρ p x i 1 ρ x j μ u i x j ρ u i u j where x 1 x x 2 y and x 3 z u i is the velocity component in the x i direction g i is the gravitational acceleration component in the x i direction ρ μ t and p are the density of the fluid fluid dynamic viscosity time and pressure respectively u i u j is the reynolds stress tensor the rans equations are solved by the open source field operation and manipulation openfoam the finite volume method fvm is applied and pressure velocity coupling is based on the pressure implicit with splitting of operators piso method the solver pimplefoam is adopted in the present study the cell limited gauss linear scheme is applied to discretize the convection terms while the gauss linear scheme is used to discretize the laplacian and pressure terms the cranknicolson implicit scheme is used for the temporal discretization 2 2 boundary conditions the computational domain shown in fig 1 is 30d long in the streamwise direction and 30d in the cross flow direction y direction the cylinder system is located at the center in the cross flow direction of the domain and 10d downstream the inlet boundary the computational domain size in the axial direction of the cylinders is about 10d for re 200 and 3 14d for re 1500 and 3900 which has been proved to be sufficiently long to simulate the three dimensionality of the wake flow patel 2010 the wake flow for a single isolated cylinder is in mode a with a spanwise wavelength of between 3d and 4d for re 200 and mode b with a spanwise wavelength of about 1d for re 250 zhang et al 1995 barkley and henderson 1996 the length of the cylinders for re 200 is longer to ensure the variation of the flow in the spanwise direction can be well captured it has been found in literature that as l d 4 0 the flow interferences among the three cylinders are very weak and each upstream cylinder behaves as an isolated cylinder for both laminar and turbulent flow regimes lam and cheung 1988 gu and sun 2001 bao et al 2010 to identify all possible flow patterns seven spacing ratios of l d 1 25 1 5 2 0 2 5 3 0 3 5 and 4 0 are used the chosen reynolds numbers cover both laminar and turbulent flow regimes in addition they have been used in other studies making it possible to straightforwardly compare the present results with the published results the diameter of each cylinder is 0 01 m and the kinematic fluid viscosity is 10 6 m2 s the inlet flow velocity in the computational domain are set to be 0 02 m s 0 15 m s and 0 39 m s for reynolds number of 200 1500 and 3900 respectively at the inlet boundary the neumann condition is used for pressure the turbulent kinetic energy k and specific dissipation ω at the inlet boundary are given as k 1 5 u i 2 and ω k 0 5 c μ 0 25 l respectively where the turbulence intensity i is 2 the model constant is c μ 0 09 and the turbulence length l is 0 07d menter et al 2003 patel 2010 tian et al 2013 at the outlet boundary the pressure is set to zero and the normal gradients of the velocity k and ω are zero on the two lateral boundaries parallel to the flow direction and two end boundaries perpendicular to the cylinder axes free slip boundary conditions are applied for velocity and the gradients of k and ω normal to the boundary are zero on the cylinder surfaces no slip boundary is adopted k is set at zero and ω is calculated as ω 60 ν 0 075 δ y 2 where δ y is the distance between the first layer of computational nodes and the cylinder surface menter 1994 2 3 validation and mesh dependency study to validate the numerical model numerical simulations of flow past a single cylinder at reynolds numbers of 100 and 3900 are performed three meshes referred to as coarse medium and fine meshes respectively with different densities are employed to accurately simulate the boundary layer flow the non dimensional distance of the first nodal point to the wall defined as y μ f δ y ν is less than 1 where μ f is the friction velocity and δy is the distance between a node and wall comparisons between the mean drag coefficient c d the standard deviation of lift coefficient c l and the strouhal number s t calculated from different meshes with reported numerical results are presented in tables 1 and 2 the meshes for re 3900 are much denser than those for re 200 to ensure that the results are converged at such a high reynolds number the drag coefficient c d the lift coefficient c l and the strouhal number s t are defined as 3 c d f x ρ u 2 d h 2 4 c l f y ρ u 2 d h 2 5 s t f s d u where f x and f y is the fluid force in the x and y direction respectively h is the length of the cylinder and f s is the frequency of the oscillatory lift force at re 100 the results of c d and s t from the medium mesh are different from those from fine mesh by less than 0 3 and 0 2 respectively similarly at re 3900 the differences in c d c l and s t between the results from medium and fine meshes are smaller than 1 5 and 0 5 respectively the mean drag coefficient from the medium mesh is 1 368 at re 100 and 1 229 at re 3900 which falls in the range of published data of 1 36 1 37 for re 100 and 1 1 to 1 27 for re 3900 respectively the present strouhal numbers also agree with other results in tables 1 and 2 the mesh dependency study shows that the medium mesh density is dense enough to obtain the reliable results for the simulations of flow past three cylinders in an equilateral triangle arrangement as is used in the rest of the simulations 3 numerical results 3 1 wake flow pattern the second negative eigenvalue λ 2 of the tensor s 2 ω 2 is used to visualize the three dimensional vortex flow pattern where s and ω represent the symmetric and antisymmetric parts of the velocity gradient tensor respectively jeong and hussain 1995 figs 2 4 show the iso surfaces of non dimensional streamwise vorticity ω x and λ 2 for re 200 1500 and 3900 respectively the vorticity and eigenvalue are nondimensionalized by ω x ω x u d and λ 2 λ 2 u d 2 respectively where the prime stands for the dimensional values in the following discussion all the vorticities and eigenvalues are non dimensional re 200 is the critical reynolds number for the flow past a single isolated cylinder transitioning from 2 d to 3 d zhao et al 2013 when the reynolds number is slightly greater than the critical reynolds number flow in the wake of a single cylinder becomes 3 d in mode a and the wavelength of the 3 d feature is about 3 4 diameters zhang et al 1995 barkley and henderson 1996 numerical simulations at re 200 are conducted for a cylinder length of h d 10 and it is found that the wake flow is 2 d if l d 1 25 fig 2 a and 3 d if l d 1 5 fig 2 b g however the three dimensionality is very weak at l d 2 0 the critical spacing ratio where the flow regime changes as re 1500 the wake flow becomes fully 3 d the flow in the wake of the three cylinders for re 1500 and l d 1 25 3 5 and 4 0 are very similar to the mode b wake flow reported by williamson 1988 and carmo et al 2010a b which is characterized by strong streamwise vortex pairs spaced by a distance of about one diameter the mode b flow pattern for a single cylinder starts at re 250 and persists until higher reynolds typically up to about re 1000 williamson 1996 the vortex pairs in mode b flow pattern is found to exist at re 1500 but only as l d 1 25 3 5 and 4 0 where well structured streamwise vortex pairs can be identified in fig 3 as l d 1 5 to 3 0 streamwise vortex pairs does not exist because strong interaction between cylinders it is interesting to see that at re 3900 well structured mode b vortex pairs can still be clearly seen but only when the gap ratio is small l d 1 25 by observing figs 2 4 it can be seen that three cylinders with a small gap ratio of l d 1 25 delay the transition of the wake flow from two dimensional to three dimensional and from mode b to full turbulent flow the contours of the spanwise vorticity on the middle section of the cylinder length for different reynolds numbers are presented in figs 5 9 the spanwise vorticity nondimensionalized by ω z ω z u d where the prime stands for the dimensional values for the convenience of discussion the gaps between c1 and c2 between c2 and c3 and between c1 and c3 are referred to as g12 g23 and g13 respectively generally the flow through g12 possesses characteristics of flow past two side by side cylinders and that through g13 has characteristics of flow past two tandem cylinders fig 5 shows the contours of the spanwise vorticity for re 200 and l d 1 25 and 1 5 globally the three cylinders behave as a single body and there is only one vortex street behind them the flow through g23 is too weak to have influence on the vortex shedding at l d 1 25 a similar flow pattern was observed by gu and sun 2001 and bao et al 2010 who reported that the gap flow through g23 is always deflected upwards due to the dominate proximity effect at l d 1 25 at l d 1 5 the shear layers generated through g23 extended further downstream compared with those at l d 1 25 but they do not form strong vortices because the shear layers from g23 for l d 1 5 are stronger than those for l d 1 25 and they bias upwards only the vortices that are shed from the top of c2 are weakened significantly fig 6 shows the contours of the spanwise vorticity on the x y plane for re 200 and l d 2 0 to 3 5 the bistable flow pattern occurs at small spacing ratios ranging from 1 25 to 2 0 this bistable flow regime is in consistent with that reported by lam and cheung 1998 which is 1 27 l d 2 29 as l d 2 0 and 2 5 vortex shedding occurs from c2 and c3 forming a dual vortex shedding dv pattern vortex shedding does not occur from c1 and the flow between c1 and c3 is very similar to the pattern e flow reported by igarashi 1981 for two tandem cylinders in flow the pattern e for two tandem cylinders is characterized by one shear layer from the upstream cylinder roll up intermittently in front of the downstream cylinder as shown in the sketch of fig 6 e in fig 6 the shear layer from the top of the upstream c1 always roll up and form a vortex as l d 2 0 and 2 5 since the shear layer from the top of c1 does not contribute the vortex shedding from c1 the vortices from top of c3 is weak the vortices from the bottom of c3 are very strong because the shear layer from bottom of c1 reattaches onto c3 as l d 3 0 and 3 5 vortex shedding from all the cylinders occurs and the flow pattern is defined as triple vortex shedding tv pattern combination of vortices in the wake of the cylinders occurs as l d 3 0 similar to that reported by bao et al 2010 as the spacing ratio is large enough the downstream c3 fails to suppress the vortex shedding from c1 and the vortex shedding from downstream cylinder 3 is strongly disturbed by the impingement of vortices shed from upstream c1 fig 7 shows contours of the spanwise vorticity on the x y plane for re 1500 and l d 1 25 similar to that for re 200 the flow in fig 7 is in proximity regime however the behavior of the flow through g23 for re 1500 and l d 1 25 is distinctly different from that for re 200 and l d 1 25 as re 1500 and l d 1 25 the direction of the flow through g23 is found to flip up and down frequently the changeover phenomenon of the deflected directions in g23 is also observed by tatsuno et al 1998 however the up and down flipping is found to be random instead of periodic for example the flow through g23 biases downwards at t t 4 after one period it biases downwards at t 5t 4 the flow pattern in fig 7 is named as proximity regime with flip flop gap flow if the jet flow through g23 is deflected upwards or downwards it is governed by the vortex generated from the bottom shear layer of c2 which is found to be trapped in an area immediately behind c2 most of the time and occasionally released for example at t 3t 4 in fig 7 at t t 4 a positive vortex has fully grown behind c2 and the flow through g23 biases downwards when this positive vortex dissipates at t 3t 4 the gap flow through g23 biases upwards after that another positive vortex will grow and squeeze the direction of the gap flow through g23 downwards again the flow for l d 1 5 and re 1500 is also in the proximity regime with flip flop gap flow fig 8 shows contours of spanwise vorticity on the x y plane for re 1500 and l d 2 0 while vortex shedding from c2 and c3 can be clearly seen in fig 8 it is interesting to see that only vortices from bottom of c1 are shed once a vortex is shed from the bottom side of c1 it sweeps c3 s bottom surface and is convected downstream as seen in fig 8 b and c because of the additional vortex shedding from the bottom side of c1 three positive vortices and two negative vortices can be seen right behind the cylinders in fig 8 c and d l d 2 0 for re 1500 where two and half pairs of vortices are shed from the three cylinders in one vortex shedding period is essentially the l d for the flow transitioning from dual vortex shedding to triple vortex shedding regimes fig 9 shows contours of spanwise vorticity on the x y plane for re 1500 and l d 2 5 to 4 0 the critical spacing ratio for flow changing from dual to triple vortex regimes for re 1500 is smaller than that for re 200 it is between l d 2 5 and 3 0 for re 200 and about l d 2 0 for re 1500 in the dual vortex shedding flow pattern the vortex wake is very different from that of a single cylinder because of the interaction between vortices although two pairs of vortices are shed from the cylinder in each vortex shedding period the wake vortices are not aligned in two rows due to the presence of c2 the wake flow pattern behind c1 is asymmetrical to the centerline which is consistent with the result obtained from lam and cheung 1988 in the triple vortex shedding regime l d 2 5 3 0 3 5 and 4 0 for re 1500 the vortex shedding from c2 is similar to that of a single cylinder and that from c1 and c3 is similar to the vortex shedding from two tandem cylinders the vortex shedding patterns identified for re 200 and 1500 are also observed for re 3900 the flow patterns for re 3900 are not shown to avoid repeating however the boundary l d between dual and triple vortex shedding regimes for re 3900 is between 1 5 and 2 0 which is smaller than that for re 1500 and the boundary l d between the proximity flow regime and dual vortex shedding regime is between 1 25 and 1 5 which is also smaller than that for re 1500 table 3 lists the identified flow regimes for all the simulated cases the flow around c1 and c3 in the dv and tv regimes is similar to the regimes found for flow past two tandem cylinders different researchers classify the wake flow of two tandem cylinders in different ways the regimes of sg symmetric in the gap and ag alternating in the gap defined by carmo et al 2010a b belong to a single wake and wg wake in the gap belongs to the dual wake the proximity regime reattachment regime and co shedding regime defined by papaionannou et al 2006 is equivalent to the sg ag and wg respectively the boundary l d between ag and wg for re 500 and 1000 was found to be between 3 5 and 4 0 by papaioannou et al 2006 the flows past c1 and c3 in the dual vortex shedding and triple vortex shedding regimes are the same as ag and wg however the critical between ag and wg in the present three cylinder case is found to be much smaller than that in previous studies of two tandem cylinders this is because the existence of c2 breaking the symmetry of the system and c2 acts as a disturbance that triggers wg at smaller l d the vortex shedding in the p d and p f regimes has some similarity to the deflected flow regime and flip flop regime for flow past two side by side cylinders respectively but not exactly the same in the deflected flow regime in the two side by side cylinder case the flow can be deflected towards one side for very long time but it can switch from one side to another side in the p d regime of the three cylinder case the flow is always deflected towards c2 in the flip flop regime of the two side by side cylinder case the frequency of the changing direction of the deflected flow is still much higher than that of the vortex shedding flow however in the three cylinder case the flow through g23 changes its direction up and down with a period the same as the vortex shedding period though the change of direction does not synchronize with the vortex shedding significant reynolds effects are clearly visible from the instantaneous iso surfaces of streamwise vorticity and spanwise vorticity contours shown in figs 2 9 with increasing reynolds numbers the three dimensionality becomes stronger at low reynolds number re 200 the vortex tube are almost aligned parallel to the cylinders and only small scales of streamwise vortices are observed the inclination of the spanwise vortices is not observed due to the synchronized phase of the vortex shedding along the cylinder span as re increases to 1500 and 3900 strong rib shaped streamwise vortices are generated and shed in the wake of the three cylinders due to the strong interference of the streamwise vortices in the wake of the three cylinders the spanwise vortices become wavy in the wake of the cylinders the inclination of the spanwise vortices occurs due to the phase differences of vortex shedding along the cylinder span the critical spacing ratios for different flow regimes for flow around three cylinders are also sensitive to reynolds number at a given spacing ratio l d 2 0 the flow pattern is dv for re 200 dv tv for re 1500 and tv for re 3900 the sensitivity of the flow patterns to the reynolds number also exists for flow past two cylinders in tandem and staggered configurations igarashi 1981 1984 sumner et al 2000 3 2 stagnation point and separation point the stagnation point of a cylinder is a point on the upstream side of the cylinder surface where the shear stress is zero and the pressure is at its maximum williamson 1988 fig 10 shows the definition of the stagnation point and separation points on a cylinder the location of the stagnation point is quantified using the angle of the stagnation which is zero at the most upstream point of the cylinder surface and measured in the clockwise direction the stagnation point oscillates along the cylinder surface because of the vortex shedding flow fig 11 shows the time histories of the angle stagnation point for re 200 and 1500 while the stagnation point of a single cylinder is nearly stationary stagnation points of the three cylinder oscillates along the cylinder surface with an amplitude between 1 and 2 as l d 1 25 the oscillation amplitude of the angle of stagnation point reduces significantly as l d 1 5 and it increases again as l d 2 5 for re 200 and l d 2 0 for re 1500 in these two cases the flow between c1 and c3 is in the dynamic ag mode which leads to strong oscillation of the angle of stagnation point when vortex shedding from c1 occurs c3 is affected by the vortices that are shed from c1 significantly and no stagnation point can be identified on c3 fig 12 shows the variation of time averaged angle of stagnation point with the spacing ratio for three cylinders at different reynolds numbers the angle of stagnation point of c3 is the largest which is slightly greater than 30 as l d 1 25 and aligns well with g12 with increasing l d the angle of stagnation point of c3 increases similar to what reported by pouryoussefi 2011 the jet flow causes to diminish the vortex shedding from downstream cylinder and leads to the shifting of separation points the angle of stagnation point of c3 does not exist for large l d because the vortex shedding from c1 makes c3 attacked by vortices and sometime surrounded by vortices the angle of stagnation points of c1 and c2 are in opposite signs and their magnitudes are close to each other at large l d it is interesting that the angle of stagnation angle of the most upstream c1 is greater than c2 at the smallest l d 1 25 the angles of stagnation point for c1 and c2 are still slightly deviated from zero at l d 4 0 indicating there is still interaction among these two cylinders because vortex shedding flow of c3 is affected by both c1 and c2 the flow separation on its surface is found to be very different from that of a single cylinder fig 13 shows the time histories of the separation angle on the cylinder surfaces at small spacing ratios of l d 1 25 and 1 5 as shown in fig 10 the separation angle is defined as the angle measured along the cylinder surface from the front stagnation point to the separation point θ st and θ sb represent the separation angles on the top and bottom sides of the cylinder respectively the calculated mean separation angles of the single cylinder for re 200 1500 and 3900 are θ s 111 9 97 9 89 9 respectively which are in good agreement with the previous research results williamson 1996 harichandan and roy 2012 zhao et al 2013 joshi and jaiman 2017 it can be seen that both θ st and θ sb of c3 oscillate with the highest amplitude compared with those of the other two cylinders mainly because it is affected the most by the dynamics gap flow through g23 and the strong vortices generated by the shear layer generated by c1 and strengthened when it passes c3 3 3 time averaged flow field the time averaged vorticity contours streamlines and reynolds stresses behind a single cylinder are compared with the experimental results obtained from ozgoren 2013 in fig 14 solid lines represent positive values and dashed lines represent negative values in the contours in the case of an isolated cylinder the contours of vorticity contours streamline topologies root mean square streamwise velocity u r m s u 0 and reynolds stress contours u u u 0 2 v v u 0 2 u v u 0 2 are concentrated in the near wake and symmetrical about the wake centerline the numerical results are in good agreement with the experimental results in ozgoren 2013 figs 15 and 16 present the time averaged vorticity contours streamlines and reynolds stresses behind the three cylinders at different spacing ratios l d 1 5 2 0 and 3 0 for re 3900 it can be seen that due to the complex interferences among the three cylinders the time averaged flow features are observed to be more complicated than those of a single cylinder at l d 1 5 the time averaged streamline patterns illustrate that the reverse flows are obviously observed in the near wake and also in the gap between c1 and c3 however due to the gap flow deflection the two recirculation zones in the wakes of c2 and c3 are aligned slightly towards top right the recirculation zone in the wake of c1 is very small and biased because the strong vortices in the wake of c2 and c3 as discussed above the recirculation zone between c2 and c3 are very large as l d is increased to 2 0 the recirculation zone in the wake of c1 increases and that in the wake of c2 and c3 decreases mainly because the reattachment of the shear layers on the downstream c2 similar what was reported by ozgoren 2013 the reynolds shear stress u v u 0 2 for the equilateral triangle arranged three cylinders are greater than that of the single cylinder as l d 1 5 strong reynolds stress is found behind g23 as the result of the flipping gap flow as l d 2 0 the distribution of the reynolds stress behind c2 becomes symmetric and that behind c3 is slightly asymmetric because of the dv flow pattern however the reynolds stress between c1 and c3 is still small because there is no vortex shedding from c1 when l d 3 0 the flow is in the tv flow pattern and the reynolds stress distribution in the wake of the three cylinder are more or less symmetric 3 4 pressure distribution and force coefficient figs 17 and 18 show the time histories of the drag and lift coefficients for reynolds numbers re 200 and 3900 respectively the drag and lift coefficients of all the cylinders for re 200 are more periodic than those at re 3900 because the three dimensionality is weak the amplitude of the lift coefficient on the downstream c3 is greater than those of the other two cylinders for both re 200 and 3900 mainly because c3 is strongly affected by the gap flow through g23 at small spacing ratios and by the vortex shedding from c1 when the spacing ratio is large at spacing ratios l d 1 25 and 2 0 and re 200 the oscillations of the lift coefficients of all the cylinders are very weak because no vortices are shed from the upstream c1 as l d is increased to 3 0 the amplitudes of the lift coefficients of the three cylinders become regular and periodic unlike those at re 200 the drag and lift coefficients for re 3900 of the three cylinders are very irregular due to strong three dimensionality of the wake flow behind the three cylinders the drag coefficient of c3 is the smallest because it is within the wake zone of c1 and its amplitude increases significantly when vortex shedding from c1 occurs in the tv flow pattern fig 19 shows the variation of the mean pressure coefficient c p on each cylinder with the spacing ratio where the overbar means averaged value and c p is defined as c p p p 0 5 ρ u 2 where p is the pressure of the incoming flow figs 20 22 show the statistic values of the drag and lift coefficient on the three cylinders for re 200 1500 and 3900 respectively in the following discussion c dn and c ln are used to stands for the drag and lift coefficient of the n th cylinder respectively as l d 1 25 the blockage effect from the narrow gap g12 increases the pressure between 0 θ 120 resulting in a significant increase in the magnitude of the negative c l 1 and a slight increase in c d 1 with the widening of g12 the magnitude of c l 1 decreases c d 1 is smaller than c d of a single cylinder as l d 2 for re 200 and l d 1 5 for re 1500 and 3900 because the pressure at the back of c1 is increased c d 2 varies with θ with an opposite trend of c d 1 it is smaller than the corresponding single cylinder value at small l d and greater at large l d c d 1 is reduced at large l d because the base pressure of c1 is increased compared with that of a single cylinder as the result of weakened vortex shedding in g13 compared with that of a single cylinder the stronger blockage of the three cylinder system than a single cylinder results in a decrease in the base pressure of c2 and an increase of c d 2 sayers 1987 reported that the increasing of drag coefficient c d 2 at large spacing ratios is due to the proximity interference between c2 and c3 the pressure coefficient on c3 is significantly different from that on a single cylinder tatsuno et al 1998 mentioned that the intense gap flow among the three cylinders causes a reduction in pressure in the gap leading to the decreasing of drag coefficient the small high pressure region on c3 near the stagnation point about 30 is due to the attack of the high speed jet flow through g12 compared with that of a single cylinder the high pressure region in front of c3 is much smaller resulting a significant reduction of the mean drag coefficient of c3 as shown in figs 14 to 15 the shift of the stagnation point towards the top surface of c3 leads to a negative mean lift coefficient of c3 the pressure at the stagnation point and the lift coefficient at l d 1 5 is greater than that at l d 1 25 because the larger gap at l d 1 5 makes larger jet flow rate through c12 that attacks the front surface of c3 as l d 1 5 the pressure at the stagnation point of c3 reduces with increasing l d so does the magnitude of the mean lift coefficient because the jet velocity in g12 is decreased it is interesting to see that the strong oscillation of the angle of separation of c3 at small l d 1 25 and 1 5 does not produce strong oscillation of the lift coefficient when l d is small the jet flow velocity and flow rate through g23 are too small to have big effects on the forces although the shear layer from g23 separates from and reattach to the back of c3 alternatively making a big oscillation amplitude of angle of separation the weakness of the shear layer does not contribute much to the oscillation of the lift coefficient the standard deviation sd of the lift coefficient of two side by side cylinders in flow with flip flop gap flow at small gap ratios was also found to be smaller compared with that of a single cylinder thapa et al 2015 from fig 20 it can be seen that the strong single vortex street in the proximity regime at small l d does not increases sd of the lift coefficients of all the cylinders mainly because there is not an integral vortex street in each individual cylinder based on fig 20 b and fig 21 b the mean lift coefficient of the whole cylinder system i e the sum of the mean lift coefficients of all the cylinders direct downwards especially when l d is small because the shear layer from the bottoms of c1 and c3 generate stronger vortices than the shear layer from the top of only c2 the sum of the mean drag coefficients of the three cylinders is more than three times the drag coefficient of a single cylinder because c d 2 is decreased dramatically based on fig 20 c and d and fig 21 c and d we can conclude that put three cylinder together in an equilateral triangle arrangement at l d between 2 5 and 4 0 will increase the sd lift coefficient of the whole system the numerical results by bao et al 2010 for re 100 are also included in fig 20 for comparison the present variation trend of the force coefficients with l d is in agreement with that in bao et al 2010 however the boundary l d between different flow patterns and the values of the force coefficients are affected by the reynolds number the rms lift coefficient for re 200 increases significantly as l d increases from 2 5 to 3 0 where the flow changes from dv to tv flow pattern the significant increase of the lift coefficient for re 100 occurs at a greater value of l d in bao et al 2010 in addition the maximum values of c d and c l for re 100 are lower than those for re 200 3 5 strouhal number the vortex shedding frequency is determined through the fast fourier transform fft analysis of the lift coefficient at the mid section of the cylinders fig 22 shows the power spectra of the lift coefficient of each cylinder at different spacing ratios for re 3900 each spectrum in fig 22 has at least one distinct peak frequency the nondimenional peak frequency is called strouhal number which is calculated by s t f s d u fig 23 shows the variations of the strouhal number with l d for re 200 1500 and 3900 in the proximity regime with l d 1 25 the peak frequencies of three cylinders are the same because the oscillation of all the lift coefficients is caused by only vortex street when l d 1 5 the spectra of c1 and c2 are broad banded mainly because the strong up and down flip flop jet flow through g23 does not synchronize with the vortex shedding as discussed in section 3 1 however the local peak with s t 0 122 can still been seen at re 3900 which is the result of the vortex shedding the strouhal numbers in the proximity regime are nearly half that of a single cylinder because the dimension of the whole three cylinder system is nearly twice the cylinder diameter which leads to decrease in the vortex shedding frequency of the single vortex street when the flow is in the dv shedding and tv flow regimes the strouhal numbers of c1 and c3 are the same because of the synchronization of the vortex shedding from these two cylinders sumner et al 2005 carmo and meneghini 2006 bao et al 2010 pouryoussefi et al 2011 the strouhal number of c2 is different from those of c1 and c3 because c2 has little interaction with the other two cylinders interestingly at l d 2 0 some cylinders have dual frequencies because the vortex street in the wake of c2 and the vortex street in the wake of c1 and c3 interact with each other as re 200 the s t of c1 and c3 are still smaller than that of a single cylinder and the s t of c2 is greater when the reynolds number increases to 1500 and 3900 the s t of c1 and c3 approach st of a single cylinder but the s t of c2 is still higher 4 conclusions three dimensional numerical simulations on flow past three circular cylinders in an equilateral triangular arrangement are performed using the openfoam open source code the combined effects of spacing ratio and reynolds number on the three dimensional flow features and force coefficients are investigated the findings are summarized as follows 1 depending on the spacing ratios and reynolds numbers five different flow regimes are identified and they are p d proximity with deflected flow p f proximity with flip flop flow dv dual vortex shedding dv tv transition between dual vortex shedding and triple vortex shedding tv triple vortex shedding the critical spacing ratios for the transition among different flow regimes decrease with increasing reynolds number three dimensionality of primary vortex shedding increases with increasing spacing ratio or reynolds number mode b flow pattern with streamwise vortex pairs is found at l d 1 25 3 5 and 4 0 for re 1500 and at l d 1 25 for 3900 2 the downstream c3 has the largest angle of stagnation point with increasing l d the angle of stagnation point of c3 increases the angles of stagnation point of c1 and c2 are in opposite signs and their magnitudes are close to each other at large l d the separation angle of c3 oscillates with the highest amplitude compared with those of the other two cylinders due to the dynamics gap flow through g23 and the strong vortices generated by c1 and strengthened when it passes c3 3 the pressure coefficient experienced by the downstream cylinder c3 is significantly different from that on a single cylinder leading to a smaller mean drag coefficient on c3 than those on c1 and c2 irrespective of the spacing ratios and reynolds numbers both the mean lift coefficients experienced by c1 and c3 are almost negative but positive for c2 at all the examined spacing ratios the strong single vortex street in the proximity regime at small l d does not increases sd of the lift coefficient for all the cylinders but increases the sd of lift coefficients at large spacing ratios 2 5 l d 4 0 4 the strouhal numbers corresponding to vortex shedding experienced by c1 and c3 are mostly the same and increase with spacing ratio then approach to that of a single cylinder at the triple vortex shedding regime the strouhal number of c2 is much larger than those of c1 and c3 at all the examined spacing ratios and maintained at a value of 0 23 acknowledgements this research was supported by the joint fund of zhejiang provincial natural science foundation grant no lhz19e090004 national key r d program of china 2018yfe0109500 2018yfd0900901 
22524,flow past three circular cylinders in an equilateral triangular configuration is simulated for reynolds numbers 200 re 3900 and spacing ratios 1 25 l d 4 0 where l is the center to center distance between each two cylinders and d is the diameter of the cylinder five different flow regimes are identified proximity with deflected flow p d proximity with flip flop flow p f dual vortex shedding dv transition between dual vortex shedding and triple vortex shedding dv tv triple vortex shedding tv the boundary spacing ratios between the five regimes are affected by the reynolds number with the increase of the spacing ratio or the reynolds number the three dimensionality of the wake flow becomes stronger mode b flow pattern with streamwise vortices is found at l d 1 25 3 5 and 4 0 for re 1500 and l d 1 25 for 3900 the pressure coefficient on the surface of the downstream cylinder c3 is significantly different from that on a single cylinder leading to significant reduction of the mean drag coefficient on c3 for all the studied spacing ratios and reynolds numbers the strouhal numbers of c1 and c3 are the same and smaller than that of c2 in dv and tv regimes keywords three cylinders equilateral triangular configuration spacing ratio reynolds number flow regimes force coefficient 1 introduction flow around multiple cylinders has been investigated extensively due to its significance both in engineering applications and fundamental fluid mechanics in many engineering practice cylindrical structures are often in groups e g groups of chimneys chemical reaction towers tension leg offshore platforms and heat exchanger tube three cylinders arranged in an equilateral triangular configuration are widely applied in heat exchangers cooling systems for nuclear power plants offshore and ocean engineering bouris and bergeles 1999 ozgoren 2013 a deep understanding of the flow pattern vortex shedding and fluid force of two and three cylinders in either side by side or tandem configuration in flow has been achieved zdravkovich 1977 1987 igarashi 1981 williamson 1985 sumner et al 1999 sumner 2010 however the studies of complex interference among three cylinders in an equilateral triangle configuration in flow are rare if two cylinders are in side by side or tandem arrangement in a fluid flow depending on the distance between the two cylinders the flow pattern can be classified into three different flow regimes proximity interference wake interference and the combination of the proximity and wake interference zdravkovich 1977 1987 the three regimes for flow past two tandem cylinder classified by williamson 1996 are proximity regime at small gaps where the two cylinders behave as one single body reattachment regime at intermediate gaps where the shear layers from the upstream cylinder reattach to the surface of the downstream cylinder either permanently or intermittently and co shedding regime at large gaps where vortex shedding occurs from both cylinders the detailed review of the effects of the reynolds number and the spacing ratio on the wake flow structures behind two tandem cylinders can be found in the review article by sumner 2010 it has been well known that the jet flow through the gap between two side by side cylinders with a small gap between them biases towards one cylinder forming a deflected gap flow pattern if the direction of the deflected gap flow changes from one cylinder to another intermittently the gap flow is called flip flop gap flow williamson 1988 the flow patterns pressure distributions and velocity characteristics for an array of three cylinders in side by side and tandem configurations have also been investigated guillaume and larue 1999 zhang and zhou 2001 harichandan and roy 2010 flow past three cylinders in an equilateral triangle arrangement is more complicated than three cylinders in tandem sayers 1987 1990 carried out experimental studies on flow past three and four cylinders at various spacing ratios the spacing ratio is defined as l d where d and l are the diameter of the cylinders and the center to center distance between the cylinders respectively the results showed that the flow direction has a significant effect on the force coefficients of the cylinders lam and cheung 1988 investigated flow interference of three cylinders in an equilateral triangle arrangement at reynolds numbers of 2 1 103 and 3 5 103 the bistable flow characteristic is found to be strongly depended on the initial condition moreover if l d 4 65 and the flow approaching angle is between 8 and 27 the vortex shedding behind the upstream cylinder is suppressed by the downstream cylinder tatsuno et al 1998 found that the effect of flow interference among three cylinders on the pressure on cylinder surfaces is strong when the spacing ratio is small gu and sun 2001 performed an experimental study of flow past three cylinders at re 1 4 104 it was found that the direction angle of the flow has strong effects on the pressure distribution on the cylinders and four different flow regions are identified with variation of spacing ratios pouryoussefi et al 2011 experimentally investigated the mean force coefficients and strouhal numbers for three cylinders in an equilateral triangle arrangement at 1 26 104 and 6 08 104 numerical studies of flow past three cylinders in an equilateral triangle arrangement were mainly conducted using two dimensional 2 d numerical models bao et al 2010 conducted a 2 d numerical investigation on the effects of spacing ratios and incident angles on flow characteristics behind three cylinders in an equilateral triangular configuration at a low reynolds number re 100 through numerical simulations at re 100 and 200 and various of spacing ratios and incident angles zheng et al 2016 identified three distinct flow patterns wu et al 2006 investigated the effect of lateral channel walls on flow and heat transfer of three circular cylinders in a horizontal channel the existing experimental studies of flow past three cylinders are mainly focused on the fluid force pressure distribution and vortex shedding frequency and very limited flow visualization in addition the 2 d numerical models are not capable to model the intrinsic three dimensional 3 d flow characteristics around the cylinders at large reynolds numbers in the turbulent flow regime moreover little attention has been paid on the combined effect of spacing ratio and reynolds number on the three dimensional flow characteristics behind three cylinders in an equilateral triangle configuration the principal aim of the present work is to gain a better understanding of the three dimensional flow characteristics behind three cylinders in an equilateral triangle configuration as shown in fig 1 through 3 d numerical simulations two of the three cylinders c1 and c3 are in a tandem arrangement and the third cylinder c3 is on their side it is expected that the flow has the combined characteristics of flow past two side by side cylinders and flow past two tandem cylinders the classification of the wake flow pattern and the correlation between the wake flow pattern and the forces on the cylinders are discussed in detail 2 numerical method 2 1 governing equations a cartesian coordinate system is defined with its origin located at the center of the three cylinder system and its x axis in the incoming flow direction as shown in fig 1 direct numerical simulation dns is adopted to simulate flow past three cylinders at a low reynolds number of re 200 and the 3 d reynolds averaged navier stokes rans model is used to simulate the flow at large reynolds numbers of re 1500 and 3900 dns is used for re 200 the critical reynolds number for wake flow transitioning from 2 d to 3 d zhao et al 2013 because obtaining accurate numerical results using dns for such low reynolds number is achievable the shear stress transport sst k ω turbulent model is used to simulate the turbulence the sst k ω model is found to be suitable to simulate complex boundary layer flows with adverse pressure gradient and separation menter et al 2003 tomboulides et al 2018 the 3 d rans equations for conservation of mass and momentum can be written as 1 u i x i 0 2 u i t x j u i u j 1 ρ p x i 1 ρ x j μ u i x j ρ u i u j where x 1 x x 2 y and x 3 z u i is the velocity component in the x i direction g i is the gravitational acceleration component in the x i direction ρ μ t and p are the density of the fluid fluid dynamic viscosity time and pressure respectively u i u j is the reynolds stress tensor the rans equations are solved by the open source field operation and manipulation openfoam the finite volume method fvm is applied and pressure velocity coupling is based on the pressure implicit with splitting of operators piso method the solver pimplefoam is adopted in the present study the cell limited gauss linear scheme is applied to discretize the convection terms while the gauss linear scheme is used to discretize the laplacian and pressure terms the cranknicolson implicit scheme is used for the temporal discretization 2 2 boundary conditions the computational domain shown in fig 1 is 30d long in the streamwise direction and 30d in the cross flow direction y direction the cylinder system is located at the center in the cross flow direction of the domain and 10d downstream the inlet boundary the computational domain size in the axial direction of the cylinders is about 10d for re 200 and 3 14d for re 1500 and 3900 which has been proved to be sufficiently long to simulate the three dimensionality of the wake flow patel 2010 the wake flow for a single isolated cylinder is in mode a with a spanwise wavelength of between 3d and 4d for re 200 and mode b with a spanwise wavelength of about 1d for re 250 zhang et al 1995 barkley and henderson 1996 the length of the cylinders for re 200 is longer to ensure the variation of the flow in the spanwise direction can be well captured it has been found in literature that as l d 4 0 the flow interferences among the three cylinders are very weak and each upstream cylinder behaves as an isolated cylinder for both laminar and turbulent flow regimes lam and cheung 1988 gu and sun 2001 bao et al 2010 to identify all possible flow patterns seven spacing ratios of l d 1 25 1 5 2 0 2 5 3 0 3 5 and 4 0 are used the chosen reynolds numbers cover both laminar and turbulent flow regimes in addition they have been used in other studies making it possible to straightforwardly compare the present results with the published results the diameter of each cylinder is 0 01 m and the kinematic fluid viscosity is 10 6 m2 s the inlet flow velocity in the computational domain are set to be 0 02 m s 0 15 m s and 0 39 m s for reynolds number of 200 1500 and 3900 respectively at the inlet boundary the neumann condition is used for pressure the turbulent kinetic energy k and specific dissipation ω at the inlet boundary are given as k 1 5 u i 2 and ω k 0 5 c μ 0 25 l respectively where the turbulence intensity i is 2 the model constant is c μ 0 09 and the turbulence length l is 0 07d menter et al 2003 patel 2010 tian et al 2013 at the outlet boundary the pressure is set to zero and the normal gradients of the velocity k and ω are zero on the two lateral boundaries parallel to the flow direction and two end boundaries perpendicular to the cylinder axes free slip boundary conditions are applied for velocity and the gradients of k and ω normal to the boundary are zero on the cylinder surfaces no slip boundary is adopted k is set at zero and ω is calculated as ω 60 ν 0 075 δ y 2 where δ y is the distance between the first layer of computational nodes and the cylinder surface menter 1994 2 3 validation and mesh dependency study to validate the numerical model numerical simulations of flow past a single cylinder at reynolds numbers of 100 and 3900 are performed three meshes referred to as coarse medium and fine meshes respectively with different densities are employed to accurately simulate the boundary layer flow the non dimensional distance of the first nodal point to the wall defined as y μ f δ y ν is less than 1 where μ f is the friction velocity and δy is the distance between a node and wall comparisons between the mean drag coefficient c d the standard deviation of lift coefficient c l and the strouhal number s t calculated from different meshes with reported numerical results are presented in tables 1 and 2 the meshes for re 3900 are much denser than those for re 200 to ensure that the results are converged at such a high reynolds number the drag coefficient c d the lift coefficient c l and the strouhal number s t are defined as 3 c d f x ρ u 2 d h 2 4 c l f y ρ u 2 d h 2 5 s t f s d u where f x and f y is the fluid force in the x and y direction respectively h is the length of the cylinder and f s is the frequency of the oscillatory lift force at re 100 the results of c d and s t from the medium mesh are different from those from fine mesh by less than 0 3 and 0 2 respectively similarly at re 3900 the differences in c d c l and s t between the results from medium and fine meshes are smaller than 1 5 and 0 5 respectively the mean drag coefficient from the medium mesh is 1 368 at re 100 and 1 229 at re 3900 which falls in the range of published data of 1 36 1 37 for re 100 and 1 1 to 1 27 for re 3900 respectively the present strouhal numbers also agree with other results in tables 1 and 2 the mesh dependency study shows that the medium mesh density is dense enough to obtain the reliable results for the simulations of flow past three cylinders in an equilateral triangle arrangement as is used in the rest of the simulations 3 numerical results 3 1 wake flow pattern the second negative eigenvalue λ 2 of the tensor s 2 ω 2 is used to visualize the three dimensional vortex flow pattern where s and ω represent the symmetric and antisymmetric parts of the velocity gradient tensor respectively jeong and hussain 1995 figs 2 4 show the iso surfaces of non dimensional streamwise vorticity ω x and λ 2 for re 200 1500 and 3900 respectively the vorticity and eigenvalue are nondimensionalized by ω x ω x u d and λ 2 λ 2 u d 2 respectively where the prime stands for the dimensional values in the following discussion all the vorticities and eigenvalues are non dimensional re 200 is the critical reynolds number for the flow past a single isolated cylinder transitioning from 2 d to 3 d zhao et al 2013 when the reynolds number is slightly greater than the critical reynolds number flow in the wake of a single cylinder becomes 3 d in mode a and the wavelength of the 3 d feature is about 3 4 diameters zhang et al 1995 barkley and henderson 1996 numerical simulations at re 200 are conducted for a cylinder length of h d 10 and it is found that the wake flow is 2 d if l d 1 25 fig 2 a and 3 d if l d 1 5 fig 2 b g however the three dimensionality is very weak at l d 2 0 the critical spacing ratio where the flow regime changes as re 1500 the wake flow becomes fully 3 d the flow in the wake of the three cylinders for re 1500 and l d 1 25 3 5 and 4 0 are very similar to the mode b wake flow reported by williamson 1988 and carmo et al 2010a b which is characterized by strong streamwise vortex pairs spaced by a distance of about one diameter the mode b flow pattern for a single cylinder starts at re 250 and persists until higher reynolds typically up to about re 1000 williamson 1996 the vortex pairs in mode b flow pattern is found to exist at re 1500 but only as l d 1 25 3 5 and 4 0 where well structured streamwise vortex pairs can be identified in fig 3 as l d 1 5 to 3 0 streamwise vortex pairs does not exist because strong interaction between cylinders it is interesting to see that at re 3900 well structured mode b vortex pairs can still be clearly seen but only when the gap ratio is small l d 1 25 by observing figs 2 4 it can be seen that three cylinders with a small gap ratio of l d 1 25 delay the transition of the wake flow from two dimensional to three dimensional and from mode b to full turbulent flow the contours of the spanwise vorticity on the middle section of the cylinder length for different reynolds numbers are presented in figs 5 9 the spanwise vorticity nondimensionalized by ω z ω z u d where the prime stands for the dimensional values for the convenience of discussion the gaps between c1 and c2 between c2 and c3 and between c1 and c3 are referred to as g12 g23 and g13 respectively generally the flow through g12 possesses characteristics of flow past two side by side cylinders and that through g13 has characteristics of flow past two tandem cylinders fig 5 shows the contours of the spanwise vorticity for re 200 and l d 1 25 and 1 5 globally the three cylinders behave as a single body and there is only one vortex street behind them the flow through g23 is too weak to have influence on the vortex shedding at l d 1 25 a similar flow pattern was observed by gu and sun 2001 and bao et al 2010 who reported that the gap flow through g23 is always deflected upwards due to the dominate proximity effect at l d 1 25 at l d 1 5 the shear layers generated through g23 extended further downstream compared with those at l d 1 25 but they do not form strong vortices because the shear layers from g23 for l d 1 5 are stronger than those for l d 1 25 and they bias upwards only the vortices that are shed from the top of c2 are weakened significantly fig 6 shows the contours of the spanwise vorticity on the x y plane for re 200 and l d 2 0 to 3 5 the bistable flow pattern occurs at small spacing ratios ranging from 1 25 to 2 0 this bistable flow regime is in consistent with that reported by lam and cheung 1998 which is 1 27 l d 2 29 as l d 2 0 and 2 5 vortex shedding occurs from c2 and c3 forming a dual vortex shedding dv pattern vortex shedding does not occur from c1 and the flow between c1 and c3 is very similar to the pattern e flow reported by igarashi 1981 for two tandem cylinders in flow the pattern e for two tandem cylinders is characterized by one shear layer from the upstream cylinder roll up intermittently in front of the downstream cylinder as shown in the sketch of fig 6 e in fig 6 the shear layer from the top of the upstream c1 always roll up and form a vortex as l d 2 0 and 2 5 since the shear layer from the top of c1 does not contribute the vortex shedding from c1 the vortices from top of c3 is weak the vortices from the bottom of c3 are very strong because the shear layer from bottom of c1 reattaches onto c3 as l d 3 0 and 3 5 vortex shedding from all the cylinders occurs and the flow pattern is defined as triple vortex shedding tv pattern combination of vortices in the wake of the cylinders occurs as l d 3 0 similar to that reported by bao et al 2010 as the spacing ratio is large enough the downstream c3 fails to suppress the vortex shedding from c1 and the vortex shedding from downstream cylinder 3 is strongly disturbed by the impingement of vortices shed from upstream c1 fig 7 shows contours of the spanwise vorticity on the x y plane for re 1500 and l d 1 25 similar to that for re 200 the flow in fig 7 is in proximity regime however the behavior of the flow through g23 for re 1500 and l d 1 25 is distinctly different from that for re 200 and l d 1 25 as re 1500 and l d 1 25 the direction of the flow through g23 is found to flip up and down frequently the changeover phenomenon of the deflected directions in g23 is also observed by tatsuno et al 1998 however the up and down flipping is found to be random instead of periodic for example the flow through g23 biases downwards at t t 4 after one period it biases downwards at t 5t 4 the flow pattern in fig 7 is named as proximity regime with flip flop gap flow if the jet flow through g23 is deflected upwards or downwards it is governed by the vortex generated from the bottom shear layer of c2 which is found to be trapped in an area immediately behind c2 most of the time and occasionally released for example at t 3t 4 in fig 7 at t t 4 a positive vortex has fully grown behind c2 and the flow through g23 biases downwards when this positive vortex dissipates at t 3t 4 the gap flow through g23 biases upwards after that another positive vortex will grow and squeeze the direction of the gap flow through g23 downwards again the flow for l d 1 5 and re 1500 is also in the proximity regime with flip flop gap flow fig 8 shows contours of spanwise vorticity on the x y plane for re 1500 and l d 2 0 while vortex shedding from c2 and c3 can be clearly seen in fig 8 it is interesting to see that only vortices from bottom of c1 are shed once a vortex is shed from the bottom side of c1 it sweeps c3 s bottom surface and is convected downstream as seen in fig 8 b and c because of the additional vortex shedding from the bottom side of c1 three positive vortices and two negative vortices can be seen right behind the cylinders in fig 8 c and d l d 2 0 for re 1500 where two and half pairs of vortices are shed from the three cylinders in one vortex shedding period is essentially the l d for the flow transitioning from dual vortex shedding to triple vortex shedding regimes fig 9 shows contours of spanwise vorticity on the x y plane for re 1500 and l d 2 5 to 4 0 the critical spacing ratio for flow changing from dual to triple vortex regimes for re 1500 is smaller than that for re 200 it is between l d 2 5 and 3 0 for re 200 and about l d 2 0 for re 1500 in the dual vortex shedding flow pattern the vortex wake is very different from that of a single cylinder because of the interaction between vortices although two pairs of vortices are shed from the cylinder in each vortex shedding period the wake vortices are not aligned in two rows due to the presence of c2 the wake flow pattern behind c1 is asymmetrical to the centerline which is consistent with the result obtained from lam and cheung 1988 in the triple vortex shedding regime l d 2 5 3 0 3 5 and 4 0 for re 1500 the vortex shedding from c2 is similar to that of a single cylinder and that from c1 and c3 is similar to the vortex shedding from two tandem cylinders the vortex shedding patterns identified for re 200 and 1500 are also observed for re 3900 the flow patterns for re 3900 are not shown to avoid repeating however the boundary l d between dual and triple vortex shedding regimes for re 3900 is between 1 5 and 2 0 which is smaller than that for re 1500 and the boundary l d between the proximity flow regime and dual vortex shedding regime is between 1 25 and 1 5 which is also smaller than that for re 1500 table 3 lists the identified flow regimes for all the simulated cases the flow around c1 and c3 in the dv and tv regimes is similar to the regimes found for flow past two tandem cylinders different researchers classify the wake flow of two tandem cylinders in different ways the regimes of sg symmetric in the gap and ag alternating in the gap defined by carmo et al 2010a b belong to a single wake and wg wake in the gap belongs to the dual wake the proximity regime reattachment regime and co shedding regime defined by papaionannou et al 2006 is equivalent to the sg ag and wg respectively the boundary l d between ag and wg for re 500 and 1000 was found to be between 3 5 and 4 0 by papaioannou et al 2006 the flows past c1 and c3 in the dual vortex shedding and triple vortex shedding regimes are the same as ag and wg however the critical between ag and wg in the present three cylinder case is found to be much smaller than that in previous studies of two tandem cylinders this is because the existence of c2 breaking the symmetry of the system and c2 acts as a disturbance that triggers wg at smaller l d the vortex shedding in the p d and p f regimes has some similarity to the deflected flow regime and flip flop regime for flow past two side by side cylinders respectively but not exactly the same in the deflected flow regime in the two side by side cylinder case the flow can be deflected towards one side for very long time but it can switch from one side to another side in the p d regime of the three cylinder case the flow is always deflected towards c2 in the flip flop regime of the two side by side cylinder case the frequency of the changing direction of the deflected flow is still much higher than that of the vortex shedding flow however in the three cylinder case the flow through g23 changes its direction up and down with a period the same as the vortex shedding period though the change of direction does not synchronize with the vortex shedding significant reynolds effects are clearly visible from the instantaneous iso surfaces of streamwise vorticity and spanwise vorticity contours shown in figs 2 9 with increasing reynolds numbers the three dimensionality becomes stronger at low reynolds number re 200 the vortex tube are almost aligned parallel to the cylinders and only small scales of streamwise vortices are observed the inclination of the spanwise vortices is not observed due to the synchronized phase of the vortex shedding along the cylinder span as re increases to 1500 and 3900 strong rib shaped streamwise vortices are generated and shed in the wake of the three cylinders due to the strong interference of the streamwise vortices in the wake of the three cylinders the spanwise vortices become wavy in the wake of the cylinders the inclination of the spanwise vortices occurs due to the phase differences of vortex shedding along the cylinder span the critical spacing ratios for different flow regimes for flow around three cylinders are also sensitive to reynolds number at a given spacing ratio l d 2 0 the flow pattern is dv for re 200 dv tv for re 1500 and tv for re 3900 the sensitivity of the flow patterns to the reynolds number also exists for flow past two cylinders in tandem and staggered configurations igarashi 1981 1984 sumner et al 2000 3 2 stagnation point and separation point the stagnation point of a cylinder is a point on the upstream side of the cylinder surface where the shear stress is zero and the pressure is at its maximum williamson 1988 fig 10 shows the definition of the stagnation point and separation points on a cylinder the location of the stagnation point is quantified using the angle of the stagnation which is zero at the most upstream point of the cylinder surface and measured in the clockwise direction the stagnation point oscillates along the cylinder surface because of the vortex shedding flow fig 11 shows the time histories of the angle stagnation point for re 200 and 1500 while the stagnation point of a single cylinder is nearly stationary stagnation points of the three cylinder oscillates along the cylinder surface with an amplitude between 1 and 2 as l d 1 25 the oscillation amplitude of the angle of stagnation point reduces significantly as l d 1 5 and it increases again as l d 2 5 for re 200 and l d 2 0 for re 1500 in these two cases the flow between c1 and c3 is in the dynamic ag mode which leads to strong oscillation of the angle of stagnation point when vortex shedding from c1 occurs c3 is affected by the vortices that are shed from c1 significantly and no stagnation point can be identified on c3 fig 12 shows the variation of time averaged angle of stagnation point with the spacing ratio for three cylinders at different reynolds numbers the angle of stagnation point of c3 is the largest which is slightly greater than 30 as l d 1 25 and aligns well with g12 with increasing l d the angle of stagnation point of c3 increases similar to what reported by pouryoussefi 2011 the jet flow causes to diminish the vortex shedding from downstream cylinder and leads to the shifting of separation points the angle of stagnation point of c3 does not exist for large l d because the vortex shedding from c1 makes c3 attacked by vortices and sometime surrounded by vortices the angle of stagnation points of c1 and c2 are in opposite signs and their magnitudes are close to each other at large l d it is interesting that the angle of stagnation angle of the most upstream c1 is greater than c2 at the smallest l d 1 25 the angles of stagnation point for c1 and c2 are still slightly deviated from zero at l d 4 0 indicating there is still interaction among these two cylinders because vortex shedding flow of c3 is affected by both c1 and c2 the flow separation on its surface is found to be very different from that of a single cylinder fig 13 shows the time histories of the separation angle on the cylinder surfaces at small spacing ratios of l d 1 25 and 1 5 as shown in fig 10 the separation angle is defined as the angle measured along the cylinder surface from the front stagnation point to the separation point θ st and θ sb represent the separation angles on the top and bottom sides of the cylinder respectively the calculated mean separation angles of the single cylinder for re 200 1500 and 3900 are θ s 111 9 97 9 89 9 respectively which are in good agreement with the previous research results williamson 1996 harichandan and roy 2012 zhao et al 2013 joshi and jaiman 2017 it can be seen that both θ st and θ sb of c3 oscillate with the highest amplitude compared with those of the other two cylinders mainly because it is affected the most by the dynamics gap flow through g23 and the strong vortices generated by the shear layer generated by c1 and strengthened when it passes c3 3 3 time averaged flow field the time averaged vorticity contours streamlines and reynolds stresses behind a single cylinder are compared with the experimental results obtained from ozgoren 2013 in fig 14 solid lines represent positive values and dashed lines represent negative values in the contours in the case of an isolated cylinder the contours of vorticity contours streamline topologies root mean square streamwise velocity u r m s u 0 and reynolds stress contours u u u 0 2 v v u 0 2 u v u 0 2 are concentrated in the near wake and symmetrical about the wake centerline the numerical results are in good agreement with the experimental results in ozgoren 2013 figs 15 and 16 present the time averaged vorticity contours streamlines and reynolds stresses behind the three cylinders at different spacing ratios l d 1 5 2 0 and 3 0 for re 3900 it can be seen that due to the complex interferences among the three cylinders the time averaged flow features are observed to be more complicated than those of a single cylinder at l d 1 5 the time averaged streamline patterns illustrate that the reverse flows are obviously observed in the near wake and also in the gap between c1 and c3 however due to the gap flow deflection the two recirculation zones in the wakes of c2 and c3 are aligned slightly towards top right the recirculation zone in the wake of c1 is very small and biased because the strong vortices in the wake of c2 and c3 as discussed above the recirculation zone between c2 and c3 are very large as l d is increased to 2 0 the recirculation zone in the wake of c1 increases and that in the wake of c2 and c3 decreases mainly because the reattachment of the shear layers on the downstream c2 similar what was reported by ozgoren 2013 the reynolds shear stress u v u 0 2 for the equilateral triangle arranged three cylinders are greater than that of the single cylinder as l d 1 5 strong reynolds stress is found behind g23 as the result of the flipping gap flow as l d 2 0 the distribution of the reynolds stress behind c2 becomes symmetric and that behind c3 is slightly asymmetric because of the dv flow pattern however the reynolds stress between c1 and c3 is still small because there is no vortex shedding from c1 when l d 3 0 the flow is in the tv flow pattern and the reynolds stress distribution in the wake of the three cylinder are more or less symmetric 3 4 pressure distribution and force coefficient figs 17 and 18 show the time histories of the drag and lift coefficients for reynolds numbers re 200 and 3900 respectively the drag and lift coefficients of all the cylinders for re 200 are more periodic than those at re 3900 because the three dimensionality is weak the amplitude of the lift coefficient on the downstream c3 is greater than those of the other two cylinders for both re 200 and 3900 mainly because c3 is strongly affected by the gap flow through g23 at small spacing ratios and by the vortex shedding from c1 when the spacing ratio is large at spacing ratios l d 1 25 and 2 0 and re 200 the oscillations of the lift coefficients of all the cylinders are very weak because no vortices are shed from the upstream c1 as l d is increased to 3 0 the amplitudes of the lift coefficients of the three cylinders become regular and periodic unlike those at re 200 the drag and lift coefficients for re 3900 of the three cylinders are very irregular due to strong three dimensionality of the wake flow behind the three cylinders the drag coefficient of c3 is the smallest because it is within the wake zone of c1 and its amplitude increases significantly when vortex shedding from c1 occurs in the tv flow pattern fig 19 shows the variation of the mean pressure coefficient c p on each cylinder with the spacing ratio where the overbar means averaged value and c p is defined as c p p p 0 5 ρ u 2 where p is the pressure of the incoming flow figs 20 22 show the statistic values of the drag and lift coefficient on the three cylinders for re 200 1500 and 3900 respectively in the following discussion c dn and c ln are used to stands for the drag and lift coefficient of the n th cylinder respectively as l d 1 25 the blockage effect from the narrow gap g12 increases the pressure between 0 θ 120 resulting in a significant increase in the magnitude of the negative c l 1 and a slight increase in c d 1 with the widening of g12 the magnitude of c l 1 decreases c d 1 is smaller than c d of a single cylinder as l d 2 for re 200 and l d 1 5 for re 1500 and 3900 because the pressure at the back of c1 is increased c d 2 varies with θ with an opposite trend of c d 1 it is smaller than the corresponding single cylinder value at small l d and greater at large l d c d 1 is reduced at large l d because the base pressure of c1 is increased compared with that of a single cylinder as the result of weakened vortex shedding in g13 compared with that of a single cylinder the stronger blockage of the three cylinder system than a single cylinder results in a decrease in the base pressure of c2 and an increase of c d 2 sayers 1987 reported that the increasing of drag coefficient c d 2 at large spacing ratios is due to the proximity interference between c2 and c3 the pressure coefficient on c3 is significantly different from that on a single cylinder tatsuno et al 1998 mentioned that the intense gap flow among the three cylinders causes a reduction in pressure in the gap leading to the decreasing of drag coefficient the small high pressure region on c3 near the stagnation point about 30 is due to the attack of the high speed jet flow through g12 compared with that of a single cylinder the high pressure region in front of c3 is much smaller resulting a significant reduction of the mean drag coefficient of c3 as shown in figs 14 to 15 the shift of the stagnation point towards the top surface of c3 leads to a negative mean lift coefficient of c3 the pressure at the stagnation point and the lift coefficient at l d 1 5 is greater than that at l d 1 25 because the larger gap at l d 1 5 makes larger jet flow rate through c12 that attacks the front surface of c3 as l d 1 5 the pressure at the stagnation point of c3 reduces with increasing l d so does the magnitude of the mean lift coefficient because the jet velocity in g12 is decreased it is interesting to see that the strong oscillation of the angle of separation of c3 at small l d 1 25 and 1 5 does not produce strong oscillation of the lift coefficient when l d is small the jet flow velocity and flow rate through g23 are too small to have big effects on the forces although the shear layer from g23 separates from and reattach to the back of c3 alternatively making a big oscillation amplitude of angle of separation the weakness of the shear layer does not contribute much to the oscillation of the lift coefficient the standard deviation sd of the lift coefficient of two side by side cylinders in flow with flip flop gap flow at small gap ratios was also found to be smaller compared with that of a single cylinder thapa et al 2015 from fig 20 it can be seen that the strong single vortex street in the proximity regime at small l d does not increases sd of the lift coefficients of all the cylinders mainly because there is not an integral vortex street in each individual cylinder based on fig 20 b and fig 21 b the mean lift coefficient of the whole cylinder system i e the sum of the mean lift coefficients of all the cylinders direct downwards especially when l d is small because the shear layer from the bottoms of c1 and c3 generate stronger vortices than the shear layer from the top of only c2 the sum of the mean drag coefficients of the three cylinders is more than three times the drag coefficient of a single cylinder because c d 2 is decreased dramatically based on fig 20 c and d and fig 21 c and d we can conclude that put three cylinder together in an equilateral triangle arrangement at l d between 2 5 and 4 0 will increase the sd lift coefficient of the whole system the numerical results by bao et al 2010 for re 100 are also included in fig 20 for comparison the present variation trend of the force coefficients with l d is in agreement with that in bao et al 2010 however the boundary l d between different flow patterns and the values of the force coefficients are affected by the reynolds number the rms lift coefficient for re 200 increases significantly as l d increases from 2 5 to 3 0 where the flow changes from dv to tv flow pattern the significant increase of the lift coefficient for re 100 occurs at a greater value of l d in bao et al 2010 in addition the maximum values of c d and c l for re 100 are lower than those for re 200 3 5 strouhal number the vortex shedding frequency is determined through the fast fourier transform fft analysis of the lift coefficient at the mid section of the cylinders fig 22 shows the power spectra of the lift coefficient of each cylinder at different spacing ratios for re 3900 each spectrum in fig 22 has at least one distinct peak frequency the nondimenional peak frequency is called strouhal number which is calculated by s t f s d u fig 23 shows the variations of the strouhal number with l d for re 200 1500 and 3900 in the proximity regime with l d 1 25 the peak frequencies of three cylinders are the same because the oscillation of all the lift coefficients is caused by only vortex street when l d 1 5 the spectra of c1 and c2 are broad banded mainly because the strong up and down flip flop jet flow through g23 does not synchronize with the vortex shedding as discussed in section 3 1 however the local peak with s t 0 122 can still been seen at re 3900 which is the result of the vortex shedding the strouhal numbers in the proximity regime are nearly half that of a single cylinder because the dimension of the whole three cylinder system is nearly twice the cylinder diameter which leads to decrease in the vortex shedding frequency of the single vortex street when the flow is in the dv shedding and tv flow regimes the strouhal numbers of c1 and c3 are the same because of the synchronization of the vortex shedding from these two cylinders sumner et al 2005 carmo and meneghini 2006 bao et al 2010 pouryoussefi et al 2011 the strouhal number of c2 is different from those of c1 and c3 because c2 has little interaction with the other two cylinders interestingly at l d 2 0 some cylinders have dual frequencies because the vortex street in the wake of c2 and the vortex street in the wake of c1 and c3 interact with each other as re 200 the s t of c1 and c3 are still smaller than that of a single cylinder and the s t of c2 is greater when the reynolds number increases to 1500 and 3900 the s t of c1 and c3 approach st of a single cylinder but the s t of c2 is still higher 4 conclusions three dimensional numerical simulations on flow past three circular cylinders in an equilateral triangular arrangement are performed using the openfoam open source code the combined effects of spacing ratio and reynolds number on the three dimensional flow features and force coefficients are investigated the findings are summarized as follows 1 depending on the spacing ratios and reynolds numbers five different flow regimes are identified and they are p d proximity with deflected flow p f proximity with flip flop flow dv dual vortex shedding dv tv transition between dual vortex shedding and triple vortex shedding tv triple vortex shedding the critical spacing ratios for the transition among different flow regimes decrease with increasing reynolds number three dimensionality of primary vortex shedding increases with increasing spacing ratio or reynolds number mode b flow pattern with streamwise vortex pairs is found at l d 1 25 3 5 and 4 0 for re 1500 and at l d 1 25 for 3900 2 the downstream c3 has the largest angle of stagnation point with increasing l d the angle of stagnation point of c3 increases the angles of stagnation point of c1 and c2 are in opposite signs and their magnitudes are close to each other at large l d the separation angle of c3 oscillates with the highest amplitude compared with those of the other two cylinders due to the dynamics gap flow through g23 and the strong vortices generated by c1 and strengthened when it passes c3 3 the pressure coefficient experienced by the downstream cylinder c3 is significantly different from that on a single cylinder leading to a smaller mean drag coefficient on c3 than those on c1 and c2 irrespective of the spacing ratios and reynolds numbers both the mean lift coefficients experienced by c1 and c3 are almost negative but positive for c2 at all the examined spacing ratios the strong single vortex street in the proximity regime at small l d does not increases sd of the lift coefficient for all the cylinders but increases the sd of lift coefficients at large spacing ratios 2 5 l d 4 0 4 the strouhal numbers corresponding to vortex shedding experienced by c1 and c3 are mostly the same and increase with spacing ratio then approach to that of a single cylinder at the triple vortex shedding regime the strouhal number of c2 is much larger than those of c1 and c3 at all the examined spacing ratios and maintained at a value of 0 23 acknowledgements this research was supported by the joint fund of zhejiang provincial natural science foundation grant no lhz19e090004 national key r d program of china 2018yfe0109500 2018yfd0900901 
