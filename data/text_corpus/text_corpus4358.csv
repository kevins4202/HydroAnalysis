index,text
21790,this paper addresses the tracking control problem of unmanned underwater vehicles under the condition of external disturbances and unmodeled dynamics using port hamiltonian theory by introducing port hamiltonian theory conventional uuvs dynamics can be transformed into port hamiltonian form with insightful expressions then combined with a structure preserving adaptive method unmodeled dynamics and unknown disturbances can be addressed simultaneously without destroying the interconnection structure of the hamiltonian system finally based on interconnection and damping assignment passivity based control the controller is designed in an intuitive way the dissipation property of port hamiltonian theory is utilized to prove the stability compared with other methods that come from the view of signal processing the proposed scheme has the advantages of better potential and physical interpretation of engineering applications simulations and comparisons are conducted to demonstrate the effectiveness of the proposed method keywords unmanned underwater vehicles adaptive control trajectory tracking control passivity based control port hamiltonian theory 1 introduction with more attention to ocean exploration marine techniques have been developed a long way among all the marine fields deep sea exploration is becoming a hot topic for many underwater missions such as resource exploration seafloor mapping environmental remediation and underwater terrain construction yuh 2000 qiao and zhang 2018a unmanned underwater vehicles uuvs have played an indispensable role which provide the main tools for various missions in unknown environment when performing tasks uuvs are often demanded to track given trajectories however due to the nonlinearity property modeling errors and unknown environmental perturbations the control problem of trajectory tracking is full of challenges in recent years many results of trajectory tracking in both marine and control communities have been published in li et al 2015 a 3d trajectory tracking controller was designed using cascaded backstepping technique under ideal conditions for more practical cases backstepping based projection algorithms were proposed to design the tracking controller under the presence of unknown parameters rezazadegan et al 2013 2015 sliding mode control is also a commonly used method for example qiao et al proposed a terminal sliding mode scheme to achieve the tracking objective with finite time convergence of position errors qiao and zhang 2018b besides other methods developed for trajectory tracking in marine field can be referred in do and pan 2005 li et al 2008 gan et al 2016 however these methods are mainly derived from the idea of signal processing which have the drawback of lacking physical interpretation this problem will increase the difficulty of practical engineering application also the aforementioned methods are often highly complex making the controller design difficult in fact for mechanical systems passivity based control is a good way to design the controller on the one hand compared with other nonlinear control methods passivity based control has natural robustness to uncertainties on the other hand different from other methods which come from the idea of signal processing the key point of passivity based control comes from the idea of energy van der schaft and van der schaft 2000 brogliato et al egeland since the mechanical systems follow the physical laws of energy and the dynamics of uuv is one of this type passivity based control has been applied to marine systems over the past two decades fossen astolfi et al 2002 recently port hamiltonian ph systems have attracted great attention for it can provide an in depth insight for physical systems through port hamiltonian theory complex physical systems can be described with network modeling in a geometric structure van der schaft 2006 nageshrao et al 2015 the port variables can be regarded as system input whose product represents the power grabbed from external environment ortega et al 2002 the hamiltonian function represents the total energy including kinetic and potential energy stored in the system by reshaping the hamiltonian function with desired kinetic and potential energy the desired stability can be guaranteed when regarding the closed loop hamiltonian function as the lyapunov candidate function with these advantages ph system can be designed as dissipation system under the passivity based control this good property effectively combines the design of control system with explicit physical meaning improving the acceptance and potential of this method in practical engineering applications based on port hamiltonian theory an integral stabilization control scheme was proposed for marine crafts to achieve dynamic positioning in donaire and perez 2010 considering external disturbances donaire et al designed a nonlinear set point regulation controller donaire and perez 2012 in their paper by introducing a state transformation integral action is added to eliminate the influence of constant disturbances as for the more difficult tracking problem fujimoto et al investigated the control problem using generalized canonical transformations fujimoto and sugie 2001 fujimoto et al 2003 by converting the original tracking system to a passive error system a general solution of tracking problem can be obtained nevertheless this method can only design those systems which are expressed in canonical ph form in other words for marine crafts only those models expressed in earth fixed coordinate can apply this method to expand the application of port hamiltonian theory in trajectory tracking problem a tracking controller was designed using interconnection and damping assignment passivity based ida pbc method in donaire et al 2015 with this method tracking controller can be designed in either earth fixed coordinate or body fixed frame the tracking problem in the presence of external disturbances has been investigated using ida pbc method in the port hamiltonian framework donaire et al 2017 by combing ida pbc method with integral action the control scheme called integral pbc scheme was designed with robustness against constant disturbances however all the aforementioned methods can only address external disturbances while the model uncertainty is out of the ability to solve this problem an adaptive control scheme of port hamiltonian systems was proposed to compensate for model uncertainties dirksz and scherpen 2010 2012 this method provides a way to incorporate adaptive method with port hamiltonian theory while preserving the interconnection structure with this idea tracking problems of port hamiltonian systems were investigated under the consideration of model uncertainties in qureshi et al 2015 and haddad et al 2018 however the above adaptive tracking schemes are all based on canonical transformations which have the same limitations as those in fujimoto et al 2003 motivated by aforementioned discussions we investigate the adaptive tracking problem of uuvs using port hamiltonian theory to study the system in a more intuitive and insightful way and design the controller with explicit physical interpretation we express the kinematics and dynamics of uuvs in ph form firstly by interconnection and damping assignment the system hamiltonian function is reshaped with desired kinetic and potential energy then without considering model uncertainties and external perturbations the tracking controller is designed firstly using ida pbc method and the control law is obtained by solving matching conditions to address model uncertainties and external perturbations simultaneously we propose an adaptive algorithm within the framework of hamiltonian systems the unknown constant disturbances and unmodeled dynamics can be estimated adaptively without destroying the interconnection structure of ph system based on the control law obtained the new tracking system is constructed with desired hamiltonian function concerned with all the tracking and estimation errors by regarding the closed loop hamiltonian function as the lyapunov candidate function the stability can be guaranteed easily from the dissipation property of ph system the main contributions of this paper are listed below 1 a novel tracking control algorithm is proposed for uuvs using ida pbc method and port hamiltonian theory 2 compared with other schemes using port hamiltonian theory the proposed adaptive method can address model uncertainties and external perturbations simultaneously while preserving the original interconnection structure 3 by utilizing the dissipation property of ph systems the controller is designed in an intuitive way which can provide explicit physical interpretation from the view of energy reduce the design complexity and have better potential of practical engineering applications 2 problem formulation to design the controller in port hamiltonian frame the classic model of marine crafts needs to be rewritten in the ph model before the design we briefly introduce the port hamiltonian theory first then rewrite the kinematics and dynamics in the ph form 2 1 port hamiltonian system port hamiltonian system is a result of network modeling of physical system with lumped parameters van der schaft 2006 a system can be called port hamiltonian system if it can be expressed as follows 1 x j x r x h x x t g x u y g h x x t with h x t a hamiltonian function bounded from below j x r n n is the interconnection matrix which is skew symmetric i e j j and r x r n n is a semi positive definite matrix with the symmetric property r r which represents the dissipation g x r n m is the input matrix u r m y r m are conjugated variables whose product represents the power flows grabbed from external environment these two variables are also called port variables of the system the interconnection matrix j x represents the energy exchanged inside the system while the dissipation matrix r x represents the energy dissipated by the system if the hamiltonian function is time invariant then the key property of port hamiltonian system can be seen from the following equation 2 d h d t h x x j r h x x h x x g u h x x r h x x y u from the above equation one can see that the total energy stored by the system equals the difference between the supplied energy and dissipated energy which shows the passivity property van der schaft and van der schaft 2000 if we can design the control law u β x α so that the closed loop system satisfying the following condition while preserving the ph structure 3 h d x t h d x 0 0 t α τ y τ d τ d r d t then system 1 can be stabilized at the desired point when α 0 here h d x is the desired hamiltonian function representing the total energy which has a minimum at the desired point x d r d t 0 is the dissipated energy while y is the new passive output 2 2 ph model of marine crafts in this section we consider the 6 dof model of marine craft the model of uuvs in classic form derived from fossen is expressed as 4 η j η ν m ν c ν ν d ν ν g η τ w τ c where η is the position vector ν represents the velocities in 6 dof surge sway heave roll pitch and yaw g η is the hydrostatics caused by gravity and buoyancy m is the symmetric inertia matrix with m m c is the coriolis centripetal matrix which is skew symmetric that is c c and d is a symmetric matrix denoting the damping term τ c and τ w are control input and external perturbation vectors j r 6 6 is the coordinate transformation matrix as j η j 1 η 0 3 3 0 3 3 j 2 η in the above expression 0 3 3 r 3 3 is the matrix of zeros and j i r 3 3 i 1 2 are defined as j 1 η c ψ c θ s ψ c ϕ c ψ s θ s ϕ s ψ s ϕ c ψ c ϕ s θ s ψ c θ c ψ c ϕ s ψ s θ s ϕ c ψ s ϕ s ψ c ϕ s θ s θ c θ s ϕ c θ c ϕ j 2 η 1 s ϕ t θ c ϕ t θ 0 c ϕ s ϕ 0 s ϕ c θ c ϕ c θ where c s and t represent cos sin and tan respectively in this paper as shown in fig 1 all the positions are expressed in inertial frame while the velocities are expressed in body fixed frame here η x y z ϕ θ ψ is the position and attitude vector ν u v w p q r is the linear and angular velocity vector to study the system in port hamiltonian frame we need to rewrite the model in ph form the ph model of uuvs is given as follows 5 η p 0 j j c 0 0 0 d h 0 g τ c τ w for fully actuated system the input matrix g i 6 6 h is the hamiltonian function concerned with kinetic energy and potential energy which is in the form as 6 h 1 2 p m 1 p v η v η w sin θ b g x w cos θ sin ϕ b g y w cos θ cos ϕ b g z where p m ν w m g and b g i i x y z are the distances between the center of gravity and the center of buoyancy the objective of trajectory tracking is to track a time varying path on time given a set of desired position vectors η d t we aim to design a controller using ida pbc method to achieve the objective lim t η t η d t remark 1 for neutrally buoyant underwater vehicles the term g η can be expressed as g η j η η v η fossen 2011 thus the term g η appearing in 4 is replaced by the product of j and h η in 5 remark 2 in this paper we adopt the ph model in body fixed frame and thus can keep the inertia matrix constant this choice will reduce the complexity of the control design while the inertia matrix of ph model in inertial coordinate is non constant the ph model of marine crafts in inertial coordinate can be referred in donaire et al 2017 3 design of tracking controller since the ph model shows passivity property as mentioned before it makes the passivity based method a good way to design the controller we first design the control law using ida pbc method then propose an adaptive method to compensate for model uncertainties and unknown constant disturbances while preserving the ph structure 3 1 control via interconnection and damping assignment in passivity based control theory interconnection and damping assignment method provides a way to shape both the kinetic and potential energy ortega et al 2002 by modifying the interconnection and damping matrices both the kinetic and potential energy in hamiltonian function can be reshaped and thus we can get the desired ph form under the designed control law for trajectory tracking uuvs need to track a time varying trajectory instead of a fixed point therefore forcing the tracking errors to converge to zero is the control objective for stabilization problem the desired ph form is constructed in terms of original states while for tracking problem we need to transform the original one into a new ph model in terms of tracking errors the tracking errors can be defined as 7 η η η d p p p d where η d t is the desired trajectory p d is a virtual velocity vector which will be defined later in this part we assume the disturbances are zero first consider the following ph form as the desired closed loop dynamics 8 η p a 11 a 12 a 12 a 22 h d where h d is the desired hamiltonian function with a minimum at x η p 0 0 a i i i 1 2 are negative definite matrices which are symmetric a 12 is a function valued matrix to be selected as we can see the original hamiltonian function includes kinetic energy and potential energy in this part we reshape the kinetic and potential energy as the desired form 9 h d 1 2 p m d 1 p 1 2 η k d η here m d and k d are symmetric and positive definite matrices to obtain the desired closed loop dynamics we need to modify the interconnection and damping matrices by designing the appropriate control law for the original system the kinematics equation is 10 η j m 1 p from where we can get the error dynamics easily as follows 11 η j m 1 p η d by matching equation 11 with the first row of desired dynamics 8 we can get the following matching condition 12 j m 1 p η d a 11 k d η a 12 m d 1 p since p p p d to satisfy the matching condition we define p d as 13 p d m j 1 a 11 k d η η d if we choose a 12 j m 1 m d then the above matching condition of dynamics of η is satisfied now we need to design the control law to match the corresponding condition of p the original dynamics of p is 14 p q m 1 p j η v g τ c where q c d according to equation p p p d 8 and 13 we can write the matching condition as 15 p q m 1 p p d j η v g τ c q m 1 p d m j 1 a 11 d t k d η j η v m j 1 a 11 k d η d m j 1 d t η d m j 1 η d g τ c m d m 1 j k d η a 22 m d 1 p design the control law as 16 τ c g 1 q m 1 p d m j 1 a 11 d t k d η m j 1 a 11 k d η d m j 1 d t η d j η v m j 1 η d m d m 1 j k d η a 22 m d 1 p with all the design procedures aforementioned the result can be summarized as the following theorem theorem 1 consider the system 5 with hamiltonian function 6 if the external disturbances τ w 0 a 12 is chosen as a 12 j m 1 m d p d are defined as 13 and the matrices a 11 a 22 are selected negative definite and symmetric then the system can be asymptotically stabilized at the desired trajectory under the control law 16 with k d and m d positive definite and symmetric proof substitute equations 13 and 16 into the original model 5 with the transformation 7 we can get the same closed loop dynamics as 8 since the closed loop dynamics is in ph form and the corresponding hamiltonian function is 9 we can get the following equation 17 d h d d t h d x j 1 r 1 h d x where x η p and 18 j 1 0 a 12 a 12 0 r 1 a 11 0 0 a 22 j 1 is a skew symmetric matrix r 1 is a positive definite and symmetric matrix so the above equation can be simplified as 19 d h d d t h d x r 1 h d x η k d a 11 k d η p m d 1 a 22 m d 1 p if we take the hamiltonian function h d as the lyapunov candidate function of the closed loop system then one can obtain the following inequality easily 20 d h d d t η k d a 11 k d η p m d 1 a 22 m d 1 p δ 1 η 2 2 δ 2 p 2 2 2 δ 1 δ 3 δ 3 2 η 2 2 2 δ 2 δ 4 δ 4 2 p 2 2 δ h d where δ 1 δ 2 δ 3 and δ 4 are positive constants related to eigenvalues δ 1 max λ k d a 11 k d δ 2 max λ m d 1 a 22 m d 1 δ 3 max λ k d δ 4 max λ m d 1 with a positive constant δ min δ 1 δ 2 from the inequality 20 we can conclude that the system is guaranteed asymptotically stable at the desired time varying trajectory η d p d 3 2 adaptive control under model uncertainties and constant disturbances in the previous section we design the controller for trajectory tracking however the control law is designed under the assumption that there is no external disturbance and model uncertainty in fact due to the nonlinearity of the model it is hard to get the accurate model also the persistent disturbance makes the control difficult in this section a novel adaptive method based on port hamiltonian theorem is proposed to address model uncertainties and constant perturbations simultaneously while preserving the ph form for uuvs model uncertainties mainly come from two aspects inertia uncertainties and hydrodynamic uncertainties in practical inertia uncertainties which mainly exist in matrix m and c are relatively easier to eliminate while due to the complexity of the hydrodynamics the corresponding uncertainties are more sever and harder to handle consequently the real values of matrix d which are highly related to hydrodynamic parameters cannot be identified accurately considering this kind of model uncertainties the matrix d can be expressed as 21 d ν ν m 1 p d 0 ν i 1 l ξ i d i ν ν m 1 p where d 0 is the nominal part which is known the unknown part is expressed in terms of unknown constant parameters ξ i then the control law can be expressed as 22 τ c g 1 q 0 m 1 p d m j 1 a 11 d t k d η m j 1 a 11 k d η d m j 1 d t η d j η v m j 1 η d m d m 1 j k d η a 22 m d 1 p δ ξ where 23 q 0 c d 0 δ b 1 b l ξ ξ 1 ξ l b i d i m 1 p since the control law 22 includes the unknown parameters ξ i it cannot be used when model uncertainties are taken into consideration however according to certainty equivalence principle the unknown parameters ξ i and constant disturbance vector τ w can be replaced by their estimations through adaptive method based on 22 the adaptive control signal with compensation for disturbances can be rewritten as follows 24 τ c a g 1 q 0 m 1 p d m j 1 a 11 d t k d η m j 1 a 11 k d η d m j 1 d t η d j η v m j 1 η d m d m 1 j k d η a 22 m d 1 p δ ξ ˆ g τ ˆ w where ξ ˆ τ ˆ w are estimations of ξ and τ w provided by adaptive laws the closed loop dynamics along the adaptive control law τ c a can be obtained 25 η p a 11 a 12 a 12 a 22 h d 0 δ ξ g τ ˆ w when the external perturbations in 5 are constant and τ w 0 we can write the dynamics as 26 η p a 11 a 12 a 12 a 22 h d 0 δ ξ g τ w where ξ τ w are estimation errors defined by the following equations 27 τ w τ w τ ˆ w ξ ξ ξ ˆ however the obtained dynamics is no longer in ph form considering the ph system structure property and stability we design the adaptive law as follows 28 ξ ˆ k z δ m d 1 p τ ˆ w k w g m d 1 p with k z k w positive definite and diagonal gain matrices then the extended tracking system can be obtained 29 η p ξ τ w a 11 a 12 0 0 a 12 a 22 δ k z g k w 0 k z δ 0 0 0 k w g 0 0 h d a with the corresponding hamiltonian function 30 h d a 1 2 p m d 1 p 1 2 η k d η 1 2 ξ k z 1 ξ 1 2 τ w k w 1 τ w before showing the result we firstly give the following assumption and lemma which will be used later assumption 1 the adaptive regressor δ is a non constant matrix lemma 1 barbalat s lemma khalil and grizzle 2002 let ρ t r r be a uniformly continuous function on 0 then the following property holds 31 ρ t 0 a s t when lim t 0 ρ τ d τ exists and is finite remark 3 as can be seen from 23 the regressor δ is related to velocity vector and matrix d i in practical the velocity is non constant and the product of d i and p is time varying therefore assumption 1 can be satisfied easily we will give the result of this section by the following theorem theorem 2 consider the system 5 with model uncertainties 21 if the external disturbances are constant and τ w 0 a 12 is chosen as a 12 j m 1 m d p d are defined as 13 the matrices a 11 a 22 are selected negative definite and symmetric then the control law 24 and adaptive update laws 28 with appropriate selections of k z k w m d and k d can realize asymptotic tracking of the desired trajectory proof in theorem 1 we have proved that the control law 16 can stabilize the tracking system at the desired trajectory without considering model uncertainties and external disturbances to show the preservation of the ph structure we construct the extended tracking system 32 x f x η p where x η p ξ τ w then when τ w 0 and is constant substitute adaptive control law 24 into the original tracking system we can easily get the closed loop error dynamics 26 along with the adaptive update laws 28 we can write the extended system in the ph form and therefore get the extended closed loop error dynamics as 29 with hamiltonian function 30 here 33 f j 2 r 2 h d a x a 11 a 12 0 0 a 12 a 22 δ k z g k w 0 k z δ 0 0 0 k w g 0 0 k d η m d 1 p k z 1 ξ k w 1 τ w where j 2 is the interconnection matrix and r 2 is the damping matrix as can be seen from the above equation the extended closed loop tracking error system satisfies the interconnection and dissipation structure condition take the hamiltonian function h d a as the lyapunov candidate function then the time derivative of h d a can be obtained 34 h d a h d a x f h d a x j 2 r 2 h d a x h d a x r 2 h d a x η k d a 11 k d η p m d 1 a 22 m d 1 p 0 since the lyapunov candidate function is lower bounded from zero k d m d are constant and positive definite a 11 a 22 are constant and negative definite by using barbalat s lemma lemma 1 with ρ t h d a we know that h d a 0 as t moreover h d a 0 holds if and only if both η and p are zero from the following equivalent equation 35 h d a 0 η p 0 and the fact h d a 0 we know that p η 0 as t from 29 we have 36 x j 1 r 1 h d a x g i δ ξ g τ w where g i 0 i as can be seen from the selection of j 1 and r 1 we know that the matrix j 1 r 1 is invertible with the result x 0 as t and become constant we have the following equation 37 h d a x j 1 r 1 1 g i δ ξ g τ w when x 0 as t the left hand term of 37 equals zero and the equation above becomes 38 j 1 r 1 1 g i δ ξ g τ w 0 because δ is a non constant regressor and g is constant from 38 we know that the equation holds if and only if ξ τ w 0 together with x we know that x 0 as t thereby we can conclude that the uuv will asymptotically track the desired trajectory remark 4 in previous literature donaire et al 2015 2017 the use of integral action makes the adaptive method impossible which can only address the external constant disturbance problem in dirksz and scherpen 2010 2012 they design the tracking controller using canonical transformations which will cause steady errors for regulation problem compared with the method used in dirksz and scherpen 2010 and dirksz and scherpen 2012 we adopt the ida pbc method to modify the interconnection and damping matrices which can be applied for regulation problem 4 simulation results in this section to demonstrate the effectiveness and applicability of the proposed scheme two different fully actuated models are utilized to conduct simulations in the first case the uuv is required to track a circular trajectory in horizontal plane in the second example the simulation is conducted in 3d space using another different uuv model to illustrate the advantages of the proposed method the integral pbc scheme is compared to the designed scheme 4 1 simulation example 1 in this case the uuv model in donaire and perez 2010 is adopted with the mass of 140 kg the uuv is equipped with several thrusters which can provide full actuation in the horizontal plane we only consider the motion at 3 dof in surge sway and yaw the specific model parameters are given as follows m 290 0 0 0 404 50 0 50 132 c 0 0 50 r 404 v 0 0 290 u 50 r 404 v 290 u 0 d 268 v 95 0 0 0 164 u 613 0 0 0 105 to implement the adaptive method proposed in previous section here we express the matrix d as 39 d ν ν m 1 p d 0 ν i 1 5 ξ i d i ν ν m 1 p where d 0 200 v 50 0 0 0 100 u 500 0 0 0 50 d 1 1 0 0 0 0 0 0 0 0 d 2 2 v 0 0 0 0 0 0 0 0 d 3 0 0 0 0 1 0 0 0 0 d 4 0 0 0 0 u 0 0 0 0 d 5 0 0 0 0 0 0 0 0 1 the desired trajectory is set as a circle and the initial position of the uuv is η 0 0 5 m 0 5 m 0 rad the constant external perturbation vector is given as τ w 30 n 20 n 20 n m select the control parameters as a 11 diag 1 0 5 2 a 22 diag 1 0 8 2 k d diag 0 4 0 4 0 4 and m d diag 0 2 0 05 0 2 choose the adaptive parameters as k w diag 0 3 0 2 0 2 and k z diag 50 200 30 150 15 simulations are conducted using matlab fig 2 shows the tracking result in horizontal plane as can be seen the uuv starts tracking the reference trajectory from a point with initial errors and then achieve accurate tracking under the proposed scheme while the integral pbc method cannot achieve accurate tracking which is shown by the red dashed line compared with the integral pbc method the proposed method has better tracking performance due to the robustness against uncertainties position tracking in 3 directions are given in fig 3 the corresponding tracking errors and inputs of the proposed method are shown in fig 4 in fig 4 a the tracking errors of integral pbc scheme and the proposed scheme are compared and it can be observed that the responses of integral pbc scheme is fragile to unmodeled dynamics since the proposed method can compensate for the uncertainties effectively it has faster convergence rate and better tracking accuracy than the integral pbc method from the above discussions we can see that the tracking objective of this paper is achieved and the tracking errors converge quickly which demonstrate the effectiveness of the proposed algorithm adaptive parameters ξ ˆ i and τ ˆ w are shown in fig 5 the real values of ξ i are the difference between nominal values of d 0 and real values of d in fig 5 a the red dotted lines represent the real values of ξ i and we can observe that the adaptive parameters ξ ˆ i converge to their real values eventually fig 5 b shows the estimations of external disturbances and the estimation of τ w provided by adaptive method is accurate 4 2 simulation example 2 in this case as the uuv smith 2008 shown in fig 6 we consider the 6 dof model of the uuv odin which is developed by the university of hawaii yang et al 1998 podder and sarkar 2001 the specific model will be given later and the parameters are listed in table 1 wherein i x x i y y i z z 8 π ρ v r o 5 15 simulations are conducted in 3d space the uuv is required to track a helical trajectory since odin have 8 thrusters the inputs can be determined by the total forces and the corresponding thruster distribution matrix which is also given with the model as follows m m 2 π ρ r 0 3 3 0 0 0 m b g z 0 0 m 2 π ρ r 0 3 3 0 m b g z 0 0 0 0 m 2 π ρ r 0 3 3 0 0 0 0 m b g z 0 i x x 0 0 m b g z 0 0 0 i y y 0 0 0 0 0 0 i z z c 0 0 0 m b g z r 2 m w 2 m v 0 0 0 2 m w m b g z r 2 m u 0 0 0 2 m v m b g z p 2 m u m b g z q 0 m b g z r 2 m w 2 m v m b g z p 0 i r i q 2 m w m b g z r 2 m u m b g z q i r 0 i p 2 m v 2 m u 0 i q i p 0 d d t 1 u d t 2 0 0 0 0 0 0 d t 1 v d t 2 0 0 0 0 0 0 d t 1 w d t 2 0 0 0 0 0 0 d t 3 p d t 4 0 0 0 0 0 0 d t 3 q d t 4 0 0 0 0 0 0 d t 3 r d t 4 g η 0 0 0 w b g z cos θ sin ϕ w b g z sin θ 0 b d a a a a 0 0 0 0 a a a a 0 0 0 0 0 0 0 0 1 1 1 1 0 0 0 0 r v a r v a r v a r v a 0 0 0 0 r v a r v a r v a r v a r h r h r h r h 0 0 0 0 where r v 0 381 m a sin π 4 r h 0 508 m with this thruster distribution matrix the actual inputs can be calculated using the following equation 40 u t b d b d b d 1 τ where u t r 8 is the input vector of thrusters and τ r 6 is the total input vector the model uncertainties in damping matrix are considered on d t 2 and d t 4 which gives the nominal part as d 0 d t 1 u 0 0 0 0 0 0 d t 1 v 0 0 0 0 0 0 d t 1 w 0 0 0 0 0 0 d t 3 p 0 0 0 0 0 0 d t 3 q 0 0 0 0 0 0 d t 3 r 10 0 0 0 0 0 0 10 0 0 0 0 0 0 10 0 0 0 0 0 0 100 0 0 0 0 0 0 100 0 0 0 0 0 0 100 by placing 1 at the i th diagonal element the adaptive unit matrix d i i 6 can be set the disturbances are given as 3 n 3 n 3 n 3 n m 3 n m 3 n m the desired trajectory is a helical curve with the initial position η 0 0 m 0 m 2 m 0 rad 0 rad 0 rad to conduct this simulation the initial position of the uuv is set as x 0 0 5 m 0 5 m 0 5 m 0 rad 0 2 rad 0 2 rad combining the physical meaning with the controller design the control parameters in this case are adjusted and selected as a 11 diag 3 5 1 10 5 5 a 22 diag 60 30 10 5 5 5 the parameter matrices concerning with potential and kinetic energy are set as k d diag 0 2 0 1 0 8 1 1 2 m d diag 0 8 1 5 5 0 1 1 2 the adaptive parameters compensating for unknown constant disturbances and model uncertainties are chosen as k w diag 5 5 0 2 0 2 0 2 1 k z diag 35 140 simulation results are shown from fig 7 fig 11 fig 7 shows the results of uuv tracking the desired helical trajectory under the mentioned two schemes the tracking performance can be compared intuitively from the 3d view figure and the other three both the two methods can drive the uuv to the desired trajectory compared to the integral pbc method it can be seen that with the proposed method the uuv can reach the desired trajectory quickly after running from the initial position point while the integral pbc method will drive the uuv oscillate around the desired trajectory for a long distance especially in the z axis fig 8 compares the real time states of uuv with the desired states it can be observed from the figure that the uuv will reach the desired trajectory in a short time from the beginning and then keep tracking it accurately under the proposed method while the integral pbc method has larger overshoot and longer tuning time the tacking errors are shown in fig 9 from which we can observe that the steady tracking errors of integral pbc method are relatively large while the proposed method has better tracking accuracy the corresponding thruster inputs of the proposed method are plotted in fig 10 fig 11 shows the adaptive parameters in which blue lines are estimated values of the corresponding variables provided by adaptive method while the red dashed lines represent the real values simulation results show that the estimations are accurate with all the simulation results the effectiveness of the proposed adaptive tracking controller can be demonstrated remark 5 the above two comparison simulations show that the proposed method has better performance in dealing with tracking control problem under the condition of uncertainties and unknown disturbances however the integral pbc method has its own advantages when there is only constant disturbances such as the control problem under the full knowledge of model in that case the integral pbc method has fewer tuning parameters and is easier to implement 5 conclusions in this paper we design the tracking controller using ida pbc method which can realize asymptotically tracking to address model uncertainties and external perturbations simultaneously a ph form preserving adaptive method is adopted to compensate for unmodeled dynamics and unknown disturbances the adaptive laws are designed to estimate the unknown parameters without destroying the original structure by utilizing the passivity property of the ph structure the stability can be guaranteed with explicit physical meaning finally two unmanned underwater vehicle models are used to conduct simulations the effectiveness of the proposed method is verified by simulation results which achieves the aim of addressing both the model uncertainties and disturbances simultaneously in one framework the advantages of the proposed method are shown by comparisons compared to integral pbc method the proposed scheme has faster response and better tracking accuracy credit authorship contribution statement zehua jia conceptualization methodology software writing original draft investigation writing review editing lei qiao validation investigation writing review editing weidong zhang supervision resources funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this paper is partly supported by the national natural science foundation of china 61473183 u1509211 61627810 and the national key r d program of china 2017yfe0128500 
21790,this paper addresses the tracking control problem of unmanned underwater vehicles under the condition of external disturbances and unmodeled dynamics using port hamiltonian theory by introducing port hamiltonian theory conventional uuvs dynamics can be transformed into port hamiltonian form with insightful expressions then combined with a structure preserving adaptive method unmodeled dynamics and unknown disturbances can be addressed simultaneously without destroying the interconnection structure of the hamiltonian system finally based on interconnection and damping assignment passivity based control the controller is designed in an intuitive way the dissipation property of port hamiltonian theory is utilized to prove the stability compared with other methods that come from the view of signal processing the proposed scheme has the advantages of better potential and physical interpretation of engineering applications simulations and comparisons are conducted to demonstrate the effectiveness of the proposed method keywords unmanned underwater vehicles adaptive control trajectory tracking control passivity based control port hamiltonian theory 1 introduction with more attention to ocean exploration marine techniques have been developed a long way among all the marine fields deep sea exploration is becoming a hot topic for many underwater missions such as resource exploration seafloor mapping environmental remediation and underwater terrain construction yuh 2000 qiao and zhang 2018a unmanned underwater vehicles uuvs have played an indispensable role which provide the main tools for various missions in unknown environment when performing tasks uuvs are often demanded to track given trajectories however due to the nonlinearity property modeling errors and unknown environmental perturbations the control problem of trajectory tracking is full of challenges in recent years many results of trajectory tracking in both marine and control communities have been published in li et al 2015 a 3d trajectory tracking controller was designed using cascaded backstepping technique under ideal conditions for more practical cases backstepping based projection algorithms were proposed to design the tracking controller under the presence of unknown parameters rezazadegan et al 2013 2015 sliding mode control is also a commonly used method for example qiao et al proposed a terminal sliding mode scheme to achieve the tracking objective with finite time convergence of position errors qiao and zhang 2018b besides other methods developed for trajectory tracking in marine field can be referred in do and pan 2005 li et al 2008 gan et al 2016 however these methods are mainly derived from the idea of signal processing which have the drawback of lacking physical interpretation this problem will increase the difficulty of practical engineering application also the aforementioned methods are often highly complex making the controller design difficult in fact for mechanical systems passivity based control is a good way to design the controller on the one hand compared with other nonlinear control methods passivity based control has natural robustness to uncertainties on the other hand different from other methods which come from the idea of signal processing the key point of passivity based control comes from the idea of energy van der schaft and van der schaft 2000 brogliato et al egeland since the mechanical systems follow the physical laws of energy and the dynamics of uuv is one of this type passivity based control has been applied to marine systems over the past two decades fossen astolfi et al 2002 recently port hamiltonian ph systems have attracted great attention for it can provide an in depth insight for physical systems through port hamiltonian theory complex physical systems can be described with network modeling in a geometric structure van der schaft 2006 nageshrao et al 2015 the port variables can be regarded as system input whose product represents the power grabbed from external environment ortega et al 2002 the hamiltonian function represents the total energy including kinetic and potential energy stored in the system by reshaping the hamiltonian function with desired kinetic and potential energy the desired stability can be guaranteed when regarding the closed loop hamiltonian function as the lyapunov candidate function with these advantages ph system can be designed as dissipation system under the passivity based control this good property effectively combines the design of control system with explicit physical meaning improving the acceptance and potential of this method in practical engineering applications based on port hamiltonian theory an integral stabilization control scheme was proposed for marine crafts to achieve dynamic positioning in donaire and perez 2010 considering external disturbances donaire et al designed a nonlinear set point regulation controller donaire and perez 2012 in their paper by introducing a state transformation integral action is added to eliminate the influence of constant disturbances as for the more difficult tracking problem fujimoto et al investigated the control problem using generalized canonical transformations fujimoto and sugie 2001 fujimoto et al 2003 by converting the original tracking system to a passive error system a general solution of tracking problem can be obtained nevertheless this method can only design those systems which are expressed in canonical ph form in other words for marine crafts only those models expressed in earth fixed coordinate can apply this method to expand the application of port hamiltonian theory in trajectory tracking problem a tracking controller was designed using interconnection and damping assignment passivity based ida pbc method in donaire et al 2015 with this method tracking controller can be designed in either earth fixed coordinate or body fixed frame the tracking problem in the presence of external disturbances has been investigated using ida pbc method in the port hamiltonian framework donaire et al 2017 by combing ida pbc method with integral action the control scheme called integral pbc scheme was designed with robustness against constant disturbances however all the aforementioned methods can only address external disturbances while the model uncertainty is out of the ability to solve this problem an adaptive control scheme of port hamiltonian systems was proposed to compensate for model uncertainties dirksz and scherpen 2010 2012 this method provides a way to incorporate adaptive method with port hamiltonian theory while preserving the interconnection structure with this idea tracking problems of port hamiltonian systems were investigated under the consideration of model uncertainties in qureshi et al 2015 and haddad et al 2018 however the above adaptive tracking schemes are all based on canonical transformations which have the same limitations as those in fujimoto et al 2003 motivated by aforementioned discussions we investigate the adaptive tracking problem of uuvs using port hamiltonian theory to study the system in a more intuitive and insightful way and design the controller with explicit physical interpretation we express the kinematics and dynamics of uuvs in ph form firstly by interconnection and damping assignment the system hamiltonian function is reshaped with desired kinetic and potential energy then without considering model uncertainties and external perturbations the tracking controller is designed firstly using ida pbc method and the control law is obtained by solving matching conditions to address model uncertainties and external perturbations simultaneously we propose an adaptive algorithm within the framework of hamiltonian systems the unknown constant disturbances and unmodeled dynamics can be estimated adaptively without destroying the interconnection structure of ph system based on the control law obtained the new tracking system is constructed with desired hamiltonian function concerned with all the tracking and estimation errors by regarding the closed loop hamiltonian function as the lyapunov candidate function the stability can be guaranteed easily from the dissipation property of ph system the main contributions of this paper are listed below 1 a novel tracking control algorithm is proposed for uuvs using ida pbc method and port hamiltonian theory 2 compared with other schemes using port hamiltonian theory the proposed adaptive method can address model uncertainties and external perturbations simultaneously while preserving the original interconnection structure 3 by utilizing the dissipation property of ph systems the controller is designed in an intuitive way which can provide explicit physical interpretation from the view of energy reduce the design complexity and have better potential of practical engineering applications 2 problem formulation to design the controller in port hamiltonian frame the classic model of marine crafts needs to be rewritten in the ph model before the design we briefly introduce the port hamiltonian theory first then rewrite the kinematics and dynamics in the ph form 2 1 port hamiltonian system port hamiltonian system is a result of network modeling of physical system with lumped parameters van der schaft 2006 a system can be called port hamiltonian system if it can be expressed as follows 1 x j x r x h x x t g x u y g h x x t with h x t a hamiltonian function bounded from below j x r n n is the interconnection matrix which is skew symmetric i e j j and r x r n n is a semi positive definite matrix with the symmetric property r r which represents the dissipation g x r n m is the input matrix u r m y r m are conjugated variables whose product represents the power flows grabbed from external environment these two variables are also called port variables of the system the interconnection matrix j x represents the energy exchanged inside the system while the dissipation matrix r x represents the energy dissipated by the system if the hamiltonian function is time invariant then the key property of port hamiltonian system can be seen from the following equation 2 d h d t h x x j r h x x h x x g u h x x r h x x y u from the above equation one can see that the total energy stored by the system equals the difference between the supplied energy and dissipated energy which shows the passivity property van der schaft and van der schaft 2000 if we can design the control law u β x α so that the closed loop system satisfying the following condition while preserving the ph structure 3 h d x t h d x 0 0 t α τ y τ d τ d r d t then system 1 can be stabilized at the desired point when α 0 here h d x is the desired hamiltonian function representing the total energy which has a minimum at the desired point x d r d t 0 is the dissipated energy while y is the new passive output 2 2 ph model of marine crafts in this section we consider the 6 dof model of marine craft the model of uuvs in classic form derived from fossen is expressed as 4 η j η ν m ν c ν ν d ν ν g η τ w τ c where η is the position vector ν represents the velocities in 6 dof surge sway heave roll pitch and yaw g η is the hydrostatics caused by gravity and buoyancy m is the symmetric inertia matrix with m m c is the coriolis centripetal matrix which is skew symmetric that is c c and d is a symmetric matrix denoting the damping term τ c and τ w are control input and external perturbation vectors j r 6 6 is the coordinate transformation matrix as j η j 1 η 0 3 3 0 3 3 j 2 η in the above expression 0 3 3 r 3 3 is the matrix of zeros and j i r 3 3 i 1 2 are defined as j 1 η c ψ c θ s ψ c ϕ c ψ s θ s ϕ s ψ s ϕ c ψ c ϕ s θ s ψ c θ c ψ c ϕ s ψ s θ s ϕ c ψ s ϕ s ψ c ϕ s θ s θ c θ s ϕ c θ c ϕ j 2 η 1 s ϕ t θ c ϕ t θ 0 c ϕ s ϕ 0 s ϕ c θ c ϕ c θ where c s and t represent cos sin and tan respectively in this paper as shown in fig 1 all the positions are expressed in inertial frame while the velocities are expressed in body fixed frame here η x y z ϕ θ ψ is the position and attitude vector ν u v w p q r is the linear and angular velocity vector to study the system in port hamiltonian frame we need to rewrite the model in ph form the ph model of uuvs is given as follows 5 η p 0 j j c 0 0 0 d h 0 g τ c τ w for fully actuated system the input matrix g i 6 6 h is the hamiltonian function concerned with kinetic energy and potential energy which is in the form as 6 h 1 2 p m 1 p v η v η w sin θ b g x w cos θ sin ϕ b g y w cos θ cos ϕ b g z where p m ν w m g and b g i i x y z are the distances between the center of gravity and the center of buoyancy the objective of trajectory tracking is to track a time varying path on time given a set of desired position vectors η d t we aim to design a controller using ida pbc method to achieve the objective lim t η t η d t remark 1 for neutrally buoyant underwater vehicles the term g η can be expressed as g η j η η v η fossen 2011 thus the term g η appearing in 4 is replaced by the product of j and h η in 5 remark 2 in this paper we adopt the ph model in body fixed frame and thus can keep the inertia matrix constant this choice will reduce the complexity of the control design while the inertia matrix of ph model in inertial coordinate is non constant the ph model of marine crafts in inertial coordinate can be referred in donaire et al 2017 3 design of tracking controller since the ph model shows passivity property as mentioned before it makes the passivity based method a good way to design the controller we first design the control law using ida pbc method then propose an adaptive method to compensate for model uncertainties and unknown constant disturbances while preserving the ph structure 3 1 control via interconnection and damping assignment in passivity based control theory interconnection and damping assignment method provides a way to shape both the kinetic and potential energy ortega et al 2002 by modifying the interconnection and damping matrices both the kinetic and potential energy in hamiltonian function can be reshaped and thus we can get the desired ph form under the designed control law for trajectory tracking uuvs need to track a time varying trajectory instead of a fixed point therefore forcing the tracking errors to converge to zero is the control objective for stabilization problem the desired ph form is constructed in terms of original states while for tracking problem we need to transform the original one into a new ph model in terms of tracking errors the tracking errors can be defined as 7 η η η d p p p d where η d t is the desired trajectory p d is a virtual velocity vector which will be defined later in this part we assume the disturbances are zero first consider the following ph form as the desired closed loop dynamics 8 η p a 11 a 12 a 12 a 22 h d where h d is the desired hamiltonian function with a minimum at x η p 0 0 a i i i 1 2 are negative definite matrices which are symmetric a 12 is a function valued matrix to be selected as we can see the original hamiltonian function includes kinetic energy and potential energy in this part we reshape the kinetic and potential energy as the desired form 9 h d 1 2 p m d 1 p 1 2 η k d η here m d and k d are symmetric and positive definite matrices to obtain the desired closed loop dynamics we need to modify the interconnection and damping matrices by designing the appropriate control law for the original system the kinematics equation is 10 η j m 1 p from where we can get the error dynamics easily as follows 11 η j m 1 p η d by matching equation 11 with the first row of desired dynamics 8 we can get the following matching condition 12 j m 1 p η d a 11 k d η a 12 m d 1 p since p p p d to satisfy the matching condition we define p d as 13 p d m j 1 a 11 k d η η d if we choose a 12 j m 1 m d then the above matching condition of dynamics of η is satisfied now we need to design the control law to match the corresponding condition of p the original dynamics of p is 14 p q m 1 p j η v g τ c where q c d according to equation p p p d 8 and 13 we can write the matching condition as 15 p q m 1 p p d j η v g τ c q m 1 p d m j 1 a 11 d t k d η j η v m j 1 a 11 k d η d m j 1 d t η d m j 1 η d g τ c m d m 1 j k d η a 22 m d 1 p design the control law as 16 τ c g 1 q m 1 p d m j 1 a 11 d t k d η m j 1 a 11 k d η d m j 1 d t η d j η v m j 1 η d m d m 1 j k d η a 22 m d 1 p with all the design procedures aforementioned the result can be summarized as the following theorem theorem 1 consider the system 5 with hamiltonian function 6 if the external disturbances τ w 0 a 12 is chosen as a 12 j m 1 m d p d are defined as 13 and the matrices a 11 a 22 are selected negative definite and symmetric then the system can be asymptotically stabilized at the desired trajectory under the control law 16 with k d and m d positive definite and symmetric proof substitute equations 13 and 16 into the original model 5 with the transformation 7 we can get the same closed loop dynamics as 8 since the closed loop dynamics is in ph form and the corresponding hamiltonian function is 9 we can get the following equation 17 d h d d t h d x j 1 r 1 h d x where x η p and 18 j 1 0 a 12 a 12 0 r 1 a 11 0 0 a 22 j 1 is a skew symmetric matrix r 1 is a positive definite and symmetric matrix so the above equation can be simplified as 19 d h d d t h d x r 1 h d x η k d a 11 k d η p m d 1 a 22 m d 1 p if we take the hamiltonian function h d as the lyapunov candidate function of the closed loop system then one can obtain the following inequality easily 20 d h d d t η k d a 11 k d η p m d 1 a 22 m d 1 p δ 1 η 2 2 δ 2 p 2 2 2 δ 1 δ 3 δ 3 2 η 2 2 2 δ 2 δ 4 δ 4 2 p 2 2 δ h d where δ 1 δ 2 δ 3 and δ 4 are positive constants related to eigenvalues δ 1 max λ k d a 11 k d δ 2 max λ m d 1 a 22 m d 1 δ 3 max λ k d δ 4 max λ m d 1 with a positive constant δ min δ 1 δ 2 from the inequality 20 we can conclude that the system is guaranteed asymptotically stable at the desired time varying trajectory η d p d 3 2 adaptive control under model uncertainties and constant disturbances in the previous section we design the controller for trajectory tracking however the control law is designed under the assumption that there is no external disturbance and model uncertainty in fact due to the nonlinearity of the model it is hard to get the accurate model also the persistent disturbance makes the control difficult in this section a novel adaptive method based on port hamiltonian theorem is proposed to address model uncertainties and constant perturbations simultaneously while preserving the ph form for uuvs model uncertainties mainly come from two aspects inertia uncertainties and hydrodynamic uncertainties in practical inertia uncertainties which mainly exist in matrix m and c are relatively easier to eliminate while due to the complexity of the hydrodynamics the corresponding uncertainties are more sever and harder to handle consequently the real values of matrix d which are highly related to hydrodynamic parameters cannot be identified accurately considering this kind of model uncertainties the matrix d can be expressed as 21 d ν ν m 1 p d 0 ν i 1 l ξ i d i ν ν m 1 p where d 0 is the nominal part which is known the unknown part is expressed in terms of unknown constant parameters ξ i then the control law can be expressed as 22 τ c g 1 q 0 m 1 p d m j 1 a 11 d t k d η m j 1 a 11 k d η d m j 1 d t η d j η v m j 1 η d m d m 1 j k d η a 22 m d 1 p δ ξ where 23 q 0 c d 0 δ b 1 b l ξ ξ 1 ξ l b i d i m 1 p since the control law 22 includes the unknown parameters ξ i it cannot be used when model uncertainties are taken into consideration however according to certainty equivalence principle the unknown parameters ξ i and constant disturbance vector τ w can be replaced by their estimations through adaptive method based on 22 the adaptive control signal with compensation for disturbances can be rewritten as follows 24 τ c a g 1 q 0 m 1 p d m j 1 a 11 d t k d η m j 1 a 11 k d η d m j 1 d t η d j η v m j 1 η d m d m 1 j k d η a 22 m d 1 p δ ξ ˆ g τ ˆ w where ξ ˆ τ ˆ w are estimations of ξ and τ w provided by adaptive laws the closed loop dynamics along the adaptive control law τ c a can be obtained 25 η p a 11 a 12 a 12 a 22 h d 0 δ ξ g τ ˆ w when the external perturbations in 5 are constant and τ w 0 we can write the dynamics as 26 η p a 11 a 12 a 12 a 22 h d 0 δ ξ g τ w where ξ τ w are estimation errors defined by the following equations 27 τ w τ w τ ˆ w ξ ξ ξ ˆ however the obtained dynamics is no longer in ph form considering the ph system structure property and stability we design the adaptive law as follows 28 ξ ˆ k z δ m d 1 p τ ˆ w k w g m d 1 p with k z k w positive definite and diagonal gain matrices then the extended tracking system can be obtained 29 η p ξ τ w a 11 a 12 0 0 a 12 a 22 δ k z g k w 0 k z δ 0 0 0 k w g 0 0 h d a with the corresponding hamiltonian function 30 h d a 1 2 p m d 1 p 1 2 η k d η 1 2 ξ k z 1 ξ 1 2 τ w k w 1 τ w before showing the result we firstly give the following assumption and lemma which will be used later assumption 1 the adaptive regressor δ is a non constant matrix lemma 1 barbalat s lemma khalil and grizzle 2002 let ρ t r r be a uniformly continuous function on 0 then the following property holds 31 ρ t 0 a s t when lim t 0 ρ τ d τ exists and is finite remark 3 as can be seen from 23 the regressor δ is related to velocity vector and matrix d i in practical the velocity is non constant and the product of d i and p is time varying therefore assumption 1 can be satisfied easily we will give the result of this section by the following theorem theorem 2 consider the system 5 with model uncertainties 21 if the external disturbances are constant and τ w 0 a 12 is chosen as a 12 j m 1 m d p d are defined as 13 the matrices a 11 a 22 are selected negative definite and symmetric then the control law 24 and adaptive update laws 28 with appropriate selections of k z k w m d and k d can realize asymptotic tracking of the desired trajectory proof in theorem 1 we have proved that the control law 16 can stabilize the tracking system at the desired trajectory without considering model uncertainties and external disturbances to show the preservation of the ph structure we construct the extended tracking system 32 x f x η p where x η p ξ τ w then when τ w 0 and is constant substitute adaptive control law 24 into the original tracking system we can easily get the closed loop error dynamics 26 along with the adaptive update laws 28 we can write the extended system in the ph form and therefore get the extended closed loop error dynamics as 29 with hamiltonian function 30 here 33 f j 2 r 2 h d a x a 11 a 12 0 0 a 12 a 22 δ k z g k w 0 k z δ 0 0 0 k w g 0 0 k d η m d 1 p k z 1 ξ k w 1 τ w where j 2 is the interconnection matrix and r 2 is the damping matrix as can be seen from the above equation the extended closed loop tracking error system satisfies the interconnection and dissipation structure condition take the hamiltonian function h d a as the lyapunov candidate function then the time derivative of h d a can be obtained 34 h d a h d a x f h d a x j 2 r 2 h d a x h d a x r 2 h d a x η k d a 11 k d η p m d 1 a 22 m d 1 p 0 since the lyapunov candidate function is lower bounded from zero k d m d are constant and positive definite a 11 a 22 are constant and negative definite by using barbalat s lemma lemma 1 with ρ t h d a we know that h d a 0 as t moreover h d a 0 holds if and only if both η and p are zero from the following equivalent equation 35 h d a 0 η p 0 and the fact h d a 0 we know that p η 0 as t from 29 we have 36 x j 1 r 1 h d a x g i δ ξ g τ w where g i 0 i as can be seen from the selection of j 1 and r 1 we know that the matrix j 1 r 1 is invertible with the result x 0 as t and become constant we have the following equation 37 h d a x j 1 r 1 1 g i δ ξ g τ w when x 0 as t the left hand term of 37 equals zero and the equation above becomes 38 j 1 r 1 1 g i δ ξ g τ w 0 because δ is a non constant regressor and g is constant from 38 we know that the equation holds if and only if ξ τ w 0 together with x we know that x 0 as t thereby we can conclude that the uuv will asymptotically track the desired trajectory remark 4 in previous literature donaire et al 2015 2017 the use of integral action makes the adaptive method impossible which can only address the external constant disturbance problem in dirksz and scherpen 2010 2012 they design the tracking controller using canonical transformations which will cause steady errors for regulation problem compared with the method used in dirksz and scherpen 2010 and dirksz and scherpen 2012 we adopt the ida pbc method to modify the interconnection and damping matrices which can be applied for regulation problem 4 simulation results in this section to demonstrate the effectiveness and applicability of the proposed scheme two different fully actuated models are utilized to conduct simulations in the first case the uuv is required to track a circular trajectory in horizontal plane in the second example the simulation is conducted in 3d space using another different uuv model to illustrate the advantages of the proposed method the integral pbc scheme is compared to the designed scheme 4 1 simulation example 1 in this case the uuv model in donaire and perez 2010 is adopted with the mass of 140 kg the uuv is equipped with several thrusters which can provide full actuation in the horizontal plane we only consider the motion at 3 dof in surge sway and yaw the specific model parameters are given as follows m 290 0 0 0 404 50 0 50 132 c 0 0 50 r 404 v 0 0 290 u 50 r 404 v 290 u 0 d 268 v 95 0 0 0 164 u 613 0 0 0 105 to implement the adaptive method proposed in previous section here we express the matrix d as 39 d ν ν m 1 p d 0 ν i 1 5 ξ i d i ν ν m 1 p where d 0 200 v 50 0 0 0 100 u 500 0 0 0 50 d 1 1 0 0 0 0 0 0 0 0 d 2 2 v 0 0 0 0 0 0 0 0 d 3 0 0 0 0 1 0 0 0 0 d 4 0 0 0 0 u 0 0 0 0 d 5 0 0 0 0 0 0 0 0 1 the desired trajectory is set as a circle and the initial position of the uuv is η 0 0 5 m 0 5 m 0 rad the constant external perturbation vector is given as τ w 30 n 20 n 20 n m select the control parameters as a 11 diag 1 0 5 2 a 22 diag 1 0 8 2 k d diag 0 4 0 4 0 4 and m d diag 0 2 0 05 0 2 choose the adaptive parameters as k w diag 0 3 0 2 0 2 and k z diag 50 200 30 150 15 simulations are conducted using matlab fig 2 shows the tracking result in horizontal plane as can be seen the uuv starts tracking the reference trajectory from a point with initial errors and then achieve accurate tracking under the proposed scheme while the integral pbc method cannot achieve accurate tracking which is shown by the red dashed line compared with the integral pbc method the proposed method has better tracking performance due to the robustness against uncertainties position tracking in 3 directions are given in fig 3 the corresponding tracking errors and inputs of the proposed method are shown in fig 4 in fig 4 a the tracking errors of integral pbc scheme and the proposed scheme are compared and it can be observed that the responses of integral pbc scheme is fragile to unmodeled dynamics since the proposed method can compensate for the uncertainties effectively it has faster convergence rate and better tracking accuracy than the integral pbc method from the above discussions we can see that the tracking objective of this paper is achieved and the tracking errors converge quickly which demonstrate the effectiveness of the proposed algorithm adaptive parameters ξ ˆ i and τ ˆ w are shown in fig 5 the real values of ξ i are the difference between nominal values of d 0 and real values of d in fig 5 a the red dotted lines represent the real values of ξ i and we can observe that the adaptive parameters ξ ˆ i converge to their real values eventually fig 5 b shows the estimations of external disturbances and the estimation of τ w provided by adaptive method is accurate 4 2 simulation example 2 in this case as the uuv smith 2008 shown in fig 6 we consider the 6 dof model of the uuv odin which is developed by the university of hawaii yang et al 1998 podder and sarkar 2001 the specific model will be given later and the parameters are listed in table 1 wherein i x x i y y i z z 8 π ρ v r o 5 15 simulations are conducted in 3d space the uuv is required to track a helical trajectory since odin have 8 thrusters the inputs can be determined by the total forces and the corresponding thruster distribution matrix which is also given with the model as follows m m 2 π ρ r 0 3 3 0 0 0 m b g z 0 0 m 2 π ρ r 0 3 3 0 m b g z 0 0 0 0 m 2 π ρ r 0 3 3 0 0 0 0 m b g z 0 i x x 0 0 m b g z 0 0 0 i y y 0 0 0 0 0 0 i z z c 0 0 0 m b g z r 2 m w 2 m v 0 0 0 2 m w m b g z r 2 m u 0 0 0 2 m v m b g z p 2 m u m b g z q 0 m b g z r 2 m w 2 m v m b g z p 0 i r i q 2 m w m b g z r 2 m u m b g z q i r 0 i p 2 m v 2 m u 0 i q i p 0 d d t 1 u d t 2 0 0 0 0 0 0 d t 1 v d t 2 0 0 0 0 0 0 d t 1 w d t 2 0 0 0 0 0 0 d t 3 p d t 4 0 0 0 0 0 0 d t 3 q d t 4 0 0 0 0 0 0 d t 3 r d t 4 g η 0 0 0 w b g z cos θ sin ϕ w b g z sin θ 0 b d a a a a 0 0 0 0 a a a a 0 0 0 0 0 0 0 0 1 1 1 1 0 0 0 0 r v a r v a r v a r v a 0 0 0 0 r v a r v a r v a r v a r h r h r h r h 0 0 0 0 where r v 0 381 m a sin π 4 r h 0 508 m with this thruster distribution matrix the actual inputs can be calculated using the following equation 40 u t b d b d b d 1 τ where u t r 8 is the input vector of thrusters and τ r 6 is the total input vector the model uncertainties in damping matrix are considered on d t 2 and d t 4 which gives the nominal part as d 0 d t 1 u 0 0 0 0 0 0 d t 1 v 0 0 0 0 0 0 d t 1 w 0 0 0 0 0 0 d t 3 p 0 0 0 0 0 0 d t 3 q 0 0 0 0 0 0 d t 3 r 10 0 0 0 0 0 0 10 0 0 0 0 0 0 10 0 0 0 0 0 0 100 0 0 0 0 0 0 100 0 0 0 0 0 0 100 by placing 1 at the i th diagonal element the adaptive unit matrix d i i 6 can be set the disturbances are given as 3 n 3 n 3 n 3 n m 3 n m 3 n m the desired trajectory is a helical curve with the initial position η 0 0 m 0 m 2 m 0 rad 0 rad 0 rad to conduct this simulation the initial position of the uuv is set as x 0 0 5 m 0 5 m 0 5 m 0 rad 0 2 rad 0 2 rad combining the physical meaning with the controller design the control parameters in this case are adjusted and selected as a 11 diag 3 5 1 10 5 5 a 22 diag 60 30 10 5 5 5 the parameter matrices concerning with potential and kinetic energy are set as k d diag 0 2 0 1 0 8 1 1 2 m d diag 0 8 1 5 5 0 1 1 2 the adaptive parameters compensating for unknown constant disturbances and model uncertainties are chosen as k w diag 5 5 0 2 0 2 0 2 1 k z diag 35 140 simulation results are shown from fig 7 fig 11 fig 7 shows the results of uuv tracking the desired helical trajectory under the mentioned two schemes the tracking performance can be compared intuitively from the 3d view figure and the other three both the two methods can drive the uuv to the desired trajectory compared to the integral pbc method it can be seen that with the proposed method the uuv can reach the desired trajectory quickly after running from the initial position point while the integral pbc method will drive the uuv oscillate around the desired trajectory for a long distance especially in the z axis fig 8 compares the real time states of uuv with the desired states it can be observed from the figure that the uuv will reach the desired trajectory in a short time from the beginning and then keep tracking it accurately under the proposed method while the integral pbc method has larger overshoot and longer tuning time the tacking errors are shown in fig 9 from which we can observe that the steady tracking errors of integral pbc method are relatively large while the proposed method has better tracking accuracy the corresponding thruster inputs of the proposed method are plotted in fig 10 fig 11 shows the adaptive parameters in which blue lines are estimated values of the corresponding variables provided by adaptive method while the red dashed lines represent the real values simulation results show that the estimations are accurate with all the simulation results the effectiveness of the proposed adaptive tracking controller can be demonstrated remark 5 the above two comparison simulations show that the proposed method has better performance in dealing with tracking control problem under the condition of uncertainties and unknown disturbances however the integral pbc method has its own advantages when there is only constant disturbances such as the control problem under the full knowledge of model in that case the integral pbc method has fewer tuning parameters and is easier to implement 5 conclusions in this paper we design the tracking controller using ida pbc method which can realize asymptotically tracking to address model uncertainties and external perturbations simultaneously a ph form preserving adaptive method is adopted to compensate for unmodeled dynamics and unknown disturbances the adaptive laws are designed to estimate the unknown parameters without destroying the original structure by utilizing the passivity property of the ph structure the stability can be guaranteed with explicit physical meaning finally two unmanned underwater vehicle models are used to conduct simulations the effectiveness of the proposed method is verified by simulation results which achieves the aim of addressing both the model uncertainties and disturbances simultaneously in one framework the advantages of the proposed method are shown by comparisons compared to integral pbc method the proposed scheme has faster response and better tracking accuracy credit authorship contribution statement zehua jia conceptualization methodology software writing original draft investigation writing review editing lei qiao validation investigation writing review editing weidong zhang supervision resources funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this paper is partly supported by the national natural science foundation of china 61473183 u1509211 61627810 and the national key r d program of china 2017yfe0128500 
21791,the twin vertical axis wind turbine vawt system is a high performance design in which two turbines are placed side by side with a variable gap distance in this paper the large eddy simulation and the sliding mesh technique are employed to numerically study the aerodynamic performance of the dual rotor configuration first the reliability of this cfd model is validated including computational stability analysis time step dependency study and grid convergence verification the turbine power coefficients under different tip speed ratios are calculated and results exhibit a satisfactory agreement with the available experimental data then the wind energy utilization of side by side placed twin vawts under different gap ratios and various azimuth angle shifts are investigated respectively the results reveal that compared with two isolated turbines the power coefficient of a twin turbine system has a significant enhancement moreover the paper analyzes the mechanism for obtaining gains in regard to the study of azimuth angle shifts between two adjacent turbines this paper demonstrates that the blade azimuth angles of twin vawts do not need to be synchronized the azimuth angle shift has little effect on the aerodynamic performance of the twin turbine system keywords twin vertical axis wind turbine system turbine power coefficient cfd gap ratio azimuth angle shift 1 introduction as a renewable and widely distributed clean energy resource wind energy has attracted growing attention in the past decade because of its potential use in the power generation wind power generators can be divided into two types according to the rotational direction the horizontal axis wind turbine hawt and the vertical axis wind turbine vawt the hawt has been sufficiently developed and commercialized with a high utilization rate however the hawt is challenged by the following limitations firstly it is necessary to install a steering device to maximize the swept area which leads to a complicated design in the structure secondly the blade root under high speed rotation is prone to fatigue failure resulting in high maintenance costs the vawt overcomes the above deficiencies and it performs better in turbulent flow fields however the disadvantages including the complex flow field structure the low efficiency and the difficulty in the construction of large scale turbines pose challenges to the popularity of the vawt at present it is mainly used for small scale equipment power supply and experimental study to overcome these challenges of the vawt it is essential to optimize the structural design in the process of the vawt s rotation there are vortex adhesion shedding and development in the interior fluid region hence it is intensely difficult to simulate the unsteady separated flow the computational fluid dynamics cfd method is employed to accurately capture the flow details around the turbine and efficiently calculate the aerodynamic performance the vawt has similar characteristics in all spanwise sections therefore the previous studies mainly focus on the 2d cfd model simulations and experiments lam and m dai 2009 lain and osorio 2011 almohammadi et al 2013 balduzzi et al 2017 bianchini et al 2017 mohamed 2012 employed the 2d cfd method to carry out an aerodynamic investigation on the h rotor darrieus turbine with different airfoils of 20 symmetrical and asymmetrical shapes the symmetrical airfoils output higher efficiency compared with the asymmetrical airfoils additionally the work optimizes the configuration and improves the performance of the h rotor darrieus turbine for wind energy conversion almohammadi et al 2012 applied the commercial software fluent to study the simulation sensitivities of the cell type the aspect ratio of the boundary layer on the airfoil surface the number of grids etc based on solving the unsteady reynolds average navier stokes urans equations reliable predictions of the aerodynamic performance for the vawt have been obtained raciti castelli et al 2012 compared and analyzed the aerodynamic performance of three blades four blades and five blades vawts by using a 2d solver elkhoury et al 2015 carried out experiments and numerical investigations of a 3d vawt with variable pitch and verified that the vawt s power coefficient can be accurately predicted using large eddy simulation les the results show that compared to the fixed pitch vawt the variable pitch vawt performs better in the power coefficient and the self starting ability balduzzi et al 2016 indicated that the k ω sst turbulence model is the most suitable choice for the performance predictions of the darrieus turbines based on this the paper assesses some critical parameters including a convergence criterion the domain dimension the number of elements wall y etc yang et al 2017 studied the influence of tip eddies on fluid field by observing distribution evolution and dissipation of the vortex along the airfoil profile rezaeiha et al 2018 discussed the impact of operational parameters including reynolds number tip speed ratio tsr and turbulence intensity on the turbine performance li et al 2018 used a 2d unsteady physical model to analyze the relationship between the blade angle and the output power of the vawt and it combined with the genetic algorithm to establish a variable blade pitch automatic optimization platform vbpaop that can be employed to search for the optimal blade pitches the cfd method is applied to investigate the optimization schemes for improving the power output of the vawt a two dimensional computational investigation with omni direction guide vane odgv was proposed by chong et al 2013 to determine the effects of this guide vane the results of wind tunnel experiments show that the odgv effectively improves the self starting behavior at free running condition the rotational speed is increased by 182 and the maximum torque for the odgv integrated the turbine is 3 48 times higher compared to the bare vawt shahizare et al 2016 studied the effects of eight different forms of odgvs on the flow field and vawt s output power this work further verified that installation of an odgv can indeed improve the aerodynamic performance of the turbine de marco et al 2014 investigated the potential benefits of inclined arms the wake effect and the blockage effect of the fluid region are analyzed in their work and results indicate that the turbine power coefficient has actually increased with the presence of inclined arms zuo et al 2016 studied the wake structure and the wake effects between the upstream and the downstream turbines with different distances along wind direction distribution a series of curved upstream deflectors were presented and evaluated to enhance the efficiency of the vawt by stout et al 2017 the calculation results exhibit that the installation of the deflector can result in a redirection of the fluid flow from the returning turbine blades which avoids the negative torque induced in the system wong et al 2018 carried out abundant lab tests and 3d cfd simulations to study the power augmentation around a flat plate deflector which is placed at the lower upstream with various distances of the turbine the results manifest that flat plate deflector installed at appropriate position can induce a high wind speed at the near wake region behind the deflector and further cause a higher positive torque interestingly a patent thomas 2004 concerning that a pair of vertical axis wind turbines are placed in the small gap to enhance the aerodynamic efficiency was developed in 2004 the inventors indicated that the adjacent turbine rotating in the opposite directions comes about the coupled vortex effect however the elaborate explanations were not presented then li and calisal 2010 presented a design principle of the twin turbine system with the vertical axis tidal current turbines they validated the numerical simulation based on a 3d dvm ubc model and results suggested that the total power output of a twin turbine system with the optimal layout can be about 25 higher than two times that of a stand alone turbine then li and calisal 2011 investigated the torque fluctuation of a twin turbine system with various parameters and operational conditions the results imply that the torque of an optimal twin turbine configuration fluctuates much less than that of the corresponding single turbine under the same operating conditions zanforlin and nishino 2016 performed an extensive 2d cfd analysis for two configurations with various gaps between two turbines tip speed ratios and wind directions the paper demonstrates that the change of lateral velocity in the upwind path of each turbine due to the presence of neighboring turbine makes the direction of the local flow approaching the turbine blade more profitable to generate the torque moreover the paper shows that the total power of a staggered pair of turbines cannot exceed that of a side by side pair of turbines the output power of a single darrieus vawt clusters of two co and counter rotating parallel and oblique turbines triangular three turbine clusters have been numerically investigated by shaheen and abdallah 2017 the results indicate that the dual rotor system performs better compared to the isolated turbine especially the most efficient configuration for two parallel turbines is the counter rotating case however there has a lack of explanation for the enhancement in addition many studies have been conducted to discuss the mutual interaction between two or more turbines in recent years d de tavernier et al 2018 bangga et al 2018 shaaban et al 2018 vergaerde et al 2020 jiang et al 2020 in this work a series of numerical simulations are carried out to study the development of an efficient counter rotating twin turbine system which has been demonstrated to enhance the wind power coefficient the flow field details and power coefficient increases of this twin turbine system under various gap ratios and azimuth angle shifts are investigated which is a significant supplement of the previous work zanforlin and nishino 2016 the results indicate that the performance of the dual rotor system has a remarkable improvement compared with that of two single turbines in the end some fundamental mechanisms of enhancement are discussed additionally the impact of the azimuth angle shift between two adjacent turbines on the aerodynamic performance is considered the novelty of this paper is the discovery that the azimuth angle shift between two turbines has little effect on the aerodynamic performance of the two turbine system it is worth noting that there is currently no reference to consider the influence of the azimuth angle shift 2 validation of cfd model 2 1 computational domain and solver setup 3d cfd simulations in this paper are based on the experimental data of a three blade fixed pitch vawt provided by elkhoury et al 2015 the geometric features of the investigated turbine using a symmetrical naca0018 airfoil is summarized in table 1 considering the difference between the 3d and 2d flow fields especially the influence of the blade tip vortex evolution on the accuracy of simulation solutions a 3d cfd model is employed to reveal the detailed flow characteristics around the turbine and provide an accurate assessment of the aerodynamic performance the conclusions of elkhoury et al 2015 exhibit that the effect of connecting rods on the efficiency of the wind power output can be neglected at low tip speed ratios tsr 1 0 therefore there is no connecting rods model established in our study the overview of a 3d wind turbine model is depicted in fig 1 where the notation 0 15 c 15 of the chord represents the distance from the blade leading edge to the pitching axis these calculations are conducted through using the commercial software star ccm which is based on the basic principles of computational fluid dynamics and the finite volume method automatic grid generator and unstructured tetrahedral cells are adopted moreover the sliding mesh technique is employed to bring about the turbine rotation the wind tunnel domain includes two computational domains namely the stationary domain and rotating domain and the latter is positioned inside the wind tunnel domain both the vawt s blades and the central axis are defined as the rigid bodies the rotating domain is obtained by a boolean subtraction operation of a cylinder with a radius of 0 47 m and all rigid bodies the sliding mesh technique simulates the real motion of the wind turbine by rotating of cells through the interface between the rotating domain and the external stationary domain it carries out the exchange of information between two fluid regions which is a transient method additionally refinement of the wake region is necessary the computational domain setup and two dimensional cross section grid structure is shown in fig 2 the boundary conditions of the wind tunnel domain must be defined before the numerical solution including a velocity inlet and a pressure outlet the remaining four boundaries are set as symmetry planes the rotation axis and three straight blades are specified as no slip wall boundary conditions as shown in fig 3 it should be noted that the setting of the wall boundary layer has a notable influence on the numerical results the wind velocity is set at 8 m s for all subsequent cases and the corresponding reynolds number is re 1 0213 1 0 5 the 12 near wall cell layers around the turbine are employed with the layer stretching ratio set at 1 2 and the total thickness set at 1 55 1 0 3 in this paper the large eddy simulation les with dynamic smagorinsky subgrid scale model germano et al 1991 is employed for all calculations and it is worth noting that the accuracy of this turbulence model in predicting the aerodynamic performance of the turbine has been examined in previous literature provided by elkhoury et al 2015 the maximum number of the internal iterations per time step is taken as 15 the simulations are conducted by a dual cpu workstation computer with an 56 core intel xeon e5 processor 2 6 ghz and 64 gb ram it takes about the 36 clock hours averagely for simulating the three periods of the rotary motion with the two operating cases simulated simultaneously actually we need to bear higher computational costs for lower tip speed ratios when the iteration time steps are the same for various cases 2 2 computational stability study for an unsteady solver the torque and the turbine power coefficient c p need to be discussed after the calculation attains convergence therefore it is necessary to pay attention to the computational stability a comparison for c p versus azimuthal angle between the second rotating cycle and the third cycle is shown in fig 4 it can be observed that there is a satisfactory agreement between two solutions corresponding to the 2nd period and the 3rd period the average c p values are 0 1639 and 0 1649 respectively it can be obtained that the deviation between them is only 0 6 as a consequence the calculation has reached a stable state within the 3rd rotation period 2 3 grid convergence study the employment of an appropriate quantity of grids for the calculation can not only guarantee the accuracy of the numerical solutions but also improve the efficiency in this paper the number of cells is adjusted by changing the value of the basic size of global grids three grid refinement levels are calculated with tsr 1 0 at a freestream velocity of 8 m s and the specific information of the grid number is listed in table 2 fig 5 depicts the instantaneous wind power coefficient vs azimuthal angle in one rotational period the comparison indicates that the results of the medium mesh and the fine mesh model are close to each other the value only differs by 2 37 based on the results of the fine mesh calculation which satisfies the grid convergence requirement therefore all the cases in this study employ the medium mesh model for simulation 2 4 time step dependency study on the premise of ensuring the accuracy of simulations a reasonable optimization of the time step can reduce the computational cost in general the choice of the time step size for rotation simulation depends on the time it takes for a rigid body to rotate by 1 namely δ t 1 180 ω π for example corresponding to the case of tsr 1 0 the rotation speed is ω 20 rad s hence the time step is set to be δ t 8 7266 1 0 4 s the simulation is performed at tsr 1 0 and the results are compared under the condition that the time step is the time that the rigid body rotates by 1 and 2 the corresponding time steps are δ t 8 7266 1 0 4 s and δ t 1 7453 1 0 3 s respectively the comparison of wind energy utilization curves in one cycle is shown in fig 6 it can be found that the curves of the turbine power coefficient corresponding to two time steps have a remarkable agreement for δ t 8 7266 1 0 4 s and δ t 1 7453 1 0 3 s the average c p are 0 1649 and 0 1625 respectively the discrepancy between them is 1 46 thus a large time step could satisfy the precision demand of the simulation however taking into account the need to calculate the tsr 1 0 operating conditions in order to minimize the simulation error δ t 8 7266 1 0 4 s is determined 2 5 comparison between cfd simulation and experiment in present study the average turbine power coefficient c p under various tip speed ratios from 0 2 to 1 8 are calculated as shown in fig 7 it can be found that the average c p predictions in tsr 1 2 show a close agreement with that of the experimental data provided by elkhoury et al 2015 which indicates that the present cfd method using sliding mesh technique and les turbulence model to analyze the aerodynamic performance is reliable encouragingly it should be noted that the absolute deviation between tests and numerical results is relatively large in tsr 1 2 the reason may be that the connecting rods are not considered in the simulation and the effect of strut drag and shaft interference has a growing influence on c p with the increase of tsr elkhoury et al 2015 the curves of the average c p versus tsr have a peak point at tsr 1 4 which is called stall point when tsr 1 4 the c p gradually increases with the increase of the tsr after the stall point is exceeded the c p value decreases rapidly which is same as the stall phenomenon that the rudder and other airfoil structures both incur 3 study on the twin turbine system in recent years many studies indicate that the mutual effect between vawts arranged in close proximity can enhance the power utilization of individual turbines which has been discussed in detail in the introduction in particular it is found that the most efficient configuration for two parallel vawts is the counter rotating configuration case shaaban et al 2018 in this paper numerical solutions are performed for two counter rotating turbines in parallel configuration where twin turbines are arranged side by side in a mirror image and they rotate in the opposite directions at the same speed the effects of various gap ratios and phase angles on the aerodynamic performance of the dual rotor system are mainly considered 3 1 gap ratio study the gap ratio l d is introduced to discuss the impact of different layout strategies for twin counter rotating turbines on the power output where l is the distance between centers of two wind turbines and d is the maximum rotation diameter it is undoubted that there exists the wind blockage effect of the dual rotor configuration which is analogous to that of the flow around two side by side circular cylinders nevertheless the past studies lacked discussions on the effects of different gap ratios in this paper five models at l d of 1 2 1 4 1 6 1 8 and 2 0 with tsr 1 4 are investigated to analyze the enhancement of various arrangements fig 8 shows the sketch of the cross section mesh at l d 1 2 a three dimensional q criterion iso surface colorized by vorticity for the blades is established to represent the spatial structure and temporal evolution of the vortex as depicted in fig 9 it exhibits that the rotor shaft has a extensive influence on the flow field in other words a large number of eddies separated from the three straight blades will collide with the shaft as a result the wake vortex is constantly broken down into the delicate structure furthermore the extension distance of the tip vortex along the blade rotation direction is intensely long as well as the influence of the shaft the interactions between the eddies and three blades has a remarkable impact on the tip vortex structure and the energy loss in order to clarify the enhancement the turbine power gain factor tpgf is used to assess the improvement of a twin turbine system in the power output this parameter is defined using the following equation as shown in eq 1 1 t p g f c p t n c p 1 where c p t denotes the total turbine power coefficient of twin vawts c p is turbine power coefficient of an isolated vawt n is the number of wind turbines and n 2 in present work fig 10 illustrates a comparison of wind power coefficient between a stand alone vawt and one vawt of a twin turbine system at tsr 1 4 in five gap ratios it should be noted that the power output can be improved when the twin turbines rotate synchronously besides that the average wind power coefficients and turbine power gain factors at tsr 1 4 with different gap ratios are presented in fig 11 the results demonstrate that the smaller the gap ratio is the higher the wind energy utilization will be encouragingly the turbine power gain factor can attain 18 at l d 1 2 which is a huge advancement the tpgf of average c p under the condition of various gap ratios is shown in table 3 compared with a single vawt the average c p of one vawt of the dual rotor system is highest when the gap ratio is 1 2 and the corresponding enhanced performance can be increased by 18 59 actually from the perspective of the practical engineering applications there should be sufficient safety distance between two rotors the effects of the tsr on a twin turbine system can be seen in fig 12 and table 4 it can be clearly derived that for the case with higher tsr the corresponding tpgf value is larger moreover we found that the twin turbine system performs better in the range of the relatively high tsrs with further increase in tsr the total power coefficient of the dual turbine system gradually decreases tsr 1 4 which is analogue to the variation trend of the isolated turbine 3 2 analysis of the enhanced performance to seek a cause for the power enhancement the torque generated by a stand alone blade is monitored in this study from the calculation formula of the turbine power coefficient c p is positively correlated with the torque fig 13 shows the torque curve generated by the blade no 1 in one rotation cycle where the gap ratio is 1 2 for the twin rotor system the results show that the torque generated by the blade no 1 of the isolated vawt is positive from 44 to 175 and the torque generated by the corresponding blade of the twin rotor system is positive from 44 to 186 intriguingly the latter has a wider range of forwarding torque than that of the former the forward torque generated by a blade in a dual turbine system is higher than that in the single vawt when the azimuthal angle is in the range of 67 to 214 the maximum torque of the blade no 1 is obtained at 108 at this location the side surface of the blade no 1 is almost perpendicular to the wind direction with the undisturbed oncoming freestream moreover the total torque of the turbine is mainly provided by the blade no 1 at this moment it should be noted that the absolute deviation of two configurations for the blade no 1 at 160 is the largest in this paper the center of the turbine rotation is defined as the coordinate origin accordingly the flow field is divided into two areas based on the front and back of the origin namely the windward side of the wind turbine is the upstream zone and the leeward side is the downstream zone apparently the turbine blades in the upstream region are the main generators of the torque after the blade no 1 travels to the downstream region due to the wake transferring to the downstream region and the vortex gathering this complicated and turbulent flow causes the decrease of the power output see fig 9 fig 14 shows a chorisogram of the velocity field for a single vawt and a twin turbine system with the gap ratio of 1 2 at the azimuthal angle of 108 it can be observed that some of the energy from the freestream is absorbed by the turbine which brings about a reduction of wind speed in the turbines interior and wake area with the extension of the downstream range the turbine s disturbance on the fluid region gradually decreases the pressure contours at the azimuthal angle of 108 and 160 are shown in figs 15 and 16 respectively we also provides a localized enlargement of the pressure field around blade no 1 it can be found that the pressure contours of a stand alone turbine and a twin turbine system with different gap ratios are similar to one another and the pressure discrepancy on the two sides of a blade creates positive torque the existence of a distance between two turbines causes the blockage effect which has an impact on the upstream flow field when the blade no 1 has a rotational angle of 108 it is in the upstream region compared to the isolated turbine s blade no 1 the pressure discrepancy around the boundary of twin turbines blade no 1 has a greater value and the latter contour is denser which indicates that the surrounding pressure gradient value is higher the smaller the gap ratio is the faster the pressure of the upstream flow field drops moreover it induces a higher pressure difference between the windward side and the leeward side of the blade no 1 which leads to a larger turbine power extraction coefficient the pressure distribution characteristics at a rotational angle of 160 are extensively similar to that at 108 in addition as the gap ratio increases the wind speed between the gap gradually decreases and the influence of the blockage on the upstream wind speed and pressure distribution also becomes weaker fig 17 illustrates the vector scene of the absolute velocity around the blade no 1 at 175 azimuthal angle in which the torque of the blade no 1 in the single vawt is zero and that in the twin turbine system is larger than zero it can be found from the graph that angle β the angle between the direction of flow velocity and horizontal direction on the windward side of the dual turbine system is smaller compared with that of a isolated turbine however the angle γ the angle between the direction of flow velocity and horizontal direction on the leeward side is larger both angles alter the results which leads to a positive enhancement of the torque for the blade no 1 the fundamental cause of this transformation is that the presence of neighboring turbine in the twin turbine system changes the direction of lateral freestream velocity as a matter of fact the transformation of the flow direction determines the variation of the angle of attack for the blade which is profitable to generate the positive torque additionally the presence of the adjacent turbine increases the wind speed in the vicinity of the blade and advances the intensity of surrounding vortices as can be seen in the area enclosed by the circle in fig 17 3 3 phase angle study actually it is almost impossible to keep two adjacent turbines being synchronous in actual operation owing to the complexity of the wind field currently there is no literature to discuss the influence of the azimuth angle shift between two turbines on the aerodynamic performance the twin vawts are not completely mirrored during the rotary process and the blade azimuth phase angle φ refers to a stagger angle between two turbines namely the angle shift of two turbines in order to illustrate the effect of the angle shifts on the aerodynamic performances of a twin turbine configuration a series of cases in which two vawts are arranged with different phase angles from 0 to 120 with an interval of 10 are calculated under the condition that tsr 1 4 and l d 1 2 fig 18 shows the sketch of a dual turbine system with various phase angles where phase angles are 0 30 60 and 90 respectively the simulation predictions of the average wind power coefficient for a twin turbine system at different phase angles are shown in fig 19 the results manifest that the total wind power utilization of the two turbine system with 60 phase angle is the highest nevertheless it is only increased by 1 19 compared with that of the case of 0 phase angle arranged in a mirror image therefore the phase angle has little impact on the turbine power coefficient of twin vawts and it does not significantly improve or worsen their ability to extract wind energy from the above discussions a critical conclusion can be found that the change of the phase angle of one turbine located in the twin turbine system has a relatively small influence on the vicinity flow field furthermore the enhancement of power output for a dual turbine configuration is mainly determined by the gap distance regardless of the instantaneous position of each blade in this system 4 conclusions in this paper the proposed cfd numerical model is validated on calculating the aerodynamic performance of the vertical axis wind turbine and applied to analysis of flow around twin counter rotating turbines to identify the local flow mechanisms contributing to their enhanced power output compared to a stand alone vawt the influences of various gap ratios and blade azimuth shifts between two turbines on the efficiency of the wind power generation are investigated it can be concluded as follows 1 the aerodynamic performance can be improved when the twin vawts is arranged side by side the counter rotating arrangement of a pair of turbines alters the incident flow field results in a higher pressure difference between the windward and the leeward sides of the blade and creates a larger driving torque on the turbines additionally we found the primary reason of this change is that the presence of neighboring turbine in the twin turbine system changes the direction of lateral freestream as the matter of fact the change of the direction of flow causes the change of the angle of attack for blade which is propitious to generate the positive torque 2 a smaller gap between two turbines can induce a larger turbine power extraction coefficient the turbine power gain factor can reach 18 the simulation of zanforlin and nishino 2016 is based on a two dimensional numerical model and the effects of various gap ratios of two side by side turbines are not studied in this paper further investigation are therefore carried out by using three dimensional simulation which is a significant development of the previous work 3 the blade azimuth angles of twin vawts do not need to be synchronized at the same rotational speed the azimuth angle shift has little effect on the aerodynamic performance of a dual turbine system it should be noted that this novel conclusion has not been previously mentioned in the literature nomenclature parameters meaning c chord length of blade m c p turbine power coefficient t ω ρ r h v w i n d 3 c p t turbine power coefficient of twin vawts d turbine diameter m d r rotating domain diameter m d s rotor s shaft diameter m h blade span length m l distance between the centers of two vawts m l d gap ratio n number of wind turbines 2 in present work n number of blades 3 in present work r turbine radius m r e reynolds number v w i n d c ν t turbine torque n m t s r tip speed ratio r ω v w i n d t p g f turbine power gain factor c p t n c p 1 v w i n d wind speed m s ν kinematic viscosity m 2 s ω rotate speed rad s α azimuthal angle θ blade pitch φ phase angle σ solidity n c d ρ air density kg m 3 credit authorship contribution statement guoqing jin software validation formal analysis zhi zong investigation writing review editing data curation yichen jiang resources writing review editing formal analysis li zou conceptualization methodology software supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the present work is supported by qingdao national laboratory for marine science and technology china qnlm2016orp0402 defense industrial technology development program china sxjqr2018wdkt02 the state key laboratory of structural analysis for industrial equipment china s18408 the national natural science foundation of china 51975032 51939003 the authors would like to thank their support 
21791,the twin vertical axis wind turbine vawt system is a high performance design in which two turbines are placed side by side with a variable gap distance in this paper the large eddy simulation and the sliding mesh technique are employed to numerically study the aerodynamic performance of the dual rotor configuration first the reliability of this cfd model is validated including computational stability analysis time step dependency study and grid convergence verification the turbine power coefficients under different tip speed ratios are calculated and results exhibit a satisfactory agreement with the available experimental data then the wind energy utilization of side by side placed twin vawts under different gap ratios and various azimuth angle shifts are investigated respectively the results reveal that compared with two isolated turbines the power coefficient of a twin turbine system has a significant enhancement moreover the paper analyzes the mechanism for obtaining gains in regard to the study of azimuth angle shifts between two adjacent turbines this paper demonstrates that the blade azimuth angles of twin vawts do not need to be synchronized the azimuth angle shift has little effect on the aerodynamic performance of the twin turbine system keywords twin vertical axis wind turbine system turbine power coefficient cfd gap ratio azimuth angle shift 1 introduction as a renewable and widely distributed clean energy resource wind energy has attracted growing attention in the past decade because of its potential use in the power generation wind power generators can be divided into two types according to the rotational direction the horizontal axis wind turbine hawt and the vertical axis wind turbine vawt the hawt has been sufficiently developed and commercialized with a high utilization rate however the hawt is challenged by the following limitations firstly it is necessary to install a steering device to maximize the swept area which leads to a complicated design in the structure secondly the blade root under high speed rotation is prone to fatigue failure resulting in high maintenance costs the vawt overcomes the above deficiencies and it performs better in turbulent flow fields however the disadvantages including the complex flow field structure the low efficiency and the difficulty in the construction of large scale turbines pose challenges to the popularity of the vawt at present it is mainly used for small scale equipment power supply and experimental study to overcome these challenges of the vawt it is essential to optimize the structural design in the process of the vawt s rotation there are vortex adhesion shedding and development in the interior fluid region hence it is intensely difficult to simulate the unsteady separated flow the computational fluid dynamics cfd method is employed to accurately capture the flow details around the turbine and efficiently calculate the aerodynamic performance the vawt has similar characteristics in all spanwise sections therefore the previous studies mainly focus on the 2d cfd model simulations and experiments lam and m dai 2009 lain and osorio 2011 almohammadi et al 2013 balduzzi et al 2017 bianchini et al 2017 mohamed 2012 employed the 2d cfd method to carry out an aerodynamic investigation on the h rotor darrieus turbine with different airfoils of 20 symmetrical and asymmetrical shapes the symmetrical airfoils output higher efficiency compared with the asymmetrical airfoils additionally the work optimizes the configuration and improves the performance of the h rotor darrieus turbine for wind energy conversion almohammadi et al 2012 applied the commercial software fluent to study the simulation sensitivities of the cell type the aspect ratio of the boundary layer on the airfoil surface the number of grids etc based on solving the unsteady reynolds average navier stokes urans equations reliable predictions of the aerodynamic performance for the vawt have been obtained raciti castelli et al 2012 compared and analyzed the aerodynamic performance of three blades four blades and five blades vawts by using a 2d solver elkhoury et al 2015 carried out experiments and numerical investigations of a 3d vawt with variable pitch and verified that the vawt s power coefficient can be accurately predicted using large eddy simulation les the results show that compared to the fixed pitch vawt the variable pitch vawt performs better in the power coefficient and the self starting ability balduzzi et al 2016 indicated that the k ω sst turbulence model is the most suitable choice for the performance predictions of the darrieus turbines based on this the paper assesses some critical parameters including a convergence criterion the domain dimension the number of elements wall y etc yang et al 2017 studied the influence of tip eddies on fluid field by observing distribution evolution and dissipation of the vortex along the airfoil profile rezaeiha et al 2018 discussed the impact of operational parameters including reynolds number tip speed ratio tsr and turbulence intensity on the turbine performance li et al 2018 used a 2d unsteady physical model to analyze the relationship between the blade angle and the output power of the vawt and it combined with the genetic algorithm to establish a variable blade pitch automatic optimization platform vbpaop that can be employed to search for the optimal blade pitches the cfd method is applied to investigate the optimization schemes for improving the power output of the vawt a two dimensional computational investigation with omni direction guide vane odgv was proposed by chong et al 2013 to determine the effects of this guide vane the results of wind tunnel experiments show that the odgv effectively improves the self starting behavior at free running condition the rotational speed is increased by 182 and the maximum torque for the odgv integrated the turbine is 3 48 times higher compared to the bare vawt shahizare et al 2016 studied the effects of eight different forms of odgvs on the flow field and vawt s output power this work further verified that installation of an odgv can indeed improve the aerodynamic performance of the turbine de marco et al 2014 investigated the potential benefits of inclined arms the wake effect and the blockage effect of the fluid region are analyzed in their work and results indicate that the turbine power coefficient has actually increased with the presence of inclined arms zuo et al 2016 studied the wake structure and the wake effects between the upstream and the downstream turbines with different distances along wind direction distribution a series of curved upstream deflectors were presented and evaluated to enhance the efficiency of the vawt by stout et al 2017 the calculation results exhibit that the installation of the deflector can result in a redirection of the fluid flow from the returning turbine blades which avoids the negative torque induced in the system wong et al 2018 carried out abundant lab tests and 3d cfd simulations to study the power augmentation around a flat plate deflector which is placed at the lower upstream with various distances of the turbine the results manifest that flat plate deflector installed at appropriate position can induce a high wind speed at the near wake region behind the deflector and further cause a higher positive torque interestingly a patent thomas 2004 concerning that a pair of vertical axis wind turbines are placed in the small gap to enhance the aerodynamic efficiency was developed in 2004 the inventors indicated that the adjacent turbine rotating in the opposite directions comes about the coupled vortex effect however the elaborate explanations were not presented then li and calisal 2010 presented a design principle of the twin turbine system with the vertical axis tidal current turbines they validated the numerical simulation based on a 3d dvm ubc model and results suggested that the total power output of a twin turbine system with the optimal layout can be about 25 higher than two times that of a stand alone turbine then li and calisal 2011 investigated the torque fluctuation of a twin turbine system with various parameters and operational conditions the results imply that the torque of an optimal twin turbine configuration fluctuates much less than that of the corresponding single turbine under the same operating conditions zanforlin and nishino 2016 performed an extensive 2d cfd analysis for two configurations with various gaps between two turbines tip speed ratios and wind directions the paper demonstrates that the change of lateral velocity in the upwind path of each turbine due to the presence of neighboring turbine makes the direction of the local flow approaching the turbine blade more profitable to generate the torque moreover the paper shows that the total power of a staggered pair of turbines cannot exceed that of a side by side pair of turbines the output power of a single darrieus vawt clusters of two co and counter rotating parallel and oblique turbines triangular three turbine clusters have been numerically investigated by shaheen and abdallah 2017 the results indicate that the dual rotor system performs better compared to the isolated turbine especially the most efficient configuration for two parallel turbines is the counter rotating case however there has a lack of explanation for the enhancement in addition many studies have been conducted to discuss the mutual interaction between two or more turbines in recent years d de tavernier et al 2018 bangga et al 2018 shaaban et al 2018 vergaerde et al 2020 jiang et al 2020 in this work a series of numerical simulations are carried out to study the development of an efficient counter rotating twin turbine system which has been demonstrated to enhance the wind power coefficient the flow field details and power coefficient increases of this twin turbine system under various gap ratios and azimuth angle shifts are investigated which is a significant supplement of the previous work zanforlin and nishino 2016 the results indicate that the performance of the dual rotor system has a remarkable improvement compared with that of two single turbines in the end some fundamental mechanisms of enhancement are discussed additionally the impact of the azimuth angle shift between two adjacent turbines on the aerodynamic performance is considered the novelty of this paper is the discovery that the azimuth angle shift between two turbines has little effect on the aerodynamic performance of the two turbine system it is worth noting that there is currently no reference to consider the influence of the azimuth angle shift 2 validation of cfd model 2 1 computational domain and solver setup 3d cfd simulations in this paper are based on the experimental data of a three blade fixed pitch vawt provided by elkhoury et al 2015 the geometric features of the investigated turbine using a symmetrical naca0018 airfoil is summarized in table 1 considering the difference between the 3d and 2d flow fields especially the influence of the blade tip vortex evolution on the accuracy of simulation solutions a 3d cfd model is employed to reveal the detailed flow characteristics around the turbine and provide an accurate assessment of the aerodynamic performance the conclusions of elkhoury et al 2015 exhibit that the effect of connecting rods on the efficiency of the wind power output can be neglected at low tip speed ratios tsr 1 0 therefore there is no connecting rods model established in our study the overview of a 3d wind turbine model is depicted in fig 1 where the notation 0 15 c 15 of the chord represents the distance from the blade leading edge to the pitching axis these calculations are conducted through using the commercial software star ccm which is based on the basic principles of computational fluid dynamics and the finite volume method automatic grid generator and unstructured tetrahedral cells are adopted moreover the sliding mesh technique is employed to bring about the turbine rotation the wind tunnel domain includes two computational domains namely the stationary domain and rotating domain and the latter is positioned inside the wind tunnel domain both the vawt s blades and the central axis are defined as the rigid bodies the rotating domain is obtained by a boolean subtraction operation of a cylinder with a radius of 0 47 m and all rigid bodies the sliding mesh technique simulates the real motion of the wind turbine by rotating of cells through the interface between the rotating domain and the external stationary domain it carries out the exchange of information between two fluid regions which is a transient method additionally refinement of the wake region is necessary the computational domain setup and two dimensional cross section grid structure is shown in fig 2 the boundary conditions of the wind tunnel domain must be defined before the numerical solution including a velocity inlet and a pressure outlet the remaining four boundaries are set as symmetry planes the rotation axis and three straight blades are specified as no slip wall boundary conditions as shown in fig 3 it should be noted that the setting of the wall boundary layer has a notable influence on the numerical results the wind velocity is set at 8 m s for all subsequent cases and the corresponding reynolds number is re 1 0213 1 0 5 the 12 near wall cell layers around the turbine are employed with the layer stretching ratio set at 1 2 and the total thickness set at 1 55 1 0 3 in this paper the large eddy simulation les with dynamic smagorinsky subgrid scale model germano et al 1991 is employed for all calculations and it is worth noting that the accuracy of this turbulence model in predicting the aerodynamic performance of the turbine has been examined in previous literature provided by elkhoury et al 2015 the maximum number of the internal iterations per time step is taken as 15 the simulations are conducted by a dual cpu workstation computer with an 56 core intel xeon e5 processor 2 6 ghz and 64 gb ram it takes about the 36 clock hours averagely for simulating the three periods of the rotary motion with the two operating cases simulated simultaneously actually we need to bear higher computational costs for lower tip speed ratios when the iteration time steps are the same for various cases 2 2 computational stability study for an unsteady solver the torque and the turbine power coefficient c p need to be discussed after the calculation attains convergence therefore it is necessary to pay attention to the computational stability a comparison for c p versus azimuthal angle between the second rotating cycle and the third cycle is shown in fig 4 it can be observed that there is a satisfactory agreement between two solutions corresponding to the 2nd period and the 3rd period the average c p values are 0 1639 and 0 1649 respectively it can be obtained that the deviation between them is only 0 6 as a consequence the calculation has reached a stable state within the 3rd rotation period 2 3 grid convergence study the employment of an appropriate quantity of grids for the calculation can not only guarantee the accuracy of the numerical solutions but also improve the efficiency in this paper the number of cells is adjusted by changing the value of the basic size of global grids three grid refinement levels are calculated with tsr 1 0 at a freestream velocity of 8 m s and the specific information of the grid number is listed in table 2 fig 5 depicts the instantaneous wind power coefficient vs azimuthal angle in one rotational period the comparison indicates that the results of the medium mesh and the fine mesh model are close to each other the value only differs by 2 37 based on the results of the fine mesh calculation which satisfies the grid convergence requirement therefore all the cases in this study employ the medium mesh model for simulation 2 4 time step dependency study on the premise of ensuring the accuracy of simulations a reasonable optimization of the time step can reduce the computational cost in general the choice of the time step size for rotation simulation depends on the time it takes for a rigid body to rotate by 1 namely δ t 1 180 ω π for example corresponding to the case of tsr 1 0 the rotation speed is ω 20 rad s hence the time step is set to be δ t 8 7266 1 0 4 s the simulation is performed at tsr 1 0 and the results are compared under the condition that the time step is the time that the rigid body rotates by 1 and 2 the corresponding time steps are δ t 8 7266 1 0 4 s and δ t 1 7453 1 0 3 s respectively the comparison of wind energy utilization curves in one cycle is shown in fig 6 it can be found that the curves of the turbine power coefficient corresponding to two time steps have a remarkable agreement for δ t 8 7266 1 0 4 s and δ t 1 7453 1 0 3 s the average c p are 0 1649 and 0 1625 respectively the discrepancy between them is 1 46 thus a large time step could satisfy the precision demand of the simulation however taking into account the need to calculate the tsr 1 0 operating conditions in order to minimize the simulation error δ t 8 7266 1 0 4 s is determined 2 5 comparison between cfd simulation and experiment in present study the average turbine power coefficient c p under various tip speed ratios from 0 2 to 1 8 are calculated as shown in fig 7 it can be found that the average c p predictions in tsr 1 2 show a close agreement with that of the experimental data provided by elkhoury et al 2015 which indicates that the present cfd method using sliding mesh technique and les turbulence model to analyze the aerodynamic performance is reliable encouragingly it should be noted that the absolute deviation between tests and numerical results is relatively large in tsr 1 2 the reason may be that the connecting rods are not considered in the simulation and the effect of strut drag and shaft interference has a growing influence on c p with the increase of tsr elkhoury et al 2015 the curves of the average c p versus tsr have a peak point at tsr 1 4 which is called stall point when tsr 1 4 the c p gradually increases with the increase of the tsr after the stall point is exceeded the c p value decreases rapidly which is same as the stall phenomenon that the rudder and other airfoil structures both incur 3 study on the twin turbine system in recent years many studies indicate that the mutual effect between vawts arranged in close proximity can enhance the power utilization of individual turbines which has been discussed in detail in the introduction in particular it is found that the most efficient configuration for two parallel vawts is the counter rotating configuration case shaaban et al 2018 in this paper numerical solutions are performed for two counter rotating turbines in parallel configuration where twin turbines are arranged side by side in a mirror image and they rotate in the opposite directions at the same speed the effects of various gap ratios and phase angles on the aerodynamic performance of the dual rotor system are mainly considered 3 1 gap ratio study the gap ratio l d is introduced to discuss the impact of different layout strategies for twin counter rotating turbines on the power output where l is the distance between centers of two wind turbines and d is the maximum rotation diameter it is undoubted that there exists the wind blockage effect of the dual rotor configuration which is analogous to that of the flow around two side by side circular cylinders nevertheless the past studies lacked discussions on the effects of different gap ratios in this paper five models at l d of 1 2 1 4 1 6 1 8 and 2 0 with tsr 1 4 are investigated to analyze the enhancement of various arrangements fig 8 shows the sketch of the cross section mesh at l d 1 2 a three dimensional q criterion iso surface colorized by vorticity for the blades is established to represent the spatial structure and temporal evolution of the vortex as depicted in fig 9 it exhibits that the rotor shaft has a extensive influence on the flow field in other words a large number of eddies separated from the three straight blades will collide with the shaft as a result the wake vortex is constantly broken down into the delicate structure furthermore the extension distance of the tip vortex along the blade rotation direction is intensely long as well as the influence of the shaft the interactions between the eddies and three blades has a remarkable impact on the tip vortex structure and the energy loss in order to clarify the enhancement the turbine power gain factor tpgf is used to assess the improvement of a twin turbine system in the power output this parameter is defined using the following equation as shown in eq 1 1 t p g f c p t n c p 1 where c p t denotes the total turbine power coefficient of twin vawts c p is turbine power coefficient of an isolated vawt n is the number of wind turbines and n 2 in present work fig 10 illustrates a comparison of wind power coefficient between a stand alone vawt and one vawt of a twin turbine system at tsr 1 4 in five gap ratios it should be noted that the power output can be improved when the twin turbines rotate synchronously besides that the average wind power coefficients and turbine power gain factors at tsr 1 4 with different gap ratios are presented in fig 11 the results demonstrate that the smaller the gap ratio is the higher the wind energy utilization will be encouragingly the turbine power gain factor can attain 18 at l d 1 2 which is a huge advancement the tpgf of average c p under the condition of various gap ratios is shown in table 3 compared with a single vawt the average c p of one vawt of the dual rotor system is highest when the gap ratio is 1 2 and the corresponding enhanced performance can be increased by 18 59 actually from the perspective of the practical engineering applications there should be sufficient safety distance between two rotors the effects of the tsr on a twin turbine system can be seen in fig 12 and table 4 it can be clearly derived that for the case with higher tsr the corresponding tpgf value is larger moreover we found that the twin turbine system performs better in the range of the relatively high tsrs with further increase in tsr the total power coefficient of the dual turbine system gradually decreases tsr 1 4 which is analogue to the variation trend of the isolated turbine 3 2 analysis of the enhanced performance to seek a cause for the power enhancement the torque generated by a stand alone blade is monitored in this study from the calculation formula of the turbine power coefficient c p is positively correlated with the torque fig 13 shows the torque curve generated by the blade no 1 in one rotation cycle where the gap ratio is 1 2 for the twin rotor system the results show that the torque generated by the blade no 1 of the isolated vawt is positive from 44 to 175 and the torque generated by the corresponding blade of the twin rotor system is positive from 44 to 186 intriguingly the latter has a wider range of forwarding torque than that of the former the forward torque generated by a blade in a dual turbine system is higher than that in the single vawt when the azimuthal angle is in the range of 67 to 214 the maximum torque of the blade no 1 is obtained at 108 at this location the side surface of the blade no 1 is almost perpendicular to the wind direction with the undisturbed oncoming freestream moreover the total torque of the turbine is mainly provided by the blade no 1 at this moment it should be noted that the absolute deviation of two configurations for the blade no 1 at 160 is the largest in this paper the center of the turbine rotation is defined as the coordinate origin accordingly the flow field is divided into two areas based on the front and back of the origin namely the windward side of the wind turbine is the upstream zone and the leeward side is the downstream zone apparently the turbine blades in the upstream region are the main generators of the torque after the blade no 1 travels to the downstream region due to the wake transferring to the downstream region and the vortex gathering this complicated and turbulent flow causes the decrease of the power output see fig 9 fig 14 shows a chorisogram of the velocity field for a single vawt and a twin turbine system with the gap ratio of 1 2 at the azimuthal angle of 108 it can be observed that some of the energy from the freestream is absorbed by the turbine which brings about a reduction of wind speed in the turbines interior and wake area with the extension of the downstream range the turbine s disturbance on the fluid region gradually decreases the pressure contours at the azimuthal angle of 108 and 160 are shown in figs 15 and 16 respectively we also provides a localized enlargement of the pressure field around blade no 1 it can be found that the pressure contours of a stand alone turbine and a twin turbine system with different gap ratios are similar to one another and the pressure discrepancy on the two sides of a blade creates positive torque the existence of a distance between two turbines causes the blockage effect which has an impact on the upstream flow field when the blade no 1 has a rotational angle of 108 it is in the upstream region compared to the isolated turbine s blade no 1 the pressure discrepancy around the boundary of twin turbines blade no 1 has a greater value and the latter contour is denser which indicates that the surrounding pressure gradient value is higher the smaller the gap ratio is the faster the pressure of the upstream flow field drops moreover it induces a higher pressure difference between the windward side and the leeward side of the blade no 1 which leads to a larger turbine power extraction coefficient the pressure distribution characteristics at a rotational angle of 160 are extensively similar to that at 108 in addition as the gap ratio increases the wind speed between the gap gradually decreases and the influence of the blockage on the upstream wind speed and pressure distribution also becomes weaker fig 17 illustrates the vector scene of the absolute velocity around the blade no 1 at 175 azimuthal angle in which the torque of the blade no 1 in the single vawt is zero and that in the twin turbine system is larger than zero it can be found from the graph that angle β the angle between the direction of flow velocity and horizontal direction on the windward side of the dual turbine system is smaller compared with that of a isolated turbine however the angle γ the angle between the direction of flow velocity and horizontal direction on the leeward side is larger both angles alter the results which leads to a positive enhancement of the torque for the blade no 1 the fundamental cause of this transformation is that the presence of neighboring turbine in the twin turbine system changes the direction of lateral freestream velocity as a matter of fact the transformation of the flow direction determines the variation of the angle of attack for the blade which is profitable to generate the positive torque additionally the presence of the adjacent turbine increases the wind speed in the vicinity of the blade and advances the intensity of surrounding vortices as can be seen in the area enclosed by the circle in fig 17 3 3 phase angle study actually it is almost impossible to keep two adjacent turbines being synchronous in actual operation owing to the complexity of the wind field currently there is no literature to discuss the influence of the azimuth angle shift between two turbines on the aerodynamic performance the twin vawts are not completely mirrored during the rotary process and the blade azimuth phase angle φ refers to a stagger angle between two turbines namely the angle shift of two turbines in order to illustrate the effect of the angle shifts on the aerodynamic performances of a twin turbine configuration a series of cases in which two vawts are arranged with different phase angles from 0 to 120 with an interval of 10 are calculated under the condition that tsr 1 4 and l d 1 2 fig 18 shows the sketch of a dual turbine system with various phase angles where phase angles are 0 30 60 and 90 respectively the simulation predictions of the average wind power coefficient for a twin turbine system at different phase angles are shown in fig 19 the results manifest that the total wind power utilization of the two turbine system with 60 phase angle is the highest nevertheless it is only increased by 1 19 compared with that of the case of 0 phase angle arranged in a mirror image therefore the phase angle has little impact on the turbine power coefficient of twin vawts and it does not significantly improve or worsen their ability to extract wind energy from the above discussions a critical conclusion can be found that the change of the phase angle of one turbine located in the twin turbine system has a relatively small influence on the vicinity flow field furthermore the enhancement of power output for a dual turbine configuration is mainly determined by the gap distance regardless of the instantaneous position of each blade in this system 4 conclusions in this paper the proposed cfd numerical model is validated on calculating the aerodynamic performance of the vertical axis wind turbine and applied to analysis of flow around twin counter rotating turbines to identify the local flow mechanisms contributing to their enhanced power output compared to a stand alone vawt the influences of various gap ratios and blade azimuth shifts between two turbines on the efficiency of the wind power generation are investigated it can be concluded as follows 1 the aerodynamic performance can be improved when the twin vawts is arranged side by side the counter rotating arrangement of a pair of turbines alters the incident flow field results in a higher pressure difference between the windward and the leeward sides of the blade and creates a larger driving torque on the turbines additionally we found the primary reason of this change is that the presence of neighboring turbine in the twin turbine system changes the direction of lateral freestream as the matter of fact the change of the direction of flow causes the change of the angle of attack for blade which is propitious to generate the positive torque 2 a smaller gap between two turbines can induce a larger turbine power extraction coefficient the turbine power gain factor can reach 18 the simulation of zanforlin and nishino 2016 is based on a two dimensional numerical model and the effects of various gap ratios of two side by side turbines are not studied in this paper further investigation are therefore carried out by using three dimensional simulation which is a significant development of the previous work 3 the blade azimuth angles of twin vawts do not need to be synchronized at the same rotational speed the azimuth angle shift has little effect on the aerodynamic performance of a dual turbine system it should be noted that this novel conclusion has not been previously mentioned in the literature nomenclature parameters meaning c chord length of blade m c p turbine power coefficient t ω ρ r h v w i n d 3 c p t turbine power coefficient of twin vawts d turbine diameter m d r rotating domain diameter m d s rotor s shaft diameter m h blade span length m l distance between the centers of two vawts m l d gap ratio n number of wind turbines 2 in present work n number of blades 3 in present work r turbine radius m r e reynolds number v w i n d c ν t turbine torque n m t s r tip speed ratio r ω v w i n d t p g f turbine power gain factor c p t n c p 1 v w i n d wind speed m s ν kinematic viscosity m 2 s ω rotate speed rad s α azimuthal angle θ blade pitch φ phase angle σ solidity n c d ρ air density kg m 3 credit authorship contribution statement guoqing jin software validation formal analysis zhi zong investigation writing review editing data curation yichen jiang resources writing review editing formal analysis li zou conceptualization methodology software supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the present work is supported by qingdao national laboratory for marine science and technology china qnlm2016orp0402 defense industrial technology development program china sxjqr2018wdkt02 the state key laboratory of structural analysis for industrial equipment china s18408 the national natural science foundation of china 51975032 51939003 the authors would like to thank their support 
21792,in this paper solitary wave induced vertical and horizontal forces on coastal bridges are investigated by laboratory experiments as well as computational fluid dynamics cfd analysis the effects of different parameters e g water depths submergence depths wave heights on wave induced force on a 1 30 scale bridge model are studied specifically the models of deck with and without girders are tested to explore the effects of girders and trapped air on structural response it is demonstrated with the collected experimental data that girders can increase the wave loads acting on decks and the trapped air makes the structure more unstable additionally a secondary impact may occur due to the bluff profile of girders subsequently based on solitary wave theory and experimental data a linear relationship is quantified between wave forces and wave steepness following the experiments numerical analysis using both two dimensional 2d and three dimensional 3d models is conducted to assess vertical and horizontal forces the comparisons between experimental study and numerical computation indicate that the 2d model can well assess most of the cases for deck without girders but fails to simulate accurate results for deck with girders indicating that 2d model cannot deal with complex interactions among wave structure and trapped air the 3d model can obtain more accurate wave forces and better capture the detailed characteristics of solitary wave forces with the information presented in this study it can aid the design and management of coastal structures under hurricane and tsunami loads keywords coastal bridges solitary wave experiments numerical analysis wave forces 3d model 1 introduction based on historical data extreme waves caused by hurricanes and tsunamis could lead to significant adverse damages to our coastal community for instance hurricane isabel 2003 struck north carolina and virginia coastline resulting in 17 deaths and more than 3 billion dollars in damages the indonesia tsunami 2004 destroyed many structures along the coast leading to approximately 1200 deaths with respect to the coastal bridges especially for the low lying ones they are vulnerable to the storm surge and wave induced forces and could result in severe damage and failure padgett et al 2008 xu et al 2016a li et al 2020 considering climate change increasing sea level rise and amplification of hazard intensity it demonstrates an urgent need for deeper understanding on failure mechanisms of coastal bridges and preparing for future disasters dong and frangopol 2017 frangopol et al 2017 douglass et al 2004 robertson et al 2007a padgett et al 2008 and okeil and cai 2008 conducted studies on the damage assessment of coastal bridges during hurricane ivan and hurricane katrina and accordingly one of the major failure modes of bridges under extreme waves is the unseating of deck akiyama et al 2012 kosa 2011 bricker and nakayama 2014 robertson et al 2007b the total load on bridge superstructure consists of hydrodynamic and hydrostatic forces caused by large waves and the short duration shock force caused by the trapped air between girders and deck azadbakht et al 2016 hayatdavoodi et al 2014 hayatdavoodi and ertekin 2016 seiffert et al 2014b the combination of these forces can overcome the weight of the superstructure and lead to the connection failure and thus the bridge deck is unseated from the substructure ataei and padgett 2012 however the way that the wave forces work is complicated and affected by many parameters including wavelength period wave height celerity and frequency as well as the structural profile fang et al 2019b in addition the prototype scale wave forces could only be estimated for scenarios with no trapped air or air fully trapped between girders seiffert et al 2015 therefore it is important to conduct further research on wave effects and structural response under solitary waves due to the complexity of wave structure interaction laboratory experiment should also be conducted to explore wave forces guo et al 2016 fang et al 2019a huang et al 2019b although there were some laboratory tests focusing on the wave forces on coastal platforms and harbor wharfs french 1970 lee and lai 1987 boccotti 1995 huseby and grue 2000 few studies investigated the impact of wave loads on bridge decks crowley et al 2018 and james et al 2015 compared test data of wave loads on bridge decks with existing analytical method associated with coastal platforms they concluded that the established method for platforms cannot be used for bridges bradner et al 2011 conducted an experiment of a 1 5 scale bridge model to measure wave forces under regular and random waves observing a second order relationship between force and wave height cuomo et al 2009 experimentally investigated the quasi static wave force and impulsive force on the bridge and proved the significance of trapped air mcpherson 2008 conducted the experimental studies using a large scale 3d wave basin and compared experimental data with analytical results it was concluded that existing prediction equations cannot sufficiently predict the measured forces guo et al 2015a investigated wave forces acting on superstructure of coastal bridges under regular waves and the experimental results were compared with the analytical results as well this series of experiments laid the foundation for later research and explained some qualitative relationships for such phenomenon due to the diversity of wave parameters and forms although some data have been obtained they fail to reach a precise conclusion of the relationship between induced force and wave parameters guo et al 2015b therefore more experimental studies are needed to investigate the structural performance under wave by considering different scenarios and to improve the accuracy and efficiency of the analytical estimation of wave induced forces on coastal bridges because of the complexity and huge cost of the experiment especially for large scale studies numerical analysis is also well accepted and should be conducted combination of experimental and numerical investigation is an effective method to explore the complex wave structure interaction seiffert 2014 the two dimensional 2d numerical simulation has been widely used within the computation of wave loads on coastal bridges huang and xiao 2009 used the 2d rans equations along with k ϵ turbulence model to analyze the wave force on bridge decks the influence of submersion water depth on the total uplift wave force was analyzed xiao et al 2010 however in some cases the 2d model could not identify some critical issues within the numerical analysis process for instance jin and meng 2011 used the commercial cfd software to simulate the wave bridge interaction of the i 10 bridge over escambia bay and found that there existed some differences between their 2d computational results and the calculated ones seiffert et al 2014a investigated the effects of trapped air under different water depths using a 2d model however the results are limited to the case where there is no lateral flow of fluid and thus a more sufficient simulation e g 3d model or test is required xu et al 2016b conducted numerical research of solitary wave forces on bridge superstructure and pointed out that the 2d numerical simulation may not fully capture some features of wave induced forces simplification by using 2d model could lead to some errors and the 3d model should be studied in order to better analyze the wave process bozorgnia and lee 2012 motley et al 2015 thus with respect to the bridges with complex geometries and bluff profile it is necessary to perform 3d numerical analysis to account for the complicated deck wave interaction also discussion and comparisons of the differences between 2d and 3d computational models should be conducted all these relevant aspects are investigated in this paper additionally the relevant numerial results from both 2d and 3d models are compared and verified by the experimental data overall this paper aims to investigate solitary wave loads on bridge superstructure by both experimental and numerical studies though the solitary wave loads on the bridge were investigated by some of previous studies huang et al 2019a b xu et al 2017a a systematic investigation incorporating both 3d numerical model and experimental study is still needed especially for the investigated t type girder bridge in this study a series of experimental studies on a 1 30 scale bridge model are conducted different water depths water surface elevations and submergence cases are selected and tested for the deck with and without girders both horizontal and vertical forces are measured the effects of these parameters on wave forces are discussed additionally a linear relationship between wave force and wave steepness is observed and an equation calculating wave induced force acting on bridge superstructure is proposed as for numerical studies both 2d and 3d models are adopted in this study and the relevant results are compared with the data from experimental studies the wave profiles obtained from experiment 2d model and 3d model are compared and discussed furthermore effects of the trapped air from irregular and complex shape of bridge superstructure are analyzed as well the remainder of the paper is structured as follows the experimental investigation is presented in section 2 numerical model establishment and validation are described in section 3 comparisons between experimental and numerical results are shown in section 4 finally conclusions are drawn and further work is noted in section 5 2 experimental investigation 2 1 experimental facilities and design the wave load experiments were conducted in the irregular wave channel at the hydraulics laboratory of the hong kong polytechnic university the wave channel is 27 m long 1 5 m wide and 1 5 m deep as shown in fig 1 b a piston type wavemaker is used to generate waves at one side of the wave channel at the opposite side of the channel a wave absorber is equipped to dissipate energy water surface elevation is measured using three capacitive wave height gauges a multi axis load cell is used to measure forces at x same direction as the wave propagation y perpendicular to the wave propagation and z vertical to the ground directions respectively force data is sampled at a frequency of 1000 hz which is sufficient for this experiment as the force events occur approximately within a 1 2 s window as shown in the experiment results and discussion section the experiments were designed according to the froude similarity model open channel flow a 1 30 scale model bridge is tested in the laboratory experiment the prototype bridge model is a typical simply supported bridge widely built in coastal regions due to years of service and increasing sea level rise some of these bridges are under high risk from hurricane and tsunami the detailed information and damage report of this type bridge under wave induced force can be found in douglass et al 2004 the model is made of clear acrylic and attached to stainless steel bar as shown in fig 2 a the pulley on the left side of the model is used for calibration of the load cell in the horizontal direction and was removed during the experiment for a better observation of wave deck interaction the side of the model is painted red the bridge model of the deck without girders is shown in fig 2 b the model of deck with girders is composed of a deck and six girders evenly distributed along the width of the deck as presented in fig 2 c the length and width of the deck are 580 mm and 320 mm respectively and the thickness is 20 mm all six girders have a height of 38 mm and a width of 20 mm the four small round holes are used to connect the structure to the load cell by stainless steel bars waterproof measures are set around these holes to prevent the leakage of compressed air caused by the extreme waves the bridge model is set at a distance of 8 m from the wave generator paddle the clearance which is calculated from the wave basin bottom to the bottom of the bridge deck for both deck with and without girders is set as 0 55 m corresponding to a prototype size of 16 5 m a total of 176 cases were tested 88 for the no girder cases and 88 for the girder cases 11 different wave heights h ranging from 0 10 m to 0 20 m with an interval of 0 01 m were tested under 8 different water depths d 0 48 0 50 0 52 0 54 0 56 0 58 0 60 and 0 62 m these cases cover a range of realistic prototype wave heights from 2 4 to 6 6 m and water depths from 14 4 to 18 6 m fully submerged conditions d 0 58 0 60 and 0 62 m are also tested considering potential impact of climate change increasing sea surface level and hurricane induced storm surge on bridges with small designed clearance 2 2 wave generation method solitary waves were generated by using a piston type wavemaker controlled by the software dhi wave synthesizer danish hydraulic institute the control strategy of the paddle motion is based on the boussinesq 1872 theory which describes the wave profile and forms an exact solution of the korteweg de vries kdv equation the dimensional quantities of such wave theory are 1 η x t h sech 2 3 4 h d 3 x c t where c g d h in these formulas η the free surface elevation above still water level swl t time h wave height d water depth and c wave celerity the field inspection results indicated that such huge wave forces acting on coastal bridges depended significantly on wave height and relative clearance between the bridge superstructure and swl ataei and padgett 2012 wave height h and water depth d are therefore often used as intensity measures for coastal bridge performance assessment under hurricane tsunami the adopted boussinesq solitary wave has the unique property that the wave profile is defined by the wave height h and water depth d which makes it suitable to simulate the wave within experimental and numerical studies goring 1978 kennedy et al 2000 chen et al 2000 given more information and specific scenarios other models e g mccowan 1891 laitone 1963 could also be used to generate solitary wave naheer 1977 french 1970 biesel and suquet 1951 discussed the wave generation for a number of different wavemaker types and developed the wave generation theory to prescribe the displacement time history of the piston wavemaker for the generation of long waves which propagate with constant form e g solitary waves the wave function can be expressed as 2 f θ sech 2 θ where θ κ c t ξ κ 3 4 h d 3 and ξ the displacement of the paddle thus the displacement is 3 ξ t h κ d tanh κ c t ξ based on eq 3 the origin of displacement ξ and time t is under the wave crest in addition the wave function f tends to be 0 as θ goes to infinity which means the intercept of the characteristics associated with the leading and trailing edges of the wave t 0 occurs at thus in order to meet the wave generating device design and practical purpose the intercept t 0 is defined with a precision of three significant figures and can be computed as goring 1978 4 t 0 tanh 1 0 999 κ c 3 80 κ c where t 0 the time interval between wave crest and swl accordingly the approximate period of solitary waves t can be calculated as 2t 0 and the effective wavelength λ can be obtained as the product of celerity and period apart from the control signal of generating progressive wave another term is utilized in control to avoid the disturb of generated waves although energy dissipation measures are set at the end of the wave channel parts of the wave energy are still reflected and travel towards the wave generator when the reflected wave reaches the wave generator it is reflected the result is a re reflected wave travelling together with the directly generated solitary wave in order to avoid the distortion of the re reflected waves an absorption control is applied by moving the paddle based on the surface elevation time series schäffer 2002 more detailed information about solitary wave generation and data acquisition method could be found in goring 1978 and dhi wave synthesizer user guide respectively 2 3 experimental results and discussion 2 3 1 time history of vertical and horizontal force to obtain a better understanding of the characteristics of solitary wave loads time histories of vertical and horizontal wave forces on the bridge models are analyzed and the wave forces are divided by the length of the model 0 58 m it should be noted that in all the figures shown in the following sections the origin of time t does not necessarily represent the starting point of the actual wave but to better display the results fig 3 shows time series of the vertical and horizontal wave loads associated with the deck without girders under the case of d 0 5 m and h 0 15 m under this circumstance the deck model is elevated from the swl to a certain height and the wave height is large enough to hit and exceed the deck for a better display of wave loads acting on the bridge model a smoothed curve is fitted and shown as well as the measured data as indicated the solitary wave force is associated with an obvious peak and trough apart from the smoothed result expressed in dark lines the extreme solitary wave also causes structural vibration to some extent the vibration is clearly observed in horizontal wave force when the wave crest first arrives at t 2 s although the horizontal force does not reach the maximum value it still causes vibration of the structure since the wave hits only on seaward side of the bridge structural vibration is asymmetric and positive forces same direction of wave propagation are larger than the negative forces opposite direction of wave propagation such asymmetrical impact may also result in damage and failure of the connection between superstructure and substructure fig 4 presents the time history of wave forces on the girder deck with the same initial condition given d 0 5 m and h 0 15 m similarly a smoothed curve is presented for better illustrative purpose it is obvious that both vertical and horizontal wave forces are much larger than those of the no girders case one difference is that the structural vibration occurs during the entire process of wave flow passing the structure it can be concluded that girders not only result in larger forced area and wave loads but also intensify the dynamic response 2 3 2 secondary impact associated with the cases with girders another significant difference of the girder deck is that there is a secondary rise in the declining phase of the wave force the force reaches its peak and drops before reaching its second peak the value of the second peak is about half of the maximum force as shown in fig 5 in order to further understand this characteristic several cases are chosen and compared including 1 d 0 5 m h 0 16 m 2 d 0 56 m h 0 16 m and 3 d 0 62 m h 0 16 m as shown in fig 5 the three different initial water depths cover unsubmerged case partially submerged case and totally submerged case it is obvious that as the initial water surface rises the maximum force descends significantly while the second peak changes little the maximum uplift force is almost twice of the second peak in unsubmerged case but the values are very close in the partially submerged case and fully submerged case horizontal wave forces are presented as well forces with continuous fluctuation reflect the strong vibration of the structure and difference between the two peaks becomes smaller as the initial water depth increases the measured secondary peak forces under these three water depths are shown in fig 6 generally it increases with larger wave height h the unsubmerged case d 0 5 m has the largest secondary impact while these forces for partially submerged and totally submerged cases e g d 0 56 m and 0 62 m are really close both the wave structure dynamic interaction and the trapped air between the girders and deck could contribute to the secondary impact the secondary impact force tends to stabilize with less trapped air e g partially and totally submerged cases 2 3 3 peak force the experimental data of the deck without girders for the vertical uplift force f u maximum vertical force vertical downward force f d absolute value of the minimum vertical force horizontal positive force f p maximum horizontal force with the same direction of the wave and horizontal negative force f n absolute value of the minimum horizontal force under different water depths and wave heights are presented in figs 7 10 respectively fig 7 a shows that uplift wave force increases nonlinearly with the wave height increasing or the water depth decreasing the greatest uplift force occurs when the wave crest significantly exceeds the top of the plate h 0 2 m for all the water depths i e d 0 48 0 50 0 52 and 0 54 m the submerged case is shown in fig 7 b as indicated the uplift force increases linearly with the increase of the wave height horizontal positive forces fig 8 keep an upwards trend with increasing h and decreasing d in unsubmerged cases except for scenarios h 0 15 m as for submerged cases larger positive forces are measured with larger wave heights overall vertical uplift forces and horizontal positive forces are larger in unsubmerged cases than those in submerged cases under the same wave height h this behavior may be related to the fact that the slamming force which plays an important role in composing total wave forces decreases or even disappears with a higher water depth the vertical downward forces are presented in fig 9 the downward force shows a totally different trend for unsubmerged cases which has a larger value for relatively large h 0 19 and 0 20 m or small h 0 10 and 0 11 m wave height the minimum value of f d occurs at h 0 15 m given d 0 48 and 0 54 m and at h 0 14 and 0 13 m given d 0 50 and 0 52 m however for the submerged cases we only see larger downward forces under larger wave heights and smaller initial water depths except for d 0 62 m similarly negative horizontal forces fig 10 tend to decrease first and then increase with the increasing wave height except for d 0 48 m for all the wave heights minimum values of f n are measured when d 0 54 m for the submerged cases although the negative forces still tend to increase with wave heights they are not well ordered compared with vertical uplift forces such irregular change may result from the unstable energy dissipation and flow separation at the trailing edge of the wave experimental data for the vertical uplift forces horizontal positive forces vertical downward forces and horizontal negative forces for the deck with girders under various water depths and wave heights are presented in figs 11 14 respectively for unsubmerged cases the whole bridge model is elevated from initial water surface for partially submerged cases the initial water level reaches the bottom of girders but are lower than the top of the deck so the quantity of trapped air decreases with the increasing initial water depth for fully submerged cases the initial water level is higher than the top of the deck overall wave forces acting on the deck with girders are much larger than those on the deck without girders similar trends are found in the vertical uplift forces and horizontal positive forces for the deck with girders both forces tend to increase with wave heights as shown in figs 11 and 12 for the unsubmerged cases positive forces for d 0 48 m are larger than those for d 0 50 m while there exists no big difference in the uplift forces for these two scenarios for partially submerged conditions these forces increase with decreasing initial water depth for most wave heights except for h 0 13 and 0 15 m these results may be related to the fact that quantity of trapped air decreases with increasing initial water depth and thus lead to the decrease in the uplift force caused by the compressed air for the fully submerged conditions it is found that vertical forces for d 0 62 m are significantly less than the other two cases with respect to the horizontal positive forces there is again an increase in forces with smaller initial water depth and the rate of increase in forces also increases fig 13 shows the vertical downward forces different from the cases of decks without girders there is no obvious trough in the figure but the forces increase in a nearly linear relationship with the increase of wave heights for partially submerged cases and fully submerged cases downward forces keep increasing with increasing initial water depth until the bridge is completely submerged after that the forces almost remain constant for d 0 48 and 0 50 m negative horizontal forces remain stable with changes in wave heights however for partially submerged cases that is d 0 52 0 54 and 0 56 m there is again an increase in force with larger wave heights negative force for d 0 56 m is the largest among the three cases when h 0 17 m for the case that h is greater than 0 17 m the force is the smallest among the three for fully submerged conditions negative forces are affected profoundly by nonlinear effects but do not change much as wave height varies 2 4 analytic equation of maximum solitary wave force based on experimental data this section presents the experimental measurements using the dimensionless parameter wave steepness s which is calculated as the ratio of wave hight h to wave length λ fig 15 shows the results for the no girders cases it is obvious that for the values of d a good linear relationship can be found between uplift wave forces and wave steepness the wave steepness can also be derived from h and d based on generation wave theory discussed in section 2 as follows 5 s h λ 0 114 h d 3 2 figs 16 a and b present the results for unsubmerged cases and partially or fully submerged cases for deck with girders cases respectively the linear relationship is well observed as well thus an analytical equation for the quantification of uplift wave force is proposed as 6 f u a γ s γ r s b a γ s γ r h d 3 2 b where f u the uplift wave force γ s and γ r parameters accounting for dimensions of bridge superstructures and relative position of the bridge and swl and a and b fitting coefficients similar linear relationships can also be found with respect to the horizontal positive force f p therefore wave steepness s might be adopted as an important parameter in calculating solitary wave loads by introducing steepness s the wave induced force could be estimated more concisely and precisely 3 numerical investigation in addition to the experiments the numerical studies are also conducted in this paper by comparing the results from experiments and numerical calculation the numerical methodology could be verified then variable scales and scenarios can be assessed in this section the computational fluid dynamics cfd modeling and validation of numerial models are introduced all the cases are calculated using the commercial software ansys fluent v 17 2 ansys inc 2016 to solve the fundamental partial differential navier stokes equations hamza et al 2015 xu et al 2016b 2017b model setups and boundary conditions for both 2d and 3d models are presented to better capture the turbulent fluctuations of bridge deck wave interactions the shear stress transport sst k ω model is used as the turbulence closure for the reynolds averaged navier stokes rans equations menter 1994 for the setups of the sst k ω model in ansys fluent the pressure based solver segregated is chosen for the transient flow which is good at resolving incompressible fluid motion for the velocity inlet boundary outlet boundary and top boundary the turbulence intensity and turbulent viscosity ratio are set as 2 and 10 respectively the pressure implicit with splitting of operators scheme piso is used for the pressure velocity coupling method bricker et al 2011 2014 and the pressure staggering option presto scheme is utilized for pressure spatial discretization due to its good performance dealing with irregular complex interface of the structure model least squares cell based scheme is used for the gradient discretization the second order upwind is utilized for calculating the momentum volume fraction turbulent kinetic energy and specific dissipation rate murillo 2008 such second order upwind also has good convergence during the calculation process the volume of fluid vof method is used to determine the dynamic free surface hirt and nichols 1981 the water particle velocity components u and v and the free surface profile η are sarpkaya and isaacson 1981 input by using user defined functions udf similarly the solitary wave crest is located at x 0 when t 0 s thus in order to more accurately simulate the wave profile the solitary wave should be shifted leftward by utilizing a coefficient t 0 to adjust t as indicated in eq 4 in this way the water surface can increase gradually at the inlet boundary and a fully developed solitary wave profile can be generated 3 1 numerical model set up to ensure the efficiency and accuracy of the numerical model a mesh sensitivity study is conducted based on the analysis the cell dimensions are determined as dx 0 005 m and dz 0 005 m the fixed time step dt 0 002 s is adopted to satisfy the requirement of the courant number a small dt may also affect the accuracy of calculating vertical wave force bozorgnia and lee 2012 in order to save the computation time especially for 3d model meshes for the top air zone deep water zone and near outlet zone are relatively coarsen fig 17 a shows the schematic diagram of the 2d numerical domain of the 1 30 bridge model the total numerical domain is 1 5 m in height and 10 m in length which is long enough to eliminate wave reflection effect line cd is the swl separating the interface of air and water line ab is set as pressure outlet with the constant atmosphere pressure i e 101 325 pa line ae is the velocity inlet with input velocity controlled by the user defined function line ef is the no slip stationary wall condition and line bf acts as the pressure outlet to keep the balanced pressures for the air and water zones fig 17 b shows the 3d numerical model of the deck with girders compared with the 2d model in order to reduce the number of total grids and calculation time a symmetry plane is used in the middle of the model plane abdc is the velocity inlet where solitary waves are generated using the udf functions similar as the 2d numerical method plane efhg is the pressure outlet to keep a free water surface level at the end of water flow and to reduce the influence of wave reflections plane abfe is set as the pressure outlet to apply a constant atmosphere pressure of 101 325 kpa plane cdhg and bdhf are no slip walls to simulate the bottom and the side of the tank respectively plane acge is the symmetry plane to speed up the calculation the bridge model is also half of the original model and set at the symmetry plane other parameters are similar with the 2d numerical model 3 2 model validation to verify the accuracy of the numerical model a comparison of solitary wave profiles generated by ansys fluent with the laboratory measurements is shown in fig 18 positions of three wave gauges and bridge model are shown in fig 18 a the initial water depth is set as 0 5 m and the expected wave height is 0 15 m due to different setting positions and slight friction resistance caused by the sidewall of wave channel the readings of these three wave gauges and the time to peak are slightly different numerical results are also presented in fig 18 b as indicted little but reasonable differences are observed 4 comparison between numerical results and experimental data in this section several cases are chosen for detailed comparison between experimental data and numerical analysis the performance of 2d and 3d models the effect of girders and trapped air and the causes of the secondary impact are discussed 4 1 comparison of peak forces computations are performed for all the experimental cases the 2d numerical result for one typical case d 0 50 m is presented for illustrative purpose as indicated in fig 19 both numerical and measured results for deck with and without girders are presented for small wave height h 0 15 m the agreement is good for both models but obvious deviations occur for the deck with girders after h reaches 0 15 m while the no girders cases still match well this may be caused by the limitation of the 2d model in dealing with the effects of trapped air in general the 2d model would reveal larger uplift forces for the girder deck under all the wave heights comparisons between the results from the 3d numerical model and experimental measurements under different submergence scenarios are presented in fig 20 results for unsubmerged conditions are illustrated in figs 20 a and b a monotonic relationship between the uplift forces f u and positive forces f p with the wave height h is observed the 3d model provides good results for wave heights from 0 13 to 0 18 m while for other cases h 0 13 m the numerical model provides slightly larger values fig 20 c and d show the results associated with partially submerged conditions experimental data and numerical results match well for f u with respect to f p the numerical results are smaller for large wave heights h 0 15 m for fully submerged conditions presented in fig 20 e and f good agreements are observed except for f u under small wave heights h 0 12 m in summary the 3d numerical model provides more reliable results for most of the cases compared with the 2d model it could better simulate the trapped air and uneven force distribution on the bridge deck 4 2 comparison of force time histories in order to have a better understand in the differences between numerical analysis and experiments a comparison of wave force time history for the deck with girders is shown in fig 21 both computational models match the experimental data well but the 3d model provides an improvement over the 2d model the 3d model captures the vertical forces very well improving upon the estimation of the 2d model both at more precise peak value and the secondary impact for the 2d model it fails to account for the complicated wave deck interaction caused by irregular contact shape forced area and trapped air the 2d model cannot simulate the air discharge in transverse direction before the wave crest arrives and overestimates uplift force caused by compressed air between girders generally the 2d model is adequate to reproduce simple wave flume experiments in which the structural dimension is simple and regular and provides conservative calculation results for a complex structure such as irregular shapes with girders bridge deck with combination of skew and slope or a bridge spanning with non uniformities results with 2d model may be inaccurate or impractical the 3d model should be adopted for these cases to achieve more accurate results 4 3 comparison of wave profiles the wave profiles during the wave structure interaction from the 2d model 3d model and experiment for the same case with wave height h 0 15 m are demonstrated in fig 22 the solitary wave comes from the right side to the left in these figures in the numerical cross sectional domain the blue represents air red represents water and other colors in between represent the mixture of water and air according to the vof method when the solitary wave approaches and first exceeds the top of deck overtopping occurs water splashes and waveshape deforms this could cause the first impact on the bridge deck then after the first impact the wave keeps moving forward with splashes resulting in mixed fluid phases around the deck during this phase as the water level gradually rises the air between the water and the bridge is first trapped and then squeezed out from both the wave direction and the gaps between the girders in x and y directions the bubbles are observed during the experimental studies as indicted in fig 22 c the partial release of trapped air may cause structural unequilibrium as well as the secondary impact measured in force time histories the trapped air between the deck and girders is simulated in the 2d model but the 2d model fails to capture the dynamic air escape process due to the model limitation in y direction under this condition the trapped air could cause an overestimation of the total forces which agrees with the results of previous study xu et al 2017a the 3d model successfully simulates the water air interaction owing to its spatial scalability and it could simulate the mixture of these two phases beneath the deck therefore the 3d model could provide more information on the calculation of peak force and better capture the force time series and the secondary impact 5 conclusions this study focuses on the experimental and numerical analyses of solitary waves on bridge superstructure specifically the experiment of the wave force on bridge superstructure was performed at the hydraulics laboratory both 2d and 3d numerical analyses were conducted to have a comparison on their performance in simulating this process bridge models with and without girders were tested to further assess the effects of girders and trapped air an analytical equation is proposed to compute the wave induced force by incorporating the dimensionless wave steepness parameter the results from the series of investigations show that for the deck without girders model in unsubmerged cases vertical uplift forces and horizontal positive forces are approximately proportional to wave height but decrease with larger initial water depth vertical downward forces and horizontal negative forces tend to decrease first and then increase as the wave height increases for most of the unsubmerged cases for submerged cases all these values have a near linear relationship with the wave height for the deck with girders group the vertical uplift forces increase with wave heights in the unsubmerged partially submerged and fully submerged cases they increase fastest in unsubmerged cases and slowest in fully submerged cases as indicated the influence of wave height is much more obvious in shallow water similar trend can be observed for horizontal positive forces as well vertical uplift forces and positive horizontal forces are relatively smaller when the wave crest has little or no interaction with the bridge deck maximum values are observed when the wave crest has a similar height of the bridge it can be concluded that such interaction contributes significantly to force magnitude a secondary impact which may be caused by the trapped air is observed for the case of deck with girders in addition after conducting the dimensionless analysis we found a linear relationship between wave forces and wave steepness based on experimental data an equation is proposed to compute the solitary waves induced force on bridge superstructure with respect to the numerical analysis the 2d numerical analysis and experimental measurements shows good agreement for most cases except for some cases where trapped air may play an important role the 3d model captures the wave forces better improving upon the estimation of the peak value and secondary impulse compared with 2d model in addition the trapped air is better simulated in the 3d model providing a more reliable result for a complex structure such as irregular shapes with girders bridge deck with combination of skew and slope or a bridge spanning with non uniform cross section the 3d model should be adopted to assess the peak value and the entire loading process from the measurements calculations and comparisons of all the data the following conclusions and suggestions are made 1 solitary wave forces on bridge decks consist of uplift and positive forces for the investigated cases the uplift forces are larger than downward and negative forces 2 for the experimental model the existence of girders increases total wave loads on the superstructure the bluff profile also leads to severe wave deck interaction and structural vibration dynamic response analysis of bridge under extreme conditions is necessary 3 a secondary impact after the first peak associated with the wave force is observed which may be caused by the release of the trapped air between girders beneath the deck such impulse may occur with a large overturning moment simultaneously and may cause damage and failure to the bridges 4 the secondary impact force may be caused by the release of trapped air between girders and it becomes smaller for larger initial water depth with less trapped air the maximum force decreases much more severe than the reduction of the secondary impact force as the initial water surface rises the maximum force decreases significantly while the secondary peak changes little the maximum uplift force is almost twice of the second peak in unsubmerged case but they are almost the same in the partially submerged case and fully submerged case 5 solitary wave loads can be assumed to be proportional to the wave steepness and the relevant coefficients can then be determined based on relevant parameters 6 wave steepness deserves more attention in calculating tsunami and hurricane wave loads for instance it can be used as an intensity measure for the structural performance assessment 7 the 3d model has a superior performance in simulating the water air interaction during the wave process and provides relatively more accurate results with an improved 3d model it is possible to deal with bridges with slopes and curves future study should carefully consider the following aspects structural dynamic analysis by considering substructure and connection between the superstructure and substructure 3d numerical analysis to further investigate the trapped air effect and 3d experimental investigations to examine the 3d fluent numerical model by considering the oblique interactions between the solitary waves and bridge decks credit authorship contribution statement deming zhu conceptualization methodology software writing original draft you dong supervision investigation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the study has been supported by the hong kong polytechnic university under start up fund number 1 ze7q the research grant council of hong kong ecs project no polyu 252161 18 e and key special project for introduced talents team of southern marine science and engineering guangdong laboratory guangzhou gml2019zd0503 the opinions and conclusions presented in this paper are those of the authors and do not necessarily reflect the views of the sponsoring organizations 
21792,in this paper solitary wave induced vertical and horizontal forces on coastal bridges are investigated by laboratory experiments as well as computational fluid dynamics cfd analysis the effects of different parameters e g water depths submergence depths wave heights on wave induced force on a 1 30 scale bridge model are studied specifically the models of deck with and without girders are tested to explore the effects of girders and trapped air on structural response it is demonstrated with the collected experimental data that girders can increase the wave loads acting on decks and the trapped air makes the structure more unstable additionally a secondary impact may occur due to the bluff profile of girders subsequently based on solitary wave theory and experimental data a linear relationship is quantified between wave forces and wave steepness following the experiments numerical analysis using both two dimensional 2d and three dimensional 3d models is conducted to assess vertical and horizontal forces the comparisons between experimental study and numerical computation indicate that the 2d model can well assess most of the cases for deck without girders but fails to simulate accurate results for deck with girders indicating that 2d model cannot deal with complex interactions among wave structure and trapped air the 3d model can obtain more accurate wave forces and better capture the detailed characteristics of solitary wave forces with the information presented in this study it can aid the design and management of coastal structures under hurricane and tsunami loads keywords coastal bridges solitary wave experiments numerical analysis wave forces 3d model 1 introduction based on historical data extreme waves caused by hurricanes and tsunamis could lead to significant adverse damages to our coastal community for instance hurricane isabel 2003 struck north carolina and virginia coastline resulting in 17 deaths and more than 3 billion dollars in damages the indonesia tsunami 2004 destroyed many structures along the coast leading to approximately 1200 deaths with respect to the coastal bridges especially for the low lying ones they are vulnerable to the storm surge and wave induced forces and could result in severe damage and failure padgett et al 2008 xu et al 2016a li et al 2020 considering climate change increasing sea level rise and amplification of hazard intensity it demonstrates an urgent need for deeper understanding on failure mechanisms of coastal bridges and preparing for future disasters dong and frangopol 2017 frangopol et al 2017 douglass et al 2004 robertson et al 2007a padgett et al 2008 and okeil and cai 2008 conducted studies on the damage assessment of coastal bridges during hurricane ivan and hurricane katrina and accordingly one of the major failure modes of bridges under extreme waves is the unseating of deck akiyama et al 2012 kosa 2011 bricker and nakayama 2014 robertson et al 2007b the total load on bridge superstructure consists of hydrodynamic and hydrostatic forces caused by large waves and the short duration shock force caused by the trapped air between girders and deck azadbakht et al 2016 hayatdavoodi et al 2014 hayatdavoodi and ertekin 2016 seiffert et al 2014b the combination of these forces can overcome the weight of the superstructure and lead to the connection failure and thus the bridge deck is unseated from the substructure ataei and padgett 2012 however the way that the wave forces work is complicated and affected by many parameters including wavelength period wave height celerity and frequency as well as the structural profile fang et al 2019b in addition the prototype scale wave forces could only be estimated for scenarios with no trapped air or air fully trapped between girders seiffert et al 2015 therefore it is important to conduct further research on wave effects and structural response under solitary waves due to the complexity of wave structure interaction laboratory experiment should also be conducted to explore wave forces guo et al 2016 fang et al 2019a huang et al 2019b although there were some laboratory tests focusing on the wave forces on coastal platforms and harbor wharfs french 1970 lee and lai 1987 boccotti 1995 huseby and grue 2000 few studies investigated the impact of wave loads on bridge decks crowley et al 2018 and james et al 2015 compared test data of wave loads on bridge decks with existing analytical method associated with coastal platforms they concluded that the established method for platforms cannot be used for bridges bradner et al 2011 conducted an experiment of a 1 5 scale bridge model to measure wave forces under regular and random waves observing a second order relationship between force and wave height cuomo et al 2009 experimentally investigated the quasi static wave force and impulsive force on the bridge and proved the significance of trapped air mcpherson 2008 conducted the experimental studies using a large scale 3d wave basin and compared experimental data with analytical results it was concluded that existing prediction equations cannot sufficiently predict the measured forces guo et al 2015a investigated wave forces acting on superstructure of coastal bridges under regular waves and the experimental results were compared with the analytical results as well this series of experiments laid the foundation for later research and explained some qualitative relationships for such phenomenon due to the diversity of wave parameters and forms although some data have been obtained they fail to reach a precise conclusion of the relationship between induced force and wave parameters guo et al 2015b therefore more experimental studies are needed to investigate the structural performance under wave by considering different scenarios and to improve the accuracy and efficiency of the analytical estimation of wave induced forces on coastal bridges because of the complexity and huge cost of the experiment especially for large scale studies numerical analysis is also well accepted and should be conducted combination of experimental and numerical investigation is an effective method to explore the complex wave structure interaction seiffert 2014 the two dimensional 2d numerical simulation has been widely used within the computation of wave loads on coastal bridges huang and xiao 2009 used the 2d rans equations along with k ϵ turbulence model to analyze the wave force on bridge decks the influence of submersion water depth on the total uplift wave force was analyzed xiao et al 2010 however in some cases the 2d model could not identify some critical issues within the numerical analysis process for instance jin and meng 2011 used the commercial cfd software to simulate the wave bridge interaction of the i 10 bridge over escambia bay and found that there existed some differences between their 2d computational results and the calculated ones seiffert et al 2014a investigated the effects of trapped air under different water depths using a 2d model however the results are limited to the case where there is no lateral flow of fluid and thus a more sufficient simulation e g 3d model or test is required xu et al 2016b conducted numerical research of solitary wave forces on bridge superstructure and pointed out that the 2d numerical simulation may not fully capture some features of wave induced forces simplification by using 2d model could lead to some errors and the 3d model should be studied in order to better analyze the wave process bozorgnia and lee 2012 motley et al 2015 thus with respect to the bridges with complex geometries and bluff profile it is necessary to perform 3d numerical analysis to account for the complicated deck wave interaction also discussion and comparisons of the differences between 2d and 3d computational models should be conducted all these relevant aspects are investigated in this paper additionally the relevant numerial results from both 2d and 3d models are compared and verified by the experimental data overall this paper aims to investigate solitary wave loads on bridge superstructure by both experimental and numerical studies though the solitary wave loads on the bridge were investigated by some of previous studies huang et al 2019a b xu et al 2017a a systematic investigation incorporating both 3d numerical model and experimental study is still needed especially for the investigated t type girder bridge in this study a series of experimental studies on a 1 30 scale bridge model are conducted different water depths water surface elevations and submergence cases are selected and tested for the deck with and without girders both horizontal and vertical forces are measured the effects of these parameters on wave forces are discussed additionally a linear relationship between wave force and wave steepness is observed and an equation calculating wave induced force acting on bridge superstructure is proposed as for numerical studies both 2d and 3d models are adopted in this study and the relevant results are compared with the data from experimental studies the wave profiles obtained from experiment 2d model and 3d model are compared and discussed furthermore effects of the trapped air from irregular and complex shape of bridge superstructure are analyzed as well the remainder of the paper is structured as follows the experimental investigation is presented in section 2 numerical model establishment and validation are described in section 3 comparisons between experimental and numerical results are shown in section 4 finally conclusions are drawn and further work is noted in section 5 2 experimental investigation 2 1 experimental facilities and design the wave load experiments were conducted in the irregular wave channel at the hydraulics laboratory of the hong kong polytechnic university the wave channel is 27 m long 1 5 m wide and 1 5 m deep as shown in fig 1 b a piston type wavemaker is used to generate waves at one side of the wave channel at the opposite side of the channel a wave absorber is equipped to dissipate energy water surface elevation is measured using three capacitive wave height gauges a multi axis load cell is used to measure forces at x same direction as the wave propagation y perpendicular to the wave propagation and z vertical to the ground directions respectively force data is sampled at a frequency of 1000 hz which is sufficient for this experiment as the force events occur approximately within a 1 2 s window as shown in the experiment results and discussion section the experiments were designed according to the froude similarity model open channel flow a 1 30 scale model bridge is tested in the laboratory experiment the prototype bridge model is a typical simply supported bridge widely built in coastal regions due to years of service and increasing sea level rise some of these bridges are under high risk from hurricane and tsunami the detailed information and damage report of this type bridge under wave induced force can be found in douglass et al 2004 the model is made of clear acrylic and attached to stainless steel bar as shown in fig 2 a the pulley on the left side of the model is used for calibration of the load cell in the horizontal direction and was removed during the experiment for a better observation of wave deck interaction the side of the model is painted red the bridge model of the deck without girders is shown in fig 2 b the model of deck with girders is composed of a deck and six girders evenly distributed along the width of the deck as presented in fig 2 c the length and width of the deck are 580 mm and 320 mm respectively and the thickness is 20 mm all six girders have a height of 38 mm and a width of 20 mm the four small round holes are used to connect the structure to the load cell by stainless steel bars waterproof measures are set around these holes to prevent the leakage of compressed air caused by the extreme waves the bridge model is set at a distance of 8 m from the wave generator paddle the clearance which is calculated from the wave basin bottom to the bottom of the bridge deck for both deck with and without girders is set as 0 55 m corresponding to a prototype size of 16 5 m a total of 176 cases were tested 88 for the no girder cases and 88 for the girder cases 11 different wave heights h ranging from 0 10 m to 0 20 m with an interval of 0 01 m were tested under 8 different water depths d 0 48 0 50 0 52 0 54 0 56 0 58 0 60 and 0 62 m these cases cover a range of realistic prototype wave heights from 2 4 to 6 6 m and water depths from 14 4 to 18 6 m fully submerged conditions d 0 58 0 60 and 0 62 m are also tested considering potential impact of climate change increasing sea surface level and hurricane induced storm surge on bridges with small designed clearance 2 2 wave generation method solitary waves were generated by using a piston type wavemaker controlled by the software dhi wave synthesizer danish hydraulic institute the control strategy of the paddle motion is based on the boussinesq 1872 theory which describes the wave profile and forms an exact solution of the korteweg de vries kdv equation the dimensional quantities of such wave theory are 1 η x t h sech 2 3 4 h d 3 x c t where c g d h in these formulas η the free surface elevation above still water level swl t time h wave height d water depth and c wave celerity the field inspection results indicated that such huge wave forces acting on coastal bridges depended significantly on wave height and relative clearance between the bridge superstructure and swl ataei and padgett 2012 wave height h and water depth d are therefore often used as intensity measures for coastal bridge performance assessment under hurricane tsunami the adopted boussinesq solitary wave has the unique property that the wave profile is defined by the wave height h and water depth d which makes it suitable to simulate the wave within experimental and numerical studies goring 1978 kennedy et al 2000 chen et al 2000 given more information and specific scenarios other models e g mccowan 1891 laitone 1963 could also be used to generate solitary wave naheer 1977 french 1970 biesel and suquet 1951 discussed the wave generation for a number of different wavemaker types and developed the wave generation theory to prescribe the displacement time history of the piston wavemaker for the generation of long waves which propagate with constant form e g solitary waves the wave function can be expressed as 2 f θ sech 2 θ where θ κ c t ξ κ 3 4 h d 3 and ξ the displacement of the paddle thus the displacement is 3 ξ t h κ d tanh κ c t ξ based on eq 3 the origin of displacement ξ and time t is under the wave crest in addition the wave function f tends to be 0 as θ goes to infinity which means the intercept of the characteristics associated with the leading and trailing edges of the wave t 0 occurs at thus in order to meet the wave generating device design and practical purpose the intercept t 0 is defined with a precision of three significant figures and can be computed as goring 1978 4 t 0 tanh 1 0 999 κ c 3 80 κ c where t 0 the time interval between wave crest and swl accordingly the approximate period of solitary waves t can be calculated as 2t 0 and the effective wavelength λ can be obtained as the product of celerity and period apart from the control signal of generating progressive wave another term is utilized in control to avoid the disturb of generated waves although energy dissipation measures are set at the end of the wave channel parts of the wave energy are still reflected and travel towards the wave generator when the reflected wave reaches the wave generator it is reflected the result is a re reflected wave travelling together with the directly generated solitary wave in order to avoid the distortion of the re reflected waves an absorption control is applied by moving the paddle based on the surface elevation time series schäffer 2002 more detailed information about solitary wave generation and data acquisition method could be found in goring 1978 and dhi wave synthesizer user guide respectively 2 3 experimental results and discussion 2 3 1 time history of vertical and horizontal force to obtain a better understanding of the characteristics of solitary wave loads time histories of vertical and horizontal wave forces on the bridge models are analyzed and the wave forces are divided by the length of the model 0 58 m it should be noted that in all the figures shown in the following sections the origin of time t does not necessarily represent the starting point of the actual wave but to better display the results fig 3 shows time series of the vertical and horizontal wave loads associated with the deck without girders under the case of d 0 5 m and h 0 15 m under this circumstance the deck model is elevated from the swl to a certain height and the wave height is large enough to hit and exceed the deck for a better display of wave loads acting on the bridge model a smoothed curve is fitted and shown as well as the measured data as indicated the solitary wave force is associated with an obvious peak and trough apart from the smoothed result expressed in dark lines the extreme solitary wave also causes structural vibration to some extent the vibration is clearly observed in horizontal wave force when the wave crest first arrives at t 2 s although the horizontal force does not reach the maximum value it still causes vibration of the structure since the wave hits only on seaward side of the bridge structural vibration is asymmetric and positive forces same direction of wave propagation are larger than the negative forces opposite direction of wave propagation such asymmetrical impact may also result in damage and failure of the connection between superstructure and substructure fig 4 presents the time history of wave forces on the girder deck with the same initial condition given d 0 5 m and h 0 15 m similarly a smoothed curve is presented for better illustrative purpose it is obvious that both vertical and horizontal wave forces are much larger than those of the no girders case one difference is that the structural vibration occurs during the entire process of wave flow passing the structure it can be concluded that girders not only result in larger forced area and wave loads but also intensify the dynamic response 2 3 2 secondary impact associated with the cases with girders another significant difference of the girder deck is that there is a secondary rise in the declining phase of the wave force the force reaches its peak and drops before reaching its second peak the value of the second peak is about half of the maximum force as shown in fig 5 in order to further understand this characteristic several cases are chosen and compared including 1 d 0 5 m h 0 16 m 2 d 0 56 m h 0 16 m and 3 d 0 62 m h 0 16 m as shown in fig 5 the three different initial water depths cover unsubmerged case partially submerged case and totally submerged case it is obvious that as the initial water surface rises the maximum force descends significantly while the second peak changes little the maximum uplift force is almost twice of the second peak in unsubmerged case but the values are very close in the partially submerged case and fully submerged case horizontal wave forces are presented as well forces with continuous fluctuation reflect the strong vibration of the structure and difference between the two peaks becomes smaller as the initial water depth increases the measured secondary peak forces under these three water depths are shown in fig 6 generally it increases with larger wave height h the unsubmerged case d 0 5 m has the largest secondary impact while these forces for partially submerged and totally submerged cases e g d 0 56 m and 0 62 m are really close both the wave structure dynamic interaction and the trapped air between the girders and deck could contribute to the secondary impact the secondary impact force tends to stabilize with less trapped air e g partially and totally submerged cases 2 3 3 peak force the experimental data of the deck without girders for the vertical uplift force f u maximum vertical force vertical downward force f d absolute value of the minimum vertical force horizontal positive force f p maximum horizontal force with the same direction of the wave and horizontal negative force f n absolute value of the minimum horizontal force under different water depths and wave heights are presented in figs 7 10 respectively fig 7 a shows that uplift wave force increases nonlinearly with the wave height increasing or the water depth decreasing the greatest uplift force occurs when the wave crest significantly exceeds the top of the plate h 0 2 m for all the water depths i e d 0 48 0 50 0 52 and 0 54 m the submerged case is shown in fig 7 b as indicated the uplift force increases linearly with the increase of the wave height horizontal positive forces fig 8 keep an upwards trend with increasing h and decreasing d in unsubmerged cases except for scenarios h 0 15 m as for submerged cases larger positive forces are measured with larger wave heights overall vertical uplift forces and horizontal positive forces are larger in unsubmerged cases than those in submerged cases under the same wave height h this behavior may be related to the fact that the slamming force which plays an important role in composing total wave forces decreases or even disappears with a higher water depth the vertical downward forces are presented in fig 9 the downward force shows a totally different trend for unsubmerged cases which has a larger value for relatively large h 0 19 and 0 20 m or small h 0 10 and 0 11 m wave height the minimum value of f d occurs at h 0 15 m given d 0 48 and 0 54 m and at h 0 14 and 0 13 m given d 0 50 and 0 52 m however for the submerged cases we only see larger downward forces under larger wave heights and smaller initial water depths except for d 0 62 m similarly negative horizontal forces fig 10 tend to decrease first and then increase with the increasing wave height except for d 0 48 m for all the wave heights minimum values of f n are measured when d 0 54 m for the submerged cases although the negative forces still tend to increase with wave heights they are not well ordered compared with vertical uplift forces such irregular change may result from the unstable energy dissipation and flow separation at the trailing edge of the wave experimental data for the vertical uplift forces horizontal positive forces vertical downward forces and horizontal negative forces for the deck with girders under various water depths and wave heights are presented in figs 11 14 respectively for unsubmerged cases the whole bridge model is elevated from initial water surface for partially submerged cases the initial water level reaches the bottom of girders but are lower than the top of the deck so the quantity of trapped air decreases with the increasing initial water depth for fully submerged cases the initial water level is higher than the top of the deck overall wave forces acting on the deck with girders are much larger than those on the deck without girders similar trends are found in the vertical uplift forces and horizontal positive forces for the deck with girders both forces tend to increase with wave heights as shown in figs 11 and 12 for the unsubmerged cases positive forces for d 0 48 m are larger than those for d 0 50 m while there exists no big difference in the uplift forces for these two scenarios for partially submerged conditions these forces increase with decreasing initial water depth for most wave heights except for h 0 13 and 0 15 m these results may be related to the fact that quantity of trapped air decreases with increasing initial water depth and thus lead to the decrease in the uplift force caused by the compressed air for the fully submerged conditions it is found that vertical forces for d 0 62 m are significantly less than the other two cases with respect to the horizontal positive forces there is again an increase in forces with smaller initial water depth and the rate of increase in forces also increases fig 13 shows the vertical downward forces different from the cases of decks without girders there is no obvious trough in the figure but the forces increase in a nearly linear relationship with the increase of wave heights for partially submerged cases and fully submerged cases downward forces keep increasing with increasing initial water depth until the bridge is completely submerged after that the forces almost remain constant for d 0 48 and 0 50 m negative horizontal forces remain stable with changes in wave heights however for partially submerged cases that is d 0 52 0 54 and 0 56 m there is again an increase in force with larger wave heights negative force for d 0 56 m is the largest among the three cases when h 0 17 m for the case that h is greater than 0 17 m the force is the smallest among the three for fully submerged conditions negative forces are affected profoundly by nonlinear effects but do not change much as wave height varies 2 4 analytic equation of maximum solitary wave force based on experimental data this section presents the experimental measurements using the dimensionless parameter wave steepness s which is calculated as the ratio of wave hight h to wave length λ fig 15 shows the results for the no girders cases it is obvious that for the values of d a good linear relationship can be found between uplift wave forces and wave steepness the wave steepness can also be derived from h and d based on generation wave theory discussed in section 2 as follows 5 s h λ 0 114 h d 3 2 figs 16 a and b present the results for unsubmerged cases and partially or fully submerged cases for deck with girders cases respectively the linear relationship is well observed as well thus an analytical equation for the quantification of uplift wave force is proposed as 6 f u a γ s γ r s b a γ s γ r h d 3 2 b where f u the uplift wave force γ s and γ r parameters accounting for dimensions of bridge superstructures and relative position of the bridge and swl and a and b fitting coefficients similar linear relationships can also be found with respect to the horizontal positive force f p therefore wave steepness s might be adopted as an important parameter in calculating solitary wave loads by introducing steepness s the wave induced force could be estimated more concisely and precisely 3 numerical investigation in addition to the experiments the numerical studies are also conducted in this paper by comparing the results from experiments and numerical calculation the numerical methodology could be verified then variable scales and scenarios can be assessed in this section the computational fluid dynamics cfd modeling and validation of numerial models are introduced all the cases are calculated using the commercial software ansys fluent v 17 2 ansys inc 2016 to solve the fundamental partial differential navier stokes equations hamza et al 2015 xu et al 2016b 2017b model setups and boundary conditions for both 2d and 3d models are presented to better capture the turbulent fluctuations of bridge deck wave interactions the shear stress transport sst k ω model is used as the turbulence closure for the reynolds averaged navier stokes rans equations menter 1994 for the setups of the sst k ω model in ansys fluent the pressure based solver segregated is chosen for the transient flow which is good at resolving incompressible fluid motion for the velocity inlet boundary outlet boundary and top boundary the turbulence intensity and turbulent viscosity ratio are set as 2 and 10 respectively the pressure implicit with splitting of operators scheme piso is used for the pressure velocity coupling method bricker et al 2011 2014 and the pressure staggering option presto scheme is utilized for pressure spatial discretization due to its good performance dealing with irregular complex interface of the structure model least squares cell based scheme is used for the gradient discretization the second order upwind is utilized for calculating the momentum volume fraction turbulent kinetic energy and specific dissipation rate murillo 2008 such second order upwind also has good convergence during the calculation process the volume of fluid vof method is used to determine the dynamic free surface hirt and nichols 1981 the water particle velocity components u and v and the free surface profile η are sarpkaya and isaacson 1981 input by using user defined functions udf similarly the solitary wave crest is located at x 0 when t 0 s thus in order to more accurately simulate the wave profile the solitary wave should be shifted leftward by utilizing a coefficient t 0 to adjust t as indicated in eq 4 in this way the water surface can increase gradually at the inlet boundary and a fully developed solitary wave profile can be generated 3 1 numerical model set up to ensure the efficiency and accuracy of the numerical model a mesh sensitivity study is conducted based on the analysis the cell dimensions are determined as dx 0 005 m and dz 0 005 m the fixed time step dt 0 002 s is adopted to satisfy the requirement of the courant number a small dt may also affect the accuracy of calculating vertical wave force bozorgnia and lee 2012 in order to save the computation time especially for 3d model meshes for the top air zone deep water zone and near outlet zone are relatively coarsen fig 17 a shows the schematic diagram of the 2d numerical domain of the 1 30 bridge model the total numerical domain is 1 5 m in height and 10 m in length which is long enough to eliminate wave reflection effect line cd is the swl separating the interface of air and water line ab is set as pressure outlet with the constant atmosphere pressure i e 101 325 pa line ae is the velocity inlet with input velocity controlled by the user defined function line ef is the no slip stationary wall condition and line bf acts as the pressure outlet to keep the balanced pressures for the air and water zones fig 17 b shows the 3d numerical model of the deck with girders compared with the 2d model in order to reduce the number of total grids and calculation time a symmetry plane is used in the middle of the model plane abdc is the velocity inlet where solitary waves are generated using the udf functions similar as the 2d numerical method plane efhg is the pressure outlet to keep a free water surface level at the end of water flow and to reduce the influence of wave reflections plane abfe is set as the pressure outlet to apply a constant atmosphere pressure of 101 325 kpa plane cdhg and bdhf are no slip walls to simulate the bottom and the side of the tank respectively plane acge is the symmetry plane to speed up the calculation the bridge model is also half of the original model and set at the symmetry plane other parameters are similar with the 2d numerical model 3 2 model validation to verify the accuracy of the numerical model a comparison of solitary wave profiles generated by ansys fluent with the laboratory measurements is shown in fig 18 positions of three wave gauges and bridge model are shown in fig 18 a the initial water depth is set as 0 5 m and the expected wave height is 0 15 m due to different setting positions and slight friction resistance caused by the sidewall of wave channel the readings of these three wave gauges and the time to peak are slightly different numerical results are also presented in fig 18 b as indicted little but reasonable differences are observed 4 comparison between numerical results and experimental data in this section several cases are chosen for detailed comparison between experimental data and numerical analysis the performance of 2d and 3d models the effect of girders and trapped air and the causes of the secondary impact are discussed 4 1 comparison of peak forces computations are performed for all the experimental cases the 2d numerical result for one typical case d 0 50 m is presented for illustrative purpose as indicated in fig 19 both numerical and measured results for deck with and without girders are presented for small wave height h 0 15 m the agreement is good for both models but obvious deviations occur for the deck with girders after h reaches 0 15 m while the no girders cases still match well this may be caused by the limitation of the 2d model in dealing with the effects of trapped air in general the 2d model would reveal larger uplift forces for the girder deck under all the wave heights comparisons between the results from the 3d numerical model and experimental measurements under different submergence scenarios are presented in fig 20 results for unsubmerged conditions are illustrated in figs 20 a and b a monotonic relationship between the uplift forces f u and positive forces f p with the wave height h is observed the 3d model provides good results for wave heights from 0 13 to 0 18 m while for other cases h 0 13 m the numerical model provides slightly larger values fig 20 c and d show the results associated with partially submerged conditions experimental data and numerical results match well for f u with respect to f p the numerical results are smaller for large wave heights h 0 15 m for fully submerged conditions presented in fig 20 e and f good agreements are observed except for f u under small wave heights h 0 12 m in summary the 3d numerical model provides more reliable results for most of the cases compared with the 2d model it could better simulate the trapped air and uneven force distribution on the bridge deck 4 2 comparison of force time histories in order to have a better understand in the differences between numerical analysis and experiments a comparison of wave force time history for the deck with girders is shown in fig 21 both computational models match the experimental data well but the 3d model provides an improvement over the 2d model the 3d model captures the vertical forces very well improving upon the estimation of the 2d model both at more precise peak value and the secondary impact for the 2d model it fails to account for the complicated wave deck interaction caused by irregular contact shape forced area and trapped air the 2d model cannot simulate the air discharge in transverse direction before the wave crest arrives and overestimates uplift force caused by compressed air between girders generally the 2d model is adequate to reproduce simple wave flume experiments in which the structural dimension is simple and regular and provides conservative calculation results for a complex structure such as irregular shapes with girders bridge deck with combination of skew and slope or a bridge spanning with non uniformities results with 2d model may be inaccurate or impractical the 3d model should be adopted for these cases to achieve more accurate results 4 3 comparison of wave profiles the wave profiles during the wave structure interaction from the 2d model 3d model and experiment for the same case with wave height h 0 15 m are demonstrated in fig 22 the solitary wave comes from the right side to the left in these figures in the numerical cross sectional domain the blue represents air red represents water and other colors in between represent the mixture of water and air according to the vof method when the solitary wave approaches and first exceeds the top of deck overtopping occurs water splashes and waveshape deforms this could cause the first impact on the bridge deck then after the first impact the wave keeps moving forward with splashes resulting in mixed fluid phases around the deck during this phase as the water level gradually rises the air between the water and the bridge is first trapped and then squeezed out from both the wave direction and the gaps between the girders in x and y directions the bubbles are observed during the experimental studies as indicted in fig 22 c the partial release of trapped air may cause structural unequilibrium as well as the secondary impact measured in force time histories the trapped air between the deck and girders is simulated in the 2d model but the 2d model fails to capture the dynamic air escape process due to the model limitation in y direction under this condition the trapped air could cause an overestimation of the total forces which agrees with the results of previous study xu et al 2017a the 3d model successfully simulates the water air interaction owing to its spatial scalability and it could simulate the mixture of these two phases beneath the deck therefore the 3d model could provide more information on the calculation of peak force and better capture the force time series and the secondary impact 5 conclusions this study focuses on the experimental and numerical analyses of solitary waves on bridge superstructure specifically the experiment of the wave force on bridge superstructure was performed at the hydraulics laboratory both 2d and 3d numerical analyses were conducted to have a comparison on their performance in simulating this process bridge models with and without girders were tested to further assess the effects of girders and trapped air an analytical equation is proposed to compute the wave induced force by incorporating the dimensionless wave steepness parameter the results from the series of investigations show that for the deck without girders model in unsubmerged cases vertical uplift forces and horizontal positive forces are approximately proportional to wave height but decrease with larger initial water depth vertical downward forces and horizontal negative forces tend to decrease first and then increase as the wave height increases for most of the unsubmerged cases for submerged cases all these values have a near linear relationship with the wave height for the deck with girders group the vertical uplift forces increase with wave heights in the unsubmerged partially submerged and fully submerged cases they increase fastest in unsubmerged cases and slowest in fully submerged cases as indicated the influence of wave height is much more obvious in shallow water similar trend can be observed for horizontal positive forces as well vertical uplift forces and positive horizontal forces are relatively smaller when the wave crest has little or no interaction with the bridge deck maximum values are observed when the wave crest has a similar height of the bridge it can be concluded that such interaction contributes significantly to force magnitude a secondary impact which may be caused by the trapped air is observed for the case of deck with girders in addition after conducting the dimensionless analysis we found a linear relationship between wave forces and wave steepness based on experimental data an equation is proposed to compute the solitary waves induced force on bridge superstructure with respect to the numerical analysis the 2d numerical analysis and experimental measurements shows good agreement for most cases except for some cases where trapped air may play an important role the 3d model captures the wave forces better improving upon the estimation of the peak value and secondary impulse compared with 2d model in addition the trapped air is better simulated in the 3d model providing a more reliable result for a complex structure such as irregular shapes with girders bridge deck with combination of skew and slope or a bridge spanning with non uniform cross section the 3d model should be adopted to assess the peak value and the entire loading process from the measurements calculations and comparisons of all the data the following conclusions and suggestions are made 1 solitary wave forces on bridge decks consist of uplift and positive forces for the investigated cases the uplift forces are larger than downward and negative forces 2 for the experimental model the existence of girders increases total wave loads on the superstructure the bluff profile also leads to severe wave deck interaction and structural vibration dynamic response analysis of bridge under extreme conditions is necessary 3 a secondary impact after the first peak associated with the wave force is observed which may be caused by the release of the trapped air between girders beneath the deck such impulse may occur with a large overturning moment simultaneously and may cause damage and failure to the bridges 4 the secondary impact force may be caused by the release of trapped air between girders and it becomes smaller for larger initial water depth with less trapped air the maximum force decreases much more severe than the reduction of the secondary impact force as the initial water surface rises the maximum force decreases significantly while the secondary peak changes little the maximum uplift force is almost twice of the second peak in unsubmerged case but they are almost the same in the partially submerged case and fully submerged case 5 solitary wave loads can be assumed to be proportional to the wave steepness and the relevant coefficients can then be determined based on relevant parameters 6 wave steepness deserves more attention in calculating tsunami and hurricane wave loads for instance it can be used as an intensity measure for the structural performance assessment 7 the 3d model has a superior performance in simulating the water air interaction during the wave process and provides relatively more accurate results with an improved 3d model it is possible to deal with bridges with slopes and curves future study should carefully consider the following aspects structural dynamic analysis by considering substructure and connection between the superstructure and substructure 3d numerical analysis to further investigate the trapped air effect and 3d experimental investigations to examine the 3d fluent numerical model by considering the oblique interactions between the solitary waves and bridge decks credit authorship contribution statement deming zhu conceptualization methodology software writing original draft you dong supervision investigation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the study has been supported by the hong kong polytechnic university under start up fund number 1 ze7q the research grant council of hong kong ecs project no polyu 252161 18 e and key special project for introduced talents team of southern marine science and engineering guangdong laboratory guangzhou gml2019zd0503 the opinions and conclusions presented in this paper are those of the authors and do not necessarily reflect the views of the sponsoring organizations 
21793,this paper investigates the numerical prediction of cavitation and hull pressure pulses induced by a marine propeller operating in behind hull conditions of a container vessel in model scale simulations are performed using commercial package star ccm and opensource package openfoam using rans approach and predictions are compared with experimental measurements a mesh dependency study with respect to wake prediction is also presented operating conditions scaled to two different reynolds numbers with the same propulsion characteristics and cavitation number are considered to study scaling effect simulations using tip refined mesh are performed and compared with using base mesh to study the tip vortex generation tip vortex cavitation its interaction with sheet cavity and induced pressure pulses the influence of time step length is also investigated star ccm and openfoam predict consistent results the predicted cavitation patterns agree well compared to experimental measurements as well as pressure pulse levels up to 3 4 times blade passing frequency bpf especially for the predictions with tip refined mesh the sheet cavitation is the major contribution to 1 st and 2 nd order bpf pressure pulses and its closure has significant contributions to higher order pressure pulses deduced pressure pulses by tip vortex cavitation tvc are significant ranging from 3 rd order to 10 th order of bpfs the tvc induced pressure pulses are related to its violent bursting behavior which is influenced by the closure of the sheet cavity keywords marine propeller cavitation hull pressure fluctuation tip vortex cavitation rans 1 introduction for operating marine propellers the thrust is related to the pressure differences that are created on the two sides of the propeller blades via the rotational motion of the curved blades this results in a rotating spatial distribution of pressure that generates pressure variations on the hull body which is one of the major sources of hull vibration and on board noise as well as pressure waves in the surrounding medium the pressure on the propeller blades can drop below water saturation pressure and tension force would break the water medium known as cavitation which contributes significantly to these side effects due to rising concern to the welfare and comfort of on board crew and passengers and environmental impact to sea creatures these operating propeller related side effects are getting more attention hull vibration and onboard noise are highly dependent on propeller induced hull pressure pulses acoustic analogies are commonly used for under water noise prediction which rely on the prediction of near field pressure fluctuations and there are studies showing high similarity between the two foeth and bosschers 2016 the quest for higher efficiency propeller design also calls for more accurate estimations of pressure pulses as there is often a trade off between the two nevertheless the prediction of pressure pulses is still a challenging task because of the complexity of involved psychical phenomenon including the interaction between the ship wake and propeller blades and different types of cavitation the propeller induced pressure pulses are usually in phase with blade rotation thus the pressure pulse levels are commonly analyzed in orders of blade passing frequency and fast fourier transformation fft is widely used to study pressure pulse signals in the frequency domain it is believed that the 1 st and 2 nd order bpf fluctuations are caused by the blade thickness and load and growth shrinkage of propeller sheet cavitation under cavitating conditions for 3 rd and higher order pressure pulses there are no well established mechanisms and knowledge is still building on but it is widely believed to be induced by tip vortex cavitation tvc related phenomenon as indicated by various experimental studies berghult 2000 experimentally studied induced noise of a series of high skew propeller models in behind condition and found that tip vortex cavitation contributes to pressure pulses ranging in between 3 rd to 12 th order bpfs pereira et al 2004 studied the model scale propeller e779a under non uniform inflow experimentally and one of the deductions was that tip vortex cavitation contributes mainly to the 3 rd order pressure pulse more recently in the study by aktas et al 2018 the tip vortex cavitation was found to increase pressure pulse levels in the frequency range 400 hz 2000 hz including the tonal values and broadband values approximately equivalent to 3 rd to 13 th order for the model scale propeller pennings et al 2015 deduced that strong excitation is a must for the tvc to generate pressure pluses efficiently including the phenomena which was termed singing vortex by maines and arndt 1997 furthermore the analytical model for vortex cavity deformations by bosschers 2008 and later studies by pennings et al 2016 indicate that the active pulsing source comes from tip vortex cavitation inside the wake which deforms in a standing wave manner the acoustic active tvc was deduced to generate pressure pulses as monopole acoustic sources which is the same for sheet cavities in the study by english 1980 tip vortex bursting was found to contribute substantially regarding hull pressure pulses and later in the study by konno et al 2002 tip vortex bursting was experimentally found to be significantly influenced by the wake and its peak where the propeller was operating in this phenomena is found to be influenced by the mechanisms that is termed sheet cavity closure in the studies by bark and bensow 2013 in which conceptual models of cavitation mechanisms regarding erosion were proposed including interactions between sheet cavity and tip vortex cavitation this tvc bursting could be highly influenced by the re entrant flow induced by sheet cavity collapse the tvc destruction by sheet cavity collapse is very common on ship propellers kuiper 2001 further in van wijngaarden et al van wijngaarden et al 2005 various possible mechanisms were discussed regarding tip vortex cavitation induced pressure pulses also sheet cavitation may contribute to higher order pressure pulses aktas et al 2018 found that sheet cavitation including its collapse and rebounding contributes not only to blade frequency but also to high order pressure pulses variation in cavitation between revolutions can also contribute to the higher order broadband pressure pulses and reduces the tonal values bosschers 2009 moreover the tip clearance between the propeller blade tip and hull is another parameter that may be dominating in certain cases as studied by bensow and gustafsson 2017 the interaction between tip vortex cavitation and the rudder can also be pronounced as the tip vortex cavitation can be trapped in the gap between the rudder and the rudder horn the collapse here can induce significant levels of pressure pulses as noticed by e g shin and andersen 2018 full scale ship measurement can provide the most reliable levels of induced pressure pulse and radiated noise but it is usually difficult to exclude the influences from sea states besides due to the low transparency of sea water and limitation of view angles the cavitation patterns can usually not be seen clearly which is of vital importance to perform detailed studies regarding the mechanisms behind the phenomenon tani et al 2016 furthermore it is usually desired to predict the pressure pulse levels before the real ship is build due to these reasons the model scale testing is widely used as an alternative to full scale measurement several experimental approaches have been developed to study and estimate propeller induced pressure pulse levels the first type of configuration have similarities with propeller open water test pot in cavitation tunnels the model scale propeller is tested in a cavitation tunnel where either upstream meshes or panels would be installed to mimic a ship wake or the propeller could be mounted on an inclined shaft to create load variation such medium size cavitation tunnel test still plays a major role to study the flow around the blades cavitation and induced pressure pulses etc in the second type of configuration the hull is included by placing the model scale ship hull in the cavitation tunnel and thus allowing the propeller to operate in the ship wake this is often referred to as large size cavitation tunnel test moreover instead of using a cavitation tunnel the model scale ship hull and propeller could be tested in a towing tank which need to be depressurised allowing the cavitation and pressure pulses to be tested during a model scale self propulsion test thus the free surface could be included and froude number should be maintained when scaled to model scale compared to the condition in cavitation tunnel the reynolds number is then several times lower model scale testing may take weeks to months and the manufacture of models are costly this is acceptable in the final verification stage where models are anyway produced but limiting in early design work besides scaling effects emerging as challenging including wake difference water nuclei content and distribution differences and the existence of laminar transitional flow over blades with the increase of computational resources especially during the past decade numerical methods are developing rapidly as a supplement and alternative which is typically faster cheaper and may provide more detailed flow information compared to model testing the potential flow theory based numerical methods are widely used for pressure pulse predictions where the nominal wake is provided from experiments or viscous cfd predictions or the potential flow solver is coupled to a viscous cfd code as the ship wake is essentially a viscous effect however by theoretical limitations only attached sheet cavitation can be predicted with potential flow codes this has lead to the development of special treatments for the predictions of tip vortex and tip vortex cavitation including berger et al 2016 lee and kinnas 2004 and bosschers 2018 viscous cfd solvers are becoming more widely used for more accurate numerical predictions reynolds averaged navier stokes equations rans has long been used for pot simulations and self propulsion simulations together with mass transfer models accounting for cavitation and satisfying predictions have been achieved thus in many studies this approach has been used for pressure pulse predictions e g paik et al 2013 and perali et al 2016 for both medium size cavitation tunnel test and large size cavitation tunnel test the numerical prediction of sheet cavitation usually agrees well when the propeller is operating inside representative wakes but for medium size cavitation test with inclined shafts without the existence of significant wake variation less accurate predictions are not rare e g perali et al 2016 and asnaghi et al 2018 with over prediction of the extent of the sheet cavity this is likely to be related to scale effects in the tests with the existence of laminar boundary layers in model scale suppressing the formation of attached sheet cavitation it is generally believed that the capacity of a rans approach regarding hull pressure pulse predictions would be limited to 2 n d order bpf due to its diffusive prediction of tip vortices thus scale resolving simulation approaches were used in the studies by fujiyama 2015 li et al 2015 sakamoto and kamiirisa 2018 and li et al 2018 where predictions of higher order pressure pulses were reported meanwhile there are also studies showing little differences between rans and ddes for cases mainly with sheet cavitation hur et al 2018 les and dns are still too expensive for this kind of predictions bensow and liefvendahl 2016 studied under water noise generated by an operating propeller in behind condition using wall modelled implicit les and suggested hundreds of millions of cells would be needed to achieve expected resolution requirements in asnaghi et al 2017 the iles approach was compared with rans regarding tip vortex predictions for a stationary foil and in hsiao and chahine 2008 dns was applied in limited tip vortex zone with rans as the background solution and compared with rans regarding tip vortex predictions in both studies rans predicted generally a more diffusive tip vortex but within a limited distance downstream the foil say around 5 chord length the minimum pressure agreed well with the more advanced predictions this implies the prediction of sheet cavitation tip vortex cavitation interaction could be possible using rans approaches in the present study a generic 3600 teu standard container vessel with representative design is considered the container vessel was developed in the year 2002 and used in the virtue the virtual tank utility in europe and sonic suppression of underwater noise induced by cavitation eu projects the referenced experiments including pressure pulse measurements and cavitation pattern recordings were performed at hsva hamburgische schiffbau versuchsanstalt and new numerical predictions are presented from simulations with the open source package openfoam v1806 and commercial package star ccm v12 06 010 using a rans approach the first objective of this work is to analyse the capability of the rans approach regarding 1 s t and 2 n d order pressure pulse predictions the second objective is to compare the predictions using a base line mesh and applying mesh refinement at the blade tip region in a limited distance downstream the blade tip to study and further analyse the interactions between tip vortex cavitation and sheet cavitation since reasonable predictions including also higher order pressure pulse levels are predicted we also discuss the mechanisms that are noted to contribute to the higher order fluctuations which are resolved by the rans approach the third objective is to study the influence of reynolds number on the predictions by considering two equivalent model test conditions corresponding to a cavitation tunnel like condition and a towing tank like condition in both conditions the non dimensional thrust coefficient k t and cavitation number σ are the same additionally a mesh resolution study was performed regarding nominal wake prediction the influence of advancing time step to pressure pulse predictions is also presented 2 case description the container vessel is equipped with a single five bladed high skew fixed pitch propeller and the main dimensions and geometry characteristics are summarized in table 1 experiments were carried out in the cavitation tunnel hykat at hsva with a test section size of 11 m 2 8 m 1 6 m which is large enough for the installation of the whole ship model the ship model was manufactured by hsva with scale ratio of 1 29 1 and was installed into hykat according to even keel draft of 11 3 m corresponding to the ship scale conditions the free surface was substituted by wooden plates to compensate for the deceleration of the flow due to the tunnel ceiling boundary layer the model scale ship draft was increased with 50 mm there were 13 pressure sensors installed on the ship hull above the propeller to measure propeller induced pressure pulses as shown in fig 1 the shaft speed of the model propeller was fixed to n m o d 28 rps during the experiments which result in a blade reynolds number of r e 1 52 10 6 with the inlet velocity of the cavitation tunnel adjusted to match desired non dimensional thrust coefficient k t and the pressure adjusted to the desired non dimensional cavitation number σ at 0 8r with blade in 12 o clock position the thrust coefficient and cavitation number is defined as 1 k t t ρ n 2 d 4 σ p p v 0 5 ρ π n d 2 pressure pulse measurements were carried out in several service conditions both with and without cavitation corresponding to full scale ship cruising speed of 23 76 knots 20 knots 18 knots and acceleration k t 5 deceleration k t 5 at 20 knots the cavitation number was fixed to 0 2354 for the cavitating conditions via tunnel depressurization the measurements without cavitation were conducted at atmospheric pressure for the condition under design speed 23 76 knots the 1 s t to 3 r d order pressure pulses were quite significant due the large cavitation volume and tip vortex bursting while for the rest of the conditions the hull pressure amplitudes were very low for both non cavitating and cavitating conditions 1 kpa in full scale the studied service condition corresponding to full scale ship is presented in table 2 3 simulation design 3 1 conditions and meshes the condition with thrust coefficient k t 0 2234 and fixed propeller rotation speed n m o d 28 rps leads to a derived velocity inlet speed of around 7 3 m s accordingly the calculated reynolds number based on ship hull is 5 8 10 7 and based on the propeller chord length and velocity at 0 75r is 3 1 10 6 for the condition in the cavitation tunnel by applying the froude scaling rule considering the scale ratio 1 29 1 and full scale ship speed of 23 75 knots the speed of the model scale ship is calculated to be 2 2 m s and the propeller speed adjusted to thrust identity at k t 0 2234 gives n m o d 2 8 5 rps in the latter configuration the calculated reynolds numbers based on the hull and propeller become 1 8 10 7 and 9 5 10 5 respectively this configuration corresponds to the condition in a towing tank both configurations are considered in the present study and the two conditions are summarized in table 3 the calibration of inlet velocities and rotation speeds are conducted via star ccm simulations similar to the experimental procedure the propeller rotation speeds are fixed to 28 rps and 8 5 rps and several simulations with varying inlet velocities are performed for each calibration run steady state simulation with 6000 time steps with mrf moving reference frame approach is performed first after that the rbm rigid body motion of the propeller region is activated and simulation runs for 8 revolutions time using euler time advancing with time step equivalent to 1 512 revolutions more strict numerical settings are used for the simulations presented in the present study and the relative differences for k t are 1 7 for condition 1 and 1 5 for condition 2 similar to the experimental settings the test section in the cavitation tunnel is used as the computational domain with size 11 m 2 8 m 1 6 m for both conditions the draft of the model scale ship is 43 83 cm which correspond to the full scale ship draft of 11 3 m with 5 cm margin to the top plate an overview of the computational domain can be found in fig 2 the domain is divided into two sub domains inner domain includes the rotating propeller and outer domain includes the ship hull and the tunnel section the two subdomains are connected via sliding interfaces to account for the rigid body motion of propeller rotation the prediction of the wake has significant impact regarding predictions of blade load blade pressure distribution cavitation and pressure pulses structured grid with 4 million cells for a half ship in model scale without free surface and appendages is deemed to be needed for reasonable nominal wake prediction using rans according to the ittc recommended procedures and guidelines practical guideline 2014 since the wake was not measured in the cavitation tunnel a mesh dependency study regarding nominal wake prediction was conducted before proceeding with pressure pulse assessment several meshes were systematically generated for the outer region and four meshes are used in the present study which are numbered from m1 to m4 m1 m2 m4 are generated using the star ccm built in trimmer mesher and m3 is partly structured and generated using pointwise m1 here serves as a selected base mesh that generally follows the ittc recommendations this mesh contains 4 million cells for the half domain there are 37 prism layers applied on the hull surface with constant growth ratio of 1 2 and average y of about 0 8 this leads to a total y of around 3500 for the total prism layer height the surface element sizes are calculated based on the size of the last prism layer height more precisely for the fore body and aft body region the surface element size is about 2 times the last layer cell height and this assures the prism layer core mesh transition ratio does not exceed 2 the surface element size is about two times larger in the parallel mid body region for these simulations as there is no propeller a cylinder block with uniform cell size is applied which encloses the wake where the propeller would be operating in the cell size in this cylinder refinement region is equivalent to the last prism layer height which is about 1 65 of the propeller diameter this leads to about 200 points in the tangential direction at the rotation interface outer radii m2 is a globally refined version based on m1 global refinement of 0 64 was applied while the prism layers vertical distribution was not changed which leads to a similar mesh with prism layer core mesh transition ratio of 1 3 and totally 12 million cells for half the hull m4 similarly as for m2 is a globally refined mesh of 0 8 based on mesh 1 while the number of prism layers is reduced to 24 with constant growth ratio of 1 2 the mesh is generally finer than mesh 1 but the prism layer core mesh ratio is quite large the total number of cells is 5 6 million for the half domain m3 was generated using pointwise with a semi structured meshing approach it can be regarded as a finer version based on ittc recommendations and a close view of the mesh at aft body and wake plane is shown in fig 3 this mesh consists of 27 8 million cells for the whole ship and tunnel section the summary of cell counts are shown in table 4 regarding meshes for simulations with the inclusion of the propeller and rudder structured conformal grids were generated on the hull body upstream the propeller and downstream of the rudder in the same way as m3 a closer view of the mesh in the aft body region is shown in fig 4 structured conformal grids were also used for the prism layers around propeller blades and rudder which are extruded from structured surface mesh using hyperbolic extrusion tetrahedral cells were used to fill the rest of the space these meshes were generated using pointwise mesh resolution is increased downstream the blade tips via helix like tube refinements with structured mesh blocks to have better flow predictions including tip vortex tip vortex cavitation and their interactions with sheet cavitation the views of the base mesh and tip refined mesh are shown in fig 5 the tip refined structured tubes have the smallest cell located in its core with size 0 086 mm 0 086 mm 0 8 mm and expands on the radial and axial directions summary of cell counts is shown in table 5 the inclusion of tip refinement lead to additionally 6 million cells 3 2 numerics both the commercial package star ccm v12 06 010 and open source package openfoam v1806 were used to perform numerical simulations for the openfoam simulations a modified version of the interphasechangedymfoam solver was used the single fluid homogeneous mixture approach is used to represent the two phases of water and vapor as 2 ρ m α l ρ l 1 α l ρ v μ m α l μ l 1 α l μ v α l α v 1 in which the subscripts l and v represent liquid phase and vapor phase quantities respectively ρ represents density μ represents dynamic viscosity and α represents volume fraction of the phase the transport equation of α consists then of convection with mass transfer source terms as 3 α l t α l u m ρ l 1 ρ l α l 1 ρ l 1 ρ v m α l 1 ρ l 1 ρ v m for the rans method the conservation equations of mass and momentum for the homogeneously mixture fluid are 4 ρ m t ρ m u 0 5 ρ m u t ρ m u u τ ρ m u u p f s and the boussinesq hypothesis is used for reynolds stress tensor ρ m u u modeling 6 ρ m u u μ t u u t 2 3 ρ m k i where u represents time averaged velocity u represents the time varying fluctuating component of velocity μ t is turbulent viscosity f s represents body forces ρ m for mixture density τ represent averaged stress tensor and i represents identity tensor the vapor density ρ v and water density ρ l are assumed to be constant while the mixture density ρ m is calculated based on volume fractions α l and α v turbulent viscosity is modelled using the k ω s s t turbulence model as μ t ρ m k t where t represents turbulent time scale and k represents kinetic energy the turbulent time scale is calculated as min a ω a 1 s f 2 in which a a 1 are model constants f 2 is a blending function s is the absolute value of the strain rate and ω represents specific dissipation rate both k and ω are modelled via additional reynolds transport equations the implementation of k ω s s t turbulence model in star ccm is based on menter 1994 menter 1994 with s in definition of the eddy viscosity instead of the vorticity and furthermore durbin s limiter durbin 1996 is used as the limiter while both modifications concerns the calculation of t in openfoam the implementation is based on menter and esch 2001 menter and esch 2001 with updated coefficients from menter et al 2003 menter et al 2003 due to the existence of strong pressure gradient and geometrical curvatures of the ship aft body the boundary layer is resolved instead of using wall functions wall resolved boundary layer requires y value smaller than 1 which is fulfilled based on condition 1 same meshes were used for condition 2 and the y value would be roughly four times smaller gravity is ignored in the present study the cavitation mass transfer model by schnerr and sauer 2001 is used in both codes the mass transfer term in equation 3 is decomposed into two terms as 7 m α l m a v 1 α l m a c while the two terms m a v and m a c are derived based on uniformly distributed spherical nuclei and simplified rayleigh relations as 8 m a c c c α l 3 ρ l ρ v ρ m r 2 3 ρ l 1 p p t h r e h o l d max p p t h r e h o l d 0 9 m a v c v 1 α n u c α l 3 ρ l ρ v ρ m r 2 3 ρ l 1 p p t h r e h o l d min p p t h r e h o l d 0 in both packages simulations start with steady state mrf converged solution and then the rbm follows with first order implicit time advancing scheme and larger time steps sampling of results from the simulations then starts from the developed flows with second order implicit time advancing scheme and smaller time steps after the non cavitating simulations the mass transfer model would be included with gradually increased vaporization factor c v and after that the cavitating condition predictions are collected the pressure velocity coupling is solved using simple algorithm in star ccm while the pimple algorithm is used in openfoam which is a combination of simple and piso algorithms in star ccm simulations the least square momentum residuals are controlled below 5 10 5 in non cavitating simulations in openfoam the pressure residual are controlled below 10 6 and for cavitating conditions more strict control was used amounting to 10 12 due to the appearance of mass transfer source term in the pressure equation the convection of velocity in the momentum equation is discretizatized using second order schemes which are limitedlinearv 0 33 and second order in openfoam and star ccm respectively the convection of turbulence terms are treated using upwind scheme in openfoam and 2 nd order upwind scheme in star ccm for gradient calculations in openfoam gauss theorem with linear interpolation is used without limiters while in star ccm the hybrid gauss and least square method based on local cell quality with venkatakrishnan limiter is used implicit second order euler upwind time scheme is used for time advancing in both packages which is referred to as backward in openfoam and second order in star ccm respectively 4 results 4 1 wake prediction the predicted nominal wake with the four meshes using the steady state solver in star ccm in condition 1 are summarized in fig 6 and line plots of u x u i n at 0 5d 0 7d and 0 9d are plotted together in fig 7 to recollect m2 is a refined version of m1 and m3 is a rather fine mesh generated using a different mesh topology and package while the differences between these three meshes are small noticable differences are found in the angular position ranging from 60 to 40 with up to 3 4 of wake fraction and around angular position 5 0 where the structured m3 mesh is rather fine some kind of stagnation effect is predicted locally when using the steady state solver with full ship configuration in m3 however using m4 a rather different wake was predicted even though it consists of more cells than the base mesh m1 the other three meshes predicted u shape wakes while a v shape wake was predicted here in m4 24 prism layers were applied on the ship hull with y around 0 8 for the first cell layer and it is estimated that the total y value for the prism layer is around 300 thus the transition of grid size becomes rather abrupt between prism layers and the core mesh the sudden increase of cell size greatly influences the boundary layer development around the hull and the diffusive predictions lead to a v shape like wake this transition ratio could be reduced by decreasing surface element size but a rough estimation leads to a needed mesh size of around one hundred million cells with 24 prism layers y around 0 8 and transition ratio below 2 0 using trimmer like mesh topology without special treatments the frictional forces predicted using the four meshes are listed in table 6 the differences between m1 to m3 are very small but around 7 under prediction could be found when using m4 since in m4 a v shape like wake the propeller load blade residence time in wake peak cavitation and cavitation development would be significantly influenced consequently the prediction of pressure pulse levels would be expected to be significantly under predicted for simulations using a mesh similar to m4 4 2 non cavitating conditions the predicted pressures were recorded via point probes at the same locations as the pressure transducers arrangements in the experiment the predicted model scale pressure values are scaled to full scale values via a simple non dimensional scaling i e the non dimensional coefficient k p is calculated using model scale values and k p is assumed to be constant between different scales following equation 10 10 k p p ˆ m ρ m n m 2 d m 2 p ˆ s k p ρ s n s 2 d s 2 fast fourier transformation fft is used to decompose the pressure signal p ˆ s into blade passing frequency harmonics the predicted 1 st and 2 nd order pressure pulse levels are summarized in fig 8 together with experimental measurements shown in corresponding full scale values the recorded pressure pulses are predominantly in the 1 st order bpf while the 2 nd and higher order pressure pulse levels are very small numerical predictions agree with experimental data both regarding the overall spatial distribution and amplitudes some noticeable discrepancies are noted at transducer numbers 2 6 and 10 the maximum absolute difference is about 0 4 kpa which is small while the relative difference amounts to 30 40 the predicted non cavitating pressure pulse levels show very small differences regarding the two operating conditions though the reynolds number differs about 3 times the prediction difference between two numerical packages is also very small which is comforting considering the differences in the numerical algorithms and discretization schemes as discussed in section 3 2 additionally there is no significant difference between tip refined mesh and base mesh regarding induced pressure pulses at the 1 st and 2 nd order bpfs nevertheless the tip vortex structures were predicted rather differently for the two meshes the predicted tip vortices and local flow properties predicted by star ccm and openfoam are shown in fig 9 for both operating conditions normalized q criterion q n is used to visualize and compare the vortex structures between the two operating conditions 11 q n q d m 2 π n m d m 2 the iso surfaces of q n 1292 q n 646 and q n 129 are presented with decreasing opacity with the tip refined mesh a main tip vortex is predicted with some secondary vortex structures surrounding it cuts of tip vortex regions are colored by non dimensional pressure coefficient k p and as shown in the frames the local pressure is low and concentrated inside the tip vortex center the velocity vectors are also plotted as black arrows which demonstrate local fluid circulation upstream the main tip vortex a vortex structure originating from the leading edge can be found which is commonly referred to as a leading edge vortex for the base mesh there is not much influence on the leading edge vortex predictions but the predicted tip vortex is very diffusive and local flow dynamics are much weaker small prediction differences can be found between the two packages as the predicted main tip vortex is slightly more diffusive in openfoam than in star ccm as well as the predicted secondary structures 4 3 cavitating conditions 4 3 1 predicted cavitation patterns the predicted cavitation patterns iso surface of α l 0 5 are shown in fig 10 together with experimental recordings in the experiments the camera shooting frequency were set to orders of propeller revolution and variations of cavitation pattern between revolutions can be found for the same blade position in the recorded video these variations can be found on all the blades while there is no phenomenal differences between the blades representative frames are selected and shown for blade phases between 10 and 58 counting from 0 at 12 o clock position and increasing anti clockwise viewed from the propeller suction side experimental recordings show that the sheet cavitation is the pronounced cavitation phenomena the sheet cavity interface is sharp and clear while a convex vapor structure could be found moving from the blade leading edge to the blade trailing tip originate at the blade position where the sheet cavity starts to form the sheet cavity decrease after blade position of 40 around 40 48 coincident with the time when the convex vapor structure reaches the blade tip end the tip vortex cavitation start to develop significantly and become quite unstable bursting displaying a rather complex flow dynamics after that the tip vortex cavitation is back to a relatively stable state around blade phase of 58 the numerical predictions of sheet cavitation agree well compared to experimental recordings especially the convex closure of the sheet is captured the tip vortex cavitation is captured qualitatively well but its extent is generally smaller than observed in the experimental the complex multi rolling tip vortex cavitation is noted in the numerical predictions at blade position of around 48 after blade phase of 58 the tip vortex cavitation show a breathing behavior with series of collapse and rebounding as shown in fig 11 especially in the last four frames at 73 4 the two tip vortex cavitation segments are collapsing while the segment between them are emerging at 75 5 and 80 4 and finally collapse at 82 5 however this phenomena could not be observed in the experimental recordings in the experiments the extent of tip vortex cavitation is continuous and maintains its shape significantly further downstream but the stretching behavior could be seen clearly closer views of sheet cavity structures with cross cuts in black are shown in fig 12 for blade phase at 15 predicted by star ccm as shown in these numerical predictions the sheet cavity is a multi layer structure with a water pocket for developed flow the cavitation interface could be roughly regarded as surfaces with constant pressure this indicates the pressure gradient is perpendicular to the sheet cavity closure line the pressure gradient direction is the direction of the re entrant flow and the convex closure line leads to the re entrant and side entrant flow the same multi layer sheet cavitation is also predicted using openfoam with minor differences cavitation patterns displayed as multiple transparent iso surfaces vapor fraction together with the iso surfaces of q n 1292 for condition 1 are shown in fig 13 to show the developments of tip vortex tip vortex cavitation sheet cavitation and their interaction the water pockets are formed at about 0 where the sheet cavity starts to develop deduced from the last frame 7 3 and the first frame 5 6 before the jet flow reaches to the tip region say earlier than 30 the tip vortex is very stable and limited tip vortex cavitation could be found developing then the secondary vortex structures start form and the tip vortices as well as tip vortex cavitation become quite developed around blade phase of 48 which correspond to the time when the jet flow arrives at the blade tip end instead of a main tip vortex structure the iso surfaces of normalized q criterion show that the tip vortex is decomposed into several rolling structures the secondary rolling structures starts to cavitate which lead to the complex flow field for the base mesh with rather coarse mesh resolution downstream the blade tip tip vortex cavitation and its interaction with sheet cavitation could not be captured as shown in fig 14 in which the predictions of cavitation patterns and vortex structures at blade phase of 50 are shown in the base mesh the tip vortex related phenomenon are not captured at all under both operating conditions though the predictions on propeller blades are merely changed comparing the two operating conditions the predicted extent of sheet cavitation is noticeably larger under the lower reynolds number condition 2 than in condition 1 the tip vortex cavitation and the tip vortex structures are influenced as well with different structures developing which is naturally related to the larger sheet cavity in condition 2 which will change both position and diameter of the vortices the overall predictions of cavitation patterns are rather similar between star ccm and openfoam however the predicted tip vortex is slightly stronger in star ccm which was also found in the non cavitating conditions which lead to more dynamics of the tip vortex cavitation 4 3 2 pressure pulse levels the 1 st and 2 nd order pressure pulse levels are summarized in fig 15 while the 3 rd to 5 th order pressure pulse levels are summarized in fig 16 the 1 st order pressure pulse levels increased significantly from around 1 kpa in the non cavitating condition to around 6 kpa in the cavitating condition the 1 s t order pressure pulse levels are significantly dependent on the reynolds number as the predicted values in condition 2 are about 20 30 higher than experimental measurements while in condition 1 the predicted values agreed well with experimental values the propeller inflow 1 7 cm upstream the propeller at the two conditions are shown in fig 17 at the lower reynolds number i e condition 2 the wake is generally stronger than in condition 1 which lead to a more extended sheet cavitation slight differences can also be found between predictions using the tip refined mesh and base mesh the prediction of 2 nd order pressure pulse values also agreed well comparing to experimental data for all the probed points and show little influence by tip mesh refinements or reynolds number it is generally believed that the development of sheet cavitation is the major source of 1 st and 2 nd order pressure pulses and the 2 nd order pressure pulses seems to be more challenging to be predicted numerically since condition 1 is under the same condition as in the experiment the accuracy of numerical prediction is very satisfying both in star ccm and openfoam with relative differences around 5 10 for most probed locations the spatial distribution of predicted pressure pulse levels also agrees well with experimental data the maximum values could be found at transducer p2 and p7 located along the propeller plane and close to the ship centerline the 1 st and 2 nd order pressure pulse levels at the probe points located at starboard side have generally higher values than at the ones located on the ship s port side as the maximum rate of cavity increase decrease occurs on the starboard side regarding the 3 rd order pressure pulses star ccm with tip refined mesh predicted values in close agreement to the experimental data this value is under predicted in openfoam but in both packages the predicted values using tip refined mesh are about two times higher than the ones predicted using the base mesh much higher pressure pulses are also predicted by the tip refined mesh at 4 th and 5 th order bpfs which indicates that the source of pressure pulses are originating from the tip vortex cavitation and its interaction with sheet cavity the 4 th and 5 th order pressure pulse levels are over predicted compared to the experimental measurements but the absolute difference values are small compared to blade rate pressure pulse values the over predicted high order pressure fluctuations can be related to the rans approach that the minimum pressure in the tip region can only be maintained in a short distance downstream which lead to more violent tip vortex cavitation collapse 4 3 3 pressure signal analysis in fig 18 the probed values of non dimensional pressure k p located at transducer 2 in three blade passing period predicted using star ccm are presented for both base mesh and tip refined mesh under the two operating conditions the prediction results in condition 1 are plotted in black lines and red lines are used for condition 2 the magnitudes of the predicted non dimensional pressure signals in condition 2 are larger than in condition 1 while the signal fluctuations are of similar magnitudes this corroborate the fft results that the 1 st order pressure pulses are larger in condition 2 while the values are less influenced for the higher order of bpfs the major events in the signals are similar for one blade passage for the two operating conditions starting from 0 the signals decrease till about 30 after that a rapid increase and decrease could be found which forms the first signal peak at around 40 then follows the second peak at around 50 60 and lastly the signal decrease with fluctuations and the signals repeat for the pressure signals predicted using the base mesh the second pressure peak is absent and the first pressure peak is stronger and ends earlier in openfoam same events occurring at the same blade positions with similar magnitudes are predicted but with numerical oscillations the total vapor volume was calculated during the simulation as v s u m σ 1 n α v i v c e l l i it is also of interest to isolate the vapor volume of the sheet cavitation and the tip vortex cavitation thus the cells with wall distance less than 2 cm which covers the sheet cavitation but excludes the tip vortex cavitation are selected and the vapor volume of these cells are computed as inner vapor volume as shown in fig 19 the difference between total vapor volume and inner vapor volume could be regarded as the volume of tip vortex cavitation the maximum total volume is about 4 cm3 and the sheet cavitation contribute the majority while the tip vortex cavitation vapor volume is much smaller about 0 3 cm3 at blade phase around 50 it has been noticed both numerically and experimentally that cavitation dynamics generate pressure fluctuations in a monopole manner and the pressure fluctuations can be related to the acceleration of cavity volume thus the linking of pressure pulse and cavity volume would be useful for identifying the source of cavitation phenomenon and generated pressure fluctuations for a breathing spherical structure the pressure fluctuation is proportional to its volumetric variation i e the second order derivative of its volume regarding time 12 p ˆ ρ 4 π r 2 v b t r c t 2 in which r represents the distance between the breathing sphere and the receiver point t is time c is velocity of pressure wave and v b represents the volume of the spherical bubble equation 12 could be simplified to a linear relationship as 13 p ˆ c d 2 v d t 2 taking second derivatives over time of the recorded vapor volumes results in the vapor rate shown in fig 20 in which the original data is plotted in grey and the smoothed data using savitzky golay filter savitzky and golay 1964 is plotted in black the resulting curves have highly similar shapes compared to the pressure signals the maximum vapor production condensation rate is about 1 5 2 0 m3 s 2 and it could be calculated that for this probe the pressure fluctuation is about c 1 d 2 v d t 2 with c 1 2313 71 the same analysis could be performed on the deduced tip vortex cavitation volume compared to the total vapor volume the deduced tip vortex cavitation volume is much smaller which contributes less than 10 of total cavitation but the vapor production condensitation rate is about 1 m3s 2 which is rather comparable to the rates calculated based on total vapor volume due to the similarity of d 2 v d t 2 and pressure fluctuations the resulted curve actually represented the pressure pulses generated from the tip vortex cavitation and for each blade passing it contains two major events and a series of smaller fluctuations the analysis of vapor volumes and pressure fluctuations provides a more complete picture of the pressure pulse mechanisms for the present case which is one of the common types that can be found for a propeller in behind conditions starting from 0 the present blade sheet cavitation extent increases until the total vapor volume reaches its maximum at around 30 at the same time the re entrant flow forms at around mid chord and travels towards the blade tip then the sheet cavitation starts to decrease in extent and pressure starts to increase during this process the tip vortex cavitation develops steadily at about 40 the re entrant flow reaches the blade tip trailing edge creating a cavity closure vortex which leads to that a part of the sheet cavity collapses after the collapse the pressure bounces back to a relatively high value which corresponds to the first pressure peak observed in the pressure signal this event is less pronounced using the tip refined mesh due to the differences in tip vortex cavitation development and the vortex interacting with the re entrant flow at the blade tip violent growth and collapse of the tip vortex cavitation can be observed between 48 and 54 which leads to the second pressure peak after the second peak the tip vortex cavitation show a monopole breathing manner and an induced series of fluctuations till about 82 10 degrees superimposed on the decreasing pressure signals the tip vortex cavitation collapse related phenomenon and the re entrant flow induced sheet cavity collapse both form mechanisms contributing to higher order pressure pulses generation the fft analysis is performed for the function c 1 d 2 v t i p d t 2 which represents the isolated pressure pulse generated from the tip vortex cavitation the results is shown as the dashed line with cross markers in fig 21 and we note that it is rich in higher order bpfs up to 10 th order the predicted pressure signals with three different time steps are shown in fig 22 predictions with the largest time step equivalent to 512 steps per propeller revolution is plotted in red line the other two lines are the results with 1024 and 2048 steps per revolution in the present study the larger time step would introduce rather significant difference compared to the other two smaller time steps the slope of the pressure increase is not as steep as the other two the two pressure peaks are delayed in blade phase which indicate the tip vortex cavitation is not well predicted the signal is rather smooth without much fluctuations the deduced pressure pulses by tvc with different time steps are also presented in fig 21 and it can be found the predicted values are significantly lower with large time steps this indicates that in order to capture the correct cavity dynamics it is not sufficient to choose a time step based on numerical stability alone but sufficiently small time scales of the physics in the flow needs to be considered 5 conclusions the present study focuses on the capability of a rans approach regarding the numerical prediction of marine propeller induced hull pressure pulses a 3600 teu standard container vessel designed and studied in the virtue and sonic eu projects with a five bladed propeller is studied numerically and prediction results are compared to experimental measurements performed at hsva in the experiment the model scale container vessel was mounted inside a cavitation tunnel while the propeller was operating at a fixed rotational speed of 28 rps two operating conditions are considered in the numerical simulations for condition 1 the propeller rotation speed is 28 rps corresponding to the experiments in the hsva cavitation tunnel and for condition 2 the propeller rotation speed is 8 5 rps corresponding to a test in a depressurised towing tank using froude scaling in both conditions the inlet velocity speed and environmental pressure are adjusted to achieve the same thrust coefficient and cavitation number the reynolds number differs about 3 times between the two conditions a mesh dependency study was performed first regarding nominal wake predictions in order to study tip vortex related phenomenon tip refinement downstream the propeller blades tip was also applied and compared the open source package openfoam and commercial package star ccm are both used for the simulations the mesh dependency study shows that the nominal wake prediction is sensitive to the prism layer cell arrangements a sufficient number of prism layers covering the major part of the flow boundary layer is vital to achieve an accurate prediction thus the further simulations were conducted with a fine structured mesh around the hull mid section and aft body regions for non cavitating conditions pressure pulses are concentrated in the blade passing frequency as also reported in the experimental measurements numerical predictions generally agree well compared to measurements but small differences are found in certain transducer locations with over predictions of the pressure pulses with a maximum difference of 0 4 kpa the predicted non cavitating 1 st order pressure pulse levels are very similar between different conditions meshes and numerical packages used regarding tip vortex predictions significant differences could be found between the base mesh and tip refined mesh while subtle differences could be found between conditions and packages the predicted sheet cavitation agree well compared to experimental recordings including the convex shape and the progression of its development during the wake passage slightly larger extent of sheet cavitation were predicted in condition 2 towing tank compared with condition 1 cavitation tunnel the 1 st and 2 nd order pressure pulse in condition 1 agree well compared with experimental data while about 20 30 over prediction are found with predictions from condition 2 the tip vortex cavitation tvc including the bursting like dynamics with multiple cavity structures and complex interactions with sheet cavitation is predicted using the tip refined mesh however the predicted tvc is generally weaker after the bursting compared to experimental recordings by using the base mesh no tvc is predicted without resolving tvc pressure pulses in 3 rd 5 th order bpfs are predicted using the base mesh while using the tip refined mesh much higher values are predicted the 3 rd order pressure pulse is in good agreement with the experiments using tip refined mesh in star ccm for condition 1 but in the other simulations the levels are under predicted over predictions are found regarding 4 th and 5 th order pressure pulses compared to experimental data further analysis was performed for the predicted pressure signal at the maximum probe point and studied together with simulated cavity volumes since cavitation generate pressure fluctuations in a monopole manner a linear relationship between pressure fluctuation and the second derivative of cavity volume can be used it was deduced based on this type of analysis that for the present case numerically predicted tip vortex cavitation generate pressure pulses up to 10 th order via the dynamics of the isolated tip vortex cavitation volume variation for the present type of tip vortex bursting which is likely to be one of the common types generating hull pressure pulses significantly the major events have been identified with support of the numerical simulations a re entrant flow which is formed due to the convex cavity closure line blade geometry and wake is formed beneath the sheet cavity surface and travels toward the blade tip when the re entrant flow travels to the blade end it induces a violent collapse of the sheet cavity and a rapid development of tip vortex cavitation is initiated which induce two pressure peaks added to the harmonic wave like pressure fluctuation signal from the sheet cavity the collapse of sheet cavitation forms the first pressure peak while the tvc collapse if resolved in the simulation forms the second pressure peak after bursting the tvc behaves in a breathing manner generating pressure fluctuations with smaller amplitudes the first sheet cavity collapse is found to be more pronounced for cases in which the tvc was not well resolved and the induced transient pressure peak contribute to the predicted higher order pressure pulses by the base mesh with a sufficient resolution in both time and space we find that rans is capable of predicting a large part of the dynamics of cavitation induced hull pressure pulses credit authorship contribution statement muye ge conceptualization methodology validation formal analysis investigation writing original draft urban svennberg conceptualization writing review editing supervision project administration rickard e bensow conceptualization methodology writing review editing supervision resources project administration funding acquisition declaration of competing interests the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement we would like to thank hsva for sharing geometry and experimental data financial support for this work has been provided by kongsberg maritime sweden ab through the university technology centre in computational hydrodynamics hosted at the department of mechanics and maritime sciences at chalmers university of technology the computations were performed on resources at chalmers centre for computational science and engineering c3se provided by the swedish national infrastructure for computing snic 
21793,this paper investigates the numerical prediction of cavitation and hull pressure pulses induced by a marine propeller operating in behind hull conditions of a container vessel in model scale simulations are performed using commercial package star ccm and opensource package openfoam using rans approach and predictions are compared with experimental measurements a mesh dependency study with respect to wake prediction is also presented operating conditions scaled to two different reynolds numbers with the same propulsion characteristics and cavitation number are considered to study scaling effect simulations using tip refined mesh are performed and compared with using base mesh to study the tip vortex generation tip vortex cavitation its interaction with sheet cavity and induced pressure pulses the influence of time step length is also investigated star ccm and openfoam predict consistent results the predicted cavitation patterns agree well compared to experimental measurements as well as pressure pulse levels up to 3 4 times blade passing frequency bpf especially for the predictions with tip refined mesh the sheet cavitation is the major contribution to 1 st and 2 nd order bpf pressure pulses and its closure has significant contributions to higher order pressure pulses deduced pressure pulses by tip vortex cavitation tvc are significant ranging from 3 rd order to 10 th order of bpfs the tvc induced pressure pulses are related to its violent bursting behavior which is influenced by the closure of the sheet cavity keywords marine propeller cavitation hull pressure fluctuation tip vortex cavitation rans 1 introduction for operating marine propellers the thrust is related to the pressure differences that are created on the two sides of the propeller blades via the rotational motion of the curved blades this results in a rotating spatial distribution of pressure that generates pressure variations on the hull body which is one of the major sources of hull vibration and on board noise as well as pressure waves in the surrounding medium the pressure on the propeller blades can drop below water saturation pressure and tension force would break the water medium known as cavitation which contributes significantly to these side effects due to rising concern to the welfare and comfort of on board crew and passengers and environmental impact to sea creatures these operating propeller related side effects are getting more attention hull vibration and onboard noise are highly dependent on propeller induced hull pressure pulses acoustic analogies are commonly used for under water noise prediction which rely on the prediction of near field pressure fluctuations and there are studies showing high similarity between the two foeth and bosschers 2016 the quest for higher efficiency propeller design also calls for more accurate estimations of pressure pulses as there is often a trade off between the two nevertheless the prediction of pressure pulses is still a challenging task because of the complexity of involved psychical phenomenon including the interaction between the ship wake and propeller blades and different types of cavitation the propeller induced pressure pulses are usually in phase with blade rotation thus the pressure pulse levels are commonly analyzed in orders of blade passing frequency and fast fourier transformation fft is widely used to study pressure pulse signals in the frequency domain it is believed that the 1 st and 2 nd order bpf fluctuations are caused by the blade thickness and load and growth shrinkage of propeller sheet cavitation under cavitating conditions for 3 rd and higher order pressure pulses there are no well established mechanisms and knowledge is still building on but it is widely believed to be induced by tip vortex cavitation tvc related phenomenon as indicated by various experimental studies berghult 2000 experimentally studied induced noise of a series of high skew propeller models in behind condition and found that tip vortex cavitation contributes to pressure pulses ranging in between 3 rd to 12 th order bpfs pereira et al 2004 studied the model scale propeller e779a under non uniform inflow experimentally and one of the deductions was that tip vortex cavitation contributes mainly to the 3 rd order pressure pulse more recently in the study by aktas et al 2018 the tip vortex cavitation was found to increase pressure pulse levels in the frequency range 400 hz 2000 hz including the tonal values and broadband values approximately equivalent to 3 rd to 13 th order for the model scale propeller pennings et al 2015 deduced that strong excitation is a must for the tvc to generate pressure pluses efficiently including the phenomena which was termed singing vortex by maines and arndt 1997 furthermore the analytical model for vortex cavity deformations by bosschers 2008 and later studies by pennings et al 2016 indicate that the active pulsing source comes from tip vortex cavitation inside the wake which deforms in a standing wave manner the acoustic active tvc was deduced to generate pressure pulses as monopole acoustic sources which is the same for sheet cavities in the study by english 1980 tip vortex bursting was found to contribute substantially regarding hull pressure pulses and later in the study by konno et al 2002 tip vortex bursting was experimentally found to be significantly influenced by the wake and its peak where the propeller was operating in this phenomena is found to be influenced by the mechanisms that is termed sheet cavity closure in the studies by bark and bensow 2013 in which conceptual models of cavitation mechanisms regarding erosion were proposed including interactions between sheet cavity and tip vortex cavitation this tvc bursting could be highly influenced by the re entrant flow induced by sheet cavity collapse the tvc destruction by sheet cavity collapse is very common on ship propellers kuiper 2001 further in van wijngaarden et al van wijngaarden et al 2005 various possible mechanisms were discussed regarding tip vortex cavitation induced pressure pulses also sheet cavitation may contribute to higher order pressure pulses aktas et al 2018 found that sheet cavitation including its collapse and rebounding contributes not only to blade frequency but also to high order pressure pulses variation in cavitation between revolutions can also contribute to the higher order broadband pressure pulses and reduces the tonal values bosschers 2009 moreover the tip clearance between the propeller blade tip and hull is another parameter that may be dominating in certain cases as studied by bensow and gustafsson 2017 the interaction between tip vortex cavitation and the rudder can also be pronounced as the tip vortex cavitation can be trapped in the gap between the rudder and the rudder horn the collapse here can induce significant levels of pressure pulses as noticed by e g shin and andersen 2018 full scale ship measurement can provide the most reliable levels of induced pressure pulse and radiated noise but it is usually difficult to exclude the influences from sea states besides due to the low transparency of sea water and limitation of view angles the cavitation patterns can usually not be seen clearly which is of vital importance to perform detailed studies regarding the mechanisms behind the phenomenon tani et al 2016 furthermore it is usually desired to predict the pressure pulse levels before the real ship is build due to these reasons the model scale testing is widely used as an alternative to full scale measurement several experimental approaches have been developed to study and estimate propeller induced pressure pulse levels the first type of configuration have similarities with propeller open water test pot in cavitation tunnels the model scale propeller is tested in a cavitation tunnel where either upstream meshes or panels would be installed to mimic a ship wake or the propeller could be mounted on an inclined shaft to create load variation such medium size cavitation tunnel test still plays a major role to study the flow around the blades cavitation and induced pressure pulses etc in the second type of configuration the hull is included by placing the model scale ship hull in the cavitation tunnel and thus allowing the propeller to operate in the ship wake this is often referred to as large size cavitation tunnel test moreover instead of using a cavitation tunnel the model scale ship hull and propeller could be tested in a towing tank which need to be depressurised allowing the cavitation and pressure pulses to be tested during a model scale self propulsion test thus the free surface could be included and froude number should be maintained when scaled to model scale compared to the condition in cavitation tunnel the reynolds number is then several times lower model scale testing may take weeks to months and the manufacture of models are costly this is acceptable in the final verification stage where models are anyway produced but limiting in early design work besides scaling effects emerging as challenging including wake difference water nuclei content and distribution differences and the existence of laminar transitional flow over blades with the increase of computational resources especially during the past decade numerical methods are developing rapidly as a supplement and alternative which is typically faster cheaper and may provide more detailed flow information compared to model testing the potential flow theory based numerical methods are widely used for pressure pulse predictions where the nominal wake is provided from experiments or viscous cfd predictions or the potential flow solver is coupled to a viscous cfd code as the ship wake is essentially a viscous effect however by theoretical limitations only attached sheet cavitation can be predicted with potential flow codes this has lead to the development of special treatments for the predictions of tip vortex and tip vortex cavitation including berger et al 2016 lee and kinnas 2004 and bosschers 2018 viscous cfd solvers are becoming more widely used for more accurate numerical predictions reynolds averaged navier stokes equations rans has long been used for pot simulations and self propulsion simulations together with mass transfer models accounting for cavitation and satisfying predictions have been achieved thus in many studies this approach has been used for pressure pulse predictions e g paik et al 2013 and perali et al 2016 for both medium size cavitation tunnel test and large size cavitation tunnel test the numerical prediction of sheet cavitation usually agrees well when the propeller is operating inside representative wakes but for medium size cavitation test with inclined shafts without the existence of significant wake variation less accurate predictions are not rare e g perali et al 2016 and asnaghi et al 2018 with over prediction of the extent of the sheet cavity this is likely to be related to scale effects in the tests with the existence of laminar boundary layers in model scale suppressing the formation of attached sheet cavitation it is generally believed that the capacity of a rans approach regarding hull pressure pulse predictions would be limited to 2 n d order bpf due to its diffusive prediction of tip vortices thus scale resolving simulation approaches were used in the studies by fujiyama 2015 li et al 2015 sakamoto and kamiirisa 2018 and li et al 2018 where predictions of higher order pressure pulses were reported meanwhile there are also studies showing little differences between rans and ddes for cases mainly with sheet cavitation hur et al 2018 les and dns are still too expensive for this kind of predictions bensow and liefvendahl 2016 studied under water noise generated by an operating propeller in behind condition using wall modelled implicit les and suggested hundreds of millions of cells would be needed to achieve expected resolution requirements in asnaghi et al 2017 the iles approach was compared with rans regarding tip vortex predictions for a stationary foil and in hsiao and chahine 2008 dns was applied in limited tip vortex zone with rans as the background solution and compared with rans regarding tip vortex predictions in both studies rans predicted generally a more diffusive tip vortex but within a limited distance downstream the foil say around 5 chord length the minimum pressure agreed well with the more advanced predictions this implies the prediction of sheet cavitation tip vortex cavitation interaction could be possible using rans approaches in the present study a generic 3600 teu standard container vessel with representative design is considered the container vessel was developed in the year 2002 and used in the virtue the virtual tank utility in europe and sonic suppression of underwater noise induced by cavitation eu projects the referenced experiments including pressure pulse measurements and cavitation pattern recordings were performed at hsva hamburgische schiffbau versuchsanstalt and new numerical predictions are presented from simulations with the open source package openfoam v1806 and commercial package star ccm v12 06 010 using a rans approach the first objective of this work is to analyse the capability of the rans approach regarding 1 s t and 2 n d order pressure pulse predictions the second objective is to compare the predictions using a base line mesh and applying mesh refinement at the blade tip region in a limited distance downstream the blade tip to study and further analyse the interactions between tip vortex cavitation and sheet cavitation since reasonable predictions including also higher order pressure pulse levels are predicted we also discuss the mechanisms that are noted to contribute to the higher order fluctuations which are resolved by the rans approach the third objective is to study the influence of reynolds number on the predictions by considering two equivalent model test conditions corresponding to a cavitation tunnel like condition and a towing tank like condition in both conditions the non dimensional thrust coefficient k t and cavitation number σ are the same additionally a mesh resolution study was performed regarding nominal wake prediction the influence of advancing time step to pressure pulse predictions is also presented 2 case description the container vessel is equipped with a single five bladed high skew fixed pitch propeller and the main dimensions and geometry characteristics are summarized in table 1 experiments were carried out in the cavitation tunnel hykat at hsva with a test section size of 11 m 2 8 m 1 6 m which is large enough for the installation of the whole ship model the ship model was manufactured by hsva with scale ratio of 1 29 1 and was installed into hykat according to even keel draft of 11 3 m corresponding to the ship scale conditions the free surface was substituted by wooden plates to compensate for the deceleration of the flow due to the tunnel ceiling boundary layer the model scale ship draft was increased with 50 mm there were 13 pressure sensors installed on the ship hull above the propeller to measure propeller induced pressure pulses as shown in fig 1 the shaft speed of the model propeller was fixed to n m o d 28 rps during the experiments which result in a blade reynolds number of r e 1 52 10 6 with the inlet velocity of the cavitation tunnel adjusted to match desired non dimensional thrust coefficient k t and the pressure adjusted to the desired non dimensional cavitation number σ at 0 8r with blade in 12 o clock position the thrust coefficient and cavitation number is defined as 1 k t t ρ n 2 d 4 σ p p v 0 5 ρ π n d 2 pressure pulse measurements were carried out in several service conditions both with and without cavitation corresponding to full scale ship cruising speed of 23 76 knots 20 knots 18 knots and acceleration k t 5 deceleration k t 5 at 20 knots the cavitation number was fixed to 0 2354 for the cavitating conditions via tunnel depressurization the measurements without cavitation were conducted at atmospheric pressure for the condition under design speed 23 76 knots the 1 s t to 3 r d order pressure pulses were quite significant due the large cavitation volume and tip vortex bursting while for the rest of the conditions the hull pressure amplitudes were very low for both non cavitating and cavitating conditions 1 kpa in full scale the studied service condition corresponding to full scale ship is presented in table 2 3 simulation design 3 1 conditions and meshes the condition with thrust coefficient k t 0 2234 and fixed propeller rotation speed n m o d 28 rps leads to a derived velocity inlet speed of around 7 3 m s accordingly the calculated reynolds number based on ship hull is 5 8 10 7 and based on the propeller chord length and velocity at 0 75r is 3 1 10 6 for the condition in the cavitation tunnel by applying the froude scaling rule considering the scale ratio 1 29 1 and full scale ship speed of 23 75 knots the speed of the model scale ship is calculated to be 2 2 m s and the propeller speed adjusted to thrust identity at k t 0 2234 gives n m o d 2 8 5 rps in the latter configuration the calculated reynolds numbers based on the hull and propeller become 1 8 10 7 and 9 5 10 5 respectively this configuration corresponds to the condition in a towing tank both configurations are considered in the present study and the two conditions are summarized in table 3 the calibration of inlet velocities and rotation speeds are conducted via star ccm simulations similar to the experimental procedure the propeller rotation speeds are fixed to 28 rps and 8 5 rps and several simulations with varying inlet velocities are performed for each calibration run steady state simulation with 6000 time steps with mrf moving reference frame approach is performed first after that the rbm rigid body motion of the propeller region is activated and simulation runs for 8 revolutions time using euler time advancing with time step equivalent to 1 512 revolutions more strict numerical settings are used for the simulations presented in the present study and the relative differences for k t are 1 7 for condition 1 and 1 5 for condition 2 similar to the experimental settings the test section in the cavitation tunnel is used as the computational domain with size 11 m 2 8 m 1 6 m for both conditions the draft of the model scale ship is 43 83 cm which correspond to the full scale ship draft of 11 3 m with 5 cm margin to the top plate an overview of the computational domain can be found in fig 2 the domain is divided into two sub domains inner domain includes the rotating propeller and outer domain includes the ship hull and the tunnel section the two subdomains are connected via sliding interfaces to account for the rigid body motion of propeller rotation the prediction of the wake has significant impact regarding predictions of blade load blade pressure distribution cavitation and pressure pulses structured grid with 4 million cells for a half ship in model scale without free surface and appendages is deemed to be needed for reasonable nominal wake prediction using rans according to the ittc recommended procedures and guidelines practical guideline 2014 since the wake was not measured in the cavitation tunnel a mesh dependency study regarding nominal wake prediction was conducted before proceeding with pressure pulse assessment several meshes were systematically generated for the outer region and four meshes are used in the present study which are numbered from m1 to m4 m1 m2 m4 are generated using the star ccm built in trimmer mesher and m3 is partly structured and generated using pointwise m1 here serves as a selected base mesh that generally follows the ittc recommendations this mesh contains 4 million cells for the half domain there are 37 prism layers applied on the hull surface with constant growth ratio of 1 2 and average y of about 0 8 this leads to a total y of around 3500 for the total prism layer height the surface element sizes are calculated based on the size of the last prism layer height more precisely for the fore body and aft body region the surface element size is about 2 times the last layer cell height and this assures the prism layer core mesh transition ratio does not exceed 2 the surface element size is about two times larger in the parallel mid body region for these simulations as there is no propeller a cylinder block with uniform cell size is applied which encloses the wake where the propeller would be operating in the cell size in this cylinder refinement region is equivalent to the last prism layer height which is about 1 65 of the propeller diameter this leads to about 200 points in the tangential direction at the rotation interface outer radii m2 is a globally refined version based on m1 global refinement of 0 64 was applied while the prism layers vertical distribution was not changed which leads to a similar mesh with prism layer core mesh transition ratio of 1 3 and totally 12 million cells for half the hull m4 similarly as for m2 is a globally refined mesh of 0 8 based on mesh 1 while the number of prism layers is reduced to 24 with constant growth ratio of 1 2 the mesh is generally finer than mesh 1 but the prism layer core mesh ratio is quite large the total number of cells is 5 6 million for the half domain m3 was generated using pointwise with a semi structured meshing approach it can be regarded as a finer version based on ittc recommendations and a close view of the mesh at aft body and wake plane is shown in fig 3 this mesh consists of 27 8 million cells for the whole ship and tunnel section the summary of cell counts are shown in table 4 regarding meshes for simulations with the inclusion of the propeller and rudder structured conformal grids were generated on the hull body upstream the propeller and downstream of the rudder in the same way as m3 a closer view of the mesh in the aft body region is shown in fig 4 structured conformal grids were also used for the prism layers around propeller blades and rudder which are extruded from structured surface mesh using hyperbolic extrusion tetrahedral cells were used to fill the rest of the space these meshes were generated using pointwise mesh resolution is increased downstream the blade tips via helix like tube refinements with structured mesh blocks to have better flow predictions including tip vortex tip vortex cavitation and their interactions with sheet cavitation the views of the base mesh and tip refined mesh are shown in fig 5 the tip refined structured tubes have the smallest cell located in its core with size 0 086 mm 0 086 mm 0 8 mm and expands on the radial and axial directions summary of cell counts is shown in table 5 the inclusion of tip refinement lead to additionally 6 million cells 3 2 numerics both the commercial package star ccm v12 06 010 and open source package openfoam v1806 were used to perform numerical simulations for the openfoam simulations a modified version of the interphasechangedymfoam solver was used the single fluid homogeneous mixture approach is used to represent the two phases of water and vapor as 2 ρ m α l ρ l 1 α l ρ v μ m α l μ l 1 α l μ v α l α v 1 in which the subscripts l and v represent liquid phase and vapor phase quantities respectively ρ represents density μ represents dynamic viscosity and α represents volume fraction of the phase the transport equation of α consists then of convection with mass transfer source terms as 3 α l t α l u m ρ l 1 ρ l α l 1 ρ l 1 ρ v m α l 1 ρ l 1 ρ v m for the rans method the conservation equations of mass and momentum for the homogeneously mixture fluid are 4 ρ m t ρ m u 0 5 ρ m u t ρ m u u τ ρ m u u p f s and the boussinesq hypothesis is used for reynolds stress tensor ρ m u u modeling 6 ρ m u u μ t u u t 2 3 ρ m k i where u represents time averaged velocity u represents the time varying fluctuating component of velocity μ t is turbulent viscosity f s represents body forces ρ m for mixture density τ represent averaged stress tensor and i represents identity tensor the vapor density ρ v and water density ρ l are assumed to be constant while the mixture density ρ m is calculated based on volume fractions α l and α v turbulent viscosity is modelled using the k ω s s t turbulence model as μ t ρ m k t where t represents turbulent time scale and k represents kinetic energy the turbulent time scale is calculated as min a ω a 1 s f 2 in which a a 1 are model constants f 2 is a blending function s is the absolute value of the strain rate and ω represents specific dissipation rate both k and ω are modelled via additional reynolds transport equations the implementation of k ω s s t turbulence model in star ccm is based on menter 1994 menter 1994 with s in definition of the eddy viscosity instead of the vorticity and furthermore durbin s limiter durbin 1996 is used as the limiter while both modifications concerns the calculation of t in openfoam the implementation is based on menter and esch 2001 menter and esch 2001 with updated coefficients from menter et al 2003 menter et al 2003 due to the existence of strong pressure gradient and geometrical curvatures of the ship aft body the boundary layer is resolved instead of using wall functions wall resolved boundary layer requires y value smaller than 1 which is fulfilled based on condition 1 same meshes were used for condition 2 and the y value would be roughly four times smaller gravity is ignored in the present study the cavitation mass transfer model by schnerr and sauer 2001 is used in both codes the mass transfer term in equation 3 is decomposed into two terms as 7 m α l m a v 1 α l m a c while the two terms m a v and m a c are derived based on uniformly distributed spherical nuclei and simplified rayleigh relations as 8 m a c c c α l 3 ρ l ρ v ρ m r 2 3 ρ l 1 p p t h r e h o l d max p p t h r e h o l d 0 9 m a v c v 1 α n u c α l 3 ρ l ρ v ρ m r 2 3 ρ l 1 p p t h r e h o l d min p p t h r e h o l d 0 in both packages simulations start with steady state mrf converged solution and then the rbm follows with first order implicit time advancing scheme and larger time steps sampling of results from the simulations then starts from the developed flows with second order implicit time advancing scheme and smaller time steps after the non cavitating simulations the mass transfer model would be included with gradually increased vaporization factor c v and after that the cavitating condition predictions are collected the pressure velocity coupling is solved using simple algorithm in star ccm while the pimple algorithm is used in openfoam which is a combination of simple and piso algorithms in star ccm simulations the least square momentum residuals are controlled below 5 10 5 in non cavitating simulations in openfoam the pressure residual are controlled below 10 6 and for cavitating conditions more strict control was used amounting to 10 12 due to the appearance of mass transfer source term in the pressure equation the convection of velocity in the momentum equation is discretizatized using second order schemes which are limitedlinearv 0 33 and second order in openfoam and star ccm respectively the convection of turbulence terms are treated using upwind scheme in openfoam and 2 nd order upwind scheme in star ccm for gradient calculations in openfoam gauss theorem with linear interpolation is used without limiters while in star ccm the hybrid gauss and least square method based on local cell quality with venkatakrishnan limiter is used implicit second order euler upwind time scheme is used for time advancing in both packages which is referred to as backward in openfoam and second order in star ccm respectively 4 results 4 1 wake prediction the predicted nominal wake with the four meshes using the steady state solver in star ccm in condition 1 are summarized in fig 6 and line plots of u x u i n at 0 5d 0 7d and 0 9d are plotted together in fig 7 to recollect m2 is a refined version of m1 and m3 is a rather fine mesh generated using a different mesh topology and package while the differences between these three meshes are small noticable differences are found in the angular position ranging from 60 to 40 with up to 3 4 of wake fraction and around angular position 5 0 where the structured m3 mesh is rather fine some kind of stagnation effect is predicted locally when using the steady state solver with full ship configuration in m3 however using m4 a rather different wake was predicted even though it consists of more cells than the base mesh m1 the other three meshes predicted u shape wakes while a v shape wake was predicted here in m4 24 prism layers were applied on the ship hull with y around 0 8 for the first cell layer and it is estimated that the total y value for the prism layer is around 300 thus the transition of grid size becomes rather abrupt between prism layers and the core mesh the sudden increase of cell size greatly influences the boundary layer development around the hull and the diffusive predictions lead to a v shape like wake this transition ratio could be reduced by decreasing surface element size but a rough estimation leads to a needed mesh size of around one hundred million cells with 24 prism layers y around 0 8 and transition ratio below 2 0 using trimmer like mesh topology without special treatments the frictional forces predicted using the four meshes are listed in table 6 the differences between m1 to m3 are very small but around 7 under prediction could be found when using m4 since in m4 a v shape like wake the propeller load blade residence time in wake peak cavitation and cavitation development would be significantly influenced consequently the prediction of pressure pulse levels would be expected to be significantly under predicted for simulations using a mesh similar to m4 4 2 non cavitating conditions the predicted pressures were recorded via point probes at the same locations as the pressure transducers arrangements in the experiment the predicted model scale pressure values are scaled to full scale values via a simple non dimensional scaling i e the non dimensional coefficient k p is calculated using model scale values and k p is assumed to be constant between different scales following equation 10 10 k p p ˆ m ρ m n m 2 d m 2 p ˆ s k p ρ s n s 2 d s 2 fast fourier transformation fft is used to decompose the pressure signal p ˆ s into blade passing frequency harmonics the predicted 1 st and 2 nd order pressure pulse levels are summarized in fig 8 together with experimental measurements shown in corresponding full scale values the recorded pressure pulses are predominantly in the 1 st order bpf while the 2 nd and higher order pressure pulse levels are very small numerical predictions agree with experimental data both regarding the overall spatial distribution and amplitudes some noticeable discrepancies are noted at transducer numbers 2 6 and 10 the maximum absolute difference is about 0 4 kpa which is small while the relative difference amounts to 30 40 the predicted non cavitating pressure pulse levels show very small differences regarding the two operating conditions though the reynolds number differs about 3 times the prediction difference between two numerical packages is also very small which is comforting considering the differences in the numerical algorithms and discretization schemes as discussed in section 3 2 additionally there is no significant difference between tip refined mesh and base mesh regarding induced pressure pulses at the 1 st and 2 nd order bpfs nevertheless the tip vortex structures were predicted rather differently for the two meshes the predicted tip vortices and local flow properties predicted by star ccm and openfoam are shown in fig 9 for both operating conditions normalized q criterion q n is used to visualize and compare the vortex structures between the two operating conditions 11 q n q d m 2 π n m d m 2 the iso surfaces of q n 1292 q n 646 and q n 129 are presented with decreasing opacity with the tip refined mesh a main tip vortex is predicted with some secondary vortex structures surrounding it cuts of tip vortex regions are colored by non dimensional pressure coefficient k p and as shown in the frames the local pressure is low and concentrated inside the tip vortex center the velocity vectors are also plotted as black arrows which demonstrate local fluid circulation upstream the main tip vortex a vortex structure originating from the leading edge can be found which is commonly referred to as a leading edge vortex for the base mesh there is not much influence on the leading edge vortex predictions but the predicted tip vortex is very diffusive and local flow dynamics are much weaker small prediction differences can be found between the two packages as the predicted main tip vortex is slightly more diffusive in openfoam than in star ccm as well as the predicted secondary structures 4 3 cavitating conditions 4 3 1 predicted cavitation patterns the predicted cavitation patterns iso surface of α l 0 5 are shown in fig 10 together with experimental recordings in the experiments the camera shooting frequency were set to orders of propeller revolution and variations of cavitation pattern between revolutions can be found for the same blade position in the recorded video these variations can be found on all the blades while there is no phenomenal differences between the blades representative frames are selected and shown for blade phases between 10 and 58 counting from 0 at 12 o clock position and increasing anti clockwise viewed from the propeller suction side experimental recordings show that the sheet cavitation is the pronounced cavitation phenomena the sheet cavity interface is sharp and clear while a convex vapor structure could be found moving from the blade leading edge to the blade trailing tip originate at the blade position where the sheet cavity starts to form the sheet cavity decrease after blade position of 40 around 40 48 coincident with the time when the convex vapor structure reaches the blade tip end the tip vortex cavitation start to develop significantly and become quite unstable bursting displaying a rather complex flow dynamics after that the tip vortex cavitation is back to a relatively stable state around blade phase of 58 the numerical predictions of sheet cavitation agree well compared to experimental recordings especially the convex closure of the sheet is captured the tip vortex cavitation is captured qualitatively well but its extent is generally smaller than observed in the experimental the complex multi rolling tip vortex cavitation is noted in the numerical predictions at blade position of around 48 after blade phase of 58 the tip vortex cavitation show a breathing behavior with series of collapse and rebounding as shown in fig 11 especially in the last four frames at 73 4 the two tip vortex cavitation segments are collapsing while the segment between them are emerging at 75 5 and 80 4 and finally collapse at 82 5 however this phenomena could not be observed in the experimental recordings in the experiments the extent of tip vortex cavitation is continuous and maintains its shape significantly further downstream but the stretching behavior could be seen clearly closer views of sheet cavity structures with cross cuts in black are shown in fig 12 for blade phase at 15 predicted by star ccm as shown in these numerical predictions the sheet cavity is a multi layer structure with a water pocket for developed flow the cavitation interface could be roughly regarded as surfaces with constant pressure this indicates the pressure gradient is perpendicular to the sheet cavity closure line the pressure gradient direction is the direction of the re entrant flow and the convex closure line leads to the re entrant and side entrant flow the same multi layer sheet cavitation is also predicted using openfoam with minor differences cavitation patterns displayed as multiple transparent iso surfaces vapor fraction together with the iso surfaces of q n 1292 for condition 1 are shown in fig 13 to show the developments of tip vortex tip vortex cavitation sheet cavitation and their interaction the water pockets are formed at about 0 where the sheet cavity starts to develop deduced from the last frame 7 3 and the first frame 5 6 before the jet flow reaches to the tip region say earlier than 30 the tip vortex is very stable and limited tip vortex cavitation could be found developing then the secondary vortex structures start form and the tip vortices as well as tip vortex cavitation become quite developed around blade phase of 48 which correspond to the time when the jet flow arrives at the blade tip end instead of a main tip vortex structure the iso surfaces of normalized q criterion show that the tip vortex is decomposed into several rolling structures the secondary rolling structures starts to cavitate which lead to the complex flow field for the base mesh with rather coarse mesh resolution downstream the blade tip tip vortex cavitation and its interaction with sheet cavitation could not be captured as shown in fig 14 in which the predictions of cavitation patterns and vortex structures at blade phase of 50 are shown in the base mesh the tip vortex related phenomenon are not captured at all under both operating conditions though the predictions on propeller blades are merely changed comparing the two operating conditions the predicted extent of sheet cavitation is noticeably larger under the lower reynolds number condition 2 than in condition 1 the tip vortex cavitation and the tip vortex structures are influenced as well with different structures developing which is naturally related to the larger sheet cavity in condition 2 which will change both position and diameter of the vortices the overall predictions of cavitation patterns are rather similar between star ccm and openfoam however the predicted tip vortex is slightly stronger in star ccm which was also found in the non cavitating conditions which lead to more dynamics of the tip vortex cavitation 4 3 2 pressure pulse levels the 1 st and 2 nd order pressure pulse levels are summarized in fig 15 while the 3 rd to 5 th order pressure pulse levels are summarized in fig 16 the 1 st order pressure pulse levels increased significantly from around 1 kpa in the non cavitating condition to around 6 kpa in the cavitating condition the 1 s t order pressure pulse levels are significantly dependent on the reynolds number as the predicted values in condition 2 are about 20 30 higher than experimental measurements while in condition 1 the predicted values agreed well with experimental values the propeller inflow 1 7 cm upstream the propeller at the two conditions are shown in fig 17 at the lower reynolds number i e condition 2 the wake is generally stronger than in condition 1 which lead to a more extended sheet cavitation slight differences can also be found between predictions using the tip refined mesh and base mesh the prediction of 2 nd order pressure pulse values also agreed well comparing to experimental data for all the probed points and show little influence by tip mesh refinements or reynolds number it is generally believed that the development of sheet cavitation is the major source of 1 st and 2 nd order pressure pulses and the 2 nd order pressure pulses seems to be more challenging to be predicted numerically since condition 1 is under the same condition as in the experiment the accuracy of numerical prediction is very satisfying both in star ccm and openfoam with relative differences around 5 10 for most probed locations the spatial distribution of predicted pressure pulse levels also agrees well with experimental data the maximum values could be found at transducer p2 and p7 located along the propeller plane and close to the ship centerline the 1 st and 2 nd order pressure pulse levels at the probe points located at starboard side have generally higher values than at the ones located on the ship s port side as the maximum rate of cavity increase decrease occurs on the starboard side regarding the 3 rd order pressure pulses star ccm with tip refined mesh predicted values in close agreement to the experimental data this value is under predicted in openfoam but in both packages the predicted values using tip refined mesh are about two times higher than the ones predicted using the base mesh much higher pressure pulses are also predicted by the tip refined mesh at 4 th and 5 th order bpfs which indicates that the source of pressure pulses are originating from the tip vortex cavitation and its interaction with sheet cavity the 4 th and 5 th order pressure pulse levels are over predicted compared to the experimental measurements but the absolute difference values are small compared to blade rate pressure pulse values the over predicted high order pressure fluctuations can be related to the rans approach that the minimum pressure in the tip region can only be maintained in a short distance downstream which lead to more violent tip vortex cavitation collapse 4 3 3 pressure signal analysis in fig 18 the probed values of non dimensional pressure k p located at transducer 2 in three blade passing period predicted using star ccm are presented for both base mesh and tip refined mesh under the two operating conditions the prediction results in condition 1 are plotted in black lines and red lines are used for condition 2 the magnitudes of the predicted non dimensional pressure signals in condition 2 are larger than in condition 1 while the signal fluctuations are of similar magnitudes this corroborate the fft results that the 1 st order pressure pulses are larger in condition 2 while the values are less influenced for the higher order of bpfs the major events in the signals are similar for one blade passage for the two operating conditions starting from 0 the signals decrease till about 30 after that a rapid increase and decrease could be found which forms the first signal peak at around 40 then follows the second peak at around 50 60 and lastly the signal decrease with fluctuations and the signals repeat for the pressure signals predicted using the base mesh the second pressure peak is absent and the first pressure peak is stronger and ends earlier in openfoam same events occurring at the same blade positions with similar magnitudes are predicted but with numerical oscillations the total vapor volume was calculated during the simulation as v s u m σ 1 n α v i v c e l l i it is also of interest to isolate the vapor volume of the sheet cavitation and the tip vortex cavitation thus the cells with wall distance less than 2 cm which covers the sheet cavitation but excludes the tip vortex cavitation are selected and the vapor volume of these cells are computed as inner vapor volume as shown in fig 19 the difference between total vapor volume and inner vapor volume could be regarded as the volume of tip vortex cavitation the maximum total volume is about 4 cm3 and the sheet cavitation contribute the majority while the tip vortex cavitation vapor volume is much smaller about 0 3 cm3 at blade phase around 50 it has been noticed both numerically and experimentally that cavitation dynamics generate pressure fluctuations in a monopole manner and the pressure fluctuations can be related to the acceleration of cavity volume thus the linking of pressure pulse and cavity volume would be useful for identifying the source of cavitation phenomenon and generated pressure fluctuations for a breathing spherical structure the pressure fluctuation is proportional to its volumetric variation i e the second order derivative of its volume regarding time 12 p ˆ ρ 4 π r 2 v b t r c t 2 in which r represents the distance between the breathing sphere and the receiver point t is time c is velocity of pressure wave and v b represents the volume of the spherical bubble equation 12 could be simplified to a linear relationship as 13 p ˆ c d 2 v d t 2 taking second derivatives over time of the recorded vapor volumes results in the vapor rate shown in fig 20 in which the original data is plotted in grey and the smoothed data using savitzky golay filter savitzky and golay 1964 is plotted in black the resulting curves have highly similar shapes compared to the pressure signals the maximum vapor production condensation rate is about 1 5 2 0 m3 s 2 and it could be calculated that for this probe the pressure fluctuation is about c 1 d 2 v d t 2 with c 1 2313 71 the same analysis could be performed on the deduced tip vortex cavitation volume compared to the total vapor volume the deduced tip vortex cavitation volume is much smaller which contributes less than 10 of total cavitation but the vapor production condensitation rate is about 1 m3s 2 which is rather comparable to the rates calculated based on total vapor volume due to the similarity of d 2 v d t 2 and pressure fluctuations the resulted curve actually represented the pressure pulses generated from the tip vortex cavitation and for each blade passing it contains two major events and a series of smaller fluctuations the analysis of vapor volumes and pressure fluctuations provides a more complete picture of the pressure pulse mechanisms for the present case which is one of the common types that can be found for a propeller in behind conditions starting from 0 the present blade sheet cavitation extent increases until the total vapor volume reaches its maximum at around 30 at the same time the re entrant flow forms at around mid chord and travels towards the blade tip then the sheet cavitation starts to decrease in extent and pressure starts to increase during this process the tip vortex cavitation develops steadily at about 40 the re entrant flow reaches the blade tip trailing edge creating a cavity closure vortex which leads to that a part of the sheet cavity collapses after the collapse the pressure bounces back to a relatively high value which corresponds to the first pressure peak observed in the pressure signal this event is less pronounced using the tip refined mesh due to the differences in tip vortex cavitation development and the vortex interacting with the re entrant flow at the blade tip violent growth and collapse of the tip vortex cavitation can be observed between 48 and 54 which leads to the second pressure peak after the second peak the tip vortex cavitation show a monopole breathing manner and an induced series of fluctuations till about 82 10 degrees superimposed on the decreasing pressure signals the tip vortex cavitation collapse related phenomenon and the re entrant flow induced sheet cavity collapse both form mechanisms contributing to higher order pressure pulses generation the fft analysis is performed for the function c 1 d 2 v t i p d t 2 which represents the isolated pressure pulse generated from the tip vortex cavitation the results is shown as the dashed line with cross markers in fig 21 and we note that it is rich in higher order bpfs up to 10 th order the predicted pressure signals with three different time steps are shown in fig 22 predictions with the largest time step equivalent to 512 steps per propeller revolution is plotted in red line the other two lines are the results with 1024 and 2048 steps per revolution in the present study the larger time step would introduce rather significant difference compared to the other two smaller time steps the slope of the pressure increase is not as steep as the other two the two pressure peaks are delayed in blade phase which indicate the tip vortex cavitation is not well predicted the signal is rather smooth without much fluctuations the deduced pressure pulses by tvc with different time steps are also presented in fig 21 and it can be found the predicted values are significantly lower with large time steps this indicates that in order to capture the correct cavity dynamics it is not sufficient to choose a time step based on numerical stability alone but sufficiently small time scales of the physics in the flow needs to be considered 5 conclusions the present study focuses on the capability of a rans approach regarding the numerical prediction of marine propeller induced hull pressure pulses a 3600 teu standard container vessel designed and studied in the virtue and sonic eu projects with a five bladed propeller is studied numerically and prediction results are compared to experimental measurements performed at hsva in the experiment the model scale container vessel was mounted inside a cavitation tunnel while the propeller was operating at a fixed rotational speed of 28 rps two operating conditions are considered in the numerical simulations for condition 1 the propeller rotation speed is 28 rps corresponding to the experiments in the hsva cavitation tunnel and for condition 2 the propeller rotation speed is 8 5 rps corresponding to a test in a depressurised towing tank using froude scaling in both conditions the inlet velocity speed and environmental pressure are adjusted to achieve the same thrust coefficient and cavitation number the reynolds number differs about 3 times between the two conditions a mesh dependency study was performed first regarding nominal wake predictions in order to study tip vortex related phenomenon tip refinement downstream the propeller blades tip was also applied and compared the open source package openfoam and commercial package star ccm are both used for the simulations the mesh dependency study shows that the nominal wake prediction is sensitive to the prism layer cell arrangements a sufficient number of prism layers covering the major part of the flow boundary layer is vital to achieve an accurate prediction thus the further simulations were conducted with a fine structured mesh around the hull mid section and aft body regions for non cavitating conditions pressure pulses are concentrated in the blade passing frequency as also reported in the experimental measurements numerical predictions generally agree well compared to measurements but small differences are found in certain transducer locations with over predictions of the pressure pulses with a maximum difference of 0 4 kpa the predicted non cavitating 1 st order pressure pulse levels are very similar between different conditions meshes and numerical packages used regarding tip vortex predictions significant differences could be found between the base mesh and tip refined mesh while subtle differences could be found between conditions and packages the predicted sheet cavitation agree well compared to experimental recordings including the convex shape and the progression of its development during the wake passage slightly larger extent of sheet cavitation were predicted in condition 2 towing tank compared with condition 1 cavitation tunnel the 1 st and 2 nd order pressure pulse in condition 1 agree well compared with experimental data while about 20 30 over prediction are found with predictions from condition 2 the tip vortex cavitation tvc including the bursting like dynamics with multiple cavity structures and complex interactions with sheet cavitation is predicted using the tip refined mesh however the predicted tvc is generally weaker after the bursting compared to experimental recordings by using the base mesh no tvc is predicted without resolving tvc pressure pulses in 3 rd 5 th order bpfs are predicted using the base mesh while using the tip refined mesh much higher values are predicted the 3 rd order pressure pulse is in good agreement with the experiments using tip refined mesh in star ccm for condition 1 but in the other simulations the levels are under predicted over predictions are found regarding 4 th and 5 th order pressure pulses compared to experimental data further analysis was performed for the predicted pressure signal at the maximum probe point and studied together with simulated cavity volumes since cavitation generate pressure fluctuations in a monopole manner a linear relationship between pressure fluctuation and the second derivative of cavity volume can be used it was deduced based on this type of analysis that for the present case numerically predicted tip vortex cavitation generate pressure pulses up to 10 th order via the dynamics of the isolated tip vortex cavitation volume variation for the present type of tip vortex bursting which is likely to be one of the common types generating hull pressure pulses significantly the major events have been identified with support of the numerical simulations a re entrant flow which is formed due to the convex cavity closure line blade geometry and wake is formed beneath the sheet cavity surface and travels toward the blade tip when the re entrant flow travels to the blade end it induces a violent collapse of the sheet cavity and a rapid development of tip vortex cavitation is initiated which induce two pressure peaks added to the harmonic wave like pressure fluctuation signal from the sheet cavity the collapse of sheet cavitation forms the first pressure peak while the tvc collapse if resolved in the simulation forms the second pressure peak after bursting the tvc behaves in a breathing manner generating pressure fluctuations with smaller amplitudes the first sheet cavity collapse is found to be more pronounced for cases in which the tvc was not well resolved and the induced transient pressure peak contribute to the predicted higher order pressure pulses by the base mesh with a sufficient resolution in both time and space we find that rans is capable of predicting a large part of the dynamics of cavitation induced hull pressure pulses credit authorship contribution statement muye ge conceptualization methodology validation formal analysis investigation writing original draft urban svennberg conceptualization writing review editing supervision project administration rickard e bensow conceptualization methodology writing review editing supervision resources project administration funding acquisition declaration of competing interests the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement we would like to thank hsva for sharing geometry and experimental data financial support for this work has been provided by kongsberg maritime sweden ab through the university technology centre in computational hydrodynamics hosted at the department of mechanics and maritime sciences at chalmers university of technology the computations were performed on resources at chalmers centre for computational science and engineering c3se provided by the swedish national infrastructure for computing snic 
21794,advances in artificial intelligence are driving the development of intelligent transportation systems with the purpose of enhancing the safety and efficiency of such systems one of the most important aspects of maritime safety is effective collision avoidance in this study a novel dual linear autoencoder approach is suggested to predict the future trajectory of a selected vessel such predictions can serve as a decision support tool to evaluate the future risk of ship collisions inspired by generative models the method suggests to predict the future trajectory of a vessel based on historical ais data using unsupervised learning to facilitate trajectory clustering and classification the method utilizes a cluster of historical ais trajectories to predict the trajectory of a selected vessel similar methods predict future states iteratively where states are dependent upon the prior predictions the method in this study however suggests predicting an entire trajectory where all states are predicted jointly further the method estimates a latent distribution of the possible future trajectories of the selected vessel by sampling from this distribution multiple trajectories are predicted the uncertainties of the predicted vessel positions are also quantified in this study keywords maritime situation awareness trajectory prediction collision avoidance machine learning autoencoder ais nomenclature a arbitrary ais parameter vector a set of ais data b backward trajectory feature vector c data cluster d euclidean distance e eigenvector e eigenvector matrix f forward trajectory feature vector h latent feature vector h distribution of latent features k number of nearest neighbors l number of eigenvectors l number of data points in selected trajectory n number of trajectories m number of models in mixture model p selected vessel position vector p distribution of selected vessel position s vessel state vector s scatter matrix t time horizon min v speed over ground m s w interpolation weight x utm x coordinate m y utm y coordinate m λ eigenvalue matrix μ mean vector π prior distribution σ standard deviation σ covariance matrix χ course over ground subscripts 0 initial state b backward trajectory b c between class w c within class f forward trajectory i sample number j j th state m model number in gmm p trajectory prediction s selected vessel δ maximum offset superscripts ˆ estimated parameter state 1 introduction as more advanced technologies are introduced into transportation systems the opportunity to enhance the safety of these systems increases increased computational power in conjunction with advances in artificial intelligence and the ubiquity of sensor data allow for new methods to be implemented across a wide number of sectors some argue that an industrial revolution is taking place naming it industry 4 0 hermann et al 2016 the automotive industry is an example of a sector in which such technological advances are embraced and integrated into existing systems the shipping industry however has historically been more conservative in adopting new technologies often relying on older but proven systems nonetheless advances are being made with some arguing that shipping is also undergoing a technological revolution shipping 4 0 rødseth et al 2015 1 1 maritime situation awareness an essential aspect of shipping 4 0 is arguably implementing modern technologies to enhance the safety of maritime operations effective collision avoidance strategies are an integral part of maintaining safe operations the efficacy of such strategies relies on the degree of situation awareness of the navigator situation awareness was defined in endsley et al 2003 as being aware of what is happening around you and understanding what that information means to you now and in the future endsley 1995 separated situation awareness into three levels 1 perception of the elements in the current situation 2 comprehension of the current situation 3 projection of the future status maritime situation awareness largely relates to obstacle detection and prediction of close range encounter situations such obstacles will primarily be other vessels referred to as target vessels in an encounter situation it is therefore essential for a navigator to have an adequate degree of situation awareness in order to conduct effective collision avoidance maneuvers a thorough review of collision avoidance methods can be found in tam et al 2009 the main challenge for a navigator is determining the risk of collision based on their degree of situation awareness in light of endsley s definition one can classify level one situation awareness as relating to obstacle detection and level two an evaluation of the current collision risk perera and guedes soares 2015 addressed collision risk detection and quantification techniques with respect to integrating modern technologies the study discussed the concept of e navigation as introduced by the international maritime organization e navigation aims to utilize maritime information by electronic means to enhance the safety of maritime operations it was argued that integrated bridge systems are the main focus here relevant information relating to ship navigation should be properly integrated in order to provide decision support to navigators as such perera and guedes soares 2015 argued that the best navigation tools possible should be available on board the vessel to aid the navigator in identifying high risk situations based on this risk evaluation adequate collision avoidance maneuvers can be conducted that adhere to the colregs as outlined in perera et al 2010 a wide range of technologies are currently adopted to aid in providing situation awareness to navigators including radar conning and ecdis electronic chart display and information system radar systems facilitated by arpa automatic radar plotting aid and the ecdis are essential in aiding navigators to determine the risk of collision generally the future state of a target vessel is estimated based on calculations of constant course and speed values these estimates can then be used by the navigator to estimate collision risk parameters relating to the closest point of approach cpa such as the time tcpa and distance dcpa based on this information a navigator can make a decision with respect to a potential collision situation however predicting collision situations far in advance i e level three of endsley s situation awareness model will be the focus area of this study 1 2 vessel trajectory prediction predicting ship behavior as in perera 2017 can provide decision support to navigators to make appropriate collision avoidance maneuvers advanced techniques e g perera et al 2012 where extended kalman filters were utilized to estimate ship trajectories can further enhance the situation awareness of navigators such methods however are only useful for prediction horizons in the order of seconds to minutes as such they will only aid navigators in cases in which close range encounter situations are imminent as a result it was suggested in perera and murray 2019 to introduce an advanced ship predictor this study focused on methods to provide autonomous vessels with adequate situation awareness however such methods are also relevant for use in decision support to ship navigators in this approach a local and global scale ship predictor were suggested at a local scale techniques such as those outlined in perera 2017 can be utilized to aid in short term trajectory predictions in order to aid in effective collision avoidance maneuvers once a collision is deemed imminent on the global scale however long term trajectory predictions on the scale of 5 30 min are conducted such predictions aim to prevent close range encounter situations from occurring at all such predictions are however not straight forward as the future intentions of the vessel are unknown and may potentially be complex 1 2 1 ais based vessel trajectory prediction one method to conduct vessel trajectory predictions on a global scale is to utilize historical ais automatic identification system data by exploiting ais data insight into historical ship behavior can be gained multiple ship parameters relating to historical ship movement are stored in databases available for use such parameters include the position speed and course over ground recently there has been a significant increase in research into exploiting ais data for maritime situation awareness a number of studies have focused on evaluating grouping trajectories together to gain insight into maritime patterns aarsæther and moan 2009 for instance utilized computer vision techniques to group trajectories and subsequently calculate statistics for each traffic pattern zhang et al 2018 also utilized ais data via a data driven approach that compressed and clustered trajectories to extrapolate the general behavior patterns of vessels traveling along the same route subsequently given a starting point the ant colony algorithm was utilized to output an optimal route to the destination zhang and meng 2019 also presented a data driven method to determine a probabilistic ship domain based on ais data such ship domains can subsequently be utilized for collision risk assessment a comprehensive review of various methods to exploit ais data for maritime navigation was presented in tu et al 2017 of primary interest for this study however is the work done to predict the future trajectory of a vessel that can be utilized in a global scale ship predictor as such the aforementioned methods are of limited usefulness ristic et al 2008 utilized a particle filter to predict the future behavior of vessels using historical ais data but the predicted future positions had a large uncertainty associated with them making the method of limited use with respect to collision avoidance decisions and actions a number of studies also have focused on clustering historical trajectories and subsequently classifying a vessel to one of these groups pallotta et al 2013 for instance presented the tread traffic route extraction and anomaly detection methodology that clustered all historical trajectories in a specific region to identify traffic routes and subsequently classify a partial trajectory to one of these routes for anomaly detection the method also addressed assessing the probability of a position along a route pallotta et al 2014 further expanded upon the tread methodology by predicting the vessel position along a route using the ornstein uhlenbeck stochastic process the tread technique however clustered entry points way points and stationary points of trajectories within a defined region in this respect the trajectory through the entire region was utilized to group similar trajectories together this can result in trajectories with large differences between sub trajectories being clustered together for predictions in the order of hours this is not an issue and the outlined method is quite effective for collision avoidance purposes a higher fidelity prediction is required that requires more discrimination between trajectories other studies on clustering and classification include zhao and shi 2019 which clustered trajectories by using dynamic time warping and the douglas peucker algorithm in addition to zhou et al 2019 which clustered using k means and subsequently classified ship behavior methods relying on dynamic time warping and way point based clustering will cluster trajectories based on similar spatial behavior but be invariant with respect to time as such trajectories that have similar spatial shapes will be grouped together despite various behavior being observed at different relative times this may be detrimental to a subsequent trajectory prediction in that the clustering capability is restricted to the shapes of trajectories irrespective of their duration and potential differences in sub trajectories mazzarella et al 2015 also presented a trajectory prediction approach using ais data via a bayesian network approach with a particle filter this method was designed for predictions in the order of hours and as such of limited use with respect to collision avoidance other methods include hexeberg et al 2017 where a single point neighbor search method was presented based on historical ais data the method does not involve any clustering or classification steps and as such suffers when handling branching dalsnes et al 2018 built upon this work and provided multiple predictions using a prediction tree this approach allows for a probability estimate of a future prediction to be estimated using a gaussian mixture model these methods however do not utilize the relationship between data points as future states are based solely on the neighborhood of previous states which may not have any relationship to the prior predicted states this will have a negative effect on the accuracy rong et al 2019 also presented a probabilistic trajectory prediction method using a gaussian process model this method in addition to predicting the future position of a vessel gave an uncertainty estimate associated with the prediction the method had good results for the regular trajectories investigated off the coast of portugal but did not address how to deal with more complex traffic situations and trajectories which likely will degrade the outcome 1 3 generative models the method utilized in this study takes an alternative approach to those that come before it is inspired by a field of deep learning known as generative models foster 2019 widely adopted in the field of machine learning such models have recently gained a high degree of popularity due to the powerful generative ability of deep learning models one such general model is the autoencoder an autoencoder is a type of neural network with its most simple form being a multi layer perceptron bourlard and kamp 1988 the objective of an autoencoder is to reconstruct the data fed into it essentially copying its input to its output such techniques are however not extensively applied in the maritime domain some studies have looked into applying these approaches in the maritime domain e g perera and mo 2018 where autoencoders were suggested as a tool to compress data to facilitate more effective maritime data transmission autoencoders are considered to have two parts an encoder function f x that produces the code h shown in 1 and a decoder function g h that reconstructs the data from the code shown in 2 an integral part of an autoencoder is the internal hidden layer h that represents the code space often referred to as the latent representation of the data 1 h f x 2 x ˆ g h for an autoencoder to be useful it must provide a form of functionality other than mapping the input to the output undercomplete autoencoders goodfellow et al 2016 i e where h has a smaller dimension than x provide a bottleneck in the code space through which the network can learn a meaningful latent representation of the data the mapping function of the input data to the code space f x can be thought of as a data compression operation or parameter reduction the encoder strives to create a meaningful latent representation that preserves as much information as possible such that the decoder has adequate information to reconstruct the data as such when an autoencoder is trained on a dataset it will adapt such that the encoder preserves the most important information in the dataset traditionally autoencoders have been utilized for dimensionality reduction and feature generation goodfellow et al 2016 in this case the latent representation can be utilized for data visualization or to generate more relevant features for further processing additionally once an autoencoder is trained data can be compressed and stored subsequently it can be decoded for later use such applications are often very useful however the generative capabilities of autoencoders have recently also gained interest alternatively to encoding and decoding the data one can solely utilize the decoder in order to generate new data this is done by sampling a data point in the code space and subsequently running a forward pass through the decoder to reconstruct the data in this manner one can interpolate between existing data points in the code space to generate new samples the variational autoencoder kingma and welling 2014 rezende et al 2014 is a popular type of generative model a variational autoencoder is a probabilistic version of an autoencoder where the network learns a probability distribution of the reconstructed data based on a learned distribution over the code in this manner there is a continuous distribution in the code space that can be sampled from kingma and welling 2014 investigated the use of a variational autoencoder and presented a figure illustrating generated images from a variational autoencoder trained on the mnist dataset of handwritten digits the figure illustrates the interpolation of the digits with a 2 d latent code each axis along the figure can be thought of as one dimension in the latent code it is evident that as one moves around within the code space the digits morph from one digit to another the latent representation is able to capture the most important differences in the data along the respective axes as such one can generate a new image simply by interpolating within the code space generated by training the autoencoder such generative capabilities can be extended to virtually any dataset where an autoencoder is trained and based on the latent distribution of the data can generate new data samples from the distribution as such if an autoencoder is trained on a cluster of trajectories it should be able to generate a new trajectory by interpolating in the latent space 1 4 contribution the objective of this study is to provide an architecture that can support collision avoidance actions by providing situational awareness to navigators or autonomous agents as a result the architecture differs from that of similar studies with respect to its design to aid in situation awareness a method is suggested to provide a global scale ship predictor that estimates the future 30 min trajectory of a selected vessel with a high degree of fidelity as opposed to a number of other studies the approach in this study is designed to run live i e without any pre trained models a ship in any region given an adequate density of historical ais data can therefore utilize the developed architecture in the suggested approach relevant historical ship trajectories are extracted from an ais database that represent the possible future 30 min behavior of a selected vessel this dataset comprises only relevant data with respect to the observed state of a selected vessel for the purpose of trajectory prediction and as such provides the basis for the remainder of the prediction methodology inherent differences in behavior are described by these trajectories which in turn represent the possible modes of the future 30 min behavior the selected vessel may belong to therefore the trajectory representation differs from other methods that evaluate entire trajectories for a region the representation in this study provides higher fidelity predictions as a result in order to discover clusters of similar trajectories other approaches utilize trajectory representations that introduce invariance with respect to time e g dynamic time warping or point based techniques using waypoints these techniques are effective for clustering trajectories of similar shapes together for the purpose of this study however it is of interest to discover all possible trajectory modes that represent the future 30 min behavior of the selected vessel not just trajectories of similar shapes for the region as such trajectories should not be invariant with respect to time therefore by representing each trajectory by vectors of equal length containing the future 30 min of trajectory data the representations will be sensitive to the time at which various behavior is observed such a representation will therefore be more sensitive to modes within primary ship routes discovering these modes will provide a much better basis for a subsequent trajectory prediction for collision avoidance purposes as the prediction must be as accurate as possible this study suggests to cluster compressed trajectories via gaussian mixture models to an unspecified number of clusters each representing a mode of future behavior and is shown to have good performance for the purpose of the study once a selected vessel is classified to a given cluster of historical ais behavior this data is used directly in the dual linear autoencoder prediction architecture this architecture differs significantly from other methods which generally predict future states in manner such that they are predicated upon previous predicted states in this study it is suggested to predict entire trajectories i e all future states are predicted jointly a novel trajectory prediction technique inspired by generative models is therefore suggested using a dual linear autoencoder approach in this approach a latent representation of the possible future behavior of the selected vessel is calculated the latent representation can be viewed as an encoded version of the data using this distribution the encoded representation of the selected vessel s future behavior is estimated by interpolating between the encoded data points by decoding the estimate of the latent representation of the future trajectory an entire trajectory is predicted by a single matrix multiplication operation other methods predict an average of the behavior in the cluster i e the average of the distribution whereas the method suggested in this study will estimate the most likely sample as such the prediction is discrete and can provide more accurate predictions than other methods in which the behavior is averaged out the prediction accuracy will also be enhanced for clustering schemes that are able to identify ship modes with a high degree of fidelity as clusters that contain multiple ship modes will result in the prediction averaging out the behavior between modes due to the interpolation as a result the overall architecture of the study allows for higher fidelity predictions than other methods additionally the study provides a method to estimate the distribution of the selected vessel s future trajectory latent representation this is to account for uncertainty in the estimate and by decoding samples from this distribution a region of uncertainty for the predicted position at a given prediction horizon can be evaluated the suggested architecture also utilizes linear autoencoders therefore it allows for fast predictions as they are facilitated by calculating eigenvectors and conducting subsequent matrix multiplications as such there is no training of a deep neural network this architecture is therefore ideal for live predictions as the calculations involved in the prediction itself will be fast this approach in this study therefore provides a method to conduct live predictions of higher fidelity with respect to collision avoidance purposes on a global scale than other methods as well as an effective method to quantify the uncertainty of the predicted positions 2 methodology in this section the methodology utilized to predict the future trajectory of a selected vessel is outlined the objective of the method is to accurately predict the future trajectory of a selected vessel and provide an uncertainty estimate with respect to the predicted positions the overall architecture of the method is illustrated in fig 2 the method can be separated into three modules the first is the trajectory clustering module where groupings of similar historical trajectories are discovered it is assumed that the future trajectory of a selected vessel can be inferred based on the historical trajectories of other vessels in the region as such the selected vessel is classified to one of the discovered clusters in the trajectory classification module based on the cluster of trajectories to which the selected vessel is classified a trajectory prediction is conducted in the trajectory prediction module this is achieved via a novel dual linear autoencoder approach in this approach two linear autoencoders are utilized the forward linear autoencoder provides a latent representation of the historical trajectories that can be used to infer the future trajectory of the selected vessel the backward linear autoencoder provides a latent representation of the prior behavior of the historical trajectories based on a similarity measure evaluated in the latent space of the backward linear autoencoder a latent interpolation is conducted to estimate the forward latent representation of the selected vessel subsequently this estimate can be decoded resulting in a trajectory prediction 2 1 unsupervised trajectory clustering and classification in this section the methodology involved in clustering historical ais trajectories and classifying the trajectory of a selected vessel is outlined this work in this section builds upon preliminary work described in murray and perera 2019 the reader is therefore referred to murray and perera 2019 for further details it can be argued that investigating the historical behavior of vessels in a particular geographical region can provide insight into the future behavior of a vessel observed in that region however historical vessel trajectories will have a high degree of variation this variation is due to the existence of multiple traffic routes as well as the characteristics of the vessel with respect to the speed it will traverse along a given route it is therefore of interest to identify groupings of similar trajectories such that specific traffic behavior can be identified once such groupings are identified a selected vessel can be classified as belonging to a given group in this manner a subsequent trajectory prediction can be conducted on an enhanced data set where the data used for prediction will likely have a high degree of similarity to that of the selected vessel this can be thought of as advanced form of preprocessing of the ais data such that subsequent trajectory predictions will have a higher degree of accuracy grouping such data can be conducted via a technique from the field of machine learning known as clustering this is a form of unsupervised learning where labels for the data are unavailable clustering has as its goal to discover underlying groupings in the data i e identify clusters of data once the historical vessel trajectories have been clustered the observed trajectory can be used to classify the selected vessel to one of the discovered clusters 2 1 1 trajectory extraction the initial state of a selected vessel is defined in 3 this state represents the observed parameters of the selected vessel available via the on board sensor suite of the own ship the parameters in this state provide the basis for the selection of relevant historical ship trajectories for a subsequent prediction of the selected vessel s future trajectory 3 s 0 x 0 y 0 χ 0 v 0 the method first identifies historical ais data points with a high degree of similarity to s 0 in essence this means that it is desirable to identify ships that were at a similar position with a similar course and speed at some point in history in order to achieve this an initial cluster c 0 is created c 0 is defined to be a rectangular cluster orthogonal to χ 0 with a height of δ h parallel to χ 0 and a width δ w orthogonal to χ 0 z is the rotated space with the orthogonal vectors in the original space as basis vectors c 0 is defined according to the following equation murray and perera 2019 4 c 0 a i a x z i x z 0 δ w y z i y z 0 δ h χ i χ 0 χ δ v i v 0 v δ additionally data points that do not match the ship type of the selected vessel are removed c 0 will however likely contain multiple data points from the same trajectory as such unique trajectories are identified and the most similar point to s 0 in each unique trajectory determined c 0 is then updated by filtering out all data points other than these most similar points in this manner c 0 only contains one data point per trajectory once the initial clustering phase is completed a forward and backward trajectory extraction operation is conducted this entails that for all trajectories in c 0 the forward trajectory from the corresponding point in c 0 is extracted this can be thought of as the future trajectory defined in relation to the point in c 0 the length of the extracted forward trajectory is defined based on the desired prediction horizon t p for instance if a 30 min prediction is desired 30 min of the forward trajectory will be extracted similarly the backward i e past trajectory from its corresponding point in c 0 of a length corresponding to t b into the past is extracted both the forward and backward trajectories are subsequently interpolated at 30 s intervals for comparative analysis as such each trajectory will have l 2 t p entries where each entry can be used to compare positions at a given time instance defined from the origin of the trajectory see fig 3 2 1 2 trajectory clustering one of the objectives of extracting the forward trajectories is to provide a dataset upon which one can identify possible future routes that the selected vessel may follow it is therefore desirable to group or cluster these trajectories such that each possible route can be evaluated individually as there may be many possible future routes that the selected vessel may follow this is conducted by first generating features for each trajectory by flattening the positional data given in utm coordinates i e x y into a feature vector clustering is a technique that groups data points based on some similarity measure i e data points that are closer to one another in some n dimensional space are more likely to be considered part of the same cluster if the dimensionality of the space is large however the clustering algorithm may suffer due to the curse of dimensionality discussed in steinbach et al 2004 one aspect of curse of dimensionality relates to points getting lost in the space due to large distances between points with respect to certain dimensions this can make clustering in a high dimensional space challenging dimensionality reduction is therefore conducted for each trajectory via the karhunen loéve kl transform karhunen 1946 in 5 where the dimensionality is reduced from 2 l to l 5 h f e t f where h f r l 1 f r 2 l 1 and e r 2 l l 6 σ e λ e t where σ r 2 l 2 l and λ r 2 l 2 l the next step is to cluster the forward trajectories this is conducted using gaussian mixture model gmm clustering via the expectation maximization em algorithm a gaussian mixture model reynolds et al 2000 assumes that data is comprised of a mixture of m different gaussian distributions each with their own mean vector μ m covariance matrix σ m and prior distribution π m each data point representing a forward trajectory will be clustered to the distribution of the highest probability the em algorithm updates the underlying parameters until a model of best fit is discovered the assumed number of underlying distributions m is also varied to discover the most likely mixture for more details on gmm clustering of trajectories see murray and perera 2019 2 1 3 trajectory classification once the forward trajectories have been clustered it is desirable to classify the selected vessel to one of the discovered clusters one method to achieve this is to investigate the backward trajectories assuming that the past behavior of the selected vessel is available for a period corresponding to t b one can compare the past behavior of the selected vessel to the backward trajectories extracted from c 0 the aforementioned backward and forward trajectories are in fact one single trajectory but the forward trajectories are the section corresponding to the future behavior and the backward trajectory the past behavior in the classification module the extracted backward trajectories are assigned the class labels of their corresponding forward trajectories discovered in the clustering module these are utilized to classify the observed trajectory of the selected vessel to one of these classes in order for the classification process to be as effective as possible it is of interest to generate optimal features to represent the backward trajectories this is achieved via linear discriminant analysis lda fisher 1936 lda requires that the data points are labeled and as such the backward trajectories are given the labels of the corresponding forward trajectories the transformation is conducted via 7 subsequently a classifier of choice can be utilized to classify the transformed backward trajectory of the selected vessel to one of the clusters this will yield the most likely future route that the selected vessel will follow in this study a k nn classifier is utilized 7 h b e t b where h b r l 1 b r 2 l 1 and e r 2 l l 8 s wc 1 s bc e λ e t where s wc 1 s bc r 2 l 2 l and λ r l l 2 2 dual linear autoencoder this study introduces a novel dual linear autoencoder trajectory prediction method that is further described in this section the motivation is to predict the future trajectory of a selected vessel the method is inspired by the generative models addressed in section 1 3 if one can create a latent distribution of possible future trajectories one can then interpolate between existing trajectories in the latent space and generate a new trajectory that corresponds to the selected vessel autoencoders generally have non linear activation functions however the linear autoencoders investigated in this study do not have non linear activation functions in the network and as such the encoder and decoder functions will simply be linear transformations of the data consider a 2 layer linear autoencoder as illustrated in fig 1 let the encoder function be described by 9 and the decoder function by 10 if the network is trained using the mean squared error shown in 11 as the loss function j the minimum reconstruction error is shown to be achieved if v w and c μ where the columns of w span the orthonormal basis spanned by the eigenvectors of the covariance matrix σ of the dataset goodfellow et al 2016 the columns of w are ordered by the magnitude of their corresponding eigenvalues one recognizes that the encoder function f x is in fact the same as the kl transform for the case of a linear autoencoder this allows for efficient calculations as the covariance matrix and its corresponding eigenvectors and eigenvalues can easily be calculated significantly saving computation time compared to training a network the eigenvectors calculated here capture the directions in which there is the greatest degree of variation in the data data can therefore be compressed and reconstructed as a linear combination of the projections of that data onto a subspace spanned by the top l eigenvectors with the largest eigenvalues 9 h f x w t x μ 10 x ˆ g h v h c 11 j e x x ˆ 2 the basis of the method is to train two linear autoencoders all forward trajectories belonging to the class of the selected vessel are input to the forward linear autoencoder in the latent representation i e the code space one can then interpolate between existing data points and in this manner predict the latent representation of the selected vessel s future trajectory if one then runs a forward pass through the decoder i e 10 one will get a full trajectory prediction at the cost of a matrix multiplication operation one can in theory move about the latent space and generate new trajectories in a similar manner to the mnist digits in kingma and welling 2014 the underlying distribution of possible future trajectories would then be visualized where moving in one dimension or another represents the most variation in the possible future trajectories the interpolation however depends on a similarity measure of the backward trajectories to the backward i e observed trajectory of the selected vessel this is facilitated via the backward linear autoencoder 2 2 1 forward linear autoencoder the forward linear autoencoder has as its goal to create a meaningful latent representation of the extracted forward trajectories however training an autoencoder on all the forward trajectories will yield a latent representation that describes the greatest variations in the data i e between all clusters of trajectories this may for instance yield predictions where a data point is interpolated between clusters and in fact represents an unrealistic data point that is not part of the original distribution if one however considers solely the cluster of trajectories that the selected vessel has been classified to one now has a subset of trajectories that are highly similar to each other where interpolation between points should be meaningful as such training an autoencoder on this subset of data will allow it to learn a latent representation that describes this specific cluster decoding a data point from this latent representation will therefore yield a trajectory prediction of higher fidelity the encoder and decoder functions are shown in 12 and 13 respectively where e f is the matrix of the subset of the top l eigenvectors of the covariance matrix of the forward trajectories 12 h f e f t f 13 f ˆ e f h f 2 2 2 backward linear autoencoder the success of the trajectory prediction technique relies on the interpolation in the latent space of the forward linear autoencoder given that the future trajectory is unknown one must infer the latent representation of the selected vessel in the forward latent representation it is therefore suggested to investigate the backward trajectories of the classified cluster in comparison to the backward trajectory of the selected vessel by identifying the degree of similarity between all backward trajectories in the cluster and the backward trajectory of the selected vessel one can interpolate in the latent space of the forward linear autoencoder using the similarity of the backward trajectories as weights it is suggested in this study to utilize a linear autoencoder to evaluate the similarity in the same manner as the forward linear autoencoder the backward linear autoencoder will learn a meaningful latent representation that describes the variation in the underlying trajectory data in this lower dimensional latent space the distance from the encoded selected vessel trajectory to all other trajectories can be measured conducting such a similarity measure in this space will yield better results due to the same challenges relating to curse of dimensionality steinbach et al 2004 as those addressed in 2 1 2 the encoder and decoder functions are shown in 14 and 15 respectively where e b is the matrix of the subset of top l eigenvectors of the covariance matrix of the backward trajectories 14 h b e b t b 15 b ˆ e b h b 2 2 3 latent interpolation since there is no explicit mapping function from the latent space of the backward autoencoder to the latent space of the forward autoencoder a similarity based mapping approach is suggested the architecture of the suggested method is visualized in fig 4 the figure shows how the backward trajectories are mapped to a latent representation h b in orange as are the forward trajectories in green to the latent space h f e represents the coordinate systems of the latent spaces the backward trajectory of the selected vessel is illustrated as the solid red line and represents the information available of the past behavior of the selected vessel this information is then encoded in the backward latent representation h b s as the red data point the goal of the mapping operation is to map to the corresponding red data point in the latent representation of the forward trajectories the mapping function can be considered an interpolation between the data points of the encoded forward trajectories the similarity between the encoded backward trajectory of the selected vessel h b s and all the backward trajectories is calculated as the euclidean distance according to 16 one common form of interpolation for multivariate data is inverse distance weighting an interpolation scheme is presented in shepard 1968 with a weighting function according to 17 and the interpolated value calculated according to 18 the equation interpolates within a neighborhood such that the k nearest data points are found and the interpolated value is calculated on a subset of neighboring data in this manner the interpolated value is not as affected by outliers and therefore more likely to be closer to the true value 16 d i h b i h b s 17 w i 1 d i 18 h ˆ f s i 1 k w i h f i i 1 k w i 2 2 4 decoded trajectory prediction subsequent to the latent interpolation operation the future trajectory of the selected vessel can be decoded i e predicted according to 19 once this is completed f ˆ s must be reshaped to a matrix containing the spatial data x y as its columns the prediction is subsequently updated such that the offset between the true initial position x 0 y 0 and the predicted initial position x ˆ 0 y ˆ 0 is subtracted from all the entries of the prediction to account for minor offsets that occur due to the approximation inherent in the latent interpolation this yields a trajectory prediction for the selected vessel at 30 s intervals up to the desired prediction horizon t p one can evaluate each row of the matrix as the predicted vessel position p ˆ j in each vessel state s j where each state is separated by 30 s 19 f ˆ s e f h ˆ f s 2 2 5 uncertainty estimate of predicted position the trajectory prediction gives a single prediction however the outlined method does not give a measure of uncertainty related to the predicted position at each time interval a method is therefore suggested to achieve this utilizing the linear autoencoder architecture previously introduced some uncertainty can be attributed to the reconstruction loss that results from reducing the dimensionality in the autoencoders but the primary source is the uncertainty associated with the latent interpolation it is therefore suggested to create a distribution in the latent space of the encoded forward trajectories i e h f s that can account for some of the interpolation error if one considers the neighborhood of h ˆ f s one can investigate the uncertainty with respect to the k nearest neighbors in the latent representation of the backward trajectories h b the method suggests to assume that h ˆ f s is the mean of a normal distribution according to 20 with a weighted unbiased covariance according to 21 these weights correspond to those in 17 in this manner the distribution will reflect the relevant importance of each latent forward trajectory representation based on their weights from the backward trajectory similarity measure 20 h f s n h ˆ f s σ h s 21 σ h s i 1 k w i h f i h ˆ f s h f i h ˆ f s t i 1 k w i i 1 k w i 2 i 1 k w i this however only yields a form of uncertainty with respect to the latent representation of the selected vessel s forward trajectory what is of interest however is the uncertainty of the predicted position at various vessel states to achieve this it is suggested to run a monte carlo simulation raychaudhuri 2008 that samples from the latent normal distribution in 20 to approximate the distribution of the trajectory predictions each sample from h f s is decoded according to 19 yielding a full trajectory prediction in the same manner as in section 2 2 4 the sampled predictions are also updated based on the offset of the true and predicted initial positions this correction will be greater for samples further away from the true value of h f s but it is assumed to have limited effect on the predictions with respect to estimating the uncertainty after the samples are decoded the distribution of the decoded trajectory positions can be evaluated at each time instance this can be viewed as the distribution p j of the predicted position p ˆ j for each vessel state s j where each state is that of the selected vessel at 30 s intervals the distribution of the position in each state can further be assumed to be normally distributed according to 22 where the mean and covariance are calculated based on the sampled predictions as such uncertainty measures can be calculated with respect to the standard deviation of the distribution 22 p j n μ j σ j 3 results and discussion to evaluate the method 100 random data points were selected from a dataset of historical ais data in the region surrounding the city of tromsø norway the dataset corresponds to that collected from january 1st 2017 to january 1st 2018 each data point represents a selected vessel state that will be initialized as the initial state s 0 of that vessel the aforementioned trajectory prediction methodology is then utilized to predict the future 30 min of each selected vessel s trajectory such as to evaluate the performance of the method the true future trajectories of the selected vessels can be thought of as the test dataset for each respective prediction the remainder of the ais data is then the training dataset utilized to conduct the predictions in this manner the method predicts the future trajectory of 100 different vessels and the accuracy can be evaluated based on the true trajectory of the vessel a value of l 3 is utilized for the latent representation of both h b and h f additionally the 100 most similar vessels to each selected vessel i e k 100 is utilized for the latent interpolation 3 1 classification accuracy the input to the trajectory prediction module is the set of extracted trajectories corresponding to the output of the classification module as such the method relies on the accuracy of this classification as an incorrect classification will result in a prediction with respect to a cluster of ship behavior that does not match the selected vessel in this study a value of k 7 was utilized for the k nn classifier for the results presented in this section 67 of the selected vessels were classified correctly in many cases however the incorrect classification can be attributed an incorrect behavior mode i e cluster these modes can be along the correct route but may for instance traverse further to one side of the lane or have variations in the speed profile along the route predictions with respect to these modes despite being incorrect can nonetheless result in reasonably accurate predictions this is due to the clustering algorithm identifying multiple modes that are quite similar one should note that this can be seen as a situation where some data clusters can overlap each other as such the 33 of incorrectly classified cases in this study likely includes many cases in which the selected vessel was classified to an incorrect mode along the correct route i e a similar trajectory mode additionally the success of the classification depends on the complexity of the discovered clusters it is on the one hand desirable for the clustering algorithm to discover as many trajectory modes as possible as this can enhance the accuracy of the subsequent trajectory prediction on the other hand an increase in the number of clusters will provide a more difficult classification task this will be further complicated due to overlapping clusters as mentioned previously each cluster is multi dimensional and classifying in this space can be challenging however the focus of the study is the dual linear autoencoder prediction technique it should be noted that the trajectory prediction methodology utilizing a dual linear autoencoder as described in this study can be utilized based on any previous clustering and classification technique however it does require that trajectories are extracted utilizing the methods described in section 2 1 1 such that trajectories can be encoded and decoded properly this trajectory extraction process can however also be conducted after an alternative clustering and classification regime has been utilized 3 2 trajectory prediction fig 5 illustrates an example of a trajectory prediction for one of the randomly selected vessels in the dataset all presented predictions are evaluated with p 0 as the origin of the coordinate system to more easily evaluate the distances involved in the case of fig 5 the algorithm classified the selected vessel to the correct cluster of trajectories the green dotted line represents the predicted trajectory of the selected vessel and the red dotted line represents the true trajectory of the selected vessel it is clear that for this case the trajectory prediction was quite accurate additionally an estimate of the uncertainty of the position at a 30 min prediction horizon is illustrated each black dot illustrated represents a decoded sample from the normal distribution of h f s in 20 utilizing these predictions a normal distribution p j was fit to the predicted positions for each state according to 22 based on this distribution the 1 σ 2 σ and 3 σ contours could be evaluated and are visualized in the figure such contours can be evaluated at any prediction horizon but only the results for the 30 min prediction horizons are illustrated in this section fig 6 shows a prediction of a more complex trajectory showing that the method is also able to successfully reconstruct more complex trajectories in certain cases however the classification is incorrect this in some cases can result in a vessel prediction along an incorrect route resulting in a degree of error with respect to the predicted position an example of such a case is illustrated in fig 7 3 3 prediction accuracy the performance of the method is most effectively measured based on the accuracy of the prediction with respect to the true vessel position the predicted position error is calculated as the distance from the mean μ j of the distribution p j and the true position in that state i e p j additionally the error is presented as a percentage of the true distance traveled by the selected vessel this is due to various vessels having traveled different distances during the course of 30 min in this manner one can compare the error irrespective of the distance traveled fig 8 illustrates the median error of all 100 predictions as a function of time i e the desired prediction horizon the overall error for all selected vessels is evaluated where the median error for a 30 min prediction is found to be 2 5 if one looks only at the vessels that were incorrectly classified it is evident that they result in a higher degree of error where the median error at a prediction horizon of 30 min is 9 6 of the distance traveled if one solely investigates the correctly classified vessels however the accuracy of the prediction increases significantly with a median position error of 1 6 for a prediction horizon of 30 min this illustrates the importance of correctly classifying the selected vessel as the predictions are discrete with respect to each class of trajectories an incorrect classification results in the prediction being conducted on a cluster corresponding to a different mode of ship behavior than that of the selected vessel fig 9 illustrates a box plot of the positional error at 5 min intervals for the correctly classified vessels the green bars correspond to the median values in fig 8 it is clear that the variance of the error increases as a function of time generally it appears that the method has good performance when vessels are correctly classified for prediction horizons up to 30 min 3 4 position uncertainty estimate as previously mentioned a normal distribution of the predicted position p j in each state is evaluated according to 22 the resultant 1 σ 2 σ and 3 σ contours can be utilized to give a measure of uncertainty relating to the prediction in each state it is desirable for this uncertainty to be as small as possible whilst still capturing the behavior of the selected vessel if the uncertainty is too small however it may not include the true future position of the selected vessel allowing for too much uncertainty on the other hand is not desirable either it is conceivable to extend the region of uncertainty such that the true future position of the selected vessel will always be included within the contours in such cases however the usefulness with respect to maritime situation awareness will be degraded as there will be a risk of collision for a very large area this increases the likelihood of the navigator needing to take action in cases where the true risk of collision is low the degree of uncertainty is dependent upon two factors the power of the clustering algorithm and the number of vessels included in the latent interpolation if the clustering algorithm is able to discover a group of trajectories with very specific behavior the uncertainty of the prediction will decrease as the variance of the behavior within the cluster is limited in essence all the historical trajectories utilized in the prediction are almost the same causing all predictions to have similar values when sampling from the latent space similarly if one only selects a limited number of vessels to evaluate the latent representation of the selected vessel in 20 the prediction will be restricted to the behavior of these historical trajectories increasing the number of trajectories will increase the variance of the behavior and contribute to a larger region of uncertainty the effect of this was investigated where the number of similar vessels k utilized in 20 was varied and the position error evaluated as a percentage of the distance traveled in the same manner as described in section 3 3 fig 10 illustrates the mean error for various values of k as a function of the prediction horizon for the 100 randomly selected vessels it is evident that increasing the value of k contributes to an increase in error but that this error converges as k increases it should be noted that the probability contours solely relate to the probability of the predicted future position and as such are entirely dependent upon the model developed in this study they provide a measure of uncertainty with respect to the predicted positions where the true position should fall within the region enclosed by the contours the predictions are based on historically similar vessels whose behavior do not necessarily match that of the selected vessel the assumption that the future trajectory of a selected vessel depends on its past trajectory is therefore a limitation of the method the uncertainty of the predictions can therefore be thought of as describing the variance of the historical behavior where it is likely that the vessel will fall somewhere within the specified region the method is designed to identify the most similar trajectories however the data may be dominated by specific vessel behavior that has a higher frequency if more similar historical trajectories have a lower frequency the data will be dominated by the less similar trajectories of the highest frequency this effect will however be somewhat ameliorated due to the weights in 17 as the more similar trajectories will have higher weights when calculating h ˆ f s and σ h s the percentage of the correctly classified vessels whose true position after 30 min was within the regions bounded by the corresponding σ contours was also investigated this was conducted in order to evaluate the uncertainty measure s ability to capture the true position of the selected vessel the results are shown in table 1 the values are estimated such that the 3 σ contour includes the points inside the 2 σ contour which again includes the points inside the 1 σ contour 75 of all true vessel positions were captured by the 3 σ contour for the tested selected vessels cases in which the true positions did not reside within the contours were therefore investigated fig 11 illustrates one such case the prediction appears to be quite accurate with the true and predicted trajectories nearly exactly aligned it is evident however that the uncertainty contours are not visible fig 12 illustrates a close up of the predicted position after 30 min here one can see that the predicted final position illustrated as the largest red dot falls outside the uncertainty contours when investigating the scale involved one can see that the true and predicted positions in fact reside less than 20 m from each other the uncertainty ellipses are extremely small and therefore reflect a very high certainty of the model with respect to the predicted position fig 13 illustrates the cluster of trajectories utilized to conduct the prediction it is discovered that this cluster corresponds to a ferry where the final position after 30 min is at one of its ports as such the data upon which the prediction is determined is concentrated about this position an offset of 20 m can be accounted for by error inherent in the ais data in addition to the orientation of the vessel when in a port there are multiple ferries in the region surrounding tromsø when investigating all tested vessels with a ship type of passenger vessel it was found that the performance with respect to the uncertainty measures was degraded despite the predictions being quite accurate the percentage of these vessels is also shown in table 1 in addition to results for all vessels except those labeled as passenger vessel it is clear that the performance increases in this case the performance of other vessel types is however likely affected by vessels with similar effects where the cluster of underlying data is too similar to allow for a large uncertainty measure whilst still providing accurate predictions 3 5 running time as the algorithm is intended to run live it is of interest to investigate the running time of the method to support the discussion the authors have evaluated the running time of the method for the cases in this study all evaluations have been run on a 2 30 ghz cpu and 16 gb ram in the following sections the running times are evaluated in two parts the first addresses the running time of the trajectory extraction algorithm and the other the classification clustering and prediction algorithms the data utilized in this study consisted of approximately 15 million data points these data points are input to the algorithm without any pre processing in the trajectory extraction step relevant historical trajectories need to be extracted from the raw ais data once this is conducted the data will be available for the period a prediction is required fig 14 illustrates the running time of the extraction of trajectory data this is visualized as a function of the number of relevant trajectories extracted a third order regression was applied to the data to visualize the relationship between the running time and the number of trajectories it is clear that the running time increases with the number of extracted trajectories it appears that for most cases the trajectories were extracted within two minutes the trajectory extraction process only needs to be conducted once and subsequent predictions can utilize the previously extracted data the algorithm utilized to extract the trajectories from the raw data has not been optimized in the current implementation however as such the running time of the extraction phase can likely be significantly improved through optimization additionally in a future system utilized for vessel trajectory prediction a more advanced computer would be utilized to conduct the prediction furthermore speed can be increased by pre processing data for regions such that whole trajectories are available for extraction instead of raw data points that require trajectories to be created nonetheless the extraction times evaluated in the implementation in this study are reasonable for the outlined purposes of most interest to the study is arguably the performance of the clustering classification and prediction algorithms fig 15 illustrates the individual algorithm running times in addition to the total running time i e the sum of the clustering classification and prediction running times these are again plotted as a function of the number of extracted trajectories with a third order regression it is clear that all algorithms are quite fast the classification was virtually instantaneous for all cases and the dual linear autoencoder trajectory prediction took less than one second for all cases the clustering algorithm dominates the total running time where most cases took between one and two seconds however the overall total running time for all algorithms was nonetheless quite low with the worst case being just below four seconds and the majority of the evaluated cases below two seconds this is considered to be acceptable for the purposes of this study with a more advanced computer and optimized implementation the running time would likely be even lower 4 conclusion a linear version of the autoencoder is implemented in this study and it is shown that it can predict complex trajectories with a high degree of accuracy training the linear version of the autoencoder utilized in this study is also less computationally demanding than deeper autoencoders compared to methods that predict future states conditioned upon their prediction of the previous state this method draws upon the generative ability of autoencoders to predict entire trajectories generative models have been shown to have good performance in creating new data points that belong to the distribution of the training data by interpolating in the latent space of historical trajectories the method in this study is able generate an entirely new trajectory the method is however dependent on the ability to cluster the trajectories if one were to apply the same method to all historical trajectories as opposed to a cluster one may end up interpolating between clusters as such a subsequent prediction will result in an unrealistic trajectory that does not belong to the distribution of the historical data applying the method on a single cluster however will increase the ability to describe subtle differences between trajectories thereby enhancing the subsequent prediction also given that all trajectories within the same cluster are quite similar the likelihood of generating a trajectory that does not belong to the original distribution is unlikely additionally as the method generates an entire trajectory and not iterative states conditioned upon the previous prediction prediction errors will not propagate as a function of time the error will therefore be related to the error of the entire trajectory by evaluating multiple trajectory predictions however one can estimate the degree of uncertainty of the prediction and this uncertainty can be modeled using the outlined method in this study the approach suggested in this study provides an effective method to predict the future trajectories of ocean going vessels specifically the method provides the basis for an advanced ship predictor on a global scale this ship predictor will aid in providing situation awareness to navigators in that the future trajectory of potential target vessels can be predicted far in advance based on a subsequent evaluation of the collision risk simple corrective measures can be conducted to prevent close range encounter situations from arising if effective such a method will increase the safety associated with maritime operations such situation awareness can also potentially be extended to autonomous vessels which can make system level intelligent decisions based on input from the outlined approach future work will include investigating deep learning methodologies that introduce nonlinearity and how increases in the complexity of the model can potentially increase the performance of the predictions in addition further work will be conducted on integrating such methods into an advanced ship predictor to provide situation awareness to navigators credit authorship contribution statement brian murray conceptualization methodology software formal analysis writing original draft visualization lokukaluge prasad perera conceptualization writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the norwegian ministry of education and research and the markom 2020 project a development project for maritime competence established by the norwegian ministry of education and research in cooperation with the norwegian ministry of trade and industry the authors would also like to express gratitude to the norwegian coastal administration for providing access to their ais database 
21794,advances in artificial intelligence are driving the development of intelligent transportation systems with the purpose of enhancing the safety and efficiency of such systems one of the most important aspects of maritime safety is effective collision avoidance in this study a novel dual linear autoencoder approach is suggested to predict the future trajectory of a selected vessel such predictions can serve as a decision support tool to evaluate the future risk of ship collisions inspired by generative models the method suggests to predict the future trajectory of a vessel based on historical ais data using unsupervised learning to facilitate trajectory clustering and classification the method utilizes a cluster of historical ais trajectories to predict the trajectory of a selected vessel similar methods predict future states iteratively where states are dependent upon the prior predictions the method in this study however suggests predicting an entire trajectory where all states are predicted jointly further the method estimates a latent distribution of the possible future trajectories of the selected vessel by sampling from this distribution multiple trajectories are predicted the uncertainties of the predicted vessel positions are also quantified in this study keywords maritime situation awareness trajectory prediction collision avoidance machine learning autoencoder ais nomenclature a arbitrary ais parameter vector a set of ais data b backward trajectory feature vector c data cluster d euclidean distance e eigenvector e eigenvector matrix f forward trajectory feature vector h latent feature vector h distribution of latent features k number of nearest neighbors l number of eigenvectors l number of data points in selected trajectory n number of trajectories m number of models in mixture model p selected vessel position vector p distribution of selected vessel position s vessel state vector s scatter matrix t time horizon min v speed over ground m s w interpolation weight x utm x coordinate m y utm y coordinate m λ eigenvalue matrix μ mean vector π prior distribution σ standard deviation σ covariance matrix χ course over ground subscripts 0 initial state b backward trajectory b c between class w c within class f forward trajectory i sample number j j th state m model number in gmm p trajectory prediction s selected vessel δ maximum offset superscripts ˆ estimated parameter state 1 introduction as more advanced technologies are introduced into transportation systems the opportunity to enhance the safety of these systems increases increased computational power in conjunction with advances in artificial intelligence and the ubiquity of sensor data allow for new methods to be implemented across a wide number of sectors some argue that an industrial revolution is taking place naming it industry 4 0 hermann et al 2016 the automotive industry is an example of a sector in which such technological advances are embraced and integrated into existing systems the shipping industry however has historically been more conservative in adopting new technologies often relying on older but proven systems nonetheless advances are being made with some arguing that shipping is also undergoing a technological revolution shipping 4 0 rødseth et al 2015 1 1 maritime situation awareness an essential aspect of shipping 4 0 is arguably implementing modern technologies to enhance the safety of maritime operations effective collision avoidance strategies are an integral part of maintaining safe operations the efficacy of such strategies relies on the degree of situation awareness of the navigator situation awareness was defined in endsley et al 2003 as being aware of what is happening around you and understanding what that information means to you now and in the future endsley 1995 separated situation awareness into three levels 1 perception of the elements in the current situation 2 comprehension of the current situation 3 projection of the future status maritime situation awareness largely relates to obstacle detection and prediction of close range encounter situations such obstacles will primarily be other vessels referred to as target vessels in an encounter situation it is therefore essential for a navigator to have an adequate degree of situation awareness in order to conduct effective collision avoidance maneuvers a thorough review of collision avoidance methods can be found in tam et al 2009 the main challenge for a navigator is determining the risk of collision based on their degree of situation awareness in light of endsley s definition one can classify level one situation awareness as relating to obstacle detection and level two an evaluation of the current collision risk perera and guedes soares 2015 addressed collision risk detection and quantification techniques with respect to integrating modern technologies the study discussed the concept of e navigation as introduced by the international maritime organization e navigation aims to utilize maritime information by electronic means to enhance the safety of maritime operations it was argued that integrated bridge systems are the main focus here relevant information relating to ship navigation should be properly integrated in order to provide decision support to navigators as such perera and guedes soares 2015 argued that the best navigation tools possible should be available on board the vessel to aid the navigator in identifying high risk situations based on this risk evaluation adequate collision avoidance maneuvers can be conducted that adhere to the colregs as outlined in perera et al 2010 a wide range of technologies are currently adopted to aid in providing situation awareness to navigators including radar conning and ecdis electronic chart display and information system radar systems facilitated by arpa automatic radar plotting aid and the ecdis are essential in aiding navigators to determine the risk of collision generally the future state of a target vessel is estimated based on calculations of constant course and speed values these estimates can then be used by the navigator to estimate collision risk parameters relating to the closest point of approach cpa such as the time tcpa and distance dcpa based on this information a navigator can make a decision with respect to a potential collision situation however predicting collision situations far in advance i e level three of endsley s situation awareness model will be the focus area of this study 1 2 vessel trajectory prediction predicting ship behavior as in perera 2017 can provide decision support to navigators to make appropriate collision avoidance maneuvers advanced techniques e g perera et al 2012 where extended kalman filters were utilized to estimate ship trajectories can further enhance the situation awareness of navigators such methods however are only useful for prediction horizons in the order of seconds to minutes as such they will only aid navigators in cases in which close range encounter situations are imminent as a result it was suggested in perera and murray 2019 to introduce an advanced ship predictor this study focused on methods to provide autonomous vessels with adequate situation awareness however such methods are also relevant for use in decision support to ship navigators in this approach a local and global scale ship predictor were suggested at a local scale techniques such as those outlined in perera 2017 can be utilized to aid in short term trajectory predictions in order to aid in effective collision avoidance maneuvers once a collision is deemed imminent on the global scale however long term trajectory predictions on the scale of 5 30 min are conducted such predictions aim to prevent close range encounter situations from occurring at all such predictions are however not straight forward as the future intentions of the vessel are unknown and may potentially be complex 1 2 1 ais based vessel trajectory prediction one method to conduct vessel trajectory predictions on a global scale is to utilize historical ais automatic identification system data by exploiting ais data insight into historical ship behavior can be gained multiple ship parameters relating to historical ship movement are stored in databases available for use such parameters include the position speed and course over ground recently there has been a significant increase in research into exploiting ais data for maritime situation awareness a number of studies have focused on evaluating grouping trajectories together to gain insight into maritime patterns aarsæther and moan 2009 for instance utilized computer vision techniques to group trajectories and subsequently calculate statistics for each traffic pattern zhang et al 2018 also utilized ais data via a data driven approach that compressed and clustered trajectories to extrapolate the general behavior patterns of vessels traveling along the same route subsequently given a starting point the ant colony algorithm was utilized to output an optimal route to the destination zhang and meng 2019 also presented a data driven method to determine a probabilistic ship domain based on ais data such ship domains can subsequently be utilized for collision risk assessment a comprehensive review of various methods to exploit ais data for maritime navigation was presented in tu et al 2017 of primary interest for this study however is the work done to predict the future trajectory of a vessel that can be utilized in a global scale ship predictor as such the aforementioned methods are of limited usefulness ristic et al 2008 utilized a particle filter to predict the future behavior of vessels using historical ais data but the predicted future positions had a large uncertainty associated with them making the method of limited use with respect to collision avoidance decisions and actions a number of studies also have focused on clustering historical trajectories and subsequently classifying a vessel to one of these groups pallotta et al 2013 for instance presented the tread traffic route extraction and anomaly detection methodology that clustered all historical trajectories in a specific region to identify traffic routes and subsequently classify a partial trajectory to one of these routes for anomaly detection the method also addressed assessing the probability of a position along a route pallotta et al 2014 further expanded upon the tread methodology by predicting the vessel position along a route using the ornstein uhlenbeck stochastic process the tread technique however clustered entry points way points and stationary points of trajectories within a defined region in this respect the trajectory through the entire region was utilized to group similar trajectories together this can result in trajectories with large differences between sub trajectories being clustered together for predictions in the order of hours this is not an issue and the outlined method is quite effective for collision avoidance purposes a higher fidelity prediction is required that requires more discrimination between trajectories other studies on clustering and classification include zhao and shi 2019 which clustered trajectories by using dynamic time warping and the douglas peucker algorithm in addition to zhou et al 2019 which clustered using k means and subsequently classified ship behavior methods relying on dynamic time warping and way point based clustering will cluster trajectories based on similar spatial behavior but be invariant with respect to time as such trajectories that have similar spatial shapes will be grouped together despite various behavior being observed at different relative times this may be detrimental to a subsequent trajectory prediction in that the clustering capability is restricted to the shapes of trajectories irrespective of their duration and potential differences in sub trajectories mazzarella et al 2015 also presented a trajectory prediction approach using ais data via a bayesian network approach with a particle filter this method was designed for predictions in the order of hours and as such of limited use with respect to collision avoidance other methods include hexeberg et al 2017 where a single point neighbor search method was presented based on historical ais data the method does not involve any clustering or classification steps and as such suffers when handling branching dalsnes et al 2018 built upon this work and provided multiple predictions using a prediction tree this approach allows for a probability estimate of a future prediction to be estimated using a gaussian mixture model these methods however do not utilize the relationship between data points as future states are based solely on the neighborhood of previous states which may not have any relationship to the prior predicted states this will have a negative effect on the accuracy rong et al 2019 also presented a probabilistic trajectory prediction method using a gaussian process model this method in addition to predicting the future position of a vessel gave an uncertainty estimate associated with the prediction the method had good results for the regular trajectories investigated off the coast of portugal but did not address how to deal with more complex traffic situations and trajectories which likely will degrade the outcome 1 3 generative models the method utilized in this study takes an alternative approach to those that come before it is inspired by a field of deep learning known as generative models foster 2019 widely adopted in the field of machine learning such models have recently gained a high degree of popularity due to the powerful generative ability of deep learning models one such general model is the autoencoder an autoencoder is a type of neural network with its most simple form being a multi layer perceptron bourlard and kamp 1988 the objective of an autoencoder is to reconstruct the data fed into it essentially copying its input to its output such techniques are however not extensively applied in the maritime domain some studies have looked into applying these approaches in the maritime domain e g perera and mo 2018 where autoencoders were suggested as a tool to compress data to facilitate more effective maritime data transmission autoencoders are considered to have two parts an encoder function f x that produces the code h shown in 1 and a decoder function g h that reconstructs the data from the code shown in 2 an integral part of an autoencoder is the internal hidden layer h that represents the code space often referred to as the latent representation of the data 1 h f x 2 x ˆ g h for an autoencoder to be useful it must provide a form of functionality other than mapping the input to the output undercomplete autoencoders goodfellow et al 2016 i e where h has a smaller dimension than x provide a bottleneck in the code space through which the network can learn a meaningful latent representation of the data the mapping function of the input data to the code space f x can be thought of as a data compression operation or parameter reduction the encoder strives to create a meaningful latent representation that preserves as much information as possible such that the decoder has adequate information to reconstruct the data as such when an autoencoder is trained on a dataset it will adapt such that the encoder preserves the most important information in the dataset traditionally autoencoders have been utilized for dimensionality reduction and feature generation goodfellow et al 2016 in this case the latent representation can be utilized for data visualization or to generate more relevant features for further processing additionally once an autoencoder is trained data can be compressed and stored subsequently it can be decoded for later use such applications are often very useful however the generative capabilities of autoencoders have recently also gained interest alternatively to encoding and decoding the data one can solely utilize the decoder in order to generate new data this is done by sampling a data point in the code space and subsequently running a forward pass through the decoder to reconstruct the data in this manner one can interpolate between existing data points in the code space to generate new samples the variational autoencoder kingma and welling 2014 rezende et al 2014 is a popular type of generative model a variational autoencoder is a probabilistic version of an autoencoder where the network learns a probability distribution of the reconstructed data based on a learned distribution over the code in this manner there is a continuous distribution in the code space that can be sampled from kingma and welling 2014 investigated the use of a variational autoencoder and presented a figure illustrating generated images from a variational autoencoder trained on the mnist dataset of handwritten digits the figure illustrates the interpolation of the digits with a 2 d latent code each axis along the figure can be thought of as one dimension in the latent code it is evident that as one moves around within the code space the digits morph from one digit to another the latent representation is able to capture the most important differences in the data along the respective axes as such one can generate a new image simply by interpolating within the code space generated by training the autoencoder such generative capabilities can be extended to virtually any dataset where an autoencoder is trained and based on the latent distribution of the data can generate new data samples from the distribution as such if an autoencoder is trained on a cluster of trajectories it should be able to generate a new trajectory by interpolating in the latent space 1 4 contribution the objective of this study is to provide an architecture that can support collision avoidance actions by providing situational awareness to navigators or autonomous agents as a result the architecture differs from that of similar studies with respect to its design to aid in situation awareness a method is suggested to provide a global scale ship predictor that estimates the future 30 min trajectory of a selected vessel with a high degree of fidelity as opposed to a number of other studies the approach in this study is designed to run live i e without any pre trained models a ship in any region given an adequate density of historical ais data can therefore utilize the developed architecture in the suggested approach relevant historical ship trajectories are extracted from an ais database that represent the possible future 30 min behavior of a selected vessel this dataset comprises only relevant data with respect to the observed state of a selected vessel for the purpose of trajectory prediction and as such provides the basis for the remainder of the prediction methodology inherent differences in behavior are described by these trajectories which in turn represent the possible modes of the future 30 min behavior the selected vessel may belong to therefore the trajectory representation differs from other methods that evaluate entire trajectories for a region the representation in this study provides higher fidelity predictions as a result in order to discover clusters of similar trajectories other approaches utilize trajectory representations that introduce invariance with respect to time e g dynamic time warping or point based techniques using waypoints these techniques are effective for clustering trajectories of similar shapes together for the purpose of this study however it is of interest to discover all possible trajectory modes that represent the future 30 min behavior of the selected vessel not just trajectories of similar shapes for the region as such trajectories should not be invariant with respect to time therefore by representing each trajectory by vectors of equal length containing the future 30 min of trajectory data the representations will be sensitive to the time at which various behavior is observed such a representation will therefore be more sensitive to modes within primary ship routes discovering these modes will provide a much better basis for a subsequent trajectory prediction for collision avoidance purposes as the prediction must be as accurate as possible this study suggests to cluster compressed trajectories via gaussian mixture models to an unspecified number of clusters each representing a mode of future behavior and is shown to have good performance for the purpose of the study once a selected vessel is classified to a given cluster of historical ais behavior this data is used directly in the dual linear autoencoder prediction architecture this architecture differs significantly from other methods which generally predict future states in manner such that they are predicated upon previous predicted states in this study it is suggested to predict entire trajectories i e all future states are predicted jointly a novel trajectory prediction technique inspired by generative models is therefore suggested using a dual linear autoencoder approach in this approach a latent representation of the possible future behavior of the selected vessel is calculated the latent representation can be viewed as an encoded version of the data using this distribution the encoded representation of the selected vessel s future behavior is estimated by interpolating between the encoded data points by decoding the estimate of the latent representation of the future trajectory an entire trajectory is predicted by a single matrix multiplication operation other methods predict an average of the behavior in the cluster i e the average of the distribution whereas the method suggested in this study will estimate the most likely sample as such the prediction is discrete and can provide more accurate predictions than other methods in which the behavior is averaged out the prediction accuracy will also be enhanced for clustering schemes that are able to identify ship modes with a high degree of fidelity as clusters that contain multiple ship modes will result in the prediction averaging out the behavior between modes due to the interpolation as a result the overall architecture of the study allows for higher fidelity predictions than other methods additionally the study provides a method to estimate the distribution of the selected vessel s future trajectory latent representation this is to account for uncertainty in the estimate and by decoding samples from this distribution a region of uncertainty for the predicted position at a given prediction horizon can be evaluated the suggested architecture also utilizes linear autoencoders therefore it allows for fast predictions as they are facilitated by calculating eigenvectors and conducting subsequent matrix multiplications as such there is no training of a deep neural network this architecture is therefore ideal for live predictions as the calculations involved in the prediction itself will be fast this approach in this study therefore provides a method to conduct live predictions of higher fidelity with respect to collision avoidance purposes on a global scale than other methods as well as an effective method to quantify the uncertainty of the predicted positions 2 methodology in this section the methodology utilized to predict the future trajectory of a selected vessel is outlined the objective of the method is to accurately predict the future trajectory of a selected vessel and provide an uncertainty estimate with respect to the predicted positions the overall architecture of the method is illustrated in fig 2 the method can be separated into three modules the first is the trajectory clustering module where groupings of similar historical trajectories are discovered it is assumed that the future trajectory of a selected vessel can be inferred based on the historical trajectories of other vessels in the region as such the selected vessel is classified to one of the discovered clusters in the trajectory classification module based on the cluster of trajectories to which the selected vessel is classified a trajectory prediction is conducted in the trajectory prediction module this is achieved via a novel dual linear autoencoder approach in this approach two linear autoencoders are utilized the forward linear autoencoder provides a latent representation of the historical trajectories that can be used to infer the future trajectory of the selected vessel the backward linear autoencoder provides a latent representation of the prior behavior of the historical trajectories based on a similarity measure evaluated in the latent space of the backward linear autoencoder a latent interpolation is conducted to estimate the forward latent representation of the selected vessel subsequently this estimate can be decoded resulting in a trajectory prediction 2 1 unsupervised trajectory clustering and classification in this section the methodology involved in clustering historical ais trajectories and classifying the trajectory of a selected vessel is outlined this work in this section builds upon preliminary work described in murray and perera 2019 the reader is therefore referred to murray and perera 2019 for further details it can be argued that investigating the historical behavior of vessels in a particular geographical region can provide insight into the future behavior of a vessel observed in that region however historical vessel trajectories will have a high degree of variation this variation is due to the existence of multiple traffic routes as well as the characteristics of the vessel with respect to the speed it will traverse along a given route it is therefore of interest to identify groupings of similar trajectories such that specific traffic behavior can be identified once such groupings are identified a selected vessel can be classified as belonging to a given group in this manner a subsequent trajectory prediction can be conducted on an enhanced data set where the data used for prediction will likely have a high degree of similarity to that of the selected vessel this can be thought of as advanced form of preprocessing of the ais data such that subsequent trajectory predictions will have a higher degree of accuracy grouping such data can be conducted via a technique from the field of machine learning known as clustering this is a form of unsupervised learning where labels for the data are unavailable clustering has as its goal to discover underlying groupings in the data i e identify clusters of data once the historical vessel trajectories have been clustered the observed trajectory can be used to classify the selected vessel to one of the discovered clusters 2 1 1 trajectory extraction the initial state of a selected vessel is defined in 3 this state represents the observed parameters of the selected vessel available via the on board sensor suite of the own ship the parameters in this state provide the basis for the selection of relevant historical ship trajectories for a subsequent prediction of the selected vessel s future trajectory 3 s 0 x 0 y 0 χ 0 v 0 the method first identifies historical ais data points with a high degree of similarity to s 0 in essence this means that it is desirable to identify ships that were at a similar position with a similar course and speed at some point in history in order to achieve this an initial cluster c 0 is created c 0 is defined to be a rectangular cluster orthogonal to χ 0 with a height of δ h parallel to χ 0 and a width δ w orthogonal to χ 0 z is the rotated space with the orthogonal vectors in the original space as basis vectors c 0 is defined according to the following equation murray and perera 2019 4 c 0 a i a x z i x z 0 δ w y z i y z 0 δ h χ i χ 0 χ δ v i v 0 v δ additionally data points that do not match the ship type of the selected vessel are removed c 0 will however likely contain multiple data points from the same trajectory as such unique trajectories are identified and the most similar point to s 0 in each unique trajectory determined c 0 is then updated by filtering out all data points other than these most similar points in this manner c 0 only contains one data point per trajectory once the initial clustering phase is completed a forward and backward trajectory extraction operation is conducted this entails that for all trajectories in c 0 the forward trajectory from the corresponding point in c 0 is extracted this can be thought of as the future trajectory defined in relation to the point in c 0 the length of the extracted forward trajectory is defined based on the desired prediction horizon t p for instance if a 30 min prediction is desired 30 min of the forward trajectory will be extracted similarly the backward i e past trajectory from its corresponding point in c 0 of a length corresponding to t b into the past is extracted both the forward and backward trajectories are subsequently interpolated at 30 s intervals for comparative analysis as such each trajectory will have l 2 t p entries where each entry can be used to compare positions at a given time instance defined from the origin of the trajectory see fig 3 2 1 2 trajectory clustering one of the objectives of extracting the forward trajectories is to provide a dataset upon which one can identify possible future routes that the selected vessel may follow it is therefore desirable to group or cluster these trajectories such that each possible route can be evaluated individually as there may be many possible future routes that the selected vessel may follow this is conducted by first generating features for each trajectory by flattening the positional data given in utm coordinates i e x y into a feature vector clustering is a technique that groups data points based on some similarity measure i e data points that are closer to one another in some n dimensional space are more likely to be considered part of the same cluster if the dimensionality of the space is large however the clustering algorithm may suffer due to the curse of dimensionality discussed in steinbach et al 2004 one aspect of curse of dimensionality relates to points getting lost in the space due to large distances between points with respect to certain dimensions this can make clustering in a high dimensional space challenging dimensionality reduction is therefore conducted for each trajectory via the karhunen loéve kl transform karhunen 1946 in 5 where the dimensionality is reduced from 2 l to l 5 h f e t f where h f r l 1 f r 2 l 1 and e r 2 l l 6 σ e λ e t where σ r 2 l 2 l and λ r 2 l 2 l the next step is to cluster the forward trajectories this is conducted using gaussian mixture model gmm clustering via the expectation maximization em algorithm a gaussian mixture model reynolds et al 2000 assumes that data is comprised of a mixture of m different gaussian distributions each with their own mean vector μ m covariance matrix σ m and prior distribution π m each data point representing a forward trajectory will be clustered to the distribution of the highest probability the em algorithm updates the underlying parameters until a model of best fit is discovered the assumed number of underlying distributions m is also varied to discover the most likely mixture for more details on gmm clustering of trajectories see murray and perera 2019 2 1 3 trajectory classification once the forward trajectories have been clustered it is desirable to classify the selected vessel to one of the discovered clusters one method to achieve this is to investigate the backward trajectories assuming that the past behavior of the selected vessel is available for a period corresponding to t b one can compare the past behavior of the selected vessel to the backward trajectories extracted from c 0 the aforementioned backward and forward trajectories are in fact one single trajectory but the forward trajectories are the section corresponding to the future behavior and the backward trajectory the past behavior in the classification module the extracted backward trajectories are assigned the class labels of their corresponding forward trajectories discovered in the clustering module these are utilized to classify the observed trajectory of the selected vessel to one of these classes in order for the classification process to be as effective as possible it is of interest to generate optimal features to represent the backward trajectories this is achieved via linear discriminant analysis lda fisher 1936 lda requires that the data points are labeled and as such the backward trajectories are given the labels of the corresponding forward trajectories the transformation is conducted via 7 subsequently a classifier of choice can be utilized to classify the transformed backward trajectory of the selected vessel to one of the clusters this will yield the most likely future route that the selected vessel will follow in this study a k nn classifier is utilized 7 h b e t b where h b r l 1 b r 2 l 1 and e r 2 l l 8 s wc 1 s bc e λ e t where s wc 1 s bc r 2 l 2 l and λ r l l 2 2 dual linear autoencoder this study introduces a novel dual linear autoencoder trajectory prediction method that is further described in this section the motivation is to predict the future trajectory of a selected vessel the method is inspired by the generative models addressed in section 1 3 if one can create a latent distribution of possible future trajectories one can then interpolate between existing trajectories in the latent space and generate a new trajectory that corresponds to the selected vessel autoencoders generally have non linear activation functions however the linear autoencoders investigated in this study do not have non linear activation functions in the network and as such the encoder and decoder functions will simply be linear transformations of the data consider a 2 layer linear autoencoder as illustrated in fig 1 let the encoder function be described by 9 and the decoder function by 10 if the network is trained using the mean squared error shown in 11 as the loss function j the minimum reconstruction error is shown to be achieved if v w and c μ where the columns of w span the orthonormal basis spanned by the eigenvectors of the covariance matrix σ of the dataset goodfellow et al 2016 the columns of w are ordered by the magnitude of their corresponding eigenvalues one recognizes that the encoder function f x is in fact the same as the kl transform for the case of a linear autoencoder this allows for efficient calculations as the covariance matrix and its corresponding eigenvectors and eigenvalues can easily be calculated significantly saving computation time compared to training a network the eigenvectors calculated here capture the directions in which there is the greatest degree of variation in the data data can therefore be compressed and reconstructed as a linear combination of the projections of that data onto a subspace spanned by the top l eigenvectors with the largest eigenvalues 9 h f x w t x μ 10 x ˆ g h v h c 11 j e x x ˆ 2 the basis of the method is to train two linear autoencoders all forward trajectories belonging to the class of the selected vessel are input to the forward linear autoencoder in the latent representation i e the code space one can then interpolate between existing data points and in this manner predict the latent representation of the selected vessel s future trajectory if one then runs a forward pass through the decoder i e 10 one will get a full trajectory prediction at the cost of a matrix multiplication operation one can in theory move about the latent space and generate new trajectories in a similar manner to the mnist digits in kingma and welling 2014 the underlying distribution of possible future trajectories would then be visualized where moving in one dimension or another represents the most variation in the possible future trajectories the interpolation however depends on a similarity measure of the backward trajectories to the backward i e observed trajectory of the selected vessel this is facilitated via the backward linear autoencoder 2 2 1 forward linear autoencoder the forward linear autoencoder has as its goal to create a meaningful latent representation of the extracted forward trajectories however training an autoencoder on all the forward trajectories will yield a latent representation that describes the greatest variations in the data i e between all clusters of trajectories this may for instance yield predictions where a data point is interpolated between clusters and in fact represents an unrealistic data point that is not part of the original distribution if one however considers solely the cluster of trajectories that the selected vessel has been classified to one now has a subset of trajectories that are highly similar to each other where interpolation between points should be meaningful as such training an autoencoder on this subset of data will allow it to learn a latent representation that describes this specific cluster decoding a data point from this latent representation will therefore yield a trajectory prediction of higher fidelity the encoder and decoder functions are shown in 12 and 13 respectively where e f is the matrix of the subset of the top l eigenvectors of the covariance matrix of the forward trajectories 12 h f e f t f 13 f ˆ e f h f 2 2 2 backward linear autoencoder the success of the trajectory prediction technique relies on the interpolation in the latent space of the forward linear autoencoder given that the future trajectory is unknown one must infer the latent representation of the selected vessel in the forward latent representation it is therefore suggested to investigate the backward trajectories of the classified cluster in comparison to the backward trajectory of the selected vessel by identifying the degree of similarity between all backward trajectories in the cluster and the backward trajectory of the selected vessel one can interpolate in the latent space of the forward linear autoencoder using the similarity of the backward trajectories as weights it is suggested in this study to utilize a linear autoencoder to evaluate the similarity in the same manner as the forward linear autoencoder the backward linear autoencoder will learn a meaningful latent representation that describes the variation in the underlying trajectory data in this lower dimensional latent space the distance from the encoded selected vessel trajectory to all other trajectories can be measured conducting such a similarity measure in this space will yield better results due to the same challenges relating to curse of dimensionality steinbach et al 2004 as those addressed in 2 1 2 the encoder and decoder functions are shown in 14 and 15 respectively where e b is the matrix of the subset of top l eigenvectors of the covariance matrix of the backward trajectories 14 h b e b t b 15 b ˆ e b h b 2 2 3 latent interpolation since there is no explicit mapping function from the latent space of the backward autoencoder to the latent space of the forward autoencoder a similarity based mapping approach is suggested the architecture of the suggested method is visualized in fig 4 the figure shows how the backward trajectories are mapped to a latent representation h b in orange as are the forward trajectories in green to the latent space h f e represents the coordinate systems of the latent spaces the backward trajectory of the selected vessel is illustrated as the solid red line and represents the information available of the past behavior of the selected vessel this information is then encoded in the backward latent representation h b s as the red data point the goal of the mapping operation is to map to the corresponding red data point in the latent representation of the forward trajectories the mapping function can be considered an interpolation between the data points of the encoded forward trajectories the similarity between the encoded backward trajectory of the selected vessel h b s and all the backward trajectories is calculated as the euclidean distance according to 16 one common form of interpolation for multivariate data is inverse distance weighting an interpolation scheme is presented in shepard 1968 with a weighting function according to 17 and the interpolated value calculated according to 18 the equation interpolates within a neighborhood such that the k nearest data points are found and the interpolated value is calculated on a subset of neighboring data in this manner the interpolated value is not as affected by outliers and therefore more likely to be closer to the true value 16 d i h b i h b s 17 w i 1 d i 18 h ˆ f s i 1 k w i h f i i 1 k w i 2 2 4 decoded trajectory prediction subsequent to the latent interpolation operation the future trajectory of the selected vessel can be decoded i e predicted according to 19 once this is completed f ˆ s must be reshaped to a matrix containing the spatial data x y as its columns the prediction is subsequently updated such that the offset between the true initial position x 0 y 0 and the predicted initial position x ˆ 0 y ˆ 0 is subtracted from all the entries of the prediction to account for minor offsets that occur due to the approximation inherent in the latent interpolation this yields a trajectory prediction for the selected vessel at 30 s intervals up to the desired prediction horizon t p one can evaluate each row of the matrix as the predicted vessel position p ˆ j in each vessel state s j where each state is separated by 30 s 19 f ˆ s e f h ˆ f s 2 2 5 uncertainty estimate of predicted position the trajectory prediction gives a single prediction however the outlined method does not give a measure of uncertainty related to the predicted position at each time interval a method is therefore suggested to achieve this utilizing the linear autoencoder architecture previously introduced some uncertainty can be attributed to the reconstruction loss that results from reducing the dimensionality in the autoencoders but the primary source is the uncertainty associated with the latent interpolation it is therefore suggested to create a distribution in the latent space of the encoded forward trajectories i e h f s that can account for some of the interpolation error if one considers the neighborhood of h ˆ f s one can investigate the uncertainty with respect to the k nearest neighbors in the latent representation of the backward trajectories h b the method suggests to assume that h ˆ f s is the mean of a normal distribution according to 20 with a weighted unbiased covariance according to 21 these weights correspond to those in 17 in this manner the distribution will reflect the relevant importance of each latent forward trajectory representation based on their weights from the backward trajectory similarity measure 20 h f s n h ˆ f s σ h s 21 σ h s i 1 k w i h f i h ˆ f s h f i h ˆ f s t i 1 k w i i 1 k w i 2 i 1 k w i this however only yields a form of uncertainty with respect to the latent representation of the selected vessel s forward trajectory what is of interest however is the uncertainty of the predicted position at various vessel states to achieve this it is suggested to run a monte carlo simulation raychaudhuri 2008 that samples from the latent normal distribution in 20 to approximate the distribution of the trajectory predictions each sample from h f s is decoded according to 19 yielding a full trajectory prediction in the same manner as in section 2 2 4 the sampled predictions are also updated based on the offset of the true and predicted initial positions this correction will be greater for samples further away from the true value of h f s but it is assumed to have limited effect on the predictions with respect to estimating the uncertainty after the samples are decoded the distribution of the decoded trajectory positions can be evaluated at each time instance this can be viewed as the distribution p j of the predicted position p ˆ j for each vessel state s j where each state is that of the selected vessel at 30 s intervals the distribution of the position in each state can further be assumed to be normally distributed according to 22 where the mean and covariance are calculated based on the sampled predictions as such uncertainty measures can be calculated with respect to the standard deviation of the distribution 22 p j n μ j σ j 3 results and discussion to evaluate the method 100 random data points were selected from a dataset of historical ais data in the region surrounding the city of tromsø norway the dataset corresponds to that collected from january 1st 2017 to january 1st 2018 each data point represents a selected vessel state that will be initialized as the initial state s 0 of that vessel the aforementioned trajectory prediction methodology is then utilized to predict the future 30 min of each selected vessel s trajectory such as to evaluate the performance of the method the true future trajectories of the selected vessels can be thought of as the test dataset for each respective prediction the remainder of the ais data is then the training dataset utilized to conduct the predictions in this manner the method predicts the future trajectory of 100 different vessels and the accuracy can be evaluated based on the true trajectory of the vessel a value of l 3 is utilized for the latent representation of both h b and h f additionally the 100 most similar vessels to each selected vessel i e k 100 is utilized for the latent interpolation 3 1 classification accuracy the input to the trajectory prediction module is the set of extracted trajectories corresponding to the output of the classification module as such the method relies on the accuracy of this classification as an incorrect classification will result in a prediction with respect to a cluster of ship behavior that does not match the selected vessel in this study a value of k 7 was utilized for the k nn classifier for the results presented in this section 67 of the selected vessels were classified correctly in many cases however the incorrect classification can be attributed an incorrect behavior mode i e cluster these modes can be along the correct route but may for instance traverse further to one side of the lane or have variations in the speed profile along the route predictions with respect to these modes despite being incorrect can nonetheless result in reasonably accurate predictions this is due to the clustering algorithm identifying multiple modes that are quite similar one should note that this can be seen as a situation where some data clusters can overlap each other as such the 33 of incorrectly classified cases in this study likely includes many cases in which the selected vessel was classified to an incorrect mode along the correct route i e a similar trajectory mode additionally the success of the classification depends on the complexity of the discovered clusters it is on the one hand desirable for the clustering algorithm to discover as many trajectory modes as possible as this can enhance the accuracy of the subsequent trajectory prediction on the other hand an increase in the number of clusters will provide a more difficult classification task this will be further complicated due to overlapping clusters as mentioned previously each cluster is multi dimensional and classifying in this space can be challenging however the focus of the study is the dual linear autoencoder prediction technique it should be noted that the trajectory prediction methodology utilizing a dual linear autoencoder as described in this study can be utilized based on any previous clustering and classification technique however it does require that trajectories are extracted utilizing the methods described in section 2 1 1 such that trajectories can be encoded and decoded properly this trajectory extraction process can however also be conducted after an alternative clustering and classification regime has been utilized 3 2 trajectory prediction fig 5 illustrates an example of a trajectory prediction for one of the randomly selected vessels in the dataset all presented predictions are evaluated with p 0 as the origin of the coordinate system to more easily evaluate the distances involved in the case of fig 5 the algorithm classified the selected vessel to the correct cluster of trajectories the green dotted line represents the predicted trajectory of the selected vessel and the red dotted line represents the true trajectory of the selected vessel it is clear that for this case the trajectory prediction was quite accurate additionally an estimate of the uncertainty of the position at a 30 min prediction horizon is illustrated each black dot illustrated represents a decoded sample from the normal distribution of h f s in 20 utilizing these predictions a normal distribution p j was fit to the predicted positions for each state according to 22 based on this distribution the 1 σ 2 σ and 3 σ contours could be evaluated and are visualized in the figure such contours can be evaluated at any prediction horizon but only the results for the 30 min prediction horizons are illustrated in this section fig 6 shows a prediction of a more complex trajectory showing that the method is also able to successfully reconstruct more complex trajectories in certain cases however the classification is incorrect this in some cases can result in a vessel prediction along an incorrect route resulting in a degree of error with respect to the predicted position an example of such a case is illustrated in fig 7 3 3 prediction accuracy the performance of the method is most effectively measured based on the accuracy of the prediction with respect to the true vessel position the predicted position error is calculated as the distance from the mean μ j of the distribution p j and the true position in that state i e p j additionally the error is presented as a percentage of the true distance traveled by the selected vessel this is due to various vessels having traveled different distances during the course of 30 min in this manner one can compare the error irrespective of the distance traveled fig 8 illustrates the median error of all 100 predictions as a function of time i e the desired prediction horizon the overall error for all selected vessels is evaluated where the median error for a 30 min prediction is found to be 2 5 if one looks only at the vessels that were incorrectly classified it is evident that they result in a higher degree of error where the median error at a prediction horizon of 30 min is 9 6 of the distance traveled if one solely investigates the correctly classified vessels however the accuracy of the prediction increases significantly with a median position error of 1 6 for a prediction horizon of 30 min this illustrates the importance of correctly classifying the selected vessel as the predictions are discrete with respect to each class of trajectories an incorrect classification results in the prediction being conducted on a cluster corresponding to a different mode of ship behavior than that of the selected vessel fig 9 illustrates a box plot of the positional error at 5 min intervals for the correctly classified vessels the green bars correspond to the median values in fig 8 it is clear that the variance of the error increases as a function of time generally it appears that the method has good performance when vessels are correctly classified for prediction horizons up to 30 min 3 4 position uncertainty estimate as previously mentioned a normal distribution of the predicted position p j in each state is evaluated according to 22 the resultant 1 σ 2 σ and 3 σ contours can be utilized to give a measure of uncertainty relating to the prediction in each state it is desirable for this uncertainty to be as small as possible whilst still capturing the behavior of the selected vessel if the uncertainty is too small however it may not include the true future position of the selected vessel allowing for too much uncertainty on the other hand is not desirable either it is conceivable to extend the region of uncertainty such that the true future position of the selected vessel will always be included within the contours in such cases however the usefulness with respect to maritime situation awareness will be degraded as there will be a risk of collision for a very large area this increases the likelihood of the navigator needing to take action in cases where the true risk of collision is low the degree of uncertainty is dependent upon two factors the power of the clustering algorithm and the number of vessels included in the latent interpolation if the clustering algorithm is able to discover a group of trajectories with very specific behavior the uncertainty of the prediction will decrease as the variance of the behavior within the cluster is limited in essence all the historical trajectories utilized in the prediction are almost the same causing all predictions to have similar values when sampling from the latent space similarly if one only selects a limited number of vessels to evaluate the latent representation of the selected vessel in 20 the prediction will be restricted to the behavior of these historical trajectories increasing the number of trajectories will increase the variance of the behavior and contribute to a larger region of uncertainty the effect of this was investigated where the number of similar vessels k utilized in 20 was varied and the position error evaluated as a percentage of the distance traveled in the same manner as described in section 3 3 fig 10 illustrates the mean error for various values of k as a function of the prediction horizon for the 100 randomly selected vessels it is evident that increasing the value of k contributes to an increase in error but that this error converges as k increases it should be noted that the probability contours solely relate to the probability of the predicted future position and as such are entirely dependent upon the model developed in this study they provide a measure of uncertainty with respect to the predicted positions where the true position should fall within the region enclosed by the contours the predictions are based on historically similar vessels whose behavior do not necessarily match that of the selected vessel the assumption that the future trajectory of a selected vessel depends on its past trajectory is therefore a limitation of the method the uncertainty of the predictions can therefore be thought of as describing the variance of the historical behavior where it is likely that the vessel will fall somewhere within the specified region the method is designed to identify the most similar trajectories however the data may be dominated by specific vessel behavior that has a higher frequency if more similar historical trajectories have a lower frequency the data will be dominated by the less similar trajectories of the highest frequency this effect will however be somewhat ameliorated due to the weights in 17 as the more similar trajectories will have higher weights when calculating h ˆ f s and σ h s the percentage of the correctly classified vessels whose true position after 30 min was within the regions bounded by the corresponding σ contours was also investigated this was conducted in order to evaluate the uncertainty measure s ability to capture the true position of the selected vessel the results are shown in table 1 the values are estimated such that the 3 σ contour includes the points inside the 2 σ contour which again includes the points inside the 1 σ contour 75 of all true vessel positions were captured by the 3 σ contour for the tested selected vessels cases in which the true positions did not reside within the contours were therefore investigated fig 11 illustrates one such case the prediction appears to be quite accurate with the true and predicted trajectories nearly exactly aligned it is evident however that the uncertainty contours are not visible fig 12 illustrates a close up of the predicted position after 30 min here one can see that the predicted final position illustrated as the largest red dot falls outside the uncertainty contours when investigating the scale involved one can see that the true and predicted positions in fact reside less than 20 m from each other the uncertainty ellipses are extremely small and therefore reflect a very high certainty of the model with respect to the predicted position fig 13 illustrates the cluster of trajectories utilized to conduct the prediction it is discovered that this cluster corresponds to a ferry where the final position after 30 min is at one of its ports as such the data upon which the prediction is determined is concentrated about this position an offset of 20 m can be accounted for by error inherent in the ais data in addition to the orientation of the vessel when in a port there are multiple ferries in the region surrounding tromsø when investigating all tested vessels with a ship type of passenger vessel it was found that the performance with respect to the uncertainty measures was degraded despite the predictions being quite accurate the percentage of these vessels is also shown in table 1 in addition to results for all vessels except those labeled as passenger vessel it is clear that the performance increases in this case the performance of other vessel types is however likely affected by vessels with similar effects where the cluster of underlying data is too similar to allow for a large uncertainty measure whilst still providing accurate predictions 3 5 running time as the algorithm is intended to run live it is of interest to investigate the running time of the method to support the discussion the authors have evaluated the running time of the method for the cases in this study all evaluations have been run on a 2 30 ghz cpu and 16 gb ram in the following sections the running times are evaluated in two parts the first addresses the running time of the trajectory extraction algorithm and the other the classification clustering and prediction algorithms the data utilized in this study consisted of approximately 15 million data points these data points are input to the algorithm without any pre processing in the trajectory extraction step relevant historical trajectories need to be extracted from the raw ais data once this is conducted the data will be available for the period a prediction is required fig 14 illustrates the running time of the extraction of trajectory data this is visualized as a function of the number of relevant trajectories extracted a third order regression was applied to the data to visualize the relationship between the running time and the number of trajectories it is clear that the running time increases with the number of extracted trajectories it appears that for most cases the trajectories were extracted within two minutes the trajectory extraction process only needs to be conducted once and subsequent predictions can utilize the previously extracted data the algorithm utilized to extract the trajectories from the raw data has not been optimized in the current implementation however as such the running time of the extraction phase can likely be significantly improved through optimization additionally in a future system utilized for vessel trajectory prediction a more advanced computer would be utilized to conduct the prediction furthermore speed can be increased by pre processing data for regions such that whole trajectories are available for extraction instead of raw data points that require trajectories to be created nonetheless the extraction times evaluated in the implementation in this study are reasonable for the outlined purposes of most interest to the study is arguably the performance of the clustering classification and prediction algorithms fig 15 illustrates the individual algorithm running times in addition to the total running time i e the sum of the clustering classification and prediction running times these are again plotted as a function of the number of extracted trajectories with a third order regression it is clear that all algorithms are quite fast the classification was virtually instantaneous for all cases and the dual linear autoencoder trajectory prediction took less than one second for all cases the clustering algorithm dominates the total running time where most cases took between one and two seconds however the overall total running time for all algorithms was nonetheless quite low with the worst case being just below four seconds and the majority of the evaluated cases below two seconds this is considered to be acceptable for the purposes of this study with a more advanced computer and optimized implementation the running time would likely be even lower 4 conclusion a linear version of the autoencoder is implemented in this study and it is shown that it can predict complex trajectories with a high degree of accuracy training the linear version of the autoencoder utilized in this study is also less computationally demanding than deeper autoencoders compared to methods that predict future states conditioned upon their prediction of the previous state this method draws upon the generative ability of autoencoders to predict entire trajectories generative models have been shown to have good performance in creating new data points that belong to the distribution of the training data by interpolating in the latent space of historical trajectories the method in this study is able generate an entirely new trajectory the method is however dependent on the ability to cluster the trajectories if one were to apply the same method to all historical trajectories as opposed to a cluster one may end up interpolating between clusters as such a subsequent prediction will result in an unrealistic trajectory that does not belong to the distribution of the historical data applying the method on a single cluster however will increase the ability to describe subtle differences between trajectories thereby enhancing the subsequent prediction also given that all trajectories within the same cluster are quite similar the likelihood of generating a trajectory that does not belong to the original distribution is unlikely additionally as the method generates an entire trajectory and not iterative states conditioned upon the previous prediction prediction errors will not propagate as a function of time the error will therefore be related to the error of the entire trajectory by evaluating multiple trajectory predictions however one can estimate the degree of uncertainty of the prediction and this uncertainty can be modeled using the outlined method in this study the approach suggested in this study provides an effective method to predict the future trajectories of ocean going vessels specifically the method provides the basis for an advanced ship predictor on a global scale this ship predictor will aid in providing situation awareness to navigators in that the future trajectory of potential target vessels can be predicted far in advance based on a subsequent evaluation of the collision risk simple corrective measures can be conducted to prevent close range encounter situations from arising if effective such a method will increase the safety associated with maritime operations such situation awareness can also potentially be extended to autonomous vessels which can make system level intelligent decisions based on input from the outlined approach future work will include investigating deep learning methodologies that introduce nonlinearity and how increases in the complexity of the model can potentially increase the performance of the predictions in addition further work will be conducted on integrating such methods into an advanced ship predictor to provide situation awareness to navigators credit authorship contribution statement brian murray conceptualization methodology software formal analysis writing original draft visualization lokukaluge prasad perera conceptualization writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the norwegian ministry of education and research and the markom 2020 project a development project for maritime competence established by the norwegian ministry of education and research in cooperation with the norwegian ministry of trade and industry the authors would also like to express gratitude to the norwegian coastal administration for providing access to their ais database 
