index,text
21320,path following control plays an essential role in improving accuracy of navigation and achieving a smooth motion control however the performance will exhibit large lateral errors caused by weak maneuverability large time lag and large ocean current disturbance when the wave glider is gliding with a low and time varying speed an adaptive path following control integrated an adaptive line of sight alos algorithm and an improved artificial potential field iapf algorithm was put forward in this paper which could extremely guarantee path following accuracy the adaptive control based a los was introduced to dynamically adjust a parameter of the los so that the output desired heading of the wave glider was on time updated based on the velocity of the wave glider and path following error the iapf was applied to analyze and modify the output of the alos guiding the vehicle always convergent to the desired path which could make a real time self diagnosing monitoring and correction in path following control following this a closed loop control was put forward with a dynamic model of the black pearl wave glider and the given path following control the proposed control was verified by simulations and sea trials compared with conventional los which demonstrated its effectiveness and long term reliability keywords wave glider path following control dynamic model adaptive line of sight improved artificial potential field sea trials 1 introduction path following control is one of the most essential features required to ensure reliable and robust operation of marine vehicles in cluttered and uncertain ocean environments and it plays an essential role in improving accuracy of navigation and achieving a smooth motion control furthermore most of marine vehicles involve such path following control problems especially to under actuated marine vessels such as autonomous underwater vehicles auvs autonomous surface vehicles asvs and remotely operated vehicles rovs see table 1 several solutions have been proposed for realizing ideal path following in numerous prior works as summarized in table 1 most of these marine vessels can be classified into two categories underwater vehicles and surface vehicles and the most two representatives are auvs and asvs for auvs the control algorithms mainly include fuzzy control yu et al 2017 adaptive control liu et al 2019 formation control gao and guo 2019 neural network control shojaei and dolatshahi 2017 and sliding mode control xia et al 2019 in addition to some other controls abdurahman et al 2017 2019 these controls were optimized based on line of sight los control to design the path following guidance laws most of these auv controls usually follow desired paths in underwater environments with a relative small ocean disturbance compared with the surface ocean environment moreover it can be seen from table 1 that all auvs have capabilities of self velocity control in path following performance on the basis of the surge and the yaw control the realization of the los guidance law on auvs becomes much easier compared with some marine vehicles with only one control input an overview of the los guidance principles for marine crafts could be found in fossen and lekkas 2017 note that the los has been widely used in the related research of path following owing to its simplicity and effectiveness for asvs a predictor based neural network method was designed to update parameters in the los guidance for path following control in gu et al 2019 woo et al 2019 adopted a learning based control for path following of an asv with two electric thrusters inputs used for the steering control and speed control tao et al 2019 put forward a characteristic model based adaptive control applied to asv multi straight line path following nie and lin 2019 designed an improved adaptive integral line of sight iailos guidance law for a kind of asvs which was used to calculate the desired yaw angle and the controller was extended to track the desired yaw angle and desired velocity it was found that in the above mentioned asv path following references whether using the model based adaptive control tao et al 2019 or the iailos guidance nie and lin 2019 the control inputs include heading control and speed control and the controlled parameters were usually related to path following errors and control inputs the wave glider is a class of wave propelled persistent unmanned ocean surface vehicle as the propulsion of the wave glider only comes from wave energy and there is no propeller or other electric propulsion with this advantage the wave glider provides a new idea for the propulsion and enables new concepts of operations for ocean applications including acoustic data collection communication gateway for subsurface systems military intelligence collection meteorological observation etc daniel et al 2011 olson and robert 2012 goebel et al 2014 yang et al 2018 to accomplish these tasks safely and efficiently it is crucial to design robust and efficient path following controls for wave gliders however compared with the above mentioned asvs and auvs the wave glider is an under actuated system with weak maneuverability and the thrusts of the wave glider comes from wave motion and changes randomly with sea condition that is to say the velocity of the wave glider is uncontrollable and time varying moreover combined with the air sea interface disturbance like wind and sea currents the control problem of wave gliders on accurate path following is more challenging than the other asvs and auvs for path following control of wave gliders the related researches are few though the above mentioned research works prompted underwater and surface vehicles all refers to the path following control problems of under actuated vehicles however these control methods only have been theoretically verified their reliabilities in practical applications are rarely tested moreover all of the aforementioned investigations focus on the single body vehicles and there are at least two control inputs including a surge force and a yaw moment thus these controls are not appropriate or need to be reconstructed for dealing with path following problems of wave gliders wang et al 2019 proposed a path following approach based on a los algorithm and a restricted circle for a wave glider although the algorithm could take advantage of ocean current and reduce the tracking error in some extent and the current speed was only set as 0 1 m s and 0 2 m s in simulations it was not accordant with the complex and changeable marine environment therefore the actual path following performance of this method is unclear and it is a well known fact that disturbances caused by wind wave and current are immeasurable and may depart the vehicle from a preset path in different sea states with non uniform flow situations an adaptive desired heading obtained with considering uncertain disturbance and its varying velocity is the foremost part when the wave glider takes path following task in the sea therefore this paper focuses on the path following control of the wave glider with weak maneuverability and large ocean current disturbance compared with the existing results an adaptive path following control algorithm is developed by using an adaptive line of sight algorithm alos and an improved artificial potential field iapf algorithm to deal with uncertain disturbance and velocity constraint simultaneously the corresponding controller is with characteristics of the lumped disturbance rejection capability therefore the proposed adaptive path following control algorithm is more applicable to the marine practice the main contributions of the manuscript can be summarized as follows 1 an adaptive improved los apf algorithm was developed to obtain a desired glider heading to follow straight lines for wave gliders which considered the time varying speed of wave gliders and the lateral error during the path following 2 a closed loop motion control system with desired path points as input and actual glider positions as output was put forward which included the dynamic model of the black pearl wave glider and the given path following control algorithm the effectiveness and applicability of the proposed control algorithm was assessed and verified through simulations and sea trials the remainder of this study is organized as follows section 2 presents the model of the black pearl wave glider section 3 proposes the alos iapf algorithm in detail at the same time the detailed deriving and proving process are presented section 4 establishes the designed closed loop system including the dynamic model and the given control algorithm and a lot of simulations and sea trials are carried out to validate the previous analysis section 5 summarizes the key conclusions of this work 2 dynamics of the black pearl wave glider to better appreciate the effect of the path following control method and imitate the real glider in an unsteady non uniform flow field the full dynamic model of the black pearl wave glider was developed through referring the previous dynamic researches wang et al 2019 fossen 1994 2002 2011 wang et al 2019 yang et al 2019 the black pearl wave glider as shown in fig 1 is a kind of under actuated wave gliders independently developed by ocean university of china and tiangong university to absorb the wave energy the wave glider is designed as a multi body system located at different depths the float on the sea surface and the submerged glider are connected by a flexible umbilical cable six pairs of hydrofoils are hinged on the submerged glider the wave forces the float heaving and the vertical motion of the float is transmitted to the submerged glider via by the umbilical the hydrofoils are forced to rotate and the lift which is always forward independent of the wave direction in horizontal plane the rudder on the back of the submerged glider is a steering actuator that is used as the only actuator in the proposed path following control four coordinate frames are established body coordinate frame system frame b float frame f submerged glider frame g and geodetic coordinate frame o kraus 2012 as shown in fig 2 let o ξ o η o ς o τ be a position vector of the wave glider from the origin of the system frame to the origin of the geodetic coordinate frame and assume that ω ϕ θ ψ τ is an attitude vector of the wave glider in the geodetic coordinate frame which is used for transformation from the system frame to the inertial frame besides o and ω can also be used to describe the position and the attitude of the wave glider which responds six degrees of freedom dofs in the following dynamic model of the black pearl wave glider υ u v w τ and ω p q r τ are a transitional velocity vector and an angular velocity vector in the body coordinate frame respectively f x y z τ and t k m n τ are a transitional external force vector and a total moment vector of the glider in the body coordinate frame respectively six dofs are considered surge and sway of the center of gravity of the wave glider roll and pitch of the system frame and yaw motions of the float and the submerged glider the location of the wave glider is described as x y which is the coordinates of the origin of system frame in the earth fixed frame the relative position of the float and the submerged glider can be described by rolling angle ϕ and pitching angle θ some important assumptions are made following as 1 the umbilical is always in tension since the submerged glider is heavy enough under water motion parameters of the float and the submerged glider in the system frame are derived based on rigid body 2 when considering the holistic motion of the wave glider the shapes of the float and the submerged glider are ignored a standard representation of a six dofs nonlinear dynamic equations of motion for a single body can be found in fossen 2011 according to this reference the dynamics of the black pearl wave glider can be expressed as 1 m ν c ν ν d ν η g η τ η where ν u v w p q r t η x y z φ θ ψ t m r 6 6 is the rigid mass matrix c ν r 6 6 is the coriolis centripetal coefficient matrix d ν η r 6 6 is the vector of damping force g η r 6 1 is the vector of gravitational forces and moments τ η r 6 1 is the vector of control inputs which contains the thrust and the rudder forces of the submerged glider here the dynamic model of the black pearl wave glider is mainly concerned with the yawing motion that has a main influence on the path following control and the vertical motion is treated separately thus the initial state variables are set as η x 0 y 0 φ 0 θ 0 ψ f ψ g t and ν u 0 v 0 p 0 q 0 r f r g t furthermore the heading error between the float and the submerged glider is considered as δ ψ ψ g ψ f in dynamics of the wave glider added mass in inertia matrix terms is neglected as the calculation is extremely difficult and it has large uncertainties furthermore some similar dynamic uncertainties combined with environment disturbance are all considered as external uncertainties in the later path following control thus the inertial matrix kraus 2012 can be simplified as 2 m m b m b i b x x i b y y i f z z i g z z where m b is the total mass of the wave glider i b x x i b y y m g d g b 2 m f d f b 2 i f z z and i g z z are rotational inertias of the float and the submerged glider respectively in the coriolis and centripetal matrix term the coriolis force is considered negligible as it is much smaller than other hydrodynamic forces moreover assuming that the roll and pitch rates of the float and the submerged glider are negligible thus c ν kraus 2012 can be expressed as 3 c ν 0 0 0 0 0 m b v b 0 0 0 0 0 m b u b 0 0 0 0 0 i b x x q b 0 0 0 0 0 i b x x p b 0 0 0 0 0 0 0 0 0 0 0 0 the transformation matrix from the system frame to the float frame and the submerged glider frame kraus 2012 can be derived as 4 r of cos δ ψ cos θ cos δ ψ sin ϕ sin θ sin δ ψ cos ϕ sin ϕ sin δ ψ cos δ ψ sin θ cos ϕ sin δ ψ cos θ cos δ ψ cos ϕ sin δ ψ sin θ sin ϕ sin θ sin δ ψ cos ϕ cos δ ψ sin ϕ sin θ cos θ sin ϕ cos θ cos ϕ 5 r og cos θ sin ϕ sin θ sin θ cos ϕ 0 cos ϕ sin ϕ sin θ cos θ sin ϕ cos θ cos ϕ with r fo r of t and r go r og t wang et al 2019 the forces and moments in the body coordinate frame can be calculated the damping matrix d ν η kraus 2012 is 6 d ν η x b y b k b m b ℕ f ℕ g where 7 x b x f b u x f b ν x g b u x g b ν x g b w x b u x f b w a v e y b y f b u y f b v y g b u y g b v y g b w y b u y f b w a v e k b y f b u y f b v y f b w a v e d f b y g b u y g b v y g b w d g b m b x f b u x f b ν x f b w a v e d f b x g b u x g b ν x g b w d g b ℕ f ℕ f f v ℕ f f r ℕ g ℕ g g v ℕ g g r here the subscript b f and g represents the body frame the float frame and the submerged glider frame respectively the former superscript f and g refers to the float and the submerged glider respectively x b u f and y b u f are the axial and cross flow forces on the float caused by the axial velocity of the submerged glider in the body frame similarly combined with transformation matrix as eq 5 g η kraus 2012 becomes 8 g η x g b h s y g b h s y g b h s d g b x g b h s d g b 0 0 the control inputs including wave generated thrust and rudder angle kraus 2012 can be expressed as 9 τ x g b t h u r s t x g b u δ δ y g b t h u r s t y g b u δ δ y g b t h u r s t y g b u δ δ d g b x g b t h u r s t x g b u δ δ d g b 0 n g u u δ here the dynamic model of the wave glider is simplified and disturbances from wind wave and current are ignored in the following proposed algorithm simulations sea trials the dynamic uncertainties and environments are all considered and are dealt with well table 2 and table 3 give the dynamic parameters coefficients and non dynamic parameters of the black pearl wave glider respectively the dynamic parameters and coefficients have been obtained by cfd simulation empirical formulas previous experiments and kraus 2012 and the non dynamic parameters have been obtained by physical measurement 3 path following control based on an alos with an iapf to keep the wave glider following a desired path it is necessary to study the path following control algorithm the los guidance is the most popular method for path following control the guidance laws composed of speed and los steering laws which could be combined in various ways to achieve different motion control objectives were presented in the previous researches liu et al 2019 fossen 2011 nie et al 2020 nie and lin 2019 wang et al 2019 abdurahman et al 2019 yu et al 2019 in this study the proposed path following control algorithm was designed to obtain the desired course according to the target point and the real time location of the wave glider and an incremental pid heading control algorithm was used to achieve the path following task the control structure for path following was presented which is shown in fig 3 the control algorithm was mainly divided into three parts an adaptive los guidance an improved apf and an incremental proportion integration differentiation ipid heading control the improved apf was employed to determine the los position in the los guidance the alos guidance was used to calculate the desired heading the desired heading was obtained by the ipid strategy 3 1 line of sight los guidance law for the wave glider sailing in open sea the desired path of the wave glider is usually specified in terms of waypoints the desired waypoint database consists of 10 wpt p o s x 1 y 1 x 2 y 2 x n y n the los guidance law is shown in fig 4 a the desired heading of wave glider can be implicitly defined by the ordered waypoint sequence according to the reference fossen 2011 since tan ψ d t y l o s t y t x l o s t x t the desired heading of the wave glider can be derived as 11 ψ d t atan 2 y l o s t y t x l o s t x t to calculate the los intersection point p l o s t x l o s t y l o s t t the following two equations can be obtained from fig 4 a 12 x l o s t x t 2 y l o s t y t 2 r 2 13 tan α c y k 1 y k x k 1 x k y l o s y k x l o s x k constant define δ x x k 1 x k and δ y y k 1 y k x l o s and y l o s can be easily obtained from eq 13 when δ y 0 if δ x 0 only eq 12 is valid which means that y l o s y r 2 x l o s x 2 and x l o s x k x k 1 where r e p 2 δ l o s 2 when δ x 0 eq 13 can be expressed as y l o s δ y δ x x l o s x k y k combined with eq 11 to eq 13 the los intersection point can be obtained as 14 x l o s b b 2 4 a c 2 a y l o s δ y δ x x l o s x k y k where d δ y δ x e x k f y k g f d e a 1 d 2 b 2 d g d y x c x 2 y 2 g 2 2 g y r 2 eq 14 shows that the los position need be analyzed and chosen by situations in real time path following control when the wave glider is in the target path following the los position is selected as seen in fig 4 b whereas if the wave glider needs to return back to the target path the los position needs to be chosen as shown in fig 4 c 3 2 improved artificial potential field iapf when tracking a preset target path normal los algorithm ignores the situation if the wave glider needs to return back to the target path through a reverse direction traditional los guidance algorithm guides the wave glider to follow a desired path along only one direction which is not applicable in the real sea applications especially when the wave glider tracks multiple paths for example if the wave glider is strongly influenced by ocean current and departs from current target path when a in fig 4 is obtuse angle the wave glider needs to return back to the desired path in a negative direction along the target path to overcome the above problems an improved artificial potential field iapf algorithm is adopted to determine the los position in a simple and effective way note that the artificial potential field method has been universally used in autonomous marine trajectory planning song et al 2018 li et al 2019 khalaji and tourajizadeh 2020 due to the advantages of simplicity high efficiency and strong adaptability however in traditional apf method the attractive potential field and the attractive force are generally in proportion ratio with the distance between the vehicle and the waypoints which is not suitable to this paper therefore the apf is improved to make the vehicle always tend to glide toward to the current target path which means that the larger the distance between the vehicle and the waypoints the smaller the improved attractive potential field and the improved attractive force and the iapf is used to calculate the los position in this path following control make the wave glider always be attracted by the current target point and illustrate the convergence of the proposed algorithm the improved apf based the los guidance algorithm is aiming to determine the reference heading angle and then realize the multi path following guidance for the wave glider the main idea of the proposed iapf algorithm is filled the vehicle workspace with an artificial potential field which takes the targets as the goal s attractive potential field center the potential field method can be expressed as 15 u a t t k p c 1 2 ε 1 ρ 2 p c p g k k 1 2 n where ε is a positive constant attractive coefficient p c x c y c t and p g k x g k y g k t are the positions of the wave glider and the k th waypoint note that the target point is taken as the n th waypoint and the total number of the waypoints turns to be n the ρ p c p g k is the distance between the vehicle and the k th waypoint which can be calculated by using gauss geodesic algorithm the attractive force f att k p c of the k th waypoint can be represented by the negative gradient of the attractive potential field li et al 2019 which can be expressed as 16 f att k p c u a t t k p c ε ρ 3 p c p g k n a t t k k 1 2 n where n a t t k is a unit vector pointing from the vehicle to the k th waypoint from eq 15 and eq 16 it can be seen that the improved attractive potential field u a t t k p c and the improved attractive force f att k p c are inversely proportional to the distance between the vehicle and the waypoints thus the wave glider always tends to be guided toward to the current target point by the improved apf in the path following task in eq 14 the los position cannot be identified and needs to be analyzed in situations especially when the path error caused by uncontrollable velocity of the wave glider and ocean disturbance is big thus the iapf is adopted to deal with the big path following basis situations in the wave glider sea trials the possible los positions obtained by eq 14 have different potential field u a t t k 1 p l o s 1 and u a t t k 1 p l o s 2 and combined with the input position of the wave glider p c t x c t y c t t and the possible los positions the final los position p l o s t x l o s t y l o s t t could be selected according to the bigger of the two attractive forces f att k 1 p l o s 1 and f att k 1 p l o s 2 the desired heading ψ d t can be determined according to the real time wave glider position and the los position when the wave glider follows a target path ψ d t can be calculated as 17 ψ d t p c t p l o s t when the wave glider switches a target point and reaches the switching radius d r the current target point and the next target point together can guide the wave glider to have a smooth transition in the target point switching process two virtual los positions are calculated to determine ψ d t until the lateral errors of the wave glider to the current path and next target path are equal which means that the turning process ends and the next target path following control begins 3 3 adaptive control the look ahead distance δ l o s in fig 2 the core of the los guidance law enables the wave glider to converge suitably when deviating from the desired path and guides the wave glider along the desired path it plays an extremely important role in path following in traditional los method look ahead distance is constant and is used for simple linear tracking however this approach exhibits poor tracking performance owing to the weak maneuverability of the wave glider and uncertainty environments in the previous los references fossen 2011 liu et al 2019 nie and lin 2019 wang et al 2019 abdurahman et al 2019 yu et al 2019 nie et al 2020 it can be seen that the target path types the lateral error and the forward speed of the vehicle are all influences the selection of proper look ahead distance for tracking the straight line paths as shown in fig 5 a if the look ahead distance is too long it will take much longer time to guide the wave glider convergent to the desired path on the contrary if the look ahead distance is too short oscillation will occur when the wave glider reaches the path as shown in fig 5 b fig 6 shows the different wave glider speeds have a huge influence on the convergence time in the path following performance when the wave glider glides at a high speed the look ahead distance will be quickly increased as shown in fig 6 a when the wave glider glides at a low speed the look ahead distance will be slowly increased as shown in fig 6 b it can be easily concluded that if the look ahead distance is constant or not well adaptive changed oscillation overshoot or long time convergence will occur therefore the adaptive adjustment of the look ahead distance δ l o s for the wave glider with weak maneuverability is essential for accurate path following control in a disturbed environment to build the rule of adaptive control fig 7 presents a time history of the varied lateral errors with different look ahead distances and different forward speeds note that the controllable δ l o s in the adaptive control is related to the varying speed and the lateral error thus based on traditional los guidance algorithm the speed of the wave glider v the real time lateral error e p and the related reference liu et al 2019 the adaptive control rule can be designed as 18 δ l o s κ 1 e κ 2 e c 2 v κ 3 where κ 1 κ 2 and κ 3 are the coefficients of adaptive control 3 4 ipid control in order to make the proposed path following control more general the most commonly used pid control method is adopted for heading control in this study most of the widely applied pid control methods for marine vehicles can be applied into the heading control of the wave glider like pd pid positional pid incremental pid etc to weak the influence of the integration link in the control performance an incremental pid is used in heading control with desired heading angle as input and desired rudder angle as output the rudder angle as a control quantum to the controlled plant is calculated to obtain forces and moments required for the desired heading which guides the wave glider to accomplish the path following task the control algorithm can be described as 19 δ δ v t k p e ψ t e ψ t 1 k i e ψ t k d e ψ t e ψ t 1 e ψ t 1 e ψ t 2 where k p k i k d are proportional integral and differential coefficients respectively e ψ k ψ d k ψ c k is the heading error δ v k δ δ v k δ v k 1 is the rudder angle 4 simulation and experiment validation to evaluate and validate performances of the proposed path following control simulations and experiments of the proposed alos iapf control and traditional los control were performed based on a closed loop control 4 1 closed loop control based on the dynamic model of the black pearl wave glider the path following control algorithm is embedded into a closed loop motion control system the real time current position and the heading angle of the wave glider used as a feedback are respectively sampled by using a gps and a compass sensor when the actual position and the preset target path are updated the desired heading of the wave glider can be confirmed the path following control is mainly used to maintain the actual position of the wave glider being consistent with the desired path in the horizontal plane during navigation motion the vertical rudder flapping adjusts the heading of the wave glider to follow the desired path fig 8 gives the closed loop control system for path following control simulation dynamic uncertainties and environment disturbance including wind wave and current are all regarded as uncertain disturbance f d i s and to simplify the analysis gaussian white noise as the uncertain disturbance is selected in the following simulations 4 2 simulations considering the actual operations of the black pearl wave glider all the simulations were performed with a time step of 1 s the control parameters used for simulations and experiments were set as k p 0 4 k i 0 007 and k d 3 0 when κ 1 120 κ 2 0 01 κ 3 40 the adaptive control could be fast evolved to update the look ahead distance in real time the initial conditions u 0 v 0 w 0 p 0 q 0 r 0 ψ 0 ϕ 0 θ 0 ξ o 0 η o 0 ζ o 0 were set as 0 001 m s 0 0 0 0 0 0 0 0 0 0 0 the initial values could be obtained by physical measurement and motion conditions additionally the research mainly focused on the speed of the wave glider and the uncertain disturbance in seas the influence of the wave acted on the speed of the wave glider and the speed varying in wave period was not considered in this paper four points 50 100 100 200 200 0 100 200 were selected as the path points to determine the desired path let 150 350 be the initial position in the first simulation and 0 0 be the initial position of the wave glider in the second and third simulations when the wave glider approaches the target point in the current target path following the target point switch will be performed if the wave glider is within 50 m to evaluate and validate performance of the improved apf comparisons between traditional los and the improved apf were presented in fig 9 it could be clearly seen from fig 9 that when the current position of the wave glider was departed from the target path t 1 t 2 traditional los control could only track the extension of the current path which had no capability to return back to the target path in time obviously for the multi waypoints path following the iapf based the los guidance algorithm could successfully and always converged to the target paths this was mainly because the inversely proportional relationship between the improved attractive force and the distance of the los position and the waypoints redefined in the iapf algorithm the desired path the actual path and the relevant impact factors in the path following response without disturbance were illustrated in fig 10 where the wave glider tracked a desired path with a constant speed average 0 5 m s the change of wave period was neglected by using traditional los and the alos with the iapf respectively compared with the conventional los control the proposed path following control had a better path following performance with a smaller lateral error and a much restrained overshoot which showed that the proposed path following control had better robustness in such nonlinear control system as seen in fig 10 a oscillation was largely restrained with shoot convergence time in the conventional los however the path following error in the conventional los increased greatly especially when the target point switch occurred on the desired path and obvious inhibitory effect on the overshoot was still not obtained more specifically it could be noted that the proposed path following control could finish the desired path following task faster than the conventional los control which showed that the proposed path following control algorithm had a high path following efficiency fig 10 b gave the look ahead distance δ l o s and the lateral error e p in the path following process and the control input was shown in fig 10 c δ l o s was set constant 30 m in the conventional los and both two algorithms had the same constant speed value it could be noted that δ l o s in the alos iapf was time varying sensitively and fluctuated much more greatly according to the lateral error which meant that the proposed control could rapidly response and effectively adjust the desired heading of the wave glider it could also be seen from fig 10 c that even though the control parameters k p k i and k d were same in the two rudder control algorithms the proposed alos iapf could output a more appropriate desired heading which could guide the wave glider to make a much more accurate path following performance in comparison of the lateral error e p apparent cusp in the conventional los occurred and the path error caused by the sudden change of target path was usually approximately equal to the target point switching radius value moreover the huge cusp caused a big overshoot in the process of the switching target path in contrast though the target path switched a little slower than the conventional los the proposed control had a much smaller lateral error and relatively smooth and steady turning in the target path changing process the much better performance was benefitted from the iapf algorithm which provided two virtual los positions to make wave glider have a relative gentle transition in the following simulation the path following performance was assessed in rigorous perturbed conditions for this purpose gaussian white noise as external disturbance was selected and was added into the current heading of the black pearl wave glider ranging from 20 to 20 meanwhile the speed of the wave glider is uncontrollable and is time varying based on the waves in the real sea task for better consistency with the actual sea conditions the speed of the wave glider also changes with time as shown in fig 11 a based on the actual speed in previous sea trials of the black pearl wave glider the speed changes in wave period could be neglected the vehicle speed was selected and smoothly changed with time fig 11 b showed that the overshoot was more seriously and fluctuations occurred in the los control were caused by the disturbance and the time varying speed it could be seen that the alos control with the iapf had a better performance with a lower path following error for its stronger resistance to the disturbance and adaptability to the time varying speed as seen in fig 11 c δ l o s varied much greater compared with non disturbance and constant speed situations fig 10 b as it changed not only with the lateral error but also was affected by time varying speed of the wave glider according to both lateral error and speed δ l o s responsed rapidly and helped the proposed control have great advantage in inhibiting oscillation and overshoot compared with the conventional los in comparisons of lateral error the cusp still had a much bigger error caused by oscillation in the target path switching process in the conventional los clearly the actual trajectory of the wave glider based on the alos iapf could accurately fit the path fig 11 d gave the control inputs of two control algorithms and it could be noted that both two control algorithms had rapid response to the disturbance and the various speed of the wave glider with the same parameters k p k i and k d in both two algorithms the proposed alos iapf could output a more appropriate desired heading which could guide the wave glider to make a much more accurate path following with time varying speed in a disturbed environment 4 3 experiments the proposed algorithm was validated on the black pearl wave glider a series of experiments were carried out in the northwest pacific ocean and the south ocean of china to verify the performance of the proposed algorithm one of sea trial sites was shown in fig 12 after the appropriate motion control parameter adjustments the proposed alos iapf and traditional los methods were tested to confirm the performance improvement of the proposed alos iapf relative to traditional los the positions and the speed of the wave glider were obtained by using a gps sensor and the heading of the vehicle in the path following sea trial was updated by using a compass sensor two path following sea trials were carried out in the first experiment two black pearl wave gliders were placed in the northwest pacific ocean to test the performances of the los and the alos iapf respectively the second experiment was performed in the south ocean of china to verify the effectiveness and practicability in long term application wave gliders may replace large buoys to perform position keeping observation works with a polygon path following control in real ocean applications considering this six path points were set for regular hexagon to determine the desired path in the first sea trial i e the red point line the length of each target path was 6 km as shown in fig 13 and fig 14 the experimented wave gliders were adopted the same states such as target path set initial laid position initial current heading and initial rudder angle considering the complex environments in sea trials the target point switched area was limited to 200 m the trajectories of the los and the alos iapf were shown in figs 13 and 14 it could be seen that the los converged to the desired path with a larger deviation than that of the alos iapf even more seriously the los control without the iapf could hardly be convergent to the target path in real time as seen in fig 13 a when the wave glider tracked the target t2 t3 path the lateral error was big due to the external disturbance the weak maneuverability and the constant look ahead distance hence it easily made the wave glider beyond and miss the target point switched area note that the los control only followed the extension of target t2 t3 path which had no capability to drive the wave glider back to the target t2 t3 path and finished the following target paths it was noteworthy that this phenomenon coincided with the former simulations of the conventional los in contrast it could be seen from fig 14 a that the alos iapf could control the wave glider to reach all target paths more precisely compared with the conventional los figs 13 b and fig 14 b further illustrated the time varying speed of the wave glider and the lateral errors of the conventional los and the alos iapf respectively the speed of the two wave gliders were changed in real time varying from 0 m s to 0 85 m s note that the speed of the proposed control was varying more frequently and intensely which might cause the more difficult path following conditions furthermore it could also be noted that the lateral error of the alos iapf was mostly within 300 m which declined nearly 40 compared with the los due to the uncertainties encountered in sea trials the control performance was worse than pure simulation and the path following error was corresponding to be extent figs 13 c and fig 14 c gave the control inputs of two algorithms in sea trials though the conventional los also had a big response in rudder action the output of the los algorithm made a wrong guide for the wave glider which led to a failed sea trial as shown in fig 13 a since the real sea conditions were more complex than pure simulation the path following error was thought as satisfactory moreover the quantized path following errors of the los and the alos iapf were presented in table 5 another experiment was carried out in the south sea of china to valid the long term effectiveness of the proposed control the experiment lasted 37 days from october 13 2019 to november 19 2019 it could be seen from fig 15 a five target points denoted by the red point lines were set and the actual trajectory of the wave glider denoted by blue lines was accurately convergent to the desired path fig 15 b gave a time history of the varied speed of the wave glider and the lateral error distance it could be noticed that the speed of the wave glider changed in a much wider range from 0 m s to 1 7 m s which showed that the vehicle confronted a bigger ocean disturbance the control input of the alos iapf was showed in fig 15 c it also could be noticed that a rapid rudder action replied well to the ocean disturbance and various speed in sea trials meanwhile table 6 gave the quantized path following errors of the long term experiment in time division it could also be noticed that the lateral error was much bigger from october 24 2019 to november 8 2019 which corresponded with the area of the third and fourth target points referring to global ocean surface geostrophic current the ocean current speed of these regions was stronger varying from 0 2 m s to 0 45 m s particularly its direction was mostly perpendicular to the forward trajectory of the vehicle which caused a huge difficulty on the path following control when the ocean current was in the range of 0 0 m s to 0 35 m s no matter how the currents direction changed the lateral error was mostly below 400 m which showed a high precision path following performance as the currents velocity continually increased in a range of most over 0 3 m s the lateral error was hardly limited in a relative small scope this was mainly because the wave glider was controlled only by rudder actuator without propeller thrust or other related actuators note that in the whole 40 day path following control the lateral errors were mostly limited below 1 km which could fully demonstrate the realistic practicability of the black pearl wave glider in a complex marine environment see table 6 5 conclusions in this paper an adaptive path following control of an under actuated wave glider was investigated in the presence of ocean currents induced uncertainties highly dynamic nonlinearities and weak maneuverability the influences of those uncertainties were considered in the proposed path following control an adaptive control based line of sight guidance alos was utilized for kinematic control to improve the tracking performance and converging rate where an auxiliary variable was adaptive adjust to the conventional los guidance control an improved artificial potential field iapf was designed to analyze and explicit the output of the alos while it could guarantee a real time convergence to the target path and improve the system robustness the proposed control employed an incremental pid heading control into a dynamic model of the wave glider black pearl which composed a closed loop control for simulations and sea trial experiments furthermore the effectiveness and practicability of the proposed control was verified with a long term sea trial application according to sea trial results and analyses the proposed control could fit the path well with a great lower deviation which cut down about 40 compared with the conventional los path following errors were mostly below 200 m when current velocity was less than 0 25 m s as ocean current velocity increases to a range of 0 25 m s to 0 45 m s and even more bigger the average path errors could be increased to 2 km thus a propeller assisted control to the path following of the wave glider will be considered in future credit authorship contribution statement xiujun sun conceptualization data curation formal analysis funding acquisition ying zhou investigation methodology formal analysis project administration validation visualization writing review editing hongqiang sang formal analysis resources supervision funding acquisition peiyuan yu formal analysis software roles writing original draft shuai zhang formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is supported by major scientific and technological innovation projects of shandong province no 2019jzzy020701 tianjin natural science foundation no 18jczdjc40100 the national key research and development plan of china no 2017yfc0305902 wenhai program of qingdao national laboratory for marine science and technology no 2017whzzb0101 the authors appreciate all staff members in research and development team of the black pearl wave gliders 
21320,path following control plays an essential role in improving accuracy of navigation and achieving a smooth motion control however the performance will exhibit large lateral errors caused by weak maneuverability large time lag and large ocean current disturbance when the wave glider is gliding with a low and time varying speed an adaptive path following control integrated an adaptive line of sight alos algorithm and an improved artificial potential field iapf algorithm was put forward in this paper which could extremely guarantee path following accuracy the adaptive control based a los was introduced to dynamically adjust a parameter of the los so that the output desired heading of the wave glider was on time updated based on the velocity of the wave glider and path following error the iapf was applied to analyze and modify the output of the alos guiding the vehicle always convergent to the desired path which could make a real time self diagnosing monitoring and correction in path following control following this a closed loop control was put forward with a dynamic model of the black pearl wave glider and the given path following control the proposed control was verified by simulations and sea trials compared with conventional los which demonstrated its effectiveness and long term reliability keywords wave glider path following control dynamic model adaptive line of sight improved artificial potential field sea trials 1 introduction path following control is one of the most essential features required to ensure reliable and robust operation of marine vehicles in cluttered and uncertain ocean environments and it plays an essential role in improving accuracy of navigation and achieving a smooth motion control furthermore most of marine vehicles involve such path following control problems especially to under actuated marine vessels such as autonomous underwater vehicles auvs autonomous surface vehicles asvs and remotely operated vehicles rovs see table 1 several solutions have been proposed for realizing ideal path following in numerous prior works as summarized in table 1 most of these marine vessels can be classified into two categories underwater vehicles and surface vehicles and the most two representatives are auvs and asvs for auvs the control algorithms mainly include fuzzy control yu et al 2017 adaptive control liu et al 2019 formation control gao and guo 2019 neural network control shojaei and dolatshahi 2017 and sliding mode control xia et al 2019 in addition to some other controls abdurahman et al 2017 2019 these controls were optimized based on line of sight los control to design the path following guidance laws most of these auv controls usually follow desired paths in underwater environments with a relative small ocean disturbance compared with the surface ocean environment moreover it can be seen from table 1 that all auvs have capabilities of self velocity control in path following performance on the basis of the surge and the yaw control the realization of the los guidance law on auvs becomes much easier compared with some marine vehicles with only one control input an overview of the los guidance principles for marine crafts could be found in fossen and lekkas 2017 note that the los has been widely used in the related research of path following owing to its simplicity and effectiveness for asvs a predictor based neural network method was designed to update parameters in the los guidance for path following control in gu et al 2019 woo et al 2019 adopted a learning based control for path following of an asv with two electric thrusters inputs used for the steering control and speed control tao et al 2019 put forward a characteristic model based adaptive control applied to asv multi straight line path following nie and lin 2019 designed an improved adaptive integral line of sight iailos guidance law for a kind of asvs which was used to calculate the desired yaw angle and the controller was extended to track the desired yaw angle and desired velocity it was found that in the above mentioned asv path following references whether using the model based adaptive control tao et al 2019 or the iailos guidance nie and lin 2019 the control inputs include heading control and speed control and the controlled parameters were usually related to path following errors and control inputs the wave glider is a class of wave propelled persistent unmanned ocean surface vehicle as the propulsion of the wave glider only comes from wave energy and there is no propeller or other electric propulsion with this advantage the wave glider provides a new idea for the propulsion and enables new concepts of operations for ocean applications including acoustic data collection communication gateway for subsurface systems military intelligence collection meteorological observation etc daniel et al 2011 olson and robert 2012 goebel et al 2014 yang et al 2018 to accomplish these tasks safely and efficiently it is crucial to design robust and efficient path following controls for wave gliders however compared with the above mentioned asvs and auvs the wave glider is an under actuated system with weak maneuverability and the thrusts of the wave glider comes from wave motion and changes randomly with sea condition that is to say the velocity of the wave glider is uncontrollable and time varying moreover combined with the air sea interface disturbance like wind and sea currents the control problem of wave gliders on accurate path following is more challenging than the other asvs and auvs for path following control of wave gliders the related researches are few though the above mentioned research works prompted underwater and surface vehicles all refers to the path following control problems of under actuated vehicles however these control methods only have been theoretically verified their reliabilities in practical applications are rarely tested moreover all of the aforementioned investigations focus on the single body vehicles and there are at least two control inputs including a surge force and a yaw moment thus these controls are not appropriate or need to be reconstructed for dealing with path following problems of wave gliders wang et al 2019 proposed a path following approach based on a los algorithm and a restricted circle for a wave glider although the algorithm could take advantage of ocean current and reduce the tracking error in some extent and the current speed was only set as 0 1 m s and 0 2 m s in simulations it was not accordant with the complex and changeable marine environment therefore the actual path following performance of this method is unclear and it is a well known fact that disturbances caused by wind wave and current are immeasurable and may depart the vehicle from a preset path in different sea states with non uniform flow situations an adaptive desired heading obtained with considering uncertain disturbance and its varying velocity is the foremost part when the wave glider takes path following task in the sea therefore this paper focuses on the path following control of the wave glider with weak maneuverability and large ocean current disturbance compared with the existing results an adaptive path following control algorithm is developed by using an adaptive line of sight algorithm alos and an improved artificial potential field iapf algorithm to deal with uncertain disturbance and velocity constraint simultaneously the corresponding controller is with characteristics of the lumped disturbance rejection capability therefore the proposed adaptive path following control algorithm is more applicable to the marine practice the main contributions of the manuscript can be summarized as follows 1 an adaptive improved los apf algorithm was developed to obtain a desired glider heading to follow straight lines for wave gliders which considered the time varying speed of wave gliders and the lateral error during the path following 2 a closed loop motion control system with desired path points as input and actual glider positions as output was put forward which included the dynamic model of the black pearl wave glider and the given path following control algorithm the effectiveness and applicability of the proposed control algorithm was assessed and verified through simulations and sea trials the remainder of this study is organized as follows section 2 presents the model of the black pearl wave glider section 3 proposes the alos iapf algorithm in detail at the same time the detailed deriving and proving process are presented section 4 establishes the designed closed loop system including the dynamic model and the given control algorithm and a lot of simulations and sea trials are carried out to validate the previous analysis section 5 summarizes the key conclusions of this work 2 dynamics of the black pearl wave glider to better appreciate the effect of the path following control method and imitate the real glider in an unsteady non uniform flow field the full dynamic model of the black pearl wave glider was developed through referring the previous dynamic researches wang et al 2019 fossen 1994 2002 2011 wang et al 2019 yang et al 2019 the black pearl wave glider as shown in fig 1 is a kind of under actuated wave gliders independently developed by ocean university of china and tiangong university to absorb the wave energy the wave glider is designed as a multi body system located at different depths the float on the sea surface and the submerged glider are connected by a flexible umbilical cable six pairs of hydrofoils are hinged on the submerged glider the wave forces the float heaving and the vertical motion of the float is transmitted to the submerged glider via by the umbilical the hydrofoils are forced to rotate and the lift which is always forward independent of the wave direction in horizontal plane the rudder on the back of the submerged glider is a steering actuator that is used as the only actuator in the proposed path following control four coordinate frames are established body coordinate frame system frame b float frame f submerged glider frame g and geodetic coordinate frame o kraus 2012 as shown in fig 2 let o ξ o η o ς o τ be a position vector of the wave glider from the origin of the system frame to the origin of the geodetic coordinate frame and assume that ω ϕ θ ψ τ is an attitude vector of the wave glider in the geodetic coordinate frame which is used for transformation from the system frame to the inertial frame besides o and ω can also be used to describe the position and the attitude of the wave glider which responds six degrees of freedom dofs in the following dynamic model of the black pearl wave glider υ u v w τ and ω p q r τ are a transitional velocity vector and an angular velocity vector in the body coordinate frame respectively f x y z τ and t k m n τ are a transitional external force vector and a total moment vector of the glider in the body coordinate frame respectively six dofs are considered surge and sway of the center of gravity of the wave glider roll and pitch of the system frame and yaw motions of the float and the submerged glider the location of the wave glider is described as x y which is the coordinates of the origin of system frame in the earth fixed frame the relative position of the float and the submerged glider can be described by rolling angle ϕ and pitching angle θ some important assumptions are made following as 1 the umbilical is always in tension since the submerged glider is heavy enough under water motion parameters of the float and the submerged glider in the system frame are derived based on rigid body 2 when considering the holistic motion of the wave glider the shapes of the float and the submerged glider are ignored a standard representation of a six dofs nonlinear dynamic equations of motion for a single body can be found in fossen 2011 according to this reference the dynamics of the black pearl wave glider can be expressed as 1 m ν c ν ν d ν η g η τ η where ν u v w p q r t η x y z φ θ ψ t m r 6 6 is the rigid mass matrix c ν r 6 6 is the coriolis centripetal coefficient matrix d ν η r 6 6 is the vector of damping force g η r 6 1 is the vector of gravitational forces and moments τ η r 6 1 is the vector of control inputs which contains the thrust and the rudder forces of the submerged glider here the dynamic model of the black pearl wave glider is mainly concerned with the yawing motion that has a main influence on the path following control and the vertical motion is treated separately thus the initial state variables are set as η x 0 y 0 φ 0 θ 0 ψ f ψ g t and ν u 0 v 0 p 0 q 0 r f r g t furthermore the heading error between the float and the submerged glider is considered as δ ψ ψ g ψ f in dynamics of the wave glider added mass in inertia matrix terms is neglected as the calculation is extremely difficult and it has large uncertainties furthermore some similar dynamic uncertainties combined with environment disturbance are all considered as external uncertainties in the later path following control thus the inertial matrix kraus 2012 can be simplified as 2 m m b m b i b x x i b y y i f z z i g z z where m b is the total mass of the wave glider i b x x i b y y m g d g b 2 m f d f b 2 i f z z and i g z z are rotational inertias of the float and the submerged glider respectively in the coriolis and centripetal matrix term the coriolis force is considered negligible as it is much smaller than other hydrodynamic forces moreover assuming that the roll and pitch rates of the float and the submerged glider are negligible thus c ν kraus 2012 can be expressed as 3 c ν 0 0 0 0 0 m b v b 0 0 0 0 0 m b u b 0 0 0 0 0 i b x x q b 0 0 0 0 0 i b x x p b 0 0 0 0 0 0 0 0 0 0 0 0 the transformation matrix from the system frame to the float frame and the submerged glider frame kraus 2012 can be derived as 4 r of cos δ ψ cos θ cos δ ψ sin ϕ sin θ sin δ ψ cos ϕ sin ϕ sin δ ψ cos δ ψ sin θ cos ϕ sin δ ψ cos θ cos δ ψ cos ϕ sin δ ψ sin θ sin ϕ sin θ sin δ ψ cos ϕ cos δ ψ sin ϕ sin θ cos θ sin ϕ cos θ cos ϕ 5 r og cos θ sin ϕ sin θ sin θ cos ϕ 0 cos ϕ sin ϕ sin θ cos θ sin ϕ cos θ cos ϕ with r fo r of t and r go r og t wang et al 2019 the forces and moments in the body coordinate frame can be calculated the damping matrix d ν η kraus 2012 is 6 d ν η x b y b k b m b ℕ f ℕ g where 7 x b x f b u x f b ν x g b u x g b ν x g b w x b u x f b w a v e y b y f b u y f b v y g b u y g b v y g b w y b u y f b w a v e k b y f b u y f b v y f b w a v e d f b y g b u y g b v y g b w d g b m b x f b u x f b ν x f b w a v e d f b x g b u x g b ν x g b w d g b ℕ f ℕ f f v ℕ f f r ℕ g ℕ g g v ℕ g g r here the subscript b f and g represents the body frame the float frame and the submerged glider frame respectively the former superscript f and g refers to the float and the submerged glider respectively x b u f and y b u f are the axial and cross flow forces on the float caused by the axial velocity of the submerged glider in the body frame similarly combined with transformation matrix as eq 5 g η kraus 2012 becomes 8 g η x g b h s y g b h s y g b h s d g b x g b h s d g b 0 0 the control inputs including wave generated thrust and rudder angle kraus 2012 can be expressed as 9 τ x g b t h u r s t x g b u δ δ y g b t h u r s t y g b u δ δ y g b t h u r s t y g b u δ δ d g b x g b t h u r s t x g b u δ δ d g b 0 n g u u δ here the dynamic model of the wave glider is simplified and disturbances from wind wave and current are ignored in the following proposed algorithm simulations sea trials the dynamic uncertainties and environments are all considered and are dealt with well table 2 and table 3 give the dynamic parameters coefficients and non dynamic parameters of the black pearl wave glider respectively the dynamic parameters and coefficients have been obtained by cfd simulation empirical formulas previous experiments and kraus 2012 and the non dynamic parameters have been obtained by physical measurement 3 path following control based on an alos with an iapf to keep the wave glider following a desired path it is necessary to study the path following control algorithm the los guidance is the most popular method for path following control the guidance laws composed of speed and los steering laws which could be combined in various ways to achieve different motion control objectives were presented in the previous researches liu et al 2019 fossen 2011 nie et al 2020 nie and lin 2019 wang et al 2019 abdurahman et al 2019 yu et al 2019 in this study the proposed path following control algorithm was designed to obtain the desired course according to the target point and the real time location of the wave glider and an incremental pid heading control algorithm was used to achieve the path following task the control structure for path following was presented which is shown in fig 3 the control algorithm was mainly divided into three parts an adaptive los guidance an improved apf and an incremental proportion integration differentiation ipid heading control the improved apf was employed to determine the los position in the los guidance the alos guidance was used to calculate the desired heading the desired heading was obtained by the ipid strategy 3 1 line of sight los guidance law for the wave glider sailing in open sea the desired path of the wave glider is usually specified in terms of waypoints the desired waypoint database consists of 10 wpt p o s x 1 y 1 x 2 y 2 x n y n the los guidance law is shown in fig 4 a the desired heading of wave glider can be implicitly defined by the ordered waypoint sequence according to the reference fossen 2011 since tan ψ d t y l o s t y t x l o s t x t the desired heading of the wave glider can be derived as 11 ψ d t atan 2 y l o s t y t x l o s t x t to calculate the los intersection point p l o s t x l o s t y l o s t t the following two equations can be obtained from fig 4 a 12 x l o s t x t 2 y l o s t y t 2 r 2 13 tan α c y k 1 y k x k 1 x k y l o s y k x l o s x k constant define δ x x k 1 x k and δ y y k 1 y k x l o s and y l o s can be easily obtained from eq 13 when δ y 0 if δ x 0 only eq 12 is valid which means that y l o s y r 2 x l o s x 2 and x l o s x k x k 1 where r e p 2 δ l o s 2 when δ x 0 eq 13 can be expressed as y l o s δ y δ x x l o s x k y k combined with eq 11 to eq 13 the los intersection point can be obtained as 14 x l o s b b 2 4 a c 2 a y l o s δ y δ x x l o s x k y k where d δ y δ x e x k f y k g f d e a 1 d 2 b 2 d g d y x c x 2 y 2 g 2 2 g y r 2 eq 14 shows that the los position need be analyzed and chosen by situations in real time path following control when the wave glider is in the target path following the los position is selected as seen in fig 4 b whereas if the wave glider needs to return back to the target path the los position needs to be chosen as shown in fig 4 c 3 2 improved artificial potential field iapf when tracking a preset target path normal los algorithm ignores the situation if the wave glider needs to return back to the target path through a reverse direction traditional los guidance algorithm guides the wave glider to follow a desired path along only one direction which is not applicable in the real sea applications especially when the wave glider tracks multiple paths for example if the wave glider is strongly influenced by ocean current and departs from current target path when a in fig 4 is obtuse angle the wave glider needs to return back to the desired path in a negative direction along the target path to overcome the above problems an improved artificial potential field iapf algorithm is adopted to determine the los position in a simple and effective way note that the artificial potential field method has been universally used in autonomous marine trajectory planning song et al 2018 li et al 2019 khalaji and tourajizadeh 2020 due to the advantages of simplicity high efficiency and strong adaptability however in traditional apf method the attractive potential field and the attractive force are generally in proportion ratio with the distance between the vehicle and the waypoints which is not suitable to this paper therefore the apf is improved to make the vehicle always tend to glide toward to the current target path which means that the larger the distance between the vehicle and the waypoints the smaller the improved attractive potential field and the improved attractive force and the iapf is used to calculate the los position in this path following control make the wave glider always be attracted by the current target point and illustrate the convergence of the proposed algorithm the improved apf based the los guidance algorithm is aiming to determine the reference heading angle and then realize the multi path following guidance for the wave glider the main idea of the proposed iapf algorithm is filled the vehicle workspace with an artificial potential field which takes the targets as the goal s attractive potential field center the potential field method can be expressed as 15 u a t t k p c 1 2 ε 1 ρ 2 p c p g k k 1 2 n where ε is a positive constant attractive coefficient p c x c y c t and p g k x g k y g k t are the positions of the wave glider and the k th waypoint note that the target point is taken as the n th waypoint and the total number of the waypoints turns to be n the ρ p c p g k is the distance between the vehicle and the k th waypoint which can be calculated by using gauss geodesic algorithm the attractive force f att k p c of the k th waypoint can be represented by the negative gradient of the attractive potential field li et al 2019 which can be expressed as 16 f att k p c u a t t k p c ε ρ 3 p c p g k n a t t k k 1 2 n where n a t t k is a unit vector pointing from the vehicle to the k th waypoint from eq 15 and eq 16 it can be seen that the improved attractive potential field u a t t k p c and the improved attractive force f att k p c are inversely proportional to the distance between the vehicle and the waypoints thus the wave glider always tends to be guided toward to the current target point by the improved apf in the path following task in eq 14 the los position cannot be identified and needs to be analyzed in situations especially when the path error caused by uncontrollable velocity of the wave glider and ocean disturbance is big thus the iapf is adopted to deal with the big path following basis situations in the wave glider sea trials the possible los positions obtained by eq 14 have different potential field u a t t k 1 p l o s 1 and u a t t k 1 p l o s 2 and combined with the input position of the wave glider p c t x c t y c t t and the possible los positions the final los position p l o s t x l o s t y l o s t t could be selected according to the bigger of the two attractive forces f att k 1 p l o s 1 and f att k 1 p l o s 2 the desired heading ψ d t can be determined according to the real time wave glider position and the los position when the wave glider follows a target path ψ d t can be calculated as 17 ψ d t p c t p l o s t when the wave glider switches a target point and reaches the switching radius d r the current target point and the next target point together can guide the wave glider to have a smooth transition in the target point switching process two virtual los positions are calculated to determine ψ d t until the lateral errors of the wave glider to the current path and next target path are equal which means that the turning process ends and the next target path following control begins 3 3 adaptive control the look ahead distance δ l o s in fig 2 the core of the los guidance law enables the wave glider to converge suitably when deviating from the desired path and guides the wave glider along the desired path it plays an extremely important role in path following in traditional los method look ahead distance is constant and is used for simple linear tracking however this approach exhibits poor tracking performance owing to the weak maneuverability of the wave glider and uncertainty environments in the previous los references fossen 2011 liu et al 2019 nie and lin 2019 wang et al 2019 abdurahman et al 2019 yu et al 2019 nie et al 2020 it can be seen that the target path types the lateral error and the forward speed of the vehicle are all influences the selection of proper look ahead distance for tracking the straight line paths as shown in fig 5 a if the look ahead distance is too long it will take much longer time to guide the wave glider convergent to the desired path on the contrary if the look ahead distance is too short oscillation will occur when the wave glider reaches the path as shown in fig 5 b fig 6 shows the different wave glider speeds have a huge influence on the convergence time in the path following performance when the wave glider glides at a high speed the look ahead distance will be quickly increased as shown in fig 6 a when the wave glider glides at a low speed the look ahead distance will be slowly increased as shown in fig 6 b it can be easily concluded that if the look ahead distance is constant or not well adaptive changed oscillation overshoot or long time convergence will occur therefore the adaptive adjustment of the look ahead distance δ l o s for the wave glider with weak maneuverability is essential for accurate path following control in a disturbed environment to build the rule of adaptive control fig 7 presents a time history of the varied lateral errors with different look ahead distances and different forward speeds note that the controllable δ l o s in the adaptive control is related to the varying speed and the lateral error thus based on traditional los guidance algorithm the speed of the wave glider v the real time lateral error e p and the related reference liu et al 2019 the adaptive control rule can be designed as 18 δ l o s κ 1 e κ 2 e c 2 v κ 3 where κ 1 κ 2 and κ 3 are the coefficients of adaptive control 3 4 ipid control in order to make the proposed path following control more general the most commonly used pid control method is adopted for heading control in this study most of the widely applied pid control methods for marine vehicles can be applied into the heading control of the wave glider like pd pid positional pid incremental pid etc to weak the influence of the integration link in the control performance an incremental pid is used in heading control with desired heading angle as input and desired rudder angle as output the rudder angle as a control quantum to the controlled plant is calculated to obtain forces and moments required for the desired heading which guides the wave glider to accomplish the path following task the control algorithm can be described as 19 δ δ v t k p e ψ t e ψ t 1 k i e ψ t k d e ψ t e ψ t 1 e ψ t 1 e ψ t 2 where k p k i k d are proportional integral and differential coefficients respectively e ψ k ψ d k ψ c k is the heading error δ v k δ δ v k δ v k 1 is the rudder angle 4 simulation and experiment validation to evaluate and validate performances of the proposed path following control simulations and experiments of the proposed alos iapf control and traditional los control were performed based on a closed loop control 4 1 closed loop control based on the dynamic model of the black pearl wave glider the path following control algorithm is embedded into a closed loop motion control system the real time current position and the heading angle of the wave glider used as a feedback are respectively sampled by using a gps and a compass sensor when the actual position and the preset target path are updated the desired heading of the wave glider can be confirmed the path following control is mainly used to maintain the actual position of the wave glider being consistent with the desired path in the horizontal plane during navigation motion the vertical rudder flapping adjusts the heading of the wave glider to follow the desired path fig 8 gives the closed loop control system for path following control simulation dynamic uncertainties and environment disturbance including wind wave and current are all regarded as uncertain disturbance f d i s and to simplify the analysis gaussian white noise as the uncertain disturbance is selected in the following simulations 4 2 simulations considering the actual operations of the black pearl wave glider all the simulations were performed with a time step of 1 s the control parameters used for simulations and experiments were set as k p 0 4 k i 0 007 and k d 3 0 when κ 1 120 κ 2 0 01 κ 3 40 the adaptive control could be fast evolved to update the look ahead distance in real time the initial conditions u 0 v 0 w 0 p 0 q 0 r 0 ψ 0 ϕ 0 θ 0 ξ o 0 η o 0 ζ o 0 were set as 0 001 m s 0 0 0 0 0 0 0 0 0 0 0 the initial values could be obtained by physical measurement and motion conditions additionally the research mainly focused on the speed of the wave glider and the uncertain disturbance in seas the influence of the wave acted on the speed of the wave glider and the speed varying in wave period was not considered in this paper four points 50 100 100 200 200 0 100 200 were selected as the path points to determine the desired path let 150 350 be the initial position in the first simulation and 0 0 be the initial position of the wave glider in the second and third simulations when the wave glider approaches the target point in the current target path following the target point switch will be performed if the wave glider is within 50 m to evaluate and validate performance of the improved apf comparisons between traditional los and the improved apf were presented in fig 9 it could be clearly seen from fig 9 that when the current position of the wave glider was departed from the target path t 1 t 2 traditional los control could only track the extension of the current path which had no capability to return back to the target path in time obviously for the multi waypoints path following the iapf based the los guidance algorithm could successfully and always converged to the target paths this was mainly because the inversely proportional relationship between the improved attractive force and the distance of the los position and the waypoints redefined in the iapf algorithm the desired path the actual path and the relevant impact factors in the path following response without disturbance were illustrated in fig 10 where the wave glider tracked a desired path with a constant speed average 0 5 m s the change of wave period was neglected by using traditional los and the alos with the iapf respectively compared with the conventional los control the proposed path following control had a better path following performance with a smaller lateral error and a much restrained overshoot which showed that the proposed path following control had better robustness in such nonlinear control system as seen in fig 10 a oscillation was largely restrained with shoot convergence time in the conventional los however the path following error in the conventional los increased greatly especially when the target point switch occurred on the desired path and obvious inhibitory effect on the overshoot was still not obtained more specifically it could be noted that the proposed path following control could finish the desired path following task faster than the conventional los control which showed that the proposed path following control algorithm had a high path following efficiency fig 10 b gave the look ahead distance δ l o s and the lateral error e p in the path following process and the control input was shown in fig 10 c δ l o s was set constant 30 m in the conventional los and both two algorithms had the same constant speed value it could be noted that δ l o s in the alos iapf was time varying sensitively and fluctuated much more greatly according to the lateral error which meant that the proposed control could rapidly response and effectively adjust the desired heading of the wave glider it could also be seen from fig 10 c that even though the control parameters k p k i and k d were same in the two rudder control algorithms the proposed alos iapf could output a more appropriate desired heading which could guide the wave glider to make a much more accurate path following performance in comparison of the lateral error e p apparent cusp in the conventional los occurred and the path error caused by the sudden change of target path was usually approximately equal to the target point switching radius value moreover the huge cusp caused a big overshoot in the process of the switching target path in contrast though the target path switched a little slower than the conventional los the proposed control had a much smaller lateral error and relatively smooth and steady turning in the target path changing process the much better performance was benefitted from the iapf algorithm which provided two virtual los positions to make wave glider have a relative gentle transition in the following simulation the path following performance was assessed in rigorous perturbed conditions for this purpose gaussian white noise as external disturbance was selected and was added into the current heading of the black pearl wave glider ranging from 20 to 20 meanwhile the speed of the wave glider is uncontrollable and is time varying based on the waves in the real sea task for better consistency with the actual sea conditions the speed of the wave glider also changes with time as shown in fig 11 a based on the actual speed in previous sea trials of the black pearl wave glider the speed changes in wave period could be neglected the vehicle speed was selected and smoothly changed with time fig 11 b showed that the overshoot was more seriously and fluctuations occurred in the los control were caused by the disturbance and the time varying speed it could be seen that the alos control with the iapf had a better performance with a lower path following error for its stronger resistance to the disturbance and adaptability to the time varying speed as seen in fig 11 c δ l o s varied much greater compared with non disturbance and constant speed situations fig 10 b as it changed not only with the lateral error but also was affected by time varying speed of the wave glider according to both lateral error and speed δ l o s responsed rapidly and helped the proposed control have great advantage in inhibiting oscillation and overshoot compared with the conventional los in comparisons of lateral error the cusp still had a much bigger error caused by oscillation in the target path switching process in the conventional los clearly the actual trajectory of the wave glider based on the alos iapf could accurately fit the path fig 11 d gave the control inputs of two control algorithms and it could be noted that both two control algorithms had rapid response to the disturbance and the various speed of the wave glider with the same parameters k p k i and k d in both two algorithms the proposed alos iapf could output a more appropriate desired heading which could guide the wave glider to make a much more accurate path following with time varying speed in a disturbed environment 4 3 experiments the proposed algorithm was validated on the black pearl wave glider a series of experiments were carried out in the northwest pacific ocean and the south ocean of china to verify the performance of the proposed algorithm one of sea trial sites was shown in fig 12 after the appropriate motion control parameter adjustments the proposed alos iapf and traditional los methods were tested to confirm the performance improvement of the proposed alos iapf relative to traditional los the positions and the speed of the wave glider were obtained by using a gps sensor and the heading of the vehicle in the path following sea trial was updated by using a compass sensor two path following sea trials were carried out in the first experiment two black pearl wave gliders were placed in the northwest pacific ocean to test the performances of the los and the alos iapf respectively the second experiment was performed in the south ocean of china to verify the effectiveness and practicability in long term application wave gliders may replace large buoys to perform position keeping observation works with a polygon path following control in real ocean applications considering this six path points were set for regular hexagon to determine the desired path in the first sea trial i e the red point line the length of each target path was 6 km as shown in fig 13 and fig 14 the experimented wave gliders were adopted the same states such as target path set initial laid position initial current heading and initial rudder angle considering the complex environments in sea trials the target point switched area was limited to 200 m the trajectories of the los and the alos iapf were shown in figs 13 and 14 it could be seen that the los converged to the desired path with a larger deviation than that of the alos iapf even more seriously the los control without the iapf could hardly be convergent to the target path in real time as seen in fig 13 a when the wave glider tracked the target t2 t3 path the lateral error was big due to the external disturbance the weak maneuverability and the constant look ahead distance hence it easily made the wave glider beyond and miss the target point switched area note that the los control only followed the extension of target t2 t3 path which had no capability to drive the wave glider back to the target t2 t3 path and finished the following target paths it was noteworthy that this phenomenon coincided with the former simulations of the conventional los in contrast it could be seen from fig 14 a that the alos iapf could control the wave glider to reach all target paths more precisely compared with the conventional los figs 13 b and fig 14 b further illustrated the time varying speed of the wave glider and the lateral errors of the conventional los and the alos iapf respectively the speed of the two wave gliders were changed in real time varying from 0 m s to 0 85 m s note that the speed of the proposed control was varying more frequently and intensely which might cause the more difficult path following conditions furthermore it could also be noted that the lateral error of the alos iapf was mostly within 300 m which declined nearly 40 compared with the los due to the uncertainties encountered in sea trials the control performance was worse than pure simulation and the path following error was corresponding to be extent figs 13 c and fig 14 c gave the control inputs of two algorithms in sea trials though the conventional los also had a big response in rudder action the output of the los algorithm made a wrong guide for the wave glider which led to a failed sea trial as shown in fig 13 a since the real sea conditions were more complex than pure simulation the path following error was thought as satisfactory moreover the quantized path following errors of the los and the alos iapf were presented in table 5 another experiment was carried out in the south sea of china to valid the long term effectiveness of the proposed control the experiment lasted 37 days from october 13 2019 to november 19 2019 it could be seen from fig 15 a five target points denoted by the red point lines were set and the actual trajectory of the wave glider denoted by blue lines was accurately convergent to the desired path fig 15 b gave a time history of the varied speed of the wave glider and the lateral error distance it could be noticed that the speed of the wave glider changed in a much wider range from 0 m s to 1 7 m s which showed that the vehicle confronted a bigger ocean disturbance the control input of the alos iapf was showed in fig 15 c it also could be noticed that a rapid rudder action replied well to the ocean disturbance and various speed in sea trials meanwhile table 6 gave the quantized path following errors of the long term experiment in time division it could also be noticed that the lateral error was much bigger from october 24 2019 to november 8 2019 which corresponded with the area of the third and fourth target points referring to global ocean surface geostrophic current the ocean current speed of these regions was stronger varying from 0 2 m s to 0 45 m s particularly its direction was mostly perpendicular to the forward trajectory of the vehicle which caused a huge difficulty on the path following control when the ocean current was in the range of 0 0 m s to 0 35 m s no matter how the currents direction changed the lateral error was mostly below 400 m which showed a high precision path following performance as the currents velocity continually increased in a range of most over 0 3 m s the lateral error was hardly limited in a relative small scope this was mainly because the wave glider was controlled only by rudder actuator without propeller thrust or other related actuators note that in the whole 40 day path following control the lateral errors were mostly limited below 1 km which could fully demonstrate the realistic practicability of the black pearl wave glider in a complex marine environment see table 6 5 conclusions in this paper an adaptive path following control of an under actuated wave glider was investigated in the presence of ocean currents induced uncertainties highly dynamic nonlinearities and weak maneuverability the influences of those uncertainties were considered in the proposed path following control an adaptive control based line of sight guidance alos was utilized for kinematic control to improve the tracking performance and converging rate where an auxiliary variable was adaptive adjust to the conventional los guidance control an improved artificial potential field iapf was designed to analyze and explicit the output of the alos while it could guarantee a real time convergence to the target path and improve the system robustness the proposed control employed an incremental pid heading control into a dynamic model of the wave glider black pearl which composed a closed loop control for simulations and sea trial experiments furthermore the effectiveness and practicability of the proposed control was verified with a long term sea trial application according to sea trial results and analyses the proposed control could fit the path well with a great lower deviation which cut down about 40 compared with the conventional los path following errors were mostly below 200 m when current velocity was less than 0 25 m s as ocean current velocity increases to a range of 0 25 m s to 0 45 m s and even more bigger the average path errors could be increased to 2 km thus a propeller assisted control to the path following of the wave glider will be considered in future credit authorship contribution statement xiujun sun conceptualization data curation formal analysis funding acquisition ying zhou investigation methodology formal analysis project administration validation visualization writing review editing hongqiang sang formal analysis resources supervision funding acquisition peiyuan yu formal analysis software roles writing original draft shuai zhang formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is supported by major scientific and technological innovation projects of shandong province no 2019jzzy020701 tianjin natural science foundation no 18jczdjc40100 the national key research and development plan of china no 2017yfc0305902 wenhai program of qingdao national laboratory for marine science and technology no 2017whzzb0101 the authors appreciate all staff members in research and development team of the black pearl wave gliders 
21321,when the vivace converter is operated in shallow water the free surface in its proximity plays a critical role in affecting the dynamic response and the consequent energy harvesting performance of the converter in this study a series of experimental tests are conducted for the flow induced vibration of a single cylinder vivace converter in the trsl3 regime with the reynolds number 34 931 r e 116 370 close to a free surface to examine this effect the cylinder is placed beneath the free surface with a gap of 3 0 d where d is the cylinder diameter and free to vibrate in the transverse direction only the virtual damper spring system is adopted to provide the damping and restoring forces the values of the harnessing damping ratio considered are ζ h a r n e s s 0 04 0 08 0 12 0 16 and 0 20 and the spring stiffness ranges from 600 to 1200 n m the amplitude response frequency response harnessed power and energy harnessing efficiency are investigated when the vivace converter is in the vicinity of the free surface the vortex induced vibration viv is initiated at a lower reduced velocity both the viv and galloping regions are enlarged with a smoother transition between the two regimes the harnessed power p h a r n e s s in the viv region is slightly lower while higher p h a r n e s s is found in the galloping region the efficiency of the cylinder near the free surface is lower in the viv region and analogous to that in the deep submerged case when the cylinder is undergoing galloping for a vivace converter placed near the free surface its flow induced vibration fiv and energy conversion features vary similarly with the damping and stiffness parameters to the far away from the free surface configuration overall given that the governing parameters are carefully selected it is viable to use the vivace converter close to the free surface for harnessing the hydrokinetic energy efficiently keywords vivace converter hydrokinetic energy flow induced vibration fiv passive turbulence control ptc free surface nomenclature a a m a x vibration amplitude and maximum vibration amplitude c y hydrodynamic force coefficient c s t r u c t u r e c h a r n e s s c t o t a l structural damping coefficient harnessing damping coefficient and total damping coefficient d diameter of cylinder f f l u i d f v o r t e x f p o t e n t i a l hydrodynamic force vortex force component and potential added mass force f r froude number f n w a t e r natural frequency in water f o s c oscillation frequency f vibration frequency ratio g gravitational acceleration h gap between free surface and cylinder k spring stiffness k average grit height l length of cylinder m a m d m o s c added mass mass of displaced fluid and total mass of oscillating parts m mass ratio p d i s s i p a t e d p h a r n e s s p m e c h dissipated power harnessed power mechanical power converted by vivace p t o t a l total power in flow in terms of area swept by cylinder p sand paper plus tape thickness r e reynolds number t total thickness of ptc t o s c oscillation period t time u freestream velocity v r reduced velocity y y ÿ displacement velocity and acceleration of cylinder in cross flow direction α p t c strip placement angle θ angular coverage of strip ζ s t r u c t u r e ζ h a r n e s s ζ t o t a l structural damping ratio harnessing damping ratio and total damping ratio η h a r n e s s energy harnessing efficiency ν kinematic viscosity of fluid ρ density of fluid ω o s c angular oscillation frequency 1 introduction one of the most pressing technical and economic challenges of our time is how to supply the world with sufficient energy for its economic growth without affecting the earth s climate fossil fuels do not seem to be able to surmount this challenge the greenhouse gases and other pollutants from burning of fossil fuels are hastening the climate change and contaminating the environment in contrast hydrokinetic energy which can be harvested from the flowing water in rivers and oceans is part of an affordable and environmentally friendly solution to meet the growing energy demands khan et al 2009 kumar and sarkar 2016 laws and epps 2016 unlike the conventional hydroelectric plants which usually require dams or penstocks to create an artificial water head hydrokinetic converters have the advantage that they can be constructed without changing the natural pathway of the water stream significantly khan et al 2009 till now various scales of the turbine systems have been successfully developed installed and tested rourke et al 2010 such as the horizontal axis and vertical axis turbines summarised in güney and kaygusuz 2010 these devices operated either standalone or in arrays exhibit many challenges with respect to economic and technical viability as well as environmental impact xiao and zhu 2014 the vast majority of the ocean currents are slower than 1 5 m s and the river streams typically flow at a velocity lower than 1 0 m s yuce and muratoglu 2015 bahaj and myers 2003 schulze et al 2005 however hydrodynamic performances and characteristics of common rotary turbines do not necessarily fit such low flow speed ranges mohammadi et al 2020 in 2006 a device which can convert horizontal hydrokinetic energy to electricity utilising the well known vortex induced vibration viv phenomenon named vivace votex induced vibration aquatic clean energy was developed by bernitsas et al 2006a b and later patented by the university of michigan bernitsas and raghavan 2009 2011 viv was commonly considered to be detrimental for aero civil mechanical marine offshore and nuclear engineering structures erenow one of the research priorities lay in the suppression of viv using different methods and devices rashidi et al 2016 over the past decade bernitsas and his co workers have been working on innovative ways to maximise the effects of viv and harness the destructive power in a controllable manner park et al 2013a ding et al 2016 kinaci et al 2016 the vivace converter can harness energy from flows as slow as 0 4 m s with no upper limit sun et al 2016 it was also found to have the highest power density among the various types of existing technologies for marine renewable energy harnessing narendran et al 2016 which enables low cost energy to be produced from relatively small installations moreover the vivace converter does not suffer from the centrifugal stress associated with the rotating blades and it generates less noise and impact on the environment owing to the lower oscillation speed wang et al 2020 a series of experimental studies have been conducted for the design and testing of the vivace converter raghavan and bernitsas 2011 investigated the effect of the reynolds number r e u d ν where u is the freestream velocity d is the cylinder diameter and ν is the kinematic viscosity of the fluid on viv of an elastically mounted smooth cylinder r e ranged from 2 0 1 0 4 3 5 1 0 5 a response amplitude of 1 9 d was observed even with a high damping being imposed in the aim of enhancing flow induced vibration fiv passive turbulence control ptc was developed by applying turbulence stimulation in a passive way it was found that in the trsl3 regime viv occurred within a certain u range and with the ptc galloping existed beyond the viv range chang et al 2011 the occurrence of galloping roots in the lift instability due to asymmetry normally cylinders with non circular cross sections could be subject to large amplitude galloping oscillations due to their geometric asymmetry with respect to the flow the ptc in the form of roughness strips gives rise to the geometric asymmetry which induces the galloping response therefore it is a particularly useful technology to expand the flow velocity range for energy harvesting in their subsequent research the effects of the mass ratio linear stiffness and linear viscous damping on fiv of a single cylinder or two cylinders with the ptc were also investigated experimentally to obtain higher power and efficiency in hydrokinetic energy conversion sun et al 2016 2017 xu et al 2018 in terms of enhancement of fiv for energy harvesting purposes apart from using the ptc in the trsl3 regime research has also been carried out for different techniques in the trsl2 regime vinod and banerjee 2014 investigated the effectiveness of surface protrusion type modifications to a circular cylinder in augmenting the fiv at 3 1 0 3 r e 3 1 0 4 the surface protrusion configurations like strips were found to be conspicuously effective in enhancing the cylinder vibrations and improving the energy extraction performance in the trsl2 r e regime in contrast to the trsl3 regime where the rough strips are more effective than the smooth strips the experimental results within trsl2 indicated the smooth strips to be a more promising mechanism for fiv enhancement vinod et al 2018 further studied fiv of a circular cylinder fitted with smooth rectangular strip pairs of varying thickness in the trsl2 regime of 1 5 1 0 3 r e 3 1 0 4 their results showed that thicker strips led to higher viv and galloping amplitudes accompanied by an increase in the steadiness within the transition regime it was also observed that galloping was initiated earlier with thicker strips indicating the capability for increased energy transfer at the lower flow speeds assi and bearman 2015 performed experiments on fiv of a circular cylinder fitted with non rotating splitter plates in the r e range of 1500 to 16 000 solid splitter plates were shown to produce severe galloping responses with a maximum attainable amplitude of 1 8 d slotted splitter plates having a porosity ratio of 30 also caused considerable vibration but with a reduced rate of increase with the flow velocity the hydrodynamic mechanism driving the excitation was found to be the reattachment of the free shear layers on the tips of the plates zhu et al 2020a numerically confirmed that the shear layer reattachment mechanism of a downstream splitter plate was effective to excite galloping of a circular cylinder wang et al 2019 proposed the utilisation of y shaped attachments on a circular cylinder to improve the wind energy harvesting performance of a piezoelectric energy harvester in the r e range of 1280 3840 transition from viv to galloping was observed by adding the y shaped attachements to the cylinder the influence of marine fouling on the energy harvesting from viv of a single cylinder at r e 7 8 1 0 3 4 9 1 0 4 was investigated by jadidi and zeinoddini 2020 their test results demonstrated that marine fouling suppressed the viv oscillations and the energy transfer ratio of the biofouled cylinders was around 15 36 below that from the corresponding clean cylinder it was also found that the coverage percentage of the fouling and the fouling irregularity negatively affected the viv hydro energy transfer ratio a more recent study by zhu et al 2020b showed that 30 fin shaped strips or 40 fin shaped strips attached to the front surface could be employed as amplifier in a lower r e range of 60 500 in engineering practice the vivace converter is sometimes placed in shallow water such as in rivers or streams xu et al 2019 in this scenario as the cylinder oscillator is close to a free surface the proximity effect and the froude number f r u g d in which g is the gravitational acceleration play important roles in the fiv and energy harvesting characteristics furthermore the fiv of a single cylinder in the vicinity of a free surface is not only a concern in the design of the vivace converter but also of fundamental research interest from a fluid structure interaction fsi point of view sheridan et al 1997 thoroughly analysed the wake behind a cylinder near a free surface when r e was in the range of 5 99 1 0 3 9 32 1 0 3 it was concluded that the wake states behind the cylinder in close proximity to the free surface were strongly dependent on the variations of f r and the gap ratio h d where h is the gap between the free surface and the centre of gravity of the cylinder a jet like flow was generated by the vorticity from the free surface adjacent to the cylinder surface in the near wake for low h d and or at higher f r for moderate h d saelim 1999 reported the findings from experimental tests for the transverse vibration of a circular cylinder under different submergence depths it was found that for h d 0 5 the lock in range increased and the extended lock in range was hysteretic at the upper end of the lock in region carberry et al 2004 found that when a cylinder was immediately underneath a free surface the attached wake was elongated and the lower shear layer had a distinct downwards angle the free surface appeared to suppress the periodic vortex shedding and the lift traces had only a small fluctuating component the two dimensional flow past a cylinder close to a free surface was numerically studied in reichl et al 2005 for f r between 0 and 0 7 and for h d between 0 1 and 5 0 it was observed that the deformation of the free surface became substantial when f r exceeded 0 3 0 4 as the surface vorticity was directly related to the surface curvature such a high surface deformation resulted in significant surface vorticity which could diffuse and then convect into the main flow changing the development of the strouhal vortices from the top shear layer affecting the wake skewness and suppressing the absolute instability chung 2016 performed numerical simulations of the two degree of freedom viv of a cylinder near a free surface two froude numbers i e f r 0 2 and 0 8 were considered it was reported that for f r 0 2 the lock in range grew with the decrease in h d in contrast at f r 0 8 the lock in range shrunk as h d was reduced from 1 0 to 0 3 more recently capell et al 2019 experimentally investigated the cross flow viv of a flexibly mounted circular cylinder near a free surface two regions of non zero response amplitude were identified in their experiment the first region corresponded to the traditional lock in range that was observed in viv of a fully submerged cylinder the second region only existed when the cylinder was close to the free surface and took place at higher reduced velocities to the best of the authors knowledge there is still a lack of experimental studies about the influence of a free surface on the vivace converter and the impact of the proximity to the free surface on fiv and hydrokinetic energy conversion of the vivace converter is still unrevealed in this paper the fiv characteristics and energy harvesting performance of a single elastically mounted circular cylinder with the ptc are experimentally investigated particular attention is paid to the important aspects including the response amplitudes response frequencies harnessed power and energy harnessing efficiencies the arrangement of the paper is as follows details about the experimental setup are provided in section 2 in section 3 a comparison with a single cylinder vivace converter far away from a free surface is presented section 4 demonstrates fiv and hydrokinetic energy conversion of a single cylinder vivace converter near a free surface with different damping and stiffness parameters and finally this paper is concluded in section 5 2 experimental setup experiments on fiv and energy harnessing of a single cylinder vivace converter are conducted in the low turbulence free surface water ltfsw channel at the marine renewable energy laboratory mrelab of the university of michigan a schematic of the experimental cross section is shown in fig 1 38 000 l of clean water recirculated in the ltfsw channel is impelled by a 20 hp induction motor the maximum flow velocity can reach up to 1 4 m s the flow turbulence intensity is around 0 098 which is acceptable for the experiments walker et al 1996 the dimensions of the main test section are 2 44 m 1 0 m 1 52 m length width depth flow visualisation is realised by two 5 w argon lasers illuminating 100 μ m aluminium oxide seeding particles through the transparent plexiglass of the main test section in this experiment the water depth is set to 1 17 m and the maximum flow velocity is limited to 1 35 m s to avoid potential damages caused by excessive galloping in order to compensate for the major challenges of physical dampers and springs lee et al 2011 and lee and bernitsas 2011 introduced and implemented the first generation of the virtual damper spring vck system the vck system is essentially a feedback loop which uses an optical encoder to record the displacement and velocity of the cylinder and a motor provides the necessary torque to simulate the damping and restoring forces required in the present tests an improved version of the vck system developed by sun et al 2015 is utilised to avoid the bias in fiv and energy harnessing each vck vivace system consists of one vck one interchangeable cylinder moving on submerged roller blocks and driven by the fluid flow and connected to the controller through belts and pulleys an elaborate system identification si process is developed making it possible to calibrate the virtual damping and spring in order to calibrate the torque of motor t m o t o r and voltage output v o u t different weights thus torque are added to capture the referenced voltage based on the motor torque versus voltage calibration variable spring constants are defined the main function of the vck system is to add linear adjustable damping to the system to harness hydrokinetic energy prior to adding the prescribed damping the physical system damping needs to be identified and subtracted the physical system damping is attributed to all the moving parts especially the timing belts and pulleys which bring undesirable excessive amount of nonlinear damping to the vck after subtracting nonlinear viscous damping the virtual linear viscous damping including the harnessing and structural damping c h a r n e s s and c s t r u c t u r e is added in this research c s t r u c t u r e is varied for each mass and stiffness combination to achieve a structural damping ratio of ζ s t r u c t u r e 0 02 programmed stoppers are set when the cylinder reaches the upper and lower ends of the travel to prevent it from piercing the free surface or from collisions with the plexiglass bottom of the ltfsw channel to enhance fiv of the cylinder oscillator and improve the energy harvesting performance of the vivace converter distributed roughness named the ptc is introduced the ptc includes two identical straight roughness strips as demonstrated in fig 1 both strips are attached symmetrically on the surface of the cylinder and parallel to the cylinder axis the thickness of the strips is approximately equal to the boundary layer thickness which makes the ptc profoundly influence the characteristics of the boundary layers and shear layers chang 2010 ding et al 2015 2016 kim and bernitsas 2016 sun et al 2019 the ptc accomplishes the transitions of the boundary and shear layers from laminar to turbulent by increasing the local turbulence intensity in the meanwhile the ptc geometrically produces asymmetry on the cylinder surface with respect to the varying angle of the incident flow and fixes the separations of the boundary layers at the front edges of the strips the combined effects initiate the large amplitude galloping of the cylinder oscillator at a very low reduced velocity kim and bernitsas 2016 according to the previous experimental results of chang et al 2011 and park et al 2013a b strips with commercial roughness designation p60 with a width of 12 7 mm covering 16 on each side of the cylinder are adopted in the present study the placement angle is set at α p t c 2 0 measured from the frontal stagnation point to the leading edge of the ptc strip the location of the ptc belongs to the soft galloping sg zone based on the ptc to fiv map in park et al 2013a b table 1 summarises the details of the roughness strips used in the experimental tests the oscillator in fig 1 is a rigid circular cylinder with diameter d 3 5 in 8 89 cm and length l 35 25 in 0 895 m the total oscillating mass m o s c is made up of the structural mass of the cylinder and the equivalent mass of the transmission belts and pulleys summing up the masses of all the oscillating parts including the vck system gives m o s c 7 286 kg and the mass of the displaced fluid is m d ρ π d 2 l 4 5 425 kg which eventually results in a mass ratio m m o s c m d 1 343 r e lies in the range of 34 931 r e 116 370 belonging to the trsl3 flow regime the cylinder is constrained to oscillate in the cross flow direction perpendicular to its axis and the direction of the flow five different ζ h a r n e s s values are considered in the present tests i e ζ h a r n e s s 0 04 0 08 0 12 0 16 and 0 20 and the designated k is varied from 600 to 1200 n m in this paper the initial gap ratio between the free surface and the centre of gravity of the cylinder is set to h d 3 0 for the fully submerged vivace converter it has been experimentally proved that in the present damping stiffness parameter space the maximum response amplitude ratio a d is 2 5 sun et al 2016 therefore the h d 3 0 gap ratio is selected so that the proximity effect of the free surface is predominant and the cylinder will not pierce the free surface 3 comparison with single cylinder vivace converter far away from free surface 3 1 response amplitudes a series of experiments for a single cylinder vivace converter with the ptc close to a free surface are conducted over different damping stiffness parameters in the mrelab in order to reveal the effect of the free surface tests are also performed for a single cylinder vivace converter with the ptc placed far away from the free surface in the case where the vivace converter is far away from the free surface the virtual spring stiffness is kept constant as k 600 n m while the flow conditions and the rest of the parameters are identical to the near the free surface case the comparisons are presented in figs 2 5 fig 2 exhibits the response amplitudes against the reduced velocity v r u f n w a t e r d where f n w a t e r is the natural frequency in water with different harnessing damping ratios for both cases the amplitude ratio a d of the cylinder is calculated by the average of the 30 largest absolute values in the time history of 60 s approximately 40 peak values are involved in the averaging it can be observed from fig 2 a that for the cylinder far away from the free surface viv initiates at v r 4 27 as ζ h a r n e s s is increased the onset of viv becomes more gradual then the response quickly enters the upper branch of viv at v r 5 25 and maintains the peak value steadily the peak a d in the viv range decreases slightly as ζ h a r n e s s is increased due to the added damping for energy harnessing the shorter error bars in the upper branch of viv indicate that the cylinder vibration is more stable than that in the initial branch the reduced velocity range 7 72 v r 9 36 covers four different regions i e the lower branch of viv the desynchronisation region the gap between viv and galloping and the onset of galloping a higher ζ h a r n e s s corresponds to a wider transition region by shrinking the viv range and delaying the onset of galloping similar phenomenon was also observed by sun et al 2016 and the mechanisms behind were thoroughly explained therein as v r is increased beyond 9 57 the response is in the galloping region where the cylinder is known to undergo large amplitude and low frequency fiv within the galloping region the vibration amplitude of the cylinder increases gradually in most of the range while it reaches a plateau when 11 42 v r 12 24 although the maximum u is constrained in the laboratory tests it can still be inferred that this increasing trend would be maintained steadily with higher flow velocities under real operation conditions for the cylinder near the free surface as shown in fig 2 b viv starts at a slightly lower v r and the width of the viv region is enlarged similar phenomena have also been observed in the previous experiment and numerical simulation by saelim 1999 and chung 2016 indicating that in the current parameter space the presence and deformation of the free surface could help maintain the lock in of the vortex shedding with the oscillations of the cylinder in addition compared to fig 2 a the transition region becomes narrower under the influence of the free surface which expands the flow velocity range for effective hydrokinetic power generation when the cylinder is in proximity to the free surface and subject to fiv wave making phenomenon similar to that in gu et al 2020 is observed and the free surface deformation grows stronger with increasing u gu et al 2020 attributed the wave making phenomenon to the blockage effect and coanda effect compared with the amplitude response for the single cylinder far away from the free surface a d of the cylinder close to the free surface manifests several unique features the peak a d values for both cases in the viv region do not demonstrate obvious differences the peak amplitude ratios in fig 2 a and b reach approximately 0 9 when ζ h a r n e s s 0 04 with an increase in ζ h a r n e s s to 0 20 the peak amplitude ratios experience a slight decrease to around 0 75 in both cases while in the beginning and at the end of the viv region the free surface leads to milder variations of a d with v r in both cases when v r 9 36 the galloping region tags along behind the viv region with an exception at ζ h a r n e s s 0 20 where the amplitude response of the cylinder exhibits an evident transitional behaviour in the v r range corresponding to galloping a d of the cylinder near the free surface is apparently larger than that for the cylinder far away from the free surface it is deduced that the presence and deformation of the free surface strengthen the geometric asymmetry and the consequent instability which enhances the galloping amplitude in the near the free surface case a flattened galloping amplitude response analogous to that in fig 2 a is also observed when the cylinder is in proximity to the free surface although in a lower v r range starting from 10 80 when the instantaneous distance between the cylinder and the free surface is small the vortex shedding is suppressed carberry et al 2004 gu et al 2020 while the ptc on the cylinder surface gives rise to the geometric asymmetry and the consequent instability which causes galloping the plateau of the galloping amplitude could be ascribed to the equilibrium between the suppression effect of the free surface and the galloping instability the instability in the fsi system grows with the increase in v r hence the galloping amplitude starts to build up again once the instability dominates the free surface suppression effect for the single cylinder vivace converter close to the free surface its a d reaches the peak at v r 13 06 thereafter the vibration of the cylinder becomes less drastic and a d reduces slightly this trivial decrease in the galloping amplitude at high v r might be attributed to the suppression of the vortex shedding and the elimination of the periodic fluctuations of the near wake when the cylinder approaches the free surface the influence of the subtle decline in amplitude on the operation of the vivace converter is twofold it lessens the energy harnessed by the converter while protecting the device from immoderate vibrations overall for a single rough circular cylinder near the free surface the widths of the viv and galloping regions are enlarged with a low harnessing damping ratio the oscillation amplitude rises in the transition region as for the galloping region the response amplitude is holistically higher and the increasing trend of the vibration amplitude is maintained until a critical v r the comparison of the amplitude response suggests that under certain circumstances selecting an appropriate submergence depth below the free surface for the vivace converter may contribute to a better energy harvesting performance 3 2 response frequencies the variations of the vibration frequency ratio f f o s c f n with v r for both the far away from and near the free surface cases are presented in fig 3 f o s c is calculated by the fast fourier transform fft of the steady state time history of the cylinder displacement excluding the initial transients as it is shown in fig 3 f is not significantly affected by ζ h a r n e s s except in the transition region sun et al 2016 believed that the latter was caused by the intermittent oscillations in viv desynchronisation and to the occurring gap between viv and galloping in terms of the cylinder placed far away from the free surface in fig 3 a f jumps from 0 to around 1 0 in the initial branch of viv this frequency jump is more sudden for a lower ζ h a r n e s s in the upper branch of viv the frequency responses for different ζ h a r n e s s values share a similar feature i e they increase gradually then reach the peak frequency ratio f 1 38 at v r 6 89 after the peak the frequency responses experience drops symbolising the exits from the upper branch a higher ζ h a r n e s s is associated with a dramatic decline in f and the response enters the transition region at a lower v r in contrast the decreases in f for low ζ h a r n e s s values are not as obvious due to the fact that in these cases the viv region is directly followed by the galloping region in the galloping region f o s c of the cylinder remains steadily close to f n w a t e r regardless of the ζ h a r n e s s value as for the cylinder near the free surface its frequency response depicted in fig 3 b resembles that in fig 3 a apart from the transition region compared with fig 3 a only the frequency response for ζ h a r n e s s 0 20 in the near the free surface case falls significantly at the entrance of the transition region owing to the diminution of the transition region under the free surface effect the variations of f for other ζ h a r n e s s values are rather smooth and nearly collapse into a single curve this feature corresponds to the amplitude responses in the transition region reflecting that the presence of the free surface could suppress the fluctuations in the vibrations and stabilise the transition and thus help improve the performance of the vivace converter 3 3 harnessed power the harnessed power p h a r n e s s versus v r plots for the single cylinder far away from the free surface and the single cylinder near the free surface are shown in fig 4 herein p h a r n e s s is calculated based on eq a 13 for the cylinder far away from the free surface within the viv region a higher ζ h a r n e s s results in higher p h a r n e s s at a lower v r when ζ h a r n e s s 0 04 the reduced velocity corresponding to the highest p h a r n e s s is v r 7 41 as ζ h a r n e s s is increased to 0 20 the highest p h a r n e s s is achieved at v r 6 89 after the peak value p h a r n e s s experiences a significant drop although a higher ζ h a r n e s s prompts a better energy conversion performance in the upper branch of viv the subsequent wider gap between the viv and galloping regions would obliterate its contribution to the overall power generation performance lowering ζ h a r n e s s could bridge the gap of p h a r n e s s in the transition region and improve the energy harvesting in the galloping region the increase in a d as observed in fig 2 a elevates p h a r n e s s steadily a higher ζ h a r n e s s results in more power being converted in this region as mentioned in the previous sections due to the limitations of the experiment apparatus the maximum u in the laboratory is restricted nevertheless judging from the increasing trends one could still expect that more power could be harnessed at higher flow velocities under the real operation conditions fig 4 b presents p h a r n e s s against v r for the single cylinder near the free surface similar characteristics to the curves in fig 4 a are observed for the viv region in spite of the smoother variations by comparing fig 4 a and b it can be seen that the discrepancies in v r associated with the peak power are eliminated as the cylinder approaches the free surface in addition p h a r n e s s is also restrained within the transition region and the suppression in p h a r n e s s is more pronounced for higher ζ h a r n e s s as discussed before the proximity to the free surface links up the viv region with the galloping region and the response of the cylinder enters the galloping region immediately after the lower branch of viv which realises a stable increase in the energy conversion p h a r n e s s in the near the free surface case is higher than that in the far away from the free surface case for v r 13 06 as discussed in section 3 1 the presence and deformation of the free surface would strengthen the geometric asymmetry and hence the galloping instability leading to the higher p h a r n e s s in the galloping range for the cylinder near the free surface overlaps are observed for p h a r n e s s curves with ζ h a r n e s s 0 16 and 0 20 in the meanwhile p h a r n e s s reaches a plateau in the flow velocity range of v r 10 80 11 32 which conforms to the flattened amplitude response in fig 2 b the comparison of p h a r n e s s in both the deep submerged and near the free surface cases suggests that a higher ζ h a r n e s s is conductive to higher p h a r n e s s in the viv and galloping regions when the cylinder oscillator is subject to the effect of the free surface p h a r n e s s in the viv region is slightly lower while lengthening the viv region could offset this negative effect to some extent within the galloping region a careful selection of the v r range can improve the energy harvesting performance these observations are crucial to the successful design of the vivace converter 3 4 energy harnessing efficiencies in this section the proximity effect of the free surface on the energy harnessing efficiency η h a r n e s s computed by eq a 15 is analysed the variations of η h a r n e s s with v r for both the far away from and near the free surface cases are depicted in fig 5 η h a r n e s s increases with the increase in ζ h a r n e s s and the growth rate of η h a r n e s s tapers off as ζ h a r n e s s goes up when the cylinder is located far away from the free surface the maximum η h a r n e s s for ζ h a r n e s s 0 20 reaches approximately 40 of the betz limit at v r 5 25 thereafter it experiences a fall until the response enters the transition region in contrast the maximum η h a r n e s s for ζ h a r n e s s 0 04 is only 10 8 of the betz limit another peak η h a r n e s s occurs at the start of the galloping region and its value is apparently lower than that in the viv region moreover the local optimum of η h a r n e s s does not match with the local optimum of p h a r n e s s the local optimal η h a r n e s s appears at the beginning of the fully developed galloping region while the local optimum of p h a r n e s s is found at the end of the galloping range inside the transition region η h a r n e s s drops to around zero this is consistent with the response amplitudes and harnessed power at transitional reduced velocities in the present experiments the best energy harnessing efficiencies in both the viv and galloping regions are found at ζ h a r n e s s 0 20 however it is also associated with the widest zero efficiency range therefore a proper ζ h a r n e s s needs to be selected to balance these two factors the η h a r n e s s curves for the cylinder in the vicinity of the free surface share similar features to those for the cylinder far away from the free surface for each curve in fig 5 b two peak η h a r n e s s values are observed in the corresponding viv and galloping regions smoother variations are observed in the viv region compared to the case where the cylinder is far away from the free surface which is in accordance with the response amplitudes in fig 2 b and harnessed power in fig 4 b under the free surface effect η h a r n e s s is much lower furthermore for a higher ζ h a r n e s s the maximum η h a r n e s s is achieved at a higher v r when ζ h a r n e s s 0 04 η h a r n e s s reaches its maxima at v r 4 83 whereas the maximum η h a r n e s s is found at v r 5 66 with ζ h a r n e s s 0 20 unlike the curves in fig 5 a which shows a significant drop in the lower branch of viv when the cylinder is near the free surface η h a r n e s s exhibits a steady decrease before the response enters the galloping range it has been mentioned in the previous section that under the free surface effect the width of the viv region is enlarged and the cylinder response does not experience evident desynchronisation before entering the transition region in a sense the presence and deformation of the free surface maintain the viv lock in of the cylinder and this effect contributes to the difference in the variations of η h a r n e s s between the deep submerged case and the near the free surface case inside the galloping region the η h a r n e s s curve for ζ h a r n e s s 0 16 overlaps with the one for ζ h a r n e s s 0 20 indicating that the optimal efficiency of the vck system tested has been reached 4 fiv and energy conversion near free surface with different damping and stiffness section 3 emphasises the effect of the free surface on the response and performance of the single cylinder vivace converter in this section fiv and energy harvesting characteristics of the single cylinder vivace converter near the free surface with different ζ h a r n e s s and k are further investigated ζ h a r n e s s ranges from 0 04 to 0 20 and four different stiffness values are chosen i e k 600 n m 800 n m 1000 n m and 1200 n m important aspects such as the response amplitudes response frequencies harnessed power and energy harnessing efficiencies are presented in figs 6 9 although most of the previous studies used v r to demonstrate the results the results in this section are plotted as functions of r e since varying k causes the variation in the range of v r the same method was used by vinod and banerjee 2014 when comparing the results for different stiffness values 4 1 response amplitudes fig 6 presents a d of a single cylinder near the free surface for various ζ h a r n e s s and k the four response regimes as shown in the previous figures are also observed and the value of k has an evident effect on the initiation of viv for k 600 n m the cylinder starts to oscillate at r e 34 524 with an initial a d around 0 3 as the stiffness is increased to 1200 n m the threshold r e for viv to be induced is delayed to r e 45 146 and the initial a d is approximately 0 therefore a lower k value could arouse a wider lock in range as well as a higher initial a d the same response features were also reported in sun et al 2016 for a fully submerged single cylinder which proves that the proximity to the free surface does not interfere the impact of k on the initiation of fiv as damping is increased the fiv amplitude experiences a decrease for the ζ h a r n e s s and k considered in the present study the maximum a d in the viv region varies from 0 5 to 1 after approaching the end of the viv branch the cylinder responses for different ζ h a r n e s s and k values turn into the transition and galloping regions at similar reynolds numbers around 79 670 and 88 522 respectively within the transition region the cylinder with low ζ h a r n e s s and k values maintains a steady increase in the amplitude while the oscillations for the cases with high ζ h a r n e s s and k are dramatically suppressed despite the differences in the damping and stiffness parameters a d of the cylinder upon most occasions hits the trough at r e 84 096 in the galloping range a d of the cylinder gradually grows with low ζ h a r n e s s and k the maximum a d can reach as large as 2 2 increasing ζ h a r n e s s and k would limit the vibration intensity and constrain the galloping amplitude for ζ h a r n e s s 0 20 and k 1200 n m the maximum a d in the galloping range decreases to around 0 82 for the cases considered in this section the galloping amplitude of the cylinder levels off in the r e range of 92 948 97 374 due to the equilibrium between the suppression effect of the free surface and the galloping instability as discussed in section 3 1 similar to the previous discussions the large amplitude vibration of the cylinder with low ζ h a r n e s s and k might result in it getting close to the free surface and the free surface could inhibit the vortex shedding from the surfaces of the cylinder which causes a decrease in a d at r e 11 685 however in the cases with higher ζ h a r n e s s and k the vibration of the cylinder is largely restricted and this keeps a distance between the cylinder and the free surface so that the vortex shedding suppression effect of the free surface is not as conspicuous 4 2 response frequencies fig 7 illustrates the variations of f with r e for the cylinder near the free surface with different combinations of ζ h a r n e s s and k values it can be seen from the figure that the differences in ζ h a r n e s s nearly have a negligible effect on the frequency responses in the viv and galloping regions for each of the tested k when the cylinder is undergoing viv there exists a slight reduction in the overall f from 1 34 to around 1 10 as the damping and stiffness parameters are increased as r e approaches 80 555 f is subject to a decline representing the transition to the galloping region and this decrease is relevant to both the ζ h a r n e s s and k values with a lower stiffness the sharp drop in f is only observed for the case with ζ h a r n e s s 0 20 increasing k to 1200 n m f starts to fall off noticeably even if ζ h a r n e s s is as low as 0 12 it has been explained in section 3 that the pace of the frequency decline can be controlled by reducing ζ h a r n e s s once r e exceeds 88 522 the frequency responses in all the cases considered in the present study are quite similar with values around 1 0 this observation agrees with those of park et al 2013a b that within the galloping region f o s c of the cylinder coincides with f n w a t e r regardless of ζ h a r n e s s and k 4 3 harnessed power p h a r n e s s of the near the free surface case for different damping stiffness parameters is plotted against r e in fig 8 p h a r n e s s becomes non zero as long as there is fiv and in the cases considered it reaches its first peak value at r e 66 391 despite the ζ h a r n e s s and k values at a specific r e the combination of higher ζ h a r n e s s and k yields higher p h a r n e s s whereas the narrower viv regions for the cases with higher ζ h a r n e s s and k result in steeper peaks of p h a r n e s s in the transition region the response of a cylinder with low ζ h a r n e s s and k enters the galloping region straight after the lower branch of viv leading to a smoothly increasing trend of p h a r n e s s with increases in ζ h a r n e s s and k an apparent boundary appears between the two regimes indicated by a dramatic drop in p h a r n e s s over the transition region at the start of the galloping region the p h a r n e s s curves flatten off when 92 948 r e 97 374 which agrees with the corresponding amplitude responses in fig 6 after the plateau p h a r n e s s grows as r e is increased until reaching its second crest at r e 11 242 a further increase in r e would enhance the free surface effect on vortex shedding with the consequences of suppressing fiv and reducing p h a r n e s s for the r e range tested p h a r n e s s possesses two peak values in the viv and galloping regions respectively it can be observed that the peak p h a r n e s s in the galloping region is considerably higher than the one in the viv region in addition the increase in ζ h a r n e s s and k magnifies the maximum p h a r n e s s in the viv region and in the meanwhile reduces the peak p h a r n e s s for the galloping response consequently the disparity between the two peak values of p h a r n e s s might be reduced by increasing the damping and stiffness of the system the amount of p h a r n e s s is also closely related to ζ h a r n e s s when k is fixed a higher ζ h a r n e s s always corresponds to a higher p h a r n e s s moreover overlaps are observed for the p h a r n e s s values of ζ h a r n e s s 0 16 and 0 20 inside the galloping region increasing k leads to the p h a r n e s s curve at a lower ζ h a r n e s s of 0 12 collapsing to those of ζ h a r n e s s 0 16 and 0 20 it suggests that for a higher k the optimal p h a r n e s s can be achieved with a lower ζ h a r n e s s to sum up the rational coordination between ζ h a r n e s s and k would help the vivace converter adjust its energy harnessing modes more smoothly 4 4 energy harnessing efficiencies in this study what interests us most is η h a r n e s s of the vivace converter when it is placed near the free surface fig 9 presents the variations of η h a r n e s s with r e for different damping stiffness properties η h a r n e s s increases sharply on entering the viv region and it reaches its first maxima at the beginning of the viv upper branch higher ζ h a r n e s s and k shift the peak η h a r n e s s in the viv region to a higher r e for ζ h a r n e s s 0 04 and k 600 n m the highest η h a r n e s s is reached at r e 42 012 with ζ h a r n e s s and k being respectively increased to 0 20 and 1200 n m the peak η h a r n e s s appears at r e 63 258 it can also be observed from fig 9 that the difference in the r e corresponding to the peak η h a r n e s s values for various ζ h a r n e s s gradually disappears as k is increased in the present near the free surface configuration and for the damping stiffness parameters considered the highest η h a r n e s s is around 32 12 of the betz limit which is associated with ζ h a r n e s s 0 20 and k 800 n m once the response is in the transition region the cases with high ζ h a r n e s s and k exhibit a distinct change in η h a r n e s s which is consistent with their amplitude responses in contrast the variations of η h a r n e s s for low ζ h a r n e s s and k are milder although p h a r n e s s undergoes steady increases in the transition region when ζ h a r n e s s and k are low p f l u i d increases exponentially with the increase in r e and it dominates over the increasing trend of p h a r n e s s which leads to the resultant η h a r n e s s in the transition region being lower than that in the viv region for the low ζ h a r n e s s and k cases in the parameter space considered η h a r n e s s nearly remains unchanged for the whole galloping region except for a small decrease when r e 10 623 this decrease can be possibly attributed to the suppression effect caused by the proximity to the free surface and meanwhile the exponentially increased p f l u i d with increasing r e for each of the k values the η h a r n e s s curve of ζ h a r n e s s 0 16 collapses with that of ζ h a r n e s s 0 20 indicating that for the current experimental setup a further increase in ζ h a r n e s s does not contribute to a higher η h a r n e s s when the cylinder is subject to the galloping 5 conclusions the flow induced vibration fiv and hydrokinetic energy conversion of a single cylinder with the passive turbulence control ptc close to a free surface are investigated experimentally in the trsl3 flow regime r e 34 931 116 370 the results including the response amplitudes response frequencies harnessed power and energy harnessing efficiencies are presented and analysed in detail the main findings based on the discussions about the experimental data are summarised as follows for the cylinder near the free surface the vibration can be induced at a lower reduced velocity v r the useful vortex induced vibration viv and galloping ranges are expanded and the free surface makes the transition from the viv to galloping regions more gradual as a result of the proximity to the free surface the harnessed power p h a r n e s s reduces slightly in the viv region whereas it rises in the galloping region when the cylinder is undergoing galloping the free surface effect contributes to a higher p h a r n e s s for v r 13 06 beyond this critical v r the cylinder gets so close to the free surface that the free surface suppresses the vortex shedding and the subsequent oscillation amplitude meanwhile p h a r n e s s is also inhibited a lower energy harnessing efficiency η h a r n e s s is observed in the viv range for the cylinder near the free surface while the η h a r n e s s values in the galloping region share similar features in both the deep submerged and near the free surface cases when the cylinder is placed immediately beneath the free surface with an incipient gap ratio h d of 3 0 the lock in range of viv is widened with a higher initial amplitude ratio a d for a low spring stiffness k for low harnessing damping ratio ζ h a r n e s s and k a steady increase in a d is observed in the transition region whereas a d in the transition range drops dramatically for the cases with high ζ h a r n e s s and k considering each of the tested k ζ h a r n e s s is found to have an almost negligible effect on the frequency response in both the viv and galloping regions the peak p h a r n e s s in the galloping regime is higher than that in the viv region in the viv region higher ζ h a r n e s s and k lead to higher p h a r n e s s while causing a significant drop in p h a r n e s s during the transition from viv to galloping the difference in p h a r n e s s between the viv and galloping ranges can be reduced by increasing ζ h a r n e s s and k the peak η h a r n e s s in the viv region is shifted to a higher r e as ζ h a r n e s s and k is increased at transitional r e milder variations of η h a r n e s s are observed for low ζ h a r n e s s and k the η h a r n e s s curves are rather similar inside the galloping region with a slight decrease in η h a r n e s s at r e 10 623 because of the suppression effect of the free surface and the exponential increase in p f l u i d as r e is increased the variations of the dynamic responses and energy harvesting characteristics of a single cylinder vivace converter near the free surface with ζ h a r n e s s and k qualitatively resemble those for a fully submerged vivace converter in previous publications the present results suggest that it is promising to apply the vivace converters in shallow water near a free surface after a global optimisation of the different governing parameters nevertheless only one gap ratio is considered in this study systematic investigations with various gap ratios harnessing damping ratios and spring stiffnesses will be carried out in the future research credit authorship contribution statement wanhai xu conceptualization investigation formal analysis writing original draft funding acquisition meng yang visualization data curation enhao wang visualization writing review editing funding acquisition hai sun investigation formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors wish to acknowledge professor michael m bernitsas and all the staff from the marine renewable energy laboratory at the university of michigan for providing the excellent facilities and offering the strong support throughout the experiments this research was funded by the national natural science foundation of china grant numbers 51679167 51979193 and 51909189 and the state key laboratory of ocean engineering shanghai jiao tong university grant number 1811 appendix assuming that the flow is in the x direction and the cylinder vibrates in the y direction then the dynamics of the oscillator can be modelled by a second order linear differential equation as follows a 1 m o s c y c t o t a l y k y f f l u i d where y is the cylinder displacement in the cross flow direction and a dot denotes differentiation with respect to time m o s c c t o t a l and k represent the total mass of the oscillating parts the total damping coefficient and the spring stiffness respectively f f l u i d stands for the hydrodynamic force in the transverse direction exerted on the cylinder by the ambient flow according to govardhan and williamson 2000 f f l u i d can be decomposed into the vortex and inviscid components as formulated in sun et al 2016 a 2 f v o r t e x 1 2 c y ρ u 2 d l a 3 f p o t e n t i a l m a y herein c y is the hydrodynamic force coefficient in the cross flow direction and m a is the added mass substituting eqs a 2 and a 3 into eq a 1 and rearranging the equation we obtain a 4 m o s c m a y c t o t a l y k y 2 π d c y m d u 2 for energy conversion from hydrokinetic energy to mechanical energy and later to electrical energy additional harnessing damping c h a r n e s s is considered to mimic a power take off pto system then the total damping coefficient can be defined as a 5 c t o t a l c s t r u c t u r e c h a r n e s s where c s t r u c t u r e is the existing damping losses in the transmission system in the present research c s t r u c t u r e is adjusted by the vck system according to m and k c s t r u c t u r e and c h a r n e s s may be nondimensionalised with respect to the critical damping 2 m o s c m a k a 6 ζ s t r u c t u r e c s t r u c t u r e 2 m o s c m a k a 7 ζ h a r n e s s c h a r n e s s 2 m o s c m a k it is worth noting that in the literature there exists a controversy regarding the value of m a in the equations above there are two approaches available to account for the added mass one is to include the added mass as a constant value based on the potential theory and the other one is to calculate the added mass from the lift force in phase with the acceleration in the y direction vikestad et al 2000 both methods are useful in post processing the data and understanding this intricate phenomenon the interested readers can refer to foulhouxm and bernitsas 1993 for comprehensive explanation to the complex added mass concept as argued by sun et al 2016 and sun and bernitsas 2019 the essential difference between the two methods merely lies in the presentation of the experimental data rather than the physical phenomenon itself therefore following their precedent m a in the present study is computed using the first method the mechanical power converted by the vivace converter is expressed as a 8 p m e c h 1 t o s c 0 t o s c 4 π m o s c m a ζ t o t a l y 2 f n w a t e r d t here t o s c denotes the oscillation period and f n w a t e r 1 2 π k m o s c m a is the natural frequency in water assuming that the cylinder displacement is sinusoidal i e y a sin 2 π f o s c t with a being the vibration amplitude and f o s c 1 t o s c being the oscillation frequency eq a 8 can be simplified into a 9 p m e c h 8 π 3 m o s c m a ζ t o t a l a f o s c 2 f n w a t e r consequently the dissipated and harnessed power are respectively given by a 10 p d i s s i p a t e d 8 π 3 m o s c m a ζ s t r u c t u r e a f o s c 2 f n w a t e r a 11 p h a r n e s s 8 π 3 m o s c m a ζ h a r n e s s a f o s c 2 f n w a t e r since eqs a 10 and a 11 depend explicitly on the added mass these two equations can be rearranged into a 12 p d i s s i p a t e d 1 2 c s t r u c t u r e a 2 ω o s c 2 a 13 p h a r n e s s 1 2 c h a r n e s s a 2 ω o s c 2 where ω o s c is the angular frequency of the oscillation measured by the vck system the total power in the flow in terms of the area swept by the oscillating cylinder can be described as a 14 p f l u i d 1 2 ρ u 3 2 a m a x d l where a m a x represents the largest amplitude of the cylinder oscillator during the whole vibration process the betz limit is the theoretical maximum power that can be extracted from an open flow without any rotation or frictional losses it takes the value of approximately 59 26 16 27 based on the betz limit the energy harnessing efficiency η h a r n e s s is calculated by a 15 η h a r n e s s p h a r n e s s p f l u i d b e t z l i m i t 100 
21321,when the vivace converter is operated in shallow water the free surface in its proximity plays a critical role in affecting the dynamic response and the consequent energy harvesting performance of the converter in this study a series of experimental tests are conducted for the flow induced vibration of a single cylinder vivace converter in the trsl3 regime with the reynolds number 34 931 r e 116 370 close to a free surface to examine this effect the cylinder is placed beneath the free surface with a gap of 3 0 d where d is the cylinder diameter and free to vibrate in the transverse direction only the virtual damper spring system is adopted to provide the damping and restoring forces the values of the harnessing damping ratio considered are ζ h a r n e s s 0 04 0 08 0 12 0 16 and 0 20 and the spring stiffness ranges from 600 to 1200 n m the amplitude response frequency response harnessed power and energy harnessing efficiency are investigated when the vivace converter is in the vicinity of the free surface the vortex induced vibration viv is initiated at a lower reduced velocity both the viv and galloping regions are enlarged with a smoother transition between the two regimes the harnessed power p h a r n e s s in the viv region is slightly lower while higher p h a r n e s s is found in the galloping region the efficiency of the cylinder near the free surface is lower in the viv region and analogous to that in the deep submerged case when the cylinder is undergoing galloping for a vivace converter placed near the free surface its flow induced vibration fiv and energy conversion features vary similarly with the damping and stiffness parameters to the far away from the free surface configuration overall given that the governing parameters are carefully selected it is viable to use the vivace converter close to the free surface for harnessing the hydrokinetic energy efficiently keywords vivace converter hydrokinetic energy flow induced vibration fiv passive turbulence control ptc free surface nomenclature a a m a x vibration amplitude and maximum vibration amplitude c y hydrodynamic force coefficient c s t r u c t u r e c h a r n e s s c t o t a l structural damping coefficient harnessing damping coefficient and total damping coefficient d diameter of cylinder f f l u i d f v o r t e x f p o t e n t i a l hydrodynamic force vortex force component and potential added mass force f r froude number f n w a t e r natural frequency in water f o s c oscillation frequency f vibration frequency ratio g gravitational acceleration h gap between free surface and cylinder k spring stiffness k average grit height l length of cylinder m a m d m o s c added mass mass of displaced fluid and total mass of oscillating parts m mass ratio p d i s s i p a t e d p h a r n e s s p m e c h dissipated power harnessed power mechanical power converted by vivace p t o t a l total power in flow in terms of area swept by cylinder p sand paper plus tape thickness r e reynolds number t total thickness of ptc t o s c oscillation period t time u freestream velocity v r reduced velocity y y ÿ displacement velocity and acceleration of cylinder in cross flow direction α p t c strip placement angle θ angular coverage of strip ζ s t r u c t u r e ζ h a r n e s s ζ t o t a l structural damping ratio harnessing damping ratio and total damping ratio η h a r n e s s energy harnessing efficiency ν kinematic viscosity of fluid ρ density of fluid ω o s c angular oscillation frequency 1 introduction one of the most pressing technical and economic challenges of our time is how to supply the world with sufficient energy for its economic growth without affecting the earth s climate fossil fuels do not seem to be able to surmount this challenge the greenhouse gases and other pollutants from burning of fossil fuels are hastening the climate change and contaminating the environment in contrast hydrokinetic energy which can be harvested from the flowing water in rivers and oceans is part of an affordable and environmentally friendly solution to meet the growing energy demands khan et al 2009 kumar and sarkar 2016 laws and epps 2016 unlike the conventional hydroelectric plants which usually require dams or penstocks to create an artificial water head hydrokinetic converters have the advantage that they can be constructed without changing the natural pathway of the water stream significantly khan et al 2009 till now various scales of the turbine systems have been successfully developed installed and tested rourke et al 2010 such as the horizontal axis and vertical axis turbines summarised in güney and kaygusuz 2010 these devices operated either standalone or in arrays exhibit many challenges with respect to economic and technical viability as well as environmental impact xiao and zhu 2014 the vast majority of the ocean currents are slower than 1 5 m s and the river streams typically flow at a velocity lower than 1 0 m s yuce and muratoglu 2015 bahaj and myers 2003 schulze et al 2005 however hydrodynamic performances and characteristics of common rotary turbines do not necessarily fit such low flow speed ranges mohammadi et al 2020 in 2006 a device which can convert horizontal hydrokinetic energy to electricity utilising the well known vortex induced vibration viv phenomenon named vivace votex induced vibration aquatic clean energy was developed by bernitsas et al 2006a b and later patented by the university of michigan bernitsas and raghavan 2009 2011 viv was commonly considered to be detrimental for aero civil mechanical marine offshore and nuclear engineering structures erenow one of the research priorities lay in the suppression of viv using different methods and devices rashidi et al 2016 over the past decade bernitsas and his co workers have been working on innovative ways to maximise the effects of viv and harness the destructive power in a controllable manner park et al 2013a ding et al 2016 kinaci et al 2016 the vivace converter can harness energy from flows as slow as 0 4 m s with no upper limit sun et al 2016 it was also found to have the highest power density among the various types of existing technologies for marine renewable energy harnessing narendran et al 2016 which enables low cost energy to be produced from relatively small installations moreover the vivace converter does not suffer from the centrifugal stress associated with the rotating blades and it generates less noise and impact on the environment owing to the lower oscillation speed wang et al 2020 a series of experimental studies have been conducted for the design and testing of the vivace converter raghavan and bernitsas 2011 investigated the effect of the reynolds number r e u d ν where u is the freestream velocity d is the cylinder diameter and ν is the kinematic viscosity of the fluid on viv of an elastically mounted smooth cylinder r e ranged from 2 0 1 0 4 3 5 1 0 5 a response amplitude of 1 9 d was observed even with a high damping being imposed in the aim of enhancing flow induced vibration fiv passive turbulence control ptc was developed by applying turbulence stimulation in a passive way it was found that in the trsl3 regime viv occurred within a certain u range and with the ptc galloping existed beyond the viv range chang et al 2011 the occurrence of galloping roots in the lift instability due to asymmetry normally cylinders with non circular cross sections could be subject to large amplitude galloping oscillations due to their geometric asymmetry with respect to the flow the ptc in the form of roughness strips gives rise to the geometric asymmetry which induces the galloping response therefore it is a particularly useful technology to expand the flow velocity range for energy harvesting in their subsequent research the effects of the mass ratio linear stiffness and linear viscous damping on fiv of a single cylinder or two cylinders with the ptc were also investigated experimentally to obtain higher power and efficiency in hydrokinetic energy conversion sun et al 2016 2017 xu et al 2018 in terms of enhancement of fiv for energy harvesting purposes apart from using the ptc in the trsl3 regime research has also been carried out for different techniques in the trsl2 regime vinod and banerjee 2014 investigated the effectiveness of surface protrusion type modifications to a circular cylinder in augmenting the fiv at 3 1 0 3 r e 3 1 0 4 the surface protrusion configurations like strips were found to be conspicuously effective in enhancing the cylinder vibrations and improving the energy extraction performance in the trsl2 r e regime in contrast to the trsl3 regime where the rough strips are more effective than the smooth strips the experimental results within trsl2 indicated the smooth strips to be a more promising mechanism for fiv enhancement vinod et al 2018 further studied fiv of a circular cylinder fitted with smooth rectangular strip pairs of varying thickness in the trsl2 regime of 1 5 1 0 3 r e 3 1 0 4 their results showed that thicker strips led to higher viv and galloping amplitudes accompanied by an increase in the steadiness within the transition regime it was also observed that galloping was initiated earlier with thicker strips indicating the capability for increased energy transfer at the lower flow speeds assi and bearman 2015 performed experiments on fiv of a circular cylinder fitted with non rotating splitter plates in the r e range of 1500 to 16 000 solid splitter plates were shown to produce severe galloping responses with a maximum attainable amplitude of 1 8 d slotted splitter plates having a porosity ratio of 30 also caused considerable vibration but with a reduced rate of increase with the flow velocity the hydrodynamic mechanism driving the excitation was found to be the reattachment of the free shear layers on the tips of the plates zhu et al 2020a numerically confirmed that the shear layer reattachment mechanism of a downstream splitter plate was effective to excite galloping of a circular cylinder wang et al 2019 proposed the utilisation of y shaped attachments on a circular cylinder to improve the wind energy harvesting performance of a piezoelectric energy harvester in the r e range of 1280 3840 transition from viv to galloping was observed by adding the y shaped attachements to the cylinder the influence of marine fouling on the energy harvesting from viv of a single cylinder at r e 7 8 1 0 3 4 9 1 0 4 was investigated by jadidi and zeinoddini 2020 their test results demonstrated that marine fouling suppressed the viv oscillations and the energy transfer ratio of the biofouled cylinders was around 15 36 below that from the corresponding clean cylinder it was also found that the coverage percentage of the fouling and the fouling irregularity negatively affected the viv hydro energy transfer ratio a more recent study by zhu et al 2020b showed that 30 fin shaped strips or 40 fin shaped strips attached to the front surface could be employed as amplifier in a lower r e range of 60 500 in engineering practice the vivace converter is sometimes placed in shallow water such as in rivers or streams xu et al 2019 in this scenario as the cylinder oscillator is close to a free surface the proximity effect and the froude number f r u g d in which g is the gravitational acceleration play important roles in the fiv and energy harvesting characteristics furthermore the fiv of a single cylinder in the vicinity of a free surface is not only a concern in the design of the vivace converter but also of fundamental research interest from a fluid structure interaction fsi point of view sheridan et al 1997 thoroughly analysed the wake behind a cylinder near a free surface when r e was in the range of 5 99 1 0 3 9 32 1 0 3 it was concluded that the wake states behind the cylinder in close proximity to the free surface were strongly dependent on the variations of f r and the gap ratio h d where h is the gap between the free surface and the centre of gravity of the cylinder a jet like flow was generated by the vorticity from the free surface adjacent to the cylinder surface in the near wake for low h d and or at higher f r for moderate h d saelim 1999 reported the findings from experimental tests for the transverse vibration of a circular cylinder under different submergence depths it was found that for h d 0 5 the lock in range increased and the extended lock in range was hysteretic at the upper end of the lock in region carberry et al 2004 found that when a cylinder was immediately underneath a free surface the attached wake was elongated and the lower shear layer had a distinct downwards angle the free surface appeared to suppress the periodic vortex shedding and the lift traces had only a small fluctuating component the two dimensional flow past a cylinder close to a free surface was numerically studied in reichl et al 2005 for f r between 0 and 0 7 and for h d between 0 1 and 5 0 it was observed that the deformation of the free surface became substantial when f r exceeded 0 3 0 4 as the surface vorticity was directly related to the surface curvature such a high surface deformation resulted in significant surface vorticity which could diffuse and then convect into the main flow changing the development of the strouhal vortices from the top shear layer affecting the wake skewness and suppressing the absolute instability chung 2016 performed numerical simulations of the two degree of freedom viv of a cylinder near a free surface two froude numbers i e f r 0 2 and 0 8 were considered it was reported that for f r 0 2 the lock in range grew with the decrease in h d in contrast at f r 0 8 the lock in range shrunk as h d was reduced from 1 0 to 0 3 more recently capell et al 2019 experimentally investigated the cross flow viv of a flexibly mounted circular cylinder near a free surface two regions of non zero response amplitude were identified in their experiment the first region corresponded to the traditional lock in range that was observed in viv of a fully submerged cylinder the second region only existed when the cylinder was close to the free surface and took place at higher reduced velocities to the best of the authors knowledge there is still a lack of experimental studies about the influence of a free surface on the vivace converter and the impact of the proximity to the free surface on fiv and hydrokinetic energy conversion of the vivace converter is still unrevealed in this paper the fiv characteristics and energy harvesting performance of a single elastically mounted circular cylinder with the ptc are experimentally investigated particular attention is paid to the important aspects including the response amplitudes response frequencies harnessed power and energy harnessing efficiencies the arrangement of the paper is as follows details about the experimental setup are provided in section 2 in section 3 a comparison with a single cylinder vivace converter far away from a free surface is presented section 4 demonstrates fiv and hydrokinetic energy conversion of a single cylinder vivace converter near a free surface with different damping and stiffness parameters and finally this paper is concluded in section 5 2 experimental setup experiments on fiv and energy harnessing of a single cylinder vivace converter are conducted in the low turbulence free surface water ltfsw channel at the marine renewable energy laboratory mrelab of the university of michigan a schematic of the experimental cross section is shown in fig 1 38 000 l of clean water recirculated in the ltfsw channel is impelled by a 20 hp induction motor the maximum flow velocity can reach up to 1 4 m s the flow turbulence intensity is around 0 098 which is acceptable for the experiments walker et al 1996 the dimensions of the main test section are 2 44 m 1 0 m 1 52 m length width depth flow visualisation is realised by two 5 w argon lasers illuminating 100 μ m aluminium oxide seeding particles through the transparent plexiglass of the main test section in this experiment the water depth is set to 1 17 m and the maximum flow velocity is limited to 1 35 m s to avoid potential damages caused by excessive galloping in order to compensate for the major challenges of physical dampers and springs lee et al 2011 and lee and bernitsas 2011 introduced and implemented the first generation of the virtual damper spring vck system the vck system is essentially a feedback loop which uses an optical encoder to record the displacement and velocity of the cylinder and a motor provides the necessary torque to simulate the damping and restoring forces required in the present tests an improved version of the vck system developed by sun et al 2015 is utilised to avoid the bias in fiv and energy harnessing each vck vivace system consists of one vck one interchangeable cylinder moving on submerged roller blocks and driven by the fluid flow and connected to the controller through belts and pulleys an elaborate system identification si process is developed making it possible to calibrate the virtual damping and spring in order to calibrate the torque of motor t m o t o r and voltage output v o u t different weights thus torque are added to capture the referenced voltage based on the motor torque versus voltage calibration variable spring constants are defined the main function of the vck system is to add linear adjustable damping to the system to harness hydrokinetic energy prior to adding the prescribed damping the physical system damping needs to be identified and subtracted the physical system damping is attributed to all the moving parts especially the timing belts and pulleys which bring undesirable excessive amount of nonlinear damping to the vck after subtracting nonlinear viscous damping the virtual linear viscous damping including the harnessing and structural damping c h a r n e s s and c s t r u c t u r e is added in this research c s t r u c t u r e is varied for each mass and stiffness combination to achieve a structural damping ratio of ζ s t r u c t u r e 0 02 programmed stoppers are set when the cylinder reaches the upper and lower ends of the travel to prevent it from piercing the free surface or from collisions with the plexiglass bottom of the ltfsw channel to enhance fiv of the cylinder oscillator and improve the energy harvesting performance of the vivace converter distributed roughness named the ptc is introduced the ptc includes two identical straight roughness strips as demonstrated in fig 1 both strips are attached symmetrically on the surface of the cylinder and parallel to the cylinder axis the thickness of the strips is approximately equal to the boundary layer thickness which makes the ptc profoundly influence the characteristics of the boundary layers and shear layers chang 2010 ding et al 2015 2016 kim and bernitsas 2016 sun et al 2019 the ptc accomplishes the transitions of the boundary and shear layers from laminar to turbulent by increasing the local turbulence intensity in the meanwhile the ptc geometrically produces asymmetry on the cylinder surface with respect to the varying angle of the incident flow and fixes the separations of the boundary layers at the front edges of the strips the combined effects initiate the large amplitude galloping of the cylinder oscillator at a very low reduced velocity kim and bernitsas 2016 according to the previous experimental results of chang et al 2011 and park et al 2013a b strips with commercial roughness designation p60 with a width of 12 7 mm covering 16 on each side of the cylinder are adopted in the present study the placement angle is set at α p t c 2 0 measured from the frontal stagnation point to the leading edge of the ptc strip the location of the ptc belongs to the soft galloping sg zone based on the ptc to fiv map in park et al 2013a b table 1 summarises the details of the roughness strips used in the experimental tests the oscillator in fig 1 is a rigid circular cylinder with diameter d 3 5 in 8 89 cm and length l 35 25 in 0 895 m the total oscillating mass m o s c is made up of the structural mass of the cylinder and the equivalent mass of the transmission belts and pulleys summing up the masses of all the oscillating parts including the vck system gives m o s c 7 286 kg and the mass of the displaced fluid is m d ρ π d 2 l 4 5 425 kg which eventually results in a mass ratio m m o s c m d 1 343 r e lies in the range of 34 931 r e 116 370 belonging to the trsl3 flow regime the cylinder is constrained to oscillate in the cross flow direction perpendicular to its axis and the direction of the flow five different ζ h a r n e s s values are considered in the present tests i e ζ h a r n e s s 0 04 0 08 0 12 0 16 and 0 20 and the designated k is varied from 600 to 1200 n m in this paper the initial gap ratio between the free surface and the centre of gravity of the cylinder is set to h d 3 0 for the fully submerged vivace converter it has been experimentally proved that in the present damping stiffness parameter space the maximum response amplitude ratio a d is 2 5 sun et al 2016 therefore the h d 3 0 gap ratio is selected so that the proximity effect of the free surface is predominant and the cylinder will not pierce the free surface 3 comparison with single cylinder vivace converter far away from free surface 3 1 response amplitudes a series of experiments for a single cylinder vivace converter with the ptc close to a free surface are conducted over different damping stiffness parameters in the mrelab in order to reveal the effect of the free surface tests are also performed for a single cylinder vivace converter with the ptc placed far away from the free surface in the case where the vivace converter is far away from the free surface the virtual spring stiffness is kept constant as k 600 n m while the flow conditions and the rest of the parameters are identical to the near the free surface case the comparisons are presented in figs 2 5 fig 2 exhibits the response amplitudes against the reduced velocity v r u f n w a t e r d where f n w a t e r is the natural frequency in water with different harnessing damping ratios for both cases the amplitude ratio a d of the cylinder is calculated by the average of the 30 largest absolute values in the time history of 60 s approximately 40 peak values are involved in the averaging it can be observed from fig 2 a that for the cylinder far away from the free surface viv initiates at v r 4 27 as ζ h a r n e s s is increased the onset of viv becomes more gradual then the response quickly enters the upper branch of viv at v r 5 25 and maintains the peak value steadily the peak a d in the viv range decreases slightly as ζ h a r n e s s is increased due to the added damping for energy harnessing the shorter error bars in the upper branch of viv indicate that the cylinder vibration is more stable than that in the initial branch the reduced velocity range 7 72 v r 9 36 covers four different regions i e the lower branch of viv the desynchronisation region the gap between viv and galloping and the onset of galloping a higher ζ h a r n e s s corresponds to a wider transition region by shrinking the viv range and delaying the onset of galloping similar phenomenon was also observed by sun et al 2016 and the mechanisms behind were thoroughly explained therein as v r is increased beyond 9 57 the response is in the galloping region where the cylinder is known to undergo large amplitude and low frequency fiv within the galloping region the vibration amplitude of the cylinder increases gradually in most of the range while it reaches a plateau when 11 42 v r 12 24 although the maximum u is constrained in the laboratory tests it can still be inferred that this increasing trend would be maintained steadily with higher flow velocities under real operation conditions for the cylinder near the free surface as shown in fig 2 b viv starts at a slightly lower v r and the width of the viv region is enlarged similar phenomena have also been observed in the previous experiment and numerical simulation by saelim 1999 and chung 2016 indicating that in the current parameter space the presence and deformation of the free surface could help maintain the lock in of the vortex shedding with the oscillations of the cylinder in addition compared to fig 2 a the transition region becomes narrower under the influence of the free surface which expands the flow velocity range for effective hydrokinetic power generation when the cylinder is in proximity to the free surface and subject to fiv wave making phenomenon similar to that in gu et al 2020 is observed and the free surface deformation grows stronger with increasing u gu et al 2020 attributed the wave making phenomenon to the blockage effect and coanda effect compared with the amplitude response for the single cylinder far away from the free surface a d of the cylinder close to the free surface manifests several unique features the peak a d values for both cases in the viv region do not demonstrate obvious differences the peak amplitude ratios in fig 2 a and b reach approximately 0 9 when ζ h a r n e s s 0 04 with an increase in ζ h a r n e s s to 0 20 the peak amplitude ratios experience a slight decrease to around 0 75 in both cases while in the beginning and at the end of the viv region the free surface leads to milder variations of a d with v r in both cases when v r 9 36 the galloping region tags along behind the viv region with an exception at ζ h a r n e s s 0 20 where the amplitude response of the cylinder exhibits an evident transitional behaviour in the v r range corresponding to galloping a d of the cylinder near the free surface is apparently larger than that for the cylinder far away from the free surface it is deduced that the presence and deformation of the free surface strengthen the geometric asymmetry and the consequent instability which enhances the galloping amplitude in the near the free surface case a flattened galloping amplitude response analogous to that in fig 2 a is also observed when the cylinder is in proximity to the free surface although in a lower v r range starting from 10 80 when the instantaneous distance between the cylinder and the free surface is small the vortex shedding is suppressed carberry et al 2004 gu et al 2020 while the ptc on the cylinder surface gives rise to the geometric asymmetry and the consequent instability which causes galloping the plateau of the galloping amplitude could be ascribed to the equilibrium between the suppression effect of the free surface and the galloping instability the instability in the fsi system grows with the increase in v r hence the galloping amplitude starts to build up again once the instability dominates the free surface suppression effect for the single cylinder vivace converter close to the free surface its a d reaches the peak at v r 13 06 thereafter the vibration of the cylinder becomes less drastic and a d reduces slightly this trivial decrease in the galloping amplitude at high v r might be attributed to the suppression of the vortex shedding and the elimination of the periodic fluctuations of the near wake when the cylinder approaches the free surface the influence of the subtle decline in amplitude on the operation of the vivace converter is twofold it lessens the energy harnessed by the converter while protecting the device from immoderate vibrations overall for a single rough circular cylinder near the free surface the widths of the viv and galloping regions are enlarged with a low harnessing damping ratio the oscillation amplitude rises in the transition region as for the galloping region the response amplitude is holistically higher and the increasing trend of the vibration amplitude is maintained until a critical v r the comparison of the amplitude response suggests that under certain circumstances selecting an appropriate submergence depth below the free surface for the vivace converter may contribute to a better energy harvesting performance 3 2 response frequencies the variations of the vibration frequency ratio f f o s c f n with v r for both the far away from and near the free surface cases are presented in fig 3 f o s c is calculated by the fast fourier transform fft of the steady state time history of the cylinder displacement excluding the initial transients as it is shown in fig 3 f is not significantly affected by ζ h a r n e s s except in the transition region sun et al 2016 believed that the latter was caused by the intermittent oscillations in viv desynchronisation and to the occurring gap between viv and galloping in terms of the cylinder placed far away from the free surface in fig 3 a f jumps from 0 to around 1 0 in the initial branch of viv this frequency jump is more sudden for a lower ζ h a r n e s s in the upper branch of viv the frequency responses for different ζ h a r n e s s values share a similar feature i e they increase gradually then reach the peak frequency ratio f 1 38 at v r 6 89 after the peak the frequency responses experience drops symbolising the exits from the upper branch a higher ζ h a r n e s s is associated with a dramatic decline in f and the response enters the transition region at a lower v r in contrast the decreases in f for low ζ h a r n e s s values are not as obvious due to the fact that in these cases the viv region is directly followed by the galloping region in the galloping region f o s c of the cylinder remains steadily close to f n w a t e r regardless of the ζ h a r n e s s value as for the cylinder near the free surface its frequency response depicted in fig 3 b resembles that in fig 3 a apart from the transition region compared with fig 3 a only the frequency response for ζ h a r n e s s 0 20 in the near the free surface case falls significantly at the entrance of the transition region owing to the diminution of the transition region under the free surface effect the variations of f for other ζ h a r n e s s values are rather smooth and nearly collapse into a single curve this feature corresponds to the amplitude responses in the transition region reflecting that the presence of the free surface could suppress the fluctuations in the vibrations and stabilise the transition and thus help improve the performance of the vivace converter 3 3 harnessed power the harnessed power p h a r n e s s versus v r plots for the single cylinder far away from the free surface and the single cylinder near the free surface are shown in fig 4 herein p h a r n e s s is calculated based on eq a 13 for the cylinder far away from the free surface within the viv region a higher ζ h a r n e s s results in higher p h a r n e s s at a lower v r when ζ h a r n e s s 0 04 the reduced velocity corresponding to the highest p h a r n e s s is v r 7 41 as ζ h a r n e s s is increased to 0 20 the highest p h a r n e s s is achieved at v r 6 89 after the peak value p h a r n e s s experiences a significant drop although a higher ζ h a r n e s s prompts a better energy conversion performance in the upper branch of viv the subsequent wider gap between the viv and galloping regions would obliterate its contribution to the overall power generation performance lowering ζ h a r n e s s could bridge the gap of p h a r n e s s in the transition region and improve the energy harvesting in the galloping region the increase in a d as observed in fig 2 a elevates p h a r n e s s steadily a higher ζ h a r n e s s results in more power being converted in this region as mentioned in the previous sections due to the limitations of the experiment apparatus the maximum u in the laboratory is restricted nevertheless judging from the increasing trends one could still expect that more power could be harnessed at higher flow velocities under the real operation conditions fig 4 b presents p h a r n e s s against v r for the single cylinder near the free surface similar characteristics to the curves in fig 4 a are observed for the viv region in spite of the smoother variations by comparing fig 4 a and b it can be seen that the discrepancies in v r associated with the peak power are eliminated as the cylinder approaches the free surface in addition p h a r n e s s is also restrained within the transition region and the suppression in p h a r n e s s is more pronounced for higher ζ h a r n e s s as discussed before the proximity to the free surface links up the viv region with the galloping region and the response of the cylinder enters the galloping region immediately after the lower branch of viv which realises a stable increase in the energy conversion p h a r n e s s in the near the free surface case is higher than that in the far away from the free surface case for v r 13 06 as discussed in section 3 1 the presence and deformation of the free surface would strengthen the geometric asymmetry and hence the galloping instability leading to the higher p h a r n e s s in the galloping range for the cylinder near the free surface overlaps are observed for p h a r n e s s curves with ζ h a r n e s s 0 16 and 0 20 in the meanwhile p h a r n e s s reaches a plateau in the flow velocity range of v r 10 80 11 32 which conforms to the flattened amplitude response in fig 2 b the comparison of p h a r n e s s in both the deep submerged and near the free surface cases suggests that a higher ζ h a r n e s s is conductive to higher p h a r n e s s in the viv and galloping regions when the cylinder oscillator is subject to the effect of the free surface p h a r n e s s in the viv region is slightly lower while lengthening the viv region could offset this negative effect to some extent within the galloping region a careful selection of the v r range can improve the energy harvesting performance these observations are crucial to the successful design of the vivace converter 3 4 energy harnessing efficiencies in this section the proximity effect of the free surface on the energy harnessing efficiency η h a r n e s s computed by eq a 15 is analysed the variations of η h a r n e s s with v r for both the far away from and near the free surface cases are depicted in fig 5 η h a r n e s s increases with the increase in ζ h a r n e s s and the growth rate of η h a r n e s s tapers off as ζ h a r n e s s goes up when the cylinder is located far away from the free surface the maximum η h a r n e s s for ζ h a r n e s s 0 20 reaches approximately 40 of the betz limit at v r 5 25 thereafter it experiences a fall until the response enters the transition region in contrast the maximum η h a r n e s s for ζ h a r n e s s 0 04 is only 10 8 of the betz limit another peak η h a r n e s s occurs at the start of the galloping region and its value is apparently lower than that in the viv region moreover the local optimum of η h a r n e s s does not match with the local optimum of p h a r n e s s the local optimal η h a r n e s s appears at the beginning of the fully developed galloping region while the local optimum of p h a r n e s s is found at the end of the galloping range inside the transition region η h a r n e s s drops to around zero this is consistent with the response amplitudes and harnessed power at transitional reduced velocities in the present experiments the best energy harnessing efficiencies in both the viv and galloping regions are found at ζ h a r n e s s 0 20 however it is also associated with the widest zero efficiency range therefore a proper ζ h a r n e s s needs to be selected to balance these two factors the η h a r n e s s curves for the cylinder in the vicinity of the free surface share similar features to those for the cylinder far away from the free surface for each curve in fig 5 b two peak η h a r n e s s values are observed in the corresponding viv and galloping regions smoother variations are observed in the viv region compared to the case where the cylinder is far away from the free surface which is in accordance with the response amplitudes in fig 2 b and harnessed power in fig 4 b under the free surface effect η h a r n e s s is much lower furthermore for a higher ζ h a r n e s s the maximum η h a r n e s s is achieved at a higher v r when ζ h a r n e s s 0 04 η h a r n e s s reaches its maxima at v r 4 83 whereas the maximum η h a r n e s s is found at v r 5 66 with ζ h a r n e s s 0 20 unlike the curves in fig 5 a which shows a significant drop in the lower branch of viv when the cylinder is near the free surface η h a r n e s s exhibits a steady decrease before the response enters the galloping range it has been mentioned in the previous section that under the free surface effect the width of the viv region is enlarged and the cylinder response does not experience evident desynchronisation before entering the transition region in a sense the presence and deformation of the free surface maintain the viv lock in of the cylinder and this effect contributes to the difference in the variations of η h a r n e s s between the deep submerged case and the near the free surface case inside the galloping region the η h a r n e s s curve for ζ h a r n e s s 0 16 overlaps with the one for ζ h a r n e s s 0 20 indicating that the optimal efficiency of the vck system tested has been reached 4 fiv and energy conversion near free surface with different damping and stiffness section 3 emphasises the effect of the free surface on the response and performance of the single cylinder vivace converter in this section fiv and energy harvesting characteristics of the single cylinder vivace converter near the free surface with different ζ h a r n e s s and k are further investigated ζ h a r n e s s ranges from 0 04 to 0 20 and four different stiffness values are chosen i e k 600 n m 800 n m 1000 n m and 1200 n m important aspects such as the response amplitudes response frequencies harnessed power and energy harnessing efficiencies are presented in figs 6 9 although most of the previous studies used v r to demonstrate the results the results in this section are plotted as functions of r e since varying k causes the variation in the range of v r the same method was used by vinod and banerjee 2014 when comparing the results for different stiffness values 4 1 response amplitudes fig 6 presents a d of a single cylinder near the free surface for various ζ h a r n e s s and k the four response regimes as shown in the previous figures are also observed and the value of k has an evident effect on the initiation of viv for k 600 n m the cylinder starts to oscillate at r e 34 524 with an initial a d around 0 3 as the stiffness is increased to 1200 n m the threshold r e for viv to be induced is delayed to r e 45 146 and the initial a d is approximately 0 therefore a lower k value could arouse a wider lock in range as well as a higher initial a d the same response features were also reported in sun et al 2016 for a fully submerged single cylinder which proves that the proximity to the free surface does not interfere the impact of k on the initiation of fiv as damping is increased the fiv amplitude experiences a decrease for the ζ h a r n e s s and k considered in the present study the maximum a d in the viv region varies from 0 5 to 1 after approaching the end of the viv branch the cylinder responses for different ζ h a r n e s s and k values turn into the transition and galloping regions at similar reynolds numbers around 79 670 and 88 522 respectively within the transition region the cylinder with low ζ h a r n e s s and k values maintains a steady increase in the amplitude while the oscillations for the cases with high ζ h a r n e s s and k are dramatically suppressed despite the differences in the damping and stiffness parameters a d of the cylinder upon most occasions hits the trough at r e 84 096 in the galloping range a d of the cylinder gradually grows with low ζ h a r n e s s and k the maximum a d can reach as large as 2 2 increasing ζ h a r n e s s and k would limit the vibration intensity and constrain the galloping amplitude for ζ h a r n e s s 0 20 and k 1200 n m the maximum a d in the galloping range decreases to around 0 82 for the cases considered in this section the galloping amplitude of the cylinder levels off in the r e range of 92 948 97 374 due to the equilibrium between the suppression effect of the free surface and the galloping instability as discussed in section 3 1 similar to the previous discussions the large amplitude vibration of the cylinder with low ζ h a r n e s s and k might result in it getting close to the free surface and the free surface could inhibit the vortex shedding from the surfaces of the cylinder which causes a decrease in a d at r e 11 685 however in the cases with higher ζ h a r n e s s and k the vibration of the cylinder is largely restricted and this keeps a distance between the cylinder and the free surface so that the vortex shedding suppression effect of the free surface is not as conspicuous 4 2 response frequencies fig 7 illustrates the variations of f with r e for the cylinder near the free surface with different combinations of ζ h a r n e s s and k values it can be seen from the figure that the differences in ζ h a r n e s s nearly have a negligible effect on the frequency responses in the viv and galloping regions for each of the tested k when the cylinder is undergoing viv there exists a slight reduction in the overall f from 1 34 to around 1 10 as the damping and stiffness parameters are increased as r e approaches 80 555 f is subject to a decline representing the transition to the galloping region and this decrease is relevant to both the ζ h a r n e s s and k values with a lower stiffness the sharp drop in f is only observed for the case with ζ h a r n e s s 0 20 increasing k to 1200 n m f starts to fall off noticeably even if ζ h a r n e s s is as low as 0 12 it has been explained in section 3 that the pace of the frequency decline can be controlled by reducing ζ h a r n e s s once r e exceeds 88 522 the frequency responses in all the cases considered in the present study are quite similar with values around 1 0 this observation agrees with those of park et al 2013a b that within the galloping region f o s c of the cylinder coincides with f n w a t e r regardless of ζ h a r n e s s and k 4 3 harnessed power p h a r n e s s of the near the free surface case for different damping stiffness parameters is plotted against r e in fig 8 p h a r n e s s becomes non zero as long as there is fiv and in the cases considered it reaches its first peak value at r e 66 391 despite the ζ h a r n e s s and k values at a specific r e the combination of higher ζ h a r n e s s and k yields higher p h a r n e s s whereas the narrower viv regions for the cases with higher ζ h a r n e s s and k result in steeper peaks of p h a r n e s s in the transition region the response of a cylinder with low ζ h a r n e s s and k enters the galloping region straight after the lower branch of viv leading to a smoothly increasing trend of p h a r n e s s with increases in ζ h a r n e s s and k an apparent boundary appears between the two regimes indicated by a dramatic drop in p h a r n e s s over the transition region at the start of the galloping region the p h a r n e s s curves flatten off when 92 948 r e 97 374 which agrees with the corresponding amplitude responses in fig 6 after the plateau p h a r n e s s grows as r e is increased until reaching its second crest at r e 11 242 a further increase in r e would enhance the free surface effect on vortex shedding with the consequences of suppressing fiv and reducing p h a r n e s s for the r e range tested p h a r n e s s possesses two peak values in the viv and galloping regions respectively it can be observed that the peak p h a r n e s s in the galloping region is considerably higher than the one in the viv region in addition the increase in ζ h a r n e s s and k magnifies the maximum p h a r n e s s in the viv region and in the meanwhile reduces the peak p h a r n e s s for the galloping response consequently the disparity between the two peak values of p h a r n e s s might be reduced by increasing the damping and stiffness of the system the amount of p h a r n e s s is also closely related to ζ h a r n e s s when k is fixed a higher ζ h a r n e s s always corresponds to a higher p h a r n e s s moreover overlaps are observed for the p h a r n e s s values of ζ h a r n e s s 0 16 and 0 20 inside the galloping region increasing k leads to the p h a r n e s s curve at a lower ζ h a r n e s s of 0 12 collapsing to those of ζ h a r n e s s 0 16 and 0 20 it suggests that for a higher k the optimal p h a r n e s s can be achieved with a lower ζ h a r n e s s to sum up the rational coordination between ζ h a r n e s s and k would help the vivace converter adjust its energy harnessing modes more smoothly 4 4 energy harnessing efficiencies in this study what interests us most is η h a r n e s s of the vivace converter when it is placed near the free surface fig 9 presents the variations of η h a r n e s s with r e for different damping stiffness properties η h a r n e s s increases sharply on entering the viv region and it reaches its first maxima at the beginning of the viv upper branch higher ζ h a r n e s s and k shift the peak η h a r n e s s in the viv region to a higher r e for ζ h a r n e s s 0 04 and k 600 n m the highest η h a r n e s s is reached at r e 42 012 with ζ h a r n e s s and k being respectively increased to 0 20 and 1200 n m the peak η h a r n e s s appears at r e 63 258 it can also be observed from fig 9 that the difference in the r e corresponding to the peak η h a r n e s s values for various ζ h a r n e s s gradually disappears as k is increased in the present near the free surface configuration and for the damping stiffness parameters considered the highest η h a r n e s s is around 32 12 of the betz limit which is associated with ζ h a r n e s s 0 20 and k 800 n m once the response is in the transition region the cases with high ζ h a r n e s s and k exhibit a distinct change in η h a r n e s s which is consistent with their amplitude responses in contrast the variations of η h a r n e s s for low ζ h a r n e s s and k are milder although p h a r n e s s undergoes steady increases in the transition region when ζ h a r n e s s and k are low p f l u i d increases exponentially with the increase in r e and it dominates over the increasing trend of p h a r n e s s which leads to the resultant η h a r n e s s in the transition region being lower than that in the viv region for the low ζ h a r n e s s and k cases in the parameter space considered η h a r n e s s nearly remains unchanged for the whole galloping region except for a small decrease when r e 10 623 this decrease can be possibly attributed to the suppression effect caused by the proximity to the free surface and meanwhile the exponentially increased p f l u i d with increasing r e for each of the k values the η h a r n e s s curve of ζ h a r n e s s 0 16 collapses with that of ζ h a r n e s s 0 20 indicating that for the current experimental setup a further increase in ζ h a r n e s s does not contribute to a higher η h a r n e s s when the cylinder is subject to the galloping 5 conclusions the flow induced vibration fiv and hydrokinetic energy conversion of a single cylinder with the passive turbulence control ptc close to a free surface are investigated experimentally in the trsl3 flow regime r e 34 931 116 370 the results including the response amplitudes response frequencies harnessed power and energy harnessing efficiencies are presented and analysed in detail the main findings based on the discussions about the experimental data are summarised as follows for the cylinder near the free surface the vibration can be induced at a lower reduced velocity v r the useful vortex induced vibration viv and galloping ranges are expanded and the free surface makes the transition from the viv to galloping regions more gradual as a result of the proximity to the free surface the harnessed power p h a r n e s s reduces slightly in the viv region whereas it rises in the galloping region when the cylinder is undergoing galloping the free surface effect contributes to a higher p h a r n e s s for v r 13 06 beyond this critical v r the cylinder gets so close to the free surface that the free surface suppresses the vortex shedding and the subsequent oscillation amplitude meanwhile p h a r n e s s is also inhibited a lower energy harnessing efficiency η h a r n e s s is observed in the viv range for the cylinder near the free surface while the η h a r n e s s values in the galloping region share similar features in both the deep submerged and near the free surface cases when the cylinder is placed immediately beneath the free surface with an incipient gap ratio h d of 3 0 the lock in range of viv is widened with a higher initial amplitude ratio a d for a low spring stiffness k for low harnessing damping ratio ζ h a r n e s s and k a steady increase in a d is observed in the transition region whereas a d in the transition range drops dramatically for the cases with high ζ h a r n e s s and k considering each of the tested k ζ h a r n e s s is found to have an almost negligible effect on the frequency response in both the viv and galloping regions the peak p h a r n e s s in the galloping regime is higher than that in the viv region in the viv region higher ζ h a r n e s s and k lead to higher p h a r n e s s while causing a significant drop in p h a r n e s s during the transition from viv to galloping the difference in p h a r n e s s between the viv and galloping ranges can be reduced by increasing ζ h a r n e s s and k the peak η h a r n e s s in the viv region is shifted to a higher r e as ζ h a r n e s s and k is increased at transitional r e milder variations of η h a r n e s s are observed for low ζ h a r n e s s and k the η h a r n e s s curves are rather similar inside the galloping region with a slight decrease in η h a r n e s s at r e 10 623 because of the suppression effect of the free surface and the exponential increase in p f l u i d as r e is increased the variations of the dynamic responses and energy harvesting characteristics of a single cylinder vivace converter near the free surface with ζ h a r n e s s and k qualitatively resemble those for a fully submerged vivace converter in previous publications the present results suggest that it is promising to apply the vivace converters in shallow water near a free surface after a global optimisation of the different governing parameters nevertheless only one gap ratio is considered in this study systematic investigations with various gap ratios harnessing damping ratios and spring stiffnesses will be carried out in the future research credit authorship contribution statement wanhai xu conceptualization investigation formal analysis writing original draft funding acquisition meng yang visualization data curation enhao wang visualization writing review editing funding acquisition hai sun investigation formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors wish to acknowledge professor michael m bernitsas and all the staff from the marine renewable energy laboratory at the university of michigan for providing the excellent facilities and offering the strong support throughout the experiments this research was funded by the national natural science foundation of china grant numbers 51679167 51979193 and 51909189 and the state key laboratory of ocean engineering shanghai jiao tong university grant number 1811 appendix assuming that the flow is in the x direction and the cylinder vibrates in the y direction then the dynamics of the oscillator can be modelled by a second order linear differential equation as follows a 1 m o s c y c t o t a l y k y f f l u i d where y is the cylinder displacement in the cross flow direction and a dot denotes differentiation with respect to time m o s c c t o t a l and k represent the total mass of the oscillating parts the total damping coefficient and the spring stiffness respectively f f l u i d stands for the hydrodynamic force in the transverse direction exerted on the cylinder by the ambient flow according to govardhan and williamson 2000 f f l u i d can be decomposed into the vortex and inviscid components as formulated in sun et al 2016 a 2 f v o r t e x 1 2 c y ρ u 2 d l a 3 f p o t e n t i a l m a y herein c y is the hydrodynamic force coefficient in the cross flow direction and m a is the added mass substituting eqs a 2 and a 3 into eq a 1 and rearranging the equation we obtain a 4 m o s c m a y c t o t a l y k y 2 π d c y m d u 2 for energy conversion from hydrokinetic energy to mechanical energy and later to electrical energy additional harnessing damping c h a r n e s s is considered to mimic a power take off pto system then the total damping coefficient can be defined as a 5 c t o t a l c s t r u c t u r e c h a r n e s s where c s t r u c t u r e is the existing damping losses in the transmission system in the present research c s t r u c t u r e is adjusted by the vck system according to m and k c s t r u c t u r e and c h a r n e s s may be nondimensionalised with respect to the critical damping 2 m o s c m a k a 6 ζ s t r u c t u r e c s t r u c t u r e 2 m o s c m a k a 7 ζ h a r n e s s c h a r n e s s 2 m o s c m a k it is worth noting that in the literature there exists a controversy regarding the value of m a in the equations above there are two approaches available to account for the added mass one is to include the added mass as a constant value based on the potential theory and the other one is to calculate the added mass from the lift force in phase with the acceleration in the y direction vikestad et al 2000 both methods are useful in post processing the data and understanding this intricate phenomenon the interested readers can refer to foulhouxm and bernitsas 1993 for comprehensive explanation to the complex added mass concept as argued by sun et al 2016 and sun and bernitsas 2019 the essential difference between the two methods merely lies in the presentation of the experimental data rather than the physical phenomenon itself therefore following their precedent m a in the present study is computed using the first method the mechanical power converted by the vivace converter is expressed as a 8 p m e c h 1 t o s c 0 t o s c 4 π m o s c m a ζ t o t a l y 2 f n w a t e r d t here t o s c denotes the oscillation period and f n w a t e r 1 2 π k m o s c m a is the natural frequency in water assuming that the cylinder displacement is sinusoidal i e y a sin 2 π f o s c t with a being the vibration amplitude and f o s c 1 t o s c being the oscillation frequency eq a 8 can be simplified into a 9 p m e c h 8 π 3 m o s c m a ζ t o t a l a f o s c 2 f n w a t e r consequently the dissipated and harnessed power are respectively given by a 10 p d i s s i p a t e d 8 π 3 m o s c m a ζ s t r u c t u r e a f o s c 2 f n w a t e r a 11 p h a r n e s s 8 π 3 m o s c m a ζ h a r n e s s a f o s c 2 f n w a t e r since eqs a 10 and a 11 depend explicitly on the added mass these two equations can be rearranged into a 12 p d i s s i p a t e d 1 2 c s t r u c t u r e a 2 ω o s c 2 a 13 p h a r n e s s 1 2 c h a r n e s s a 2 ω o s c 2 where ω o s c is the angular frequency of the oscillation measured by the vck system the total power in the flow in terms of the area swept by the oscillating cylinder can be described as a 14 p f l u i d 1 2 ρ u 3 2 a m a x d l where a m a x represents the largest amplitude of the cylinder oscillator during the whole vibration process the betz limit is the theoretical maximum power that can be extracted from an open flow without any rotation or frictional losses it takes the value of approximately 59 26 16 27 based on the betz limit the energy harnessing efficiency η h a r n e s s is calculated by a 15 η h a r n e s s p h a r n e s s p f l u i d b e t z l i m i t 100 
21322,manoeuvring in adverse weather conditions has significant challenges for the shipmaster especially when the ship is equipped with the smaller propulsion power the automatic control methods for safe manoeuvring in severe weather conditions have not been studied extensively since manual control is applied in these conditions moreover in most numerical simulations pid control is used due to its simplicity in this paper the authors discussed the performance of a conventional pid autopilot under large external forces using the numerical simulation of a handymax bulk carrier in various weather conditions then a path following control strategy was applied to eliminate the drifting problem found in the conventional pid autopilot alone moreover optimal control oc based general purpose trajectory optimization path planner was proposed for obtaining obstacle free optimal paths finally the performance of the resulting path planner follower is analyzed under different severe weather conditions a series of early small and precise continuous rudder commands are found to be used to execute the successful collision avoidance maneuver whereas a human operator may use discrete rudder angles with large steps the head sea course is found to be the safest one in adverse weather conditions compared to the other oblique courses keywords adverse weather pid autopilot los guidance optimal control path following path planning list of symbols α k angle of the path defined by two waypoints k and k 1 w r t to space fixed coordinate e cross track error c x c y c n non dimensionalized 2nd order wave drift forces and moment in surge sway and yaw i z moment of inertia of ship around z axis j t o t a l polar moment of inertia of crankshaft propeller shaft propeller and added mass of propeller combined j z added moment of inertia of ship around z axis k i rudder integral gain k i l o s integral gain in los guidance k p rudder proportional gain l p p length between perpendiculars m ship s mass m x m y added mass in x axis and y axis direction q e q p q f engine propeller and friction torque s wave spectrum t time t e rudder time constant u v r surge velocity sway velocity roll angular velocity and yaw angular velocity of the ship r k f wave filtered yaw angular velocity by kalman filter x y position in space fixed coordinated system x y n surge force lateral force yaw moment around center of gravity cg acting on the ship subscripts h p r a w mean hull propeller rudder wind and wave δ rudder angle δ lookahead distance ψ yaw angle ship heading ψ k f wave filtered yaw angle by kalman filter ψ r e f reference heading angle ω e angular rotation rate of engine crankshaft acronyms bf beaufort number cg center of gravity co2 carbon dioxide colreg international regulations for preventing collisions at sea dof degree of freedom ecdis electronic chart display and information system eedi energy efficiency design index measured in co2 g ton nmile gnss global navigation satellite system imo international maritime organization jonswap joint north sea wave project kf kalman filter los line of sight ilos integral line of sight marpol international convention for the prevention of pollution from ships mmg mathematical manoeuvring group nlp nonlinear program nmcr rpm at smcr nmpc nonlinear model predictive control oc optimal control ocp optimal control problem pmcr power at smcr pi proportional integral pid proportional integral differential rao response amplitude operator rpm revolution per minute smcr specified maximum continuous rating to trajectory optimization top trajectory optimization problem 1 introduction to reduce the co2 emission from the international shipping and to encourage the development of more efficient ships imo international maritime organization introduced the eedi regulation in the annex vi of the marpol convention imo 2014 since the regulation is gradually tightened phase by phase every 5 years the ship designers have to find a way to reduce the eedi value of the ship to comply with the regulation among the various eedi reduction measures design ship speed or power reduction is the easiest and unexpensive solution since eedi value is proportional to propulsion power and the power is approximately proportional to the cube of the ship s speed on the other hand small propulsion power can impose operational danger under adverse weather conditions therefore imo added the minimum power guideline in the eedi regulations imo 2017 2014 2013 with the possible use of small propulsion power and the introduction of minimum power guidelines the maneuverability of the ships under adverse weather conditions got attention from the researchers several methods for judging the safety or operability of the ship under these severe weather conditions have been proposed imo 2016 shigunov 2018 yasukawa and sakuno 2019 manoeuvring in adverse weather conditions is usually studied either by study sailing condition calculation or time domain simulation with autopilot control in those studies drifting of the ship is usually considered as one of the variables of interest and drift compensation is not usually taken into account however in real life since the ship is manually controlled during a severe condition the helmsman will try to compensate the drifting as possible as he she can therefore drifting compensation should be considered in the ship motion control system to reflect the real life scenario moreover the automatic control methods for safe manoeuvring in severe weather conditions have not been studied extensively since manual control is applied in these conditions a conventional pid autopilot controller is used in most numerical manoeuvring simulations due to its simplicity aung and umeda 2020 when very large external forces and moments are involved drifting is significant and the ship may become course unstable yasukawa and sakuno 2019 in these cases inefficient rudder movements could affect the ship s heading or trajectory significantly leading to navigational accidents since manual rudder control is usually discrete with large steps it has limitations in terms of precision and efficiency moreover the helmsman will have difficulty in controlling the ship since the ship s motions are very large in these conditions in those cases a well designed path following automatic control may outperform the human operator in this paper the authors discuss the shortcomings of the conventional pid autopilot under very large external forces and propose the path following control strategy for navigation in adverse weather conditions the goal is to propose a simple and feasible robust automatic navigation control system which has good performance even under the vary large environmental loads a general purpose optimal path planner is also proposed to obtain the collision free path with the static obstacles of known positions which could represent a small island or an anchorage near a port the proposed control system can be applied to the exiting ships without any additional special hardware since it uses only gyro compass and gnss measurements as feedbacks moreover with the development of autonomous and remote controlled ships these automatic control systems will be valuable in the future 2 manoeuvring model to realize the performance of the various control strategies in adverse weather conditions numerical simulations in various scenarios are executed for the simulation purpose a numerical manoeuvring model of the subject ship is required in this study a surge sway yaw coupled 3 dof mmg model is used ohiwa and umeda 2016 the diagram of the manoeuvring model is shown in fig 1 as being a modular manoeuvring model each physical component is modelled independently but the interactions between these components are also considered where necessary this approach models low frequency motions only and use high frequency motions such as harmonic motions due to incident waves only as the input for calculating the second order wave forces and moments this approach can be justified by a multiple time scale perturbation analysis by nonaka 1990 2 1 equations of motions and coordinate system in fig 2 the coordinate system o x y represents a space fixed system while the coordinate system o x y does a body fixed system at the center of gravity cg of the ship the wind and wave are assumed to come from the positive direction of o x axis here the ship heading measured from o x axis is indicated by ψ and the ship is assumed to run at forward speed of u with the drift angle β then the 3 dof equations of motions are represented as follow ohiwa and umeda 2016 1 m m x u m m y v r x h x p x r x a x w 2 m m y v m m x u r y h y r y a y w 3 i z j z r n h n r n a n w 2 2 hull reaction forces and moments the hydrodynamic reaction forces and moment acting on the hull x h y h and n h are calculated using the unified mathematical model for ship manoeuvring in ocean and harbour area proposed by yoshimura et al 2009 this model can deal with the very large drift angle and very low speed manoeuvring which may encounter in the severe seas due to extreme wind and waves the correction factors of crossflow drag coefficients used in this model were obtained from the captive model experiments 2 3 propulsion and steering system the propulsion system arrangement is shown in fig 3 the propeller generated thrust x p and torque demand q p are calculated from the open water propeller characteristic data whereas the engine generated torque is obtained from the simplified torque fuel linear relationship model aung and umeda 2020 the propeller or engine revolution ω e is then obtained by solving the following equilibrium equation of shaft dynamics hirano and takashina 2010 4 ω e q e q p q f j t o t a l the torque loss due to friction q f from eq 4 is assumed to be neglectable for the engine speed control a proportional integral pi type governor is used in order to safeguard the engine from mechanical and thermal loads the fuel limiter is also incorporated into the governor so that the operating point which is a combination of engine speed and power is always within the design load diagram or engine s limit envelope imo 2016 man energy solutions 2018a shigunov 2018 fig 4 shows the layout and load diagram of man b w 8s40me b9 5 tii for the smcr of 7930 kw at 137 rpm man diesel and turbo 2018 man energy solutions 2018b the rudder induced forces and moment x r y r and n r are calculated using a standard mmg model yasukawa and yoshimura 2015 the steering gear limits such as maximum rudder angle and maximum rudder rate are also considered in the steering system model 2 4 wind and wave forces and moments 2 4 1 sea condition definition environmental conditions are defined by the beaufort numbers bf no which in turn relate to the wind speeds and significant wave heights as shown in table 1 wmo 2011 the mean wave period is chosen as the most critical one based on the average largest of 2nd order wave forces and moments around the head sea and bow quartering directions this value may not give the largest 1st order motions but is consistent with the fact the same mean wave period is used for both 2nd order wave forces and 1st order wave motions 2 4 2 wind forces and moments the wind forces and moments x a y a and n a are estimated with fujiwara s empirical method fujiwara et al 2001 1998 this estimation method which is based on a linear multiple regression model was obtained by using the experimental results of various kinds of ships with the modification for the effect of wind velocity profiles in experimental conditions the effect of fluctuating wind velocity which has low frequency components could be important for ship manoeuvring but in this study only the mean component of wind velocity we was taken into account for simplicity as the first attempt 2 4 3 wave forces and moments the added wave resistance for different ship speeds and headings x w are estimated by maruo s theory maruo 1963 with the kochin function calculated by ogilive tuck s slender body theory ogilvie and tuck 1969 the wave induced steady sway force y w and yaw moment n w are calculated by a linear 3d panel method using the green function for zero forward speed yasukawa et al 2019 these are categorized as the second order forces with respect to the wave steepness so that in irregular waves they consist of the mean components the slowly varying components due to the difference between the two frequencies of incident wave elements and the quickly varying components due to the sum of the two frequencies of incident wave elements while the quickly varying components do not affect the ship manoeuvring motion because of its very low frequency other two components could be relevant to this topic as the first attempt for simplicity the authors focused on only the mean component which are calculated with the jonswap wave spectrum by assuming they are proportional to the square of wave height based on maruo s work maruo 1963 as follow 5 x w ψ u h s t 0 2 ρ g l p p 0 c x ω ψ u ζ 2 s ω h s t 0 d ω 6 y w ψ h s t 0 2 ρ g l p p 0 c y ω ψ ζ 2 s ω h s t 0 d ω 7 n w ψ h s t 0 2 ρ g l p p 2 0 c n ω ψ ζ 2 s ω h s t 0 d ω where c x c y and c n are the non dimensionalized 2nd order wave drift forces and moment in surge sway and yaw respectively s here represents the long crested jonswap wave spectrum alongside the wave induced steady forces and moment first order zero mean oscillatory motions are also added into the ship manoeuvring motions to obtain the realistic ship motions in the actual sea so that the yaw angle and yaw angular velocity measurements from gyroscope represent the realistic ones these first order harmonic motions are calculated by transforming the motions raos which are in frequency domain into the time domain using the jonswap wave spectrum aung and umeda 2020 fossen 2011 2 5 subject ship the subject ship used in this study is a hypothetical handymax bulk carrier its hull form is originated from the kvlcc2 which is modified to have the block coefficient of 0 84 yasukawa et al 2019 2015 the 3d model of the subject ship is shown in fig 5 and principal particulars of the ship propeller rudder and propulsion engine are shown in table 2 3 conventional pid autopilot 3 1 pid autopilot setup first the authors studied how a conventional pid autopilot alone performs under very large external forces and moments fig 6 shows the block diagram of the simulation setup with pid autopilot alone pid autopilot accepts the reference heading angle ψ r e f from the operator and yaw angle ψ and yaw angular velocity r measurements from the gyroscope and then calculates the rudder angle command for the ship using the pid control algorithm the pid autopilot controller is expressed in the following equation 8 δ k p ψ ψ r e f k i ψ ψ r e f d t t d r t e δ where δ is the rudder angle and k p k i t d and t e are proportional gain integral gain differential time constant and rudder time constant respectively since first order motions are considered in the ship numerical model the yaw angle feedback into the autopilot contains the harmonic motions which are not desirable for the autopilot a kalman filter based on the 1st order nomoto k t model is used for wave filtering to remove the unwanted oscillatory yaw motions from the feedback measurements fossen 2011 to respect the physical limitations of the steering gear the limits on maximum rudder angles δ m a x and rudder turning rate δ m a x are also added into the autopilot 3 2 simulation results with pid autopilot alone time domain simulations for the course keeping of various course angles in different weather conditions are executed to access the performance of pid autopilot alone in severe weather the parameters for the pid autopilot controller are shown in table 3 the same parameters are used for all weather conditions bf no without retuning for a specific case or gain scheduling the numerical simulations are done using the 4th order runge kutta method with the time step of 0 01 s throughout this paper 3 2 1 course keeping in various bf nos fig 7 and fig 8 show the ship trajectories and timeseries of heading rudder angle ship speed and engine power for reference heading of 15 degree oblige angle in different severities of weather conditions since the ship starts with the same heading angle as the desired autopilot heading it is attempting to keep its course using the pid autopilot as shown in the figures up to the bf 8 the autopilot has no problem in course keeping significant drifting can be found starting from the bf 9 although there is large drifting in the bf 9 and bf 10 the autopilot did not use the maximum steering angle which is 35 to compensate the drifting since its task is just to maintain the ship heading at the desired reference heading and it is already fulfilling that task fig 8 therefore autopilot is working well as intended although there is undesirable drifting to avoid the drifting problem conventional autopilot alone should not be used in these conditions another layer of guidance should be added to the control system to obtain the path following behavior in the power graph of fig 8 the engine powers at the higher bf no are lower than those of smaller bf no cases this is due to the lower engine power limits at the high propeller engine loadings lower rpm in heavy weather fig 4 in severe weather the propeller curve will move to the left side lower rpm side of the load diagram and the engine could not provide the full power due to its limitations such as tuque limit thermal limit etc the more detailed information on engine limitations can be found in aung and umeda 2020 the reason that the power at bf0 case is lower than that of bf 8 is that the desired rpm is already reached in bf 0 at that power so the governor does not provide more fuel supply to the engine 3 2 2 various headings in bf 10 condition fig 9 and fig 10 show the simulation results for various autopilot desired headings in the bf 10 condition the larger drifting can be seen for the larger oblige headings to the wind and waves starting from around 30 degree heading the rudder angle is saturated and the ship suffers the uncontrollable drifting 4 ilos pid path follower to resolve the drifting problem found in the conventional pid autopilot alone a guidance system is introduced as another layer in the control system as shown in fig 11 the guidance system accepts the reference path defined by two waypoints and calculates the reference heading for the autopilot that would drive the ship onto the desired path only ship position measurement from the gnss sensors is needed to feedback into the guidance system since most of the ships are already equipped with the gnss sensors there is no need to install the additional new sensors onboard 4 1 los guidance for straight paths lookahead based line of sight los method which is a frequently used marine craft path following algorithm fossen 2011 is applied for the guidance system as shown in fig 12 in los guidance cross track error which is the perpendicular distance from the path to the ship is calculated using eq 9 and eq 10 depending on the amount of cross track error e and the predefined lookahead distance δ the los vector which is the reference heading for autopilot is calculated according to eq 11 and eq 12 fossen 2011 here the lookahead distance δ serves as the tuning parameter for the los guidance depending on the value of δ the guidance system will force the ship onto the desired path either slowly or aggressively analogous to the pid controller this parameter can be regarded as the inverse of proportional gain δ 1 k p l o s 4 1 1 ilos integral los when very large external forces and moment are involved steady offset error between the actual ship path and the desired path is expected therefore proportional effect alone in the guidance is not enough to obtain the desired performance and therefore an integral effect is added to the guidance system by modifying eq 12 into eq 13 as shown 13 x r e atan 2 e t δ p r o p o r t i o n a l e f f e c t atan 2 k i l o s e t d τ δ i n t e g r a l e f f e c t 4 2 simulation results with ilos pid path follower the parameters for ilos guidance are shown in table 4 these parameters are tuned by using a trial and error approach in the high bf numbers such as bf 9 and bf 10 the range of value of lookahead distance that ensures the stability is found to be very narrow 4 2 1 beaufort 9 bf9 condition fig 13 and fig 14 shows the comparison between the pid autopilot alone and the ilos guidance plus pid autopilot for the 15 degree heading path in bf 9 by adding the ilos guidance a smaller reference heading is put into the autopilot to compensate for the drifting and the ship was found to successfully follow the path although the ship trajectories between two approaches significantly differ there is no large difference in the rudder angle commands moreover the rudder angles are also very small these conclude that small differences in rudder angles can make significant differences in ship trajectories under large external forces in addition these small and precise rudder commands might not be able to execute by manual control under bf 9 condition the ship was successfully able to execute the path following for various oblige paths as shown in fig 15 4 2 2 beaufort 10 bf10 condition fig 16 and fig 17 show the comparison of conventional pid autopilot and ilos guidance plus pid autopilot under bf 10 condition there are some oscillations at first since the ship is not at the equilibrium condition initially in bf 10 the guidance system gave nearly head sea reference heading to autopilot to compensate the drifting and at the same time to keep the ship on the desired path as shown in fig 18 in bf 10 the ship was able to follow the oblige path of up to 25 degree starting from the 30 degree path the drifting is too large and failed to follow the path regardless of the maximum steering effort for this particular ship 30 degree oblige path can be regarded as the limit for the path following in bf 10 moreover it can be concluded that in severe weather conditions keeping the head sea course is safer than keeping the other oblige courses since the ship is less effaced by the wind and wave forces on the lateral direction therefore keeping the side drift force and yaw moment at minimum furthermore conventional propulsion systems are designed to deal with longitudinal force only therefore it is recommended to keep the head sea heading if the ship encounters the adverse weather conditions however on the other hand it might be difficult to accurately identify the relative wind and wave directions in the real sea since they could be changing with time and they may not be exactly aligned with each other the authors acknowledge that it is not fair to directly compare between pid autopilot and los pid path follower since they are intended for different tasks the former for the heading control and the later for path following here the authors aim to highlight the shortcomings of using the conventional pid autopilot alone in the severe weather conditions and how these shortcomings could be solved by adding a simple guidance system 5 oc ilos pid path planner follower in the previous setup it was assumed that there are no obstacles on the path to be followed by the ship so it was a simple straight line path following however in real situations there may be some obstacles on the way for instance small islands in the coastal area or anchored ships near the port therefore in the next step the authors tried to add the obstacle avoidance feature into the control system using a path planner as an additional layer over the guidance system the diagram of the simulation setup for the path planner follower is shown in fig 19 there are various algorithms for surface vehicle collision avoidance path planning such as variants of a lee et al 2015 singh et al 2018 song et al 2019 rapidly exploring random tree rrt zaccone and martelli 2018 particle swarm optimization pso kang et al 2018 artificial potential field apf lyu and yin 2019 trajectory unit cell based methods du et al 2019 2018 optimization based methods bergman et al 2020 bitar et al 2019 ma et al 2018 etc each of these algorithms has different complexities and advantages some of them are fast enough to be realized in real time updating or replanning the path as the ship moves but there will be compromises in performance and features available in this study the authors proposed to use trajectory optimization to or optimal control oc as an offline path planner to obtain the optimal collision free path trajectory optimization is the finding of optimal states and corresponding control sequences of a dynamical system here a ship between the given initial and final conditions it is a technique for computing an open loop solution to an optimal control problem ocp the optimality or cost function is defined by the mission objectives such as minimum time minimum energy usage maximum passenger comfort minimum damage to the ship structure and combinations of these and so on various constraints may be imposed on the problem the dynamic constraints of the vehicle e g manoeuvring limits a ship may not execute a very sharp turn suddenly the physical limitations of actuators e g maximum rudder angle and rudder rate limitation of propulsion machinery the obstacles on the way and navigation channel limits etc the goal is to find the solution trajectory that is both feasible and optimal as mentioned above oc based trajectory optimization has several advantageous features compared to the other path planning methods it can explicitly consider the dynamics of the ship which is very important for the large inertia ship with poor maneuverability as a result the resulting collision free path could easily be followed by the path follower without any problem if the environmental disturbances can be measured and modelled they can also be considered in the path planning stage giving a path with better feasibility moreover various actuators and obstacles constraints can be taken into account explicitly in the path planning the various cost functions can be designed depending on the mission requirements one major disadvantage of trajectory optimization is that it could be computationally expensive depending on the problem formulation and required performance or accuracy however in the cases where the planned path does not need to be updated very frequently the computation problem may not be a limiting factor for practical implementation a brief literature survey on track keeping autopilot is given here the development of track keeping autopilots has started around 1990 and primarily intended for automatic execution of special maneuvers of the survey vessels and minehunters and so on later they are also applied to commercial vessels for automatic course changing along a prescribed route track controllers designed using a combination of feedforward and linear quadratic gaussian lqg feedback control can be found in bertin 1998 holzhüter 1997 1990 holzhüter and schultze 1996 works on fuzzy logic based track keeping autopilots can be found in cheng et al 2006 omerdic et al 2003 velagic et al 2000 tracking controllers can also be regarded as the path following controllers when there is no temporal constraint along the path or the ship s speed is independently controlled or kept constant another popular approach for path following control is the line of sight los guidance which has typically been employed for surface to air missiles theory and applications of los guidance for marine craft guidance are extensively discussed in breivik 2010 breivik and i 2009 fossen 2011 1994 fossen et al 2003 moreira et al 2007 in recent years backstepping technique and sliding mode control have been applied to path following and trajectory tracking of the surface vessels and underwater vehicles fossen 2011 liao et al 2011 xu et al 2015 zheng et al 2017 a ship track control system usually includes two parts 1 a path trajectory generator and 2 a path follower or trajectory tracker in most studies of the track keeping autopilots the main focus is usually on the motion control part of the system and generating the path or trajectory is usually done manually similarly route or path planning in most commercial track controllers is manually done in ecdis using a series of waypoints and straight lines in between a suitable mechanism for track changing maneuver at the waypoints is applied to get the nice transition between the two straight line paths in that case since the route path planning is done manually by the operator using a nautical chart the track segments between waypoints are usually limited to the straight lines therefore the planned path may not be optimal with respect to the obstacles and the dynamics of the ship is not considered either in the case of the proposed oc path planner collision avoidance optimal path planning can be done automatically which is important for future autonomous ships and the dynamical constraints of the ship are also taken into account therefore the path generated by the oc path planner is both optimal and dynamically feasible and it could be easily followed by the path followers 5 1 trajectory optimization problem top a standard top or ocp is defined as below eq 14 14 m i n i m i z e φ b c t 0 t f ω d τ subject to dynamics x t f t x u bounds x l o w x x u p p u l o w u u u p p t 0 t f t f constraints h t x u 0 g t x u 0 where φ bc is the terminal or boundary cost imposed at the initial and final conditions ω is the path cost imposed along the trajectory x u and t are state vector control vector and time variable respectively f is the function of the vehicle dynamics and h and g are equality and inequality constraint functions respectively 5 2 numerical solution of ocp there are two main sets of methods for solving an ocp indirect and direct methods in an indirect approach the necessary and sufficient conditions for optimality for a specific problem are constructed analytically first then these conditions are discretized forming a constrained parameter optimization problem and finally resulting optimization problem is solved in a direct approach the trajectory optimization problem is directly converted into a constrained parameter optimization problem by a transcription method either collocation or shooting then the optimization problem is solved although indirect approach gives more accurate results it involves the derivation of optimality conditions and it has particular difficulty with path inequality constraints on the other hand direct methods are much easier to solve and applicable to a wider range of problems betts 2010 in a shooting transcription only control variables are discretized and state variables are obtained by simulation usually explicit runge kutta methods i e the state transition odes are embedded in the optimization problem in a direct shooting method path constraints are difficult to implement since the intermediate state variables are not decision variables in the non linear program direct collocation transcription works by approximating both state and control trajectories using polynomial splines in a collocation approach both control variables and state variables are discretized therefore the resulting optimization problem tends to be larger but it is easier to implement the path constraints and they are easily applicable to the more general problems the discretization is typically done using implicit runge kutta schemes kelly 2017 in this study direct trapezoidal collocation method is used to solve the ocp due to its simplicity in a trapezoidal collocation the control trajectory and the system dynamics are approximated as piece wise linear functions i e linear splines the continuous states and controls variables are discretized at the specific points in time known as collocation points the continuous system dynamics are converted into a set of constraints at the collocation points using trapezoidal rule by equating the change in state between two collocation points to the integral of the system dynamics that integral is then approximated using trapezoidal quadrature as shown on eq 15 15 x k 1 x k t k t k 1 f τ x u d τ h k 2 f k 1 f k where f t x u x t is the system dynamics and h k t t k 1 t k is the time step between the collocation points in the same manner the integral in the objective function is also approximated using the trapezoidal quadrature converting it into the summation over time states and or controls at each collocation point as shown in eq 16 16 t 0 t f ω d τ k 0 n 1 h k 2 ω k ω k 1 after converting the continuous time ocp into a non linear program nlp using a transcription method it can be solved using an appropriate nlp solver the resulting solution is an open loop solution that contains both optimal control inputs i e rudder angles in this case and corresponding ship states since it is an open loop solution in a relatively coarse mesh only collision free optimal path x y from the oc path planner is utilized for subsequent guidance and control since the lower level guidance and autopilot are feedback controllers they could handle the modelling uncertainties of ship dynamics of the oc path planner the process of the oc ilos pid path planner follower can be summarized as follows the operator inputs the target pose position and orientation of the ship and obstacles into the oc path planner then path planner uses the provided cost function and the numerical ship model to solve the constrained nonlinear program nlp giving the optimal control inputs and optimal ship states the time energy optimal collision free path from oc path planner is used as a reference path for ilos guidance then ilos guidance calculates the reference heading for pid autopilot using the current ship position finally pid autopilot calculates the rudder angle command to keep or change the ship heading accordingly if the nlp solver is fast enough to update frequently dynamic obstacles e g sailing ships can be considered in the path planning stage using the additional feedback measurements integration of colreg rules should be required when other sailing ships are involved in the collision avoidance path planning however in this study the oc path planner is used as an offline path planner by only considering the static obstacles therefore no feedback measurement to the path planner is needed 5 3 los guidance for curve paths since los guidance is initially designed for following straight paths it has to be modified to follow the curve path since the path given by the oc path planner is a curve path the main difference between straight line and curve path los guidance is how the point of minimum distance on the path is obtained in the case of the straight line the minimum distance from the path to the ship is the perpendicular distance from the straight line for the curve path if the path is represented by a piece wise spline the point of minimum distance can be found by using a suitable algorithm e g distance2curve d errico 2020 a simpler approach is to calculate all distances from ship to the discretized positions on the path and then find the minimum distance among them this approach easier to implement but a fine discretization of the path is required to get the smooth transition between discretized points and it may demand more computational resource if the array size is very large therefore the number of discretized points should be selected by balancing between a smooth transition and available computational resources when the point of minimum distance x y m i n is obtained a tangent line can be drawn at that point and follow the same procedure for los guidance for the straight line path described in section 4 1 however it was found that using a small distance d δ to reduce the deviation of x y l o s from the actual path has a slightly better performance compared to directly drawing the tangent at the point of minimum distance x y m i n therefore the tangent line is drawn at x y d δ instead of x y m i n as shown in fig 20 since d δ δ serves as the total lookahead distance they should be tuned simultaneously 5 4 simulation results with oc ilos pid path planner follower the simulation scenarios are similar to the straight line path following cases from section 4 except for the circle shape obstacle with 1 km diameter placed on the path at about 2 5 km from the initial ship position there are two possible collision free paths on each side of the obstacle if the obstacle center lies exactly on the reference straight line path to favor one side of the obstacle safer side with respect to wind and wave direction in the optimization the obstacle circle s center is placed at a certain small distance offset from the reference straight line path the shape of own ship is assumed to be a point mass assuming that the real obstacles are represented by enough safety margin the choice of safety margin is user dependent but it should be at least half of the ship s total length when the ego ship is represented by a point mass at the midship the variables and functions used for ocp in the trajectory optimization path planning are shown in table 5 the wind and wave forces are not considered in the system dynamics of the ocp this eliminates the measurement and modelling of these forces in the path planner although a path planned with wind and wave forces could give the better trajectory the feasibility of the nlp becomes problematic when very large forces and moments and hard constraints are involved in the system dynamics at high bf nos since the environmental loads are not considered in the trajectory optimization the propeller revolution per minute rpm is assumed to be constant at the path planning stage and design rpm is used in addition the wave diffraction due to the obstacle in this calculation is ignored so that the obstacle used here could represent an anchored ship or an anchorage rather than an island the ocp and nlp settings and curve path ilos guidance parameters are shown in table 6 and table 7 respectively ilos guidance parameters in table 7 are tuned using trial and error approach 5 4 1 beaufort 9 bf9 condition fig 21 shows the minimum time collision free path generated by the oc path planner for head sea shown in dashed line and the trajectory of the ship that follows the generated path in bf 9 condition in this case the ship was successfully able to follow the path generated by the oc path planner without having significant deviation from the path hereinafter the circles that represent the obstacles are drawn without reducing the safety margin since the choice of safety margin is user dependent therefore safety judgment for collision avoidance is dependent on the safety margin used the performance criterion here is how well the ship can follow the generated collision free path without significant deviations along the path the time histories of reference heading calculated by ilos guidance actual ship heading rudder angle commands from autopilot ship speed and engine power are shown in fig 22 fig 23 and fig 24 show the simulation results for the 45 degree oblige path in bf 9 although there are some path deviations near the initial position due to the unbalance equilibrium at initial condition the ship also could nicely follow the 45 degree oblige path in bf 9 larger oblige paths are also found to be successfully followed in bf 9 therefore in bf 9 it can be concluded that the ship has no dangerous problem in following the collision avoidance path for all oblige headings 5 4 2 beaufort 10 bf 10 condition fig 25 and fig 26 shows the simulation results of collision avoidance path following for head sea course in bf 10 since the environmental forces are not considered in the path generation the generated paths are the same for all weather conditions as shown in fig 25 there are some path deviations along the path since the external loads on the ship are very large and the guidance system has the particular difficulties in performance and stability issue in this kind of condition due to the path deviation the ship has found somewhat passed through the obstacles if an enough safety margin is added in the representation of the obstacles the ship would not collide with the actual obstacle pid autopilot is found to have no problem in heading control since the reference heading and actual ship heading are almost same along the path as shown in the upper graph of fig 26 the oscillations around the final position are caused by sudden change in reference heading due to the non smooth transition between the curve path and the remaining straight line path in high bf no the choice of lookahead distance and the smoothness of the path are found to be very critical for the ilos guidance system this robustness issue of the guidance system found in severe weather conditions should be examined and improved in the future fig 27 and fig 28 shows the simulation results of collision avoidance path following for 25 degree course in bf 10 similar to the head sea course some path deviations exist along the path and path following performance is not as good as the bf 9 condition similar to the straight line following case 25 degree oblige path is also the limit course angle for curve path following in bf 10 condition one important finding for path following in head sea or oblige path is that the rudder angle commands used in all collision avoidance maneuvers are very small although it was expected to use the large rudder angle in avoiding an obstacle therefore early small and precise rudder movements are found to be important in executing the successful head on collision avoidance maneuver in adverse weather conditions 6 conclusion the performance of the different control strategies are studied by doing the numerical simulation with 3 dof mmg model conventional pid autopilot alone has the large drifting problem in high bf no since its function is just to control the ship heading only regardless of the ship position and drifting by adding line of sight guidance with integral effect as another layer over the autopilot the ship can advance onto the desired path with minimal deviation using the compensated reference heading for autopilot reference heading calculated by the guidance system is pointing to near head sea direction similar to crossing a river in the current the head sea course or path is found to be the least dangerous one in adverse weather conditions compared to the other oblige courses when comparing the rudder angle commands between the pid autopilot alone and ilos pid path follower there no significant differences although the trajectories significantly differ therefore a small difference in the rudder angle could give a significant difference in ship trajectory in a heavy sea a collision avoidance path planner for optimal path generation is proposed using trajectory optimization and direct optimal control for navigating near an anchorage up to bf 9 the guidance system has no problem in following the generated path for all directions in bf 10 the ship becomes somewhat course unstable so the guidance system was found to be struggling some significant deviations are found along the path in the larger oblique heading the ship was unable to follow the path regardless of the maximum rudder angle due to uncontrollable drifting the range of tuning parameters for guidance in successful path following becomes very narrow in high bf no early small and precise continuous rudder movements are found to be used to achieve the successful path following and collision avoidance maneuver under very large external loads manual rudder control by a human may have difficulty obtaining that kind of small precise rudder movements 7 future works in the present study the oc path planner is only used as an offline path planner because it is computationally demanding with advances in optimization algorithms and computer hardware oc path planner could be realized in real time i e updating the path as the ship moves in the near future in this case dynamic obstacles such as moving vessels can be considered in the path planning stages and even the control inputs calculated from the oc path planner could be used to directly control the ship another similar approach is to use the nonlinear model predictive control nmpc as an autopilot controller in place of pid autopilot since nmpc is a real time optimal control method with the moving horizon the obstacles within the horizon can be taken into account in the autopilot either as constraints or penalties in the objective function however in the preliminary study it was found that tuning of an nmpc controller is more difficult due to the more tuning parameters and its performance is also highly sensitive to those tuning parameters moreover realizing a good performance nmpc controller in real time is still difficult in practice especially for highly nonlinear and computationally expensive ship model with difficult obstacle constraints colreg rules have to be considered in the collision avoidance planning and control when sailing vessels are involved these rules can also be integrated into the cost or constraint functions of the optimization of either approach these issues should be addressed in the future to complete the control system and to eliminate the implementation problems the calculation of slowing varying wave drift forces and moment associated with the difference in frequencies between wave components as well as the fluctuating wind velocity are not included in this study as the effect of these slowly varying external forces would be significant in severe weather conditions the control system has to respond to those accordingly therefore these effects will be considered in the future to represent the complete picture in the external force calculations credit authorship contribution statement myo zin aung methodology software investigation writing original draft visualization naoya umeda conceptualization writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by a grant in aid for scientific research from the japan society for promotion of science jsps kakenhi grant number 19h02360 
21322,manoeuvring in adverse weather conditions has significant challenges for the shipmaster especially when the ship is equipped with the smaller propulsion power the automatic control methods for safe manoeuvring in severe weather conditions have not been studied extensively since manual control is applied in these conditions moreover in most numerical simulations pid control is used due to its simplicity in this paper the authors discussed the performance of a conventional pid autopilot under large external forces using the numerical simulation of a handymax bulk carrier in various weather conditions then a path following control strategy was applied to eliminate the drifting problem found in the conventional pid autopilot alone moreover optimal control oc based general purpose trajectory optimization path planner was proposed for obtaining obstacle free optimal paths finally the performance of the resulting path planner follower is analyzed under different severe weather conditions a series of early small and precise continuous rudder commands are found to be used to execute the successful collision avoidance maneuver whereas a human operator may use discrete rudder angles with large steps the head sea course is found to be the safest one in adverse weather conditions compared to the other oblique courses keywords adverse weather pid autopilot los guidance optimal control path following path planning list of symbols α k angle of the path defined by two waypoints k and k 1 w r t to space fixed coordinate e cross track error c x c y c n non dimensionalized 2nd order wave drift forces and moment in surge sway and yaw i z moment of inertia of ship around z axis j t o t a l polar moment of inertia of crankshaft propeller shaft propeller and added mass of propeller combined j z added moment of inertia of ship around z axis k i rudder integral gain k i l o s integral gain in los guidance k p rudder proportional gain l p p length between perpendiculars m ship s mass m x m y added mass in x axis and y axis direction q e q p q f engine propeller and friction torque s wave spectrum t time t e rudder time constant u v r surge velocity sway velocity roll angular velocity and yaw angular velocity of the ship r k f wave filtered yaw angular velocity by kalman filter x y position in space fixed coordinated system x y n surge force lateral force yaw moment around center of gravity cg acting on the ship subscripts h p r a w mean hull propeller rudder wind and wave δ rudder angle δ lookahead distance ψ yaw angle ship heading ψ k f wave filtered yaw angle by kalman filter ψ r e f reference heading angle ω e angular rotation rate of engine crankshaft acronyms bf beaufort number cg center of gravity co2 carbon dioxide colreg international regulations for preventing collisions at sea dof degree of freedom ecdis electronic chart display and information system eedi energy efficiency design index measured in co2 g ton nmile gnss global navigation satellite system imo international maritime organization jonswap joint north sea wave project kf kalman filter los line of sight ilos integral line of sight marpol international convention for the prevention of pollution from ships mmg mathematical manoeuvring group nlp nonlinear program nmcr rpm at smcr nmpc nonlinear model predictive control oc optimal control ocp optimal control problem pmcr power at smcr pi proportional integral pid proportional integral differential rao response amplitude operator rpm revolution per minute smcr specified maximum continuous rating to trajectory optimization top trajectory optimization problem 1 introduction to reduce the co2 emission from the international shipping and to encourage the development of more efficient ships imo international maritime organization introduced the eedi regulation in the annex vi of the marpol convention imo 2014 since the regulation is gradually tightened phase by phase every 5 years the ship designers have to find a way to reduce the eedi value of the ship to comply with the regulation among the various eedi reduction measures design ship speed or power reduction is the easiest and unexpensive solution since eedi value is proportional to propulsion power and the power is approximately proportional to the cube of the ship s speed on the other hand small propulsion power can impose operational danger under adverse weather conditions therefore imo added the minimum power guideline in the eedi regulations imo 2017 2014 2013 with the possible use of small propulsion power and the introduction of minimum power guidelines the maneuverability of the ships under adverse weather conditions got attention from the researchers several methods for judging the safety or operability of the ship under these severe weather conditions have been proposed imo 2016 shigunov 2018 yasukawa and sakuno 2019 manoeuvring in adverse weather conditions is usually studied either by study sailing condition calculation or time domain simulation with autopilot control in those studies drifting of the ship is usually considered as one of the variables of interest and drift compensation is not usually taken into account however in real life since the ship is manually controlled during a severe condition the helmsman will try to compensate the drifting as possible as he she can therefore drifting compensation should be considered in the ship motion control system to reflect the real life scenario moreover the automatic control methods for safe manoeuvring in severe weather conditions have not been studied extensively since manual control is applied in these conditions a conventional pid autopilot controller is used in most numerical manoeuvring simulations due to its simplicity aung and umeda 2020 when very large external forces and moments are involved drifting is significant and the ship may become course unstable yasukawa and sakuno 2019 in these cases inefficient rudder movements could affect the ship s heading or trajectory significantly leading to navigational accidents since manual rudder control is usually discrete with large steps it has limitations in terms of precision and efficiency moreover the helmsman will have difficulty in controlling the ship since the ship s motions are very large in these conditions in those cases a well designed path following automatic control may outperform the human operator in this paper the authors discuss the shortcomings of the conventional pid autopilot under very large external forces and propose the path following control strategy for navigation in adverse weather conditions the goal is to propose a simple and feasible robust automatic navigation control system which has good performance even under the vary large environmental loads a general purpose optimal path planner is also proposed to obtain the collision free path with the static obstacles of known positions which could represent a small island or an anchorage near a port the proposed control system can be applied to the exiting ships without any additional special hardware since it uses only gyro compass and gnss measurements as feedbacks moreover with the development of autonomous and remote controlled ships these automatic control systems will be valuable in the future 2 manoeuvring model to realize the performance of the various control strategies in adverse weather conditions numerical simulations in various scenarios are executed for the simulation purpose a numerical manoeuvring model of the subject ship is required in this study a surge sway yaw coupled 3 dof mmg model is used ohiwa and umeda 2016 the diagram of the manoeuvring model is shown in fig 1 as being a modular manoeuvring model each physical component is modelled independently but the interactions between these components are also considered where necessary this approach models low frequency motions only and use high frequency motions such as harmonic motions due to incident waves only as the input for calculating the second order wave forces and moments this approach can be justified by a multiple time scale perturbation analysis by nonaka 1990 2 1 equations of motions and coordinate system in fig 2 the coordinate system o x y represents a space fixed system while the coordinate system o x y does a body fixed system at the center of gravity cg of the ship the wind and wave are assumed to come from the positive direction of o x axis here the ship heading measured from o x axis is indicated by ψ and the ship is assumed to run at forward speed of u with the drift angle β then the 3 dof equations of motions are represented as follow ohiwa and umeda 2016 1 m m x u m m y v r x h x p x r x a x w 2 m m y v m m x u r y h y r y a y w 3 i z j z r n h n r n a n w 2 2 hull reaction forces and moments the hydrodynamic reaction forces and moment acting on the hull x h y h and n h are calculated using the unified mathematical model for ship manoeuvring in ocean and harbour area proposed by yoshimura et al 2009 this model can deal with the very large drift angle and very low speed manoeuvring which may encounter in the severe seas due to extreme wind and waves the correction factors of crossflow drag coefficients used in this model were obtained from the captive model experiments 2 3 propulsion and steering system the propulsion system arrangement is shown in fig 3 the propeller generated thrust x p and torque demand q p are calculated from the open water propeller characteristic data whereas the engine generated torque is obtained from the simplified torque fuel linear relationship model aung and umeda 2020 the propeller or engine revolution ω e is then obtained by solving the following equilibrium equation of shaft dynamics hirano and takashina 2010 4 ω e q e q p q f j t o t a l the torque loss due to friction q f from eq 4 is assumed to be neglectable for the engine speed control a proportional integral pi type governor is used in order to safeguard the engine from mechanical and thermal loads the fuel limiter is also incorporated into the governor so that the operating point which is a combination of engine speed and power is always within the design load diagram or engine s limit envelope imo 2016 man energy solutions 2018a shigunov 2018 fig 4 shows the layout and load diagram of man b w 8s40me b9 5 tii for the smcr of 7930 kw at 137 rpm man diesel and turbo 2018 man energy solutions 2018b the rudder induced forces and moment x r y r and n r are calculated using a standard mmg model yasukawa and yoshimura 2015 the steering gear limits such as maximum rudder angle and maximum rudder rate are also considered in the steering system model 2 4 wind and wave forces and moments 2 4 1 sea condition definition environmental conditions are defined by the beaufort numbers bf no which in turn relate to the wind speeds and significant wave heights as shown in table 1 wmo 2011 the mean wave period is chosen as the most critical one based on the average largest of 2nd order wave forces and moments around the head sea and bow quartering directions this value may not give the largest 1st order motions but is consistent with the fact the same mean wave period is used for both 2nd order wave forces and 1st order wave motions 2 4 2 wind forces and moments the wind forces and moments x a y a and n a are estimated with fujiwara s empirical method fujiwara et al 2001 1998 this estimation method which is based on a linear multiple regression model was obtained by using the experimental results of various kinds of ships with the modification for the effect of wind velocity profiles in experimental conditions the effect of fluctuating wind velocity which has low frequency components could be important for ship manoeuvring but in this study only the mean component of wind velocity we was taken into account for simplicity as the first attempt 2 4 3 wave forces and moments the added wave resistance for different ship speeds and headings x w are estimated by maruo s theory maruo 1963 with the kochin function calculated by ogilive tuck s slender body theory ogilvie and tuck 1969 the wave induced steady sway force y w and yaw moment n w are calculated by a linear 3d panel method using the green function for zero forward speed yasukawa et al 2019 these are categorized as the second order forces with respect to the wave steepness so that in irregular waves they consist of the mean components the slowly varying components due to the difference between the two frequencies of incident wave elements and the quickly varying components due to the sum of the two frequencies of incident wave elements while the quickly varying components do not affect the ship manoeuvring motion because of its very low frequency other two components could be relevant to this topic as the first attempt for simplicity the authors focused on only the mean component which are calculated with the jonswap wave spectrum by assuming they are proportional to the square of wave height based on maruo s work maruo 1963 as follow 5 x w ψ u h s t 0 2 ρ g l p p 0 c x ω ψ u ζ 2 s ω h s t 0 d ω 6 y w ψ h s t 0 2 ρ g l p p 0 c y ω ψ ζ 2 s ω h s t 0 d ω 7 n w ψ h s t 0 2 ρ g l p p 2 0 c n ω ψ ζ 2 s ω h s t 0 d ω where c x c y and c n are the non dimensionalized 2nd order wave drift forces and moment in surge sway and yaw respectively s here represents the long crested jonswap wave spectrum alongside the wave induced steady forces and moment first order zero mean oscillatory motions are also added into the ship manoeuvring motions to obtain the realistic ship motions in the actual sea so that the yaw angle and yaw angular velocity measurements from gyroscope represent the realistic ones these first order harmonic motions are calculated by transforming the motions raos which are in frequency domain into the time domain using the jonswap wave spectrum aung and umeda 2020 fossen 2011 2 5 subject ship the subject ship used in this study is a hypothetical handymax bulk carrier its hull form is originated from the kvlcc2 which is modified to have the block coefficient of 0 84 yasukawa et al 2019 2015 the 3d model of the subject ship is shown in fig 5 and principal particulars of the ship propeller rudder and propulsion engine are shown in table 2 3 conventional pid autopilot 3 1 pid autopilot setup first the authors studied how a conventional pid autopilot alone performs under very large external forces and moments fig 6 shows the block diagram of the simulation setup with pid autopilot alone pid autopilot accepts the reference heading angle ψ r e f from the operator and yaw angle ψ and yaw angular velocity r measurements from the gyroscope and then calculates the rudder angle command for the ship using the pid control algorithm the pid autopilot controller is expressed in the following equation 8 δ k p ψ ψ r e f k i ψ ψ r e f d t t d r t e δ where δ is the rudder angle and k p k i t d and t e are proportional gain integral gain differential time constant and rudder time constant respectively since first order motions are considered in the ship numerical model the yaw angle feedback into the autopilot contains the harmonic motions which are not desirable for the autopilot a kalman filter based on the 1st order nomoto k t model is used for wave filtering to remove the unwanted oscillatory yaw motions from the feedback measurements fossen 2011 to respect the physical limitations of the steering gear the limits on maximum rudder angles δ m a x and rudder turning rate δ m a x are also added into the autopilot 3 2 simulation results with pid autopilot alone time domain simulations for the course keeping of various course angles in different weather conditions are executed to access the performance of pid autopilot alone in severe weather the parameters for the pid autopilot controller are shown in table 3 the same parameters are used for all weather conditions bf no without retuning for a specific case or gain scheduling the numerical simulations are done using the 4th order runge kutta method with the time step of 0 01 s throughout this paper 3 2 1 course keeping in various bf nos fig 7 and fig 8 show the ship trajectories and timeseries of heading rudder angle ship speed and engine power for reference heading of 15 degree oblige angle in different severities of weather conditions since the ship starts with the same heading angle as the desired autopilot heading it is attempting to keep its course using the pid autopilot as shown in the figures up to the bf 8 the autopilot has no problem in course keeping significant drifting can be found starting from the bf 9 although there is large drifting in the bf 9 and bf 10 the autopilot did not use the maximum steering angle which is 35 to compensate the drifting since its task is just to maintain the ship heading at the desired reference heading and it is already fulfilling that task fig 8 therefore autopilot is working well as intended although there is undesirable drifting to avoid the drifting problem conventional autopilot alone should not be used in these conditions another layer of guidance should be added to the control system to obtain the path following behavior in the power graph of fig 8 the engine powers at the higher bf no are lower than those of smaller bf no cases this is due to the lower engine power limits at the high propeller engine loadings lower rpm in heavy weather fig 4 in severe weather the propeller curve will move to the left side lower rpm side of the load diagram and the engine could not provide the full power due to its limitations such as tuque limit thermal limit etc the more detailed information on engine limitations can be found in aung and umeda 2020 the reason that the power at bf0 case is lower than that of bf 8 is that the desired rpm is already reached in bf 0 at that power so the governor does not provide more fuel supply to the engine 3 2 2 various headings in bf 10 condition fig 9 and fig 10 show the simulation results for various autopilot desired headings in the bf 10 condition the larger drifting can be seen for the larger oblige headings to the wind and waves starting from around 30 degree heading the rudder angle is saturated and the ship suffers the uncontrollable drifting 4 ilos pid path follower to resolve the drifting problem found in the conventional pid autopilot alone a guidance system is introduced as another layer in the control system as shown in fig 11 the guidance system accepts the reference path defined by two waypoints and calculates the reference heading for the autopilot that would drive the ship onto the desired path only ship position measurement from the gnss sensors is needed to feedback into the guidance system since most of the ships are already equipped with the gnss sensors there is no need to install the additional new sensors onboard 4 1 los guidance for straight paths lookahead based line of sight los method which is a frequently used marine craft path following algorithm fossen 2011 is applied for the guidance system as shown in fig 12 in los guidance cross track error which is the perpendicular distance from the path to the ship is calculated using eq 9 and eq 10 depending on the amount of cross track error e and the predefined lookahead distance δ the los vector which is the reference heading for autopilot is calculated according to eq 11 and eq 12 fossen 2011 here the lookahead distance δ serves as the tuning parameter for the los guidance depending on the value of δ the guidance system will force the ship onto the desired path either slowly or aggressively analogous to the pid controller this parameter can be regarded as the inverse of proportional gain δ 1 k p l o s 4 1 1 ilos integral los when very large external forces and moment are involved steady offset error between the actual ship path and the desired path is expected therefore proportional effect alone in the guidance is not enough to obtain the desired performance and therefore an integral effect is added to the guidance system by modifying eq 12 into eq 13 as shown 13 x r e atan 2 e t δ p r o p o r t i o n a l e f f e c t atan 2 k i l o s e t d τ δ i n t e g r a l e f f e c t 4 2 simulation results with ilos pid path follower the parameters for ilos guidance are shown in table 4 these parameters are tuned by using a trial and error approach in the high bf numbers such as bf 9 and bf 10 the range of value of lookahead distance that ensures the stability is found to be very narrow 4 2 1 beaufort 9 bf9 condition fig 13 and fig 14 shows the comparison between the pid autopilot alone and the ilos guidance plus pid autopilot for the 15 degree heading path in bf 9 by adding the ilos guidance a smaller reference heading is put into the autopilot to compensate for the drifting and the ship was found to successfully follow the path although the ship trajectories between two approaches significantly differ there is no large difference in the rudder angle commands moreover the rudder angles are also very small these conclude that small differences in rudder angles can make significant differences in ship trajectories under large external forces in addition these small and precise rudder commands might not be able to execute by manual control under bf 9 condition the ship was successfully able to execute the path following for various oblige paths as shown in fig 15 4 2 2 beaufort 10 bf10 condition fig 16 and fig 17 show the comparison of conventional pid autopilot and ilos guidance plus pid autopilot under bf 10 condition there are some oscillations at first since the ship is not at the equilibrium condition initially in bf 10 the guidance system gave nearly head sea reference heading to autopilot to compensate the drifting and at the same time to keep the ship on the desired path as shown in fig 18 in bf 10 the ship was able to follow the oblige path of up to 25 degree starting from the 30 degree path the drifting is too large and failed to follow the path regardless of the maximum steering effort for this particular ship 30 degree oblige path can be regarded as the limit for the path following in bf 10 moreover it can be concluded that in severe weather conditions keeping the head sea course is safer than keeping the other oblige courses since the ship is less effaced by the wind and wave forces on the lateral direction therefore keeping the side drift force and yaw moment at minimum furthermore conventional propulsion systems are designed to deal with longitudinal force only therefore it is recommended to keep the head sea heading if the ship encounters the adverse weather conditions however on the other hand it might be difficult to accurately identify the relative wind and wave directions in the real sea since they could be changing with time and they may not be exactly aligned with each other the authors acknowledge that it is not fair to directly compare between pid autopilot and los pid path follower since they are intended for different tasks the former for the heading control and the later for path following here the authors aim to highlight the shortcomings of using the conventional pid autopilot alone in the severe weather conditions and how these shortcomings could be solved by adding a simple guidance system 5 oc ilos pid path planner follower in the previous setup it was assumed that there are no obstacles on the path to be followed by the ship so it was a simple straight line path following however in real situations there may be some obstacles on the way for instance small islands in the coastal area or anchored ships near the port therefore in the next step the authors tried to add the obstacle avoidance feature into the control system using a path planner as an additional layer over the guidance system the diagram of the simulation setup for the path planner follower is shown in fig 19 there are various algorithms for surface vehicle collision avoidance path planning such as variants of a lee et al 2015 singh et al 2018 song et al 2019 rapidly exploring random tree rrt zaccone and martelli 2018 particle swarm optimization pso kang et al 2018 artificial potential field apf lyu and yin 2019 trajectory unit cell based methods du et al 2019 2018 optimization based methods bergman et al 2020 bitar et al 2019 ma et al 2018 etc each of these algorithms has different complexities and advantages some of them are fast enough to be realized in real time updating or replanning the path as the ship moves but there will be compromises in performance and features available in this study the authors proposed to use trajectory optimization to or optimal control oc as an offline path planner to obtain the optimal collision free path trajectory optimization is the finding of optimal states and corresponding control sequences of a dynamical system here a ship between the given initial and final conditions it is a technique for computing an open loop solution to an optimal control problem ocp the optimality or cost function is defined by the mission objectives such as minimum time minimum energy usage maximum passenger comfort minimum damage to the ship structure and combinations of these and so on various constraints may be imposed on the problem the dynamic constraints of the vehicle e g manoeuvring limits a ship may not execute a very sharp turn suddenly the physical limitations of actuators e g maximum rudder angle and rudder rate limitation of propulsion machinery the obstacles on the way and navigation channel limits etc the goal is to find the solution trajectory that is both feasible and optimal as mentioned above oc based trajectory optimization has several advantageous features compared to the other path planning methods it can explicitly consider the dynamics of the ship which is very important for the large inertia ship with poor maneuverability as a result the resulting collision free path could easily be followed by the path follower without any problem if the environmental disturbances can be measured and modelled they can also be considered in the path planning stage giving a path with better feasibility moreover various actuators and obstacles constraints can be taken into account explicitly in the path planning the various cost functions can be designed depending on the mission requirements one major disadvantage of trajectory optimization is that it could be computationally expensive depending on the problem formulation and required performance or accuracy however in the cases where the planned path does not need to be updated very frequently the computation problem may not be a limiting factor for practical implementation a brief literature survey on track keeping autopilot is given here the development of track keeping autopilots has started around 1990 and primarily intended for automatic execution of special maneuvers of the survey vessels and minehunters and so on later they are also applied to commercial vessels for automatic course changing along a prescribed route track controllers designed using a combination of feedforward and linear quadratic gaussian lqg feedback control can be found in bertin 1998 holzhüter 1997 1990 holzhüter and schultze 1996 works on fuzzy logic based track keeping autopilots can be found in cheng et al 2006 omerdic et al 2003 velagic et al 2000 tracking controllers can also be regarded as the path following controllers when there is no temporal constraint along the path or the ship s speed is independently controlled or kept constant another popular approach for path following control is the line of sight los guidance which has typically been employed for surface to air missiles theory and applications of los guidance for marine craft guidance are extensively discussed in breivik 2010 breivik and i 2009 fossen 2011 1994 fossen et al 2003 moreira et al 2007 in recent years backstepping technique and sliding mode control have been applied to path following and trajectory tracking of the surface vessels and underwater vehicles fossen 2011 liao et al 2011 xu et al 2015 zheng et al 2017 a ship track control system usually includes two parts 1 a path trajectory generator and 2 a path follower or trajectory tracker in most studies of the track keeping autopilots the main focus is usually on the motion control part of the system and generating the path or trajectory is usually done manually similarly route or path planning in most commercial track controllers is manually done in ecdis using a series of waypoints and straight lines in between a suitable mechanism for track changing maneuver at the waypoints is applied to get the nice transition between the two straight line paths in that case since the route path planning is done manually by the operator using a nautical chart the track segments between waypoints are usually limited to the straight lines therefore the planned path may not be optimal with respect to the obstacles and the dynamics of the ship is not considered either in the case of the proposed oc path planner collision avoidance optimal path planning can be done automatically which is important for future autonomous ships and the dynamical constraints of the ship are also taken into account therefore the path generated by the oc path planner is both optimal and dynamically feasible and it could be easily followed by the path followers 5 1 trajectory optimization problem top a standard top or ocp is defined as below eq 14 14 m i n i m i z e φ b c t 0 t f ω d τ subject to dynamics x t f t x u bounds x l o w x x u p p u l o w u u u p p t 0 t f t f constraints h t x u 0 g t x u 0 where φ bc is the terminal or boundary cost imposed at the initial and final conditions ω is the path cost imposed along the trajectory x u and t are state vector control vector and time variable respectively f is the function of the vehicle dynamics and h and g are equality and inequality constraint functions respectively 5 2 numerical solution of ocp there are two main sets of methods for solving an ocp indirect and direct methods in an indirect approach the necessary and sufficient conditions for optimality for a specific problem are constructed analytically first then these conditions are discretized forming a constrained parameter optimization problem and finally resulting optimization problem is solved in a direct approach the trajectory optimization problem is directly converted into a constrained parameter optimization problem by a transcription method either collocation or shooting then the optimization problem is solved although indirect approach gives more accurate results it involves the derivation of optimality conditions and it has particular difficulty with path inequality constraints on the other hand direct methods are much easier to solve and applicable to a wider range of problems betts 2010 in a shooting transcription only control variables are discretized and state variables are obtained by simulation usually explicit runge kutta methods i e the state transition odes are embedded in the optimization problem in a direct shooting method path constraints are difficult to implement since the intermediate state variables are not decision variables in the non linear program direct collocation transcription works by approximating both state and control trajectories using polynomial splines in a collocation approach both control variables and state variables are discretized therefore the resulting optimization problem tends to be larger but it is easier to implement the path constraints and they are easily applicable to the more general problems the discretization is typically done using implicit runge kutta schemes kelly 2017 in this study direct trapezoidal collocation method is used to solve the ocp due to its simplicity in a trapezoidal collocation the control trajectory and the system dynamics are approximated as piece wise linear functions i e linear splines the continuous states and controls variables are discretized at the specific points in time known as collocation points the continuous system dynamics are converted into a set of constraints at the collocation points using trapezoidal rule by equating the change in state between two collocation points to the integral of the system dynamics that integral is then approximated using trapezoidal quadrature as shown on eq 15 15 x k 1 x k t k t k 1 f τ x u d τ h k 2 f k 1 f k where f t x u x t is the system dynamics and h k t t k 1 t k is the time step between the collocation points in the same manner the integral in the objective function is also approximated using the trapezoidal quadrature converting it into the summation over time states and or controls at each collocation point as shown in eq 16 16 t 0 t f ω d τ k 0 n 1 h k 2 ω k ω k 1 after converting the continuous time ocp into a non linear program nlp using a transcription method it can be solved using an appropriate nlp solver the resulting solution is an open loop solution that contains both optimal control inputs i e rudder angles in this case and corresponding ship states since it is an open loop solution in a relatively coarse mesh only collision free optimal path x y from the oc path planner is utilized for subsequent guidance and control since the lower level guidance and autopilot are feedback controllers they could handle the modelling uncertainties of ship dynamics of the oc path planner the process of the oc ilos pid path planner follower can be summarized as follows the operator inputs the target pose position and orientation of the ship and obstacles into the oc path planner then path planner uses the provided cost function and the numerical ship model to solve the constrained nonlinear program nlp giving the optimal control inputs and optimal ship states the time energy optimal collision free path from oc path planner is used as a reference path for ilos guidance then ilos guidance calculates the reference heading for pid autopilot using the current ship position finally pid autopilot calculates the rudder angle command to keep or change the ship heading accordingly if the nlp solver is fast enough to update frequently dynamic obstacles e g sailing ships can be considered in the path planning stage using the additional feedback measurements integration of colreg rules should be required when other sailing ships are involved in the collision avoidance path planning however in this study the oc path planner is used as an offline path planner by only considering the static obstacles therefore no feedback measurement to the path planner is needed 5 3 los guidance for curve paths since los guidance is initially designed for following straight paths it has to be modified to follow the curve path since the path given by the oc path planner is a curve path the main difference between straight line and curve path los guidance is how the point of minimum distance on the path is obtained in the case of the straight line the minimum distance from the path to the ship is the perpendicular distance from the straight line for the curve path if the path is represented by a piece wise spline the point of minimum distance can be found by using a suitable algorithm e g distance2curve d errico 2020 a simpler approach is to calculate all distances from ship to the discretized positions on the path and then find the minimum distance among them this approach easier to implement but a fine discretization of the path is required to get the smooth transition between discretized points and it may demand more computational resource if the array size is very large therefore the number of discretized points should be selected by balancing between a smooth transition and available computational resources when the point of minimum distance x y m i n is obtained a tangent line can be drawn at that point and follow the same procedure for los guidance for the straight line path described in section 4 1 however it was found that using a small distance d δ to reduce the deviation of x y l o s from the actual path has a slightly better performance compared to directly drawing the tangent at the point of minimum distance x y m i n therefore the tangent line is drawn at x y d δ instead of x y m i n as shown in fig 20 since d δ δ serves as the total lookahead distance they should be tuned simultaneously 5 4 simulation results with oc ilos pid path planner follower the simulation scenarios are similar to the straight line path following cases from section 4 except for the circle shape obstacle with 1 km diameter placed on the path at about 2 5 km from the initial ship position there are two possible collision free paths on each side of the obstacle if the obstacle center lies exactly on the reference straight line path to favor one side of the obstacle safer side with respect to wind and wave direction in the optimization the obstacle circle s center is placed at a certain small distance offset from the reference straight line path the shape of own ship is assumed to be a point mass assuming that the real obstacles are represented by enough safety margin the choice of safety margin is user dependent but it should be at least half of the ship s total length when the ego ship is represented by a point mass at the midship the variables and functions used for ocp in the trajectory optimization path planning are shown in table 5 the wind and wave forces are not considered in the system dynamics of the ocp this eliminates the measurement and modelling of these forces in the path planner although a path planned with wind and wave forces could give the better trajectory the feasibility of the nlp becomes problematic when very large forces and moments and hard constraints are involved in the system dynamics at high bf nos since the environmental loads are not considered in the trajectory optimization the propeller revolution per minute rpm is assumed to be constant at the path planning stage and design rpm is used in addition the wave diffraction due to the obstacle in this calculation is ignored so that the obstacle used here could represent an anchored ship or an anchorage rather than an island the ocp and nlp settings and curve path ilos guidance parameters are shown in table 6 and table 7 respectively ilos guidance parameters in table 7 are tuned using trial and error approach 5 4 1 beaufort 9 bf9 condition fig 21 shows the minimum time collision free path generated by the oc path planner for head sea shown in dashed line and the trajectory of the ship that follows the generated path in bf 9 condition in this case the ship was successfully able to follow the path generated by the oc path planner without having significant deviation from the path hereinafter the circles that represent the obstacles are drawn without reducing the safety margin since the choice of safety margin is user dependent therefore safety judgment for collision avoidance is dependent on the safety margin used the performance criterion here is how well the ship can follow the generated collision free path without significant deviations along the path the time histories of reference heading calculated by ilos guidance actual ship heading rudder angle commands from autopilot ship speed and engine power are shown in fig 22 fig 23 and fig 24 show the simulation results for the 45 degree oblige path in bf 9 although there are some path deviations near the initial position due to the unbalance equilibrium at initial condition the ship also could nicely follow the 45 degree oblige path in bf 9 larger oblige paths are also found to be successfully followed in bf 9 therefore in bf 9 it can be concluded that the ship has no dangerous problem in following the collision avoidance path for all oblige headings 5 4 2 beaufort 10 bf 10 condition fig 25 and fig 26 shows the simulation results of collision avoidance path following for head sea course in bf 10 since the environmental forces are not considered in the path generation the generated paths are the same for all weather conditions as shown in fig 25 there are some path deviations along the path since the external loads on the ship are very large and the guidance system has the particular difficulties in performance and stability issue in this kind of condition due to the path deviation the ship has found somewhat passed through the obstacles if an enough safety margin is added in the representation of the obstacles the ship would not collide with the actual obstacle pid autopilot is found to have no problem in heading control since the reference heading and actual ship heading are almost same along the path as shown in the upper graph of fig 26 the oscillations around the final position are caused by sudden change in reference heading due to the non smooth transition between the curve path and the remaining straight line path in high bf no the choice of lookahead distance and the smoothness of the path are found to be very critical for the ilos guidance system this robustness issue of the guidance system found in severe weather conditions should be examined and improved in the future fig 27 and fig 28 shows the simulation results of collision avoidance path following for 25 degree course in bf 10 similar to the head sea course some path deviations exist along the path and path following performance is not as good as the bf 9 condition similar to the straight line following case 25 degree oblige path is also the limit course angle for curve path following in bf 10 condition one important finding for path following in head sea or oblige path is that the rudder angle commands used in all collision avoidance maneuvers are very small although it was expected to use the large rudder angle in avoiding an obstacle therefore early small and precise rudder movements are found to be important in executing the successful head on collision avoidance maneuver in adverse weather conditions 6 conclusion the performance of the different control strategies are studied by doing the numerical simulation with 3 dof mmg model conventional pid autopilot alone has the large drifting problem in high bf no since its function is just to control the ship heading only regardless of the ship position and drifting by adding line of sight guidance with integral effect as another layer over the autopilot the ship can advance onto the desired path with minimal deviation using the compensated reference heading for autopilot reference heading calculated by the guidance system is pointing to near head sea direction similar to crossing a river in the current the head sea course or path is found to be the least dangerous one in adverse weather conditions compared to the other oblige courses when comparing the rudder angle commands between the pid autopilot alone and ilos pid path follower there no significant differences although the trajectories significantly differ therefore a small difference in the rudder angle could give a significant difference in ship trajectory in a heavy sea a collision avoidance path planner for optimal path generation is proposed using trajectory optimization and direct optimal control for navigating near an anchorage up to bf 9 the guidance system has no problem in following the generated path for all directions in bf 10 the ship becomes somewhat course unstable so the guidance system was found to be struggling some significant deviations are found along the path in the larger oblique heading the ship was unable to follow the path regardless of the maximum rudder angle due to uncontrollable drifting the range of tuning parameters for guidance in successful path following becomes very narrow in high bf no early small and precise continuous rudder movements are found to be used to achieve the successful path following and collision avoidance maneuver under very large external loads manual rudder control by a human may have difficulty obtaining that kind of small precise rudder movements 7 future works in the present study the oc path planner is only used as an offline path planner because it is computationally demanding with advances in optimization algorithms and computer hardware oc path planner could be realized in real time i e updating the path as the ship moves in the near future in this case dynamic obstacles such as moving vessels can be considered in the path planning stages and even the control inputs calculated from the oc path planner could be used to directly control the ship another similar approach is to use the nonlinear model predictive control nmpc as an autopilot controller in place of pid autopilot since nmpc is a real time optimal control method with the moving horizon the obstacles within the horizon can be taken into account in the autopilot either as constraints or penalties in the objective function however in the preliminary study it was found that tuning of an nmpc controller is more difficult due to the more tuning parameters and its performance is also highly sensitive to those tuning parameters moreover realizing a good performance nmpc controller in real time is still difficult in practice especially for highly nonlinear and computationally expensive ship model with difficult obstacle constraints colreg rules have to be considered in the collision avoidance planning and control when sailing vessels are involved these rules can also be integrated into the cost or constraint functions of the optimization of either approach these issues should be addressed in the future to complete the control system and to eliminate the implementation problems the calculation of slowing varying wave drift forces and moment associated with the difference in frequencies between wave components as well as the fluctuating wind velocity are not included in this study as the effect of these slowly varying external forces would be significant in severe weather conditions the control system has to respond to those accordingly therefore these effects will be considered in the future to represent the complete picture in the external force calculations credit authorship contribution statement myo zin aung methodology software investigation writing original draft visualization naoya umeda conceptualization writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by a grant in aid for scientific research from the japan society for promotion of science jsps kakenhi grant number 19h02360 
21323,to guarantee the safety of a ship by preventing accidents various regulations including those related to the ship design must be followed despite these efforts accidents may occur personnel injury or oil spill are highly probable during an accident therefore this study proposes a method for analyzing the intermediate state of flooding to predict the motion of the ship and the amount of flooded water and spilled oil during an accident quasi static analysis has been primarily used for intermediate flooding analysis however limitations exist with respect to dynamic effects and ocean environmental loads to overcome these limitations a dynamic flooding analysis method is proposed in this study cummins equation is used to analyze the six degrees of freedom motion of a ship while the dynamic orifice equation is used to calculate the flow rate through damaged holes and openings in the ship additionally a method is proposed to consider the oil spill over a period this method is verified in comparison with other studies and its feasibility is confirmed using three case studies of a navy oiler graphical abstract image 1 keywords intermediate flooding dynamic flooding analysis ocean environmental load damage stability oil spill 1 introduction 1 1 research background unlike land the sea is impossible for humans to walk on and has various forces such as wave current and wind affecting its environment it is very difficult to respond to an accident at sea owing to its environmental characteristics hence the standards for design and operation of ships are set to minimize accidents that may occur during the operations of international organizations and classification society nevertheless accidents at sea are common and are often followed by personnel injury and oil spill most ship accidents are followed by flooding during flooding the ship s equipment human life and loss of its buoyancy due to the flooded water can cause tragic accidents because of changes in geometry and dynamic characteristics fig 1 shows recent ship accidents which caused severe loss of life in addition to personnel injury crude oil carriers are prone to spills during an accident oil spills have a profound impact on the marine ecosystem and surrounding coastal environment fig 2 shows the oil spill accident of hebei spirit in 2007 and surrounding area that was affected by the oil spill oil spills occur frequently during ship accidents therefore analyzing the oil spill in the event of a ship accident is important to prevent ship accidents classification societies and the international maritime organization imo require that ship design and operation follow various regulations furthermore shipbuilding companies consider the regulations from the early design stage until the early 2000s the regulations considered only the final outcome of flooding however limitations to these regulations have been identified as various external forces affect a ship accident at sea during flooding a more serious situation can occur than the final state in terms of motion and the stability of the ship therefore in the past decade various studies on flooding were conducted and regulations have been developed corresponding to the studies regulations on harmonized and probabilistic damage stability were introduced in 2009 by the safety of life at sea solas of imo 2017 for considering the intermediate flooding process to the damage stability goalds goal based damage stability project was conducted to suggest a new design paradigm for designing a safe ship papanikolaou et al 2010 in this project an improved formulation for the survival probability in case of flooding accounting for key design parameters of passenger ships and for the time evolution of flooding scenarios was developed floodstand integrated flooding control and standard for stability and crises management project was also conducted for increasing the reliability of flooding simulation tools in design and onboard use by establishing modeling principles and uncertainty bounds jalonen et al 2012 ittc conducted an experiment on damage stability for ro ro passenger ships under various conditions and compared it with benchmark tests ittc 2002 in addition the recent development allows for a more realistic assessment of the flooding process and the stability criteria in the regulation primarily relies on the characteristics of the stability curve ruponen 2018 ruponen et al 2019 furthermore imo 1992 regulates post accident operation for oil spill and the european maritime safety agency emsa is scheduled to be enforced to minimize the damage from oil spills in the mid 2020s however the amount of crude oil that may spill in a ship accident cannot be analyzed therefore this study proposes a method to analyze the process of flooding in various sea conditions in the time domain in addition the amount crude oil that would leak out of a ship during flooding is analyzed 1 2 related works since the early 1990s several time domain simulation methods for the motions of a damaged ship have been developed ruponen 2007 to analyze the actual flooding process it is necessary to analyze progressive flooding in the time domain studies on flooding analysis until the early 2000s were introduced by papanikolaou 2007 since the late 2000s various methods have been proposed for flooding analysis in the time domain ruponen 2006a 2007 performed intermediate flooding analysis in the time domain using a quasi static analysis method a hydraulic orifice equation based on the bernoulli s equation was used to calculate flow rate through an opening and a pressure correction equation was proposed to correct the air pressure that occurred during the analysis similar to previous studies dankowski and krüger 2012 and dankowski et al 2013 performed a quasi static analysis based on the hydraulic orifice equation however the continuity equation was used for air pressure correction kim et al 2017 proposed quasi static analysis using the hydraulic orifice equation and modified bernoulli s equation of air flow for the flooding analysis of barge type ships recently braidotti and mauro 2019 proposed a new calculation technique for intermediate flooding analysis based on the quasi static analysis on the other hand lee 2014 2015 proposed a dynamic orifice equation in the quasi static analysis method using the mass conservation equation and momentum conservation equation to address a limitation of the hydraulic orifice equation in addition kim et al 2020 proposed a method for considering the oil spill and cargo load during the quasi static flooding analysis using the dynamic orifice equation several studies have used quasi static analysis to simulate the flooding process the advantages of the quasi static analysis method are that the analysis is relatively simple and requires less computation time however owing to the nature of the quasi static analysis method dynamics of the ship cannot be considered and it is challenging to apply external force such as waves currents and winds therefore some studies have analyzed flooding using the dynamic flooding analysis method spanos et al 1997 and zaraphonitis et al 1997 proposed a mathematical model for the analysis of the flooding of ships in the waves for calculating the flow rate through the opening the semi empirical formula was used furthermore it was assumed that the mass of the flooded water was concentrated at the center of gravity similarly papanikolaou et al 2000 devised a coupled dynamic system for the analysis of ship motion and incoming water for dynamic flooding analysis in addition a benchmark test was conducted using the proposed method in comparison with the actual ship flooding experiment papanikolaou and spanos 2008 2005 the semi empirical method used by spanos et al 1997 zaraphonitis et al 1997 and papanikolaou et al 2000 is a method that expresses the flow in and out through the opening of the ship as the height difference at both ends of the opening and the empirical weir flow coefficient and the hydraulic orifice equation used in many studies is an equation of calculating the flow rate by assuming the ship s opening as a small orifice based on bernoulli s equation jasionowski 2001 proposed an assessment method for damage stability using strip theory rankine source method and free mass on potential surface model van t veer et al 2004 performed flooding simulation using a damaged large passenger ship in waves they used equations of the six degrees of freedom motion and a quasi stationary hydraulic flow model the aforementioned methods analyzed the motion of a ship through mathematical modeling on one hand certain studies have investigated the flooding of ships using computational fluid dynamics cfd tools strasser et al 2009 compared the results presented in ruponen 2006b using dynamic flooding analysis with the cfd tools lee et al 2012 and hamid et al 2016 used open source cfd tools to analyze the flooding of damaged ships in the waves their analysis considers the motion of the ship and movement of the flooded water inside the ship hence it can be relatively accurate with a large amount of flooded fluid inside the ship under severe sea conditions however mesh generation for the analysis and the analysis itself are time consuming caldas et al 2018 performed flooding simulation for a number of scenarios for a cruise ship at a full scale they considered flooding scenarios in calm and rough sea conditions by using the high fidelity deterministic cfd zhang et al 2019 performed time domain simulation of flooding processes under different ventilation levels considering air compression characteristics by using commercial cfd tools to take advantage of the quasi static analysis and dynamic analysis simultaneously a dynamic flooding analysis using the six degrees of freedom motion equation to analyze motions of the ship and the orifice equations to calculate the fluid through the opening of the ship was proposed manderbacka et al 2015 2016 modeled the motion of the ship as a six degrees of freedom motion of the rigid body and analyzed it in the time domain additionally the amount of fluid through the opening of a ship was calculated using the hydraulic orifice equation similarly ypma and turner 2010 performed a flooding analysis of a ship considering wave loads until recently studies that consider oil spills during flooding have rarely been conducted debra et al 2001 performed experiments using canola oil which has similar properties to crude oil in this study a dynamic flooding analysis method is proposed to analyze the intermediate flooding of the ship while considering the wave loads in addition the amount of oil spilled through the opening was analyzed table 1 summarizes the related studies and characteristics of this study 2 theoretical background in this study a dynamic flooding analysis is proposed to analyze the intermediate flooding of the ship section 2 1 describes the process of dynamic flooding analysis section 2 2 describes the dynamic orifice equations for calculating the flow through the damaged hole or openings of a ship section 2 3 introduces a method to handle the oil spill when calculating the flow rate using the dynamic orifice equation section 2 4 describes the cummins equation for the analysis of the six degrees of freedom motion of ships in waves 2 1 process of dynamic flooding analysis in this study the intermediate flooding of the ship was analyzed using dynamic flooding analysis unlike the quasi static analysis method which is generally used for intermediate flooding analysis dynamic flooding analysis considers the dynamic motion of the ship hence it is necessary to solve the six degree of freedom equation that considers external forces such as waves during this process the amount of fluid flowing through the damaged hole or opening inside the ship should be calculated by substituting this result in the six degree of freedom equation we can perform the dynamic flooding analysis fig 3 summarizes the sequence of dynamic flooding analysis to perform the dynamic flooding analysis mesh modeling is required the mesh model includes the hull model the compartments where flooding occurs the compartments where the center of gravity changes depending on the attitude of the ship due to liquid cargo openings between compartments and damaged holes of course in the case of flooding between the compartments modeling of connections between them is included additionally damaged holes should be modeled when the external hull is damaged modeling for the dynamic flooding analysis is relatively easy the mesh model used in this study is compatible with the mesh model used in general visualization so it is much simpler to generate it than the mesh model used for cfd analysis the difference between the mesh model of this study and the mesh model for cfd analysis is shown in fig 4 the initial conditions are set for the analysis the initial states require the weight distribution of the hull and volume of cargo carried in each compartment hence the analysis begins after obtaining these values the analysis is performed in the time domain and the same task what to mention in later is performed at each time step depending on the modeled structure the dynamic orifice equation is used to calculate the mass flow in and out through each opening figs 3 1 the calculated mass flow includes all the fluid flowing through the openings of a ship air water and oil are considered as fluids for calculating in this study by multiplying the mass flow of each fluid calculated using the dynamic orifice equation with the unit time of analysis it is possible to obtain the inflow and outflow of fluid in a section per unit time figs 3 2 next the mass and center of gravity of the ship can be calculated using the mass change of each compartment figs 3 the dynamic motion of the ship is calculated by substituting the changed weight and center of gravity in the cummins equation for the six degrees of freedom motion analysis figs 3 4 then the changed position and attitude of the ship per unit time can be calculated and the amount of flooded water in each compartment can be obtained by repeating the aforementioned steps 1 4 the dynamic flooding analysis can be performed the shapes of the fluids contained in the ship change with the change in the attitude of the ship during the analysis therefore the center of gravity of the fluid inside each compartment is recalculated when this change occurs while considering the free surface of the fluid accordingly figs 3 5 fig 5 graphically shows the steps of the dynamic flooding analysis each step shows the midship section of the ship 2 2 dynamic orifice equation to proceed with the flooding analysis of the ship in the time domain it is necessary to calculate the flow rate of the fluid flowing through the damaged hole or opening connecting the compartment inside the ship at every time step as shown in table 1 many studies have calculated the flow rate using the hydraulic orifice equation the hydraulic orifice equation calculates the velocity at the orifice using the bernoulli s equation and the mass flow rate of the fluid flowing through the orifice using velocity as bernoulli s equation was derived along the streamline inducing the orifice velocity also proceeds along the streamline fig 6 shows the orifice connecting the two compartments and the streamline of fluid moving through it in fig 6 points p1 and p2 located on the same streamline with compartments 1 and 2 satisfy the bernoulli s equation as shown in eqs 1 and 2 1 p 1 2 ρ v 2 ρ g z c 2 p 1 1 2 ρ v 1 2 ρ g z 1 p 2 1 2 ρ v 2 2 ρ g z 2 where ρ is the density of the fluid p is the pressure g is the gravitational acceleration z is the vertical position of the streamline and v is the fluid speed eq 2 is for incompressible flow because it does not include the pressure term that varies by density in bernoulli s equation if the area of the orifice is small the velocity of flow v 1 at p1 can be assumed to be zero then eq 2 can be derived as eq 3 3 1 2 v 2 2 1 ρ p 1 p 2 g z 1 z 2 it can be observed from eq 3 that the velocity v 2 of the fluid at p2 is determined by the pressure and height difference if there is no difference in height between the two points p1 and p2 v 2 can be derived as eq 4 the flow rate q through the orifice can be obtained by multiplying the area a with the velocity through the orifice as shown in eq 5 4 v 2 2 ρ δ p 5 q ρ c d a v ρ c d a 2 ρ δ p where c d is the discharge coefficient the c d corresponds to the shape of the orifice and generally equals 0 6 0 7 lee 2014 if the area of the orifice is large and pressure difference within the area changes the speed can be integrated within the orifice cross sectional area the hydraulic orifice equation for calculating the flow rate as shown in eq 5 has two limitations first the bernoulli s equation is derived for the steady flow so as to not consider the dynamic effect in addition as it is assumed to be a newtonian fluid it can be applied to a small area orifice hence it is difficult to apply it to a large opening eq 5 is the square root function of pressure differences it also has a singular behavior for the square root function therefore when the pressure difference at both ends of the opening is large it can be applied without any problems however when the pressure difference approaches 0 the rate of change can be infinitely divergent resulting in an abnormal solution a detailed explanation of this phenomenon was presented in the study of lee 2015 other studies using the hydraulic orifice equation did not use only eq 5 but tried to solve this by additionally using the pressure correction equation and the continuity equation therefore in this study the dynamic orifice equation lee 2015 that was developed to resolve the aforementioned problems was used the dynamic orifice equation is calculated based on five assumptions 1 the fluid is incompressible 2 the pressure at the inlet boundary ar is equal to p0 and the fluid velocity flows parallel to the normal vector n of ar 3 the fluid velocity and pressure gradient in the control volume c 1 are constant 4 the fluid passing through the orifice is non viscous 5 the fluid is considered to be flowing normal to the opening therefore we can define the inlet and outlet control volume as shown in fig 7 the dynamic orifice equation can be derived by applying the mass conservation law and momentum conservation law to the control volume of the inlet and outlet as shown in fig 7 the mass conservation law and momentum conservation law using an integral euler equation can be derived as eqs 6 and 7 6 c s v d a 0 7 f s x f b x t c v u ρ d v c s u ρ v d a where v is vector of speed f s x and f b x are surface and body forces u is normal speed of orifice a is area for integral ρ is density of fluid v is a volume of the control volume and a is the area of the control surface if the mass conservation law is applied to the control volume c1 of the outlet it can be derived as eq 8 in addition if the aforementioned assumptions 3 and 4 in the momentum conservation law are applied to c1 and it is assumed that no external force acts in the normal direction eq 7 can be derived as eq 9 8 o p e n i n g u d a u 1 a 1 q 9 o p e n i n g p d a p 1 a 1 t c v 1 u ρ d v where q is the mass flow of fluid this process can be applied to the control volume c0 of the inlet the mass conservation law is applied to c0 and by substituting the flow rate q obtained in eq 8 the velocity v of the fluid passing through the opening can be obtained as eq 10 in addition the momentum conservation law is applied to c0 and by substituting in eqs 9 and 10 to applied equation the dynamic orifice equation can be derived as eq 11 10 v n 1 2 π r 2 q 11 a o p e n i n g 2 u t 7 8 u 2 p 0 p 1 ρ the dynamic orifice equation is a differential equation that inputs the opening area a opening time interval dt pressure p 0 and p 1 at both ends of the opening and density ρ of the fluid at the higher pressure side by solving the differential equation based on the inputs the velocity of the fluid u passing through the opening can be determined the mass flow of fluid q can be calculated as shown in eq 12 the process of inducing the dynamic orifice equation was explained in detail by lee 2015 12 q ρ u a o p e n i n g δ t 2 3 consideration of oil spill for dynamic orifice equation as described in section 2 2 the flow rate of the fluid flowing through the opening was calculated using the dynamic orifice equation various studies using the hydraulic orifice equation krüger et al 2012 lorkowski et al 2014 ruponen 2018 ruponen et al 2018 2013 and dynamic orifice equation lee 2015 2014 limited the type of fluid passing through the opening to seawater and air therefore if the cargo tank in the ship contains oil its amount of inflow and outflow cannot be calculated imo 1992 regulated the rules to handle the oil when oil spills occur in ships in accordance with the regulations tavakoli et al 2011 compared analytic models of an instantaneous oil spill and experimental tests for damaged ships puolakka 2020 conducted a fluid mechanical analysis for the wave induced oil spill of a damaged double hulled tanker in addition price et al 2003 ha et al 2013 and others have studied the spreading of the oil spilled from ships at sea kim et al 2020 considered the oil spill when using the dynamic orifice equation therefore developing on the previous study this study improved the dynamic orifice equation to analyze the amount of oil that flows out of the ships when calculating the inflow and outflow of fluid in a ship the intersections in the openings are categorized into three types as shown in fig 8 according to the type of intersection the dynamic orifice equation can be used as eqs 13 15 where a aa a wa and a ww are the area of the air air intersection area of the water air intersection and area of the water water intersection respectively p air1 and p air2 and p water1 and p water2 are the air pressures and water pressures in compartments 1 and 2 respectively as previously mentioned if the opening is composed of three intersections the flow rate can be calculated through nine cases depending on the fluid level at both sides of the opening in this study we intend to expand this concept and use it to calculate the flow rate of oil in a ship according to thrift viveros et al 2015 and fingas 2017 the national oceanic and atmospheric administration noaa suggests that the analysis of oil spills of similar properties can be substituted with other fluids oils with similar properties are boscan crude bunker c california heavy and canola oil in contrast oils containing surfactants are different from those described above in addition such oils dissolve in water and spread rapidly in this study the analysis of oil flowing separately from water was performed oils containing surfactants were not considered the viscosity of the oil was neglected because the dynamic orifice equation was used in this study to calculate the oil spill using the dynamic orifice equation three additional intersections are required in addition to the three intersections shown in fig 9 the three intersections are oil air oil oil and water oil therefore six intersections should be considered to estimate an oil spill deriving the dynamic orifice equations for the three additional intersections can be expressed as eqs 16 18 where a oa a oo and a wo are the area of the oil air intersection area of the oil oil intersection and area of the water oil intersection respectively p oil1 and p oir2 are the oil pressures in compartments 1 and 2 respectively if an opening is composed of the six intersections an additional 35 cases are required depending on the fluid level at both sides of the opening in eqs 13 18 the unknown is the flow u flowing through the intersection if the fluids at both sides are the same ρ is the density of the higher pressure side similarly even if the types of fluids at both sides are different as the pressure moves from the high pressure side to the low pressure side the fluid at the high pressure side moves to the low pressure side and accordingly ρ follows the density at the high pressure side in this study oil spills from ships were analyzed by separating the aforementioned 35 cases 2 4 equations of motion in the time domain through the dynamic orifice equation the amount of fluid flowing through the opening in the ship can be calculated at every time step when the amount of fluid in the compartment changes the weight and center of gravity of the compartment change accordingly thus the center of gravity and weight of the ship changes therefore to calculate the six degrees of freedom motion of the ship the ship s weight and center of gravity that vary at each time step should be calculated as the ship is at sea various environmental loads act on it therefore the hydrodynamic force must be considered when calculating the six degrees of freedom motion of a ship hydrodynamic forces mainly consist of two parts they are the wave exciting force caused by the incident wave and radiation force caused by the ship moving at sea the radiation force is further composed of two components the force proportional to the acceleration of motion and force proportional to the speed of motion ham et al 2017 it can be expressed as eq 19 19 f h y d r o d y n a m i c f e x c i t i n g f r a d i a t i o n the ship s six degrees of freedom motion equation should include the aforementioned components of the hydrodynamic force the cummins equation cummins 1962 can represent the ship s six degrees of freedom motion equation considering the wave exciting force in the cummins equation the force response amplitude operator rao can be calculated by multiplying the sinusoidal function at a given frequency furthermore the force rao can be obtained using a commercial solver such as wadam by dnv in addition a radiation force is required to calculate the cummins equation and the radiation force must consider the impulse response of the floating body in the time domain the wave exciting force and radiation force are given in eq 19 and can be expressed as eqs 20 and 21 to calculate the radiation force the frequency dependent added mass coefficient a ij ω and damping coefficient b ij ω at a given frequency ω are required these coefficients can be obtained by the aforementioned commercial solver 20 f e x c i t i n g f ω cos ω t ε 21 f r a d i a t i o n a v t 0 b σ v t σ d σ using the frequency dependent coefficients a ij ω and b ij ω the added mass a and retardation function b τ can be obtained the added mass a which is a constant matrix is used in the infinite motion frequency rather than the integral form ham et al 2020 this is because the equation is available at any frequency ω using the obtained radiation force and wave exciting force we can obtain the equations of motion in the time domain cummins equation as eq 22 finally eq 22 can be derived as eq 23 22 m x f r a d i a t i o n f r e s t o r i n g f e x c i t i n g a x 0 b τ x t τ d τ c x f ω cos ω t ε 23 m a x 0 b τ x t τ d τ c x f ω cos ω t ε where the mass term m and restoring term c vary depending on the ship s weight and center of gravity therefore in this study m and c were updated using the ship s weight and center of gravity modified by the dynamic orifice equation before solving the equations of motion at every time step 3 verification of dynamic flooding analysis in this study a dynamic flooding analysis method was proposed to analyze the flooding considering while the environmental load this section verifies the proposed method by comparing it with three other results in section 3 1 it was confirmed that the dynamic flooding analysis method is consistent with the existing quasi static flooding analysis in section 3 2 the accuracy of the proposed method was compared with the dynamic flooding analysis conducted by sadat hosseini et al 2016 in section 3 3 to verify the accuracy of the oil spill the experimental results of debra et al 2001 were compared with those of this study 3 1 comparison with the quasi static method lee 2015 performed a flooding analysis of the ship using the quasi static analysis with the dynamic orifice equation the dynamic orifice equation was used in this study however a dynamic flooding analysis was proposed incorporating the six degrees of freedom equation the quasi static analysis is a method of finding a static position and attitude at every time step and cannot consider the dynamic effects and environmental loads however owing to the simplicity of the analysis the analysis speed is high and the mesh model for the analysis is relatively simple the dynamic analysis is slower than the quasi static analysis but it can compensate for the aforementioned limitations of the quasi static analysis if flooding occurs in a ship floating in still water with no environmental load the final state of the quasi static analysis and dynamic analysis should be the same in this study to confirm that the proposed dynamic analysis works correct we compared the results with those of the quasi static analysis and confirmed that the final state was the same to compare the differences between the two analysis methods the behavior of a 20 000 ton class navy oiler which is damaged in the outer shell was used for the comparison the damaged compartment was assumed to have been damaged by 2 m 2 m in the ballast tank of the starboard as previously mentioned it was assumed that there was no environmental load the detailed shape and damaged hole of the model for verification are shown in fig 10 when the ballast tank is damaged the external seawater flows into the damaged hole and the ship gradually tilts toward the starboard the ship sinks slightly due to the weight of the seawater the quasi static analysis showed that the equilibrium was reached in approximately 90 s the quasi static method took a total of 263 s and the dynamic method took a total of 258 s for the analysis therefore it is judged that there is no significant difference in calculation performance in the dynamic analysis the inflow of seawater reached the final state at a time similar to that of the quasi static analysis however the results showed that the motion remained the same due to inertia fig 11 shows the state of the ship visualized during the quasi static analysis fig 12 shows the motion of ship during flooding analysis in the quasi static analysis the motion continued until equilibrium was reached in the dynamic analysis the motion continued due to the inertia therefore in this study three motions roll angle pitch angle and heave were compared for the two methods comparing the roll angle the ship inclined 4 23 at the final equilibrium state using the quasi static analysis in the dynamic analysis an extremely small difference of 0 03 occurred due to a slope of 4 26 when it was converged comparing the pitch angle the ship showed a very slight difference of 0 002 at 0 025 in the final state using the quasi static analysis and 0 023 in the dynamic analysis in the heave motion the two methods showed a slight difference of 0 001 m the quasi static analysis was at 0 105 m and dynamic analysis was at 0 104 m respectively as previously described the tendency to reach the final state is very similar however in the dynamic analysis it tended to oscillate due to the inertia force until the motion converged fig 13 shows the amount of seawater in the ballast tank compartment with damaged holes during the analysis as the seawater steadily flowed through the process for approximately 90 s the difference between the quasi static and dynamic analysis was 1 ton showing a very slight difference in the two methods when there are no external forces due to environmental loads the behavior of the ship tends to be very similar until the final equilibrium state the effectiveness of the dynamic analysis was confirmed because additional dynamic effects can be considered 3 2 comparison with the analysis and experiment by sadat hosseini et al 2016 in section 3 1 the replaceability of the quasi static analysis with the dynamic analysis and similarity of the analysis results are confirmed the flooding analysis of a navy oiler in section 3 1 shows that the damaged hole size is very small when compared with the ship size such that the transit motion is less therefore the two methods are similar however the greater the extent of damage when compared with the size of the ship the greater are the dynamic effects sadat hosseini et al 2016 performed a flooding experiment owing to large damage to the model of a cruise ship and analyzed it using cfd to analyze the applicability of the dynamic flooding analysis proposed in this study to the damaged ship which has large damage with transit motion the results of this study were compared with the experimental data and cfd data of sadat hosseini et al 2016 sadat hosseini et al 2016 established a model using the ship s linearity of the cruise ship released by the ship stability research center ssrc and compartments for flooding analysis the shape of the hull and compartments are shown in fig 14 table 2 summarizes the principal dimensions of the model ship as detailed in fig 15 the cruise ship model has two compartments with a damaged hole and opening one with the external hole is equipped with a probe to measure the water level as shown in fig 15 water flows through the damaged hole in the starboard and water is transferred through the opening between the compartments fig 16 shows the comparison of the roll angle during flooding the red and black dashed lines represent the experimental results and cfd results of sadat hosseini et al 2016 respectively and the solid blue line represents the results of this study although the results of this study and the experimental results were more similar in amplitude than cfd analysis results the roll period of the ship tended to be shorter this is because the hull mesh used in this study was configured as a triangular mesh for analysis and the natural frequency of the hull form was not preserved fig 17 shows the water height at the probe in the compartment similar to fig 16 the red and black dashed lines represent the experimental and cfd analysis results of sadat hosseini et al 2016 respectively the solid blue line indicates the results of this study the water level initially appeared smaller than that in the experimental results after 2 s it showed almost the same value as that in the experimental results although the dynamic flooding analysis proposed in this study exhibits a certain difference it can be used with a slight difference from the experimental results despite large damage 3 3 comparison with the experiment by debra et al 2001 in this study to predict the amount of oil flowing out of the ship a method to consider oil in the dynamic orifice equation was proposed in section 2 3 to determine the applicability of the proposed method the results of this study were compared with those of the two experimental data of debra et al 2001 debra et al 2001 filled the box container with canola oil in the first experiment and drilled a circular hole to allow the oil to flow out the height of the oil in the container changed and the height of oil was measured in the second experiment the same container as in the first experiment was placed in another container filled with water such that the oil spilled into the water the water level and height of oil were measured the density of canola oil used in the experiment was 0 91 kg m3 the details of the experimental model are shown in fig 18 the graph comparing the results of the first experiment with this study is shown in fig 19 at the end of the analysis the oil flowed out and maintained the same height but there was a slight difference in speed in the middle part of the analysis the graph comparing the results of the second experiment with those of this study is shown in fig 20 the decrease in the oil level owing to the oil spill through the hole is extremely similar to the experimental data however although the final amount of water is the same the water flow rate is different at the midpoint of the analysis this is because the dynamic orifice equation used in this study does not consider the viscosity of the fluid and it is assumed that a certain amount of mixing occurs as the oil flows out and water flows in when the results of this study were compared with those of the two experiments conducted by debra et al 2001 the results were sufficiently accurate the results of this study are very similar to those of previous studies kim et al 2020 the movement of the container was not taken into account because the oil box was fixed in the experiment so that the results show similar consequences therefore it is expected that the dynamic flooding analysis method proposed in this study can be used for oil spills 4 applications in this study a dynamic flooding analysis method considering the dynamic effects and environmental loads were proposed to verify the effectiveness of the method proposed in this study three case studies were performed in this section the ship s model used in the case study is described and the significance of each case study are discussed in addition the efficiency of the proposed method is discussed 4 1 prototype program for dynamic flooding analysis in this study for efficiency analysis a prototype program was developed to perform intermediate flooding analysis of ships using the proposed method the core analysis engine of the program was developed using c language in the net environment and a graphical user interface gui for efficient analysis was developed using windows presentation foundation wpf the program can be divided into five parts the first ribbon menu was configured for easy use of the program by borrowing the same interface as the existing microsoft programs the simulation timeline was developed to check the actual time taken for analysis and simulation time passed during the analysis the model tree represents the required components for the analysis such as a hull model and openings or damaged holes in compartments a 3d visualization shows the behavior of the ship and amount of fluid in real time through during the analysis finally the report view tracks the analysis results set by the user while the analysis is in progress and displays them graphically fig 21 shows the screenshot of flooding analysis through the prototype program 4 2 application target and case descriptions in this study a case study was performed using a 20 000 tons class of navy oiler kim 2019 a navy oiler is a military ship and the purpose of the operation is to carry military oil the oiler resembles the structure of a merchant ship rather than a naval ship performing general military operations as shown in fig 22 the part related to the flooding analysis in the actual navy oiler was modeled through the lines and general arrangement the model used in this study was a simple triangular mesh for visualization and not the mesh conventionally used in cfd analysis therefore the time and effort required for mesh modeling can be reduced the main specifications of the navy oiler used in this study are listed in table 3 in this study three case studies were performed to confirm the effectiveness of the dynamic flooding analysis method the case study compared the difference between the quasi static analysis which was mainly used in the intermediate flooding analysis and dynamic flooding analysis method proposed in this study in the first case study the results of the quasi static and dynamic analyses subjected to the wave load were compared when the ballast tank was damaged second the difference between the quasi static and dynamic analyses was compared when the damage was large finally in the third case the difference between the quasi static and dynamic analyses was compared when the oil spilled through the damaged hole the environmental load regular sinusoidal waves applied to each case was assumed to have a wave height 1 m wave period 10 s and head sea in general it is assumed to be the most severe situation for ships as the beam sea however when the military ship is damaged the ship should turn the bow to the head sea condition by regulation hence we assumed it to be the head sea the detailed description of each case is summarized in table 4 for each case the satisfaction of the damage stability regulation was evaluated in the intermediate and final states as mentioned above the target ship for the case study is a naval ship of the korea navy hence five criteria of the korea navy 2014 were applied the damage stability criteria in the intermediate state were evaluated assuming that the ship s motion is fixed at each time step therefore it is possible to check whether the damage stability criteria are satisfied in a situation where both flooding and dynamic motion co occur 4 3 case studies case 1 reproduces the situation where seawater flows in through the damaged hole of the ballast tank case 1 1 was analyzed until the equilibrium state was reached using the quasi static analysis and case 1 2 was analyzed using dynamic analysis under environmental load fig 23 shows the process of flooding and sequence of seawater gradually flowing through the damaged hole in the ballast tank which is a double hull structure the motion of the ship in cases 1 1 and 1 2 during the analysis is shown in fig 24 and the amount of seawater entering through the damaged hole during the analysis is shown in fig 25 case 1 1 was conducted using the quasi static analysis and it took approximately 73 s to reach the equilibrium state due to the flooding comparing the roll motion of case 1 the quasi static analysis reached a maximum angle of 4 37 at an equilibrium of 73 s in case 1 2 the motion continued under environmental load even when the equilibrium was reached and the maximum angle was 5 12 in the heave motion the quasi static analysis showed a maximum motion of 0 13 m at the equilibrium state the dynamic analysis showed the tendency to continuously oscillate due to the influence of the environmental load and the maximum motion was 0 71 m the amount of seawater flowing into the ballast tank was similar to 492 ton and 494 ton in cases 1 1 and 1 2 respectively table 6 shows the results of evaluating the criteria in table 5 during the analysis in cases 1 1 and 1 2 five damage stability criteria were satisfied in the final and intermediate states case 2 reproduces the ship s flooding process when it has severe damage in starboard case 2 1 was analyzed using the quasi static analysis until equilibrium was reached and case 2 2 performed the dynamic analysis under the condition of environmental load fig 26 shows the process of flooding in case 2 the seawater gradually flows through the three damaged holes in the ballast tank which is a double hull structure in addition there was a damaged hole in the main engine room for the seawater to flow into the compartment in case 2 it was assumed that the ship suffered severe damage than case 1 the motion of the ship in cases 2 1 and 2 2 during the analysis is shown in fig 27 and the amount of seawater entering through the damaged holes during the analysis is shown in fig 28 case 2 1 was conducted using the quasi static analysis and it required approximately 81 s to reach the equilibrium state due to the flooding comparing the roll motion of case 2 the quasi static analysis reached a maximum angle of 14 49 in the equilibrium state in the dynamic analysis the motion continued under the environmental load even when the equilibrium was reached and the maximum angle was 15 10 in the heave motion the quasi static analysis showed a maximum motion of 0 09 m at the equilibrium state furthermore the dynamic analysis showed the tendency to continuously oscillate due to the influence of the environmental load the maximum motion of the heave in the dynamic analysis was 0 22 m the amount of seawater flowing into the damaged compartments was 2652 ton and 2585 ton in cases 2 1 and 2 2 respectively the error was 67 tons due to the ship s motion during the waves and movement of the damaged holes table 7 shows the results of evaluating the criteria of damage stability during the analysis of case 2 case 2 1 satisfies the criterion of damage stability in the final and intermediate states while case 2 2 does not satisfy the first criterion of damage stability in the intermediate state the first criterion for damage stability is that when the ship is damaged the initial heeling angle due to the damage should not exceed 15 considering the effects of dynamic motion and environmental loads which are difficult to express in the quasi static analysis it suggests that a situation more dangerous than the final state may occur in an intermediate state of flooding as observed in case 2 therefore we should check the damage stability during the intermediate flooding process case 3 reproduces the case of oil leakage due to the damage propagated to the internal cargo oil tank compartment caused by the severe damage to the double hull structure case 3 1 was analyzed using the quasi static analysis until the equilibrium was reached and case 3 2 was performed using the dynamic analysis under the condition of environmental load fig 29 shows the process of flooding and situation where seawater enters owing to external damage and oil leaks due to internal damage in case 3 unlike the previous case the amount of oil spilled was tracked the motion of the ship in cases 3 1 and 3 2 during the analysis is shown in fig 30 in case 3 the heave motion of the ship was insignificant and excluded from the comparison in fig 31 the amount of seawater entering through the damaged hole during the analysis was compared with the amount of oil leaked from the ship case 3 1 was performed using the quasi static analysis and it required approximately 207 s to reach the equilibrium state in the roll motion of case 3 in the quasi static analysis the maximum angle was reached 2 02 at the equilibrium state at 207 s in the dynamic analysis the motion continued under environmental load even after reaching the equilibrium and the maximum angle was 3 06 the amount of seawater flowing into the damaged compartments reached equilibrium in case 3 1 and no longer flowed in at 201 tons however in case 3 2 it tended to increase continuously in the oil spill case 3 1 reached equilibrium and stopped at 304 tons of outflow in case 3 2 the oil is continuously leaking table 8 shows the results of evaluating the criterion of damage stability during the analysis of case 3 in both the cases the damage stability criteria were satisfied even during the intermediate state as previously described cases 1 and 2 were damaged in places where the liquid cargo was not loaded and after a certain time the inflow of seawater reached a steady state however in case 3 the damage proceeds to the cargo oil tank cot inside the ballast tank and seawater flowed for a long time while the oil leaked fig 32 shows the process of the oil spill in detail initially the oil leaks from the cot to the ballast tank the oil level does not reach the external damage and the amount of oil spill was maintained at zero after approximately 20 s the oil level of the ballast tank reached the external damaged hole and the oil started to leak rapidly as the oil level of cot is higher than the oil level of the ballast tank the outflow rate of oil was maintained almost constant until approximately 100 s from approximately 100 s the three levels which were the oil level of cot oil level of the ballast tank and external water and outflow rate of the oil were decreased in the quasi static analysis a small amount of oil flows out and the equilibrium was reached in 207 s in this study the dynamic orifice equation described in section 2 2 was used and the flow rate was generated by the pressure difference between the openings in addition in the case of oil and water it was assumed that they did not mix and peeled off therefore under certain conditions the equilibrium was reached when the pressures of the two levels are equal however in general when oil leaks owing to an accident all the oil in the cot leaks out this can be analyzed through the proposed dynamic flooding analysis method owing to the dynamic behavior there is a small but continuous motion which can be analyzed fig 33 shows the amount of seawater and oil spill of approximately 2 h 46 m 10 000 s after the quasi static analysis reached the equilibrium state in fig 31 as observed in fig 33 after 300 s the seawater continuously flows and oil leaks until approximately 23 m 1400 s the seawater continuously flowed into the ballast tank and the oil in the cot flowed out gradually after approximately 23 m 1400 s the seawater level of the ballast tank reached the damaged hole inside and the seawater began to flow into the internal cot when observing the analysis results at approximately 2 h 46 m 10 000 s the seawater gradually filled the internal cot after 2 h 46 m 10 000 s the dynamic flooding analysis continues until all the oil in the cot flows out and the seawater level in the inner cot and ballast tank reaches the outer waterline using the dynamic flooding analysis it is possible to precisely describe the process of oil spill in a ship during a disaster 5 conclusions and scope for future work in this study a method for dynamically analyzing the process of intermediate flooding was proposed considering oil spill as the quasi static method which is mainly used to analyze the intermediate flooding process cannot consider dynamic effects it is difficult to consider effects due to transit motion and environmental loads using this method therefore to overcome this limitation the method for dynamic flooding analysis was proposed in this study as mentioned in section 1 2 various methods for the dynamic flooding analysis were proposed this study sought to develop a dynamic flooding analysis method by referring to various studies for this cummins equation was used as a six degrees of freedom equation to analyze the dynamic motion of a ship and the flow rate through an internal or external opening was analyzed using the dynamic orifice equation during the flooding process the shape and center of gravity of the fluid inside the ship were considered and the dynamic flooding analysis was performed by updating it in the cummins equation at every time step furthermore the method for the oil spill which was difficult to consider using the existing dynamic orifice equation was additionally considered and applied for the application of the proposed method a prototype program was developed for the user to perform the flooding analysis the method was compared and verified with methods proposed in various studies in addition the proposed method was applied to realistic examples to confirm its effectiveness and applicability in particular it was found that by considering the dynamic effects and environmental loads during the flooding process a more serious situation may occur during the flooding process it was further confirmed that the process of the oil spill of the ship could be realistically reproduced further research is required to improve the proposed method as this study was performed under the assumption that the influence of the fluid behavior inside the ship was small a more realistic and dynamic analysis needs to be performed in consideration of the effects of sloshing etc which occur when the dynamic motion is large in this study the verification was conducted through comparison with other studies but comparison with the experiment by the authors was not performed therefore in the future we have a plan to further improve the proposed method through cooperation with the industry and to compare it with experimental results credit authorship contribution statement ki su kim conceptualization methodology software visualization validation writing original draft myung il roh conceptualization validation writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is an expansion of our previous study kim et al 2017 2020 and supported by the research institute of marine systems engineering and the institute of engineering research of seoul national university republic of korea 
21323,to guarantee the safety of a ship by preventing accidents various regulations including those related to the ship design must be followed despite these efforts accidents may occur personnel injury or oil spill are highly probable during an accident therefore this study proposes a method for analyzing the intermediate state of flooding to predict the motion of the ship and the amount of flooded water and spilled oil during an accident quasi static analysis has been primarily used for intermediate flooding analysis however limitations exist with respect to dynamic effects and ocean environmental loads to overcome these limitations a dynamic flooding analysis method is proposed in this study cummins equation is used to analyze the six degrees of freedom motion of a ship while the dynamic orifice equation is used to calculate the flow rate through damaged holes and openings in the ship additionally a method is proposed to consider the oil spill over a period this method is verified in comparison with other studies and its feasibility is confirmed using three case studies of a navy oiler graphical abstract image 1 keywords intermediate flooding dynamic flooding analysis ocean environmental load damage stability oil spill 1 introduction 1 1 research background unlike land the sea is impossible for humans to walk on and has various forces such as wave current and wind affecting its environment it is very difficult to respond to an accident at sea owing to its environmental characteristics hence the standards for design and operation of ships are set to minimize accidents that may occur during the operations of international organizations and classification society nevertheless accidents at sea are common and are often followed by personnel injury and oil spill most ship accidents are followed by flooding during flooding the ship s equipment human life and loss of its buoyancy due to the flooded water can cause tragic accidents because of changes in geometry and dynamic characteristics fig 1 shows recent ship accidents which caused severe loss of life in addition to personnel injury crude oil carriers are prone to spills during an accident oil spills have a profound impact on the marine ecosystem and surrounding coastal environment fig 2 shows the oil spill accident of hebei spirit in 2007 and surrounding area that was affected by the oil spill oil spills occur frequently during ship accidents therefore analyzing the oil spill in the event of a ship accident is important to prevent ship accidents classification societies and the international maritime organization imo require that ship design and operation follow various regulations furthermore shipbuilding companies consider the regulations from the early design stage until the early 2000s the regulations considered only the final outcome of flooding however limitations to these regulations have been identified as various external forces affect a ship accident at sea during flooding a more serious situation can occur than the final state in terms of motion and the stability of the ship therefore in the past decade various studies on flooding were conducted and regulations have been developed corresponding to the studies regulations on harmonized and probabilistic damage stability were introduced in 2009 by the safety of life at sea solas of imo 2017 for considering the intermediate flooding process to the damage stability goalds goal based damage stability project was conducted to suggest a new design paradigm for designing a safe ship papanikolaou et al 2010 in this project an improved formulation for the survival probability in case of flooding accounting for key design parameters of passenger ships and for the time evolution of flooding scenarios was developed floodstand integrated flooding control and standard for stability and crises management project was also conducted for increasing the reliability of flooding simulation tools in design and onboard use by establishing modeling principles and uncertainty bounds jalonen et al 2012 ittc conducted an experiment on damage stability for ro ro passenger ships under various conditions and compared it with benchmark tests ittc 2002 in addition the recent development allows for a more realistic assessment of the flooding process and the stability criteria in the regulation primarily relies on the characteristics of the stability curve ruponen 2018 ruponen et al 2019 furthermore imo 1992 regulates post accident operation for oil spill and the european maritime safety agency emsa is scheduled to be enforced to minimize the damage from oil spills in the mid 2020s however the amount of crude oil that may spill in a ship accident cannot be analyzed therefore this study proposes a method to analyze the process of flooding in various sea conditions in the time domain in addition the amount crude oil that would leak out of a ship during flooding is analyzed 1 2 related works since the early 1990s several time domain simulation methods for the motions of a damaged ship have been developed ruponen 2007 to analyze the actual flooding process it is necessary to analyze progressive flooding in the time domain studies on flooding analysis until the early 2000s were introduced by papanikolaou 2007 since the late 2000s various methods have been proposed for flooding analysis in the time domain ruponen 2006a 2007 performed intermediate flooding analysis in the time domain using a quasi static analysis method a hydraulic orifice equation based on the bernoulli s equation was used to calculate flow rate through an opening and a pressure correction equation was proposed to correct the air pressure that occurred during the analysis similar to previous studies dankowski and krüger 2012 and dankowski et al 2013 performed a quasi static analysis based on the hydraulic orifice equation however the continuity equation was used for air pressure correction kim et al 2017 proposed quasi static analysis using the hydraulic orifice equation and modified bernoulli s equation of air flow for the flooding analysis of barge type ships recently braidotti and mauro 2019 proposed a new calculation technique for intermediate flooding analysis based on the quasi static analysis on the other hand lee 2014 2015 proposed a dynamic orifice equation in the quasi static analysis method using the mass conservation equation and momentum conservation equation to address a limitation of the hydraulic orifice equation in addition kim et al 2020 proposed a method for considering the oil spill and cargo load during the quasi static flooding analysis using the dynamic orifice equation several studies have used quasi static analysis to simulate the flooding process the advantages of the quasi static analysis method are that the analysis is relatively simple and requires less computation time however owing to the nature of the quasi static analysis method dynamics of the ship cannot be considered and it is challenging to apply external force such as waves currents and winds therefore some studies have analyzed flooding using the dynamic flooding analysis method spanos et al 1997 and zaraphonitis et al 1997 proposed a mathematical model for the analysis of the flooding of ships in the waves for calculating the flow rate through the opening the semi empirical formula was used furthermore it was assumed that the mass of the flooded water was concentrated at the center of gravity similarly papanikolaou et al 2000 devised a coupled dynamic system for the analysis of ship motion and incoming water for dynamic flooding analysis in addition a benchmark test was conducted using the proposed method in comparison with the actual ship flooding experiment papanikolaou and spanos 2008 2005 the semi empirical method used by spanos et al 1997 zaraphonitis et al 1997 and papanikolaou et al 2000 is a method that expresses the flow in and out through the opening of the ship as the height difference at both ends of the opening and the empirical weir flow coefficient and the hydraulic orifice equation used in many studies is an equation of calculating the flow rate by assuming the ship s opening as a small orifice based on bernoulli s equation jasionowski 2001 proposed an assessment method for damage stability using strip theory rankine source method and free mass on potential surface model van t veer et al 2004 performed flooding simulation using a damaged large passenger ship in waves they used equations of the six degrees of freedom motion and a quasi stationary hydraulic flow model the aforementioned methods analyzed the motion of a ship through mathematical modeling on one hand certain studies have investigated the flooding of ships using computational fluid dynamics cfd tools strasser et al 2009 compared the results presented in ruponen 2006b using dynamic flooding analysis with the cfd tools lee et al 2012 and hamid et al 2016 used open source cfd tools to analyze the flooding of damaged ships in the waves their analysis considers the motion of the ship and movement of the flooded water inside the ship hence it can be relatively accurate with a large amount of flooded fluid inside the ship under severe sea conditions however mesh generation for the analysis and the analysis itself are time consuming caldas et al 2018 performed flooding simulation for a number of scenarios for a cruise ship at a full scale they considered flooding scenarios in calm and rough sea conditions by using the high fidelity deterministic cfd zhang et al 2019 performed time domain simulation of flooding processes under different ventilation levels considering air compression characteristics by using commercial cfd tools to take advantage of the quasi static analysis and dynamic analysis simultaneously a dynamic flooding analysis using the six degrees of freedom motion equation to analyze motions of the ship and the orifice equations to calculate the fluid through the opening of the ship was proposed manderbacka et al 2015 2016 modeled the motion of the ship as a six degrees of freedom motion of the rigid body and analyzed it in the time domain additionally the amount of fluid through the opening of a ship was calculated using the hydraulic orifice equation similarly ypma and turner 2010 performed a flooding analysis of a ship considering wave loads until recently studies that consider oil spills during flooding have rarely been conducted debra et al 2001 performed experiments using canola oil which has similar properties to crude oil in this study a dynamic flooding analysis method is proposed to analyze the intermediate flooding of the ship while considering the wave loads in addition the amount of oil spilled through the opening was analyzed table 1 summarizes the related studies and characteristics of this study 2 theoretical background in this study a dynamic flooding analysis is proposed to analyze the intermediate flooding of the ship section 2 1 describes the process of dynamic flooding analysis section 2 2 describes the dynamic orifice equations for calculating the flow through the damaged hole or openings of a ship section 2 3 introduces a method to handle the oil spill when calculating the flow rate using the dynamic orifice equation section 2 4 describes the cummins equation for the analysis of the six degrees of freedom motion of ships in waves 2 1 process of dynamic flooding analysis in this study the intermediate flooding of the ship was analyzed using dynamic flooding analysis unlike the quasi static analysis method which is generally used for intermediate flooding analysis dynamic flooding analysis considers the dynamic motion of the ship hence it is necessary to solve the six degree of freedom equation that considers external forces such as waves during this process the amount of fluid flowing through the damaged hole or opening inside the ship should be calculated by substituting this result in the six degree of freedom equation we can perform the dynamic flooding analysis fig 3 summarizes the sequence of dynamic flooding analysis to perform the dynamic flooding analysis mesh modeling is required the mesh model includes the hull model the compartments where flooding occurs the compartments where the center of gravity changes depending on the attitude of the ship due to liquid cargo openings between compartments and damaged holes of course in the case of flooding between the compartments modeling of connections between them is included additionally damaged holes should be modeled when the external hull is damaged modeling for the dynamic flooding analysis is relatively easy the mesh model used in this study is compatible with the mesh model used in general visualization so it is much simpler to generate it than the mesh model used for cfd analysis the difference between the mesh model of this study and the mesh model for cfd analysis is shown in fig 4 the initial conditions are set for the analysis the initial states require the weight distribution of the hull and volume of cargo carried in each compartment hence the analysis begins after obtaining these values the analysis is performed in the time domain and the same task what to mention in later is performed at each time step depending on the modeled structure the dynamic orifice equation is used to calculate the mass flow in and out through each opening figs 3 1 the calculated mass flow includes all the fluid flowing through the openings of a ship air water and oil are considered as fluids for calculating in this study by multiplying the mass flow of each fluid calculated using the dynamic orifice equation with the unit time of analysis it is possible to obtain the inflow and outflow of fluid in a section per unit time figs 3 2 next the mass and center of gravity of the ship can be calculated using the mass change of each compartment figs 3 the dynamic motion of the ship is calculated by substituting the changed weight and center of gravity in the cummins equation for the six degrees of freedom motion analysis figs 3 4 then the changed position and attitude of the ship per unit time can be calculated and the amount of flooded water in each compartment can be obtained by repeating the aforementioned steps 1 4 the dynamic flooding analysis can be performed the shapes of the fluids contained in the ship change with the change in the attitude of the ship during the analysis therefore the center of gravity of the fluid inside each compartment is recalculated when this change occurs while considering the free surface of the fluid accordingly figs 3 5 fig 5 graphically shows the steps of the dynamic flooding analysis each step shows the midship section of the ship 2 2 dynamic orifice equation to proceed with the flooding analysis of the ship in the time domain it is necessary to calculate the flow rate of the fluid flowing through the damaged hole or opening connecting the compartment inside the ship at every time step as shown in table 1 many studies have calculated the flow rate using the hydraulic orifice equation the hydraulic orifice equation calculates the velocity at the orifice using the bernoulli s equation and the mass flow rate of the fluid flowing through the orifice using velocity as bernoulli s equation was derived along the streamline inducing the orifice velocity also proceeds along the streamline fig 6 shows the orifice connecting the two compartments and the streamline of fluid moving through it in fig 6 points p1 and p2 located on the same streamline with compartments 1 and 2 satisfy the bernoulli s equation as shown in eqs 1 and 2 1 p 1 2 ρ v 2 ρ g z c 2 p 1 1 2 ρ v 1 2 ρ g z 1 p 2 1 2 ρ v 2 2 ρ g z 2 where ρ is the density of the fluid p is the pressure g is the gravitational acceleration z is the vertical position of the streamline and v is the fluid speed eq 2 is for incompressible flow because it does not include the pressure term that varies by density in bernoulli s equation if the area of the orifice is small the velocity of flow v 1 at p1 can be assumed to be zero then eq 2 can be derived as eq 3 3 1 2 v 2 2 1 ρ p 1 p 2 g z 1 z 2 it can be observed from eq 3 that the velocity v 2 of the fluid at p2 is determined by the pressure and height difference if there is no difference in height between the two points p1 and p2 v 2 can be derived as eq 4 the flow rate q through the orifice can be obtained by multiplying the area a with the velocity through the orifice as shown in eq 5 4 v 2 2 ρ δ p 5 q ρ c d a v ρ c d a 2 ρ δ p where c d is the discharge coefficient the c d corresponds to the shape of the orifice and generally equals 0 6 0 7 lee 2014 if the area of the orifice is large and pressure difference within the area changes the speed can be integrated within the orifice cross sectional area the hydraulic orifice equation for calculating the flow rate as shown in eq 5 has two limitations first the bernoulli s equation is derived for the steady flow so as to not consider the dynamic effect in addition as it is assumed to be a newtonian fluid it can be applied to a small area orifice hence it is difficult to apply it to a large opening eq 5 is the square root function of pressure differences it also has a singular behavior for the square root function therefore when the pressure difference at both ends of the opening is large it can be applied without any problems however when the pressure difference approaches 0 the rate of change can be infinitely divergent resulting in an abnormal solution a detailed explanation of this phenomenon was presented in the study of lee 2015 other studies using the hydraulic orifice equation did not use only eq 5 but tried to solve this by additionally using the pressure correction equation and the continuity equation therefore in this study the dynamic orifice equation lee 2015 that was developed to resolve the aforementioned problems was used the dynamic orifice equation is calculated based on five assumptions 1 the fluid is incompressible 2 the pressure at the inlet boundary ar is equal to p0 and the fluid velocity flows parallel to the normal vector n of ar 3 the fluid velocity and pressure gradient in the control volume c 1 are constant 4 the fluid passing through the orifice is non viscous 5 the fluid is considered to be flowing normal to the opening therefore we can define the inlet and outlet control volume as shown in fig 7 the dynamic orifice equation can be derived by applying the mass conservation law and momentum conservation law to the control volume of the inlet and outlet as shown in fig 7 the mass conservation law and momentum conservation law using an integral euler equation can be derived as eqs 6 and 7 6 c s v d a 0 7 f s x f b x t c v u ρ d v c s u ρ v d a where v is vector of speed f s x and f b x are surface and body forces u is normal speed of orifice a is area for integral ρ is density of fluid v is a volume of the control volume and a is the area of the control surface if the mass conservation law is applied to the control volume c1 of the outlet it can be derived as eq 8 in addition if the aforementioned assumptions 3 and 4 in the momentum conservation law are applied to c1 and it is assumed that no external force acts in the normal direction eq 7 can be derived as eq 9 8 o p e n i n g u d a u 1 a 1 q 9 o p e n i n g p d a p 1 a 1 t c v 1 u ρ d v where q is the mass flow of fluid this process can be applied to the control volume c0 of the inlet the mass conservation law is applied to c0 and by substituting the flow rate q obtained in eq 8 the velocity v of the fluid passing through the opening can be obtained as eq 10 in addition the momentum conservation law is applied to c0 and by substituting in eqs 9 and 10 to applied equation the dynamic orifice equation can be derived as eq 11 10 v n 1 2 π r 2 q 11 a o p e n i n g 2 u t 7 8 u 2 p 0 p 1 ρ the dynamic orifice equation is a differential equation that inputs the opening area a opening time interval dt pressure p 0 and p 1 at both ends of the opening and density ρ of the fluid at the higher pressure side by solving the differential equation based on the inputs the velocity of the fluid u passing through the opening can be determined the mass flow of fluid q can be calculated as shown in eq 12 the process of inducing the dynamic orifice equation was explained in detail by lee 2015 12 q ρ u a o p e n i n g δ t 2 3 consideration of oil spill for dynamic orifice equation as described in section 2 2 the flow rate of the fluid flowing through the opening was calculated using the dynamic orifice equation various studies using the hydraulic orifice equation krüger et al 2012 lorkowski et al 2014 ruponen 2018 ruponen et al 2018 2013 and dynamic orifice equation lee 2015 2014 limited the type of fluid passing through the opening to seawater and air therefore if the cargo tank in the ship contains oil its amount of inflow and outflow cannot be calculated imo 1992 regulated the rules to handle the oil when oil spills occur in ships in accordance with the regulations tavakoli et al 2011 compared analytic models of an instantaneous oil spill and experimental tests for damaged ships puolakka 2020 conducted a fluid mechanical analysis for the wave induced oil spill of a damaged double hulled tanker in addition price et al 2003 ha et al 2013 and others have studied the spreading of the oil spilled from ships at sea kim et al 2020 considered the oil spill when using the dynamic orifice equation therefore developing on the previous study this study improved the dynamic orifice equation to analyze the amount of oil that flows out of the ships when calculating the inflow and outflow of fluid in a ship the intersections in the openings are categorized into three types as shown in fig 8 according to the type of intersection the dynamic orifice equation can be used as eqs 13 15 where a aa a wa and a ww are the area of the air air intersection area of the water air intersection and area of the water water intersection respectively p air1 and p air2 and p water1 and p water2 are the air pressures and water pressures in compartments 1 and 2 respectively as previously mentioned if the opening is composed of three intersections the flow rate can be calculated through nine cases depending on the fluid level at both sides of the opening in this study we intend to expand this concept and use it to calculate the flow rate of oil in a ship according to thrift viveros et al 2015 and fingas 2017 the national oceanic and atmospheric administration noaa suggests that the analysis of oil spills of similar properties can be substituted with other fluids oils with similar properties are boscan crude bunker c california heavy and canola oil in contrast oils containing surfactants are different from those described above in addition such oils dissolve in water and spread rapidly in this study the analysis of oil flowing separately from water was performed oils containing surfactants were not considered the viscosity of the oil was neglected because the dynamic orifice equation was used in this study to calculate the oil spill using the dynamic orifice equation three additional intersections are required in addition to the three intersections shown in fig 9 the three intersections are oil air oil oil and water oil therefore six intersections should be considered to estimate an oil spill deriving the dynamic orifice equations for the three additional intersections can be expressed as eqs 16 18 where a oa a oo and a wo are the area of the oil air intersection area of the oil oil intersection and area of the water oil intersection respectively p oil1 and p oir2 are the oil pressures in compartments 1 and 2 respectively if an opening is composed of the six intersections an additional 35 cases are required depending on the fluid level at both sides of the opening in eqs 13 18 the unknown is the flow u flowing through the intersection if the fluids at both sides are the same ρ is the density of the higher pressure side similarly even if the types of fluids at both sides are different as the pressure moves from the high pressure side to the low pressure side the fluid at the high pressure side moves to the low pressure side and accordingly ρ follows the density at the high pressure side in this study oil spills from ships were analyzed by separating the aforementioned 35 cases 2 4 equations of motion in the time domain through the dynamic orifice equation the amount of fluid flowing through the opening in the ship can be calculated at every time step when the amount of fluid in the compartment changes the weight and center of gravity of the compartment change accordingly thus the center of gravity and weight of the ship changes therefore to calculate the six degrees of freedom motion of the ship the ship s weight and center of gravity that vary at each time step should be calculated as the ship is at sea various environmental loads act on it therefore the hydrodynamic force must be considered when calculating the six degrees of freedom motion of a ship hydrodynamic forces mainly consist of two parts they are the wave exciting force caused by the incident wave and radiation force caused by the ship moving at sea the radiation force is further composed of two components the force proportional to the acceleration of motion and force proportional to the speed of motion ham et al 2017 it can be expressed as eq 19 19 f h y d r o d y n a m i c f e x c i t i n g f r a d i a t i o n the ship s six degrees of freedom motion equation should include the aforementioned components of the hydrodynamic force the cummins equation cummins 1962 can represent the ship s six degrees of freedom motion equation considering the wave exciting force in the cummins equation the force response amplitude operator rao can be calculated by multiplying the sinusoidal function at a given frequency furthermore the force rao can be obtained using a commercial solver such as wadam by dnv in addition a radiation force is required to calculate the cummins equation and the radiation force must consider the impulse response of the floating body in the time domain the wave exciting force and radiation force are given in eq 19 and can be expressed as eqs 20 and 21 to calculate the radiation force the frequency dependent added mass coefficient a ij ω and damping coefficient b ij ω at a given frequency ω are required these coefficients can be obtained by the aforementioned commercial solver 20 f e x c i t i n g f ω cos ω t ε 21 f r a d i a t i o n a v t 0 b σ v t σ d σ using the frequency dependent coefficients a ij ω and b ij ω the added mass a and retardation function b τ can be obtained the added mass a which is a constant matrix is used in the infinite motion frequency rather than the integral form ham et al 2020 this is because the equation is available at any frequency ω using the obtained radiation force and wave exciting force we can obtain the equations of motion in the time domain cummins equation as eq 22 finally eq 22 can be derived as eq 23 22 m x f r a d i a t i o n f r e s t o r i n g f e x c i t i n g a x 0 b τ x t τ d τ c x f ω cos ω t ε 23 m a x 0 b τ x t τ d τ c x f ω cos ω t ε where the mass term m and restoring term c vary depending on the ship s weight and center of gravity therefore in this study m and c were updated using the ship s weight and center of gravity modified by the dynamic orifice equation before solving the equations of motion at every time step 3 verification of dynamic flooding analysis in this study a dynamic flooding analysis method was proposed to analyze the flooding considering while the environmental load this section verifies the proposed method by comparing it with three other results in section 3 1 it was confirmed that the dynamic flooding analysis method is consistent with the existing quasi static flooding analysis in section 3 2 the accuracy of the proposed method was compared with the dynamic flooding analysis conducted by sadat hosseini et al 2016 in section 3 3 to verify the accuracy of the oil spill the experimental results of debra et al 2001 were compared with those of this study 3 1 comparison with the quasi static method lee 2015 performed a flooding analysis of the ship using the quasi static analysis with the dynamic orifice equation the dynamic orifice equation was used in this study however a dynamic flooding analysis was proposed incorporating the six degrees of freedom equation the quasi static analysis is a method of finding a static position and attitude at every time step and cannot consider the dynamic effects and environmental loads however owing to the simplicity of the analysis the analysis speed is high and the mesh model for the analysis is relatively simple the dynamic analysis is slower than the quasi static analysis but it can compensate for the aforementioned limitations of the quasi static analysis if flooding occurs in a ship floating in still water with no environmental load the final state of the quasi static analysis and dynamic analysis should be the same in this study to confirm that the proposed dynamic analysis works correct we compared the results with those of the quasi static analysis and confirmed that the final state was the same to compare the differences between the two analysis methods the behavior of a 20 000 ton class navy oiler which is damaged in the outer shell was used for the comparison the damaged compartment was assumed to have been damaged by 2 m 2 m in the ballast tank of the starboard as previously mentioned it was assumed that there was no environmental load the detailed shape and damaged hole of the model for verification are shown in fig 10 when the ballast tank is damaged the external seawater flows into the damaged hole and the ship gradually tilts toward the starboard the ship sinks slightly due to the weight of the seawater the quasi static analysis showed that the equilibrium was reached in approximately 90 s the quasi static method took a total of 263 s and the dynamic method took a total of 258 s for the analysis therefore it is judged that there is no significant difference in calculation performance in the dynamic analysis the inflow of seawater reached the final state at a time similar to that of the quasi static analysis however the results showed that the motion remained the same due to inertia fig 11 shows the state of the ship visualized during the quasi static analysis fig 12 shows the motion of ship during flooding analysis in the quasi static analysis the motion continued until equilibrium was reached in the dynamic analysis the motion continued due to the inertia therefore in this study three motions roll angle pitch angle and heave were compared for the two methods comparing the roll angle the ship inclined 4 23 at the final equilibrium state using the quasi static analysis in the dynamic analysis an extremely small difference of 0 03 occurred due to a slope of 4 26 when it was converged comparing the pitch angle the ship showed a very slight difference of 0 002 at 0 025 in the final state using the quasi static analysis and 0 023 in the dynamic analysis in the heave motion the two methods showed a slight difference of 0 001 m the quasi static analysis was at 0 105 m and dynamic analysis was at 0 104 m respectively as previously described the tendency to reach the final state is very similar however in the dynamic analysis it tended to oscillate due to the inertia force until the motion converged fig 13 shows the amount of seawater in the ballast tank compartment with damaged holes during the analysis as the seawater steadily flowed through the process for approximately 90 s the difference between the quasi static and dynamic analysis was 1 ton showing a very slight difference in the two methods when there are no external forces due to environmental loads the behavior of the ship tends to be very similar until the final equilibrium state the effectiveness of the dynamic analysis was confirmed because additional dynamic effects can be considered 3 2 comparison with the analysis and experiment by sadat hosseini et al 2016 in section 3 1 the replaceability of the quasi static analysis with the dynamic analysis and similarity of the analysis results are confirmed the flooding analysis of a navy oiler in section 3 1 shows that the damaged hole size is very small when compared with the ship size such that the transit motion is less therefore the two methods are similar however the greater the extent of damage when compared with the size of the ship the greater are the dynamic effects sadat hosseini et al 2016 performed a flooding experiment owing to large damage to the model of a cruise ship and analyzed it using cfd to analyze the applicability of the dynamic flooding analysis proposed in this study to the damaged ship which has large damage with transit motion the results of this study were compared with the experimental data and cfd data of sadat hosseini et al 2016 sadat hosseini et al 2016 established a model using the ship s linearity of the cruise ship released by the ship stability research center ssrc and compartments for flooding analysis the shape of the hull and compartments are shown in fig 14 table 2 summarizes the principal dimensions of the model ship as detailed in fig 15 the cruise ship model has two compartments with a damaged hole and opening one with the external hole is equipped with a probe to measure the water level as shown in fig 15 water flows through the damaged hole in the starboard and water is transferred through the opening between the compartments fig 16 shows the comparison of the roll angle during flooding the red and black dashed lines represent the experimental results and cfd results of sadat hosseini et al 2016 respectively and the solid blue line represents the results of this study although the results of this study and the experimental results were more similar in amplitude than cfd analysis results the roll period of the ship tended to be shorter this is because the hull mesh used in this study was configured as a triangular mesh for analysis and the natural frequency of the hull form was not preserved fig 17 shows the water height at the probe in the compartment similar to fig 16 the red and black dashed lines represent the experimental and cfd analysis results of sadat hosseini et al 2016 respectively the solid blue line indicates the results of this study the water level initially appeared smaller than that in the experimental results after 2 s it showed almost the same value as that in the experimental results although the dynamic flooding analysis proposed in this study exhibits a certain difference it can be used with a slight difference from the experimental results despite large damage 3 3 comparison with the experiment by debra et al 2001 in this study to predict the amount of oil flowing out of the ship a method to consider oil in the dynamic orifice equation was proposed in section 2 3 to determine the applicability of the proposed method the results of this study were compared with those of the two experimental data of debra et al 2001 debra et al 2001 filled the box container with canola oil in the first experiment and drilled a circular hole to allow the oil to flow out the height of the oil in the container changed and the height of oil was measured in the second experiment the same container as in the first experiment was placed in another container filled with water such that the oil spilled into the water the water level and height of oil were measured the density of canola oil used in the experiment was 0 91 kg m3 the details of the experimental model are shown in fig 18 the graph comparing the results of the first experiment with this study is shown in fig 19 at the end of the analysis the oil flowed out and maintained the same height but there was a slight difference in speed in the middle part of the analysis the graph comparing the results of the second experiment with those of this study is shown in fig 20 the decrease in the oil level owing to the oil spill through the hole is extremely similar to the experimental data however although the final amount of water is the same the water flow rate is different at the midpoint of the analysis this is because the dynamic orifice equation used in this study does not consider the viscosity of the fluid and it is assumed that a certain amount of mixing occurs as the oil flows out and water flows in when the results of this study were compared with those of the two experiments conducted by debra et al 2001 the results were sufficiently accurate the results of this study are very similar to those of previous studies kim et al 2020 the movement of the container was not taken into account because the oil box was fixed in the experiment so that the results show similar consequences therefore it is expected that the dynamic flooding analysis method proposed in this study can be used for oil spills 4 applications in this study a dynamic flooding analysis method considering the dynamic effects and environmental loads were proposed to verify the effectiveness of the method proposed in this study three case studies were performed in this section the ship s model used in the case study is described and the significance of each case study are discussed in addition the efficiency of the proposed method is discussed 4 1 prototype program for dynamic flooding analysis in this study for efficiency analysis a prototype program was developed to perform intermediate flooding analysis of ships using the proposed method the core analysis engine of the program was developed using c language in the net environment and a graphical user interface gui for efficient analysis was developed using windows presentation foundation wpf the program can be divided into five parts the first ribbon menu was configured for easy use of the program by borrowing the same interface as the existing microsoft programs the simulation timeline was developed to check the actual time taken for analysis and simulation time passed during the analysis the model tree represents the required components for the analysis such as a hull model and openings or damaged holes in compartments a 3d visualization shows the behavior of the ship and amount of fluid in real time through during the analysis finally the report view tracks the analysis results set by the user while the analysis is in progress and displays them graphically fig 21 shows the screenshot of flooding analysis through the prototype program 4 2 application target and case descriptions in this study a case study was performed using a 20 000 tons class of navy oiler kim 2019 a navy oiler is a military ship and the purpose of the operation is to carry military oil the oiler resembles the structure of a merchant ship rather than a naval ship performing general military operations as shown in fig 22 the part related to the flooding analysis in the actual navy oiler was modeled through the lines and general arrangement the model used in this study was a simple triangular mesh for visualization and not the mesh conventionally used in cfd analysis therefore the time and effort required for mesh modeling can be reduced the main specifications of the navy oiler used in this study are listed in table 3 in this study three case studies were performed to confirm the effectiveness of the dynamic flooding analysis method the case study compared the difference between the quasi static analysis which was mainly used in the intermediate flooding analysis and dynamic flooding analysis method proposed in this study in the first case study the results of the quasi static and dynamic analyses subjected to the wave load were compared when the ballast tank was damaged second the difference between the quasi static and dynamic analyses was compared when the damage was large finally in the third case the difference between the quasi static and dynamic analyses was compared when the oil spilled through the damaged hole the environmental load regular sinusoidal waves applied to each case was assumed to have a wave height 1 m wave period 10 s and head sea in general it is assumed to be the most severe situation for ships as the beam sea however when the military ship is damaged the ship should turn the bow to the head sea condition by regulation hence we assumed it to be the head sea the detailed description of each case is summarized in table 4 for each case the satisfaction of the damage stability regulation was evaluated in the intermediate and final states as mentioned above the target ship for the case study is a naval ship of the korea navy hence five criteria of the korea navy 2014 were applied the damage stability criteria in the intermediate state were evaluated assuming that the ship s motion is fixed at each time step therefore it is possible to check whether the damage stability criteria are satisfied in a situation where both flooding and dynamic motion co occur 4 3 case studies case 1 reproduces the situation where seawater flows in through the damaged hole of the ballast tank case 1 1 was analyzed until the equilibrium state was reached using the quasi static analysis and case 1 2 was analyzed using dynamic analysis under environmental load fig 23 shows the process of flooding and sequence of seawater gradually flowing through the damaged hole in the ballast tank which is a double hull structure the motion of the ship in cases 1 1 and 1 2 during the analysis is shown in fig 24 and the amount of seawater entering through the damaged hole during the analysis is shown in fig 25 case 1 1 was conducted using the quasi static analysis and it took approximately 73 s to reach the equilibrium state due to the flooding comparing the roll motion of case 1 the quasi static analysis reached a maximum angle of 4 37 at an equilibrium of 73 s in case 1 2 the motion continued under environmental load even when the equilibrium was reached and the maximum angle was 5 12 in the heave motion the quasi static analysis showed a maximum motion of 0 13 m at the equilibrium state the dynamic analysis showed the tendency to continuously oscillate due to the influence of the environmental load and the maximum motion was 0 71 m the amount of seawater flowing into the ballast tank was similar to 492 ton and 494 ton in cases 1 1 and 1 2 respectively table 6 shows the results of evaluating the criteria in table 5 during the analysis in cases 1 1 and 1 2 five damage stability criteria were satisfied in the final and intermediate states case 2 reproduces the ship s flooding process when it has severe damage in starboard case 2 1 was analyzed using the quasi static analysis until equilibrium was reached and case 2 2 performed the dynamic analysis under the condition of environmental load fig 26 shows the process of flooding in case 2 the seawater gradually flows through the three damaged holes in the ballast tank which is a double hull structure in addition there was a damaged hole in the main engine room for the seawater to flow into the compartment in case 2 it was assumed that the ship suffered severe damage than case 1 the motion of the ship in cases 2 1 and 2 2 during the analysis is shown in fig 27 and the amount of seawater entering through the damaged holes during the analysis is shown in fig 28 case 2 1 was conducted using the quasi static analysis and it required approximately 81 s to reach the equilibrium state due to the flooding comparing the roll motion of case 2 the quasi static analysis reached a maximum angle of 14 49 in the equilibrium state in the dynamic analysis the motion continued under the environmental load even when the equilibrium was reached and the maximum angle was 15 10 in the heave motion the quasi static analysis showed a maximum motion of 0 09 m at the equilibrium state furthermore the dynamic analysis showed the tendency to continuously oscillate due to the influence of the environmental load the maximum motion of the heave in the dynamic analysis was 0 22 m the amount of seawater flowing into the damaged compartments was 2652 ton and 2585 ton in cases 2 1 and 2 2 respectively the error was 67 tons due to the ship s motion during the waves and movement of the damaged holes table 7 shows the results of evaluating the criteria of damage stability during the analysis of case 2 case 2 1 satisfies the criterion of damage stability in the final and intermediate states while case 2 2 does not satisfy the first criterion of damage stability in the intermediate state the first criterion for damage stability is that when the ship is damaged the initial heeling angle due to the damage should not exceed 15 considering the effects of dynamic motion and environmental loads which are difficult to express in the quasi static analysis it suggests that a situation more dangerous than the final state may occur in an intermediate state of flooding as observed in case 2 therefore we should check the damage stability during the intermediate flooding process case 3 reproduces the case of oil leakage due to the damage propagated to the internal cargo oil tank compartment caused by the severe damage to the double hull structure case 3 1 was analyzed using the quasi static analysis until the equilibrium was reached and case 3 2 was performed using the dynamic analysis under the condition of environmental load fig 29 shows the process of flooding and situation where seawater enters owing to external damage and oil leaks due to internal damage in case 3 unlike the previous case the amount of oil spilled was tracked the motion of the ship in cases 3 1 and 3 2 during the analysis is shown in fig 30 in case 3 the heave motion of the ship was insignificant and excluded from the comparison in fig 31 the amount of seawater entering through the damaged hole during the analysis was compared with the amount of oil leaked from the ship case 3 1 was performed using the quasi static analysis and it required approximately 207 s to reach the equilibrium state in the roll motion of case 3 in the quasi static analysis the maximum angle was reached 2 02 at the equilibrium state at 207 s in the dynamic analysis the motion continued under environmental load even after reaching the equilibrium and the maximum angle was 3 06 the amount of seawater flowing into the damaged compartments reached equilibrium in case 3 1 and no longer flowed in at 201 tons however in case 3 2 it tended to increase continuously in the oil spill case 3 1 reached equilibrium and stopped at 304 tons of outflow in case 3 2 the oil is continuously leaking table 8 shows the results of evaluating the criterion of damage stability during the analysis of case 3 in both the cases the damage stability criteria were satisfied even during the intermediate state as previously described cases 1 and 2 were damaged in places where the liquid cargo was not loaded and after a certain time the inflow of seawater reached a steady state however in case 3 the damage proceeds to the cargo oil tank cot inside the ballast tank and seawater flowed for a long time while the oil leaked fig 32 shows the process of the oil spill in detail initially the oil leaks from the cot to the ballast tank the oil level does not reach the external damage and the amount of oil spill was maintained at zero after approximately 20 s the oil level of the ballast tank reached the external damaged hole and the oil started to leak rapidly as the oil level of cot is higher than the oil level of the ballast tank the outflow rate of oil was maintained almost constant until approximately 100 s from approximately 100 s the three levels which were the oil level of cot oil level of the ballast tank and external water and outflow rate of the oil were decreased in the quasi static analysis a small amount of oil flows out and the equilibrium was reached in 207 s in this study the dynamic orifice equation described in section 2 2 was used and the flow rate was generated by the pressure difference between the openings in addition in the case of oil and water it was assumed that they did not mix and peeled off therefore under certain conditions the equilibrium was reached when the pressures of the two levels are equal however in general when oil leaks owing to an accident all the oil in the cot leaks out this can be analyzed through the proposed dynamic flooding analysis method owing to the dynamic behavior there is a small but continuous motion which can be analyzed fig 33 shows the amount of seawater and oil spill of approximately 2 h 46 m 10 000 s after the quasi static analysis reached the equilibrium state in fig 31 as observed in fig 33 after 300 s the seawater continuously flows and oil leaks until approximately 23 m 1400 s the seawater continuously flowed into the ballast tank and the oil in the cot flowed out gradually after approximately 23 m 1400 s the seawater level of the ballast tank reached the damaged hole inside and the seawater began to flow into the internal cot when observing the analysis results at approximately 2 h 46 m 10 000 s the seawater gradually filled the internal cot after 2 h 46 m 10 000 s the dynamic flooding analysis continues until all the oil in the cot flows out and the seawater level in the inner cot and ballast tank reaches the outer waterline using the dynamic flooding analysis it is possible to precisely describe the process of oil spill in a ship during a disaster 5 conclusions and scope for future work in this study a method for dynamically analyzing the process of intermediate flooding was proposed considering oil spill as the quasi static method which is mainly used to analyze the intermediate flooding process cannot consider dynamic effects it is difficult to consider effects due to transit motion and environmental loads using this method therefore to overcome this limitation the method for dynamic flooding analysis was proposed in this study as mentioned in section 1 2 various methods for the dynamic flooding analysis were proposed this study sought to develop a dynamic flooding analysis method by referring to various studies for this cummins equation was used as a six degrees of freedom equation to analyze the dynamic motion of a ship and the flow rate through an internal or external opening was analyzed using the dynamic orifice equation during the flooding process the shape and center of gravity of the fluid inside the ship were considered and the dynamic flooding analysis was performed by updating it in the cummins equation at every time step furthermore the method for the oil spill which was difficult to consider using the existing dynamic orifice equation was additionally considered and applied for the application of the proposed method a prototype program was developed for the user to perform the flooding analysis the method was compared and verified with methods proposed in various studies in addition the proposed method was applied to realistic examples to confirm its effectiveness and applicability in particular it was found that by considering the dynamic effects and environmental loads during the flooding process a more serious situation may occur during the flooding process it was further confirmed that the process of the oil spill of the ship could be realistically reproduced further research is required to improve the proposed method as this study was performed under the assumption that the influence of the fluid behavior inside the ship was small a more realistic and dynamic analysis needs to be performed in consideration of the effects of sloshing etc which occur when the dynamic motion is large in this study the verification was conducted through comparison with other studies but comparison with the experiment by the authors was not performed therefore in the future we have a plan to further improve the proposed method through cooperation with the industry and to compare it with experimental results credit authorship contribution statement ki su kim conceptualization methodology software visualization validation writing original draft myung il roh conceptualization validation writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is an expansion of our previous study kim et al 2017 2020 and supported by the research institute of marine systems engineering and the institute of engineering research of seoul national university republic of korea 
21324,a semi analytic dynamic model is developed for vibro acoustic analysis of submerged coupled propeller shaft hull systems under propeller forces the propeller shaft and hull are idealized as a lumped mass multi span beam and ring stiffened shell of revolution respectively stern middle and thrust bearings are simulated as spring damping systems the hull is firstly decomposed into many segments which are treated as conical shells and analyzed through combining flügge shell theory and power series method the shaft is divided into three timoshenko beams according to the bearings by expanding acoustic pressure and velocity as fourier series in circumferential direction surface helmholtz integral equation is reduced to line integral and acoustic pressure is further expressed as displacements of segments after meshing the line to some 3 node isoparameter elements boundary conditions and continuity conditions modified by external acoustic pressure are orderly assembled to the dynamic model as considering the hull as a ring stiffened conical cylindrical spherical shell vibro acoustic results of present method are compared with ones of coupled finite element boundary element method and the accuracy and efficiency of developed dynamic model are demonstrated furthermore parameter analysis reveals that breathing and beam modes are predominant for vibro acoustic responses and sound power is mainly dominated by the cylindrical compartment keywords coupled propeller shaft hull systems semi analytic method ring stiffened conical cylindrical spherical shells helmholtz integral equation vibro acoustic responses 1 introduction for submerged vessels such as submarines the level of radiated noise is vital and the reduction or suppression of vibration and radiated noise has been a key topic in a long time however knowing vibro acoustic characteristics of these structures plays a very important role before adopting appropriate measures for the reduction or suppression at low frequencies significant radiated noise emitting from submerged vessels can be attributed to fluctuating propeller forces which are generated by the rotation of propeller in spatially nonuniform wake and transmitted to the hull through the propeller shaft system as a result dynamic models of independent propeller shaft system or hull cannot be directly utilized for vibro acoustic analysis of the coupled structure accordingly the dynamic modeling for vibro acoustic responses of coupled propeller shaft hull systems under propeller excitations has been attracting attentions of lots of researchers and engineers on the other hand although there are some opened works about dynamic modeling of the coupled system the literature about analytic or semi analytic models is rare how to obtain the governing equation of the titled structure is involved in three major problems namely establishing the dynamic model of hull establishing the dynamic model of propeller shaft system and synthesizing the two parts vibro acoustic characteristics of independent propeller shaft system or fluid loaded hull e g cylindrical shells conical cylindrical shells and cylindrical spherical shells have received much attention since the last century and these investigations are not particularly analyzed here for recent studies about vibro acoustic problems of coupled propeller shaft hull systems the coupled finite element boundary element method fem bem is the most common tool merz et al 2009 2010 li et al 2016 2019 wang et al 2017 su et al 2018 merz et al 2009 2010 utilized ansys to generate structural stiffness mass and damping matrices and the software developed by the authors to compute structure fluid coupling matrices however only axial force excitation of propeller was considered in addition experiments were adopted in some references li et al 2016 wang et al 2017 su et al 2018 and results illustrated the validity of established models on the basis of fem bem some other methods were developed song et al 2014 huang et al 2017 chen et al 2019 qin et al 2020 song et al 2014 used the transfer matrix method and fem bem to construct the model of propeller shaft system and hull respectively the two parts were synthesized via the mobility at connection point between propeller shaft system and foundation through employing fem bem or fem to obtain frequency response functions at connection points on the propeller shaft system and hull a frf based substructuring method was proposed for vibro acoustic analysis of coupled propeller shaft hull systems huang et al 2017 chen et al 2019 qin et al 2020 caresta and kessissoglou 2011a 2011b 2012 developed a semi analytic method to study vibro acoustic responses of submarine hull under axial excitation of propeller the hull was modeled as a ring stiffened conical cylindrical shell with internal bulkheads the two ends of which were closed by circular plates as both the hull and excitation are axisymmetric only axisymmetric motions were considered in addition smearing out method was used to deal with ring stiffeners rather than discrete members correspondingly the dynamic model was significantly simplified after utilizing one kind of finite element software to calculate dry modes and generate boundary element mesh of the propeller shaft hull coupled system qi et al 2016 2019a 2019b extended the three dimensional sono elasticity theory to explore acoustic and vibrational characteristics by virtue of the modified variational method and spectral kirchhoff helmholtz integral formulation qu et al 2017 developed a theoretical model for coupled propeller shaft and submarine hull system under propeller force excitations in different directions radial and thrust bearings were modeled as spring damping system and hull was modeled as a spherical cylindrical spherical shell without bulkheads for most of these investigations the hull was modeled as a ring stiffened conical cylindrical spherical shell whereas the propeller was modeled as a lumped mass or pan the elasticity of propeller was only considered in several papers huang et al 2017 li et al 2019 qi et al 2019a 2019b in addition commercial software ansys and or virtual lab were utilized to establish the dynamic model the main purpose of current paper is to develop a semi analytic model for vibro acoustic analysis of coupled propeller shaft hull systems subjected to propeller excitations in different directions which is on the basis of the model developed by the authors for vibration analysis of ring stiffened shells of revolution xie et al 2019a and vibro acoustic analysis of submerged shells of revolution xie et al 2019b according to hull models in above mentioned references and some recent articles about vibration and acoustic characteristics of submarine hulls su and jin 2016 jin et al 2017 2018 xie et al 2017 the hull is modeled as a ring stiffened conical cylindrical spherical shell with bulkheads and it is uniformly analyzed as general ring stiffened shells of revolution the propeller and shaft are modeled as a lumped mass and multi span beam stern middle and thrust bearings are idealized as spring damping systems the hull and shaft are firstly divided into many shell segments and beams in axial direction by expanding displacements as power series and fourier series in axial and circumferential directions motion equations of conical shells are solved and four displacements and four forces at cross section of segments are further expressed as 8 unknown coefficients longitudinal vibrations of bars and bending vibrations of timoshenko beams are adopted to analyze vibrations of the shaft for external acoustic pressure the surface helmholtz integral equation is reduced to line integral of a generator as expanding pressure and velocity as fourier series in circumferential direction after meshing the generator into some 3 node isoparameter elements the node pressure can be further expressed as displacements of all segments correspondingly the acoustic pressure can be easily considered in continuity conditions between segments continuity conditions at junctions of beam beam segment segment and beam segment can be orderly assembled to directly establish the final governing equation for vibro acoustic analysis of coupled propeller shaft hull systems 2 the semi analytic dynamic model fig 1 shows the schematic diagram of a coupled propeller shaft hull system and the submerged hull is modeled as a ring stiffened conical cylindrical spherical shell with bulkheads which is uniformly considered in the dynamic model of general ring stiffened shells of revolution a global cartesian and cylindrical coordinate systems o x y z and o r θ x are also given in the figure and the origin is located at the center of left end directions of three axes of the global cartesian coordinate system indicate axial vertical and transverse directions to establish vibro acoustic governing equation of the coupled system due to propeller forces the hull and shaft are divided into p narrow segments and 3 beams in axial direction respectively and these narrow segments are modeled as conical shells and beams are considered as timoshenko beams all segments and beams will be assembled to the overall system via continuity conditions which are modified by the external acoustic pressure acting on the hull to consider structure acoustic coupling 2 1 structural model 2 1 1 conical shells fig 2 shows the schematic diagram of a conical shell segment α is the semi vertex angle r 1 and r 2 are radii at two ends and r 0 r 1 r 2 2 is the mean radius the local coordinate o c x c z c θ c of a conical shell and normal directions of displacements and forces at ends are also presented in the following the subscript c indicating parameters of conical shells will be omitted based on flügge shell theory equations of motions of conical shells are leissa 1993 1 l 11 u l 12 v l 13 w 0 l 21 u l 22 v l 23 w 0 l 31 u l 32 v l 33 w 0 where l i j i j 1 3 are differential operators by expanding displacements as the power series and fourier series in meridional and circumferential directions u v and w are expressed as tong 1993 2 u x θ t n 0 m 0 a n m c x m cos n θ a n m s x m sin n θ e j ω t v x θ t n 0 m 0 b n m c x m sin n θ b n m s x m cos n θ e j ω t w x θ t n 0 m 0 c n m c x m cos n θ c n m s x m sin n θ e j ω t where the superscript c and s indicate symmetric and anti symmetric modes m n j ω and t are the exponent circumferential mode number imaginary unity circular frequency and time substituting eq 2 into eq 1 recurrence relationships about a n m c b n m c c n m c a n m s b n m s and c n m s can be deduced omitting the time part displacements are further expressed as 3 u x θ n 0 u n c x n c t cos n θ u n s x n s t sin n θ v x θ n 0 v n c x n c t sin n θ v n s x n s t cos n θ w x θ n 0 w n c x n c t cos n θ w n s x n s t sin n θ where 4 x n c a n 0 c a n 1 c b n 0 c b n 1 c c n 0 c c n 1 c c n 2 c c n 3 c x n s a n 0 s a n 1 s b n 0 s b n 1 s c n 0 s c n 1 s c n 2 s c n 3 s the detailed process to deduce the recurrence relationships and eq 3 can be referred in the previous works of authors xie et al 2015 2019a 2019b 1 8 vectors u n c v n c w n c u n s v n s and w n s mainly consist of the recurrence relationships local coordinate x exponent m and circumferential mode number n it must be stated that it seems impossible to give concisely analytic expressions for every element in these vectors but these elements can be readily obtained in matlab on the basis of recurrence relationships to uniformly express displacements and forces in global cylindrical coordinate system displacements and forces in normal and meridional directions are transformed into the ones in radial and axial directions 5 u u cos α w sin α w w cos α u sin α n n cos α s sin α s s cos α n sin α substituting eq 3 into expressions of forces and considering the truncated circumferential mode number n displacements and forces at any cross section of conical shells are 6 u v w β n t s m t n 0 n τ c d n c τ c f n c x n c t τ s d n s τ s f n s x n s t where 7 d n ψ 1 u n ψ 1 v n ψ 1 w n ψ 1 β n ψ 1 4 8 f n ψ 1 n n ψ 1 t n ψ 1 s n ψ 1 m n ψ 1 4 8 8 τ c diag cos n θ sin n θ cos n θ cos n θ τ s diag sin n θ cos n θ sin n θ sin n θ in eq 7 superscript ψ 1 denotes c or s 2 1 2 beams a local cartesian coordinate system is presented in fig 3 for a beam normal directions of three axes of the local cartesian coordinate system completely coincide with corresponding ones of global cartesian coordinate w x w y and w z are displacements in x b y b and z b directions expressions of slope β y and β z and forces n x n y n z m y and m z are given in appendix a equations of motions for longitudinal vibrations of bars and transverse vibrations of timoshenko beams are qatu and leissa 2011 9 e a 2 w x z 2 ρ a 2 w x t 2 0 e i z 4 w y x 4 ρ a 2 w y t 2 ρ i z 1 e k b g 4 w y x 2 t 2 ρ 2 i z k b g 4 w y t 4 0 e i y 4 w z x 4 ρ a 2 w z t 2 ρ i y 1 e k b g 4 w z x 2 t 2 ρ 2 i y k b g 4 w z t 4 0 where k b is shear correction factor and it is assigned as 9 10 for beams with circular cross section i y and i z are the moment of inertia a is the cross section area e ρ and g are young s modulus density and shear modulus to solve above equation w x w y and w z are expanded as 10 w x w b x e j k b x x e j ω t i 1 2 w b x i e j k b x i x e j ω t w y w b y e j k b y x e j ω t i 1 4 w b y i e j k b y i x e j ω t w z w b z e j k b z x e j ω t i 1 4 w b z i e j k b z i x e j ω t substituting the middle part of above equation into eq 9 a two order eigen equation for k b x and two independent four order eigen equations for k b y and k b z are deduced so displacements are expressed as the final form in eq 10 accordingly displacements and forces of beams are expressed as 11 w x w y w z β y β z n x n y n z m y m z t d b f b x b t where 12 d b w x w y w z β y β z 5 10 f b n x n y n z m y m z 5 10 13 x b w b x 1 w b x 2 w b y 1 w b y 2 w b y 3 w b y 4 w b z 1 w b z 2 w b z 3 w b z 4 in eq 12 1 10 vectors w x w y w z β y β z n x n y n z m y and m z can be easily obtained through displacement functions eq 10 and detailed expressions are not given for simplicity 2 1 3 coupled propeller shaft hull systems to assemble all segments and beams to the coupled system continuity conditions between segment segment beam beam and beam segment are required in fig 4 normal directions of displacements and forces at the ith junction of hull and the jth junction of shaft are shown although spring damping systems of stern middle thrust bearing are coupled with the hull at several axial locations as shown in fig 1 only one certain junction is considered in theory formulas as a result the ith junction of hull and the jth junction of shaft are one to one correspondence in the figure a ring with rectangular cross section is modeled as annular plate and it is indicated by the subscript a the semi vertex angle of conical segments is assigned as 90 or 90 for internal or external rings so it is always the right edge coupled with the hull 2 1 3 1 continuity conditions of shell segments at the ith junction of hull continuity conditions of displacements and equilibrium equations of forces are 14 u i r u i 1 l u a i r v i r v i 1 l v a i r w i r w i 1 l w a i r β i r β i 1 l β a i r 15 n i r n i 1 l n a i r k 1 k f u i j k h t i r t i 1 l t a i r k 1 k f v i j k h s i r s i 1 l s a i r k 1 k f w i j k h m i r m i 1 l m a i r 0 in eq 15 k denotes the number of spring damping systems for one bearing f u i j k h f x i j k h f v i j k h f y i j k h cos θ k f z i j k h sin θ k and f w i j k h f y i j k h sin θ k f z i j k h cos θ k f x i j k h f y i j k h and f z i j k h are forces of spring damping systems acting on the hull and they are expressed as dirac delta function δ as 16 f x i j k h f x i j k h 0 δ θ θ k r i f y i j k h f y i j k h 0 δ θ θ k r i f z i j k h f z i j k h 0 δ θ θ k r i where f x i j k h 0 f y i j k h 0 and f z i j k h 0 are amplitudes and they are denoted by a vector f i j k h f x i j k h 0 f y i j k h 0 f z i j k h 0 θ k indicates the circumferential coordinate and r i is radius at the i th junction of hull in addition free boundary conditions at the left edge of rings must be taken into account and they are 17 n a i l 0 t a i l 0 s a i l 0 m a i l 0 it should be mentioned that since it is always the right edge of rings coupled with the hull continuity conditions between rings and hull keep unchanged in eqs 14 15 and 17 for internal and external rings and the difference of these two types of rings comes from different semi vertex angles substituting eq 6 into eqs 14 17 continuity conditions between segments eq 14 and 15 further become 18 d n i ψ 1 r x n i ψ 1 t d n i 1 ψ 1 l x n i 1 ψ 1 t 19 f n i ψ 1 r x n i ψ 1 t f n i 1 ψ 1 l x n i 1 ψ 1 t f n i a ψ 1 r t n i a ψ 1 x n i 1 ψ 1 t m n i ψ 1 f i j h where 20 d n i ψ 1 l d n i ψ 1 x l i 2 d n i ψ 1 r d n i ψ 1 x l i 2 f n i ψ 1 l f n i ψ 1 x l i 2 f n i ψ 1 r f n i ψ 1 x l i 2 21 m n i ψ 1 m n i 1 ψ 1 m n i 2 ψ 1 m n i k ψ 1 22 f n i a ψ 1 r f n i ψ 1 x h a i 2 23 t n i a ψ 1 d n i a ψ 1 r f n i a ψ 1 l 1 d n i 1 ψ 1 l 0 24 f i j h f i j 1 h f i j 2 h f i j k h f i j k h t in above equations l i is the meridional length of conical segments decomposed from the hull and h a i is the height of corresponding ring 4 8 matrices d n i a ψ 1 r and f n i a ψ 1 l equal to d n i ψ 1 x h a i 2 and f n i ψ 1 x h a i 2 matrix m n i k ψ 1 is given in appendix b at two ends of the hull displacements are restrained by artificial springs on the basis of eq 19 boundary conditions are readily obtained 25 k e d n 1 ψ 1 x l 1 2 f n 1 ψ 1 x l 1 2 x n 1 ψ 1 t b n 1 ψ 1 x n 1 ψ 1 t 0 k e d n p ψ 1 x l p 2 f n p ψ 1 x l p 2 x n p ψ 1 t b n p ψ 1 x n p ψ 1 t 0 where k e diag k u k v k w k β k u k v k w and k β are corresponding stiffness constants 2 1 3 2 continuity conditions of beams continuity conditions between beams are 26 w x j r w x j 1 l w y j r w y j 1 l w z j r w z j 1 l β y j r β y j 1 l β z j r β z j 1 l 27 n x j r n x j 1 l k 1 k f x i j k b n y j r n y j 1 l k 1 k f y i j k b n z j r n z j 1 l k 1 k f z i j k b m y j r m y j 1 l 0 m z j r m z j 1 l 0 substituting eqs 11 and 12 into above two equations eqs 26 and 27 become 28 d j b r x j b t d j 1 b l x j 1 b t 29 f j b r x j b t f j 1 b l x j 1 b t m j b f i j b where 30 m j b m j 1 b m j 2 b m j k b 31 d j b l d j b x 0 d j b r d j b x l i b f j b l f j b x 0 f j b r f j b x l i b 32 f i j b f i j 1 b f i j 2 b f i j k b f i j k b t between the lumped mass and shaft continuity conditions are 33 f 1 b l x 1 b t ω 2 m p d 1 b l x 1 b t b 1 b x 1 b t f 1 e where m p diag m p m p m p 0 0 f 1 e f x f y f z 0 0 t and b 1 b f 1 b l ω 2 m p d 1 b l m p is the mass of propeller f x f y and f z are amplitudes of propeller excitations in axial vertical and transverse directions 2 1 3 3 continuity conditions between segments and beams in eq 19 and eq 29 vectors f i j h and f i j b are stilled unknown by virtue of fig 4 three elements in sub vector f i j k h f i j k b of f i j h f i j b are 34 f x i j k h 0 f x i j k b 0 k x j ω c x w x j 1 l u i 1 l f y i j k h 0 f y i j k b 0 k y j ω c y w y j 1 l w i 1 l cos θ k v i 1 l sin θ k f z i j k h 0 f z i j k b 0 k z j ω c z w z j 1 l w i 1 l sin θ k v i 1 l cos θ k where k x k y and k z are stiffness coefficients in axial vertical and transverse directions and c x c y and c z are corresponding damping coefficients according to eqs 6 and 11 eq 34 is rewritten as 35 f i j k h t k s t s g d j 1 b l x j 1 b t t k h g n 0 n τ n k c d n i 1 c l x n i 1 c t τ n k s d n i 1 s l x n i 1 s t where 36 k s diag k x j ω c x k y j ω c y k z j ω c z 37 t s g 1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 38 t k h g 1 0 0 0 0 sin θ k cos θ k 0 0 cos θ k sin θ k 0 39 τ n k c diag cos n θ k sin n θ k cos n θ k cos n θ k τ n k s diag sin n θ k cos n θ k sin n θ k sin n θ k according to eq 34 it is further found that 40 f i j h f i j b through assembling boundary and continuity conditions of segments eq 18 19 and beams eq 28 29 and 33 and considering eqs 35 and 40 the vibration governing equation of coupled propeller shaft hull systems is 41 κ h c 0 0 0 κ h s 0 0 0 κ b κ c c κ c s κ b c κ s c κ s s κ b s κ h c κ h s κ h b x c x s x b 0 0 f e where 42 κ h ψ 1 diag k h 0 ψ 1 k h 1 ψ 1 k h n ψ 1 43 κ b b 1 b d 1 b r f 1 b r d 2 b l f 2 b l d 2 b r f 2 b r d 3 b l f 3 b l f 3 b r 44 κ ψ 1 ψ 2 κ 00 ψ 1 ψ 2 κ 0 n ψ 1 ψ 2 κ n 0 ψ 1 ψ 2 κ nn ψ 1 ψ 2 45 κ b ψ 1 κ 0 b ψ 1 κ 1 b ψ 1 κ n b ψ 1 46 κ h ψ 1 κ 0 h ψ 1 κ 1 h ψ 1 κ n h ψ 1 47 x ψ 1 x 0 1 ψ 1 x 0 2 ψ 1 x 0 p ψ 1 x n 1 ψ 1 x n p ψ 1 x n 1 ψ 1 x n p ψ 1 t x b x 1 b x 2 b x 3 b t 48 f e f 1 e 0 25 1 in eq 44 ψ 2 also indicates c and s matrices κ h n ψ 1 κ n 1 n 2 ψ 1 ψ 2 κ n b ψ 1 κ n h ψ 1 and κ h b are given in appendix b 2 2 acoustic model of hull to calculate external acoustic pressure generated by vibrations of shells of revolution the helmholtz boundary integral equation is employed in fig 5 external field point p and surface field point q are shown acoustic pressure p p and p q satisfy integral equation 49 c p p p s 0 p q g p q n q p q n q g p q d s 0 q where g p q e j k f r p q 4 π r p q is free space green s function and c p is the geometric constant according to coordinates of p and q distance r p q between two points is 50 r p q r 1 λ 2 cos 2 θ 2 where r r p r q 2 x p x q 2 λ 2 r p r q r and θ θ q θ p it should be mentioned that θ in eq 50 completely coincides with the circumferential coordinate of global cylindrical coordinate system taking full advantage of geometry property of shells of revolution acoustic pressure p r θ x and surface velocity w r θ x can be expanded as fourier series 51 p r θ x n 0 p n c r x cos n θ p n s r x sin n θ w r θ x n 0 w n c r x cos n θ w n s r x sin n θ substituting eqs 50 and 51 into eq 49 the surface integral equation is reduced to 52 c p p n ψ 1 p γ h n ψ 1 p n q g n ψ 1 p n ψ 1 q n q r q d γ where 53 g n ψ 1 0 2 π g p q cos n θ d θ h n ψ 1 0 2 π g p q n cos n θ d θ how to calculate above two equations was discussed in many opened works and readers can refer to the reference wang et al 1997 as needed by meshing the generator γ into several 3 node isoparametric elements and utilizing gaussian quadrature formulas the line integral equation eq 52 is rewritten as 54 a n p n ψ 1 b n w n ψ 1 where vector p n ψ 1 and w n ψ 1 consist of node pressure and velocity 55 p n ψ 1 p n 1 ψ 1 p n 2 ψ 1 p n p 1 ψ 1 t w n ψ 1 w n 1 ψ 1 w n 2 ψ 1 w n p 1 ψ 1 t in order to conveniently consider structural acoustic coupling the element mesh of generator has been uniformly considered as dividing hull to segments which means that axial locations of all junctions between segments are the same with the ones of nodes on generator as the hull is divided into p segments there are p 2 elements and p 1 nodes for the acoustic model in addition the acoustic model of opened shells is sealed by rigid circular baffle at the ends furthermore the chief method copley 1967 is adopted to eliminate the nonuniqueness 2 3 final vibro acoustic model velocity vector w n ψ 1 is expressed by displacements of segments as 56 w n ψ 1 t n v ψ 1 x n 1 ψ 1 x n 2 ψ 1 x n p ψ 1 t where 57 t n v ψ 1 w n 1 ψ 1 l w n 2 ψ 1 l w n p ψ 1 l w n p ψ 1 r p 1 8 p 58 w n i ψ 1 l j ω t i v d n i ψ 1 l w n i ψ 1 r j ω t i v d n i ψ 1 r in eq 58 t i v cos α i 0 sin α i 0 substituting eq 56 into eq 54 the surface pressure can be further expressed as 59 p n ψ 1 t n p ψ 1 x n 1 ψ 1 x n 2 ψ 1 x n p ψ 1 t where t n p ψ 1 a n 1 b n t n v ψ 1 owing to the acoustic pressure of external fluid equilibrium equations of forces between segments eq 19 are modified as 60 f n i ψ 1 r x n i ψ 1 t f n i 1 ψ 1 l x n i 1 ψ 1 t f n i a ψ 1 r t n i a ψ 1 x n i 1 ψ 1 t p n i ψ 1 m n i ψ 1 f i j h accordingly the vibration governing equation eq 41 is extended to the vibro acoustic governing equation of the titled structure 61 κ h c 0 0 0 κ h s 0 0 0 κ b κ c c κ c s κ b c κ s c κ s s κ b s κ h c κ h s κ h b κ f c 0 0 0 κ f s 0 0 0 0 x c x s x b 0 0 f b where 62 κ f ψ 1 diag k f 0 ψ 1 k f 1 ψ 1 k f n ψ 1 63 κ f n ψ 1 κ f n 1 ψ 1 0 4 8 p κ f n 2 c 0 4 8 p κ f n p ψ 1 κ f n p 1 ψ 1 8 p 8 p in eq 63 κ f n i ψ 1 is 64 κ f n i ψ 1 t n i p ψ 1 cos α i 0 t n i p ψ 1 sin α i 0 4 8 p in eq 64 t n i p ψ 1 denotes the ith row in matrix t n p ψ 1 3 results and discussion detailed geometry and material parameters of the coupled system are listed in table 1 only internal rings are accounted for both hull and shaft are composed of steel two kinds of external fluid water and air are considered the stern and middle bearings are located at the small end of conical shell and the junction between conical and cylindrical shells respectively for stern middle or thrust bearing 9 spring damping systems are adopted and they evenly distributed from θ 90 to θ 270 in circumferential direction and the damping is assigned as 0 as no appropriate results in opened works can be directly utilized to demonstrate the accuracy of present method a coupled finite element boundary element model is developed in virtual lab 13 6 the finite element model is modeled in ansys16 0 the hull rings and bulkheads are composed of 156 904 shell 181 elements the shaft is modeled as 110 beam 188 elements and the propeller is simulated as 1 mass21 element three bearings are modeled as 63 combin14 elements the boundary element model is also generated in ansys and the total number of elements is 8576 the elements satisfy the requirement of convergence fig 6 shows the finite element model and boundary element model in addition as adopting ansys to calculate the dry modes of coupled system the first 1000 orders of modes are accounted for and the maximum frequency is larger than 230 hz for present method the conical cylindrical and spherical parts are divided to 60 180 102 segments and the truncated circumferential mode number is 10 the number of segments and truncated circumferential mode number can ensure convergent results of present method the propeller excitation is in three directions and the amplitude of f x f y and f z is 1 n the frequency range is 1 100 hz and the step is 1 hz 3 1 validity 3 1 1 vibro acoustic responses in air vibro acoustic responses of the coupled system submerged in air are firstly discussed and comparison results are shown in fig 7 the sum displacement of driving point d s and the radiated sound power w s are analyzed and they are represented by displacement level 20 log 10 d s 10 12 and sound power level 10 log 10 w s 10 12 respectively fem bem indicates results calculated by virtual lab it is observed that two curves in two sub figures are almost overlapped excepting amplitudes of several resonant peaks in addition directivity patterns of two peaks are compared in fig 8 the axial coordinate of these field points is x 30 964 m and the distance between field points and the axis of coupled system is 1000 m the sound pressure p a is presented as 20 log 10 p a 10 6 once again the directivity pattern of present method agrees well with the one of fem bem for two frequencies 3 1 2 vibro acoustic responses in water in fig 9 vibro acoustic responses of the coupled system submerged in water are compared for two methods as frequencies are less than 50 hz results of two methods are completely consistent besides amplitudes of several peaks as frequencies are larger than 50 hz the shift of resonant peaks appears which is more apparent for sound power and frequencies of most resonant peaks are labeled in the figure about sound power it is known that the discrepancy of these resonant peaks is 1 hz or 2 hz in contrast to results in air fig 7 the difference between two methods is more obvious for the ones in water on one hand more resonant peaks of the coupled system submerged in water appear which means that modes with higher orders appear on the other hand the difference between theories of two methods leads to slight discrepancies of natural frequencies and it is more obvious for modes with higher order in addition as the difference in percentage may be not apparent the absolute difference becomes obvious for large frequencies these reasons lead to slight shift of peaks at 50 100 hz to further illustrate the accuracy of present method fig 10 and fig 11 compare surface normal velocities and directivity patterns of two methods for some resonant peaks respectively although frequencies of some resonant peaks of two methods are different surface velocities of two methods are almost identical for directivity patterns curves of present method are in well agreement with the ones of fem bem in addition from figs 8 10 and 11 it is further observed that modes with circumferential mode number n 1 seems to be mainly contributed to vibro acoustic responses of the coupled system which will be particularly discussed in sec 3 2 1 on the basis of the aforementioned comparisons for the coupled system submerged in air and water it can be concluded that present method is of high accuracy for titled structures furthermore the number of segments of present method is significantly less than the number of elements in the coupled finite element boundary element method which means that present method is of higher efficiency to some degree 3 2 parameter analysis as vibrations of different nodes on the hull may be disparate the mean quadratic velocity will be employed to discuss vibration characteristics of the coupled system the mean quadratic velocity of hull v m e a n is expressed as 20 log 10 v m e a n 10 9 3 2 1 contributions of different modes contributions of different modes to vibro acoustic responses of the coupled system are presented in fig 12 it is clearly found that curves of n 1 beam modes almost coincide with the ones of n 0 10 for most resonant peaks whereas peaks in 30 50 hz are mainly dominated by n 0 breathing modes in addition results of n 2 can be ignored especially for sound power on the other hand although amplitudes of mean quadratic velocity of n 0 are not the maximum for the peaks in 30 50 hz corresponding amplitudes of sound power are obviously greater than all other peaks accordingly beam modes and breathing modes mainly dominate vibro acoustic responses of the coupled system under propeller excitations and breathing modes are more efficient for radiated sound power 3 2 2 effects of excitations of propeller fig 13 compares vibro acoustic responses of the coupled system under different propeller excitations excepting from amplitudes of several peaks curves of vertical excitation f y and transverse excitation f z seem to be overlapped for axial excitation f x besides results in 30 50 hz the vibro acoustic responses are obviously less than the ones of f y or f z comparing figs 12 and 13 it is further found that beam modes are excited by vertical or transverse force while breathing modes are excited by axial force in addition for non resonant frequencies the sound power is dominated by the excitation in three directions 3 2 3 contributions of different parts in order to analyze contributions of three parts of the hull conical cylindrical and spherical shells to vibro acoustic responses the mean quadratic velocity and sound power of three parts are compared with the ones of overall hull in fig 14 it is found that the mean quadratic velocity of conical shell is obviously larger than others although the mean quadratic velocity of cylindrical shell is not the largest the sound power is mainly dominated by cylindrical shell for most frequencies which may be attributed to the largest radiated surface for the peaks dominated by breathing modes contributions of conical and spherical shells are more outstanding 3 2 4 effects of bearings fig 15 shows effects of stiffness constant of three bearings on vibro acoustic responses it is clearly found that effects of the variation of stiffness of middle bearing seem to be negligible for stern and thrust bearings increasing the stiffness can dramatically increase vibro acoustic responses of the coupled system but changes are apparently different the overall tendency of three curves about stern bearing is similar notwithstanding amplitudes are reduced by the decrease of stiffness for thrust bearing contributions of breathing modes to vibro acoustic responses are not predominant as the stiffness constant is 1 10 7 but they become more and more outstanding with the increase of stiffness in addition as the stiffness increases from 1 10 8 to 1 10 9 the resonant peak with maximum amplitude obviously shifts which means that the breathing mode with higher order is excited and the phenomenon is more visible for sound power in above models every bearing is idealized as 9 spring damping systems and effects of the number of spring damping systems are shown in fig 16 on the whole with the decrease of the number of spring damping systems vibro acoustic responses can be apparently reduced which is similar with effects of the stiffness constant of bearings in addition most resonant peaks of four numbers are identical since the peaks are mainly dominated by modes of hull and similar phenomenon can be also found in effects of stiffness constants of bearings for some peaks between 20 and 50 hz decreasing the number of spring damping systems reduces supporting stiffness of the propeller shaft system which leads to the shift of the resonant peaks 3 2 5 effects of stiffeners for present method rings with rectangular cross section and bulkheads are uniformly dealt as annular plates for bulkheads the inner radius is assigned as a very small value accordingly effects of both rings and bulkheads are taken into account in fig 17 since the number of bulkheads is apparently less than rings effects of bulkheads are smaller in addition as vibration responses of the hull are mainly contributed by the overall breathing and beam modes rather than local modes of the hull effects of stiffeners are not very apparent but vibro acoustic responses of the coupled system can be reduced through increasing stiffeners to some degree 4 conclusions a semi analytic model is developed for vibro acoustic analysis of coupled propeller shaft hull systems under propeller excitations in three directions the hull is idealized as a ring stiffened conical cylindrical spherical shell with bulkheads and it is considered as a specific case of ring stiffened shells of revolution in theory modeling the propeller and shaft are modeled as the lumped mass and multi span beam stern middle and thrust bearings are simplified as spring damping systems to obtain governing equation the hull and shaft are decomposed into many shell segments and beams in axial direction respectively by expanding displacements as power series and fourier series in axial and circumferential directions motion equations of conical shells are solved and four displacements and four forces at cross section of segments are further expressed as 8 unknown coefficients longitudinal vibrations of bars and bending vibrations of timoshenko beams are adopted to analyze vibrations of the shaft for external acoustic pressure the surface helmholtz integral equation is reduced to line integral of a generator as expanding pressure and velocity as fourier series in circumferential direction the node pressure can be further expressed as displacements of all segments via meshing the generator into some 3 node isoparameter elements so acoustic pressure can be readily considered in continuity conditions between segments continuity conditions at junctions of segment segment beam beam and beam segment are orderly assembled to establish the final vibro acoustic governing equation of coupled propeller shaft hull systems through comparing vibro acoustic results of present method and fem bem the validity of the semi analytic model is demonstrated as the coupled system is excited by propeller forces in three directions breathing and beam modes are mainly contributed to vibro acoustic responses in addition beam modes are mainly excited by vertical and transverse excitations whereas breathing modes are excited by axial excitation for three shell parts of the hull mean quadratic velocity of conical part is obviously larger than other two parts but sound power is mainly dominated by cylindrical part decreasing stiffness of stern or thrust bearing can efficiently reduce vibro acoustic responses of the coupled system stiffeners can also decrease vibro acoustic responses to some degree although the hull is considered as a ring stiffened conical cylindrical spherical shell with bulkheads other combined shells such as conical cylindrical conical and spherical conical spherical shells are uniformly considered in present dynamic model which means that present model is of wider applications in contrast to traditional finite element methods or coupled finite element boundary element methods present method is of higher efficiency in addition contributions of different modes and compartments to vibro acoustic responses can be easily dealt credit authorship contribution statement kun xie methodology writing original draft meixia chen conceptualization supervision wanjing dong validation investigation formal analysis wencheng li writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china grand nos 51909098 and 51779098 the natural science foundation of hubei province of china grand no 2019cfb132 and the fundamental research funds for the central universities of china grant nos 2662018qd032 and 2662018qd005 appendix c supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix c supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 108175 appendix a for beams slopes β y and β y and forces n x n y n z m y and m z are a 1 β y w z x ρ k b g 2 w z t 2 d x a 2 β z w y x ρ k b g 2 w y t 2 d x a 3 n x e a w x x a 4 n y k b a g β z w y x a 5 n z k b a g β y w z x a 6 m y e i y β y x a 7 m z e i z β z x appendix b 4 3 matrix m n i k ψ 1 in eq 21 is b 1 m n i k ψ 1 t n i k f ψ 1 t d 0 1 3 where b 2 t n i k f c 1 ε π r i diag cos n θ k sin n θ k cos n θ k t n i k f s 1 ε π r i diag sin n θ k cos n θ k sin n θ k b 3 t d 1 0 0 0 cos θ k sin θ k 0 sin θ k cos θ k in eq b 2 ε 2 for n 0 and ε 1 for n 1 5 3 matrix m j k b in eq 30 is b 4 m j k b 1 0 0 0 1 0 0 0 1 0 0 0 0 0 0 8 p 8 p matrices k h n ψ 1 in eq 42 are b 5 k h n ψ 1 b n 1 ψ 1 d n 1 ψ 1 r f n 1 ψ 1 r d n 2 ψ 1 l f n 2 ψ 1 l m d n 2 ψ 1 r f n 2 ψ 1 r d n 3 ψ 1 l f n 3 ψ 1 l m d n p 1 ψ 1 r f n p 1 ψ 1 r d n p ψ 1 l f n p ψ 1 l m b n p ψ 1 8 p 8 p where b 6 f n i ψ 1 l m f n i ψ 1 l f n i 1 a ψ 1 r t n i 1 a ψ 1 to simplify expressions of κ n 1 n 2 ψ 1 ψ 2 κ n b ψ 1 κ h b n ψ 1 and κ n h b it is assumed that the stern middle and thrust bearings are only located at the i 1 th i 2 th and i 3 th junctions of the hull and corresponding junctions of shaft are j 1 1 j 2 2 and j 3 3 in addition some notations i 12 i 2 i 1 i 23 i 3 i 2 i 34 p i 3 are introduced matrices κ n 1 n 2 ψ 1 ψ 2 and κ n b ψ 1 are b 7 κ n 1 n 2 ψ 1 ψ 2 diag 0 8 i 1 8 i 1 κ n 1 n 2 i 1 ψ 1 ψ 2 0 8 i 12 4 8 i 12 8 κ n 1 n 2 i 2 ψ 1 ψ 2 0 8 i 23 4 8 i 23 8 κ n 1 n 2 i 3 ψ 1 ψ 2 0 8 i 34 4 8 i 34 8 b 8 κ n b ψ 1 0 8 i 1 30 κ n i 1 b ψ 1 0 8 i 12 4 30 κ n i 2 b ψ 1 0 8 i 23 4 30 κ n i 3 b ψ 1 0 8 i 34 4 30 where b 9 κ n 1 n 2 i ψ 1 ψ 2 k 1 k m n 1 i k ψ 1 k s t k h g τ n 2 k ψ 2 d n 2 i 1 ψ 2 l i i 1 i 2 i 3 b 10 κ n i 1 b ψ 1 k 1 k 0 4 10 m n i 1 k ψ 1 k s t s g d 2 b l 0 4 10 κ n i 2 b ψ 1 k 1 k 0 4 20 m n i 2 k ψ 1 k s t s g d 3 b l κ n i 3 b ψ 1 k 1 k 0 4 20 m n i 3 k ψ 1 k s t s g d 3 b r matrices κ h b n c κ h b n s and κ n h b are b 11 κ n h ψ 1 0 5 8 p 0 5 8 p κ n j 1 h ψ 1 0 5 8 p κ n j 2 h ψ 1 κ n j 3 h ψ 1 30 8 p κ h b 0 5 8 p 0 5 8 p κ j 1 h b 0 5 8 p κ j 2 h b κ j 3 h b 30 30 where b 12 κ n j q h ψ 1 0 5 8 i q κ n i q h ψ 1 0 5 8 p 8 i q 8 q 1 2 3 b 13 κ j 1 h b k 0 k 0 5 10 m j 1 k b k s t s g d 2 b l 0 5 10 κ j 2 h b k 0 k 0 5 20 m j 2 k b k s t s g d 3 b l κ j 3 h b k 0 k 0 5 20 m j 3 k b k s t s g d 3 b r in eq b 12 b 14 κ n i q h ψ 1 k 1 k m j q k b k s t k h g τ n k ψ 1 d n i q 1 ψ 1 l q 1 2 3 
21324,a semi analytic dynamic model is developed for vibro acoustic analysis of submerged coupled propeller shaft hull systems under propeller forces the propeller shaft and hull are idealized as a lumped mass multi span beam and ring stiffened shell of revolution respectively stern middle and thrust bearings are simulated as spring damping systems the hull is firstly decomposed into many segments which are treated as conical shells and analyzed through combining flügge shell theory and power series method the shaft is divided into three timoshenko beams according to the bearings by expanding acoustic pressure and velocity as fourier series in circumferential direction surface helmholtz integral equation is reduced to line integral and acoustic pressure is further expressed as displacements of segments after meshing the line to some 3 node isoparameter elements boundary conditions and continuity conditions modified by external acoustic pressure are orderly assembled to the dynamic model as considering the hull as a ring stiffened conical cylindrical spherical shell vibro acoustic results of present method are compared with ones of coupled finite element boundary element method and the accuracy and efficiency of developed dynamic model are demonstrated furthermore parameter analysis reveals that breathing and beam modes are predominant for vibro acoustic responses and sound power is mainly dominated by the cylindrical compartment keywords coupled propeller shaft hull systems semi analytic method ring stiffened conical cylindrical spherical shells helmholtz integral equation vibro acoustic responses 1 introduction for submerged vessels such as submarines the level of radiated noise is vital and the reduction or suppression of vibration and radiated noise has been a key topic in a long time however knowing vibro acoustic characteristics of these structures plays a very important role before adopting appropriate measures for the reduction or suppression at low frequencies significant radiated noise emitting from submerged vessels can be attributed to fluctuating propeller forces which are generated by the rotation of propeller in spatially nonuniform wake and transmitted to the hull through the propeller shaft system as a result dynamic models of independent propeller shaft system or hull cannot be directly utilized for vibro acoustic analysis of the coupled structure accordingly the dynamic modeling for vibro acoustic responses of coupled propeller shaft hull systems under propeller excitations has been attracting attentions of lots of researchers and engineers on the other hand although there are some opened works about dynamic modeling of the coupled system the literature about analytic or semi analytic models is rare how to obtain the governing equation of the titled structure is involved in three major problems namely establishing the dynamic model of hull establishing the dynamic model of propeller shaft system and synthesizing the two parts vibro acoustic characteristics of independent propeller shaft system or fluid loaded hull e g cylindrical shells conical cylindrical shells and cylindrical spherical shells have received much attention since the last century and these investigations are not particularly analyzed here for recent studies about vibro acoustic problems of coupled propeller shaft hull systems the coupled finite element boundary element method fem bem is the most common tool merz et al 2009 2010 li et al 2016 2019 wang et al 2017 su et al 2018 merz et al 2009 2010 utilized ansys to generate structural stiffness mass and damping matrices and the software developed by the authors to compute structure fluid coupling matrices however only axial force excitation of propeller was considered in addition experiments were adopted in some references li et al 2016 wang et al 2017 su et al 2018 and results illustrated the validity of established models on the basis of fem bem some other methods were developed song et al 2014 huang et al 2017 chen et al 2019 qin et al 2020 song et al 2014 used the transfer matrix method and fem bem to construct the model of propeller shaft system and hull respectively the two parts were synthesized via the mobility at connection point between propeller shaft system and foundation through employing fem bem or fem to obtain frequency response functions at connection points on the propeller shaft system and hull a frf based substructuring method was proposed for vibro acoustic analysis of coupled propeller shaft hull systems huang et al 2017 chen et al 2019 qin et al 2020 caresta and kessissoglou 2011a 2011b 2012 developed a semi analytic method to study vibro acoustic responses of submarine hull under axial excitation of propeller the hull was modeled as a ring stiffened conical cylindrical shell with internal bulkheads the two ends of which were closed by circular plates as both the hull and excitation are axisymmetric only axisymmetric motions were considered in addition smearing out method was used to deal with ring stiffeners rather than discrete members correspondingly the dynamic model was significantly simplified after utilizing one kind of finite element software to calculate dry modes and generate boundary element mesh of the propeller shaft hull coupled system qi et al 2016 2019a 2019b extended the three dimensional sono elasticity theory to explore acoustic and vibrational characteristics by virtue of the modified variational method and spectral kirchhoff helmholtz integral formulation qu et al 2017 developed a theoretical model for coupled propeller shaft and submarine hull system under propeller force excitations in different directions radial and thrust bearings were modeled as spring damping system and hull was modeled as a spherical cylindrical spherical shell without bulkheads for most of these investigations the hull was modeled as a ring stiffened conical cylindrical spherical shell whereas the propeller was modeled as a lumped mass or pan the elasticity of propeller was only considered in several papers huang et al 2017 li et al 2019 qi et al 2019a 2019b in addition commercial software ansys and or virtual lab were utilized to establish the dynamic model the main purpose of current paper is to develop a semi analytic model for vibro acoustic analysis of coupled propeller shaft hull systems subjected to propeller excitations in different directions which is on the basis of the model developed by the authors for vibration analysis of ring stiffened shells of revolution xie et al 2019a and vibro acoustic analysis of submerged shells of revolution xie et al 2019b according to hull models in above mentioned references and some recent articles about vibration and acoustic characteristics of submarine hulls su and jin 2016 jin et al 2017 2018 xie et al 2017 the hull is modeled as a ring stiffened conical cylindrical spherical shell with bulkheads and it is uniformly analyzed as general ring stiffened shells of revolution the propeller and shaft are modeled as a lumped mass and multi span beam stern middle and thrust bearings are idealized as spring damping systems the hull and shaft are firstly divided into many shell segments and beams in axial direction by expanding displacements as power series and fourier series in axial and circumferential directions motion equations of conical shells are solved and four displacements and four forces at cross section of segments are further expressed as 8 unknown coefficients longitudinal vibrations of bars and bending vibrations of timoshenko beams are adopted to analyze vibrations of the shaft for external acoustic pressure the surface helmholtz integral equation is reduced to line integral of a generator as expanding pressure and velocity as fourier series in circumferential direction after meshing the generator into some 3 node isoparameter elements the node pressure can be further expressed as displacements of all segments correspondingly the acoustic pressure can be easily considered in continuity conditions between segments continuity conditions at junctions of beam beam segment segment and beam segment can be orderly assembled to directly establish the final governing equation for vibro acoustic analysis of coupled propeller shaft hull systems 2 the semi analytic dynamic model fig 1 shows the schematic diagram of a coupled propeller shaft hull system and the submerged hull is modeled as a ring stiffened conical cylindrical spherical shell with bulkheads which is uniformly considered in the dynamic model of general ring stiffened shells of revolution a global cartesian and cylindrical coordinate systems o x y z and o r θ x are also given in the figure and the origin is located at the center of left end directions of three axes of the global cartesian coordinate system indicate axial vertical and transverse directions to establish vibro acoustic governing equation of the coupled system due to propeller forces the hull and shaft are divided into p narrow segments and 3 beams in axial direction respectively and these narrow segments are modeled as conical shells and beams are considered as timoshenko beams all segments and beams will be assembled to the overall system via continuity conditions which are modified by the external acoustic pressure acting on the hull to consider structure acoustic coupling 2 1 structural model 2 1 1 conical shells fig 2 shows the schematic diagram of a conical shell segment α is the semi vertex angle r 1 and r 2 are radii at two ends and r 0 r 1 r 2 2 is the mean radius the local coordinate o c x c z c θ c of a conical shell and normal directions of displacements and forces at ends are also presented in the following the subscript c indicating parameters of conical shells will be omitted based on flügge shell theory equations of motions of conical shells are leissa 1993 1 l 11 u l 12 v l 13 w 0 l 21 u l 22 v l 23 w 0 l 31 u l 32 v l 33 w 0 where l i j i j 1 3 are differential operators by expanding displacements as the power series and fourier series in meridional and circumferential directions u v and w are expressed as tong 1993 2 u x θ t n 0 m 0 a n m c x m cos n θ a n m s x m sin n θ e j ω t v x θ t n 0 m 0 b n m c x m sin n θ b n m s x m cos n θ e j ω t w x θ t n 0 m 0 c n m c x m cos n θ c n m s x m sin n θ e j ω t where the superscript c and s indicate symmetric and anti symmetric modes m n j ω and t are the exponent circumferential mode number imaginary unity circular frequency and time substituting eq 2 into eq 1 recurrence relationships about a n m c b n m c c n m c a n m s b n m s and c n m s can be deduced omitting the time part displacements are further expressed as 3 u x θ n 0 u n c x n c t cos n θ u n s x n s t sin n θ v x θ n 0 v n c x n c t sin n θ v n s x n s t cos n θ w x θ n 0 w n c x n c t cos n θ w n s x n s t sin n θ where 4 x n c a n 0 c a n 1 c b n 0 c b n 1 c c n 0 c c n 1 c c n 2 c c n 3 c x n s a n 0 s a n 1 s b n 0 s b n 1 s c n 0 s c n 1 s c n 2 s c n 3 s the detailed process to deduce the recurrence relationships and eq 3 can be referred in the previous works of authors xie et al 2015 2019a 2019b 1 8 vectors u n c v n c w n c u n s v n s and w n s mainly consist of the recurrence relationships local coordinate x exponent m and circumferential mode number n it must be stated that it seems impossible to give concisely analytic expressions for every element in these vectors but these elements can be readily obtained in matlab on the basis of recurrence relationships to uniformly express displacements and forces in global cylindrical coordinate system displacements and forces in normal and meridional directions are transformed into the ones in radial and axial directions 5 u u cos α w sin α w w cos α u sin α n n cos α s sin α s s cos α n sin α substituting eq 3 into expressions of forces and considering the truncated circumferential mode number n displacements and forces at any cross section of conical shells are 6 u v w β n t s m t n 0 n τ c d n c τ c f n c x n c t τ s d n s τ s f n s x n s t where 7 d n ψ 1 u n ψ 1 v n ψ 1 w n ψ 1 β n ψ 1 4 8 f n ψ 1 n n ψ 1 t n ψ 1 s n ψ 1 m n ψ 1 4 8 8 τ c diag cos n θ sin n θ cos n θ cos n θ τ s diag sin n θ cos n θ sin n θ sin n θ in eq 7 superscript ψ 1 denotes c or s 2 1 2 beams a local cartesian coordinate system is presented in fig 3 for a beam normal directions of three axes of the local cartesian coordinate system completely coincide with corresponding ones of global cartesian coordinate w x w y and w z are displacements in x b y b and z b directions expressions of slope β y and β z and forces n x n y n z m y and m z are given in appendix a equations of motions for longitudinal vibrations of bars and transverse vibrations of timoshenko beams are qatu and leissa 2011 9 e a 2 w x z 2 ρ a 2 w x t 2 0 e i z 4 w y x 4 ρ a 2 w y t 2 ρ i z 1 e k b g 4 w y x 2 t 2 ρ 2 i z k b g 4 w y t 4 0 e i y 4 w z x 4 ρ a 2 w z t 2 ρ i y 1 e k b g 4 w z x 2 t 2 ρ 2 i y k b g 4 w z t 4 0 where k b is shear correction factor and it is assigned as 9 10 for beams with circular cross section i y and i z are the moment of inertia a is the cross section area e ρ and g are young s modulus density and shear modulus to solve above equation w x w y and w z are expanded as 10 w x w b x e j k b x x e j ω t i 1 2 w b x i e j k b x i x e j ω t w y w b y e j k b y x e j ω t i 1 4 w b y i e j k b y i x e j ω t w z w b z e j k b z x e j ω t i 1 4 w b z i e j k b z i x e j ω t substituting the middle part of above equation into eq 9 a two order eigen equation for k b x and two independent four order eigen equations for k b y and k b z are deduced so displacements are expressed as the final form in eq 10 accordingly displacements and forces of beams are expressed as 11 w x w y w z β y β z n x n y n z m y m z t d b f b x b t where 12 d b w x w y w z β y β z 5 10 f b n x n y n z m y m z 5 10 13 x b w b x 1 w b x 2 w b y 1 w b y 2 w b y 3 w b y 4 w b z 1 w b z 2 w b z 3 w b z 4 in eq 12 1 10 vectors w x w y w z β y β z n x n y n z m y and m z can be easily obtained through displacement functions eq 10 and detailed expressions are not given for simplicity 2 1 3 coupled propeller shaft hull systems to assemble all segments and beams to the coupled system continuity conditions between segment segment beam beam and beam segment are required in fig 4 normal directions of displacements and forces at the ith junction of hull and the jth junction of shaft are shown although spring damping systems of stern middle thrust bearing are coupled with the hull at several axial locations as shown in fig 1 only one certain junction is considered in theory formulas as a result the ith junction of hull and the jth junction of shaft are one to one correspondence in the figure a ring with rectangular cross section is modeled as annular plate and it is indicated by the subscript a the semi vertex angle of conical segments is assigned as 90 or 90 for internal or external rings so it is always the right edge coupled with the hull 2 1 3 1 continuity conditions of shell segments at the ith junction of hull continuity conditions of displacements and equilibrium equations of forces are 14 u i r u i 1 l u a i r v i r v i 1 l v a i r w i r w i 1 l w a i r β i r β i 1 l β a i r 15 n i r n i 1 l n a i r k 1 k f u i j k h t i r t i 1 l t a i r k 1 k f v i j k h s i r s i 1 l s a i r k 1 k f w i j k h m i r m i 1 l m a i r 0 in eq 15 k denotes the number of spring damping systems for one bearing f u i j k h f x i j k h f v i j k h f y i j k h cos θ k f z i j k h sin θ k and f w i j k h f y i j k h sin θ k f z i j k h cos θ k f x i j k h f y i j k h and f z i j k h are forces of spring damping systems acting on the hull and they are expressed as dirac delta function δ as 16 f x i j k h f x i j k h 0 δ θ θ k r i f y i j k h f y i j k h 0 δ θ θ k r i f z i j k h f z i j k h 0 δ θ θ k r i where f x i j k h 0 f y i j k h 0 and f z i j k h 0 are amplitudes and they are denoted by a vector f i j k h f x i j k h 0 f y i j k h 0 f z i j k h 0 θ k indicates the circumferential coordinate and r i is radius at the i th junction of hull in addition free boundary conditions at the left edge of rings must be taken into account and they are 17 n a i l 0 t a i l 0 s a i l 0 m a i l 0 it should be mentioned that since it is always the right edge of rings coupled with the hull continuity conditions between rings and hull keep unchanged in eqs 14 15 and 17 for internal and external rings and the difference of these two types of rings comes from different semi vertex angles substituting eq 6 into eqs 14 17 continuity conditions between segments eq 14 and 15 further become 18 d n i ψ 1 r x n i ψ 1 t d n i 1 ψ 1 l x n i 1 ψ 1 t 19 f n i ψ 1 r x n i ψ 1 t f n i 1 ψ 1 l x n i 1 ψ 1 t f n i a ψ 1 r t n i a ψ 1 x n i 1 ψ 1 t m n i ψ 1 f i j h where 20 d n i ψ 1 l d n i ψ 1 x l i 2 d n i ψ 1 r d n i ψ 1 x l i 2 f n i ψ 1 l f n i ψ 1 x l i 2 f n i ψ 1 r f n i ψ 1 x l i 2 21 m n i ψ 1 m n i 1 ψ 1 m n i 2 ψ 1 m n i k ψ 1 22 f n i a ψ 1 r f n i ψ 1 x h a i 2 23 t n i a ψ 1 d n i a ψ 1 r f n i a ψ 1 l 1 d n i 1 ψ 1 l 0 24 f i j h f i j 1 h f i j 2 h f i j k h f i j k h t in above equations l i is the meridional length of conical segments decomposed from the hull and h a i is the height of corresponding ring 4 8 matrices d n i a ψ 1 r and f n i a ψ 1 l equal to d n i ψ 1 x h a i 2 and f n i ψ 1 x h a i 2 matrix m n i k ψ 1 is given in appendix b at two ends of the hull displacements are restrained by artificial springs on the basis of eq 19 boundary conditions are readily obtained 25 k e d n 1 ψ 1 x l 1 2 f n 1 ψ 1 x l 1 2 x n 1 ψ 1 t b n 1 ψ 1 x n 1 ψ 1 t 0 k e d n p ψ 1 x l p 2 f n p ψ 1 x l p 2 x n p ψ 1 t b n p ψ 1 x n p ψ 1 t 0 where k e diag k u k v k w k β k u k v k w and k β are corresponding stiffness constants 2 1 3 2 continuity conditions of beams continuity conditions between beams are 26 w x j r w x j 1 l w y j r w y j 1 l w z j r w z j 1 l β y j r β y j 1 l β z j r β z j 1 l 27 n x j r n x j 1 l k 1 k f x i j k b n y j r n y j 1 l k 1 k f y i j k b n z j r n z j 1 l k 1 k f z i j k b m y j r m y j 1 l 0 m z j r m z j 1 l 0 substituting eqs 11 and 12 into above two equations eqs 26 and 27 become 28 d j b r x j b t d j 1 b l x j 1 b t 29 f j b r x j b t f j 1 b l x j 1 b t m j b f i j b where 30 m j b m j 1 b m j 2 b m j k b 31 d j b l d j b x 0 d j b r d j b x l i b f j b l f j b x 0 f j b r f j b x l i b 32 f i j b f i j 1 b f i j 2 b f i j k b f i j k b t between the lumped mass and shaft continuity conditions are 33 f 1 b l x 1 b t ω 2 m p d 1 b l x 1 b t b 1 b x 1 b t f 1 e where m p diag m p m p m p 0 0 f 1 e f x f y f z 0 0 t and b 1 b f 1 b l ω 2 m p d 1 b l m p is the mass of propeller f x f y and f z are amplitudes of propeller excitations in axial vertical and transverse directions 2 1 3 3 continuity conditions between segments and beams in eq 19 and eq 29 vectors f i j h and f i j b are stilled unknown by virtue of fig 4 three elements in sub vector f i j k h f i j k b of f i j h f i j b are 34 f x i j k h 0 f x i j k b 0 k x j ω c x w x j 1 l u i 1 l f y i j k h 0 f y i j k b 0 k y j ω c y w y j 1 l w i 1 l cos θ k v i 1 l sin θ k f z i j k h 0 f z i j k b 0 k z j ω c z w z j 1 l w i 1 l sin θ k v i 1 l cos θ k where k x k y and k z are stiffness coefficients in axial vertical and transverse directions and c x c y and c z are corresponding damping coefficients according to eqs 6 and 11 eq 34 is rewritten as 35 f i j k h t k s t s g d j 1 b l x j 1 b t t k h g n 0 n τ n k c d n i 1 c l x n i 1 c t τ n k s d n i 1 s l x n i 1 s t where 36 k s diag k x j ω c x k y j ω c y k z j ω c z 37 t s g 1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 38 t k h g 1 0 0 0 0 sin θ k cos θ k 0 0 cos θ k sin θ k 0 39 τ n k c diag cos n θ k sin n θ k cos n θ k cos n θ k τ n k s diag sin n θ k cos n θ k sin n θ k sin n θ k according to eq 34 it is further found that 40 f i j h f i j b through assembling boundary and continuity conditions of segments eq 18 19 and beams eq 28 29 and 33 and considering eqs 35 and 40 the vibration governing equation of coupled propeller shaft hull systems is 41 κ h c 0 0 0 κ h s 0 0 0 κ b κ c c κ c s κ b c κ s c κ s s κ b s κ h c κ h s κ h b x c x s x b 0 0 f e where 42 κ h ψ 1 diag k h 0 ψ 1 k h 1 ψ 1 k h n ψ 1 43 κ b b 1 b d 1 b r f 1 b r d 2 b l f 2 b l d 2 b r f 2 b r d 3 b l f 3 b l f 3 b r 44 κ ψ 1 ψ 2 κ 00 ψ 1 ψ 2 κ 0 n ψ 1 ψ 2 κ n 0 ψ 1 ψ 2 κ nn ψ 1 ψ 2 45 κ b ψ 1 κ 0 b ψ 1 κ 1 b ψ 1 κ n b ψ 1 46 κ h ψ 1 κ 0 h ψ 1 κ 1 h ψ 1 κ n h ψ 1 47 x ψ 1 x 0 1 ψ 1 x 0 2 ψ 1 x 0 p ψ 1 x n 1 ψ 1 x n p ψ 1 x n 1 ψ 1 x n p ψ 1 t x b x 1 b x 2 b x 3 b t 48 f e f 1 e 0 25 1 in eq 44 ψ 2 also indicates c and s matrices κ h n ψ 1 κ n 1 n 2 ψ 1 ψ 2 κ n b ψ 1 κ n h ψ 1 and κ h b are given in appendix b 2 2 acoustic model of hull to calculate external acoustic pressure generated by vibrations of shells of revolution the helmholtz boundary integral equation is employed in fig 5 external field point p and surface field point q are shown acoustic pressure p p and p q satisfy integral equation 49 c p p p s 0 p q g p q n q p q n q g p q d s 0 q where g p q e j k f r p q 4 π r p q is free space green s function and c p is the geometric constant according to coordinates of p and q distance r p q between two points is 50 r p q r 1 λ 2 cos 2 θ 2 where r r p r q 2 x p x q 2 λ 2 r p r q r and θ θ q θ p it should be mentioned that θ in eq 50 completely coincides with the circumferential coordinate of global cylindrical coordinate system taking full advantage of geometry property of shells of revolution acoustic pressure p r θ x and surface velocity w r θ x can be expanded as fourier series 51 p r θ x n 0 p n c r x cos n θ p n s r x sin n θ w r θ x n 0 w n c r x cos n θ w n s r x sin n θ substituting eqs 50 and 51 into eq 49 the surface integral equation is reduced to 52 c p p n ψ 1 p γ h n ψ 1 p n q g n ψ 1 p n ψ 1 q n q r q d γ where 53 g n ψ 1 0 2 π g p q cos n θ d θ h n ψ 1 0 2 π g p q n cos n θ d θ how to calculate above two equations was discussed in many opened works and readers can refer to the reference wang et al 1997 as needed by meshing the generator γ into several 3 node isoparametric elements and utilizing gaussian quadrature formulas the line integral equation eq 52 is rewritten as 54 a n p n ψ 1 b n w n ψ 1 where vector p n ψ 1 and w n ψ 1 consist of node pressure and velocity 55 p n ψ 1 p n 1 ψ 1 p n 2 ψ 1 p n p 1 ψ 1 t w n ψ 1 w n 1 ψ 1 w n 2 ψ 1 w n p 1 ψ 1 t in order to conveniently consider structural acoustic coupling the element mesh of generator has been uniformly considered as dividing hull to segments which means that axial locations of all junctions between segments are the same with the ones of nodes on generator as the hull is divided into p segments there are p 2 elements and p 1 nodes for the acoustic model in addition the acoustic model of opened shells is sealed by rigid circular baffle at the ends furthermore the chief method copley 1967 is adopted to eliminate the nonuniqueness 2 3 final vibro acoustic model velocity vector w n ψ 1 is expressed by displacements of segments as 56 w n ψ 1 t n v ψ 1 x n 1 ψ 1 x n 2 ψ 1 x n p ψ 1 t where 57 t n v ψ 1 w n 1 ψ 1 l w n 2 ψ 1 l w n p ψ 1 l w n p ψ 1 r p 1 8 p 58 w n i ψ 1 l j ω t i v d n i ψ 1 l w n i ψ 1 r j ω t i v d n i ψ 1 r in eq 58 t i v cos α i 0 sin α i 0 substituting eq 56 into eq 54 the surface pressure can be further expressed as 59 p n ψ 1 t n p ψ 1 x n 1 ψ 1 x n 2 ψ 1 x n p ψ 1 t where t n p ψ 1 a n 1 b n t n v ψ 1 owing to the acoustic pressure of external fluid equilibrium equations of forces between segments eq 19 are modified as 60 f n i ψ 1 r x n i ψ 1 t f n i 1 ψ 1 l x n i 1 ψ 1 t f n i a ψ 1 r t n i a ψ 1 x n i 1 ψ 1 t p n i ψ 1 m n i ψ 1 f i j h accordingly the vibration governing equation eq 41 is extended to the vibro acoustic governing equation of the titled structure 61 κ h c 0 0 0 κ h s 0 0 0 κ b κ c c κ c s κ b c κ s c κ s s κ b s κ h c κ h s κ h b κ f c 0 0 0 κ f s 0 0 0 0 x c x s x b 0 0 f b where 62 κ f ψ 1 diag k f 0 ψ 1 k f 1 ψ 1 k f n ψ 1 63 κ f n ψ 1 κ f n 1 ψ 1 0 4 8 p κ f n 2 c 0 4 8 p κ f n p ψ 1 κ f n p 1 ψ 1 8 p 8 p in eq 63 κ f n i ψ 1 is 64 κ f n i ψ 1 t n i p ψ 1 cos α i 0 t n i p ψ 1 sin α i 0 4 8 p in eq 64 t n i p ψ 1 denotes the ith row in matrix t n p ψ 1 3 results and discussion detailed geometry and material parameters of the coupled system are listed in table 1 only internal rings are accounted for both hull and shaft are composed of steel two kinds of external fluid water and air are considered the stern and middle bearings are located at the small end of conical shell and the junction between conical and cylindrical shells respectively for stern middle or thrust bearing 9 spring damping systems are adopted and they evenly distributed from θ 90 to θ 270 in circumferential direction and the damping is assigned as 0 as no appropriate results in opened works can be directly utilized to demonstrate the accuracy of present method a coupled finite element boundary element model is developed in virtual lab 13 6 the finite element model is modeled in ansys16 0 the hull rings and bulkheads are composed of 156 904 shell 181 elements the shaft is modeled as 110 beam 188 elements and the propeller is simulated as 1 mass21 element three bearings are modeled as 63 combin14 elements the boundary element model is also generated in ansys and the total number of elements is 8576 the elements satisfy the requirement of convergence fig 6 shows the finite element model and boundary element model in addition as adopting ansys to calculate the dry modes of coupled system the first 1000 orders of modes are accounted for and the maximum frequency is larger than 230 hz for present method the conical cylindrical and spherical parts are divided to 60 180 102 segments and the truncated circumferential mode number is 10 the number of segments and truncated circumferential mode number can ensure convergent results of present method the propeller excitation is in three directions and the amplitude of f x f y and f z is 1 n the frequency range is 1 100 hz and the step is 1 hz 3 1 validity 3 1 1 vibro acoustic responses in air vibro acoustic responses of the coupled system submerged in air are firstly discussed and comparison results are shown in fig 7 the sum displacement of driving point d s and the radiated sound power w s are analyzed and they are represented by displacement level 20 log 10 d s 10 12 and sound power level 10 log 10 w s 10 12 respectively fem bem indicates results calculated by virtual lab it is observed that two curves in two sub figures are almost overlapped excepting amplitudes of several resonant peaks in addition directivity patterns of two peaks are compared in fig 8 the axial coordinate of these field points is x 30 964 m and the distance between field points and the axis of coupled system is 1000 m the sound pressure p a is presented as 20 log 10 p a 10 6 once again the directivity pattern of present method agrees well with the one of fem bem for two frequencies 3 1 2 vibro acoustic responses in water in fig 9 vibro acoustic responses of the coupled system submerged in water are compared for two methods as frequencies are less than 50 hz results of two methods are completely consistent besides amplitudes of several peaks as frequencies are larger than 50 hz the shift of resonant peaks appears which is more apparent for sound power and frequencies of most resonant peaks are labeled in the figure about sound power it is known that the discrepancy of these resonant peaks is 1 hz or 2 hz in contrast to results in air fig 7 the difference between two methods is more obvious for the ones in water on one hand more resonant peaks of the coupled system submerged in water appear which means that modes with higher orders appear on the other hand the difference between theories of two methods leads to slight discrepancies of natural frequencies and it is more obvious for modes with higher order in addition as the difference in percentage may be not apparent the absolute difference becomes obvious for large frequencies these reasons lead to slight shift of peaks at 50 100 hz to further illustrate the accuracy of present method fig 10 and fig 11 compare surface normal velocities and directivity patterns of two methods for some resonant peaks respectively although frequencies of some resonant peaks of two methods are different surface velocities of two methods are almost identical for directivity patterns curves of present method are in well agreement with the ones of fem bem in addition from figs 8 10 and 11 it is further observed that modes with circumferential mode number n 1 seems to be mainly contributed to vibro acoustic responses of the coupled system which will be particularly discussed in sec 3 2 1 on the basis of the aforementioned comparisons for the coupled system submerged in air and water it can be concluded that present method is of high accuracy for titled structures furthermore the number of segments of present method is significantly less than the number of elements in the coupled finite element boundary element method which means that present method is of higher efficiency to some degree 3 2 parameter analysis as vibrations of different nodes on the hull may be disparate the mean quadratic velocity will be employed to discuss vibration characteristics of the coupled system the mean quadratic velocity of hull v m e a n is expressed as 20 log 10 v m e a n 10 9 3 2 1 contributions of different modes contributions of different modes to vibro acoustic responses of the coupled system are presented in fig 12 it is clearly found that curves of n 1 beam modes almost coincide with the ones of n 0 10 for most resonant peaks whereas peaks in 30 50 hz are mainly dominated by n 0 breathing modes in addition results of n 2 can be ignored especially for sound power on the other hand although amplitudes of mean quadratic velocity of n 0 are not the maximum for the peaks in 30 50 hz corresponding amplitudes of sound power are obviously greater than all other peaks accordingly beam modes and breathing modes mainly dominate vibro acoustic responses of the coupled system under propeller excitations and breathing modes are more efficient for radiated sound power 3 2 2 effects of excitations of propeller fig 13 compares vibro acoustic responses of the coupled system under different propeller excitations excepting from amplitudes of several peaks curves of vertical excitation f y and transverse excitation f z seem to be overlapped for axial excitation f x besides results in 30 50 hz the vibro acoustic responses are obviously less than the ones of f y or f z comparing figs 12 and 13 it is further found that beam modes are excited by vertical or transverse force while breathing modes are excited by axial force in addition for non resonant frequencies the sound power is dominated by the excitation in three directions 3 2 3 contributions of different parts in order to analyze contributions of three parts of the hull conical cylindrical and spherical shells to vibro acoustic responses the mean quadratic velocity and sound power of three parts are compared with the ones of overall hull in fig 14 it is found that the mean quadratic velocity of conical shell is obviously larger than others although the mean quadratic velocity of cylindrical shell is not the largest the sound power is mainly dominated by cylindrical shell for most frequencies which may be attributed to the largest radiated surface for the peaks dominated by breathing modes contributions of conical and spherical shells are more outstanding 3 2 4 effects of bearings fig 15 shows effects of stiffness constant of three bearings on vibro acoustic responses it is clearly found that effects of the variation of stiffness of middle bearing seem to be negligible for stern and thrust bearings increasing the stiffness can dramatically increase vibro acoustic responses of the coupled system but changes are apparently different the overall tendency of three curves about stern bearing is similar notwithstanding amplitudes are reduced by the decrease of stiffness for thrust bearing contributions of breathing modes to vibro acoustic responses are not predominant as the stiffness constant is 1 10 7 but they become more and more outstanding with the increase of stiffness in addition as the stiffness increases from 1 10 8 to 1 10 9 the resonant peak with maximum amplitude obviously shifts which means that the breathing mode with higher order is excited and the phenomenon is more visible for sound power in above models every bearing is idealized as 9 spring damping systems and effects of the number of spring damping systems are shown in fig 16 on the whole with the decrease of the number of spring damping systems vibro acoustic responses can be apparently reduced which is similar with effects of the stiffness constant of bearings in addition most resonant peaks of four numbers are identical since the peaks are mainly dominated by modes of hull and similar phenomenon can be also found in effects of stiffness constants of bearings for some peaks between 20 and 50 hz decreasing the number of spring damping systems reduces supporting stiffness of the propeller shaft system which leads to the shift of the resonant peaks 3 2 5 effects of stiffeners for present method rings with rectangular cross section and bulkheads are uniformly dealt as annular plates for bulkheads the inner radius is assigned as a very small value accordingly effects of both rings and bulkheads are taken into account in fig 17 since the number of bulkheads is apparently less than rings effects of bulkheads are smaller in addition as vibration responses of the hull are mainly contributed by the overall breathing and beam modes rather than local modes of the hull effects of stiffeners are not very apparent but vibro acoustic responses of the coupled system can be reduced through increasing stiffeners to some degree 4 conclusions a semi analytic model is developed for vibro acoustic analysis of coupled propeller shaft hull systems under propeller excitations in three directions the hull is idealized as a ring stiffened conical cylindrical spherical shell with bulkheads and it is considered as a specific case of ring stiffened shells of revolution in theory modeling the propeller and shaft are modeled as the lumped mass and multi span beam stern middle and thrust bearings are simplified as spring damping systems to obtain governing equation the hull and shaft are decomposed into many shell segments and beams in axial direction respectively by expanding displacements as power series and fourier series in axial and circumferential directions motion equations of conical shells are solved and four displacements and four forces at cross section of segments are further expressed as 8 unknown coefficients longitudinal vibrations of bars and bending vibrations of timoshenko beams are adopted to analyze vibrations of the shaft for external acoustic pressure the surface helmholtz integral equation is reduced to line integral of a generator as expanding pressure and velocity as fourier series in circumferential direction the node pressure can be further expressed as displacements of all segments via meshing the generator into some 3 node isoparameter elements so acoustic pressure can be readily considered in continuity conditions between segments continuity conditions at junctions of segment segment beam beam and beam segment are orderly assembled to establish the final vibro acoustic governing equation of coupled propeller shaft hull systems through comparing vibro acoustic results of present method and fem bem the validity of the semi analytic model is demonstrated as the coupled system is excited by propeller forces in three directions breathing and beam modes are mainly contributed to vibro acoustic responses in addition beam modes are mainly excited by vertical and transverse excitations whereas breathing modes are excited by axial excitation for three shell parts of the hull mean quadratic velocity of conical part is obviously larger than other two parts but sound power is mainly dominated by cylindrical part decreasing stiffness of stern or thrust bearing can efficiently reduce vibro acoustic responses of the coupled system stiffeners can also decrease vibro acoustic responses to some degree although the hull is considered as a ring stiffened conical cylindrical spherical shell with bulkheads other combined shells such as conical cylindrical conical and spherical conical spherical shells are uniformly considered in present dynamic model which means that present model is of wider applications in contrast to traditional finite element methods or coupled finite element boundary element methods present method is of higher efficiency in addition contributions of different modes and compartments to vibro acoustic responses can be easily dealt credit authorship contribution statement kun xie methodology writing original draft meixia chen conceptualization supervision wanjing dong validation investigation formal analysis wencheng li writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china grand nos 51909098 and 51779098 the natural science foundation of hubei province of china grand no 2019cfb132 and the fundamental research funds for the central universities of china grant nos 2662018qd032 and 2662018qd005 appendix c supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix c supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 108175 appendix a for beams slopes β y and β y and forces n x n y n z m y and m z are a 1 β y w z x ρ k b g 2 w z t 2 d x a 2 β z w y x ρ k b g 2 w y t 2 d x a 3 n x e a w x x a 4 n y k b a g β z w y x a 5 n z k b a g β y w z x a 6 m y e i y β y x a 7 m z e i z β z x appendix b 4 3 matrix m n i k ψ 1 in eq 21 is b 1 m n i k ψ 1 t n i k f ψ 1 t d 0 1 3 where b 2 t n i k f c 1 ε π r i diag cos n θ k sin n θ k cos n θ k t n i k f s 1 ε π r i diag sin n θ k cos n θ k sin n θ k b 3 t d 1 0 0 0 cos θ k sin θ k 0 sin θ k cos θ k in eq b 2 ε 2 for n 0 and ε 1 for n 1 5 3 matrix m j k b in eq 30 is b 4 m j k b 1 0 0 0 1 0 0 0 1 0 0 0 0 0 0 8 p 8 p matrices k h n ψ 1 in eq 42 are b 5 k h n ψ 1 b n 1 ψ 1 d n 1 ψ 1 r f n 1 ψ 1 r d n 2 ψ 1 l f n 2 ψ 1 l m d n 2 ψ 1 r f n 2 ψ 1 r d n 3 ψ 1 l f n 3 ψ 1 l m d n p 1 ψ 1 r f n p 1 ψ 1 r d n p ψ 1 l f n p ψ 1 l m b n p ψ 1 8 p 8 p where b 6 f n i ψ 1 l m f n i ψ 1 l f n i 1 a ψ 1 r t n i 1 a ψ 1 to simplify expressions of κ n 1 n 2 ψ 1 ψ 2 κ n b ψ 1 κ h b n ψ 1 and κ n h b it is assumed that the stern middle and thrust bearings are only located at the i 1 th i 2 th and i 3 th junctions of the hull and corresponding junctions of shaft are j 1 1 j 2 2 and j 3 3 in addition some notations i 12 i 2 i 1 i 23 i 3 i 2 i 34 p i 3 are introduced matrices κ n 1 n 2 ψ 1 ψ 2 and κ n b ψ 1 are b 7 κ n 1 n 2 ψ 1 ψ 2 diag 0 8 i 1 8 i 1 κ n 1 n 2 i 1 ψ 1 ψ 2 0 8 i 12 4 8 i 12 8 κ n 1 n 2 i 2 ψ 1 ψ 2 0 8 i 23 4 8 i 23 8 κ n 1 n 2 i 3 ψ 1 ψ 2 0 8 i 34 4 8 i 34 8 b 8 κ n b ψ 1 0 8 i 1 30 κ n i 1 b ψ 1 0 8 i 12 4 30 κ n i 2 b ψ 1 0 8 i 23 4 30 κ n i 3 b ψ 1 0 8 i 34 4 30 where b 9 κ n 1 n 2 i ψ 1 ψ 2 k 1 k m n 1 i k ψ 1 k s t k h g τ n 2 k ψ 2 d n 2 i 1 ψ 2 l i i 1 i 2 i 3 b 10 κ n i 1 b ψ 1 k 1 k 0 4 10 m n i 1 k ψ 1 k s t s g d 2 b l 0 4 10 κ n i 2 b ψ 1 k 1 k 0 4 20 m n i 2 k ψ 1 k s t s g d 3 b l κ n i 3 b ψ 1 k 1 k 0 4 20 m n i 3 k ψ 1 k s t s g d 3 b r matrices κ h b n c κ h b n s and κ n h b are b 11 κ n h ψ 1 0 5 8 p 0 5 8 p κ n j 1 h ψ 1 0 5 8 p κ n j 2 h ψ 1 κ n j 3 h ψ 1 30 8 p κ h b 0 5 8 p 0 5 8 p κ j 1 h b 0 5 8 p κ j 2 h b κ j 3 h b 30 30 where b 12 κ n j q h ψ 1 0 5 8 i q κ n i q h ψ 1 0 5 8 p 8 i q 8 q 1 2 3 b 13 κ j 1 h b k 0 k 0 5 10 m j 1 k b k s t s g d 2 b l 0 5 10 κ j 2 h b k 0 k 0 5 20 m j 2 k b k s t s g d 3 b l κ j 3 h b k 0 k 0 5 20 m j 3 k b k s t s g d 3 b r in eq b 12 b 14 κ n i q h ψ 1 k 1 k m j q k b k s t k h g τ n k ψ 1 d n i q 1 ψ 1 l q 1 2 3 
