index,text
20525,in this note one focuses on the application of the event triggered mechanism into the formation control system of the underactuated surface vehicles usvs to avoid the possible singularity problem a novel fleet control model of the leader follower structure is established in the cartesian coordinate frame the innovation of this design is that the information status between the leader and the follower could be acquired continuously and intuitively furthermore a practical event triggered robust neural control is developed by utilizing the robust neural damping technique and the input event triggered rule when the event triggered threshold is satisfied the state variables and the control input could be reset or updated aperiodically that can effectively reduce the occupancy of the communication network from the controller to the actuator and facilitate its application in the practical engineering in this algorithm only four adaptive updated parameters are required in the adaptive model such design could compensate the gain uncertainties and the environmental disturbances based on the lyapunov theory considerable efforts have been made to illustrate that all signals in the closed loop system are the semi global uniformly ultimately bounded sguub finally numerical simulations are conducted to demonstrate the validity of the proposed scheme keywords underactuated vehicles formation control optimized leader follower structure neural damping technique event triggered inputs 1 introduction the formation control of the underactuated surface vehicles usvs is gradually becoming a meaningful research area in practical engineering due to its diversity and flexibility especially more successful formation applications have been explored in the civilian and military fields e g ocean navigation replenishment chen and wang 2005 environmental monitoring beard et al 2001 resource exploration xiang et al 2018 compared with a variety of formation control methods peng et al 2013 xiao et al 2016 the leader follower based control has become a more preferred approach with the simple configuration and effective implementation while tracking the predetermined path the leader follower based scheme requires to constantly update the feedback status signals and relevant control commands breivik et al 2018 however for the resource limited onboard that is unnecessary and unrealistic owning to the busy information interaction between the controller and the actuator the congestion may occur frequently or cause the failure of the conventional control schemes he et al 2018 therefore for the purpose of efficiency and resource conservation the leader follower formation control scheme with consideration of the event triggered mechanism should attract more attentions and is meaningful in the marine industry under the leader follower based control structure all vehicles are divided into two roles the leader and the follower the leader is converged to a predetermined reference path while forcing the follower to maintain the desired distance and orientation from the leader xiang et al 2017 in the existing literature the corresponding studies on the leader follower structure have been the active area of the formation control research for instance in skjetne et al 2002 for merits of the vectorial backstepping technique an nonlinear formation control is proposed the related formation is viewed as a flexible system that maneuvers along a parameterized path such design makes the geometric task and the dynamic task for the formation of marine craft can be addressed respectively by virtues of the lyapunov based technique and graph theory a cooperative path tracking guidance for the formation control is proposed in ghommam and mnif 2009 this enables the decentralized formation control structure could be achieved during the instantaneous steering however the formation control task is largely constrained to the priori knowledge of the predefined path to address the problem the virtual vehicles are constructed into the formation scheme cui et al 2010 based on the law of the adaptive position tracking the followers could be converged to the reference point only by tracking the dynamic virtual vehicle in the aforementioned literatures the formation controllers are constructed with the model based methods which require obtain the model parameters precisely however in practical applications it is difficult to settle the issue of the model parameters acquisition especially for the hydrodynamic matrix hence it is imperative to employ additional schemes to deal with the related problems for example the cartesian coordinate frame can be applied to optimize the leader follower structure for the kinematic model in li and xiao 2005 a novel cartesian coordinate frame is exploited by virtual of the frame the inherent singularity problem in the polar coordinate representation can be avoided besides the neural networks nns can be employed to compensate for the dynamic uncertainties in shojaei 2015 the radial basis function neural network rbf nn is introduced to solve the trajectory tracking problem of the formation control such design could improve their robustness against the unmodeled dynamics and time varying disturbances however with the application of theoretical algorithms in practice new obstructions e g the explosion of complexity and the curse of dimensionality may occur chen et al 2009 these issues are caused by the repeated differentiations of virtual controls and the large amounts of the updated nns weights hence for merits of the dynamic surface control dsc and robust neural damping techniques a practical robust adaptive formation algorithm is designed lu et al 2018 due to the smaller computational burden the actual control law can be effectively implemented in practice with a concise form furthermore the event triggered mechanism can be introduced into the resource limited formation scheme through the mechanism the performance of the controller is maintained satisfactorily while the over consumption of computing can be greatly reduced szanto et al 2018 in addition to avoid acquiring formation position parameters continuously the event sampled nns can be applied to develop an nonuniform sampled data control system li and yang 2018b thus the related parameters could be transmitted intermittently between the controller and the actuator thus greatly avoiding the occupation of communication resources motivated by the aforementioned observation an event triggered robust neural formation control scheme is proposed for usvs with the optimized leader follower structure different from the traditional studies the corresponding kinematic model is developed in the cartesian coordinate representation furthermore by virtue of the robust neural damping technique and the input event triggered rule a practical event triggered robust neural control algorithm is ultimately constructed the outstanding contributions of this design can be summarized as follows 1 a novel kinematic model for the formation control is designed in the cartesian coordinate representation compared with the similar model in the polar coordinate system it can eliminate the possible singularity problem that may occur as the number of the fleet elements increases moreover based on the designed kinematic model the issue of the fleet state s continuous acquisition can be addressed by the control system in a simple form thus these processes can further optimize the control algorithm and reduce the burden on the computer 2 an event triggered robust neural control algorithm is developed to perform the fleet control task by employing the input event triggered mechanism and the robust neural damping technique the related constraints generated by the nns can be effectively avoided besides the adaptive laws are compressed into four weights to compensate for the actuator s gain uncertainty such parameters can be aperiodically updated only at the event triggered instants hence the triggering process can ultimately reduce the unnecessary information transmission between the actuator and the controller and facilitate its application in practical engineering 2 problem formulation and preliminaries throughout this note indicates the absolute value of the scalar besides and f are expressed as the euclidean norm and the frobenius norm of respectively the estimation error is defined as ˆ and ˆ is the estimated value of for a given matrix a a i j r m n a f 2 t r a t a σ i 1 m σ j 1 n a i j 2 2 1 ship dynamics according to the newtonian and lagrangian mechanics fossen 2011 η i x i y i ψ i t and v i u i v i r i t are defined as the attitude vector and the velocity vector of the i th underactuated surface vehicle usv respectively therefore in a multi vehicle formation system the 3 degree of freedom dof kinematic model of each vehicle could be described as followers 1 x i u i cos ψ i v i sin ψ i y i u i sin ψ i v i cos ψ i ψ i r i 2 u i f u i v t u i m u i n i n i d w u i v i f v i v d w v i r i f r i v f r i m r i δ i d w r i with f u i v m v i m u i v i r i d u 1 i m u i u i d u 2 i m u i u i u i d u 3 i m u i u i 3 f v i v m u i m v i u i r i d v 1 i m v i v i d v 2 i m v i v i v i d v 3 i m v i v i 3 f r i v m u i m v i m r i u i v i d r 1 i m r i r i d r 2 i m r i r i r i d r 3 i m r i r i 3 where η i x i y i ψ i t denote the surge sway displacements and yawing angle of the i th vehicle in the earth fixed coordinate frame v i u i v i r i t represent the surge sway and yaw velocities in the body fixed frame meanwhile m u i m v i m r i are described as the additional mass in the three orientations and d w u i d w v i d w r i indicate the immeasurable forces or moments generated by the marine environment and the system perturbation moreover f u i v f v i v f r i v are expressed as the high order hydrodynamic effects and d l 1 i d l 2 i d l 3 i l u v r are employed to describe the hydrodynamic damping terms n i δ i are the actual control inputs i e the propeller revolution and the actual rudder angle t u i and f r i as the unknown gain function can be expressed as 3 t u i 1 t p ρ w d p 4 k t j p f r i 6 13 v r v r 2 25 a r l 2 x r α h x h u r 2 cos δ i in eq 3 ρ w and d p respectively represent the water density and the propeller diameter k t is the thrust coefficient which is a nonlinear function of the propeller s propulsion coefficient j p besides t p α h as the wake fraction and the attack angle denote the interference effect between the hydrodynamic forces or torques acting on the propeller and the rudder moreover a r l are expressed as the rudder area and the length between perpendiculars v r is the aspect ratio and u r denotes the apparent velocity of the rudder x r and x h are the dimension of the rudder blade and the ship s center of gravity in the x coordinate system furthermore the energy of the actuator is limited in practical engineering hence there are unknown positive constants t u i t u i f r i f r i resulting in 0 t u i t u i t u i 0 f r i f r i f r i assumption 1 in practical engineering the external disturbance terms d w u i d w v i d w r i satisfy d w u i d w u i d w v i d w v i d w r i d w r i where d w u i d w v i d w r i are the unknown positive constants assumption 2 based on the analysis in li et al 2008 as long as the surge and yaw dof are adjusted effectively the usv s sway motion can be achieved passive bounded remark 1 as the external environment is constantly varying with the condition of limited energy the environmental disturbances suffered by the usv have the unknown time varying and bounded signal characteristics thus it can be rendered that assumption 1 is reasonable and meets the practical engineering requirements in addition the sway dynamics passive boundedness for the usv has been systematically illustrated in li et al 2008 since the swing motion of usv is subjected to the hydrodynamic damping forces in the swing direction the conception of the passive bounded swing motion in assumption 2 can be easily satisfied the control objective of this note is to develop a novel event triggered robust neural formation control scheme in the presence of the model uncertainty and the unknown disturbance such that 1 a group of underactuated surface vehicles could closely track the waypoints based reference path in a desired formation configuration 2 all signals in the closed loop system are guaranteed to be semi global uniformly ultimately bounded sguub 2 2 function approximation based on rbf nns in practical engineering neural networks nns are generally applied as an effective tool to address the system uncertainties especially for its good capabilities in approximating unknown functions the radial basis function neural networks rbf nns has been the preferred technique to settle the structure and parameter uncertainties zhang and zhang 2015 xu and sun 2017 hence lemma1 is introduced here to describe the approximate process lemma 1 chen et al 2009 for any given continuous function f x with f 0 0 defined on the compact set ω x through the continuous function separation and rbf nns approximation techniques f x can be ultimately modeled as 4 f x s x a x ε x x ω x where ε x denotes the approximating error with the unknown upper bound ε s x s 1 x s 2 x s n x is the vector of rbf basis functions with the form of gaussian function s i x i 1 2 n 5 s i x 1 2 π ξ i exp x μ i t x μ i 2 ξ i 2 from eq 5 it can be seen that μ i is the center of the receptive field and ξ i indicates the width of the gaussian function a is the optimal weight matrix where m is the dimension number of the state vector x and n denotes the node number of nns 6 a ω 11 ω 12 ω 1 m ω 21 ω 22 ω 2 m ω n 1 ω n 2 ω n m 3 formulation of the robust neural formation control 3 1 leader follower formation set up to display the fleet structure more intuitively the geometric configuration of the leader follower formation is shown in fig 1 there are three key elements in the fundamental group i e one leader vehicle and two followers the leader is in the middle position and the followers are on either side of the leader as a virtual vehicle the leader provides a predetermined attitude reference to the followers while the followers are tracking the leader with the desired distance and orientation jin 2016 in this note p l i λ l i represent the relative distance and angle between the leader and the i th follower similarly the desired distance and angle between the leader and the i th follower are described as p l i d λ l i d referring to fig 1 the basic geometric configuration of the leader follower formation is constructed in the cartesian coordinate frame x l y l ψ l and x i y i ψ i are defined as the position and heading angle of the leader and the i th follower moreover p x l i p y l i are the projects of p l i along the longitudinal and transverse direction relative of the leader besides p x l i d p y l i d are denoted as the desired value of p l i d respectively hence the desired formation can be maintained as 7 p x l i d p l i d sin λ l i d ψ l π 2 p y l i d p l i d cos λ l i d ψ l π 2 define the position error and orientation error between the leader and the i th follower 8 p x l i p y l i ψ e i cos ψ l sin ψ l 0 sin ψ l cos ψ l 0 0 0 1 x l x i y l y i ψ l ψ i taking the derivative of p x l i p y l i ψ e i the formation s relative motion equation can be obtained 9 p x l i p y l i ψ e i 1 0 p y l i 0 1 p x l i 0 0 1 u l v l r l cos ψ e i sin ψ e i 0 sin ψ e i cos ψ e i 0 0 0 1 u i v i r i the distance error in the longitudinal and transverse direction can be defined as x e l i p x l i p x l i d y e l i p y l i p y l i d hence according to eqs 7 8 and 9 the distance error model should be described in the leader s body fixed frame 10 x e l i y e l i ψ e i 1 0 y e l i p y l i d 0 1 x e l i p x l i d 0 0 1 u l v l r l u i cos ψ e i v i sin ψ e i p x l i d u i sin ψ e i v i cos ψ e i p y l i d r i with the specified fleet configuration the control task is to design the bounded tracking algorithms for followers so that 11 lim t x e l i 0 lim t y e l i 0 lim t ψ e i θ θ π 2 π 2 hence in view of the distance errors x e l i y e l i two new coordinate variables z 1 l i z 2 l i can be defined here to perform the coordinate conversion li and xiao 2005 the specific form is expressed as 12 z 1 l i z 2 l i cos ψ e i s i n ψ e i sin ψ e i cos ψ e i x e l i y e l i for merits of the rotation matrix the distance error model can be transformed such design is to facilitate the subsequent description of the distance error model in the follower s coordinate thus the error model related to the two immediate variables can be expressed as 13 z 1 l i z 2 l i 1 z 2 l i 0 z 1 l i u i r i δ 1 i cos ψ e i δ 2 i sin ψ e i δ 1 i sin ψ e i δ 2 i cos ψ e i v i where δ 1 i u l p x l i d p y l i d r l δ 2 i v l p y l i d p x l i d r l remark 2 different from jin 2019 a novel coordinate representation strategy is incorporated for the kinematic model interpreted as follows one adopts the cartesian coordinate representation instead of the commonly used the polar coordinates because there is a singularity problem in the polar coordinate representation moreover two new variables z 1 l i z 2 l i are employed to represent the distances error between the leader and the i th follower thus the formation control system can be transformed into a simple form which contributes to the acquisition of fleet states intuitively 3 2 design of the event triggered mechanism motivated by the detailed illustration of the relative threshold approach in li and yang 2018a an event triggered mechanism with the time varying threshold is introduced here into the formation control scheme hence n l i is defined as the event triggered input which is related to the output signal of the actuator since the threshold mainly depends on the command value of the actuator the related control input signal n l i for the actuator could be designed as 14 n l i t w l i t k l i t t k l i t k 1 l i l u r from eq 14 it can be obtained that the event triggered input signal n l i can be maintained as w l i t k l i during the time t t k l i t k 1 l i where w l i is the intermediate control law and t k l i k z is described as the update time of the actuator furthermore the event triggered error is defined as follows 15 e l i t w l i t n l i t t k 1 l i inf t t k l i e l i t η l i n l i d l i where 0 η l i 1 d l i 0 represent the design parameters according to the above discussion it can be inferred that w l i t n l i t η l i n l i d l i holds for all the time hence the analysis of the event triggered error requires to be conducted for two situation e g n l i t 0 and n l i t 0 for the first situation n l i t 0 it can be obtained that η l i n l i d l i w l i t n l i t η l i n l i d l i similarly η l i n l i d l i w l i t n l i t η l i n l i d l i can be achieved for the second situation n l i t 0 hence the following equation can be developed by combining with the two situation 16 w l i t n l i t λ i t η l i n l i d l i n l i 0 λ i t η l i n l i d l i n l i 0 in eq 16 λ i t 1 1 besides two unknown parameters λ 1 i t λ 2 i t are defined here to substitute λ i t thus the error 16 could be further discussed as 17 w l i t n l i t λ 1 i t η l i n l i λ 2 i t d l i with λ 1 i t λ 2 i t λ i t n l i t 0 λ 1 i t λ 2 i t λ i t n l i t 0 the intermediate value w l i t can be derived 18 w l i t 1 λ 1 i t η l i n l i λ 2 i t d l i furthermore the event triggered input n l i t could ultimately described as follows 19 n l i t w l i t 1 λ 1 i t η l i λ 2 i t d l i 1 λ 1 i t η l i 3 3 control design by virtual of the dynamic surface control dsc and robust neural damping techniques a novel robust adaptive neural formation controller is developed huang et al 2019 li et al 2013 the control design process including two steps e g the kinematic part and the dynamic part are detailed at here step 1 based on eq 13 the error dynamics of the formation control can be derived as follows 20 z 1 l i u i z 2 l i r i δ 1 i cos ψ e i δ 2 i sin ψ e i z 2 l i v i z 1 l i r i δ 1 i sin ψ e i δ 2 i cos ψ e i in order to stabilize the kinematic error dynamics of z 1 l i z 2 l i one can directly choose α u i α ψ e i as the virtual control law of u i ψ e i via the backstepping technique 21 α u i k z 1 l i z 1 l i δ 1 i cos ψ e i δ 2 i sin ψ e i α ψ e i arcsin v i k z 2 l i z 2 l i δ i ξ i where k z 1 l i 0 k z 2 l i 0 are both the design parameters δ i δ 1 i 2 δ 2 i 2 and ξ i arccos δ 1 i δ i arcsin δ 2 i δ i actually v i k z 2 l i z 2 l i δ i can be easily guaranteed in practical engineering if the designed parameters are selected reasonably however the detailed derivations of the virtual signals are complicated and even lead to the increasing complexity of the algorithm to eliminate the constraints and reduce the computational burden the differential of α u i and α ψ e i can be ultimately substituted by employing the dsc technique yang et al 2019 let the virtual signals pass through two first order filters with the time constants τ u i and τ ψ e i 22 τ u i β u i β u i α u i τ ψ e i β ψ e i β ψ e i α ψ e i from eq 20 it can be rendered that the initial values are β u i 0 α u i 0 β ψ e i 0 α ψ e i 0 moreover the errors of the dynamic surface can be described as q u i α u i β u i q ψ e i α ψ e i β ψ e i by defining u e i β u i u i and ψ e i β ψ e i ψ e i one has 23 z 1 l i α u i z 2 l i r i q u i u e i δ 1 i cos ψ e i δ 2 i sin ψ e i k z 1 l i z 1 l i z 2 l i r i q u i u e i z 2 l i v i δ i sin α ψ e i ξ i δ i ψ y i z 1 l i r i k z 2 l i z 2 l i z 1 l i r i δ i ψ y i where ψ y i cos q ψ e i ψ e i 1 sin α ψ e i ξ i sin q ψ e i ψ e i cos α ψ e i ξ i and ψ y i is bounded by ψ y i furthermore based on eqs 21 and 22 q u i q ψ e i can be obtained 24 q u i β u i α u i q u i τ u i α u i z 1 l i z 1 l i α u i ψ e i ψ e i q u i τ u i a u z 1 l i z 1 l i ψ e i ψ e i q ψ e i β ψ e i α ψ e i q ψ e i τ ψ e i α ψ e i z 2 l i z 2 l i α ψ e i v i v i q ψ e i τ ψ e i a ψ e i z 2 l i z 2 l i v i v i since the virtual control β ψ e i is not required in the following design a similar operation is employed here to describe the dynamics ψ e i define α r i and β r i as the virtual control and the filtered signal of r i thus the dynamic surface is described as 25 τ r i β r i β r i α r i β r i 0 α r i 0 then it can be rendered that q r i α r i β r i r e i β r i r i meanwhile the derivative of ψ e i could be deduced 26 ψ e i β ψ e i r l r i β ψ e i r l α r i q r i r e i based on eq 26 the virtual law α r i is described as 27 α r i k ψ e i ψ e i r l β ψ e i besides one can obtain the derivative of q r i 28 q r i β r i α r i q r i τ r i α r i z 2 l i z 2 l i α r i v i v i α r i ψ e i ψ e i q r i τ r i a r i z 2 l i z 2 l i v i v i ψ e i ψ e i where k ψ e i is a designed positive parameter in eqs 24 and 28 a u i a ψ e i and a r i are all the bounded functions moreover there exist the positive constants m u i m ψ e i m r i resulting in a u i m u i a ψ e i m ψ e i and a r i m r i step 2 at this step the derivative of u e i and r e i can be described here by substituting eqs 22 and 25 into eq 2 thus the corresponding error dynamics could be obtained 29 u e i β u i f u i v t u i n i n i m u i d w u i r e i β r i f r i v f r i δ i m r i d w r i according to lemma 1 the system uncertainty f l i v l u r in eq 29 could be approximated by using the rbf nns 30 f l i v s v a l i v ε l i v s v a l i β v s v a l i v e i ε l i v s v a l i β v b l i s v ϖ l i ε l i v where β v β u i 0 β r i t v e i u e i 0 r e i t for the two subsystem u i r i s v is represented as the same basis function of nns besides b l i a l i f a l i m a l i a l i f are defined here it can be rendered that ϖ l i a l i m v e i and b l i ϖ l i a l i v e i hence the robust neural damping term in eq 29 can be described by ζ l i 2 31 ζ l i 2 s ν a l i β ν ε l i d w l i 2 s ν a l i β ν ε l i v d w l i 2 ϑ l i φ l i where ε l i d w l i are denoted as the upper bound of ε l i d w l i besides ϑ l i max a l i f ε l i v d w l i is expressed as the compressed weights and φ l i 1 s ν β ν is the damping term furthermore the error dynamic can be rewritten by substituting the event triggered design 19 into eq 29 32 u e i β u i ζ u i b u i s v ϖ u i 1 m u i t u i w u i t 1 λ 1 i t η u i t u 1 λ 2 i t d u i 1 λ 1 i t η u i r r i β r i ζ r i b r i s v ϖ r i 1 m r i f r i w r i t 1 λ 1 i t η r i f r i λ 2 i t d r i 1 λ 1 i t η r i where t u i 1 λ 1 i t η u i and f r i 1 λ 1 i t η r i are two gain functions in order to facilitate the subsequent design two learning parameters λ t u i λ f r i are introduced here they are defined as λ t u i t u i 1 λ 1 i t η u i 1 and λ f r i f r i 1 λ 1 i t η r i 1 moreover t u i λ 2 i t d u i 1 λ 1 i t η u i f r i λ 2 i t d r i 1 λ 1 i t η r i can be further defined by two new variables φ u i φ r i to stabilize the above effects two adaptive learning parameters ϱ u i ϱ r i are introduced here 33 ϱ u i sup t k u i t t k 1 u i λ 2 i t d u i ϱ r i sup t k r i t t k 1 r i λ 2 i t d r i furthermore the estimated errors are defined as ϱ u i ϱ u i ϱ ˆ u i ϱ r i ϱ r i ϱ ˆ r i where ϱ ˆ u i ϱ ˆ r i are the estimated value of ϱ u i ϱ r i hence the term φ u i φ r i can be further rewritten as 34 φ u i t u i 1 λ 1 i t η u i ϱ ˆ u i t u i 1 λ 1 i t η u i ϱ u i φ r i f r i 1 λ 1 i t η r i ϱ ˆ r i f r i 1 λ 1 i t η r i ϱ r i obviously λ ˆ t u i λ ˆ f r i are the estimated values of λ t u i λ f r i they are updated online to compensate uncertainties of the nonlinear gain functions t u i 1 λ 1 i t η u i and f r i 1 λ 1 i t η r i hence based on eq 19 the actual control variables n i δ i for the propeller revolution and the rudder angle can be derived and α n i α δ i are described as the intermediate control laws for t u i n i n i f r i δ i 35 n i sgn n u i n u i δ i n r i w u i λ ˆ t u i α n i ϱ ˆ u i tanh ϱ ˆ u i u e i ϵ 0 w r i λ ˆ f r i α δ i ϱ ˆ r i tanh ϱ ˆ r i r e i ϵ 0 α n i k n i u e i β u i k u n g u i u e i α δ i k δ i r e i β r i k r n g r i r e i where g u i 1 4 φ u i 2 s v t s v g r i 1 4 φ r i 2 s v t s v ϵ 0 is a small positive value k n i k δ i are the positive controller parameters k u n k r n are the robust neural damping parameters moreover according to the above consideration the corresponding adaptive laws can be designed as follows and the detailed synthesis analysis will be illustrated in section 4 zhang et al 2020 36 λ ˆ t u i γ t u i α n i u e i σ t u i λ ˆ t u i λ ˆ t u i 0 λ ˆ f r i γ f r i α δ i r e i σ f r i λ ˆ f r i λ ˆ f r i 0 ϱ ˆ u i γ ϱ u i u e i σ ϱ u i ϱ ˆ u i ϱ ˆ u i 0 ϱ ˆ r i γ ϱ r i r e i σ ϱ r i ϱ ˆ r i ϱ ˆ r i 0 in eq 36 λ ˆ t u i λ ˆ f r i are utilized to deal with the gain uncertainty and ϱ u i ϱ r i are responsible for compensating the actuator s fault γ t u i γ f r i γ ϱ u i γ ϱ r i σ t u i σ f r i σ ϱ u i σ ϱ r i are all positive parameters besides λ ˆ t u i 0 λ ˆ f r i 0 ϱ ˆ u i 0 ϱ ˆ r i 0 are the initial values of the corresponding variables 4 stability analysis in this section the stability analysis of the closed loop scheme is performed on all signals the consequences can be summarized as theorem 1 theorem 1 consider the closed loop scheme consisting of usvs with the error dynamic system 2 and 10 satisfying assumptions 1 2 the virtual control laws 21 and 27 the event triggered robust neural control 35 and the adaptive updating parameter 36 for all initial conditions satisfying z 1 l i 2 0 z 2 l i 2 0 ψ e i 2 0 q u i 2 0 q r i 2 0 q ψ e i 2 0 u e i 2 0 r e i 2 0 λ t u i 2 0 λ f r i 2 0 ϱ u i 2 0 ϱ r i 2 0 2 δ with any δ 0 hence the design parameters k z 1 l i k z 2 l i k ψ e i k n i k δ i k u n k r n k n u i k n r i γ t u i γ f r i γ ϱ u i γ ϱ r i σ t u i σ f r i σ ϱ u i σ ϱ r i can be turned appropriately such that all the immediate state variables are semi global uniformly ultimately bounded sguub proof according to the design process of the proposed control scheme the lyapunov function candidate can be described as 37 v 1 2 i 1 n z 1 l i 2 z 2 l i 2 ψ e i 2 q u i 2 q r i 2 q ψ e i 2 u e i 2 r e i 2 1 2 i 1 n t u i m u i 1 λ 1 i η u i λ t u i 2 γ t u i ϱ u i 2 γ ϱ u i f r i m r i 1 λ 1 i η r i λ f r i 2 γ f r i ϱ r i 2 γ ϱ r i hence one can have the derivative of v 38 v i 1 n z 1 l i z 1 l i z 2 l i z 2 l i ψ e i ψ e i q u i q u i q r i q r i q ψ e i q ψ e i u e i u e i r e i r e i i 1 n t u i m u i 1 λ 1 i η u i λ t u i λ ˆ t u i γ t u i ϱ u i ϱ ˆ u i γ ϱ u i f r i m r i 1 λ 1 i η r i λ f r i λ ˆ f r i γ f r i ϱ r i ϱ ˆ r i γ ϱ r i along 23 24 26 28 and 32 v can be rewritten 39 v i 1 n k z 1 l i z 1 l i q u i u e i z 1 l i k z 2 l i z 2 l i δ i ψ y i z 2 l i k ψ e i ψ e i q r i r e i ψ e i q u i q u i q r i q r i q ψ e i q ψ e i i 1 n u e i β u i ζ u i b u i s v ϖ u i φ u i m u i t u i m u i 1 λ 1 i t η u i λ t u i λ t u i α n i ϱ ˆ u i tanh ϱ ˆ u i u e i ϵ 0 i 1 n r e i β r i ζ r i b r i s v ϖ r i φ r i m r i f r i m r i 1 λ 1 i t η r i λ f r i λ f r i α δ i ϱ ˆ r i tanh ϱ ˆ r i r e i ϵ 0 i 1 n t u i m u i 1 λ 1 i η u i λ t u i λ ˆ t u i γ t u i ϱ u i ϱ ˆ u i γ ϱ u i i 1 n f r i m r i 1 λ 1 i η r i λ f r i λ ˆ f r i γ f r i ϱ r i ϱ ˆ r i γ ϱ r i in order to simplify the further calculation the following equations can be ultimately obtained via the young s inequality 40 q l i q l i q l i 2 τ l i q l i α l i 1 τ l i m l i 2 2 c q l i 2 c 2 41 ϖ l i t ϖ l i a i m v e 2 ω i 1 t ω i 1 ω i 2 t ω i 2 ω i l t ω i l a i f 2 v e t v e u e 2 r e 2 42 ζ l i l e i b l i s v ϖ l i l e i 1 4 k l n φ i 2 s v t s v l e i 2 ϑ l i 2 k l n b l i 2 ϖ l i t ϖ l i k l n k l n g l i l e i 2 ϑ l i 2 k l n b l i 2 k l n u e i 2 r e i 2 43 λ t u i λ ˆ t u i λ ˆ t u i 0 1 2 λ t u i 2 1 2 λ t u i λ ˆ t u i 0 2 λ f r i λ ˆ f r i λ ˆ f r i 0 1 2 λ f r i 2 1 2 λ f r i λ ˆ f r i 0 2 44 ϱ ˆ u i u e i ϱ ˆ u i u e i tanh ϱ ˆ u i u e i ϵ 1 0 2785 ϵ 1 ϱ ˆ r i r e i ϱ ˆ r i r e i tanh ϱ ˆ r i r e i ϵ 2 0 2785 ϵ 2 45 l e i β l i 1 m l i l e i β l i 1 1 m l i τ l i l e i 2 1 1 m l i 4 τ l i q i 2 substituting the actual control law 35 adaptive law 36 and eq 40 eq 45 into eq 39 the derivative value v can be ultimately rewritten as 46 v i 1 n k z 1 l i 1 2 z 1 l i 2 k z 2 l i δ i 2 4 z 2 l i 2 k ψ e i 1 2 ψ e i 2 1 τ ψ e i m ψ e i 2 2 c q ψ e i 2 3 c 2 ψ y i 2 1 τ u i m u i 2 2 c 1 1 m u i 4 τ u i 1 q u i 2 1 τ r i m r i 2 2 c 1 1 m r i 4 τ r i 1 q r i 2 i 1 n k n i m u i 1 1 m u i τ u i b u i 2 b r i 2 m u i k u n 1 u e i 2 i 1 n k δ i m r i 1 1 m r i τ r i b u i 2 b r i 2 m r i k r n 1 r e i 2 i 1 n t u i m u i 1 λ 1 i η u i σ t u i λ t u i 2 2 σ ϱ u i ϱ u i 2 2 f r i m r i 1 λ 1 i η r i σ f r i λ f r i 2 2 σ ϱ r i ϱ r i 2 2 i 1 n t u i m u i 1 λ 1 i η u i σ t u i 2 λ t u i λ ˆ t u i 0 2 σ ϱ u i 2 ϱ u i ϱ ˆ u i 0 2 0 2785 ϵ 1 f r i m r i 1 λ 1 i η r i σ f r i 2 λ f r i λ ˆ f r i 0 2 σ ϱ r i 2 ϱ r i ϱ ˆ r i 0 2 0 2785 ϵ 2 ϑ u i 2 k u n ϑ r i 2 k r n in eq 46 c 0 ϵ 1 ϵ 2 k u n and k r n are all the positive constants ψ y i 2 is the bounded value which satisfy ψ y i 2 4 to obtain the favorable performance all design parameters should be selected appropriately such that the following conditions hold 47 1 τ u i m u i 3 m u i 1 2 m u i 2 c 4 1 τ r i m r i 3 m r i 1 2 m r i 2 c 4 1 τ ψ e i m ψ e i 2 2 c k z 1 l i 1 2 k z 2 l i δ i 2 4 k n i m u i 1 τ u i b u i 2 b r i 2 k u n m u i k δ i m r i 1 τ r i b u i 2 b r i 2 k r n m r i k ψ e i 1 2 therefore the derivative value v can be rewritten as 48 v 2 a 0 v ρ 0 where a 0 i 1 n a i ρ 0 i 1 n ρ i and a i ρ i are both positive constants satisfying 49 a 1 min k z 1 l i 1 2 k z 2 l i δ i 2 4 k ψ e i 1 2 1 τ ψ e i m ψ e i 2 2 c 1 τ u i m u i 2 2 c 1 1 m u i 4 τ u i 1 1 τ r i m r i 2 2 c 1 1 m r i 4 τ r i 1 k n i m u i 1 1 m u i τ u i b u i 2 b r i 2 m u i k u n 1 k δ i m r i 1 1 m r i τ r i b u i 2 b r i 2 m r i k r n 1 a i min a 1 σ t u i 2 σ f r i 2 σ ϱ u i 2 σ ϱ r i 2 ρ i t u i m u i 1 λ 1 i η u i σ t u i 2 λ t u i λ ˆ t u i 0 2 σ ϱ u i 2 ϱ u i ϱ ˆ u i 0 2 0 2785 ϵ 1 f r i m r i 1 λ 1 i η r i σ f r i 2 λ f r i λ ˆ f r i 0 2 σ ϱ r i 2 ϱ r i ϱ ˆ r i 0 2 0 2785 ϵ 2 ϑ u i 2 k u n ϑ r i 2 k r n ψ y i 2 3 c 2 by integrating eq 48 the equation with v can be obtained 50 v t ρ 0 2 a 0 v 0 ρ 0 2 a 0 exp 2 a 0 t obviously it is rendered that lim t v t ρ 0 2 a 0 and the bounded variable ρ 0 can be small enough by turning the design parameters appropriately besides the boundedness of v also indicates that z 1 l i z 2 l i ψ e i q u i q r i q ψ e i u e i r e i λ t u i ϱ u i λ f r i ϱ r i are all bounded combined with assumption 1 the proposed formation configuration can be guaranteed and the boundedness of α n i α δ i α u i α ψ e i α r i can be referred from 20 26 and 34 hence all signals in the closed loop formation system are sguub the proof is completed 5 numerical experiments in this section numerical experiments have been carried out to illustrate the effectiveness of the proposed formation control scheme for this purposed a set of three usvs including one leader and two followers is employed to describe the basic formation configuration the control plant is quoted from a classic vehicle cybership ii length of l 1 255 m breadth of 0 29 m mass of 23 8 kg whose modeling process has been detailed in skjetne et al 2005 besides by implementing the scale model test in the basin the related model parameters can be ultimately established it is worth noting that the closed loop performance experiment at section 5 1 is presented in fields of the simulated ocean environment while the comparative experiment at section 5 2 is performed between the proposed event triggered control algorithm and the results in lu et al 2018 thus the related principle and the external interference are referred by the literature lu et al 2018 5 1 experiment under the simulated ocean environment in this subsection the superiorities of the proposed formation control algorithm are illustrated by fusing the experiments with the simulated ocean environment the geometric configuration of the formation scheme is formed by three usvs leader follower 1 and follower 2 furthermore the following waypoints are utilized to provide the formation reference w 1 0 m 8 m w 2 21 m 8 m w 3 34 m 35 m w 4 53 m 41 m the leader is in the middle position and the two followers are in the blind zone on both side of the leader therefore a triangular formation structure is constructed to further verify the formation performance of the proposed scheme meanwhile the leader is a virtual vehicle which provides the corresponding attitude reference to the followers the initial values of the leader are set as η l 0 0 m 8 m 0 rad t and v l 0 0 5 m s 0 m s 0 rad s t while the related states of follower1 and follower2 are shown as η 1 0 2 m 5 m π 4 rad t η 2 0 2 m 11 m π 4 rad t and v 1 0 v 2 0 0 m s 0 m s 0 rad s t in addition the both followers are all with the identical nonlinear function f u i f v i that can be approximated by the rbf nns which contains eight neuron nodes with the width h i 2 i 1 2 8 then the centers spaced of u i v i r i can be expressed as 10 m s 10 m s 10 m s 10 m s 2 5 rad s 2 5 rad s moreover the design control parameters for the proposed algorithm can be described where l u r 51 p l 1 d p l 2 d 4 0 λ l 1 d λ l 2 d 3 π 4 k z 1 l 1 1 0 k z 2 l 1 2 0 k z 1 l 2 5 0 k z 2 l 2 8 0 k ψ e 1 k ψ e 2 2 5 k n 1 k n 2 0 5 k δ 1 k δ 2 0 1 k u n k r n 0 3 γ t u 1 γ t u 2 γ f r 1 γ f r 2 0 02 τ u 1 τ u 2 0 1 τ r 1 τ r 2 τ ψ e 1 τ ψ e 2 0 05 σ t u 1 σ t u 2 0 16 σ f r 1 σ f r 2 0 35 γ ϱ l 1 γ ϱ l 2 0 116 σ ϱ l 1 σ ϱ l 2 0 14 to simulate the external marine disturbance the physical based mathematical models fossen 2011 are introduced here the real sea state of the environment including the sea wind and the irregular wind generated waves can be generated by the norsok wind spectrum and the jonswap wave spectrums the 4 level sea state is simulated the wind direction is ψ wind 200 deg and the average wind velocity is v wind 15 7 m s fig 2 illustrates the corresponding graphs of the wind field and wind generated waves that can be used to describe the forces torques generated by the amplitude of the sea state for the given fleet configuration the experiment results of the formation can be illustrated in figs 3 7 with the simulated ocean environment in fig 3 the pink dotted line represents the trajectory of the leader while the followers track the leader s trajectory according to the desired distance and angle as can be seen the triangle formation geometry of the three usvs is guaranteed which means that an effective formation configuration can be achieved by setting the desired distance and angle between the leader and the i th follower hence as long as the leader and the i th follower maintain different desired angles and distances the different formation configurations can be ultimately realized in the proposed algorithm fig 4 illustrates the distance errors and heading errors between the followers and the reference paths respectively under the conditions of the uncertain dynamic and ocean disturbance the distance errors both converge to a small neighborhood of the origin meanwhile despite the maneuverability of the fleet the heading error of the two followers can also remain bounded that are consistent with theorem 1 in fig 5 the control orders and the actual inputs of the two followers are described it can be conclude that the control orders and the actual inputs are within an reasonable range note the event triggered proposed scheme is with the larger and more frequent control orders though that can satisfies the physical constraints i e δ r i 0 deg 30 deg therefore according to the event triggered control inputs the actual inputs n i δ r i could eventually converge to the vicinity of the origin furthermore fig 6 shows the corresponding inter event time between two adjacent event triggered instants it can be seen that the minimum inter event time is 0 05 s and the mean interval is 0 2 s the existence of the inter event time can prove that the undesirable zeno behavior is excluded and the network transmission load from the controller to the actuator can be effectively reduced fig 7 presents the corresponding adaptive parameters for each follower which are utilized compensate the effect of the actuator s gain uncertainties it can be seen that the updating online parameters are quickly ensure a reasonable range within 20 s 5 2 comparative experiments in this subsection the event triggered control scheme and the existing results in lu et al 2018 are selected as the comparative experiment to illustrate the robustness and the effectiveness of the proposed scheme the related principle and the external interference are referred by the literature lu et al 2018 in addition the initial values and the corresponding reference trajectories are all with the identical parameters in section 5 1 the comparative results are presented in figs 8 10 in fig 8 the comparison of the formation trajectory is described by the different control schemes obviously the performance of the proposed algorithm is better than those based on the algorithm in lu et al 2018 especially in the process of the maneuvering turns fig 9 illustrates the distance errors and the heading errors in the both algorithm for follower 1 it can be seen that the corresponding errors both converge to the reasonable range of the origin for the guiding law in lu et al 2018 although the bounded problem is solved the fluctuation range of the errors are larger than those based on the proposed control algorithm fig 10 presents the comparison of the control inputs for follower 1 since the event triggered mechanism is introduced into the proposed algorithm the control inputs are required to be updated only at the event triggered instants it is can be found that the control inputs of the proposed control algorithm are significantly smaller than those of result in lu et al 2018 namely the proposed algorithm can effectively reduce the computational load and increase the response efficiency since the update does not need to be performed in every available time for further qualitative analysis three common performance indexes are introduced into the comparative evaluation e g the mean absolute error mae the mean absolute control effort mac and the mean total variation mtv of the control zhang and zhang 2013 they are respectively described as the stabilizing performance of the system the energy consumption and the smoothness properties of the controller the detailed quantitative valuation are summarized as table 1 it can be observed that the item value n 1 underlined marked in the mac is a bit larger than that under the algorithm in lu et al 2018 however on the whole the values of the proposed schemes are less than the corresponding values in lu et al 2018 hence through the quantitative comparison it can be proved that the proposed algorithm is with the superiorities of the simple structure and the small computational burden 52 mae 1 t f t 0 t 0 t f e t d t mac 1 t f t 0 t 0 t f n l t d t mtv 1 t f t 0 t 0 t f n l t 1 n l t d t actually the formation control algorithm of usvs is executed in the hardware computing model e g the industrial process computer ipc hence the computational burden may have a significant impact on the application of theoretical algorithms for this consideration four evaluation indexes are utilized to valuate the above two schemes i e the computing held memory cm the elapsed time et the occupancy percentage op of cpu and the sampling trigger number tn the comparison results are presented in table 2 as can be seen the proposed scheme is with the lower computational burden and the sampling trigger number thus it can be inferred that the event triggered technique has the superiority of reducing the computational load which meets the nautical engineering requirements 6 conclusions in this note a novel event triggered formation control algorithm has been presented for usvs with the optimized leader follower structure considering the possible singularity problem the kinematic model of the formation is established in the cartesian coordinate frame hence the control system is transformed into a simple form which contributes to settle the issue of the fleet state s continuous acquisition intuitively furthermore a practical event triggered robust neural control algorithm is developed by employing the robust neural damping technique and the input event triggered rule thus the state variables and control parameters can be reset or updated aperiodically at the event triggered instants compared with the existed results the proposed scheme can promote the effective information interaction between the actuator and the controller thereby avoiding unnecessary waste of communication resources finally by fuse of the lyapunov theory all signals in the closed loop system has been proved to be with the sguub stability besides the comparative experiments have illustrated the effectiveness of the scheme under the simulated ocean environment credit authorship contribution statement guoqing zhang methodology software formal analysis writing original draft project administration wei yu conceptualization software validation writing review editing jiqiang li validation formal analysis writing review editing xianku zhang project administration funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is supported by the national natural science foundation of china no 51909018 the science and technology innovation foundation of dalian city no 2019j12gx026 the doctoral scientific research foundation of liaoning province china no 20170520189 the natural science foundation of liaoning province china no 20180520039 and the fundamental research funds for the central universities of china 3132021132 3132020124 the authors would like to thank anonymous reviewers for their valuable comments to improve the quality of this note 
20525,in this note one focuses on the application of the event triggered mechanism into the formation control system of the underactuated surface vehicles usvs to avoid the possible singularity problem a novel fleet control model of the leader follower structure is established in the cartesian coordinate frame the innovation of this design is that the information status between the leader and the follower could be acquired continuously and intuitively furthermore a practical event triggered robust neural control is developed by utilizing the robust neural damping technique and the input event triggered rule when the event triggered threshold is satisfied the state variables and the control input could be reset or updated aperiodically that can effectively reduce the occupancy of the communication network from the controller to the actuator and facilitate its application in the practical engineering in this algorithm only four adaptive updated parameters are required in the adaptive model such design could compensate the gain uncertainties and the environmental disturbances based on the lyapunov theory considerable efforts have been made to illustrate that all signals in the closed loop system are the semi global uniformly ultimately bounded sguub finally numerical simulations are conducted to demonstrate the validity of the proposed scheme keywords underactuated vehicles formation control optimized leader follower structure neural damping technique event triggered inputs 1 introduction the formation control of the underactuated surface vehicles usvs is gradually becoming a meaningful research area in practical engineering due to its diversity and flexibility especially more successful formation applications have been explored in the civilian and military fields e g ocean navigation replenishment chen and wang 2005 environmental monitoring beard et al 2001 resource exploration xiang et al 2018 compared with a variety of formation control methods peng et al 2013 xiao et al 2016 the leader follower based control has become a more preferred approach with the simple configuration and effective implementation while tracking the predetermined path the leader follower based scheme requires to constantly update the feedback status signals and relevant control commands breivik et al 2018 however for the resource limited onboard that is unnecessary and unrealistic owning to the busy information interaction between the controller and the actuator the congestion may occur frequently or cause the failure of the conventional control schemes he et al 2018 therefore for the purpose of efficiency and resource conservation the leader follower formation control scheme with consideration of the event triggered mechanism should attract more attentions and is meaningful in the marine industry under the leader follower based control structure all vehicles are divided into two roles the leader and the follower the leader is converged to a predetermined reference path while forcing the follower to maintain the desired distance and orientation from the leader xiang et al 2017 in the existing literature the corresponding studies on the leader follower structure have been the active area of the formation control research for instance in skjetne et al 2002 for merits of the vectorial backstepping technique an nonlinear formation control is proposed the related formation is viewed as a flexible system that maneuvers along a parameterized path such design makes the geometric task and the dynamic task for the formation of marine craft can be addressed respectively by virtues of the lyapunov based technique and graph theory a cooperative path tracking guidance for the formation control is proposed in ghommam and mnif 2009 this enables the decentralized formation control structure could be achieved during the instantaneous steering however the formation control task is largely constrained to the priori knowledge of the predefined path to address the problem the virtual vehicles are constructed into the formation scheme cui et al 2010 based on the law of the adaptive position tracking the followers could be converged to the reference point only by tracking the dynamic virtual vehicle in the aforementioned literatures the formation controllers are constructed with the model based methods which require obtain the model parameters precisely however in practical applications it is difficult to settle the issue of the model parameters acquisition especially for the hydrodynamic matrix hence it is imperative to employ additional schemes to deal with the related problems for example the cartesian coordinate frame can be applied to optimize the leader follower structure for the kinematic model in li and xiao 2005 a novel cartesian coordinate frame is exploited by virtual of the frame the inherent singularity problem in the polar coordinate representation can be avoided besides the neural networks nns can be employed to compensate for the dynamic uncertainties in shojaei 2015 the radial basis function neural network rbf nn is introduced to solve the trajectory tracking problem of the formation control such design could improve their robustness against the unmodeled dynamics and time varying disturbances however with the application of theoretical algorithms in practice new obstructions e g the explosion of complexity and the curse of dimensionality may occur chen et al 2009 these issues are caused by the repeated differentiations of virtual controls and the large amounts of the updated nns weights hence for merits of the dynamic surface control dsc and robust neural damping techniques a practical robust adaptive formation algorithm is designed lu et al 2018 due to the smaller computational burden the actual control law can be effectively implemented in practice with a concise form furthermore the event triggered mechanism can be introduced into the resource limited formation scheme through the mechanism the performance of the controller is maintained satisfactorily while the over consumption of computing can be greatly reduced szanto et al 2018 in addition to avoid acquiring formation position parameters continuously the event sampled nns can be applied to develop an nonuniform sampled data control system li and yang 2018b thus the related parameters could be transmitted intermittently between the controller and the actuator thus greatly avoiding the occupation of communication resources motivated by the aforementioned observation an event triggered robust neural formation control scheme is proposed for usvs with the optimized leader follower structure different from the traditional studies the corresponding kinematic model is developed in the cartesian coordinate representation furthermore by virtue of the robust neural damping technique and the input event triggered rule a practical event triggered robust neural control algorithm is ultimately constructed the outstanding contributions of this design can be summarized as follows 1 a novel kinematic model for the formation control is designed in the cartesian coordinate representation compared with the similar model in the polar coordinate system it can eliminate the possible singularity problem that may occur as the number of the fleet elements increases moreover based on the designed kinematic model the issue of the fleet state s continuous acquisition can be addressed by the control system in a simple form thus these processes can further optimize the control algorithm and reduce the burden on the computer 2 an event triggered robust neural control algorithm is developed to perform the fleet control task by employing the input event triggered mechanism and the robust neural damping technique the related constraints generated by the nns can be effectively avoided besides the adaptive laws are compressed into four weights to compensate for the actuator s gain uncertainty such parameters can be aperiodically updated only at the event triggered instants hence the triggering process can ultimately reduce the unnecessary information transmission between the actuator and the controller and facilitate its application in practical engineering 2 problem formulation and preliminaries throughout this note indicates the absolute value of the scalar besides and f are expressed as the euclidean norm and the frobenius norm of respectively the estimation error is defined as ˆ and ˆ is the estimated value of for a given matrix a a i j r m n a f 2 t r a t a σ i 1 m σ j 1 n a i j 2 2 1 ship dynamics according to the newtonian and lagrangian mechanics fossen 2011 η i x i y i ψ i t and v i u i v i r i t are defined as the attitude vector and the velocity vector of the i th underactuated surface vehicle usv respectively therefore in a multi vehicle formation system the 3 degree of freedom dof kinematic model of each vehicle could be described as followers 1 x i u i cos ψ i v i sin ψ i y i u i sin ψ i v i cos ψ i ψ i r i 2 u i f u i v t u i m u i n i n i d w u i v i f v i v d w v i r i f r i v f r i m r i δ i d w r i with f u i v m v i m u i v i r i d u 1 i m u i u i d u 2 i m u i u i u i d u 3 i m u i u i 3 f v i v m u i m v i u i r i d v 1 i m v i v i d v 2 i m v i v i v i d v 3 i m v i v i 3 f r i v m u i m v i m r i u i v i d r 1 i m r i r i d r 2 i m r i r i r i d r 3 i m r i r i 3 where η i x i y i ψ i t denote the surge sway displacements and yawing angle of the i th vehicle in the earth fixed coordinate frame v i u i v i r i t represent the surge sway and yaw velocities in the body fixed frame meanwhile m u i m v i m r i are described as the additional mass in the three orientations and d w u i d w v i d w r i indicate the immeasurable forces or moments generated by the marine environment and the system perturbation moreover f u i v f v i v f r i v are expressed as the high order hydrodynamic effects and d l 1 i d l 2 i d l 3 i l u v r are employed to describe the hydrodynamic damping terms n i δ i are the actual control inputs i e the propeller revolution and the actual rudder angle t u i and f r i as the unknown gain function can be expressed as 3 t u i 1 t p ρ w d p 4 k t j p f r i 6 13 v r v r 2 25 a r l 2 x r α h x h u r 2 cos δ i in eq 3 ρ w and d p respectively represent the water density and the propeller diameter k t is the thrust coefficient which is a nonlinear function of the propeller s propulsion coefficient j p besides t p α h as the wake fraction and the attack angle denote the interference effect between the hydrodynamic forces or torques acting on the propeller and the rudder moreover a r l are expressed as the rudder area and the length between perpendiculars v r is the aspect ratio and u r denotes the apparent velocity of the rudder x r and x h are the dimension of the rudder blade and the ship s center of gravity in the x coordinate system furthermore the energy of the actuator is limited in practical engineering hence there are unknown positive constants t u i t u i f r i f r i resulting in 0 t u i t u i t u i 0 f r i f r i f r i assumption 1 in practical engineering the external disturbance terms d w u i d w v i d w r i satisfy d w u i d w u i d w v i d w v i d w r i d w r i where d w u i d w v i d w r i are the unknown positive constants assumption 2 based on the analysis in li et al 2008 as long as the surge and yaw dof are adjusted effectively the usv s sway motion can be achieved passive bounded remark 1 as the external environment is constantly varying with the condition of limited energy the environmental disturbances suffered by the usv have the unknown time varying and bounded signal characteristics thus it can be rendered that assumption 1 is reasonable and meets the practical engineering requirements in addition the sway dynamics passive boundedness for the usv has been systematically illustrated in li et al 2008 since the swing motion of usv is subjected to the hydrodynamic damping forces in the swing direction the conception of the passive bounded swing motion in assumption 2 can be easily satisfied the control objective of this note is to develop a novel event triggered robust neural formation control scheme in the presence of the model uncertainty and the unknown disturbance such that 1 a group of underactuated surface vehicles could closely track the waypoints based reference path in a desired formation configuration 2 all signals in the closed loop system are guaranteed to be semi global uniformly ultimately bounded sguub 2 2 function approximation based on rbf nns in practical engineering neural networks nns are generally applied as an effective tool to address the system uncertainties especially for its good capabilities in approximating unknown functions the radial basis function neural networks rbf nns has been the preferred technique to settle the structure and parameter uncertainties zhang and zhang 2015 xu and sun 2017 hence lemma1 is introduced here to describe the approximate process lemma 1 chen et al 2009 for any given continuous function f x with f 0 0 defined on the compact set ω x through the continuous function separation and rbf nns approximation techniques f x can be ultimately modeled as 4 f x s x a x ε x x ω x where ε x denotes the approximating error with the unknown upper bound ε s x s 1 x s 2 x s n x is the vector of rbf basis functions with the form of gaussian function s i x i 1 2 n 5 s i x 1 2 π ξ i exp x μ i t x μ i 2 ξ i 2 from eq 5 it can be seen that μ i is the center of the receptive field and ξ i indicates the width of the gaussian function a is the optimal weight matrix where m is the dimension number of the state vector x and n denotes the node number of nns 6 a ω 11 ω 12 ω 1 m ω 21 ω 22 ω 2 m ω n 1 ω n 2 ω n m 3 formulation of the robust neural formation control 3 1 leader follower formation set up to display the fleet structure more intuitively the geometric configuration of the leader follower formation is shown in fig 1 there are three key elements in the fundamental group i e one leader vehicle and two followers the leader is in the middle position and the followers are on either side of the leader as a virtual vehicle the leader provides a predetermined attitude reference to the followers while the followers are tracking the leader with the desired distance and orientation jin 2016 in this note p l i λ l i represent the relative distance and angle between the leader and the i th follower similarly the desired distance and angle between the leader and the i th follower are described as p l i d λ l i d referring to fig 1 the basic geometric configuration of the leader follower formation is constructed in the cartesian coordinate frame x l y l ψ l and x i y i ψ i are defined as the position and heading angle of the leader and the i th follower moreover p x l i p y l i are the projects of p l i along the longitudinal and transverse direction relative of the leader besides p x l i d p y l i d are denoted as the desired value of p l i d respectively hence the desired formation can be maintained as 7 p x l i d p l i d sin λ l i d ψ l π 2 p y l i d p l i d cos λ l i d ψ l π 2 define the position error and orientation error between the leader and the i th follower 8 p x l i p y l i ψ e i cos ψ l sin ψ l 0 sin ψ l cos ψ l 0 0 0 1 x l x i y l y i ψ l ψ i taking the derivative of p x l i p y l i ψ e i the formation s relative motion equation can be obtained 9 p x l i p y l i ψ e i 1 0 p y l i 0 1 p x l i 0 0 1 u l v l r l cos ψ e i sin ψ e i 0 sin ψ e i cos ψ e i 0 0 0 1 u i v i r i the distance error in the longitudinal and transverse direction can be defined as x e l i p x l i p x l i d y e l i p y l i p y l i d hence according to eqs 7 8 and 9 the distance error model should be described in the leader s body fixed frame 10 x e l i y e l i ψ e i 1 0 y e l i p y l i d 0 1 x e l i p x l i d 0 0 1 u l v l r l u i cos ψ e i v i sin ψ e i p x l i d u i sin ψ e i v i cos ψ e i p y l i d r i with the specified fleet configuration the control task is to design the bounded tracking algorithms for followers so that 11 lim t x e l i 0 lim t y e l i 0 lim t ψ e i θ θ π 2 π 2 hence in view of the distance errors x e l i y e l i two new coordinate variables z 1 l i z 2 l i can be defined here to perform the coordinate conversion li and xiao 2005 the specific form is expressed as 12 z 1 l i z 2 l i cos ψ e i s i n ψ e i sin ψ e i cos ψ e i x e l i y e l i for merits of the rotation matrix the distance error model can be transformed such design is to facilitate the subsequent description of the distance error model in the follower s coordinate thus the error model related to the two immediate variables can be expressed as 13 z 1 l i z 2 l i 1 z 2 l i 0 z 1 l i u i r i δ 1 i cos ψ e i δ 2 i sin ψ e i δ 1 i sin ψ e i δ 2 i cos ψ e i v i where δ 1 i u l p x l i d p y l i d r l δ 2 i v l p y l i d p x l i d r l remark 2 different from jin 2019 a novel coordinate representation strategy is incorporated for the kinematic model interpreted as follows one adopts the cartesian coordinate representation instead of the commonly used the polar coordinates because there is a singularity problem in the polar coordinate representation moreover two new variables z 1 l i z 2 l i are employed to represent the distances error between the leader and the i th follower thus the formation control system can be transformed into a simple form which contributes to the acquisition of fleet states intuitively 3 2 design of the event triggered mechanism motivated by the detailed illustration of the relative threshold approach in li and yang 2018a an event triggered mechanism with the time varying threshold is introduced here into the formation control scheme hence n l i is defined as the event triggered input which is related to the output signal of the actuator since the threshold mainly depends on the command value of the actuator the related control input signal n l i for the actuator could be designed as 14 n l i t w l i t k l i t t k l i t k 1 l i l u r from eq 14 it can be obtained that the event triggered input signal n l i can be maintained as w l i t k l i during the time t t k l i t k 1 l i where w l i is the intermediate control law and t k l i k z is described as the update time of the actuator furthermore the event triggered error is defined as follows 15 e l i t w l i t n l i t t k 1 l i inf t t k l i e l i t η l i n l i d l i where 0 η l i 1 d l i 0 represent the design parameters according to the above discussion it can be inferred that w l i t n l i t η l i n l i d l i holds for all the time hence the analysis of the event triggered error requires to be conducted for two situation e g n l i t 0 and n l i t 0 for the first situation n l i t 0 it can be obtained that η l i n l i d l i w l i t n l i t η l i n l i d l i similarly η l i n l i d l i w l i t n l i t η l i n l i d l i can be achieved for the second situation n l i t 0 hence the following equation can be developed by combining with the two situation 16 w l i t n l i t λ i t η l i n l i d l i n l i 0 λ i t η l i n l i d l i n l i 0 in eq 16 λ i t 1 1 besides two unknown parameters λ 1 i t λ 2 i t are defined here to substitute λ i t thus the error 16 could be further discussed as 17 w l i t n l i t λ 1 i t η l i n l i λ 2 i t d l i with λ 1 i t λ 2 i t λ i t n l i t 0 λ 1 i t λ 2 i t λ i t n l i t 0 the intermediate value w l i t can be derived 18 w l i t 1 λ 1 i t η l i n l i λ 2 i t d l i furthermore the event triggered input n l i t could ultimately described as follows 19 n l i t w l i t 1 λ 1 i t η l i λ 2 i t d l i 1 λ 1 i t η l i 3 3 control design by virtual of the dynamic surface control dsc and robust neural damping techniques a novel robust adaptive neural formation controller is developed huang et al 2019 li et al 2013 the control design process including two steps e g the kinematic part and the dynamic part are detailed at here step 1 based on eq 13 the error dynamics of the formation control can be derived as follows 20 z 1 l i u i z 2 l i r i δ 1 i cos ψ e i δ 2 i sin ψ e i z 2 l i v i z 1 l i r i δ 1 i sin ψ e i δ 2 i cos ψ e i in order to stabilize the kinematic error dynamics of z 1 l i z 2 l i one can directly choose α u i α ψ e i as the virtual control law of u i ψ e i via the backstepping technique 21 α u i k z 1 l i z 1 l i δ 1 i cos ψ e i δ 2 i sin ψ e i α ψ e i arcsin v i k z 2 l i z 2 l i δ i ξ i where k z 1 l i 0 k z 2 l i 0 are both the design parameters δ i δ 1 i 2 δ 2 i 2 and ξ i arccos δ 1 i δ i arcsin δ 2 i δ i actually v i k z 2 l i z 2 l i δ i can be easily guaranteed in practical engineering if the designed parameters are selected reasonably however the detailed derivations of the virtual signals are complicated and even lead to the increasing complexity of the algorithm to eliminate the constraints and reduce the computational burden the differential of α u i and α ψ e i can be ultimately substituted by employing the dsc technique yang et al 2019 let the virtual signals pass through two first order filters with the time constants τ u i and τ ψ e i 22 τ u i β u i β u i α u i τ ψ e i β ψ e i β ψ e i α ψ e i from eq 20 it can be rendered that the initial values are β u i 0 α u i 0 β ψ e i 0 α ψ e i 0 moreover the errors of the dynamic surface can be described as q u i α u i β u i q ψ e i α ψ e i β ψ e i by defining u e i β u i u i and ψ e i β ψ e i ψ e i one has 23 z 1 l i α u i z 2 l i r i q u i u e i δ 1 i cos ψ e i δ 2 i sin ψ e i k z 1 l i z 1 l i z 2 l i r i q u i u e i z 2 l i v i δ i sin α ψ e i ξ i δ i ψ y i z 1 l i r i k z 2 l i z 2 l i z 1 l i r i δ i ψ y i where ψ y i cos q ψ e i ψ e i 1 sin α ψ e i ξ i sin q ψ e i ψ e i cos α ψ e i ξ i and ψ y i is bounded by ψ y i furthermore based on eqs 21 and 22 q u i q ψ e i can be obtained 24 q u i β u i α u i q u i τ u i α u i z 1 l i z 1 l i α u i ψ e i ψ e i q u i τ u i a u z 1 l i z 1 l i ψ e i ψ e i q ψ e i β ψ e i α ψ e i q ψ e i τ ψ e i α ψ e i z 2 l i z 2 l i α ψ e i v i v i q ψ e i τ ψ e i a ψ e i z 2 l i z 2 l i v i v i since the virtual control β ψ e i is not required in the following design a similar operation is employed here to describe the dynamics ψ e i define α r i and β r i as the virtual control and the filtered signal of r i thus the dynamic surface is described as 25 τ r i β r i β r i α r i β r i 0 α r i 0 then it can be rendered that q r i α r i β r i r e i β r i r i meanwhile the derivative of ψ e i could be deduced 26 ψ e i β ψ e i r l r i β ψ e i r l α r i q r i r e i based on eq 26 the virtual law α r i is described as 27 α r i k ψ e i ψ e i r l β ψ e i besides one can obtain the derivative of q r i 28 q r i β r i α r i q r i τ r i α r i z 2 l i z 2 l i α r i v i v i α r i ψ e i ψ e i q r i τ r i a r i z 2 l i z 2 l i v i v i ψ e i ψ e i where k ψ e i is a designed positive parameter in eqs 24 and 28 a u i a ψ e i and a r i are all the bounded functions moreover there exist the positive constants m u i m ψ e i m r i resulting in a u i m u i a ψ e i m ψ e i and a r i m r i step 2 at this step the derivative of u e i and r e i can be described here by substituting eqs 22 and 25 into eq 2 thus the corresponding error dynamics could be obtained 29 u e i β u i f u i v t u i n i n i m u i d w u i r e i β r i f r i v f r i δ i m r i d w r i according to lemma 1 the system uncertainty f l i v l u r in eq 29 could be approximated by using the rbf nns 30 f l i v s v a l i v ε l i v s v a l i β v s v a l i v e i ε l i v s v a l i β v b l i s v ϖ l i ε l i v where β v β u i 0 β r i t v e i u e i 0 r e i t for the two subsystem u i r i s v is represented as the same basis function of nns besides b l i a l i f a l i m a l i a l i f are defined here it can be rendered that ϖ l i a l i m v e i and b l i ϖ l i a l i v e i hence the robust neural damping term in eq 29 can be described by ζ l i 2 31 ζ l i 2 s ν a l i β ν ε l i d w l i 2 s ν a l i β ν ε l i v d w l i 2 ϑ l i φ l i where ε l i d w l i are denoted as the upper bound of ε l i d w l i besides ϑ l i max a l i f ε l i v d w l i is expressed as the compressed weights and φ l i 1 s ν β ν is the damping term furthermore the error dynamic can be rewritten by substituting the event triggered design 19 into eq 29 32 u e i β u i ζ u i b u i s v ϖ u i 1 m u i t u i w u i t 1 λ 1 i t η u i t u 1 λ 2 i t d u i 1 λ 1 i t η u i r r i β r i ζ r i b r i s v ϖ r i 1 m r i f r i w r i t 1 λ 1 i t η r i f r i λ 2 i t d r i 1 λ 1 i t η r i where t u i 1 λ 1 i t η u i and f r i 1 λ 1 i t η r i are two gain functions in order to facilitate the subsequent design two learning parameters λ t u i λ f r i are introduced here they are defined as λ t u i t u i 1 λ 1 i t η u i 1 and λ f r i f r i 1 λ 1 i t η r i 1 moreover t u i λ 2 i t d u i 1 λ 1 i t η u i f r i λ 2 i t d r i 1 λ 1 i t η r i can be further defined by two new variables φ u i φ r i to stabilize the above effects two adaptive learning parameters ϱ u i ϱ r i are introduced here 33 ϱ u i sup t k u i t t k 1 u i λ 2 i t d u i ϱ r i sup t k r i t t k 1 r i λ 2 i t d r i furthermore the estimated errors are defined as ϱ u i ϱ u i ϱ ˆ u i ϱ r i ϱ r i ϱ ˆ r i where ϱ ˆ u i ϱ ˆ r i are the estimated value of ϱ u i ϱ r i hence the term φ u i φ r i can be further rewritten as 34 φ u i t u i 1 λ 1 i t η u i ϱ ˆ u i t u i 1 λ 1 i t η u i ϱ u i φ r i f r i 1 λ 1 i t η r i ϱ ˆ r i f r i 1 λ 1 i t η r i ϱ r i obviously λ ˆ t u i λ ˆ f r i are the estimated values of λ t u i λ f r i they are updated online to compensate uncertainties of the nonlinear gain functions t u i 1 λ 1 i t η u i and f r i 1 λ 1 i t η r i hence based on eq 19 the actual control variables n i δ i for the propeller revolution and the rudder angle can be derived and α n i α δ i are described as the intermediate control laws for t u i n i n i f r i δ i 35 n i sgn n u i n u i δ i n r i w u i λ ˆ t u i α n i ϱ ˆ u i tanh ϱ ˆ u i u e i ϵ 0 w r i λ ˆ f r i α δ i ϱ ˆ r i tanh ϱ ˆ r i r e i ϵ 0 α n i k n i u e i β u i k u n g u i u e i α δ i k δ i r e i β r i k r n g r i r e i where g u i 1 4 φ u i 2 s v t s v g r i 1 4 φ r i 2 s v t s v ϵ 0 is a small positive value k n i k δ i are the positive controller parameters k u n k r n are the robust neural damping parameters moreover according to the above consideration the corresponding adaptive laws can be designed as follows and the detailed synthesis analysis will be illustrated in section 4 zhang et al 2020 36 λ ˆ t u i γ t u i α n i u e i σ t u i λ ˆ t u i λ ˆ t u i 0 λ ˆ f r i γ f r i α δ i r e i σ f r i λ ˆ f r i λ ˆ f r i 0 ϱ ˆ u i γ ϱ u i u e i σ ϱ u i ϱ ˆ u i ϱ ˆ u i 0 ϱ ˆ r i γ ϱ r i r e i σ ϱ r i ϱ ˆ r i ϱ ˆ r i 0 in eq 36 λ ˆ t u i λ ˆ f r i are utilized to deal with the gain uncertainty and ϱ u i ϱ r i are responsible for compensating the actuator s fault γ t u i γ f r i γ ϱ u i γ ϱ r i σ t u i σ f r i σ ϱ u i σ ϱ r i are all positive parameters besides λ ˆ t u i 0 λ ˆ f r i 0 ϱ ˆ u i 0 ϱ ˆ r i 0 are the initial values of the corresponding variables 4 stability analysis in this section the stability analysis of the closed loop scheme is performed on all signals the consequences can be summarized as theorem 1 theorem 1 consider the closed loop scheme consisting of usvs with the error dynamic system 2 and 10 satisfying assumptions 1 2 the virtual control laws 21 and 27 the event triggered robust neural control 35 and the adaptive updating parameter 36 for all initial conditions satisfying z 1 l i 2 0 z 2 l i 2 0 ψ e i 2 0 q u i 2 0 q r i 2 0 q ψ e i 2 0 u e i 2 0 r e i 2 0 λ t u i 2 0 λ f r i 2 0 ϱ u i 2 0 ϱ r i 2 0 2 δ with any δ 0 hence the design parameters k z 1 l i k z 2 l i k ψ e i k n i k δ i k u n k r n k n u i k n r i γ t u i γ f r i γ ϱ u i γ ϱ r i σ t u i σ f r i σ ϱ u i σ ϱ r i can be turned appropriately such that all the immediate state variables are semi global uniformly ultimately bounded sguub proof according to the design process of the proposed control scheme the lyapunov function candidate can be described as 37 v 1 2 i 1 n z 1 l i 2 z 2 l i 2 ψ e i 2 q u i 2 q r i 2 q ψ e i 2 u e i 2 r e i 2 1 2 i 1 n t u i m u i 1 λ 1 i η u i λ t u i 2 γ t u i ϱ u i 2 γ ϱ u i f r i m r i 1 λ 1 i η r i λ f r i 2 γ f r i ϱ r i 2 γ ϱ r i hence one can have the derivative of v 38 v i 1 n z 1 l i z 1 l i z 2 l i z 2 l i ψ e i ψ e i q u i q u i q r i q r i q ψ e i q ψ e i u e i u e i r e i r e i i 1 n t u i m u i 1 λ 1 i η u i λ t u i λ ˆ t u i γ t u i ϱ u i ϱ ˆ u i γ ϱ u i f r i m r i 1 λ 1 i η r i λ f r i λ ˆ f r i γ f r i ϱ r i ϱ ˆ r i γ ϱ r i along 23 24 26 28 and 32 v can be rewritten 39 v i 1 n k z 1 l i z 1 l i q u i u e i z 1 l i k z 2 l i z 2 l i δ i ψ y i z 2 l i k ψ e i ψ e i q r i r e i ψ e i q u i q u i q r i q r i q ψ e i q ψ e i i 1 n u e i β u i ζ u i b u i s v ϖ u i φ u i m u i t u i m u i 1 λ 1 i t η u i λ t u i λ t u i α n i ϱ ˆ u i tanh ϱ ˆ u i u e i ϵ 0 i 1 n r e i β r i ζ r i b r i s v ϖ r i φ r i m r i f r i m r i 1 λ 1 i t η r i λ f r i λ f r i α δ i ϱ ˆ r i tanh ϱ ˆ r i r e i ϵ 0 i 1 n t u i m u i 1 λ 1 i η u i λ t u i λ ˆ t u i γ t u i ϱ u i ϱ ˆ u i γ ϱ u i i 1 n f r i m r i 1 λ 1 i η r i λ f r i λ ˆ f r i γ f r i ϱ r i ϱ ˆ r i γ ϱ r i in order to simplify the further calculation the following equations can be ultimately obtained via the young s inequality 40 q l i q l i q l i 2 τ l i q l i α l i 1 τ l i m l i 2 2 c q l i 2 c 2 41 ϖ l i t ϖ l i a i m v e 2 ω i 1 t ω i 1 ω i 2 t ω i 2 ω i l t ω i l a i f 2 v e t v e u e 2 r e 2 42 ζ l i l e i b l i s v ϖ l i l e i 1 4 k l n φ i 2 s v t s v l e i 2 ϑ l i 2 k l n b l i 2 ϖ l i t ϖ l i k l n k l n g l i l e i 2 ϑ l i 2 k l n b l i 2 k l n u e i 2 r e i 2 43 λ t u i λ ˆ t u i λ ˆ t u i 0 1 2 λ t u i 2 1 2 λ t u i λ ˆ t u i 0 2 λ f r i λ ˆ f r i λ ˆ f r i 0 1 2 λ f r i 2 1 2 λ f r i λ ˆ f r i 0 2 44 ϱ ˆ u i u e i ϱ ˆ u i u e i tanh ϱ ˆ u i u e i ϵ 1 0 2785 ϵ 1 ϱ ˆ r i r e i ϱ ˆ r i r e i tanh ϱ ˆ r i r e i ϵ 2 0 2785 ϵ 2 45 l e i β l i 1 m l i l e i β l i 1 1 m l i τ l i l e i 2 1 1 m l i 4 τ l i q i 2 substituting the actual control law 35 adaptive law 36 and eq 40 eq 45 into eq 39 the derivative value v can be ultimately rewritten as 46 v i 1 n k z 1 l i 1 2 z 1 l i 2 k z 2 l i δ i 2 4 z 2 l i 2 k ψ e i 1 2 ψ e i 2 1 τ ψ e i m ψ e i 2 2 c q ψ e i 2 3 c 2 ψ y i 2 1 τ u i m u i 2 2 c 1 1 m u i 4 τ u i 1 q u i 2 1 τ r i m r i 2 2 c 1 1 m r i 4 τ r i 1 q r i 2 i 1 n k n i m u i 1 1 m u i τ u i b u i 2 b r i 2 m u i k u n 1 u e i 2 i 1 n k δ i m r i 1 1 m r i τ r i b u i 2 b r i 2 m r i k r n 1 r e i 2 i 1 n t u i m u i 1 λ 1 i η u i σ t u i λ t u i 2 2 σ ϱ u i ϱ u i 2 2 f r i m r i 1 λ 1 i η r i σ f r i λ f r i 2 2 σ ϱ r i ϱ r i 2 2 i 1 n t u i m u i 1 λ 1 i η u i σ t u i 2 λ t u i λ ˆ t u i 0 2 σ ϱ u i 2 ϱ u i ϱ ˆ u i 0 2 0 2785 ϵ 1 f r i m r i 1 λ 1 i η r i σ f r i 2 λ f r i λ ˆ f r i 0 2 σ ϱ r i 2 ϱ r i ϱ ˆ r i 0 2 0 2785 ϵ 2 ϑ u i 2 k u n ϑ r i 2 k r n in eq 46 c 0 ϵ 1 ϵ 2 k u n and k r n are all the positive constants ψ y i 2 is the bounded value which satisfy ψ y i 2 4 to obtain the favorable performance all design parameters should be selected appropriately such that the following conditions hold 47 1 τ u i m u i 3 m u i 1 2 m u i 2 c 4 1 τ r i m r i 3 m r i 1 2 m r i 2 c 4 1 τ ψ e i m ψ e i 2 2 c k z 1 l i 1 2 k z 2 l i δ i 2 4 k n i m u i 1 τ u i b u i 2 b r i 2 k u n m u i k δ i m r i 1 τ r i b u i 2 b r i 2 k r n m r i k ψ e i 1 2 therefore the derivative value v can be rewritten as 48 v 2 a 0 v ρ 0 where a 0 i 1 n a i ρ 0 i 1 n ρ i and a i ρ i are both positive constants satisfying 49 a 1 min k z 1 l i 1 2 k z 2 l i δ i 2 4 k ψ e i 1 2 1 τ ψ e i m ψ e i 2 2 c 1 τ u i m u i 2 2 c 1 1 m u i 4 τ u i 1 1 τ r i m r i 2 2 c 1 1 m r i 4 τ r i 1 k n i m u i 1 1 m u i τ u i b u i 2 b r i 2 m u i k u n 1 k δ i m r i 1 1 m r i τ r i b u i 2 b r i 2 m r i k r n 1 a i min a 1 σ t u i 2 σ f r i 2 σ ϱ u i 2 σ ϱ r i 2 ρ i t u i m u i 1 λ 1 i η u i σ t u i 2 λ t u i λ ˆ t u i 0 2 σ ϱ u i 2 ϱ u i ϱ ˆ u i 0 2 0 2785 ϵ 1 f r i m r i 1 λ 1 i η r i σ f r i 2 λ f r i λ ˆ f r i 0 2 σ ϱ r i 2 ϱ r i ϱ ˆ r i 0 2 0 2785 ϵ 2 ϑ u i 2 k u n ϑ r i 2 k r n ψ y i 2 3 c 2 by integrating eq 48 the equation with v can be obtained 50 v t ρ 0 2 a 0 v 0 ρ 0 2 a 0 exp 2 a 0 t obviously it is rendered that lim t v t ρ 0 2 a 0 and the bounded variable ρ 0 can be small enough by turning the design parameters appropriately besides the boundedness of v also indicates that z 1 l i z 2 l i ψ e i q u i q r i q ψ e i u e i r e i λ t u i ϱ u i λ f r i ϱ r i are all bounded combined with assumption 1 the proposed formation configuration can be guaranteed and the boundedness of α n i α δ i α u i α ψ e i α r i can be referred from 20 26 and 34 hence all signals in the closed loop formation system are sguub the proof is completed 5 numerical experiments in this section numerical experiments have been carried out to illustrate the effectiveness of the proposed formation control scheme for this purposed a set of three usvs including one leader and two followers is employed to describe the basic formation configuration the control plant is quoted from a classic vehicle cybership ii length of l 1 255 m breadth of 0 29 m mass of 23 8 kg whose modeling process has been detailed in skjetne et al 2005 besides by implementing the scale model test in the basin the related model parameters can be ultimately established it is worth noting that the closed loop performance experiment at section 5 1 is presented in fields of the simulated ocean environment while the comparative experiment at section 5 2 is performed between the proposed event triggered control algorithm and the results in lu et al 2018 thus the related principle and the external interference are referred by the literature lu et al 2018 5 1 experiment under the simulated ocean environment in this subsection the superiorities of the proposed formation control algorithm are illustrated by fusing the experiments with the simulated ocean environment the geometric configuration of the formation scheme is formed by three usvs leader follower 1 and follower 2 furthermore the following waypoints are utilized to provide the formation reference w 1 0 m 8 m w 2 21 m 8 m w 3 34 m 35 m w 4 53 m 41 m the leader is in the middle position and the two followers are in the blind zone on both side of the leader therefore a triangular formation structure is constructed to further verify the formation performance of the proposed scheme meanwhile the leader is a virtual vehicle which provides the corresponding attitude reference to the followers the initial values of the leader are set as η l 0 0 m 8 m 0 rad t and v l 0 0 5 m s 0 m s 0 rad s t while the related states of follower1 and follower2 are shown as η 1 0 2 m 5 m π 4 rad t η 2 0 2 m 11 m π 4 rad t and v 1 0 v 2 0 0 m s 0 m s 0 rad s t in addition the both followers are all with the identical nonlinear function f u i f v i that can be approximated by the rbf nns which contains eight neuron nodes with the width h i 2 i 1 2 8 then the centers spaced of u i v i r i can be expressed as 10 m s 10 m s 10 m s 10 m s 2 5 rad s 2 5 rad s moreover the design control parameters for the proposed algorithm can be described where l u r 51 p l 1 d p l 2 d 4 0 λ l 1 d λ l 2 d 3 π 4 k z 1 l 1 1 0 k z 2 l 1 2 0 k z 1 l 2 5 0 k z 2 l 2 8 0 k ψ e 1 k ψ e 2 2 5 k n 1 k n 2 0 5 k δ 1 k δ 2 0 1 k u n k r n 0 3 γ t u 1 γ t u 2 γ f r 1 γ f r 2 0 02 τ u 1 τ u 2 0 1 τ r 1 τ r 2 τ ψ e 1 τ ψ e 2 0 05 σ t u 1 σ t u 2 0 16 σ f r 1 σ f r 2 0 35 γ ϱ l 1 γ ϱ l 2 0 116 σ ϱ l 1 σ ϱ l 2 0 14 to simulate the external marine disturbance the physical based mathematical models fossen 2011 are introduced here the real sea state of the environment including the sea wind and the irregular wind generated waves can be generated by the norsok wind spectrum and the jonswap wave spectrums the 4 level sea state is simulated the wind direction is ψ wind 200 deg and the average wind velocity is v wind 15 7 m s fig 2 illustrates the corresponding graphs of the wind field and wind generated waves that can be used to describe the forces torques generated by the amplitude of the sea state for the given fleet configuration the experiment results of the formation can be illustrated in figs 3 7 with the simulated ocean environment in fig 3 the pink dotted line represents the trajectory of the leader while the followers track the leader s trajectory according to the desired distance and angle as can be seen the triangle formation geometry of the three usvs is guaranteed which means that an effective formation configuration can be achieved by setting the desired distance and angle between the leader and the i th follower hence as long as the leader and the i th follower maintain different desired angles and distances the different formation configurations can be ultimately realized in the proposed algorithm fig 4 illustrates the distance errors and heading errors between the followers and the reference paths respectively under the conditions of the uncertain dynamic and ocean disturbance the distance errors both converge to a small neighborhood of the origin meanwhile despite the maneuverability of the fleet the heading error of the two followers can also remain bounded that are consistent with theorem 1 in fig 5 the control orders and the actual inputs of the two followers are described it can be conclude that the control orders and the actual inputs are within an reasonable range note the event triggered proposed scheme is with the larger and more frequent control orders though that can satisfies the physical constraints i e δ r i 0 deg 30 deg therefore according to the event triggered control inputs the actual inputs n i δ r i could eventually converge to the vicinity of the origin furthermore fig 6 shows the corresponding inter event time between two adjacent event triggered instants it can be seen that the minimum inter event time is 0 05 s and the mean interval is 0 2 s the existence of the inter event time can prove that the undesirable zeno behavior is excluded and the network transmission load from the controller to the actuator can be effectively reduced fig 7 presents the corresponding adaptive parameters for each follower which are utilized compensate the effect of the actuator s gain uncertainties it can be seen that the updating online parameters are quickly ensure a reasonable range within 20 s 5 2 comparative experiments in this subsection the event triggered control scheme and the existing results in lu et al 2018 are selected as the comparative experiment to illustrate the robustness and the effectiveness of the proposed scheme the related principle and the external interference are referred by the literature lu et al 2018 in addition the initial values and the corresponding reference trajectories are all with the identical parameters in section 5 1 the comparative results are presented in figs 8 10 in fig 8 the comparison of the formation trajectory is described by the different control schemes obviously the performance of the proposed algorithm is better than those based on the algorithm in lu et al 2018 especially in the process of the maneuvering turns fig 9 illustrates the distance errors and the heading errors in the both algorithm for follower 1 it can be seen that the corresponding errors both converge to the reasonable range of the origin for the guiding law in lu et al 2018 although the bounded problem is solved the fluctuation range of the errors are larger than those based on the proposed control algorithm fig 10 presents the comparison of the control inputs for follower 1 since the event triggered mechanism is introduced into the proposed algorithm the control inputs are required to be updated only at the event triggered instants it is can be found that the control inputs of the proposed control algorithm are significantly smaller than those of result in lu et al 2018 namely the proposed algorithm can effectively reduce the computational load and increase the response efficiency since the update does not need to be performed in every available time for further qualitative analysis three common performance indexes are introduced into the comparative evaluation e g the mean absolute error mae the mean absolute control effort mac and the mean total variation mtv of the control zhang and zhang 2013 they are respectively described as the stabilizing performance of the system the energy consumption and the smoothness properties of the controller the detailed quantitative valuation are summarized as table 1 it can be observed that the item value n 1 underlined marked in the mac is a bit larger than that under the algorithm in lu et al 2018 however on the whole the values of the proposed schemes are less than the corresponding values in lu et al 2018 hence through the quantitative comparison it can be proved that the proposed algorithm is with the superiorities of the simple structure and the small computational burden 52 mae 1 t f t 0 t 0 t f e t d t mac 1 t f t 0 t 0 t f n l t d t mtv 1 t f t 0 t 0 t f n l t 1 n l t d t actually the formation control algorithm of usvs is executed in the hardware computing model e g the industrial process computer ipc hence the computational burden may have a significant impact on the application of theoretical algorithms for this consideration four evaluation indexes are utilized to valuate the above two schemes i e the computing held memory cm the elapsed time et the occupancy percentage op of cpu and the sampling trigger number tn the comparison results are presented in table 2 as can be seen the proposed scheme is with the lower computational burden and the sampling trigger number thus it can be inferred that the event triggered technique has the superiority of reducing the computational load which meets the nautical engineering requirements 6 conclusions in this note a novel event triggered formation control algorithm has been presented for usvs with the optimized leader follower structure considering the possible singularity problem the kinematic model of the formation is established in the cartesian coordinate frame hence the control system is transformed into a simple form which contributes to settle the issue of the fleet state s continuous acquisition intuitively furthermore a practical event triggered robust neural control algorithm is developed by employing the robust neural damping technique and the input event triggered rule thus the state variables and control parameters can be reset or updated aperiodically at the event triggered instants compared with the existed results the proposed scheme can promote the effective information interaction between the actuator and the controller thereby avoiding unnecessary waste of communication resources finally by fuse of the lyapunov theory all signals in the closed loop system has been proved to be with the sguub stability besides the comparative experiments have illustrated the effectiveness of the scheme under the simulated ocean environment credit authorship contribution statement guoqing zhang methodology software formal analysis writing original draft project administration wei yu conceptualization software validation writing review editing jiqiang li validation formal analysis writing review editing xianku zhang project administration funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is supported by the national natural science foundation of china no 51909018 the science and technology innovation foundation of dalian city no 2019j12gx026 the doctoral scientific research foundation of liaoning province china no 20170520189 the natural science foundation of liaoning province china no 20180520039 and the fundamental research funds for the central universities of china 3132021132 3132020124 the authors would like to thank anonymous reviewers for their valuable comments to improve the quality of this note 
20526,improving the operational energy efficiency of existing ships is attracting considerable interests to reduce the environmental footprint due to air emissions as the shipping industry is entering into shipping 4 0 with digitalization as a disruptive force an intriguing area in the field of ship s operational energy efficiency is big data analytics this paper proposes a big data analytics framework for ship performance monitoring under localized operational conditions with the help of appropriate data analytics together with domain knowledge the proposed framework is showcased through a data set obtained from a bulk carrier pertaining the detection of data anomalies the investigation of the ship s localized operational conditions the identification of the relative correlations among parameters and the quantification of the ship s performance in each of the respective conditions the novelty of this study is to provide a kpi i e key performance indicator for ship performance quantification in order to identify the best performance trim draft mode under the engine modes of the case study ship the proposed framework has the features to serve as an operational energy efficiency measure to provide data quality evaluation and decision support for ship performance monitoring that is of value for both ship operators and decision makers keywords big data analytics machine learning ship performance monitoring energy efficiency emission control data anomaly detection 1 introduction international shipping is an indispensable sector for the facilitation of global economy since it is responsible for about 80 of the total volume of global trade unctad 2019 furthermore seaborne transportation is recognized as the most energy efficient mode of cargo transport as regards energy use per unit transported nonetheless considering its scale and current growth rate the shipping industry is a major catalyst for global ecological change balcombe et al 2019 according to the fourth greenhouse gas ghg study published by the international maritime organization imo global anthropogenic emissions from shipping increased by approximately 10 from 2012 to 2018 imo 2020 it is envisaged that shipping emissions will rise between 90 and 130 by 2050 relative to 2008 for long term economic and energy scenarios therefore shipping co2 emissions are increasing by way of illustration if the maritime sector had been treated as a country it would have been the sixth largest co2 emitter in 2015 olivier et al 2016 such environmental concerns have been acknowledged in a number of regulatory frameworks established by the imo ghg emissions from shipping are addressed by energy efficiency measures under annex vi of the international convention for the prevention of pollution from ships marpol in response to the paris agreement the imo set out an initial imo strategy on reducing ghg emissions from ships aiming at reducing the total annual ghg emissions by at least 50 by 2050 compared to 2008 levels these increasingly stringent regulations have exerted pressure on the shipping industry to pursue possible avenues of reducing its environmental footprint perera et al 2021 in order to achieve this finding alternative fuel sources has been paid much attention in the industry the search for the right future fuel is challenging since it is a multi faceted problem where the evaluation of a pallet of different alternative options is influenced by multiple criteria such as technical economic environmental and social criteria bui and perera 2019 bui et al 2020 in addition to fuel changes it is an orthodox norm that reducing fuel consumption or improving energy efficiency is an effective solution to reduce ship emissions due to the fact that ghg emissions from internal combustion engines are directly related to ship fuel consumption energy efficiency improvement solutions are generally divided into technical and operational measures the former refers to improvements made throughout the ship design phase such as hull form optimization air lubricant propulsion efficiency devices waste heat recovery technology brynolf et al 2016 the latter refers to measures including optimal handling of ships e g trim and ballast optimization voyage optimization e g weather routing slow steaming just in time arrival and good maintenance practices for engine hull and propeller ölçer 2018 it has been observed from the literature that there is still a large potential for increasing energy efficiency from operational practices thereby reducing co2 emissions for example voyage optimization has the potential effect on co2 emissions reduction at the figure of up to 48 bouman et al 2017 nonetheless technical support systems ship performance monitoring systems are required to facilitate this practice imo 2014 viktorelius and lundh 2019 it is a widely held view that the shipping industry is on its way to the fourth industrial revolution as known as shipping 4 0 rødseth et al 2016 the transformational role of digitalization and the rise of artificial intelligence ai together with machine learning ml will exert tremendous impacts on all of the aspects of the industry internet of things iot with the utilization of sensor technologies as well as data acquisition systems can produce a massive amount of sensor data referred to as big data which can be used for analysis and further insights on ship performance monitoring therefore proper techniques are required to leverage big data to support increased energy efficiency during ship operation zaman et al 2017 sullivan et al 2020 in this respect big data analytics have emerged as a disruptive technology that can be an operational energy efficiency measure under the ship performance monitoring systems the last few years have witnessed a considerable growth in the number of data driven studies on improving ship energy efficiency despite this interest scant studies have applied big data analytics approach in addition several studies have failed to demonstrate significant advantages of domain knowledge in every step of data analysis workflow the term domain knowledge means the domain specific expertise of the field and it plays an important role in each step of a data analysis project ranging from problem formulation data collection data pre processing modeling to result interpretation therefore the accuracy of data driven models based on ml can be increased if domain knowledge is incorporated into such models furthermore concerns have arisen which call into question the quality of ship performance and navigation data this problem is related to data veracity which is one of the characteristics of big data as known as the four v s of big data including volume velocity variety and veracity perera and mo 2017 zaman et al 2017 it should also be noted that knowledge and awareness of ship operators have been recognized as one of the energy efficiency gaps from the operational side kitada and ölçer 2015 rasmussen et al 2018 given the above mentioned background this paper aims to develop an advanced data analytics framework for ship performance monitoring under localized operational conditions where domain knowledge is taken into account the proposed framework will be able to serve as an operational energy efficiency measure to provide data quality evaluation and decision support for ship performance monitoring under the digitalization of the maritime industry the structure of this paper is organized as follow section 2 reviews the literature on ship s operational energy efficiency and data anomaly detection the proposed methodology is described in section 3 results of the proposed methodology are reported in section 5 the conclusions are drawn in section 6 2 literature review 2 1 ship s operational energy efficiency on the question of improving operational energy efficiency more attention in the literature has been given to the prediction of ship fuel consumption or engine power in this regard statistical models were deployed in several studies erto et al 2015 sasa et al 2015 however these parametric methods may have bias problems due to their assumptions on data distributions additionally they have failed to cope with complicated and non linear data yan et al 2020 soner et al 2018 therefore ml models have been widely developed to overcome these problems in this context a number of studies implemented ml models such as artificial neural networks anns petersen et al 2012a b bal beşikçi et al 2016 farag and ölçer 2020 karagiannidis and themelis 2021 regression models brandsæter and vanem 2018 yan et al 2020 wang et al 2018 and ensemble models soner et al 2018 gkerekos et al 2019 engine speed optimization and trim optimization have also been gained attention in the literature in terms of improving operational energy efficiency in this respect there has been considerable interest in using big data analytics approach wang et al 2017 made an attempt to achieve ship energy efficiency through a big data analysis based on hadoop platform architecture in this study route division with regard to environmental factors was examined and speed optimization in different navigational segments of a route was investigated yan et al 2018 proposed a big data analytics platform to analyze environmental factors for the purpose of optimizing engine speed for inland ships this study applied the distributed parallel k means clustering algorithm to obtain an elaborate route division and then find the optimal engine speed for the selected inland ship coraddu et al 2017 employed a data analytics approach for fuel consumption prediction and trim optimization of a tanker in this study two gray box models were proposed as predictive models for the prediction of the fuel consumption based on these models a trim optimization method of the tanker was developed lee et al 2018 utilized weather archive big data to estimate the fuel consumption function for speed optimization in maritime logistics in this study they developed a decision support systems for minimizing fuel consumption while maintaining service level agreement by applying an optimization method called particle swarm optimization it is probable that these ml based studies have become the means to provide better prediction and decision support towards energy efficiency nonetheless several studies have not treated domain knowledge in much detail in this regard man et al 2020 proposed an ethnographic method to identify operational challenges on using fuel monitoring systems one of these challenges is the lack of effective analytical approaches for ship performance evaluation this leads to a need for utilizing big data analytics in order to gain understanding of actual fuel consumption to achieve energy efficiency it has also been observed that many studies hold the view that ship speed is the major determinant for ship fuel consumption nonetheless other factors including among others displacement trim draft conditions loading conditions environmental conditions and navigation conditions also have impacts on ship fuel consumption tran 2020 yuan et al 2017 soner et al 2019 it should be noted that these factors may pose a high dimensional challenge for data visualization as pointed out by perera and mo 2020 2 2 data anomaly detection it is a self evident fact that data collected from real world sources are often impure the so called garbage in garbage out gigo refers to the fact that poor quality data input is associated with untrustworthy output pyle 1999 this leads to the needs for methods that can be used for preparing quality data i e data preprocessing as a fundamental step during data analysis workflow zhang et al 2003 nevertheless data quality awareness has yet to be reached its maturity in the maritime industry and a call for the industry to value and improve data quality in addition it is worth bearing in mind that the practicality of data quality cannot be done without considering domain knowledge in the literature several taxonomies for data anomaly detection have been developed such as fault diagnosis fault detection and fault tolerant control such taxonomies can be treated under decision support systems and condition monitoring aiming at enhancing reliability safety and energy efficiency of ship systems different approaches for the detection of possible faults in decision support systems of a container ship were proposed i e the deployment of residuals and the generalized likelihood ratio glr algorithm lajic and nielsen 2010 the deployment of volterra theory lajic et al 2009 and the deployment of a frequency domain based model nielsen et al 2012 raptodimos and lazakis 2018 proposed a method based on the integration of anns and self organising maps som along with inter clustering for data clustering and fault diagnosis of measurement data of physical parameters of a ship main engine cylinder vanem and brandsæter 2019 deployed unsupervised learning techniques for data anomaly detection for sensor based condition monitoring for a marine diesel engine capezza et al 2019 developed a model based on the combination of partial least squares pls regression and prediction error control charts for monitoring of fuel consumption and diagnosis of faults lazakis et al 2019 investigated the utilization of support vector machine svm for the detection of deviant and abnormal ship machinery conditions dalheim and steen 2020 developed a data preparation toolbox for time series data in order to improve the quality of ship operation and performance analysis cheliotis et al 2020 proposed a method based on expected behavior eb models in combination with exponentially weighted moving average ewma control charts for early faults detection in the main engine of a ship karagiannidis and themelis 2021 demonstrated that their proposed algorithms for replacing and cleaning data were be able to increase the accuracy of their produced ann models 2 3 research contribution the research studies reviewed in the previous section point to the following research drawbacks first the use of anns have been observed in several studies albeit its shortcomings the most fundamental shortcoming of this approach has been clearly recognized as a black box approach and it is challenging to interpret behavior of the network second the contribution of domain knowledge has received little attention within the context of maritime applications third most of the studies reviewed have not been able to take into account correlations between factors contributing to ship fuel consumption in a high dimensional data space fourth data quality for ship operation and performance is still a neglected area in the maritime domain and few researchers have addressed this issue in the literature in order to overcome aforementioned drawbacks this study proposes an advanced data analytics framework for ship performance monitoring the novelty of this study is to utilize the proposed framework in order to quantify the performance of a selected ship in the context of its localized operational conditions i e engine and trim draft modes as the novel contributions of this study the proposed framework is be able to i detect and isolate data anomalies existing in a given data set ii investigate the ship s localized operational conditions iv deal with numerous factors that have influences on the ship s performance in a high dimensional data space and iii to provide a kpi i e ship performance indicator for ship performance quantification 3 method the proposed framework presented in this paper has been built upon a preliminary work as described in bui and perera 2020 fig 1 illustrates the overall architecture of the proposed framework with key aspects that can be listed as follows domain knowledge descriptive analytics diagnostic analytics visual analytics and prescriptive analytics domain knowledge is embedded in every step of the proposed framework it refers to an understanding of the ship s localized operational conditions i e engine and trim draft modes the reasoning behind conclusions in each data analytics it also refers to the knowledge obtained from interactions with experts in the field of maritime transport e g ship owners ship operators engine manufacturers descriptive analytics this attempts to answer the question of what happened it provides an understanding of what happened to the system from this perspective two anomaly detectors are proposed to detect and isolate data anomalies furthermore digital modeling is proposed for the investigation of certain patterns of the ship s operational conditions through data clustering diagnostic analytics this attempts to answer the question of why did it happen it reflects an understanding of why something happened to the system from this perspective the causes of data anomalies are identified visual analytics this visualizes the improved data in order to identify the relative relationships or correlations among ship performance and navigation parameters under each of the localized operational conditions prescriptive analytics this attempts to answer the question of what do we do from this perspective a selected kpi i e key performance indicator for ship performance quantification is provided 3 1 descriptive analytics 3 1 1 digital modeling what follows is an account of digital modeling which aims to provide insights into data properties with respect to the ship s localized operational conditions for this reason a digital model is formulated to gain a better understating of discrete data distributions in a high dimensional space fig 2 depicts the digital model which is an extended version of perera and mo 2020 the digital model is represented in the right handed coordinate system of three parameters i e x 1 x 2 x 3 of a selected data set it is assumed in the digital model that there is an existence of several data clusters i e a b c which represent engine localized operational conditions these data clusters are represented by vectors with their respective mean values i e μ 1 μ 2 μ 3 moreover each of the data clusters contains several structural vectors in the form of singular vectors svs for example svs of cluster i i a b c are denoted as z i 1 z i 2 z i 3 furthermore fig 2 also pinpoints some arrows between the data clusters in the digital model a probable explanation is that there are certain transient regions representing the transition modes from an operational condition to another it is necessary to be borne in mind that data outliers and data anomaly clusters can also be represented under the digital model this is attributed to the data veracity that should be properly addressed it is also of interest to further investigate other operational conditions i e trim and draft conditions within the respective data clusters in this respect the projection of the data cluster a onto another high dimensional space is shown in the window on the right handed side of fig 2 where sub data clusters with respect to trim and draft condition i e a 1 a 2 a 3 can be explored a more detailed account of the ship s localized operational conditions can be observed in fig 3 in this regard there are hierarchical relationships between engine operational conditions and trim draft operational conditions it can be assumed that there are several engine modes e g engine mode a b c etc such engine modes can be demonstrated by cluster a b c etc several trim draft modes can be further explored under each of these engine modes for example trim draft modes a 1 a 2 a 3 etc can be found under engine mode a these trim draft modes can be demonstrated by sub clusters e g sub cluster a 1 a 2 a 3 etc 3 1 2 kernel density estimation kde the investigation on the properties of the data can be done by kde a non parametric density estimation method which yields a smooth representation of the underlying probability density function of the data supposing a data set of observations x x 1 x 2 x 3 x n with n samples are being drawn from an unknown probability density p x we wish to estimate the shape of p x the kernel density estimation at x is defined as follows bishop 2006 1 p ˆ x 1 n h i 1 n ϕ x x i h where ϕ is a kernel function which specifies the shape of the distribution placed at each point h is a smoothing parameter called the bandwidth which controls the size of the kernel at each point the choice for ϕ in this study is the gaussian kernel 3 1 3 gaussian mixture models gmms the following is a brief description of an unsupervised learning technique for data clustering the technique is based on probability density estimation using gmms and the expectation maximization em algorithm for distributing data into different clusters the gaussian distribution of a d dimensional vector x is defined as bishop 2006 2 n x μ σ 1 2 π d 2 σ e x p 1 2 x μ t σ 1 x μ where μ is a mean vector and σ is a covariance matrix the probability given in a mixture of k gaussians is defined as 3 p x k 1 k π k n x μ k σ k where each gaussian density n x μ k σ k is called a component of the mixture with its mean vector μ k and covariance σ k for the k t h gaussian component π k is the prior probability of the k t h gaussian π k is also defined as the mixing coefficients with the constraint that k 1 k π k 1 em algorithm for gaussian mixtures fitting a mixture of gaussians to data can be done by using the maximum likelihood and the em algorithm from eq 3 the log of the likelihood function is expressed as 4 l n p x π μ σ n 1 n l n k 1 k π k n x n μ k σ k given a gaussian mixture model the em algorithm is a powerful technique for maximizing this likelihood function with respect to the parameters i e the means μ k the covariances of the components σ k and the mixing coefficients π k step 1 initialize μ k σ k π k and evaluate the initial value of the log likelihood step 2 expectation step use the current values for parameters to evaluate the posterior probabilities or the responsibilities γ z n k which is taken by component k for explaining the observation of data point x n 5 γ z n k π k n x n μ k σ k j 1 k π j n x n μ j σ j step 3 maximization step re estimate the parameters using the current responsibilities 6 μ k n e w 1 n k n 1 n γ z n k x n 7 γ k n e w 1 n k n 1 n γ z n k x n μ k n e w x n μ k n e w t 8 π k n e w n k n where 9 n k n 1 n γ z n k n k can be interpreted as the effective number of points assigned to cluster k step 4 evaluate the log likelihood 10 l n p x π μ σ n 1 n l n k 1 k π k n x n μ k σ k and check for convergence of either the parameters or the log likelihood if the convergence criterion is not satisfied get back to step 2 3 1 4 finding the optimal number of clusters the gmms for data clustering is an unsupervised learning technique in which the ground true class labels are not given in the data set consequently the performance of the gmms is constrained by finding the number of components k in order to do this several techniques exist it may not possible to use the silhouette metric because it may not reliable if the clusters are not spherical or have different sizes shapes and orientations instead finding the model that minimizes a theoretical criterion information such as the bayesian information criterion bic or the akaike information criterion aic is considered the bic and the aic are expressed as follows schwarz 1978 akaike 1974 11 b i c l n n q 2 l n l ˆ 12 a i c 2 q 2 l n l ˆ where n is the number of observations q is the number of parameters learned by the model l ˆ is the maximized value of the likelihood function of the model the optimal number of components k i e the number of clusters is likely with the lowest bic and aic value 3 1 5 data anomaly detectors in the section that follows it is critical to investigate the quality of the data set before proceeding to deploy the digital modeling with further data analysis for the purpose of such investigation two data anomaly detectors are proposed as illustrated in fig 4 first of all the data set needs to go through the first data anomaly detector based on minimum maximum values in this regard a limit check approach as discussed by isermann 2006 and perera 2016 is adopted for the detection of data anomalies and or outliers the domain knowledge is required to define the minimum and maximum values of the parameters of the data set these values represent the general range that the parameters can exist if data points stay beyond one of the given minimum and maximum thresholds they are indicating data outliers and will then be removed the second data anomaly detector will be executed when the digital modeling is constructed if there are any anomalies detected flag alarms will be given afterwards these anomalies are isolated it is noted that these outliers and anomalies acquired from the two data anomaly detectors are then stored in a data anomaly database for data recovery however dealing with the recovery process is beyond the scope of this study the second data anomaly detector is based on singular value decomposition svd brunton and kutz 2019 this is a numerically stable matrix decomposition method with versatile applications considering the following data set x r n m where n is the number of observations and m is the number of features i e parameters n m the svd formula can be expressed as follows 13 x u σ v t where u r n n is a square matrix with its column vectors are called the left singular vectors v r m m is a square matrix with its column vectors are called the right singular vectors σ r n m is called the singular value matrix consisting of singular values σ i i 1 m these singular values are ordered as σ 1 σ 2 σ m 0 an elegant interpretation of the svd can be observed in the correlation matrix x t x i e the normalized covariance matrix as follows 14 x t x v σ ˆ 2 v t x t x v v σ ˆ 2 where σ ˆ r m m is the square diagonal matrix with the singular values this interpretation provides some important advantages in using the svd in this study first the svd is able to construct optimal orthogonal expansions for projecting the original data set onto a linear subspace in this respect the columns of v i e the right singular vectors can be used as principal axes for data projections therefore the representation of the original data set can be constructed intuitively and meaningfully second with the help of the svd the most important information of the data set can be extracted based on the hierarchical order of importance of the dominant features this information can be observed in the top svs on the contrary the least important information of the data set are accommodated in the bottom svs for this reason data anomalies can be perceived in such bottom svs these anomalies can be understood as the parameter relationships that are deviated from the existing physical relationships of the parameters 3 2 visual analytics as indicated previously high dimensional data may cause a difficulty for data visualization in other words it is not easy to have intuition about the structure of data clusters in a high dimensional space the visual analytics is therefore proposed in order to identify the relative correlations or relationships among parameters under the respective data clusters in this regard the svd is performed and the structure of each data cluster is denoted by svs fig 5 illustrates this approach with three parameters i e x 1 x 2 and x 3 in a high dimensional space as a general representation presumably there are three svs z 1 z 2 and z 3 sorted in descending order i e from the outermost circle to the innermost circle associated with their singular values which represent the descending variance directions such variance information can be used to extract relevant correlations among parameters as represented by colored circles in the svs the size of each colored circle expresses the significance i e the strength of the parameter correlation the color of each colored circle expresses the positive negative sign of the parameter correlation when the colored circle is denoted in a large red circle it means that there is a high positive correlation when it is denoted in a large blue circle it means that there is a high negative correlation taking the top singular vector z 1 in fig 5 as an example there is a significant increase in the parameter x 2 while there is a significant decrease in the parameter x 3 a decrease in the parameter x 1 can also be seen in this condition it should be noted that the top singular vector z 1 represents the largest variance direction i e the most information of the data cluster while the bottom singular vector z 3 represents the smallest variance direction i e the least information of the respective data cluster for this reason several correlations among parameters might be unclear in the bottom singular vector 3 3 prescriptive analytics the section below proposes a selected kpi i e key performance indicator for ship performance quantification it is important to stress that this kpi is derived with respect to the availability of the ship performance and navigation parameters in the respective data set the kpi is attached to each of the ship s localized operational conditions i e represented by a cluster or a sub cluster in order to evaluate its performance the resulting kpi for ship performance quantification can be expressed as 15 s p i i f c i d i where 16 f c i f c a v g i t i 17 d i s t w a v g i t i here s p i i is the ship performance index of the ship s localized operational condition i f c i is the main engine me fuel consumption cons ton f c a v g i is the average me fuel cons ton day d i is the traveled distance nm t i is the time traveled day and s t w a v g i is the average speed through water stw nm h under the respective localized operational condition i correspondingly for the sake of unit consistency eq 15 can be rewritten as follows 18 s p i i f c a v g i 24 s t w a v g i it is noted that s p i i ton nm is a representation of the ship s average me fuel cons per nautical mile 4 data description and experimental settings as an exemplification for the application of the proposed method a ship performance and navigation data set was obtained from a bulk carrier this is a time series data set of 3 years with a sampling rate of 15 minutes table 1 shows several principal particulars of the selected ship while table 2 demonstrates twelve parameters with respect to ship performance and navigation along with their minimum maximum values the programming language used to analyze the data was python with jupyter notebook 6 0 3 interface it was running on a macos computer consisting of intel core i7 cpu 2 2 ghz with 6 cores and 32 gb ram the computational complexity of training the gmms depends on the number of observations n the number of parameters m the number of clusters k and the constraints on the covariance matrices regarding the settings of the gmms it needs to be run several times in order to end up converging to the best solution the number of initializations was set in this study is 10 5 results and discussion 5 1 descriptive analytics regarding the deployment of the first data anomaly detector it was found that several data points were unreasonable for example the values of trim were around 10 m or the values of the me fuel cons were around 118 ton day based on the domain knowledge these values were characterized as outliers and should be omitted therefore threshold values i e the minimum and maximum values of the navigation and performance parameters were accordingly identified based on the domain knowledge as shown in table 2 the ranges for the engine power and the shaft speed were given by the engine manufacturer in the case of the digital modeling fig 6 exemplifies the implementation of the kde and the gmms for engine data i e shaft speed and engine power in the first place the kde was constructed to gain insights into the number of components k for the gmms in this respect the density estimation of the engine data can be approximately perceived as three components i e cluster a b and c as shown in fig 6a among of these cluster a and c are the two main modes of the engine in operation while other data points are belonging to cluster b which could be attributed to a transient state of the engine therefore by using the kde as a representation guidance together with the domain knowledge the number of components i e the number of clusters k 3 was then be suggested for the gmms fig 6b illustrates the results of the deployment of the gmms capturing these three clusters as ellipsoid shaped clusters denoted in dark blue orange and turquoise respectively therefore it arrived at a conclusion that the selected ship was operating in three engine modes the gmms was further investigated in three dimensional space where the me fuel consumption the shaft speed and the engine power were taken into consideration as presented in fig 7 there are three clusters in relation to engine modes existing in the digital modeling when the digital modeling had been constructed the deployment of the second data anomaly detector was carried out as mentioned earlier the bottom singular vector i e z 12 carries the least important information of the data set hence it was used to detect anomalies for the second anomaly detector fig 8 shows that data cluster a is projected onto a new subspace represented by z 12 it should be noted that 3 σ and 3 σ here σ is the standard deviation of the respective data distribution were chosen as appropriate threshold values if data points exceed these values they are flagged as anomalies for this detector in this regard a number of anomalies are detected as shown in the middle and the bottom plot of fig 8 the identification of such anomalies was further investigated in fig 9 where all parameters are presented in a time series format with respect to the number of data points what stands out in this figure is that several anomalies are detected denoted by the red pulses and the anomaly alarms are accordingly raised it should be borne in mind that the shaft speed arranged in ascending order in the first plot is a basis for the detection of such anomalies it is also important to bear in mind that the operation of other on board systems including hotel systems is completely independent of the main engine in some situations therefore any variations in the auxiliary aux fuel cons or the aux power do not have any effects on the actual me fuel consumption in such situations in the first anomaly point da 1 there are some sudden changes with respect to the me power and the stw in the second anomaly point da 2 there are falling points in the me fuel cons and the stw similar strange behaviors can also be observed with respect to the me fuel cons and the stw in the third anomaly point da 3 this approach was further adopted to cluster b and cluster c table 3 presents the number of anomalies identified by this detector in the respective clusters the most likely causes of identified data anomalies existing in the data set are sensor faults and or abnormal events these causes draw conclusions for the diagnostic analytics perhaps the most interesting aspect of the descriptive analytics is the exploration of the ship s localized operational conditions as was pointed out previously the selected ship was operating in three engine modes represented by cluster a b and c each of these engine modes has different trim draft modes which can be represented by sub clusters to further examine this the deployment of the kde and the gmms for trim draft data was carried out under each of these engine modes the domain knowledge also occupied a role in determining the number of sub clusters in these cases fig 10 indicates there are four sub clusters a 1 a 2 a 3 and a 4 representing trim draft modes with respect to cluster a it can be seen from fig 11 that there are four sub cluster b 1 b 2 b 3 and b 4 i e trim draft modes with respect to cluster b fig 12 reports four sub clusters c 1 c 2 c 3 and c 4 i e trim draft modes with respect to cluster c 5 2 finding the optimal number of clusters as mentioned earlier an important factor by which the gmms can be evaluated is finding the optimal number of clusters k this can be done by calculating the bic and the aic the results on the bic and the aic of the engine data i e shaft speed and engine power are shown in fig 13 it can be seen from this figure that the bic and the aic results do not give an optimal position for k if there are many components k in the gmms it will increase the probability of over fitting therefore in this case the bic and the aic results are inconclusive the domain knowledge can play a crucial role in this case after consulting with the ship owner who provided us the data set they confirmed that the ship was operating in three engine modes this is in line with what we determined before further experiments on the bic and the aic were also performed for trim draft data as shown in figs 14 15 16 it can be observed from these figures that the results on the bic and the aic in all cases are also inconclusive therefore in this study the domain knowledge regarding the engine operational modes and the trim draft operational modes should be directly embedded into the gmms in order to identify possible data clusters by doing this the accuracy of the digital model can be improved 5 3 visual analytics as explained earlier the purpose of the visual analytics is to reveal the relative correlations among parameters under a cluster or a sub cluster the results on the visual analytics of data cluster a under trim draft modes i e represented by sub cluster a 1 a 2 a 3 and a 4 are illustrated in fig 17 the results on this analytics of sub cluster a 3 was selected for the purpose of illustration fig 17c is revealing in several ways the top singular vector shows an increase in the shaft speed and an increase in the me power thus the me fuel cons also increases it can also be found that a decrease in the aux power leads to a decrease in the aux fuel cons the average avg draft is also decreased in this condition turning to the second singular vector there is an adjustment of the trim and the avg draft thereby increasing the stw and the speed over ground sog the third singular vector demonstrates that an increase in the aux fuel cons is attributed to an increase in the aux power it can be observed from the fourth singular vector that an decrease in the stw may cause a considerable increase in the rel wind direction the fifth singular vector indicates that a decrease in the aux fuel cons stems from a decrease in the aux power it can also be seen in this situation that the trim is increased the sixth singular vector shows that there is an increase in the stw along with an increase in the rel wind direction besides a trim draft adjustment can be observed it is noted that the bottom singular vectors have low singular values as a result of this the correlations among parameters are unclear or there are no realistic correlations that can be observed in these bottom singular vectors the remaining results on this analytics of other sub clusters e g a 1 a 2 and a 4 can be explained in the same manners 5 4 prescriptive analytics as mentioned previously the prescriptive analytics is proposed to provide the kpi expressed by the ship performance index s p i in order to quantify the ship s performance under the identified localized operational modes table 4 compares the s p i results of trim draft modes under the respective engine modes as defined in eq 18 considering engine mode a trim draft mode a 1 appears to be the best performance mode because of its lowest s p i value s p i 0 0797 ton nm looking at engine mode b the s p i value of trim draft mode b 4 s p i 0 0805 ton nm indicates that this trim draft mode is the best performance mode turning to engine mode c based on the s p i value of trim draft mode c 1 s p i 0 0699 ton nm this is the best performance trim draft mode it is apparent from this table that overall trim draft mode c 1 has the lowest s p i value among other trim draft modes it can thus be suggested that this is the best performance mode of the selected ship however with the ship performance and navigation parameters available in the data set were considered caution should be applied the lack of the loading conditions in the data set added the caution regarding the generalizability of these results for energy efficiency quantification for this reason ship performance quantification was addressed rather than energy efficiency quantification 6 conclusion prior studies have only focused on predicting ship fuel consumption or optimizing engine speed trim as regards the improvement of operational energy efficiency to the best of our knowledge no other authors have studied the ship s performance in a local scale with respect to its operational conditions the novelty of this study is to quantify the performance of a selected ship under localized operational conditions i e engine and trim draft modes by developing an advanced data analytics framework it was demonstrated through a data set collected from a bulk carrier the research findings obtained from the proposed framework have been summarized as follows descriptive analytics has proposed two data anomaly detectors that were be able to detect and isolate a number of data anomalies existing in the data set furthermore it has offered a better understanding of the ship s localized operational conditions this can be perceived by the engine and the trim draft modes with the help of the kde and the gmms the investigation of the digital model has shown that the selected ship was operating in three engine modes represented by clusters a b and c the digital model was further examined for trim draft data with respect to these clusters the findings of this examination have shown that several trim draft modes were identified represented by sub clusters diagnostic analytics has suggested two main reasons why there are data anomalies in almost data sets collected from data acquisition systems in this regard sensor faults and or abnormal events were identified as the causes strongly associated with these data anomalies visual analytics has revealed the relative relationships or correlations among the ship performance and navigation parameters in relation to the respective engine modes and trim draft modes prescriptive analytics has provided a kpi in order to quantify the ship s performance under the respective engine modes and trim draft modes the kpi was expressed by the ship performance index s p i i e the average me fuel cons per nautical mile based on the s p i findings it is likely that sub cluster c 1 was the best performance trim draft mode of the selected ship taken together the findings suggest a role for the domain knowledge in every step of the proposed framework moreover the findings have the potential to serve as an operational energy efficiency measure that is of value for both ship operators captains chief engineers ship officers and decision makers ship owners fleet managers technical divisions for improving energy efficiency through operational practices in this respect the findings can be integrated into the ship performance monitoring systems specifically they can be simulated and displayed on the on board user interfaces therefore ship operators are equipped with meaningful visualizations and indicators in order to evaluate their practices and raise their awareness with respect to energy efficiency by considering the kpi proposed in this study ship operators could know in which engine trim draft mode they should facilitate the eco maneuvering e g operating the engine under the load range with the lowest specific fuel oil consumption this kpi will change depending on system s operational conditions and hull fouling conditions hence ship operators can also consult with technical divisions ashore in order to trouble shoot their operational problems via remote communication furthermore such visualizations and indicators can assist ship owners fleet managers in achieving performance improvement across their fleet looking ahead towards shipping 4 0 the ship performance monitoring systems can be transformed into digital platforms by the digital twin technology the digital twin is a virtual representation which serves as the real life counterpart of the ship the digital model proposed in the study has the potential for exploiting the digital twin in this way the digital twin has the capabilities to become an automated self aware anomaly detection self visualization platform that enables ship operators and fleet managers to monitor the instantaneous performance of the ship in real time nonetheless the findings in this study are subject to a limitation the s p i findings on the account of ship performance quantification maybe somewhat limited by the absence of the loading conditions parameter in the data set therefore these findings need to be interpreted with caution this is the main reason why ship performance quantification was concerned in this study rather than energy efficiency quantification further studies which take the loading conditions and other factors into account for energy efficiency quantification will need to be undertaken moreover the issue of data quality is an intriguing one which could be usefully explored in the further studies credit authorship contribution statement khanh q bui methodology software formal analysis writing original draft preparation visualization lokukaluge p perera conceptualization methodology writing review and editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20526,improving the operational energy efficiency of existing ships is attracting considerable interests to reduce the environmental footprint due to air emissions as the shipping industry is entering into shipping 4 0 with digitalization as a disruptive force an intriguing area in the field of ship s operational energy efficiency is big data analytics this paper proposes a big data analytics framework for ship performance monitoring under localized operational conditions with the help of appropriate data analytics together with domain knowledge the proposed framework is showcased through a data set obtained from a bulk carrier pertaining the detection of data anomalies the investigation of the ship s localized operational conditions the identification of the relative correlations among parameters and the quantification of the ship s performance in each of the respective conditions the novelty of this study is to provide a kpi i e key performance indicator for ship performance quantification in order to identify the best performance trim draft mode under the engine modes of the case study ship the proposed framework has the features to serve as an operational energy efficiency measure to provide data quality evaluation and decision support for ship performance monitoring that is of value for both ship operators and decision makers keywords big data analytics machine learning ship performance monitoring energy efficiency emission control data anomaly detection 1 introduction international shipping is an indispensable sector for the facilitation of global economy since it is responsible for about 80 of the total volume of global trade unctad 2019 furthermore seaborne transportation is recognized as the most energy efficient mode of cargo transport as regards energy use per unit transported nonetheless considering its scale and current growth rate the shipping industry is a major catalyst for global ecological change balcombe et al 2019 according to the fourth greenhouse gas ghg study published by the international maritime organization imo global anthropogenic emissions from shipping increased by approximately 10 from 2012 to 2018 imo 2020 it is envisaged that shipping emissions will rise between 90 and 130 by 2050 relative to 2008 for long term economic and energy scenarios therefore shipping co2 emissions are increasing by way of illustration if the maritime sector had been treated as a country it would have been the sixth largest co2 emitter in 2015 olivier et al 2016 such environmental concerns have been acknowledged in a number of regulatory frameworks established by the imo ghg emissions from shipping are addressed by energy efficiency measures under annex vi of the international convention for the prevention of pollution from ships marpol in response to the paris agreement the imo set out an initial imo strategy on reducing ghg emissions from ships aiming at reducing the total annual ghg emissions by at least 50 by 2050 compared to 2008 levels these increasingly stringent regulations have exerted pressure on the shipping industry to pursue possible avenues of reducing its environmental footprint perera et al 2021 in order to achieve this finding alternative fuel sources has been paid much attention in the industry the search for the right future fuel is challenging since it is a multi faceted problem where the evaluation of a pallet of different alternative options is influenced by multiple criteria such as technical economic environmental and social criteria bui and perera 2019 bui et al 2020 in addition to fuel changes it is an orthodox norm that reducing fuel consumption or improving energy efficiency is an effective solution to reduce ship emissions due to the fact that ghg emissions from internal combustion engines are directly related to ship fuel consumption energy efficiency improvement solutions are generally divided into technical and operational measures the former refers to improvements made throughout the ship design phase such as hull form optimization air lubricant propulsion efficiency devices waste heat recovery technology brynolf et al 2016 the latter refers to measures including optimal handling of ships e g trim and ballast optimization voyage optimization e g weather routing slow steaming just in time arrival and good maintenance practices for engine hull and propeller ölçer 2018 it has been observed from the literature that there is still a large potential for increasing energy efficiency from operational practices thereby reducing co2 emissions for example voyage optimization has the potential effect on co2 emissions reduction at the figure of up to 48 bouman et al 2017 nonetheless technical support systems ship performance monitoring systems are required to facilitate this practice imo 2014 viktorelius and lundh 2019 it is a widely held view that the shipping industry is on its way to the fourth industrial revolution as known as shipping 4 0 rødseth et al 2016 the transformational role of digitalization and the rise of artificial intelligence ai together with machine learning ml will exert tremendous impacts on all of the aspects of the industry internet of things iot with the utilization of sensor technologies as well as data acquisition systems can produce a massive amount of sensor data referred to as big data which can be used for analysis and further insights on ship performance monitoring therefore proper techniques are required to leverage big data to support increased energy efficiency during ship operation zaman et al 2017 sullivan et al 2020 in this respect big data analytics have emerged as a disruptive technology that can be an operational energy efficiency measure under the ship performance monitoring systems the last few years have witnessed a considerable growth in the number of data driven studies on improving ship energy efficiency despite this interest scant studies have applied big data analytics approach in addition several studies have failed to demonstrate significant advantages of domain knowledge in every step of data analysis workflow the term domain knowledge means the domain specific expertise of the field and it plays an important role in each step of a data analysis project ranging from problem formulation data collection data pre processing modeling to result interpretation therefore the accuracy of data driven models based on ml can be increased if domain knowledge is incorporated into such models furthermore concerns have arisen which call into question the quality of ship performance and navigation data this problem is related to data veracity which is one of the characteristics of big data as known as the four v s of big data including volume velocity variety and veracity perera and mo 2017 zaman et al 2017 it should also be noted that knowledge and awareness of ship operators have been recognized as one of the energy efficiency gaps from the operational side kitada and ölçer 2015 rasmussen et al 2018 given the above mentioned background this paper aims to develop an advanced data analytics framework for ship performance monitoring under localized operational conditions where domain knowledge is taken into account the proposed framework will be able to serve as an operational energy efficiency measure to provide data quality evaluation and decision support for ship performance monitoring under the digitalization of the maritime industry the structure of this paper is organized as follow section 2 reviews the literature on ship s operational energy efficiency and data anomaly detection the proposed methodology is described in section 3 results of the proposed methodology are reported in section 5 the conclusions are drawn in section 6 2 literature review 2 1 ship s operational energy efficiency on the question of improving operational energy efficiency more attention in the literature has been given to the prediction of ship fuel consumption or engine power in this regard statistical models were deployed in several studies erto et al 2015 sasa et al 2015 however these parametric methods may have bias problems due to their assumptions on data distributions additionally they have failed to cope with complicated and non linear data yan et al 2020 soner et al 2018 therefore ml models have been widely developed to overcome these problems in this context a number of studies implemented ml models such as artificial neural networks anns petersen et al 2012a b bal beşikçi et al 2016 farag and ölçer 2020 karagiannidis and themelis 2021 regression models brandsæter and vanem 2018 yan et al 2020 wang et al 2018 and ensemble models soner et al 2018 gkerekos et al 2019 engine speed optimization and trim optimization have also been gained attention in the literature in terms of improving operational energy efficiency in this respect there has been considerable interest in using big data analytics approach wang et al 2017 made an attempt to achieve ship energy efficiency through a big data analysis based on hadoop platform architecture in this study route division with regard to environmental factors was examined and speed optimization in different navigational segments of a route was investigated yan et al 2018 proposed a big data analytics platform to analyze environmental factors for the purpose of optimizing engine speed for inland ships this study applied the distributed parallel k means clustering algorithm to obtain an elaborate route division and then find the optimal engine speed for the selected inland ship coraddu et al 2017 employed a data analytics approach for fuel consumption prediction and trim optimization of a tanker in this study two gray box models were proposed as predictive models for the prediction of the fuel consumption based on these models a trim optimization method of the tanker was developed lee et al 2018 utilized weather archive big data to estimate the fuel consumption function for speed optimization in maritime logistics in this study they developed a decision support systems for minimizing fuel consumption while maintaining service level agreement by applying an optimization method called particle swarm optimization it is probable that these ml based studies have become the means to provide better prediction and decision support towards energy efficiency nonetheless several studies have not treated domain knowledge in much detail in this regard man et al 2020 proposed an ethnographic method to identify operational challenges on using fuel monitoring systems one of these challenges is the lack of effective analytical approaches for ship performance evaluation this leads to a need for utilizing big data analytics in order to gain understanding of actual fuel consumption to achieve energy efficiency it has also been observed that many studies hold the view that ship speed is the major determinant for ship fuel consumption nonetheless other factors including among others displacement trim draft conditions loading conditions environmental conditions and navigation conditions also have impacts on ship fuel consumption tran 2020 yuan et al 2017 soner et al 2019 it should be noted that these factors may pose a high dimensional challenge for data visualization as pointed out by perera and mo 2020 2 2 data anomaly detection it is a self evident fact that data collected from real world sources are often impure the so called garbage in garbage out gigo refers to the fact that poor quality data input is associated with untrustworthy output pyle 1999 this leads to the needs for methods that can be used for preparing quality data i e data preprocessing as a fundamental step during data analysis workflow zhang et al 2003 nevertheless data quality awareness has yet to be reached its maturity in the maritime industry and a call for the industry to value and improve data quality in addition it is worth bearing in mind that the practicality of data quality cannot be done without considering domain knowledge in the literature several taxonomies for data anomaly detection have been developed such as fault diagnosis fault detection and fault tolerant control such taxonomies can be treated under decision support systems and condition monitoring aiming at enhancing reliability safety and energy efficiency of ship systems different approaches for the detection of possible faults in decision support systems of a container ship were proposed i e the deployment of residuals and the generalized likelihood ratio glr algorithm lajic and nielsen 2010 the deployment of volterra theory lajic et al 2009 and the deployment of a frequency domain based model nielsen et al 2012 raptodimos and lazakis 2018 proposed a method based on the integration of anns and self organising maps som along with inter clustering for data clustering and fault diagnosis of measurement data of physical parameters of a ship main engine cylinder vanem and brandsæter 2019 deployed unsupervised learning techniques for data anomaly detection for sensor based condition monitoring for a marine diesel engine capezza et al 2019 developed a model based on the combination of partial least squares pls regression and prediction error control charts for monitoring of fuel consumption and diagnosis of faults lazakis et al 2019 investigated the utilization of support vector machine svm for the detection of deviant and abnormal ship machinery conditions dalheim and steen 2020 developed a data preparation toolbox for time series data in order to improve the quality of ship operation and performance analysis cheliotis et al 2020 proposed a method based on expected behavior eb models in combination with exponentially weighted moving average ewma control charts for early faults detection in the main engine of a ship karagiannidis and themelis 2021 demonstrated that their proposed algorithms for replacing and cleaning data were be able to increase the accuracy of their produced ann models 2 3 research contribution the research studies reviewed in the previous section point to the following research drawbacks first the use of anns have been observed in several studies albeit its shortcomings the most fundamental shortcoming of this approach has been clearly recognized as a black box approach and it is challenging to interpret behavior of the network second the contribution of domain knowledge has received little attention within the context of maritime applications third most of the studies reviewed have not been able to take into account correlations between factors contributing to ship fuel consumption in a high dimensional data space fourth data quality for ship operation and performance is still a neglected area in the maritime domain and few researchers have addressed this issue in the literature in order to overcome aforementioned drawbacks this study proposes an advanced data analytics framework for ship performance monitoring the novelty of this study is to utilize the proposed framework in order to quantify the performance of a selected ship in the context of its localized operational conditions i e engine and trim draft modes as the novel contributions of this study the proposed framework is be able to i detect and isolate data anomalies existing in a given data set ii investigate the ship s localized operational conditions iv deal with numerous factors that have influences on the ship s performance in a high dimensional data space and iii to provide a kpi i e ship performance indicator for ship performance quantification 3 method the proposed framework presented in this paper has been built upon a preliminary work as described in bui and perera 2020 fig 1 illustrates the overall architecture of the proposed framework with key aspects that can be listed as follows domain knowledge descriptive analytics diagnostic analytics visual analytics and prescriptive analytics domain knowledge is embedded in every step of the proposed framework it refers to an understanding of the ship s localized operational conditions i e engine and trim draft modes the reasoning behind conclusions in each data analytics it also refers to the knowledge obtained from interactions with experts in the field of maritime transport e g ship owners ship operators engine manufacturers descriptive analytics this attempts to answer the question of what happened it provides an understanding of what happened to the system from this perspective two anomaly detectors are proposed to detect and isolate data anomalies furthermore digital modeling is proposed for the investigation of certain patterns of the ship s operational conditions through data clustering diagnostic analytics this attempts to answer the question of why did it happen it reflects an understanding of why something happened to the system from this perspective the causes of data anomalies are identified visual analytics this visualizes the improved data in order to identify the relative relationships or correlations among ship performance and navigation parameters under each of the localized operational conditions prescriptive analytics this attempts to answer the question of what do we do from this perspective a selected kpi i e key performance indicator for ship performance quantification is provided 3 1 descriptive analytics 3 1 1 digital modeling what follows is an account of digital modeling which aims to provide insights into data properties with respect to the ship s localized operational conditions for this reason a digital model is formulated to gain a better understating of discrete data distributions in a high dimensional space fig 2 depicts the digital model which is an extended version of perera and mo 2020 the digital model is represented in the right handed coordinate system of three parameters i e x 1 x 2 x 3 of a selected data set it is assumed in the digital model that there is an existence of several data clusters i e a b c which represent engine localized operational conditions these data clusters are represented by vectors with their respective mean values i e μ 1 μ 2 μ 3 moreover each of the data clusters contains several structural vectors in the form of singular vectors svs for example svs of cluster i i a b c are denoted as z i 1 z i 2 z i 3 furthermore fig 2 also pinpoints some arrows between the data clusters in the digital model a probable explanation is that there are certain transient regions representing the transition modes from an operational condition to another it is necessary to be borne in mind that data outliers and data anomaly clusters can also be represented under the digital model this is attributed to the data veracity that should be properly addressed it is also of interest to further investigate other operational conditions i e trim and draft conditions within the respective data clusters in this respect the projection of the data cluster a onto another high dimensional space is shown in the window on the right handed side of fig 2 where sub data clusters with respect to trim and draft condition i e a 1 a 2 a 3 can be explored a more detailed account of the ship s localized operational conditions can be observed in fig 3 in this regard there are hierarchical relationships between engine operational conditions and trim draft operational conditions it can be assumed that there are several engine modes e g engine mode a b c etc such engine modes can be demonstrated by cluster a b c etc several trim draft modes can be further explored under each of these engine modes for example trim draft modes a 1 a 2 a 3 etc can be found under engine mode a these trim draft modes can be demonstrated by sub clusters e g sub cluster a 1 a 2 a 3 etc 3 1 2 kernel density estimation kde the investigation on the properties of the data can be done by kde a non parametric density estimation method which yields a smooth representation of the underlying probability density function of the data supposing a data set of observations x x 1 x 2 x 3 x n with n samples are being drawn from an unknown probability density p x we wish to estimate the shape of p x the kernel density estimation at x is defined as follows bishop 2006 1 p ˆ x 1 n h i 1 n ϕ x x i h where ϕ is a kernel function which specifies the shape of the distribution placed at each point h is a smoothing parameter called the bandwidth which controls the size of the kernel at each point the choice for ϕ in this study is the gaussian kernel 3 1 3 gaussian mixture models gmms the following is a brief description of an unsupervised learning technique for data clustering the technique is based on probability density estimation using gmms and the expectation maximization em algorithm for distributing data into different clusters the gaussian distribution of a d dimensional vector x is defined as bishop 2006 2 n x μ σ 1 2 π d 2 σ e x p 1 2 x μ t σ 1 x μ where μ is a mean vector and σ is a covariance matrix the probability given in a mixture of k gaussians is defined as 3 p x k 1 k π k n x μ k σ k where each gaussian density n x μ k σ k is called a component of the mixture with its mean vector μ k and covariance σ k for the k t h gaussian component π k is the prior probability of the k t h gaussian π k is also defined as the mixing coefficients with the constraint that k 1 k π k 1 em algorithm for gaussian mixtures fitting a mixture of gaussians to data can be done by using the maximum likelihood and the em algorithm from eq 3 the log of the likelihood function is expressed as 4 l n p x π μ σ n 1 n l n k 1 k π k n x n μ k σ k given a gaussian mixture model the em algorithm is a powerful technique for maximizing this likelihood function with respect to the parameters i e the means μ k the covariances of the components σ k and the mixing coefficients π k step 1 initialize μ k σ k π k and evaluate the initial value of the log likelihood step 2 expectation step use the current values for parameters to evaluate the posterior probabilities or the responsibilities γ z n k which is taken by component k for explaining the observation of data point x n 5 γ z n k π k n x n μ k σ k j 1 k π j n x n μ j σ j step 3 maximization step re estimate the parameters using the current responsibilities 6 μ k n e w 1 n k n 1 n γ z n k x n 7 γ k n e w 1 n k n 1 n γ z n k x n μ k n e w x n μ k n e w t 8 π k n e w n k n where 9 n k n 1 n γ z n k n k can be interpreted as the effective number of points assigned to cluster k step 4 evaluate the log likelihood 10 l n p x π μ σ n 1 n l n k 1 k π k n x n μ k σ k and check for convergence of either the parameters or the log likelihood if the convergence criterion is not satisfied get back to step 2 3 1 4 finding the optimal number of clusters the gmms for data clustering is an unsupervised learning technique in which the ground true class labels are not given in the data set consequently the performance of the gmms is constrained by finding the number of components k in order to do this several techniques exist it may not possible to use the silhouette metric because it may not reliable if the clusters are not spherical or have different sizes shapes and orientations instead finding the model that minimizes a theoretical criterion information such as the bayesian information criterion bic or the akaike information criterion aic is considered the bic and the aic are expressed as follows schwarz 1978 akaike 1974 11 b i c l n n q 2 l n l ˆ 12 a i c 2 q 2 l n l ˆ where n is the number of observations q is the number of parameters learned by the model l ˆ is the maximized value of the likelihood function of the model the optimal number of components k i e the number of clusters is likely with the lowest bic and aic value 3 1 5 data anomaly detectors in the section that follows it is critical to investigate the quality of the data set before proceeding to deploy the digital modeling with further data analysis for the purpose of such investigation two data anomaly detectors are proposed as illustrated in fig 4 first of all the data set needs to go through the first data anomaly detector based on minimum maximum values in this regard a limit check approach as discussed by isermann 2006 and perera 2016 is adopted for the detection of data anomalies and or outliers the domain knowledge is required to define the minimum and maximum values of the parameters of the data set these values represent the general range that the parameters can exist if data points stay beyond one of the given minimum and maximum thresholds they are indicating data outliers and will then be removed the second data anomaly detector will be executed when the digital modeling is constructed if there are any anomalies detected flag alarms will be given afterwards these anomalies are isolated it is noted that these outliers and anomalies acquired from the two data anomaly detectors are then stored in a data anomaly database for data recovery however dealing with the recovery process is beyond the scope of this study the second data anomaly detector is based on singular value decomposition svd brunton and kutz 2019 this is a numerically stable matrix decomposition method with versatile applications considering the following data set x r n m where n is the number of observations and m is the number of features i e parameters n m the svd formula can be expressed as follows 13 x u σ v t where u r n n is a square matrix with its column vectors are called the left singular vectors v r m m is a square matrix with its column vectors are called the right singular vectors σ r n m is called the singular value matrix consisting of singular values σ i i 1 m these singular values are ordered as σ 1 σ 2 σ m 0 an elegant interpretation of the svd can be observed in the correlation matrix x t x i e the normalized covariance matrix as follows 14 x t x v σ ˆ 2 v t x t x v v σ ˆ 2 where σ ˆ r m m is the square diagonal matrix with the singular values this interpretation provides some important advantages in using the svd in this study first the svd is able to construct optimal orthogonal expansions for projecting the original data set onto a linear subspace in this respect the columns of v i e the right singular vectors can be used as principal axes for data projections therefore the representation of the original data set can be constructed intuitively and meaningfully second with the help of the svd the most important information of the data set can be extracted based on the hierarchical order of importance of the dominant features this information can be observed in the top svs on the contrary the least important information of the data set are accommodated in the bottom svs for this reason data anomalies can be perceived in such bottom svs these anomalies can be understood as the parameter relationships that are deviated from the existing physical relationships of the parameters 3 2 visual analytics as indicated previously high dimensional data may cause a difficulty for data visualization in other words it is not easy to have intuition about the structure of data clusters in a high dimensional space the visual analytics is therefore proposed in order to identify the relative correlations or relationships among parameters under the respective data clusters in this regard the svd is performed and the structure of each data cluster is denoted by svs fig 5 illustrates this approach with three parameters i e x 1 x 2 and x 3 in a high dimensional space as a general representation presumably there are three svs z 1 z 2 and z 3 sorted in descending order i e from the outermost circle to the innermost circle associated with their singular values which represent the descending variance directions such variance information can be used to extract relevant correlations among parameters as represented by colored circles in the svs the size of each colored circle expresses the significance i e the strength of the parameter correlation the color of each colored circle expresses the positive negative sign of the parameter correlation when the colored circle is denoted in a large red circle it means that there is a high positive correlation when it is denoted in a large blue circle it means that there is a high negative correlation taking the top singular vector z 1 in fig 5 as an example there is a significant increase in the parameter x 2 while there is a significant decrease in the parameter x 3 a decrease in the parameter x 1 can also be seen in this condition it should be noted that the top singular vector z 1 represents the largest variance direction i e the most information of the data cluster while the bottom singular vector z 3 represents the smallest variance direction i e the least information of the respective data cluster for this reason several correlations among parameters might be unclear in the bottom singular vector 3 3 prescriptive analytics the section below proposes a selected kpi i e key performance indicator for ship performance quantification it is important to stress that this kpi is derived with respect to the availability of the ship performance and navigation parameters in the respective data set the kpi is attached to each of the ship s localized operational conditions i e represented by a cluster or a sub cluster in order to evaluate its performance the resulting kpi for ship performance quantification can be expressed as 15 s p i i f c i d i where 16 f c i f c a v g i t i 17 d i s t w a v g i t i here s p i i is the ship performance index of the ship s localized operational condition i f c i is the main engine me fuel consumption cons ton f c a v g i is the average me fuel cons ton day d i is the traveled distance nm t i is the time traveled day and s t w a v g i is the average speed through water stw nm h under the respective localized operational condition i correspondingly for the sake of unit consistency eq 15 can be rewritten as follows 18 s p i i f c a v g i 24 s t w a v g i it is noted that s p i i ton nm is a representation of the ship s average me fuel cons per nautical mile 4 data description and experimental settings as an exemplification for the application of the proposed method a ship performance and navigation data set was obtained from a bulk carrier this is a time series data set of 3 years with a sampling rate of 15 minutes table 1 shows several principal particulars of the selected ship while table 2 demonstrates twelve parameters with respect to ship performance and navigation along with their minimum maximum values the programming language used to analyze the data was python with jupyter notebook 6 0 3 interface it was running on a macos computer consisting of intel core i7 cpu 2 2 ghz with 6 cores and 32 gb ram the computational complexity of training the gmms depends on the number of observations n the number of parameters m the number of clusters k and the constraints on the covariance matrices regarding the settings of the gmms it needs to be run several times in order to end up converging to the best solution the number of initializations was set in this study is 10 5 results and discussion 5 1 descriptive analytics regarding the deployment of the first data anomaly detector it was found that several data points were unreasonable for example the values of trim were around 10 m or the values of the me fuel cons were around 118 ton day based on the domain knowledge these values were characterized as outliers and should be omitted therefore threshold values i e the minimum and maximum values of the navigation and performance parameters were accordingly identified based on the domain knowledge as shown in table 2 the ranges for the engine power and the shaft speed were given by the engine manufacturer in the case of the digital modeling fig 6 exemplifies the implementation of the kde and the gmms for engine data i e shaft speed and engine power in the first place the kde was constructed to gain insights into the number of components k for the gmms in this respect the density estimation of the engine data can be approximately perceived as three components i e cluster a b and c as shown in fig 6a among of these cluster a and c are the two main modes of the engine in operation while other data points are belonging to cluster b which could be attributed to a transient state of the engine therefore by using the kde as a representation guidance together with the domain knowledge the number of components i e the number of clusters k 3 was then be suggested for the gmms fig 6b illustrates the results of the deployment of the gmms capturing these three clusters as ellipsoid shaped clusters denoted in dark blue orange and turquoise respectively therefore it arrived at a conclusion that the selected ship was operating in three engine modes the gmms was further investigated in three dimensional space where the me fuel consumption the shaft speed and the engine power were taken into consideration as presented in fig 7 there are three clusters in relation to engine modes existing in the digital modeling when the digital modeling had been constructed the deployment of the second data anomaly detector was carried out as mentioned earlier the bottom singular vector i e z 12 carries the least important information of the data set hence it was used to detect anomalies for the second anomaly detector fig 8 shows that data cluster a is projected onto a new subspace represented by z 12 it should be noted that 3 σ and 3 σ here σ is the standard deviation of the respective data distribution were chosen as appropriate threshold values if data points exceed these values they are flagged as anomalies for this detector in this regard a number of anomalies are detected as shown in the middle and the bottom plot of fig 8 the identification of such anomalies was further investigated in fig 9 where all parameters are presented in a time series format with respect to the number of data points what stands out in this figure is that several anomalies are detected denoted by the red pulses and the anomaly alarms are accordingly raised it should be borne in mind that the shaft speed arranged in ascending order in the first plot is a basis for the detection of such anomalies it is also important to bear in mind that the operation of other on board systems including hotel systems is completely independent of the main engine in some situations therefore any variations in the auxiliary aux fuel cons or the aux power do not have any effects on the actual me fuel consumption in such situations in the first anomaly point da 1 there are some sudden changes with respect to the me power and the stw in the second anomaly point da 2 there are falling points in the me fuel cons and the stw similar strange behaviors can also be observed with respect to the me fuel cons and the stw in the third anomaly point da 3 this approach was further adopted to cluster b and cluster c table 3 presents the number of anomalies identified by this detector in the respective clusters the most likely causes of identified data anomalies existing in the data set are sensor faults and or abnormal events these causes draw conclusions for the diagnostic analytics perhaps the most interesting aspect of the descriptive analytics is the exploration of the ship s localized operational conditions as was pointed out previously the selected ship was operating in three engine modes represented by cluster a b and c each of these engine modes has different trim draft modes which can be represented by sub clusters to further examine this the deployment of the kde and the gmms for trim draft data was carried out under each of these engine modes the domain knowledge also occupied a role in determining the number of sub clusters in these cases fig 10 indicates there are four sub clusters a 1 a 2 a 3 and a 4 representing trim draft modes with respect to cluster a it can be seen from fig 11 that there are four sub cluster b 1 b 2 b 3 and b 4 i e trim draft modes with respect to cluster b fig 12 reports four sub clusters c 1 c 2 c 3 and c 4 i e trim draft modes with respect to cluster c 5 2 finding the optimal number of clusters as mentioned earlier an important factor by which the gmms can be evaluated is finding the optimal number of clusters k this can be done by calculating the bic and the aic the results on the bic and the aic of the engine data i e shaft speed and engine power are shown in fig 13 it can be seen from this figure that the bic and the aic results do not give an optimal position for k if there are many components k in the gmms it will increase the probability of over fitting therefore in this case the bic and the aic results are inconclusive the domain knowledge can play a crucial role in this case after consulting with the ship owner who provided us the data set they confirmed that the ship was operating in three engine modes this is in line with what we determined before further experiments on the bic and the aic were also performed for trim draft data as shown in figs 14 15 16 it can be observed from these figures that the results on the bic and the aic in all cases are also inconclusive therefore in this study the domain knowledge regarding the engine operational modes and the trim draft operational modes should be directly embedded into the gmms in order to identify possible data clusters by doing this the accuracy of the digital model can be improved 5 3 visual analytics as explained earlier the purpose of the visual analytics is to reveal the relative correlations among parameters under a cluster or a sub cluster the results on the visual analytics of data cluster a under trim draft modes i e represented by sub cluster a 1 a 2 a 3 and a 4 are illustrated in fig 17 the results on this analytics of sub cluster a 3 was selected for the purpose of illustration fig 17c is revealing in several ways the top singular vector shows an increase in the shaft speed and an increase in the me power thus the me fuel cons also increases it can also be found that a decrease in the aux power leads to a decrease in the aux fuel cons the average avg draft is also decreased in this condition turning to the second singular vector there is an adjustment of the trim and the avg draft thereby increasing the stw and the speed over ground sog the third singular vector demonstrates that an increase in the aux fuel cons is attributed to an increase in the aux power it can be observed from the fourth singular vector that an decrease in the stw may cause a considerable increase in the rel wind direction the fifth singular vector indicates that a decrease in the aux fuel cons stems from a decrease in the aux power it can also be seen in this situation that the trim is increased the sixth singular vector shows that there is an increase in the stw along with an increase in the rel wind direction besides a trim draft adjustment can be observed it is noted that the bottom singular vectors have low singular values as a result of this the correlations among parameters are unclear or there are no realistic correlations that can be observed in these bottom singular vectors the remaining results on this analytics of other sub clusters e g a 1 a 2 and a 4 can be explained in the same manners 5 4 prescriptive analytics as mentioned previously the prescriptive analytics is proposed to provide the kpi expressed by the ship performance index s p i in order to quantify the ship s performance under the identified localized operational modes table 4 compares the s p i results of trim draft modes under the respective engine modes as defined in eq 18 considering engine mode a trim draft mode a 1 appears to be the best performance mode because of its lowest s p i value s p i 0 0797 ton nm looking at engine mode b the s p i value of trim draft mode b 4 s p i 0 0805 ton nm indicates that this trim draft mode is the best performance mode turning to engine mode c based on the s p i value of trim draft mode c 1 s p i 0 0699 ton nm this is the best performance trim draft mode it is apparent from this table that overall trim draft mode c 1 has the lowest s p i value among other trim draft modes it can thus be suggested that this is the best performance mode of the selected ship however with the ship performance and navigation parameters available in the data set were considered caution should be applied the lack of the loading conditions in the data set added the caution regarding the generalizability of these results for energy efficiency quantification for this reason ship performance quantification was addressed rather than energy efficiency quantification 6 conclusion prior studies have only focused on predicting ship fuel consumption or optimizing engine speed trim as regards the improvement of operational energy efficiency to the best of our knowledge no other authors have studied the ship s performance in a local scale with respect to its operational conditions the novelty of this study is to quantify the performance of a selected ship under localized operational conditions i e engine and trim draft modes by developing an advanced data analytics framework it was demonstrated through a data set collected from a bulk carrier the research findings obtained from the proposed framework have been summarized as follows descriptive analytics has proposed two data anomaly detectors that were be able to detect and isolate a number of data anomalies existing in the data set furthermore it has offered a better understanding of the ship s localized operational conditions this can be perceived by the engine and the trim draft modes with the help of the kde and the gmms the investigation of the digital model has shown that the selected ship was operating in three engine modes represented by clusters a b and c the digital model was further examined for trim draft data with respect to these clusters the findings of this examination have shown that several trim draft modes were identified represented by sub clusters diagnostic analytics has suggested two main reasons why there are data anomalies in almost data sets collected from data acquisition systems in this regard sensor faults and or abnormal events were identified as the causes strongly associated with these data anomalies visual analytics has revealed the relative relationships or correlations among the ship performance and navigation parameters in relation to the respective engine modes and trim draft modes prescriptive analytics has provided a kpi in order to quantify the ship s performance under the respective engine modes and trim draft modes the kpi was expressed by the ship performance index s p i i e the average me fuel cons per nautical mile based on the s p i findings it is likely that sub cluster c 1 was the best performance trim draft mode of the selected ship taken together the findings suggest a role for the domain knowledge in every step of the proposed framework moreover the findings have the potential to serve as an operational energy efficiency measure that is of value for both ship operators captains chief engineers ship officers and decision makers ship owners fleet managers technical divisions for improving energy efficiency through operational practices in this respect the findings can be integrated into the ship performance monitoring systems specifically they can be simulated and displayed on the on board user interfaces therefore ship operators are equipped with meaningful visualizations and indicators in order to evaluate their practices and raise their awareness with respect to energy efficiency by considering the kpi proposed in this study ship operators could know in which engine trim draft mode they should facilitate the eco maneuvering e g operating the engine under the load range with the lowest specific fuel oil consumption this kpi will change depending on system s operational conditions and hull fouling conditions hence ship operators can also consult with technical divisions ashore in order to trouble shoot their operational problems via remote communication furthermore such visualizations and indicators can assist ship owners fleet managers in achieving performance improvement across their fleet looking ahead towards shipping 4 0 the ship performance monitoring systems can be transformed into digital platforms by the digital twin technology the digital twin is a virtual representation which serves as the real life counterpart of the ship the digital model proposed in the study has the potential for exploiting the digital twin in this way the digital twin has the capabilities to become an automated self aware anomaly detection self visualization platform that enables ship operators and fleet managers to monitor the instantaneous performance of the ship in real time nonetheless the findings in this study are subject to a limitation the s p i findings on the account of ship performance quantification maybe somewhat limited by the absence of the loading conditions parameter in the data set therefore these findings need to be interpreted with caution this is the main reason why ship performance quantification was concerned in this study rather than energy efficiency quantification further studies which take the loading conditions and other factors into account for energy efficiency quantification will need to be undertaken moreover the issue of data quality is an intriguing one which could be usefully explored in the further studies credit authorship contribution statement khanh q bui methodology software formal analysis writing original draft preparation visualization lokukaluge p perera conceptualization methodology writing review and editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20527,in this study the acceleration and stopping manoeuvres of a bare hull surface combatant have practically been predicted by closed form analytical solutions derived from basic mechanical principles they have also been simulated directly by an unsteady rans reynolds averaged navier stokes solver with overset grid structure to compare the results with those of closed form approaches a well known surface combatant model dtmb5415 has been chosen for validation the instantaneous drag forces of the model ship in the acceleration and stopping manoeuvres have been provided by both cfd and holtrop s methods it has been observed that the results by analytical solutions have a good match with those of the manoeuvring simulations based on unsteady rans solver successful predictions have also been made consistent with the results obtained when experimental resistance values are used in analytical solutions it has been concluded that the closed form solution methods yield practically satisfactory results in a very short time when a fast resistance prediction method such as holtrop s method or cfd is used keywords ship manoeuvring acceleration stopping cfd analytical solution nomenclature α acceleration m s 2 bm beam moulded m bwl beam at waterline m cb block coefficient cd drag coefficient ct cfd total drag coefficient by cfd ct exp total drag coefficient by experiments ct h total drag coefficient by holtrop cm midship coefficient δ displacement kg δt infinitesimal time step s fd drag force n k time dependent coefficient kg m 1 λ model scale ratio lbp length between perpendiculars m lwl length of waterline m υ kinematic viscosity n s m 2 displacement volume m3 ρ density of water kg m 3 p pressure n m 2 s wetted hull surface area m2 tfinal total time of the selected manoeuvre s u v w fluid velocity components vacc ship s speed in acceleration m s 1 vstop ship s speed in stopping m s 1 xacc distance in acceleration m xadv advance distance m xstop distance in stopping m y dimensionless wall distance bcs boundary conditions cf correction factor cfd computational fluid dynamics dms direct manoeuvring simulation dtmb david taylor model basin fr froude number fs factors of safety gci grid convergence index hf mansys high fidelity cfd based empirical manoeuvring system method iihr institute of iowa hydraulic research ittc international towing tank conference imo international maritime organization nmri national maritime research institute nutts numerical towing tank symposium rans reynolds averaged navier stokes simman workshop on verification and validation of ship manoeuvring simulation methods vof volume of fluid 1 introduction prediction of a ship s trajectory during a manoeuvring motion is mainly based on mathematical models that have both dynamic and kinematic terms of equations of motion these equations of motion were successfully applied and adapted to ship manoeuvring problems by norrbin 1960 abkowitz 1964 burcher 1991 these and similar methods are generally called the hydrodynamic derivative methods due to the mathematical approach applied in the computations although these models can perform manoeuvring motions in different operating conditions the ship s response to the environmental forces such as wave wind current forces has to be reduced to a number of terms obtained under certain assumptions computation time can thus be saved by using closed form solutions for certain types of manoeuvres regression analysis is one of the most common techniques used for predicting the expected behaviour of a ship this analysis has been applied to different problems in ship hydrodynamics for instance a well known regression study was conducted by holtrop and mennen 1982 to calculate the total drag of a displacement hull and was improved to get a better wave drag prediction by holtrop 1984 empirical formulas have also been developed to determine the linear hydrodynamic derivatives used in the differential manoeuvring theory by processing the experimental results performed for a number of different hull forms smitt 1970 norrbin 1971 inoue et al 1981 ankudinov 1987 kijima et al 1993 in recent years cfd computational fluid dynamics has emerged as a useful and powerful method for use in ship manoeuvring problems the number of regular workshops on cfd have begun to increase and their contents have been gradually enriched simman 2008 simman 2014 nmri 2015 nutts 2019 the solution of the fully turbulent viscous flow around a 3 dimensional floating body has become possible to apply on a moderately equipped computer even under free surface effects with the verification techniques developed for computational analysis cfd has become individually feasible and acceptable even in the absence of experimental results since the beginning of the 21st century roache 1994 stern et al 2001 phillips and roy 2014 xing and stern 2010 duman and bal 2017 used an unsteady rans method to obtain the manoeuvring coefficients of dtmb5415 via virtual static drift and rudder drift simulations certain manoeuvres of a tanker ship kvlcc2 and a surface combatant dtmb5415 were realized with a 3 dof modular mathematical model for manoeuvring simulations mansim in sukas et al 2019a hydrodynamic derivatives of a surface combatant were predicted by sukas et al 2019b using the unsteady rans approach at moderate speeds a high fidelity cfd based empirical manoeuvring system method hf mansys was presented by duman and bal 2019 they used this technique to predict the performance parameters of the turning circle with two parameters ship advance speed and rudder angle the results of the empirical approach showed good accuracy with those of direct manoeuvring simulation dms based on cfd wang and wan 2020 used an in house cfd solver naoe foam sjtu to simulate the stopping manoeuvre of a tanker ship kvlcc1 associated with the overset grid technique in this study closed form analytical solutions based on basic mechanical principles are derived to predict the manoeuvring performance parameters of a navy ship a guided missile destroyer hull form dtmb5415 at model scale has been chosen to validate the results two approaches have been adopted analytical cfd closed form solution based on cfd drag values and analytical holtrop closed form solution based on holtrop s method for drag values they are named according to the total drag forces calculation technique fast calculations with drag forces have yielded significantly close results to the experimental ones in which the resistance values were obtained from the experiments the closed solution approach has also been applied to a commercial ship and the stopping manoeuvre parameters have been estimated in accordance with the free trial manoeuvre tests 2 mathematical models a guided missile destroyer form dtmb5415 hull has been chosen for validation a 3 048m long model at the scale ratio of 46 588 has been selected the model was constructed by the iihr iowa institute of hydraulic research and used in many experimental and computational studies hull geometry is shown both from perspective and bottom views in fig 1 in 3 dimensional form it is a displacement type of hull with a sonar dome continuous bilge keels on both sides and a transom stern the principal particulars of the hull are given in table 1 with the full scale values 2 1 numerical details 2 1 1 computational domain and boundary conditions in an adequately large domain resistance tests have been simulated by implementing the overset grid technique although a method such as the overset grid structure is necessary for large amplitude movements it has been observed in a previous study that it gives compatible results with the rigid network structure in stationary solutions duman et al 2017a the multi phase fluid flow enters the computational domain via inlet faces which are front bottom and top faces during the cfd simulations while the side faces are assigned as symmetrical boundaries two types of inlet velocity methods are commonly used in cfd analysis according to the flow direction via inlet boundaries 1 flow speed in vector form on a specific coordinate system and 2 flow in the normal direction to the inlet surfaces with a predefined magnitude of flow speed the first method is applied to the inlet surfaces in this study the vector of flow speed is set in the direction of the longitudinal axis of the vessel since the flow speed vector is orthogonal to the surface normal vector there is no actual entry into the computational domain from the top and bottom surfaces the flow velocity and direction on these boundary surfaces are the same as on the inlet boundary front surface and there is a parallel stream to the fluid flow throughout the volume the purpose of this application is to create an infinite volume effect in the top and bottom directions finally the back face is considered as a pressure outlet fig 2 in order to provide a consistent solution in cfd analysis either a constant pressure is set at the outlet by assigning a flow rate to the inlet or a flow rate is assigned to the outlet by predetermining the pressure of the flow at the inlet the first option is applied to the pressure outlets i e the pressure value on the outlet boundary is set to a fixed value the acceleration and stopping manoeuvres have also been executed by the direct manoeuvring simulation dms technique to provide comparison data for the analytical solutions in the acceleration manoeuvre the ship starts from zero speed with a constant thrust that is equal to the drag of the hull at the target speed of 2 242 m s which corresponds to the maximum operational condition of dtmb5415 domain dimensions in ship length are given in table 2 for resistance and direct manoeuvring simulations the only difference in dimensions is the total length of the computational domain in direct manoeuvres downstream is 1 5 l lower than the length taken in resistance simulations because the ship is allowed to move forward i e there is no fluid flow in the inlet outlet direction all bcs are shown in fig 2 for acceleration simulations where the inlet velocities are set to zero and others remain the same as the ship moves forward by the thrust forces acting on the hull deformed waves spread in all three dimensions since the velocities are always zero on the surfaces defined as inlet there is no input to affect the motion when the radiated diagonal waves reach the symmetry limits on the port and starboard sides the same features occur in the form of mirror symmetry on the other sides of the surfaces without any reflection back when the dimensions of calculation volume are changed according to the main dimensions given in table 2 and the entry speeds are revised as the ship s forward speed resistance analyses are performed with the same boundary conditions the chimera or overset grid approach has been adopted for the cfd simulations in this approach the computational domain is constructed from two overlapping regions one of them covers the whole field and the other is the overset region that moves simultaneously with the vessel the cells in the overset region do not have any deformation during the simulation which enables the examination of large amplitude motions the grid cells are classified into several types such as active passive donor etc the flow information is transferred between the overset region boundaries and the background region cells through those cells benek et al 1986 the grid cells located in both regions are called active cells where the governing equations are solved indicated with the blue background and the white overset colours in fig 3 and fig 4 the first layer of passive cells next to active cells are called acceptors shown with red colour and the green coloured cells stand for the donors 2 1 2 numerical details the resistance simulations have been performed under free surface effects by implementing the volume of fluid vof method the free water surface is assumed to be undisturbed before starting the simulations the computational domain is governed by the continuity equation 1 and the well known navier stokes n s momentum equations given below reynolds averaging procedure is applied to convert n s equations into a numerically solvable state which is called rans reynolds averaged n s equations equation 2 as the last step reynolds stresses equation 3 appeared in the rans equations are calculated using a two equation turbulence model to close the numerical solution the segregated solution method is chosen to solve the algebraic equations for different velocity components u v and w for the 3 d case sequentially with a guessed pressure field or a field determined from a given velocity field tao et al 2004 the numerical procedure continues with the pressure correction and the solution of the turbulence equations karki and patankar 1989 reynolds stresses are solved by implementing the realizable k epsilon turbulence model with the near wall treatment the dimensionless wall distance y is set to be between 30 and 300 to ensure that the wall function is used around the no slip surfaces the time step is determined according to the ittc s recommendations for cfd simulations ittc 2011 1 u i x i 0 2 u i t u j u i x j u i u j x j 1 ρ p x j τ i j x j 3 τ i j ν u i x j u j x i 2 1 3 grid resolution according to the previous uncertainty analysis presented in duman and bal 2019 medium grid quality has been adopted for the resistance analyses acceleration and stopping manoeuvres the grid structure is totally the same in the near wall field while it has slight differences in shape on the free water surface between resistance simulations and predefined manoeuvre types structured grid layers have been generated in the vicinity of the no slip wall boundaries fig 5 left side kelvin wave adopted grid shape has been used in the resistance simulations to reduce the computational cost by using not a rectangular volume shape fig 5 right side still this type of grid generation has been applied to the acceleration and stopping manoeuvres presented in fig 6 here the free surface grid structure is presented overlapped with the kelvin wave pattern that was occurred when the ship reached the target speed in the acceleration manoeuvre to provide a better view of the wave spreading over the grid the vertical lines indicate the starting position at the right side of fig 6 and the final position where the target speed is reached at the left side of fig 6 respectively the centreline has been drawn to illustrate the straight path the ship travelled fig 6 total grid cell numbers are approximately 1 6 m in both types of cfd simulations in which the distribution of dense grid areas has been rearranged according to the importance of the physical case the two level kelvin type of volume shape see fig 5 right has been reduced to one level and these cells have been distributed to the expected straight path of the hull fig 6 total solver cpu times for the resistance and direct manoeuvring simulations are about 12 h and 28 h on a 10 dual core 20 processing units and 64gb ram workstation respectively the convergence of the hydrodynamic forces for each resistance simulation on the other hand is achieved in approximately 6 h which is almost half of the full solution time it is shown in fig 12 that residual values are gradually decreasing and remain low starting from about half of the solution time although the time spent for the estimation of resistance values and the total solution time for dynamic manoeuvre analysis seems to be equal for a single case the closed solution approach with resistance values by cfd will be much more effective in terms of time if different scenarios are repeated it should also be mentioned that the acceleration and stopping manoeuvres have been simulated under restricted motions except for the forward motion 2 2 analytical solution the presented method is mainly based on the following flow diagram fig 7 the main particulars of the ship hull and total resistance values are provided as inputs solution algorithm starts with processing manually that reads total resistance coefficients the polynomial curve fitting technique of fifth order is applied to calculate the interval values of total resistance coefficients in the iterative solution in fact the closed form solution is reduced to an algebraic equation to predict the advance distance and the elapsed time for the acceleration and stopping manoeuvres by going one step further in order to obtain the dynamics of the motion e g the rate of change of speed or traveling distance from the starting position the manoeuvring motions acceleration and stopping are divided into time steps and the next position and speed is calculated by using the previously calculated resistance values via cfd and or holtrop methods the derivation of these closed formulas from the basic mechanical principles is given in the following subsections 2 2 1 acceleration the acceleration calculations are based on newton s second law during acceleration of ship from v0 initial velocity to v target velocity the total force acting on the ship in the x direction i e thrust t generated by propellers minus the total drag force of ship fd including viscous wave air wind if exists etc is equal to displacement mass including added mass mx times acceleration fig 8 4 f x t f d δ m x δ a δ d v d t added mass mx in the surge motion is assumed to be equal to 5 of the total displacement as proposed by clarke et al 1983 total drag of ship can be written as 5 f d 1 2 ρ s c d k v 2 here k is a constant or can be taken as a time dependent function and be calculated by holtrop s method or cfd based approaches if k in other words cd is taken as constant with an average value between v and v0 velocities equation 4 can then be rewritten as 6 t k v 2 δ d v d t δ v d v d x if equation 6 is re arranged by applying the change of variables technique the integration of equation 7 yields the advance distance in an acceleration manoeuvre equation 8 7 0 x d x v 1 v 2 δ v d v t k v 2 η η 1 η 2 δ d η 2 k η 8 x δ 2 k ln η 2 ln η 1 if equation 6 is solved with respect to time equation 9 the time required to accelerate from v0 to v can be calculated as in equation 10 9 d t δ d v t k v 2 δ k d v v 2 t k 10 t δ k tanh 1 v t k t k v 0 v the advancing distance during this acceleration can be given as 11 s v v 0 t 2 if k is taken as a time dependent the advancing velocity and distance covered by the ship during this time can be calculated for each time step from the following equations 12 v a c c t t k tanh t k t k δ 13 x a c c t δ t x a c c t v a c c t δ t 2 2 2 stopping if the ship has an initial speed v0 without any propulsive forces t 0 newton s second law can be applied to model the stopping manoeuvre fig 8 the total drag forces fd during the stopping of the ship can be calculated as similar to the acceleration case except without a thrust force as follows 14 f x f d δ m x δ a δ d v d t by using equation 5 this differential equation can be solved as 15 d v d t k δ v 2 v 0 v d v v 2 k δ 0 t d t 16 v s t o p t v 0 1 α t α k δ v 0 since k is assumed as a constant α is then a constant it should be noted that in stopping manoeuvres if k is assumed as a time dependent value it can be calculated by using the total drag coefficients obtained from cfd analyses or holtrop s empirical approach for each time step and the stopping distance can be computed from the following equation 17 x s t o p t δ t x s t o p t v s t o p t δ t 3 results and discussion 3 1 verification and validation 3 1 1 numerical uncertainty a detailed verification study for the cfd analyses was conducted in a previous study duman and bal 2019 three different verification techniques namely grid convergence index gci correction factor cf and factors of safety fs were implemented to determine the uncertainties in the computations accordingly the total numerical uncertainty was reported as 15 93 it was also stated that the spatial convergence was monotonic while the temporal was oscillatory detailed information about the verification procedure can be found in the related references roache 1994 stern et al 2001 celik et al 2008 xing and stern 2010 phillips and roy 2014 3 1 2 validation of drag force in the present study it is first compared the results by holtrop s method with the available experimental and numerical data before using it as input to the analytical solution holtrop s method has been used here to get very quick results for manoeuvring calculations the test data was measured by ship model experiments conducted at the iihr s facility yoon 2009 cfd results have been calculated by using the same grid structure that was used in duman and bal 2019 the results by holtrop s method are found to be higher than the experiments for the overall range of froude numbers fig 9 however the trend of the total drag versus advancing speed matches the high fidelity results and the experiments fig 9 another point to be explained here is that the difference between cfd and experiments has increased for fr 0 20 fig 9 at very low speeds the wavelengths and wave amplitudes generated by the ship decrease in proportion to the square of the advance speed and as a result of this very high grid quality is required to capture the free surface deformations it should also be noted that cfd yields closer results to experiments than those of the empirical holtrop s method even at low speeds table 3 the average relative errors for the presented speed interval are calculated as 7 63 and 19 16 with cfd and holtrop s method respectively visual data extracted from the cfd simulations have been presented in the following figures the pressure coefficient distributions on the bow and the aft part of the hull have been found well captured there is a high pressure field where the fluid flow meets the sonar dome and a low pressure field around the camber of the same geometry fig 10 in addition to being well shaped the maximum values of the wave crest and the wave trough are also compatible with the previous study duman et al 2017b fig 11 the convergence of total resistance with physical time has been plotted in fig 12 resistance predictions with cfd have been performed under free to sinkage and trim conditions a common technique for having a stable computation has been applied according to this seakeeping motions are kept still for a 50 time step long then the ship model is released with suppressed hydrodynamic forces for another 100 time step long period the calculations continue in their normal course at the end of the 150 time step period 3 s of physical solution time 3 2 acceleration and stopping the maximum speed both in acceleration and stopping manoeuvres is chosen as 2 242 m s which corresponds to the maximum operational condition of dtmb5415 hull form simman 2014 the acceleration has been performed by starting from the zero speed with a constant thrust that is equal to the force calculated by using the thrust deduction factor that was presented in duman et al 2017b and the total drag resistance of the hull at that target speed the interactions between the propulsion unit and the hull have been limited to this thrust deduction coefficient in the present study to simplify the model and facilitate the comparison the effects of environmental factors wave current wind are not included and a solution has been provided through basic mechanics in fig 13 and fig 16 x adv is the nondimensional traveling distance xadv lbp from the starting position in both acceleration and stopping manoeuvres and t is the nondimensional time obtained by multiplying the dimensional time t by the target speed and dividing it by the length between perpendiculars t v lbp the advancing distance and speed during the acceleration manoeuvre in analytical solutions have been found significantly similar to each other in the analytical holtrop approach the ship reaches its maximum speed of 2 2409 m s in 26 02 s she travels about 48 2225 m while this distance is found as 47 3767 m by the analytical cfd approach and it takes 26 4 s fig 13 and fig 14 if the total drag values are changed by the experiments the advance distance is calculated as 47 6756 m for travel of 26 6 s in the legends of these figures analytical cfd means that analytical closed form solutions are based on drag forces computed by cfd similarly analytical holtrop and analytical experiment represent the analytical solutions based on drag forces calculated by holtrop s method and experiments respectively it can be noted that the acceleration distance and time calculated by the analytical cfd solution is almost the same as those of the analytical experiment but the differences between cfd and holtrop s method are also very small in the dms the ship reaches its maximum speed of 2 2409 m s in 26 01 s and she travels about 45 8577 m in the dms simulations mentioned here the ship model is forced into a single degree of freedom motion and movements in other directions are restricted thrust on the other hand was calculated using the total resistance and thrust reduction coefficient as described in the closed solution calculations and was implemented by the propeller position as a singular force the initial velocities in the direct acceleration and stopping manoeuvres were set to zero speed fr 0 and the approach speed fr 0 41 respectively since the full domain is used in dynamic manoeuvre analysis and the boat is released into forwarding motion it would be necessary to create fine meshes throughout the entire domain in order to measure heave and pitch motions which will prolong the solution time so the seakeeping motions are restricted and the squat effects have not been studied the fact that the final travelled distance of the analytical cfd is closer to the dms results than other solutions in the acceleration manoeuvre supports that the closed solution formulas work well in estimating the manoeuvre parameters both dms and analytical cfd have very similar trends with the analytical experiment results considering the solution times and the flexibility of setting up a numerical solution for each advance speed fast response analytic cfd can be preferred over dms selecting the analytical holtrop method at the preliminary design stage when only the main dimensions are available and the hull form is not completely featured will make it possible to obtain practical and reliable results in a very short time table 4 the normal procedure has been followed during the stopping manoeuvre the thrust forces acting on the ship model that is traveling at the speed of 2 242 m s are cut off zero thrust force is applied and the ship is allowed to move in the longitudinal direction until her speed falls below 0 2261 m s which corresponds to 3 knots at full scale in the analytic cfd approach using the drag coefficients calculated with cfd the stopping criterion is achieved at a longer time 69 8 s and a longer distance 47 9292 m the normal stopping manoeuvre is completed in 76 5 s after the ship travels 48 3231 m by the analytic holtrop approach if the experimental drag values are used to simulate the normal stopping manoeuvre 98 2 s and 59 5891 m advance distance is needed to achieve the stop note that the analytic experiment approach gives the longest distance and time in a normal stopping manoeuvre table 4 as it is known drag forces at low speeds are overpredicted by cfd due to the assumptions made to represent the turbulence in the boundary layer that occurs around the no slip wall which causes fast stopping characteristics fig 15 and fig 16 in the preliminary design phase it should be taken into consideration that the cfd results that are safe while performing power calculations may have an adverse effect during the manoeuvre however the presented method gives reasonably accurate results in addition to providing quick solutions and being cost effective it is also seen that there are no considerable differences between dms and analytic cfd stopping manoeuvre results as similar to the acceleration manoeuvre the stopping distance and elapsed time have also been calculated by selecting the following options passenger car ferry diesel machinery and 100 200 m ship length imo 2002 which is the closest sample ship to the current ship form with the formula proposed by imo and the results were compared with these values according to imo s recommendation non dimensional stopping distance can be calculated with equation 18 where a b and c are empirical coefficients 18 s a l o g e 1 b c since the ship which is examined has a full length in the range of 100 200 m calculations have been made as lower and upper limits separately for 100 m and 200 m which means coefficient c takes two different values that are 2 3 and 1 1 coefficient a and b have been considered as 8 9 and 0 6 1 0 respectively as given in the imo s report the stopping distances have been calculated as 4 86 and 8 53 ship length for the lower and upper limits which is found as parallel with analytical solutions in the analytic cfd holtrop experiment the stopping distances have been predicted as 15 7 15 8 and 19 54 in ship length respectively the stopping distance of dtmb5415 has also been calculated as 32 l by a similar closed form approach which is presented in bertram 2012 where the analytical formulas can be used for a stepwise computation of the stopping manoeuvre here the advance speed ut that the ship would have after a long time if the thrust is provided in the forwarding direction as described in the related reference is assumed to be zero the analytical approach has also been applied to a model ship that has experimental stopping manoeuvre results that can be used for comparison the ship model hull has a length between perpendiculars of 7 243 m the analytical solution has been used to calculate the stopping distance and the elapsed time of the ship model during the stopping manoeuvre starting from 1 76 m s to 0 49 m s as recorded in the experiments here experimental resistance values of the ship model see table 5 that were fitted to a polynomial curve have been used in each time step this method is named as analytic experiment the travelled distance of the ship has been calculated as 12 2 l with the analytical solution which was reported as 11 8 l in the experiments in the closed solution where the propeller effects were not included the stopping distance was slightly higher than in the experiment including the propeller resistance to the solution may cause a decrease in traveling distance and make the result much closer to the experimental result the resistance results of the ship model that have been used in the closed solution are given in table 4 and plotted in fig 17 since the ship model cannot be shared due to commercial reasons this example contains only the final results of the stopping manoeuvre however examples can easily be expanded using the open access hull forms and applying analytic cfd and or analytic holtrop methods to them 4 conclusions recently advances in high fidelity cfd based methods have offered cfd as a good alternative to generate comparison data to be used in the development of fast responding solution methods the proliferation of this approach has been a motivation for this study on practical solutions in manoeuvring problems three analytical approaches based on the basic mechanical principles have been derived and used with the experimental computational and empirical inputs to obtain acceleration and stopping manoeuvre performance parameters the results have been compared with those obtained from the analytic experiment approach the results can be summarized as follows the advance distances during the acceleration manoeuvre have been calculated with 3 81 0 62 and 1 14 relative errors by dms analytic cfd and analytic holtrop approaches respectively the stopping distances have been predicted with 24 75 19 56 and 18 90 relative errors by dms analytic cfd and analytic holtrop approaches respectively the velocities versus time in both acceleration and stopping manoeuvres have been found to have very similar characteristics it can be noted that the analytic cfd method can be used as relatively fast and reliable at the preliminary design phase due to including viscous effects and providing fast response when compared with the dms technique the use of the holtrop method will be effective in obtaining fast results in case there is a very limited time for the solution especially at the preliminary design stage successful predictions have been made for a model ship that has experimental resistance values analytic experiment approach and for a commercial ship with free trial data note also that the closed form solutions here are the basics they can be easily applied to a different set of propulsion and control devices for slow speeds up to froude numbers 0 25 since viscous forces are dominant on total resistance it is preferred to use cfd instead of a potential flow solver moreover in an analytical solution initial and target values are generally used to find the ultimate parameters while the interval changes are provided by applying an iterative approach in this study the effect of rudders on the other hand do not have any significant effects on the stopping manoeuvre when they are located behind the reverse propellers bertram 2012 recent studies showed that cfd is a powerful method that can be used to predict the viscous flow around any arbitrary shaped floating body under different physical conditions wall functions are highly capable of predicting the shear forces on a no slip boundary therefore the cfd method has been used instead of potential based solution methods considering that empirical formulas are more general and do not fully reflect hull form features closed solutions that take hull characteristics as input are considered to be more reliable it is found that the stepwise closed solution approach has yielded successful results as well as the short computation time with the provided resistance values in future studies the effects of propeller and appendages will be included in acceleration and stopping manoeuvres and physical conditions will be enhanced in addition practical approaches will be developed for other types of manoeuvre as well and formulations needed in the preliminary design phase will be derived credit authorship contribution statement suleyman duman investigation software validation writing original draft visualization data curation sakir bal investigation conceptualization methodology supervision project administration writing review editing resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors thank prof m a baykal from gedik university for providing the experimental drag values of a model ship given in fig 17 this study was carried out as a part of süleyman duman s doctoral thesis he is supported by the scientific and technological research council of turkey tübi̇tak under the national doctoral scholarship 2211 a and by itu project unit itu bap project no 42196 
20527,in this study the acceleration and stopping manoeuvres of a bare hull surface combatant have practically been predicted by closed form analytical solutions derived from basic mechanical principles they have also been simulated directly by an unsteady rans reynolds averaged navier stokes solver with overset grid structure to compare the results with those of closed form approaches a well known surface combatant model dtmb5415 has been chosen for validation the instantaneous drag forces of the model ship in the acceleration and stopping manoeuvres have been provided by both cfd and holtrop s methods it has been observed that the results by analytical solutions have a good match with those of the manoeuvring simulations based on unsteady rans solver successful predictions have also been made consistent with the results obtained when experimental resistance values are used in analytical solutions it has been concluded that the closed form solution methods yield practically satisfactory results in a very short time when a fast resistance prediction method such as holtrop s method or cfd is used keywords ship manoeuvring acceleration stopping cfd analytical solution nomenclature α acceleration m s 2 bm beam moulded m bwl beam at waterline m cb block coefficient cd drag coefficient ct cfd total drag coefficient by cfd ct exp total drag coefficient by experiments ct h total drag coefficient by holtrop cm midship coefficient δ displacement kg δt infinitesimal time step s fd drag force n k time dependent coefficient kg m 1 λ model scale ratio lbp length between perpendiculars m lwl length of waterline m υ kinematic viscosity n s m 2 displacement volume m3 ρ density of water kg m 3 p pressure n m 2 s wetted hull surface area m2 tfinal total time of the selected manoeuvre s u v w fluid velocity components vacc ship s speed in acceleration m s 1 vstop ship s speed in stopping m s 1 xacc distance in acceleration m xadv advance distance m xstop distance in stopping m y dimensionless wall distance bcs boundary conditions cf correction factor cfd computational fluid dynamics dms direct manoeuvring simulation dtmb david taylor model basin fr froude number fs factors of safety gci grid convergence index hf mansys high fidelity cfd based empirical manoeuvring system method iihr institute of iowa hydraulic research ittc international towing tank conference imo international maritime organization nmri national maritime research institute nutts numerical towing tank symposium rans reynolds averaged navier stokes simman workshop on verification and validation of ship manoeuvring simulation methods vof volume of fluid 1 introduction prediction of a ship s trajectory during a manoeuvring motion is mainly based on mathematical models that have both dynamic and kinematic terms of equations of motion these equations of motion were successfully applied and adapted to ship manoeuvring problems by norrbin 1960 abkowitz 1964 burcher 1991 these and similar methods are generally called the hydrodynamic derivative methods due to the mathematical approach applied in the computations although these models can perform manoeuvring motions in different operating conditions the ship s response to the environmental forces such as wave wind current forces has to be reduced to a number of terms obtained under certain assumptions computation time can thus be saved by using closed form solutions for certain types of manoeuvres regression analysis is one of the most common techniques used for predicting the expected behaviour of a ship this analysis has been applied to different problems in ship hydrodynamics for instance a well known regression study was conducted by holtrop and mennen 1982 to calculate the total drag of a displacement hull and was improved to get a better wave drag prediction by holtrop 1984 empirical formulas have also been developed to determine the linear hydrodynamic derivatives used in the differential manoeuvring theory by processing the experimental results performed for a number of different hull forms smitt 1970 norrbin 1971 inoue et al 1981 ankudinov 1987 kijima et al 1993 in recent years cfd computational fluid dynamics has emerged as a useful and powerful method for use in ship manoeuvring problems the number of regular workshops on cfd have begun to increase and their contents have been gradually enriched simman 2008 simman 2014 nmri 2015 nutts 2019 the solution of the fully turbulent viscous flow around a 3 dimensional floating body has become possible to apply on a moderately equipped computer even under free surface effects with the verification techniques developed for computational analysis cfd has become individually feasible and acceptable even in the absence of experimental results since the beginning of the 21st century roache 1994 stern et al 2001 phillips and roy 2014 xing and stern 2010 duman and bal 2017 used an unsteady rans method to obtain the manoeuvring coefficients of dtmb5415 via virtual static drift and rudder drift simulations certain manoeuvres of a tanker ship kvlcc2 and a surface combatant dtmb5415 were realized with a 3 dof modular mathematical model for manoeuvring simulations mansim in sukas et al 2019a hydrodynamic derivatives of a surface combatant were predicted by sukas et al 2019b using the unsteady rans approach at moderate speeds a high fidelity cfd based empirical manoeuvring system method hf mansys was presented by duman and bal 2019 they used this technique to predict the performance parameters of the turning circle with two parameters ship advance speed and rudder angle the results of the empirical approach showed good accuracy with those of direct manoeuvring simulation dms based on cfd wang and wan 2020 used an in house cfd solver naoe foam sjtu to simulate the stopping manoeuvre of a tanker ship kvlcc1 associated with the overset grid technique in this study closed form analytical solutions based on basic mechanical principles are derived to predict the manoeuvring performance parameters of a navy ship a guided missile destroyer hull form dtmb5415 at model scale has been chosen to validate the results two approaches have been adopted analytical cfd closed form solution based on cfd drag values and analytical holtrop closed form solution based on holtrop s method for drag values they are named according to the total drag forces calculation technique fast calculations with drag forces have yielded significantly close results to the experimental ones in which the resistance values were obtained from the experiments the closed solution approach has also been applied to a commercial ship and the stopping manoeuvre parameters have been estimated in accordance with the free trial manoeuvre tests 2 mathematical models a guided missile destroyer form dtmb5415 hull has been chosen for validation a 3 048m long model at the scale ratio of 46 588 has been selected the model was constructed by the iihr iowa institute of hydraulic research and used in many experimental and computational studies hull geometry is shown both from perspective and bottom views in fig 1 in 3 dimensional form it is a displacement type of hull with a sonar dome continuous bilge keels on both sides and a transom stern the principal particulars of the hull are given in table 1 with the full scale values 2 1 numerical details 2 1 1 computational domain and boundary conditions in an adequately large domain resistance tests have been simulated by implementing the overset grid technique although a method such as the overset grid structure is necessary for large amplitude movements it has been observed in a previous study that it gives compatible results with the rigid network structure in stationary solutions duman et al 2017a the multi phase fluid flow enters the computational domain via inlet faces which are front bottom and top faces during the cfd simulations while the side faces are assigned as symmetrical boundaries two types of inlet velocity methods are commonly used in cfd analysis according to the flow direction via inlet boundaries 1 flow speed in vector form on a specific coordinate system and 2 flow in the normal direction to the inlet surfaces with a predefined magnitude of flow speed the first method is applied to the inlet surfaces in this study the vector of flow speed is set in the direction of the longitudinal axis of the vessel since the flow speed vector is orthogonal to the surface normal vector there is no actual entry into the computational domain from the top and bottom surfaces the flow velocity and direction on these boundary surfaces are the same as on the inlet boundary front surface and there is a parallel stream to the fluid flow throughout the volume the purpose of this application is to create an infinite volume effect in the top and bottom directions finally the back face is considered as a pressure outlet fig 2 in order to provide a consistent solution in cfd analysis either a constant pressure is set at the outlet by assigning a flow rate to the inlet or a flow rate is assigned to the outlet by predetermining the pressure of the flow at the inlet the first option is applied to the pressure outlets i e the pressure value on the outlet boundary is set to a fixed value the acceleration and stopping manoeuvres have also been executed by the direct manoeuvring simulation dms technique to provide comparison data for the analytical solutions in the acceleration manoeuvre the ship starts from zero speed with a constant thrust that is equal to the drag of the hull at the target speed of 2 242 m s which corresponds to the maximum operational condition of dtmb5415 domain dimensions in ship length are given in table 2 for resistance and direct manoeuvring simulations the only difference in dimensions is the total length of the computational domain in direct manoeuvres downstream is 1 5 l lower than the length taken in resistance simulations because the ship is allowed to move forward i e there is no fluid flow in the inlet outlet direction all bcs are shown in fig 2 for acceleration simulations where the inlet velocities are set to zero and others remain the same as the ship moves forward by the thrust forces acting on the hull deformed waves spread in all three dimensions since the velocities are always zero on the surfaces defined as inlet there is no input to affect the motion when the radiated diagonal waves reach the symmetry limits on the port and starboard sides the same features occur in the form of mirror symmetry on the other sides of the surfaces without any reflection back when the dimensions of calculation volume are changed according to the main dimensions given in table 2 and the entry speeds are revised as the ship s forward speed resistance analyses are performed with the same boundary conditions the chimera or overset grid approach has been adopted for the cfd simulations in this approach the computational domain is constructed from two overlapping regions one of them covers the whole field and the other is the overset region that moves simultaneously with the vessel the cells in the overset region do not have any deformation during the simulation which enables the examination of large amplitude motions the grid cells are classified into several types such as active passive donor etc the flow information is transferred between the overset region boundaries and the background region cells through those cells benek et al 1986 the grid cells located in both regions are called active cells where the governing equations are solved indicated with the blue background and the white overset colours in fig 3 and fig 4 the first layer of passive cells next to active cells are called acceptors shown with red colour and the green coloured cells stand for the donors 2 1 2 numerical details the resistance simulations have been performed under free surface effects by implementing the volume of fluid vof method the free water surface is assumed to be undisturbed before starting the simulations the computational domain is governed by the continuity equation 1 and the well known navier stokes n s momentum equations given below reynolds averaging procedure is applied to convert n s equations into a numerically solvable state which is called rans reynolds averaged n s equations equation 2 as the last step reynolds stresses equation 3 appeared in the rans equations are calculated using a two equation turbulence model to close the numerical solution the segregated solution method is chosen to solve the algebraic equations for different velocity components u v and w for the 3 d case sequentially with a guessed pressure field or a field determined from a given velocity field tao et al 2004 the numerical procedure continues with the pressure correction and the solution of the turbulence equations karki and patankar 1989 reynolds stresses are solved by implementing the realizable k epsilon turbulence model with the near wall treatment the dimensionless wall distance y is set to be between 30 and 300 to ensure that the wall function is used around the no slip surfaces the time step is determined according to the ittc s recommendations for cfd simulations ittc 2011 1 u i x i 0 2 u i t u j u i x j u i u j x j 1 ρ p x j τ i j x j 3 τ i j ν u i x j u j x i 2 1 3 grid resolution according to the previous uncertainty analysis presented in duman and bal 2019 medium grid quality has been adopted for the resistance analyses acceleration and stopping manoeuvres the grid structure is totally the same in the near wall field while it has slight differences in shape on the free water surface between resistance simulations and predefined manoeuvre types structured grid layers have been generated in the vicinity of the no slip wall boundaries fig 5 left side kelvin wave adopted grid shape has been used in the resistance simulations to reduce the computational cost by using not a rectangular volume shape fig 5 right side still this type of grid generation has been applied to the acceleration and stopping manoeuvres presented in fig 6 here the free surface grid structure is presented overlapped with the kelvin wave pattern that was occurred when the ship reached the target speed in the acceleration manoeuvre to provide a better view of the wave spreading over the grid the vertical lines indicate the starting position at the right side of fig 6 and the final position where the target speed is reached at the left side of fig 6 respectively the centreline has been drawn to illustrate the straight path the ship travelled fig 6 total grid cell numbers are approximately 1 6 m in both types of cfd simulations in which the distribution of dense grid areas has been rearranged according to the importance of the physical case the two level kelvin type of volume shape see fig 5 right has been reduced to one level and these cells have been distributed to the expected straight path of the hull fig 6 total solver cpu times for the resistance and direct manoeuvring simulations are about 12 h and 28 h on a 10 dual core 20 processing units and 64gb ram workstation respectively the convergence of the hydrodynamic forces for each resistance simulation on the other hand is achieved in approximately 6 h which is almost half of the full solution time it is shown in fig 12 that residual values are gradually decreasing and remain low starting from about half of the solution time although the time spent for the estimation of resistance values and the total solution time for dynamic manoeuvre analysis seems to be equal for a single case the closed solution approach with resistance values by cfd will be much more effective in terms of time if different scenarios are repeated it should also be mentioned that the acceleration and stopping manoeuvres have been simulated under restricted motions except for the forward motion 2 2 analytical solution the presented method is mainly based on the following flow diagram fig 7 the main particulars of the ship hull and total resistance values are provided as inputs solution algorithm starts with processing manually that reads total resistance coefficients the polynomial curve fitting technique of fifth order is applied to calculate the interval values of total resistance coefficients in the iterative solution in fact the closed form solution is reduced to an algebraic equation to predict the advance distance and the elapsed time for the acceleration and stopping manoeuvres by going one step further in order to obtain the dynamics of the motion e g the rate of change of speed or traveling distance from the starting position the manoeuvring motions acceleration and stopping are divided into time steps and the next position and speed is calculated by using the previously calculated resistance values via cfd and or holtrop methods the derivation of these closed formulas from the basic mechanical principles is given in the following subsections 2 2 1 acceleration the acceleration calculations are based on newton s second law during acceleration of ship from v0 initial velocity to v target velocity the total force acting on the ship in the x direction i e thrust t generated by propellers minus the total drag force of ship fd including viscous wave air wind if exists etc is equal to displacement mass including added mass mx times acceleration fig 8 4 f x t f d δ m x δ a δ d v d t added mass mx in the surge motion is assumed to be equal to 5 of the total displacement as proposed by clarke et al 1983 total drag of ship can be written as 5 f d 1 2 ρ s c d k v 2 here k is a constant or can be taken as a time dependent function and be calculated by holtrop s method or cfd based approaches if k in other words cd is taken as constant with an average value between v and v0 velocities equation 4 can then be rewritten as 6 t k v 2 δ d v d t δ v d v d x if equation 6 is re arranged by applying the change of variables technique the integration of equation 7 yields the advance distance in an acceleration manoeuvre equation 8 7 0 x d x v 1 v 2 δ v d v t k v 2 η η 1 η 2 δ d η 2 k η 8 x δ 2 k ln η 2 ln η 1 if equation 6 is solved with respect to time equation 9 the time required to accelerate from v0 to v can be calculated as in equation 10 9 d t δ d v t k v 2 δ k d v v 2 t k 10 t δ k tanh 1 v t k t k v 0 v the advancing distance during this acceleration can be given as 11 s v v 0 t 2 if k is taken as a time dependent the advancing velocity and distance covered by the ship during this time can be calculated for each time step from the following equations 12 v a c c t t k tanh t k t k δ 13 x a c c t δ t x a c c t v a c c t δ t 2 2 2 stopping if the ship has an initial speed v0 without any propulsive forces t 0 newton s second law can be applied to model the stopping manoeuvre fig 8 the total drag forces fd during the stopping of the ship can be calculated as similar to the acceleration case except without a thrust force as follows 14 f x f d δ m x δ a δ d v d t by using equation 5 this differential equation can be solved as 15 d v d t k δ v 2 v 0 v d v v 2 k δ 0 t d t 16 v s t o p t v 0 1 α t α k δ v 0 since k is assumed as a constant α is then a constant it should be noted that in stopping manoeuvres if k is assumed as a time dependent value it can be calculated by using the total drag coefficients obtained from cfd analyses or holtrop s empirical approach for each time step and the stopping distance can be computed from the following equation 17 x s t o p t δ t x s t o p t v s t o p t δ t 3 results and discussion 3 1 verification and validation 3 1 1 numerical uncertainty a detailed verification study for the cfd analyses was conducted in a previous study duman and bal 2019 three different verification techniques namely grid convergence index gci correction factor cf and factors of safety fs were implemented to determine the uncertainties in the computations accordingly the total numerical uncertainty was reported as 15 93 it was also stated that the spatial convergence was monotonic while the temporal was oscillatory detailed information about the verification procedure can be found in the related references roache 1994 stern et al 2001 celik et al 2008 xing and stern 2010 phillips and roy 2014 3 1 2 validation of drag force in the present study it is first compared the results by holtrop s method with the available experimental and numerical data before using it as input to the analytical solution holtrop s method has been used here to get very quick results for manoeuvring calculations the test data was measured by ship model experiments conducted at the iihr s facility yoon 2009 cfd results have been calculated by using the same grid structure that was used in duman and bal 2019 the results by holtrop s method are found to be higher than the experiments for the overall range of froude numbers fig 9 however the trend of the total drag versus advancing speed matches the high fidelity results and the experiments fig 9 another point to be explained here is that the difference between cfd and experiments has increased for fr 0 20 fig 9 at very low speeds the wavelengths and wave amplitudes generated by the ship decrease in proportion to the square of the advance speed and as a result of this very high grid quality is required to capture the free surface deformations it should also be noted that cfd yields closer results to experiments than those of the empirical holtrop s method even at low speeds table 3 the average relative errors for the presented speed interval are calculated as 7 63 and 19 16 with cfd and holtrop s method respectively visual data extracted from the cfd simulations have been presented in the following figures the pressure coefficient distributions on the bow and the aft part of the hull have been found well captured there is a high pressure field where the fluid flow meets the sonar dome and a low pressure field around the camber of the same geometry fig 10 in addition to being well shaped the maximum values of the wave crest and the wave trough are also compatible with the previous study duman et al 2017b fig 11 the convergence of total resistance with physical time has been plotted in fig 12 resistance predictions with cfd have been performed under free to sinkage and trim conditions a common technique for having a stable computation has been applied according to this seakeeping motions are kept still for a 50 time step long then the ship model is released with suppressed hydrodynamic forces for another 100 time step long period the calculations continue in their normal course at the end of the 150 time step period 3 s of physical solution time 3 2 acceleration and stopping the maximum speed both in acceleration and stopping manoeuvres is chosen as 2 242 m s which corresponds to the maximum operational condition of dtmb5415 hull form simman 2014 the acceleration has been performed by starting from the zero speed with a constant thrust that is equal to the force calculated by using the thrust deduction factor that was presented in duman et al 2017b and the total drag resistance of the hull at that target speed the interactions between the propulsion unit and the hull have been limited to this thrust deduction coefficient in the present study to simplify the model and facilitate the comparison the effects of environmental factors wave current wind are not included and a solution has been provided through basic mechanics in fig 13 and fig 16 x adv is the nondimensional traveling distance xadv lbp from the starting position in both acceleration and stopping manoeuvres and t is the nondimensional time obtained by multiplying the dimensional time t by the target speed and dividing it by the length between perpendiculars t v lbp the advancing distance and speed during the acceleration manoeuvre in analytical solutions have been found significantly similar to each other in the analytical holtrop approach the ship reaches its maximum speed of 2 2409 m s in 26 02 s she travels about 48 2225 m while this distance is found as 47 3767 m by the analytical cfd approach and it takes 26 4 s fig 13 and fig 14 if the total drag values are changed by the experiments the advance distance is calculated as 47 6756 m for travel of 26 6 s in the legends of these figures analytical cfd means that analytical closed form solutions are based on drag forces computed by cfd similarly analytical holtrop and analytical experiment represent the analytical solutions based on drag forces calculated by holtrop s method and experiments respectively it can be noted that the acceleration distance and time calculated by the analytical cfd solution is almost the same as those of the analytical experiment but the differences between cfd and holtrop s method are also very small in the dms the ship reaches its maximum speed of 2 2409 m s in 26 01 s and she travels about 45 8577 m in the dms simulations mentioned here the ship model is forced into a single degree of freedom motion and movements in other directions are restricted thrust on the other hand was calculated using the total resistance and thrust reduction coefficient as described in the closed solution calculations and was implemented by the propeller position as a singular force the initial velocities in the direct acceleration and stopping manoeuvres were set to zero speed fr 0 and the approach speed fr 0 41 respectively since the full domain is used in dynamic manoeuvre analysis and the boat is released into forwarding motion it would be necessary to create fine meshes throughout the entire domain in order to measure heave and pitch motions which will prolong the solution time so the seakeeping motions are restricted and the squat effects have not been studied the fact that the final travelled distance of the analytical cfd is closer to the dms results than other solutions in the acceleration manoeuvre supports that the closed solution formulas work well in estimating the manoeuvre parameters both dms and analytical cfd have very similar trends with the analytical experiment results considering the solution times and the flexibility of setting up a numerical solution for each advance speed fast response analytic cfd can be preferred over dms selecting the analytical holtrop method at the preliminary design stage when only the main dimensions are available and the hull form is not completely featured will make it possible to obtain practical and reliable results in a very short time table 4 the normal procedure has been followed during the stopping manoeuvre the thrust forces acting on the ship model that is traveling at the speed of 2 242 m s are cut off zero thrust force is applied and the ship is allowed to move in the longitudinal direction until her speed falls below 0 2261 m s which corresponds to 3 knots at full scale in the analytic cfd approach using the drag coefficients calculated with cfd the stopping criterion is achieved at a longer time 69 8 s and a longer distance 47 9292 m the normal stopping manoeuvre is completed in 76 5 s after the ship travels 48 3231 m by the analytic holtrop approach if the experimental drag values are used to simulate the normal stopping manoeuvre 98 2 s and 59 5891 m advance distance is needed to achieve the stop note that the analytic experiment approach gives the longest distance and time in a normal stopping manoeuvre table 4 as it is known drag forces at low speeds are overpredicted by cfd due to the assumptions made to represent the turbulence in the boundary layer that occurs around the no slip wall which causes fast stopping characteristics fig 15 and fig 16 in the preliminary design phase it should be taken into consideration that the cfd results that are safe while performing power calculations may have an adverse effect during the manoeuvre however the presented method gives reasonably accurate results in addition to providing quick solutions and being cost effective it is also seen that there are no considerable differences between dms and analytic cfd stopping manoeuvre results as similar to the acceleration manoeuvre the stopping distance and elapsed time have also been calculated by selecting the following options passenger car ferry diesel machinery and 100 200 m ship length imo 2002 which is the closest sample ship to the current ship form with the formula proposed by imo and the results were compared with these values according to imo s recommendation non dimensional stopping distance can be calculated with equation 18 where a b and c are empirical coefficients 18 s a l o g e 1 b c since the ship which is examined has a full length in the range of 100 200 m calculations have been made as lower and upper limits separately for 100 m and 200 m which means coefficient c takes two different values that are 2 3 and 1 1 coefficient a and b have been considered as 8 9 and 0 6 1 0 respectively as given in the imo s report the stopping distances have been calculated as 4 86 and 8 53 ship length for the lower and upper limits which is found as parallel with analytical solutions in the analytic cfd holtrop experiment the stopping distances have been predicted as 15 7 15 8 and 19 54 in ship length respectively the stopping distance of dtmb5415 has also been calculated as 32 l by a similar closed form approach which is presented in bertram 2012 where the analytical formulas can be used for a stepwise computation of the stopping manoeuvre here the advance speed ut that the ship would have after a long time if the thrust is provided in the forwarding direction as described in the related reference is assumed to be zero the analytical approach has also been applied to a model ship that has experimental stopping manoeuvre results that can be used for comparison the ship model hull has a length between perpendiculars of 7 243 m the analytical solution has been used to calculate the stopping distance and the elapsed time of the ship model during the stopping manoeuvre starting from 1 76 m s to 0 49 m s as recorded in the experiments here experimental resistance values of the ship model see table 5 that were fitted to a polynomial curve have been used in each time step this method is named as analytic experiment the travelled distance of the ship has been calculated as 12 2 l with the analytical solution which was reported as 11 8 l in the experiments in the closed solution where the propeller effects were not included the stopping distance was slightly higher than in the experiment including the propeller resistance to the solution may cause a decrease in traveling distance and make the result much closer to the experimental result the resistance results of the ship model that have been used in the closed solution are given in table 4 and plotted in fig 17 since the ship model cannot be shared due to commercial reasons this example contains only the final results of the stopping manoeuvre however examples can easily be expanded using the open access hull forms and applying analytic cfd and or analytic holtrop methods to them 4 conclusions recently advances in high fidelity cfd based methods have offered cfd as a good alternative to generate comparison data to be used in the development of fast responding solution methods the proliferation of this approach has been a motivation for this study on practical solutions in manoeuvring problems three analytical approaches based on the basic mechanical principles have been derived and used with the experimental computational and empirical inputs to obtain acceleration and stopping manoeuvre performance parameters the results have been compared with those obtained from the analytic experiment approach the results can be summarized as follows the advance distances during the acceleration manoeuvre have been calculated with 3 81 0 62 and 1 14 relative errors by dms analytic cfd and analytic holtrop approaches respectively the stopping distances have been predicted with 24 75 19 56 and 18 90 relative errors by dms analytic cfd and analytic holtrop approaches respectively the velocities versus time in both acceleration and stopping manoeuvres have been found to have very similar characteristics it can be noted that the analytic cfd method can be used as relatively fast and reliable at the preliminary design phase due to including viscous effects and providing fast response when compared with the dms technique the use of the holtrop method will be effective in obtaining fast results in case there is a very limited time for the solution especially at the preliminary design stage successful predictions have been made for a model ship that has experimental resistance values analytic experiment approach and for a commercial ship with free trial data note also that the closed form solutions here are the basics they can be easily applied to a different set of propulsion and control devices for slow speeds up to froude numbers 0 25 since viscous forces are dominant on total resistance it is preferred to use cfd instead of a potential flow solver moreover in an analytical solution initial and target values are generally used to find the ultimate parameters while the interval changes are provided by applying an iterative approach in this study the effect of rudders on the other hand do not have any significant effects on the stopping manoeuvre when they are located behind the reverse propellers bertram 2012 recent studies showed that cfd is a powerful method that can be used to predict the viscous flow around any arbitrary shaped floating body under different physical conditions wall functions are highly capable of predicting the shear forces on a no slip boundary therefore the cfd method has been used instead of potential based solution methods considering that empirical formulas are more general and do not fully reflect hull form features closed solutions that take hull characteristics as input are considered to be more reliable it is found that the stepwise closed solution approach has yielded successful results as well as the short computation time with the provided resistance values in future studies the effects of propeller and appendages will be included in acceleration and stopping manoeuvres and physical conditions will be enhanced in addition practical approaches will be developed for other types of manoeuvre as well and formulations needed in the preliminary design phase will be derived credit authorship contribution statement suleyman duman investigation software validation writing original draft visualization data curation sakir bal investigation conceptualization methodology supervision project administration writing review editing resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors thank prof m a baykal from gedik university for providing the experimental drag values of a model ship given in fig 17 this study was carried out as a part of süleyman duman s doctoral thesis he is supported by the scientific and technological research council of turkey tübi̇tak under the national doctoral scholarship 2211 a and by itu project unit itu bap project no 42196 
20528,a numerical analysis was conducted on the hydrodynamic characteristics of a deep sea mining vehicle the simulations employed the reynolds stress model rsm to focus on the complicated flow field under three typical motions during the traveling process the fluid separated around the vehicle and the low pressure areas formed behind the vehicle the turbulent kinetic energy was large near the shape edge of the vehicle and transferred downstream along with the flow with the increase of the velocity reynolds number the surface friction coefficient increased and the pressure coefficient decreased which made a large frictional resistance and differential pressure resistance meanwhile although the development processes of the flow field were similar in different motions the spatial hydrodynamic distributions and the changes of the hydrodynamic coefficients also performed differently this study can serve as an important reference for the structure optimization and control system development of the mining vehicle keywords hydrodynamic characteristics deep sea mining vehicle rsm 1 introduction the rich mineral resources on the seafloor have attracted the interest of many countries and organizations in the research of deep sea mining systems and the deep sea mining vehicle is a key component of the system chung 2009 the study of hydrodynamic characteristics can be used to optimize the structure and shape of the mining vehicle and develop the control system of the mining vehicle therefore it is crucial to obtain the hydrodynamic characteristics of the deep sea mining vehicle comprehensively and accurately the hydrodynamic coefficient of the specific model can be accurately obtained through hydrodynamic tests such as the towing test and the self propelled test obreja and domnisoru 2012 established a 1 1 scale model of an underwater remotely operating vehicle rov and analyzed the influence of different immersion depths and self propelled speeds on hydrodynamic coefficients based on a robot with a non regular shape cely et al 2019 obtained the added mass and drag coefficient through the free decay test and the linear and nonlinear term coefficients through the free decay pendulum test respectively azarsina and williams 2010 measured axial force lateral force and yaw moment of an autonomous underwater vehicle auv in towing tank with an internal three component balance and a series of forwarding resistance tests at equal speed intervals were conducted to obtain the hydrodynamic force for square fitting jagadeesh et al 2009 used an internally mounted multi component strain gauge type balance to investigate axial normal drag lift and pitching moment coefficients with reynolds number and angle of attack avila and adamowski 2011 proposed an open frame rov to test the planar motion mechanism and calculated the inertia and drag coefficients of the morrison equation through two parameter weighted identification xu et al 2015 2017 studied a vertical planar motion mechanism to test and discuss the influence of the structural asymmetry on the hydrodynamic behavior of rov in surge and heave motion the above test methods can accurately obtain the hydrodynamic characteristics of the underwater vehicle however it usually requires high precision measuring instruments physical models and test sites which is often costly and difficult to achieve with the improvement and development of commercial software such as star ccm and ansys fluent the numerical calculation method based on cfd has become an important method for studying the hydrodynamic performance of the underwater vehicle in the design stage phillips et al 2010a wang et al 2016 investigated the flow field distribution around the auv based on large eddy simulation based on the moving least squares reconstruction the immersed boundary method was used to deal with the complex geometric boundary of the auv the results showed that the large eddy simulation accurately captured the subtle features of the vortex structure in the near wall and the wake of the auv the time averaged pressure coefficients and flow velocity curve showed a high degree of consistency with the test results of additional mass however the method of large eddy simulation must have grid points ranging from tens of millions to billions which does not meet the general requirements of rapid forecasting current numerical research mostly focuses on turbulence models based on reynolds average navier stokes rans suzuki et al 2013 performed a numerical simulation of forced vibration on cfd and a six degree of freedom coupled model then the hydrodynamic force coefficients and the additional mass components in its motion equations were obtained li et al 2020 investigated the hydrodynamics of the rov by a rans solver and the results of the experimental test were in good agreement with the numerical simulation results liu et al 2017 predicted the fluid resistance and lift of an underwater vehicle based on the sst k ω turbulence model in the open source code openfoam shariati and mousavizadegan 2017 simulated the influence of the attachment on the hydrodynamic characteristics of the robot which was based on the fluid volume method and the reynolds time average method lidtke et al 2018 used an improved method k t k l ω to predict the effect of laminar turbulent transition flow unlike the method of sst k ω the introduced laminar turbulent kinetic energy coefficient k l was used to determine the starting position of the laminar transition and assumed the total turbulent kinetic energy linearly related to the average strain rate the hydrodynamic performance of a symmetrical disc shaped auv under uniform flow was analyzed and the propulsive performance of a ducted propeller by a cfx rans solver chen and jiang 2019 the hydrodynamic coefficients in calculation results of the standard k ε model and the sst k ω model showed consistency in changing trend but with some deviations based on the realizable k ε turbulence model kaya et al 2020 analyzed the hydrodynamic coefficients of an rov traveling at constant velocity with different position angles compared with the standard k ε model the realizable k ε turbulence model modified the transport equation of diffusion rate ε and its performance in simulating backflow and separated flow is improved dai et al 2021 utilized the rng k ε model to investigate the hydrodynamic resistance of the deep sea mining vehicle in straight and steering motion zarei et al 2020 analyzed the vorticity characteristics near the rov with rounded corners and sharp edges when the reynolds number changed from 3 9 10 4 to 1 6 10 5 and the angle of attack changed from 0 to 45 through numerical simulation the two equation turbulence models based on the boussinesq eddy viscosity assumption are widely used in the research of underwater vehicles however these models may not accurately capture the flow physics in complex situations since those rely on many assumptions and simplifications panda et al 2021 the eddy viscosity models use the turbulence viscosity coefficient to solve the reynolds stress making it difficult to solve the complex flow features resulting from the streamline curvature and flow separation chou 1945 proposed the rsm to accurately solve the rotating flow and streamline curvature change caused by complex structures which directly calculated the time average value of the product of two fluctuating velocities in the reynolds stress the rsm is used to calculate seven equations throughout the discretized flow domain so this gives more accurate results than two equation turbulence models the rsm is applied to near wall regions with a low reynolds number by modifying the expressions of the dissipation term and the pressure strain correlation term in the transport equation however the rsm introduces additional solving variables and the closed form of the equation is more complicated than the low order turbulence model the closing conditions of the rsm transport equation were researched by many scholars mishra and girimaji 2010 2017 analyzed the consistency between the rapid pressure strain correlation term caused by the linear source term in the pressure poisson equation and the linear rapid deformation theory the compromise between the range of turbulence statistics and the closure method was proposed simultaneously panda et al 2017 2018 conducted experiments and numerical simulations of turbulence attenuation generated by the grid with or without average strain and studied the detailed evolution of the reynolds stress anisotropy under a wide range of grid reynolds numbers the studies showed that the turbulence generated by the rsm has high fidelity but there was a contradiction between the optimal value of the rsm closure coefficient and the theoretical limited value proposed in the previous research the numerical calibration method and compromised value of the closure parameters were proposed phillips et al 2010b utilized five turbulence models to analyze the vortical flow field around a submarine body the rsm was recommended to better capture the shed vortices wu et al 2014 adopted rsm to explore the approach of the auv docking with a dock after a comparison of different turbulence models and the docking processes were effectively simulated mitra et al 2019 2020 investigated the hydrodynamic effects of a fixed auv at different velocity reynolds numbers the results showed that the wall reflection terms of the rsm could capture the near wall flow characteristics well the spatial hydrodynamic distribution of a deep sea mining vehicle was simply analyzed by rsm under straight and steering motion states meanwhile the backflow and separation vortices were observed between several complex main structures dai et al 2020 panda et al 2021 utilized the rsm and a variety of two equation turbulence models to study the hydrodynamic characteristics of an auv the results showed that the rsm has the highest potential to capture the turbulent flow field along the auv of different shapes the structure of the deep sea mining vehicle is complicated and the backflow may appear in the tail area and the region among each attachment resulting in complicated separation vortices besides the slope degree of the seabed with a maximum value of 15 these complex situations can reduce the predictive performance of turbulence models based on the boussinesq eddy viscosity assumption and the subtle flow separation cannot be accurately captured in the flow field in contrast the rsm model has better predictive performance in complex flows so the rsm is more suitable for predicting the hydrodynamic performance of the deep sea mining vehicle in this study the rsm model was chosen to achieve rapid and accurate analysis of the hydrodynamic characteristics of a deep sea mining vehicle under three typical motions including the straight motion steering motion and downslope motion 2 cfd simulation 2 1 governing equations turbulent flow is a complex unsteady random flow but its instantaneous motion still satisfies the continuity and navier stokes equations the reynolds equation of a constant density viscous fluid is given by 1 u i t u j u i x j f i 1 ρ p x i 1 ρ x j μ u i x j ρ u i u j where μ denotes dynamic viscosity of the fluid f i is the first order tensor of force per unit mass ρ u i u j is the second order tensor of reynolds stress to consider the influence of turbulence anisotropy the rsm which directly solves ρ u i u j is introduced the rsm transport equation for incompressible fluids is represented by 2 d d t u i u j p i j t i j k x k ε i j φ i j p i j u k u j u i x k u i u k u j x k t k i j u i u j u k ν u i u j x k δ j k u i p ρ δ i k u j p ρ ε i j 2 v u i x k u j x k φ i j p ρ u i x j u j x i where p i j is turbulence generation term t i j k denotes turbulent diffusion ε i j denotes turbulence dissipation φ i j denotes pressure strain correlation the rsm turbulence model directly solves the 3d reynolds stress but it introduces new unknown variables and some model constants that need to be determined experimentally φ i j reflects the anisotropy of reynolds stress in turbulent flow the fluctuating pressure p is controlled by the poisson equation gibson and launder 1978 which is given by 3 1 ρ 2 p x i 2 2 u i u j u i u j x j x i 2 u i x j u j x i the fluctuating pressure p can be regarded as the superposition of the slow pressure term p s and the rapid pressure term p r the surface integral term φ i j w is generally added for near wall pressure points which is negligible away from the solid boundary launder et al 1975 thus the pressure strain correlation term has the following form 4 φ i j φ i j s φ i j r φ i j w where φ i j s is the slow pressure strain correlation term φ i j r is the rapid pressure strain correlation term johansson and hallbäck 1994 obtained the form of rapid pressure strain under classical reynolds stress closed uniform flow through the fast deformation theory 5 φ i j r 4 k u l x k m k j i l m i k j l the ideal closure φ i j r should maintain the number of fourier modes in the representation of the fluctuation field therefore the expression φ i j r should be a linear function of reynolds stress anisotropy mishra and girimaji 2017 6 φ i j r k c 2 s i j c 3 b i k s j k b j k s i k 2 3 b m n s m n δ i j c 4 b i k w j k b j k w i k where b i j denotes the reynolds stress anisotropy tensor s i j indicates the strain rate tensor w i j denotes the average flow rotation rate tensor u i j denotes the average velocity gradient tensor c 2 c 3 and c 4 represent the model closure constants to be determined in order to describe the information of the plane average velocity gradient field the ellipticity parameter β is introduced as following mishra and girimaji 2014 7 β w i j w i j w i j w i j s i j s i j the general form of the slow pressure strain correlation term φ i j s can be expressed as 8 φ i j s β 1 b i j β 2 b i k b k j 1 3 b i k b k i δ i j the near wall term φ i j w can redistribute the normal stress near the wall therefore attenuating the reynolds stress component perpendicular to the wall and enhancing the wall shear stress it has the following form 9 φ i j w 0 5 ε k u k u m n k n m δ i j 1 5 u i u k n j n k 1 5 u j u k n i n k c l k 3 2 ε y 0 3 φ k m r ε k n k n m δ i j 1 5 φ i k r n j n k 1 5 φ j k r n i n k c l k 3 2 ε y where n k is the x k component of the wall unit normal phase vector c l c μ 3 4 κ panda et al 2018 have calibrated the closure coefficient in the rsm model through experimental research the following values were recommended c ε 1 1 42 c ε 2 1 87 σ ε 1 25 c 3 2 52 c 4 0 71 in the subsequent numerical simulation the rsm and above model closure parameters will be adopted 2 2 modeling details the length breadth and height l b and h of the deep sea mining vehicle are 9 5 m 5 3 m and 3 2 m respectively the coordinate system of the deep sea mining vehicle was defined in fig 1 the global coordinate system was fixed in the ground the local coordinate system was fixed with the centroid of the vehicle and maintained a constant relative azimuth to the mining vehicle the x o axis of the local coordinate system was defined as the longitudinal direction the y o axis as the lateral direction and the z o axis as the vertical direction the fluid calculation domains of the mining vehicle were shown in fig 2 all of the upstream boundaries were set as velocity inlets and all of the downstream boundaries were set as pressure outlets the symmetrical planes were set in fig 2 a and c to reduce the consumption of computing resources the other surfaces were set as non slip walls the rsm model was used to solve the complex turbulence problem in star ccm and the pressure velocity algorithm simple was selected the y of the model was taken as 50 which met the simulation requirement the velocities of seawater in the simulation of the straight and steering motions were set to 0 1 2 m s and the mining vehicle was fixed the overset grid method was applied in the downslope motion which can describe the movement of the deep sea mining vehicle well compared with the dynamic grid method the overset grid method tends to have better grid quality and makes the simulation easier to converge the velocity of the mining vehicle was set to 0 1 2 m s the thickness of the first prismatic layer on the wall of the mining vehicle was between 1 66 10 3 m and 8 77 10 3 m and the layer growth rate was set to 1 5 the mesh generation method which contains the surface reconstruction and the cutting volume was used to spatially discretize the computational domain as shown in fig 3 a the three layers of dense volume were utilized to refine the sharp edged mesh and the boundary layer grid was set to six layers this method improved the simulation accuracy of near wall pressure and tail eddy currents the grid of the steering computing domain was similar to that of the straight computing domain the component and background grid of downslope motion were displayed in fig 3 b the component grid was similar to the first layer grid of the straight computing domain besides the seawater was the material of the flow field which density and dynamic viscosity were 1027 kg m3 and 0 00161 kg m s respectively three simulations with different grid numbers were compared for the study of grid independence the speeds of seawater in the straight and steering motion domains were both set to 1 m s and the speed of the component grid in the downslope motion was also set to 1 m s the convergence ratio r g could be used to verify the grid convergence eca and hoekstra 2014 the r g is given by 10 r g ε 1 ε 2 ε 2 ε 3 where ε 1 ε 2 and ε 3 are the results under the fine middle and coarse grid respectively the state of convergence was defined as follows monotonic convergence for 0 r g 1 monotonic divergence for r g 1 oscillatory convergence for r g 0 and r g 1 oscillatory divergence for r g 0 and r g 1 the results of three simulations with different grid numbers were displayed in table 1 all the r g were in the range of 0 1 which presented that the convergences were monotonic with the increase in the number of grids the middle grid was adopted for the balance of the simulation accuracy and time 3 numerical results when the mining vehicle travels on the seabed the pressure difference between the front and back of the mining vehicle makes the vehicle suffers seawater resistance in the direction of travel the dimensionless resistance coefficient is given by 11 c d f d 0 5 ρ u 2 a v where f d is the resistance of the vehicle a v is the headstream area of the vehicle u is the average speed of the incoming flow the surface friction coefficient between the seawater and the surface of the mining vehicle is calculated by 12 c f ρ μ u 3 x 0 5 ρ u 2 ν u x the pressure change of the vehicle surface is expressed by the dimensionless pressure coefficient 13 c p p p 0 5 ρ u 2 where p is the pressure of the free flow according to the physical parameters of the seawater and the traveling speed of the vehicle the velocity reynolds number was calculated 14 r e v ρ u v 1 3 μ where v represents the volume of the mining vehicle 3 1 results of the straight motion the velocity distribution of the flow field at a seawater speed of 1 2 m s was displayed in fig 4 the average velocity of the free flow around the mining vehicle was maintained at 1 2 m s and the velocity gradient in the flow direction was small in fig 4 a the low speed area was mainly concentrated in the tail of the mining vehicle besides the low speed region also appeared in the front and interior of the collecting device as well as the zone between the collecting device and the main structure of the mining vehicle the velocity of the normal flow field on the upper part of the mining vehicle increased rapidly from 0 m s to the maximum value of 1 5223 m s and then gradually decayed to the average velocity of the free flow as shown in fig 4 b the structure of the mining vehicle was symmetrical about the central axis which resulted in that the velocity distribution of the flow field in the straight motion was also symmetrical figs 5 and 6 showed the pressure and velocity streamline distributions of the flow field in the straight motion at 1 2 m s respectively in fig 5 a there was a typical inverse pressure gradient at the top of the mining vehicle which was due to the sharp edges and planar boundary layer on the structure as illustrated in the upper streamline of fig 6 a the phenomenon of boundary layer separation occurred on the upper part of the mining vehicle at the same time the backflow areas appeared and the detached vortices formed as a result of the inverse pressure gradient the fluid separated in the low speed areas besides fig 5 b and fig 6 b indicated that the pressure field and velocity streamline of the vehicle also conformed to a symmetrical distribution fig 7 presented the turbulent kinetic energy distribution of the flow field in the straight motion at 1 2 m s it could be seen that the large turbulent kinetic energy occurred in the backflow region near the sharp edge of the mining vehicle the turbulent kinetic energy was transferred downstream along with the flow then it would gradually transform into thermal energy and dissipate due to the viscosity of the fluid finally the low pressure areas shown in fig 5 were formed which increased the pressure difference between the front and back of the mining vehicle the pressure contour on the surface of the vehicle was displayed in fig 8 the pressure on the front of the vehicle was greater than that on the rear and the distribution of the pressure was symmetrical according to the numerical simulation results fig 9 showed the resistance curve fitted by the least squares the relationship between the longitudinal hydrodynamic resistance f l o n g along the x o axis and the traveling speeds was revealed moreover the pressure distribution of the flow field was symmetrical so that the lateral hydrodynamic resistance f l a t along the y o axis could be ignored it could be seen that the resistance velocity relationship satisfied f v 2 the relationship between the dimensionless longitudinal resistance coefficient and the velocity reynolds numbers was presented in fig 10 the average resistance coefficient of the mining vehicle was 0 91 fig 11 presented the distribution law of the surface friction coefficient from fig 11 a the surface friction coefficient on the side of the track increased slowly and then decreased rapidly and the surface friction coefficient of the chassis centerline in fig 11 b behaved the same along the direction of flow the fluid shear stress and the local frictional resistance of the boundary layer near the wall gradually decreased besides as the velocity reynolds number increased the turbulent kinetic energy of the seawater increased and the surface friction coefficient increased accordingly as illustrated in fig 12 the pressure coefficient of the vehicle surface decreased significantly with the increase of the turbulent kinetic energy which caused a greater pressure difference between the front and back of the vehicle surface therefore the seawater resistance of the vehicle increased 3 2 results of the steering motion the velocity distribution of the flow field in the steering motion at 1 2 m s was shown in fig 13 when the free flow passed through the narrow loop and the mining vehicle the speed of the fluid increased significantly and the speed distribution on the left and right sides of the vehicle was different the wake area was asymmetrical in fig 13 b with the deflection to the inside the speed of the fluid on the inner side was greater than that on the outer side similar to the low speed areas of the flow field in the above straight motion the low speed areas appeared in the same regions the maximum speed of the fluid appeared on the upper part of the mining vehicle with a value of 1 6054 m s the fluid velocity around the mining vehicle changed extremely sharply figs 14 and 15 showed the pressure and velocity streamline distributions of the flow field in the steering motion at 1 2 m s respectively the speed difference between the left and right sides of the mining vehicle in fig 14 b resulted in asymmetric pressure distribution the pressure on the outside was significantly greater than the pressure on the inside therefore the lateral hydrodynamic resistance could not be neglected in the steering motion at the same time the flow separation and the shedding vortex were observed in fig 15 a as shown in fig 15 b the separated flow behind the mining vehicle deflected to the inner side in the steering process fig 16 illustrated the turbulent kinetic energy distribution of the flow field in steering motion at 1 2 m s the large turbulent kinetic energy appeared in the backflow region near the sharp edge and transferred to the downstream area due to the viscosity of the fluid the turbulent kinetic energy was gradually converted to thermal energy and dissipated eventually creating the low pressure region in fig 14 the low pressure region resulted in an increased pressure difference between the front and rear of the mining vehicle the surface pressure contour of the mining vehicle was shown in fig 17 the mining vehicle traveled with the combined effect of the longitudinal and lateral hydrodynamic resistance caused by pressure difference when the mining vehicle was in the process of the steering motion the effects of both longitudinal and lateral hydrodynamic resistance needed to be considered the fluid resistance and the least squares fitted curves were revealed in fig 18 the resistance and the speed were positively correlated and the squared relationship between the resistance and the speed was satisfied when the speed was 1 2 m s the longitudinal resistance reached 10 kn and the lateral resistance was about 0 9 kn as illustrated in fig 19 the average longitudinal hydrodynamic resistance coefficient of the mining vehicle was approximately 1 06 which was slightly greater than that in the straight motion as shown in fig 20 the maximum surface friction coefficient of the right track was located at the position of x o 1 5 however the two peaks of the surface friction coefficient appeared on the left track the left track was on the inner side and its streamline structure was more complicated in fig 15 b the thickness distribution of the boundary layer near the wall changed non monotonously along the flow direction so the velocity gradient was not uniform meanwhile as the dimensionless speed increased the surface friction coefficient of the mining vehicle increased as illustrated in fig 21 the surface friction coefficient of the chassis surface was similar to that of the right track fig 22 revealed that the pressure coefficient of the right track was greater than that of the left track the pressure difference made the vehicle subject to the lateral hydrodynamic resistance imposed by the seawater with the increase of the dimensionless speed of seawater the pressure coefficient of the mining vehicle decreased accordingly at the same time the pressure difference between the left track and the right track increased so that the lateral hydrodynamic resistance as shown in fig 23 with the increase of dimensionless velocity reynolds numbers the turbulent kinetic energy increased and the pressure coefficient on the surface of the chassis decreased 3 3 results of the downslope motion the overset grid method was adopted to simulated the downslope motion of the mining vehicle with different slope degrees the slope degree of the seabed varied from 5 to 12 5 with an interval of 2 5 the f x is the hydrodynamic resistance along the x axis and the f z is the hydrodynamic resistance along the z axis in the global coordinate system the instantaneous vorticity of the flow field was shown in fig 24 the significant phenomenon of flow separation could be observed which would lead to an increase of the pressure difference between the multiple pairs of surfaces fig 24 a showed the starting vortex at 1 s the flow separation began to occur in many areas including the upper and lower surfaces of the collecting device the top of the buoyant body and the tail of the vehicle as illustrated in fig 24 b the vortex at the rear of the mining vehicle was dislodged the dislodged vortex at the bottom of the vehicle was blocked by the main structure and then spread the second shedding vortex formed in the back area and the high vorticity region of the flow field around the mining vehicle became larger in fig 24 c with the formation of newly separated vortices the previously shedding vortices gradually dissipated and the areas of high vortex volume around the mining vehicle formed in fig 24 d the evolution of the pressure distribution when the mining vehicle was traveling on the slope was shown in fig 25 the low pressure areas appeared at the top and rear of the mining vehicle in fig 25 a corresponding to the flow separation area in fig 24 a the fluid pressure at the front of the mining vehicle was large so that seawater exerted a high resistance to the travel of the mining vehicle with the development of the flow and the dissipation of the vortex the pressure of the flow field around the mining vehicle was reduced and the seawater resistance tended to be stable the final pressure distribution of the flow field was shown in fig 25 b when the mining vehicle traveled at 1 2 m s the relationship between the hydrodynamic resistance and the slope degree β of the seabed was displayed in fig 26 when the slope degree was 5 the hydrodynamic resistance in the x axis was about 7 5 kn and the fluid resistance in the z axis was about 0 5 kn as the slope β increased the f x decreased and the f z gradually increased when the slope degree was 12 5 the hydrodynamic resistance in the x axis was about 6 9 kn and the hydrodynamic resistance in the z axis was about 2 8 kn the flow field of the downslope motion was symmetrical so the hydrodynamic resistance in y axis could be neglected compared with the longitudinal hydrodynamic resistance in the straight motion the corresponding value in the downslope motion was smaller 4 conclusion in this study a series of numerical investigations were proposed to analyze the hydrodynamic characteristics of the deep sea mining vehicle the rsm was utilized to simulate the complicated flow field in three typical motions the major results of this study are as follows 1 the velocity pressure velocity streamline and turbulent kinetic energy distributions of the flow field were symmetrical in the straight motion as the mining vehicle traveling the fluid separated on the surface of the vehicle and formed detached vortices in the backflow regions resulting in the formation of the low pressure areas the pressure difference of the fluid was the main source of the longitudinal hydrodynamic resistance the resistance was proportional to the square of the velocity the average longitudinal hydrodynamic resistance coefficient of the mining vehicle was 0 91 with the increase of the velocity reynolds number the surface friction coefficient increased but the pressure coefficient decreased 2 the velocity pressure velocity streamline and turbulent kinetic energy distributions of the flow field were asymmetrical in the steering motion the wake area was deflected to the inside and the speed of the fluid on the inner side was greater than that on the outer side the source of hydrodynamic resistance during steering motion was similar to that of straight motion however in addition to the longitudinal hydrodynamic resistance the vehicle was also subject to lateral hydrodynamic resistance during its movement the average longitudinal resistance coefficient of the mining vehicle was 1 06 the changing laws of the surface friction and pressure coefficients during steering motion were similar to that of straight motion 3 the phenomenon of fluid separation occurred when the mining vehicle first started to move on the slope and the first and second tail shedding vortices formed in the fourth and seventh seconds the fluid pressure in the flow separation area was relatively low and none of the flow separations appeared in the front of the vehicle which resulted in that the vehicle suffered a large starting resistance and a relatively stable traveling resistance with the increase of the slope degree the f x gradually decreased from 7 5 kn to 6 9 kn and the f z gradually increased from 0 5 kn to 2 8 kn credit authorship contribution statement yu dai conceptualization methodology software validation formal analysis resources data curation writing original draft writing review editing supervision project administration funding acquisition cong xue software validation formal analysis data curation writing original draft visualization qiao su methodology software validation investigation visualization writing review editing xin huang software validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was funded by the national natural science foundation of china grant number 51774324 the national key research and development program of china grant number sq2016yf010109 and the natural science foundation of hunan province grant number 2019jj40380 and 17b063 
20528,a numerical analysis was conducted on the hydrodynamic characteristics of a deep sea mining vehicle the simulations employed the reynolds stress model rsm to focus on the complicated flow field under three typical motions during the traveling process the fluid separated around the vehicle and the low pressure areas formed behind the vehicle the turbulent kinetic energy was large near the shape edge of the vehicle and transferred downstream along with the flow with the increase of the velocity reynolds number the surface friction coefficient increased and the pressure coefficient decreased which made a large frictional resistance and differential pressure resistance meanwhile although the development processes of the flow field were similar in different motions the spatial hydrodynamic distributions and the changes of the hydrodynamic coefficients also performed differently this study can serve as an important reference for the structure optimization and control system development of the mining vehicle keywords hydrodynamic characteristics deep sea mining vehicle rsm 1 introduction the rich mineral resources on the seafloor have attracted the interest of many countries and organizations in the research of deep sea mining systems and the deep sea mining vehicle is a key component of the system chung 2009 the study of hydrodynamic characteristics can be used to optimize the structure and shape of the mining vehicle and develop the control system of the mining vehicle therefore it is crucial to obtain the hydrodynamic characteristics of the deep sea mining vehicle comprehensively and accurately the hydrodynamic coefficient of the specific model can be accurately obtained through hydrodynamic tests such as the towing test and the self propelled test obreja and domnisoru 2012 established a 1 1 scale model of an underwater remotely operating vehicle rov and analyzed the influence of different immersion depths and self propelled speeds on hydrodynamic coefficients based on a robot with a non regular shape cely et al 2019 obtained the added mass and drag coefficient through the free decay test and the linear and nonlinear term coefficients through the free decay pendulum test respectively azarsina and williams 2010 measured axial force lateral force and yaw moment of an autonomous underwater vehicle auv in towing tank with an internal three component balance and a series of forwarding resistance tests at equal speed intervals were conducted to obtain the hydrodynamic force for square fitting jagadeesh et al 2009 used an internally mounted multi component strain gauge type balance to investigate axial normal drag lift and pitching moment coefficients with reynolds number and angle of attack avila and adamowski 2011 proposed an open frame rov to test the planar motion mechanism and calculated the inertia and drag coefficients of the morrison equation through two parameter weighted identification xu et al 2015 2017 studied a vertical planar motion mechanism to test and discuss the influence of the structural asymmetry on the hydrodynamic behavior of rov in surge and heave motion the above test methods can accurately obtain the hydrodynamic characteristics of the underwater vehicle however it usually requires high precision measuring instruments physical models and test sites which is often costly and difficult to achieve with the improvement and development of commercial software such as star ccm and ansys fluent the numerical calculation method based on cfd has become an important method for studying the hydrodynamic performance of the underwater vehicle in the design stage phillips et al 2010a wang et al 2016 investigated the flow field distribution around the auv based on large eddy simulation based on the moving least squares reconstruction the immersed boundary method was used to deal with the complex geometric boundary of the auv the results showed that the large eddy simulation accurately captured the subtle features of the vortex structure in the near wall and the wake of the auv the time averaged pressure coefficients and flow velocity curve showed a high degree of consistency with the test results of additional mass however the method of large eddy simulation must have grid points ranging from tens of millions to billions which does not meet the general requirements of rapid forecasting current numerical research mostly focuses on turbulence models based on reynolds average navier stokes rans suzuki et al 2013 performed a numerical simulation of forced vibration on cfd and a six degree of freedom coupled model then the hydrodynamic force coefficients and the additional mass components in its motion equations were obtained li et al 2020 investigated the hydrodynamics of the rov by a rans solver and the results of the experimental test were in good agreement with the numerical simulation results liu et al 2017 predicted the fluid resistance and lift of an underwater vehicle based on the sst k ω turbulence model in the open source code openfoam shariati and mousavizadegan 2017 simulated the influence of the attachment on the hydrodynamic characteristics of the robot which was based on the fluid volume method and the reynolds time average method lidtke et al 2018 used an improved method k t k l ω to predict the effect of laminar turbulent transition flow unlike the method of sst k ω the introduced laminar turbulent kinetic energy coefficient k l was used to determine the starting position of the laminar transition and assumed the total turbulent kinetic energy linearly related to the average strain rate the hydrodynamic performance of a symmetrical disc shaped auv under uniform flow was analyzed and the propulsive performance of a ducted propeller by a cfx rans solver chen and jiang 2019 the hydrodynamic coefficients in calculation results of the standard k ε model and the sst k ω model showed consistency in changing trend but with some deviations based on the realizable k ε turbulence model kaya et al 2020 analyzed the hydrodynamic coefficients of an rov traveling at constant velocity with different position angles compared with the standard k ε model the realizable k ε turbulence model modified the transport equation of diffusion rate ε and its performance in simulating backflow and separated flow is improved dai et al 2021 utilized the rng k ε model to investigate the hydrodynamic resistance of the deep sea mining vehicle in straight and steering motion zarei et al 2020 analyzed the vorticity characteristics near the rov with rounded corners and sharp edges when the reynolds number changed from 3 9 10 4 to 1 6 10 5 and the angle of attack changed from 0 to 45 through numerical simulation the two equation turbulence models based on the boussinesq eddy viscosity assumption are widely used in the research of underwater vehicles however these models may not accurately capture the flow physics in complex situations since those rely on many assumptions and simplifications panda et al 2021 the eddy viscosity models use the turbulence viscosity coefficient to solve the reynolds stress making it difficult to solve the complex flow features resulting from the streamline curvature and flow separation chou 1945 proposed the rsm to accurately solve the rotating flow and streamline curvature change caused by complex structures which directly calculated the time average value of the product of two fluctuating velocities in the reynolds stress the rsm is used to calculate seven equations throughout the discretized flow domain so this gives more accurate results than two equation turbulence models the rsm is applied to near wall regions with a low reynolds number by modifying the expressions of the dissipation term and the pressure strain correlation term in the transport equation however the rsm introduces additional solving variables and the closed form of the equation is more complicated than the low order turbulence model the closing conditions of the rsm transport equation were researched by many scholars mishra and girimaji 2010 2017 analyzed the consistency between the rapid pressure strain correlation term caused by the linear source term in the pressure poisson equation and the linear rapid deformation theory the compromise between the range of turbulence statistics and the closure method was proposed simultaneously panda et al 2017 2018 conducted experiments and numerical simulations of turbulence attenuation generated by the grid with or without average strain and studied the detailed evolution of the reynolds stress anisotropy under a wide range of grid reynolds numbers the studies showed that the turbulence generated by the rsm has high fidelity but there was a contradiction between the optimal value of the rsm closure coefficient and the theoretical limited value proposed in the previous research the numerical calibration method and compromised value of the closure parameters were proposed phillips et al 2010b utilized five turbulence models to analyze the vortical flow field around a submarine body the rsm was recommended to better capture the shed vortices wu et al 2014 adopted rsm to explore the approach of the auv docking with a dock after a comparison of different turbulence models and the docking processes were effectively simulated mitra et al 2019 2020 investigated the hydrodynamic effects of a fixed auv at different velocity reynolds numbers the results showed that the wall reflection terms of the rsm could capture the near wall flow characteristics well the spatial hydrodynamic distribution of a deep sea mining vehicle was simply analyzed by rsm under straight and steering motion states meanwhile the backflow and separation vortices were observed between several complex main structures dai et al 2020 panda et al 2021 utilized the rsm and a variety of two equation turbulence models to study the hydrodynamic characteristics of an auv the results showed that the rsm has the highest potential to capture the turbulent flow field along the auv of different shapes the structure of the deep sea mining vehicle is complicated and the backflow may appear in the tail area and the region among each attachment resulting in complicated separation vortices besides the slope degree of the seabed with a maximum value of 15 these complex situations can reduce the predictive performance of turbulence models based on the boussinesq eddy viscosity assumption and the subtle flow separation cannot be accurately captured in the flow field in contrast the rsm model has better predictive performance in complex flows so the rsm is more suitable for predicting the hydrodynamic performance of the deep sea mining vehicle in this study the rsm model was chosen to achieve rapid and accurate analysis of the hydrodynamic characteristics of a deep sea mining vehicle under three typical motions including the straight motion steering motion and downslope motion 2 cfd simulation 2 1 governing equations turbulent flow is a complex unsteady random flow but its instantaneous motion still satisfies the continuity and navier stokes equations the reynolds equation of a constant density viscous fluid is given by 1 u i t u j u i x j f i 1 ρ p x i 1 ρ x j μ u i x j ρ u i u j where μ denotes dynamic viscosity of the fluid f i is the first order tensor of force per unit mass ρ u i u j is the second order tensor of reynolds stress to consider the influence of turbulence anisotropy the rsm which directly solves ρ u i u j is introduced the rsm transport equation for incompressible fluids is represented by 2 d d t u i u j p i j t i j k x k ε i j φ i j p i j u k u j u i x k u i u k u j x k t k i j u i u j u k ν u i u j x k δ j k u i p ρ δ i k u j p ρ ε i j 2 v u i x k u j x k φ i j p ρ u i x j u j x i where p i j is turbulence generation term t i j k denotes turbulent diffusion ε i j denotes turbulence dissipation φ i j denotes pressure strain correlation the rsm turbulence model directly solves the 3d reynolds stress but it introduces new unknown variables and some model constants that need to be determined experimentally φ i j reflects the anisotropy of reynolds stress in turbulent flow the fluctuating pressure p is controlled by the poisson equation gibson and launder 1978 which is given by 3 1 ρ 2 p x i 2 2 u i u j u i u j x j x i 2 u i x j u j x i the fluctuating pressure p can be regarded as the superposition of the slow pressure term p s and the rapid pressure term p r the surface integral term φ i j w is generally added for near wall pressure points which is negligible away from the solid boundary launder et al 1975 thus the pressure strain correlation term has the following form 4 φ i j φ i j s φ i j r φ i j w where φ i j s is the slow pressure strain correlation term φ i j r is the rapid pressure strain correlation term johansson and hallbäck 1994 obtained the form of rapid pressure strain under classical reynolds stress closed uniform flow through the fast deformation theory 5 φ i j r 4 k u l x k m k j i l m i k j l the ideal closure φ i j r should maintain the number of fourier modes in the representation of the fluctuation field therefore the expression φ i j r should be a linear function of reynolds stress anisotropy mishra and girimaji 2017 6 φ i j r k c 2 s i j c 3 b i k s j k b j k s i k 2 3 b m n s m n δ i j c 4 b i k w j k b j k w i k where b i j denotes the reynolds stress anisotropy tensor s i j indicates the strain rate tensor w i j denotes the average flow rotation rate tensor u i j denotes the average velocity gradient tensor c 2 c 3 and c 4 represent the model closure constants to be determined in order to describe the information of the plane average velocity gradient field the ellipticity parameter β is introduced as following mishra and girimaji 2014 7 β w i j w i j w i j w i j s i j s i j the general form of the slow pressure strain correlation term φ i j s can be expressed as 8 φ i j s β 1 b i j β 2 b i k b k j 1 3 b i k b k i δ i j the near wall term φ i j w can redistribute the normal stress near the wall therefore attenuating the reynolds stress component perpendicular to the wall and enhancing the wall shear stress it has the following form 9 φ i j w 0 5 ε k u k u m n k n m δ i j 1 5 u i u k n j n k 1 5 u j u k n i n k c l k 3 2 ε y 0 3 φ k m r ε k n k n m δ i j 1 5 φ i k r n j n k 1 5 φ j k r n i n k c l k 3 2 ε y where n k is the x k component of the wall unit normal phase vector c l c μ 3 4 κ panda et al 2018 have calibrated the closure coefficient in the rsm model through experimental research the following values were recommended c ε 1 1 42 c ε 2 1 87 σ ε 1 25 c 3 2 52 c 4 0 71 in the subsequent numerical simulation the rsm and above model closure parameters will be adopted 2 2 modeling details the length breadth and height l b and h of the deep sea mining vehicle are 9 5 m 5 3 m and 3 2 m respectively the coordinate system of the deep sea mining vehicle was defined in fig 1 the global coordinate system was fixed in the ground the local coordinate system was fixed with the centroid of the vehicle and maintained a constant relative azimuth to the mining vehicle the x o axis of the local coordinate system was defined as the longitudinal direction the y o axis as the lateral direction and the z o axis as the vertical direction the fluid calculation domains of the mining vehicle were shown in fig 2 all of the upstream boundaries were set as velocity inlets and all of the downstream boundaries were set as pressure outlets the symmetrical planes were set in fig 2 a and c to reduce the consumption of computing resources the other surfaces were set as non slip walls the rsm model was used to solve the complex turbulence problem in star ccm and the pressure velocity algorithm simple was selected the y of the model was taken as 50 which met the simulation requirement the velocities of seawater in the simulation of the straight and steering motions were set to 0 1 2 m s and the mining vehicle was fixed the overset grid method was applied in the downslope motion which can describe the movement of the deep sea mining vehicle well compared with the dynamic grid method the overset grid method tends to have better grid quality and makes the simulation easier to converge the velocity of the mining vehicle was set to 0 1 2 m s the thickness of the first prismatic layer on the wall of the mining vehicle was between 1 66 10 3 m and 8 77 10 3 m and the layer growth rate was set to 1 5 the mesh generation method which contains the surface reconstruction and the cutting volume was used to spatially discretize the computational domain as shown in fig 3 a the three layers of dense volume were utilized to refine the sharp edged mesh and the boundary layer grid was set to six layers this method improved the simulation accuracy of near wall pressure and tail eddy currents the grid of the steering computing domain was similar to that of the straight computing domain the component and background grid of downslope motion were displayed in fig 3 b the component grid was similar to the first layer grid of the straight computing domain besides the seawater was the material of the flow field which density and dynamic viscosity were 1027 kg m3 and 0 00161 kg m s respectively three simulations with different grid numbers were compared for the study of grid independence the speeds of seawater in the straight and steering motion domains were both set to 1 m s and the speed of the component grid in the downslope motion was also set to 1 m s the convergence ratio r g could be used to verify the grid convergence eca and hoekstra 2014 the r g is given by 10 r g ε 1 ε 2 ε 2 ε 3 where ε 1 ε 2 and ε 3 are the results under the fine middle and coarse grid respectively the state of convergence was defined as follows monotonic convergence for 0 r g 1 monotonic divergence for r g 1 oscillatory convergence for r g 0 and r g 1 oscillatory divergence for r g 0 and r g 1 the results of three simulations with different grid numbers were displayed in table 1 all the r g were in the range of 0 1 which presented that the convergences were monotonic with the increase in the number of grids the middle grid was adopted for the balance of the simulation accuracy and time 3 numerical results when the mining vehicle travels on the seabed the pressure difference between the front and back of the mining vehicle makes the vehicle suffers seawater resistance in the direction of travel the dimensionless resistance coefficient is given by 11 c d f d 0 5 ρ u 2 a v where f d is the resistance of the vehicle a v is the headstream area of the vehicle u is the average speed of the incoming flow the surface friction coefficient between the seawater and the surface of the mining vehicle is calculated by 12 c f ρ μ u 3 x 0 5 ρ u 2 ν u x the pressure change of the vehicle surface is expressed by the dimensionless pressure coefficient 13 c p p p 0 5 ρ u 2 where p is the pressure of the free flow according to the physical parameters of the seawater and the traveling speed of the vehicle the velocity reynolds number was calculated 14 r e v ρ u v 1 3 μ where v represents the volume of the mining vehicle 3 1 results of the straight motion the velocity distribution of the flow field at a seawater speed of 1 2 m s was displayed in fig 4 the average velocity of the free flow around the mining vehicle was maintained at 1 2 m s and the velocity gradient in the flow direction was small in fig 4 a the low speed area was mainly concentrated in the tail of the mining vehicle besides the low speed region also appeared in the front and interior of the collecting device as well as the zone between the collecting device and the main structure of the mining vehicle the velocity of the normal flow field on the upper part of the mining vehicle increased rapidly from 0 m s to the maximum value of 1 5223 m s and then gradually decayed to the average velocity of the free flow as shown in fig 4 b the structure of the mining vehicle was symmetrical about the central axis which resulted in that the velocity distribution of the flow field in the straight motion was also symmetrical figs 5 and 6 showed the pressure and velocity streamline distributions of the flow field in the straight motion at 1 2 m s respectively in fig 5 a there was a typical inverse pressure gradient at the top of the mining vehicle which was due to the sharp edges and planar boundary layer on the structure as illustrated in the upper streamline of fig 6 a the phenomenon of boundary layer separation occurred on the upper part of the mining vehicle at the same time the backflow areas appeared and the detached vortices formed as a result of the inverse pressure gradient the fluid separated in the low speed areas besides fig 5 b and fig 6 b indicated that the pressure field and velocity streamline of the vehicle also conformed to a symmetrical distribution fig 7 presented the turbulent kinetic energy distribution of the flow field in the straight motion at 1 2 m s it could be seen that the large turbulent kinetic energy occurred in the backflow region near the sharp edge of the mining vehicle the turbulent kinetic energy was transferred downstream along with the flow then it would gradually transform into thermal energy and dissipate due to the viscosity of the fluid finally the low pressure areas shown in fig 5 were formed which increased the pressure difference between the front and back of the mining vehicle the pressure contour on the surface of the vehicle was displayed in fig 8 the pressure on the front of the vehicle was greater than that on the rear and the distribution of the pressure was symmetrical according to the numerical simulation results fig 9 showed the resistance curve fitted by the least squares the relationship between the longitudinal hydrodynamic resistance f l o n g along the x o axis and the traveling speeds was revealed moreover the pressure distribution of the flow field was symmetrical so that the lateral hydrodynamic resistance f l a t along the y o axis could be ignored it could be seen that the resistance velocity relationship satisfied f v 2 the relationship between the dimensionless longitudinal resistance coefficient and the velocity reynolds numbers was presented in fig 10 the average resistance coefficient of the mining vehicle was 0 91 fig 11 presented the distribution law of the surface friction coefficient from fig 11 a the surface friction coefficient on the side of the track increased slowly and then decreased rapidly and the surface friction coefficient of the chassis centerline in fig 11 b behaved the same along the direction of flow the fluid shear stress and the local frictional resistance of the boundary layer near the wall gradually decreased besides as the velocity reynolds number increased the turbulent kinetic energy of the seawater increased and the surface friction coefficient increased accordingly as illustrated in fig 12 the pressure coefficient of the vehicle surface decreased significantly with the increase of the turbulent kinetic energy which caused a greater pressure difference between the front and back of the vehicle surface therefore the seawater resistance of the vehicle increased 3 2 results of the steering motion the velocity distribution of the flow field in the steering motion at 1 2 m s was shown in fig 13 when the free flow passed through the narrow loop and the mining vehicle the speed of the fluid increased significantly and the speed distribution on the left and right sides of the vehicle was different the wake area was asymmetrical in fig 13 b with the deflection to the inside the speed of the fluid on the inner side was greater than that on the outer side similar to the low speed areas of the flow field in the above straight motion the low speed areas appeared in the same regions the maximum speed of the fluid appeared on the upper part of the mining vehicle with a value of 1 6054 m s the fluid velocity around the mining vehicle changed extremely sharply figs 14 and 15 showed the pressure and velocity streamline distributions of the flow field in the steering motion at 1 2 m s respectively the speed difference between the left and right sides of the mining vehicle in fig 14 b resulted in asymmetric pressure distribution the pressure on the outside was significantly greater than the pressure on the inside therefore the lateral hydrodynamic resistance could not be neglected in the steering motion at the same time the flow separation and the shedding vortex were observed in fig 15 a as shown in fig 15 b the separated flow behind the mining vehicle deflected to the inner side in the steering process fig 16 illustrated the turbulent kinetic energy distribution of the flow field in steering motion at 1 2 m s the large turbulent kinetic energy appeared in the backflow region near the sharp edge and transferred to the downstream area due to the viscosity of the fluid the turbulent kinetic energy was gradually converted to thermal energy and dissipated eventually creating the low pressure region in fig 14 the low pressure region resulted in an increased pressure difference between the front and rear of the mining vehicle the surface pressure contour of the mining vehicle was shown in fig 17 the mining vehicle traveled with the combined effect of the longitudinal and lateral hydrodynamic resistance caused by pressure difference when the mining vehicle was in the process of the steering motion the effects of both longitudinal and lateral hydrodynamic resistance needed to be considered the fluid resistance and the least squares fitted curves were revealed in fig 18 the resistance and the speed were positively correlated and the squared relationship between the resistance and the speed was satisfied when the speed was 1 2 m s the longitudinal resistance reached 10 kn and the lateral resistance was about 0 9 kn as illustrated in fig 19 the average longitudinal hydrodynamic resistance coefficient of the mining vehicle was approximately 1 06 which was slightly greater than that in the straight motion as shown in fig 20 the maximum surface friction coefficient of the right track was located at the position of x o 1 5 however the two peaks of the surface friction coefficient appeared on the left track the left track was on the inner side and its streamline structure was more complicated in fig 15 b the thickness distribution of the boundary layer near the wall changed non monotonously along the flow direction so the velocity gradient was not uniform meanwhile as the dimensionless speed increased the surface friction coefficient of the mining vehicle increased as illustrated in fig 21 the surface friction coefficient of the chassis surface was similar to that of the right track fig 22 revealed that the pressure coefficient of the right track was greater than that of the left track the pressure difference made the vehicle subject to the lateral hydrodynamic resistance imposed by the seawater with the increase of the dimensionless speed of seawater the pressure coefficient of the mining vehicle decreased accordingly at the same time the pressure difference between the left track and the right track increased so that the lateral hydrodynamic resistance as shown in fig 23 with the increase of dimensionless velocity reynolds numbers the turbulent kinetic energy increased and the pressure coefficient on the surface of the chassis decreased 3 3 results of the downslope motion the overset grid method was adopted to simulated the downslope motion of the mining vehicle with different slope degrees the slope degree of the seabed varied from 5 to 12 5 with an interval of 2 5 the f x is the hydrodynamic resistance along the x axis and the f z is the hydrodynamic resistance along the z axis in the global coordinate system the instantaneous vorticity of the flow field was shown in fig 24 the significant phenomenon of flow separation could be observed which would lead to an increase of the pressure difference between the multiple pairs of surfaces fig 24 a showed the starting vortex at 1 s the flow separation began to occur in many areas including the upper and lower surfaces of the collecting device the top of the buoyant body and the tail of the vehicle as illustrated in fig 24 b the vortex at the rear of the mining vehicle was dislodged the dislodged vortex at the bottom of the vehicle was blocked by the main structure and then spread the second shedding vortex formed in the back area and the high vorticity region of the flow field around the mining vehicle became larger in fig 24 c with the formation of newly separated vortices the previously shedding vortices gradually dissipated and the areas of high vortex volume around the mining vehicle formed in fig 24 d the evolution of the pressure distribution when the mining vehicle was traveling on the slope was shown in fig 25 the low pressure areas appeared at the top and rear of the mining vehicle in fig 25 a corresponding to the flow separation area in fig 24 a the fluid pressure at the front of the mining vehicle was large so that seawater exerted a high resistance to the travel of the mining vehicle with the development of the flow and the dissipation of the vortex the pressure of the flow field around the mining vehicle was reduced and the seawater resistance tended to be stable the final pressure distribution of the flow field was shown in fig 25 b when the mining vehicle traveled at 1 2 m s the relationship between the hydrodynamic resistance and the slope degree β of the seabed was displayed in fig 26 when the slope degree was 5 the hydrodynamic resistance in the x axis was about 7 5 kn and the fluid resistance in the z axis was about 0 5 kn as the slope β increased the f x decreased and the f z gradually increased when the slope degree was 12 5 the hydrodynamic resistance in the x axis was about 6 9 kn and the hydrodynamic resistance in the z axis was about 2 8 kn the flow field of the downslope motion was symmetrical so the hydrodynamic resistance in y axis could be neglected compared with the longitudinal hydrodynamic resistance in the straight motion the corresponding value in the downslope motion was smaller 4 conclusion in this study a series of numerical investigations were proposed to analyze the hydrodynamic characteristics of the deep sea mining vehicle the rsm was utilized to simulate the complicated flow field in three typical motions the major results of this study are as follows 1 the velocity pressure velocity streamline and turbulent kinetic energy distributions of the flow field were symmetrical in the straight motion as the mining vehicle traveling the fluid separated on the surface of the vehicle and formed detached vortices in the backflow regions resulting in the formation of the low pressure areas the pressure difference of the fluid was the main source of the longitudinal hydrodynamic resistance the resistance was proportional to the square of the velocity the average longitudinal hydrodynamic resistance coefficient of the mining vehicle was 0 91 with the increase of the velocity reynolds number the surface friction coefficient increased but the pressure coefficient decreased 2 the velocity pressure velocity streamline and turbulent kinetic energy distributions of the flow field were asymmetrical in the steering motion the wake area was deflected to the inside and the speed of the fluid on the inner side was greater than that on the outer side the source of hydrodynamic resistance during steering motion was similar to that of straight motion however in addition to the longitudinal hydrodynamic resistance the vehicle was also subject to lateral hydrodynamic resistance during its movement the average longitudinal resistance coefficient of the mining vehicle was 1 06 the changing laws of the surface friction and pressure coefficients during steering motion were similar to that of straight motion 3 the phenomenon of fluid separation occurred when the mining vehicle first started to move on the slope and the first and second tail shedding vortices formed in the fourth and seventh seconds the fluid pressure in the flow separation area was relatively low and none of the flow separations appeared in the front of the vehicle which resulted in that the vehicle suffered a large starting resistance and a relatively stable traveling resistance with the increase of the slope degree the f x gradually decreased from 7 5 kn to 6 9 kn and the f z gradually increased from 0 5 kn to 2 8 kn credit authorship contribution statement yu dai conceptualization methodology software validation formal analysis resources data curation writing original draft writing review editing supervision project administration funding acquisition cong xue software validation formal analysis data curation writing original draft visualization qiao su methodology software validation investigation visualization writing review editing xin huang software validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was funded by the national natural science foundation of china grant number 51774324 the national key research and development program of china grant number sq2016yf010109 and the natural science foundation of hunan province grant number 2019jj40380 and 17b063 
20529,a dynamic analysis model for natural gas hydrate ngh production riser was established considering the internal phase transition of hydrate multiphase flow and the external marine environmental loads the model was numerically discretized by the finite element method fem and solved by newmark β method the correctness of the analysis model was verified by an experiment and field testing data the results indicate that the ngh begins to rapidly decompose in the middle of the riser causing the sudden pressure drop in the riser the internal ngh decomposition will significantly increase the axial tension and von mises stress of the riser the von mises stress reaches maximum at the top end of the riser subjected to the distribution of effective axial tension the lateral displacement and bending moment of the riser increase with the increase of flow rate and mixed fluid density in the middle and lower sections and the stress decreases with the increase of flow rate and mixed fluid density the increase of hydrate content and seawater temperature will decrease the lateral displacement and bending moment and the upper part stress of the riser but it will significantly increase the stress in the lower part keywords natural gas hydrate production riser hydrate decomposition multiphase flow 1 introduction the natural gas hydrate ngh is a newly unconventional energy resource which is of great development and application prospects because of its cleanliness and abundant reserves the marine riser is the key channel for ngh production and transition and the fragile part of the offshore production system the riser will deform subjected to the marine environmental loads and the hydrate decomposition in the internal multiphase flow will bring a more complex dynamic response of the ngh riser the ngh riser may be damaged if the deformation and stress are too large thus the dynamic analysis of the riser is important for the development of ngh many scholars have developed numerical simulations on marine risers since the 1970s burke 1973 patel et al 1984 athisakul and chucheepsakul 2008 mao et al 2016 yang et al 2020 most of them have focused on the mechanics of the riser with different marine loads configurations and platform movement in recent years marine riser numerical simulation studies have concentrated on safety issues such as riser stress distribution axial buckling vortex induced vibration and fatigue failure zhou et al 2019 tian et al 2020 amarante and fujarra 2021 nguyen and al safran 2021 ragheb et al 2021 considering that the primary function of the marine riser is to circulate and transport fluid the dynamic response coupling of the internal fluid flow and riser deformation has attracted the attention of scholars lesmez et al 1990 fan et al 2011 klaycham et al 2020 duan et al 2021 then the phenomenon that marine riser vibration induced by the internal high velocity fluid is found furthermore some researchers have studied the mechanical behavior of marine risers considering the combined action of internal high velocity fluid and the external marine environmental loads yamamoto et al 2009 montoya hernandez et al 2014 ma et al 2018 and indicated that the increase of inner fluid speed will increase the damping and stiffness of the riser therefore the displacement and natural frequency of the marine riser will decrease with the increase of the inner fluid velocity some scholars have researched the dynamic response of the marine riser with the internal gas liquid flow an and su 2015 xie et al 2016 ma and srinil 2018 and discussed the possibility of slug flow caused by the gas phase however a multiphase flow is found inside the hydrate production riser the natural gas hydrate undergoes a phase and decomposes into gas with the fluid goes upward the effect of the complicated mass and speed changes of the internal multiphase flow on the mechanics of the ngh riser cannot be ignored some researchers have studied the internal phase transition mechanism of the gas liquid solid fluid of ngh riser wang and sun 2014 mao et al 2016 wei et al 2016 gao et al 2017 and found that the decomposition of hydrate during transporting upward in the pipe string will cause a sudden pressure drop in the bottom hole which may lead to risks in riser damage and well control they point out that the decomposition of hydrate in the wellbore could be inhibited by increasing the fluid velocity and applying wellhead backpressure study on the effect of ngh multiphase flow and its phase transition on riser response is rare lou and liang liang and lou 2020 lou and liang 2020 investigated the influence of the multiphase flow considering the ngh decomposition on the riser vortex induced vibration viv and pointed out that increasing the gas intake ratio could increase the natural frequency of ngh production riser and the changing trends were more evident at higher vibration modes based on these investigations most researches for marine risers considering internal flows have focused on the vibration frequency and viv responses research on the mechanical behavior of ngh production riser considering the internal ngh gas liquid solid multiphase flow and its phase transition and the external marine environmental loads has not been reported yet the understanding of the effect of ngh decomposition on the response of the riser deformation and stress during hydrate production is still unclear therefore this paper established a numerical analysis model for ngh production riser considering the internal phase transition of hydrate multiphase flow and the external marine environmental loads to determine the mechanical property of the ngh production riser the model was solved by using the fem and the newmark β method the dynamic mechanical behavior and the effect of engineering factors on the ngh production riser were discussed the results could provide effective theoretical guidance for the safety of the ngh production riser besides the fluid structure interaction of the pipe string mainly focuses on the periodic vibration which is not considered during analyzing the large deformation of the riser in this paper 2 analysis model the production riser is an irreplaceable channel for the ngh production as shown in fig 1 depending on the mining method the ngh production riser includes drilling riser lifting pipeline and return line etc which will be called for short as a riser in the following text the gas hydrate inside the riser decomposes to form a multiphase flow during the upward movement and the outside of the riser is subjected to marine environmental loads such as wind wave and current 2 1 mechanical model for natural gas hydrate production riser the length of ngh production riser is usually greater than 300 m determined by the water depth of the ngh reservoir the outer diameter of the riser is generally not more than 21 inches 0 5334 m depending on the mining method zhou et al 2018 the riser beam section diameter is much smaller than the beam span and the aspect ratio l d is usually much larger than 500 therefore the riser could be considered as euler bernoulli beam during the analysis of the bending deformation the coordinate system is established with the seabed as the origin considering the inertial force of the multiphase flow axial tension and external marine environmental load the riser differential control equation wilson 2003 mao et al 2016 can be represented as follows 1 e i z 4 x z 4 m m v m 2 t z 2 x z 2 2 m m v m 2 x z t c x t m r m m 2 x t 2 f z where m m is the mass of the inner mixed fluid in kg m that can be calculated by following multiphase model v m is the velocity of the inner mixed fluid in m s that can be calculated by following multiphase model c is the damping coefficient m r is the mass of the riser in kg m and f z is the lateral ocean environment force in n the effective axial tension force on the riser can be represented by the following equation 2 t z t top z l m r m m g d z a o p o a i p i where t top is the riser top tension force in n a o is the outer cross sectional area in m2 a i is the inner cross sectional area in m2 p o is the external seawater pressure in mpa p i is the pressure in the pipeline in mpa l is the depth of the water surface in m considering the inner hydrate multiphase flow and its transition the mass and velocity of the inner fluid are the important parameters of the riser differential control equation equation 1 which can be determined by the following multiphase flow analysis model the mixture fluid that includes the natural gas hydrate particle solids is transported upward through the riser during ngh production the inner fluid will transform to the gas liquid solid multiphase flow due to the decomposition of ngh with the increase of seawater temperature and pressure drop the water resulting from the decomposition of hydrate is hypothesized to be ignored thus the multiphase flow model can be proposed the gas continuity equation could be written as 3 ρ g v g e g a z ρ g e g a t a i x g r h the continuity equations of the liquid and solid phases can be expressed as 4 ρ l v l e l a z ρ l e l a t 0 5 ρ s v s e s a z ρ s e s a t a i r h where ρ g ρ l and ρ s are the density of the gas fluid and solid hydrate in kg m 3 respectively v g v l v s are the speed of the gas fluid and solid hydrate in m s respectively e g e l e s are the gas fraction liquid holdup solid concentration respectively x g is the mass fraction of natural gas in the hydrate the momentum equation could be written as follows wang 2009 wang and sun 2014 6 t i g l s ρ i v i e i z i g l s ρ i v i 2 e i i g l s ρ i e i g d p d z 0 thus the endothermic decomposition of hydrate is considered to calculate the temperature in the pipeline 7 t i g l s ρ i e i c i t a a i δ h h r h a i m h i g l s v i c i t a z π d o u t a t where t a is the temperature field of the seawater zeng and zhou 2003 nie et al 2016 c i is the specific heat of gas fluid and solid t is the temperature in the pipeline in k δ h h is the decomposition heat of ngh in j mol u is the heat transfer coefficient m h is the average molecular mass of ngh in kg mol the decomposition rate of ngh could be expressed as kim et al 1987 8 r h k a s p eq exp 1 δ e r t 1 p g p eq where k is the ngh decomposition constant in min 1 mpa 1 δ e is the activation energy in j mol r is the gas constant 8 314 j mol k t is the temperature in k p g is the pressure of gas phase in mpa p eq is the ngh phase equilibrium pressure which can be calculated through the empirical equation proposed by dzyuba and zektser 2013 9 p eq exp t 264 9661 9 6339 the inner pressure of the pipeline varies with the water depth mass and velocity of the fluid during the production of ngh thus the pressure drop in the pipeline can be written as follows wei et al 2016 10 d p d z ρ m g 2 f x v m 2 ρ m d o d i ρ m v m d v m d z the mass and density of the mixed fluid could be calculated as follows 11 m m ρ m a ρ m ρ g e g ρ l e l ρ s e s the speed of mixed fluid could be express as 12 v m v g e g v l e l v s e s where ρ g ρ l and ρ s are the densities of the gas liquid and solid phases in kg m3 respectively f x is the flow friction coefficient d o is the outer diameter in m d i is the inner diameter in m 2 2 boundary conditions the boundary conditions of the multiphase flow model are shown as follows 13 t 0 t t in t l t t a l t p l t p out the conventional hydrate mining methods usually include the depressurization method and thermal stimulation method etc these methods based on the traditional drilling technology establish the cycling channel by the drilling pipe and drilling riser yoshihiro et al 2016 chen et al 2018 collett 2019 xia et al 2019 two ends of these risers are connected by a diverter flex joint fig 2 a the rotation stiffness of the bottom diverter flex joint is k b and the rotation stiffness of the top diverter flex joint is k u mao et al 2016 therefore the boundary condition can be written as follows 14 bottom x 0 t 0 e i 2 x 0 t z 2 k b x 0 t z top x l t 0 e i 2 x l t z 2 k u x l t z other methods to exploit the hydrate soil using an excavator including the cutter suction method and solid fluidization method etc the mixed fluid of hydrate is bumped from a smaller diameter lifting pipeline or return line to the platform yin 2007 sakurai et al 2016 wei et al 2016 zhou et al 2018 two ends of these risers are connected by a fixed connection yin 2007 chen et al 2009 where the displacement and rotation are restricted fig 2b therefore the boundary condition can be written as follows 15 bottom x 0 t 0 x 0 t z 0 top x l t 0 x l t z 0 where t in is the temperature of the inlet in k p out is the pressure of the outlet in mpa k b is the rotation stiffness of the lower flexible joint in n m deg k u is the rotation stiffness of the upper flexible joint in n m deg 2 3 calculation of the marine environmental loads the primary riser environmental loads are generated by sea waves ocean currents and wind the wave load zhu 1991 wilson 2003 wang and liang 2013 can be calculated as follows 16 f w z 1 2 c d ρ w d z u x u x c m ρ w π d z 2 4 d u x d t where c d is the drag force coefficient ρ w is the seawater density in kg m3 d z is the outer diameter of the riser c m is the inertia force coefficient can be calculated by c m 1 c m is the added mass coefficients the horizontal velocity and acceleration of the water particles can be determined by wang and liang 2013 17 u x π h t wv e 2 π z l λ cos 2 π x λ t t wv 18 d u x d t 2 π 2 h t wv 2 e 2 π z l λ sin 2 π x λ t t wv where h is the wave height in m t wv is the wave period in s λ is the wave length in m λ g t 2 2 π x is the horizontal position in m the ocean current flow is mainly generated by the tide and wind and the current load could be calculated as follows 19 f c z 1 2 c d d z ρ w u z 2 where u z is the current speed generated by the wind and tidal current in m s the current velocity profile according to the ekman drift current theory zhu 1991 can be written as follows 20 u z v cw z l m m v d z l 1 7 z l m u z v d z l 1 7 z l m where m is the friction depth in m v d is the tidal current that can be determined by experience zhu 1991 the wind will cause the surface water to flow so the wind induced current speed zhu 1991 can be expressed as follows 21 v cw k w v w where k w is the wind coefficient v w is the wind speed in m s zhu 1991 wilson 2003 wang and liang 2013 2 4 calculation of the von mises stress the von mises stress is used to analyze the safety of the riser which can be calculated as follows 22 σ e 1 2 σ r σ θ 2 σ r σ z 2 σ θ σ z 2 where σ r σ θ σ z are the three principal stresses in mpa namely radial stresses annular stresses and axial stresses respectively the lame formula is presented as follows lee 1998 23 σ r p i r i 2 p o r o 2 r o 2 r i 2 p i p o r o 2 r i 2 r o 2 r i 2 r 2 σ θ p i r i 2 p o r o 2 r o 2 r i 2 p i p o r o 2 r i 2 r o 2 r i 2 r 2 where p o is the external pressure of the riser in mpa p i is the internal pressure of the pipe in mpa r o is the external radius of the pipe in m r i is the inside radius of the pipe in m theoretical deduction proved that the maximum radial stress and annular stress of the pipe string occur at the inner pipe wall du and yuan 1993 therefore the radial stresses and annular stresses can be written as follows 24 σ r p i σ θ p i r o 2 r i 2 r o 2 r i 2 2 p o r o 2 r o 2 r i 2 the axial stress is composed of effective axial tension and bending stress which is calculated as follows 25 σ z σ t z σ m t z π 4 d o 2 d i 2 m π 32 d o 4 d i 4 d o t h m e i 2 x z 2 where th is the wall thickness of the riser in m 3 solution of the analysis model the finite difference method is applied to solve the multiphase flow model for ngh production wang 2009 wang and sun 2014 the mass and speed of the mixed fluid will be determined and considered in the mechanical model for the ngh production riser the fem is used to solve the ngh production riser control equation equation 1 the typical structural dynamics motion equation chopra 1995 wilson 2003 and can be expressed as follows 26 m u c u k u f t where m is the mass matrix c is the damping matrix k is the stiffness matrix u is the nodal displacement u is the nodal velocity u is the nodal acceleration and f t is the nodal load the piecewise cubic hermite interpolation is used to discretize the dynamics equation the shape functions are shown as follows 27 n 1 1 3 z 2 l 2 2 z 3 l 3 n 2 z 2 z 2 l z 3 l 2 n 3 3 z 2 l 2 2 z 3 l 3 n 4 z 2 l z 3 l 2 the element mass matrix can be expressed as follows 28 m e 0 l n i m r m m n j d z the element damping matrix can be written as follows 29 c e 0 l n i 2 m m v m n j z d z 0 l n i c n j d z the element stiffness matrix can be expressed as follows 30 k e k e 1 k e 2 k e 3 k e 4 31 k e 1 e i 0 l 2 n i z 2 t 2 n j z 2 d z k e 2 0 l n i z t m m v m 2 t top m m m e g l n j z d z k e 3 0 l n i z t m r g m m 2 m e g z n j z d z k e 4 0 l m r g m m 2 m e g n j z d z where l is the element length m e is the added mass of the production riser in kg m the equation 26 can be solved by the newmark β method after assembling the element matrix into the global matrix chopra 1995 wilson 2003 mao et al 2019 the procedure for obtaining the solution is shown in fig 3 4 validity of the analysis model an experiment was conducted to simulate the riser deformation subjected to the internal fluid and external loads to prove the validity of the analysis model fig 4 shows the sketch and photograph of the experimental facilities including a steel frame motor pulley wirerope system a riser model a gas supply system and a data acquisition system the environment with low temperature and high pressure is needed for the simulation of hydrate phase transition which is not suitable for carrying out riser deformation experiments therefore high velocity gas was pumped into the pipe from the bottom end by the gas supply system which could simulate the internal fluid of the production riser two ends of the riser were connected to a slider which could slide in the upper and lower horizontal track respectively the motor pulley wirerope system pulled the two ends of the riser model to move along the horizontal track in the water and then a uniform flow was obtained through the relative movement between the riser and the water the movement velocity of the riser can be regarded as the uniform flow velocity which can be calculated by dividing distance by time the velocity of the internal gas is calculated from the cross sectional area and gas flow rate measured by the flow meter the strain gauges were attached to the pipe in four directions to collect the deformation data and the riser strain data will be used to calculate the lateral displacement of each position through the modal analysis method the experimental pipe is made of polythene and the physical parameters of the pipe and in the experiment are shown in table 1 the detailed experimentation and data processing refer to relevant literature lie and kaasen 2006 mao et al 2015 2020a fig 5 shows the comparison of the maximum deformation of the experimental riser and the result calculated by the numerical model under the experimental condition the numerical result is in good agreement with the experimental result thereby proving the correctness of the numerical model the slight difference between the two results might be attributed to the effect of strain gauges and electric wire on the experimental riser the china national offshore oil corporation cnooc successfully implemented the world s first solid fluidization well testing and production of marine ngh in the shenhu area of the south china sea in may 2017 zhou et al 2018 the wellhead pressure of the test data could be used to validate the ngh multiphase flow model the core concept of the solid fluidization method is to pulverize the non diagenetic ngh sediments and transport the mixture through a lifting riser the basic parameters of the solid fluidization test well in the shenhu area are shown in table 2 the comparison results of the predicted wellhead pressure with the measured data from the well are shown in fig 6 it can be found that the predicted wellhead pressure is in good agreement with the measured data 5 application and case study based on the submarine pump lifting method for ngh production yin 2007 sakurai et al 2016 wei et al 2016 the mechanical behavior of ngh production riser considering the internal phase transition of the ngh multiphase flow and the external marine environmental loads have been analyzed the primary parameters of the production riser are shown in table 3 the production riser adopts the return line with fixed connections at both ends regardless of the configuration of the buoyancy block yin 2007 the temperature and pressure of the hydrate remain stable under the initial conditions of the seabed therefore the hydrate is considered not to decompose on the seabed and the interior of the riser is initially a liquid solid mixture fluid xie 2016 5 1 mechanical behavior fig 7 a shows the distribution of gas void fraction changes with time during ngh production the gas void fraction begins to increase in the middle part of the riser which means the ngh starts to decompose into gas and then increases sharply as the hydrate continues to decompose it reaches the maximal gas void fraction of 0 61 at the top outlet in approximately 150 s the gas void fraction in the last time is shown as the red bold line in fig 7a and the pressure distribution is shown in fig 7b the mechanical characteristic of the riser in the last time will be analyzed in the following text fig 8 a presents the cloud picture of lateral displacement considering the inner ngh decomposition in the riser the displacement of the ngh production riser increases rapidly from 0 to 40 s and then gradually stabilizes the maximum displacement appears near the middle position and the maximum displacement is approximately 15 5 m the red lines in fig 8 are the riser mechanical characteristic with the hydrate decomposition the largest displacement of the riser appears near the middle part fig 8b due to the two ends are fixedly connected the maximum bending moment fig 8c appears at the bottom and the maximum value is 13 kn m fig 8d presented that the von mises stress decrease with the water depth increase and a sharp increase is found near the two ends because of the stress concentration phenomenon in the connecting part mao et al 2019 the maximum von mises stress located at the top end of the riser and the maximum value is 200 mpa moreover the marine environmental loads reach the maximum at the water surface mao et al 2016 2020b which leads to a sudden change of the displacement bending moment and von mises stress of the riser near the water surface part compared with the riser does not consider hydrate decomposition blue line in fig 8 the lateral displacement and bending moment of the ngh production riser are smaller but the stress of the ngh production riser is larger due to the increase of the effective axial tension the following reasons are account for these phenomena the cross sectional mass and pressure of the fluid inside the riser decrease as the gas void fraction increases with the hydrate decomposition during transportation as the top tension in the effective axial tension formula 2 remains unchanged the decrease in the internal fluid mass in the second term of formula 2 and the increase in the difference between the internal and external pressure the last two terms of formula 2 will lead to an increase in the effective axial tension fig 7e further leading to an increase of the stiffness matrix value the riser displacement decreases with the increase of stiffness under the same load which indicates that the lateral displacement is inversely proportional to its effective axial tension in addition an increased tendency to increase the displacement of the riser with a smaller mass of inner fluid is found in the area with a higher gas void fraction under the same load therefore the combined effect of the opposite change law of mass and stiffness results in changes in the displacement and bending moment of the riser above approximately 900 m notably the riser stress appears to increase significantly in the middle part red line in fig 7d after considering the decomposition of the hydrate according to formula 20 23 stress is related to the fluid pressure inside and outside the riser as shown in fig 6 a large amount of hydrate decomposes in the middle of the riser to release gas and the pressure inside the riser has a significant drop blue line in fig 6b and even a negative pressure difference area appears where the absolute pressure of the difference between the internal and external fluid increases which leads to an increase of stress in the local regions furthermore the increase in effective axial tension will lead to an increase in stress as it is part of the axial stress 5 2 effects of flow rate on the mechanical behavior of the ngh production riser fig 9 shows the mechanical behavior of the ngh production riser at a different flow rate as shown in fig 9a and b the displacement and bending moment of the riser increase with the increase of the flow rate in the middle and lower part the maximum displacement remains in the middle of the riser and the maximum bending moment is always at the bottom end the fluid velocity increases as the flow rate increases moreover the heat exchange time between the mixture and the external seawater is small and the hydrate decomposition is later at a higher position fig 9e wang and sun 2014 liang and lou 2020 this phenomenon leads to a decrease in the volume of gas in the upper part of the ngh production riser and an increase in the pressure of the inside liquid column fig 9f furthermore the difference between the external and internal pressure of the riser decreases the local effective axial tension and stiffness decrease and then the displacement and bending moment of the riser increase in addition the displacement and bending moment of the riser slightly change with the flow rate in the area above 900 m because the liquid volume increases with the increase of flow rate increasing the mass of the riser and then the riser displacement tends to decrease meanwhile the internal pressure of the riser and the effective axial tension slightly change in the upper region fig 9c shows that the riser von mises stress decreases as the flow rate increases particularly in the middle and lower parts the stress near the top almost remains unchanged and the maximum stress always appears at the top of the riser this is because the effective axial tension in the middle and lower part of the riser decreases as the flow rate increases fig 9d whereas the bending moment increases locally at the bottom in addition the change in the upper area is small in the area above approximately 900 m because of the internal pressure of the riser and the effective axial tension thus the stress change in this region is also small therefore increasing the flow rate will lead to an increase in the displacement and bending moment of the middle and lower parts of the riser but it will reduce the effective axial tension and von mises stress of the riser therefore hydrate mining can be allowed to produce a large flow rate greater than 40 l s 5 3 effects of hydrate content on the mechanical behavior of the ngh production riser the solid phase in the hydrate multiphase is usually a cohesive mixture of hydrate particles and impurity particles wang and sun 2014 wei et al 2016 the hydrate content in the mixture will affect the hydrate decomposition position and riser characteristics during ngh production therefore the dynamic characteristics of the riser considering the hydrate content and mass fraction of hydrate particles in the solid phase changing from 10 to 25 are shown in fig 9 the lateral displacement and bending moment of the riser decrease with the increase of hydrate content because the effective decomposition area formula 8 increases with the increase of the hydrate content thereby increasing the decomposition rate of hydrate and the decrease in the starting position of decomposition fig 10 e meanwhile a longer multiphase flow section in the upper part of the riser leads to a decrease in the internal pressure fig 9f then the difference between the external and internal pressure of the wellbore the last two items in equation 2 increases therefore as the hydrate content increases the effective axial tension fig 9d and stiffness of the pipe string increase and the displacement and bending moment of the pipe string decrease fig 9c presents that the riser von mises stress increases significantly with the increase of hydrate content in the middle and lower parts and decreases slightly in the middle and upper parts the maximum stress always appears at the top of the riser because of the significant decrease in the internal pressure of the riser as the hydrate content increases fig 9f which leads to a significant increase in the effective axial tension in the middle and lower parts however the internal pressure and effective axial tension of the middle and upper riser slightly vary in the opposite trend compared with that of the lower part the ngh reservoirs with a hydrate content of 10 25 are quite suitable for mining by submarine pump lifting method without safety threaten to the riser 5 4 influence of mixed fluid density on the mechanical behavior of the ngh production riser fig 11 shows the mechanical behavior of the ngh production riser at different mixed fluid densities on the initial bottom position the lateral displacement and bending moment of the riser increase with the increase of the hydrate mixed fluid density and the increase is evident in the middle and lower parts fig 11 e shows that the increase of mixed fluid density has little effect on the gas void fraction during hydrate decomposition but the pressure and mass of fluid inside the riser increase fig 11f consequently local effective axial tension fig 11d and stiffness decrease and riser displacement and bending moment increase in addition the internal and external pressure difference caused by the density change is proportional to the depth moreover the change of the liquid phase density has less effect on the mass of the internal fluid for the area with a higher gas void fraction in the upper part therefore the degree of bottom tension reduction and the resulting increase in riser displacement and bending moment are more evident in the middle and lower regions fig 11c shows that the riser von mises stress decreases with the increase of the hydrate mixed fluid density and the stress change near the top end is small this result is consistent with the variation of the effective axial tension of the pipe string with the mixed fluid density fig 11d therefore it can be considered that the riser stress is mainly affected by the effective axial tension in addition the mixed fluid density is determined by the fluid density and solid concentration therefore increasing the density of the conveying fluid or increasing the production rate to increase the solid concentration is important to inhibit the decomposition of hydrate and reduce the stress of the production riser 5 5 effects of seawater temperature on the mechanical behavior of the ngh production riser seawater temperature gradually increases from the seabed to the water surface zeng and zhou 2003 nie et al 2016 the temperature at the water surface and its gradient along the depth will directly affect the internal hydrate decomposition therefore the mechanical behavior of the riser considering the water surface temperature change from 20 c to 23 c is analyzed and shown in fig 12 the riser displacement and bending moment decrease with the increase of water surface temperature as the water surface temperature rises the temperature of the seawater increases in the depth direction and the hydrate inside the riser absorbs more heat causing it to decompose earlier at a lower position fig 12e moreover as the pressure inside the wellbore decreases fig 12e the effective axial tension fig 12d and stiffness increase fig 12c indicated that the riser von mises stress increases with the increase of water surface temperature below 750 m and slightly decreases with the increase of water surface temperature in the remaining upper area the maximum stress is always located at the top end this finding is the same as the trend of the axial tension distribution with temperature fig 12d therefore during hydrate production and transportation the increase of seawater and wellbore temperature will cause the rapid decomposition and phase change of the hydrate multiphase flow and a decrease of wellbore pressure which will significantly increase the von mises stress of the riser particularly at the bottom connection part it is a befitting temperature of 20 c in the top outlet for the ngh production 6 conclusions this work studied the dynamic mechanical behavior of the ngh production riser by establishing a numerical mechanics model considering the internal phase transition of the hydrate multiphase flow and the external marine environmental loads the effects of the flow rate hydrate content mixed fluid density and seawater temperature on the mechanical behavior of the ngh production riser were discussed the major new findings of this work are presented as follows 1 ngh begins to rapidly decompose in the middle of the riser causing the sudden pressure drop in the riser and the increase in axial effective tension and von mises stress the effective tension and von mises stress reach a maximum at the top connection position where measurement such as increasing the wall thickness or configuring buoyancy block should be taken to ensure the riser safety 2 the displacement and bending moment of the ngh production riser increase with the increase of flow rate and mixed fluid density in the middle and lower sections and the von mises stress decreases with the increase of flow rate and mixed fluid density therefore a large flow rate of 40 l s or more can increase the ngh production and inhibit the inner hydrate decomposition to reduce the stress of the ngh production riser 3 the increase of hydrate content and seawater temperature will decrease the lateral displacement and bending moment of the riser and the upper part von mises stress of the riser but it will significantly increase the von mises in the lower part the ngh reservoirs with a hydrate content of 10 25 are quite suitable for mining by submarine pump lifting method without safety threaten to the riser however for the ngh reservoirs with high hydrate content or high temperature appropriate measures would be considered to suppress the decomposition of hydrate 4 the phenomenon that the von mises stress of the ngh production riser changes in contrast to the displacement and bending moment with the engineering influencing factor was found the von mises stress distribution of the ngh riser is mainly subjected to the effective axial tension therefore further research on the mechanical properties of hydrate production riser coupling of vertical and horizontal deformation is of great significance in the future contributions liangjie mao and qingyou liu conceived overarching research goals and aims liangjie mao and song zeng developed and designed the methodology and model and wrote the paper song zeng and juan li performed the verification experiment qingyou liu and guorong wang reviewed and edited the manuscript all authors read and approved the manuscript credit statement i confirm that this paper has not been published previously and is not under consideration elsewhere i certify that to the best of my knowledge the content of this paper is our work this paper has not been submitted for any degree or other purposes and that if accepted will not be published elsewhere in the same form in english or any other language without the written consent of the publisher declaration of competing interest the authors declare that there is no conflict of interest regarding the publication of this paper acknowledgments the authors gratefully acknowledge the financial support of the national key research and development program of china 2019yfc0312303 cnpc innovation foundation 2020d 5007 0210 open fund pln2020 7 of state key laboratory of oil and gas reservoir geology and exploitation southwest petroleum university 
20529,a dynamic analysis model for natural gas hydrate ngh production riser was established considering the internal phase transition of hydrate multiphase flow and the external marine environmental loads the model was numerically discretized by the finite element method fem and solved by newmark β method the correctness of the analysis model was verified by an experiment and field testing data the results indicate that the ngh begins to rapidly decompose in the middle of the riser causing the sudden pressure drop in the riser the internal ngh decomposition will significantly increase the axial tension and von mises stress of the riser the von mises stress reaches maximum at the top end of the riser subjected to the distribution of effective axial tension the lateral displacement and bending moment of the riser increase with the increase of flow rate and mixed fluid density in the middle and lower sections and the stress decreases with the increase of flow rate and mixed fluid density the increase of hydrate content and seawater temperature will decrease the lateral displacement and bending moment and the upper part stress of the riser but it will significantly increase the stress in the lower part keywords natural gas hydrate production riser hydrate decomposition multiphase flow 1 introduction the natural gas hydrate ngh is a newly unconventional energy resource which is of great development and application prospects because of its cleanliness and abundant reserves the marine riser is the key channel for ngh production and transition and the fragile part of the offshore production system the riser will deform subjected to the marine environmental loads and the hydrate decomposition in the internal multiphase flow will bring a more complex dynamic response of the ngh riser the ngh riser may be damaged if the deformation and stress are too large thus the dynamic analysis of the riser is important for the development of ngh many scholars have developed numerical simulations on marine risers since the 1970s burke 1973 patel et al 1984 athisakul and chucheepsakul 2008 mao et al 2016 yang et al 2020 most of them have focused on the mechanics of the riser with different marine loads configurations and platform movement in recent years marine riser numerical simulation studies have concentrated on safety issues such as riser stress distribution axial buckling vortex induced vibration and fatigue failure zhou et al 2019 tian et al 2020 amarante and fujarra 2021 nguyen and al safran 2021 ragheb et al 2021 considering that the primary function of the marine riser is to circulate and transport fluid the dynamic response coupling of the internal fluid flow and riser deformation has attracted the attention of scholars lesmez et al 1990 fan et al 2011 klaycham et al 2020 duan et al 2021 then the phenomenon that marine riser vibration induced by the internal high velocity fluid is found furthermore some researchers have studied the mechanical behavior of marine risers considering the combined action of internal high velocity fluid and the external marine environmental loads yamamoto et al 2009 montoya hernandez et al 2014 ma et al 2018 and indicated that the increase of inner fluid speed will increase the damping and stiffness of the riser therefore the displacement and natural frequency of the marine riser will decrease with the increase of the inner fluid velocity some scholars have researched the dynamic response of the marine riser with the internal gas liquid flow an and su 2015 xie et al 2016 ma and srinil 2018 and discussed the possibility of slug flow caused by the gas phase however a multiphase flow is found inside the hydrate production riser the natural gas hydrate undergoes a phase and decomposes into gas with the fluid goes upward the effect of the complicated mass and speed changes of the internal multiphase flow on the mechanics of the ngh riser cannot be ignored some researchers have studied the internal phase transition mechanism of the gas liquid solid fluid of ngh riser wang and sun 2014 mao et al 2016 wei et al 2016 gao et al 2017 and found that the decomposition of hydrate during transporting upward in the pipe string will cause a sudden pressure drop in the bottom hole which may lead to risks in riser damage and well control they point out that the decomposition of hydrate in the wellbore could be inhibited by increasing the fluid velocity and applying wellhead backpressure study on the effect of ngh multiphase flow and its phase transition on riser response is rare lou and liang liang and lou 2020 lou and liang 2020 investigated the influence of the multiphase flow considering the ngh decomposition on the riser vortex induced vibration viv and pointed out that increasing the gas intake ratio could increase the natural frequency of ngh production riser and the changing trends were more evident at higher vibration modes based on these investigations most researches for marine risers considering internal flows have focused on the vibration frequency and viv responses research on the mechanical behavior of ngh production riser considering the internal ngh gas liquid solid multiphase flow and its phase transition and the external marine environmental loads has not been reported yet the understanding of the effect of ngh decomposition on the response of the riser deformation and stress during hydrate production is still unclear therefore this paper established a numerical analysis model for ngh production riser considering the internal phase transition of hydrate multiphase flow and the external marine environmental loads to determine the mechanical property of the ngh production riser the model was solved by using the fem and the newmark β method the dynamic mechanical behavior and the effect of engineering factors on the ngh production riser were discussed the results could provide effective theoretical guidance for the safety of the ngh production riser besides the fluid structure interaction of the pipe string mainly focuses on the periodic vibration which is not considered during analyzing the large deformation of the riser in this paper 2 analysis model the production riser is an irreplaceable channel for the ngh production as shown in fig 1 depending on the mining method the ngh production riser includes drilling riser lifting pipeline and return line etc which will be called for short as a riser in the following text the gas hydrate inside the riser decomposes to form a multiphase flow during the upward movement and the outside of the riser is subjected to marine environmental loads such as wind wave and current 2 1 mechanical model for natural gas hydrate production riser the length of ngh production riser is usually greater than 300 m determined by the water depth of the ngh reservoir the outer diameter of the riser is generally not more than 21 inches 0 5334 m depending on the mining method zhou et al 2018 the riser beam section diameter is much smaller than the beam span and the aspect ratio l d is usually much larger than 500 therefore the riser could be considered as euler bernoulli beam during the analysis of the bending deformation the coordinate system is established with the seabed as the origin considering the inertial force of the multiphase flow axial tension and external marine environmental load the riser differential control equation wilson 2003 mao et al 2016 can be represented as follows 1 e i z 4 x z 4 m m v m 2 t z 2 x z 2 2 m m v m 2 x z t c x t m r m m 2 x t 2 f z where m m is the mass of the inner mixed fluid in kg m that can be calculated by following multiphase model v m is the velocity of the inner mixed fluid in m s that can be calculated by following multiphase model c is the damping coefficient m r is the mass of the riser in kg m and f z is the lateral ocean environment force in n the effective axial tension force on the riser can be represented by the following equation 2 t z t top z l m r m m g d z a o p o a i p i where t top is the riser top tension force in n a o is the outer cross sectional area in m2 a i is the inner cross sectional area in m2 p o is the external seawater pressure in mpa p i is the pressure in the pipeline in mpa l is the depth of the water surface in m considering the inner hydrate multiphase flow and its transition the mass and velocity of the inner fluid are the important parameters of the riser differential control equation equation 1 which can be determined by the following multiphase flow analysis model the mixture fluid that includes the natural gas hydrate particle solids is transported upward through the riser during ngh production the inner fluid will transform to the gas liquid solid multiphase flow due to the decomposition of ngh with the increase of seawater temperature and pressure drop the water resulting from the decomposition of hydrate is hypothesized to be ignored thus the multiphase flow model can be proposed the gas continuity equation could be written as 3 ρ g v g e g a z ρ g e g a t a i x g r h the continuity equations of the liquid and solid phases can be expressed as 4 ρ l v l e l a z ρ l e l a t 0 5 ρ s v s e s a z ρ s e s a t a i r h where ρ g ρ l and ρ s are the density of the gas fluid and solid hydrate in kg m 3 respectively v g v l v s are the speed of the gas fluid and solid hydrate in m s respectively e g e l e s are the gas fraction liquid holdup solid concentration respectively x g is the mass fraction of natural gas in the hydrate the momentum equation could be written as follows wang 2009 wang and sun 2014 6 t i g l s ρ i v i e i z i g l s ρ i v i 2 e i i g l s ρ i e i g d p d z 0 thus the endothermic decomposition of hydrate is considered to calculate the temperature in the pipeline 7 t i g l s ρ i e i c i t a a i δ h h r h a i m h i g l s v i c i t a z π d o u t a t where t a is the temperature field of the seawater zeng and zhou 2003 nie et al 2016 c i is the specific heat of gas fluid and solid t is the temperature in the pipeline in k δ h h is the decomposition heat of ngh in j mol u is the heat transfer coefficient m h is the average molecular mass of ngh in kg mol the decomposition rate of ngh could be expressed as kim et al 1987 8 r h k a s p eq exp 1 δ e r t 1 p g p eq where k is the ngh decomposition constant in min 1 mpa 1 δ e is the activation energy in j mol r is the gas constant 8 314 j mol k t is the temperature in k p g is the pressure of gas phase in mpa p eq is the ngh phase equilibrium pressure which can be calculated through the empirical equation proposed by dzyuba and zektser 2013 9 p eq exp t 264 9661 9 6339 the inner pressure of the pipeline varies with the water depth mass and velocity of the fluid during the production of ngh thus the pressure drop in the pipeline can be written as follows wei et al 2016 10 d p d z ρ m g 2 f x v m 2 ρ m d o d i ρ m v m d v m d z the mass and density of the mixed fluid could be calculated as follows 11 m m ρ m a ρ m ρ g e g ρ l e l ρ s e s the speed of mixed fluid could be express as 12 v m v g e g v l e l v s e s where ρ g ρ l and ρ s are the densities of the gas liquid and solid phases in kg m3 respectively f x is the flow friction coefficient d o is the outer diameter in m d i is the inner diameter in m 2 2 boundary conditions the boundary conditions of the multiphase flow model are shown as follows 13 t 0 t t in t l t t a l t p l t p out the conventional hydrate mining methods usually include the depressurization method and thermal stimulation method etc these methods based on the traditional drilling technology establish the cycling channel by the drilling pipe and drilling riser yoshihiro et al 2016 chen et al 2018 collett 2019 xia et al 2019 two ends of these risers are connected by a diverter flex joint fig 2 a the rotation stiffness of the bottom diverter flex joint is k b and the rotation stiffness of the top diverter flex joint is k u mao et al 2016 therefore the boundary condition can be written as follows 14 bottom x 0 t 0 e i 2 x 0 t z 2 k b x 0 t z top x l t 0 e i 2 x l t z 2 k u x l t z other methods to exploit the hydrate soil using an excavator including the cutter suction method and solid fluidization method etc the mixed fluid of hydrate is bumped from a smaller diameter lifting pipeline or return line to the platform yin 2007 sakurai et al 2016 wei et al 2016 zhou et al 2018 two ends of these risers are connected by a fixed connection yin 2007 chen et al 2009 where the displacement and rotation are restricted fig 2b therefore the boundary condition can be written as follows 15 bottom x 0 t 0 x 0 t z 0 top x l t 0 x l t z 0 where t in is the temperature of the inlet in k p out is the pressure of the outlet in mpa k b is the rotation stiffness of the lower flexible joint in n m deg k u is the rotation stiffness of the upper flexible joint in n m deg 2 3 calculation of the marine environmental loads the primary riser environmental loads are generated by sea waves ocean currents and wind the wave load zhu 1991 wilson 2003 wang and liang 2013 can be calculated as follows 16 f w z 1 2 c d ρ w d z u x u x c m ρ w π d z 2 4 d u x d t where c d is the drag force coefficient ρ w is the seawater density in kg m3 d z is the outer diameter of the riser c m is the inertia force coefficient can be calculated by c m 1 c m is the added mass coefficients the horizontal velocity and acceleration of the water particles can be determined by wang and liang 2013 17 u x π h t wv e 2 π z l λ cos 2 π x λ t t wv 18 d u x d t 2 π 2 h t wv 2 e 2 π z l λ sin 2 π x λ t t wv where h is the wave height in m t wv is the wave period in s λ is the wave length in m λ g t 2 2 π x is the horizontal position in m the ocean current flow is mainly generated by the tide and wind and the current load could be calculated as follows 19 f c z 1 2 c d d z ρ w u z 2 where u z is the current speed generated by the wind and tidal current in m s the current velocity profile according to the ekman drift current theory zhu 1991 can be written as follows 20 u z v cw z l m m v d z l 1 7 z l m u z v d z l 1 7 z l m where m is the friction depth in m v d is the tidal current that can be determined by experience zhu 1991 the wind will cause the surface water to flow so the wind induced current speed zhu 1991 can be expressed as follows 21 v cw k w v w where k w is the wind coefficient v w is the wind speed in m s zhu 1991 wilson 2003 wang and liang 2013 2 4 calculation of the von mises stress the von mises stress is used to analyze the safety of the riser which can be calculated as follows 22 σ e 1 2 σ r σ θ 2 σ r σ z 2 σ θ σ z 2 where σ r σ θ σ z are the three principal stresses in mpa namely radial stresses annular stresses and axial stresses respectively the lame formula is presented as follows lee 1998 23 σ r p i r i 2 p o r o 2 r o 2 r i 2 p i p o r o 2 r i 2 r o 2 r i 2 r 2 σ θ p i r i 2 p o r o 2 r o 2 r i 2 p i p o r o 2 r i 2 r o 2 r i 2 r 2 where p o is the external pressure of the riser in mpa p i is the internal pressure of the pipe in mpa r o is the external radius of the pipe in m r i is the inside radius of the pipe in m theoretical deduction proved that the maximum radial stress and annular stress of the pipe string occur at the inner pipe wall du and yuan 1993 therefore the radial stresses and annular stresses can be written as follows 24 σ r p i σ θ p i r o 2 r i 2 r o 2 r i 2 2 p o r o 2 r o 2 r i 2 the axial stress is composed of effective axial tension and bending stress which is calculated as follows 25 σ z σ t z σ m t z π 4 d o 2 d i 2 m π 32 d o 4 d i 4 d o t h m e i 2 x z 2 where th is the wall thickness of the riser in m 3 solution of the analysis model the finite difference method is applied to solve the multiphase flow model for ngh production wang 2009 wang and sun 2014 the mass and speed of the mixed fluid will be determined and considered in the mechanical model for the ngh production riser the fem is used to solve the ngh production riser control equation equation 1 the typical structural dynamics motion equation chopra 1995 wilson 2003 and can be expressed as follows 26 m u c u k u f t where m is the mass matrix c is the damping matrix k is the stiffness matrix u is the nodal displacement u is the nodal velocity u is the nodal acceleration and f t is the nodal load the piecewise cubic hermite interpolation is used to discretize the dynamics equation the shape functions are shown as follows 27 n 1 1 3 z 2 l 2 2 z 3 l 3 n 2 z 2 z 2 l z 3 l 2 n 3 3 z 2 l 2 2 z 3 l 3 n 4 z 2 l z 3 l 2 the element mass matrix can be expressed as follows 28 m e 0 l n i m r m m n j d z the element damping matrix can be written as follows 29 c e 0 l n i 2 m m v m n j z d z 0 l n i c n j d z the element stiffness matrix can be expressed as follows 30 k e k e 1 k e 2 k e 3 k e 4 31 k e 1 e i 0 l 2 n i z 2 t 2 n j z 2 d z k e 2 0 l n i z t m m v m 2 t top m m m e g l n j z d z k e 3 0 l n i z t m r g m m 2 m e g z n j z d z k e 4 0 l m r g m m 2 m e g n j z d z where l is the element length m e is the added mass of the production riser in kg m the equation 26 can be solved by the newmark β method after assembling the element matrix into the global matrix chopra 1995 wilson 2003 mao et al 2019 the procedure for obtaining the solution is shown in fig 3 4 validity of the analysis model an experiment was conducted to simulate the riser deformation subjected to the internal fluid and external loads to prove the validity of the analysis model fig 4 shows the sketch and photograph of the experimental facilities including a steel frame motor pulley wirerope system a riser model a gas supply system and a data acquisition system the environment with low temperature and high pressure is needed for the simulation of hydrate phase transition which is not suitable for carrying out riser deformation experiments therefore high velocity gas was pumped into the pipe from the bottom end by the gas supply system which could simulate the internal fluid of the production riser two ends of the riser were connected to a slider which could slide in the upper and lower horizontal track respectively the motor pulley wirerope system pulled the two ends of the riser model to move along the horizontal track in the water and then a uniform flow was obtained through the relative movement between the riser and the water the movement velocity of the riser can be regarded as the uniform flow velocity which can be calculated by dividing distance by time the velocity of the internal gas is calculated from the cross sectional area and gas flow rate measured by the flow meter the strain gauges were attached to the pipe in four directions to collect the deformation data and the riser strain data will be used to calculate the lateral displacement of each position through the modal analysis method the experimental pipe is made of polythene and the physical parameters of the pipe and in the experiment are shown in table 1 the detailed experimentation and data processing refer to relevant literature lie and kaasen 2006 mao et al 2015 2020a fig 5 shows the comparison of the maximum deformation of the experimental riser and the result calculated by the numerical model under the experimental condition the numerical result is in good agreement with the experimental result thereby proving the correctness of the numerical model the slight difference between the two results might be attributed to the effect of strain gauges and electric wire on the experimental riser the china national offshore oil corporation cnooc successfully implemented the world s first solid fluidization well testing and production of marine ngh in the shenhu area of the south china sea in may 2017 zhou et al 2018 the wellhead pressure of the test data could be used to validate the ngh multiphase flow model the core concept of the solid fluidization method is to pulverize the non diagenetic ngh sediments and transport the mixture through a lifting riser the basic parameters of the solid fluidization test well in the shenhu area are shown in table 2 the comparison results of the predicted wellhead pressure with the measured data from the well are shown in fig 6 it can be found that the predicted wellhead pressure is in good agreement with the measured data 5 application and case study based on the submarine pump lifting method for ngh production yin 2007 sakurai et al 2016 wei et al 2016 the mechanical behavior of ngh production riser considering the internal phase transition of the ngh multiphase flow and the external marine environmental loads have been analyzed the primary parameters of the production riser are shown in table 3 the production riser adopts the return line with fixed connections at both ends regardless of the configuration of the buoyancy block yin 2007 the temperature and pressure of the hydrate remain stable under the initial conditions of the seabed therefore the hydrate is considered not to decompose on the seabed and the interior of the riser is initially a liquid solid mixture fluid xie 2016 5 1 mechanical behavior fig 7 a shows the distribution of gas void fraction changes with time during ngh production the gas void fraction begins to increase in the middle part of the riser which means the ngh starts to decompose into gas and then increases sharply as the hydrate continues to decompose it reaches the maximal gas void fraction of 0 61 at the top outlet in approximately 150 s the gas void fraction in the last time is shown as the red bold line in fig 7a and the pressure distribution is shown in fig 7b the mechanical characteristic of the riser in the last time will be analyzed in the following text fig 8 a presents the cloud picture of lateral displacement considering the inner ngh decomposition in the riser the displacement of the ngh production riser increases rapidly from 0 to 40 s and then gradually stabilizes the maximum displacement appears near the middle position and the maximum displacement is approximately 15 5 m the red lines in fig 8 are the riser mechanical characteristic with the hydrate decomposition the largest displacement of the riser appears near the middle part fig 8b due to the two ends are fixedly connected the maximum bending moment fig 8c appears at the bottom and the maximum value is 13 kn m fig 8d presented that the von mises stress decrease with the water depth increase and a sharp increase is found near the two ends because of the stress concentration phenomenon in the connecting part mao et al 2019 the maximum von mises stress located at the top end of the riser and the maximum value is 200 mpa moreover the marine environmental loads reach the maximum at the water surface mao et al 2016 2020b which leads to a sudden change of the displacement bending moment and von mises stress of the riser near the water surface part compared with the riser does not consider hydrate decomposition blue line in fig 8 the lateral displacement and bending moment of the ngh production riser are smaller but the stress of the ngh production riser is larger due to the increase of the effective axial tension the following reasons are account for these phenomena the cross sectional mass and pressure of the fluid inside the riser decrease as the gas void fraction increases with the hydrate decomposition during transportation as the top tension in the effective axial tension formula 2 remains unchanged the decrease in the internal fluid mass in the second term of formula 2 and the increase in the difference between the internal and external pressure the last two terms of formula 2 will lead to an increase in the effective axial tension fig 7e further leading to an increase of the stiffness matrix value the riser displacement decreases with the increase of stiffness under the same load which indicates that the lateral displacement is inversely proportional to its effective axial tension in addition an increased tendency to increase the displacement of the riser with a smaller mass of inner fluid is found in the area with a higher gas void fraction under the same load therefore the combined effect of the opposite change law of mass and stiffness results in changes in the displacement and bending moment of the riser above approximately 900 m notably the riser stress appears to increase significantly in the middle part red line in fig 7d after considering the decomposition of the hydrate according to formula 20 23 stress is related to the fluid pressure inside and outside the riser as shown in fig 6 a large amount of hydrate decomposes in the middle of the riser to release gas and the pressure inside the riser has a significant drop blue line in fig 6b and even a negative pressure difference area appears where the absolute pressure of the difference between the internal and external fluid increases which leads to an increase of stress in the local regions furthermore the increase in effective axial tension will lead to an increase in stress as it is part of the axial stress 5 2 effects of flow rate on the mechanical behavior of the ngh production riser fig 9 shows the mechanical behavior of the ngh production riser at a different flow rate as shown in fig 9a and b the displacement and bending moment of the riser increase with the increase of the flow rate in the middle and lower part the maximum displacement remains in the middle of the riser and the maximum bending moment is always at the bottom end the fluid velocity increases as the flow rate increases moreover the heat exchange time between the mixture and the external seawater is small and the hydrate decomposition is later at a higher position fig 9e wang and sun 2014 liang and lou 2020 this phenomenon leads to a decrease in the volume of gas in the upper part of the ngh production riser and an increase in the pressure of the inside liquid column fig 9f furthermore the difference between the external and internal pressure of the riser decreases the local effective axial tension and stiffness decrease and then the displacement and bending moment of the riser increase in addition the displacement and bending moment of the riser slightly change with the flow rate in the area above 900 m because the liquid volume increases with the increase of flow rate increasing the mass of the riser and then the riser displacement tends to decrease meanwhile the internal pressure of the riser and the effective axial tension slightly change in the upper region fig 9c shows that the riser von mises stress decreases as the flow rate increases particularly in the middle and lower parts the stress near the top almost remains unchanged and the maximum stress always appears at the top of the riser this is because the effective axial tension in the middle and lower part of the riser decreases as the flow rate increases fig 9d whereas the bending moment increases locally at the bottom in addition the change in the upper area is small in the area above approximately 900 m because of the internal pressure of the riser and the effective axial tension thus the stress change in this region is also small therefore increasing the flow rate will lead to an increase in the displacement and bending moment of the middle and lower parts of the riser but it will reduce the effective axial tension and von mises stress of the riser therefore hydrate mining can be allowed to produce a large flow rate greater than 40 l s 5 3 effects of hydrate content on the mechanical behavior of the ngh production riser the solid phase in the hydrate multiphase is usually a cohesive mixture of hydrate particles and impurity particles wang and sun 2014 wei et al 2016 the hydrate content in the mixture will affect the hydrate decomposition position and riser characteristics during ngh production therefore the dynamic characteristics of the riser considering the hydrate content and mass fraction of hydrate particles in the solid phase changing from 10 to 25 are shown in fig 9 the lateral displacement and bending moment of the riser decrease with the increase of hydrate content because the effective decomposition area formula 8 increases with the increase of the hydrate content thereby increasing the decomposition rate of hydrate and the decrease in the starting position of decomposition fig 10 e meanwhile a longer multiphase flow section in the upper part of the riser leads to a decrease in the internal pressure fig 9f then the difference between the external and internal pressure of the wellbore the last two items in equation 2 increases therefore as the hydrate content increases the effective axial tension fig 9d and stiffness of the pipe string increase and the displacement and bending moment of the pipe string decrease fig 9c presents that the riser von mises stress increases significantly with the increase of hydrate content in the middle and lower parts and decreases slightly in the middle and upper parts the maximum stress always appears at the top of the riser because of the significant decrease in the internal pressure of the riser as the hydrate content increases fig 9f which leads to a significant increase in the effective axial tension in the middle and lower parts however the internal pressure and effective axial tension of the middle and upper riser slightly vary in the opposite trend compared with that of the lower part the ngh reservoirs with a hydrate content of 10 25 are quite suitable for mining by submarine pump lifting method without safety threaten to the riser 5 4 influence of mixed fluid density on the mechanical behavior of the ngh production riser fig 11 shows the mechanical behavior of the ngh production riser at different mixed fluid densities on the initial bottom position the lateral displacement and bending moment of the riser increase with the increase of the hydrate mixed fluid density and the increase is evident in the middle and lower parts fig 11 e shows that the increase of mixed fluid density has little effect on the gas void fraction during hydrate decomposition but the pressure and mass of fluid inside the riser increase fig 11f consequently local effective axial tension fig 11d and stiffness decrease and riser displacement and bending moment increase in addition the internal and external pressure difference caused by the density change is proportional to the depth moreover the change of the liquid phase density has less effect on the mass of the internal fluid for the area with a higher gas void fraction in the upper part therefore the degree of bottom tension reduction and the resulting increase in riser displacement and bending moment are more evident in the middle and lower regions fig 11c shows that the riser von mises stress decreases with the increase of the hydrate mixed fluid density and the stress change near the top end is small this result is consistent with the variation of the effective axial tension of the pipe string with the mixed fluid density fig 11d therefore it can be considered that the riser stress is mainly affected by the effective axial tension in addition the mixed fluid density is determined by the fluid density and solid concentration therefore increasing the density of the conveying fluid or increasing the production rate to increase the solid concentration is important to inhibit the decomposition of hydrate and reduce the stress of the production riser 5 5 effects of seawater temperature on the mechanical behavior of the ngh production riser seawater temperature gradually increases from the seabed to the water surface zeng and zhou 2003 nie et al 2016 the temperature at the water surface and its gradient along the depth will directly affect the internal hydrate decomposition therefore the mechanical behavior of the riser considering the water surface temperature change from 20 c to 23 c is analyzed and shown in fig 12 the riser displacement and bending moment decrease with the increase of water surface temperature as the water surface temperature rises the temperature of the seawater increases in the depth direction and the hydrate inside the riser absorbs more heat causing it to decompose earlier at a lower position fig 12e moreover as the pressure inside the wellbore decreases fig 12e the effective axial tension fig 12d and stiffness increase fig 12c indicated that the riser von mises stress increases with the increase of water surface temperature below 750 m and slightly decreases with the increase of water surface temperature in the remaining upper area the maximum stress is always located at the top end this finding is the same as the trend of the axial tension distribution with temperature fig 12d therefore during hydrate production and transportation the increase of seawater and wellbore temperature will cause the rapid decomposition and phase change of the hydrate multiphase flow and a decrease of wellbore pressure which will significantly increase the von mises stress of the riser particularly at the bottom connection part it is a befitting temperature of 20 c in the top outlet for the ngh production 6 conclusions this work studied the dynamic mechanical behavior of the ngh production riser by establishing a numerical mechanics model considering the internal phase transition of the hydrate multiphase flow and the external marine environmental loads the effects of the flow rate hydrate content mixed fluid density and seawater temperature on the mechanical behavior of the ngh production riser were discussed the major new findings of this work are presented as follows 1 ngh begins to rapidly decompose in the middle of the riser causing the sudden pressure drop in the riser and the increase in axial effective tension and von mises stress the effective tension and von mises stress reach a maximum at the top connection position where measurement such as increasing the wall thickness or configuring buoyancy block should be taken to ensure the riser safety 2 the displacement and bending moment of the ngh production riser increase with the increase of flow rate and mixed fluid density in the middle and lower sections and the von mises stress decreases with the increase of flow rate and mixed fluid density therefore a large flow rate of 40 l s or more can increase the ngh production and inhibit the inner hydrate decomposition to reduce the stress of the ngh production riser 3 the increase of hydrate content and seawater temperature will decrease the lateral displacement and bending moment of the riser and the upper part von mises stress of the riser but it will significantly increase the von mises in the lower part the ngh reservoirs with a hydrate content of 10 25 are quite suitable for mining by submarine pump lifting method without safety threaten to the riser however for the ngh reservoirs with high hydrate content or high temperature appropriate measures would be considered to suppress the decomposition of hydrate 4 the phenomenon that the von mises stress of the ngh production riser changes in contrast to the displacement and bending moment with the engineering influencing factor was found the von mises stress distribution of the ngh riser is mainly subjected to the effective axial tension therefore further research on the mechanical properties of hydrate production riser coupling of vertical and horizontal deformation is of great significance in the future contributions liangjie mao and qingyou liu conceived overarching research goals and aims liangjie mao and song zeng developed and designed the methodology and model and wrote the paper song zeng and juan li performed the verification experiment qingyou liu and guorong wang reviewed and edited the manuscript all authors read and approved the manuscript credit statement i confirm that this paper has not been published previously and is not under consideration elsewhere i certify that to the best of my knowledge the content of this paper is our work this paper has not been submitted for any degree or other purposes and that if accepted will not be published elsewhere in the same form in english or any other language without the written consent of the publisher declaration of competing interest the authors declare that there is no conflict of interest regarding the publication of this paper acknowledgments the authors gratefully acknowledge the financial support of the national key research and development program of china 2019yfc0312303 cnpc innovation foundation 2020d 5007 0210 open fund pln2020 7 of state key laboratory of oil and gas reservoir geology and exploitation southwest petroleum university 
