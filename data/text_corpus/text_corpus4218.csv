index,text
21090,engineering cases where jack up rigs with large diameter spudcan foundations operate near a jacket platform supported by pile groups are increasing therefore the group interaction of lateral loaded pile groups should be re evaluated a pile group analysis method that is able to evaluate the effect of spudcan penetration on the pile group interaction is proposed in this study this method is based on the modified poulos method and is universally used in current ocean engineering practices the pile group interaction induced additional pile head deflection of a pile group when subjected to both spudcan penetration and the influence of another pile group is initially determined by elastic analysis next the nonlinear foundation beam nfb method is adopted to calculate the head deflection of an isolated pile which we utilise to calculate the head deflection of the pile group after considering the effects of spudcan penetration finally the y multiplier is obtained by several pilot modifications of p y curves of the isolated pile in the nfb model whose variation during spudcan penetration indicates the effect that such penetration has on the pile group interaction predicted results were compared with those of the centrifuge model test and further with numerical simulation results in order to prove the validity of the method in analysing a free head and a fixed head pile group keywords spudcan penetration pile group effect modified poulos method y multiplier nonlinear foundation beam 1 introduction jack up rigs are often utilised to perform well drilling or work overs near an existing jacket platform without drilling equipment in such cases a spudcan with a large diameter is made to penetrate the seabed to provide sufficient bearing capacity moreover the penetration depth often exceeds 10 m for some soft seabeds the spudcan pile clearance is often found to be less than the spudcan diameter large soil deformation and adjacent pile stressing will be induced because of deep penetration of the large diameter spudcan the society of naval architects and marine engineers sname 2002 guidelines recommend that the effect of spudcan penetration be considered during design especially when the spudcan pile clearance is less than the spudcan diameter some research studies evaluated the additional response of an adjacent single pile caused by spudcan penetration using model tests craig 1998 siciliano et al 1990 stewart 2006 xie 2009 wang et al 2018a 2018b zhang et al 2019 and numerical simulations tho et al 2013 2015 li et al 2015 wang et al 2016 wang et al 2017 fan et al 2018 2019 and suggested corresponding analytical methods however considering that the jacket platforms are generally supported by pile group foundations with two to four piles in deep waters and the pile spacing is usually less than three times the pile diameter the pile group interaction effect cannot be neglected surprisingly thus far only a few studies have been focused on how spudcan penetration influences the pile group interaction most methods proposed considered the group effect to be concentrated on the laterally loaded pile groups focht and koch 1973 dong and yan 2019 gao and zhou 2020 the modified poulos method proposed by focht koch 1973 has been universally adopted in current ocean engineering practices to analyse the interaction of laterally loaded pile groups this is in accordance with the recommendation of the american petroleum institute api 2011 especially in cases where only the pile head loads transmitted from the upper structure are considered the head deflection of the pile group is assumed to consist of two components the head deflection of an equivalent isolated pile and the extra pile head deflection because of the pile group interaction the head deflection of the isolated pile is calculated using the nonlinear foundation beam nfb model and the p y curve while the extra pile head deflection is determined based on the elastic theory method suggested by poulos davis 1980 further modified p y data are developed by multiplying the y values of the original p y data by a y multiplier larger than unity the y multiplier is determined by trial calculations so that the isolated pile head deflection equals the pile group head deflection predicted above the modified p y relationship accounts for the pile group effect and the y multiplier is considered as the parameter that represents the group effect of the laterally loaded pile group when spudcan penetration is taken into consideration the modified poulos method may not be applicable furthermore when accounting for spudcan penetration the penetration induced soil movements will lead to differences in pile soil interaction during the analysis of the additional pile head deflection wherein the modified poulos method may not be applicable wang et al 2017 adopted the coupled eulerian lagrangian cel method to analyse the group pile response due to spudcan penetration in this method the whole pile foundation and the spudcan are modelled in a three dimensional finite element analysis the method is time consuming and can be complicated because more influencing factors are taken into consideration huang et al 2009 and zhang et al 2011 developed analytical methods for pile groups that are subjected to excavation and tunnelling induced soil displacement based on the nfb model of isolated piles where the free field soil displacements owing to pile to pile interaction are modified by taking advantage of mindlin s solution however these methods are not consistent with the current design practices in ocean engineering after group analysis for a laterally loaded pile group the y multiplier is usually determined for the successful prediction of pile responses it is very important for pile design to clarify the evolution of the y multiplier during spudcan penetration if the y multiplier varies during spudcan penetration a re evaluation of the group effect will be necessary in the design stage thus a method is developed to evaluate the effect of spudcan penetration on the adjacent laterally loaded pile group based on the logic of the modified poulos pile group analysis method the validity of the method is then verified by centrifuge model tests and by three dimensional large deformation finite element analysis respectively in addition the effects of spudcan penetration on the adjacent pile group are evaluated by utilizing variations in the pile response and the y multiplier during spudcan penetration 2 methodology as stated above pile head deflection y kg 1 of pile k in a laterally loaded pile group with n piles is rationally determined using eq 1 which is based on the modified poulos method 1 y kg 1 y k 1 ρ h i 1 i k n α ki h i where y k 1 is the pile head deflection of an isolated pile subjected to the lateral load h k calculated using the nfb model further the p y relationship ρ h is the elastic pile head deflection of an isolated pile under a unit load as determined by poulos elastic analysis poulos and davis 1980 and α ki is the pile group interaction factor indicating the additional response of pile k because of the existence of pile i this factor is also obtained by elastic analysis and is proportional to the pile head load h i on pile i if the pile head distributional loads h i and h k are known y kg 1 can be directly obtained by eq 1 for a fixed head pile group subjected to a total pile head load h the problem can be solved by combining eqs 1 3 2 h i 1 n h i 3 y kg 1 y ig 1 i 1 2 n i k however when the laterally loaded pile group is also subjected to the squeezing soil load during spudcan penetration α kj not only depends on the pile head load but also changes with the penetration induced soil load along the shaft and is no longer proportional to the pile head load to evaluate the group effect in this condition eq 1 is modified to yield eq 4 in order to account for the effects of spudcan penetration 4 y kg 1 y k 1 i 1 i k n δ y ki 1 where δ y ki 1 is the additional pile head deflection of pile k due to the pile shaft stress along the shaft of pile i and is determined by poulos elastic analysis therefore the pile head deflection of pile k in a pile group is divided into two parts the calculation of the isolated pile head deflection y k 1 and the evaluation of the additional pile head deflection δ y ki 1 induced by other piles in the group for floating piles an isolated pile head deflection y k 1 is calculated using the nfb model with the proper lateral soil pile interaction relationships given in eq 5 during spudcan penetration the subgrade reaction modulus k s in eq 5 not only decreases with increasing relative soil pile displacement but also varies along the depth 5 p z k s z y s z y k z in eq 5 p is the soil pressure z is the depth below the mudline k s z is determined according to the p y relationship of an active pile and after considering the effect of spudcan penetration y s z is the soil movement determined during spudcan penetration in a free field and y k z is the pile deflection combining the beam deflection equation given in eq 6 with eq 5 eq 7 is obtained because of varying soil properties along depth the differential form eq 7 cannot be directly used to calculate pile responses instead it should be transformed into a difference form where the pile needs to be discretised into n segments with an uniform length of δ furthermore two extra virtual nodes are added to the head and tip of the pile respectively these extra nodes are numbered as 2 1 n 2 n 3 next an equation of order n 1 eq 8 with n 5 variables are obtained combining boundary conditions at the pile head and the pile tip the pile deflection y k z of an isolated pile subjected to a combination of pile head and spudcan penetration induced soil displacement can be determined using eq 8 fan and wang 2018 6 e p i p d 4 y k z d z 4 p z where e p is the elastic modulus of the pile and i p is the sectional moment of inertia of the pile 7 d 4 y p z d z 4 4 λ 4 y p z y s z 0 where λ k s 4 e p i p 4 is the flexibility index 8 y p i 2 4 y p i 1 6 4 λ i δ 4 y p i 4 y p i 1 y p i 2 4 λ i δ 4 y s i where 1 i n 1 as defined above the pile group interaction induced additional head deflection δ y ki 1 is determined using eq 9 9 δ y ki 1 y kge 1 y ke 1 where y kge 1 and y ke 1 are the pile group head deflection and an isolated pile head deflection respectively and are determined by elastic analysis in the elastic analysis the soil is assumed to be an elastic semi space and its stress and deformation can be calculated according to mindlin s solution as depicted in fig 1 the pile shaft with l in length below the mudline is uniformly discretised into n 1 segments and each segment length is l n except that the segments at the top and the tip are of length l 2n in such a case the displacement of an arbitrary point in the soil due to a set of lateral forces p can be expressed as eq 10 10 y r d e s i s p where y r is the soil pile relative displacement d is the pile diameter e s is the soil modulus and i s is the soil pile interaction matrix the element i sij of such a matrix signifies the displacement of node i induced by a unit distributional load at the surface of element j douglas and david 1964 provided an integral solution to the problem of displacement at the corners of a rectangular area induced by a distributional load based on the mindlin s solution during calculation p j at element j is assumed to be uniform on the surface and i ij can be obtained according to eq 11 based on the superposition principle 11 i i j i a b d c i e f d c where i abdc and i efdc are the corresponding displacement coefficients of node i due to the distributional load p j at rectangles abdc and efdc respectively as shown in fig 2 the penetration induced free field soil displacement at the pile location is expressed as y s and the single pile deflection is y ke in such a case the soil pile relative displacement is y r y s y ke namely the soil pile interaction satisfies eq 12 based on eq 10 12 y k e d e s i s p y s we substitute eq 12 into the difference forms of the beam deflection equation eq 6 poulos and davis 1980 and consider the equilibrium equations of the lateral load and the bending moment along the pile shaft in this situation the difference equations determining the pressure p along the pile shaft for the free head and fixed head constraint conditions are provided in eqs 13 and 14 respectively the pile head deflection of an isolated pile y ke 1 can be determined based on eq 12 after solving p based on eqs 13 or 14 13 i 1 e p i p n 4 e s l 4 d 1 i s p e p i p n 4 d l 4 d 1 y s b 1 14 i 2 e p i p n 4 e s l 4 d 2 i s p e p i p n 4 d l 4 d 2 y s b 2 where i 1 d 1 i 2 and d 2 are the n 1 n 1 matrix b 1 and b 2 are the n 1 column vectors and their expressions are supplied in appendix a calculation of the elastic group pile head deflection y kge 1 is shown as an example by the following analysis of a 1 2 laterally loaded pile group with a spacing of s located at a relative position to the spudcan as shown in fig 3 the pile near the spudcan is defined as pile 1 and the other as pile 2 the lateral pile head load h is applied at an angle of β against the centre to centre line of the pile group and the pile head bending moment m usually induced by h above the mudline is perpendicular to the lateral load c1 and c2 are the centre to centre distances between the spudcan and pile 1 and pile 2 respectively considering that the spudcan penetration induced soil displacement at the pile locations and the pile head loads are not on the same plane the three dimensional problem is decomposed into a pair of two dimensional problems thus the pile head loads and the soil displacements at the pile locations are decomposed into directions perpendicular and parallel to the centre to centre line of the pile group as shown in eqs 15 18 15 y s 1 0 y s 1 cos α 1 y s 1 90 y s 1 sin α 1 16 y s 2 0 y s 2 sin α 2 y s 2 90 y s 2 cos α 2 17 h 0 h cos β h 90 h sin β 18 m 0 m sin β m 90 m cos β where y s1 and y s2 are the free field soil displacements at pile 1 and pile 2 locations in the directions of the centre to centre line between the spudcan and pile 1 and pile 2 respectively furthermore α 1 and α 2 are the angles between the centre to centre line connecting the piles and the line connecting the spudcan centre with the centre of pile 1 and pile 2 respectively where α 1 arccos c 2 2 s 2 c 1 2 2 s c 1 and α 2 α 1 arcsin s sin α 1 c 2 during the analysis of a two dimensional problem the piles and the soil body are discretised in the same manner as those in the single pile elastic analysis however the relative soil pile displacement at the pile 1 location is not only affected by the soil pressure p 1 along pile 1 but is also influenced by the soil pressure p 2 along the shaft of pile 2 thus the soil pile interaction equation at the pile 1 location can be expressed as eq 19 furthermore the same logic applies in the case of the soil pile interaction equation at pile 2 in eq 20 19 y 1 g e 0 90 d e s i s 11 p 1 0 90 i s 12 0 90 p 2 0 90 y s 1 0 90 20 y 2 g e 0 90 d e s i s 21 0 90 p 1 0 90 i s 22 p 2 0 90 y s 2 0 90 where i s11 and i s22 are the matrices of the soil displacement influence factor with their elements i s11ij or i s22ij signifying the displacement of node i along the shaft of pile 1 or pile 2 induced by a unit distributional load at the surface of element j of pile 1 or pile 2 the calculations of i s11 and i s22 are the same as that of i s moreover i s12 and i s21 are also the matrices of the soil displacement influence factor with their elements i s12ij or i s21ij signifying the displacement of node i along the shaft of pile 1 or pile 2 induced by a unit distributional load at the surface of element j on pile 2 or pile 1 the calculations of i s12ij and i s21ij are directly obtained by the mindlin s solution poulos and davis 1980 assuming that the surface load on element j is replaced by an equivalent point load acting at the centre of the element the superscripts 0 and 90 represent the directions parallel and perpendicular to the centre to centre line connecting the piles respectively we substitute eqs 19 and 20 into the difference forms of the beam deflection equation eq 6 poulos and davis 1980 furthermore we take into consideration boundary conditions and the equilibrium equations of the lateral load and the bending moment along the pile shaft under such conditions the difference equations determining the pressure p 1 0 90 and p 2 0 90 for free head and fixed head constraints are expressed as eqs 21 and 22 respectively the pile group head deflection y kge 1 can be determined based on eqs 19 and 20 after solving p 1 0 90 and p 2 0 90 based on eqs 21 or 22 21 i 1 e p i p n 4 e s l 4 d 1 i s 11 p 1 0 90 e p i p n 4 e s l 4 d 1 i s 12 0 90 p 2 0 90 e p i p n 4 d l 4 d 1 y s 1 0 90 b 11 e p i p n 4 e s l 4 d 1 i s 21 0 90 p 1 0 90 i 1 e p i p n 4 e s l 4 d 1 i s 22 p 2 0 90 e p i p n 4 d l 4 d 1 y s 2 0 90 b 22 where i 1 and d 1 are the same as in eq 13 b11 and b22 are n 1 column vectors and their expressions are supplied in appendix a 22 i 11 e p i p n 4 e s l 4 d 2 i s 11 p 1 0 90 i 12 e p i p n 4 e s l 4 d 2 i s 12 0 90 p 2 0 90 e p i p n 4 d l 4 d 2 y s 1 0 90 b f 1 i 21 e p i p n 4 e s l 4 d 2 i s 21 0 90 p 1 0 90 i 22 e p i p n 4 e s l 4 d 2 i s 22 p 2 0 90 e p i p n 4 d l 4 d 2 y s 2 0 90 b f 2 where the meaning of d 2 is the same as that in eq 14 i 11 i 12 i 21 and i 22 are n 1 n 1 matrices b f1 and b f2 are n 1 column vectors and their expressions are also presented in appendix a assuming that the pile head loads for each pile in the group is known a procedure to evaluate the effect of spudcan penetration on the adjacent free head pile group is proposed as follows 1 the free field soil displacements y s1 and y s2 at pile locations due to spudcan penetration are calculated 2 the pile group head deflection y kge 1 and the pile head deflection of an isolated pile y ke 1 subjected to the pile head loads and spudcan penetration induced soil displacement are determined by elastic analysis the additional deflection y ki 1 is calculated based on eq 9 3 the pile head deflection y k 1 of an isolated pile subjected to a combination of pile head loads and spudcan penetration induced soil displacement is calculated by the nfb analysis 4 the pile group head deflection y kg 1 is determined based on eq 4 5 the effect of spudcan penetration on the adjacent pile group effect is evaluated by trial calculations using the p y data modified by the y multiplier during the nfb analysis of an isolated pile this can be obtained when the calculated pile head deflection equals to y kg 1 as determined in the step 4 if the total load applied to the pile group head is known for a fixed head pile group a procedure to evaluate the effect of spudcan penetration on the pile group is as follows 1 the free field soil displacement of pile locations y s1 and y s2 due to spudcan penetration is calculated 2 the pile group head deflection y kge 1 is calculated based on the total load and soil displacements by elastic analysis and the pile head deflection of an isolated pile subjected to the average load and soil displacement y k e 1 is calculated by elastic analysis the additional deflection δ y ki e is calculated based on eq 9 3 the distributed loads on the group piles are calculated over several iterations in the nfb analysis of an isolated pile these iterations must simultaneously satisfy the conditions that the pile head deflection for each pile be equal and that the sum of the distributed loads must equal the total load finally the pile group head deflection δ y kg e is determined at the same time 4 the effect of spudcan penetration on the adjacent pile group is evaluated by trial calculations using the p y data modified by the y multiplier during the nfb analysis of an isolated pile this can be obtained when the calculated pile head deflection equals to δ y kg e as determined in step 3 a flow chart of the solution procedure is supplied in fig 4 any variation of the y multiplier is deemed to be caused by the group effect influenced by spudcan penetration the increase in the y multiplier indicates that spudcan penetration strengthens the pile group effect while the decrease suggests that the results are safe if the pile group response during spudcan penetration is analysed using the y multiplier determined prior to spudcan penetration 3 centrifuge model test with free head pile group because of the dependence of soil stress strain behaviour on its stress history the realisation of its self weight can guarantee the stress equality between the small scale model and the corresponding prototype by subjecting the model to the n g condition thus the centrifuge model test has the advantage of resembling the prototype in all the parameters supplied in table 1 by a small scale model centrifuge model tests were conducted to investigate the effect of spudcan penetration on an adjacent pile group and verify the validity of the above method using the qsinghua university centrifuge lu et al 2017 the capacity of the centrifuge was 50 gt with a spinning radius of 2 m and a maximum acceleration of 50 g 3 1 experimental setup a half model based on symmetry with a half spudcan and a half pile group was used in the centrifuge model test the centrifuge model container was 0 8 m in length 0 25 m in width and 0 68 m in height this container was used to reassemble a field of 40 m 12 5 m 32 5 m length width height in flight as shown in fig 5 a transparent perspex window was installed to record soil movements and pile deflections during spudcan penetration on the symmetrical plane of the model container the maximum diameter of the model spudcan represented by d the in following text was 16 cm in order to reassemble a spudcan with a diameter of 8 m in the prototype as shown in fig 6 the model pile was a rectangular aluminium tube with an outer edge length of 0 04 m an outer edge width of 0 025 m and a wall thickness of 0 00196 m furthermore it was 0 72 m in length so that it could simulate a prototype pile with outer edge dimensions of 2 m 1 25 m width height it had a wall thickness of 0 08 m and was 36 m in length as shown in fig 7 the relationship between the model and the prototype is also summarised in table 2 fig 8 describes the centrifuge model test configuration and the dimensions are labelled in model scale the 1 2 pile group and the spudcan are arranged along the symmetric plane of the model test as displayed in fig 8 the pile close to the spudcan is pile 1 while the one farther away is pile 2 in the following discussion the pile spacing is 1 56 times width of the pile cross section 3 12 m and the clearance between the spudcan and pile 1 is 0 172d 1 38 m as shown in fig 8 the lateral pile head load was applied by a hydraulic cylinder with a loading capacity of 20 kn and the spudcan was penetrated by a device driven by a linear motor with a loading capacity of 12 kn the pile group head was perfectly free the total lateral load h g was divided into two equal components by a pulley that was applied to each pile at 6 m above the mudline in the same direction as shown in fig 7 eight pairs of strain gauges were instrumented along the pile shaft at 2 5 4 45 9 1 11 9 17 25 19 0 23 75 and 25 95 m below the mudline to monitor the pile shaft bending moment load cells were used to measure the spudcan penetration resistance and the lateral load applied to the piles data transmitted from strain gauges and transducers in the tests were collected by a data processing and acquisition system that had 128 channels and was controlled by a computer the soils used in the centrifuge model tests were remoulded saturated kaolin clay and saturated fine sand the plastic limit and the liquid limit of the kaolin clay are 21 and 45 respectively and the grading curve of the fine sand is supplied in fig 9 six layers of the remoulded soft kaolin clay were prepared using the stratified consolidated method the height of each layer was 0 1 m the preparation steps are as follows 1 a drainage sand layer with 0 05 m thickness is laid on the bottom of the centrifuge model test container and the geotextile is laid on the top of the sand layer 2 the kaolin slurry was prepared so that it was 1 5 times the liquid limit 3 the slurry was placed into the container 4 the slurry was consolidated under the overburden pressure of the prototype stratum we note that the settlement tends to be stable after 10 days the height of each layer after consolidation depended on the overburden pressure the total height of the consolidated soft clay stratum was 0 6 m based on vane shear test results the undrained shear strength s u of the stratum was 3 19 kpa at an approximate depth of 2 m below the mudline furthermore its variation over depths of 2 m 30 m under the mudline was expressed as eq 23 23 s u 1 29 z 0 61 k p a z 2 m the dry unit weight of the sand was 16 kn m3 the saturated sand stratum was prepared using the stratified compaction method and the water head saturation method the height of the prepared sand stratum was also 0 65 m to simulate a prototype stratum with 32 5 m thickness the internal friction angle ϕ of the sand was 30 based on consolidated drained triaxial tests 3 2 centrifuge model steps the centrifuge model test consisted of the following steps 1 for the sand test the piles instrumented with strain gauges were initially placed at the prescribed position following this step the stratum was prepared as stated above for the test conducted in clay the consolidated soil was cut off at the predetermined pile locations and replaced by the group piles the pile embedment below the mudline was 30 m 2 the transducers were connected to the signal conditioning devices 3 after the model container extended its span to 50 g the pile group was loaded at 6 m above the mudline the lateral load for the pile group was twice the load that could either stress an isolated pile to 50 of its yield stress or push the pile to 0 1 times the pile width 0 2 m at the mudline the lateral load was determined as 2 7 mn for the clay test and 3 5 mn for the sand test the vertical load was calculated as 0 93 mn at the mudline before spudcan penetration including the weight of pile and additional test devices above the mudline 4 the displacement controlled electric penetration device was adopted to push the spudcan into the stratum at a penetration rate of 0 15 mm s for the sand test and 0 2 mm s for the clay test the final penetration depth was 1 0d 8 0 m for the clay model test or 0 5d 4 0 m for the sand model test 5 after reaching the maximum penetration depth the penetration device was set to the load controlled mode to maintain the penetration force at 0 5 times the maximum penetration resistance for one hour to simulate operation for 104 days 6 the spudcan was extracted from the stratum at a rate of 0 15 mm s in sand and 0 2 mm s in clay strain gauges a piv camera and load cells recorded the pile shaft bending moment the pile deflection the soil movement the lateral pile head load and the resistances during spudcan penetration and extraction 4 comparison with centrifuge model test data 4 1 soil displacement at the pile group locations because the pile is on the right side of the spudcan see fig 8 spudcan penetration induced soil displacement on the left of the spudcan is considered as the free field soil displacement the soil displacement associated with pile 1 and pile 2 locations are shown in figs 11 and 12 they are based on piv measuring results obtained during spudcan penetration as can be seen from symbols in figs 11 and 12 to predict the pile group head deflection and y multiplier during spudcan penetration by the proposed method the free field soil displacements at the pile group locations were determined using the cel method of the abaqus software a cel finite model was established according to the centrifuge model tests as depicted in fig 10 we conclude that an accurate soil displacement calculation is a prerequisite for pile response prediction tho et al 2015 therefore a fine mesh of 0 05d 0 4 m was adopted in the range from the spudcan centre to 1 0d in the lateral direction this was uniformly discretised by 0 05d 0 4 m grids in the vertical direction the rest of the area was meshed by 0 1d 0 8 m grids to account for calculation efficiency a void domain of 10 m in height was established above the mudline to allow for soil upheaval and back flow during spudcan penetration the whole soil domain was described by eulerian elements the stratum was modelled as an elastic perfectly plastic material obeying the mises yield criterion for the clay stratum and the effective unit weight was set as 8 5 kn m3 the elastic modulus was assumed to be 150s u and the poisson s ratio was 0 49 to account for the undrained condition the sand stratum was modelled as an elastic perfectly plastic material obeying the mohr column yield criterion the friction angle of the sand was assumed as 30 and the effective unit weight was 9 0 kn m3 the elastic modulus was assumed to be 5 mpa and the poisson s ratio was 0 3 the spudcan was assumed to be a rigid body during analysis the interface friction angle between the spudcan and the clay was set as zero according to the research conducted by tho et al 2012 the contact between the spudcan and the sand was also considered to be smooth so that the predicted penetration resistance by the frictionless model is closer to the test results lateral and vertical velocities were constrained at the vertical boundary and the bottom respectively further a non reflection eulerian boundary is also assigned at the vertical boundary to simulate an infinite boundary condition dassault systems 2018 the boundary condition was realised by adding additional boundary damping constants to the boundary to minimise the effects of reflection from the boundary the simulation speed was set at 0 5 m s to strike a balance between calculation efficiency and accuracy the free field soil displacement was obtained by setting a list of tracer particles along the depth of the pile locations and extracting the displacement of the tracer particles after simulation the calculated results are shown in figs 11 and 12 for clay and sand sites respectively and compared with test results which will be adopted as input to determine the y multiplier for simplicity penetration and prediction are represented by pene and pre in the legends of the following figures in this manuscript 4 2 variation of the y multiplier during spudcan penetration in the following calculations all the parameters were considered for complete piles and spudcans in the prototype the p y curves in the nfb model were determined based on the api code 2011 which consists of two basic parameters ε 50 and s u for clays and only depends on the effective internal friction angle for sands the undrained shear strength s u was determined from eq 23 and ε 50 was assumed to be 0 5 for the model test clay the effective internal friction angle of the model test sand was assumed as 30 because the lateral load is applied to piles at 6 m above the mudline boundary conditions at the pile head on the mudline are expressed in the following eqs 24 and 25 the model pile group is considered to consist of floating piles and boundary conditions at the pile tip are expressed in the following eqs 26 and 27 24 h 0 h 25 m 0 m 26 h 30 0 27 m 30 0 where h and m are 1 35 mn and 8 1 mn m for the clay model test h and m are 1 75 mn and 10 5 mn m for the sand model test the pile was discretised into 300 segments during the nfb calculation to obtain the pile head deflection y 1 1 and y 2 1 of pile 1 and pile 2 the flexural rigidity e p i p of the pile is 10 31 109 n m2 and the iteration was terminated when the relative error of the pile deflection is less than 10 5 during calculation the elastic head deflection y 1 e 1 and y 2 e 1 of pile 1 and pile 2 were determined by solving eq 13 the pile was discretised by 30 segments and the poisson s ratio was assumed to be 0 5 during calculation research briaud 1997 demonstrates that for laterally loaded piles the pile capacity mainly depends on the soil pile interaction from the mudline to about 1 3 of the pile length below the mudline therefore the soil modulus e s in the elastic analysis calculation was averaged along one third of the pile length below the mudline according to eq 28 in clay and eq 29 in sand goh and wong 1997 28 e s u ε 50 29 e 2 1 μ p a η σ v p a 0 7 where p a is 100 kpa η is a parameter depending on the relative density of the sand for most sands η is in the range from 60 to 300 and was fixed at 70 for the model test sand similarly the elastic head deflections y 1 ge 1 and y 2 ge 1 of the pile group were calculated by solving eq 21 and they in turn yielded the elastic additional pile head deflection for each group pile finally pile head deflections y 1 g 1 and y 2 g 1 were obtained according to eq 4 the predicted and measured pile group head deflection y kg 1 at different spudcan penetration depths are compared in figs 13 and 14 it is indicated that the predicted results are slightly larger compared to the test results the p y curves were in turn modified to calculate the variations in the y multiplier as shown in figs 15 and 16 these modifications are based on y s and y kg 1 displayed in figs 11 14 it is observed that the y multiplier increases with advancing spudcan penetration therefore the y multiplier determined before spudcan penetration cannot be directly used for the evaluation of the spudcan penetration induced pile group response further bending moment distributions are predicted based on the nfb model with the y multiplier after considering the spudcan penetration effect they are compared with the test results in figs 17 and 18 we find that the predicted results are in agreement with the test results 5 comparisons of numerical simulation and predicted results for fixed head pile group 5 1 case definition and model set up during design considering the constraint because of the upper structure the head constraint of the jacket platform pile foundations is usually considered fixed i e fixed in rotation and free in translation the cel method has proven to be an effective approach in the analysis of spudcan pile interaction tho et al 2013 wang et al 2016 thus to validate further the proposed method during the analysis of the effects of spudcan penetration on a fixed head pile group a cel all in model established with both the spudcan and a fixed head pile group is adopted as benchmark furthermore simulated and predicted results will be compared in the following analysis including a comparison amongst the various bending moments and different distributed loads for each group pile the all in model was also developed by using the explicit solver of the abaqus software and the lateral deflection of the pile group was directly extracted from the output database after calculation the model is established based on the design parameters of several engineering cases in chinese ocean engineering practice as shown in fig 19 the spudcan penetration in clay is usually encountered upon deeper penetration and can lead to a larger pile response therefore a cylindrical field of diameter 90 m and depth of 90 m is established the undrained shear strength s u linearly increases over the upper 30 m and is maintained constant for clays deeper than 30 m the undrained shear strength s u at the mudline is 3 19 kpa and it increases with depth at a rate of 1 29 kpa m two 80 m long steel pipe piles with 2 m outer diameter and 1 84 m inner diameter were arranged in line with a spudcan with a maximum diameter of 18 m as shown in fig 19 the spudcan dimensions are shown in fig 20 the pile embedment is 80 m and the pile spacing is twice the pile diameter please note that c1 and c2 in fig 3 are 1 0d 18 m and 1 22d 21 96 m respectively the final penetration is designed to be 1 0d 18 m a 10 m high eulerian void domain was added at the top of the mudline to consider soil upheaval and back flow for the cel finite model the calculation can lead to diverging results if the soil was only set as an eulerian domain based on the research conducted by wang et al 2016 therefore the soil from the mudline to 0 5d below the final penetration depth 27 m was established as the eulerian domain and the rest of the soil was set as the lagrangian domain in the cel model in detail an eulerian section was first established based on the prototype of the centrifuge model test including an eulerian soil domain a lagrangian soil domain a pre embedded pile zone and a void domain above the mudline the void domain that is 10 m above the mudline was set to account for soil upheaval during spudcan penetration similarly the pre embedded pile zone and the lagrangian soil zone were also set in the eulerian part in order to consider possible soil flow across the eulerian domain pile interface and the interface between the eulerian and lagrangian soils the spudcan was assumed to be a rigid body during the analysis the steel pipe pile was transformed into an equivalent solid pile to improve calculation efficiency and the equivalent pile modulus is determined based on eq 30 30 e e e p i p i e where e e is the elastic modulus of the equivalent pile and is equal to 46 gpa e p is the elastic modulus of steel assumed to be 210 gpa and i p and i e are the moments of inertia for the pipe pile and the equivalent solid pile respectively in the lateral direction an area of 3 0d centred on the spudcan was discretised by 0 05d 0 9 m grids and the rest of the area was meshed by 0 1d 1 8 m grids in the vertical direction the mesh grid was assumed to be 0 05d 0 9 m an elastic and perfectly plastic constitutive model obeying the mises yielding criterion was adopted to describe the stress strain relationship of the clay the yielding stress was set as 3 s u the elastic modulus was taken as 150 su and the poisson s ratio was set as 0 49 in order to simulate the undrained state during spudcan penetration the effective unit weight of the clay was assumed to be 8 5 kn m3 the vertical boundary was constrained in lateral velocity and set as the non reflecting eulerian boundary the vertical velocity was set as zero at the bottom of the cel model furthermore boundary conditions appropriate for the symmetrical boundary were applied two piles were connected by a rigid pile cap which was assumed possess complete translational freedom in the lateral direction at the mudline for soil pile and soil spudcan interfaces no friction was considered in the tangential direction and hard contact allowing for separation after contact was set in the normal direction the contact between the eulerian and lagrangian soil domains was assumed to obey the coulomb s law of friction in the tangential direction with a friction coefficient of 1 0 and an ultimate shear stress equal to s u at the depth being considered in the normal direction no separation was set during the analysis of the all in model after achieving equilibrium under geostatic stress in a simulation time of 10 s the lateral pile head load was applied at the pile cap as shown in fig 19 after which the spudcan was penetrated at 0 5 m s to 1d below the mudline the lateral pile head load was 6 7 mn also determined by an nfb analysis in order to stress an isolated pile to 50 of its yielding stress thus the pile response was directly obtained from the all in model and was compared with the results predicted by the proposed method the free field soil displacement at the pile locations was calculated to predict the pile group head deflection and distributed loads that acted on each pile by the proposed method above a free field spudcan penetration cel model corresponding to the model in fig 19 was established as fig 21 material parameters were the same as those in the all in model and the spudcan was also considered as a rigid body contact parameters between the spudcan and the clay and boundary conditions were the same as that in the all in cel model and the penetration speed was 0 5 m s as well 5 2 effects of spudcan penetration on the pile group calculated free field soil displacement distributions at pile 1 and pile 2 locations i e 18 and 22 m from the spudcan centre are shown in fig 22 during calculation of the addition pile head deflection by elastic analysis the soil modulus e s was calculated according to eq 28 and determined by the soil pile interaction within the upper one third of the pile length and the result was 3 mpa further the poisson s ratio was assumed to be 0 5 the elastic pile head deflection y ke 1 was first determined by solving eq 14 based on the average pile head load next the elastic pile group head deflection y kge 1 was calculated by solving eq 22 based on the lateral load of the pile group and in turn it yielded the additional pile head deflections δ y 12 1 and δ y 21 1 for pile 1 and pile 2 furthermore considering that the head deflection is equal for all members of the group and that the total pile head load is constant pile head load distributions for each group pile and y kg 1 can be obtained by iteration the predicted and simulated results are compared in figs 23 and 24 the comparison indicated that the predicted results matched closely with the actual load redistribution during spudcan penetration furthermore spudcan penetration can lead to load redistribution among the group piles we concluded that the distributed load of the pile closer to the spudcan decreases with spudcan penetration while the load of the other pile increases the y multiplier variations of pile 1 and pile 2 with spudcan penetration depth can also be evaluated in the nfb model based on the distributed loads free field soil displacement distributions and y kg 1 as shown in fig 25 because of the load redistribution on the pile head the y multiplier of pile 1 near the spudcan is less than that of pile 2 in order to further demonstrate the validity of predicted results bending moment distributions are also compared to the cel results in fig 26 we find that the predicted and simulated results are in agreement with one another 6 conclusions the modified poulos method is widely used in current ocean engineering practices to evaluate the pile to pile interaction of the pile group because of the y multiplier however the method has been limited to cases where the pile group is only subjected to pile head loads therefore this study was focused on the evolution of the group effect when the pile group is subjected to a combination of pile head load and spudcan penetration the pile deflection is assumed to consist of two portions the first portion is the pile head deflection of an equivalent isolated pile calculated using the nfb model the second portion is an elastic additional pile deflection induced by the group effect calculated by elastic analyses of the pile deflections of an equivalent isolated pile and the pile group finally we suggest that the pile group effect be evaluated by trial calculations of the y multiplier using the nfb model of an isolated pile the feasibility of the method was proven by both centrifuge model tests and numerical simulations and the conclusions are summarised as follows 1 the y multiplier varies with spudcan penetration for the cases involved in the study the y multipliers of the free head group piles increase with spudcan penetration while the y multipliers of the fixed head group piles initially increase and subsequently decrease with the advance of the spudcan 2 for the fixed head condition spudcan penetration can lead to load redistribution among the group piles cases in this study show that the distributed load of the pile closer to the spudcan decreases with spudcan penetration while the load of the other pile increases credit authorship contribution statement yifei fan methodology software writing original draft preparation jianhua wang conceptualization data curation supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the national natural science foundation nsfc of china grant number 51579174 mr kai sun helped us to conduct the centrifuge model tests their contributions are acknowledged with gratitude and appreciation appendix a a1 i 1 0 5 1 1 0 5 0 125 1 2 n 2 n 1 0 5 n 0 125 0 1 0 0 0 0 0 1 0 0 0 0 1 0 a2 d 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 5 4 1 0 0 0 0 0 0 0 0 4 6 4 1 0 0 0 0 0 0 0 1 4 6 4 1 0 0 0 0 0 0 0 0 0 0 0 1 4 6 4 1 0 0 0 0 0 0 0 1 4 5 2 a3 b 1 n d l h n 2 d l 2 m n 2 d l 2 m 0 t a4 i 2 0 5 1 1 0 5 i 21 i 22 i 23 i 2 n 1 i 2 n i 2 n 1 0 1 0 0 0 0 0 1 0 0 0 0 1 0 where i 2 j f j 2 3 e p i p n 4 e s l 4 i s 3 j i s 2 j and f 1 0 125 f j j 1 1 j n 1 f n 1 0 5n 0 125 a5 d 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 7 4 1 0 0 0 0 0 0 0 0 4 6 4 1 0 0 0 0 0 0 0 1 4 6 4 1 0 0 0 0 0 0 0 0 0 0 0 1 4 6 4 1 0 0 0 0 0 0 0 1 4 5 2 a6 b 2 n d l h 0 0 0 t a7 b 11 n d l h 1 n 2 d l 2 m 1 n 2 d l 2 m 1 0 t b 22 n d l h 2 n 2 d l 2 m 2 n 2 d l 2 m 2 0 t a8 i 11 0 5 1 1 0 5 i 11 1 i 11 j i 11 n 1 0 1 0 0 0 0 0 1 0 0 0 0 1 0 where i 11 1 0 125 2 e p i p 3 e s l 4 n 4 i s 31 i s 21 i 2 j j 1 2 e p i p 3 e s l 4 n 4 i s 11 3 j i s 11 2 j 1 j n 1 and i 11 n 1 0 5 n 0 125 2 e p i p 3 e s l 4 n 4 i s 11 3 n 1 i s 11 2 n 1 a9 i 12 0 5 1 1 0 5 i 12 1 i 12 j i 12 n 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 where i 12 j 2 3 e p i p e s l 4 n 4 i s 12 3 j i s 12 2 j 1 j n 1 a10 i 21 i 21 1 i 21 j i 21 n 1 k 1 1 k 1 j k 1 n 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 where i 21 j 2 3 e p i p e s l 4 n 4 i s 21 3 j i s 21 2 j k 1 j i s 11 1 j i s 12 1 j 1 i j n 1 a11 i 22 i 22 1 i 22 j i 22 n 1 k 2 1 k 2 j k 2 n 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 where i 22 1 0 125 2 e p i p 3 e s l 4 n 4 i s 22 31 i s 22 21 i 22 j j 1 2 e p i p 3 e s l 4 n 4 i s 22 3 j i s 22 2 j 1 j n 1 i 22 n 1 0 5 n 0 125 2 e p i p 3 e s l 4 n 4 i s 22 3 n 1 i s 22 2 n 1 k 2 j i s 12 1 j i s 22 1 j b f 1 n h d l 2 3 e p i p d l 4 n 4 y s 1 2 y s 1 3 0 t b f 2 2 3 e p i p d l 4 n 4 y s 2 2 y s 2 3 e s y s 2 1 d e s y s 1 1 d 0 0 t 
21090,engineering cases where jack up rigs with large diameter spudcan foundations operate near a jacket platform supported by pile groups are increasing therefore the group interaction of lateral loaded pile groups should be re evaluated a pile group analysis method that is able to evaluate the effect of spudcan penetration on the pile group interaction is proposed in this study this method is based on the modified poulos method and is universally used in current ocean engineering practices the pile group interaction induced additional pile head deflection of a pile group when subjected to both spudcan penetration and the influence of another pile group is initially determined by elastic analysis next the nonlinear foundation beam nfb method is adopted to calculate the head deflection of an isolated pile which we utilise to calculate the head deflection of the pile group after considering the effects of spudcan penetration finally the y multiplier is obtained by several pilot modifications of p y curves of the isolated pile in the nfb model whose variation during spudcan penetration indicates the effect that such penetration has on the pile group interaction predicted results were compared with those of the centrifuge model test and further with numerical simulation results in order to prove the validity of the method in analysing a free head and a fixed head pile group keywords spudcan penetration pile group effect modified poulos method y multiplier nonlinear foundation beam 1 introduction jack up rigs are often utilised to perform well drilling or work overs near an existing jacket platform without drilling equipment in such cases a spudcan with a large diameter is made to penetrate the seabed to provide sufficient bearing capacity moreover the penetration depth often exceeds 10 m for some soft seabeds the spudcan pile clearance is often found to be less than the spudcan diameter large soil deformation and adjacent pile stressing will be induced because of deep penetration of the large diameter spudcan the society of naval architects and marine engineers sname 2002 guidelines recommend that the effect of spudcan penetration be considered during design especially when the spudcan pile clearance is less than the spudcan diameter some research studies evaluated the additional response of an adjacent single pile caused by spudcan penetration using model tests craig 1998 siciliano et al 1990 stewart 2006 xie 2009 wang et al 2018a 2018b zhang et al 2019 and numerical simulations tho et al 2013 2015 li et al 2015 wang et al 2016 wang et al 2017 fan et al 2018 2019 and suggested corresponding analytical methods however considering that the jacket platforms are generally supported by pile group foundations with two to four piles in deep waters and the pile spacing is usually less than three times the pile diameter the pile group interaction effect cannot be neglected surprisingly thus far only a few studies have been focused on how spudcan penetration influences the pile group interaction most methods proposed considered the group effect to be concentrated on the laterally loaded pile groups focht and koch 1973 dong and yan 2019 gao and zhou 2020 the modified poulos method proposed by focht koch 1973 has been universally adopted in current ocean engineering practices to analyse the interaction of laterally loaded pile groups this is in accordance with the recommendation of the american petroleum institute api 2011 especially in cases where only the pile head loads transmitted from the upper structure are considered the head deflection of the pile group is assumed to consist of two components the head deflection of an equivalent isolated pile and the extra pile head deflection because of the pile group interaction the head deflection of the isolated pile is calculated using the nonlinear foundation beam nfb model and the p y curve while the extra pile head deflection is determined based on the elastic theory method suggested by poulos davis 1980 further modified p y data are developed by multiplying the y values of the original p y data by a y multiplier larger than unity the y multiplier is determined by trial calculations so that the isolated pile head deflection equals the pile group head deflection predicted above the modified p y relationship accounts for the pile group effect and the y multiplier is considered as the parameter that represents the group effect of the laterally loaded pile group when spudcan penetration is taken into consideration the modified poulos method may not be applicable furthermore when accounting for spudcan penetration the penetration induced soil movements will lead to differences in pile soil interaction during the analysis of the additional pile head deflection wherein the modified poulos method may not be applicable wang et al 2017 adopted the coupled eulerian lagrangian cel method to analyse the group pile response due to spudcan penetration in this method the whole pile foundation and the spudcan are modelled in a three dimensional finite element analysis the method is time consuming and can be complicated because more influencing factors are taken into consideration huang et al 2009 and zhang et al 2011 developed analytical methods for pile groups that are subjected to excavation and tunnelling induced soil displacement based on the nfb model of isolated piles where the free field soil displacements owing to pile to pile interaction are modified by taking advantage of mindlin s solution however these methods are not consistent with the current design practices in ocean engineering after group analysis for a laterally loaded pile group the y multiplier is usually determined for the successful prediction of pile responses it is very important for pile design to clarify the evolution of the y multiplier during spudcan penetration if the y multiplier varies during spudcan penetration a re evaluation of the group effect will be necessary in the design stage thus a method is developed to evaluate the effect of spudcan penetration on the adjacent laterally loaded pile group based on the logic of the modified poulos pile group analysis method the validity of the method is then verified by centrifuge model tests and by three dimensional large deformation finite element analysis respectively in addition the effects of spudcan penetration on the adjacent pile group are evaluated by utilizing variations in the pile response and the y multiplier during spudcan penetration 2 methodology as stated above pile head deflection y kg 1 of pile k in a laterally loaded pile group with n piles is rationally determined using eq 1 which is based on the modified poulos method 1 y kg 1 y k 1 ρ h i 1 i k n α ki h i where y k 1 is the pile head deflection of an isolated pile subjected to the lateral load h k calculated using the nfb model further the p y relationship ρ h is the elastic pile head deflection of an isolated pile under a unit load as determined by poulos elastic analysis poulos and davis 1980 and α ki is the pile group interaction factor indicating the additional response of pile k because of the existence of pile i this factor is also obtained by elastic analysis and is proportional to the pile head load h i on pile i if the pile head distributional loads h i and h k are known y kg 1 can be directly obtained by eq 1 for a fixed head pile group subjected to a total pile head load h the problem can be solved by combining eqs 1 3 2 h i 1 n h i 3 y kg 1 y ig 1 i 1 2 n i k however when the laterally loaded pile group is also subjected to the squeezing soil load during spudcan penetration α kj not only depends on the pile head load but also changes with the penetration induced soil load along the shaft and is no longer proportional to the pile head load to evaluate the group effect in this condition eq 1 is modified to yield eq 4 in order to account for the effects of spudcan penetration 4 y kg 1 y k 1 i 1 i k n δ y ki 1 where δ y ki 1 is the additional pile head deflection of pile k due to the pile shaft stress along the shaft of pile i and is determined by poulos elastic analysis therefore the pile head deflection of pile k in a pile group is divided into two parts the calculation of the isolated pile head deflection y k 1 and the evaluation of the additional pile head deflection δ y ki 1 induced by other piles in the group for floating piles an isolated pile head deflection y k 1 is calculated using the nfb model with the proper lateral soil pile interaction relationships given in eq 5 during spudcan penetration the subgrade reaction modulus k s in eq 5 not only decreases with increasing relative soil pile displacement but also varies along the depth 5 p z k s z y s z y k z in eq 5 p is the soil pressure z is the depth below the mudline k s z is determined according to the p y relationship of an active pile and after considering the effect of spudcan penetration y s z is the soil movement determined during spudcan penetration in a free field and y k z is the pile deflection combining the beam deflection equation given in eq 6 with eq 5 eq 7 is obtained because of varying soil properties along depth the differential form eq 7 cannot be directly used to calculate pile responses instead it should be transformed into a difference form where the pile needs to be discretised into n segments with an uniform length of δ furthermore two extra virtual nodes are added to the head and tip of the pile respectively these extra nodes are numbered as 2 1 n 2 n 3 next an equation of order n 1 eq 8 with n 5 variables are obtained combining boundary conditions at the pile head and the pile tip the pile deflection y k z of an isolated pile subjected to a combination of pile head and spudcan penetration induced soil displacement can be determined using eq 8 fan and wang 2018 6 e p i p d 4 y k z d z 4 p z where e p is the elastic modulus of the pile and i p is the sectional moment of inertia of the pile 7 d 4 y p z d z 4 4 λ 4 y p z y s z 0 where λ k s 4 e p i p 4 is the flexibility index 8 y p i 2 4 y p i 1 6 4 λ i δ 4 y p i 4 y p i 1 y p i 2 4 λ i δ 4 y s i where 1 i n 1 as defined above the pile group interaction induced additional head deflection δ y ki 1 is determined using eq 9 9 δ y ki 1 y kge 1 y ke 1 where y kge 1 and y ke 1 are the pile group head deflection and an isolated pile head deflection respectively and are determined by elastic analysis in the elastic analysis the soil is assumed to be an elastic semi space and its stress and deformation can be calculated according to mindlin s solution as depicted in fig 1 the pile shaft with l in length below the mudline is uniformly discretised into n 1 segments and each segment length is l n except that the segments at the top and the tip are of length l 2n in such a case the displacement of an arbitrary point in the soil due to a set of lateral forces p can be expressed as eq 10 10 y r d e s i s p where y r is the soil pile relative displacement d is the pile diameter e s is the soil modulus and i s is the soil pile interaction matrix the element i sij of such a matrix signifies the displacement of node i induced by a unit distributional load at the surface of element j douglas and david 1964 provided an integral solution to the problem of displacement at the corners of a rectangular area induced by a distributional load based on the mindlin s solution during calculation p j at element j is assumed to be uniform on the surface and i ij can be obtained according to eq 11 based on the superposition principle 11 i i j i a b d c i e f d c where i abdc and i efdc are the corresponding displacement coefficients of node i due to the distributional load p j at rectangles abdc and efdc respectively as shown in fig 2 the penetration induced free field soil displacement at the pile location is expressed as y s and the single pile deflection is y ke in such a case the soil pile relative displacement is y r y s y ke namely the soil pile interaction satisfies eq 12 based on eq 10 12 y k e d e s i s p y s we substitute eq 12 into the difference forms of the beam deflection equation eq 6 poulos and davis 1980 and consider the equilibrium equations of the lateral load and the bending moment along the pile shaft in this situation the difference equations determining the pressure p along the pile shaft for the free head and fixed head constraint conditions are provided in eqs 13 and 14 respectively the pile head deflection of an isolated pile y ke 1 can be determined based on eq 12 after solving p based on eqs 13 or 14 13 i 1 e p i p n 4 e s l 4 d 1 i s p e p i p n 4 d l 4 d 1 y s b 1 14 i 2 e p i p n 4 e s l 4 d 2 i s p e p i p n 4 d l 4 d 2 y s b 2 where i 1 d 1 i 2 and d 2 are the n 1 n 1 matrix b 1 and b 2 are the n 1 column vectors and their expressions are supplied in appendix a calculation of the elastic group pile head deflection y kge 1 is shown as an example by the following analysis of a 1 2 laterally loaded pile group with a spacing of s located at a relative position to the spudcan as shown in fig 3 the pile near the spudcan is defined as pile 1 and the other as pile 2 the lateral pile head load h is applied at an angle of β against the centre to centre line of the pile group and the pile head bending moment m usually induced by h above the mudline is perpendicular to the lateral load c1 and c2 are the centre to centre distances between the spudcan and pile 1 and pile 2 respectively considering that the spudcan penetration induced soil displacement at the pile locations and the pile head loads are not on the same plane the three dimensional problem is decomposed into a pair of two dimensional problems thus the pile head loads and the soil displacements at the pile locations are decomposed into directions perpendicular and parallel to the centre to centre line of the pile group as shown in eqs 15 18 15 y s 1 0 y s 1 cos α 1 y s 1 90 y s 1 sin α 1 16 y s 2 0 y s 2 sin α 2 y s 2 90 y s 2 cos α 2 17 h 0 h cos β h 90 h sin β 18 m 0 m sin β m 90 m cos β where y s1 and y s2 are the free field soil displacements at pile 1 and pile 2 locations in the directions of the centre to centre line between the spudcan and pile 1 and pile 2 respectively furthermore α 1 and α 2 are the angles between the centre to centre line connecting the piles and the line connecting the spudcan centre with the centre of pile 1 and pile 2 respectively where α 1 arccos c 2 2 s 2 c 1 2 2 s c 1 and α 2 α 1 arcsin s sin α 1 c 2 during the analysis of a two dimensional problem the piles and the soil body are discretised in the same manner as those in the single pile elastic analysis however the relative soil pile displacement at the pile 1 location is not only affected by the soil pressure p 1 along pile 1 but is also influenced by the soil pressure p 2 along the shaft of pile 2 thus the soil pile interaction equation at the pile 1 location can be expressed as eq 19 furthermore the same logic applies in the case of the soil pile interaction equation at pile 2 in eq 20 19 y 1 g e 0 90 d e s i s 11 p 1 0 90 i s 12 0 90 p 2 0 90 y s 1 0 90 20 y 2 g e 0 90 d e s i s 21 0 90 p 1 0 90 i s 22 p 2 0 90 y s 2 0 90 where i s11 and i s22 are the matrices of the soil displacement influence factor with their elements i s11ij or i s22ij signifying the displacement of node i along the shaft of pile 1 or pile 2 induced by a unit distributional load at the surface of element j of pile 1 or pile 2 the calculations of i s11 and i s22 are the same as that of i s moreover i s12 and i s21 are also the matrices of the soil displacement influence factor with their elements i s12ij or i s21ij signifying the displacement of node i along the shaft of pile 1 or pile 2 induced by a unit distributional load at the surface of element j on pile 2 or pile 1 the calculations of i s12ij and i s21ij are directly obtained by the mindlin s solution poulos and davis 1980 assuming that the surface load on element j is replaced by an equivalent point load acting at the centre of the element the superscripts 0 and 90 represent the directions parallel and perpendicular to the centre to centre line connecting the piles respectively we substitute eqs 19 and 20 into the difference forms of the beam deflection equation eq 6 poulos and davis 1980 furthermore we take into consideration boundary conditions and the equilibrium equations of the lateral load and the bending moment along the pile shaft under such conditions the difference equations determining the pressure p 1 0 90 and p 2 0 90 for free head and fixed head constraints are expressed as eqs 21 and 22 respectively the pile group head deflection y kge 1 can be determined based on eqs 19 and 20 after solving p 1 0 90 and p 2 0 90 based on eqs 21 or 22 21 i 1 e p i p n 4 e s l 4 d 1 i s 11 p 1 0 90 e p i p n 4 e s l 4 d 1 i s 12 0 90 p 2 0 90 e p i p n 4 d l 4 d 1 y s 1 0 90 b 11 e p i p n 4 e s l 4 d 1 i s 21 0 90 p 1 0 90 i 1 e p i p n 4 e s l 4 d 1 i s 22 p 2 0 90 e p i p n 4 d l 4 d 1 y s 2 0 90 b 22 where i 1 and d 1 are the same as in eq 13 b11 and b22 are n 1 column vectors and their expressions are supplied in appendix a 22 i 11 e p i p n 4 e s l 4 d 2 i s 11 p 1 0 90 i 12 e p i p n 4 e s l 4 d 2 i s 12 0 90 p 2 0 90 e p i p n 4 d l 4 d 2 y s 1 0 90 b f 1 i 21 e p i p n 4 e s l 4 d 2 i s 21 0 90 p 1 0 90 i 22 e p i p n 4 e s l 4 d 2 i s 22 p 2 0 90 e p i p n 4 d l 4 d 2 y s 2 0 90 b f 2 where the meaning of d 2 is the same as that in eq 14 i 11 i 12 i 21 and i 22 are n 1 n 1 matrices b f1 and b f2 are n 1 column vectors and their expressions are also presented in appendix a assuming that the pile head loads for each pile in the group is known a procedure to evaluate the effect of spudcan penetration on the adjacent free head pile group is proposed as follows 1 the free field soil displacements y s1 and y s2 at pile locations due to spudcan penetration are calculated 2 the pile group head deflection y kge 1 and the pile head deflection of an isolated pile y ke 1 subjected to the pile head loads and spudcan penetration induced soil displacement are determined by elastic analysis the additional deflection y ki 1 is calculated based on eq 9 3 the pile head deflection y k 1 of an isolated pile subjected to a combination of pile head loads and spudcan penetration induced soil displacement is calculated by the nfb analysis 4 the pile group head deflection y kg 1 is determined based on eq 4 5 the effect of spudcan penetration on the adjacent pile group effect is evaluated by trial calculations using the p y data modified by the y multiplier during the nfb analysis of an isolated pile this can be obtained when the calculated pile head deflection equals to y kg 1 as determined in the step 4 if the total load applied to the pile group head is known for a fixed head pile group a procedure to evaluate the effect of spudcan penetration on the pile group is as follows 1 the free field soil displacement of pile locations y s1 and y s2 due to spudcan penetration is calculated 2 the pile group head deflection y kge 1 is calculated based on the total load and soil displacements by elastic analysis and the pile head deflection of an isolated pile subjected to the average load and soil displacement y k e 1 is calculated by elastic analysis the additional deflection δ y ki e is calculated based on eq 9 3 the distributed loads on the group piles are calculated over several iterations in the nfb analysis of an isolated pile these iterations must simultaneously satisfy the conditions that the pile head deflection for each pile be equal and that the sum of the distributed loads must equal the total load finally the pile group head deflection δ y kg e is determined at the same time 4 the effect of spudcan penetration on the adjacent pile group is evaluated by trial calculations using the p y data modified by the y multiplier during the nfb analysis of an isolated pile this can be obtained when the calculated pile head deflection equals to δ y kg e as determined in step 3 a flow chart of the solution procedure is supplied in fig 4 any variation of the y multiplier is deemed to be caused by the group effect influenced by spudcan penetration the increase in the y multiplier indicates that spudcan penetration strengthens the pile group effect while the decrease suggests that the results are safe if the pile group response during spudcan penetration is analysed using the y multiplier determined prior to spudcan penetration 3 centrifuge model test with free head pile group because of the dependence of soil stress strain behaviour on its stress history the realisation of its self weight can guarantee the stress equality between the small scale model and the corresponding prototype by subjecting the model to the n g condition thus the centrifuge model test has the advantage of resembling the prototype in all the parameters supplied in table 1 by a small scale model centrifuge model tests were conducted to investigate the effect of spudcan penetration on an adjacent pile group and verify the validity of the above method using the qsinghua university centrifuge lu et al 2017 the capacity of the centrifuge was 50 gt with a spinning radius of 2 m and a maximum acceleration of 50 g 3 1 experimental setup a half model based on symmetry with a half spudcan and a half pile group was used in the centrifuge model test the centrifuge model container was 0 8 m in length 0 25 m in width and 0 68 m in height this container was used to reassemble a field of 40 m 12 5 m 32 5 m length width height in flight as shown in fig 5 a transparent perspex window was installed to record soil movements and pile deflections during spudcan penetration on the symmetrical plane of the model container the maximum diameter of the model spudcan represented by d the in following text was 16 cm in order to reassemble a spudcan with a diameter of 8 m in the prototype as shown in fig 6 the model pile was a rectangular aluminium tube with an outer edge length of 0 04 m an outer edge width of 0 025 m and a wall thickness of 0 00196 m furthermore it was 0 72 m in length so that it could simulate a prototype pile with outer edge dimensions of 2 m 1 25 m width height it had a wall thickness of 0 08 m and was 36 m in length as shown in fig 7 the relationship between the model and the prototype is also summarised in table 2 fig 8 describes the centrifuge model test configuration and the dimensions are labelled in model scale the 1 2 pile group and the spudcan are arranged along the symmetric plane of the model test as displayed in fig 8 the pile close to the spudcan is pile 1 while the one farther away is pile 2 in the following discussion the pile spacing is 1 56 times width of the pile cross section 3 12 m and the clearance between the spudcan and pile 1 is 0 172d 1 38 m as shown in fig 8 the lateral pile head load was applied by a hydraulic cylinder with a loading capacity of 20 kn and the spudcan was penetrated by a device driven by a linear motor with a loading capacity of 12 kn the pile group head was perfectly free the total lateral load h g was divided into two equal components by a pulley that was applied to each pile at 6 m above the mudline in the same direction as shown in fig 7 eight pairs of strain gauges were instrumented along the pile shaft at 2 5 4 45 9 1 11 9 17 25 19 0 23 75 and 25 95 m below the mudline to monitor the pile shaft bending moment load cells were used to measure the spudcan penetration resistance and the lateral load applied to the piles data transmitted from strain gauges and transducers in the tests were collected by a data processing and acquisition system that had 128 channels and was controlled by a computer the soils used in the centrifuge model tests were remoulded saturated kaolin clay and saturated fine sand the plastic limit and the liquid limit of the kaolin clay are 21 and 45 respectively and the grading curve of the fine sand is supplied in fig 9 six layers of the remoulded soft kaolin clay were prepared using the stratified consolidated method the height of each layer was 0 1 m the preparation steps are as follows 1 a drainage sand layer with 0 05 m thickness is laid on the bottom of the centrifuge model test container and the geotextile is laid on the top of the sand layer 2 the kaolin slurry was prepared so that it was 1 5 times the liquid limit 3 the slurry was placed into the container 4 the slurry was consolidated under the overburden pressure of the prototype stratum we note that the settlement tends to be stable after 10 days the height of each layer after consolidation depended on the overburden pressure the total height of the consolidated soft clay stratum was 0 6 m based on vane shear test results the undrained shear strength s u of the stratum was 3 19 kpa at an approximate depth of 2 m below the mudline furthermore its variation over depths of 2 m 30 m under the mudline was expressed as eq 23 23 s u 1 29 z 0 61 k p a z 2 m the dry unit weight of the sand was 16 kn m3 the saturated sand stratum was prepared using the stratified compaction method and the water head saturation method the height of the prepared sand stratum was also 0 65 m to simulate a prototype stratum with 32 5 m thickness the internal friction angle ϕ of the sand was 30 based on consolidated drained triaxial tests 3 2 centrifuge model steps the centrifuge model test consisted of the following steps 1 for the sand test the piles instrumented with strain gauges were initially placed at the prescribed position following this step the stratum was prepared as stated above for the test conducted in clay the consolidated soil was cut off at the predetermined pile locations and replaced by the group piles the pile embedment below the mudline was 30 m 2 the transducers were connected to the signal conditioning devices 3 after the model container extended its span to 50 g the pile group was loaded at 6 m above the mudline the lateral load for the pile group was twice the load that could either stress an isolated pile to 50 of its yield stress or push the pile to 0 1 times the pile width 0 2 m at the mudline the lateral load was determined as 2 7 mn for the clay test and 3 5 mn for the sand test the vertical load was calculated as 0 93 mn at the mudline before spudcan penetration including the weight of pile and additional test devices above the mudline 4 the displacement controlled electric penetration device was adopted to push the spudcan into the stratum at a penetration rate of 0 15 mm s for the sand test and 0 2 mm s for the clay test the final penetration depth was 1 0d 8 0 m for the clay model test or 0 5d 4 0 m for the sand model test 5 after reaching the maximum penetration depth the penetration device was set to the load controlled mode to maintain the penetration force at 0 5 times the maximum penetration resistance for one hour to simulate operation for 104 days 6 the spudcan was extracted from the stratum at a rate of 0 15 mm s in sand and 0 2 mm s in clay strain gauges a piv camera and load cells recorded the pile shaft bending moment the pile deflection the soil movement the lateral pile head load and the resistances during spudcan penetration and extraction 4 comparison with centrifuge model test data 4 1 soil displacement at the pile group locations because the pile is on the right side of the spudcan see fig 8 spudcan penetration induced soil displacement on the left of the spudcan is considered as the free field soil displacement the soil displacement associated with pile 1 and pile 2 locations are shown in figs 11 and 12 they are based on piv measuring results obtained during spudcan penetration as can be seen from symbols in figs 11 and 12 to predict the pile group head deflection and y multiplier during spudcan penetration by the proposed method the free field soil displacements at the pile group locations were determined using the cel method of the abaqus software a cel finite model was established according to the centrifuge model tests as depicted in fig 10 we conclude that an accurate soil displacement calculation is a prerequisite for pile response prediction tho et al 2015 therefore a fine mesh of 0 05d 0 4 m was adopted in the range from the spudcan centre to 1 0d in the lateral direction this was uniformly discretised by 0 05d 0 4 m grids in the vertical direction the rest of the area was meshed by 0 1d 0 8 m grids to account for calculation efficiency a void domain of 10 m in height was established above the mudline to allow for soil upheaval and back flow during spudcan penetration the whole soil domain was described by eulerian elements the stratum was modelled as an elastic perfectly plastic material obeying the mises yield criterion for the clay stratum and the effective unit weight was set as 8 5 kn m3 the elastic modulus was assumed to be 150s u and the poisson s ratio was 0 49 to account for the undrained condition the sand stratum was modelled as an elastic perfectly plastic material obeying the mohr column yield criterion the friction angle of the sand was assumed as 30 and the effective unit weight was 9 0 kn m3 the elastic modulus was assumed to be 5 mpa and the poisson s ratio was 0 3 the spudcan was assumed to be a rigid body during analysis the interface friction angle between the spudcan and the clay was set as zero according to the research conducted by tho et al 2012 the contact between the spudcan and the sand was also considered to be smooth so that the predicted penetration resistance by the frictionless model is closer to the test results lateral and vertical velocities were constrained at the vertical boundary and the bottom respectively further a non reflection eulerian boundary is also assigned at the vertical boundary to simulate an infinite boundary condition dassault systems 2018 the boundary condition was realised by adding additional boundary damping constants to the boundary to minimise the effects of reflection from the boundary the simulation speed was set at 0 5 m s to strike a balance between calculation efficiency and accuracy the free field soil displacement was obtained by setting a list of tracer particles along the depth of the pile locations and extracting the displacement of the tracer particles after simulation the calculated results are shown in figs 11 and 12 for clay and sand sites respectively and compared with test results which will be adopted as input to determine the y multiplier for simplicity penetration and prediction are represented by pene and pre in the legends of the following figures in this manuscript 4 2 variation of the y multiplier during spudcan penetration in the following calculations all the parameters were considered for complete piles and spudcans in the prototype the p y curves in the nfb model were determined based on the api code 2011 which consists of two basic parameters ε 50 and s u for clays and only depends on the effective internal friction angle for sands the undrained shear strength s u was determined from eq 23 and ε 50 was assumed to be 0 5 for the model test clay the effective internal friction angle of the model test sand was assumed as 30 because the lateral load is applied to piles at 6 m above the mudline boundary conditions at the pile head on the mudline are expressed in the following eqs 24 and 25 the model pile group is considered to consist of floating piles and boundary conditions at the pile tip are expressed in the following eqs 26 and 27 24 h 0 h 25 m 0 m 26 h 30 0 27 m 30 0 where h and m are 1 35 mn and 8 1 mn m for the clay model test h and m are 1 75 mn and 10 5 mn m for the sand model test the pile was discretised into 300 segments during the nfb calculation to obtain the pile head deflection y 1 1 and y 2 1 of pile 1 and pile 2 the flexural rigidity e p i p of the pile is 10 31 109 n m2 and the iteration was terminated when the relative error of the pile deflection is less than 10 5 during calculation the elastic head deflection y 1 e 1 and y 2 e 1 of pile 1 and pile 2 were determined by solving eq 13 the pile was discretised by 30 segments and the poisson s ratio was assumed to be 0 5 during calculation research briaud 1997 demonstrates that for laterally loaded piles the pile capacity mainly depends on the soil pile interaction from the mudline to about 1 3 of the pile length below the mudline therefore the soil modulus e s in the elastic analysis calculation was averaged along one third of the pile length below the mudline according to eq 28 in clay and eq 29 in sand goh and wong 1997 28 e s u ε 50 29 e 2 1 μ p a η σ v p a 0 7 where p a is 100 kpa η is a parameter depending on the relative density of the sand for most sands η is in the range from 60 to 300 and was fixed at 70 for the model test sand similarly the elastic head deflections y 1 ge 1 and y 2 ge 1 of the pile group were calculated by solving eq 21 and they in turn yielded the elastic additional pile head deflection for each group pile finally pile head deflections y 1 g 1 and y 2 g 1 were obtained according to eq 4 the predicted and measured pile group head deflection y kg 1 at different spudcan penetration depths are compared in figs 13 and 14 it is indicated that the predicted results are slightly larger compared to the test results the p y curves were in turn modified to calculate the variations in the y multiplier as shown in figs 15 and 16 these modifications are based on y s and y kg 1 displayed in figs 11 14 it is observed that the y multiplier increases with advancing spudcan penetration therefore the y multiplier determined before spudcan penetration cannot be directly used for the evaluation of the spudcan penetration induced pile group response further bending moment distributions are predicted based on the nfb model with the y multiplier after considering the spudcan penetration effect they are compared with the test results in figs 17 and 18 we find that the predicted results are in agreement with the test results 5 comparisons of numerical simulation and predicted results for fixed head pile group 5 1 case definition and model set up during design considering the constraint because of the upper structure the head constraint of the jacket platform pile foundations is usually considered fixed i e fixed in rotation and free in translation the cel method has proven to be an effective approach in the analysis of spudcan pile interaction tho et al 2013 wang et al 2016 thus to validate further the proposed method during the analysis of the effects of spudcan penetration on a fixed head pile group a cel all in model established with both the spudcan and a fixed head pile group is adopted as benchmark furthermore simulated and predicted results will be compared in the following analysis including a comparison amongst the various bending moments and different distributed loads for each group pile the all in model was also developed by using the explicit solver of the abaqus software and the lateral deflection of the pile group was directly extracted from the output database after calculation the model is established based on the design parameters of several engineering cases in chinese ocean engineering practice as shown in fig 19 the spudcan penetration in clay is usually encountered upon deeper penetration and can lead to a larger pile response therefore a cylindrical field of diameter 90 m and depth of 90 m is established the undrained shear strength s u linearly increases over the upper 30 m and is maintained constant for clays deeper than 30 m the undrained shear strength s u at the mudline is 3 19 kpa and it increases with depth at a rate of 1 29 kpa m two 80 m long steel pipe piles with 2 m outer diameter and 1 84 m inner diameter were arranged in line with a spudcan with a maximum diameter of 18 m as shown in fig 19 the spudcan dimensions are shown in fig 20 the pile embedment is 80 m and the pile spacing is twice the pile diameter please note that c1 and c2 in fig 3 are 1 0d 18 m and 1 22d 21 96 m respectively the final penetration is designed to be 1 0d 18 m a 10 m high eulerian void domain was added at the top of the mudline to consider soil upheaval and back flow for the cel finite model the calculation can lead to diverging results if the soil was only set as an eulerian domain based on the research conducted by wang et al 2016 therefore the soil from the mudline to 0 5d below the final penetration depth 27 m was established as the eulerian domain and the rest of the soil was set as the lagrangian domain in the cel model in detail an eulerian section was first established based on the prototype of the centrifuge model test including an eulerian soil domain a lagrangian soil domain a pre embedded pile zone and a void domain above the mudline the void domain that is 10 m above the mudline was set to account for soil upheaval during spudcan penetration similarly the pre embedded pile zone and the lagrangian soil zone were also set in the eulerian part in order to consider possible soil flow across the eulerian domain pile interface and the interface between the eulerian and lagrangian soils the spudcan was assumed to be a rigid body during the analysis the steel pipe pile was transformed into an equivalent solid pile to improve calculation efficiency and the equivalent pile modulus is determined based on eq 30 30 e e e p i p i e where e e is the elastic modulus of the equivalent pile and is equal to 46 gpa e p is the elastic modulus of steel assumed to be 210 gpa and i p and i e are the moments of inertia for the pipe pile and the equivalent solid pile respectively in the lateral direction an area of 3 0d centred on the spudcan was discretised by 0 05d 0 9 m grids and the rest of the area was meshed by 0 1d 1 8 m grids in the vertical direction the mesh grid was assumed to be 0 05d 0 9 m an elastic and perfectly plastic constitutive model obeying the mises yielding criterion was adopted to describe the stress strain relationship of the clay the yielding stress was set as 3 s u the elastic modulus was taken as 150 su and the poisson s ratio was set as 0 49 in order to simulate the undrained state during spudcan penetration the effective unit weight of the clay was assumed to be 8 5 kn m3 the vertical boundary was constrained in lateral velocity and set as the non reflecting eulerian boundary the vertical velocity was set as zero at the bottom of the cel model furthermore boundary conditions appropriate for the symmetrical boundary were applied two piles were connected by a rigid pile cap which was assumed possess complete translational freedom in the lateral direction at the mudline for soil pile and soil spudcan interfaces no friction was considered in the tangential direction and hard contact allowing for separation after contact was set in the normal direction the contact between the eulerian and lagrangian soil domains was assumed to obey the coulomb s law of friction in the tangential direction with a friction coefficient of 1 0 and an ultimate shear stress equal to s u at the depth being considered in the normal direction no separation was set during the analysis of the all in model after achieving equilibrium under geostatic stress in a simulation time of 10 s the lateral pile head load was applied at the pile cap as shown in fig 19 after which the spudcan was penetrated at 0 5 m s to 1d below the mudline the lateral pile head load was 6 7 mn also determined by an nfb analysis in order to stress an isolated pile to 50 of its yielding stress thus the pile response was directly obtained from the all in model and was compared with the results predicted by the proposed method the free field soil displacement at the pile locations was calculated to predict the pile group head deflection and distributed loads that acted on each pile by the proposed method above a free field spudcan penetration cel model corresponding to the model in fig 19 was established as fig 21 material parameters were the same as those in the all in model and the spudcan was also considered as a rigid body contact parameters between the spudcan and the clay and boundary conditions were the same as that in the all in cel model and the penetration speed was 0 5 m s as well 5 2 effects of spudcan penetration on the pile group calculated free field soil displacement distributions at pile 1 and pile 2 locations i e 18 and 22 m from the spudcan centre are shown in fig 22 during calculation of the addition pile head deflection by elastic analysis the soil modulus e s was calculated according to eq 28 and determined by the soil pile interaction within the upper one third of the pile length and the result was 3 mpa further the poisson s ratio was assumed to be 0 5 the elastic pile head deflection y ke 1 was first determined by solving eq 14 based on the average pile head load next the elastic pile group head deflection y kge 1 was calculated by solving eq 22 based on the lateral load of the pile group and in turn it yielded the additional pile head deflections δ y 12 1 and δ y 21 1 for pile 1 and pile 2 furthermore considering that the head deflection is equal for all members of the group and that the total pile head load is constant pile head load distributions for each group pile and y kg 1 can be obtained by iteration the predicted and simulated results are compared in figs 23 and 24 the comparison indicated that the predicted results matched closely with the actual load redistribution during spudcan penetration furthermore spudcan penetration can lead to load redistribution among the group piles we concluded that the distributed load of the pile closer to the spudcan decreases with spudcan penetration while the load of the other pile increases the y multiplier variations of pile 1 and pile 2 with spudcan penetration depth can also be evaluated in the nfb model based on the distributed loads free field soil displacement distributions and y kg 1 as shown in fig 25 because of the load redistribution on the pile head the y multiplier of pile 1 near the spudcan is less than that of pile 2 in order to further demonstrate the validity of predicted results bending moment distributions are also compared to the cel results in fig 26 we find that the predicted and simulated results are in agreement with one another 6 conclusions the modified poulos method is widely used in current ocean engineering practices to evaluate the pile to pile interaction of the pile group because of the y multiplier however the method has been limited to cases where the pile group is only subjected to pile head loads therefore this study was focused on the evolution of the group effect when the pile group is subjected to a combination of pile head load and spudcan penetration the pile deflection is assumed to consist of two portions the first portion is the pile head deflection of an equivalent isolated pile calculated using the nfb model the second portion is an elastic additional pile deflection induced by the group effect calculated by elastic analyses of the pile deflections of an equivalent isolated pile and the pile group finally we suggest that the pile group effect be evaluated by trial calculations of the y multiplier using the nfb model of an isolated pile the feasibility of the method was proven by both centrifuge model tests and numerical simulations and the conclusions are summarised as follows 1 the y multiplier varies with spudcan penetration for the cases involved in the study the y multipliers of the free head group piles increase with spudcan penetration while the y multipliers of the fixed head group piles initially increase and subsequently decrease with the advance of the spudcan 2 for the fixed head condition spudcan penetration can lead to load redistribution among the group piles cases in this study show that the distributed load of the pile closer to the spudcan decreases with spudcan penetration while the load of the other pile increases credit authorship contribution statement yifei fan methodology software writing original draft preparation jianhua wang conceptualization data curation supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the national natural science foundation nsfc of china grant number 51579174 mr kai sun helped us to conduct the centrifuge model tests their contributions are acknowledged with gratitude and appreciation appendix a a1 i 1 0 5 1 1 0 5 0 125 1 2 n 2 n 1 0 5 n 0 125 0 1 0 0 0 0 0 1 0 0 0 0 1 0 a2 d 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 5 4 1 0 0 0 0 0 0 0 0 4 6 4 1 0 0 0 0 0 0 0 1 4 6 4 1 0 0 0 0 0 0 0 0 0 0 0 1 4 6 4 1 0 0 0 0 0 0 0 1 4 5 2 a3 b 1 n d l h n 2 d l 2 m n 2 d l 2 m 0 t a4 i 2 0 5 1 1 0 5 i 21 i 22 i 23 i 2 n 1 i 2 n i 2 n 1 0 1 0 0 0 0 0 1 0 0 0 0 1 0 where i 2 j f j 2 3 e p i p n 4 e s l 4 i s 3 j i s 2 j and f 1 0 125 f j j 1 1 j n 1 f n 1 0 5n 0 125 a5 d 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 7 4 1 0 0 0 0 0 0 0 0 4 6 4 1 0 0 0 0 0 0 0 1 4 6 4 1 0 0 0 0 0 0 0 0 0 0 0 1 4 6 4 1 0 0 0 0 0 0 0 1 4 5 2 a6 b 2 n d l h 0 0 0 t a7 b 11 n d l h 1 n 2 d l 2 m 1 n 2 d l 2 m 1 0 t b 22 n d l h 2 n 2 d l 2 m 2 n 2 d l 2 m 2 0 t a8 i 11 0 5 1 1 0 5 i 11 1 i 11 j i 11 n 1 0 1 0 0 0 0 0 1 0 0 0 0 1 0 where i 11 1 0 125 2 e p i p 3 e s l 4 n 4 i s 31 i s 21 i 2 j j 1 2 e p i p 3 e s l 4 n 4 i s 11 3 j i s 11 2 j 1 j n 1 and i 11 n 1 0 5 n 0 125 2 e p i p 3 e s l 4 n 4 i s 11 3 n 1 i s 11 2 n 1 a9 i 12 0 5 1 1 0 5 i 12 1 i 12 j i 12 n 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 where i 12 j 2 3 e p i p e s l 4 n 4 i s 12 3 j i s 12 2 j 1 j n 1 a10 i 21 i 21 1 i 21 j i 21 n 1 k 1 1 k 1 j k 1 n 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 where i 21 j 2 3 e p i p e s l 4 n 4 i s 21 3 j i s 21 2 j k 1 j i s 11 1 j i s 12 1 j 1 i j n 1 a11 i 22 i 22 1 i 22 j i 22 n 1 k 2 1 k 2 j k 2 n 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 where i 22 1 0 125 2 e p i p 3 e s l 4 n 4 i s 22 31 i s 22 21 i 22 j j 1 2 e p i p 3 e s l 4 n 4 i s 22 3 j i s 22 2 j 1 j n 1 i 22 n 1 0 5 n 0 125 2 e p i p 3 e s l 4 n 4 i s 22 3 n 1 i s 22 2 n 1 k 2 j i s 12 1 j i s 22 1 j b f 1 n h d l 2 3 e p i p d l 4 n 4 y s 1 2 y s 1 3 0 t b f 2 2 3 e p i p d l 4 n 4 y s 2 2 y s 2 3 e s y s 2 1 d e s y s 1 1 d 0 0 t 
21091,in recent years the interaction between submarine slide runout and offshore pipelines has received extensive attention based on the need to protect pipelines crossing regions susceptible to submarine slides the interaction force between the slide material and a pipeline may be resolved into horizontal and vertical components but with most attention to date focusing on the former while the latter has not been studied thoroughly this paper reports the results from a series of multiphase flow slide material and the ambient seawater numerical simulations using a computational fluid dynamics cfd approach aimed at investigating the vertical forces during submarine slide flow around a pipeline at different gap ratios pipeline seabed gap normalized by pipeline diameter from 0 08 to 10 0 and at reynolds numbers ranging from 0 38 to 267 the oscillatory characteristics and magnitude of the vertical forces for different gap ratios are discussed the effects of the gap ratios on the geotechnical and inertial components of the slide pipeline vertical forces are analyzed systematically using a hybrid geotechnical fluid mechanics framework from the results of the cfd simulations a modified hybrid geotechnical fluid mechanics method to estimate the slide pipeline vertical forces is developed considering the effects of pipeline seabed gaps keywords submarine slides pipelines vertical forces pipeline seabed gaps cfd approach 1 introduction submarine slides pose a significant threat to the security of oil and gas subsea infrastructure especially for offshore pipelines located in unstable regions of soft seabed schwab et al 1993 randolph et al 2011 zhang et al 2016 for example the mardi gras export pipeline from the atlantis field in the gulf of mexico crosses the base of the sigsbee escarpment which is prone to submarine slide hazards jeanjean et al 2005 in previous slope failures in this field slide runouts covering a distance of about 7 km travelling at velocities of up to 100 km h have been reported niedoroda et al 2003 for such hazardous environments estimating the potential loading caused by submarine slides is very important for the design of pipelines since the late 1970s methods to quantify the horizontal load component during submarine slide pipeline interaction have been developed based on both geotechnical and fluid mechanics principles these different approaches are summarised in table 1 the purely geotechnical framework links the slide pipeline horizontal interaction forces to the undrained shear strength of slide mass through a geotechnical bearing capacity equation while the fluid mechanics framework considers just the inertial effects of the slide mass when it flows around a cylinder assuming the soil shear strength is low the hybrid geotechnical fluid dynamics approach combines the above two frameworks and can be used to quantify the slide pipeline horizontal interaction forces for a large range of reynolds numbers 200 reflecting the slide behaviour spanning across the solid fluid range despite the recent advancement research on the vertical force component during submarine slide pipeline interaction is still limited moreover the vertical force may be oscillatory zakeri et al 2009 fan et al 2018 and the characteristics triggering mechanisms frequencies etc of the oscillating vertical force component have not been considered in detail the oscillating vertical force may pose potential resonance risk to pipelines in addition the vertical force component may also alter the pipeline vertical position leading to changes in the horizontal force magnitude fan et al 2019 offshore pipelines may be buried or laid on the seafloor with the latter generally preferred in deep water to minimize installation costs offshore pipelines often cross through undulating seabeds e g submarine escarpments canyons causing suspension of some pipeline sections jeanjean et al 2005 xiu et al 2016 moreover due to the complex pipeline soil water interactions initially on bottom seafloor pipelines may be suspended at different distances above the seabed vijaya kumar et al 2003 cathie et al 2005 due to scour of the underlying soil despite this the influence of the suspended distance between the pipeline and seabed termed gap henceforth on the slide pipeline interaction forces is rarely considered this paper investigates the effects of pipeline seabed gaps on the vertical slide pipeline forces using extensive computational fluid dynamics cfd simulations of slide interactions with a pipeline at different pipeline seabed gap ratios a hybrid geotechnical and fluid mechanics framework is proposed to evaluate the vertical slide pipeline forces 2 cfd modelling 2 1 governing equations of the incompressible multiphase flow after submarine slope failure the failed soil block may transform into a debris flow due to intense soil remoulding which is exacerbated by water entrainment boylan et al 2009 dong 2017 fan et al 2018 at this stage the sliding mass may travel at a velocity of up to 30 m s de blasio et al 2004 and possesses high water content and low undrained strength compared to the parent intact slope this paper focuses on the submarine slide phase that has progressed from the debris flow stage where the slide material may be considered as a fully remoulded viscous fluid the commercial cfd platform ansys cfx was used in this study to simulate the submarine slide impact on a pipeline the pre and post processing tools used in the cfd simulation include a three dimensional geometric model a meshing subprogram icem cfd and a cfx solver based on the finite volume method an inhomogeneous two phase separated eulerian eulerian multiphase flow model was used to simulate the interactions between the submarine slide mass and ambient water the phase continuity in a two phase flow can be written as 1 t r α ρ α r α ρ α u α s msα β 1 n p γ αβ where r α ρ α and u α are the volume fraction density and velocity of flowing material respectively s msα is the mass source term specified by the user n p is the total number of phases two in this study and γ αβ is the diffusion coefficient of the interphase mass transfer from the sliding mass to water which must obey the equal and opposite rule between two phases γ αβ γ βα α 1 n p γ α 0 in general to track the direction of the mass transfer between two phases γ αβ is expressed by γ αβ γ αβ γ βα with γ αβ 0 representing a positive net mass flow the volume fractions obey the conservation equation α 1 n p γ α 1 the momentum conservation is governed by the navier stokes equation expressed as 2 t r α ρ α u α r α ρ α u α u α r α p α r α μ α u α u α t β 1 n p γ α β u β γ β α u α s m α m α where p α and μ α are the phase pressure and viscosity respectively s mα is the momentum source which is implemented in ansys cfx as force per unit volume acting on the fluids due to external body forces and user definition γ α β u β γ β α u α is the momentum transfer induced by the interphase mass transfer m α is the total interfacial forces acting on phase α due to the interaction with phase β m α may arise from several independent physical effects such as the interphase drag force uplift force wall lubrication force virtual mass force and turbulence dispersion force 2 2 numerical modelling details the numerical model used to simulate the slide pipeline interaction is shown in fig 1 a numerical domain of 8 m 15 5 m 0 5 m width height thickness was used with a pipeline of 0 5 m in diameter d pipe fixed horizontally at 2 5 m 5 d pipe away from the inlet the slide mass of 10 5 m in height enters from the left side of the domain over 270 000 tetrahedral elements with a maximum grid size of 0 25 m were used in the numerical model grid refinement was conducted in a square zone with a radius of 0 75 m 1 5 d pipe where 5 layers of very fine mesh total thickness of 0 05 m were constructed around the pipeline and on the seabed surface as shown in fig 1 b the inlet of slide mass is a velocity boundary and the outlet is an opening boundary with a gauge pressure of zero the top and left boundaries are set as free slip surfaces while the bottom boundary and the pipeline were set as rough no slip surfaces each with equivalent roughness ks of 0 0015 and 0 5 mm crowe et al 2001 zakeri et al 2009 each simulation was terminated when the sliding mass has travelled an equivalent distance of 48 m 96 d pipe and therefore the simulation duration depends on the runout velocity e g the duration is 48 s for a runout velocity of 1 m s this approach was employed to ensure that the vertical force time profiles for all simulation cases have stabilized a second order upwind difference scheme was applied through the model and a standard k ε model was employed once turbulent flow became relevant within either the sliding mass or the seawater in total 71 cfd simulations were performed in this study as shown in table 2 cases 1 1 to 7 8 encompass re non newtonian of 0 38 267 and gap ratio h ps d pipe where h ps is the pipeline seabed gap of 0 08 10 0 to investigate the effect of different gap ratios on the slide pipeline forces re non newtonian is defined as zakeri et al 2008 3 r e n o n n e w t o n i a n ρ v 2 μ a p p γ ρ v 2 s u where γ is shear strain rate s 1 γ v d pipe μ a p p s u γ is the apparent viscosity pa s cases 8 1 to 9 4 were performed to investigate the effects of sliding mass strength on the slide pipeline interaction forces see section 3 the strength increases in proportion with the increase in the shear strain rate according to the well known herschel bulkley rheological model 4 s u τ τ y k γ n where τ is the shear stress of the submarine slide mass pa τ y is the yield stress pa k is the viscous property of the fluids pa s n n is the shear thinning index note that the results at very high re non newtonian cases 8 3 and cases 8 4 may be influenced by the choice of turbulence model however this is outside the scope of the current paper and warrants future investigations case 10 1 to case 10 7 were performed to simulate extreme conditions where the sliding body travels at a very low velocity v 0 01 m s re non newtonian 0 001 on a smooth seabed so that the soil strength contribution to the vertical slide pipeline forces can be investigated see section 4 for simplicity the density of ambient seawater was set equal to the slide mass to prevent the slide mass from collapsing at low velocities or hydroplane at high velocities mohrig et al 1999 along the slide run out direction this simplification is expected to have little influence on the slide pipeline vertical force results because the pipeline behaviour is mainly affected by the slide mass 3 slide pipeline vertical force evolution compared to a single phase fluid flow such as water passing a cylinder the process of submarine slide impacting a pipeline is more complicated since it is essentially a two phase flow problem the sliding body is a non newtonian fluid but the ambient water is a newtonian fluid to investigate the time dependent characteristics of the vertical slide pipeline forces f v some typical vertical force time curves at different re non newtonian are shown in fig 2 it should be noted that all the cases in fig 2 have the same pipeline seabed gap ratio h ps d pipe 1 0 it can be seen that the vertical forces show large fluctuations when the slide mass first comes into contact with the pipeline after which f v either levels off in cases with re non newtonian 0 2 to 23 as shown in fig 2 a b c d e g or oscillates periodically in cases with re non newtonian from 87 to 1241 as shown in fig 2 f h i as more slide material interacts with the pipeline this two stage slide pipeline vertical force evolution can be characterized by the peak the maximum value in the instantaneous slide impact stage and stable the average value in the stable impact stage forces the stable vertical force describes the continuous slide pipeline interaction for a large length to thickness ratio of the sliding body while the peak vertical force is generally larger than the stable force and more representative of the destructiveness of submarine slides from an ultimate limit state design perspective therefore both are analyzed in this study an example of the slide pipeline interaction features at high re non newtonian is depicted in fig 3 which shows the variation of the volume fraction and streamline of the slide mass and seawater during slide pipeline interaction a separated region consisting of the ambient seawater is formed at the pipeline rear when the slide first comes into contact with the pipeline as shown in fig 3 a the separated region gradually closes as more slide material interacts with the pipeline simulation times of 3 7 s 40 s the slide mass gradually replaces the water in the separated region after which vortex shedding can be observed at the pipeline rear in fig 3 b this is similar to newtonian fluid flow past pipelines sumer and fredsøe 2006 the shedding of counter rotating vortices of the slide material causes a periodic oscillation of the vertical slide pipeline forces in this study the re non newtonian range where vortex shedding of the slide material in the pipeline wake occurs is consistent with patnana et al 2009 who reported periodic shedding behaviour for re non newtonian 50 after the onset of flow separation sahdi et al 2019 for shear thinning non newtonian fluids the periodic shedding behaviour of the counter rotating vortices can be represented by a dimensionless parameter the strouhal number st defined as 5 s t f d p i p e v where f is the vortex shedding frequency hz to analyze the effect of pipeline seabed gap on the slide pipeline vertical force oscillation characteristics the relationship between the strouhal number and the reynolds number for different gap ratios h ps d pipe 0 2 10 0 are shown in fig 4 where the data for simulations conducted at re non newtonian 50 the critical reynolds number for periodic vortex shedding in the current and previous studies zakeri et al 2008 2009 is plotted for gap ratios 0 2 vortex shedding is inhibited even at large re non newtonian due to the restricted slide flow below the pipeline invert it can be seen in fig 4 that the st increases with increasing re non newtonian this trend is consistent with the results of newtonian fluid flow past a cylinder schlichting and gersten 2016 the st also increases with decreasing gap ratio and the resulting st range 0 166 0 222 is slightly larger than that of the newtonian flow past a cylinder 0 14 st 0 21 but consistent with previous flume tests zakeri et al 2008 and cfd simulations zakeri et al 2009 fan et al 2018 the tendency for st to change with h ps d pipe may be attributed to the formation of asymmetric vortices as the pipeline gap from the seabed decreases i e decreasing h ps d pipe both the peak and stable vertical forces for different gap ratios h ps d pipe of 0 08 10 0 are summarised in table 2 generally the results show that the peak and stable vertical forces both increase as the re non newtonian increases and the gap decreases when the gap ratio h ps d pipe exceeds 2 5 the average stable vertical force is essentially negligible 0 n however the stable vertical forces can be as high as 1 kn when h ps d pipe 1 0 a methodology to effectively quantify this force component is discussed in subsequent sections 4 vertical slide pipeline forces 4 1 hybrid geotechnical fluid mechanics framework similar to quantifying the horizontal slide pipeline forces randolph and white 2012 the vertical forces may also be interpreted using the hybrid framework 6 f v n v s u a 1 2 ρ v 2 c v a where n v and c v are the uplift bearing factor and uplift drag coefficient respectively the first term captures the contribution of soil strength to the vertical slide pipeline forces while the second term represents the contribution of the incoming flow inertial forces since f v varies with both re non newtonian and h ps d pipe the n v and c v parameters of each component are expected to be influenced by the gap ratios h ps d pipe and these aspects are explored in the ensuing sections 4 2 viscous strength component of vertical slide pipeline forces as highlighted earlier the slide pipeline vertical force component due to the slide viscous strength was quantified by modelling a slide mass travelling at low velocities along a smooth seabed past the pipeline v 0 01 m s as in case 10 1 to case 10 7 in table 2 implying that the inertial component is negligible so that we may consider f v n v s u a fig 5 depicts the cfd results for cases 10 1 to 10 7 where the f v is normalized by the operative undrained strength of the slide s u calculated using eq 4 with the adopted τ y k and n parameters shown in table 2 multiplied by the pipeline projected area a it can be seen here that the normalized slide pipeline vertical forces n v decreases sharply with increasing h ps d pipe for h ps d pipe 2 0 n v approaches 0 showing little seabed boundary influence as depicted in fig 5 the variation of n v with h ps d pipe can be fitted by 7 n v 2 5 15 9 h p s d p i p e 1 6 5 h p s d p i p e 4 3 inertial component of vertical slide pipeline forces substituting eq 3 into eq 6 and rearranging gives 8 f v s u a n v 1 2 c v r e n o n n e w t o n i a n based on eqs 7 and 8 fig 6 plots the relationship between f v s u a n v and re non newtonian allowing the slopes 0 5 c v for both peak cv p and stable cv s vertical forces at different gap ratios to be obtained through the least square method the best fit c v p and c v s at different gap ratios are presented in fig 7 showing an evident decreasing trend for both c v parameters as the gap ratio increases the h ps d pipe range where both c v p and c v s become stable is approximately between 1 0 and 2 5 the value of c v p is essentially larger than c v s which may be due to inertial effects and the presence of an entrapped water zone behind the pipeline see fig 3 causing a large pressure difference between the pipe front and rear sides as the slide first comes into contact with the pipeline in order to understand the mechanisms that govern how c v is affected by the pipeline seabed gap ratios a detailed consideration of the slide flow mechanism around the pipeline and along the seabed is necessary fig 8 shows an example of the velocity contour during slide pipeline interaction at a relatively large gap ratio h ps d pipe 5 0 when the slide has fully engulfed the pipeline i e c v c v s at this stage it can be seen from fig 8 a that there is a pair of symmetrical slide flow zones termed high velocity zone close to the pipeline circumference while there is a low velocity zone on the seabed a schematic of the slide flow paths around the pipeline is depicted in fig 8 b here the slide mass moves in the x direction along the seabed which is assumed to be equivalent to a flat no slip plate close to the seabed a boundary layer exists where the slide flow velocity v y increases non linearly from v y 0 at the seabed due to the no slip condition to the free stream velocity v 0 at a certain height above the seabed similarly a boundary layer may also form at the periphery of the pipeline as the slide mass flows around the pipeline but it is much thinner than the high velocity zone therefore as h ps d pipe decreases the slide flow velocity field around the pipeline becomes less symmetrical and the high velocity zone may overlap with the seabed boundary layer the variation of c v at different h ps d pipe reflects the pressure difference caused by the different slide flow velocities near the pipeline crown and invert levels due to the interaction of the seabed boundary layer and the pipeline invert high velocity zone therefore the variation of c v with different h ps d pipe is expected to be governed by the combined extent of both the seabed boundary layer and the pipeline high velocity zone in this study the high velocity zone around the pipeline is defined as the distance from the pipeline invert level to the farthest point r a where the slide velocity close to the pipeline invert v y is 1 1 times the free stream slide velocity v 0 i e v y 1 10 v 0 similarly the seabed boundary layer is defined as the vertical distance from the seabed δ seabed where the slide velocity v y is 0 to where it equals 99 of the free stream slide velocity v 0 i e v y 0 99 v 0 at the location along the seabed where the pipeline invert is situated the magnitudes of r a and δ seabed were measured from the ansys cfx post processing velocity contours the relationship between the r a d pipe and 1 re non newtonian for h ps d pipe of 5 0 and 10 0 is shown in fig 9 a it should be noted that these h ps d pipe ratios were chosen so that the r a can be assessed without the influence from the seabed boundary layer the extent of r a is expected to be governed by the pipeline diameter so r a is normalized with d pipe in fig 9 a it can be seen in fig 9 a that r a d pipe is inversely proportional to 1 re non newtonian an empirical equation describing the r a d pipe 1 re non newtonian relationship can be expressed as 9 r a d p i p e 1 17 1 r e n o n n e w t o n i a n 0 07 close to the seabed the boundary layer may be idealised as a fluid flow over a flat plate so the boundary layer thickness close to the seabed is expected to be a function of the reynolds number of the incoming slide flow and the characteristic length along the plane parallel to the slide flow l x schlichting and gersten 2016 in the case of a non newtonian fluid described by the herschel bulkley rheological model the seabed boundary layer thickness δ seabed can be evaluated as 10 δ s e a b e d l x 0 23 1 r e n o n n e w t o n i a n 0 02 1 r e n o n n e w t o n i a n 0 90 the dimensionless relationship between δ seabed l x and 1 re non newtonian at different gap ratios is shown in fig 9 b l x is 2 75 m for the simulation model of this study calculated from the submarine slide inlet to the pipeline centerline it should be noted that only the simulation results corresponding to h ps d pipe 5 0 are included in fig 9 b where the boundary layer at the seabed can develop freely fig 9 b shows that as re non newtonian increases the boundary layer near the seabed becomes thinner based on eqs 9 and 10 a critical gap h c affecting the inertial component of vertical forces can be defined as 11 h c d p i p e δ s e a b e d r a d p i p e as evident from eq 11 and from fig 9 the seabed boundary layer has a dominant influence on the inertial component of vertical forces at low reynolds numbers due to the thick seabed boundary layer and a small high velocity zone 1 d pipe close the pipeline surface interestingly this is similar to the flow round influence zone of a t bar penetrometer zhou et al 2007 by contrast the high velocity zone becomes dominant at high reynolds numbers the relationship of h c d pipe with re non newtonian is also plotted in fig 10 where it is shown that h c d pipe approaches 1 92 at large re non newtonian in light of the results depicted in figs 9 and 10 the peak and stable c v are plotted against h ps h c here h c d pipe 1 92 in fig 11 it can be seen here that for h ps h c the inertial component of vertical forces will be affected by the seabed pipeline gap but for h ps h c the peak c v p and stable c v s inertia parameters approaches 0 20 and 0 respectively these c v parameters may be estimated as 12 c v p 0 19 h p s h c 0 65 h p s h c 0 20 h p s h c 13 c v s 0 03 h p s h c 0 88 h p s h c 0 h p s h c from careful consideration of the interactions of the seabed boundary layer and the influence zone close to the pipeline the vertical slide pipeline forces can now be evaluated using eq 6 after determining n v parameter using eq 7 and c v parameter using eqs 12 and 13 5 verification on vertical forces evaluation the slide pipeline vertical forces estimated using the proposed method eqs 6 and 7 and eqs 12 and 13 as outlined above is compared with the experimental data reported by zakeri et al 2008 in fig 12 and the numerical simulation results reported by guo et al 2019 in fig 13 the detailed parameters of these previous experiments simulations can be found in table 3 fig 12 shows the performance of the proposed approach as compared to flume tests data reported by zakeri et al 2008 the results of zakeri et al 2008 may be assumed to correspond to the peak vertical force condition due to the limited slurry supply in their flume tests 190 l of slurry thus the normalized vertical force f v s u a is estimated using c v p the proposed approach for estimating the vertical forces matches the flume test data well see fig 12 estimations of the peak vertical forces using eqs 6 and 7 and eqs 12 and 13 also compares well with data reported by guo et al 2019 fig 13 a but the predicted stable vertical forces appear to be lower than those from guo et al 2019 especially at high re non newtonian this is attributed to the difference in defining the stable force in guo et al 2019 the stable force is taken as the maximum vertical force once the vertical force time profile has stabilized whereas in the present study an averaged value is used instead given the different pipeline diameters used in zakeri et al 2019 guo et al 2019 and the current study the close agreement of the estimated f v p and f v s with that reported by zakeri et al 2019 and guo et al 2019 give confidence to the proposed method in estimating the vertical slide pipeline impact forces 6 conclusions this paper has considered the vertical force component during submarine slide impact on offshore pipelines by means of computational fluid dynamics cfd simulations cfd simulations of a stationary pipeline were performed at different pipeline seabed gap ratios h ps d pipe and a non newtonian reynolds number re non newtonian range of 0 38 267 the main conclusions of this study are 1 the vertical slide pipeline forces will be oscillatory once re non newtonian exceeds 50 due to the shedding of vortices at the pipeline rear the resulting strouhal number a dimensionless parameter for representing the periodic shedding behaviour of the counter rotating vortices of the oscillation at different gaps is 0 166 0 222 for re non newtonian 50 267 in addition the oscillation characteristics and magnitude of the vertical forces are related to the pipeline seabed gap ratios 2 cfd results show that the magnitude of vertical slide pipeline force is influenced by the flow mechanism as the slide flows past the pipeline this flow mechanism is affected by the combined extent of the seabed boundary layer and the high velocity zones close to the pipeline surface 3 an expanded hybrid geotechnical fluid mechanics approach is derived from the cfd data where this approach combines a vertical geotechnical term n v net vertical pressure normalized by the mobilized shear stress around the pipeline which varies with the pipeline gap ratio and a vertical inertial term c v for both peak and stable vertical load conditions which varies as a function of both re non newtonian and the combined vertical extent of the seabed boundary layer and the flow high velocity zone close to the pipe circumference the proposed method shows good agreement with previously published experimental and numerical vertical slide pipeline force data demonstrating its ability to estimate the vertical slide pipeline forces in a simple and reliable manner to test the validity of the proposed method additional physical test programs tailored to investigate the effects of pipeline seabed gap on the slide pipeline vertical forces is recommended in future research endeavors credit authorship contribution statement ning fan conceptualization methodology software formal analysis writing original draft fauzan sahdi methodology validation investigation writing review editing wangcheng zhang methodology validation investigation writing review editing tingkai nian resources supervision funding acquisition writing review editing mark f randolph conceptualization validation investigation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the research presented here was supported by the national key research and development program of china 2018yfc0309203 2016yfe0200100 the national natural science foundation of china 51879036 zhejiang provincial natural science foundation of china lq21e080001 and the china scholarship council during a visit of ning fan to the centre for offshore foundation systems cofs of university of western australia the second author is grateful for the postdoctoral financial support provided by the arc industrial transformation research hub for offshore floating facilities which is funded by the australian research council woodside energy shell bureau veritas and lloyds register grant no ih140100012 the second author also acknowledges the financial support received from universiti malaysia sarawak the work also forms part of the activities of the cofs currently supported as a node of the australian research council centre of excellence for geotechnical science and engineering and through the fugro chair in geotechnics the lloyd s register foundation chair and centre of excellence in offshore foundations and the shell emi chair in offshore engineering 
21091,in recent years the interaction between submarine slide runout and offshore pipelines has received extensive attention based on the need to protect pipelines crossing regions susceptible to submarine slides the interaction force between the slide material and a pipeline may be resolved into horizontal and vertical components but with most attention to date focusing on the former while the latter has not been studied thoroughly this paper reports the results from a series of multiphase flow slide material and the ambient seawater numerical simulations using a computational fluid dynamics cfd approach aimed at investigating the vertical forces during submarine slide flow around a pipeline at different gap ratios pipeline seabed gap normalized by pipeline diameter from 0 08 to 10 0 and at reynolds numbers ranging from 0 38 to 267 the oscillatory characteristics and magnitude of the vertical forces for different gap ratios are discussed the effects of the gap ratios on the geotechnical and inertial components of the slide pipeline vertical forces are analyzed systematically using a hybrid geotechnical fluid mechanics framework from the results of the cfd simulations a modified hybrid geotechnical fluid mechanics method to estimate the slide pipeline vertical forces is developed considering the effects of pipeline seabed gaps keywords submarine slides pipelines vertical forces pipeline seabed gaps cfd approach 1 introduction submarine slides pose a significant threat to the security of oil and gas subsea infrastructure especially for offshore pipelines located in unstable regions of soft seabed schwab et al 1993 randolph et al 2011 zhang et al 2016 for example the mardi gras export pipeline from the atlantis field in the gulf of mexico crosses the base of the sigsbee escarpment which is prone to submarine slide hazards jeanjean et al 2005 in previous slope failures in this field slide runouts covering a distance of about 7 km travelling at velocities of up to 100 km h have been reported niedoroda et al 2003 for such hazardous environments estimating the potential loading caused by submarine slides is very important for the design of pipelines since the late 1970s methods to quantify the horizontal load component during submarine slide pipeline interaction have been developed based on both geotechnical and fluid mechanics principles these different approaches are summarised in table 1 the purely geotechnical framework links the slide pipeline horizontal interaction forces to the undrained shear strength of slide mass through a geotechnical bearing capacity equation while the fluid mechanics framework considers just the inertial effects of the slide mass when it flows around a cylinder assuming the soil shear strength is low the hybrid geotechnical fluid dynamics approach combines the above two frameworks and can be used to quantify the slide pipeline horizontal interaction forces for a large range of reynolds numbers 200 reflecting the slide behaviour spanning across the solid fluid range despite the recent advancement research on the vertical force component during submarine slide pipeline interaction is still limited moreover the vertical force may be oscillatory zakeri et al 2009 fan et al 2018 and the characteristics triggering mechanisms frequencies etc of the oscillating vertical force component have not been considered in detail the oscillating vertical force may pose potential resonance risk to pipelines in addition the vertical force component may also alter the pipeline vertical position leading to changes in the horizontal force magnitude fan et al 2019 offshore pipelines may be buried or laid on the seafloor with the latter generally preferred in deep water to minimize installation costs offshore pipelines often cross through undulating seabeds e g submarine escarpments canyons causing suspension of some pipeline sections jeanjean et al 2005 xiu et al 2016 moreover due to the complex pipeline soil water interactions initially on bottom seafloor pipelines may be suspended at different distances above the seabed vijaya kumar et al 2003 cathie et al 2005 due to scour of the underlying soil despite this the influence of the suspended distance between the pipeline and seabed termed gap henceforth on the slide pipeline interaction forces is rarely considered this paper investigates the effects of pipeline seabed gaps on the vertical slide pipeline forces using extensive computational fluid dynamics cfd simulations of slide interactions with a pipeline at different pipeline seabed gap ratios a hybrid geotechnical and fluid mechanics framework is proposed to evaluate the vertical slide pipeline forces 2 cfd modelling 2 1 governing equations of the incompressible multiphase flow after submarine slope failure the failed soil block may transform into a debris flow due to intense soil remoulding which is exacerbated by water entrainment boylan et al 2009 dong 2017 fan et al 2018 at this stage the sliding mass may travel at a velocity of up to 30 m s de blasio et al 2004 and possesses high water content and low undrained strength compared to the parent intact slope this paper focuses on the submarine slide phase that has progressed from the debris flow stage where the slide material may be considered as a fully remoulded viscous fluid the commercial cfd platform ansys cfx was used in this study to simulate the submarine slide impact on a pipeline the pre and post processing tools used in the cfd simulation include a three dimensional geometric model a meshing subprogram icem cfd and a cfx solver based on the finite volume method an inhomogeneous two phase separated eulerian eulerian multiphase flow model was used to simulate the interactions between the submarine slide mass and ambient water the phase continuity in a two phase flow can be written as 1 t r α ρ α r α ρ α u α s msα β 1 n p γ αβ where r α ρ α and u α are the volume fraction density and velocity of flowing material respectively s msα is the mass source term specified by the user n p is the total number of phases two in this study and γ αβ is the diffusion coefficient of the interphase mass transfer from the sliding mass to water which must obey the equal and opposite rule between two phases γ αβ γ βα α 1 n p γ α 0 in general to track the direction of the mass transfer between two phases γ αβ is expressed by γ αβ γ αβ γ βα with γ αβ 0 representing a positive net mass flow the volume fractions obey the conservation equation α 1 n p γ α 1 the momentum conservation is governed by the navier stokes equation expressed as 2 t r α ρ α u α r α ρ α u α u α r α p α r α μ α u α u α t β 1 n p γ α β u β γ β α u α s m α m α where p α and μ α are the phase pressure and viscosity respectively s mα is the momentum source which is implemented in ansys cfx as force per unit volume acting on the fluids due to external body forces and user definition γ α β u β γ β α u α is the momentum transfer induced by the interphase mass transfer m α is the total interfacial forces acting on phase α due to the interaction with phase β m α may arise from several independent physical effects such as the interphase drag force uplift force wall lubrication force virtual mass force and turbulence dispersion force 2 2 numerical modelling details the numerical model used to simulate the slide pipeline interaction is shown in fig 1 a numerical domain of 8 m 15 5 m 0 5 m width height thickness was used with a pipeline of 0 5 m in diameter d pipe fixed horizontally at 2 5 m 5 d pipe away from the inlet the slide mass of 10 5 m in height enters from the left side of the domain over 270 000 tetrahedral elements with a maximum grid size of 0 25 m were used in the numerical model grid refinement was conducted in a square zone with a radius of 0 75 m 1 5 d pipe where 5 layers of very fine mesh total thickness of 0 05 m were constructed around the pipeline and on the seabed surface as shown in fig 1 b the inlet of slide mass is a velocity boundary and the outlet is an opening boundary with a gauge pressure of zero the top and left boundaries are set as free slip surfaces while the bottom boundary and the pipeline were set as rough no slip surfaces each with equivalent roughness ks of 0 0015 and 0 5 mm crowe et al 2001 zakeri et al 2009 each simulation was terminated when the sliding mass has travelled an equivalent distance of 48 m 96 d pipe and therefore the simulation duration depends on the runout velocity e g the duration is 48 s for a runout velocity of 1 m s this approach was employed to ensure that the vertical force time profiles for all simulation cases have stabilized a second order upwind difference scheme was applied through the model and a standard k ε model was employed once turbulent flow became relevant within either the sliding mass or the seawater in total 71 cfd simulations were performed in this study as shown in table 2 cases 1 1 to 7 8 encompass re non newtonian of 0 38 267 and gap ratio h ps d pipe where h ps is the pipeline seabed gap of 0 08 10 0 to investigate the effect of different gap ratios on the slide pipeline forces re non newtonian is defined as zakeri et al 2008 3 r e n o n n e w t o n i a n ρ v 2 μ a p p γ ρ v 2 s u where γ is shear strain rate s 1 γ v d pipe μ a p p s u γ is the apparent viscosity pa s cases 8 1 to 9 4 were performed to investigate the effects of sliding mass strength on the slide pipeline interaction forces see section 3 the strength increases in proportion with the increase in the shear strain rate according to the well known herschel bulkley rheological model 4 s u τ τ y k γ n where τ is the shear stress of the submarine slide mass pa τ y is the yield stress pa k is the viscous property of the fluids pa s n n is the shear thinning index note that the results at very high re non newtonian cases 8 3 and cases 8 4 may be influenced by the choice of turbulence model however this is outside the scope of the current paper and warrants future investigations case 10 1 to case 10 7 were performed to simulate extreme conditions where the sliding body travels at a very low velocity v 0 01 m s re non newtonian 0 001 on a smooth seabed so that the soil strength contribution to the vertical slide pipeline forces can be investigated see section 4 for simplicity the density of ambient seawater was set equal to the slide mass to prevent the slide mass from collapsing at low velocities or hydroplane at high velocities mohrig et al 1999 along the slide run out direction this simplification is expected to have little influence on the slide pipeline vertical force results because the pipeline behaviour is mainly affected by the slide mass 3 slide pipeline vertical force evolution compared to a single phase fluid flow such as water passing a cylinder the process of submarine slide impacting a pipeline is more complicated since it is essentially a two phase flow problem the sliding body is a non newtonian fluid but the ambient water is a newtonian fluid to investigate the time dependent characteristics of the vertical slide pipeline forces f v some typical vertical force time curves at different re non newtonian are shown in fig 2 it should be noted that all the cases in fig 2 have the same pipeline seabed gap ratio h ps d pipe 1 0 it can be seen that the vertical forces show large fluctuations when the slide mass first comes into contact with the pipeline after which f v either levels off in cases with re non newtonian 0 2 to 23 as shown in fig 2 a b c d e g or oscillates periodically in cases with re non newtonian from 87 to 1241 as shown in fig 2 f h i as more slide material interacts with the pipeline this two stage slide pipeline vertical force evolution can be characterized by the peak the maximum value in the instantaneous slide impact stage and stable the average value in the stable impact stage forces the stable vertical force describes the continuous slide pipeline interaction for a large length to thickness ratio of the sliding body while the peak vertical force is generally larger than the stable force and more representative of the destructiveness of submarine slides from an ultimate limit state design perspective therefore both are analyzed in this study an example of the slide pipeline interaction features at high re non newtonian is depicted in fig 3 which shows the variation of the volume fraction and streamline of the slide mass and seawater during slide pipeline interaction a separated region consisting of the ambient seawater is formed at the pipeline rear when the slide first comes into contact with the pipeline as shown in fig 3 a the separated region gradually closes as more slide material interacts with the pipeline simulation times of 3 7 s 40 s the slide mass gradually replaces the water in the separated region after which vortex shedding can be observed at the pipeline rear in fig 3 b this is similar to newtonian fluid flow past pipelines sumer and fredsøe 2006 the shedding of counter rotating vortices of the slide material causes a periodic oscillation of the vertical slide pipeline forces in this study the re non newtonian range where vortex shedding of the slide material in the pipeline wake occurs is consistent with patnana et al 2009 who reported periodic shedding behaviour for re non newtonian 50 after the onset of flow separation sahdi et al 2019 for shear thinning non newtonian fluids the periodic shedding behaviour of the counter rotating vortices can be represented by a dimensionless parameter the strouhal number st defined as 5 s t f d p i p e v where f is the vortex shedding frequency hz to analyze the effect of pipeline seabed gap on the slide pipeline vertical force oscillation characteristics the relationship between the strouhal number and the reynolds number for different gap ratios h ps d pipe 0 2 10 0 are shown in fig 4 where the data for simulations conducted at re non newtonian 50 the critical reynolds number for periodic vortex shedding in the current and previous studies zakeri et al 2008 2009 is plotted for gap ratios 0 2 vortex shedding is inhibited even at large re non newtonian due to the restricted slide flow below the pipeline invert it can be seen in fig 4 that the st increases with increasing re non newtonian this trend is consistent with the results of newtonian fluid flow past a cylinder schlichting and gersten 2016 the st also increases with decreasing gap ratio and the resulting st range 0 166 0 222 is slightly larger than that of the newtonian flow past a cylinder 0 14 st 0 21 but consistent with previous flume tests zakeri et al 2008 and cfd simulations zakeri et al 2009 fan et al 2018 the tendency for st to change with h ps d pipe may be attributed to the formation of asymmetric vortices as the pipeline gap from the seabed decreases i e decreasing h ps d pipe both the peak and stable vertical forces for different gap ratios h ps d pipe of 0 08 10 0 are summarised in table 2 generally the results show that the peak and stable vertical forces both increase as the re non newtonian increases and the gap decreases when the gap ratio h ps d pipe exceeds 2 5 the average stable vertical force is essentially negligible 0 n however the stable vertical forces can be as high as 1 kn when h ps d pipe 1 0 a methodology to effectively quantify this force component is discussed in subsequent sections 4 vertical slide pipeline forces 4 1 hybrid geotechnical fluid mechanics framework similar to quantifying the horizontal slide pipeline forces randolph and white 2012 the vertical forces may also be interpreted using the hybrid framework 6 f v n v s u a 1 2 ρ v 2 c v a where n v and c v are the uplift bearing factor and uplift drag coefficient respectively the first term captures the contribution of soil strength to the vertical slide pipeline forces while the second term represents the contribution of the incoming flow inertial forces since f v varies with both re non newtonian and h ps d pipe the n v and c v parameters of each component are expected to be influenced by the gap ratios h ps d pipe and these aspects are explored in the ensuing sections 4 2 viscous strength component of vertical slide pipeline forces as highlighted earlier the slide pipeline vertical force component due to the slide viscous strength was quantified by modelling a slide mass travelling at low velocities along a smooth seabed past the pipeline v 0 01 m s as in case 10 1 to case 10 7 in table 2 implying that the inertial component is negligible so that we may consider f v n v s u a fig 5 depicts the cfd results for cases 10 1 to 10 7 where the f v is normalized by the operative undrained strength of the slide s u calculated using eq 4 with the adopted τ y k and n parameters shown in table 2 multiplied by the pipeline projected area a it can be seen here that the normalized slide pipeline vertical forces n v decreases sharply with increasing h ps d pipe for h ps d pipe 2 0 n v approaches 0 showing little seabed boundary influence as depicted in fig 5 the variation of n v with h ps d pipe can be fitted by 7 n v 2 5 15 9 h p s d p i p e 1 6 5 h p s d p i p e 4 3 inertial component of vertical slide pipeline forces substituting eq 3 into eq 6 and rearranging gives 8 f v s u a n v 1 2 c v r e n o n n e w t o n i a n based on eqs 7 and 8 fig 6 plots the relationship between f v s u a n v and re non newtonian allowing the slopes 0 5 c v for both peak cv p and stable cv s vertical forces at different gap ratios to be obtained through the least square method the best fit c v p and c v s at different gap ratios are presented in fig 7 showing an evident decreasing trend for both c v parameters as the gap ratio increases the h ps d pipe range where both c v p and c v s become stable is approximately between 1 0 and 2 5 the value of c v p is essentially larger than c v s which may be due to inertial effects and the presence of an entrapped water zone behind the pipeline see fig 3 causing a large pressure difference between the pipe front and rear sides as the slide first comes into contact with the pipeline in order to understand the mechanisms that govern how c v is affected by the pipeline seabed gap ratios a detailed consideration of the slide flow mechanism around the pipeline and along the seabed is necessary fig 8 shows an example of the velocity contour during slide pipeline interaction at a relatively large gap ratio h ps d pipe 5 0 when the slide has fully engulfed the pipeline i e c v c v s at this stage it can be seen from fig 8 a that there is a pair of symmetrical slide flow zones termed high velocity zone close to the pipeline circumference while there is a low velocity zone on the seabed a schematic of the slide flow paths around the pipeline is depicted in fig 8 b here the slide mass moves in the x direction along the seabed which is assumed to be equivalent to a flat no slip plate close to the seabed a boundary layer exists where the slide flow velocity v y increases non linearly from v y 0 at the seabed due to the no slip condition to the free stream velocity v 0 at a certain height above the seabed similarly a boundary layer may also form at the periphery of the pipeline as the slide mass flows around the pipeline but it is much thinner than the high velocity zone therefore as h ps d pipe decreases the slide flow velocity field around the pipeline becomes less symmetrical and the high velocity zone may overlap with the seabed boundary layer the variation of c v at different h ps d pipe reflects the pressure difference caused by the different slide flow velocities near the pipeline crown and invert levels due to the interaction of the seabed boundary layer and the pipeline invert high velocity zone therefore the variation of c v with different h ps d pipe is expected to be governed by the combined extent of both the seabed boundary layer and the pipeline high velocity zone in this study the high velocity zone around the pipeline is defined as the distance from the pipeline invert level to the farthest point r a where the slide velocity close to the pipeline invert v y is 1 1 times the free stream slide velocity v 0 i e v y 1 10 v 0 similarly the seabed boundary layer is defined as the vertical distance from the seabed δ seabed where the slide velocity v y is 0 to where it equals 99 of the free stream slide velocity v 0 i e v y 0 99 v 0 at the location along the seabed where the pipeline invert is situated the magnitudes of r a and δ seabed were measured from the ansys cfx post processing velocity contours the relationship between the r a d pipe and 1 re non newtonian for h ps d pipe of 5 0 and 10 0 is shown in fig 9 a it should be noted that these h ps d pipe ratios were chosen so that the r a can be assessed without the influence from the seabed boundary layer the extent of r a is expected to be governed by the pipeline diameter so r a is normalized with d pipe in fig 9 a it can be seen in fig 9 a that r a d pipe is inversely proportional to 1 re non newtonian an empirical equation describing the r a d pipe 1 re non newtonian relationship can be expressed as 9 r a d p i p e 1 17 1 r e n o n n e w t o n i a n 0 07 close to the seabed the boundary layer may be idealised as a fluid flow over a flat plate so the boundary layer thickness close to the seabed is expected to be a function of the reynolds number of the incoming slide flow and the characteristic length along the plane parallel to the slide flow l x schlichting and gersten 2016 in the case of a non newtonian fluid described by the herschel bulkley rheological model the seabed boundary layer thickness δ seabed can be evaluated as 10 δ s e a b e d l x 0 23 1 r e n o n n e w t o n i a n 0 02 1 r e n o n n e w t o n i a n 0 90 the dimensionless relationship between δ seabed l x and 1 re non newtonian at different gap ratios is shown in fig 9 b l x is 2 75 m for the simulation model of this study calculated from the submarine slide inlet to the pipeline centerline it should be noted that only the simulation results corresponding to h ps d pipe 5 0 are included in fig 9 b where the boundary layer at the seabed can develop freely fig 9 b shows that as re non newtonian increases the boundary layer near the seabed becomes thinner based on eqs 9 and 10 a critical gap h c affecting the inertial component of vertical forces can be defined as 11 h c d p i p e δ s e a b e d r a d p i p e as evident from eq 11 and from fig 9 the seabed boundary layer has a dominant influence on the inertial component of vertical forces at low reynolds numbers due to the thick seabed boundary layer and a small high velocity zone 1 d pipe close the pipeline surface interestingly this is similar to the flow round influence zone of a t bar penetrometer zhou et al 2007 by contrast the high velocity zone becomes dominant at high reynolds numbers the relationship of h c d pipe with re non newtonian is also plotted in fig 10 where it is shown that h c d pipe approaches 1 92 at large re non newtonian in light of the results depicted in figs 9 and 10 the peak and stable c v are plotted against h ps h c here h c d pipe 1 92 in fig 11 it can be seen here that for h ps h c the inertial component of vertical forces will be affected by the seabed pipeline gap but for h ps h c the peak c v p and stable c v s inertia parameters approaches 0 20 and 0 respectively these c v parameters may be estimated as 12 c v p 0 19 h p s h c 0 65 h p s h c 0 20 h p s h c 13 c v s 0 03 h p s h c 0 88 h p s h c 0 h p s h c from careful consideration of the interactions of the seabed boundary layer and the influence zone close to the pipeline the vertical slide pipeline forces can now be evaluated using eq 6 after determining n v parameter using eq 7 and c v parameter using eqs 12 and 13 5 verification on vertical forces evaluation the slide pipeline vertical forces estimated using the proposed method eqs 6 and 7 and eqs 12 and 13 as outlined above is compared with the experimental data reported by zakeri et al 2008 in fig 12 and the numerical simulation results reported by guo et al 2019 in fig 13 the detailed parameters of these previous experiments simulations can be found in table 3 fig 12 shows the performance of the proposed approach as compared to flume tests data reported by zakeri et al 2008 the results of zakeri et al 2008 may be assumed to correspond to the peak vertical force condition due to the limited slurry supply in their flume tests 190 l of slurry thus the normalized vertical force f v s u a is estimated using c v p the proposed approach for estimating the vertical forces matches the flume test data well see fig 12 estimations of the peak vertical forces using eqs 6 and 7 and eqs 12 and 13 also compares well with data reported by guo et al 2019 fig 13 a but the predicted stable vertical forces appear to be lower than those from guo et al 2019 especially at high re non newtonian this is attributed to the difference in defining the stable force in guo et al 2019 the stable force is taken as the maximum vertical force once the vertical force time profile has stabilized whereas in the present study an averaged value is used instead given the different pipeline diameters used in zakeri et al 2019 guo et al 2019 and the current study the close agreement of the estimated f v p and f v s with that reported by zakeri et al 2019 and guo et al 2019 give confidence to the proposed method in estimating the vertical slide pipeline impact forces 6 conclusions this paper has considered the vertical force component during submarine slide impact on offshore pipelines by means of computational fluid dynamics cfd simulations cfd simulations of a stationary pipeline were performed at different pipeline seabed gap ratios h ps d pipe and a non newtonian reynolds number re non newtonian range of 0 38 267 the main conclusions of this study are 1 the vertical slide pipeline forces will be oscillatory once re non newtonian exceeds 50 due to the shedding of vortices at the pipeline rear the resulting strouhal number a dimensionless parameter for representing the periodic shedding behaviour of the counter rotating vortices of the oscillation at different gaps is 0 166 0 222 for re non newtonian 50 267 in addition the oscillation characteristics and magnitude of the vertical forces are related to the pipeline seabed gap ratios 2 cfd results show that the magnitude of vertical slide pipeline force is influenced by the flow mechanism as the slide flows past the pipeline this flow mechanism is affected by the combined extent of the seabed boundary layer and the high velocity zones close to the pipeline surface 3 an expanded hybrid geotechnical fluid mechanics approach is derived from the cfd data where this approach combines a vertical geotechnical term n v net vertical pressure normalized by the mobilized shear stress around the pipeline which varies with the pipeline gap ratio and a vertical inertial term c v for both peak and stable vertical load conditions which varies as a function of both re non newtonian and the combined vertical extent of the seabed boundary layer and the flow high velocity zone close to the pipe circumference the proposed method shows good agreement with previously published experimental and numerical vertical slide pipeline force data demonstrating its ability to estimate the vertical slide pipeline forces in a simple and reliable manner to test the validity of the proposed method additional physical test programs tailored to investigate the effects of pipeline seabed gap on the slide pipeline vertical forces is recommended in future research endeavors credit authorship contribution statement ning fan conceptualization methodology software formal analysis writing original draft fauzan sahdi methodology validation investigation writing review editing wangcheng zhang methodology validation investigation writing review editing tingkai nian resources supervision funding acquisition writing review editing mark f randolph conceptualization validation investigation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the research presented here was supported by the national key research and development program of china 2018yfc0309203 2016yfe0200100 the national natural science foundation of china 51879036 zhejiang provincial natural science foundation of china lq21e080001 and the china scholarship council during a visit of ning fan to the centre for offshore foundation systems cofs of university of western australia the second author is grateful for the postdoctoral financial support provided by the arc industrial transformation research hub for offshore floating facilities which is funded by the australian research council woodside energy shell bureau veritas and lloyds register grant no ih140100012 the second author also acknowledges the financial support received from universiti malaysia sarawak the work also forms part of the activities of the cofs currently supported as a node of the australian research council centre of excellence for geotechnical science and engineering and through the fugro chair in geotechnics the lloyd s register foundation chair and centre of excellence in offshore foundations and the shell emi chair in offshore engineering 
21092,the cavity dynamics and trajectories of twin spheres vertically entering water side by side are investigated experimentally for different time intervals and several lateral distances at initial velocities from 14 1 m s to 15 2 m s with the diameter d based froude number varying from 37 1 to 40 0 a high speed photograph system and an image processing method are employed to obtain the features of cavity flow and the position of twin spheres we firstly investigate the cavity shapes and sphere trajectories with lateral distance being 1 5d between the spheres results show that the contact lines of two cavities are obliquely pinned on the twin spheres in synchronous water entry and a molar shaped cavity is formed by the overlap of the two cavities subsequently the motion characteristics of the second water entry sphere sphere ii are studied as the increase of time interval between the twin spheres it is found that the influence on sphere ii increases as the decrease of the time interval at lateral distance of a 1 5d except a certain condition i e δt 2 5 ms as we change the lateral distance in synchronous water entry the disturbance introduced by adjacent sphere is weakened with the increase of the distance the results demonstrate that both the cavity dynamics and trajectories of sphere ii are similar to that of single water entry when the lateral distance increases to 5 5d as for the combined effects of lateral distance and time interval on twin water entry it is found that sphere ii is attracted horizontally to sphere i at moderate time intervals with the lateral distance of a 1 5d while the interaction acted on sphere ii in cases of a 2 5d and 3 5d changes from repulsion to attraction gradually as the increase of time interval from 3 5 ms to 8 4 ms and then to 13 1 ms keywords twin water entry side by side cavity dynamics trajectory repulsion attraction 1 introduction when an object passes through a free surface and enters into water a complex multiphase flow process is occurred which is called water entry water entry problem has been investigated for over a century owing to its broad engineering application background such as naval weapons may 1951 rabiee et al 2011 ship launching chen 2007 aerospace industry qu et al 2015 ballistic water entry truscott et al 2009 and so on in the early studies the formation and evolution of cavities jet and splash were usually discussed aristoff et al 2010 duclaux et al 2007 duez et al 2007 gilbarg and anderson 1948 shi and takami 2001 worthington and cole 1897 with the development of high speed camera technology various experimental methods were proposed to investigate the water entry of objects with different shapes such as wedge cylinder bullet disk and even droplet chen et al 2019a ern and brosse 2014 speirs et al 2018 truscott et al 2009 vincent et al 2018 wei and hu 2014 with many different and interesting phenomena coming to light when objects impact water instantaneous changes occurs in the flow structure owing to the interaction among solid liquid and gas phases ding et al 2015 in order to explain the mechanism of this multiphase flow process many studies have been carried out to detail the fluid object interaction including cavity evolution impact force splash dynamics body trajectory etc as one of the most typical phenomena in this multiphase flow process cavitation is easily affected by the posture of moving objects for example the spinning motion can induce a lift force on spheres in free falling water entry which results in a deviation of trajectory and formes a cardioid shaped cavity observed in bird s eye view truscott and techet 2009a 2009b wei and hu 2015 revealed the cavity evolution of cylinders with inclined angles during water entry and discussed the trajectories and angular displacement of cylinders based on their studies horizontal velocities were taken into account for cylinders during water entry by xia et al 2019 with the horizontal effect on cavity dynamics and motion characteristics being evaluated as objects impact water an instantaneous force is usually generated truscott et al 2012 presented a study on this kind of force during free falling water entry and the effects on trajectories and force coefficient were revealed and it was found that a lighter sphere undergoes a larger deceleration and trajectory deviation most investigations in this field focus on single object hydrodynamics however the motion of multiple objects has a very wide engineering application as well and the flow structure of multiple objects is usually different from that of single one alam and zhou 2007 kim et al 1993 yoon and yang 2007 wake flow behind multi objects is of great significance to ocean engineering affecting the design of marine structures bai et al 2020 a complex flow structure often occurs between two objects leading to an interweaving wake mondal et al 2019 schouveiler et al 2004 in order to understand such flow details intuitively particle image velocimetry was applied to measure the flow field around three circular cylinders side by side at various gap ratios and reynolds numbers in a water tunnel by sooraj et al 2019 for the problem of multiple objects in high speed incoming flow with cavitation jin et al 2010 numerically investigated the cavity shape and drag characteristics of tandem cylinders using fluent 6 3 which was known as an early study about cavitating flow of multiple objects however only a small number of published studies have focused on multi object water entry up to now which is important for a wide range of scientific and industrial processes wang and wang 2010 numerically studied the influence of various parameters of cylinders on the hydrodynamic forces acting on two cylinders water entry side by side moreover the water entry cavity evolution and motion characteristics of two bodies in tandem are investigated by yu 2019 using numerical and experimental methods with the speed of water entry less than 3 43 m s more recently the tandem water entry of two spheres was investigated by yun et al 2020a 2020b they found that the second sphere was accelerated when it submerged in the cavity created by the first sphere during oblique water entry while it leaded to a significantly large cavity and an interesting multi section cavity during the vertical water entry lu et al 2019a studied the cavities evolution and motion characteristics during side by side water entry of two cylinders at a very low speed range of 1 5 3 1 m s and found that the cavities were obviously asymmetry in addition the effect of froude number during water entry on cavities evolution was analyzed by lu et al 2019b with comparison of the cavity shapes between single and twin water entry with cylinders recently wang and lyu 2020 experimentally investigated the water entry of twin spheres synchronously with different lateral distances side by side and the cavity evolution and wakes characteristics were revealed previous studies have extensively investigated the water entry of one object however only a little attentions have been paid to the disturbance by adjacent object during water entry of multiple objects side by side which obviously affects the two phase flow pattern and the movements of objects to further explain the complicated interaction among bodies cavities and water flow during this process the cavity dynamics and trajectories of twin spheres entering water side by side are investigated in this paper with the water entry speed from 14 1 m s to 15 2 m s and surface seal occurring to achieve a systematic understanding both time interval and lateral distance between the twin spheres are taken into account we firstly analyze the cavity dynamics of synchronous water entry and then evaluate the influence of the first cavity on the second water entry by changing time interval and lateral distance respectively 2 experimental methods 2 1 experimental setup the water entry experiments are carried out in a closed laboratory in order to avoid the air flow disturbance twin steel spheres are released by two paralleled reluctance coil electromagnetic launchers which are composed of energy storage capacitors induction coils photoelectric gates and rails the spheres are made of high carbon chromium bearing steel with measuring diameter d 14 7 mm and density ρ s 7778 6 kg m3 the static contact angle of water on the sphere surface is α 80 10 similar to that of the sphere used by yun et al 2020a the twin spheres are vertically launched into the water filled rectangular tank which has a dimension of 1000 700 1000 mm3 with the water depth being set to 750 mm to avoid the initial disturbance of the acquiescent air water surface the wait time between two releases is more than 10 min in order to capture the cavity dynamics and trajectories during the water entry process a high speed photograph system with two cameras is applied as shown in fig 1 a phantom veo410 camera with a 105 mm fixed focus lens is used for front view acquisition while the other one of phantom lc111 with a 24 85 mm zoom nikon lens is applied to check whether the motion of twin spheres deviates in the side view in order to clearly analyze the changes of cavity shaped and trajectories the frame rate of the cameras is set to 10000 fps and the exposure time is in a range of 7 17 μs at such high frame rate for image acquisition the resolutions of the two cameras are limited to 1280 400 and 1280 200 pixels respectively in addition five led lights and two backlights are located around the tank to provide bright and uniform view for the image acquisition note that special attentions should be paid to the arrangement of these lights to get very crisp images during the experiment 2 2 image processing method the origin of the coordinate is set on the quiescent free surface where the sphere entering into is set as y 0 mm and the moving direction of sphere is set as negative along y axis as sketched in fig 1 the x coordinate represents the horizontal deviation of the sphere during a drop in order to get the position of twin spheres from image sequences a digital image correlation dic method based on the studies by epps et al 2010 and wei and hu 2014 2015 is employed to get the position of sphere from each frame image in this paper we make a template with a size of 1 5d for the sphere above the free surface using the cross correlation method to extract the positions in each image the optimal solution is acquired by the translation information which is cooperated with a gaussian fitting curve with both accuracy and smoothness being considered the curves of velocity and acceleration are obtained by the first and second derivation of displacement respectively to reduce the error of fitting curve the spline curve with an acceptable tolerance and a proper roughness should be find the kinks at critical error tolerance of twin spheres in a typical case i e case 2 as described in table 1 are selected and marked by red square in fig 2 the critical error tolerance of sphere i is 3 89 10 9 and that of sphere ii is 4 02 10 9 an estimate of experimental measurement error epps et al 2010 wei and hu 2014 2015 can be written as ε e c r n δ t where n 1000 is the image number obtained for sphere position data analysis δt is acquisition time interval of high speed camera the experimental measurement errors of the twin spheres are ε 1 0 197 mm and ε 2 0 200 mm respectively so that we have 0 2 mm 0 471 pixel therefore it is believed that we get an image processing resolution of half pixel in present study 3 results and discussion the experimental cases of twin water entry are listed in table 1 the corresponding froude numbers f r u 0 g d varies in a range of 37 1 40 0 based on water entry velocity u 0 and sphere diameter d in cases 1 to 5 we consider the effects of lateral distance between twin spheres on cavity dynamic in synchronous water entry in cases 6 to 19 we investigate the trajectory and cavity evolution of sphere ii in various time intervals and lateral distance cases 8 14 and 18 are applied to demonstrate the differences of cavity diameter at different lateral distance with the time interval about 8 4 ms case 0 represents water entry with a single sphere and is used as a control group for comparison with other cases the sphere entering into water earlier is marked as sphere i and the other one is marked as sphere ii the time point when sphere i reaches the quiescent water surface is set as t 1 0 and that for sphere ii is set as t 0 the symbols u 10 and u 20 represent the initial velocities of sphere i and sphere ii respectively during water entry note that the time points of the sphere reach the quiescent water surface in single water entry and synchronous twin water entry are both set as t 0 as well 3 1 cavities evolution of synchronous water entry fig 3 shows a sequence of images depicting twin spheres entering water synchronously in this case the twin spheres step into the open cavity stage concurrently the cavities generated by the spheres expand towards each other and the expansion is limited by the short lateral distance 1 5d forming a pair of asymmetric cavities which are symmetrical about the centerline fig 3 b with the downward movements of the spheres both diameter and length of the twin cavities increase before surface seal and the cavities remain symmetric with each other one interesting observation is that the cavity walls overlap to connect twin cavities and forms a molar shaped cavity as marked in fig 3 c and d in addition a converged upward jetting appears with a notable velocity which is caused by the splashes and enhanced by surface seals of the twin cavities as shown in fig 3 c and d at t 20 ms fig 3 e a large number of micro bubbles cover the middle of the molar shaped cavity worsening the instability of cavity evolution and leading to a subsequent collapse the collapse develops into a cloud wake behind the cavity as the spheres move downwards as shown in fig 3 f h owing to a large velocity difference between the spheres and water when impacting events happened the contact line between cavity and sphere moves up along the sphere surface with a high initial speed as has been reported by ding et al 2015 an adverse pressure gradient exists near the equator of spheres which will slow down the movement of contact line and make it pin to the sphere surface finally as shown in fig 4 the contact lines induced by the twin spheres show good symmetry with different angles of inclination at different time points during water entry the surrounding water is rapidly accelerated as the spheres passing concurrently the kinetic of spheres is converted to water and the fluid in the inner side of twin spheres received more energy so that a high inside splash occurs as shown in figs 4 a and fig 3 b whereby a low pressure zone is created between the spheres due to bernoulli s principle and weakens the blocking effect of the adverse pressure gradient near sphere equator thus the inner side of contact line stops slightly above the equator of sphere while the other side pinned at a normal position causing an oblique contact line fig 4 b shows the curve of contact line angle β varying with time the angle β is defined as the angle between the contact line and horizontal plane it appears that the contact line angle rapidly rises within 1 1 ms owing to the strongly disturbance upon water entry and rises more and more slowly as the water entry develops 3 2 effect of time interval between the twin spheres on water entry mostly side by side objects are more likely to enter into water with a certain time interval other than strict synchronization this may leads to a different cavity dynamics and trajectory variation in this section the time interval effect of the cases with a 1 5d is discussed fig 5 displays the main features of twin water entry at δt 4 4 ms in case 7 sphere ii hits the cavity created by sphere i called cavity i leading to an initial cavity deformation as shown in fig 5 a before sphere ii arriving at the free surface a low pressure region has been produced by cavity i therefore once sphere ii enters into water and generates another cavity called cavity ii the new cavity is affected by the low pressure region it is found that the inner side cavity wall expands horizontally and even breaks through the walls of cavity i fig 5 b and c and a multistrand cavity is formed as shown in fig 5 d with three sub cavities marked as c1 c2 and c3 respectively in fig 5 d and e as the multistrand cavity pulled away from free surface the main body of sub cavity c2 between c1 and c3 collapses to a smaller one trailing after sphere i the developed cavity c2 together with the separated cavities c1 and c3 forms a y shaped cavity during this process sphere ii enters into cavity i and moves for a short time and then hits sphere i at t 1 32 4 ms as detailed in fig 6 a ring joint caused by collision of the twin spheres appears in fig 6 d similar to that observed by hurd et al 2015 and yun et al 2020a it can be seen from fig 6 d f that the ring joint is almost at the same height as marked by a blue dot line and slightly moves up as the spheres move down the velocity and acceleration of twin spheres in this process are show in fig 7 it is found that both of the twin spheres suffers violent deceleration as they impact water and the acceleration of sphere ii decreases quickly upon the sphere entering into cavity i as shown in fig 7 b subsequently sphere ii moves in the cavity with gentle changes of velocity due to much lower drag from gas instead of water an energy transfer occurred during the collision between the two spheres as shown in fig 7 b a horizontal jet occurs when sphere ii hits the wall of cavity i again as demonstrated in fig 6 e and f the cavity wall becomes rough owing to the impacting of lateral splash similar as that reported by yun et al 2020a and the splash grows up as sphere ii penetrates the cavity wall finally as shown in fig 6 e and fig 5 h cavity i is cut off by the horizontal jet and part of the cavity still moves with sphere i meanwhile sphere ii induces a new cavity when it escapes from cavity i completely differing from that cavity i is not sealed yet when sphere ii reaches the air water free surface in case 7 δt 4 4 ms cavity i in case 9 δt 13 4 ms has sealed at the free surface and been pulled away when sphere ii arrived as shown in fig 8 a according to bernoulli principle the local water field behind cavity i achieves a lower pressure distribution than that of the surroundings due to the downward movements of both sphere i and the cavitation wake it is clear that the expansion of cavity ii would yield to the low pressure region as shown in fig 8 b once cavity ii reaches the bubbly wake of cavity i the expansion interacts with the wake and arouses a sharp tuber on the wall of cavity ii as depicted in fig 8 c with sphere i moving down cavity i begins to collapse and leaves a foamy wake which penetrates into cavity ii generating a water curtain on the cavity wall as shown in fig 8 d this phenomenon is similar to the water wedge observed by xia et al 2019 who investigated the water entry of a cylinder with a horizontal velocity moreover a wave shaped wall deformation of cavity ii caused by the foam wake appears as well as shown in fig 8 e and f some expanding water curtains along cavity ii converge into a lateral splash and cause a contraction of the cavity as the sphere moves downwards cavity ii finally pinches off at the splash point and generates an inclined foam wake as depicted in fig 8 g and h in addition it is found that the vertical position of the splash almost remains constant during the cavity evolution it is observed that although the wake of cavity i deformed a little asymmetrically due to the effect by sphere ii the part of cavity i ahead sphere ii is almost unaffected as shown in fig 8 b f it also can be seen clearly that the trajectory of sphere ii generates an obvious horizontal deviation owing to the differential pressure created by the water entry of sphere i whereas the trajectory of sphere i doesn t changed distinctly as shown in fig 8 to quantify this horizontal deviation of sphere ii during water entry the trajectories for sphere ii cases 6 10 with δt 2 5 ms 4 4 ms 8 6 ms 13 4 ms and 40 7 ms respectively during water entry are presented in fig 9 to study the influence of time intervals as shown in the figure although we have tried our best to fabricate the experimental setup and the spheres with a high degree of accuracy the single sphere with few initial disturbances above water still gets some random horizontal deviation that falls in the shaded area marked in fig 9 during water entry this might be caused by the wake fluctuation behind the sphere similar to that reported by xia et al 2019 in case 7 with δt 4 4 ms sphere ii penetrate the wall of cavity i and enter into the water field again resulting in a significant horizontal deviation however cavity i has already broken into a lot of dissipated micro bubbles which have little effect on the sphere ii when it enters into water in the case with δt 40 7 ms as a result the trajectory deviation of sphere ii is basically in the same level with that of the single water entry as demonstrated clearly in fig 9 it is found that the horizontal deviation of sphere ii is increased with the decrease of time intervals from 40 7 ms to 4 4 ms indicating that the effect of cavity i on sphere ii increases however the deviation which is supposed to be much more significant shows a totally different trend as the time interval decreases to the δt 2 5 ms in case 6 this distinct phenomenon will be discussed later in section 3 3 2 with more details 3 3 effect of lateral distance between the twin spheres on water entry in this section the effect of the lateral distance between twin spheres on the water entry process is investigated with distances of 1 5d 2 5d 3 5d 5 5d and 7 5d being taken into account the cases of synchronous water entry are discussed in section 3 3 1 and those of successive water entry are evaluated in section 3 3 2 with effects of different time intervals being discussed 3 3 1 synchronous water entry side by side fig 10 displays the cavity shape transition at t 15 and 40 ms via lateral distance cases 0 to 5 during synchronous water entry since the energy transferred to water from the twin spheres is almost the same level in cases 1 to 5 the low pressure region is expanded to a wider flow filed as the distance between twin spheres increases with the pressure gradually approaching the surrounding pressure as a result it can be seen that the inside expansion of cavity wall gradually weakens with the increase of lateral distance at t 15 ms the molar shaped cavity phenomenon is observed in short distance cases of 1 5d and 2 5d as shown in fig 10 a1 and b1 while the twin cavities evolve individually with expansion towards each other in the cases of 3 5d and 5 5d as shown in fig 10 c1 and d1 as the lateral distance increased to 7 5d the lateral effects are so weak that shapes of the twin cavities are basically the same as that of single sphere water entry as shown in fig 10 e1 f1 at t 40 ms the outside and the inside outlines of twin cavities appear to be quite different owing to the extrusion between the cavities in short distance cases as shown in fig 10 a2 and b2 it is found that the outline of the cavity can be shaped by a curved line and straight line forming a pair of crescent shaped cavity due to the interaction between twin cavities the collapse wake is different from that of single cavity as well at the lateral distance of a 2 5d as shown in fig 10 a2 and b2 the molar shaped cavity collapses inwards due to the existence of low pressure region and forms an intertwining cloud wake however the wake of twin cavities is converged but not intertwined anymore as the lateral distance increased to 3 5d as shown in fig 10 c2 as it can be seen in fig 10 c2 f2 the interaction of wakes gradually weakened with the increase of lateral distance and finally tends to normal and similar to that in single water entry as we know an interaction between objects and the free surface can be observed since the water entry happened this interaction was firstly captured by worthington and cole 1897 marston et al 2016 obtained the crown shaped jet in detail as well and analyzed its instability based on these studies we present the observation of the water jetting produced by the cavities collapse in twin water entry as has been discussed by guo et al 2019 the free surface tends to sink when the cavity is contracting due to this contraction process the fluid obtains potential energy and rebounds from the collapse area forming an upward water jetting fig 11 a c shows the water jetting produced by the molar shaped cavity at a 1 5d 2 5d and 3 5d which is wider than a general water jetting shown in fig 11 f it is found that an m shaped splash appears on top center of the jetting and moves to both sides of the spheres as shown in fig 11 a c as the lateral distance increased to 5 5d the pair of water jetting produced by twin cavities is almost independent of each other showing a similarity as that of single water entry shown in fig 11 f it is found that the phenomenon of large lateral distance is similar as that observed by chen et al 2013 who investigated the morphological changes of a water jet induced by droplet breakdown fig 12 a shows the variation of average contact line angle of the twin spheres at t 3 ms via the normalized lateral distance a d the angle decreases significantly as the lateral distance increases from 1 5d to 2 5d and then to 3 5d while its reduction is relatively slow as the lateral distance increases from 3 5 to 5 5d and finally to infinity at which β 0 for the sphere during single water entry this finding quantifies that the influence of interaction between the twin spheres weakens with an attenuation rate as the increase of the lateral distance to further verify this influence the average trajectories of twin spheres with different lateral distance are sketched in fig 12 b an obvious tendency can be observed that the average horizontal deviation of the twin spheres gradually decreases as the lateral distance increases from 1 5d to 7 5d step by step going closer to the trajectory of single sphere water entry gradually 3 3 2 successive water entry side by side the cavity shape is susceptible to the variation of flow fluctuation caused by the water entry this effect tends to be weakened with the increase of time interval or lateral distance individually according to the study in previous sections in this section the combined effect of the two factors on cavity evolution and movements of the twin spheres is discussed as for successive water entry side by side the effect of lateral distance on cavity dynamics is taken into account firstly with obvious cavity interactions as shown in fig 13 the experimental cases of time interval around δt 8 4 ms 8 6 ms 8 3 ms and 8 4 ms correspond to cases 8 14 and 18 respectively at different lateral distance are selected to demonstrate the problem in addition the variation of cavity diameter d c defined as the diameter of cavity ii at the depth of h d as shown in fig 13 is presented in fig 15 to quantify the interaction effect on cavity the cavity shapes corresponding to typical points on the diameter curves are depicted as well to provide a detailed view of the cavity variation as marked with ① ⑯ in fig 15 the interaction between cavity ii and cavity i results in a converged water jet in case 1 a 1 5d δt 0 ms as shown in fig 13 a a lateral expansion of cavity ii occurs but confined by cavity i subsequently for the case 8 δt 8 6 ms at short distance a 1 5d between the twin spheres as shown in fig 13 b it leads to a long time stability point ① to point ⑤ for cavity ii after the initial formation as depicted in fig 15 a since the interaction is very weak in case 18 a 3 5d δt 8 4 ms the diameter of cavity ii is close to that of single water entry as shown in fig 15 a in line with the small difference between the cavities in fig 13 d and e with a moderate lateral distance of a 2 5d in case 14 the expansion of cavity ii is obviously achieved during successive twin water entry at δt 8 3 ms with higher peaks of cavity diameter than that of single water entry as shown in fig 15 a in the cases of δt 8 4 ms as shown in fig 13 b and c as the distance gets broader from 1 5d case 8 to 2 5d case 14 the interaction leads to significant expansion for cavity ii and contraction for cavity i as demonstrated in fig 14 to further characterize the remarkable cavity expansion at the lateral distance of a 2 5d experimental cases with different time intervals are taken into account and the diameter variations of cavity ii via water entry time are detailed in fig 15 b at lower time interval such as δt 0 and 2 4 ms the existence of cavity i and its wake suppresses the lateral expansion of cavity ii making the cavity contract inside obviously it is found that cavity ii gets an obvious expansion at δt 6 5 ms and 8 4 ms and the diameter is noticeably larger as the time interval increased to 11 ms the maximum diameter is reduced and gets close to that of single sphere case for the results presented in fig 15 it is noteworthy that the case in which the cavity diameter can be measured in a longer time during water entry i e 14 4 ms at ⑦ in case 18 and 19 5 ms at ⑥ in case 14 implies that cavity ii is stretched with greater length that is cavity ii is able to persist for a longer time during water entry to analyze the combined effect of time interval and lateral distance on the movement of sphere ii during successive water entry the trajectories of sphere ii for three time intervals δt 4 5 ms 8 4 ms and 13 2 ms and three lateral distances a 1 5d 2 5d and 3 5d are selected for discussion synchronous water entry and single water entry are presented as well for comparison as shown in fig 16 a water entry sphere i e sphere i usually generates a lateral expulsion of water around and a low pressure region in the wake behind at the same time the lateral expulsion of water by sphere i results in repulsion with a repulsive force f expulsion while its movement and cavity collapse leads to a low pressure region with an attractive force f pressure for sphere ii for synchronous water entry the instantaneous repulsive force occurs during the twin spheres upon water entry before the generation of any low pressure region as a result both of the twin spheres are accelerated reversely in horizontal direction leading to the repulsive trajectory phenomena in fig 16 a as sketched in fig 17 a the roles that the repulsive force f expulsion and the attractive force f expulsion play determine the deviation magnitude and direction of sphere ii during water entry as demonstrated in fig 17 b it is believed that both horizontal distance decided by the lateral distance a and vertical distance decided by the time interval δt between the twin spheres during water entry will affect the two forces with the increase of time interval the repulsive force acted on sphere ii by sphere i s water entry declines rapidly and the horizontal movement of sphere ii is mainly influenced by the attractive force corresponding to the trajectory performance in fig 16 b d it is not difficult to understand that the variation sensitivity of sphere ii s trajectory with repulsion or attraction is positively related the lateral distance of the twin spheres with the most variation at a 1 5d and the least variation at a 3 5d as the time interval changes as for successive twin water entry shown in fig 16 b d it is interesting that sphere ii is attracted horizontally to sphere i at the lateral distance of a 1 5d with a declined deviation while the interaction acted on sphere ii at a 2 5d and 3 5d varies from repulsion to attraction gradually as the increase of time interval from 4 5 ms to 8 4 ms and then to 13 2 ms to reveal this phenomenon another case with a smaller time interval of δt 2 5 ms is taken into account for the lateral distance of a 1 5d it is observed that sphere ii is gradually involved in the wake of sphere i at moderate time intervals i e δt 4 4 ms 8 6 and 13 4 ms however a much weak attractive force is coincidentally equal to the repulsive force when sphere ii is very close to sphere i other than the low pressure wake at small time interval i e δt 2 5 ms as demonstrated in fig 18 as a result the trajectory of sphere ii at δt 2 5 ms is quite different from that at the moderate time intervals and coincident with that of single water entry as shown in fig 9 previously 4 conclusions in this paper the water entry of twin spheres side by side with different lateral distances and time intervals is experimentally investigated with the cavity evolutions and movement characteristics of the spheres being recorded by a high speed camera system firstly the cavity dynamics and sphere trajectories of synchronous water entry are investigated at a 1 5d it is found that two asymmetrical cavity is induced during water entry forming a molar shaped cavity meanwhile the contact lines are obliquely pinned on the twin spheres owing to the differential pressure of flow field and the contact line angle increases as the spheres move downwards as for successive water entry at a 1 5d it is found that the horizontal deviation of sphere ii decreases with the increase of time interval indicating that the effect of cavity i on sphere ii is declined gradually in addition experiments on twin water entry with the distance varying from 1 5d to 7 5d are conducted to study the effect of lateral distance on synchronous water entry some interesting phenomena occur due to the interaction between the twin spheres i e crescent shaped cavity converged wake m shaped splash and trajectory deviation of the spheres it is revealed that the interaction gradually weakens as the lateral distance increases with very small differences between the cases at 7 5d and the single water entry finally the combined effect of lateral distance and time interval on cavity evolution and movements of the twin spheres is evaluated a laterally confined expansion of cavity ii occurs in case 8 a 1 5d δt 8 6 ms and results in a better stability for the cavity than that in other cases in which the diameter of cavity ii varies in quasi parabolic via water entry time the evaluation of cavity evolution and trajectory of sphere ii indicates that the interaction on sphere ii is obviously affected by lateral distance and time interval and the trajectory deviation of sphere ii depends on the repulsion or attraction induced by sphere i credit authorship contribution statement xu wang investigation writing original draft xujian lyu conceptualization supervision data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was financially supported by the national natural science foundation of china grant number 51609115 fundamental research funds for the central universities grant numbers 30918012201 and fund of state key laboratory grant number 6142604190302 
21092,the cavity dynamics and trajectories of twin spheres vertically entering water side by side are investigated experimentally for different time intervals and several lateral distances at initial velocities from 14 1 m s to 15 2 m s with the diameter d based froude number varying from 37 1 to 40 0 a high speed photograph system and an image processing method are employed to obtain the features of cavity flow and the position of twin spheres we firstly investigate the cavity shapes and sphere trajectories with lateral distance being 1 5d between the spheres results show that the contact lines of two cavities are obliquely pinned on the twin spheres in synchronous water entry and a molar shaped cavity is formed by the overlap of the two cavities subsequently the motion characteristics of the second water entry sphere sphere ii are studied as the increase of time interval between the twin spheres it is found that the influence on sphere ii increases as the decrease of the time interval at lateral distance of a 1 5d except a certain condition i e δt 2 5 ms as we change the lateral distance in synchronous water entry the disturbance introduced by adjacent sphere is weakened with the increase of the distance the results demonstrate that both the cavity dynamics and trajectories of sphere ii are similar to that of single water entry when the lateral distance increases to 5 5d as for the combined effects of lateral distance and time interval on twin water entry it is found that sphere ii is attracted horizontally to sphere i at moderate time intervals with the lateral distance of a 1 5d while the interaction acted on sphere ii in cases of a 2 5d and 3 5d changes from repulsion to attraction gradually as the increase of time interval from 3 5 ms to 8 4 ms and then to 13 1 ms keywords twin water entry side by side cavity dynamics trajectory repulsion attraction 1 introduction when an object passes through a free surface and enters into water a complex multiphase flow process is occurred which is called water entry water entry problem has been investigated for over a century owing to its broad engineering application background such as naval weapons may 1951 rabiee et al 2011 ship launching chen 2007 aerospace industry qu et al 2015 ballistic water entry truscott et al 2009 and so on in the early studies the formation and evolution of cavities jet and splash were usually discussed aristoff et al 2010 duclaux et al 2007 duez et al 2007 gilbarg and anderson 1948 shi and takami 2001 worthington and cole 1897 with the development of high speed camera technology various experimental methods were proposed to investigate the water entry of objects with different shapes such as wedge cylinder bullet disk and even droplet chen et al 2019a ern and brosse 2014 speirs et al 2018 truscott et al 2009 vincent et al 2018 wei and hu 2014 with many different and interesting phenomena coming to light when objects impact water instantaneous changes occurs in the flow structure owing to the interaction among solid liquid and gas phases ding et al 2015 in order to explain the mechanism of this multiphase flow process many studies have been carried out to detail the fluid object interaction including cavity evolution impact force splash dynamics body trajectory etc as one of the most typical phenomena in this multiphase flow process cavitation is easily affected by the posture of moving objects for example the spinning motion can induce a lift force on spheres in free falling water entry which results in a deviation of trajectory and formes a cardioid shaped cavity observed in bird s eye view truscott and techet 2009a 2009b wei and hu 2015 revealed the cavity evolution of cylinders with inclined angles during water entry and discussed the trajectories and angular displacement of cylinders based on their studies horizontal velocities were taken into account for cylinders during water entry by xia et al 2019 with the horizontal effect on cavity dynamics and motion characteristics being evaluated as objects impact water an instantaneous force is usually generated truscott et al 2012 presented a study on this kind of force during free falling water entry and the effects on trajectories and force coefficient were revealed and it was found that a lighter sphere undergoes a larger deceleration and trajectory deviation most investigations in this field focus on single object hydrodynamics however the motion of multiple objects has a very wide engineering application as well and the flow structure of multiple objects is usually different from that of single one alam and zhou 2007 kim et al 1993 yoon and yang 2007 wake flow behind multi objects is of great significance to ocean engineering affecting the design of marine structures bai et al 2020 a complex flow structure often occurs between two objects leading to an interweaving wake mondal et al 2019 schouveiler et al 2004 in order to understand such flow details intuitively particle image velocimetry was applied to measure the flow field around three circular cylinders side by side at various gap ratios and reynolds numbers in a water tunnel by sooraj et al 2019 for the problem of multiple objects in high speed incoming flow with cavitation jin et al 2010 numerically investigated the cavity shape and drag characteristics of tandem cylinders using fluent 6 3 which was known as an early study about cavitating flow of multiple objects however only a small number of published studies have focused on multi object water entry up to now which is important for a wide range of scientific and industrial processes wang and wang 2010 numerically studied the influence of various parameters of cylinders on the hydrodynamic forces acting on two cylinders water entry side by side moreover the water entry cavity evolution and motion characteristics of two bodies in tandem are investigated by yu 2019 using numerical and experimental methods with the speed of water entry less than 3 43 m s more recently the tandem water entry of two spheres was investigated by yun et al 2020a 2020b they found that the second sphere was accelerated when it submerged in the cavity created by the first sphere during oblique water entry while it leaded to a significantly large cavity and an interesting multi section cavity during the vertical water entry lu et al 2019a studied the cavities evolution and motion characteristics during side by side water entry of two cylinders at a very low speed range of 1 5 3 1 m s and found that the cavities were obviously asymmetry in addition the effect of froude number during water entry on cavities evolution was analyzed by lu et al 2019b with comparison of the cavity shapes between single and twin water entry with cylinders recently wang and lyu 2020 experimentally investigated the water entry of twin spheres synchronously with different lateral distances side by side and the cavity evolution and wakes characteristics were revealed previous studies have extensively investigated the water entry of one object however only a little attentions have been paid to the disturbance by adjacent object during water entry of multiple objects side by side which obviously affects the two phase flow pattern and the movements of objects to further explain the complicated interaction among bodies cavities and water flow during this process the cavity dynamics and trajectories of twin spheres entering water side by side are investigated in this paper with the water entry speed from 14 1 m s to 15 2 m s and surface seal occurring to achieve a systematic understanding both time interval and lateral distance between the twin spheres are taken into account we firstly analyze the cavity dynamics of synchronous water entry and then evaluate the influence of the first cavity on the second water entry by changing time interval and lateral distance respectively 2 experimental methods 2 1 experimental setup the water entry experiments are carried out in a closed laboratory in order to avoid the air flow disturbance twin steel spheres are released by two paralleled reluctance coil electromagnetic launchers which are composed of energy storage capacitors induction coils photoelectric gates and rails the spheres are made of high carbon chromium bearing steel with measuring diameter d 14 7 mm and density ρ s 7778 6 kg m3 the static contact angle of water on the sphere surface is α 80 10 similar to that of the sphere used by yun et al 2020a the twin spheres are vertically launched into the water filled rectangular tank which has a dimension of 1000 700 1000 mm3 with the water depth being set to 750 mm to avoid the initial disturbance of the acquiescent air water surface the wait time between two releases is more than 10 min in order to capture the cavity dynamics and trajectories during the water entry process a high speed photograph system with two cameras is applied as shown in fig 1 a phantom veo410 camera with a 105 mm fixed focus lens is used for front view acquisition while the other one of phantom lc111 with a 24 85 mm zoom nikon lens is applied to check whether the motion of twin spheres deviates in the side view in order to clearly analyze the changes of cavity shaped and trajectories the frame rate of the cameras is set to 10000 fps and the exposure time is in a range of 7 17 μs at such high frame rate for image acquisition the resolutions of the two cameras are limited to 1280 400 and 1280 200 pixels respectively in addition five led lights and two backlights are located around the tank to provide bright and uniform view for the image acquisition note that special attentions should be paid to the arrangement of these lights to get very crisp images during the experiment 2 2 image processing method the origin of the coordinate is set on the quiescent free surface where the sphere entering into is set as y 0 mm and the moving direction of sphere is set as negative along y axis as sketched in fig 1 the x coordinate represents the horizontal deviation of the sphere during a drop in order to get the position of twin spheres from image sequences a digital image correlation dic method based on the studies by epps et al 2010 and wei and hu 2014 2015 is employed to get the position of sphere from each frame image in this paper we make a template with a size of 1 5d for the sphere above the free surface using the cross correlation method to extract the positions in each image the optimal solution is acquired by the translation information which is cooperated with a gaussian fitting curve with both accuracy and smoothness being considered the curves of velocity and acceleration are obtained by the first and second derivation of displacement respectively to reduce the error of fitting curve the spline curve with an acceptable tolerance and a proper roughness should be find the kinks at critical error tolerance of twin spheres in a typical case i e case 2 as described in table 1 are selected and marked by red square in fig 2 the critical error tolerance of sphere i is 3 89 10 9 and that of sphere ii is 4 02 10 9 an estimate of experimental measurement error epps et al 2010 wei and hu 2014 2015 can be written as ε e c r n δ t where n 1000 is the image number obtained for sphere position data analysis δt is acquisition time interval of high speed camera the experimental measurement errors of the twin spheres are ε 1 0 197 mm and ε 2 0 200 mm respectively so that we have 0 2 mm 0 471 pixel therefore it is believed that we get an image processing resolution of half pixel in present study 3 results and discussion the experimental cases of twin water entry are listed in table 1 the corresponding froude numbers f r u 0 g d varies in a range of 37 1 40 0 based on water entry velocity u 0 and sphere diameter d in cases 1 to 5 we consider the effects of lateral distance between twin spheres on cavity dynamic in synchronous water entry in cases 6 to 19 we investigate the trajectory and cavity evolution of sphere ii in various time intervals and lateral distance cases 8 14 and 18 are applied to demonstrate the differences of cavity diameter at different lateral distance with the time interval about 8 4 ms case 0 represents water entry with a single sphere and is used as a control group for comparison with other cases the sphere entering into water earlier is marked as sphere i and the other one is marked as sphere ii the time point when sphere i reaches the quiescent water surface is set as t 1 0 and that for sphere ii is set as t 0 the symbols u 10 and u 20 represent the initial velocities of sphere i and sphere ii respectively during water entry note that the time points of the sphere reach the quiescent water surface in single water entry and synchronous twin water entry are both set as t 0 as well 3 1 cavities evolution of synchronous water entry fig 3 shows a sequence of images depicting twin spheres entering water synchronously in this case the twin spheres step into the open cavity stage concurrently the cavities generated by the spheres expand towards each other and the expansion is limited by the short lateral distance 1 5d forming a pair of asymmetric cavities which are symmetrical about the centerline fig 3 b with the downward movements of the spheres both diameter and length of the twin cavities increase before surface seal and the cavities remain symmetric with each other one interesting observation is that the cavity walls overlap to connect twin cavities and forms a molar shaped cavity as marked in fig 3 c and d in addition a converged upward jetting appears with a notable velocity which is caused by the splashes and enhanced by surface seals of the twin cavities as shown in fig 3 c and d at t 20 ms fig 3 e a large number of micro bubbles cover the middle of the molar shaped cavity worsening the instability of cavity evolution and leading to a subsequent collapse the collapse develops into a cloud wake behind the cavity as the spheres move downwards as shown in fig 3 f h owing to a large velocity difference between the spheres and water when impacting events happened the contact line between cavity and sphere moves up along the sphere surface with a high initial speed as has been reported by ding et al 2015 an adverse pressure gradient exists near the equator of spheres which will slow down the movement of contact line and make it pin to the sphere surface finally as shown in fig 4 the contact lines induced by the twin spheres show good symmetry with different angles of inclination at different time points during water entry the surrounding water is rapidly accelerated as the spheres passing concurrently the kinetic of spheres is converted to water and the fluid in the inner side of twin spheres received more energy so that a high inside splash occurs as shown in figs 4 a and fig 3 b whereby a low pressure zone is created between the spheres due to bernoulli s principle and weakens the blocking effect of the adverse pressure gradient near sphere equator thus the inner side of contact line stops slightly above the equator of sphere while the other side pinned at a normal position causing an oblique contact line fig 4 b shows the curve of contact line angle β varying with time the angle β is defined as the angle between the contact line and horizontal plane it appears that the contact line angle rapidly rises within 1 1 ms owing to the strongly disturbance upon water entry and rises more and more slowly as the water entry develops 3 2 effect of time interval between the twin spheres on water entry mostly side by side objects are more likely to enter into water with a certain time interval other than strict synchronization this may leads to a different cavity dynamics and trajectory variation in this section the time interval effect of the cases with a 1 5d is discussed fig 5 displays the main features of twin water entry at δt 4 4 ms in case 7 sphere ii hits the cavity created by sphere i called cavity i leading to an initial cavity deformation as shown in fig 5 a before sphere ii arriving at the free surface a low pressure region has been produced by cavity i therefore once sphere ii enters into water and generates another cavity called cavity ii the new cavity is affected by the low pressure region it is found that the inner side cavity wall expands horizontally and even breaks through the walls of cavity i fig 5 b and c and a multistrand cavity is formed as shown in fig 5 d with three sub cavities marked as c1 c2 and c3 respectively in fig 5 d and e as the multistrand cavity pulled away from free surface the main body of sub cavity c2 between c1 and c3 collapses to a smaller one trailing after sphere i the developed cavity c2 together with the separated cavities c1 and c3 forms a y shaped cavity during this process sphere ii enters into cavity i and moves for a short time and then hits sphere i at t 1 32 4 ms as detailed in fig 6 a ring joint caused by collision of the twin spheres appears in fig 6 d similar to that observed by hurd et al 2015 and yun et al 2020a it can be seen from fig 6 d f that the ring joint is almost at the same height as marked by a blue dot line and slightly moves up as the spheres move down the velocity and acceleration of twin spheres in this process are show in fig 7 it is found that both of the twin spheres suffers violent deceleration as they impact water and the acceleration of sphere ii decreases quickly upon the sphere entering into cavity i as shown in fig 7 b subsequently sphere ii moves in the cavity with gentle changes of velocity due to much lower drag from gas instead of water an energy transfer occurred during the collision between the two spheres as shown in fig 7 b a horizontal jet occurs when sphere ii hits the wall of cavity i again as demonstrated in fig 6 e and f the cavity wall becomes rough owing to the impacting of lateral splash similar as that reported by yun et al 2020a and the splash grows up as sphere ii penetrates the cavity wall finally as shown in fig 6 e and fig 5 h cavity i is cut off by the horizontal jet and part of the cavity still moves with sphere i meanwhile sphere ii induces a new cavity when it escapes from cavity i completely differing from that cavity i is not sealed yet when sphere ii reaches the air water free surface in case 7 δt 4 4 ms cavity i in case 9 δt 13 4 ms has sealed at the free surface and been pulled away when sphere ii arrived as shown in fig 8 a according to bernoulli principle the local water field behind cavity i achieves a lower pressure distribution than that of the surroundings due to the downward movements of both sphere i and the cavitation wake it is clear that the expansion of cavity ii would yield to the low pressure region as shown in fig 8 b once cavity ii reaches the bubbly wake of cavity i the expansion interacts with the wake and arouses a sharp tuber on the wall of cavity ii as depicted in fig 8 c with sphere i moving down cavity i begins to collapse and leaves a foamy wake which penetrates into cavity ii generating a water curtain on the cavity wall as shown in fig 8 d this phenomenon is similar to the water wedge observed by xia et al 2019 who investigated the water entry of a cylinder with a horizontal velocity moreover a wave shaped wall deformation of cavity ii caused by the foam wake appears as well as shown in fig 8 e and f some expanding water curtains along cavity ii converge into a lateral splash and cause a contraction of the cavity as the sphere moves downwards cavity ii finally pinches off at the splash point and generates an inclined foam wake as depicted in fig 8 g and h in addition it is found that the vertical position of the splash almost remains constant during the cavity evolution it is observed that although the wake of cavity i deformed a little asymmetrically due to the effect by sphere ii the part of cavity i ahead sphere ii is almost unaffected as shown in fig 8 b f it also can be seen clearly that the trajectory of sphere ii generates an obvious horizontal deviation owing to the differential pressure created by the water entry of sphere i whereas the trajectory of sphere i doesn t changed distinctly as shown in fig 8 to quantify this horizontal deviation of sphere ii during water entry the trajectories for sphere ii cases 6 10 with δt 2 5 ms 4 4 ms 8 6 ms 13 4 ms and 40 7 ms respectively during water entry are presented in fig 9 to study the influence of time intervals as shown in the figure although we have tried our best to fabricate the experimental setup and the spheres with a high degree of accuracy the single sphere with few initial disturbances above water still gets some random horizontal deviation that falls in the shaded area marked in fig 9 during water entry this might be caused by the wake fluctuation behind the sphere similar to that reported by xia et al 2019 in case 7 with δt 4 4 ms sphere ii penetrate the wall of cavity i and enter into the water field again resulting in a significant horizontal deviation however cavity i has already broken into a lot of dissipated micro bubbles which have little effect on the sphere ii when it enters into water in the case with δt 40 7 ms as a result the trajectory deviation of sphere ii is basically in the same level with that of the single water entry as demonstrated clearly in fig 9 it is found that the horizontal deviation of sphere ii is increased with the decrease of time intervals from 40 7 ms to 4 4 ms indicating that the effect of cavity i on sphere ii increases however the deviation which is supposed to be much more significant shows a totally different trend as the time interval decreases to the δt 2 5 ms in case 6 this distinct phenomenon will be discussed later in section 3 3 2 with more details 3 3 effect of lateral distance between the twin spheres on water entry in this section the effect of the lateral distance between twin spheres on the water entry process is investigated with distances of 1 5d 2 5d 3 5d 5 5d and 7 5d being taken into account the cases of synchronous water entry are discussed in section 3 3 1 and those of successive water entry are evaluated in section 3 3 2 with effects of different time intervals being discussed 3 3 1 synchronous water entry side by side fig 10 displays the cavity shape transition at t 15 and 40 ms via lateral distance cases 0 to 5 during synchronous water entry since the energy transferred to water from the twin spheres is almost the same level in cases 1 to 5 the low pressure region is expanded to a wider flow filed as the distance between twin spheres increases with the pressure gradually approaching the surrounding pressure as a result it can be seen that the inside expansion of cavity wall gradually weakens with the increase of lateral distance at t 15 ms the molar shaped cavity phenomenon is observed in short distance cases of 1 5d and 2 5d as shown in fig 10 a1 and b1 while the twin cavities evolve individually with expansion towards each other in the cases of 3 5d and 5 5d as shown in fig 10 c1 and d1 as the lateral distance increased to 7 5d the lateral effects are so weak that shapes of the twin cavities are basically the same as that of single sphere water entry as shown in fig 10 e1 f1 at t 40 ms the outside and the inside outlines of twin cavities appear to be quite different owing to the extrusion between the cavities in short distance cases as shown in fig 10 a2 and b2 it is found that the outline of the cavity can be shaped by a curved line and straight line forming a pair of crescent shaped cavity due to the interaction between twin cavities the collapse wake is different from that of single cavity as well at the lateral distance of a 2 5d as shown in fig 10 a2 and b2 the molar shaped cavity collapses inwards due to the existence of low pressure region and forms an intertwining cloud wake however the wake of twin cavities is converged but not intertwined anymore as the lateral distance increased to 3 5d as shown in fig 10 c2 as it can be seen in fig 10 c2 f2 the interaction of wakes gradually weakened with the increase of lateral distance and finally tends to normal and similar to that in single water entry as we know an interaction between objects and the free surface can be observed since the water entry happened this interaction was firstly captured by worthington and cole 1897 marston et al 2016 obtained the crown shaped jet in detail as well and analyzed its instability based on these studies we present the observation of the water jetting produced by the cavities collapse in twin water entry as has been discussed by guo et al 2019 the free surface tends to sink when the cavity is contracting due to this contraction process the fluid obtains potential energy and rebounds from the collapse area forming an upward water jetting fig 11 a c shows the water jetting produced by the molar shaped cavity at a 1 5d 2 5d and 3 5d which is wider than a general water jetting shown in fig 11 f it is found that an m shaped splash appears on top center of the jetting and moves to both sides of the spheres as shown in fig 11 a c as the lateral distance increased to 5 5d the pair of water jetting produced by twin cavities is almost independent of each other showing a similarity as that of single water entry shown in fig 11 f it is found that the phenomenon of large lateral distance is similar as that observed by chen et al 2013 who investigated the morphological changes of a water jet induced by droplet breakdown fig 12 a shows the variation of average contact line angle of the twin spheres at t 3 ms via the normalized lateral distance a d the angle decreases significantly as the lateral distance increases from 1 5d to 2 5d and then to 3 5d while its reduction is relatively slow as the lateral distance increases from 3 5 to 5 5d and finally to infinity at which β 0 for the sphere during single water entry this finding quantifies that the influence of interaction between the twin spheres weakens with an attenuation rate as the increase of the lateral distance to further verify this influence the average trajectories of twin spheres with different lateral distance are sketched in fig 12 b an obvious tendency can be observed that the average horizontal deviation of the twin spheres gradually decreases as the lateral distance increases from 1 5d to 7 5d step by step going closer to the trajectory of single sphere water entry gradually 3 3 2 successive water entry side by side the cavity shape is susceptible to the variation of flow fluctuation caused by the water entry this effect tends to be weakened with the increase of time interval or lateral distance individually according to the study in previous sections in this section the combined effect of the two factors on cavity evolution and movements of the twin spheres is discussed as for successive water entry side by side the effect of lateral distance on cavity dynamics is taken into account firstly with obvious cavity interactions as shown in fig 13 the experimental cases of time interval around δt 8 4 ms 8 6 ms 8 3 ms and 8 4 ms correspond to cases 8 14 and 18 respectively at different lateral distance are selected to demonstrate the problem in addition the variation of cavity diameter d c defined as the diameter of cavity ii at the depth of h d as shown in fig 13 is presented in fig 15 to quantify the interaction effect on cavity the cavity shapes corresponding to typical points on the diameter curves are depicted as well to provide a detailed view of the cavity variation as marked with ① ⑯ in fig 15 the interaction between cavity ii and cavity i results in a converged water jet in case 1 a 1 5d δt 0 ms as shown in fig 13 a a lateral expansion of cavity ii occurs but confined by cavity i subsequently for the case 8 δt 8 6 ms at short distance a 1 5d between the twin spheres as shown in fig 13 b it leads to a long time stability point ① to point ⑤ for cavity ii after the initial formation as depicted in fig 15 a since the interaction is very weak in case 18 a 3 5d δt 8 4 ms the diameter of cavity ii is close to that of single water entry as shown in fig 15 a in line with the small difference between the cavities in fig 13 d and e with a moderate lateral distance of a 2 5d in case 14 the expansion of cavity ii is obviously achieved during successive twin water entry at δt 8 3 ms with higher peaks of cavity diameter than that of single water entry as shown in fig 15 a in the cases of δt 8 4 ms as shown in fig 13 b and c as the distance gets broader from 1 5d case 8 to 2 5d case 14 the interaction leads to significant expansion for cavity ii and contraction for cavity i as demonstrated in fig 14 to further characterize the remarkable cavity expansion at the lateral distance of a 2 5d experimental cases with different time intervals are taken into account and the diameter variations of cavity ii via water entry time are detailed in fig 15 b at lower time interval such as δt 0 and 2 4 ms the existence of cavity i and its wake suppresses the lateral expansion of cavity ii making the cavity contract inside obviously it is found that cavity ii gets an obvious expansion at δt 6 5 ms and 8 4 ms and the diameter is noticeably larger as the time interval increased to 11 ms the maximum diameter is reduced and gets close to that of single sphere case for the results presented in fig 15 it is noteworthy that the case in which the cavity diameter can be measured in a longer time during water entry i e 14 4 ms at ⑦ in case 18 and 19 5 ms at ⑥ in case 14 implies that cavity ii is stretched with greater length that is cavity ii is able to persist for a longer time during water entry to analyze the combined effect of time interval and lateral distance on the movement of sphere ii during successive water entry the trajectories of sphere ii for three time intervals δt 4 5 ms 8 4 ms and 13 2 ms and three lateral distances a 1 5d 2 5d and 3 5d are selected for discussion synchronous water entry and single water entry are presented as well for comparison as shown in fig 16 a water entry sphere i e sphere i usually generates a lateral expulsion of water around and a low pressure region in the wake behind at the same time the lateral expulsion of water by sphere i results in repulsion with a repulsive force f expulsion while its movement and cavity collapse leads to a low pressure region with an attractive force f pressure for sphere ii for synchronous water entry the instantaneous repulsive force occurs during the twin spheres upon water entry before the generation of any low pressure region as a result both of the twin spheres are accelerated reversely in horizontal direction leading to the repulsive trajectory phenomena in fig 16 a as sketched in fig 17 a the roles that the repulsive force f expulsion and the attractive force f expulsion play determine the deviation magnitude and direction of sphere ii during water entry as demonstrated in fig 17 b it is believed that both horizontal distance decided by the lateral distance a and vertical distance decided by the time interval δt between the twin spheres during water entry will affect the two forces with the increase of time interval the repulsive force acted on sphere ii by sphere i s water entry declines rapidly and the horizontal movement of sphere ii is mainly influenced by the attractive force corresponding to the trajectory performance in fig 16 b d it is not difficult to understand that the variation sensitivity of sphere ii s trajectory with repulsion or attraction is positively related the lateral distance of the twin spheres with the most variation at a 1 5d and the least variation at a 3 5d as the time interval changes as for successive twin water entry shown in fig 16 b d it is interesting that sphere ii is attracted horizontally to sphere i at the lateral distance of a 1 5d with a declined deviation while the interaction acted on sphere ii at a 2 5d and 3 5d varies from repulsion to attraction gradually as the increase of time interval from 4 5 ms to 8 4 ms and then to 13 2 ms to reveal this phenomenon another case with a smaller time interval of δt 2 5 ms is taken into account for the lateral distance of a 1 5d it is observed that sphere ii is gradually involved in the wake of sphere i at moderate time intervals i e δt 4 4 ms 8 6 and 13 4 ms however a much weak attractive force is coincidentally equal to the repulsive force when sphere ii is very close to sphere i other than the low pressure wake at small time interval i e δt 2 5 ms as demonstrated in fig 18 as a result the trajectory of sphere ii at δt 2 5 ms is quite different from that at the moderate time intervals and coincident with that of single water entry as shown in fig 9 previously 4 conclusions in this paper the water entry of twin spheres side by side with different lateral distances and time intervals is experimentally investigated with the cavity evolutions and movement characteristics of the spheres being recorded by a high speed camera system firstly the cavity dynamics and sphere trajectories of synchronous water entry are investigated at a 1 5d it is found that two asymmetrical cavity is induced during water entry forming a molar shaped cavity meanwhile the contact lines are obliquely pinned on the twin spheres owing to the differential pressure of flow field and the contact line angle increases as the spheres move downwards as for successive water entry at a 1 5d it is found that the horizontal deviation of sphere ii decreases with the increase of time interval indicating that the effect of cavity i on sphere ii is declined gradually in addition experiments on twin water entry with the distance varying from 1 5d to 7 5d are conducted to study the effect of lateral distance on synchronous water entry some interesting phenomena occur due to the interaction between the twin spheres i e crescent shaped cavity converged wake m shaped splash and trajectory deviation of the spheres it is revealed that the interaction gradually weakens as the lateral distance increases with very small differences between the cases at 7 5d and the single water entry finally the combined effect of lateral distance and time interval on cavity evolution and movements of the twin spheres is evaluated a laterally confined expansion of cavity ii occurs in case 8 a 1 5d δt 8 6 ms and results in a better stability for the cavity than that in other cases in which the diameter of cavity ii varies in quasi parabolic via water entry time the evaluation of cavity evolution and trajectory of sphere ii indicates that the interaction on sphere ii is obviously affected by lateral distance and time interval and the trajectory deviation of sphere ii depends on the repulsion or attraction induced by sphere i credit authorship contribution statement xu wang investigation writing original draft xujian lyu conceptualization supervision data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was financially supported by the national natural science foundation of china grant number 51609115 fundamental research funds for the central universities grant numbers 30918012201 and fund of state key laboratory grant number 6142604190302 
21093,this work aims to investigate the effects of duct parameter on the open water performance of pump jet propulsor five duct parameters are considered including the length diameter ratio the incidence angle the shrinkage ratio of duct inlet the expansion ratio of duct outlet and the tip clearance ratio based on the mesh verification a brief analysis of the pjp unsteady propulsion performance is first presented the duct parameters are thoroughly studied focusing on the open water performance thrust fluctuation the pressure field and its fluctuation the velocity field and vortices the results indicate that the length diameter ratio and the expansion ratio of duct outlet have significant effects on open water performance and controlling the vortices the tip clearance ratio and the shrinkage ratio of duct inlet show slight effects on performance but the tip clearance flow presents noticeable changes the incidence angle also has significant impacts on tip clearance vortices but results in more considerable performance changes than tip clearance ratio and shrinkage ratio of duct inlet keywords pump jet propulsor hydrodynamics duct parameter vortices 1 introduction the propulsion system is an essential part of underwater carriers for high speed underwater vehicles and submarine the pump jet propulsor pjp is considered as the most promising candidate propulsor and the major significant superiorities over other propulsors are the high efficiency and quietness under the same input power the pjp positively utilizes the retarded wake flow and produces high efficiency if the pjp is properly designed the ejected flow has a finite positive flow speed against the surroundings and even has a velocity near the vehicle speed thus the ejected flow leaves a finite jet wake after the vehicle passed and this is also much beneficial to the quietness for the pjp the duct forms the flow passage and then affects the ejected flow thereby affecting the propulsion performance the duct plays a significant role in pjp due to the particular application of pjp there are a few public published research on theory design but many numerical studies on the pjp performance are publicly published and available though the analysis approaches are further developed and improved especially when great progress has been made in the computer power and computational fluid dynamics cfd the design theory is still mainly based on the potential flow the duct processing in the design stage is helpful for investigating the effects of duct parameter eisenhuth and mccormick eisenhuth and mc cormick 1963 presented the design and performance of pjp under the cavitation and efficiency requirements in their design the duct is first determined and then the input of the rotor and stator design is given according to the duct design they thought that the chord line of the duct should be aligned along with the resultant velocity due to the body and rotor to avoid the negative pressure peaks existing at the duct nose in addition the stall over the duct outside also should be considered after the foregoing design henderson et al 1964 discussed the duct design of pjp the duct should be designed under consideration of the flow between duct and central body the stream surface of revolution is based on a certain mean velocity of flow between upstream and central body and the contour of duct must be slightly outside the stream surface at duct inlet and end slightly outside the stream surface at duct outlet to produce a slight vena contracta for discharging jet the duct length is obtained on the basis of mechanical considerations the incidence angle should be determined under the considerations of duct lift coefficient and flow separation bruce et al 1974 also discussed the duct design problem in mounting on the aft end of a body of revolution on the views of drag and energy focusing on the analysis of pjp it has been widely studied by numerical approach many experiments are mainly conducted for validation or research on the performance of pjp under different operating conditions there is almost none experiment investigation on geometric parameter due to the massive cost of manufacturing model and experiment the public experimental data has successfully validated the performance characteristics of pjp and the feasibility of numerical method applied in predicting the pjp performance ivanell 2001 dong et al 2012 shirazi et al 2019 suryanarayana et al 2010a suryanarayana et al 2010b suryanarayana et al 2010c the work of suryanarayana et al 2010a suryanarayana et al 2010b suryanarayana et al 2010c show that the pjp of a torpedo performs well in torque balance both in non cavitation and cavitation and even though the torpedo has a trim angle of 4 5 degree the cavitation incepts on the rotor tip surface and develops towards the suction side of the rotor as the rotating speed increases and the cavitation expands fully on the suction side of the rotor blade at a very low cavitation number for a torpedo equipped pjp model these characteristics including the torque balance and cavitation performance are also concluded in some numerical studies shi et al 2015 lu et al 2016a pan et al 2016 the effects of tip clearance on pjp performance has been studied in many published papers the tip clearance flow has a significant role in the pjp flow field primarily affecting the flow on the tip region and its downstream the tip clearance is the gap between the rotor tip surface and the duct near rotor tip so there are two ways of using duct to cut the blade or placing duct profile in the radial direction when to modify the tip clearance modifying the tip clearance by placing duct can be regarded as a parameter of duct as this way changes the duct radial position the effects of tip clearance on pjp open water and cavitation performances are almost numerically discussed increasing tip clearance size causes the pjp open water efficiency decreasing while it shows the improvement of efficiency at an extremely high advance coefficient and indicates a sharp decrease in efficiency at a very low advance coefficient under cavitation condition lu et al 2016b qin et al 2018 though the modification approach to tip clearance in the work li et al 2019 is different from the studies lu et al 2016b qin et al 2018 the open water efficiency follows the same change trend for a front stator pjp the tip clearance reduces the intensity of pressure fluctuation on rotor suction side near the tip region while it shows the contrary law on the pressure side yu et al 2019 besides the unsteady investigations show that applying the mesh motion approach to handle the rotor rotating causes considerable differences in pjp performance and flow field details comparing to that predicted by applying multi reference frame mrf li et al 2019 yu et al 2019 motallebi nejad et al 2017 except for the tip clearance there are a few investigations on the effects of other duct parameters wang et al 2019a parameterized the duct and investigated the effect of some duct parameters including the camber tip clearance and angle of attack on the hydrodynamic performance of a post stator pjp by an in house code wang et al 2019b their works indicate that the tip clearance has the same effect mentioned before on pjp efficiency increasing the duct camber or reducing the angle of attack improves the pjp overall efficiency and the increment of camber is also beneficial for cavitation performance moreover the angle of attack has more obvious effects on pjp performance the quietness is another important requirement for the pjp so new treatments with focus on the local details of duct shape are considered to study their effects on pjp noise performance qin et al 2019 and sun et al 2019 applied the sawtooth duct for pjp noise reduction results show that the sawtooth duct wastes a little efficiency of pjp and gains an improvement of overall noise level the duct parameter has also been investigated for other ducted propulsor those investigations are valuable and inspirational for the study on pjp duct some typical and systematic analyses of researches on duct of the ducted propulsor have been revisited huyer and dropkin 2011 conducted a duct optimization by simplifying the propulsor behind the hull into the axisymmetric two dimensional layout the vehicle drag arrives at the minimum value when the duct generates a zero mean flow acceleration the duct increases the total drag no matter the duct accelerates or decreases the flow but propulsive efficiency is improved from the accelerating effects while decelerating flow shows contrary effects in their work the duct shape was not parameterized and the authors mainly focused on the overall duct effects on the flow the theoretical analysis oosterveld 1970 indicates that increasing the duct length generates more drag when the duct is under generating drag condition while it has the opposite effect when the duct generates thrust regardless of generating drag or thrust the thickness has the coincident influence that the drag is increased or the thrust is decreased as the thickness increases and demonstrates the more obvious effects when the duct produces drag moreover the increased absolute value of duct drag or thrust exacerbates the risk of flow separation on the exterior surface of duct the experimental data of k4 55 propeller inside the 19 a accelerating duct with different duct lengths demonstrate that increasing the length improves both the thrusts of propeller and duct and results in higher value at optimum efficiency point the length camber and the maximum thickness of a decelerating duct equipped in a ducted propeller have been studied by applying the axial momentum theory and the nonlinear semi analytical actuator disk model bontempo et al 2016 the maximum thickness has more pronounced effects on duct drag than that of camber and length the length has the minimum effects on duct drag increasing the camber and length or decreasing the maximum thickness enhances the propeller cavitation resistance but the increase of camber causes the duct cavitation at the extremely high advance coefficient and the decrease of the maximum thickness fosters the leading edge cavitation on duct with the same approach they investigated the effects of the maximum thickness length camber and incidence angle of an accelerating duct an increase of thickness length camber or a decrease in incidence angle improves the propulsion efficiency bontempo and manna 2018 the approach of axisymmetric momentum theory and actuator disk model can quickly analyze the duct parameter effects but the viscous effects are not considered in the duct optimization gaggero et al 2017 including accelerating duct and decelerating duct the duct profile is described by the b spline and varied its shape by controlling several points this method of varying the duct does not show more organized results comparing to the duct parameters varying method bontempo et al 2016 bontempo and manna 2018 due to the more complex duct profile and the stator effects the flow around the pjp duct and its impacts on pjp overall performance are more complicated compared to the ducted propeller investigating the effects of duct parameter is valuable it is also reliable through the cfd approach to implementing the investigation as the cfd approach can overcome the simplifications of geometry and fluid property and becomes a common method in the numerical studies on flow problems in this paper the layout is organized as follows section 2 presents the research objects geometry configurations and the numerical approach used in this work in section 3 the mesh and the problem set up are described the discussion and analysis are exhibited in section 4 including the verification of mesh density the unsteady hydrodynamics performance the effects of duct parameters the flow field finally a summary of the key results can be found in section 5 2 research object 2 1 geometry configuration the pump jet propulsor in model scale and its coordinate are presented in fig 1 the rotor rotates around z axis and the flow direction follows the z axis direction this model has a pre swirl stator with eight blades and a rear rotor with six blades the rotor diameter is d r 2r r 0 1664 m and the maximum diameter of stator is d s 0 2038m the diameters of duct inlet and outlet are d t1 0 2104 m and d t2 0 1460 m respectively the tip clearance size between the duct inside and the tip face is 0 001 m the stator hub has the same conical degree as the submarine tail and extends out of the duct inlet a cut ellipsoid connects the far field hub and stator hub for a better transition for analyzing the effects of duct parameter on the pjp performance the pjp model with those above geometric parameters is set as the original model which was fabricated and then conducted an experiment in the science and technology on water jet propulsion laboratory of the marine design and research institute of china in fig 2 the main parameters of duct are given where the l d α d δ d r i r o r w l w are the length of duct the incidence angle of duct the tip clearance size the radius of duct inlet the radius of duct outlet the radius of rotor working stage the length of rotor working stage respectively as the rotor working stage should be held to ensure the rotor rotating the duct profile is no longer a simple airfoil it is not appropriate and will catch more additional problems by applying the airfoil controlling parameter to vary duct parameter so in this present work the duct profile is parameterized and modified in the following way the duct profile is divided by nine points from point p 1 to point p 9 into nine segments point p 1 and p 9 are the leading edge and trailing edge of duct profile respectively the arcs p 2 p 3 and p 7 p 8 are the fillets of leading edge and trailing edge of duct profile respectively the up and down profile curves are described by four shape functions f r i u z f ro u z f r i d z f r o d z and a line p 4 p 5 in the duct profile plane xoz the incidence angle of duct α d is the acute angle between the connected line p 1 p 9 and the z coordinate axis four duct main dimensionless parameters the shrinkage ratio of duct inlet r i expansion ratio of duct outlet r o tip clearance ratio δ d length diameter ratio l d are defined as follows 1 r i r i r w r w r r δ d δ d δ d r w r o r o r w l d l d r w and there exists a correlation among r i r o l d and α d 2 l d tan α d r i r o when an investigated parameter is changing it will cause another parameter to change this can not be avoided so we mainly focus on the directly changed parameter to study the effects of duct parameters the tip clearance size is controlled by fixing the rotor and then moving the duct profile in the radial direction the duct length is elongated on the basis of o in the z direction to get different duct length the incidence angle of duct is varied by rotating the duct profile around o in the xoz plane in order to ensure the rotor working stage the duct profiles are partially modified near the inlet and outlet of rotor working stage rotating the duct profile will change the positions of p 4 and p 5 so when the rotated p 4 is more closer to z axis in the x direction than the original position of p 4 the curve p 3 p 4 will cut by the extended line p 4 p 5 and when the rotated p 4 is farther a tangent of curve p 3 p 4 beginning from p 4 is added and cut curve p 3 p 4 at the tangency point for p 5 the modification follows the contrary way the changing step of α d is one degree the modified profiles under α d parameter are shown in fig 3 in detail the changes of r i and r o are controlled by the above four functions and a increment function r z k d z 2 in the x direction where k d is a controlled coefficient during this processing the duct thickness distribution is held constant when r i is varied the increment r z k d z z 4 2 z 3 z z 4 is added to curves p 3 p 4 and p 2 p 6 to control r i concurrently thus the increment of r i is r z k d z 3 z 4 2 similar to r i an increment r z k d z z 5 2 z 5 z z 7 is added to curves p 5 p 7 and p 6 p 8 to control the r o concurrently all modified results are demonstrated in fig 3 and table 1 in detail furthermore considering the duct will extend out of the cut ellipsoid stage in the z direction when the duct length parameter is investigated the hub before the stator hub is extended as shown in fig 2 the modifications of duct profile will change the length of stator blade in the radial direction so for the increase of stator blade length the stator section is extended along the leading edge and trailing edge and for the decrease the stator blade is directly cut by the duct 2 2 numerical approach in this work the fluid is considered as an incompressible and homogeneous newtonian fluid the body force and gravitational acceleration are not considered the fluid flow is governed by navier stokes ns equations but solving these equations is unrealistic in engineering and even a lot of research applying the reynolds averaged processing to ns equations is the common approach to resolve the viscous flow and results in the reynolds averaged ns rans equations this approach introduces the reynolds stresses terms that need to be solved turbulence models are used by introducing an eddy viscosity μ t to compute the reynolds stresses the shear stress transport sst k ω model is employed menter 1993 menter 1994 menter et al 2003 as it is developed from the k ε model and has been widely applied and validated in predicting no cavitating and cavitating flow around underwater propulsors with its advantages pan et al 2016 lu et al 2016b li et al 2019 motallebi nejad et al 2017 as the re numbers of the two sides of pjp duct are different a significant part of laminar flow region exists on the duct outside particularly at low advance coefficient the difference in flow regimes will affect the duct thrust according to the studies pawar and brizzolara 2019 bhattacharyya et al 2016 bhattacharyya et al 2015 where a significant difference in re numbers of the two sides of the duct also exists and the duct outside has a re number lower than the minimum reynolds number accepted by ittc 5 105 the effect of the difference in flow regimes on duct thrust is slight due to that the duct thrust is dominated by its pressure component and its friction component is very slight when low advance velocity so in this work the transition on duct is ignored as only the thrust of duct is concerned besides the following formulation of turbulent viscosity μ t is adopted 3 μ t ρ k ω 1 max 1 α s f 2 a 1 ω where a 1 is equal to 0 31 ρ is the fluid density s and f 2 are the strain magnitude and blend function respectively α is a coefficient that damps the μ t causing a low reynolds number correction 2 3 pjp performance parameters in order to assess the performance of the pump jet propulsor the non dimensional coefficients are defined as follows 4 j v n d r k t r t r ρ n 2 d r 4 k q r q r ρ n 2 d r 5 k t s t s ρ n 2 d r 4 k q s q s ρ n 2 d r 5 k t d t d ρ n 2 d r 4 k t k t r k t s k t d k q k q r η j 2 π k t k q where v is the inflow velocity n is the rotor rotating speed j is the advance coefficient d r is the rotor diameter t is the total thrust and q is the pjp torque equal to rotor torque t r t s and t d are the thrust of rotor stator and duct respectively q r and q s are the torque of rotor and stator respectively k t and k q represent the total thrust coefficient and torque coefficient of pjp respectively k tr k ts and k td are the thrust coefficient of rotor stator and duct respectively k qr and k qs are the torque coefficient of rotor and stator respectively η is the pjp efficiency the pressure coefficient is defined as 5 c p p p 1 2 ρ π n d r 2 where the p is the far field pressure whose value is equal to the domain outlet pressure in the current work the pressure on pjp is fluctuant so the non dimensional form of root mean square error of pressure is applied to evaluate the fluctuation degree of pressure the definition is 6 c σ p σ p 1 2 ρ π n d r 2 σ p 1 n t n 1 n t p p 2 p 1 n t n 1 n t p where n t is the counted time step 3 mesh and numerical set up the whole computational domain is divided into three sub domains the rotor domain the stator domain and the external domain the external domain has the same section as the cavitation tunnel and a length of 15 0d r the rotor locates at 5 0d r from the inlet partitioning the entire computational domain is beneficial for the mesh generation all sub domains are structure mesh and both the rotor mesh and stator mesh were generated by the periodic grid of one blade the close up views of the fine mesh based on the original pjp model are given in fig 4 in the present work the maximum reynolds number of pjp re max is simply estimated by the definition ρ c 1 0 r v 2 π n d r 2 μ where c 1 0r is chord length of rotor blade at 1 0r and r is the radius and μ is the fluid dynamic viscosity the re max ranges from 9 25 105 to 9 88 105 in condition for the original pjp model this range is lower than the real value as the rotor suction effects will accelerate the flow according to the re max near the walls the heights of first layers are 2 10 5 m and 5 10 5 m for tip clearance and other walls under a given y value close to 5 respectively that is appropriate for the rans solver with the sst k ω turbulence model and resolves to the viscous sub layer of the boundary layer the max cell volume of the fine mesh group is approximate to 2 d r 1 d r 1 d r in the duct inner flow field and less than 1 d r 1 d r 1 d r in rotor domain table 2 lists the sub domain mesh of all cases where the colored lines are accordant with table 1 the close up views of mesh distribution around the duct are given in fig 5 in order to hold the max cell size around the duct and tip clearance the total mesh elements are changed for the duct length and tip clearance cases the boundary conditions are shown in fig 4 a uniform flow with the velocity value v corresponding to the advance coefficient j of pjp and the turbulence intensity of the value 5 is set on the inlet boundary a pressure outlet boundary is given to the outlet with the constant pressure p out equal to 1 atm the far field wall is set as a zero shear stress wall during the simulations the rotor revolution speed n is fixed as 20r s three group meshes of coarse medium and fine are used to assess the effects of mesh density on calculating the hydrodynamics of pjp for the transient calculations based on the fine mesh the time step is set as 1 0δt corresponded to one degree for rotor revolution all the simulations are solved by ansys fluent with the simplec scheme a second order discretization of momentum and standard discretization of pressure are used the transient term is discretized by the second order implicit the unsteady simulations are conducted on the basis of the corresponding steady results in addition all the steady and unsteady calculations are performed in a cloud computing platform ccp 4 results and discussion 4 1 grid verification and unsteady effects following the ittc i t t c ittc 2008 guidelines for a solution variable φ the numerical errors include the iterative errors δ it φ grid size error δ g φ time step error δ t φ and other parameters related errors δ op φ however in most practical engineering applications the numerical errors related to other parameters are ignored and iterative uncertainty is negligible for steady simulations the convergency study needs at least three solutions solved with the meshes which are well ordered by following a systematic refinement process for the parameter i under investigations all other parameters should be held constant the refinement ratio r i is used to estimate the input parameter refining level for grid refinement the grid ratio r g is required where the subscript denotes the grid parameter in the present work the value of r g is set equal to 1 3 during the mesh refining procedure the convergency ratio r i φ for the input parameter is expressed as 7 r i φ s i 2 φ s i 1 φ s i 3 φ s i 2 φ where s i 1 φ s i 2 φ and s i 3 φ represent three different solutions with fine medium and coarse input parameter respectively three conditions are possible 1 0 r i φ 1 monotonic convergence 2 1 r i φ 0 oscillatory convergence 3 r i φ 1 divergence celik et al 2008 offers an improved approach to estimate the effects of mesh density called the grid convergency index gci whose definition is 8 g c i f i n e 21 φ 1 25 δ i 21 a φ r i p i φ 1 where the subscripts 1 and 2 denote the input parameters of fine and medium mesh respectively the following formulations are employed in calculating g c i f i n e 21 φ 9 p i φ 1 ln r i 21 ln s i 3 φ s i 2 φ s i 2 φ s i 1 φ q p φ q p φ ln r i 21 p i φ s φ r i 32 p i φ s φ s φ 1 s i g n s i 3 φ s i 2 φ s i 2 φ s i 1 φ s i 21 e x t φ r i 21 p i φ s i 1 φ s i 2 φ r i 21 p i φ 1 δ i 21 a s i 2 φ s i 1 φ s i 1 φ δ i 21 e x t φ s i 21 e x t φ s i 1 φ s i 21 e x t φ where the subscript 3 denotes the input parameters obtained from coarse mesh p i φ is the apparent order s i 21 e x t φ is the extrapolated value δ i 21 a φ is the approximate error and δ i 21 e x t φ is the extrapolated relative error in this case the grid ratios calculated by the total grid numbers are r g 21 1 3139 between the fine and medium and r g 32 1 3391 between the medium and coarse table 3 lists the mesh verification results of k t and k q at j 1 0 results indicate that three group meshes are monotonic convergence the gci approach exhibits that the mesh has a more discernible effect on the thrust as the k t values are more sensitive to mesh density overall the grid convergency verification shows good convergence so all the cases are based on the same grid topology and density of the fine mesh and the details of total grid numbers are given in table 2 fig 6 shows the v m y and c p distributions where v m is the nondimensionalized value of the velocity magnitude v m calculated by v fig 7 exhibits the effects of unsteady calculation on open water curves and the comparison of rotor hydrodynamic coefficients to the experiment where the k qs is the absolute value and the unsteady results are the periodic averaged values the mesh density has significant impacts on the rotor wake and tip clearance flow it shows more similar distributions on the high velocity gradient areas between medium and fine meshes according to the mesh verification the fine mesh is capable of getting hydrodynamics and reduces the effects of mesh density on results as much as possible there are considerable differences between the steady and unsteady results except for k td showing a large change at j 0 8 due to the small absolute value all coefficients have relative differences approximate to or lower than 2 compared with the experimental data of rotor there are also some pronounced differences that may mainly come from the reasons of the numerical method mesh and the differences between the pjp models in numerical calculation and experiment the rotor operating in stator wake causes apparent fluctuations of rotor thrust and torque the duct force is also obviously fluctuant due to the intense interaction between the rotor and duct in the frequency domain the relative amplitudes a nondimensionalized by the time averaged value of rotor thrust and torque coefficients respectively show that the fluctuations mainly act on 2bpf and 4bpf where the bpf is the blade passing frequency bpf k tr and k qr have the absolutely dominant intensities of fluctuation the unsteady results successfully present the propagations downstream of the radial and circumferential velocity components which is an important factor affecting the y and c p distributions on duct the differences between the pressure distributions of per blade cause the blade to generate fluctuant forces from the contour and iso surface of q criterion hunt et al 1988 two typical vortices the stator wake vortices and the tip clearance vortices exist in pjp wake the rans simulation can not offer more details of these vortices and its evolution but it provides the main typical vortices structures and shows the propagation downstream of these vortices and the effects of duct restriction though the steady calculating can get a satisfying result of open water performance and require less cpu consumption it obtains great differences of pressure distributions on rotor and duct compared to unsteady results for those reasons all the cases are performed with unsteady calculation 4 2 open water performance according to the research objective the results of tip clearance and incidence angle are given in fig 8 and fig 9 the two parameters are directly varied by changing duct profile position the effects of tip clearance δ d exhibit the same change pattern as the investigations on the post stator pjp increasing δ d results in reductions of k t and k q and causes the efficiency decrease as k t has a larger relative reduction than k q at high advance coefficients the efficiency shows more pronounced changes comparing k tr and k td k ts the decrease of total thrust mainly comes from the k tr when the duct generating drag it demonstrates the same trend as stator that increasing δ d decreases the drag besides the advance coefficient also shows significant effects on k td and k ts k ts has larger decrements at low advance coefficients while the duct shows the contrary law the stator produces the equivalent degree of torque to the rotor unlike the rotor the stator presents large torque decrements at low advance coefficients as δ d increases the tip clearance dominantly affects the fluctuant intensities of rotor thrust and torque though the intensities go down as the δ d increases they exhibit the contrary change when tip clearance is very large this is mainly caused by the intense tip clearance leakage flow which has been investigated and indicates the coincident results that the larger tip clearance is the intenser tip clearance leakage flow exists and hence more effects act on rotor li et al 2019 yu et al 2019 decreasing tip clearance can obtain the efficiency improvement and restrains tip clearance flow loss but the increase of nondimensionalized amplitudes means the intenser fluctuant thrust and torque as the fluctuation and time averaged values are increased simultaneously for a pjp operating behind the submarine large fluctuant forces will generate more resistance in improving the stealth so it may not be proper to decrease the tip clearance size to a very small value thoughtlessly for the incidence angle of duct α d in order to guarantee the rotor working stage the inner duct in the rotor region is slightly modified and the details are shown in fig 3 d the effects of this modification on open water performance are shown in fig 9 a and b except for the k td showing relatively large differences at j 0 8 vicinity due to the small absolute values all coefficients are slightly changed and the relative differences are lower than 0 5 the changes are slight and the following analyses of α d effects are based on the modified model except that increasing α d of the original model causes a sharp drop of k t at j 1 2 k t is almost no notable difference as the incidence angle changes the sharp drop of k t is caused by the decreases of k tr and k td where k td contributes the major part so in the following discussion the case of α d 11 2270 at j 1 2 is ignored k q manages the efficiency changes the open water efficiency is improved because the k q has larger decrease while k t is almost no notable change though the k ts shows obvious relative changes it does not cause noticeable change to k t k t is mainly changed under the effects of k tr and k td decreasing α d improves the duct thrust but this improvement is almost offset by the decrease of rotor thrust as the k tr and k td has the equivalent degree of change more distinguishable differences and larger increments of k qs than that of k qr occur it is a negative effect on the pjp torque balance performance due to the large difference between the rotor and stator torque near the design point according to the open water curves except for the case α d 11 2270 the fluctuant intensities of k tr and k qr at 4bpf are presented in fig 9 h under the α d influence the relative amplitude intensities of k tr and k qr show slight changes but the time averaged values of k tr and k qr are decreased as α d decreases so they show lower absolute fluctuant intensities when small incidence angle decreasing the incidence angle means the duct sharing more thrust or generated less drag which is better for reducing the exciting force of rotor under the open water condition by changing the allocation ratio of thrust between rotor and duct comparing the effects of tip clearance and incidence angle a proper tip clearance size or a small incidence angle is better for the pjp propulsion performance vibration and noise level for the pjp an optimization value of tip clearance size exists when considering the unsteady forces and it is better to arrange the duct with a small incidence angle as much as possible under satisfying the matching and adapting with the submarine stern shape the duct length the shrinkage ratio of duct inlet and the expansion ratio of duct outlet are directly varied by changing the shape of duct profile for the duct length the hub is extended as the duct length will exceed the original hub in z direction the effects of the extended hub on pjp open water performance are given in fig 10 a and b except for k td whose difference is affected by its low absolute value the differences of all coefficients are less than 5 when the advance coefficients are lower than 1 2 the variation of duct length is based on the pjp model with the extended hub the influences of l d on open water curves are shown in fig 10 c g the efficiency increases as the l d increases at almost all the calculated advance coefficients the k t rises with increasing l d at all the advance coefficients lower than 1 2 while the k q shows the contrary trend at advance coefficients higher than 0 2 k qs has more notable changes than that of k tr and k qr and its increment between different lengths is decreased as the duct length increases k ts also shows the same trend and its value plays a noticeable impact on total thrust due to its obvious changes which can be seen from the figures of k td and k td k ts the improvement of efficiency mainly comes from the duct as its thrust increases as the duct length extends while the k tr and k qr are slightly decreased the fluctuant intensities of k tr and k qr decrease and then increase as the duct is elongated though the k tr and k qr are decreased with increasing the length they have very large relative amplitudes in the long duct cases the fluctuant forces of rotor are weakened and then aggravated this is not beneficial for open water performance with too long duct and the long duct also results in larger stator torque and has more effects on the submarine stern thus affecting the marine drag and the maneuverability so when the duct generates thrust or small drag and increasing the length does not cause significant effects on these it is better to prolong the duct to a proper length under the marine drag and maneuverability permits the long duct also results in benefits in noise resistance due to the duct shielding effects on noise propagation in fig 11 the hydrodynamics curves under the r i effects are shown where some results of r i 1 3035 are not shown for a better representation of other data when r i 1 3035 sharp drops of thrust and torque occur at j 1 0 and j 1 2 and even the negative total thrust at j 1 2 so the following discussion does not consider the case r i 1 3035 unlike k t which demonstrates the increase as r i goes up the change trend of k q is affected by the advance coefficient when the advance coefficients are higher than 0 8 k q is increased and then decreased k qs shows the same trend at all advance coefficients as k q does at high advance coefficients though k td has a decrease trend as r i decreases the increases of k ts and k tr offsets the loss of k td and maintains the k t in slight increments and thus the efficiency improvement when pjp is under moderate to high advance coefficients the increment of k ts even totally offsets the decrement of k td and thus k td k ts shows an increase trend as the r i increases this improves the total thrust and thus efficiency as the total thrust and efficiency obtain the improvements by decreasing r i reducing the r i is beneficial for the propulsion performance the fluctuation of unsteady force does not linearly change as the r i decreases among the calculated cases the amplitude of fluctuation is decreased and then increased and gets the minimum values at r i 1 1803 the magnitude gets over serval times of other cases at r i 1 0981 due to that k tr is increased and then decreased as the r i decreases decreasing the r i is better for the exciting force to some extent but this trend is only suitable for open water conditions like the r i the expansion ratio of the duct outlet r o is also an important factor affecting the pjp hydrodynamics the results are given in fig 12 the efficiency obtains the decrease trend at the advance coefficients before the design point as the r o decreases while η shows the trend of increase first and then decrease at j 1 0 and j 1 2 k tr and k td demonstrate the contrary change trend k ts has the same trend as k tr but its absolute value is far smaller than that of k tr and k td comparing k td and k td k ts k ts makes no noticeable effects in offsetting the decrease of k td the total thrust is mainly affected by the relative changes of k tr and k td k qr and k qs show the inverse change trend and k qr has more obvious differences the torque is affected by the advance coefficient and shows larger changes between different r o at high advance coefficient from the open water curves it can be seen that the r o shows limited variation range and but presents significant effects on performance if only considering the efficiency there are three new cases r o 0 8497 r o 0 9136 and r o 0 9460 which shows slight effects near the design point but these cases also mean that there exist many choices that the efficiency can be maintained in small change under different thrust and torque requirements the fluctuant amplitudes of rotor thrust and torque of the three new cases and the original model are given in fig 12 h the relative amplitudes increase as the r o increases though the forces of rotor are decreased the larger changes in relative amplitudes cause intenser fluctuations comparing the relative changes of rotor force and fluctuant intensity it is better for the rotor operating in a duct with low r o value only under satisfying the thrust and torque requirements for the three factors affecting the duct profile shape and thus the performance a slight change of r i or r o results in apparent changes in hydrodynamic performance and thrust fluctuation l d indicates the positive influences on pjp open water performance as the increment of k td k ts is larger than the decrement of k tr prolonging the duct increases the duct force however when the pjp works behind a submarine stern the duct benefits may be weakened as there exists important interaction between the stern and duct the improvement of duct thrust enhances the pjp performance but the interaction may cause more drag generated by the stern thus the increment of total drag of the hull moreover an overlong duct exacerbates the force fluctuation intensity and also puts greater challenges in maneuverability 4 3 the pressure field in this section the effects of duct parameters on pressure distribution are discussed at the design point j 1 0 analyzing the pressure distribution is better for understanding the effects of duct parameter and getting feedback to design fig 13 and fig 14 present the effects of δ d and α d on the pressure distributions of duct rotor and stator respectively increasing δ d causes the global rising of pressure on stator the pressure on the outside of duct is almost no discernible changes under the impact of δ d for the inside of duct the rotor and stator show the significant effects on pressure distribution the increase of pressure on the pressure side of stator leads to larger local high pressure regions near the duct inlet the tip region and it downstream significantly impacts the pressure distributions on duct decreasing δ d means the interaction degree between the rotor tip and duct is enhanced the enhanced interaction results in an increase of pressure on the local high pressure region and hence increasing the duct drag decreasing δ d leads to the expansion of the low pressure region on suction side and lower pressure on this region which is harmful to the cavitation resistance of rotor moreover small tip clearance has significant inhibitory effects on the development of tip clearance flow too large tip clearance not only causes very low pressure in the tip region but also leads the tip low pressure region to move and expand to the trailing edge the rotor has a significant intensity of pressure fluctuation on the rotor leading edge which is the main reason for causing the fluctuation of rotor forces the tip clearance also presents apparent pressure fluctuation in the tip region and the pressure side of next blade there are two areas on the tip face with apparent intensities increasing the tip clearance expands the areas and then they merge when the tip clearance is very large the large tip clearance is friendly with the improvement of duct thrust but causes intenser tip clearance flow and reduces the rotor load reducing the tip clearance results in an improvement of the pressure fluctuations in the tip region and its impacting regions and is an effective means of controlling tip clearance flow and its impacts though the pre swirl effect of stator has improved inflow of rotor it brings some undesirable results due to that the rotor rotates in the stator wake as an essential working part the rotor behind the stator is the primary disturbance source causing the flow field fluctuation the incidence angle causes significant changes in the pressure distributions of the duct rotor and stator decreasing α d causes the global reduction of pressure on stator unlike the tip clearance decreasing α d leads to a significant reduction of stator length in the radial direction and thus narrowing the high pressure area on pressure side the rotor working stage is ensured during modifying the geometry and thus the tip clearance is constant nevertheless increasing α d exacerbates the interaction between the rotor wake and duct and also has more significant effects of restriction on tip clearance flow the enhanced interaction brings more loss of duct thrust it results in extreme changes in hydrodynamic performance when the incidence angle is too large increasing α d causes pressure reduction on the leading edge area of duct outside but this does not offset the pressure increment on duct inside in the rotor downstream causing the huge drop of duct thrust under the strong interaction between the rotor and duct the pressure on rotor pressure side is increased and has a larger increment than that of pressure on suction side resulting in the improvement of rotor thrust however this improvement is nearly offset by the reduction of duct thrust and only shows a slight increment without any improvement of torque the efficiency is decreased with increasing the incidence angle and drops quickly when the angle increases to a critical value besides increasing the angle improves the low pressure distribution on the suction side of rotor but causes intenser low pressure and broader region in the tip region and more potent effects of tip clearance flow on the rotor suction side unlike the tip clearance the change of incidence angle does not cause the movement of tip clearance low pressure region a balanced value exists for better control of low pressure distributions on tip clearance and suction side the distribution of c σp shows slight changes on the leading edge and presents an expansion and high intensity on the tip face and the impacted area on the next blade as decreasing the angle reduces the restriction of duct on tip clearance flow it ensures the tip clearance flow has a more prosperous region to develop and thus causing intenser pressure fluctuation on tip face and the pressure side of next blade with the considerations of performance pressure distribution and fluctuation cavitation the interaction between the duct and the hull stern the incidence angle of duct is not the smaller the better unlike the tip clearance it can not give a better angle value only by studying and considering the angle effects the effects of l d r i and r o on pressure distribution are shown in fig 15 fig 16 and fig 17 respectively the pressure on stator is obviously decreased though the decrease of pressure on suction side of stator is bad for thrust it causes the improvement of stator thrust due to the effects of stator length in the radial direction and the simultaneous decrement of pressure on pressure side on the leading edge of duct increasing l d results lower difference of pressures on the outside and inside on the duct inside increasing l d mainly expands the high pressure region and causes slight decrease of pressure prolonging the duct weakens the interaction degree in the tip region though the pressure on rotor suction side is decreased the weakened interaction leads to reduction of pressure on rotor pressure side thus causing slight loss of rotor thrust due to that the pressure side has larger decrement of pressure the weakened interaction also slightly reduces the low pressure region on blade tip two significant areas with high c σp exist on the tip clearance region with l d increasing these areas are expanded but they do not merge into one large area the intensities of c σp on these areas are also enhanced it also has the same change trend for another typical area on the pressure side of next blade besides longer length weakens the interaction between the middle of leading edge of rotor blade and the stator wake but exacerbates the interaction between the tip of leading edge of rotor blade and the stator wake decreasing r i presents the same change trend of pressure on stator as increasing the duct length does on the leading edge of duct outside the pressure decreases and then increases as the r i goes up the decrease is beneficial for improving the duct drag but the increase at the high r i value r i 1 3035 results in a huge drop of duct thrust decreasing r i presents the reduction of pressure on the leading edge of duct inside which is better for increasing duct thrust for the interaction area on duct inside increasing r i slightly increases and then weakens the pressure due to the strong interaction the pressure on pressure side of rotor shows the same trend but more noticeable for the rotor suction side the change in pressure also follows the same trend and show quicker change when r i is small the low pressure area on tip is expanded and then narrowed as the r i increases according to the open water curves and the pressure distribution only the original model and the models with decreasing r i are considered to calculate the c σp decreasing r i intensifies the interaction between the leading edge of rotor and the stator wake and causes intenser c σp on the leading edge near tip and the tip face as mentioned before two typical areas exist on the tip face whose fluctuation is local higher and significantly enhanced by decreasing r i the huge rise of thrust fluctuation at the smallest r i is caused by the violent interaction of the leading edge to the stator wake it is not proper to significantly reduce the r i value for getting higher efficiency with the considerations of cavitation and the hull stern effect an optimization value exists the pressure distribution is susceptible to r o change the change of r o causes more violent changes of pressure distributions than that of other duct parameters particularly the pressure on rotor and duct inside increasing r o causes the global decrease of pressure on stator on the leading edge of duct high r o results in the slight decrease of pressure on the inside while it shows the inverse trend on the outside decreasing r o exacerbates the interaction between the duct and the rotor small r o restricts the rotor wake causing very high pressure on duct and the pressure side of rotor and hence showing the significant loss of duct thrust and the improvement of rotor thrust can not balance the loss resulting efficiency loss increasing r o enlarges the low pressure region on the suction side of rotor and this region even covers the whole suction side when r o is very high over 1 0 a low pressure region also occurs and expands on the pressure side when high r o in the tip region increasing r o weakens the limitation to tip clearance flow thus showing the increase of pressure this phenomenon is better for the tip clearance cavitation but the suction side is under the easy cavitation condition considering the open water curves and the pressure distributions on rotor and duct there only four cases are chosen to conduct the further calculation of pressure fluctuation for the leading edge of rotor and the pressure side of next rotor blade the differences of c σp are slight under different r o two areas with high local intensity of c σp exist on tip face and are significantly affected by the change of r o larger r o results in the movement of these areas to trailing edge and causes the obvious increase of intensity on the second area located close to trailing edge though the hydrodynamic coefficients and pressure details are very sensitive to r o the accepting cases present little difference in efficiency at the design point 4 4 the velocity field on the basis of pressure changes the effects of duct parameter on pjp propulsion performance can be better understood from the velocity distribution the vortex identification q criteria hunt et al 1988 is employed to identify the vortices there are typical vortices of tip clearance vortices and stator wake vortices in the inner flow field and pjp wake the distributions of velocity and vortices under the effects of duct parameters are shown in fig 18 and fig 19 respectively the tip clearance has significant effects of acceleration or deceleration on duct inside flow small δ d results in an intenser suction effect on the duct inflow and thus accelerating the flow in the duct inside passage before the rotor for the rotor outflow it is decelerated as δ d decreases according to the velocity change of rotor outflow the velocity of duct outflow presents a noticeable increase mainly due to the radius decrease of duct outlet increasing δ d causes stronger tip clearance flow resulting in more disturbance to main flow near the tip clearance region and it downstream near the wall of duct inside too large δ d leads to a very slow flow in the transition region between the rotor working stage and it downstream this slow flow obstructs the tip clearance flow and shows the resistance to the movement and development of tip clearance flow motion with a larger tip clearance the flow with high velocity gradient in stator wake is also more apparent in pjp wake as the influence of pjp outflow is mitigated due to its low velocity under the q criteria the effects of tip clearance on the vortices are more distinct there are two typical vortices series of the tip clearance vortices and stator wake vortices the tip clearance slightly impacts on the stator wake vortices the generation beginning and development of tip clearance vortices are essentially restrained by the duct the wall boundary layer and the main flow together act on these vortices after the tip vortices moving out of duct its intensities are enhanced by the shedding vortices from the duct trailing edge with very small δ d the tip vortices are very close to the duct and thus quickly dissipate in the rotor wake until they get the improvement from the duct trailing edge shedding vortices though the vortices get the enhancement their propagation and expansion in the pjp wake are also very short and narrow large tip clearance generates high intensity tip clearance vortices whose development and evolution are slightly affected by the wall boundary layer of duct however too large tip clearance size generates high intense tip clearance vortices which are more significant to the mainstream and cause intenser feedback besides the slow flow region aforementioned also generates significant resistance to the vortices motion those effects result in the huge reduction of vortex intensity and thus show a lower intensity after out of duct and the limited propagation distance in the pjp wake high incidence angle results in the high speed outflow of duct and more inhibition to tip clearance flow and intensifies the interaction between tip clearance flow and mainstream the tip clearance vortices are sharply decayed in rotor wake before out of duct when α d is high increasing α d increases the flow separation duct outside and produces the higher intensity of the duct trailing edge shedding vortices and thus showing more apparent enhancement on the tip clearance vortices moreover decreasing α d results in high speed flow through the stator and thus generating high intensity of stator wake vortices comparing the effects of tip clearance and incidence angle on tip clearance vortices and stator wake vortices adopting small tip clearance and slightly decreasing the incidence angle is a considerable way to control the vortices changing duct length presents slight differences in the maximum velocity of duct outflow longer duct provides a larger distance for the tip clearance flow holding high strength to move downstream but this phenomenon does not show when the duct is very long as the wall boundary also has significant resistance to the movement of tip clearance flow prolonging the duct results in the decrease of stator length in the radial direction which causes an acceleration effect on the flow around the stator and thus increasing the velocity gradient in stator wake the enhancement of stator wake vortices is more evident when a long duct while for the tip vortices the longer length prolongs the distance of the interaction between the tip vortices and the wall boundary and increases the time of mainstream effects on tip vortices under the duct restraining which results in the significant dissipation of tip vortices before out of duct the r i does not present apparent effects on the velocity of duct outflow and mainly affects the flow around duct surface small r i accelerates the flow around stator but the velocity of rotor outflow is slightly decreased the high velocity region on duct outside moves to the leading edge as r i increases when r i is very high the flow separation occurs on the leading edge the tip clearance flow and tip clearance vortices which are significantly affected by tip clearance size radius of duct outlet and interaction distance from duct are almost no distinct differences until large r i causes the flow separation on duct outside and thus significantly affects the duct trailing edge shedding vortices inside the duct the vortex field does not show apparent changes until too high r i causes the intense flow separation on duct outside and thus affecting the tip clearance vortices out of duct the radius of duct outlet significantly affects the inflow and outflow of duct decreasing r o results in the high velocity of duct outflow and low velocity of duct inflow thus showing the high jet ratio and too small r o causes intenser flow separation near duct trailing edge the acceleration effect on the duct inflow means the stator generates large drag at the same time the tip clearance flow is enhanced but it is more considerably restricted by the shrinkage of duct this restriction is different from the duct effects on tip clearance flow when high r o under which the tip clearance flow is detained and weakened by the thicker boundary layer as decreasing r o increases the rotor load the tip clearance vortices are enhanced and show apparent vortices in pjp wake though the duct has an appreciable restriction on vortices during out of duct the enhancement from the duct trailing edge vortices is also enhanced due to the intenser flow separation and hence improves the tip clearance vortices the development of tip clearance vortices is also weakened before moving out of duct as the r o goes up the increased r o causes slow flow and thicker boundary layer near the duct wall before out of duct which are essential factors to delay the tip vortices and thus getting the aim of weakening intensity as the separation effect on duct also is weakened the enhancement of tip vortices from the shedding vortices of duct trailing edge is decreased this phenomenon results in the very low intensities of vortices in pjp wake when high r o however those changes do not make sense due to a vast reduction in pjp performance besides large r o enhances the rotor suction effect which results in higher flow velocity through the stator and hence increases the stator drag and causes high strength vortices in stator wake according to the velocity and vortices changes under the effects of l d r i and r o a better vortices control is feasible by modestly increasing the duct length or the radius of duct outlet increasing the r i or decreasing the r o to an unreasonable value will cause the intense flow separation and thus significantly affect the pjp performance 5 conclusions in this paper in order to study the effects of duct parameters on pjp performance serval series of pjp model are obtained under given modifying methods and then we perform a systemic investigation based on the discussion of the pjp unsteady hydrodynamics and flow characteristics for the tip clearance and incidence angle they are directly changed by moving the position of duct profile the duct length is directly changed by prolonging it in the axial direction for the shrinkage ratio of duct inlet and the expansion ratio of duct outlet they are controlled by changing the radius of duct inlet or the radius of duct outlet the unsteady performance and flow field of the original pjp model are firstly discussed on the basis of considering the mesh density effects then the effects of duct parameters on pjp open water performance and flow field are systemically analyzed decreasing tip clearance improves the open water performance and weakens the tip clearance flow but aggravates the fluctuation of rotor forces and enhances the low pressure area on suction side including the size and pressure value the changes in open water performance are mainly reflected in the rotor thrust and torque hence the efficiency as the tip clearance flow is weakened the tip clearance vortices and thus the vortices in pjp wake are weakened but decreasing the tip clearance flow causes the flow through the stator is accelerated and hence increases the intensity of stator wake vortices decreasing the incidence angle improves the open water performance and weakens the fluctuation of rotor forces but enhances the low pressure area on suction side including the size and pressure value unlike the effects of tip clearance changing the incidence angle also causes a significant change in duct thrust decreasing the incidence angle weakens the thrust and torque of rotor but improves the duct thrust for the tip clearance flow decreasing the incidence angle mainly improves the pressure and decreases the size of low pressure region but does not show an essential decrease of tip clearance vortices besides the low incidence angle shows strong stator wake vortices prolonging the duct improves the open water performance which mainly comes from the enhancement of duct thrust as the rotor thrust and torque have relatively slight changes increasing duct length significantly deteriorates the torque balance because the stator torque has a more apparent increase than that of rotor the stator thrust also increases with lengthening the duct the fluctuations of rotor forces show the global trend of increase as duct increases for the low pressure region on rotor suction side it expands with lengthening the duct and the pressure on this region is also decreased simultaneously and the pressure fluctuations on leading edge near the rotor tip and in the tip clearance region are also aggravated increasing duct length weakens the tip clearance vortices and its development in the pjp wake but causes the intenser stator wake vortices decreasing the shrinkage ratio of duct inlet improves the open water performance but enhances the low pressure area on suction side including the size and pressure value the improvement of open water performance is mainly contributed by rotor thrust and the thrust improvement of duct and stator system the decrease of duct thrust is well offset by the increase of stator thrust too small shrinkage ratio of duct inlet causes intense fluctuation of rotor forces and expands the low pressure region on rotor suction side when decreasing the shrinkage ratio of duct inlet the pressure fluctuation on rotor has the same change trend as that of prolonging the duct the expansion ratio of duct outlet significantly affects the pjp open water performance as a slight change of r o results in obvious changes in hydrodynamic coefficients the effects of r o on efficiency is also changed by the advance coefficient the efficiency is decreased with r o decreasing while it shows the tendency to increase and then decrease at high advance coefficients decreasing r o improves the total thrust as the rotor thrust has a larger increase than the decrease of duct thrust increasing r o causes the fluctuation degrees of rotor forces going up and weakens the cavitation resistance of rotor suction side but for the tip clearance region increasing r o improves the cavitation resistance increasing r o appropriately under the requirement of propulsion is vital for controlling the tip clearance vortices by reducing the rotor loads and enhancing the interaction between the vortices and duct wall boundary layer both the r i and r o will affect the flow separation on duct outside and the properly low values of them are better for the efficiency and vortex controlling based on the results of presented cases credit authorship contribution statement qiaogao huang conceptualization supervision writing review editing software han li conceptualization data curation investigation methodology visualization writing original draft software guang pan supervision xinguo dong validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by the national natural science foundation of china under project no 51979226 no 61803306 and no 51709229 fundamental research funds for the central universities under project no 3102019hhzy030019 and national key r d plan of china under project no 2016yfc0301300 
21093,this work aims to investigate the effects of duct parameter on the open water performance of pump jet propulsor five duct parameters are considered including the length diameter ratio the incidence angle the shrinkage ratio of duct inlet the expansion ratio of duct outlet and the tip clearance ratio based on the mesh verification a brief analysis of the pjp unsteady propulsion performance is first presented the duct parameters are thoroughly studied focusing on the open water performance thrust fluctuation the pressure field and its fluctuation the velocity field and vortices the results indicate that the length diameter ratio and the expansion ratio of duct outlet have significant effects on open water performance and controlling the vortices the tip clearance ratio and the shrinkage ratio of duct inlet show slight effects on performance but the tip clearance flow presents noticeable changes the incidence angle also has significant impacts on tip clearance vortices but results in more considerable performance changes than tip clearance ratio and shrinkage ratio of duct inlet keywords pump jet propulsor hydrodynamics duct parameter vortices 1 introduction the propulsion system is an essential part of underwater carriers for high speed underwater vehicles and submarine the pump jet propulsor pjp is considered as the most promising candidate propulsor and the major significant superiorities over other propulsors are the high efficiency and quietness under the same input power the pjp positively utilizes the retarded wake flow and produces high efficiency if the pjp is properly designed the ejected flow has a finite positive flow speed against the surroundings and even has a velocity near the vehicle speed thus the ejected flow leaves a finite jet wake after the vehicle passed and this is also much beneficial to the quietness for the pjp the duct forms the flow passage and then affects the ejected flow thereby affecting the propulsion performance the duct plays a significant role in pjp due to the particular application of pjp there are a few public published research on theory design but many numerical studies on the pjp performance are publicly published and available though the analysis approaches are further developed and improved especially when great progress has been made in the computer power and computational fluid dynamics cfd the design theory is still mainly based on the potential flow the duct processing in the design stage is helpful for investigating the effects of duct parameter eisenhuth and mccormick eisenhuth and mc cormick 1963 presented the design and performance of pjp under the cavitation and efficiency requirements in their design the duct is first determined and then the input of the rotor and stator design is given according to the duct design they thought that the chord line of the duct should be aligned along with the resultant velocity due to the body and rotor to avoid the negative pressure peaks existing at the duct nose in addition the stall over the duct outside also should be considered after the foregoing design henderson et al 1964 discussed the duct design of pjp the duct should be designed under consideration of the flow between duct and central body the stream surface of revolution is based on a certain mean velocity of flow between upstream and central body and the contour of duct must be slightly outside the stream surface at duct inlet and end slightly outside the stream surface at duct outlet to produce a slight vena contracta for discharging jet the duct length is obtained on the basis of mechanical considerations the incidence angle should be determined under the considerations of duct lift coefficient and flow separation bruce et al 1974 also discussed the duct design problem in mounting on the aft end of a body of revolution on the views of drag and energy focusing on the analysis of pjp it has been widely studied by numerical approach many experiments are mainly conducted for validation or research on the performance of pjp under different operating conditions there is almost none experiment investigation on geometric parameter due to the massive cost of manufacturing model and experiment the public experimental data has successfully validated the performance characteristics of pjp and the feasibility of numerical method applied in predicting the pjp performance ivanell 2001 dong et al 2012 shirazi et al 2019 suryanarayana et al 2010a suryanarayana et al 2010b suryanarayana et al 2010c the work of suryanarayana et al 2010a suryanarayana et al 2010b suryanarayana et al 2010c show that the pjp of a torpedo performs well in torque balance both in non cavitation and cavitation and even though the torpedo has a trim angle of 4 5 degree the cavitation incepts on the rotor tip surface and develops towards the suction side of the rotor as the rotating speed increases and the cavitation expands fully on the suction side of the rotor blade at a very low cavitation number for a torpedo equipped pjp model these characteristics including the torque balance and cavitation performance are also concluded in some numerical studies shi et al 2015 lu et al 2016a pan et al 2016 the effects of tip clearance on pjp performance has been studied in many published papers the tip clearance flow has a significant role in the pjp flow field primarily affecting the flow on the tip region and its downstream the tip clearance is the gap between the rotor tip surface and the duct near rotor tip so there are two ways of using duct to cut the blade or placing duct profile in the radial direction when to modify the tip clearance modifying the tip clearance by placing duct can be regarded as a parameter of duct as this way changes the duct radial position the effects of tip clearance on pjp open water and cavitation performances are almost numerically discussed increasing tip clearance size causes the pjp open water efficiency decreasing while it shows the improvement of efficiency at an extremely high advance coefficient and indicates a sharp decrease in efficiency at a very low advance coefficient under cavitation condition lu et al 2016b qin et al 2018 though the modification approach to tip clearance in the work li et al 2019 is different from the studies lu et al 2016b qin et al 2018 the open water efficiency follows the same change trend for a front stator pjp the tip clearance reduces the intensity of pressure fluctuation on rotor suction side near the tip region while it shows the contrary law on the pressure side yu et al 2019 besides the unsteady investigations show that applying the mesh motion approach to handle the rotor rotating causes considerable differences in pjp performance and flow field details comparing to that predicted by applying multi reference frame mrf li et al 2019 yu et al 2019 motallebi nejad et al 2017 except for the tip clearance there are a few investigations on the effects of other duct parameters wang et al 2019a parameterized the duct and investigated the effect of some duct parameters including the camber tip clearance and angle of attack on the hydrodynamic performance of a post stator pjp by an in house code wang et al 2019b their works indicate that the tip clearance has the same effect mentioned before on pjp efficiency increasing the duct camber or reducing the angle of attack improves the pjp overall efficiency and the increment of camber is also beneficial for cavitation performance moreover the angle of attack has more obvious effects on pjp performance the quietness is another important requirement for the pjp so new treatments with focus on the local details of duct shape are considered to study their effects on pjp noise performance qin et al 2019 and sun et al 2019 applied the sawtooth duct for pjp noise reduction results show that the sawtooth duct wastes a little efficiency of pjp and gains an improvement of overall noise level the duct parameter has also been investigated for other ducted propulsor those investigations are valuable and inspirational for the study on pjp duct some typical and systematic analyses of researches on duct of the ducted propulsor have been revisited huyer and dropkin 2011 conducted a duct optimization by simplifying the propulsor behind the hull into the axisymmetric two dimensional layout the vehicle drag arrives at the minimum value when the duct generates a zero mean flow acceleration the duct increases the total drag no matter the duct accelerates or decreases the flow but propulsive efficiency is improved from the accelerating effects while decelerating flow shows contrary effects in their work the duct shape was not parameterized and the authors mainly focused on the overall duct effects on the flow the theoretical analysis oosterveld 1970 indicates that increasing the duct length generates more drag when the duct is under generating drag condition while it has the opposite effect when the duct generates thrust regardless of generating drag or thrust the thickness has the coincident influence that the drag is increased or the thrust is decreased as the thickness increases and demonstrates the more obvious effects when the duct produces drag moreover the increased absolute value of duct drag or thrust exacerbates the risk of flow separation on the exterior surface of duct the experimental data of k4 55 propeller inside the 19 a accelerating duct with different duct lengths demonstrate that increasing the length improves both the thrusts of propeller and duct and results in higher value at optimum efficiency point the length camber and the maximum thickness of a decelerating duct equipped in a ducted propeller have been studied by applying the axial momentum theory and the nonlinear semi analytical actuator disk model bontempo et al 2016 the maximum thickness has more pronounced effects on duct drag than that of camber and length the length has the minimum effects on duct drag increasing the camber and length or decreasing the maximum thickness enhances the propeller cavitation resistance but the increase of camber causes the duct cavitation at the extremely high advance coefficient and the decrease of the maximum thickness fosters the leading edge cavitation on duct with the same approach they investigated the effects of the maximum thickness length camber and incidence angle of an accelerating duct an increase of thickness length camber or a decrease in incidence angle improves the propulsion efficiency bontempo and manna 2018 the approach of axisymmetric momentum theory and actuator disk model can quickly analyze the duct parameter effects but the viscous effects are not considered in the duct optimization gaggero et al 2017 including accelerating duct and decelerating duct the duct profile is described by the b spline and varied its shape by controlling several points this method of varying the duct does not show more organized results comparing to the duct parameters varying method bontempo et al 2016 bontempo and manna 2018 due to the more complex duct profile and the stator effects the flow around the pjp duct and its impacts on pjp overall performance are more complicated compared to the ducted propeller investigating the effects of duct parameter is valuable it is also reliable through the cfd approach to implementing the investigation as the cfd approach can overcome the simplifications of geometry and fluid property and becomes a common method in the numerical studies on flow problems in this paper the layout is organized as follows section 2 presents the research objects geometry configurations and the numerical approach used in this work in section 3 the mesh and the problem set up are described the discussion and analysis are exhibited in section 4 including the verification of mesh density the unsteady hydrodynamics performance the effects of duct parameters the flow field finally a summary of the key results can be found in section 5 2 research object 2 1 geometry configuration the pump jet propulsor in model scale and its coordinate are presented in fig 1 the rotor rotates around z axis and the flow direction follows the z axis direction this model has a pre swirl stator with eight blades and a rear rotor with six blades the rotor diameter is d r 2r r 0 1664 m and the maximum diameter of stator is d s 0 2038m the diameters of duct inlet and outlet are d t1 0 2104 m and d t2 0 1460 m respectively the tip clearance size between the duct inside and the tip face is 0 001 m the stator hub has the same conical degree as the submarine tail and extends out of the duct inlet a cut ellipsoid connects the far field hub and stator hub for a better transition for analyzing the effects of duct parameter on the pjp performance the pjp model with those above geometric parameters is set as the original model which was fabricated and then conducted an experiment in the science and technology on water jet propulsion laboratory of the marine design and research institute of china in fig 2 the main parameters of duct are given where the l d α d δ d r i r o r w l w are the length of duct the incidence angle of duct the tip clearance size the radius of duct inlet the radius of duct outlet the radius of rotor working stage the length of rotor working stage respectively as the rotor working stage should be held to ensure the rotor rotating the duct profile is no longer a simple airfoil it is not appropriate and will catch more additional problems by applying the airfoil controlling parameter to vary duct parameter so in this present work the duct profile is parameterized and modified in the following way the duct profile is divided by nine points from point p 1 to point p 9 into nine segments point p 1 and p 9 are the leading edge and trailing edge of duct profile respectively the arcs p 2 p 3 and p 7 p 8 are the fillets of leading edge and trailing edge of duct profile respectively the up and down profile curves are described by four shape functions f r i u z f ro u z f r i d z f r o d z and a line p 4 p 5 in the duct profile plane xoz the incidence angle of duct α d is the acute angle between the connected line p 1 p 9 and the z coordinate axis four duct main dimensionless parameters the shrinkage ratio of duct inlet r i expansion ratio of duct outlet r o tip clearance ratio δ d length diameter ratio l d are defined as follows 1 r i r i r w r w r r δ d δ d δ d r w r o r o r w l d l d r w and there exists a correlation among r i r o l d and α d 2 l d tan α d r i r o when an investigated parameter is changing it will cause another parameter to change this can not be avoided so we mainly focus on the directly changed parameter to study the effects of duct parameters the tip clearance size is controlled by fixing the rotor and then moving the duct profile in the radial direction the duct length is elongated on the basis of o in the z direction to get different duct length the incidence angle of duct is varied by rotating the duct profile around o in the xoz plane in order to ensure the rotor working stage the duct profiles are partially modified near the inlet and outlet of rotor working stage rotating the duct profile will change the positions of p 4 and p 5 so when the rotated p 4 is more closer to z axis in the x direction than the original position of p 4 the curve p 3 p 4 will cut by the extended line p 4 p 5 and when the rotated p 4 is farther a tangent of curve p 3 p 4 beginning from p 4 is added and cut curve p 3 p 4 at the tangency point for p 5 the modification follows the contrary way the changing step of α d is one degree the modified profiles under α d parameter are shown in fig 3 in detail the changes of r i and r o are controlled by the above four functions and a increment function r z k d z 2 in the x direction where k d is a controlled coefficient during this processing the duct thickness distribution is held constant when r i is varied the increment r z k d z z 4 2 z 3 z z 4 is added to curves p 3 p 4 and p 2 p 6 to control r i concurrently thus the increment of r i is r z k d z 3 z 4 2 similar to r i an increment r z k d z z 5 2 z 5 z z 7 is added to curves p 5 p 7 and p 6 p 8 to control the r o concurrently all modified results are demonstrated in fig 3 and table 1 in detail furthermore considering the duct will extend out of the cut ellipsoid stage in the z direction when the duct length parameter is investigated the hub before the stator hub is extended as shown in fig 2 the modifications of duct profile will change the length of stator blade in the radial direction so for the increase of stator blade length the stator section is extended along the leading edge and trailing edge and for the decrease the stator blade is directly cut by the duct 2 2 numerical approach in this work the fluid is considered as an incompressible and homogeneous newtonian fluid the body force and gravitational acceleration are not considered the fluid flow is governed by navier stokes ns equations but solving these equations is unrealistic in engineering and even a lot of research applying the reynolds averaged processing to ns equations is the common approach to resolve the viscous flow and results in the reynolds averaged ns rans equations this approach introduces the reynolds stresses terms that need to be solved turbulence models are used by introducing an eddy viscosity μ t to compute the reynolds stresses the shear stress transport sst k ω model is employed menter 1993 menter 1994 menter et al 2003 as it is developed from the k ε model and has been widely applied and validated in predicting no cavitating and cavitating flow around underwater propulsors with its advantages pan et al 2016 lu et al 2016b li et al 2019 motallebi nejad et al 2017 as the re numbers of the two sides of pjp duct are different a significant part of laminar flow region exists on the duct outside particularly at low advance coefficient the difference in flow regimes will affect the duct thrust according to the studies pawar and brizzolara 2019 bhattacharyya et al 2016 bhattacharyya et al 2015 where a significant difference in re numbers of the two sides of the duct also exists and the duct outside has a re number lower than the minimum reynolds number accepted by ittc 5 105 the effect of the difference in flow regimes on duct thrust is slight due to that the duct thrust is dominated by its pressure component and its friction component is very slight when low advance velocity so in this work the transition on duct is ignored as only the thrust of duct is concerned besides the following formulation of turbulent viscosity μ t is adopted 3 μ t ρ k ω 1 max 1 α s f 2 a 1 ω where a 1 is equal to 0 31 ρ is the fluid density s and f 2 are the strain magnitude and blend function respectively α is a coefficient that damps the μ t causing a low reynolds number correction 2 3 pjp performance parameters in order to assess the performance of the pump jet propulsor the non dimensional coefficients are defined as follows 4 j v n d r k t r t r ρ n 2 d r 4 k q r q r ρ n 2 d r 5 k t s t s ρ n 2 d r 4 k q s q s ρ n 2 d r 5 k t d t d ρ n 2 d r 4 k t k t r k t s k t d k q k q r η j 2 π k t k q where v is the inflow velocity n is the rotor rotating speed j is the advance coefficient d r is the rotor diameter t is the total thrust and q is the pjp torque equal to rotor torque t r t s and t d are the thrust of rotor stator and duct respectively q r and q s are the torque of rotor and stator respectively k t and k q represent the total thrust coefficient and torque coefficient of pjp respectively k tr k ts and k td are the thrust coefficient of rotor stator and duct respectively k qr and k qs are the torque coefficient of rotor and stator respectively η is the pjp efficiency the pressure coefficient is defined as 5 c p p p 1 2 ρ π n d r 2 where the p is the far field pressure whose value is equal to the domain outlet pressure in the current work the pressure on pjp is fluctuant so the non dimensional form of root mean square error of pressure is applied to evaluate the fluctuation degree of pressure the definition is 6 c σ p σ p 1 2 ρ π n d r 2 σ p 1 n t n 1 n t p p 2 p 1 n t n 1 n t p where n t is the counted time step 3 mesh and numerical set up the whole computational domain is divided into three sub domains the rotor domain the stator domain and the external domain the external domain has the same section as the cavitation tunnel and a length of 15 0d r the rotor locates at 5 0d r from the inlet partitioning the entire computational domain is beneficial for the mesh generation all sub domains are structure mesh and both the rotor mesh and stator mesh were generated by the periodic grid of one blade the close up views of the fine mesh based on the original pjp model are given in fig 4 in the present work the maximum reynolds number of pjp re max is simply estimated by the definition ρ c 1 0 r v 2 π n d r 2 μ where c 1 0r is chord length of rotor blade at 1 0r and r is the radius and μ is the fluid dynamic viscosity the re max ranges from 9 25 105 to 9 88 105 in condition for the original pjp model this range is lower than the real value as the rotor suction effects will accelerate the flow according to the re max near the walls the heights of first layers are 2 10 5 m and 5 10 5 m for tip clearance and other walls under a given y value close to 5 respectively that is appropriate for the rans solver with the sst k ω turbulence model and resolves to the viscous sub layer of the boundary layer the max cell volume of the fine mesh group is approximate to 2 d r 1 d r 1 d r in the duct inner flow field and less than 1 d r 1 d r 1 d r in rotor domain table 2 lists the sub domain mesh of all cases where the colored lines are accordant with table 1 the close up views of mesh distribution around the duct are given in fig 5 in order to hold the max cell size around the duct and tip clearance the total mesh elements are changed for the duct length and tip clearance cases the boundary conditions are shown in fig 4 a uniform flow with the velocity value v corresponding to the advance coefficient j of pjp and the turbulence intensity of the value 5 is set on the inlet boundary a pressure outlet boundary is given to the outlet with the constant pressure p out equal to 1 atm the far field wall is set as a zero shear stress wall during the simulations the rotor revolution speed n is fixed as 20r s three group meshes of coarse medium and fine are used to assess the effects of mesh density on calculating the hydrodynamics of pjp for the transient calculations based on the fine mesh the time step is set as 1 0δt corresponded to one degree for rotor revolution all the simulations are solved by ansys fluent with the simplec scheme a second order discretization of momentum and standard discretization of pressure are used the transient term is discretized by the second order implicit the unsteady simulations are conducted on the basis of the corresponding steady results in addition all the steady and unsteady calculations are performed in a cloud computing platform ccp 4 results and discussion 4 1 grid verification and unsteady effects following the ittc i t t c ittc 2008 guidelines for a solution variable φ the numerical errors include the iterative errors δ it φ grid size error δ g φ time step error δ t φ and other parameters related errors δ op φ however in most practical engineering applications the numerical errors related to other parameters are ignored and iterative uncertainty is negligible for steady simulations the convergency study needs at least three solutions solved with the meshes which are well ordered by following a systematic refinement process for the parameter i under investigations all other parameters should be held constant the refinement ratio r i is used to estimate the input parameter refining level for grid refinement the grid ratio r g is required where the subscript denotes the grid parameter in the present work the value of r g is set equal to 1 3 during the mesh refining procedure the convergency ratio r i φ for the input parameter is expressed as 7 r i φ s i 2 φ s i 1 φ s i 3 φ s i 2 φ where s i 1 φ s i 2 φ and s i 3 φ represent three different solutions with fine medium and coarse input parameter respectively three conditions are possible 1 0 r i φ 1 monotonic convergence 2 1 r i φ 0 oscillatory convergence 3 r i φ 1 divergence celik et al 2008 offers an improved approach to estimate the effects of mesh density called the grid convergency index gci whose definition is 8 g c i f i n e 21 φ 1 25 δ i 21 a φ r i p i φ 1 where the subscripts 1 and 2 denote the input parameters of fine and medium mesh respectively the following formulations are employed in calculating g c i f i n e 21 φ 9 p i φ 1 ln r i 21 ln s i 3 φ s i 2 φ s i 2 φ s i 1 φ q p φ q p φ ln r i 21 p i φ s φ r i 32 p i φ s φ s φ 1 s i g n s i 3 φ s i 2 φ s i 2 φ s i 1 φ s i 21 e x t φ r i 21 p i φ s i 1 φ s i 2 φ r i 21 p i φ 1 δ i 21 a s i 2 φ s i 1 φ s i 1 φ δ i 21 e x t φ s i 21 e x t φ s i 1 φ s i 21 e x t φ where the subscript 3 denotes the input parameters obtained from coarse mesh p i φ is the apparent order s i 21 e x t φ is the extrapolated value δ i 21 a φ is the approximate error and δ i 21 e x t φ is the extrapolated relative error in this case the grid ratios calculated by the total grid numbers are r g 21 1 3139 between the fine and medium and r g 32 1 3391 between the medium and coarse table 3 lists the mesh verification results of k t and k q at j 1 0 results indicate that three group meshes are monotonic convergence the gci approach exhibits that the mesh has a more discernible effect on the thrust as the k t values are more sensitive to mesh density overall the grid convergency verification shows good convergence so all the cases are based on the same grid topology and density of the fine mesh and the details of total grid numbers are given in table 2 fig 6 shows the v m y and c p distributions where v m is the nondimensionalized value of the velocity magnitude v m calculated by v fig 7 exhibits the effects of unsteady calculation on open water curves and the comparison of rotor hydrodynamic coefficients to the experiment where the k qs is the absolute value and the unsteady results are the periodic averaged values the mesh density has significant impacts on the rotor wake and tip clearance flow it shows more similar distributions on the high velocity gradient areas between medium and fine meshes according to the mesh verification the fine mesh is capable of getting hydrodynamics and reduces the effects of mesh density on results as much as possible there are considerable differences between the steady and unsteady results except for k td showing a large change at j 0 8 due to the small absolute value all coefficients have relative differences approximate to or lower than 2 compared with the experimental data of rotor there are also some pronounced differences that may mainly come from the reasons of the numerical method mesh and the differences between the pjp models in numerical calculation and experiment the rotor operating in stator wake causes apparent fluctuations of rotor thrust and torque the duct force is also obviously fluctuant due to the intense interaction between the rotor and duct in the frequency domain the relative amplitudes a nondimensionalized by the time averaged value of rotor thrust and torque coefficients respectively show that the fluctuations mainly act on 2bpf and 4bpf where the bpf is the blade passing frequency bpf k tr and k qr have the absolutely dominant intensities of fluctuation the unsteady results successfully present the propagations downstream of the radial and circumferential velocity components which is an important factor affecting the y and c p distributions on duct the differences between the pressure distributions of per blade cause the blade to generate fluctuant forces from the contour and iso surface of q criterion hunt et al 1988 two typical vortices the stator wake vortices and the tip clearance vortices exist in pjp wake the rans simulation can not offer more details of these vortices and its evolution but it provides the main typical vortices structures and shows the propagation downstream of these vortices and the effects of duct restriction though the steady calculating can get a satisfying result of open water performance and require less cpu consumption it obtains great differences of pressure distributions on rotor and duct compared to unsteady results for those reasons all the cases are performed with unsteady calculation 4 2 open water performance according to the research objective the results of tip clearance and incidence angle are given in fig 8 and fig 9 the two parameters are directly varied by changing duct profile position the effects of tip clearance δ d exhibit the same change pattern as the investigations on the post stator pjp increasing δ d results in reductions of k t and k q and causes the efficiency decrease as k t has a larger relative reduction than k q at high advance coefficients the efficiency shows more pronounced changes comparing k tr and k td k ts the decrease of total thrust mainly comes from the k tr when the duct generating drag it demonstrates the same trend as stator that increasing δ d decreases the drag besides the advance coefficient also shows significant effects on k td and k ts k ts has larger decrements at low advance coefficients while the duct shows the contrary law the stator produces the equivalent degree of torque to the rotor unlike the rotor the stator presents large torque decrements at low advance coefficients as δ d increases the tip clearance dominantly affects the fluctuant intensities of rotor thrust and torque though the intensities go down as the δ d increases they exhibit the contrary change when tip clearance is very large this is mainly caused by the intense tip clearance leakage flow which has been investigated and indicates the coincident results that the larger tip clearance is the intenser tip clearance leakage flow exists and hence more effects act on rotor li et al 2019 yu et al 2019 decreasing tip clearance can obtain the efficiency improvement and restrains tip clearance flow loss but the increase of nondimensionalized amplitudes means the intenser fluctuant thrust and torque as the fluctuation and time averaged values are increased simultaneously for a pjp operating behind the submarine large fluctuant forces will generate more resistance in improving the stealth so it may not be proper to decrease the tip clearance size to a very small value thoughtlessly for the incidence angle of duct α d in order to guarantee the rotor working stage the inner duct in the rotor region is slightly modified and the details are shown in fig 3 d the effects of this modification on open water performance are shown in fig 9 a and b except for the k td showing relatively large differences at j 0 8 vicinity due to the small absolute values all coefficients are slightly changed and the relative differences are lower than 0 5 the changes are slight and the following analyses of α d effects are based on the modified model except that increasing α d of the original model causes a sharp drop of k t at j 1 2 k t is almost no notable difference as the incidence angle changes the sharp drop of k t is caused by the decreases of k tr and k td where k td contributes the major part so in the following discussion the case of α d 11 2270 at j 1 2 is ignored k q manages the efficiency changes the open water efficiency is improved because the k q has larger decrease while k t is almost no notable change though the k ts shows obvious relative changes it does not cause noticeable change to k t k t is mainly changed under the effects of k tr and k td decreasing α d improves the duct thrust but this improvement is almost offset by the decrease of rotor thrust as the k tr and k td has the equivalent degree of change more distinguishable differences and larger increments of k qs than that of k qr occur it is a negative effect on the pjp torque balance performance due to the large difference between the rotor and stator torque near the design point according to the open water curves except for the case α d 11 2270 the fluctuant intensities of k tr and k qr at 4bpf are presented in fig 9 h under the α d influence the relative amplitude intensities of k tr and k qr show slight changes but the time averaged values of k tr and k qr are decreased as α d decreases so they show lower absolute fluctuant intensities when small incidence angle decreasing the incidence angle means the duct sharing more thrust or generated less drag which is better for reducing the exciting force of rotor under the open water condition by changing the allocation ratio of thrust between rotor and duct comparing the effects of tip clearance and incidence angle a proper tip clearance size or a small incidence angle is better for the pjp propulsion performance vibration and noise level for the pjp an optimization value of tip clearance size exists when considering the unsteady forces and it is better to arrange the duct with a small incidence angle as much as possible under satisfying the matching and adapting with the submarine stern shape the duct length the shrinkage ratio of duct inlet and the expansion ratio of duct outlet are directly varied by changing the shape of duct profile for the duct length the hub is extended as the duct length will exceed the original hub in z direction the effects of the extended hub on pjp open water performance are given in fig 10 a and b except for k td whose difference is affected by its low absolute value the differences of all coefficients are less than 5 when the advance coefficients are lower than 1 2 the variation of duct length is based on the pjp model with the extended hub the influences of l d on open water curves are shown in fig 10 c g the efficiency increases as the l d increases at almost all the calculated advance coefficients the k t rises with increasing l d at all the advance coefficients lower than 1 2 while the k q shows the contrary trend at advance coefficients higher than 0 2 k qs has more notable changes than that of k tr and k qr and its increment between different lengths is decreased as the duct length increases k ts also shows the same trend and its value plays a noticeable impact on total thrust due to its obvious changes which can be seen from the figures of k td and k td k ts the improvement of efficiency mainly comes from the duct as its thrust increases as the duct length extends while the k tr and k qr are slightly decreased the fluctuant intensities of k tr and k qr decrease and then increase as the duct is elongated though the k tr and k qr are decreased with increasing the length they have very large relative amplitudes in the long duct cases the fluctuant forces of rotor are weakened and then aggravated this is not beneficial for open water performance with too long duct and the long duct also results in larger stator torque and has more effects on the submarine stern thus affecting the marine drag and the maneuverability so when the duct generates thrust or small drag and increasing the length does not cause significant effects on these it is better to prolong the duct to a proper length under the marine drag and maneuverability permits the long duct also results in benefits in noise resistance due to the duct shielding effects on noise propagation in fig 11 the hydrodynamics curves under the r i effects are shown where some results of r i 1 3035 are not shown for a better representation of other data when r i 1 3035 sharp drops of thrust and torque occur at j 1 0 and j 1 2 and even the negative total thrust at j 1 2 so the following discussion does not consider the case r i 1 3035 unlike k t which demonstrates the increase as r i goes up the change trend of k q is affected by the advance coefficient when the advance coefficients are higher than 0 8 k q is increased and then decreased k qs shows the same trend at all advance coefficients as k q does at high advance coefficients though k td has a decrease trend as r i decreases the increases of k ts and k tr offsets the loss of k td and maintains the k t in slight increments and thus the efficiency improvement when pjp is under moderate to high advance coefficients the increment of k ts even totally offsets the decrement of k td and thus k td k ts shows an increase trend as the r i increases this improves the total thrust and thus efficiency as the total thrust and efficiency obtain the improvements by decreasing r i reducing the r i is beneficial for the propulsion performance the fluctuation of unsteady force does not linearly change as the r i decreases among the calculated cases the amplitude of fluctuation is decreased and then increased and gets the minimum values at r i 1 1803 the magnitude gets over serval times of other cases at r i 1 0981 due to that k tr is increased and then decreased as the r i decreases decreasing the r i is better for the exciting force to some extent but this trend is only suitable for open water conditions like the r i the expansion ratio of the duct outlet r o is also an important factor affecting the pjp hydrodynamics the results are given in fig 12 the efficiency obtains the decrease trend at the advance coefficients before the design point as the r o decreases while η shows the trend of increase first and then decrease at j 1 0 and j 1 2 k tr and k td demonstrate the contrary change trend k ts has the same trend as k tr but its absolute value is far smaller than that of k tr and k td comparing k td and k td k ts k ts makes no noticeable effects in offsetting the decrease of k td the total thrust is mainly affected by the relative changes of k tr and k td k qr and k qs show the inverse change trend and k qr has more obvious differences the torque is affected by the advance coefficient and shows larger changes between different r o at high advance coefficient from the open water curves it can be seen that the r o shows limited variation range and but presents significant effects on performance if only considering the efficiency there are three new cases r o 0 8497 r o 0 9136 and r o 0 9460 which shows slight effects near the design point but these cases also mean that there exist many choices that the efficiency can be maintained in small change under different thrust and torque requirements the fluctuant amplitudes of rotor thrust and torque of the three new cases and the original model are given in fig 12 h the relative amplitudes increase as the r o increases though the forces of rotor are decreased the larger changes in relative amplitudes cause intenser fluctuations comparing the relative changes of rotor force and fluctuant intensity it is better for the rotor operating in a duct with low r o value only under satisfying the thrust and torque requirements for the three factors affecting the duct profile shape and thus the performance a slight change of r i or r o results in apparent changes in hydrodynamic performance and thrust fluctuation l d indicates the positive influences on pjp open water performance as the increment of k td k ts is larger than the decrement of k tr prolonging the duct increases the duct force however when the pjp works behind a submarine stern the duct benefits may be weakened as there exists important interaction between the stern and duct the improvement of duct thrust enhances the pjp performance but the interaction may cause more drag generated by the stern thus the increment of total drag of the hull moreover an overlong duct exacerbates the force fluctuation intensity and also puts greater challenges in maneuverability 4 3 the pressure field in this section the effects of duct parameters on pressure distribution are discussed at the design point j 1 0 analyzing the pressure distribution is better for understanding the effects of duct parameter and getting feedback to design fig 13 and fig 14 present the effects of δ d and α d on the pressure distributions of duct rotor and stator respectively increasing δ d causes the global rising of pressure on stator the pressure on the outside of duct is almost no discernible changes under the impact of δ d for the inside of duct the rotor and stator show the significant effects on pressure distribution the increase of pressure on the pressure side of stator leads to larger local high pressure regions near the duct inlet the tip region and it downstream significantly impacts the pressure distributions on duct decreasing δ d means the interaction degree between the rotor tip and duct is enhanced the enhanced interaction results in an increase of pressure on the local high pressure region and hence increasing the duct drag decreasing δ d leads to the expansion of the low pressure region on suction side and lower pressure on this region which is harmful to the cavitation resistance of rotor moreover small tip clearance has significant inhibitory effects on the development of tip clearance flow too large tip clearance not only causes very low pressure in the tip region but also leads the tip low pressure region to move and expand to the trailing edge the rotor has a significant intensity of pressure fluctuation on the rotor leading edge which is the main reason for causing the fluctuation of rotor forces the tip clearance also presents apparent pressure fluctuation in the tip region and the pressure side of next blade there are two areas on the tip face with apparent intensities increasing the tip clearance expands the areas and then they merge when the tip clearance is very large the large tip clearance is friendly with the improvement of duct thrust but causes intenser tip clearance flow and reduces the rotor load reducing the tip clearance results in an improvement of the pressure fluctuations in the tip region and its impacting regions and is an effective means of controlling tip clearance flow and its impacts though the pre swirl effect of stator has improved inflow of rotor it brings some undesirable results due to that the rotor rotates in the stator wake as an essential working part the rotor behind the stator is the primary disturbance source causing the flow field fluctuation the incidence angle causes significant changes in the pressure distributions of the duct rotor and stator decreasing α d causes the global reduction of pressure on stator unlike the tip clearance decreasing α d leads to a significant reduction of stator length in the radial direction and thus narrowing the high pressure area on pressure side the rotor working stage is ensured during modifying the geometry and thus the tip clearance is constant nevertheless increasing α d exacerbates the interaction between the rotor wake and duct and also has more significant effects of restriction on tip clearance flow the enhanced interaction brings more loss of duct thrust it results in extreme changes in hydrodynamic performance when the incidence angle is too large increasing α d causes pressure reduction on the leading edge area of duct outside but this does not offset the pressure increment on duct inside in the rotor downstream causing the huge drop of duct thrust under the strong interaction between the rotor and duct the pressure on rotor pressure side is increased and has a larger increment than that of pressure on suction side resulting in the improvement of rotor thrust however this improvement is nearly offset by the reduction of duct thrust and only shows a slight increment without any improvement of torque the efficiency is decreased with increasing the incidence angle and drops quickly when the angle increases to a critical value besides increasing the angle improves the low pressure distribution on the suction side of rotor but causes intenser low pressure and broader region in the tip region and more potent effects of tip clearance flow on the rotor suction side unlike the tip clearance the change of incidence angle does not cause the movement of tip clearance low pressure region a balanced value exists for better control of low pressure distributions on tip clearance and suction side the distribution of c σp shows slight changes on the leading edge and presents an expansion and high intensity on the tip face and the impacted area on the next blade as decreasing the angle reduces the restriction of duct on tip clearance flow it ensures the tip clearance flow has a more prosperous region to develop and thus causing intenser pressure fluctuation on tip face and the pressure side of next blade with the considerations of performance pressure distribution and fluctuation cavitation the interaction between the duct and the hull stern the incidence angle of duct is not the smaller the better unlike the tip clearance it can not give a better angle value only by studying and considering the angle effects the effects of l d r i and r o on pressure distribution are shown in fig 15 fig 16 and fig 17 respectively the pressure on stator is obviously decreased though the decrease of pressure on suction side of stator is bad for thrust it causes the improvement of stator thrust due to the effects of stator length in the radial direction and the simultaneous decrement of pressure on pressure side on the leading edge of duct increasing l d results lower difference of pressures on the outside and inside on the duct inside increasing l d mainly expands the high pressure region and causes slight decrease of pressure prolonging the duct weakens the interaction degree in the tip region though the pressure on rotor suction side is decreased the weakened interaction leads to reduction of pressure on rotor pressure side thus causing slight loss of rotor thrust due to that the pressure side has larger decrement of pressure the weakened interaction also slightly reduces the low pressure region on blade tip two significant areas with high c σp exist on the tip clearance region with l d increasing these areas are expanded but they do not merge into one large area the intensities of c σp on these areas are also enhanced it also has the same change trend for another typical area on the pressure side of next blade besides longer length weakens the interaction between the middle of leading edge of rotor blade and the stator wake but exacerbates the interaction between the tip of leading edge of rotor blade and the stator wake decreasing r i presents the same change trend of pressure on stator as increasing the duct length does on the leading edge of duct outside the pressure decreases and then increases as the r i goes up the decrease is beneficial for improving the duct drag but the increase at the high r i value r i 1 3035 results in a huge drop of duct thrust decreasing r i presents the reduction of pressure on the leading edge of duct inside which is better for increasing duct thrust for the interaction area on duct inside increasing r i slightly increases and then weakens the pressure due to the strong interaction the pressure on pressure side of rotor shows the same trend but more noticeable for the rotor suction side the change in pressure also follows the same trend and show quicker change when r i is small the low pressure area on tip is expanded and then narrowed as the r i increases according to the open water curves and the pressure distribution only the original model and the models with decreasing r i are considered to calculate the c σp decreasing r i intensifies the interaction between the leading edge of rotor and the stator wake and causes intenser c σp on the leading edge near tip and the tip face as mentioned before two typical areas exist on the tip face whose fluctuation is local higher and significantly enhanced by decreasing r i the huge rise of thrust fluctuation at the smallest r i is caused by the violent interaction of the leading edge to the stator wake it is not proper to significantly reduce the r i value for getting higher efficiency with the considerations of cavitation and the hull stern effect an optimization value exists the pressure distribution is susceptible to r o change the change of r o causes more violent changes of pressure distributions than that of other duct parameters particularly the pressure on rotor and duct inside increasing r o causes the global decrease of pressure on stator on the leading edge of duct high r o results in the slight decrease of pressure on the inside while it shows the inverse trend on the outside decreasing r o exacerbates the interaction between the duct and the rotor small r o restricts the rotor wake causing very high pressure on duct and the pressure side of rotor and hence showing the significant loss of duct thrust and the improvement of rotor thrust can not balance the loss resulting efficiency loss increasing r o enlarges the low pressure region on the suction side of rotor and this region even covers the whole suction side when r o is very high over 1 0 a low pressure region also occurs and expands on the pressure side when high r o in the tip region increasing r o weakens the limitation to tip clearance flow thus showing the increase of pressure this phenomenon is better for the tip clearance cavitation but the suction side is under the easy cavitation condition considering the open water curves and the pressure distributions on rotor and duct there only four cases are chosen to conduct the further calculation of pressure fluctuation for the leading edge of rotor and the pressure side of next rotor blade the differences of c σp are slight under different r o two areas with high local intensity of c σp exist on tip face and are significantly affected by the change of r o larger r o results in the movement of these areas to trailing edge and causes the obvious increase of intensity on the second area located close to trailing edge though the hydrodynamic coefficients and pressure details are very sensitive to r o the accepting cases present little difference in efficiency at the design point 4 4 the velocity field on the basis of pressure changes the effects of duct parameter on pjp propulsion performance can be better understood from the velocity distribution the vortex identification q criteria hunt et al 1988 is employed to identify the vortices there are typical vortices of tip clearance vortices and stator wake vortices in the inner flow field and pjp wake the distributions of velocity and vortices under the effects of duct parameters are shown in fig 18 and fig 19 respectively the tip clearance has significant effects of acceleration or deceleration on duct inside flow small δ d results in an intenser suction effect on the duct inflow and thus accelerating the flow in the duct inside passage before the rotor for the rotor outflow it is decelerated as δ d decreases according to the velocity change of rotor outflow the velocity of duct outflow presents a noticeable increase mainly due to the radius decrease of duct outlet increasing δ d causes stronger tip clearance flow resulting in more disturbance to main flow near the tip clearance region and it downstream near the wall of duct inside too large δ d leads to a very slow flow in the transition region between the rotor working stage and it downstream this slow flow obstructs the tip clearance flow and shows the resistance to the movement and development of tip clearance flow motion with a larger tip clearance the flow with high velocity gradient in stator wake is also more apparent in pjp wake as the influence of pjp outflow is mitigated due to its low velocity under the q criteria the effects of tip clearance on the vortices are more distinct there are two typical vortices series of the tip clearance vortices and stator wake vortices the tip clearance slightly impacts on the stator wake vortices the generation beginning and development of tip clearance vortices are essentially restrained by the duct the wall boundary layer and the main flow together act on these vortices after the tip vortices moving out of duct its intensities are enhanced by the shedding vortices from the duct trailing edge with very small δ d the tip vortices are very close to the duct and thus quickly dissipate in the rotor wake until they get the improvement from the duct trailing edge shedding vortices though the vortices get the enhancement their propagation and expansion in the pjp wake are also very short and narrow large tip clearance generates high intensity tip clearance vortices whose development and evolution are slightly affected by the wall boundary layer of duct however too large tip clearance size generates high intense tip clearance vortices which are more significant to the mainstream and cause intenser feedback besides the slow flow region aforementioned also generates significant resistance to the vortices motion those effects result in the huge reduction of vortex intensity and thus show a lower intensity after out of duct and the limited propagation distance in the pjp wake high incidence angle results in the high speed outflow of duct and more inhibition to tip clearance flow and intensifies the interaction between tip clearance flow and mainstream the tip clearance vortices are sharply decayed in rotor wake before out of duct when α d is high increasing α d increases the flow separation duct outside and produces the higher intensity of the duct trailing edge shedding vortices and thus showing more apparent enhancement on the tip clearance vortices moreover decreasing α d results in high speed flow through the stator and thus generating high intensity of stator wake vortices comparing the effects of tip clearance and incidence angle on tip clearance vortices and stator wake vortices adopting small tip clearance and slightly decreasing the incidence angle is a considerable way to control the vortices changing duct length presents slight differences in the maximum velocity of duct outflow longer duct provides a larger distance for the tip clearance flow holding high strength to move downstream but this phenomenon does not show when the duct is very long as the wall boundary also has significant resistance to the movement of tip clearance flow prolonging the duct results in the decrease of stator length in the radial direction which causes an acceleration effect on the flow around the stator and thus increasing the velocity gradient in stator wake the enhancement of stator wake vortices is more evident when a long duct while for the tip vortices the longer length prolongs the distance of the interaction between the tip vortices and the wall boundary and increases the time of mainstream effects on tip vortices under the duct restraining which results in the significant dissipation of tip vortices before out of duct the r i does not present apparent effects on the velocity of duct outflow and mainly affects the flow around duct surface small r i accelerates the flow around stator but the velocity of rotor outflow is slightly decreased the high velocity region on duct outside moves to the leading edge as r i increases when r i is very high the flow separation occurs on the leading edge the tip clearance flow and tip clearance vortices which are significantly affected by tip clearance size radius of duct outlet and interaction distance from duct are almost no distinct differences until large r i causes the flow separation on duct outside and thus significantly affects the duct trailing edge shedding vortices inside the duct the vortex field does not show apparent changes until too high r i causes the intense flow separation on duct outside and thus affecting the tip clearance vortices out of duct the radius of duct outlet significantly affects the inflow and outflow of duct decreasing r o results in the high velocity of duct outflow and low velocity of duct inflow thus showing the high jet ratio and too small r o causes intenser flow separation near duct trailing edge the acceleration effect on the duct inflow means the stator generates large drag at the same time the tip clearance flow is enhanced but it is more considerably restricted by the shrinkage of duct this restriction is different from the duct effects on tip clearance flow when high r o under which the tip clearance flow is detained and weakened by the thicker boundary layer as decreasing r o increases the rotor load the tip clearance vortices are enhanced and show apparent vortices in pjp wake though the duct has an appreciable restriction on vortices during out of duct the enhancement from the duct trailing edge vortices is also enhanced due to the intenser flow separation and hence improves the tip clearance vortices the development of tip clearance vortices is also weakened before moving out of duct as the r o goes up the increased r o causes slow flow and thicker boundary layer near the duct wall before out of duct which are essential factors to delay the tip vortices and thus getting the aim of weakening intensity as the separation effect on duct also is weakened the enhancement of tip vortices from the shedding vortices of duct trailing edge is decreased this phenomenon results in the very low intensities of vortices in pjp wake when high r o however those changes do not make sense due to a vast reduction in pjp performance besides large r o enhances the rotor suction effect which results in higher flow velocity through the stator and hence increases the stator drag and causes high strength vortices in stator wake according to the velocity and vortices changes under the effects of l d r i and r o a better vortices control is feasible by modestly increasing the duct length or the radius of duct outlet increasing the r i or decreasing the r o to an unreasonable value will cause the intense flow separation and thus significantly affect the pjp performance 5 conclusions in this paper in order to study the effects of duct parameters on pjp performance serval series of pjp model are obtained under given modifying methods and then we perform a systemic investigation based on the discussion of the pjp unsteady hydrodynamics and flow characteristics for the tip clearance and incidence angle they are directly changed by moving the position of duct profile the duct length is directly changed by prolonging it in the axial direction for the shrinkage ratio of duct inlet and the expansion ratio of duct outlet they are controlled by changing the radius of duct inlet or the radius of duct outlet the unsteady performance and flow field of the original pjp model are firstly discussed on the basis of considering the mesh density effects then the effects of duct parameters on pjp open water performance and flow field are systemically analyzed decreasing tip clearance improves the open water performance and weakens the tip clearance flow but aggravates the fluctuation of rotor forces and enhances the low pressure area on suction side including the size and pressure value the changes in open water performance are mainly reflected in the rotor thrust and torque hence the efficiency as the tip clearance flow is weakened the tip clearance vortices and thus the vortices in pjp wake are weakened but decreasing the tip clearance flow causes the flow through the stator is accelerated and hence increases the intensity of stator wake vortices decreasing the incidence angle improves the open water performance and weakens the fluctuation of rotor forces but enhances the low pressure area on suction side including the size and pressure value unlike the effects of tip clearance changing the incidence angle also causes a significant change in duct thrust decreasing the incidence angle weakens the thrust and torque of rotor but improves the duct thrust for the tip clearance flow decreasing the incidence angle mainly improves the pressure and decreases the size of low pressure region but does not show an essential decrease of tip clearance vortices besides the low incidence angle shows strong stator wake vortices prolonging the duct improves the open water performance which mainly comes from the enhancement of duct thrust as the rotor thrust and torque have relatively slight changes increasing duct length significantly deteriorates the torque balance because the stator torque has a more apparent increase than that of rotor the stator thrust also increases with lengthening the duct the fluctuations of rotor forces show the global trend of increase as duct increases for the low pressure region on rotor suction side it expands with lengthening the duct and the pressure on this region is also decreased simultaneously and the pressure fluctuations on leading edge near the rotor tip and in the tip clearance region are also aggravated increasing duct length weakens the tip clearance vortices and its development in the pjp wake but causes the intenser stator wake vortices decreasing the shrinkage ratio of duct inlet improves the open water performance but enhances the low pressure area on suction side including the size and pressure value the improvement of open water performance is mainly contributed by rotor thrust and the thrust improvement of duct and stator system the decrease of duct thrust is well offset by the increase of stator thrust too small shrinkage ratio of duct inlet causes intense fluctuation of rotor forces and expands the low pressure region on rotor suction side when decreasing the shrinkage ratio of duct inlet the pressure fluctuation on rotor has the same change trend as that of prolonging the duct the expansion ratio of duct outlet significantly affects the pjp open water performance as a slight change of r o results in obvious changes in hydrodynamic coefficients the effects of r o on efficiency is also changed by the advance coefficient the efficiency is decreased with r o decreasing while it shows the tendency to increase and then decrease at high advance coefficients decreasing r o improves the total thrust as the rotor thrust has a larger increase than the decrease of duct thrust increasing r o causes the fluctuation degrees of rotor forces going up and weakens the cavitation resistance of rotor suction side but for the tip clearance region increasing r o improves the cavitation resistance increasing r o appropriately under the requirement of propulsion is vital for controlling the tip clearance vortices by reducing the rotor loads and enhancing the interaction between the vortices and duct wall boundary layer both the r i and r o will affect the flow separation on duct outside and the properly low values of them are better for the efficiency and vortex controlling based on the results of presented cases credit authorship contribution statement qiaogao huang conceptualization supervision writing review editing software han li conceptualization data curation investigation methodology visualization writing original draft software guang pan supervision xinguo dong validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by the national natural science foundation of china under project no 51979226 no 61803306 and no 51709229 fundamental research funds for the central universities under project no 3102019hhzy030019 and national key r d plan of china under project no 2016yfc0301300 
21094,this paper proposes an efficient potential and viscous flow decomposition method for wave structure interaction simulation with single phase wave models and two phase computational fluid dynamics cfd solvers the potential part represents the incident waves is solved with spectral wave models the viscous part represents the complementary perturbation on the incident waves is solved with the cfd solver the decomposition strategy is called spectral wave explicit navier stokes equations swense originally proposed for single phase cfd solvers ferrant et al 2003 firstly this paper presents a new two phase swens equations with interface capturing technique to achieve this single phase and two phase decomposition the incident fields are extended in the air with a density weighted pressure secondly an accurate and efficient interpolation method is proposed to transfer high order spectral hos wave model s result on cfd mesh which reduces drastically the divergence error of the interpolated velocity implemented within openfoam these methods are tested by three verification validation and application cases considering incident wave propagation high order loads on a vertical cylinder in regular waves and a catenary anchor leg mooring buoy in both regular and irregular waves speed ups between 1 7 and 4 2 are achieved the wave models and the interpolation method are released open source to the public keywords wave structure interaction potential viscous flow coupling swense two phase flow spectral wave models 1 introduction the accurate prediction of wave structure interactions is of vital importance in ship hydrodynamics and ocean engineering for ocean going vessels the wave induced loads are essential for analyzing ships seakeeping property the resistance in waves and the structural integrity in extreme sea states in ocean engineering the calculation of wave structure interaction helps to optimally design offshore structures for example oil and gas facilities or marine renewable energy devices traditionally water waves and wave structure interactions are addressed with single phase potential theory pt with the inviscid and incompressible fluid and irrotational flow assumption thanks to the irrotational flow assumption the velocity vector 3 variables in 3d cases can be represented by a scalar the velocity potential hence the complexity of the problem is much reduced many highly efficient wave models including the simplest 1st order stokes wave theory stokes 2009 to more complex fully nonlinear models ducrozet et al 2016 rienecker and fenton 1981 are established with basis functions derived from pt and can solve wave propagation in idealized periodic or rectangular domains to take into account realistic bathymetry and to solve wave structure interactions numerous numerical methods have been developed to solve the velocity potential discretely the boundary element method bem babarit and delhommeau 2015 newman and lee 2002 yeung 1982 is the prevailing method the merit of bem is that its variables only locate on the boundaries so the complexity of the problem is reduced by one dimension however a dense matrix has to be solved which sets a limit on the number of elements can be treated by the bem for larger problems volumetric method solving a sparse matrix can be used such as the finite element method fem ma and yan 2006 the finite difference method fdm bingham and zhang 2007 the finite volume method fvm mehmood et al 2015 the harmonic polynomial cells hpc shao and faltinsen 2014 however due to the irrotational assumption pt fails in complex scenarios such as flow separation around structures and wave breaking in contrast computational fluid dynamics cfd solvers based on ns equations have a more sophisticated mathematical model and accept rotational flow moreover cfd solvers offer more possibilities to deal with the moving water air interface for example the two phase flow can be modeled in the same solver chen et al 2014 iafrati et al 2001 queutey et al 2016 so that violent free surface deformations can be treated numerous validations have confirmed that cfd s capacity to provide high fidelity results for marine and offshore applications stern et al 2013 however cfd solvers demand higher computational cost than pt solvers a recent blind test ransley et al 2019 reveals a comparison between several cfd and pt solvers on a wave structure interaction with an intermediate wave steepness without wave breaking and concludes that even the quickest cfd code is 1 5 orders of magnitude slower than a fem pt solver in that non violent wave case but the authors of ransley et al 2019 also admit that cfd solvers may win the comparison when the non breaking and irrotational conditions of pt are violated i e when the wave becomes steeper to summarize both pt and cfd have advantages and limits if they can be coupled appropriately one can expect the resulting method to benefit from both sides in the literature this idea has been explored by many researchers among others two main coupling strategies are commonly used i e domain decomposition dd and functional decomposition fd dd splits the computational domain into a potential region and a viscous region and in each region uses the appropriate solver with the best efficiency and accuracy from a physical point of view the complex interaction e g viscous effects and violent free surface deformation appears near the structure only in the far field the viscous effects can often be neglected allowing the use of potential theory for this reason the computational domain can be split into a viscous inner sub domain plus an irrotational outer sub domain information is exchanged on the common boundary either in a two way interactive fashion or a one way forcing manner for two way coupling the most common practice is to couple a pt solver and a reynolds averaged navier stokes equation ranse solver if the structure does not induce wave breaking both pt and ranse solvers can be single phase solvers as in campana et al 1995 chen and lee 1999 zhang et al 2013 when the waves near structure are more violent two phase ranse solvers are more suitable but in the far field single phase pt solver can still be used as shown in lu et al 2017 siddiqui et al 2018 in extreme violent free surface deformation cases such as dam breaking both pt and ranse solvers should be two phase as in colicchio et al 2006 generally the above mentioned studies have confirmed the two way coupling s capacity in reducing the size of the cfd domain but the reduction of computational time has not yet been confirmed since the two way coupling introduces extra iterations between the pt and the cfd solvers alternatively the one way manner sends information from the pt to the viscous cfd solver only the pt solver considers the wave propagation in the far field until the inner zone the inner cfd zone then uses this information as wave making boundary conditions this method has been applied for shoaling and breaking wave problem in near shore areas grilli et al 2004 guignard et al 1999 lachaume et al 2003 calculation of wave force on offshore structures chen et al 2014 christensen et al 2009 paulsen et al 2014 a general one way coupling method to combine potential wave theories and two phase viscous solvers with the relaxation zone method has been proposed in openfoam and has been widely used by the offshore and coastal engineering community jacobsen et al 2012 however the one way coupling needs a larger computational domain to avoid wave reflection at the boundaries li et al 2019 and thus the number of grid cells is still large as a fine spatial resolution has to be employed in the far field to propagate the incident waves the second category fd splits the total flow problem into i an irrotational part to be solved with pt solvers and ii a complementary part to be solved by cfd codes dommermuth 1993 since such a decomposition is not unique multiple choices exist in the literature which can be classified into two categories according to the complexity of the irrotational part in ref edmund et al 2013 kim et al 2005 rosemurgy et al 2016 the authors proposed a complementary rans method that solves a general fluid structure interaction problem by using firstly a pt solver for the irrotational solution and then correct the solution with a rotational part calculated with a cfd solver with test cases using uniform single phase inflow without free surface it has been found that this strategy allows the cfd solver to employ coarse mesh in the far field and to reduce the computational cost for wave structure interactions ref ferrant et al 2003 proposed a more simple and direct decomposition strategy called the spectral wave explicit navier stokes equations swense method in the swense method the pt solves for the incident waves only and all the rest phenomena are solved by the cfd solver the essential benefits of this incident and complementary decomposition strategy are i it provides fast and accurate incident waves with pt wave models ii the pt solves only incident waves and thus will not fail due to complex flow phenomenon induced by wave structure interactions iii it allows the cfd solver to employ coarse mesh in the far field for the incident wave propagation with only a locally refined region near the structure to solve complementary field accurately the original swense method is proposed only for single phase cfd solvers it has been successfully applied to calculate wave force on vertical cylinder li et al 2017 on a catenary anchor leg mooring buoy monroy 2010 and ship resistance in waves reliquet et al 2013 zhang et al 2000 in the single phase scenario the use of coarser mesh reduced the cpu time of the swense method by one order of magnitude compared with conventional ns solvers for an equivalent accuracy luquet et al 2007 recently the swense method has been extended for two phase cfd solvers vukčević et al 2016 however ref vukčević et al 2016 adopts an fd strategy different from the original swense method which leaves the pressure field not decomposed consequently the use of coarse mesh in the far field may introduce errors to the incident pressure field and consequently to the incident waves losing the advantage of the swense method this point will be discussed in detail in sect 2 4 3 in this paper we present a novel extension of the swense method for two phase viscous cfd solvers which keeps all advantages of the original method i e the ability to use a coarse mesh in the far field to enhance the efficiency moreover coupling two phase cfd solvers with swense enables the method to deal with violent free surface deformations such as breaking waves near the structure secondly the paper also proposes an accurate and convenient reconstruction method to interpolate the results of high order spectral hos wave models onto cfd mesh the method can reduce the divergence error of the interpolated velocity field to meet the cfd solver s need without reprojection implemented in openfoam the validity and efficiency of the proposed methods are assessed thanks to three convincing cases including the simulation of progressive regular waves the calculation of high order loads on a vertical cylinder in regular waves and a catenary anchored leg mooring calm buoy in regular and irregular waves the rest of the paper is organized as follows section 2 derives the two phase swens governing equations section 3 presents the fully non linear spectral wave models for incident wave modeling and proposes the reconstruction technique to interpolate the results of hos wave models onto cfd mesh section 4 details the numerical discretization and an implementation example of a two phase swense solver in openfoam openuser guide http 2018 the validation and application cases are shown in sect 5 2 governing equations of the two phase swense method 2 1 swense decomposition the swense method ferrant et al 2003 2008 defines three notions in a wave structure interaction 1 total field the total field represents the real flow including the incident waves the scattered waves and viscous effects caused by the wave structure interaction it is assumed that the flow is governed by the incompressible ns equations 2 incident field the incident part concerns the propagation of the incident waves in the computational domain without structures the viscosity is neglected the flow is described by the euler equations it is further assumed that the flow is irrotational so that incident waves can be solved by pt wave models 3 complementary field the complementary part represents the difference between the total field and the incident field this field is generated due to the presence of structures in the computational domain and the viscosity of the fluid the complementary variables are governed by the swens equations with these notions a primitive field of the flow χ pressure velocity is decomposed into an incident part χ i and a complementary part χ c see eqn 1 χ i is explicitly given by pt wave models χ c is to be calculated by the cfd solver implementing the swens equations in the following contents variables without subscript denote the total field subscript i denotes the incident part and subscript c denotes the complementary part 1 χ χ i χ c in fig 1 a v shape illustrates how the swens equations are derived with the functional decomposition and how the total field is reconstructed the left half of this v shape shows the derivation procedure of the swens equations assuming the navier stokes equations the first row and the euler equations the second row have the same definition zone we can subtract the euler equations from the ns equations the swens equations the third row is obtained by writing the remainder with the variable χ c on the right half the complementary field χ c is added to the incident solution χ i to reconstruct the total solution χ see fig 2 2 2 derivation of two phase swens equations the two phase swens equations are derived following the swense decomposition procedure in fig 1 with the two phase ns equations and the euler equations 2 2 1 two phase incompressible navier stokes equations in the present work the immiscible air water flow with a deformable common interface is considered as incompressible and viscous the definition zone contains both water and air the volume of fluid vof method hirt and nichols 1981 is used for interface capturing the method is chosen among others for its advantage of mass conservation the vof field α is used to represent the volume fraction of water it is transported by the total velocity field u with the following equation 2 α t u α u r α 1 α 0 where u u v w is the fluid velocity and α 1 α u r is an artificial compression term to avoid the interface smearing with u r the compression velocity albadawi et al 2014 rusche 2003 a sharp interface is approximated with α 0 5 the density ρ and the molecular viscosity μ are phase dependent and are defined as 3 ρ ρ w α 0 5 ρ a α 0 5 and 4 μ μ w α 0 5 μ a α 0 5 with subscriptions w and a representing water and air respectively this kind of definition has been used in the literature abadie et al 2010 jasak et al 2019 despite its simplicity it shows adequate accuracy in the present work while other more accurate techniques such as plic scardovelli and zaleski 1999 can be considered in the future the flow is described by incompressible ns equations 5 u 0 6 u t u u p ρ g μ μ t u u t ρ where p is the total pressure g is the gravitational acceleration μ t represents the turbulent viscosity obtained from reynolds averaged turbulence models with the boussinesq assumption eqn 6 neglects the surface tension since it is small in classical marine and ocean engineering applications 2 2 2 euler equations for incident water waves the incident waves are modeled as a single phase flow the water free surface is considered as a moving boundary see fig 3 and is defined by a time dependent free surface elevation function as follows 7 z η i x t where x x y it assumes η i is a single valued function and the application is consequently limited to non breaking incident waves neglecting the viscosity of water the flow beneath the free surface is modeled with the incompressible euler equations as follows 8 u i 0 9 u i t u i u i p i ρ i g where the subscript i represents incident field the density ρ i is equal to the water density since the equations are defined only in water the boundary conditions are 10 η i t u i η i x v i η i y w i 0 a t z η i x t on the free surface 11 p i 0 a t z η i x t on the free surface 12 w i 0 a t z h on the seabed with u i u i v i w i and x x y 2 2 2 1 extension of the definition zone it is worth noting that the definition zone of euler equations is different from that of two phase ns equations consequently the former must be extended to apply the same swense decomposition in both water and air the extension technique will be presented in sect 3 3 herein please just assume the euler equations and their solution have the same definition zone as that of the two phase ns equations i e in the whole air and water domain 2 2 3 two phase spectral wave explicit navier stokes equations the two phase swens equations are derived by subtracting the euler equations from the two phase navier stokes equations 2 2 3 1 continuity equation using the continuity equation of ns equations eqn 5 minus the that of euler equations eqn 8 yields 13 u u i 0 with the notation of u c u u i the continuity equation using the complementary variable reads 14 u c 0 2 2 3 2 momentum equation the momentum equation should also be derived by subtracting the momentum equation of the euler equations eqn 9 from that of the navier stokes equations eqn 6 however the direct use of eqn 9 causes stability problems in the air see appendix a for this reason a density weighted pressure p i is designed as 15 p i ρ ρ i p i where ρ is the density of the two phase flow and ρ i is equal to the water density eqn 9 written in its modified version by using p i reads 16 u i t u i u i p i ρ p i ρ i ρ ρ g subtracting eqn 16 from eqn 6 and using the notation of p c p p i the two phase swense momentum equation written with the complementary variables is obtained as 17 u c t u u c u c u i p c ρ p i ρ i ρ ρ μ μ t u u t ρ by comparing eqn 57 in appendix a and eqn 17 it is clear that the density weighted pressure p i is a key element of the two phase swens equations we now simplify the viscosity term by separating the molecular and turbulent terms looking at the molecular terms first we can decompose it into incident and complementary terms 18 μ u u t μ u i u i t μ u c u c t continue to simplify the incident part using u i 0 and u i 0 since the incident velocity field is incompressible and irrotational we have 19 μ u i u i t 2 μ u i t 2 μ u i u i μ 2 u i μ the turbulence viscosity can be also simplified in the same way the resulting equation is 20 u c t u u c u c u i p c ρ p i ρ i ρ ρ μ μ t u c u c t ρ 2 u i μ ρ 2 u i μ t ρ it worth noting that in eqn 20 two source terms have non zero values only on the air water interface i e p i ρ i ρ ρ and 2 u i μ ρ the first suggests a restoring force proportional to the density gradient the second represents a viscous dissipation at the interface which is proportional to the molecular viscosity gradient the second term is neglected since it is several orders of magnitude smaller moreover the turbulence stress on the incident wave part 2 u i μ t ρ is assumed to be zero because the reynolds stresses arising from an irrotational field have no effect on the mean velocity field pope 2000 the final simplified momentum equation reads 21 u c t u u c u c u i p c ρ p i ρ i ρ ρ μ μ t u c u c t ρ 2 2 3 3 vof equation the vof field is not decomposed as other variables because it is challenging to consider the boundedness in the decomposition i e it is not straightforward to define an incident vof field α i and a complementary vof field α c and to keep 0 α i α c 1 instead the total vof field is transported with the reconstructed total field u u i u c using eqn 2 the authors are aware that in this step transporting vof field with a given velocity field the proposed method introduces numerical errors as large as convectional two phase vof ns solvers and thus may restrict the accuracy of the present method when using coarse mesh however the mesh requirement of an accurate vof convection is often not as demanding as for the momentum equations see appendix 8 using 15 cells per wave length can already provide adequate accuracy decomposition approaches can be used on other approaches such as the decomposed level set dls reliquet 2013 vukčević et al 2016 appendix 8 also provides a comparison between vof and dls 2 3 boundary conditions the boundary conditions bcs of the complementary field are derived from the boundary conditions of the total fields with the same physical significance table 1 shows some commonly used bcs in the swense method with their equivalence in navier stokes equation nse for far field and the non slip wall boundary condition the bcs of nse and swense are mathematical equivalent the pressure bcs are not given as they should be calculated to ensure the fixed velocity bc the far field bc is applied to the outer boundaries assuming that the fluid motion is equal to the incident waves i e the complementary field vanishes because the wave amplitude decay with 1 r r is the distance from the structure the no slip wall bc is used on the body for a fixed body the total velocity on the wall u 0 thus in swense u c u i the atmosphere boundary is the upper limit of the computational domain in two phase flow simulation which is connected to the atmosphere in nse such boundary condition is imposed by the atmosphere pressure p 0 and assumes the gradient of velocity u is equal to zero the strict equivalence is p c p i however the p i is small by definition in the air eqn 15 for simplicity we impose p c 0 and assume the gradient of u c is zero 2 4 discussion 2 4 1 relation with ns equations the given swense equation can regress to the ns equations when the incident solution is set to be calm water i e eqn 21 in the two phase swense momentum equation is equivalent to eqn 6 in the two phase ns equations if the incident wave part is explicitly given as no waves to prove that one can let the incident wave field be zero i e 22 u i 0 and thus the incident pressure is equal to the hydrostatic pressure 23 p i ρ i g z thus eqn 21 can be written as 24 u c t u u c p c ρ g z ρ ρ μ μ t u c u c t ρ transforming this equation with the relations below 25 u c u u i u 26 p c p p i p ρ g z yields eqn 6 showing that the swense momentum equation eqn 21 can regress to the two phase ns equation eqn 6 if there are no incident waves 2 4 2 keeping incident solution with coarse mesh the second property is to preserve exactly the incident wave solution throughout the domain when no structure is present regardless of the mesh used in the case of pure incident wave simulation the initial values of the complementary fields are zero i e 27 u c x t 0 0 28 p c x t 0 0 the second term on the r h s of eqn 21 is equal to zero in the entire computational domain 29 p i ρ i ρ ρ 0 because at the incident free surface elsewhere p i 0 non zero ρ non zero 0 p i ρ i ρ ρ 0 using the above conditions eqn 21 is simplified to 30 u c t 0 showing that complementary velocity fields u c remains zero in this condition the pressured field p c also remains zero after solving the pressure poisson equation as a result eqn 21 preserves the kinematics of the incident waves 2 4 3 main differences from vukčević et al vukčević et al 2016 another two phase swense method has been introduced early by vukčevićet al vukčević et al 2016 with different characteristics with the method proposed here these differences are presented as follows the first and the fundamental difference is that in reference vukčević et al 2016 terms containing incident wave information are not simplified with known relations from pt for example the continuity equation reads 31 u c u i although the r h s is equal to zero in the wave theory reference vukčević et al 2016 evaluates it by the cfd solver to consider the errors coming from the spectral solution techniques the interpolation of incident wave velocity on the cfd mesh reference vukčević et al 2016 emphasizes the necessity to correct these errors with the complementary field however in the present work we choose to drop off these errors and cancel out the r h s term with the theoretical relation u i 0 for incompressible flow the reasons for this choice are the pt methods are accurate for water wave problems the numerical error resides in a converged spectral potential flow result is often negligible compensating this error by cfd solvers is not beneficial because this correcting step may introduce larger numerical errors itself the interpolation of incident field on cfd mesh is improved in this work see section 3 2 so that the numerical error related to the interpolation procedure is drastically reduced the numerical evaluation of the incident quantities requires fine cfd discretization to be accurate this is not consistent with the objective of the swense method i e to use coarse mesh for the incident wave propagation problem similarly the momentum equation in reference vukčević et al 2016 is not simplified either with the analytic relation provided by the euler equations it reads 32 u c t u u c ν 2 u c u i t u u i ν 2 u i β p d where ν is the kinematic viscosity and β 1 ρ this treatment also prevents the use of coarse mesh for incident wave propagation because coarse mesh even only used in the far field generates errors on the r h s of eqn 32 and results in spurious complementary fields that interfere with incident waves in contrast the present work cancels out these terms with analytical relations so that the numerical errors can be avoided as shown in sect 2 4 2 the second difference is that reference vukčević et al 2016 uses the decomposed level set dls method to capture the interface instead of the standard vof not decomposed here appendix 8 compares both methods on a pure convection case i e the interface capturing function is transported by the incident wave velocity the results demonstrate that the dls is not more advantageous than the vof in the present second order accurate finite volume framework 3 incident wave modeling this section describes how to obtain the incident wave solution by potential flow solvers spectral wave models the theoretical part will show that for the swense method the spectral wave models are superior to other pt methods because they can extend the incident wave fields above the free surface easily the influence of such an extension in the air is also discussed in this section to show its influence on the total field an accurate and efficient technique to interpolate the incident wave fields on arbitrary cfd mesh is also proposed in this section 3 1 potential flow theory and spectral solution techniques by further assuming the incident wave velocity is irrotational the euler equations can be solved efficiently and accurately dean and dalrymple 1991 with pt such an assumption allows to reduce the number of unknowns in the euler equation by defining a scalar field φ called velocity potential or potential so that 33 u i φ using φ the euler equations are written in an equivalent form as follows 34 δ φ 0 laplace s equation 35 η i t φ x η i x φ y η i y φ z 0 a t z η i x t free surface kinematic condition 36 φ t 1 2 φ 2 g z 0 a t z η i x t free surface dynamic condition 37 φ z 0 a t z h seabed boundary condition in the present work spectral methods are used to solve this non linear potential flow problem with high accuracy and efficiency these methods decompose the free surface elevation η i x t and the velocity potential φ x z t using a set of basis functions an example in a 2d uni directional wave case is shown as follows 38 η i x t i 1 m a i η t ψ i x 39 φ x z t i 1 n a i φ t cosh k i z h cosh k i h ψ i x where a i are the modal amplitudes k i are the basis wave numbers and ψ i x are the horizontal basis functions sine and cosine functions or their complex exponential equivalents with these basis functions eqn 39 satisfy automatically the laplace s equations and the seabed boundary condition eqns 34 and 37 the free surface boundary conditions eqns 35 and 36 discretized on uniformly distributed points on the free surface are used to establish a linear system to determine the modal amplitudes a i η t and a i φ t after the potential φ is obtained the velocity field u i is calculated with eqn 33 and the pressure field is obtained with the bernoulli equation 3 1 1 regular waves stream function theory for 2d regular nonlinear waves the algorithm proposed by rienecker fenton rienecker and fenton 1981 based on the stream function theory is adopted cn stream 2019 ducrozet et al 2019 this algorithm solves 2d progressing regular waves over a horizontal seabed for a wide range of depths amplitudes and wavelengths the free surface elevation and the velocity potential are decomposed with basis functions as shown in eqns 38 and 39 the basis function ψ i x is replaced by ψ i x c t with c the phase velocity to make the modal amplitudes a i η and a i φ independent of time these amplitudes are solved from a linear system established with the kinematic and the dynamic boundary conditions eqns 35 and 36 the reader can find more information in references rienecker and fenton 1981 3 1 2 arbitrary waves high order spectral method the high order spectral hos method dommermuth and yue 1987 west et al 1987 is adopted for arbitrary unsteady wave propagation 2d or 3d hos considers the full non linearity of the free surface and exhibits high efficiency and accuracy thanks to its pseudo spectral formalism in this work two well validated open source solvers developed at lheea lab ecole centrale nantes and cnrs hos ocean high order spectral metho 2018 ducrozet et al 2016 and hos nwt numerical wave tank based 2018 ducrozet et al 2012 are used to solve arbitrary incident waves in open sea and experimental wave tanks respectively 3 2 reconstruction of incident wave information on the cfd mesh the reconstruction step transforms the results of spectral wave models onto the cfd mesh for example in a 2d case the velocity potential φ is stored as the modal amplitudes a i φ t in eqn 39 with these modal amplitudes the potential φ can be reconstructed and the velocity can be further calculated by evaluating the derivatives of the potential eqn 33 as follows 40 u i x z t i 1 n a i φ t j k i cosh k i z h cosh k i h ψ i x 41 w i x z t i 1 n a i φ t k i sinh k i z h cosh k i h ψ i x the velocity can be obtained by substituting the coordinates x z and the time t into the above equations this reconstruction method is referred to as analytical evaluation method hereafter the computational cost at each cell location and at each timestep is proportional to the number of fourier components for the stream function wave theory the number of fourier components are n o 10 whereas the hos method typically needs 100 to 1000 fourier components in a single direction for an irregular wave train as a result the analytical evaluation is very time consuming for hos waves instead an interpolation method is used the modal results are first transferred on a series of space points with the inverse fast fourier transform ifft algorithm and then interpolated to the cfd cells in this section the analytical evaluation and the interpolation method are explained in the first two subsections the third subsection focuses on the reconstruction error and its consequences the last subsection proposes a new interpolation technique to improve the interpolation accuracy for simplicity only the velocity field is shown as an example the pressure field can be reconstructed similarly 3 2 1 analytical evaluation for the stream function wave theory for regular waves obtained with the stream function wave theory the analytical evaluation method is applied since the number of fourier components is small for example a regular wave with a moderately large steepness k a 0 24 converges with only 9 fourier components n 9 3 2 2 interpolation for the hos waves the interpolation procedure ducrozet 2007 to reconstruct the hos results on cfd cells firstly reconstructs the wave information on a coarse rectangular hos grid via ifft and then interpolates it on the cfd mesh compared to the analytical evaluation the efficiency is much improved by the ifft algorithm this procedure can be divided into two steps 1 ifft this step translates the spectral information in the spatial domain via ifft after the ifft the wave information is available on uniformly spaced points the number of points is equal to the number of fourier modes n used in the hos computation the distance between two points is equal to the shortest wave length of the basis function 2 π k n take a 2d case as an example for the free surface elevation η i x t ifft transforms a i η to n uniformly distributed points in the x direction see fig 4 the velocity field u i x z t is reconstructed similarly but since the velocity field also depends on the vertical direction z several iffts are used each ifft transforms a i φ to the velocity at n horizontally uniformly distributed points with a given vertical position z after this reconstruction the velocity field is available on a coarse rectangular grid referred to as the hos grid hereafter with several horizontal layers each horizontal layer contains n uniformly distributed points note the vertical position of these layers can be given arbitrarily so that a vertical refinement is possible in contrast horizontal refinement cannot be done directly since the number of points n is equal to the number of modes in the hos calculation 2 interpolation the incident wave information is interpolated from the hos grid onto the cfd mesh as the hos grid is usually different from a cfd mesh for example a typical hos simulation uses 10 points per peak wave length while cfd solvers usually use around 100 cells fig 5 interpolated a comparison of a typical hos grid on the left and a cfd mesh on the right the figure is colored by the velocity magnitude the result on the cfd mesh is interpolated from the hos grid behind it with the cubic spline scheme an example of the interpolation result is shown in fig 6 the vof field on the top is reconstructed from the free surface elevation η i the velocity field is shown at the bottom the waves are simulated by hos ocean jonswap wave spectrum with t p 0 7 s h s 0 028 m γ 3 3 the hos simulation domain contains 10 peak wave lengths l x 10 λ p with 128 fourier components n 128 3 2 3 reconstruction error velocity divergence this section analyzes the reconstruction error represented by the velocity divergence u i the physical significance of the velocity divergence is the volume change rate its unit is s 1 having u i a s 1 means that the fluid will have a relative volume change of a in 1 s if the reconstruction is accurate the velocity divergence is equal to zero because the flow is incompressible the vof method is very sensitive to the velocity divergence because the boundedness of the vof field requires a divergence free velocity field such an error finally leads to instabilities in the simulation in the present work the velocity field is reconstructed on finite volume mesh the divergence is then calculated by 42 u i f u i f a f δ v where f represents the cell faces u i f represents the face averaged incident velocity a f the surface vector of the cell face f and δ v the volume of the cell it may contain numerical errors coming from 1 approximating the face averaged value by the face center value u i f u i x c f where x c f is the face center coordinates 2 evaluating u i x c f by interpolation in the interpolation method the first source of error is due to the use of the second order finite volume method which affects both the analytical evaluation and the interpolation method and is often negligible in contrast the second source of error is usually much larger fig 7 shows the divergence error of the interpolated velocity field of fig 6 the cfd mesh is discretized with δ x δ z λ p 100 h s 20 the vof field transported by this velocity field after one wave period is shown in fig 8 its values are no more bounded by 0 and 1 this problem suggests the necessity to improve the interpolation accuracy 3 2 4 improvement of the interpolation accuracy the main source of inaccuracy in the interpolation is the large space interval between hos points refining the hos grid is definitively helpful to reduce the interpolation error however using a grid as refined as a cfd mesh directly in the hos computation is not feasible since it introduces too many very short waves and may make the computation unstable ducrozet et al 2017 to overcome this difficulty we propose a refinement at the postprocessing stage the method takes any hos simulation result as input and allows to refine the grid to a user defined level this refinement is achieved with a zero padding step in the spectral domain before the ifft see fig 9 after reading the amplitudes of fourier components from an hos result the method extends the spectrum by adding extra modes with zero amplitude at the end according to the relation between the spectral and the spatial domain in the fft algorithm additional fourier components result in extra spatial points i e if the spectrum is extended n times the distance between two hos points can be reduced to 1 n note that the factor n has to be an integer to end up with the original spatial points plus n 1 additional points between two original points in this way the incident result is available on a finer grid and the interpolation error is reduced consequently although more points are added the efficiency is still greatly enhanced compared to the analytical evaluation since this method still relies on the ifft to demonstrate the improvement in the interpolation accuracy the divergence of the hos velocity reconstructed by the zero padding method is shown in fig 10 the same cfd mesh and the same hos simulation results are used as in fig 7 the zero padding method transfers the modal information on 512 reconstruction points by extending the fourier modes by a factor of 4 compared to fig 7 the divergence error is reduced by 2 orders of magnitudes this level of accuracy appears to be enough in our experience to convect the vof field in a stable way compare fig 11 to fig 8 3 2 5 code availability this reconstruction technique is included in the open source library grid2grid grid2grid 2018 choi et al 2017 this library is developed by the lheea research department ecole centrale nantes and cnrs to connect any cfd solver with hos ocean ducrozet et al 2016 grilli et al 2004 and hos nwt numerical wave tank based 2018 ducrozet et al 2012 two open source hos wave solvers the library is published with the gnu general public license v3 0 and can be downloaded from the url https github com lheea grid2grid 3 3 extension of incident wave solution in the air the two phase swense method requires the incident solution both in water and in air however the wave model only defines the incident solution under the incident free surface position to obtain the information above the free surface the incident solution is extended by using eqn 37 which gives an incident solution even above the free surface fig 12 gives an example of the extended velocity field of a regular wave the white line represents the free surface position of the incident wave it is worth noting that the extended solution still satisfies the euler equations eqns 8 and 9 this property of the spectral method helps the swense method to adjust the definition zone of the incident wave so that the same functional decomposition can be used in the entire cfd computational domain this direct extension results in a smooth transition across the free surface which is beneficial numerically the drawback of such an extension is an oscillating incident wind field in the air by using the boundary conditions given in table 1 this oscillatory wind remains in the total field although it is possible to correct this unrealistic phenomenon for example by using no slip bc on the top such correction requires extra computational cost in the air which goes against the objective to reduce cpu time in the present work we accept this oscillatory wind as a side effect of the swense decomposition in the air without any special treatment since in most classical wave structure interaction problems the air effects are often very weak as it will be verified in sect 5 4 implementation in openfoam the present work uses the open source cfd package openfoam 1 1 https openfoam org to implement the proposed method openfoam uses the second order finite volume method fvm with unstructured polyhedral meshes all the variables are located at the cell center its native two phase solver interfoam adopts the vof method hirt and nichols 1981 and the multi dimensional limiter for explicit solution mules algorithm deshpande et al 2012 the pimple algorithm openfoam 1906 which combines the pressure implicit with splitting of operator piso and the semi implicit method for pressure linked equations simple versteeg and malalasekera 2007 is used to obtain converged results of the velocity pressure vof coupling at each time step the readers are referred to deshpande et al 2012 ubbink and issa 1999 for more details of interfoam the marine hydrodynamics community of openfoam has developed codes based on interfoam by adding wave modeling techniques e g waves2foam jacobsen et al 2012 foamstar monroy et al 2016 etc the proposed two phase swense method is implemented on top of foamstar monroy et al 2016 developed by bureau veritas and ecole centrale nantes the new solver is named as foamstar swense the only difference between the two solvers is that the ns equations in foamstar are replaced by the swens equations in foamstar swense 4 1 equations discretization this section briefly describes how the governing equations are discretized standard schemes in openfoam are used as listed in the end of the section more details of these schemes can be found in the literature ferziger and peric 2012 moukalled et al 2016 for convenience the sign is used to indicate that the terms enclosed are treated implicitly otherwise the terms are evaluated explicitly 4 1 1 vof equation the discretization of eqn 2 is standard as in interfoam 43 α t u α α 1 α u r 0 the mules algorithm deshpande et al 2012 is used to keep the boundedness of the α field 4 1 2 momentum equation eqn 21 rewritten in its conservative form is discretized as follows 44 u c t u u c u c u i μ e f f u c μ e f f u c t ρ p c ρ p i ρ i ρ ρ where μ e f f μ μ t the time derivative the convection and the diffusion terms of the u c are discretized implicitly the rest terms are explicitly evaluated note that the r h s terms are evaluated with a reconstruction operation from face flux openfoam 2019 to introduce a pseudo staggered grid setup and to avoid checker board pressure oscillations that may occur on co located grids for example p c ρ is evaluated at the cell face p c f ρ f and reconstructed to the cell center the pressure p c f at the cell face is directly calculated with the pressure at the two neighbor cell centers the face density ρ f is interpolated as 45 ρ f ρ w δ x w ρ a δ x a δ x w δ x a where δ x w and δ x a denote the distance of cell center to the interface of water cell and air cell respectively this interpolation scheme mimics the ghost fluid method for two phase incompressible flow lalanne et al 2015 p i ρ i ρ ρ is evaluated similarly eqn 44 written in a semi discretized form for a cell p reads 46 a p u c p n a n u c n s p c ρ p i ρ i ρ ρ where the subscript p and n represent the value of the current cell and the values of its neighbors the coefficients of the discretized system are a p and a n s represents the source terms in the discretized equation except for the complementary pressure term and the interface term in openfoam the solution step of eqn 46 is called the momentum prediction it provides a momentum conserving velocity field u c however the result of the velocity prediction does not guarantee the incompressibility of the field a correction is necessary via the pressure equation step 4 1 3 pressure equation the discretized pressure equation in the swense solver is derived in the same way in as in standard incompressible flow openfoam solvers the semi discretized form of the momentum equation eqn 46 as follows 47 a p u c p h u c p c ρ p i ρ i ρ ρ where is the diagonal contribution of eqn 46 is the contribution of the complementary pressure gradient is the contribution of interface density gradient is the off diagonal contribution of the matrix and the source terms s in eqn 46 48 h u c n a n u c n s from eqn 45 the complementary velocity at the center of the cell is 49 u c p h u c a p 1 a p p c ρ 1 a p p i ρ i ρ ρ interpolating this value to the face center yields 50 u c f u c h u c a p 1 a p p c f ρ f 1 a p p i f ρ i ρ f ρ f where the symbol denotes the value on the cell face which is linearly interpolated from the cell center of both sides substituting eqn 50 into eqn 14 the discretized pressure equation is written as 51 1 a p p c f ρ f h u c a p 1 a p p i f ρ i ρ f ρ f this poisson equation is used to determine the complementary pressure field and to correct the complementary velocity flux at last the flux is used to reconstruct the cell centered u c 4 1 4 discretization schemes the discretization schemes are listed in table 2 the time derivative is discretized with second order crank nicolson scheme and blended with first order euler implicit scheme to compromise between the accuracy and the stability spatial schemes are also 2nd order in general but first order schemes will be used locally to avoid over shoots or under shoots 4 2 prevention of wave reflections with the relaxation zone technique the present method adopts the relaxation zone technique jacobsen et al 2012 monroy et al 2016 to prevent wave reflections at the computational domain boundaries in the relaxation zones the complementary velocity field u c is gradually attenuated to zero and the vof field α is blended to the target value of incident wave field α i as follows 52 u c r e l a x ω 0 1 ω u c c f d 53 α r e l a x ω α i 1 ω α c f d with 0 w 1 the weighting factor the complementary pressure is not relaxed by this method as it is solved implicitly at each step 4 3 solution algorithm the structure of the swense solver is provided in the flowchart of fig 13 1 at the beginning of each time step incident wave properties u i and p i are updated from potential wave solvers and mapped on the cfd mesh the total velocity is reconstructed with u u i u c 2 solve for the vof field α eqn 43 update the fluid properties with the new vof field eqns 3 and 4 update the modified incident wave pressure p i with the new density field eqn 15 3 in the piso loop the complementary velocity field is solved from eqn 44 at first the momentum prediction step secondly the complementary pressure p c is solved from eqn 51 the flux of the complementary velocity is corrected by the pressure field p c after the correction the flux is used to reconstruct the complementary velocity field u c at the cell center the piso loop iterates until reaching the maximum iteration number user defined value set to 6 in the present cases 4 the solution is then blended to the target values in the relaxation zones to attenuate the complementary waves in the far field eqns 52 and 53 5 outer nonlinear iterations are made to achieve the convergence of the vof the velocity and the pressure before stepping to the next time the convergence criterion is that the residual of u c is reduced 3 orders of magnitude 5 validation and application in this section the two phase swense method is validated on three test cases progressive waves this test case consists simply in a simple regular wave propagation in a periodic domain no structure is present different discretizations are used to check whether a swense solver can keep incident waves accurate with coarse discretizations a comparison with the conventional ns solver foamstar is also provided high order wave loads on a vertical cylinder this case validates the method on the calculation of the wave force on a fixed structure with simple geometry the horizontal wave force on the cylinder is recorded up to fourth harmonic components are extracted and compared with experimental data and numerical results of potential flow solvers a systematic convergence study is also conducted fixed catenary anchored leg mooring calm buoy with a heave damping skirt in regular and irregular waves this configuration is used to assess the method with a complex geometry and includes violent free surface deformation and viscous effects representing a real ocean engineering application the results of foamstar swense are compared with experimental data for the regular wave case comparative simulations conducted with foamstar are used to demonstrate the efficiency and accuracy of the proposed method 5 1 progressive waves good quality of the incident waves is the first requirement for wave structure interaction simulations ns solvers e g foamstar which simulate the wave system with a direct method need fine meshes to propagate waves accurately instead incident wave propagation in swense solvers is much easier because the incident waves are explicitly given by wave models in a swense solver maintaining the accurate incident waves is nothing more than keeping the complementary field is equal to zero although such a property of the proposed two phase swense method has been demonstrated theoretically in sect 2 4 numerical errors may exist in cfd simulations therefore this case tests the real behavior of foamstar swense taking all the probable numerical errors into account the case simulates regular wave propagation in a 2d periodic domain periodic boundary conditions at inlet and outlet are used to get rid of the wave generation and absorption issues and to focus on the wave propagation the case is intentionally designed with a large computational domain and a long time duration to increase the numerical errors in order to test the stability and the accuracy of the method foamstar swense and foamstar are tested and compared with several identical spatial and temporal discretizations 5 1 1 test case setup regular waves with a moderately large wave steepness k a 0 22 are simulated the wave characteristics are listed in table 3 the stream function wave theory ducrozet et al 2019 rienecker and fenton 1981 is used to generate the reference solution and provide the incident wave information to foamstar swense the simulations use a two dimensional rectangular computational domain see fig 14 the waves travel from the left to the right periodic boundary conditions are applied on the left and the right boundaries the origin of the coordinate system is located at the left of the computational domain on the free surface position at rest the axis x points right and the axis z points up the length of the computational domain is equal to ten wave lengths λ and the height of the computational domain is equal to the water depth h plus 2 5 times the wave height h the simulation time is equal to 20 wave periods three sets of space and time resolutions are used see table 4 the medium discretization corresponds to the typical mesh used by two phase vof solvers for the wave structure interaction problems for foamstar swense the initial values of the complementary velocity field u c and the complementary pressure field p c are set to zero the vof field is set according to the stream function wave theory for foamstar the initial values of the velocity field u pressure field p d and the vof field α are set according to the stream function wave theory 5 1 2 numerical results the free surface elevation at the center of the domain is measured fig 15 plots the time evolution of the first and second harmonics the vertical axis is normalized by the reference stream function value the horizontal axis is non dimensionalized by the wave period the errors on the first harmonic are listed in table 5 every five periods foamstar swense fig 15 reveals that the first and the second harmonic amplitudes are well kept for the entire 20 wave periods with all the three discretizations the fine and the medium discretizations give very close results the coarse discretization produces results with slightly larger errors but still simulates the waves rather accurately table 5 confirms the above observations the three meshes have relative errors of 2 45 0 81 and 1 03 at t 20 t foamstar fig 15 suggests a more remarkable wave damping throughout the 20 periods with all the discretizations the loss of wave amplitude is of 18 97 6 68 and 2 45 for the coarse medium and fine meshes at t 20 t 5 1 3 discussion 5 1 3 1 numerical errors in two phase swense method although sect 2 4 2 proves that the swense method keeps the waves equal to the incident solution in theory the simulation results show a difference one reason for this contradiction is the error created when approximating the interface position by the contour of α 0 5 theoretically the complementary fields are kept zero in a pure incident wave propagation case because the free surface position the density jump coincides with the p i 0 contour incident free surface position however the present implementation defines the density jump at α 0 5 where p i is slightly different from 0 an error in p i ρ i ρ ρ of the momentum equation eqn 19 is introduced and generates a tiny spurious complementary field near the free surface even with refinement this error cannot be fully reduced to zero in the future better definition of the density jump can be considered with more advanced interface capturing methods to improve the result for now we satisfy with the method since it provides more accurate results than the ns solver as shown below 5 1 3 2 advantage in keeping incident waves over conventional solvers in fig 15 the results of foamstar show the well known numerical wave damping problem of two phase ns solvers choi et al 2020 monroy and seng 2017 and the wave damping is more severe with coarser discretizations for this reason the international towing tank conference ittc suggests more than 80 grids per wavelength when using 2nd order cfd codes for wave problems practical guideline 2014 for foamstar swense the results are very close to the reference value even with the coarse discretization moreover foamstar swense with the coarse mesh gives results as good as foamstar with the fine mesh showing that foamstar needs 4 times more refined discretization to achieve the same accuracy an obvious efficiency gain of the swense method is confirmed 5 2 high order wave forces on a vertical cylinder high order wave force on cylinders is a classical problem in offshore engineering despite their small amplitudes the high order wave forces may cause sudden structural vibration the so called ringing phenomenon since their frequencies are close to the natural frequency of the structure this problem has been addressed by numerous approaches in the literature including asymptotic analytical solutions faltinsen et al 1995 malenica and molin 1995 experiment huseby and grue 2000 and numerical simulations with fully nonlinear potential flow approaches ferrant 1996 shao and faltinsen 2014 therefore these well established reference data make this case very suitable for validation purposes the test case contains two following parts a convergence study in a rather steep wave condition k a 0 24 validation of the method with simulations covering eight different wave steepnesses 0 6 k a 0 24 5 2 1 test case setup the simulation reproduces the experiment in huseby and grue 2000 where a thin cylinder is exposed to regular waves in deep water see fig 16 the cylinder has a radius of r 0 03 m being fixed in the water tank of water depth h 0 6 m the incident wave frequency f is equal to 1 425 hz different wave amplitudes a are used in the experiment and the data are available for a series of wave steepnesses in the range of k a 0 03 0 24 for convenience a cylindrical mesh is used by the simulation instead of modeling the entire experimental wave tank see fig 17 the cylinder is located at the center at far field the complementary field is damped to avoid reflections this configuration represents an ideal experimental condition where no wave reflects back from the boundaries this kind of mesh is also used by the potential flow solvers producing the reference data ferrant 1996 shao and faltinsen 2014 the cylindrical mesh is also accurate and efficient for the swense method the mesh is fine near the center which helps to capture the complementary fields accurately near the structure coarse mesh in the far field helps to reduce the computational cost please note that ns solvers cannot use such a mesh since coarse far field mesh results in inaccurate incident waves a longitudinal symmetry plane is used the origin of the coordinate system coincides with the cylinder s center line and is located at the still water level axis x points to the incident wave propagation direction and axis z points upward along z axis the computational domain extends from the tank bottom at z h until z 5 a in the air in z direction the mesh is uniform near the air water interface z 1 5 a 1 5 a the cell size increases gradually out of this refined zone the domain s radius is equal to 2 wave lengths l r 2 λ the mesh is refined near the cylinder and gradually enlarged along the radius direction in the far field a relaxation zone with a length of l r e l a x 1 5 λ is used to absorb the complementary field leaving a pure cfd zone with one wave length diameter the setup of the relaxation zone follows the study in paulsen et al 2014 which shows a relaxation zone of at least 1λ long locating at least 1 6λ away from the structure is sufficient the setup is summarized in table 6 the maximum reynolds number r e 1 55 10 4 when the wave crest reaches the cylinder indicating the flow is between the laminar and transitional regime with a keulegen carpenter number k c 3 01 as a result no turbulence model is used no slip wall boundary condition is applied on the cylinder with under resolved boundary layer it is acceptable since the viscous force is very small compared to the pressure contribution 5 2 2 convergence study a systematic convergence study with six sets of temporal and spatial resolutions is conducted the time step and the mesh size in radial tangential and vertical directions are changed simultaneously the discretization details are summarized in table 7 this study uses the steepest wave case k a 0 24 in the experiment fig 18 shows the time histories of the inline force obtained with different discretizations the abscissa denotes the time t which is normalized by the wave period t it is observed that a periodic regime appears after two wave periods the bottom plot zooms in between the fourth and fifth periods the first observation is that the results are very close and converge with the refinement for a better comparison the time histories in the periodic regime are transformed to the frequency domain by the fast fourier transform fft the amplitudes of the first four harmonic components are summarized in table 8 following huseby and grue 2000 the harmonic amplitudes in the table are normalized using 54 f n f n ρ g r 3 r a n fig 19 shows the variation of the normalized harmonic amplitudes with the mesh refinement the abscissa represents the mesh 1 to 6 and is scaled by the number of cells per dimension again it is observed that results with different discretizations are very close showing that even the coarsest mesh can give a good prediction of force in the following the error estimation procedure proposed by eça and hoekstra 2014 is adopted to estimate the convergence rate and the converged value this procedure assumes that the discretization error is a power function of the mesh and time step size as follows 55 ε i φ i φ 0 α δ x p x β δ t p t where ε i is the discretization error of the simulation result φ i while φ 0 denotes the extrapolated exact solution of the mathematical equations δ x and δ t stand for the characteristic mesh and time step size p x and p t are the convergence order in space and time for each harmonic amplitude the five parameters φ 0 α p x β p t are determined by the method of least squares using the six discretization results the converged values φ 0 and the convergence order are listed in table 9 the results show a general convergence order between 1 and 2 which is coherent with the discretization schemes used in openfoam second order convective schemes with first order limiters table 10 presents the relative error for different mesh resolutions the relative error is defined with the following equation according to eça and hoekstra 2014 56 δ i φ i φ 0 φ 0 from table 10 it is observed that the first harmonic amplitude is predicted rather accurately even with the coarsest mesh 6 66 error this should be credited to the advantage of the swense method and the use of an optimal cylindrical mesh the swense method ensures a good incident wave allowing the use of coarse mesh in the far field the cylindrical mesh is refined near the structure so that it is always fine enough to calculate the first harmonic amplitude correctly higher harmonic components contain larger relative errors than that in the first harmonic component since the high order components are smaller and thus require finer discretizations to be captured accurately even so the accuracy with the coarsest mesh is still rather satisfying with a maximum relative error smaller than 20 for the finest mesh errors are so low that the convergence seems to saturate however one must remember here that it is a relative error to an estimated solution and not to an exact one so that errors of the order of a few percents do not represent the absolute accuracy of the method 5 2 3 steepness study in this part the wave force with eight wave steepnesses k a 0 06 0 08 0 10 0 13 0 15 0 17 0 20 0 24 are calculated with foamstar swense the mesh 4 of the previous section is used to make a compromise between the computational cost and the accuracy table 10 shows that this mesh achieves a rather small relative errors with only 0 67 million cells 1 8 of the finest mesh the mesh is adjusted in the vertical direction according to the wave steepness so that the number of cells per wave amplitude is the same the harmonic amplitudes and the phase shifts calculated by foamstar swense are compared with reference data in fig 21 from the top to the bottom the first to the fourth harmonic components the amplitudes are shown on the left and the phase shifts are shown on the right in each subplot the horizontal axis denotes the wave steepness the reference data include the third order analytical solution of malenica and molin 1995 referred to as analytical the experiment data reference huseby and grue 2000 referred to as exp two numerical results using fully nonlinear potential flow theory referred to as ferrant 1998 and shao et al shao and faltinsen 2014 to analyze these results the primary focus is put on the first harmonic amplitudes fig 20 a since it is dominant in general foamstar swense shows a very close agreement with experimental data this agreement suggests the accuracy of the proposed method in calculating the wave load when compared with the potential theory results of ferrant 1998 and shao et al shao and faltinsen 2014 foamstar swense shows also a good agreement at small wave steepness k a 0 1 for k a 0 1 foamstar swense is more accurate than the potential flow solvers since the two phase swense method is able to capture the flow separation and wake breaking near the cylinder see fig 21 where pt solvers encounter numerical difficulties li et al 2017 for the second harmonic amplitudes both foamstar swense and the experiment show the same decreasing trend when the wave steepness becomes larger the results are approximately 20 larger than the experimental data and are closer to experimental data than that of the potential flow solvers where they are available for the third and fourth harmonic amplitudes the comparison is better when the wave steepness is large for small wave steepness it is indeed more difficult because the magnitudes of the high order force are very small the oscillations appearing in the experimental data also confirm this difficulty for the phase shifts a good agreement is shown among the analytical solution and all the numerical results which are however different from the experimental data the reason for this discrepancy is still not clear shao and faltinsen 2014 but it may due to a setup slightly different in the experiment more specifically in consideration of the difference getting larger while the order increases it is possible that the beginning time of the experiment and the calculations are different to conclude this comparison demonstrates that the proposed two phase swense method is able to calculate the wave force on a simple structure for a large range of wave steepness the typical cylindrical mesh with coarse cells in the far field can be used to reduce the computational cost without influencing the accuracy 5 3 calm buoy in regular and irregular waves this part aims to demonstrate the ability of the two phase swense method in dealing with a more complex geometry and wave conditions geometry the catenary anchor leg mooring calm buoy rousset and ferrant 2005 contains a thin heave damping skirt violent free surface deformation and significant flow separation induced by such a geometry needs to be captured by the complementary field wave condition both regular and irregular wave conditions are used the irregular waves are obtained with hos nwt solver and reconstructed onto the cfd mesh to validate the reconstruction method proposed in sect 3 turbulence modeling the k ω sst turbulence model menter 1994 is used the non slip boundary condition is applied on the buoy with standard wall functions in openfoam liu 2016 in addition the accuracy and efficiency of foamstar swense and foamstar are compared in the regular wave condition the regular wave case and the experimental data have been published in a separated paper li et al 2019 to compare the mesh requirement of three different wave generation methods by using the wave forces and free surface elevations near the buoy in the present paper we compare also the instantaneous velocity field and the computational cost of both solvers in the following only the main configuration and results are recalled the reader can find a detailed description in reference li et al 2019 5 3 1 geometry and wave parameters the test case reproduces an experiment rousset and ferrant 2005 carried out in the ocean engineering basin of ecole centrale nantes 50 m long 30 m wide and 5 m deep the buoy is a truncated cylinder r 0 46 m with a thin skirt near the bottom to provide additional damping forces through vortex shedding see fig 22 regular and irregular wave conditions chosen from the experiment are listed in table 11 the irregular waves are generated with a jonswap spectrum with γ 3 the wave steepnesses are moderate and wave breaking is only expected near the buoy as a result of wave structure interaction 5 3 2 computational domain and meshes a cylindrical and three rectangular mesh configurations are used as shown in fig 23 the computational domain of all meshes is approximately the same with a longitudinal symmetry plane the cylindrical mesh is used by foamstar swense with the grid size gradually stretched in the far field however the cylindrical mesh is unsuitable for foamstar because the coarse cells in the far field deteriorate the incident waves for this reason a series of rectangular meshes are designed to compare foamstar and foamstar swense the grid resolution is presented in table 12 for the cylindrical case λ δ x and λ δ y represent the grid interval in the radial and the azimuthal directions in the far field please note that the rectangular meshes follow the common meshing strategy in uni directional wave cases i e the transverse direction is less resolved to reduce the number of cells near the buoy all the meshes have the same grid resolution the differences between the configurations in terms of spatial resolution are in the far field only 5 3 3 regular waves 5 3 3 1 comparison of the accuracy with wave forces after the periodic regime is established the forces are recorded during 7 wave periods the time history is transformed into the frequency domain the first and second harmonic amplitudes of the wave forces shown in table 13 are compared to show the accuracy of both solvers the forces are normalized with a k ρ g where a h 2 is the amplitude of the waves k the wavenumber and the displacement volume of the buoy at the designed draft the relative differences with respect to the experimental data are given in percentage in general both solvers provide consistent results with the experiment especially when the fine grid 80 is employed enlarging the grid space in the far field introduces larger errors however it is found that the results of foamstar swense are less sensitive to the far field mesh resolution than foamstar this difference can be found by comparing the first harmonic amplitudes of the horizontal wave force f x 1 x80 total cells 2 58 m the results of both solvers are in good agreement with the experiment foamstar gives slightly smaller predictions of the first harmonic amplitudes the foamstar swense result has a better agreement with the experiment x40 total cells 1 47 m foamstar swense is able to predict the wave force and elevation correctly with an accuracy of 1 whereas this difference is about 4 for foamstar x20 total cells 1 28 m this discretization is known to be too coarse to simulate waves in conventional ns solvers the coarse mesh causes excessive numerical diffusion and damps the incident waves for this reason foamstar predicts a force 13 5 smaller however foamstar swense s relative error is still within 2 5 cylindrical total cells 0 72 m this configuration is optimal for the swense method with only 0 72 million cells the results of foamstar swense is almost as accurate as the result of foamstar with 80 mesh 2 58 million cells for the first harmonic amplitude of the vertical waves force f z 1 a similar trend of convergence with mesh refinement can be found in the results of both solvers the discrepancies with respect to the experimental data are slightly larger than for the horizontal force f x 1 but foamstar swense shows a better accuracy than foamstar the simulations provide also consistent second harmonic forces f x 2 and f z 2 all simulation results fall close to the experimental data with a margin of approximately 30 as the second harmonics are two to three orders of magnitude smaller than the first harmonics larger relative errors are observed for both solvers and the influence of mesh resolution on the errors is less obvious it is thus difficult to comment on which solver is superior for the second harmonic force 5 3 3 2 comparison of the computational cost the computational times required by foamstar swense and foamstar are tested the results are listed in table 14 the computation is done with 24 2 5 ghz processors the wall clock time per wave period is compared table 14 first suggests that the computational time on the same mesh is similar for the two solvers this information suggests that the extra terms in the governing equations of swense and the associated calculations do not influence much the total computational time secondly foamstar swense shows a clear advantage when considering the computational time at the same accuracy foamstar swense with the 20 or the cylindrical mesh obtains the same level of accuracy as foamstar using the 80 mesh a speed up between 1 71 with x20 to 4 28 with the cylindrical mesh is achieved compare with foamstar using 80 mesh this speed up would be even much larger in multi directional wave cases in that scenario the mesh for foamstar could not be defined with a less resolved transversal direction while foamstar swense can still use the cylindrical mesh besides in an irregular wave case the mesh of foamstar has to be defined by the smallest wave length of the irregular wave spectrum and thus contains even more cells than the present case please note that the swense method is not designed to reduce computational cost by allowing larger timesteps the same cfl criterion should be set for both solvers since they convect variables with the same total velocity field in this test the same timestep 1 360 wave period is used for all the simulations the maximum cfl number is about 30 near the refinement zone of the skirt and the cfl number in the farfield is about 0 2 these values are coherent with other similar simulations ransley et al 2019 5 3 3 3 comparison of the flow field to ensure the correctness of the simulation especially to validate the result of foamstar swense on the coarse mesh the flow field of the simulation are compared fig 24 plots the total velocity magnitude u in the water obtained by foamstar and foamstar swense with 80 and 20 meshes respectively the velocity in the air is set to zero the results show identical flow behaviors in the vicinity of the buoy i e the same free surface shape vortex shedding near the thin skirt etc it shows clearly the present method s capacity to deal with rotational flow this good agreement between the two figures also confirms the equivalence of the swense and the nse 5 3 4 irregular waves this section aims to validate the swense method in irregular wave cases the force on the buoy is recorded and compared with the experimental data 5 3 4 1 incident waves the irregular waves are unidirectional generated according to a jonswap spectrum t p 2 0 s h s 0 12 m γ 3 the motion of the wave maker is provided to the hos nwt to calculate the incident wave field in the entire wave tank and then interpolated to the cfd mesh defined near the structure 5 3 4 2 computational domain the computational domain of this test case is illustrated by fig 25 the cylindrical mesh is the same one in the regular wave case with the same relaxation zone the simulation thus reproduces only the first 100 s of the experiment 5 3 4 3 results the comparison of the simulation results and the experimental data represented by the horizontal and vertical wave forces time history is shown in fig 26 a very good agreement is observed at the beginning of the simulation where the wave front does not reach the structure the wave forces remain zero after the wave arrival the simulated wave force curves are very close to the experimental data during most of the simulation time both the amplitudes and the phases are in good agreement fig 27 gives a focused view between t 61 s and t 64 s where a large wave group reaches the buoy the time histories of forces both in the horizontal and the vertical direction are in good agreement with the experimental data note that the simulation results have a peak value slightly larger than the experimental data it may be due to the overprediction of wave velocity in the crest related to the hos method ducrozet 2007 flow details near the structure are provided in fig 28 the free surface approximated by the contour of vof field α 0 5 is plotted colored by the free surface elevation η the time interval between each figure is 0 1 s violent free surface deformations wave breaking are observed near the structure at t 62 95 s a large runup occurs on the structure corresponding to the peak in the time history of force the wave breaking at t 63 1 s demonstrates that the present two phase swense method is able to treat violent free surface deformation 7 conclusion in this paper the two phase spectral wave explicit navier stokes equations swense method is proposed to improve the efficiency and accuracy of two phase cfd solvers when they are applied to wave dominated phenomena the method decomposes the total problem into an incident wave part and a complementary part only the latter part is solved by the cfd solver while the incident wave solution is provided by nonlinear wave models based on spectral representation this paper details the derivation of the two phase swens governing equations shows the assumptions and discusses their potential influence with the objective to make the present paper a theoretical reference of the two phase swense method the governing equations of the complementary part are established from the two phase navier stokes equations and a modified version of euler equations for incident waves a density weighted incident pressure field is proposed to solve the density mismatch problem when extending the incident wave fields above the free surface the proposed equations are mathematically equivalent to the two phase navier stokes equations and are able to keep the accuracy of the incident waves with coarse cfd mesh the solution of the euler equations is obtained by two spectral pt models assuming the velocity field is irrotational the stream function wave theory for regular waves and the hos method for arbitrary waves in open sea or in an experimental wave tank an accurate and efficient interpolation method to map the results of hos wave models onto the cfd mesh is proposed the method is able to reduce divergence error of the interpolated velocity field to meet the cfd solver s need without reprojection this interpolation method is made available for the public through an open source project grid2grid choi et al 2017 an implementation example is shown with a customized solver foamstar swense in openfoam based on an existing navier stokes solver foamstar the implementation is straight forward requiring only the modification of the governing equations the method is validated with three validation and application cases the incident wave propagation cases prove the essential advantage of the swense method i e allowing the use of coarse cfd mesh to simulate incident waves the swense solver can use a grid 4 times more coarse than that of the ns solver in each dimension to achieve the same accuracy for the application of incident waves the high order wave loads on a vertical cylinder calculated with the swense method agree well with the reference experimental and numerical results the convergence study shows a second order convergence behavior of the solver which is consistent with the numerical schemes used in openfoam note that if only the dominant order is considered the coarsest discretization can provide a good prediction with an error of less than 10 this property is useful to give a fast estimation of the wave force when the absolute accuracy is not very important e g in the early design stage the calm buoy case validates the accuracy of the method with complex flow phenomena and reveals its advantage in efficiency it is found that the additional cpu time to calculate the incident wave related terms in the swense method is negligible the proposed two phase swense method achieves a speed up between 1 71 and 4 28 compared with an ns solver on the regular wave case to achieve the same level of accuracy this speed up would be much larger in an irregular and or multi directional situation the present work contains the following limitations the incident waves are limited to non breaking waves propagating at a constant water depth due to the spectral wave models used here such limitations can be overcome in future developments by using advanced spectral wave models allowing wave breaking seiffert and ducrozet 2018 seiffert et al 2017 and variable water depth gouin et al 2016 the method is unsuitable for problems with important air effects in the present work the extended air velocity is nonphysical special treatments should be designed to correct this extended air field when the air effects cannot be neglected the present implementation approximates the interface position in the simplest manner vof contour α 0 5 in the future vof methods with interface reconstruction such as plic scardovelli and zaleski 1999 or sharp interface methods such as level set sethian and smereka 2003 can be considered to improve the accuracy the validation cases are limited to the calculation of the wave force on a fixed structure however in most marine and offshore applications a moving structure is of interest the next step of the work is to extend the two phase swense method to deal with moving structures and a first attempt of such an extension can be found in a recent international blind comparative study of wave structure interaction ransley 2020 most of the numerical implementation is based on open source codes openfoam openuser guide http 2018 hos ocean high order spectral metho 2018 hos nwt numerical wave tank based 2018 and grid2grid grid2grid 2018 the reader is encouraged to reproduce this work and go beyond the present limitations declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work has been performed in the framework of the chaire hydrodynamique et structure marines centrale nantes bureau veritas the first author acknowledges china scholarship council csc for the financial support for his ph d study the authors are indebted to dr vukčević prof jasak from university of zagreb and dr deng from ecole centrale nantes for their help in this work anonymous reviewers are also gratefully acknowledged appendix a problem with the direct subtraction of the euler equations this section shows the numerical difficulties appearing when the euler equation is directly subtracted from the two phase navier stokes equations recalling the ns momentum equation for two phase incompressible fluid eqn 6 u t u u p ρ g μ μ t u u t ρ the perfect fluid euler momentum equation eqn 9 reads u i t u i u i p i ρ i g to demonstrate the challenge we now subtract the two equations directly and simplify the viscous terms as in eqn 19 we obtain a57 u c t u c u c u c u i u i u c p c ρ p i ρ i p i ρ μ μ t u c u c t ρ the underlined terms are canceled out in the water since ρ ρ i however these terms have non zero values in the air phase they behave as source terms and affect the numerical stability appendix b comparison of level set and volume of fluid method the decomposed level set dls method vukčević et al 2016 and the standard volume of fluid method vof are compared here with a pure convection case the transporting velocity is the incident wave velocity obtained from pt same as in sect 5 1 the computational domain boundary conditions are also the same as in sect 5 1 five meshes are used three are the same as in sect 5 1 fine δ x δ z λ 200 h 40 medium δ x δ z λ 100 h 20 coarse δ x δ z λ 50 h 10 two coarser meshes are in addition δ x δ z λ 25 h 5 and δ x δ z λ 15 h 3 the measurement and postprocessing procedures are the same as in sect 5 1 fig 29 shows the first harmonic amplitudes of the free surface elevation nondimensionalised by the target value the dls method shows no advantages against the vof method the vof method creates only 1 error with the coarsest mesh δ x δ z λ 15 h 3 suggesting the vof method can work together with the swense method to reduce the mesh 
21094,this paper proposes an efficient potential and viscous flow decomposition method for wave structure interaction simulation with single phase wave models and two phase computational fluid dynamics cfd solvers the potential part represents the incident waves is solved with spectral wave models the viscous part represents the complementary perturbation on the incident waves is solved with the cfd solver the decomposition strategy is called spectral wave explicit navier stokes equations swense originally proposed for single phase cfd solvers ferrant et al 2003 firstly this paper presents a new two phase swens equations with interface capturing technique to achieve this single phase and two phase decomposition the incident fields are extended in the air with a density weighted pressure secondly an accurate and efficient interpolation method is proposed to transfer high order spectral hos wave model s result on cfd mesh which reduces drastically the divergence error of the interpolated velocity implemented within openfoam these methods are tested by three verification validation and application cases considering incident wave propagation high order loads on a vertical cylinder in regular waves and a catenary anchor leg mooring buoy in both regular and irregular waves speed ups between 1 7 and 4 2 are achieved the wave models and the interpolation method are released open source to the public keywords wave structure interaction potential viscous flow coupling swense two phase flow spectral wave models 1 introduction the accurate prediction of wave structure interactions is of vital importance in ship hydrodynamics and ocean engineering for ocean going vessels the wave induced loads are essential for analyzing ships seakeeping property the resistance in waves and the structural integrity in extreme sea states in ocean engineering the calculation of wave structure interaction helps to optimally design offshore structures for example oil and gas facilities or marine renewable energy devices traditionally water waves and wave structure interactions are addressed with single phase potential theory pt with the inviscid and incompressible fluid and irrotational flow assumption thanks to the irrotational flow assumption the velocity vector 3 variables in 3d cases can be represented by a scalar the velocity potential hence the complexity of the problem is much reduced many highly efficient wave models including the simplest 1st order stokes wave theory stokes 2009 to more complex fully nonlinear models ducrozet et al 2016 rienecker and fenton 1981 are established with basis functions derived from pt and can solve wave propagation in idealized periodic or rectangular domains to take into account realistic bathymetry and to solve wave structure interactions numerous numerical methods have been developed to solve the velocity potential discretely the boundary element method bem babarit and delhommeau 2015 newman and lee 2002 yeung 1982 is the prevailing method the merit of bem is that its variables only locate on the boundaries so the complexity of the problem is reduced by one dimension however a dense matrix has to be solved which sets a limit on the number of elements can be treated by the bem for larger problems volumetric method solving a sparse matrix can be used such as the finite element method fem ma and yan 2006 the finite difference method fdm bingham and zhang 2007 the finite volume method fvm mehmood et al 2015 the harmonic polynomial cells hpc shao and faltinsen 2014 however due to the irrotational assumption pt fails in complex scenarios such as flow separation around structures and wave breaking in contrast computational fluid dynamics cfd solvers based on ns equations have a more sophisticated mathematical model and accept rotational flow moreover cfd solvers offer more possibilities to deal with the moving water air interface for example the two phase flow can be modeled in the same solver chen et al 2014 iafrati et al 2001 queutey et al 2016 so that violent free surface deformations can be treated numerous validations have confirmed that cfd s capacity to provide high fidelity results for marine and offshore applications stern et al 2013 however cfd solvers demand higher computational cost than pt solvers a recent blind test ransley et al 2019 reveals a comparison between several cfd and pt solvers on a wave structure interaction with an intermediate wave steepness without wave breaking and concludes that even the quickest cfd code is 1 5 orders of magnitude slower than a fem pt solver in that non violent wave case but the authors of ransley et al 2019 also admit that cfd solvers may win the comparison when the non breaking and irrotational conditions of pt are violated i e when the wave becomes steeper to summarize both pt and cfd have advantages and limits if they can be coupled appropriately one can expect the resulting method to benefit from both sides in the literature this idea has been explored by many researchers among others two main coupling strategies are commonly used i e domain decomposition dd and functional decomposition fd dd splits the computational domain into a potential region and a viscous region and in each region uses the appropriate solver with the best efficiency and accuracy from a physical point of view the complex interaction e g viscous effects and violent free surface deformation appears near the structure only in the far field the viscous effects can often be neglected allowing the use of potential theory for this reason the computational domain can be split into a viscous inner sub domain plus an irrotational outer sub domain information is exchanged on the common boundary either in a two way interactive fashion or a one way forcing manner for two way coupling the most common practice is to couple a pt solver and a reynolds averaged navier stokes equation ranse solver if the structure does not induce wave breaking both pt and ranse solvers can be single phase solvers as in campana et al 1995 chen and lee 1999 zhang et al 2013 when the waves near structure are more violent two phase ranse solvers are more suitable but in the far field single phase pt solver can still be used as shown in lu et al 2017 siddiqui et al 2018 in extreme violent free surface deformation cases such as dam breaking both pt and ranse solvers should be two phase as in colicchio et al 2006 generally the above mentioned studies have confirmed the two way coupling s capacity in reducing the size of the cfd domain but the reduction of computational time has not yet been confirmed since the two way coupling introduces extra iterations between the pt and the cfd solvers alternatively the one way manner sends information from the pt to the viscous cfd solver only the pt solver considers the wave propagation in the far field until the inner zone the inner cfd zone then uses this information as wave making boundary conditions this method has been applied for shoaling and breaking wave problem in near shore areas grilli et al 2004 guignard et al 1999 lachaume et al 2003 calculation of wave force on offshore structures chen et al 2014 christensen et al 2009 paulsen et al 2014 a general one way coupling method to combine potential wave theories and two phase viscous solvers with the relaxation zone method has been proposed in openfoam and has been widely used by the offshore and coastal engineering community jacobsen et al 2012 however the one way coupling needs a larger computational domain to avoid wave reflection at the boundaries li et al 2019 and thus the number of grid cells is still large as a fine spatial resolution has to be employed in the far field to propagate the incident waves the second category fd splits the total flow problem into i an irrotational part to be solved with pt solvers and ii a complementary part to be solved by cfd codes dommermuth 1993 since such a decomposition is not unique multiple choices exist in the literature which can be classified into two categories according to the complexity of the irrotational part in ref edmund et al 2013 kim et al 2005 rosemurgy et al 2016 the authors proposed a complementary rans method that solves a general fluid structure interaction problem by using firstly a pt solver for the irrotational solution and then correct the solution with a rotational part calculated with a cfd solver with test cases using uniform single phase inflow without free surface it has been found that this strategy allows the cfd solver to employ coarse mesh in the far field and to reduce the computational cost for wave structure interactions ref ferrant et al 2003 proposed a more simple and direct decomposition strategy called the spectral wave explicit navier stokes equations swense method in the swense method the pt solves for the incident waves only and all the rest phenomena are solved by the cfd solver the essential benefits of this incident and complementary decomposition strategy are i it provides fast and accurate incident waves with pt wave models ii the pt solves only incident waves and thus will not fail due to complex flow phenomenon induced by wave structure interactions iii it allows the cfd solver to employ coarse mesh in the far field for the incident wave propagation with only a locally refined region near the structure to solve complementary field accurately the original swense method is proposed only for single phase cfd solvers it has been successfully applied to calculate wave force on vertical cylinder li et al 2017 on a catenary anchor leg mooring buoy monroy 2010 and ship resistance in waves reliquet et al 2013 zhang et al 2000 in the single phase scenario the use of coarser mesh reduced the cpu time of the swense method by one order of magnitude compared with conventional ns solvers for an equivalent accuracy luquet et al 2007 recently the swense method has been extended for two phase cfd solvers vukčević et al 2016 however ref vukčević et al 2016 adopts an fd strategy different from the original swense method which leaves the pressure field not decomposed consequently the use of coarse mesh in the far field may introduce errors to the incident pressure field and consequently to the incident waves losing the advantage of the swense method this point will be discussed in detail in sect 2 4 3 in this paper we present a novel extension of the swense method for two phase viscous cfd solvers which keeps all advantages of the original method i e the ability to use a coarse mesh in the far field to enhance the efficiency moreover coupling two phase cfd solvers with swense enables the method to deal with violent free surface deformations such as breaking waves near the structure secondly the paper also proposes an accurate and convenient reconstruction method to interpolate the results of high order spectral hos wave models onto cfd mesh the method can reduce the divergence error of the interpolated velocity field to meet the cfd solver s need without reprojection implemented in openfoam the validity and efficiency of the proposed methods are assessed thanks to three convincing cases including the simulation of progressive regular waves the calculation of high order loads on a vertical cylinder in regular waves and a catenary anchored leg mooring calm buoy in regular and irregular waves the rest of the paper is organized as follows section 2 derives the two phase swens governing equations section 3 presents the fully non linear spectral wave models for incident wave modeling and proposes the reconstruction technique to interpolate the results of hos wave models onto cfd mesh section 4 details the numerical discretization and an implementation example of a two phase swense solver in openfoam openuser guide http 2018 the validation and application cases are shown in sect 5 2 governing equations of the two phase swense method 2 1 swense decomposition the swense method ferrant et al 2003 2008 defines three notions in a wave structure interaction 1 total field the total field represents the real flow including the incident waves the scattered waves and viscous effects caused by the wave structure interaction it is assumed that the flow is governed by the incompressible ns equations 2 incident field the incident part concerns the propagation of the incident waves in the computational domain without structures the viscosity is neglected the flow is described by the euler equations it is further assumed that the flow is irrotational so that incident waves can be solved by pt wave models 3 complementary field the complementary part represents the difference between the total field and the incident field this field is generated due to the presence of structures in the computational domain and the viscosity of the fluid the complementary variables are governed by the swens equations with these notions a primitive field of the flow χ pressure velocity is decomposed into an incident part χ i and a complementary part χ c see eqn 1 χ i is explicitly given by pt wave models χ c is to be calculated by the cfd solver implementing the swens equations in the following contents variables without subscript denote the total field subscript i denotes the incident part and subscript c denotes the complementary part 1 χ χ i χ c in fig 1 a v shape illustrates how the swens equations are derived with the functional decomposition and how the total field is reconstructed the left half of this v shape shows the derivation procedure of the swens equations assuming the navier stokes equations the first row and the euler equations the second row have the same definition zone we can subtract the euler equations from the ns equations the swens equations the third row is obtained by writing the remainder with the variable χ c on the right half the complementary field χ c is added to the incident solution χ i to reconstruct the total solution χ see fig 2 2 2 derivation of two phase swens equations the two phase swens equations are derived following the swense decomposition procedure in fig 1 with the two phase ns equations and the euler equations 2 2 1 two phase incompressible navier stokes equations in the present work the immiscible air water flow with a deformable common interface is considered as incompressible and viscous the definition zone contains both water and air the volume of fluid vof method hirt and nichols 1981 is used for interface capturing the method is chosen among others for its advantage of mass conservation the vof field α is used to represent the volume fraction of water it is transported by the total velocity field u with the following equation 2 α t u α u r α 1 α 0 where u u v w is the fluid velocity and α 1 α u r is an artificial compression term to avoid the interface smearing with u r the compression velocity albadawi et al 2014 rusche 2003 a sharp interface is approximated with α 0 5 the density ρ and the molecular viscosity μ are phase dependent and are defined as 3 ρ ρ w α 0 5 ρ a α 0 5 and 4 μ μ w α 0 5 μ a α 0 5 with subscriptions w and a representing water and air respectively this kind of definition has been used in the literature abadie et al 2010 jasak et al 2019 despite its simplicity it shows adequate accuracy in the present work while other more accurate techniques such as plic scardovelli and zaleski 1999 can be considered in the future the flow is described by incompressible ns equations 5 u 0 6 u t u u p ρ g μ μ t u u t ρ where p is the total pressure g is the gravitational acceleration μ t represents the turbulent viscosity obtained from reynolds averaged turbulence models with the boussinesq assumption eqn 6 neglects the surface tension since it is small in classical marine and ocean engineering applications 2 2 2 euler equations for incident water waves the incident waves are modeled as a single phase flow the water free surface is considered as a moving boundary see fig 3 and is defined by a time dependent free surface elevation function as follows 7 z η i x t where x x y it assumes η i is a single valued function and the application is consequently limited to non breaking incident waves neglecting the viscosity of water the flow beneath the free surface is modeled with the incompressible euler equations as follows 8 u i 0 9 u i t u i u i p i ρ i g where the subscript i represents incident field the density ρ i is equal to the water density since the equations are defined only in water the boundary conditions are 10 η i t u i η i x v i η i y w i 0 a t z η i x t on the free surface 11 p i 0 a t z η i x t on the free surface 12 w i 0 a t z h on the seabed with u i u i v i w i and x x y 2 2 2 1 extension of the definition zone it is worth noting that the definition zone of euler equations is different from that of two phase ns equations consequently the former must be extended to apply the same swense decomposition in both water and air the extension technique will be presented in sect 3 3 herein please just assume the euler equations and their solution have the same definition zone as that of the two phase ns equations i e in the whole air and water domain 2 2 3 two phase spectral wave explicit navier stokes equations the two phase swens equations are derived by subtracting the euler equations from the two phase navier stokes equations 2 2 3 1 continuity equation using the continuity equation of ns equations eqn 5 minus the that of euler equations eqn 8 yields 13 u u i 0 with the notation of u c u u i the continuity equation using the complementary variable reads 14 u c 0 2 2 3 2 momentum equation the momentum equation should also be derived by subtracting the momentum equation of the euler equations eqn 9 from that of the navier stokes equations eqn 6 however the direct use of eqn 9 causes stability problems in the air see appendix a for this reason a density weighted pressure p i is designed as 15 p i ρ ρ i p i where ρ is the density of the two phase flow and ρ i is equal to the water density eqn 9 written in its modified version by using p i reads 16 u i t u i u i p i ρ p i ρ i ρ ρ g subtracting eqn 16 from eqn 6 and using the notation of p c p p i the two phase swense momentum equation written with the complementary variables is obtained as 17 u c t u u c u c u i p c ρ p i ρ i ρ ρ μ μ t u u t ρ by comparing eqn 57 in appendix a and eqn 17 it is clear that the density weighted pressure p i is a key element of the two phase swens equations we now simplify the viscosity term by separating the molecular and turbulent terms looking at the molecular terms first we can decompose it into incident and complementary terms 18 μ u u t μ u i u i t μ u c u c t continue to simplify the incident part using u i 0 and u i 0 since the incident velocity field is incompressible and irrotational we have 19 μ u i u i t 2 μ u i t 2 μ u i u i μ 2 u i μ the turbulence viscosity can be also simplified in the same way the resulting equation is 20 u c t u u c u c u i p c ρ p i ρ i ρ ρ μ μ t u c u c t ρ 2 u i μ ρ 2 u i μ t ρ it worth noting that in eqn 20 two source terms have non zero values only on the air water interface i e p i ρ i ρ ρ and 2 u i μ ρ the first suggests a restoring force proportional to the density gradient the second represents a viscous dissipation at the interface which is proportional to the molecular viscosity gradient the second term is neglected since it is several orders of magnitude smaller moreover the turbulence stress on the incident wave part 2 u i μ t ρ is assumed to be zero because the reynolds stresses arising from an irrotational field have no effect on the mean velocity field pope 2000 the final simplified momentum equation reads 21 u c t u u c u c u i p c ρ p i ρ i ρ ρ μ μ t u c u c t ρ 2 2 3 3 vof equation the vof field is not decomposed as other variables because it is challenging to consider the boundedness in the decomposition i e it is not straightforward to define an incident vof field α i and a complementary vof field α c and to keep 0 α i α c 1 instead the total vof field is transported with the reconstructed total field u u i u c using eqn 2 the authors are aware that in this step transporting vof field with a given velocity field the proposed method introduces numerical errors as large as convectional two phase vof ns solvers and thus may restrict the accuracy of the present method when using coarse mesh however the mesh requirement of an accurate vof convection is often not as demanding as for the momentum equations see appendix 8 using 15 cells per wave length can already provide adequate accuracy decomposition approaches can be used on other approaches such as the decomposed level set dls reliquet 2013 vukčević et al 2016 appendix 8 also provides a comparison between vof and dls 2 3 boundary conditions the boundary conditions bcs of the complementary field are derived from the boundary conditions of the total fields with the same physical significance table 1 shows some commonly used bcs in the swense method with their equivalence in navier stokes equation nse for far field and the non slip wall boundary condition the bcs of nse and swense are mathematical equivalent the pressure bcs are not given as they should be calculated to ensure the fixed velocity bc the far field bc is applied to the outer boundaries assuming that the fluid motion is equal to the incident waves i e the complementary field vanishes because the wave amplitude decay with 1 r r is the distance from the structure the no slip wall bc is used on the body for a fixed body the total velocity on the wall u 0 thus in swense u c u i the atmosphere boundary is the upper limit of the computational domain in two phase flow simulation which is connected to the atmosphere in nse such boundary condition is imposed by the atmosphere pressure p 0 and assumes the gradient of velocity u is equal to zero the strict equivalence is p c p i however the p i is small by definition in the air eqn 15 for simplicity we impose p c 0 and assume the gradient of u c is zero 2 4 discussion 2 4 1 relation with ns equations the given swense equation can regress to the ns equations when the incident solution is set to be calm water i e eqn 21 in the two phase swense momentum equation is equivalent to eqn 6 in the two phase ns equations if the incident wave part is explicitly given as no waves to prove that one can let the incident wave field be zero i e 22 u i 0 and thus the incident pressure is equal to the hydrostatic pressure 23 p i ρ i g z thus eqn 21 can be written as 24 u c t u u c p c ρ g z ρ ρ μ μ t u c u c t ρ transforming this equation with the relations below 25 u c u u i u 26 p c p p i p ρ g z yields eqn 6 showing that the swense momentum equation eqn 21 can regress to the two phase ns equation eqn 6 if there are no incident waves 2 4 2 keeping incident solution with coarse mesh the second property is to preserve exactly the incident wave solution throughout the domain when no structure is present regardless of the mesh used in the case of pure incident wave simulation the initial values of the complementary fields are zero i e 27 u c x t 0 0 28 p c x t 0 0 the second term on the r h s of eqn 21 is equal to zero in the entire computational domain 29 p i ρ i ρ ρ 0 because at the incident free surface elsewhere p i 0 non zero ρ non zero 0 p i ρ i ρ ρ 0 using the above conditions eqn 21 is simplified to 30 u c t 0 showing that complementary velocity fields u c remains zero in this condition the pressured field p c also remains zero after solving the pressure poisson equation as a result eqn 21 preserves the kinematics of the incident waves 2 4 3 main differences from vukčević et al vukčević et al 2016 another two phase swense method has been introduced early by vukčevićet al vukčević et al 2016 with different characteristics with the method proposed here these differences are presented as follows the first and the fundamental difference is that in reference vukčević et al 2016 terms containing incident wave information are not simplified with known relations from pt for example the continuity equation reads 31 u c u i although the r h s is equal to zero in the wave theory reference vukčević et al 2016 evaluates it by the cfd solver to consider the errors coming from the spectral solution techniques the interpolation of incident wave velocity on the cfd mesh reference vukčević et al 2016 emphasizes the necessity to correct these errors with the complementary field however in the present work we choose to drop off these errors and cancel out the r h s term with the theoretical relation u i 0 for incompressible flow the reasons for this choice are the pt methods are accurate for water wave problems the numerical error resides in a converged spectral potential flow result is often negligible compensating this error by cfd solvers is not beneficial because this correcting step may introduce larger numerical errors itself the interpolation of incident field on cfd mesh is improved in this work see section 3 2 so that the numerical error related to the interpolation procedure is drastically reduced the numerical evaluation of the incident quantities requires fine cfd discretization to be accurate this is not consistent with the objective of the swense method i e to use coarse mesh for the incident wave propagation problem similarly the momentum equation in reference vukčević et al 2016 is not simplified either with the analytic relation provided by the euler equations it reads 32 u c t u u c ν 2 u c u i t u u i ν 2 u i β p d where ν is the kinematic viscosity and β 1 ρ this treatment also prevents the use of coarse mesh for incident wave propagation because coarse mesh even only used in the far field generates errors on the r h s of eqn 32 and results in spurious complementary fields that interfere with incident waves in contrast the present work cancels out these terms with analytical relations so that the numerical errors can be avoided as shown in sect 2 4 2 the second difference is that reference vukčević et al 2016 uses the decomposed level set dls method to capture the interface instead of the standard vof not decomposed here appendix 8 compares both methods on a pure convection case i e the interface capturing function is transported by the incident wave velocity the results demonstrate that the dls is not more advantageous than the vof in the present second order accurate finite volume framework 3 incident wave modeling this section describes how to obtain the incident wave solution by potential flow solvers spectral wave models the theoretical part will show that for the swense method the spectral wave models are superior to other pt methods because they can extend the incident wave fields above the free surface easily the influence of such an extension in the air is also discussed in this section to show its influence on the total field an accurate and efficient technique to interpolate the incident wave fields on arbitrary cfd mesh is also proposed in this section 3 1 potential flow theory and spectral solution techniques by further assuming the incident wave velocity is irrotational the euler equations can be solved efficiently and accurately dean and dalrymple 1991 with pt such an assumption allows to reduce the number of unknowns in the euler equation by defining a scalar field φ called velocity potential or potential so that 33 u i φ using φ the euler equations are written in an equivalent form as follows 34 δ φ 0 laplace s equation 35 η i t φ x η i x φ y η i y φ z 0 a t z η i x t free surface kinematic condition 36 φ t 1 2 φ 2 g z 0 a t z η i x t free surface dynamic condition 37 φ z 0 a t z h seabed boundary condition in the present work spectral methods are used to solve this non linear potential flow problem with high accuracy and efficiency these methods decompose the free surface elevation η i x t and the velocity potential φ x z t using a set of basis functions an example in a 2d uni directional wave case is shown as follows 38 η i x t i 1 m a i η t ψ i x 39 φ x z t i 1 n a i φ t cosh k i z h cosh k i h ψ i x where a i are the modal amplitudes k i are the basis wave numbers and ψ i x are the horizontal basis functions sine and cosine functions or their complex exponential equivalents with these basis functions eqn 39 satisfy automatically the laplace s equations and the seabed boundary condition eqns 34 and 37 the free surface boundary conditions eqns 35 and 36 discretized on uniformly distributed points on the free surface are used to establish a linear system to determine the modal amplitudes a i η t and a i φ t after the potential φ is obtained the velocity field u i is calculated with eqn 33 and the pressure field is obtained with the bernoulli equation 3 1 1 regular waves stream function theory for 2d regular nonlinear waves the algorithm proposed by rienecker fenton rienecker and fenton 1981 based on the stream function theory is adopted cn stream 2019 ducrozet et al 2019 this algorithm solves 2d progressing regular waves over a horizontal seabed for a wide range of depths amplitudes and wavelengths the free surface elevation and the velocity potential are decomposed with basis functions as shown in eqns 38 and 39 the basis function ψ i x is replaced by ψ i x c t with c the phase velocity to make the modal amplitudes a i η and a i φ independent of time these amplitudes are solved from a linear system established with the kinematic and the dynamic boundary conditions eqns 35 and 36 the reader can find more information in references rienecker and fenton 1981 3 1 2 arbitrary waves high order spectral method the high order spectral hos method dommermuth and yue 1987 west et al 1987 is adopted for arbitrary unsteady wave propagation 2d or 3d hos considers the full non linearity of the free surface and exhibits high efficiency and accuracy thanks to its pseudo spectral formalism in this work two well validated open source solvers developed at lheea lab ecole centrale nantes and cnrs hos ocean high order spectral metho 2018 ducrozet et al 2016 and hos nwt numerical wave tank based 2018 ducrozet et al 2012 are used to solve arbitrary incident waves in open sea and experimental wave tanks respectively 3 2 reconstruction of incident wave information on the cfd mesh the reconstruction step transforms the results of spectral wave models onto the cfd mesh for example in a 2d case the velocity potential φ is stored as the modal amplitudes a i φ t in eqn 39 with these modal amplitudes the potential φ can be reconstructed and the velocity can be further calculated by evaluating the derivatives of the potential eqn 33 as follows 40 u i x z t i 1 n a i φ t j k i cosh k i z h cosh k i h ψ i x 41 w i x z t i 1 n a i φ t k i sinh k i z h cosh k i h ψ i x the velocity can be obtained by substituting the coordinates x z and the time t into the above equations this reconstruction method is referred to as analytical evaluation method hereafter the computational cost at each cell location and at each timestep is proportional to the number of fourier components for the stream function wave theory the number of fourier components are n o 10 whereas the hos method typically needs 100 to 1000 fourier components in a single direction for an irregular wave train as a result the analytical evaluation is very time consuming for hos waves instead an interpolation method is used the modal results are first transferred on a series of space points with the inverse fast fourier transform ifft algorithm and then interpolated to the cfd cells in this section the analytical evaluation and the interpolation method are explained in the first two subsections the third subsection focuses on the reconstruction error and its consequences the last subsection proposes a new interpolation technique to improve the interpolation accuracy for simplicity only the velocity field is shown as an example the pressure field can be reconstructed similarly 3 2 1 analytical evaluation for the stream function wave theory for regular waves obtained with the stream function wave theory the analytical evaluation method is applied since the number of fourier components is small for example a regular wave with a moderately large steepness k a 0 24 converges with only 9 fourier components n 9 3 2 2 interpolation for the hos waves the interpolation procedure ducrozet 2007 to reconstruct the hos results on cfd cells firstly reconstructs the wave information on a coarse rectangular hos grid via ifft and then interpolates it on the cfd mesh compared to the analytical evaluation the efficiency is much improved by the ifft algorithm this procedure can be divided into two steps 1 ifft this step translates the spectral information in the spatial domain via ifft after the ifft the wave information is available on uniformly spaced points the number of points is equal to the number of fourier modes n used in the hos computation the distance between two points is equal to the shortest wave length of the basis function 2 π k n take a 2d case as an example for the free surface elevation η i x t ifft transforms a i η to n uniformly distributed points in the x direction see fig 4 the velocity field u i x z t is reconstructed similarly but since the velocity field also depends on the vertical direction z several iffts are used each ifft transforms a i φ to the velocity at n horizontally uniformly distributed points with a given vertical position z after this reconstruction the velocity field is available on a coarse rectangular grid referred to as the hos grid hereafter with several horizontal layers each horizontal layer contains n uniformly distributed points note the vertical position of these layers can be given arbitrarily so that a vertical refinement is possible in contrast horizontal refinement cannot be done directly since the number of points n is equal to the number of modes in the hos calculation 2 interpolation the incident wave information is interpolated from the hos grid onto the cfd mesh as the hos grid is usually different from a cfd mesh for example a typical hos simulation uses 10 points per peak wave length while cfd solvers usually use around 100 cells fig 5 interpolated a comparison of a typical hos grid on the left and a cfd mesh on the right the figure is colored by the velocity magnitude the result on the cfd mesh is interpolated from the hos grid behind it with the cubic spline scheme an example of the interpolation result is shown in fig 6 the vof field on the top is reconstructed from the free surface elevation η i the velocity field is shown at the bottom the waves are simulated by hos ocean jonswap wave spectrum with t p 0 7 s h s 0 028 m γ 3 3 the hos simulation domain contains 10 peak wave lengths l x 10 λ p with 128 fourier components n 128 3 2 3 reconstruction error velocity divergence this section analyzes the reconstruction error represented by the velocity divergence u i the physical significance of the velocity divergence is the volume change rate its unit is s 1 having u i a s 1 means that the fluid will have a relative volume change of a in 1 s if the reconstruction is accurate the velocity divergence is equal to zero because the flow is incompressible the vof method is very sensitive to the velocity divergence because the boundedness of the vof field requires a divergence free velocity field such an error finally leads to instabilities in the simulation in the present work the velocity field is reconstructed on finite volume mesh the divergence is then calculated by 42 u i f u i f a f δ v where f represents the cell faces u i f represents the face averaged incident velocity a f the surface vector of the cell face f and δ v the volume of the cell it may contain numerical errors coming from 1 approximating the face averaged value by the face center value u i f u i x c f where x c f is the face center coordinates 2 evaluating u i x c f by interpolation in the interpolation method the first source of error is due to the use of the second order finite volume method which affects both the analytical evaluation and the interpolation method and is often negligible in contrast the second source of error is usually much larger fig 7 shows the divergence error of the interpolated velocity field of fig 6 the cfd mesh is discretized with δ x δ z λ p 100 h s 20 the vof field transported by this velocity field after one wave period is shown in fig 8 its values are no more bounded by 0 and 1 this problem suggests the necessity to improve the interpolation accuracy 3 2 4 improvement of the interpolation accuracy the main source of inaccuracy in the interpolation is the large space interval between hos points refining the hos grid is definitively helpful to reduce the interpolation error however using a grid as refined as a cfd mesh directly in the hos computation is not feasible since it introduces too many very short waves and may make the computation unstable ducrozet et al 2017 to overcome this difficulty we propose a refinement at the postprocessing stage the method takes any hos simulation result as input and allows to refine the grid to a user defined level this refinement is achieved with a zero padding step in the spectral domain before the ifft see fig 9 after reading the amplitudes of fourier components from an hos result the method extends the spectrum by adding extra modes with zero amplitude at the end according to the relation between the spectral and the spatial domain in the fft algorithm additional fourier components result in extra spatial points i e if the spectrum is extended n times the distance between two hos points can be reduced to 1 n note that the factor n has to be an integer to end up with the original spatial points plus n 1 additional points between two original points in this way the incident result is available on a finer grid and the interpolation error is reduced consequently although more points are added the efficiency is still greatly enhanced compared to the analytical evaluation since this method still relies on the ifft to demonstrate the improvement in the interpolation accuracy the divergence of the hos velocity reconstructed by the zero padding method is shown in fig 10 the same cfd mesh and the same hos simulation results are used as in fig 7 the zero padding method transfers the modal information on 512 reconstruction points by extending the fourier modes by a factor of 4 compared to fig 7 the divergence error is reduced by 2 orders of magnitudes this level of accuracy appears to be enough in our experience to convect the vof field in a stable way compare fig 11 to fig 8 3 2 5 code availability this reconstruction technique is included in the open source library grid2grid grid2grid 2018 choi et al 2017 this library is developed by the lheea research department ecole centrale nantes and cnrs to connect any cfd solver with hos ocean ducrozet et al 2016 grilli et al 2004 and hos nwt numerical wave tank based 2018 ducrozet et al 2012 two open source hos wave solvers the library is published with the gnu general public license v3 0 and can be downloaded from the url https github com lheea grid2grid 3 3 extension of incident wave solution in the air the two phase swense method requires the incident solution both in water and in air however the wave model only defines the incident solution under the incident free surface position to obtain the information above the free surface the incident solution is extended by using eqn 37 which gives an incident solution even above the free surface fig 12 gives an example of the extended velocity field of a regular wave the white line represents the free surface position of the incident wave it is worth noting that the extended solution still satisfies the euler equations eqns 8 and 9 this property of the spectral method helps the swense method to adjust the definition zone of the incident wave so that the same functional decomposition can be used in the entire cfd computational domain this direct extension results in a smooth transition across the free surface which is beneficial numerically the drawback of such an extension is an oscillating incident wind field in the air by using the boundary conditions given in table 1 this oscillatory wind remains in the total field although it is possible to correct this unrealistic phenomenon for example by using no slip bc on the top such correction requires extra computational cost in the air which goes against the objective to reduce cpu time in the present work we accept this oscillatory wind as a side effect of the swense decomposition in the air without any special treatment since in most classical wave structure interaction problems the air effects are often very weak as it will be verified in sect 5 4 implementation in openfoam the present work uses the open source cfd package openfoam 1 1 https openfoam org to implement the proposed method openfoam uses the second order finite volume method fvm with unstructured polyhedral meshes all the variables are located at the cell center its native two phase solver interfoam adopts the vof method hirt and nichols 1981 and the multi dimensional limiter for explicit solution mules algorithm deshpande et al 2012 the pimple algorithm openfoam 1906 which combines the pressure implicit with splitting of operator piso and the semi implicit method for pressure linked equations simple versteeg and malalasekera 2007 is used to obtain converged results of the velocity pressure vof coupling at each time step the readers are referred to deshpande et al 2012 ubbink and issa 1999 for more details of interfoam the marine hydrodynamics community of openfoam has developed codes based on interfoam by adding wave modeling techniques e g waves2foam jacobsen et al 2012 foamstar monroy et al 2016 etc the proposed two phase swense method is implemented on top of foamstar monroy et al 2016 developed by bureau veritas and ecole centrale nantes the new solver is named as foamstar swense the only difference between the two solvers is that the ns equations in foamstar are replaced by the swens equations in foamstar swense 4 1 equations discretization this section briefly describes how the governing equations are discretized standard schemes in openfoam are used as listed in the end of the section more details of these schemes can be found in the literature ferziger and peric 2012 moukalled et al 2016 for convenience the sign is used to indicate that the terms enclosed are treated implicitly otherwise the terms are evaluated explicitly 4 1 1 vof equation the discretization of eqn 2 is standard as in interfoam 43 α t u α α 1 α u r 0 the mules algorithm deshpande et al 2012 is used to keep the boundedness of the α field 4 1 2 momentum equation eqn 21 rewritten in its conservative form is discretized as follows 44 u c t u u c u c u i μ e f f u c μ e f f u c t ρ p c ρ p i ρ i ρ ρ where μ e f f μ μ t the time derivative the convection and the diffusion terms of the u c are discretized implicitly the rest terms are explicitly evaluated note that the r h s terms are evaluated with a reconstruction operation from face flux openfoam 2019 to introduce a pseudo staggered grid setup and to avoid checker board pressure oscillations that may occur on co located grids for example p c ρ is evaluated at the cell face p c f ρ f and reconstructed to the cell center the pressure p c f at the cell face is directly calculated with the pressure at the two neighbor cell centers the face density ρ f is interpolated as 45 ρ f ρ w δ x w ρ a δ x a δ x w δ x a where δ x w and δ x a denote the distance of cell center to the interface of water cell and air cell respectively this interpolation scheme mimics the ghost fluid method for two phase incompressible flow lalanne et al 2015 p i ρ i ρ ρ is evaluated similarly eqn 44 written in a semi discretized form for a cell p reads 46 a p u c p n a n u c n s p c ρ p i ρ i ρ ρ where the subscript p and n represent the value of the current cell and the values of its neighbors the coefficients of the discretized system are a p and a n s represents the source terms in the discretized equation except for the complementary pressure term and the interface term in openfoam the solution step of eqn 46 is called the momentum prediction it provides a momentum conserving velocity field u c however the result of the velocity prediction does not guarantee the incompressibility of the field a correction is necessary via the pressure equation step 4 1 3 pressure equation the discretized pressure equation in the swense solver is derived in the same way in as in standard incompressible flow openfoam solvers the semi discretized form of the momentum equation eqn 46 as follows 47 a p u c p h u c p c ρ p i ρ i ρ ρ where is the diagonal contribution of eqn 46 is the contribution of the complementary pressure gradient is the contribution of interface density gradient is the off diagonal contribution of the matrix and the source terms s in eqn 46 48 h u c n a n u c n s from eqn 45 the complementary velocity at the center of the cell is 49 u c p h u c a p 1 a p p c ρ 1 a p p i ρ i ρ ρ interpolating this value to the face center yields 50 u c f u c h u c a p 1 a p p c f ρ f 1 a p p i f ρ i ρ f ρ f where the symbol denotes the value on the cell face which is linearly interpolated from the cell center of both sides substituting eqn 50 into eqn 14 the discretized pressure equation is written as 51 1 a p p c f ρ f h u c a p 1 a p p i f ρ i ρ f ρ f this poisson equation is used to determine the complementary pressure field and to correct the complementary velocity flux at last the flux is used to reconstruct the cell centered u c 4 1 4 discretization schemes the discretization schemes are listed in table 2 the time derivative is discretized with second order crank nicolson scheme and blended with first order euler implicit scheme to compromise between the accuracy and the stability spatial schemes are also 2nd order in general but first order schemes will be used locally to avoid over shoots or under shoots 4 2 prevention of wave reflections with the relaxation zone technique the present method adopts the relaxation zone technique jacobsen et al 2012 monroy et al 2016 to prevent wave reflections at the computational domain boundaries in the relaxation zones the complementary velocity field u c is gradually attenuated to zero and the vof field α is blended to the target value of incident wave field α i as follows 52 u c r e l a x ω 0 1 ω u c c f d 53 α r e l a x ω α i 1 ω α c f d with 0 w 1 the weighting factor the complementary pressure is not relaxed by this method as it is solved implicitly at each step 4 3 solution algorithm the structure of the swense solver is provided in the flowchart of fig 13 1 at the beginning of each time step incident wave properties u i and p i are updated from potential wave solvers and mapped on the cfd mesh the total velocity is reconstructed with u u i u c 2 solve for the vof field α eqn 43 update the fluid properties with the new vof field eqns 3 and 4 update the modified incident wave pressure p i with the new density field eqn 15 3 in the piso loop the complementary velocity field is solved from eqn 44 at first the momentum prediction step secondly the complementary pressure p c is solved from eqn 51 the flux of the complementary velocity is corrected by the pressure field p c after the correction the flux is used to reconstruct the complementary velocity field u c at the cell center the piso loop iterates until reaching the maximum iteration number user defined value set to 6 in the present cases 4 the solution is then blended to the target values in the relaxation zones to attenuate the complementary waves in the far field eqns 52 and 53 5 outer nonlinear iterations are made to achieve the convergence of the vof the velocity and the pressure before stepping to the next time the convergence criterion is that the residual of u c is reduced 3 orders of magnitude 5 validation and application in this section the two phase swense method is validated on three test cases progressive waves this test case consists simply in a simple regular wave propagation in a periodic domain no structure is present different discretizations are used to check whether a swense solver can keep incident waves accurate with coarse discretizations a comparison with the conventional ns solver foamstar is also provided high order wave loads on a vertical cylinder this case validates the method on the calculation of the wave force on a fixed structure with simple geometry the horizontal wave force on the cylinder is recorded up to fourth harmonic components are extracted and compared with experimental data and numerical results of potential flow solvers a systematic convergence study is also conducted fixed catenary anchored leg mooring calm buoy with a heave damping skirt in regular and irregular waves this configuration is used to assess the method with a complex geometry and includes violent free surface deformation and viscous effects representing a real ocean engineering application the results of foamstar swense are compared with experimental data for the regular wave case comparative simulations conducted with foamstar are used to demonstrate the efficiency and accuracy of the proposed method 5 1 progressive waves good quality of the incident waves is the first requirement for wave structure interaction simulations ns solvers e g foamstar which simulate the wave system with a direct method need fine meshes to propagate waves accurately instead incident wave propagation in swense solvers is much easier because the incident waves are explicitly given by wave models in a swense solver maintaining the accurate incident waves is nothing more than keeping the complementary field is equal to zero although such a property of the proposed two phase swense method has been demonstrated theoretically in sect 2 4 numerical errors may exist in cfd simulations therefore this case tests the real behavior of foamstar swense taking all the probable numerical errors into account the case simulates regular wave propagation in a 2d periodic domain periodic boundary conditions at inlet and outlet are used to get rid of the wave generation and absorption issues and to focus on the wave propagation the case is intentionally designed with a large computational domain and a long time duration to increase the numerical errors in order to test the stability and the accuracy of the method foamstar swense and foamstar are tested and compared with several identical spatial and temporal discretizations 5 1 1 test case setup regular waves with a moderately large wave steepness k a 0 22 are simulated the wave characteristics are listed in table 3 the stream function wave theory ducrozet et al 2019 rienecker and fenton 1981 is used to generate the reference solution and provide the incident wave information to foamstar swense the simulations use a two dimensional rectangular computational domain see fig 14 the waves travel from the left to the right periodic boundary conditions are applied on the left and the right boundaries the origin of the coordinate system is located at the left of the computational domain on the free surface position at rest the axis x points right and the axis z points up the length of the computational domain is equal to ten wave lengths λ and the height of the computational domain is equal to the water depth h plus 2 5 times the wave height h the simulation time is equal to 20 wave periods three sets of space and time resolutions are used see table 4 the medium discretization corresponds to the typical mesh used by two phase vof solvers for the wave structure interaction problems for foamstar swense the initial values of the complementary velocity field u c and the complementary pressure field p c are set to zero the vof field is set according to the stream function wave theory for foamstar the initial values of the velocity field u pressure field p d and the vof field α are set according to the stream function wave theory 5 1 2 numerical results the free surface elevation at the center of the domain is measured fig 15 plots the time evolution of the first and second harmonics the vertical axis is normalized by the reference stream function value the horizontal axis is non dimensionalized by the wave period the errors on the first harmonic are listed in table 5 every five periods foamstar swense fig 15 reveals that the first and the second harmonic amplitudes are well kept for the entire 20 wave periods with all the three discretizations the fine and the medium discretizations give very close results the coarse discretization produces results with slightly larger errors but still simulates the waves rather accurately table 5 confirms the above observations the three meshes have relative errors of 2 45 0 81 and 1 03 at t 20 t foamstar fig 15 suggests a more remarkable wave damping throughout the 20 periods with all the discretizations the loss of wave amplitude is of 18 97 6 68 and 2 45 for the coarse medium and fine meshes at t 20 t 5 1 3 discussion 5 1 3 1 numerical errors in two phase swense method although sect 2 4 2 proves that the swense method keeps the waves equal to the incident solution in theory the simulation results show a difference one reason for this contradiction is the error created when approximating the interface position by the contour of α 0 5 theoretically the complementary fields are kept zero in a pure incident wave propagation case because the free surface position the density jump coincides with the p i 0 contour incident free surface position however the present implementation defines the density jump at α 0 5 where p i is slightly different from 0 an error in p i ρ i ρ ρ of the momentum equation eqn 19 is introduced and generates a tiny spurious complementary field near the free surface even with refinement this error cannot be fully reduced to zero in the future better definition of the density jump can be considered with more advanced interface capturing methods to improve the result for now we satisfy with the method since it provides more accurate results than the ns solver as shown below 5 1 3 2 advantage in keeping incident waves over conventional solvers in fig 15 the results of foamstar show the well known numerical wave damping problem of two phase ns solvers choi et al 2020 monroy and seng 2017 and the wave damping is more severe with coarser discretizations for this reason the international towing tank conference ittc suggests more than 80 grids per wavelength when using 2nd order cfd codes for wave problems practical guideline 2014 for foamstar swense the results are very close to the reference value even with the coarse discretization moreover foamstar swense with the coarse mesh gives results as good as foamstar with the fine mesh showing that foamstar needs 4 times more refined discretization to achieve the same accuracy an obvious efficiency gain of the swense method is confirmed 5 2 high order wave forces on a vertical cylinder high order wave force on cylinders is a classical problem in offshore engineering despite their small amplitudes the high order wave forces may cause sudden structural vibration the so called ringing phenomenon since their frequencies are close to the natural frequency of the structure this problem has been addressed by numerous approaches in the literature including asymptotic analytical solutions faltinsen et al 1995 malenica and molin 1995 experiment huseby and grue 2000 and numerical simulations with fully nonlinear potential flow approaches ferrant 1996 shao and faltinsen 2014 therefore these well established reference data make this case very suitable for validation purposes the test case contains two following parts a convergence study in a rather steep wave condition k a 0 24 validation of the method with simulations covering eight different wave steepnesses 0 6 k a 0 24 5 2 1 test case setup the simulation reproduces the experiment in huseby and grue 2000 where a thin cylinder is exposed to regular waves in deep water see fig 16 the cylinder has a radius of r 0 03 m being fixed in the water tank of water depth h 0 6 m the incident wave frequency f is equal to 1 425 hz different wave amplitudes a are used in the experiment and the data are available for a series of wave steepnesses in the range of k a 0 03 0 24 for convenience a cylindrical mesh is used by the simulation instead of modeling the entire experimental wave tank see fig 17 the cylinder is located at the center at far field the complementary field is damped to avoid reflections this configuration represents an ideal experimental condition where no wave reflects back from the boundaries this kind of mesh is also used by the potential flow solvers producing the reference data ferrant 1996 shao and faltinsen 2014 the cylindrical mesh is also accurate and efficient for the swense method the mesh is fine near the center which helps to capture the complementary fields accurately near the structure coarse mesh in the far field helps to reduce the computational cost please note that ns solvers cannot use such a mesh since coarse far field mesh results in inaccurate incident waves a longitudinal symmetry plane is used the origin of the coordinate system coincides with the cylinder s center line and is located at the still water level axis x points to the incident wave propagation direction and axis z points upward along z axis the computational domain extends from the tank bottom at z h until z 5 a in the air in z direction the mesh is uniform near the air water interface z 1 5 a 1 5 a the cell size increases gradually out of this refined zone the domain s radius is equal to 2 wave lengths l r 2 λ the mesh is refined near the cylinder and gradually enlarged along the radius direction in the far field a relaxation zone with a length of l r e l a x 1 5 λ is used to absorb the complementary field leaving a pure cfd zone with one wave length diameter the setup of the relaxation zone follows the study in paulsen et al 2014 which shows a relaxation zone of at least 1λ long locating at least 1 6λ away from the structure is sufficient the setup is summarized in table 6 the maximum reynolds number r e 1 55 10 4 when the wave crest reaches the cylinder indicating the flow is between the laminar and transitional regime with a keulegen carpenter number k c 3 01 as a result no turbulence model is used no slip wall boundary condition is applied on the cylinder with under resolved boundary layer it is acceptable since the viscous force is very small compared to the pressure contribution 5 2 2 convergence study a systematic convergence study with six sets of temporal and spatial resolutions is conducted the time step and the mesh size in radial tangential and vertical directions are changed simultaneously the discretization details are summarized in table 7 this study uses the steepest wave case k a 0 24 in the experiment fig 18 shows the time histories of the inline force obtained with different discretizations the abscissa denotes the time t which is normalized by the wave period t it is observed that a periodic regime appears after two wave periods the bottom plot zooms in between the fourth and fifth periods the first observation is that the results are very close and converge with the refinement for a better comparison the time histories in the periodic regime are transformed to the frequency domain by the fast fourier transform fft the amplitudes of the first four harmonic components are summarized in table 8 following huseby and grue 2000 the harmonic amplitudes in the table are normalized using 54 f n f n ρ g r 3 r a n fig 19 shows the variation of the normalized harmonic amplitudes with the mesh refinement the abscissa represents the mesh 1 to 6 and is scaled by the number of cells per dimension again it is observed that results with different discretizations are very close showing that even the coarsest mesh can give a good prediction of force in the following the error estimation procedure proposed by eça and hoekstra 2014 is adopted to estimate the convergence rate and the converged value this procedure assumes that the discretization error is a power function of the mesh and time step size as follows 55 ε i φ i φ 0 α δ x p x β δ t p t where ε i is the discretization error of the simulation result φ i while φ 0 denotes the extrapolated exact solution of the mathematical equations δ x and δ t stand for the characteristic mesh and time step size p x and p t are the convergence order in space and time for each harmonic amplitude the five parameters φ 0 α p x β p t are determined by the method of least squares using the six discretization results the converged values φ 0 and the convergence order are listed in table 9 the results show a general convergence order between 1 and 2 which is coherent with the discretization schemes used in openfoam second order convective schemes with first order limiters table 10 presents the relative error for different mesh resolutions the relative error is defined with the following equation according to eça and hoekstra 2014 56 δ i φ i φ 0 φ 0 from table 10 it is observed that the first harmonic amplitude is predicted rather accurately even with the coarsest mesh 6 66 error this should be credited to the advantage of the swense method and the use of an optimal cylindrical mesh the swense method ensures a good incident wave allowing the use of coarse mesh in the far field the cylindrical mesh is refined near the structure so that it is always fine enough to calculate the first harmonic amplitude correctly higher harmonic components contain larger relative errors than that in the first harmonic component since the high order components are smaller and thus require finer discretizations to be captured accurately even so the accuracy with the coarsest mesh is still rather satisfying with a maximum relative error smaller than 20 for the finest mesh errors are so low that the convergence seems to saturate however one must remember here that it is a relative error to an estimated solution and not to an exact one so that errors of the order of a few percents do not represent the absolute accuracy of the method 5 2 3 steepness study in this part the wave force with eight wave steepnesses k a 0 06 0 08 0 10 0 13 0 15 0 17 0 20 0 24 are calculated with foamstar swense the mesh 4 of the previous section is used to make a compromise between the computational cost and the accuracy table 10 shows that this mesh achieves a rather small relative errors with only 0 67 million cells 1 8 of the finest mesh the mesh is adjusted in the vertical direction according to the wave steepness so that the number of cells per wave amplitude is the same the harmonic amplitudes and the phase shifts calculated by foamstar swense are compared with reference data in fig 21 from the top to the bottom the first to the fourth harmonic components the amplitudes are shown on the left and the phase shifts are shown on the right in each subplot the horizontal axis denotes the wave steepness the reference data include the third order analytical solution of malenica and molin 1995 referred to as analytical the experiment data reference huseby and grue 2000 referred to as exp two numerical results using fully nonlinear potential flow theory referred to as ferrant 1998 and shao et al shao and faltinsen 2014 to analyze these results the primary focus is put on the first harmonic amplitudes fig 20 a since it is dominant in general foamstar swense shows a very close agreement with experimental data this agreement suggests the accuracy of the proposed method in calculating the wave load when compared with the potential theory results of ferrant 1998 and shao et al shao and faltinsen 2014 foamstar swense shows also a good agreement at small wave steepness k a 0 1 for k a 0 1 foamstar swense is more accurate than the potential flow solvers since the two phase swense method is able to capture the flow separation and wake breaking near the cylinder see fig 21 where pt solvers encounter numerical difficulties li et al 2017 for the second harmonic amplitudes both foamstar swense and the experiment show the same decreasing trend when the wave steepness becomes larger the results are approximately 20 larger than the experimental data and are closer to experimental data than that of the potential flow solvers where they are available for the third and fourth harmonic amplitudes the comparison is better when the wave steepness is large for small wave steepness it is indeed more difficult because the magnitudes of the high order force are very small the oscillations appearing in the experimental data also confirm this difficulty for the phase shifts a good agreement is shown among the analytical solution and all the numerical results which are however different from the experimental data the reason for this discrepancy is still not clear shao and faltinsen 2014 but it may due to a setup slightly different in the experiment more specifically in consideration of the difference getting larger while the order increases it is possible that the beginning time of the experiment and the calculations are different to conclude this comparison demonstrates that the proposed two phase swense method is able to calculate the wave force on a simple structure for a large range of wave steepness the typical cylindrical mesh with coarse cells in the far field can be used to reduce the computational cost without influencing the accuracy 5 3 calm buoy in regular and irregular waves this part aims to demonstrate the ability of the two phase swense method in dealing with a more complex geometry and wave conditions geometry the catenary anchor leg mooring calm buoy rousset and ferrant 2005 contains a thin heave damping skirt violent free surface deformation and significant flow separation induced by such a geometry needs to be captured by the complementary field wave condition both regular and irregular wave conditions are used the irregular waves are obtained with hos nwt solver and reconstructed onto the cfd mesh to validate the reconstruction method proposed in sect 3 turbulence modeling the k ω sst turbulence model menter 1994 is used the non slip boundary condition is applied on the buoy with standard wall functions in openfoam liu 2016 in addition the accuracy and efficiency of foamstar swense and foamstar are compared in the regular wave condition the regular wave case and the experimental data have been published in a separated paper li et al 2019 to compare the mesh requirement of three different wave generation methods by using the wave forces and free surface elevations near the buoy in the present paper we compare also the instantaneous velocity field and the computational cost of both solvers in the following only the main configuration and results are recalled the reader can find a detailed description in reference li et al 2019 5 3 1 geometry and wave parameters the test case reproduces an experiment rousset and ferrant 2005 carried out in the ocean engineering basin of ecole centrale nantes 50 m long 30 m wide and 5 m deep the buoy is a truncated cylinder r 0 46 m with a thin skirt near the bottom to provide additional damping forces through vortex shedding see fig 22 regular and irregular wave conditions chosen from the experiment are listed in table 11 the irregular waves are generated with a jonswap spectrum with γ 3 the wave steepnesses are moderate and wave breaking is only expected near the buoy as a result of wave structure interaction 5 3 2 computational domain and meshes a cylindrical and three rectangular mesh configurations are used as shown in fig 23 the computational domain of all meshes is approximately the same with a longitudinal symmetry plane the cylindrical mesh is used by foamstar swense with the grid size gradually stretched in the far field however the cylindrical mesh is unsuitable for foamstar because the coarse cells in the far field deteriorate the incident waves for this reason a series of rectangular meshes are designed to compare foamstar and foamstar swense the grid resolution is presented in table 12 for the cylindrical case λ δ x and λ δ y represent the grid interval in the radial and the azimuthal directions in the far field please note that the rectangular meshes follow the common meshing strategy in uni directional wave cases i e the transverse direction is less resolved to reduce the number of cells near the buoy all the meshes have the same grid resolution the differences between the configurations in terms of spatial resolution are in the far field only 5 3 3 regular waves 5 3 3 1 comparison of the accuracy with wave forces after the periodic regime is established the forces are recorded during 7 wave periods the time history is transformed into the frequency domain the first and second harmonic amplitudes of the wave forces shown in table 13 are compared to show the accuracy of both solvers the forces are normalized with a k ρ g where a h 2 is the amplitude of the waves k the wavenumber and the displacement volume of the buoy at the designed draft the relative differences with respect to the experimental data are given in percentage in general both solvers provide consistent results with the experiment especially when the fine grid 80 is employed enlarging the grid space in the far field introduces larger errors however it is found that the results of foamstar swense are less sensitive to the far field mesh resolution than foamstar this difference can be found by comparing the first harmonic amplitudes of the horizontal wave force f x 1 x80 total cells 2 58 m the results of both solvers are in good agreement with the experiment foamstar gives slightly smaller predictions of the first harmonic amplitudes the foamstar swense result has a better agreement with the experiment x40 total cells 1 47 m foamstar swense is able to predict the wave force and elevation correctly with an accuracy of 1 whereas this difference is about 4 for foamstar x20 total cells 1 28 m this discretization is known to be too coarse to simulate waves in conventional ns solvers the coarse mesh causes excessive numerical diffusion and damps the incident waves for this reason foamstar predicts a force 13 5 smaller however foamstar swense s relative error is still within 2 5 cylindrical total cells 0 72 m this configuration is optimal for the swense method with only 0 72 million cells the results of foamstar swense is almost as accurate as the result of foamstar with 80 mesh 2 58 million cells for the first harmonic amplitude of the vertical waves force f z 1 a similar trend of convergence with mesh refinement can be found in the results of both solvers the discrepancies with respect to the experimental data are slightly larger than for the horizontal force f x 1 but foamstar swense shows a better accuracy than foamstar the simulations provide also consistent second harmonic forces f x 2 and f z 2 all simulation results fall close to the experimental data with a margin of approximately 30 as the second harmonics are two to three orders of magnitude smaller than the first harmonics larger relative errors are observed for both solvers and the influence of mesh resolution on the errors is less obvious it is thus difficult to comment on which solver is superior for the second harmonic force 5 3 3 2 comparison of the computational cost the computational times required by foamstar swense and foamstar are tested the results are listed in table 14 the computation is done with 24 2 5 ghz processors the wall clock time per wave period is compared table 14 first suggests that the computational time on the same mesh is similar for the two solvers this information suggests that the extra terms in the governing equations of swense and the associated calculations do not influence much the total computational time secondly foamstar swense shows a clear advantage when considering the computational time at the same accuracy foamstar swense with the 20 or the cylindrical mesh obtains the same level of accuracy as foamstar using the 80 mesh a speed up between 1 71 with x20 to 4 28 with the cylindrical mesh is achieved compare with foamstar using 80 mesh this speed up would be even much larger in multi directional wave cases in that scenario the mesh for foamstar could not be defined with a less resolved transversal direction while foamstar swense can still use the cylindrical mesh besides in an irregular wave case the mesh of foamstar has to be defined by the smallest wave length of the irregular wave spectrum and thus contains even more cells than the present case please note that the swense method is not designed to reduce computational cost by allowing larger timesteps the same cfl criterion should be set for both solvers since they convect variables with the same total velocity field in this test the same timestep 1 360 wave period is used for all the simulations the maximum cfl number is about 30 near the refinement zone of the skirt and the cfl number in the farfield is about 0 2 these values are coherent with other similar simulations ransley et al 2019 5 3 3 3 comparison of the flow field to ensure the correctness of the simulation especially to validate the result of foamstar swense on the coarse mesh the flow field of the simulation are compared fig 24 plots the total velocity magnitude u in the water obtained by foamstar and foamstar swense with 80 and 20 meshes respectively the velocity in the air is set to zero the results show identical flow behaviors in the vicinity of the buoy i e the same free surface shape vortex shedding near the thin skirt etc it shows clearly the present method s capacity to deal with rotational flow this good agreement between the two figures also confirms the equivalence of the swense and the nse 5 3 4 irregular waves this section aims to validate the swense method in irregular wave cases the force on the buoy is recorded and compared with the experimental data 5 3 4 1 incident waves the irregular waves are unidirectional generated according to a jonswap spectrum t p 2 0 s h s 0 12 m γ 3 the motion of the wave maker is provided to the hos nwt to calculate the incident wave field in the entire wave tank and then interpolated to the cfd mesh defined near the structure 5 3 4 2 computational domain the computational domain of this test case is illustrated by fig 25 the cylindrical mesh is the same one in the regular wave case with the same relaxation zone the simulation thus reproduces only the first 100 s of the experiment 5 3 4 3 results the comparison of the simulation results and the experimental data represented by the horizontal and vertical wave forces time history is shown in fig 26 a very good agreement is observed at the beginning of the simulation where the wave front does not reach the structure the wave forces remain zero after the wave arrival the simulated wave force curves are very close to the experimental data during most of the simulation time both the amplitudes and the phases are in good agreement fig 27 gives a focused view between t 61 s and t 64 s where a large wave group reaches the buoy the time histories of forces both in the horizontal and the vertical direction are in good agreement with the experimental data note that the simulation results have a peak value slightly larger than the experimental data it may be due to the overprediction of wave velocity in the crest related to the hos method ducrozet 2007 flow details near the structure are provided in fig 28 the free surface approximated by the contour of vof field α 0 5 is plotted colored by the free surface elevation η the time interval between each figure is 0 1 s violent free surface deformations wave breaking are observed near the structure at t 62 95 s a large runup occurs on the structure corresponding to the peak in the time history of force the wave breaking at t 63 1 s demonstrates that the present two phase swense method is able to treat violent free surface deformation 7 conclusion in this paper the two phase spectral wave explicit navier stokes equations swense method is proposed to improve the efficiency and accuracy of two phase cfd solvers when they are applied to wave dominated phenomena the method decomposes the total problem into an incident wave part and a complementary part only the latter part is solved by the cfd solver while the incident wave solution is provided by nonlinear wave models based on spectral representation this paper details the derivation of the two phase swens governing equations shows the assumptions and discusses their potential influence with the objective to make the present paper a theoretical reference of the two phase swense method the governing equations of the complementary part are established from the two phase navier stokes equations and a modified version of euler equations for incident waves a density weighted incident pressure field is proposed to solve the density mismatch problem when extending the incident wave fields above the free surface the proposed equations are mathematically equivalent to the two phase navier stokes equations and are able to keep the accuracy of the incident waves with coarse cfd mesh the solution of the euler equations is obtained by two spectral pt models assuming the velocity field is irrotational the stream function wave theory for regular waves and the hos method for arbitrary waves in open sea or in an experimental wave tank an accurate and efficient interpolation method to map the results of hos wave models onto the cfd mesh is proposed the method is able to reduce divergence error of the interpolated velocity field to meet the cfd solver s need without reprojection this interpolation method is made available for the public through an open source project grid2grid choi et al 2017 an implementation example is shown with a customized solver foamstar swense in openfoam based on an existing navier stokes solver foamstar the implementation is straight forward requiring only the modification of the governing equations the method is validated with three validation and application cases the incident wave propagation cases prove the essential advantage of the swense method i e allowing the use of coarse cfd mesh to simulate incident waves the swense solver can use a grid 4 times more coarse than that of the ns solver in each dimension to achieve the same accuracy for the application of incident waves the high order wave loads on a vertical cylinder calculated with the swense method agree well with the reference experimental and numerical results the convergence study shows a second order convergence behavior of the solver which is consistent with the numerical schemes used in openfoam note that if only the dominant order is considered the coarsest discretization can provide a good prediction with an error of less than 10 this property is useful to give a fast estimation of the wave force when the absolute accuracy is not very important e g in the early design stage the calm buoy case validates the accuracy of the method with complex flow phenomena and reveals its advantage in efficiency it is found that the additional cpu time to calculate the incident wave related terms in the swense method is negligible the proposed two phase swense method achieves a speed up between 1 71 and 4 28 compared with an ns solver on the regular wave case to achieve the same level of accuracy this speed up would be much larger in an irregular and or multi directional situation the present work contains the following limitations the incident waves are limited to non breaking waves propagating at a constant water depth due to the spectral wave models used here such limitations can be overcome in future developments by using advanced spectral wave models allowing wave breaking seiffert and ducrozet 2018 seiffert et al 2017 and variable water depth gouin et al 2016 the method is unsuitable for problems with important air effects in the present work the extended air velocity is nonphysical special treatments should be designed to correct this extended air field when the air effects cannot be neglected the present implementation approximates the interface position in the simplest manner vof contour α 0 5 in the future vof methods with interface reconstruction such as plic scardovelli and zaleski 1999 or sharp interface methods such as level set sethian and smereka 2003 can be considered to improve the accuracy the validation cases are limited to the calculation of the wave force on a fixed structure however in most marine and offshore applications a moving structure is of interest the next step of the work is to extend the two phase swense method to deal with moving structures and a first attempt of such an extension can be found in a recent international blind comparative study of wave structure interaction ransley 2020 most of the numerical implementation is based on open source codes openfoam openuser guide http 2018 hos ocean high order spectral metho 2018 hos nwt numerical wave tank based 2018 and grid2grid grid2grid 2018 the reader is encouraged to reproduce this work and go beyond the present limitations declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work has been performed in the framework of the chaire hydrodynamique et structure marines centrale nantes bureau veritas the first author acknowledges china scholarship council csc for the financial support for his ph d study the authors are indebted to dr vukčević prof jasak from university of zagreb and dr deng from ecole centrale nantes for their help in this work anonymous reviewers are also gratefully acknowledged appendix a problem with the direct subtraction of the euler equations this section shows the numerical difficulties appearing when the euler equation is directly subtracted from the two phase navier stokes equations recalling the ns momentum equation for two phase incompressible fluid eqn 6 u t u u p ρ g μ μ t u u t ρ the perfect fluid euler momentum equation eqn 9 reads u i t u i u i p i ρ i g to demonstrate the challenge we now subtract the two equations directly and simplify the viscous terms as in eqn 19 we obtain a57 u c t u c u c u c u i u i u c p c ρ p i ρ i p i ρ μ μ t u c u c t ρ the underlined terms are canceled out in the water since ρ ρ i however these terms have non zero values in the air phase they behave as source terms and affect the numerical stability appendix b comparison of level set and volume of fluid method the decomposed level set dls method vukčević et al 2016 and the standard volume of fluid method vof are compared here with a pure convection case the transporting velocity is the incident wave velocity obtained from pt same as in sect 5 1 the computational domain boundary conditions are also the same as in sect 5 1 five meshes are used three are the same as in sect 5 1 fine δ x δ z λ 200 h 40 medium δ x δ z λ 100 h 20 coarse δ x δ z λ 50 h 10 two coarser meshes are in addition δ x δ z λ 25 h 5 and δ x δ z λ 15 h 3 the measurement and postprocessing procedures are the same as in sect 5 1 fig 29 shows the first harmonic amplitudes of the free surface elevation nondimensionalised by the target value the dls method shows no advantages against the vof method the vof method creates only 1 error with the coarsest mesh δ x δ z λ 15 h 3 suggesting the vof method can work together with the swense method to reduce the mesh 
