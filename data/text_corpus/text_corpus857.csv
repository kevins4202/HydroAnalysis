index,text
4285,solar activity including sunspot number ssn and ei niño southern oscillation enso affect both surface and subsurface hydrological processes in arid semiarid regions of the world thus evaluating multi scale hydrological response to global climate changes can provide valuable information on regional water resources management and ecological restoration in this study we utilize wavelet coherence together with continuous wavelet transform to analyze the influence of ssn and enso on multiple interacting hydrological processes and distinguish nonstationary patterns in annual precipitation and extreme precipitation events and their effects on short term or long term streamflow variations and periodic flooding in xinjiang an arid semiarid region of china the results indicate that the climate in xinjiang has become wetter during the period 1960 2019 extreme precipitation events in xinjiang have significant oscillation periods at the 2 4 years band and stations with strong extreme precipitation events are located in northern xinjiang and tianshan mountain area while stations with weak extreme precipitation events are found in southern xinjiang the annual precipitation has significant multiple periodicities at the 2 7 year band at the 7 11 year band and at the 13 15 year band furthermore annual streamflow data for nine natural rivers all have significant dominant periodicities at inter annual scale of 2 4 year and 4 7 year band and monthly streamflow data for yarkand river has significant periodicities at intra annual scale of 3 7 month and 8 14 month band since evolution of annual streamflow variability and monthly streamflow variability all show direct response to precipitation features increasing extreme precipitation events significantly affect streamflow fluctuation of natural rivers in xinjiang overall ssn and enso is viewed as one of the main drivers for annual precipitation or extreme precipitation periodic variation by either enhancing or suppressing convection and the ssn and enso modulated precipitation anomaly contributes to significant streamflow variation or regional flooding disasters investigating the detailed linkage between interannual to multidecadal climate variability and hydrometeorological variables will help decision makers and scientists to better understand variability in regional hydrological processes which has great implications for water resources planning and operations in xinjiang under future climate uncertainty keywords solar activity ei niño southern oscillation extreme precipitation events streamflow inland arid semiarid region climate change 1 introduction climate change induced by human activities and its impacts on the hydrological cycle have become a vital issue for social and economic sustainable development and ecological health in particular precipitation and flows in streams and rivers may play a critically important role in the global energy and hydrological cycle that is critical for life on earth increasing evidences have shown that the hydrological variables including precipitation and water quantity are closely linked with global warming trends and the intensity frequency and duration of various climate extremes such as heavy precipitation heatwaves droughts floods and tropical and extratropical storms have occurred frequently ipcc 2014 tegegne et al 2020 over the past several decades the number and scope of extreme precipitation events increased significantly in both global and regional scales tong et al 2019 yang et al 2020 and a series of catastrophic natural disasters around the world such as a calamitous flood in central america in 1998 large scale snow disasters in china in 2008 and intense precipitation events in calgary and toronto in 2013 have become grave public concerns easterling et al 2000a tong et al 2019 wang et al 2014 thus exploring changes in extreme precipitation events can be conducive to monitor short term or long term streamflow variations and periodic flooding it is well known that solar radiation and plasma movement can be strengthened with many solar activities such as radiation bursts flares and solar winds which affect global climate changes li et al 2009 periodical activities of sunspot number ssn can lead to changes in earth s atmosphere both in terms of energy as well as its composition and further influence periodic change of hydrological variables in water cycle in direct and or indirect ways furthermore sunspot activity has a marked impact on the creation of large scale climate phenomena including ei niño southern oscillation enso atlantic oscillation and pacific decadal oscillation fu et al 2012 enso is a periodic climate phenomenon with strong direct effects on the variability of the hydrological cycle in many parts of the world therefore it is important to study global or regional changes in water resources caused by climate change solar active phenomena and or large scale climate phenomena from a long term perspective previously deng et al 2020 have disclosed that the periodic properties of solar activity have a wide range varying from a few days to several decades some studies have founded the similar periodicities or multi timescale characteristics to solar activity in many natural hydrological processes including precipitation and temperature time series lan et al 2020 yuan et al 2015 streamflow and suspended sediment discharge series wei et al 2016 drought flood time series wang et al 2015 moreover li et al 2009 quantified ssn s influences on natural runoff with a 11 year band in the yellow river li et al 2017 founded that close relationship with 16 year and 41 year scales between precipitation and ssn were identifiable in the loess plateau of china during 1951 2015 besides the impact of solar activity various studies have also quantified the correlation between enso and hydrological processes such as streamflow precipitation flood frequency and drought across different regions of the world chiew et al 1998 huo et al 2016a 2016b keener et al 2010 nalley et al 2016 wang et al 2015 2019 yang et al 2019 both solar activity and large scale climate phenomena have played crucial roles in regulating natural processes particularly hydrological processes but it is easy to confound their effects on multiple natural processes due to the direct influence of solar activity on large scale climate phenomena to quantify their contributions fu et al 2012 attempted to estimate the combined influence of solar activity and large scale climate phenomena on single hydrological variable streamflow across southern canada and founded that solar activity affected el niño first and this influence was then transferred by el niño to streamflow in addition li et al 2017 also tried to explore the response mechanisms of extreme precipitation events to solar activity and el nino events in typical regions of loess plateau of china however few studies sought to focus on direct or indirect influence of solar activity and large scale climate phenomena on multiple interacting hydrological processes for instance precipitation variability can affect changes in natural runoff of stream and river or flood occurrence and they are all influenced by solar activity and large scale climate phenomena in addition few catchment scale researchers have paid attention to the coupling of annual precipitation extreme precipitation events and streamflow or flood events and their responses to influence of solar activity and large scale climate phenomena in recent years wavelet analysis including continuous wavelet transform cwt cross wavelet transform xwt together with wavelet coherence wtc have been widely used for analyzing time series characteristics of climate change and multi scale hydrology agarwal et al 2016 fu and yao 2015 guo et al 2019 hao et al 2016 henderson et al 2009 huo et al 2016a 2016b xi et al 2018 however the wtc method has not yet been used extensively in multiple interacting hydrological processes in the arid semiarid region very recently rezaei and gurdak 2020 and nourani et al 2019 used wtc analysis based on cwt to identify the teleconnections between the large scale climate variability and hydrological processes in the lake urmia watershed of a semiarid region in iran they have also investigated the natural climate variability effects on the lake s hydro climate variables of precipitation temperature the lake level groundwater fluctuations soil moisture vegetation coverage and insolation clearness index however there are many remaining questions about the hydro climatic mechanisms affecting water resources in other similar arid semiarid region worldwide xinjiang is an outstanding example of an environmental tragedy in the arid central asia due to the special topographical features of three mountains and two basins and the unique natural environment pattern yao et al 2018 the distribution of water resources in xinjiang is highly uneven in recent decades flood events and drought events have occurred frequently and alternately in northern xinjiang and southern xinjiang mainly showing the characteristics of spring drought summer flood autumn lack and winter dryness since the late 1980s affected mainly by global or regional climate change especially extreme climate variability the flood disasters in xinjiang have shown an expanding trend which is manifested as an increase in the frequency and intensity of storm floods meltwater floods and cement flows furthermore under the influence of global warming the climate in xinjiang has experienced a dry to wet evolution in 1961 2019 and the increases of annual mean temperature annual total precipitation and extreme climate events in xinjiang are more significant than those in other typical regions of the same latitude as xinjiang wang et al 2020 zhang et al 2012 this is clearly different from the trend of dry get drier and wet get wetter in most other regions of the world under the background of climate warming ipcc 2013 therefore exploring changes in annual precipitation and extreme precipitation events can be conducive to monitor short term or long term streamflow variations and periodic flooding in this study an integrated assessment of linking multiple interacting hydrometeorological parameters to two non stationary climatic modes is provided the novelty of this paper is that it is one of the first analyses to focus on the coupling of precipitation extremes and discharge of streamflow or flooding events and their responses to these non stationary climate modes such as ssn and enso the main objectives in this study are to 1 explore the direct or indirect influence of climate variability at the inter annual level via ssn and enso on multiple interacting hydrometeorological parameters including eight extreme precipitation indices epis annual mean streamflow q a of nine natural rivers in an arid semiarid region of xinjiang northwest china 2 distinguish nonstationary patterns in annual precipitation and extreme precipitation events and their effects on short term or long term streamflow variations of nine natural rivers and periodic flooding of yarkant river under the influence of global warming and climate change 2 study area and data 2 1 study area the study area xinjiang uygur autonomous region 34 25 48 10 n 73 40 96 18 e the largest province in china is located in the eastern part of central asia it is an arid semiarid region in the northwestern china with an area of approximately 1 66 million km2 fig 1 two basins tarim and junggar basins are sandwiched between three mountain ranges kunlun tianshan and altai mountains forming unique geomorphic features of three mountains surrounding two basins yao et al 2018 the annual mean precipitation in xinjiang is 200 mm and water resources mainly come from rivers produced by precipitation and glacial snow meltwater in the mountainous regions thus investigating the hydrological processes under climate change scenarios is important for a number of issues including agriculture and water management in this region 2 2 data sources the daily climate datasets with a horizontal resolution 0 5 0 5 grid of 62 meteorological stations in xinjiang including daily temperature dataset and daily precipitation dataset during the period 1960 2019 were obtained from the national meteorological information center of the china meteorological administration http data cma cn data quality control such as checks on internal consistency and extremes were carried out using rclimdex 1 0 package in r version 3 5 3 more information about meteorological stations in xinjiang was introduced in table s1 the q a values of nine hydrological stations in xinjiang were derived from some published papers table 1 these hydrological stations located in different upper reaches of natural rivers and streams with pristine watersheds have a minimum record length of 47 years and good quality and reliable data in order to distinguish the interarea differences this paper takes q a of each station as the unit of study a time series recording of monthly stream discharge q m of kaqun hydrological station in upper reaches of yarkant river fu et al 2020 was used in flood frequency analysis the international ssn is obtained from the solar influences data analysis center sidc world data center for the sunspot index at the royal observatory of belgium brussels https wwwbis sidc be silso multivariate enso index version 2 mei v2 is used to represent enso events because it combines both oceanic and atmospheric variables limsakul and singhruck 2016 xi et al 2018 recent 1950 2019 monthly mei v2 data were obtained through the noaa national geophysical data center website https psl noaa gov enso mei 3 methodology 3 1 definition of extreme climate indices in this study eight epis were recommended on climate change detection and indices based on previous investigations sillmann et al 2013 tong et al 2019 xi et al 2018 the extreme climate indices were defined and described in detail in table 2 the epis covered max 1 day precipitation amount rx1day max 5 day precipitation amount rx5day heavy precipitation days r10 very heavy precipitation days r20 consecutive dry days cdd consecutive wet days cwd very wet days r95p and extremely wet days r99p these indices provided a rather complete and accurate description of precipitation change in xinjiang 3 2 long term trends and spatial patterns the non parametric sen s slope estimator sen 1968 was utilized to calculating the magnitude of the long term trend in epis on annual scale in xinjiang the statistical significance of the long term trend in each time series of climate indices in xinjiang at the 95 confidence level was evaluated using the non parametric mann kendall mk trend test mann 1945 kendall 1975 additionally the 5 year smoothing average is applied to explore the interannual changes of precipitation extremes and the spatial distribution maps of extreme precipitation events were produced by arcmap 10 2 to analyze the distribution of spatial trends of them 3 3 wavelet analysis recently wavelet analysis has been successfully used to decompose the non stationary hydro climatic time series into time frequency domain fu et al 2012 2021 liu et al 2017 2019 nalley et al 2016 nourani et al 2019 rezaei and gurdak 2020 cwt xwt and wtc are the three commonly used methods for the wavelet analysis to obtain useful time frequency information fu et al 2012 grinsted et al 2004 rezaei and gurdak 2020 the cwt with the morlet wavelet function was useful in detecting the dominant oscillation modes and different periodic components in each individual time series grinsted et al 2004 holman et al 2011 rashid et al 2015 rezaei and gurdak 2020 the xwt can show regions in time frequency space with high common power between two variables whereas the wtc can find regions in time frequency space where two variables covary without necessarily revealing high power keener et al 2010 maraun and kurths 2004 nalley et al 2016 xwt may not be useful to identify the possible links between two hydro climate processes if it is calculated by non normalized wavelet power spectrums although in some cases it also can be used to distinguish the phase spectrum and to identify some regions of high common power between times series nourani et al 2019 therefore in this study wtc based on cwt analysis was applied to estimate the existing correlation between any two hydrological variables of annual precipitation epis q a and q m in an arid semiarid region of xinjiang china and to determine the effect of both solar activity and large scale climate phenomena on coupling non stationary hydro climatic processes the morlet wavelet ψ 0 consists of a complex exponential function modulated by a derivative of the gaussian distribution function given by the following formula 1 ψ 0 t π 1 4 e i ω 0 t e t 2 2 where ψ 0 is the non dimensional wavelet value and ω 0 is the dimensionless frequency in respect to the dimensionless time t which adjusts the scale resolution hao et al 2016 pall et al 2018 torrence and compo 1998 the cwt of a time series x n n 1 2 3 n with uniform time steps δ t is defined by the following formula 2 w n x s δ t s n 1 n x n ψ 0 n n δ t s where δ t s is the normalization factor w n x s denotes the essential characteristics of a time series x n s is the wavelet scale n is the reversed time and ψ 0 is the morlet wavelet hao et al 2016 xi et al 2018 the cwt has edge artifacts because several real time series are not periodical to minimize the edge effects a decorrelation calculation known as the cone of influence is computed for each time series following the procedure described in torrence and compo 1998 the correlation coefficient of wtc between two time series is defined as follow torrence and webster 1999 3 r n 2 s s s 1 w n xy s 2 s s 1 w n x 2 s s 1 w n y 2 where r n 2 s represents the coherence coefficient with maximum coherence at 1 and no coherence at 0 s 1 is used to convert to an energy density s is a smoothing operator applied to both time and frequency which can be represented as das et al 2020 4 s w s scale s time w s where s scale represents smoothing along the wavelet scale axis and s time represents smoothing in time the time convolution is performed with a gaussian operator and the scale convolution is performed with a rectangular window one piece of important information that can be obtained from wtc plots is the dynamics and nature of the arrows which indicate phase shift and types of correlation i e positive in phase negative anti phase correlations between any two non stationary hydro climatic time series nourani et al 2021 some previous studies about wtc analysis have utilized directions of the arrows to indicate the degree to which the x n and y n series are in phase or anti phase in wtc carey et al 2013 fu et al 2012 jiang and yoon 2020 lee and kim 2019 huang and huang 2020 also the phase angle ϕ n s of the wtc can be used to analyze the lead lag relationships between the two series the phase angle is defined as torrence and webster 1999 5 ϕ n s tan 1 i s s 1 w n xy s r s s 1 w n xy s where ϕ n s π π the imaginary parts i and real parts r of the wtc have been computed in equation 3 both r n 2 s and ϕ n s are functions of the time index n and the scale s the directions of phase arrows in wtc pointing right ϕ n s 0 reveal that the x n and y n series are completely in phase while left pointing arrows ϕ n s π or π reveal that the x n and y n series are completely anti phase and up pointing arrows ϕ n s π 2 indicate that the x n and y n series have anti phase correlation and y n lags x n by 90 1 4 period length while down pointing arrows ϕ n s π 2 indicate that the x n and y n series have in phase correlation and y n leads x n by 90 1 4 period length see fig s1 and section s2 in the supplementary material for more details about phase angle conditions and lead lag relationship between the two series x n and y n in addition more detailed information of cwt and wtc algorithms is given by torrence and compo 1998 torrence and webster 1999 and grinsted et al 2004 and the relevant codes of matlab r2018a toolbox can be downloaded from https github com grinsted wavelet coherence 4 results 4 1 changes in extreme precipitation events temporal trends and spatial patterns of extreme precipitation events in xinjiang during the period 1960 2019 are presented in fig 2 rx1day rx5day r10 r20 r95p r99p and cwd significantly increase at rates of 0 64 mm decade 1 02 mm decade 0 25 days decade 0 07 days decade 3 13 days decade 1 14 days decade 0 07 days decade respectively while cdd significantly decreases by 4 67 days decade fig 2 a1 h1 table s2 at the spatial scale both rx1day and rx5day decrease from northwestern to southeastern in xinjiang peak at northern slope of tianshan mountain fig 2 a2 and b2 the rate of change in cwd andr20 indicators of tianshan mountains are higher than those in other areas fig 2 g2 and d2 these results indicate that the precipitation in tianshan mountain has a significant increase over the past 60 years in addition significant increases occur in the foot of tianshan mountain for all epis except for cdd change in cdd of meteorological stations distributed around the taklamakan desert is more obvious than those in other areas in xinjiang fig 2 h2 the cwt analysis results from the departure time series of the epis variables in xinjiang are shown in fig 2 and table 3 notably all the epis variables in xinjiang have similar areas of significant periodicities of 2 4 year but the strong variations across the 2 4 year period band in rx1day rx5day r10 r20 r95p r99p are higher than cwd and cdd and cwd shows relatively weak periodicity with lower variance fig 2 for example rx1day rx5day r10 r20 and r95p all show significant periodicities at scales of up to about 4 years during the mid late 1990 s and from 2007 to 2013 fig 2 a3 b3 c3 d3 and e3 whereas r99p shows strong power at periodicities of 2 6 years only during 2003 2015 fig 2 f3 furthermore significant periodicities during the late 1970 s or late 1980 s are observed for scales between 2 and 3 years for cwd and cdd fig 2 g3 and h3 besides significant inter annual variability with longer periodicities at scales of 4 6 year in roughly the mid late 1980 s are observed for rx1day and rx5day fig 2 a3 and b3 but r95p and r99p during the mid late 2000 s or the early 2010 s fig 2 e3 and f3 4 2 variability in annual runoff and its response to annual precipitation the original annual mean streamflow q a and their cwt spectra for nine natural rivers are shown in figs 3 and 4 respectively the q a values of hydrological stations in southern slope of tianshan mountain all reveal clear upward trends in northern slope of tianshan mountain the q a values of stations nt1 and nt3 show increasing tendency fig 3d and f during the last several decades the q a of station kl1 increases considerably in contrast to those in stations at1 and kl2 fig 3a c therefore our results suggest that climate change with the wetter climate in xinjiang is considered as primary causes of increased runoff in the headstreams in addition significant regions in the cwt spectra of q a are sorted into two main periodicities smaller than 4 years 2 4 year and 4 years 4 7 year fig 4 and table 3 remarkably regions of significant periodicities for q a occur at different times for different stations as is shown in fig 4 and table 3 the q a of nine hydrological stations can be categorized into three groups group 1 including at1 nt1 nt3 st1 and st2 only has moderate variations at the periods of smaller than 4 years group 2 including kl1 and kl2 only shows moderate to relatively strong variations at the periods of 4 years group 3 including nt2 and st3 not only has the smaller periods 2 4 year but also has the larger periods 4 7 year of all the hydrological stations of concern here station kl1 has the strongest variations of significant long periodicities exceeding 4 years concentrated in 1965 1968 1973 1981 and 2005 2009 these variations shown by the thick black contour lines denote statistical significance at the 95 confidence level to explore relations between precipitation and runoff response in the arid semiarid region xinjiang of china nine corresponding meteorological stations namely a9 a52 a54 a15 a16 a17 a30 a33 a44 are used for the precipitation runoff analysis in the mentioned hydrological stations at1 kl1 kl2 nt1 nt2 nt3 st1 st2 st3 respectively the cwt spectra of the annual precipitation of nine meteorological stations in xinjiang show significant periodicities around 2 4 year for a9 a15 a17 a30 a33 a44 a52 and a54 around 4 7 year for a15 a16 a30 a52 a54 around 7 11 year for a33 and a52 and 13 15 year for a17 fig 5 and table 3 annual precipitation variability of stations a52 and a54 show stronger powers at periodicities of 2 11 year from1980 to 2006 fig 5b and 4 7 year from 1980 to 1993 fig 5c respectively annual precipitation variabilities of nine meteorological stations in xinjiang are significantly affected by the cycles of ssn occurring at 5 13 years in fig s2 and enso occurring at 2 7 years in fig s2 which are consistent with previous studies fu et al 2012 li et al 2017 nalley et al 2016 annual precipitation units mm yr 1 and annual mean runoff units mm yr 1 for several decade catchment records indicate notable variability in their timing magnitude and synchrony fig 6 and table 4 originating from the northern slope of tianshan mountain the upstream of bortala river is the wettest site compared with other rivers with annual mean precipitation of wenquan station having 232 14 mm yr 1 fig 6d kunmalike originates from southern slope of tianshan mountain and the annual mean runoff upstream of xiehela is 389 52 mm yr 1 fig 6h in catchments with significant snow storage such as kl1 kl2 nt1 nt2 nt3 st1 and st2 annual runoff is usually larger than annual precipitation table 4 because recorded annual precipitation does not reflect accumulated snow storage melt and delayed water delivery in addition underestimation of precipitation due to the sparse gauging network in high elevations is one possible reason for the discrepancy between the annual runoff and annual precipitation li et al 2020 the wtc spectra of annual precipitation and annual streamflow data are presented in fig 7 and table 5 the q a of station at1 likely has the strongest coherence with annual precipitation of station a9 at a significant periodicity of 2 19 year fig 7a the signals from a9 and at1 are in phase right pointing arrows in fig 7a which reveals the significant influence of precipitation of station a9 on the streamflow variability of station at1 furthermore a zero phase angle phase angle ϕ n s 0 means that the two underlying time series q a of station at1 and annual precipitation of station a9 move together at a specific scale the q a of station nt2 also has in phase correlation with the annual precipitation of station a16 at multiple periodicities of 2 6 year band during 1963 1975 1985 1992 1997 1997 and 2001 2008 4 7 year band during 1976 1998 and 10 19 year band during 1972 1992 fig 7e and right upward arrows with phase angle ϕ n s 0 π 2 suggest that the response pattern of annual precipitation leads that of time series q a furthermore we find similar in phase correlation for the wtc spectra of a17 nt3 and a44 st3 and q a lags precipitation by 0 1 8 period length fig 7f and i however close anti phase correlation for the precipitation runoff analysis of a52 kl1 a54 kl2 a30 st1 and a33 st2 in wtc results for each region are seen in fig 7b c g and h in the long term annual precipitation shows a clear leading effect on the q a of station kl1 and kl2 for a specific time and frequency compared with stations st1 and st2 in addition the q a of station nt1 has anti phase correlation up pointing arrows at the 2 3 year band from 1967 to 1974 with the annal precipitation of station a15 but has some significant regions with in phase correlation right pointing arrows for the 95 confidence level at the 2 3 year band from 1981 to 1983 at the 3 6 year band from 1998 to 2007 and at the 6 8 year band from 1969 to 1972 fig 7d also observed arrows pointing upward phase angle ϕ n s π 2 and right upward phase angle ϕ n s 0 π 2 indicate that annual precipitation of station a15 leads the q a of station nt1 by 0 1 4 period length 4 3 variability in monthly runoff and seasonality based record flood peak originating in karakorun mountains yarkand river is a typical inland river in xinjiang and flows are mainly derived from snow ice melt fu et al 2020 seasonality based monthly discharge and the record flood peak of kaqun station kl1 located near the mouth of yarkand river from 1970 to 2017 is presented in fig 8 the record flood peak over a 48 years observation period from the station kl1 is 1240 m3 s and occurred on august 1984 and the second largest flood peak in a stream gaging record over the same period is 1230 m3 s on july 1994 the q a of station kl1 exceeding 3500 m3 s occurred in 1994 and 2012 in addition the q a of station kl1 in 1973 1978 2005 2006 2008 and 2013 all exceeded 3000 m3 s fig 8a the flow of yarkand river has significant seasonal variations and summer flows are quite high whereas flows during the winter are limited the calculated runoff corresponding to 70 96 annual runoff frequencies occur in flood season june september using the 48 years runoff record from the station kl1 fig 8b the cwt spectra of q m data shows high wavelet power or significant regions at periodicities of around 3 7 month and 8 14 month band from 1970 to 2017 fig 8c which indicates that there are significant intra annual scale and the strong seasonality patterns of non stationary monthly streamflow data for station kl1 4 4 coherence between ssn enso and epis in the arid semiarid region wtc results between ssn and epis in xinjiang are shown in fig 9 and table 6 all epis have regions of statistical significance at the 95 confidence level ssn has common periodicities with rx1day rx5day r10 r20 r95p and r99p at the 2 5 year band fig 9a f and the in phase correlations phase angle ϕ n s 0 π 2 at the 2 3 year band indicate that the ssn leads these epis by 0 1 4 period length while anti phase correlations phase angle ϕ n s π 2 π at the 3 5 year band indicate that the ssn has not clear leading relationship with these epis moreover ssn has close in phase correlations with rx1day r10 r20 and r95p in the 8 12 year band phase angle ϕ n s π π 2 fig 9a c e in phase correlations between ssn and cwd are observed during 1999 2002 2 4 year band and 1995 2003 11 13 year band when phase angle remain within the range of π 2 to 0 whereas anti phase correlations are between the two groups at the 2 4 year band from 2012 to 2015 fig 9g when phase angle is larger than π 2 compared with cwd in the similar band ssn s influence on cdd in fig 9h is concentrated on two periods 1971 1975 revealing anti phase relations phase angle ϕ n s π π 2 between ssn and cdd at the 2 3 year band 1987 1991 showing in phase relations phase angle ϕ n s π 2 0 between ssn and cdd at the 2 3 year band 1976 1984 also demonstrating in phase relations with the same phase angle between ssn and cdd in the 4 5 year band wtc results between enso and epis in xinjiang an arid semiarid region of china are shown in fig 10 and table 7 it is evident that anti phase correlations between enso and all epis except for cdd have been observed at the 2 3 year band since the early 1990s and arrows with phase angle ϕ n s π π 2 reveal enso leading epis by 1 4 1 2 period length however as shown by the correlation analysis in fig 10 the positive influences of enso on all epis except for cdd are significant and focused mainly on the interdecadal scale at the 4 year band rx1day rx5day r10 and r95p have close in phase relations at the 95 confidence level in the 2 4 year band from mid 2000s to mid 2010 s also a zone phase angle the arrow is between the time series enso r10 enso r20 and enso r95p at the 3 4 year band and between the two series enso r99p at the 4 8 year band indicate that the two underlying series have positive correlation and move together at the 4 year band enso has close in phase regions with high wavelet are observed at the 4 6 year band from mid 1980 s to 1996 with rx1day and rx5day at the 4 7 year band with r20 and r95p from 1984 to 2000 or the early 2010s and at the 5 7 year band with r10 from 1988 to 2002 furthermore the close in phase correlations between rx1day rx5day cwd and the enso event are clearer at the greater time scales higher than 7 years from 1990 to 2006 and these three epis lags enso by 1 8 period length in addition the cdd as an index for assessing seasonal drought demonstrates the anti phase correlations with enso at the 2 3 year band during 1987 1992 and at the 5 7 year band during 1970 1981 but show the in phase correlations with enso at the 3 5 year band fig 10 h also arrows with phase angle ϕ n s 0 π 2 indicate that enso leads cdd during 1993 2000 and 2009 2013 4 5 coherence between ssn enso and q a in the arid semiarid region the wtc spectra between ssn enso and q a for the nine stations with record length 47 years are exhibited in fig 11 and table 8 the influence of ssn and enso at the inter annual scale on q a is clearly observed and a possible time delay between streamflow and two climate patterns is significantly different as shown in fig 11 g1 and g2 no close correlation between ssn enso and q a for station st1 are observed at the 2 5 year band with the 0 8 0 9 coherency value between the periods 1988 2001 1998 2003 and 2005 2010 ssn and q a for station at1 have shown close anti phase correlations fig 11 a1 and enso and q a for station at1 have also shown similar anti phase correlations between the periods 1982 1989 and 2009 2012 fig 11 a2 through phase comparison similar anti phase correlations between ssn enso and q a of kl2 and st3 can be verified in fig 11 c1 c2 and i1 i2 at the 2 6 year band from mid 1960 s to mid 1980 s or from mid 1990 s to mid 2000 s kl1 has shown anti phase correlations with ssn at the 2 6 year band 1970 1987 in fig 11 b1 and enso at the 2 4 year band 1962 1975 in fig 11 b2 while the correlations are almost typically in phase between ssn and q a at the 4 6 year band from 1994 to 2004 fig 11 b1 and between enso and q a at the 11 12 year band from 1987 to 1991 fig 11 b2 at the 2 6 year band the effects of enso on q a of station nt2 are concentrated on four periods fig 11 e2 1961 1964 and 1998 1999 where anti phase correlations are seen at the 2 3 year band 1965 1975 revealing in phase correlations at the 3 5 year band 1976 1994 showing in phase correlations at the 2 5 year band and 2005 2009 showing anti phase correlations at the 2 4 year band however compared with enso ssn only has close anti phase correlation with q a of station nt2 at the 2 5 year band from 1984 to 1993 fig 11 e1 these results illustrate the potential strong influence of enso on q a of station nt2 in this region than ssn notably at the 2 4 year band the q a of station nt3 has close anti phase correlations with ssn in the wtc spectra extending from 1958 to 1970 and from 1974 to 1981 and has in phase correlations with ssn in the wtc spectra extending from 2001 to 2003 but mainly has in phase correlations with enso in the wtc spectra extending from 1972 to 1973 compared to ssn fig 11 f1 f2 consistent with the relationships between ssn enso and q a of station nt3 close anti phase relations between ssn and q a of station nt1 during 1968 1973 2 4 year band 1986 1989 3 4 year band and close in phase correlations between ssn and q a of station nt1 during 1998 2005 2 4 year band and close in phase correlations between enso and q a of station nt1 during 1986 2000 3 6 year band are observed in fig 11 d1 d2 these results all show the extensive influence of ssn on q a of nt1 and station nt3 than enso in addition ssn has negative influence anti phase relations on q a of station st2 at the 2 4 year band from 1977 to 1984 however in addition to the negative influence on q a at the 2 3 year band from 1978 to 1982 enso also has positive influence in phase relations on q a of station st2 at the 4 5 year band from 1971 to 1975 fig 11 h1 h2 to further concisely determine the influences of periodic climate phenomenon on annual streamflow variability of nine rivers in xinjiang we employ the phase angle analysis to investigate the lead lag effects of these hydrometeorological variables through phase comparison in fig 11 and table 8 all values for the phase angle between enso and q a of stations at1 kl2 nt3 and st3 remain within the range of π to π 2 or 0 to π 2 for all sub periods implying that enso leads q a of these hydrological stations however enso is not leading q a of stations kl1 nt1 nt2 and st2 for all sub periods but only in the time scale of 2 4 year in addition the results of wtc analysis indicate that the co movement and leading effects of ssn and q a of stations at1 kl1 nt1 and nt3 is not uniform over time and across time scales and ssn has not clear leading effects with q a of stations kl2 nt2 st2 and st3 4 6 coherence between epis and q a in the arid semiarid region there is no doubt that difference in periodic changes of headstream runoff may be directly influenced by the observed variability of precipitation extremes due to solar activity and climate change in addition extreme precipitation events appear to be mostly responsible for streamflow variability herein we take kl1 as an example to study the teleconnections and coherence between epis and q a in the arid semiarid region fig 12 and table 9 as is shown in fig 12 rx1day r10 r20 r95p and r99p have weakly negative effect anti phase relations on q a at the up to 4 year band from the mid late 1960 s or early 1970 s fig 12a 12 f furthermore a moderate coherence for anti phase correlations between epis except for rx5day r99p and cdd and q a is concentrated at the 4 year period fig 12a 12 e and g however in phase relationships at the 2 3 year band are observed between epis except for r99p and cdd and kl1 s annual streamflow after 2000 the correlations between cwd cdd and q a are just the opposite in some similar periods such as at the 2 4 year band from 2005 to 2014 the q a of station kl1 has a close in phase relation with cwd but has a close anti phase relation with cdd at the 5 10 year band from 1998 to 2008 the q a of station kl1 has a close anti phase relation with cwd but has a close in phase relation with cdd fig 12g and h in addition compared with cwd cdd has a close anti phase correlation with q a at the 4 7 year band from 1974 to 1982 fig 12h from wtc analysis between extreme precipitation events and annual streamflow variability of station kl1 some interesting results are revealed there are obvious lead lag relationships between all epis and q a and q a lags all epis by 1 4 1 2 period length at intermediate and greater time scales 5 10 year the results from the wtc analysis between epis and q a of at1 kl2 nt1 nt2 nt3 st1 st2 and st3 are presented in the supplementary material section s4 and figs s3 s10 table s3 s10 5 discussion changes in the spatial extent duration intensity and frequency of various extreme weather and climate events are closely relevant to this study and similar previous investigations easterling et al 2000b sun et al 2016 we select eight valuable epis in xinjiang to investigate the spatiotemporal evolution and periodic oscillation characteristic of extreme precipitation events during 1960 2019 over such a 60 years period the precipitation in xinjiang has been increasing and the climate has become wetter moreover extreme events of heavy precipitation often occur more frequently zhang et al 2012 reported that the occurrence of extremely low precipitation decreased or slightly increased while the occurrence of extremely high precipitation increases significantly in xinjiang after 1980 due to the special terrain structure of three mountains and two basins in xinjiang significant differences in spatial distribution of extreme precipitation events still exist tianshan can be regarded as the boundary between the northern and southern regions of xinjiang and has a huge impact on the distribution and changes of extreme precipitation after all the north atlantic and the arctic ocean are the main sources of water vapor for xinjiang in summer zhang et al 2012 water vapor reaches xinjiang from north and the mediterranean sea and caspian sea are also the sources of water vapor of xinjiang zhang et al 2012 the frequency of the extreme precipitation variables in the northern foot of tianshan mountains and northern xinjiang shows an overall increasing trend and gradually decreases from tianshan mountains and northern xinjiang to southern xinjiang moreover the areas around taklamakan desert experience very low intensity and low frequency precipitation events and the drought is the worst in southern xinjiang than other areas cdd is the largest in southern xinjiang for instance rx1day and rx5day have similar spatial patterns with the changing trends stronger in the northern xinjiang than in the southern xinjiang moreover the spatial distribution of extreme precipitation shows a pattern of more north and less south and the northern xinjiang is wetter than southern xinjiang northern xinjiang is more prone to heavy precipitation extremes while southern xinjiang is more prone to weak precipitation extremes in general mountainous areas are wetter than plains in addition all extreme precipitation events have clear inter annual variability with significant oscillation periods at 2 4 years band during the period 1960 2019 thus the wetting trend in xinjiang may be a local manifestation of global multivariate climate change streamflow variability in xinjiang the largest inland arid semiarid region in china is critical to local hydrological cycle the long term variability in streamflow of nine hydrological stations provide insight into marked climate change in xinjiang the q a values for nine natural rivers are mainly dominated by the 2 4 and 4 7 year activity and have significant inter annual variability on basin scale the q a for the stations distributed at tianshan mountain and karakorum mountain have significantly positive trends and the stations with significantly negative trends of annual streamflow are mostly occurred at altai mountain and kunlun mountain in addition the q a for the stations originated from the southern slope of tianshan mountain have more sizable increase than those from the northern slope of tianshan mountain the phenomenon may be related to a greater contribution of meltwater of glaciers and snow on the southern slope of tianshan mountain because the south facing glaciers located on the southern slope of tianshan mountain can receive more solar energy in contrast to the north facing glaciers situated on northern slope of tianshan mountain the ssn record since 1749 is usually recognized as a periodicity of 11 year oscillation scafetta 2012 while the enso is described as having a periodicity of 2 7 year oscillation keener et al 2010 such oscillations have several influences on hydrometeorological variables including annual precipitation precipitation extremes and streamflow the cwt spectrums of the annual precipitation of mentioned meteorological stations in xinjiang have significant periodicities at the 2 7 year band which belongs to the periodic scope of enso and have significant multiple periodicities at the 7 11 year band and the 13 15 year band which belongs to the periodic scope of ssn illustrating the combined influence of solar activity and large scale climate phenomena on precipitation variability in xinjiang during 1960 2019 the wtc analysis suggests that extreme precipitation events and streamflow in xinjiang all have good responses to solar activity and large scale climate phenomena in general both ssn and enso s impacts on all epis in xinjiang at the 2 7 and 11 year bands are common and similar besides the epis have resonance cycles in the wtc of 11 2 year bands with ssn and also show significant resonance cycles in the wtc of 2 7 year bands in accordance with enso through phase comparison figs 9 and 10 tables 6 and 7 due to the heterogeneous non stationary behavior of large scale climate phenomena including ssn and enso events phase lags are statistically different between two large scale climate phenomena and extreme precipitation events at the several frequency bands in xinjiang the q a of most hydrological stations in xinjiang have periodicities of 2 7 year consistent with both ssn and enso but compared with enso and q a there is no uniform lead lag effect between ssn and q a over time and across time scales considering that the solar activity including ssn has a significant long term impact on enso solar activity s influences may be transferred by enso to precipitation extremes or streamflow variability at the 2 7 year band similar studies also have confirmed that enso plays a vital link between solar activity and surface or subsurface hydrological patterns dong et al 2018 fu et al 2012 enso is the primary climate mode occurring in the tropics owing to its ability to influence global temperature and precipitation which in turn affects the hydrological cycle and ecological environment garcia villada et al 2020 common areas of shared power between multivariate enso index and the hydrological variables including epis and q a for hydrological stations have been founded in xinjiang over the past several decades enso periodically fluctuates between three phases el niño la niña or neutral and strong evidence has founded that the three phases of enso have significantly different impacts on the frequency of extreme climate events and crop yield variability garcia villada et al 2020 júnior et al 2020 el niño referred to as the warm phase of enso and la niña referred to as the cold phase of enso are opposite phases of the enso pattern and the transitional period when el niño or la niña occurs or leaves can also become an important factor in precipitation extremes variability and streamflow variability by affecting teleconnection the current study reveals that precipitation extremes and streamflow in xinjiang are mainly influenced by the 2 4 year and 4 7 year activity and the influences of 11 years activity has also been founded in general compared with ssn enso shows a clear leading effect on precipitation extremes variability and annual streamflow variability in an arid semiarid region xinjiang of china for a specific time and frequency which indicates that enso may play a key role in determining the indirect influence of ssn on these hydrological processes in xinjiang due to the arid semiarid climate characteristics some hydrological processes including precipitation glaciers and snow cover melt streamflow transport and flooding events contribute significantly to runoff and provide the freshwater supply for residents the annual runoff in the upper reaches of main natural rivers in xinjiang shows a significant increase accompanied by an increase of annual precipitation since the 1960s the distribution of annual precipitation changes is consistent with the distribution of stations with significant increase in streamflow showing the considerable impact of annual precipitation changes on annual streamflow variability at a period of the 2 4 year band in wtc spectrums between annual precipitation and q a all hydrometeorological stations in xinjiang show strong coherency related to the annual signals of precipitation and streamflow reflecting coupling patterns of precipitation and runoff also there is less than a quarter period lag between annual precipitation and q a time series for the majority of hydrometeorological stations suggesting that annual precipitation changes have a clear connection with annual runoff fluctuations in the arid semiarid region xinjiang of china in addition the wtc spectra between epis and q a shows that response of precipitation extremes to streamflow runoff can be explained by the form of lead lag relations instead of absolute in phase or anti phase relations taking station kl1 as an example observed left downward arrows between the epis except for r99p and the q a at the 3 4 year or 5 10 year frequency bands indicate that q a lags epis by approximately three eighths period length meaning that extreme precipitation events fluctuations significantly alter q a fluctuations with a 13 5 18 month or 22 5 45 month time lag moreover the effects of the epis on the streamflow have various phase angle conditions occurred in different years our results also indicate that increase in precipitation contribute to the increase of annual runoff of these catchments in the typical arid semiarid region of xinjiang in china and temporal variability of streamflow in natural rivers are caused by multiple extreme precipitation events which is seen to be linked to enso and solar activity furthermore our results also suggest that climate change with the wetter climate in xinjiang was considered as primary causes of increased runoff in the headstreams while human activities may play a dominant role in decreased runoff in the headstreams from 1960 to 2019 the conclusion is consistent with previous research about the dominant causes for annual runoff evolution in the headstream of main rivers in xinjiang li et al 2020 ling et al 2011 2014 qin et al 2016 tao et al 2011 yang et al 2018 6 conclusions the present study selects xinjiang of china as a typical inland arid semiarid region to study spatiotemporal variability for the indices of extreme precipitation events and the multi scale features of runoff variability over the past six decades it further explores significant periodicities of hydrological processes including annual precipitation extreme precipitation events and annual monthly streamflow characteristics using the cwt approach and investigates the detailed linkage between the evolution of interannual to multidecadal climate variability and multiple interacting hydrological processes using wtc approaches the main conclusions are as follows 1 the extreme precipitation events in xinjiang have been increasing during the a 60 years period of 1960 2019 and the climate has become wetter all extreme precipitation events had clear inter annual variability with significant oscillation periods at a 2 4 years band during such a 60 years period moreover strong extreme precipitation events are mostly concentrated in northern xinjiang and tianshan mountain while weak precipitation events often occur in southern xinjiang 2 long term records of annual streamflow data reveal that the q a values for nine natural rivers in xinjiang have dominant periodicities of 2 4 and 4 7 year in the cwt spectra streamflow of headstreams in the upper reaches originated from tianshan mountain and karakorum mountain show obvious increasing trends as compared with streamflow in other mountain areas furthermore significant periodicities for the q m of station kl1 at the intra annual scale of 3 7 month and 8 14 month band during 1970 2017 also are found which showing the strong seasonality patterns of non stationary monthly streamflow variability and seasonality based record flood peak 3 the variability in the headstream runoff shows a nice correlation to precipitation indicating that increases in precipitation attributed to variability in streamflow the wtc spectra between epis and q a shows that response of precipitation extremes to streamflow runoff can be explained by the form of lead lag relations instead of absolute in phase or anti phase relations since the precipitation is regarded as the crucial elements of streamflow variation the response of hydrological features mainly occurs in the rainy season june september and the influence can contribute to the occurrence of flood events in summer due to the extreme precipitation events with higher frequencies 4 long term variability in extreme precipitation events and periodic streamflow in xinjiang are primarily driven by solar activity and enso climate change in xinjiang is a primary factor driving increased runoff in the headstreams of natural river in xinjiang whereas the negative runoff trend in the headstreams of natural river in xinjiang may be influenced by human activities and climate change overall this paper reflects multi scale response characteristics of the variability of long term historical records of hydrological data to climate change on different time scales in the arid semiarid region such as xinjiang and provides an important scientific foundation for designing best practice strategies for water resource management and ecological restoration in similar arid semiarid basins around the world credit authorship contribution statement lin zhang conceptualization methodology validation formal analysis investigation data curation writing original draft visualization yanfeng liu conceptualization methodology validation formal analysis supervision writing review editing hongbin zhan conceptualization methodology validation formal analysis supervision writing review editing menggui jin conceptualization resources supervision writing review editing project administration funding acquisition xing liang conceptualization methodology validation formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the national natural science foundation of china no 41672246 and the fundamental research funds for the central universities china university of geosciences wuhan no 1910491t05 thanks are due to mr feng zhao mrs yining sun and mrs jie gao of china university of geosciences for helping with the meteorological data collection we gratefully acknowledge the contribution of mrs yixin wu of central china normal university for insightful statistical advice we sincerely thank editor and five anonymous reviewers who have provided constructive comments and suggestions for improving the manuscript appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126630 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4285,solar activity including sunspot number ssn and ei niño southern oscillation enso affect both surface and subsurface hydrological processes in arid semiarid regions of the world thus evaluating multi scale hydrological response to global climate changes can provide valuable information on regional water resources management and ecological restoration in this study we utilize wavelet coherence together with continuous wavelet transform to analyze the influence of ssn and enso on multiple interacting hydrological processes and distinguish nonstationary patterns in annual precipitation and extreme precipitation events and their effects on short term or long term streamflow variations and periodic flooding in xinjiang an arid semiarid region of china the results indicate that the climate in xinjiang has become wetter during the period 1960 2019 extreme precipitation events in xinjiang have significant oscillation periods at the 2 4 years band and stations with strong extreme precipitation events are located in northern xinjiang and tianshan mountain area while stations with weak extreme precipitation events are found in southern xinjiang the annual precipitation has significant multiple periodicities at the 2 7 year band at the 7 11 year band and at the 13 15 year band furthermore annual streamflow data for nine natural rivers all have significant dominant periodicities at inter annual scale of 2 4 year and 4 7 year band and monthly streamflow data for yarkand river has significant periodicities at intra annual scale of 3 7 month and 8 14 month band since evolution of annual streamflow variability and monthly streamflow variability all show direct response to precipitation features increasing extreme precipitation events significantly affect streamflow fluctuation of natural rivers in xinjiang overall ssn and enso is viewed as one of the main drivers for annual precipitation or extreme precipitation periodic variation by either enhancing or suppressing convection and the ssn and enso modulated precipitation anomaly contributes to significant streamflow variation or regional flooding disasters investigating the detailed linkage between interannual to multidecadal climate variability and hydrometeorological variables will help decision makers and scientists to better understand variability in regional hydrological processes which has great implications for water resources planning and operations in xinjiang under future climate uncertainty keywords solar activity ei niño southern oscillation extreme precipitation events streamflow inland arid semiarid region climate change 1 introduction climate change induced by human activities and its impacts on the hydrological cycle have become a vital issue for social and economic sustainable development and ecological health in particular precipitation and flows in streams and rivers may play a critically important role in the global energy and hydrological cycle that is critical for life on earth increasing evidences have shown that the hydrological variables including precipitation and water quantity are closely linked with global warming trends and the intensity frequency and duration of various climate extremes such as heavy precipitation heatwaves droughts floods and tropical and extratropical storms have occurred frequently ipcc 2014 tegegne et al 2020 over the past several decades the number and scope of extreme precipitation events increased significantly in both global and regional scales tong et al 2019 yang et al 2020 and a series of catastrophic natural disasters around the world such as a calamitous flood in central america in 1998 large scale snow disasters in china in 2008 and intense precipitation events in calgary and toronto in 2013 have become grave public concerns easterling et al 2000a tong et al 2019 wang et al 2014 thus exploring changes in extreme precipitation events can be conducive to monitor short term or long term streamflow variations and periodic flooding it is well known that solar radiation and plasma movement can be strengthened with many solar activities such as radiation bursts flares and solar winds which affect global climate changes li et al 2009 periodical activities of sunspot number ssn can lead to changes in earth s atmosphere both in terms of energy as well as its composition and further influence periodic change of hydrological variables in water cycle in direct and or indirect ways furthermore sunspot activity has a marked impact on the creation of large scale climate phenomena including ei niño southern oscillation enso atlantic oscillation and pacific decadal oscillation fu et al 2012 enso is a periodic climate phenomenon with strong direct effects on the variability of the hydrological cycle in many parts of the world therefore it is important to study global or regional changes in water resources caused by climate change solar active phenomena and or large scale climate phenomena from a long term perspective previously deng et al 2020 have disclosed that the periodic properties of solar activity have a wide range varying from a few days to several decades some studies have founded the similar periodicities or multi timescale characteristics to solar activity in many natural hydrological processes including precipitation and temperature time series lan et al 2020 yuan et al 2015 streamflow and suspended sediment discharge series wei et al 2016 drought flood time series wang et al 2015 moreover li et al 2009 quantified ssn s influences on natural runoff with a 11 year band in the yellow river li et al 2017 founded that close relationship with 16 year and 41 year scales between precipitation and ssn were identifiable in the loess plateau of china during 1951 2015 besides the impact of solar activity various studies have also quantified the correlation between enso and hydrological processes such as streamflow precipitation flood frequency and drought across different regions of the world chiew et al 1998 huo et al 2016a 2016b keener et al 2010 nalley et al 2016 wang et al 2015 2019 yang et al 2019 both solar activity and large scale climate phenomena have played crucial roles in regulating natural processes particularly hydrological processes but it is easy to confound their effects on multiple natural processes due to the direct influence of solar activity on large scale climate phenomena to quantify their contributions fu et al 2012 attempted to estimate the combined influence of solar activity and large scale climate phenomena on single hydrological variable streamflow across southern canada and founded that solar activity affected el niño first and this influence was then transferred by el niño to streamflow in addition li et al 2017 also tried to explore the response mechanisms of extreme precipitation events to solar activity and el nino events in typical regions of loess plateau of china however few studies sought to focus on direct or indirect influence of solar activity and large scale climate phenomena on multiple interacting hydrological processes for instance precipitation variability can affect changes in natural runoff of stream and river or flood occurrence and they are all influenced by solar activity and large scale climate phenomena in addition few catchment scale researchers have paid attention to the coupling of annual precipitation extreme precipitation events and streamflow or flood events and their responses to influence of solar activity and large scale climate phenomena in recent years wavelet analysis including continuous wavelet transform cwt cross wavelet transform xwt together with wavelet coherence wtc have been widely used for analyzing time series characteristics of climate change and multi scale hydrology agarwal et al 2016 fu and yao 2015 guo et al 2019 hao et al 2016 henderson et al 2009 huo et al 2016a 2016b xi et al 2018 however the wtc method has not yet been used extensively in multiple interacting hydrological processes in the arid semiarid region very recently rezaei and gurdak 2020 and nourani et al 2019 used wtc analysis based on cwt to identify the teleconnections between the large scale climate variability and hydrological processes in the lake urmia watershed of a semiarid region in iran they have also investigated the natural climate variability effects on the lake s hydro climate variables of precipitation temperature the lake level groundwater fluctuations soil moisture vegetation coverage and insolation clearness index however there are many remaining questions about the hydro climatic mechanisms affecting water resources in other similar arid semiarid region worldwide xinjiang is an outstanding example of an environmental tragedy in the arid central asia due to the special topographical features of three mountains and two basins and the unique natural environment pattern yao et al 2018 the distribution of water resources in xinjiang is highly uneven in recent decades flood events and drought events have occurred frequently and alternately in northern xinjiang and southern xinjiang mainly showing the characteristics of spring drought summer flood autumn lack and winter dryness since the late 1980s affected mainly by global or regional climate change especially extreme climate variability the flood disasters in xinjiang have shown an expanding trend which is manifested as an increase in the frequency and intensity of storm floods meltwater floods and cement flows furthermore under the influence of global warming the climate in xinjiang has experienced a dry to wet evolution in 1961 2019 and the increases of annual mean temperature annual total precipitation and extreme climate events in xinjiang are more significant than those in other typical regions of the same latitude as xinjiang wang et al 2020 zhang et al 2012 this is clearly different from the trend of dry get drier and wet get wetter in most other regions of the world under the background of climate warming ipcc 2013 therefore exploring changes in annual precipitation and extreme precipitation events can be conducive to monitor short term or long term streamflow variations and periodic flooding in this study an integrated assessment of linking multiple interacting hydrometeorological parameters to two non stationary climatic modes is provided the novelty of this paper is that it is one of the first analyses to focus on the coupling of precipitation extremes and discharge of streamflow or flooding events and their responses to these non stationary climate modes such as ssn and enso the main objectives in this study are to 1 explore the direct or indirect influence of climate variability at the inter annual level via ssn and enso on multiple interacting hydrometeorological parameters including eight extreme precipitation indices epis annual mean streamflow q a of nine natural rivers in an arid semiarid region of xinjiang northwest china 2 distinguish nonstationary patterns in annual precipitation and extreme precipitation events and their effects on short term or long term streamflow variations of nine natural rivers and periodic flooding of yarkant river under the influence of global warming and climate change 2 study area and data 2 1 study area the study area xinjiang uygur autonomous region 34 25 48 10 n 73 40 96 18 e the largest province in china is located in the eastern part of central asia it is an arid semiarid region in the northwestern china with an area of approximately 1 66 million km2 fig 1 two basins tarim and junggar basins are sandwiched between three mountain ranges kunlun tianshan and altai mountains forming unique geomorphic features of three mountains surrounding two basins yao et al 2018 the annual mean precipitation in xinjiang is 200 mm and water resources mainly come from rivers produced by precipitation and glacial snow meltwater in the mountainous regions thus investigating the hydrological processes under climate change scenarios is important for a number of issues including agriculture and water management in this region 2 2 data sources the daily climate datasets with a horizontal resolution 0 5 0 5 grid of 62 meteorological stations in xinjiang including daily temperature dataset and daily precipitation dataset during the period 1960 2019 were obtained from the national meteorological information center of the china meteorological administration http data cma cn data quality control such as checks on internal consistency and extremes were carried out using rclimdex 1 0 package in r version 3 5 3 more information about meteorological stations in xinjiang was introduced in table s1 the q a values of nine hydrological stations in xinjiang were derived from some published papers table 1 these hydrological stations located in different upper reaches of natural rivers and streams with pristine watersheds have a minimum record length of 47 years and good quality and reliable data in order to distinguish the interarea differences this paper takes q a of each station as the unit of study a time series recording of monthly stream discharge q m of kaqun hydrological station in upper reaches of yarkant river fu et al 2020 was used in flood frequency analysis the international ssn is obtained from the solar influences data analysis center sidc world data center for the sunspot index at the royal observatory of belgium brussels https wwwbis sidc be silso multivariate enso index version 2 mei v2 is used to represent enso events because it combines both oceanic and atmospheric variables limsakul and singhruck 2016 xi et al 2018 recent 1950 2019 monthly mei v2 data were obtained through the noaa national geophysical data center website https psl noaa gov enso mei 3 methodology 3 1 definition of extreme climate indices in this study eight epis were recommended on climate change detection and indices based on previous investigations sillmann et al 2013 tong et al 2019 xi et al 2018 the extreme climate indices were defined and described in detail in table 2 the epis covered max 1 day precipitation amount rx1day max 5 day precipitation amount rx5day heavy precipitation days r10 very heavy precipitation days r20 consecutive dry days cdd consecutive wet days cwd very wet days r95p and extremely wet days r99p these indices provided a rather complete and accurate description of precipitation change in xinjiang 3 2 long term trends and spatial patterns the non parametric sen s slope estimator sen 1968 was utilized to calculating the magnitude of the long term trend in epis on annual scale in xinjiang the statistical significance of the long term trend in each time series of climate indices in xinjiang at the 95 confidence level was evaluated using the non parametric mann kendall mk trend test mann 1945 kendall 1975 additionally the 5 year smoothing average is applied to explore the interannual changes of precipitation extremes and the spatial distribution maps of extreme precipitation events were produced by arcmap 10 2 to analyze the distribution of spatial trends of them 3 3 wavelet analysis recently wavelet analysis has been successfully used to decompose the non stationary hydro climatic time series into time frequency domain fu et al 2012 2021 liu et al 2017 2019 nalley et al 2016 nourani et al 2019 rezaei and gurdak 2020 cwt xwt and wtc are the three commonly used methods for the wavelet analysis to obtain useful time frequency information fu et al 2012 grinsted et al 2004 rezaei and gurdak 2020 the cwt with the morlet wavelet function was useful in detecting the dominant oscillation modes and different periodic components in each individual time series grinsted et al 2004 holman et al 2011 rashid et al 2015 rezaei and gurdak 2020 the xwt can show regions in time frequency space with high common power between two variables whereas the wtc can find regions in time frequency space where two variables covary without necessarily revealing high power keener et al 2010 maraun and kurths 2004 nalley et al 2016 xwt may not be useful to identify the possible links between two hydro climate processes if it is calculated by non normalized wavelet power spectrums although in some cases it also can be used to distinguish the phase spectrum and to identify some regions of high common power between times series nourani et al 2019 therefore in this study wtc based on cwt analysis was applied to estimate the existing correlation between any two hydrological variables of annual precipitation epis q a and q m in an arid semiarid region of xinjiang china and to determine the effect of both solar activity and large scale climate phenomena on coupling non stationary hydro climatic processes the morlet wavelet ψ 0 consists of a complex exponential function modulated by a derivative of the gaussian distribution function given by the following formula 1 ψ 0 t π 1 4 e i ω 0 t e t 2 2 where ψ 0 is the non dimensional wavelet value and ω 0 is the dimensionless frequency in respect to the dimensionless time t which adjusts the scale resolution hao et al 2016 pall et al 2018 torrence and compo 1998 the cwt of a time series x n n 1 2 3 n with uniform time steps δ t is defined by the following formula 2 w n x s δ t s n 1 n x n ψ 0 n n δ t s where δ t s is the normalization factor w n x s denotes the essential characteristics of a time series x n s is the wavelet scale n is the reversed time and ψ 0 is the morlet wavelet hao et al 2016 xi et al 2018 the cwt has edge artifacts because several real time series are not periodical to minimize the edge effects a decorrelation calculation known as the cone of influence is computed for each time series following the procedure described in torrence and compo 1998 the correlation coefficient of wtc between two time series is defined as follow torrence and webster 1999 3 r n 2 s s s 1 w n xy s 2 s s 1 w n x 2 s s 1 w n y 2 where r n 2 s represents the coherence coefficient with maximum coherence at 1 and no coherence at 0 s 1 is used to convert to an energy density s is a smoothing operator applied to both time and frequency which can be represented as das et al 2020 4 s w s scale s time w s where s scale represents smoothing along the wavelet scale axis and s time represents smoothing in time the time convolution is performed with a gaussian operator and the scale convolution is performed with a rectangular window one piece of important information that can be obtained from wtc plots is the dynamics and nature of the arrows which indicate phase shift and types of correlation i e positive in phase negative anti phase correlations between any two non stationary hydro climatic time series nourani et al 2021 some previous studies about wtc analysis have utilized directions of the arrows to indicate the degree to which the x n and y n series are in phase or anti phase in wtc carey et al 2013 fu et al 2012 jiang and yoon 2020 lee and kim 2019 huang and huang 2020 also the phase angle ϕ n s of the wtc can be used to analyze the lead lag relationships between the two series the phase angle is defined as torrence and webster 1999 5 ϕ n s tan 1 i s s 1 w n xy s r s s 1 w n xy s where ϕ n s π π the imaginary parts i and real parts r of the wtc have been computed in equation 3 both r n 2 s and ϕ n s are functions of the time index n and the scale s the directions of phase arrows in wtc pointing right ϕ n s 0 reveal that the x n and y n series are completely in phase while left pointing arrows ϕ n s π or π reveal that the x n and y n series are completely anti phase and up pointing arrows ϕ n s π 2 indicate that the x n and y n series have anti phase correlation and y n lags x n by 90 1 4 period length while down pointing arrows ϕ n s π 2 indicate that the x n and y n series have in phase correlation and y n leads x n by 90 1 4 period length see fig s1 and section s2 in the supplementary material for more details about phase angle conditions and lead lag relationship between the two series x n and y n in addition more detailed information of cwt and wtc algorithms is given by torrence and compo 1998 torrence and webster 1999 and grinsted et al 2004 and the relevant codes of matlab r2018a toolbox can be downloaded from https github com grinsted wavelet coherence 4 results 4 1 changes in extreme precipitation events temporal trends and spatial patterns of extreme precipitation events in xinjiang during the period 1960 2019 are presented in fig 2 rx1day rx5day r10 r20 r95p r99p and cwd significantly increase at rates of 0 64 mm decade 1 02 mm decade 0 25 days decade 0 07 days decade 3 13 days decade 1 14 days decade 0 07 days decade respectively while cdd significantly decreases by 4 67 days decade fig 2 a1 h1 table s2 at the spatial scale both rx1day and rx5day decrease from northwestern to southeastern in xinjiang peak at northern slope of tianshan mountain fig 2 a2 and b2 the rate of change in cwd andr20 indicators of tianshan mountains are higher than those in other areas fig 2 g2 and d2 these results indicate that the precipitation in tianshan mountain has a significant increase over the past 60 years in addition significant increases occur in the foot of tianshan mountain for all epis except for cdd change in cdd of meteorological stations distributed around the taklamakan desert is more obvious than those in other areas in xinjiang fig 2 h2 the cwt analysis results from the departure time series of the epis variables in xinjiang are shown in fig 2 and table 3 notably all the epis variables in xinjiang have similar areas of significant periodicities of 2 4 year but the strong variations across the 2 4 year period band in rx1day rx5day r10 r20 r95p r99p are higher than cwd and cdd and cwd shows relatively weak periodicity with lower variance fig 2 for example rx1day rx5day r10 r20 and r95p all show significant periodicities at scales of up to about 4 years during the mid late 1990 s and from 2007 to 2013 fig 2 a3 b3 c3 d3 and e3 whereas r99p shows strong power at periodicities of 2 6 years only during 2003 2015 fig 2 f3 furthermore significant periodicities during the late 1970 s or late 1980 s are observed for scales between 2 and 3 years for cwd and cdd fig 2 g3 and h3 besides significant inter annual variability with longer periodicities at scales of 4 6 year in roughly the mid late 1980 s are observed for rx1day and rx5day fig 2 a3 and b3 but r95p and r99p during the mid late 2000 s or the early 2010 s fig 2 e3 and f3 4 2 variability in annual runoff and its response to annual precipitation the original annual mean streamflow q a and their cwt spectra for nine natural rivers are shown in figs 3 and 4 respectively the q a values of hydrological stations in southern slope of tianshan mountain all reveal clear upward trends in northern slope of tianshan mountain the q a values of stations nt1 and nt3 show increasing tendency fig 3d and f during the last several decades the q a of station kl1 increases considerably in contrast to those in stations at1 and kl2 fig 3a c therefore our results suggest that climate change with the wetter climate in xinjiang is considered as primary causes of increased runoff in the headstreams in addition significant regions in the cwt spectra of q a are sorted into two main periodicities smaller than 4 years 2 4 year and 4 years 4 7 year fig 4 and table 3 remarkably regions of significant periodicities for q a occur at different times for different stations as is shown in fig 4 and table 3 the q a of nine hydrological stations can be categorized into three groups group 1 including at1 nt1 nt3 st1 and st2 only has moderate variations at the periods of smaller than 4 years group 2 including kl1 and kl2 only shows moderate to relatively strong variations at the periods of 4 years group 3 including nt2 and st3 not only has the smaller periods 2 4 year but also has the larger periods 4 7 year of all the hydrological stations of concern here station kl1 has the strongest variations of significant long periodicities exceeding 4 years concentrated in 1965 1968 1973 1981 and 2005 2009 these variations shown by the thick black contour lines denote statistical significance at the 95 confidence level to explore relations between precipitation and runoff response in the arid semiarid region xinjiang of china nine corresponding meteorological stations namely a9 a52 a54 a15 a16 a17 a30 a33 a44 are used for the precipitation runoff analysis in the mentioned hydrological stations at1 kl1 kl2 nt1 nt2 nt3 st1 st2 st3 respectively the cwt spectra of the annual precipitation of nine meteorological stations in xinjiang show significant periodicities around 2 4 year for a9 a15 a17 a30 a33 a44 a52 and a54 around 4 7 year for a15 a16 a30 a52 a54 around 7 11 year for a33 and a52 and 13 15 year for a17 fig 5 and table 3 annual precipitation variability of stations a52 and a54 show stronger powers at periodicities of 2 11 year from1980 to 2006 fig 5b and 4 7 year from 1980 to 1993 fig 5c respectively annual precipitation variabilities of nine meteorological stations in xinjiang are significantly affected by the cycles of ssn occurring at 5 13 years in fig s2 and enso occurring at 2 7 years in fig s2 which are consistent with previous studies fu et al 2012 li et al 2017 nalley et al 2016 annual precipitation units mm yr 1 and annual mean runoff units mm yr 1 for several decade catchment records indicate notable variability in their timing magnitude and synchrony fig 6 and table 4 originating from the northern slope of tianshan mountain the upstream of bortala river is the wettest site compared with other rivers with annual mean precipitation of wenquan station having 232 14 mm yr 1 fig 6d kunmalike originates from southern slope of tianshan mountain and the annual mean runoff upstream of xiehela is 389 52 mm yr 1 fig 6h in catchments with significant snow storage such as kl1 kl2 nt1 nt2 nt3 st1 and st2 annual runoff is usually larger than annual precipitation table 4 because recorded annual precipitation does not reflect accumulated snow storage melt and delayed water delivery in addition underestimation of precipitation due to the sparse gauging network in high elevations is one possible reason for the discrepancy between the annual runoff and annual precipitation li et al 2020 the wtc spectra of annual precipitation and annual streamflow data are presented in fig 7 and table 5 the q a of station at1 likely has the strongest coherence with annual precipitation of station a9 at a significant periodicity of 2 19 year fig 7a the signals from a9 and at1 are in phase right pointing arrows in fig 7a which reveals the significant influence of precipitation of station a9 on the streamflow variability of station at1 furthermore a zero phase angle phase angle ϕ n s 0 means that the two underlying time series q a of station at1 and annual precipitation of station a9 move together at a specific scale the q a of station nt2 also has in phase correlation with the annual precipitation of station a16 at multiple periodicities of 2 6 year band during 1963 1975 1985 1992 1997 1997 and 2001 2008 4 7 year band during 1976 1998 and 10 19 year band during 1972 1992 fig 7e and right upward arrows with phase angle ϕ n s 0 π 2 suggest that the response pattern of annual precipitation leads that of time series q a furthermore we find similar in phase correlation for the wtc spectra of a17 nt3 and a44 st3 and q a lags precipitation by 0 1 8 period length fig 7f and i however close anti phase correlation for the precipitation runoff analysis of a52 kl1 a54 kl2 a30 st1 and a33 st2 in wtc results for each region are seen in fig 7b c g and h in the long term annual precipitation shows a clear leading effect on the q a of station kl1 and kl2 for a specific time and frequency compared with stations st1 and st2 in addition the q a of station nt1 has anti phase correlation up pointing arrows at the 2 3 year band from 1967 to 1974 with the annal precipitation of station a15 but has some significant regions with in phase correlation right pointing arrows for the 95 confidence level at the 2 3 year band from 1981 to 1983 at the 3 6 year band from 1998 to 2007 and at the 6 8 year band from 1969 to 1972 fig 7d also observed arrows pointing upward phase angle ϕ n s π 2 and right upward phase angle ϕ n s 0 π 2 indicate that annual precipitation of station a15 leads the q a of station nt1 by 0 1 4 period length 4 3 variability in monthly runoff and seasonality based record flood peak originating in karakorun mountains yarkand river is a typical inland river in xinjiang and flows are mainly derived from snow ice melt fu et al 2020 seasonality based monthly discharge and the record flood peak of kaqun station kl1 located near the mouth of yarkand river from 1970 to 2017 is presented in fig 8 the record flood peak over a 48 years observation period from the station kl1 is 1240 m3 s and occurred on august 1984 and the second largest flood peak in a stream gaging record over the same period is 1230 m3 s on july 1994 the q a of station kl1 exceeding 3500 m3 s occurred in 1994 and 2012 in addition the q a of station kl1 in 1973 1978 2005 2006 2008 and 2013 all exceeded 3000 m3 s fig 8a the flow of yarkand river has significant seasonal variations and summer flows are quite high whereas flows during the winter are limited the calculated runoff corresponding to 70 96 annual runoff frequencies occur in flood season june september using the 48 years runoff record from the station kl1 fig 8b the cwt spectra of q m data shows high wavelet power or significant regions at periodicities of around 3 7 month and 8 14 month band from 1970 to 2017 fig 8c which indicates that there are significant intra annual scale and the strong seasonality patterns of non stationary monthly streamflow data for station kl1 4 4 coherence between ssn enso and epis in the arid semiarid region wtc results between ssn and epis in xinjiang are shown in fig 9 and table 6 all epis have regions of statistical significance at the 95 confidence level ssn has common periodicities with rx1day rx5day r10 r20 r95p and r99p at the 2 5 year band fig 9a f and the in phase correlations phase angle ϕ n s 0 π 2 at the 2 3 year band indicate that the ssn leads these epis by 0 1 4 period length while anti phase correlations phase angle ϕ n s π 2 π at the 3 5 year band indicate that the ssn has not clear leading relationship with these epis moreover ssn has close in phase correlations with rx1day r10 r20 and r95p in the 8 12 year band phase angle ϕ n s π π 2 fig 9a c e in phase correlations between ssn and cwd are observed during 1999 2002 2 4 year band and 1995 2003 11 13 year band when phase angle remain within the range of π 2 to 0 whereas anti phase correlations are between the two groups at the 2 4 year band from 2012 to 2015 fig 9g when phase angle is larger than π 2 compared with cwd in the similar band ssn s influence on cdd in fig 9h is concentrated on two periods 1971 1975 revealing anti phase relations phase angle ϕ n s π π 2 between ssn and cdd at the 2 3 year band 1987 1991 showing in phase relations phase angle ϕ n s π 2 0 between ssn and cdd at the 2 3 year band 1976 1984 also demonstrating in phase relations with the same phase angle between ssn and cdd in the 4 5 year band wtc results between enso and epis in xinjiang an arid semiarid region of china are shown in fig 10 and table 7 it is evident that anti phase correlations between enso and all epis except for cdd have been observed at the 2 3 year band since the early 1990s and arrows with phase angle ϕ n s π π 2 reveal enso leading epis by 1 4 1 2 period length however as shown by the correlation analysis in fig 10 the positive influences of enso on all epis except for cdd are significant and focused mainly on the interdecadal scale at the 4 year band rx1day rx5day r10 and r95p have close in phase relations at the 95 confidence level in the 2 4 year band from mid 2000s to mid 2010 s also a zone phase angle the arrow is between the time series enso r10 enso r20 and enso r95p at the 3 4 year band and between the two series enso r99p at the 4 8 year band indicate that the two underlying series have positive correlation and move together at the 4 year band enso has close in phase regions with high wavelet are observed at the 4 6 year band from mid 1980 s to 1996 with rx1day and rx5day at the 4 7 year band with r20 and r95p from 1984 to 2000 or the early 2010s and at the 5 7 year band with r10 from 1988 to 2002 furthermore the close in phase correlations between rx1day rx5day cwd and the enso event are clearer at the greater time scales higher than 7 years from 1990 to 2006 and these three epis lags enso by 1 8 period length in addition the cdd as an index for assessing seasonal drought demonstrates the anti phase correlations with enso at the 2 3 year band during 1987 1992 and at the 5 7 year band during 1970 1981 but show the in phase correlations with enso at the 3 5 year band fig 10 h also arrows with phase angle ϕ n s 0 π 2 indicate that enso leads cdd during 1993 2000 and 2009 2013 4 5 coherence between ssn enso and q a in the arid semiarid region the wtc spectra between ssn enso and q a for the nine stations with record length 47 years are exhibited in fig 11 and table 8 the influence of ssn and enso at the inter annual scale on q a is clearly observed and a possible time delay between streamflow and two climate patterns is significantly different as shown in fig 11 g1 and g2 no close correlation between ssn enso and q a for station st1 are observed at the 2 5 year band with the 0 8 0 9 coherency value between the periods 1988 2001 1998 2003 and 2005 2010 ssn and q a for station at1 have shown close anti phase correlations fig 11 a1 and enso and q a for station at1 have also shown similar anti phase correlations between the periods 1982 1989 and 2009 2012 fig 11 a2 through phase comparison similar anti phase correlations between ssn enso and q a of kl2 and st3 can be verified in fig 11 c1 c2 and i1 i2 at the 2 6 year band from mid 1960 s to mid 1980 s or from mid 1990 s to mid 2000 s kl1 has shown anti phase correlations with ssn at the 2 6 year band 1970 1987 in fig 11 b1 and enso at the 2 4 year band 1962 1975 in fig 11 b2 while the correlations are almost typically in phase between ssn and q a at the 4 6 year band from 1994 to 2004 fig 11 b1 and between enso and q a at the 11 12 year band from 1987 to 1991 fig 11 b2 at the 2 6 year band the effects of enso on q a of station nt2 are concentrated on four periods fig 11 e2 1961 1964 and 1998 1999 where anti phase correlations are seen at the 2 3 year band 1965 1975 revealing in phase correlations at the 3 5 year band 1976 1994 showing in phase correlations at the 2 5 year band and 2005 2009 showing anti phase correlations at the 2 4 year band however compared with enso ssn only has close anti phase correlation with q a of station nt2 at the 2 5 year band from 1984 to 1993 fig 11 e1 these results illustrate the potential strong influence of enso on q a of station nt2 in this region than ssn notably at the 2 4 year band the q a of station nt3 has close anti phase correlations with ssn in the wtc spectra extending from 1958 to 1970 and from 1974 to 1981 and has in phase correlations with ssn in the wtc spectra extending from 2001 to 2003 but mainly has in phase correlations with enso in the wtc spectra extending from 1972 to 1973 compared to ssn fig 11 f1 f2 consistent with the relationships between ssn enso and q a of station nt3 close anti phase relations between ssn and q a of station nt1 during 1968 1973 2 4 year band 1986 1989 3 4 year band and close in phase correlations between ssn and q a of station nt1 during 1998 2005 2 4 year band and close in phase correlations between enso and q a of station nt1 during 1986 2000 3 6 year band are observed in fig 11 d1 d2 these results all show the extensive influence of ssn on q a of nt1 and station nt3 than enso in addition ssn has negative influence anti phase relations on q a of station st2 at the 2 4 year band from 1977 to 1984 however in addition to the negative influence on q a at the 2 3 year band from 1978 to 1982 enso also has positive influence in phase relations on q a of station st2 at the 4 5 year band from 1971 to 1975 fig 11 h1 h2 to further concisely determine the influences of periodic climate phenomenon on annual streamflow variability of nine rivers in xinjiang we employ the phase angle analysis to investigate the lead lag effects of these hydrometeorological variables through phase comparison in fig 11 and table 8 all values for the phase angle between enso and q a of stations at1 kl2 nt3 and st3 remain within the range of π to π 2 or 0 to π 2 for all sub periods implying that enso leads q a of these hydrological stations however enso is not leading q a of stations kl1 nt1 nt2 and st2 for all sub periods but only in the time scale of 2 4 year in addition the results of wtc analysis indicate that the co movement and leading effects of ssn and q a of stations at1 kl1 nt1 and nt3 is not uniform over time and across time scales and ssn has not clear leading effects with q a of stations kl2 nt2 st2 and st3 4 6 coherence between epis and q a in the arid semiarid region there is no doubt that difference in periodic changes of headstream runoff may be directly influenced by the observed variability of precipitation extremes due to solar activity and climate change in addition extreme precipitation events appear to be mostly responsible for streamflow variability herein we take kl1 as an example to study the teleconnections and coherence between epis and q a in the arid semiarid region fig 12 and table 9 as is shown in fig 12 rx1day r10 r20 r95p and r99p have weakly negative effect anti phase relations on q a at the up to 4 year band from the mid late 1960 s or early 1970 s fig 12a 12 f furthermore a moderate coherence for anti phase correlations between epis except for rx5day r99p and cdd and q a is concentrated at the 4 year period fig 12a 12 e and g however in phase relationships at the 2 3 year band are observed between epis except for r99p and cdd and kl1 s annual streamflow after 2000 the correlations between cwd cdd and q a are just the opposite in some similar periods such as at the 2 4 year band from 2005 to 2014 the q a of station kl1 has a close in phase relation with cwd but has a close anti phase relation with cdd at the 5 10 year band from 1998 to 2008 the q a of station kl1 has a close anti phase relation with cwd but has a close in phase relation with cdd fig 12g and h in addition compared with cwd cdd has a close anti phase correlation with q a at the 4 7 year band from 1974 to 1982 fig 12h from wtc analysis between extreme precipitation events and annual streamflow variability of station kl1 some interesting results are revealed there are obvious lead lag relationships between all epis and q a and q a lags all epis by 1 4 1 2 period length at intermediate and greater time scales 5 10 year the results from the wtc analysis between epis and q a of at1 kl2 nt1 nt2 nt3 st1 st2 and st3 are presented in the supplementary material section s4 and figs s3 s10 table s3 s10 5 discussion changes in the spatial extent duration intensity and frequency of various extreme weather and climate events are closely relevant to this study and similar previous investigations easterling et al 2000b sun et al 2016 we select eight valuable epis in xinjiang to investigate the spatiotemporal evolution and periodic oscillation characteristic of extreme precipitation events during 1960 2019 over such a 60 years period the precipitation in xinjiang has been increasing and the climate has become wetter moreover extreme events of heavy precipitation often occur more frequently zhang et al 2012 reported that the occurrence of extremely low precipitation decreased or slightly increased while the occurrence of extremely high precipitation increases significantly in xinjiang after 1980 due to the special terrain structure of three mountains and two basins in xinjiang significant differences in spatial distribution of extreme precipitation events still exist tianshan can be regarded as the boundary between the northern and southern regions of xinjiang and has a huge impact on the distribution and changes of extreme precipitation after all the north atlantic and the arctic ocean are the main sources of water vapor for xinjiang in summer zhang et al 2012 water vapor reaches xinjiang from north and the mediterranean sea and caspian sea are also the sources of water vapor of xinjiang zhang et al 2012 the frequency of the extreme precipitation variables in the northern foot of tianshan mountains and northern xinjiang shows an overall increasing trend and gradually decreases from tianshan mountains and northern xinjiang to southern xinjiang moreover the areas around taklamakan desert experience very low intensity and low frequency precipitation events and the drought is the worst in southern xinjiang than other areas cdd is the largest in southern xinjiang for instance rx1day and rx5day have similar spatial patterns with the changing trends stronger in the northern xinjiang than in the southern xinjiang moreover the spatial distribution of extreme precipitation shows a pattern of more north and less south and the northern xinjiang is wetter than southern xinjiang northern xinjiang is more prone to heavy precipitation extremes while southern xinjiang is more prone to weak precipitation extremes in general mountainous areas are wetter than plains in addition all extreme precipitation events have clear inter annual variability with significant oscillation periods at 2 4 years band during the period 1960 2019 thus the wetting trend in xinjiang may be a local manifestation of global multivariate climate change streamflow variability in xinjiang the largest inland arid semiarid region in china is critical to local hydrological cycle the long term variability in streamflow of nine hydrological stations provide insight into marked climate change in xinjiang the q a values for nine natural rivers are mainly dominated by the 2 4 and 4 7 year activity and have significant inter annual variability on basin scale the q a for the stations distributed at tianshan mountain and karakorum mountain have significantly positive trends and the stations with significantly negative trends of annual streamflow are mostly occurred at altai mountain and kunlun mountain in addition the q a for the stations originated from the southern slope of tianshan mountain have more sizable increase than those from the northern slope of tianshan mountain the phenomenon may be related to a greater contribution of meltwater of glaciers and snow on the southern slope of tianshan mountain because the south facing glaciers located on the southern slope of tianshan mountain can receive more solar energy in contrast to the north facing glaciers situated on northern slope of tianshan mountain the ssn record since 1749 is usually recognized as a periodicity of 11 year oscillation scafetta 2012 while the enso is described as having a periodicity of 2 7 year oscillation keener et al 2010 such oscillations have several influences on hydrometeorological variables including annual precipitation precipitation extremes and streamflow the cwt spectrums of the annual precipitation of mentioned meteorological stations in xinjiang have significant periodicities at the 2 7 year band which belongs to the periodic scope of enso and have significant multiple periodicities at the 7 11 year band and the 13 15 year band which belongs to the periodic scope of ssn illustrating the combined influence of solar activity and large scale climate phenomena on precipitation variability in xinjiang during 1960 2019 the wtc analysis suggests that extreme precipitation events and streamflow in xinjiang all have good responses to solar activity and large scale climate phenomena in general both ssn and enso s impacts on all epis in xinjiang at the 2 7 and 11 year bands are common and similar besides the epis have resonance cycles in the wtc of 11 2 year bands with ssn and also show significant resonance cycles in the wtc of 2 7 year bands in accordance with enso through phase comparison figs 9 and 10 tables 6 and 7 due to the heterogeneous non stationary behavior of large scale climate phenomena including ssn and enso events phase lags are statistically different between two large scale climate phenomena and extreme precipitation events at the several frequency bands in xinjiang the q a of most hydrological stations in xinjiang have periodicities of 2 7 year consistent with both ssn and enso but compared with enso and q a there is no uniform lead lag effect between ssn and q a over time and across time scales considering that the solar activity including ssn has a significant long term impact on enso solar activity s influences may be transferred by enso to precipitation extremes or streamflow variability at the 2 7 year band similar studies also have confirmed that enso plays a vital link between solar activity and surface or subsurface hydrological patterns dong et al 2018 fu et al 2012 enso is the primary climate mode occurring in the tropics owing to its ability to influence global temperature and precipitation which in turn affects the hydrological cycle and ecological environment garcia villada et al 2020 common areas of shared power between multivariate enso index and the hydrological variables including epis and q a for hydrological stations have been founded in xinjiang over the past several decades enso periodically fluctuates between three phases el niño la niña or neutral and strong evidence has founded that the three phases of enso have significantly different impacts on the frequency of extreme climate events and crop yield variability garcia villada et al 2020 júnior et al 2020 el niño referred to as the warm phase of enso and la niña referred to as the cold phase of enso are opposite phases of the enso pattern and the transitional period when el niño or la niña occurs or leaves can also become an important factor in precipitation extremes variability and streamflow variability by affecting teleconnection the current study reveals that precipitation extremes and streamflow in xinjiang are mainly influenced by the 2 4 year and 4 7 year activity and the influences of 11 years activity has also been founded in general compared with ssn enso shows a clear leading effect on precipitation extremes variability and annual streamflow variability in an arid semiarid region xinjiang of china for a specific time and frequency which indicates that enso may play a key role in determining the indirect influence of ssn on these hydrological processes in xinjiang due to the arid semiarid climate characteristics some hydrological processes including precipitation glaciers and snow cover melt streamflow transport and flooding events contribute significantly to runoff and provide the freshwater supply for residents the annual runoff in the upper reaches of main natural rivers in xinjiang shows a significant increase accompanied by an increase of annual precipitation since the 1960s the distribution of annual precipitation changes is consistent with the distribution of stations with significant increase in streamflow showing the considerable impact of annual precipitation changes on annual streamflow variability at a period of the 2 4 year band in wtc spectrums between annual precipitation and q a all hydrometeorological stations in xinjiang show strong coherency related to the annual signals of precipitation and streamflow reflecting coupling patterns of precipitation and runoff also there is less than a quarter period lag between annual precipitation and q a time series for the majority of hydrometeorological stations suggesting that annual precipitation changes have a clear connection with annual runoff fluctuations in the arid semiarid region xinjiang of china in addition the wtc spectra between epis and q a shows that response of precipitation extremes to streamflow runoff can be explained by the form of lead lag relations instead of absolute in phase or anti phase relations taking station kl1 as an example observed left downward arrows between the epis except for r99p and the q a at the 3 4 year or 5 10 year frequency bands indicate that q a lags epis by approximately three eighths period length meaning that extreme precipitation events fluctuations significantly alter q a fluctuations with a 13 5 18 month or 22 5 45 month time lag moreover the effects of the epis on the streamflow have various phase angle conditions occurred in different years our results also indicate that increase in precipitation contribute to the increase of annual runoff of these catchments in the typical arid semiarid region of xinjiang in china and temporal variability of streamflow in natural rivers are caused by multiple extreme precipitation events which is seen to be linked to enso and solar activity furthermore our results also suggest that climate change with the wetter climate in xinjiang was considered as primary causes of increased runoff in the headstreams while human activities may play a dominant role in decreased runoff in the headstreams from 1960 to 2019 the conclusion is consistent with previous research about the dominant causes for annual runoff evolution in the headstream of main rivers in xinjiang li et al 2020 ling et al 2011 2014 qin et al 2016 tao et al 2011 yang et al 2018 6 conclusions the present study selects xinjiang of china as a typical inland arid semiarid region to study spatiotemporal variability for the indices of extreme precipitation events and the multi scale features of runoff variability over the past six decades it further explores significant periodicities of hydrological processes including annual precipitation extreme precipitation events and annual monthly streamflow characteristics using the cwt approach and investigates the detailed linkage between the evolution of interannual to multidecadal climate variability and multiple interacting hydrological processes using wtc approaches the main conclusions are as follows 1 the extreme precipitation events in xinjiang have been increasing during the a 60 years period of 1960 2019 and the climate has become wetter all extreme precipitation events had clear inter annual variability with significant oscillation periods at a 2 4 years band during such a 60 years period moreover strong extreme precipitation events are mostly concentrated in northern xinjiang and tianshan mountain while weak precipitation events often occur in southern xinjiang 2 long term records of annual streamflow data reveal that the q a values for nine natural rivers in xinjiang have dominant periodicities of 2 4 and 4 7 year in the cwt spectra streamflow of headstreams in the upper reaches originated from tianshan mountain and karakorum mountain show obvious increasing trends as compared with streamflow in other mountain areas furthermore significant periodicities for the q m of station kl1 at the intra annual scale of 3 7 month and 8 14 month band during 1970 2017 also are found which showing the strong seasonality patterns of non stationary monthly streamflow variability and seasonality based record flood peak 3 the variability in the headstream runoff shows a nice correlation to precipitation indicating that increases in precipitation attributed to variability in streamflow the wtc spectra between epis and q a shows that response of precipitation extremes to streamflow runoff can be explained by the form of lead lag relations instead of absolute in phase or anti phase relations since the precipitation is regarded as the crucial elements of streamflow variation the response of hydrological features mainly occurs in the rainy season june september and the influence can contribute to the occurrence of flood events in summer due to the extreme precipitation events with higher frequencies 4 long term variability in extreme precipitation events and periodic streamflow in xinjiang are primarily driven by solar activity and enso climate change in xinjiang is a primary factor driving increased runoff in the headstreams of natural river in xinjiang whereas the negative runoff trend in the headstreams of natural river in xinjiang may be influenced by human activities and climate change overall this paper reflects multi scale response characteristics of the variability of long term historical records of hydrological data to climate change on different time scales in the arid semiarid region such as xinjiang and provides an important scientific foundation for designing best practice strategies for water resource management and ecological restoration in similar arid semiarid basins around the world credit authorship contribution statement lin zhang conceptualization methodology validation formal analysis investigation data curation writing original draft visualization yanfeng liu conceptualization methodology validation formal analysis supervision writing review editing hongbin zhan conceptualization methodology validation formal analysis supervision writing review editing menggui jin conceptualization resources supervision writing review editing project administration funding acquisition xing liang conceptualization methodology validation formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the national natural science foundation of china no 41672246 and the fundamental research funds for the central universities china university of geosciences wuhan no 1910491t05 thanks are due to mr feng zhao mrs yining sun and mrs jie gao of china university of geosciences for helping with the meteorological data collection we gratefully acknowledge the contribution of mrs yixin wu of central china normal university for insightful statistical advice we sincerely thank editor and five anonymous reviewers who have provided constructive comments and suggestions for improving the manuscript appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126630 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4286,semi distributed model based on spatial information is effective for simulating hydrologic cycle however it cannot completely simulate all relevant natural processes uncertainty analysis is necessary for achieving high accuracy of hydrological modelling in this study optimization algorithms and weighted network analysis techniques were adopted to explore hydrological parameter combination characteristics as well as hydrological simulating uncertainties in yalong river basin ylrb of southwestern china based on sequential uncertainty fitting version 2 sufi 2 generalized likelihood uncertainty estimation glue and particle swarm optimization pso the results indicated that a groundwater recession factor effective hydraulic conductivity in channel and saturated hydraulic conductivity could significantly affect streamflow in the studying basin b complex parameter combination responded diversely under aforementioned three optimization algorithms comparatively glue brought out higher autocorrelation parameter network and c sufi 2 and pso performed better in terms of effective uncertainty analysis and fitting values than those of glue this work could provide references and insights for sensitive parameter modification and prediction uncertainty reduction of streamflow simulation furthermore contributing to an optimal water resource management abbreviations cn2 initial scs runoff curve value of humidity condition ii gwqmn threshold depth of water in the shallow aquifer required for return flow to occur mm alpha bf baseflow recession factor days gw delay groundwater delay days esco soil evaporation compensation factor ch n2 manninǵs n value for main channel ch k2 effective hydraulic conductivity in channel mm h 1 sol awc 1 soil available water storage capacity mm h2o mm soil 1 in the first layer of soil sol k 1 saturated hydraulic conductivity mm h 1 in the first layer of soil gw revap groundwater revap coefficient keywords sensitivity analysis uncertainty analysis optimization algorithm streamflow simulation yalong river basin 1 introduction hydrological modelling could be applied to water resources management abbaspour et al 2009 particularly semi distributed hydrological models combined with observations can simulate physical processes of hydrologic cycle and water resources distribution within basins based on spatial information and relevant inputs also they can estimate water yields and confluence and then support quantitative assessment of water resources and hydrological forecast as a widely used semi distributed hydrological watershed model soil and water assessment tool swat is a conceptual and time continuous model and has a large and growing number of applications to address watershed water resources ranging from catchments to continental scales abbaspour et al 2015 it is considered as an effective tool for exploring hydrological cycle for over 90 countries such a modeling tool takes advantages of high operational efficiency and good fitting performances based on limited field monitoring information especially in many large scale watersheds comprehensive monitoring is difficult to undertake with the development of cascade hydropower stations in yalong river basin ylrb of southwestern china the utilization of water resources increased rapidly thus the precise hydrological estimation of this region is significantly important to sustainable exploitation of water resources the discrepancy between the fitted model and true hydrological processes is expected to be minimized cai et al 2018 however the envisioned model could hardly simulate the entire true intrinsic hydrological dynamics and thus can probably lead to inherent and stochastic errors contained in the modeling process and the associated outputs all these uncertainties and changes associated with hydrological simulating are posing challenges for water resources management and may lead to confusions when setting policy based on the proposed fitting models eventually deteriorating into potential risks montanari et al 2009 song et al 2015 zhang et al 2009 therefore comprehensive analysis of uncertainty in hydrological simulation is necessary to achieve reliable water resources management in ylrb normally sources of uncertainties come from model inputs including underlying surface characteristics and meteorological data model structure which is the conceptualization and simplification of hydrological cycle and model parameters characterizing the unique hydrological process cai et al 2016 montanari et al 2009 song et al 2015 as comprehensive reflection of water balance a lot of parameters has been embedded into relevant models the uncertainties stemming from natural hydrological processes are hard to be eradicated once the model input and structure has been determined it is critical to identify the effective parameter characteristics for minimizing the uncertainties and mistakes caused by parameter sets rajagopalan et al 2018 tan et al 2016 tolley et al 2019 traditional methods yielded the uncertainty range of parameter sets based on the first order approximation which required few computing capacities nevertheless correlation relationships between parameters were not reflected li et al 2010 the parameter uncertainty may be underestimated due to against the statistical assumption of independent and normally distributed errors within the adoption of certain classical methods van griensven and meixner 2007 then a lot of machine learning techniques based on bayesian methods containing non probabilistic approaches have been employed to deal with parameter sensitivities and uncertainties meanwhile large computation resources and reasonable initial parameter ranges were required in the face of unknown prior parameter information it is effective means to apply these optimization algorithms to find the optimal parameter combination through a large number of simulations the proposed swat calibration uncertainty programs swat cup developed by swiss federal institute of aquatic and technology naprash company and texas a m university has achieved model calibration validation five optimization procedures containing sequential uncertainty fitting version 2 sufi 2 particle swarm optimization pso generalized likelihood uncertainty estimation glue parameter solution parasol and markov chain monte carlo mcmc algorithms were implemented into the swat cup interface and attained effective uncertainty analysis of hydrological simulation azimi et al 2013 faramarzi et al 2013 molina navarro et al 2017 xue et al 2014 in recent decades many studies have conducted hydrological model performance comparisons regarding different optimization algorithms or objective functions also the uncertainty evaluation efficiency varied with multiple methods kouchi et al 2017 found that three algorithms containing sufi 2 glue and pso could result in acceptable calibration results while with notably distinct parameter ranges and concluded that nash sutcliffe efficiency nse nash and sutcliffe 1970 as an objective function performed best among all eight different objective functions in sufi 2 uniyal et al 2015 demonstrated that glue was a more reliable uncertainty analysis technique providing trustworthy parameter ranges than sufi 2 in eastern india zhao et al 2018 observed that parasol algorithm was more efficient in capturing optimal parameter sets while sufi 2 was more superior than glue for the model prediction uncertainty through the employment of the same parameter ranges in a mountain loess transitional watershed nonetheless the prediction uncertainty band was too narrow for parasol which has been confirmed by other research yang et al 2008 also parasol tended to ignore the error originated in model structure and observed data which would underestimate the prediction uncertainty yang et al 2008 mcmc required much larger simulations to attain the true posterior distributions of parameters accompanied by a complex parameter surface and it was difficult to construct a likelihood function smith and marshall 2008 sufi 2 and glue could identify all sources of uncertainty while parasol and mcmc only parameter uncertainty yang et al 2008 from those the calibration validation performance uncertainty prediction and the sensitive parameter identification along with suitable ranges of these multiple algorithms varied from various researches uniyal et al 2015 zhang et al 2009 zhou et al 2014 these optimization techniques embed in hydrological model demand to be applied to different regions and justified its hydrological implications generally sufi 2 glue and pso were preferred for swat model calibration with good fitting and uncertainty capture capacity machine optimization algorithms may find varied optimal solutions of parameter set due to the non uniqueness and conditionality characteristics abbaspour et al 2018 setting the same objective function could cut down the effect of objective function on exploring parameter space as for single indicator nse which is based on the mean squared error is comprehensive for model performance evaluation and has been widely applied to evaluating model efficiency kouchi et al 2017 nse value indicates the coincidence degree of two variable sequences which is representative of the simulated hydrological process and thus could reflect and avoid certain simulation errors therefore the objective function as nse could bring out better fitting effect owing to its superior model output confirmed by recent studies kouchi et al 2017 then it is interesting to explore whether these optimization methods with the same objective function could result in a good fitting on an equal basis and the similar parameter sets the relationship analysis for parameter sets was conducted mainly based on the correlation matrix in previous researches li et al 2009 yang et al 2008 in fact watershed system contains very complicated hydrological process and the interaction within parameter combination is dimensional and complex relevant to water balance moreover different optimization algorithms may cause disturbance to parameter combination relationships the synergism and inhibition among parameters could affect the water cycle thus identifying the parameter combination correlation network regarding multiple optimization algorithms could provide prior references for the optimal settings of parameter combination furtherly comparatively for yalong river basin a typical mountain river basin precise uncertainty analysis was the prerequisite and foundation for a rational exploitation of water resources in view of the complexity of basin hydrological process and the correlation among multiple parameters this study aims to comprehensively identify the hydrological parameter combination characteristics and the hydrological simulating uncertainties regarding three optimization algorithms including sufi 2 glue and pso in ylrb the specific research innovations are 1 clarifying the complex parameter combination responses regarding multiple preferred optimization algorithms 2 quantifying the hydrological model predicted streamflow uncertainty and 3 obtaining the optimization performance of three aforementioned algorithms 2 materials and methods 2 1 overview of the studying area yalong river basin ylrb 96 103 e 26 34 n lies in the southeast of tibetan plateau west of sichuan north of the hengduan mountains which is the key source water area for many large asian rivers fig 1 hallet and molnar 2001 sun et al 2019 the so called ylrb ranks as the top ten hydropower bases in china and contains abundant water resources with plentiful runoff the elevation difference between the source and estuary reaches 3 830 m the total length of mainstream is approximately 1 570 km and the basin area has reached 1 36 105 km2 it is also an important water transfer area in the west route of south to north water transfer project geographically ylrb belongs to the plateau climate region of western sichuan with distinct dry and wet seasons the dry season covers november to april in the next year accounting for 5 10 of the annual precipitation the rainy season covers may to october accounting for 90 95 of the annual precipitation the water vapor in ylrb is mainly formed by the southwest monsoon wang 2014 the rainfall depends on the intensity of the monsoon and the topographic conditions shaping an uneven spatiotemporal distributed precipitation the general trend of precipitation is decreasing from south to north and from east to west the average annual temperature in the ylrb is 7 3 c which is close to 0 c in the upper reach and 15 c in the lower reach the extreme temperature is below 35 c the annual sunshine hours in the basin are 2 400 h major land use and land cover lulc types are pasture and forest accounting for 51 96 and 40 69 of the area the dominant soil types of ylrb are gelic leptosols and haplic luvisols accounting for 33 15 and 23 74 of the area respectively 2 2 model inputs and data source the swat model input include a digital elevation map land use and soil dataset and meteorological data the drainage area of ylrb was 126 475 6 km2 according to the swat model calculation then the basin was partitioned into 177 sub watersheds based on the digital elevation map dem information the model is conducted on the scale of hydrological response units hrus which is defined by considering specific soil type land use slope class and sub basin management action zhao et al 2018 lulc and soil property determine the runoff generation and confluence characteristic of each hru thus on account of the land use types soil types and three level slopes the basin was divided into 3 530 hrus observed daily discharge data from xiaodeshi xds and wantan wt stations were collected of 1979 1983 and tongzilin tzl station of 2006 2010 all calculations were performed by the swat 2012 procedure attaching to arcgis interface esri version 10 2 2 a detailed description of model input is given in table 1 2 3 sensitivity and uncertainty analyses a three year period of 1976 1978 was set up as warming up period which allowed the model to initialize and specify the reasonable starting status for model s storage volumes streamflow was calibrated with monthly discharge from 1979 to 1983 and validated from 2006 to 2010 totally 120 samples the calibration was based on the sum of observations from wt and xds which were located at the tributaries nearest to the output and there were no other tributaries flowing in the basin output except these two stations the validation was based on tzl located in the downstream of wt and xds and closer to the basin outlet three optimization algorithms including sufi 2 glue and pso embedded in swat cup 2019 were applied to sensitivity and uncertainty analysis fig 2 a brief introduction of three algorithms is given as follows sufi 2 it was developed by swiss federal research institute of water science and technology and it takes parameter uncertainty for all sources of uncertainties based on bayesian framework model parameter values are selected through the latin hypercube random sampling method according to the prior parameter range abbaspour et al 2007 1 b j b j a b s m i n b j b j a b s m a x j 1 m where bj is the j th parameter and m is the number of parameters the steps of sufi 2 uncertainty analysis are a initially a large range of parameter uncertainty was assumed contributing to measured data falling into the uncertainty range b then this range decreased gradually and calculated the p factor and r factor as well parameter range was updated step by step by calculating the sensitivity matrix followed by the calculation of covariance matrix 95 confidence intervals of the parameters and correlation matrix abbaspour et al 2018 the final parameter ranges centered around the best simulation were determined when ideal value of p factor and r factor was reached glue it determines parameter set uncertainty based on bayesian method requiring assumptions about the statistical structure of errors between the observation and simulation the posterior probability function of this method is derived from a subjective likelihood measure and then it is used to derive the predictive probability of the output variables abbaspour 2013 the basic idea of glue method is to use the single objective likelihood function distribution method to solve and analyze the uncertainties of parameters separately and then describe the feature of hydrological process by single objective thus the posterior distribution characteristics of parameters are determined the technique currently supports a likelihood measure expressed as the nse zhao et al 2018 in this research the threshold value of the likelihood objective function as nse was 0 5 then the difference between the likelihood function value of simulation and measurement is calculated and the weight of these function values is calculated to obtain the likelihood value of each parameter combination yang et al 2008 zhang et al 2019 2 weight i l θ i k 1 n l θ k where n is the number of behavioral parameter sets the uncertainty range of the model prediction under a certain confidence level is acquired based on the size of the processed likelihood value pso it is a random search algorithm of swarm intelligence which was put forward by kennedy and eberhart inpurdue university in america eberhart and kennedy 1995 the algorithm searches for global optimum by following the optimal solution currently has been searched it is similar to some evolutionary computation techniques like genetic algorithm ga while within fewer parameters to adjust it is initialized by a group of random solutions and then searches for optimum solution by updating generations abbaspour 2013 the search for pso is completely relied on particle velocity with no crossover and mutation operations also in the iterative evolution only the best particles transmit information to other particles so the search speed is fast which provides the possibility of large scale calculation for parameter calibration every particle stores the best solution obtained from pbest gbest after determining the population size the particle velocity v i k 1 and position x i k 1 are randomly adjusted the position of each particle to obtain the best solution is updated based on equations 3 4 ebtehaj and bonakdari 2016 gholami et al 2018 also pso algorithm uses posterior information to adjust the idea of particle optimization path dynamically so that the optimization process can be sampled with a larger probability according to the actual parameters distribution leading to higher optimization efficiency 3 v i k 1 wv i k c 1 r 2 pbest i x i k c 2 r 2 gbest i x i k 4 x i k 1 x i k v i k 1 where r1 and r2 are random numbers in 01 c1 and c2 are weight factors and w is the inertia weigh parameter generally the requiring simulation numbers for glue was the most pso the second and sufi 2 the last the samples for sufi 2 in each iteration could be set 500 to 1 000 from previous publications abbaspour et al 2015 wu and chen 2015 and 600 groups of parameter samples within parameter ranges were selected based on a latin hypercube sampling method in this study glue and pso usually require a larger number of simulations as 10 000 recommended for glue abbaspour 2013 and relatively less pso pre analysis has identified the rough parameter ranges so fewer simulations of 1 000 were conducted by a monto carlo method for glue and 700 model runs for pso 2 iterations were conducted for each method i e a total of 1200 runs for sufi 2 2000 runs for glue and 1400 runs for pso to compare the parameter and prediction uncertainty of three algorithms concurrently the objective function was set the same as nse it was confirmed that swat model could achieve better satisfactory simulation with the objective function of nse according to the preliminary analysis and most relevant published papers the behavioral threshold was set at nse 0 5 defining that the simulations with nse values 0 5 were behavioral otherwise non behavioral all sensitivity and uncertainty analysis were based on the behavioral simulations for the rest were not effective the optimization for the objective function in the calibration validation process was put down to 5 m a x n s e θ 1 i 1 n x 0 x s i 2 i 1 n x 0 x 0 i 2 where θ is a vector of model parameters x 0 is an observed variable x s is corresponding simulated variable and n is the number of observation samples there are over 200 parameters in swat model whereas not all of them are significantly associated with the specific modeling outputs paul and negahban azar 2018 thus it is essential to identify the contributive parameters to the outputs too few parameters could not cover the hydrological cycle and too many irrelevant parameters would lead to over parameterization parameter sensitivity analysis aims to explore the magnitude of the influence of each parameter on model output thereby attain suitable parameter sets global sensitivity analysis depends on the calculation of multiple regressions which all at a time used to quantify the sensitivity of each parameter the multiple regression approach is applied to determine the statistics of parameter sensitivity and is calculated as the following function 6 g α i 1 m β i b i where g is the objective function value α is the regression constant and β is the coefficient of parameters then a t test statistics was used to identify the relative sensitivity significance of each parameter bi larger absolute t stat value i e the coefficient of a parameter divided by its standard error and smaller p value yielded the more sensitive parameter abbaspour 2013 abbaspour et al 2018 generally a p value 0 05 is accepted to reject the null hypothesis 2 4 weighted correlation network analysis to explore the complex parameter network relationships regarding three optimization algorithms weighted correlation network analysis wgcna which is achieved in r environment https cran r project org web packages wgcna index html was implemented based on the significant parameter correlations at 0 05 level 2 tailed the connections between different parameters were performed as paths in the network and flows inside path the importance of the parameter was determined by its proximity to the center 2 5 prediction uncertainty quantification the proportion of all model input uncertainties to model output is mapped in 95 percentage prediction uncertainty 95ppu abbaspour et al 2018 the calibration validation uncertainty degree was measured by 2 statistics of p factor and r factor p factor is the proportion of measured data bracketed by the 95ppu band and r factor is a value of the average distance between the upper and lower 95ppu and is expressed as the value of the average 95ppu thickness divided by the standard deviation of the corresponding observed data abbaspour 2013 the extent of uncertainty r factor value is calculated as follows 7 d 1 n t 1 n y ti 97 5 m y ti 92 5 m 8 r f a c t o r d σ obs where n is the observed sample numbers y ti 97 5 m and y ti 92 5 m represent the 97 5 the upper and 92 5 the lower level of the cumulative distribution of simulations and σ obs is the standard deviation of observations the range for p factor and r factor is 0 1 and 0 respectively ideally the p factor closer to 1 and r factor closer to 0 the simulations exactly match the observations abbaspour 2013 uniyal et al 2015 the 95ppu forces to contain most observed data based on the minimum uncertainty through combining these two factors in this study the coefficient of determination r2 nash sutcliffe efficiency nse and percentage of bias pbias were applied to evaluate model performance efficiency according to the model evaluation criteria seen in table 2 set up by moriasi et al moriasi et al 2007 2015 root mean square error rmse mean absolute error mae mean absolute percentage error mape were applied to evaluate the regression error ebtehaj and bonakdari 2016 gholami et al 2018 qasem et al 2017 r2 describes the proportion of the total variance in the measured data and the linear relationship between simulations and observations krause et al 2005 the range of r2 is 0 1 and higher value shows a better fitting nse an efficient evaluating index for hydrologic model describes the estimating variance over temporal scale and demonstrates the occurrence of the extreme events krause et al 2005 paul and negahban azar 2018 the range is 1 where 1 means a perfect match of simulations to observations pbias measures the average tendency of the simulated output to over or under estimate the observed data where a positive value indicates an underestimation bias and a negative value indicates an overestimation of observations paul and negahban azar 2018 the lower absolute pbias yields the closer tendency of the simulations to observations the range of rmse and mae is 0 the value closer to 0 yields a better simulation mape ranges from 0 to 100 where o indicates a perfect simulation and the value 100 yields a poor simulation the formulas for model evaluating indexes are in the supplementary materials 3 results 3 1 optimal parameter combination identifiability in this study parameter combination of 10 key parameters associated with hydrological process were finally selected for model calibration validation procedure based on the data pre analysis fig 3 the parameter reflecting the evaporation process was esco cn2 was the parameter associated with runoff generation process sol k 1 and sol awc 1 regulated soil water content ch k2 and ch n2 reflected the channel flow parameter set related to groundwater flow included alpha bf gw delay gwqmn and gw revap the results exhibited non uniqueness of parameter combination values associated with optimization methods the initial ranges were set based on literature review and prior knowledge the final parameter ranges estimated by sufi 2 glue and pso were similar while within certain difference which revealed the challenge of error brought from model parameterization even though the same final parameter interval was set the best fitted parameter combination values were not completely consistent from different optimization algorithms as sufi 2 and glue the parameter distribution became narrower through calibration iterations the optimal parameter interval could be determined integrating the results from three optimization methods parameter behaviors responded variously with sampling methods it was clear that final fitted calibrated parameter values for sufi 2 and pso were closer than glue the difference of best fitted parameter value between glue and pso was the largest parameter set obtained by sufi 2 had certain similarity with the other two algorithms 3 2 sensitivity and uncertainty of hydrological parameters parameter sensitivity analysis estimated the change of objective function value along with a particular parameter change comparing the parameter sensitivity results for three algorithms table 3 sufi 2 and glue assigned similar ranks to parameter combination while different from pso the scs cn method was used to estimate the direct surface runoff in swat model and cn2 was supposed as the most sensitive parameter however in this study cn2 ranked as 8th or 10th sensitive parameter with much lower t stat values compared with other parameters the t stat value of gw delay representing groundwater delay was very close for sufi 2 and glue but significantly different from that of pso the distinct sensibility of this parameter was probably caused by algorithm difference between pso and those two on the whole baseflow recession factor effective hydraulic conductivity in channel saturated hydraulic conductivity and groundwater coefficient were the most sensitive parameters affecting streamflow integrated three algorithms the posterior marginal distributions of aggregate parameters showed a relatively uniform parameter sampling for sufi 2 uneven for glue and the most uneven for pso fig 4 totally 95 confidence interval 95ci which was identified based on 2 5 and 97 5 threshold values was computed to evaluate the uncertainty ranges of parameters the mean values of parameter set for sufi 2 and glue were very close while the values for pso were slightly different confidence intervals of ground water parameter gw delay and gw revap for sufi 2 and pso were closer than glue while that of other parameters for sufi 2 and glue were closer than pso the dotty plots of objective function vs parameters for all behavioral runs showed that nse value increased as the calibrated parameter of v alpha bf v gw revap and r sol k 1 increased for sufi 2 and glue fig 5 identifying the corresponding sensitive range the trend of aforementioned three parameters was similarly like an exponential function as the baseflow recession factor increased from 0 to 0 4 which was the sensitive range of this parameter nse increased fast and then became stable as the independent variable continued to increase besides that the values of most parameter values brought about very good nse values the dotty plots of all parameters were more convergence and concentrate for pso along with stably high values of nse and lower uncertainty the correlation matrix of posterior parameters table s1 showed that all the parameter correlations were below 0 2 pso provided the weakest parameter correlations followed by sufi 2 and glue the heaviest fig 6 showed the complex network of significant parameter correlations for three algorithms it was an undirected weight graph of correlated parameters baseflow recession factor was relatively at the center of network for all three algorithms indicating that it had wider relationships with other parameters for sufi 2 and glue the positive correlation between baseflow recession factor and soil saturated hydraulic conductivity exerted the greatest weight with the thickest connecting line among parameter combination also initial scs runoff curve value of humidity conditions and channel factors exerted negative correlations for pso the two connecting lines were thin and the relationship weights were relatively low in general baseflow recession factor and effective hydraulic conductivity in channel had the heaviest weight among the parameter correlation network 3 3 uncertainty of model output 95ppu map showed the proportion of all sources of uncertainties to the model output in the last iteration fig 7 the model performance evaluating indicators regarding three optimization techniques were listed in table 4 the closer the p factor to 1 and r factor to 0 the better the fitting effect is however when the p factor increases the r factor will also increase therefore it is necessary to find a balance between the twos generally p factor 0 7 and r factor 1 5 are considered to meet the fitting requirements in calibration period 95ppu captured 88 of the observed streamflow for sufi 2 68 for glue and 72 for pso fig 7 table 4 the r factor was 0 80 0 78 and 0 57 for three methods respectively showing that the 95 average width of uncertainty interval was narrowest for pso in validation period 95ppu captured 82 of the observed data for sufi 2 72 for glue and 65 for pso generally the uncertainty band was wider for sufi 2 and also bracketed more observed data than glue and pso pso captured more observations within a narrower uncertainty band than glue the uncertainty band of pso had higher accuracy furthermore the frequency histograms of observations and simulations showed that sufi 2 captured the observations better within lower runoff level than those twos and pso captured extreme high runoff slightly better fig 8 the calibration and validation from three aforementioned methods all achieved very good simulations with nse of 0 8 and r2 of 0 85 while the pbias values indicated an discharge underestimation in calibration and overestimation in validation and large absolute errors was due to the large discharge background in ylrb also one way anova analysis showed that there was no significant difference among observations and three kinds of simulations and sufi 2 exerted the highest correlation with others table s2 s3 overall sufi 2 and pso achieved better fitting and uncertainty efficiency 4 discussion 4 1 parameter combination and its hydrological implications the accurate parameter set is a key premise to a successful hydrological simulation li et al 2010 zhao et al 2018 although the best parameter combination interval might be obtained through optimization algorithms the reasonability in water balance process still need to be justified even with the same initial interval different optimization methods produced separate optimal parameter combination values therefore we need to obtain a parameter combination interval and verify its reasonability and uncertainty in this study 10 parameters were identified effectively regulating the hydrological process in ylrb and could achieve a satisfied model fitting performance from previous studies it could be concluded that parameter embedded in water balance specifically reflecting runoff generation as cn2 and esco groundwater flow as alpha bf gw revap soil water condition as sol awc sol k sol z and channel flow as ch k2 had been modified frequently and widely abbaspour et al 2015 li et al 2010 zhou et al 2014 9 parameters have been selected for swat model parameter uncertainty analysis in a case study of an inland river basin in northwest china li et al 2010 and 10 parameters in chaohe basin yang et al 2008 the pre analyses for sensitive parameters identification in this study was consistent with relevant researches the best fitted parameter values of three optimization methods were very close however there was a big difference of parameter gwqmn regarding return flow it might be caused by different algorithm structures of three methods considering its lower sensitivity the discrepancy had lower effect on streamflow the specific physical parameter range of ch k2 and ch n2 regarding channel condition could be determined and verified through field and laboratory measurement the best fitted ch n2 value of around 0 24 for three techniques indicated a dense vegetation coverage which was reasonable considering the ecological environment in ylrb the calibrated gw delay value of around 50 meant the time delay between water exiting in the soil profile and entering the shallow aquifer was about 50 days the slightly lower cn2 value indicated a larger permeability of the basin additionally a lower watershed yield in ylrb also the posterior range of cn2 value has changed little compared with the original value which demonstrated its weaker role in hydrological cycle in ylrb with abundant water the optimal parameter combination intervals and fitted values calculated from optimization algorithms were reasonable through practical and literature comparisons 4 2 hydrological parameter sensitivity and uncertainty analysis the sensitive parameter combination varies with the meteorological and soil conditions the uncertainty range of parameter combination was on condition of the initial state and optimization methods multiple procedures were implemented for swat model calibration validation however how these optimization methods contributed to the uncertainty estimation was still confusing the response surface could be flattened by setting the same objective function of nse with the threshold value of 0 5 thus the parameter uncertainty ranges were relatively narrow and similar for these three methods for three methods parameter combination of alpha bf gw revap gw delay ch k2 and sol k 1 had noticeable impact on monthly streamflow in ylrb which were consistent with previous papers in different areas and covered the main water balance process li et al 2009 paul and negahban azar 2018 uniyal et al 2015 also the sensitive parameters in ylrb indicated that sub process of channel flow and groundwater had critical effect on the whole hydrological cycle alpha bf defined the splitting factor of base streamflow and had a great impact on groundwater supply it ranked as the most sensitivity parameter for sufi 2 and glue yet fifth for pso demonstrating that groundwater recharge significantly contributed to streamflow in ylrb as an indicator of the effective hydraulic conductivity in the main channel the value of ch k2 was all about 70 for three optimization methods it ranked as the 2nd sensitivity parameter for sufi 2 and glue the influence of gw delay whose definition was groundwater delay time was different between pso and other two techniques this difference might come from the pso computational process compared with other peer research the higher esco in ylrb yielded a weaker contribution of soil evaporation to the total evaporation process ylrb is well covered with vegetation and has a good ecological environment which might lead to a higher esco value the low sensitive class of gwqmn indicated that the non point source was not the main driven role for streamflow in ylrb manning s n value for the main channel was a medium sensitive parameter for all three methods the sensitivity of soil conductivity factor in the first soil profile to model output ranked 3rd or 4th it was agreed with relevant studies and could be concluded that alpha bf ch k2 and sol k 1 normally ranked as the most sensitive parameters to streamflow which would provide certain references for further study regarding identification of sensitive parameters the value of cn2 could represent the permeability of the land surface and antecedent soil water conditions consequently it was supposed that surface runoff was most sensitive to this parameter however it was more applicable to dry land shen et al 2014 in ylrb the available water content in surface soil profile was adequate thus the change in cn2 value couldn t lead to significant streamflow variations generally the regression coefficient of groundwater the effective hydraulic conductivity and the saturated hydraulic conductivity had significant regulating effects on the runoff in ylrb previous studies conducted uncertainty analysis with no consideration of the complex network relationship among parameters in this study wgcna which has been widely applied to various biological contexts langfelder and horvath 2008 was implemented to construct complex parameter network the coupling correlation of parameter alpha bf and ch k2 which could adjust the groundwater supply and channel flow respectively had synergistic effect on runoff with the highest weight among the complex network the parameter correlations for sufi 2 and pso were weaker which was correspondence to conclusions of a neglected parameter correlations for sufi 2 in other analyses yang et al 2008 zhao et al 2018 wgcna results implied that glue optimization algorithm would introduce more internal correlation of complex parameter network while sufi 2 and pso algorithm introduced less internal correlation of parameter combination how different algorithms cause the disturbance of synergism and inhibition among hydrological parameter combination needs further exploring theoretically glue had strengths in identifying any modes of parameter posterior distribution in practice large numbers of simulations were hard to conduct thus this advantage could not be achieved it might be a deficiency of the application for this technique paul and negahban azar 2018 sufi 2 and pso were recommended as effective parameter uncertainty analysis techniques due to the good performance based on fewer simulations 4 3 model predicted streamflow uncertainty analysis the purpose of parameter calibration could be obtaining the effective parameter combination interval various studies focused on the simulation based on the best calibrated parameters this paper aimed to explore the model output uncertainty based on effective parameter interval which provided an important base for further model application sufi 2 method took advantage of latin hypercube sampling to compute with high efficiency for identifying the sensitive parameters to model output it could manage uncertainty analysis for dimensional and complex hydrological systems beven and freer 2001 yang et al 2008 glue applied monte carlo algorithm for sampling which is relatively simple and straightforward also the procedure of glue is simple and requires few assumptions when conducted to practical applications thus glue is easy to implement sensitivity analysis and optimization calculation but dealing with complicated hydrological model it could not achieve ideal uncertainty analysis due to its simple conception and low computational efficiency more time and computation resources may be needed to search the parameter combination space and meet the challenge wu and chen 2015 within a narrower width pso uncertainty band captured more observations than glue whose uncertainty band was much wider this revealed that pso had a more efficient computation on uncertainty analysis than glue which would be helpful for the superiority identification regarding the uncertainty of these techniques the results were agreed to other studies that sufi 2 was a superior tool within a higher p factor and lower r factor zhao et al 2018 zhou et al 2014 some differences between simulations and observations as capturing the peak flow might be due to some large scale events including natural disasters and human activities these findings were similar to the study conducted by zhou et al 2014 where sufi 2 and auto calibration were applied to assess uncertainty estimates and the results demonstrated that swat model had some difficulties regarding peak flow not only due to the model itself but also some large flow events additionally there were certain gaps between simulations and observations of base flow in both calibration and validation periods the slight overestimation at the validation stage might be attributed to the regulation of runoff by management in this study despite acceptable model performance evaluation results and 95ppu band of all three algorithms slight different uncertainties still existed it could be inferred that sufi 2 had the superiority to yield a more reasonable prediction uncertainty owing to its high efficiency dealing with complexly structured model consistent with related uncertainty studies uniyal et al 2015 zhao et al 2018 by considering the computational requirement and predicted streamflow uncertainty capture sufi 2 and pso achieved better performance 5 conclusions this study conducted uncertainty analysis for swat model which was the key premise to a successful simulation based on three optimization algorithms including sufi 2 glue and pso in a mountain canyon river as ylrb the sensitive parameter combination varied with the meteorological and soil conditions groundwater recession factor effective hydraulic conductivity in channel and saturated hydraulic conductivity could significantly regulate streamflow in ylrb further the complex parameter correlation network responded variously regarding optimization algorithms autocorrelation within the parameter combination brought by glue algorithm was significantly higher than sufi 2 and pso different algorithms obtained satisfactory calibration validations while sufi 2 and pso performed better model fitting effect and uncertainty analysis than glue sufi 2 s computational efficiency was the highest and its uncertainty band could bracket more model output pso could achieve higher fitting performance within a slight narrower uncertainty band in the practice of limited processing capacity sufi 2 and pso algorithms were preferred to achieve effective uncertainty analysis and better fitting this research provides references for sensitive parameter identification and modification for further studies and implications for the complex network analysis within parameter combination regarding different optimization algorithms credit authorship contribution statement yanan liang conceptualization data curation investigation formal analysis methodology writing original draft yanpeng cai conceptualization investigation supervision funding acquisition lian sun investigation xuan wang chunhui li qiang liu declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national key research program of china 2016yfc0502209 the national natural science foundation of china no 51879007 and the beijing municipal natural science foundation of china no jq18028 we would also like to express our gratitude to the anonymous reviewers and the editors for providing us the valuable comments and suggestions in improving our manuscript appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126598 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4286,semi distributed model based on spatial information is effective for simulating hydrologic cycle however it cannot completely simulate all relevant natural processes uncertainty analysis is necessary for achieving high accuracy of hydrological modelling in this study optimization algorithms and weighted network analysis techniques were adopted to explore hydrological parameter combination characteristics as well as hydrological simulating uncertainties in yalong river basin ylrb of southwestern china based on sequential uncertainty fitting version 2 sufi 2 generalized likelihood uncertainty estimation glue and particle swarm optimization pso the results indicated that a groundwater recession factor effective hydraulic conductivity in channel and saturated hydraulic conductivity could significantly affect streamflow in the studying basin b complex parameter combination responded diversely under aforementioned three optimization algorithms comparatively glue brought out higher autocorrelation parameter network and c sufi 2 and pso performed better in terms of effective uncertainty analysis and fitting values than those of glue this work could provide references and insights for sensitive parameter modification and prediction uncertainty reduction of streamflow simulation furthermore contributing to an optimal water resource management abbreviations cn2 initial scs runoff curve value of humidity condition ii gwqmn threshold depth of water in the shallow aquifer required for return flow to occur mm alpha bf baseflow recession factor days gw delay groundwater delay days esco soil evaporation compensation factor ch n2 manninǵs n value for main channel ch k2 effective hydraulic conductivity in channel mm h 1 sol awc 1 soil available water storage capacity mm h2o mm soil 1 in the first layer of soil sol k 1 saturated hydraulic conductivity mm h 1 in the first layer of soil gw revap groundwater revap coefficient keywords sensitivity analysis uncertainty analysis optimization algorithm streamflow simulation yalong river basin 1 introduction hydrological modelling could be applied to water resources management abbaspour et al 2009 particularly semi distributed hydrological models combined with observations can simulate physical processes of hydrologic cycle and water resources distribution within basins based on spatial information and relevant inputs also they can estimate water yields and confluence and then support quantitative assessment of water resources and hydrological forecast as a widely used semi distributed hydrological watershed model soil and water assessment tool swat is a conceptual and time continuous model and has a large and growing number of applications to address watershed water resources ranging from catchments to continental scales abbaspour et al 2015 it is considered as an effective tool for exploring hydrological cycle for over 90 countries such a modeling tool takes advantages of high operational efficiency and good fitting performances based on limited field monitoring information especially in many large scale watersheds comprehensive monitoring is difficult to undertake with the development of cascade hydropower stations in yalong river basin ylrb of southwestern china the utilization of water resources increased rapidly thus the precise hydrological estimation of this region is significantly important to sustainable exploitation of water resources the discrepancy between the fitted model and true hydrological processes is expected to be minimized cai et al 2018 however the envisioned model could hardly simulate the entire true intrinsic hydrological dynamics and thus can probably lead to inherent and stochastic errors contained in the modeling process and the associated outputs all these uncertainties and changes associated with hydrological simulating are posing challenges for water resources management and may lead to confusions when setting policy based on the proposed fitting models eventually deteriorating into potential risks montanari et al 2009 song et al 2015 zhang et al 2009 therefore comprehensive analysis of uncertainty in hydrological simulation is necessary to achieve reliable water resources management in ylrb normally sources of uncertainties come from model inputs including underlying surface characteristics and meteorological data model structure which is the conceptualization and simplification of hydrological cycle and model parameters characterizing the unique hydrological process cai et al 2016 montanari et al 2009 song et al 2015 as comprehensive reflection of water balance a lot of parameters has been embedded into relevant models the uncertainties stemming from natural hydrological processes are hard to be eradicated once the model input and structure has been determined it is critical to identify the effective parameter characteristics for minimizing the uncertainties and mistakes caused by parameter sets rajagopalan et al 2018 tan et al 2016 tolley et al 2019 traditional methods yielded the uncertainty range of parameter sets based on the first order approximation which required few computing capacities nevertheless correlation relationships between parameters were not reflected li et al 2010 the parameter uncertainty may be underestimated due to against the statistical assumption of independent and normally distributed errors within the adoption of certain classical methods van griensven and meixner 2007 then a lot of machine learning techniques based on bayesian methods containing non probabilistic approaches have been employed to deal with parameter sensitivities and uncertainties meanwhile large computation resources and reasonable initial parameter ranges were required in the face of unknown prior parameter information it is effective means to apply these optimization algorithms to find the optimal parameter combination through a large number of simulations the proposed swat calibration uncertainty programs swat cup developed by swiss federal institute of aquatic and technology naprash company and texas a m university has achieved model calibration validation five optimization procedures containing sequential uncertainty fitting version 2 sufi 2 particle swarm optimization pso generalized likelihood uncertainty estimation glue parameter solution parasol and markov chain monte carlo mcmc algorithms were implemented into the swat cup interface and attained effective uncertainty analysis of hydrological simulation azimi et al 2013 faramarzi et al 2013 molina navarro et al 2017 xue et al 2014 in recent decades many studies have conducted hydrological model performance comparisons regarding different optimization algorithms or objective functions also the uncertainty evaluation efficiency varied with multiple methods kouchi et al 2017 found that three algorithms containing sufi 2 glue and pso could result in acceptable calibration results while with notably distinct parameter ranges and concluded that nash sutcliffe efficiency nse nash and sutcliffe 1970 as an objective function performed best among all eight different objective functions in sufi 2 uniyal et al 2015 demonstrated that glue was a more reliable uncertainty analysis technique providing trustworthy parameter ranges than sufi 2 in eastern india zhao et al 2018 observed that parasol algorithm was more efficient in capturing optimal parameter sets while sufi 2 was more superior than glue for the model prediction uncertainty through the employment of the same parameter ranges in a mountain loess transitional watershed nonetheless the prediction uncertainty band was too narrow for parasol which has been confirmed by other research yang et al 2008 also parasol tended to ignore the error originated in model structure and observed data which would underestimate the prediction uncertainty yang et al 2008 mcmc required much larger simulations to attain the true posterior distributions of parameters accompanied by a complex parameter surface and it was difficult to construct a likelihood function smith and marshall 2008 sufi 2 and glue could identify all sources of uncertainty while parasol and mcmc only parameter uncertainty yang et al 2008 from those the calibration validation performance uncertainty prediction and the sensitive parameter identification along with suitable ranges of these multiple algorithms varied from various researches uniyal et al 2015 zhang et al 2009 zhou et al 2014 these optimization techniques embed in hydrological model demand to be applied to different regions and justified its hydrological implications generally sufi 2 glue and pso were preferred for swat model calibration with good fitting and uncertainty capture capacity machine optimization algorithms may find varied optimal solutions of parameter set due to the non uniqueness and conditionality characteristics abbaspour et al 2018 setting the same objective function could cut down the effect of objective function on exploring parameter space as for single indicator nse which is based on the mean squared error is comprehensive for model performance evaluation and has been widely applied to evaluating model efficiency kouchi et al 2017 nse value indicates the coincidence degree of two variable sequences which is representative of the simulated hydrological process and thus could reflect and avoid certain simulation errors therefore the objective function as nse could bring out better fitting effect owing to its superior model output confirmed by recent studies kouchi et al 2017 then it is interesting to explore whether these optimization methods with the same objective function could result in a good fitting on an equal basis and the similar parameter sets the relationship analysis for parameter sets was conducted mainly based on the correlation matrix in previous researches li et al 2009 yang et al 2008 in fact watershed system contains very complicated hydrological process and the interaction within parameter combination is dimensional and complex relevant to water balance moreover different optimization algorithms may cause disturbance to parameter combination relationships the synergism and inhibition among parameters could affect the water cycle thus identifying the parameter combination correlation network regarding multiple optimization algorithms could provide prior references for the optimal settings of parameter combination furtherly comparatively for yalong river basin a typical mountain river basin precise uncertainty analysis was the prerequisite and foundation for a rational exploitation of water resources in view of the complexity of basin hydrological process and the correlation among multiple parameters this study aims to comprehensively identify the hydrological parameter combination characteristics and the hydrological simulating uncertainties regarding three optimization algorithms including sufi 2 glue and pso in ylrb the specific research innovations are 1 clarifying the complex parameter combination responses regarding multiple preferred optimization algorithms 2 quantifying the hydrological model predicted streamflow uncertainty and 3 obtaining the optimization performance of three aforementioned algorithms 2 materials and methods 2 1 overview of the studying area yalong river basin ylrb 96 103 e 26 34 n lies in the southeast of tibetan plateau west of sichuan north of the hengduan mountains which is the key source water area for many large asian rivers fig 1 hallet and molnar 2001 sun et al 2019 the so called ylrb ranks as the top ten hydropower bases in china and contains abundant water resources with plentiful runoff the elevation difference between the source and estuary reaches 3 830 m the total length of mainstream is approximately 1 570 km and the basin area has reached 1 36 105 km2 it is also an important water transfer area in the west route of south to north water transfer project geographically ylrb belongs to the plateau climate region of western sichuan with distinct dry and wet seasons the dry season covers november to april in the next year accounting for 5 10 of the annual precipitation the rainy season covers may to october accounting for 90 95 of the annual precipitation the water vapor in ylrb is mainly formed by the southwest monsoon wang 2014 the rainfall depends on the intensity of the monsoon and the topographic conditions shaping an uneven spatiotemporal distributed precipitation the general trend of precipitation is decreasing from south to north and from east to west the average annual temperature in the ylrb is 7 3 c which is close to 0 c in the upper reach and 15 c in the lower reach the extreme temperature is below 35 c the annual sunshine hours in the basin are 2 400 h major land use and land cover lulc types are pasture and forest accounting for 51 96 and 40 69 of the area the dominant soil types of ylrb are gelic leptosols and haplic luvisols accounting for 33 15 and 23 74 of the area respectively 2 2 model inputs and data source the swat model input include a digital elevation map land use and soil dataset and meteorological data the drainage area of ylrb was 126 475 6 km2 according to the swat model calculation then the basin was partitioned into 177 sub watersheds based on the digital elevation map dem information the model is conducted on the scale of hydrological response units hrus which is defined by considering specific soil type land use slope class and sub basin management action zhao et al 2018 lulc and soil property determine the runoff generation and confluence characteristic of each hru thus on account of the land use types soil types and three level slopes the basin was divided into 3 530 hrus observed daily discharge data from xiaodeshi xds and wantan wt stations were collected of 1979 1983 and tongzilin tzl station of 2006 2010 all calculations were performed by the swat 2012 procedure attaching to arcgis interface esri version 10 2 2 a detailed description of model input is given in table 1 2 3 sensitivity and uncertainty analyses a three year period of 1976 1978 was set up as warming up period which allowed the model to initialize and specify the reasonable starting status for model s storage volumes streamflow was calibrated with monthly discharge from 1979 to 1983 and validated from 2006 to 2010 totally 120 samples the calibration was based on the sum of observations from wt and xds which were located at the tributaries nearest to the output and there were no other tributaries flowing in the basin output except these two stations the validation was based on tzl located in the downstream of wt and xds and closer to the basin outlet three optimization algorithms including sufi 2 glue and pso embedded in swat cup 2019 were applied to sensitivity and uncertainty analysis fig 2 a brief introduction of three algorithms is given as follows sufi 2 it was developed by swiss federal research institute of water science and technology and it takes parameter uncertainty for all sources of uncertainties based on bayesian framework model parameter values are selected through the latin hypercube random sampling method according to the prior parameter range abbaspour et al 2007 1 b j b j a b s m i n b j b j a b s m a x j 1 m where bj is the j th parameter and m is the number of parameters the steps of sufi 2 uncertainty analysis are a initially a large range of parameter uncertainty was assumed contributing to measured data falling into the uncertainty range b then this range decreased gradually and calculated the p factor and r factor as well parameter range was updated step by step by calculating the sensitivity matrix followed by the calculation of covariance matrix 95 confidence intervals of the parameters and correlation matrix abbaspour et al 2018 the final parameter ranges centered around the best simulation were determined when ideal value of p factor and r factor was reached glue it determines parameter set uncertainty based on bayesian method requiring assumptions about the statistical structure of errors between the observation and simulation the posterior probability function of this method is derived from a subjective likelihood measure and then it is used to derive the predictive probability of the output variables abbaspour 2013 the basic idea of glue method is to use the single objective likelihood function distribution method to solve and analyze the uncertainties of parameters separately and then describe the feature of hydrological process by single objective thus the posterior distribution characteristics of parameters are determined the technique currently supports a likelihood measure expressed as the nse zhao et al 2018 in this research the threshold value of the likelihood objective function as nse was 0 5 then the difference between the likelihood function value of simulation and measurement is calculated and the weight of these function values is calculated to obtain the likelihood value of each parameter combination yang et al 2008 zhang et al 2019 2 weight i l θ i k 1 n l θ k where n is the number of behavioral parameter sets the uncertainty range of the model prediction under a certain confidence level is acquired based on the size of the processed likelihood value pso it is a random search algorithm of swarm intelligence which was put forward by kennedy and eberhart inpurdue university in america eberhart and kennedy 1995 the algorithm searches for global optimum by following the optimal solution currently has been searched it is similar to some evolutionary computation techniques like genetic algorithm ga while within fewer parameters to adjust it is initialized by a group of random solutions and then searches for optimum solution by updating generations abbaspour 2013 the search for pso is completely relied on particle velocity with no crossover and mutation operations also in the iterative evolution only the best particles transmit information to other particles so the search speed is fast which provides the possibility of large scale calculation for parameter calibration every particle stores the best solution obtained from pbest gbest after determining the population size the particle velocity v i k 1 and position x i k 1 are randomly adjusted the position of each particle to obtain the best solution is updated based on equations 3 4 ebtehaj and bonakdari 2016 gholami et al 2018 also pso algorithm uses posterior information to adjust the idea of particle optimization path dynamically so that the optimization process can be sampled with a larger probability according to the actual parameters distribution leading to higher optimization efficiency 3 v i k 1 wv i k c 1 r 2 pbest i x i k c 2 r 2 gbest i x i k 4 x i k 1 x i k v i k 1 where r1 and r2 are random numbers in 01 c1 and c2 are weight factors and w is the inertia weigh parameter generally the requiring simulation numbers for glue was the most pso the second and sufi 2 the last the samples for sufi 2 in each iteration could be set 500 to 1 000 from previous publications abbaspour et al 2015 wu and chen 2015 and 600 groups of parameter samples within parameter ranges were selected based on a latin hypercube sampling method in this study glue and pso usually require a larger number of simulations as 10 000 recommended for glue abbaspour 2013 and relatively less pso pre analysis has identified the rough parameter ranges so fewer simulations of 1 000 were conducted by a monto carlo method for glue and 700 model runs for pso 2 iterations were conducted for each method i e a total of 1200 runs for sufi 2 2000 runs for glue and 1400 runs for pso to compare the parameter and prediction uncertainty of three algorithms concurrently the objective function was set the same as nse it was confirmed that swat model could achieve better satisfactory simulation with the objective function of nse according to the preliminary analysis and most relevant published papers the behavioral threshold was set at nse 0 5 defining that the simulations with nse values 0 5 were behavioral otherwise non behavioral all sensitivity and uncertainty analysis were based on the behavioral simulations for the rest were not effective the optimization for the objective function in the calibration validation process was put down to 5 m a x n s e θ 1 i 1 n x 0 x s i 2 i 1 n x 0 x 0 i 2 where θ is a vector of model parameters x 0 is an observed variable x s is corresponding simulated variable and n is the number of observation samples there are over 200 parameters in swat model whereas not all of them are significantly associated with the specific modeling outputs paul and negahban azar 2018 thus it is essential to identify the contributive parameters to the outputs too few parameters could not cover the hydrological cycle and too many irrelevant parameters would lead to over parameterization parameter sensitivity analysis aims to explore the magnitude of the influence of each parameter on model output thereby attain suitable parameter sets global sensitivity analysis depends on the calculation of multiple regressions which all at a time used to quantify the sensitivity of each parameter the multiple regression approach is applied to determine the statistics of parameter sensitivity and is calculated as the following function 6 g α i 1 m β i b i where g is the objective function value α is the regression constant and β is the coefficient of parameters then a t test statistics was used to identify the relative sensitivity significance of each parameter bi larger absolute t stat value i e the coefficient of a parameter divided by its standard error and smaller p value yielded the more sensitive parameter abbaspour 2013 abbaspour et al 2018 generally a p value 0 05 is accepted to reject the null hypothesis 2 4 weighted correlation network analysis to explore the complex parameter network relationships regarding three optimization algorithms weighted correlation network analysis wgcna which is achieved in r environment https cran r project org web packages wgcna index html was implemented based on the significant parameter correlations at 0 05 level 2 tailed the connections between different parameters were performed as paths in the network and flows inside path the importance of the parameter was determined by its proximity to the center 2 5 prediction uncertainty quantification the proportion of all model input uncertainties to model output is mapped in 95 percentage prediction uncertainty 95ppu abbaspour et al 2018 the calibration validation uncertainty degree was measured by 2 statistics of p factor and r factor p factor is the proportion of measured data bracketed by the 95ppu band and r factor is a value of the average distance between the upper and lower 95ppu and is expressed as the value of the average 95ppu thickness divided by the standard deviation of the corresponding observed data abbaspour 2013 the extent of uncertainty r factor value is calculated as follows 7 d 1 n t 1 n y ti 97 5 m y ti 92 5 m 8 r f a c t o r d σ obs where n is the observed sample numbers y ti 97 5 m and y ti 92 5 m represent the 97 5 the upper and 92 5 the lower level of the cumulative distribution of simulations and σ obs is the standard deviation of observations the range for p factor and r factor is 0 1 and 0 respectively ideally the p factor closer to 1 and r factor closer to 0 the simulations exactly match the observations abbaspour 2013 uniyal et al 2015 the 95ppu forces to contain most observed data based on the minimum uncertainty through combining these two factors in this study the coefficient of determination r2 nash sutcliffe efficiency nse and percentage of bias pbias were applied to evaluate model performance efficiency according to the model evaluation criteria seen in table 2 set up by moriasi et al moriasi et al 2007 2015 root mean square error rmse mean absolute error mae mean absolute percentage error mape were applied to evaluate the regression error ebtehaj and bonakdari 2016 gholami et al 2018 qasem et al 2017 r2 describes the proportion of the total variance in the measured data and the linear relationship between simulations and observations krause et al 2005 the range of r2 is 0 1 and higher value shows a better fitting nse an efficient evaluating index for hydrologic model describes the estimating variance over temporal scale and demonstrates the occurrence of the extreme events krause et al 2005 paul and negahban azar 2018 the range is 1 where 1 means a perfect match of simulations to observations pbias measures the average tendency of the simulated output to over or under estimate the observed data where a positive value indicates an underestimation bias and a negative value indicates an overestimation of observations paul and negahban azar 2018 the lower absolute pbias yields the closer tendency of the simulations to observations the range of rmse and mae is 0 the value closer to 0 yields a better simulation mape ranges from 0 to 100 where o indicates a perfect simulation and the value 100 yields a poor simulation the formulas for model evaluating indexes are in the supplementary materials 3 results 3 1 optimal parameter combination identifiability in this study parameter combination of 10 key parameters associated with hydrological process were finally selected for model calibration validation procedure based on the data pre analysis fig 3 the parameter reflecting the evaporation process was esco cn2 was the parameter associated with runoff generation process sol k 1 and sol awc 1 regulated soil water content ch k2 and ch n2 reflected the channel flow parameter set related to groundwater flow included alpha bf gw delay gwqmn and gw revap the results exhibited non uniqueness of parameter combination values associated with optimization methods the initial ranges were set based on literature review and prior knowledge the final parameter ranges estimated by sufi 2 glue and pso were similar while within certain difference which revealed the challenge of error brought from model parameterization even though the same final parameter interval was set the best fitted parameter combination values were not completely consistent from different optimization algorithms as sufi 2 and glue the parameter distribution became narrower through calibration iterations the optimal parameter interval could be determined integrating the results from three optimization methods parameter behaviors responded variously with sampling methods it was clear that final fitted calibrated parameter values for sufi 2 and pso were closer than glue the difference of best fitted parameter value between glue and pso was the largest parameter set obtained by sufi 2 had certain similarity with the other two algorithms 3 2 sensitivity and uncertainty of hydrological parameters parameter sensitivity analysis estimated the change of objective function value along with a particular parameter change comparing the parameter sensitivity results for three algorithms table 3 sufi 2 and glue assigned similar ranks to parameter combination while different from pso the scs cn method was used to estimate the direct surface runoff in swat model and cn2 was supposed as the most sensitive parameter however in this study cn2 ranked as 8th or 10th sensitive parameter with much lower t stat values compared with other parameters the t stat value of gw delay representing groundwater delay was very close for sufi 2 and glue but significantly different from that of pso the distinct sensibility of this parameter was probably caused by algorithm difference between pso and those two on the whole baseflow recession factor effective hydraulic conductivity in channel saturated hydraulic conductivity and groundwater coefficient were the most sensitive parameters affecting streamflow integrated three algorithms the posterior marginal distributions of aggregate parameters showed a relatively uniform parameter sampling for sufi 2 uneven for glue and the most uneven for pso fig 4 totally 95 confidence interval 95ci which was identified based on 2 5 and 97 5 threshold values was computed to evaluate the uncertainty ranges of parameters the mean values of parameter set for sufi 2 and glue were very close while the values for pso were slightly different confidence intervals of ground water parameter gw delay and gw revap for sufi 2 and pso were closer than glue while that of other parameters for sufi 2 and glue were closer than pso the dotty plots of objective function vs parameters for all behavioral runs showed that nse value increased as the calibrated parameter of v alpha bf v gw revap and r sol k 1 increased for sufi 2 and glue fig 5 identifying the corresponding sensitive range the trend of aforementioned three parameters was similarly like an exponential function as the baseflow recession factor increased from 0 to 0 4 which was the sensitive range of this parameter nse increased fast and then became stable as the independent variable continued to increase besides that the values of most parameter values brought about very good nse values the dotty plots of all parameters were more convergence and concentrate for pso along with stably high values of nse and lower uncertainty the correlation matrix of posterior parameters table s1 showed that all the parameter correlations were below 0 2 pso provided the weakest parameter correlations followed by sufi 2 and glue the heaviest fig 6 showed the complex network of significant parameter correlations for three algorithms it was an undirected weight graph of correlated parameters baseflow recession factor was relatively at the center of network for all three algorithms indicating that it had wider relationships with other parameters for sufi 2 and glue the positive correlation between baseflow recession factor and soil saturated hydraulic conductivity exerted the greatest weight with the thickest connecting line among parameter combination also initial scs runoff curve value of humidity conditions and channel factors exerted negative correlations for pso the two connecting lines were thin and the relationship weights were relatively low in general baseflow recession factor and effective hydraulic conductivity in channel had the heaviest weight among the parameter correlation network 3 3 uncertainty of model output 95ppu map showed the proportion of all sources of uncertainties to the model output in the last iteration fig 7 the model performance evaluating indicators regarding three optimization techniques were listed in table 4 the closer the p factor to 1 and r factor to 0 the better the fitting effect is however when the p factor increases the r factor will also increase therefore it is necessary to find a balance between the twos generally p factor 0 7 and r factor 1 5 are considered to meet the fitting requirements in calibration period 95ppu captured 88 of the observed streamflow for sufi 2 68 for glue and 72 for pso fig 7 table 4 the r factor was 0 80 0 78 and 0 57 for three methods respectively showing that the 95 average width of uncertainty interval was narrowest for pso in validation period 95ppu captured 82 of the observed data for sufi 2 72 for glue and 65 for pso generally the uncertainty band was wider for sufi 2 and also bracketed more observed data than glue and pso pso captured more observations within a narrower uncertainty band than glue the uncertainty band of pso had higher accuracy furthermore the frequency histograms of observations and simulations showed that sufi 2 captured the observations better within lower runoff level than those twos and pso captured extreme high runoff slightly better fig 8 the calibration and validation from three aforementioned methods all achieved very good simulations with nse of 0 8 and r2 of 0 85 while the pbias values indicated an discharge underestimation in calibration and overestimation in validation and large absolute errors was due to the large discharge background in ylrb also one way anova analysis showed that there was no significant difference among observations and three kinds of simulations and sufi 2 exerted the highest correlation with others table s2 s3 overall sufi 2 and pso achieved better fitting and uncertainty efficiency 4 discussion 4 1 parameter combination and its hydrological implications the accurate parameter set is a key premise to a successful hydrological simulation li et al 2010 zhao et al 2018 although the best parameter combination interval might be obtained through optimization algorithms the reasonability in water balance process still need to be justified even with the same initial interval different optimization methods produced separate optimal parameter combination values therefore we need to obtain a parameter combination interval and verify its reasonability and uncertainty in this study 10 parameters were identified effectively regulating the hydrological process in ylrb and could achieve a satisfied model fitting performance from previous studies it could be concluded that parameter embedded in water balance specifically reflecting runoff generation as cn2 and esco groundwater flow as alpha bf gw revap soil water condition as sol awc sol k sol z and channel flow as ch k2 had been modified frequently and widely abbaspour et al 2015 li et al 2010 zhou et al 2014 9 parameters have been selected for swat model parameter uncertainty analysis in a case study of an inland river basin in northwest china li et al 2010 and 10 parameters in chaohe basin yang et al 2008 the pre analyses for sensitive parameters identification in this study was consistent with relevant researches the best fitted parameter values of three optimization methods were very close however there was a big difference of parameter gwqmn regarding return flow it might be caused by different algorithm structures of three methods considering its lower sensitivity the discrepancy had lower effect on streamflow the specific physical parameter range of ch k2 and ch n2 regarding channel condition could be determined and verified through field and laboratory measurement the best fitted ch n2 value of around 0 24 for three techniques indicated a dense vegetation coverage which was reasonable considering the ecological environment in ylrb the calibrated gw delay value of around 50 meant the time delay between water exiting in the soil profile and entering the shallow aquifer was about 50 days the slightly lower cn2 value indicated a larger permeability of the basin additionally a lower watershed yield in ylrb also the posterior range of cn2 value has changed little compared with the original value which demonstrated its weaker role in hydrological cycle in ylrb with abundant water the optimal parameter combination intervals and fitted values calculated from optimization algorithms were reasonable through practical and literature comparisons 4 2 hydrological parameter sensitivity and uncertainty analysis the sensitive parameter combination varies with the meteorological and soil conditions the uncertainty range of parameter combination was on condition of the initial state and optimization methods multiple procedures were implemented for swat model calibration validation however how these optimization methods contributed to the uncertainty estimation was still confusing the response surface could be flattened by setting the same objective function of nse with the threshold value of 0 5 thus the parameter uncertainty ranges were relatively narrow and similar for these three methods for three methods parameter combination of alpha bf gw revap gw delay ch k2 and sol k 1 had noticeable impact on monthly streamflow in ylrb which were consistent with previous papers in different areas and covered the main water balance process li et al 2009 paul and negahban azar 2018 uniyal et al 2015 also the sensitive parameters in ylrb indicated that sub process of channel flow and groundwater had critical effect on the whole hydrological cycle alpha bf defined the splitting factor of base streamflow and had a great impact on groundwater supply it ranked as the most sensitivity parameter for sufi 2 and glue yet fifth for pso demonstrating that groundwater recharge significantly contributed to streamflow in ylrb as an indicator of the effective hydraulic conductivity in the main channel the value of ch k2 was all about 70 for three optimization methods it ranked as the 2nd sensitivity parameter for sufi 2 and glue the influence of gw delay whose definition was groundwater delay time was different between pso and other two techniques this difference might come from the pso computational process compared with other peer research the higher esco in ylrb yielded a weaker contribution of soil evaporation to the total evaporation process ylrb is well covered with vegetation and has a good ecological environment which might lead to a higher esco value the low sensitive class of gwqmn indicated that the non point source was not the main driven role for streamflow in ylrb manning s n value for the main channel was a medium sensitive parameter for all three methods the sensitivity of soil conductivity factor in the first soil profile to model output ranked 3rd or 4th it was agreed with relevant studies and could be concluded that alpha bf ch k2 and sol k 1 normally ranked as the most sensitive parameters to streamflow which would provide certain references for further study regarding identification of sensitive parameters the value of cn2 could represent the permeability of the land surface and antecedent soil water conditions consequently it was supposed that surface runoff was most sensitive to this parameter however it was more applicable to dry land shen et al 2014 in ylrb the available water content in surface soil profile was adequate thus the change in cn2 value couldn t lead to significant streamflow variations generally the regression coefficient of groundwater the effective hydraulic conductivity and the saturated hydraulic conductivity had significant regulating effects on the runoff in ylrb previous studies conducted uncertainty analysis with no consideration of the complex network relationship among parameters in this study wgcna which has been widely applied to various biological contexts langfelder and horvath 2008 was implemented to construct complex parameter network the coupling correlation of parameter alpha bf and ch k2 which could adjust the groundwater supply and channel flow respectively had synergistic effect on runoff with the highest weight among the complex network the parameter correlations for sufi 2 and pso were weaker which was correspondence to conclusions of a neglected parameter correlations for sufi 2 in other analyses yang et al 2008 zhao et al 2018 wgcna results implied that glue optimization algorithm would introduce more internal correlation of complex parameter network while sufi 2 and pso algorithm introduced less internal correlation of parameter combination how different algorithms cause the disturbance of synergism and inhibition among hydrological parameter combination needs further exploring theoretically glue had strengths in identifying any modes of parameter posterior distribution in practice large numbers of simulations were hard to conduct thus this advantage could not be achieved it might be a deficiency of the application for this technique paul and negahban azar 2018 sufi 2 and pso were recommended as effective parameter uncertainty analysis techniques due to the good performance based on fewer simulations 4 3 model predicted streamflow uncertainty analysis the purpose of parameter calibration could be obtaining the effective parameter combination interval various studies focused on the simulation based on the best calibrated parameters this paper aimed to explore the model output uncertainty based on effective parameter interval which provided an important base for further model application sufi 2 method took advantage of latin hypercube sampling to compute with high efficiency for identifying the sensitive parameters to model output it could manage uncertainty analysis for dimensional and complex hydrological systems beven and freer 2001 yang et al 2008 glue applied monte carlo algorithm for sampling which is relatively simple and straightforward also the procedure of glue is simple and requires few assumptions when conducted to practical applications thus glue is easy to implement sensitivity analysis and optimization calculation but dealing with complicated hydrological model it could not achieve ideal uncertainty analysis due to its simple conception and low computational efficiency more time and computation resources may be needed to search the parameter combination space and meet the challenge wu and chen 2015 within a narrower width pso uncertainty band captured more observations than glue whose uncertainty band was much wider this revealed that pso had a more efficient computation on uncertainty analysis than glue which would be helpful for the superiority identification regarding the uncertainty of these techniques the results were agreed to other studies that sufi 2 was a superior tool within a higher p factor and lower r factor zhao et al 2018 zhou et al 2014 some differences between simulations and observations as capturing the peak flow might be due to some large scale events including natural disasters and human activities these findings were similar to the study conducted by zhou et al 2014 where sufi 2 and auto calibration were applied to assess uncertainty estimates and the results demonstrated that swat model had some difficulties regarding peak flow not only due to the model itself but also some large flow events additionally there were certain gaps between simulations and observations of base flow in both calibration and validation periods the slight overestimation at the validation stage might be attributed to the regulation of runoff by management in this study despite acceptable model performance evaluation results and 95ppu band of all three algorithms slight different uncertainties still existed it could be inferred that sufi 2 had the superiority to yield a more reasonable prediction uncertainty owing to its high efficiency dealing with complexly structured model consistent with related uncertainty studies uniyal et al 2015 zhao et al 2018 by considering the computational requirement and predicted streamflow uncertainty capture sufi 2 and pso achieved better performance 5 conclusions this study conducted uncertainty analysis for swat model which was the key premise to a successful simulation based on three optimization algorithms including sufi 2 glue and pso in a mountain canyon river as ylrb the sensitive parameter combination varied with the meteorological and soil conditions groundwater recession factor effective hydraulic conductivity in channel and saturated hydraulic conductivity could significantly regulate streamflow in ylrb further the complex parameter correlation network responded variously regarding optimization algorithms autocorrelation within the parameter combination brought by glue algorithm was significantly higher than sufi 2 and pso different algorithms obtained satisfactory calibration validations while sufi 2 and pso performed better model fitting effect and uncertainty analysis than glue sufi 2 s computational efficiency was the highest and its uncertainty band could bracket more model output pso could achieve higher fitting performance within a slight narrower uncertainty band in the practice of limited processing capacity sufi 2 and pso algorithms were preferred to achieve effective uncertainty analysis and better fitting this research provides references for sensitive parameter identification and modification for further studies and implications for the complex network analysis within parameter combination regarding different optimization algorithms credit authorship contribution statement yanan liang conceptualization data curation investigation formal analysis methodology writing original draft yanpeng cai conceptualization investigation supervision funding acquisition lian sun investigation xuan wang chunhui li qiang liu declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national key research program of china 2016yfc0502209 the national natural science foundation of china no 51879007 and the beijing municipal natural science foundation of china no jq18028 we would also like to express our gratitude to the anonymous reviewers and the editors for providing us the valuable comments and suggestions in improving our manuscript appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126598 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4287,obtaining accurate estimates of evapotranspiration is a key issue in many fields like hydrology ecology and agriculture there exist different ways including physical based and data driven approaches to estimate evapotranspiration here the physical based model the surface energy balance system sebs data driven models using three machine learning techniques deep neural network dnn random forest rf and symbolic regression sr and hybrid model were compared using the fluxnet2015 dataset more importantly different search strategies were investigated to optimize the network architecture and to explore the maximum accuracy of data driven models the shapley additive explanations shap was introduced to quantify the contributions of input features to evapotranspiration estimation the results show that there is a large error in the sebs model with rmse of 121 w m 2 while the data driven models acquire the best evapotranspiration estimation with rmse of 32 53 w m 2 the hybrid approach whose rmse is 60 w m 2 improves the sebs model but still underperforms data driven models the complexity of data driven models influences the accuracy of evapotranspiration estimations by optimizing the network architecture dnn and rf obtain results with similar precision but the performance of sr which generates a simple algebraic formula for evapotranspiration estimation is significantly degraded shap reveals that all models regard net radiation as the most crucial feature the sebs and hybrid models attach much importance to temperature and humidity three data driven models learn the different relationships between input features and evapotranspiration the dnn based model is likely to learn a relatively correct relationship among the data driven models because it has a similar feature importances pattern with physical based and hybrid models keywords evapotranspiration physical based data driven hybrid modeling 1 introduction evapotranspiration which contains soil evaporation plant transpiration and canopy rainfall interception is the water loss from land surface to atmosphere and involves a phase change of water from liquid to gas plant transpiration also couples with photosynthesis via the stoma therefore evapotranspiration is the nexus of the water cycle energy balance and carbon cycle fisher et al 2017 how to acquire accurate evapotranspiration information is the key issue in the fields of hydrology ecology agriculture and climate change etc morton 1983 fisher et al 2011 maes and steppe 2012 helbig et al 2020 many methods have been proposed for evapotranspiration estimation these methods generally can be categorized into two types physical based models and data driven models the physical based models build the evapotranspiration equations based on various theoretical hypotheses such as energy conservation gradient flux similarity complementary relationship budyko hypothesis there are some classical evapotranspiration models including the penman monteith model penman 1948 monteith 1965 priestley taylor equation priestley and taylor 1972 surface energy balance system sebs su 2002 complementary relationship model bouchet 1963 morton 1978 brutsaert and stricker 1979 granger 1989 budyko coupled water energy balance equations budyko 1974 by contrast the data driven models consider fewer physical mechanisms and directly estimate evapotranspiration from forcing data using all sorts of machine learning algorithms such as linear regression symbolic regression support vector machine neural network tree method kumar et al 2002 yang et al 2006 parasuraman et al 2007 wang et al 2007 2010 jung et al 2009 specificly xu et al 2018 compared various machine learning algorithms in estimating watershed evapotranspiration both types of methods have achieved great success and help us acquire evapotranspiration information from instantaneous scale to annual scale and from leaf scale to a global scale however it should be pointed out that there still exist many limitations in current evapotranspiration models recent studies reported relatively high errors in evapotranspiration modeling running et al 2019 showed that the modis global terrestrial evapotranspiration product mod16a2 collection6 has a mean absolute error of 0 33 mm day 1 for daily evapotranspiration modeling which account for 24 6 of the evapotranspiration measurements chen et al 2019b reported that the sebs model obtained the instantaneous evapotranspiration with the rmse ranging from 44 to 100 w m 2 and daily evapotranspiration with the rmse of 1 47 mm day 1 these errors mainly attribute to the uncertainty of key parameters and model structure in the framework of energy balance type models such as the penman monteith model and sebs model the key parameters include surface roughness lengths and surface resistance in addition the energy imbalance problem which means the sum of latent heat flux and sensible heat flux is not equivalent to available energy indicates a model structural error in the typically used energy balance equation the energy imbalance problem also brings uncertainty to surface resistance measurement wohlfahrt et al 2009 therefore a large number of studies focus on physical mechanisms and parameterization schemes of these key parameters jarvis 1976 brutsaert 1982 stewart 1988 kustas et al 1989 raupach 1992 1994 massman 1997 1999 su et al 2001 yang et al 2002 gokmen et al 2012 yebra et al 2013 chen et al 2013 2019a 2019b hu et al 2018 2020 and energy imbalance induced structure error li and wang 2020 wei et al 2020 hu et al 2021 parameter error and structural error also exist in other physical based evapotranspiration models the data driven evapotranspiration models ignore the physical mechanisms and only care about the accuracy of evapotranspiration modeling thus there are no concepts of structure error and parameter error however the lack of physical constraint has some adverse impacts such as weak interpretability and high risks of learning spurious relationships the essence of machine learning algorithms is to find the potential relationship within the data therefore the result is highly dependent on the training set moreover the hyperparameters of machine learning algorithms have an important influence on the performance of data driven models but finding the optimal hyperparameters is a difficult task there is a growing consensus that novel methodologies that couple physical based models and machine learning techniques are promising approaches for complex science problems one of the integration methods hybrid modeling can be a plausible solution to maintain accuracy and interpretability reichstein et al 2019 under the guidance of hybrid modeling the fundamental physical laws should be conserved while the key parameters and the ill described subprocesses can be quantified using machine learning algorithms compared with model calibration the advantage of hybrid modeling is that the powerful approximation ability of machine learning algorithms is utilized to replace the original parameterization schemes of parameters and subprocess which may contain considerable uncertainty besides by clearly defining model structural error the hybrid modeling can reduce the parameter compensation issue that the parameter estimate deviates from its true value due to treating model structural error as a part of model parameter error zhang et al 2019 therefore it is worthwhile to answer a question that which modeling strategies among physical based data driven and hybrid model is optimal to estimate evapotranspiration hyperparameter optimization and interpretation are two obstacles to the application of machine learning techniques despite the lack of mature and unified theories for the two issues at present some potentially useful tools have been proposed for hyperparameter optimization several strategies including grid search random search bergstra and bengio 2012 bayesian optimization snoek et al 2012 genetic programming stanley et al 2009 have been widely applied in various machine learning algorithms the abovementioned methods are suitable for the search space with low dimensions when it comes to deep learning the network architecture is so flexible that the search space is much too large accordingly some novel algorithms for example reinforcement learning based network architecture search algorithm zoph and le 2016 efficient neural architecture search via parameter sharing method pham et al 2018 differentiable architecture search algorithm liu et al 2018 are designed new methods for machine learning interpretability are also published at breakneck speed some simple machine learning techniques such as linear regression and decision trees are inherently interpretable the more universal interpretation methods are model agnostic interpretation tools for example partial dependence plots feature importance global surrogate models local surrogate models shapley value explanations counterfactual explanations this kind of method works by measuring the effect of changing input on the prediction output molnar 2019 to gain a better understanding of different modeling strategis on evapotranspiration estimation this paper evaluates three methods including the physical based data driven and hybrid modeling approach using the fluxnet2015 global surface flux measurements dataset a famous physical based model the sebs model is selected as the benchmark model the hybrid model is built by modifying the original parameterization schemes of parameters and quantifying the structural errors in the sebs model using the data driven method moreover three different machine learning algorithms including deep neural network random forest and symbolic regression combined with state of the art hyperparameter optimization techniques are adopted to comprehensively evaluate the performance of data driven evapotranspiration models our contribution in this paper is three fold 1 we build the hybrid evapotranspiration model by combining the sebs model with the surrogate models of surface roughness lengths and energy imbalance induced structure error and compare the accuracy of physical based data driven and hybrid modeling approaches for evapotranspiration estimation 2 explore the contribution of environmental factors to evapotranspiration in different models using the shap method 3 evaluate the pros and cons of different modeling strategies for evapotranspiration estimation the paper is structured as follows section 2 provides the dataset the framework of evapotranspiration models and shap method section 3 lists the results of evapotranspiration estimation and presents a discussion section 4 delivers our conclusions 2 material and methods 2 1 site and data this study selected 49 flux tower sites from the fluxnet2015 dataset table a1 and fig 1 these sites covered eight land cover types including evergreen needleleaf forest enf evergreen broadleaf forest ebf deciduous needleleaf forest dbf closed shrubland csh open shrubland osh woody savannas wsa grasslands gra cropland cro they sampled half hourly or hourly latent heat flux and sensible heat flux which were denoted as instantaneous fluxes aubinet et al 2012 recommended that high quality data can be used for the development of parameterizations moreover the energy imbalance problem was regarded as the structural error of the classical energy balance models in this study the explanation of the energy imbalance problem was shown in the supplementary material therefore only measured data without any gap filled and energy balance correction was selected the corresponding meteorological data wind speed air temperature air humidity air pressure ambient co2 concentration radiation observations including shortwave radiation longwave radiation incoming photosynthetic photon flux density as well as soil heat flux and soil water content observations were also offered by fluxnet2015 dataset the actual canopy height and instrument heights were obtained from the biological ancillar disturbance management badm database and they were furtherly interpolated to the daily interval the 16 day normalized difference vegetation index ndvi and enhance vegetation index evi were obtained from mod myd13q1 datasets the observations with low quality were removed then the missing data were filled in using the temporal spatial filter method finally daily ndvi and lai were obtained by linear interpolation ndvi and lai were assumed to maintain constant for the whole day the boundary layer height zi was acquired from the european center for medium range weather forecasts ecmwf reanalysis interim era interim dataset with a spatial resolution of 0 125 and a temporal resolution of 3 h the 3 hour zi data were interpolated to the half hour or hourly interval 2 2 measurement of surface roughness lengths and energy imbalance ratio the surface roughness lengths include aerodynamic roughness z0m and the thermodynamic roughness length z0h represented by excess resistance kb 1 ln z0h z0m typically z0m is assumed as a constant over a short period of time yang et al 2003 while kb 1 is an instantaneously time varying parameter verhoef et al 1997 the daily z0m observation was acquired by minimizing the following cost function 1 j u o b s u e s t 2 where u obs is the friction velocity observation from the eddy covariance system and u est is the friction velocity estimated by the following equation 2 u κ u ln z m d z 0 m ψ m z m d l ψ m z 0 m l 1 where κ is the von karman constant 0 4 u is the friction velocity m s 1 u is the wind speed at measurement height m s 1 d is the zero plane displacement height m set as 2 3 hc hc is the canopy height ψ m is the stability correction function for momentum transfer l is the obukhov length m the instantaneous kb 1 observation was inferred using the following equation 3 k b 1 κ u ρ c p t s t a h ln z h d z 0 m ψ h z h d l ψ h z 0 h l where h is sensible heat flux w m 2 ρ is the air density kg m 3 cp is the specific heat for air j kg 1 k 1 ts is the land surface temperature k ta is the air temperature at height z h k ψh is the stability correction function for heat transfer in most cases eq 3 can be solved by simple iteration while the simple iteration will fail in some stable atmospheric conditions the fsolve tool of the scipy package was further used to obtain accurate solutions ts was obtained from longwave radiation as 4 t s r lu 1 ε r ld ε σ 1 4 where σ is the stefan boltzmann constant 5 67 10 8 w m 2 k 4 rlu and rld are the upwelling and downwelling longwave radiation w m 2 respectively ε is the surface emissivity calculated as follow 5 ε f v c ε v 1 f v c ε s where fvc is the fractional vegetation cover εv and εs are the vegetation and soil emissivity respectively fvc is estimated as follows 6 fvc ndvi n d v i s ndv i v n d v i s 2 where ndviv and ndvis refer to the ndvi of vegetation and soil respectively in eqs 2 and 3 stability correction functions for momentum and heat transfer are required in this study the stability correction functions of högström 1996 were adopted 7 ψ m ζ ln 1 x 2 2 1 x 2 2 2 tan 1 x π 2 ζ 0 5 3 ζ ζ 0 8 ψ h ζ 2 ln 1 y 2 ζ 0 8 ζ ζ 0 where ζ z l x 1 19 ζ 1 4 y 0 95 1 11 6 ζ 1 2 and l is the obukhov length defined as 9 l ρ c p u 3 t a p 0 p a 0 286 kgh where p 0 is the reference pressure 105 pa p a is actual atmospheric pressure pa g is the acceleration of gravity 9 81 m s 2 the energy imbalance induced structural error was indicated using the energy balance ratio ebr 10 ebr le h r n g where rn is the net radiation w m 2 g is the soil heat flux w m 2 le is the latent heat flux w m 2 h is the sensible heat flux w m 2 to ensure the quality of surface roughness lengthss and energy balance ratio observations several criteria were used to filter data 1 the turbulence flux measurements with low quality the quality flag is not equal to 0 which means that the data is produced using the gap filling method the le and h whose absolute value is below the detection limit 10 w m 2 and ex situ meteorological measurement were excluded 2 the measurements during rainfall were rejected 3 for the calculation of z0m data with wind speed lower than 1 m s 1 and friction velocity lower than 0 1 m s 1 were dropped 4 for the calculation of kb 1 data with the difference between land surface temperature and air temperature lower than 0 1 k and counter gradient heat fluxes namely h ts ta 0 were removed 5 the outlier thresholds of kb 1 measurement were set as 10 and 60 and the kb 1 measurement exceeding the bounds were removed 6 the outlier thresholds of ebr measurement were set as 1 and 2 according to cui chui 2019 and the ebr measurement exceeding the bounds were removed the outlier thresholds of kb 1 were determined based on the 5 and 95 percentile the 5 and 95 percentile for most sites were located in the range of 10 60 except the au wac site whose 95 percentile was 256 finally we obtained about 785 099 samples it should be pointed out that the roughness sublayer correction was not adopted when calculated z0m and kb 1 because our previous work hu et al 2020 demonstrated that whether considered roughness sublayer correction had little impact on the estimation of turbulence fluxes 2 3 sebs model the benchmark model in this study the sebs model has a simple and clear structure and needs few manual inferences compared with other classical evapotranspiration models such as the two source energy balance model tseb norman et al 1995 and surface energy balance algorithm for land sebal bastiaanssen et al 1998 in the sesb model the friction velocity and sensible heat flux were estimated using eqs 2 and 11 11 h κ ρ c p u t s t a ln z h d z 0 h ψ h z h d l ψ h z 0 h l 1 the latent heat flux was estimated by introducing the concepts of dry limit and wet limit 12 le λ r l e wet 13 l e wet r n g 14 λ r 1 h h wet h dry h wet 15 h dry r n g 16 h wet r n g ρ c p r ew e s e a γ 1 δ γ where λr is the relative evaporation lewet is the latent heat flux under the wet limit w m 2 hdry and hwet are the sensible heat flux under the dry limit and wet limit respectively w m 2 rew is the aerodynamic resistance under the wet limit s m 1 es and ea are saturation vapor pressure and actual vapor pressure kpa respectively γ is the psychrometric constant and δ is the slope of saturation vapor pressure curve the detail of the sebs model including the parameterization schemes of z0m kb 1 and rew can be found in su 2002 and chen et al 2019a some previous studies such as chen et al 2019b attempted to improve the performance of the sebs model by calibrating some parameters we found that the calibrating parameters contributed little to improving the sebs models therefore the parameters of the sebs model adopted the values recommended by su 2002 and chen et al 2019a in this work the detailed process of calibrating parameters was offered in the supplementary material 2 4 data driven evapotranspiration models three types of machine learning algorithms including deep neural network random forest and symbolic regression combined with state of the art hyperparameter optimization techniques were used to build data driven evapotranspiration models the three algorithms own different characteristics and complexity the deep neural network is a kind of parametric method and requires a pre defined network architecture that consists of a large number of weight and bias parameters the forest random is a kind of non parametric method and contains a set of a multitude of decision trees with different split nodes the complicated mathematical expression of these two algorithms ensures the powerful approximation ability in comparison symbolic regression can extract a simple and clear algebraic expression from data fourteen variables were selected as the input features of the data driven model they were wind speed u air temperature ta actual vapor pressure ea air pressure pa land surface temperature ts net radiation rn soil heat flux g canopy height hc leaf area index lai fraction vegetation cover fvc land cover type lct soil water content swc ambient co2 concentration co2 incoming photosynthetic photon flux density ppfdin the land cover type was represented using the numerical coding method and displayed in table a1 the column named lct the first 11 variables are the input of the sebs model the last 3 variables were used to estimate evapotranspiration in some studies zhao et al 2019 and thus were adopted in this work when using the deep neural network algorithm all input variables except land cover type were standardized to have a mean of zero and a standard deviation of one when using the random forest and symbolic regression no data preprocessing was conducted because the two algorithms are not fitted by the gradient descent method only four mathematical operators were used in the symbolic regression algorithm the dataset was randomly apportioned into training validation and test sets with a 60 20 20 split they were used to train the models tune the hyperparameters and evaluate the generalization error respectively the mean square error was selected as the loss function for all of the three machine learning algorithms the pre defined network architecture and forest structure are required in the deep neural network and random forest algorithms due to numerous combinations of the activation functions neuron number and the connection ways of hidden layers such as chain structure multiple branches skip connection as well as stacking cells the search space of network architecture is too large in this study five different search strategies including bayesian optimization bo 1 1 bo network architecture search was implemented by auto keras jin et al 2019 genetic programming gp 2 2 gp network architecture search was implemented using code from https github com joeddav devol reinforcement learning rl 3 3 rl network architecture search was implemented using code from https github com titu1994 neural architecture search efficient neural network search via parameter sharing method enas 4 4 enas was implemented using code from https github com carpedm20 enas pytorch and differentiable architecture search darts 5 5 darts was implemented using the code from https github com quark0 darts were used to find the optimal network architecture the detailed descriptions of these five search strategies can be found in snoek et al 2012 stanley et al 2009 zoph and le 2016 and pham et al 2018 differentiable architecture search algorithm liu et al 2018 the mean square error in the validation dataset was used as the objective or reward for network architecture search it should be pointed out that we did not unify the search space for these search strategies bayesian optimization genetic programming and reinforcement learning were employed to search the optimal chain structure the enas and darts were employed to search the optimal structure with multiple branches and skip connection the maximum hidden layer node was set as 6 to limit the complexity of the network the structure of the random forest is relatively simple it mainly depends on five hyperparameters including the number of trees in the forest n estimators the maximum depth of the tree max depth the minimum number of samples required to split an internal node min samples split the minimum number of sample to be at a leaf node min samples leaf the number of features to consider when looking for the best split max features however the computational cost of grid search for these hyperparameters is still huge therefore we first evaluated the effect of a single hyperparameter then combined the optimal value of every hyperparameter 2 5 hybrid evapotranspiration model in the sebs model the model error is mainly from the uncertainty of roughness lengths and the energy imbalance induced structural errors our previous works comprehensively investigated the data driven solutions to the model parameters and structural errors hu et al 2020 2021 in this study we utilized the random forest algorithm to build the data driven daily z0m instantaneous kb 1 and instantaneous ebr models the data driven solutions to these three variables were shown as follows 17 z 0 m f z 0 m h c l a i f c v u daily t a d a i l y 18 k b 1 f k b 1 u t a e a p a t s d t s w c h c f v c l a i l c t 19 ebr f ebr u t a v p d d t a dt dvpd dt t s u ζ z z i s w c h c f c v σ evi l c t where udaily and ta daily are daily average wind speed m s 1 and air temperature k the reason for using daily average data is that the z0m is assumed to be constant for the whole day dt is the difference between air temperature and land surface temperature k vpd is the vapor pressure deficit kpa dta dt and dvpd dt are the time derivative of air temperature k h 1 and vapor pressure deficit kpa h 1 ζ is the atmospheric stability z zi is the ratio of measurement height to boundary layer height σ evi is the standard deviation of evi across 20 km 20 km region the data driven z0m and kb 1 models combined with eqs 2 and 11 were used to estimate instantaneous h then the instantaneous le is obtained using the data driven ebr model 20 le e b r m r n g h where ebrm is the estimated ebr value it should be noted that it is more reasonable to unify the input variables when comparing the physical based data driven and hybrid models however the input variables vary in different models for example the sebs model does not consider soil water content ambient co2 incoming photosynthetic photon flux density while the three variables are related to the evapotranspiration process thus used in the data driven models this issue causes that the three types of evapotranspiration models are not comparable in some sense but it seems unavoidable therefore the effect of inconsistent input variables was ignored in this study 2 6 shapley additive explanations shap shap lundberg and lee 2017 is a game theoretic approach to explain the performance of the machine learning model it can quantify the contribution of the input feature to the prediction for an individual sample shap specifies the explanation using the additive feature attribution method 21 f x g x ϕ 0 i 1 m ϕ i x where f x is the original model g x is the explanation model with simplified input x x 0 1 m x and x are related via a mapping function x hx x m represents the number of input feature ϕi is the feature attribution for the feature i the explanation model g has a unique solution 22 ϕ i f x z x z m z 1 m f x z f x z i where z represents the number of non zero entries in z and z x f x f hx z e f z zs and s is the set of non zero indexes in z in this study all evapotranspiration models were analyzed by the shap method 3 results and discussion 3 1 optimization of pure data driven models the process of network architecture search for the deep neural network was displayed in fig 2 the five algorithms searched hundreds of network architectures the best network architectures from bo gp rl enas darts algorithms had valid rmse of 36 26 36 15 35 72 35 35 and 56 24 w m 2 respectively it indicated that most network architectures had a similar performance for evapotranspiration estimation bo and gp approaches displayed a convergence tendency the performance of network architectures found by darts was significantly poorer than other algorithms the reason is that darts uses the mixture of all candidate operations for each node during searching but replaces each mixed operation with the most likely operation when determining the final network architectures several bad network architectures occurred during the search process of the rl approach this phenomenon is due to the exploration exploitation strategy in the reinforcement learning algorithm when adopting the exploration strategy the rl approach will randomly generate a network architecture rather than produce a network architecture based on the reward of the last architecture the best network architecture was found by the enas algorithm and was diagramed in fig 3 this architecture had four branches shu et al 2020 claimed that existing neural architecture search algorithms favor architectures with wide and shallow cell structures which seems to support the fact the multiple branch structure was selected however it can be observed that the performance gap between multiple branch structure and chain structure was small which meant that both multiple branch and chain structures were suitable for evapotranspiration estimation moreover the physical meaning of this network architecture is still unclear we cannot infer the connection between this architecture and the mechanisms of evapotranspiration see fig 3 fig 4 illustrated the influence of hyperparameters on the performance of the rf based evapotranspiration model it can be observed that n estimators and max features had little impact on the accuracy of evapotranspiration estimation in contrast the performance of the rf based evapotranspiration model can be improved by decreasing min samples leaf and min samples split and increasing max depth finally the n estimators max depth min samples leaf min samples split and max feature were set as 100 2 2 auto respectively the hyperparameters of symbolic regression were set as the default values the prediction formula of evapotranspiration was shown as follow 23 le u t a 2 l a i 0 314 f v c r n s w c fvc l c t r n 2 pa l c t r n c o 2 l c t rh p p f d in 3 18 r n rh r n g t s c o 2 compared with previous studies parasuraman et al 2007 izadifar and elshorbagy 2010 eq 23 consistently revealed the critical role of net radiation in the evapotranspiration process however the last term in eq 23 is too complicated there are several meaningless operations in the last term thus it is not easy to extract some physical mechanism of evapotranspiration from the equation directly 3 2 evapotranspiration estimation the performance of the sebs model data driven models and hybrid models was shown in fig 5 the metrics including correlation coefficient r root mean square error rmse median absolute percentage error mdape and linear regression were adopted to evaluated these models it can be found that the sebs model performs worst the r was 0 66 the rmse and mdape were up to 121 w m 2 and 100 respectively in contrast the three data driven models acquired more accurate evapotranspiration estimation the rf based model obtained the best result with the r of 0 93 rmse of 32 w m 2 and mdape of 22 on the validation and test dataset the dnn based model reached a similar accuracy the r rmse and mdape were 0 91 37 w m 2 28 on the valid and test datasets respectively the error in the sr based model was relatively large the r decreased to 0 80 while rmse and mdape increased to 53 w m 2 and 40 respectively dnn based and sr based models had similar accuracy on training validation and test dataset but the training accuracy was obviously higher than validation and test accuracy in the rf based model the performance of the hybrid model was between the sebs model and the data driven models the r rmse and mdape were 0 81 60 w m 2 and 46 on the validation and test dataset respectively from the perspective of linear regression most models except the sr based model had a slope close to 1 and interception approaching 0 in the sr based model the slope was only 0 62 indicating an obvious bias 3 3 shap analysis fig 6 displayed the summary plots for the three data driven models using the 10 000 samples from the whole dataset each point on the plot represents the shapley value of a specific feature for a sample and the color indicated the value of the input feature the y axis indicates the input variables in the order of importance from top to bottom it can be found that all models consistently detected the net radiation as the most critical factor and revealed the positive correlation relationship between evapotranspiration and net radiation however the contributions of the rest feature varied in different models in the dnn based model the air temperature and land surface temperature also made a high contribution to evapotranspiration estimation the impact of the rest features was much smaller than the top three features in the rf based model fraction vegetation cover became the second important feature and air temperature remained high contribution but the importance of land surface decreased significantly some other features also contributed much to the evapotranspiration estimation in the sr based model the fraction vegetation cover and soil water content were the second and third important features respectively in contrast the contribution of soil water content was much less than the top two features the sebs model and the hybrid model contain a logarithm operation eqs 2 and 11 if using samples from the whole dataset there will be situations that the canopy height was higher than the measurement height when calculating the background values resulting in invalid results therefore we selected one site to compare the shapley values of different models fig 7 showed the summary plots of shapley value in the ca sf1 site enf 3991 samples for the three machine learning algorithms the main characteristics of shapley value distribution remained stable in the dnn based model the net radiation air temperature and land surface temperature still were the most critical features in the rf based model the net radiation fraction vegetation cover and air temperature made the most contribution to evapotranspiration estimation which was consistent with the result in fig 6 in the sr based model net radiation and fraction vegetation cover were still the top two essential features while air temperature replaced soil water content as the third essential feature soil water content still made a considerable contribution to evapotranspiration estimation in comparison the sebs model attached much importance to net radiation air temperature actual vapor pressure and land surface temperature land surface temperature air temperature and temperature difference contributed much to the hybrid models it can be seen that the sebs model and dnn based model shared a similar pattern of feature importance the net radiation air temperature land surface temperature and air humidity which were indicated by actual vapor pressure and relative humidity in the two models were the main factors impacting evapotranspiration fraction vegetation cover which played an essential role in rf based and sr based models made minor contributions in both the sebs and hybrid models the range of shapley values in the hybrid model was significantly larger than the other models in fig 7 e the shapley value was constrained in the range of 10 000 10 000 the constraint dropped 2 samples the high variation of shapley value is likely because some features are repeatedly used in different subprocesses 3 4 error propagation in the hybrid model in the hybrid model the data driven solutions were used to parameterize the roughness lengths and energy imbalance induced structural error table 1 listed the error of evapotranspiration estimation from different subprocesses it can be found that when using observed roughness lengths and ebr the r rmse and mdape were about 0 90 41 w m 2 and 16 respectively this error was due to the assumption of constant z0m over a short period of time and the uncertainty in the iteration process of atmospheric stability correction fig 8 a presented the evapotranspiration estimation using observed u l kb 1 and ebr in this case the evapotranspiration estimation obtained an excellent result in fig 8 b the observed u was replaced with estimated u and the other variables remained the observed values the evapotranspiration estimation had r rmse and mdpae of 0 87 50 59 w m 2 22 09 respectively this error quantified the uncertainty of the assumption of constant z0m for several days which directly resulted in the relatively poor performance of the hybrid model in fig 8 c u kb 1 and ebr were set as observed values then l and evapotranspiration were calculated using eqs 11 and 20 in this case the error source was sole the iteration process of atmospheric stability correction it can be observed that the atmospheric stability correction introduced an error with r of 0 97 rmse of 23 13 w m 2 mdape of 0 84 the failure of atmospheric stability correction mainly occurred in stable atmospheric conditions when using estimated roughness lengths the r decreased to 0 85 while rmse and mdape increased to 57 w m 2 and 40 compared with pure data driven evapotranspiration models the individual modification of energy imbalance induced structural error also failed to generate better evapotranspiration estimation with r of 0 82 0 89 rmse of 41 10 52 87 w m 2 and mdape of 26 96 39 53 when using the hybrid model with modifications of surface roughness length and energy imbalance induced structural error the accuracy of evapotranspiration estimation further degraded with r of 0 80 0 84 rmse of 52 11 60 52 w m 2 and mdape of 35 85 46 39 the error propagation analysis of the hybrid model indicated that deeper understandings of the roughness lengths the atmospheric stability correction and the energy imbalance problem are required on the one hand the assumption of constant z0m during several days causes significant error in friction velocity estimation and furtherly decreases the accuracy of evapotranspiration estimation moreover it is difficult to obtain accurate turbulence fluxes by the current scheme of atmospheric stability correction on the other hand machine learning algorithms are promising methods to quantify the subprocesses of evapotranspiration however current data driven solutions have met with limited success especially for the estimation of kb 1 and ebr the uncertainty from subprocesses models results in the fact that the hybrid model still underperforms the data driven models for energy imbalance induced structural error even the data driven method fails to achieve a satisfactory result the reason is likely due to missing some key features when building the ebr models 3 5 further discussion rethinking the modeling strategies for evapotranspiration estimation this study evaluated three modeling strategies for evapotranspiration estimation from the perspective of practicability the pure data driven model is likely to be the best choice for evapotranspiration modeling it does not contain any physical mechanism thus has no necessity to consider model parameters error and model structural error state of the art optimization techniques can help to acquire optimal hyperparameters the main issues of the pure data driven method are the representativeness of data and interpretability scientific problems involve many physical variables and physical variables commonly show intricate and non stationary patterns that dynamically change over time karpatne et al 2017 therefore the paucity of representative training samples may be inevitable in scientific problems zhao et al 2019 claimed that the pure data driven evapotranspiration model underperformed the hybrid evapotranspiration model under extreme weather conditions such as droughts and heatwaves the performance of the physical based model data driven models and hybrid model under extreme weather conditions was also evaluated in this work as shown in fig 9 the extreme weather in this study was defined from the aspect of soil moisture air temperature and relative humidity respectively the soil water content and relative humidity indicate extreme dry and wet weather and air temperature indicates heatwave and cold wave the 5 quantile and 95 quantile in the whole dataset were taken as the extreme weather threshold value zhu toth 2013 for example when investigating the model performances under extreme soil water content conditions the 5 quantile and 95 quantile of soil water content in the whole dataset are calculated samples with soil water content varying between the two threshold values in the original training dataset were used as the new training dataset the observation with soil water content lower than 5 quantile and higher than 95 quantile in the whole dataset was selected as the testing dataset a similar analysis was carried out from the aspect of air temperature and air humidity it should be emphasized that the thresholds in this analysis do not define the real extreme weather because the study of extreme weather requires long time series data for example 100 years essentially the performance under the extreme weather in the study reveals the extrapolation ability of models from the aspect of soil water content air temperature and relative humidity respectively the result showed that the data driven models still outperformed the physical based model and hybrid model the mdape of the hybrid model increased significantly under extreme weather conditions which is different from the conclusion of zhao et al 2019 we think the main reasons are 1 the insufficient prediction ability of current data driven parameters and structural error models especially the relatively high error in the data driven ebr model 2 the similar variation range of net radiation which is the most important variable for evapotranspiration estimation occurring in both normal weather and extreme weather which ensure the good performance of data driven models in extreme weather under extreme relative humidity conditions the rmse of sebs and hybrid model decreased obviously the reason is that the variation range of le is relatively narrow under low and high relative humidity conditions different machine learning algorithms usually learn different relationships from the same data the shapley value can help to tell whether the data driven model learns the correct relationship in this study the rf based and sr based evapotranspiration models are at high risk of learning a spurious relationship because their pattern of feature contributions is obviously different from that in physical based and hybrid models nevertheless this method is a post hoc analysis it is impossible to make a judgment before training a model in conclusion pure data driven evapotranspiration models can acquire accurate estimates but are at risk of distorting the relationship between evapotranspiration and input features in comparison the physical based and hybrid models retain the primary physical mechanism including the relation between flux and gradient and conservation law in physical based models the formulas of key parameters and subprocesses are derived based on some theoretical hypotheses and calibrated by limited laboratory observations these formulas can describe the variation tendency of parameters and subprocesses but may deviate from the true values the uncertainties in some subprocesses result in a large error for evapotranspiration estimation and severely limit the application of the physical based model the hybrid model quantifies these subprocesses using true observations which can achieve improvement to some degree the domain knowledge retained in the physical based and hybrid models tell us where the error comes from and how the error is propagated this information can guide us to further improve the model our result showed a large gap between pure data driven models and physical based hybrid models for evapotranspiration estimation zhao et al 2019 also built a framework for hybrid modeling of half hourly evapotranspiration their hybrid model achieved similar performance in comparison with the pure data driven model the small gap in their work is likely due to that they simplified the subprocess of evapotranspiration they used sensible and latent heat fluxes corrected by the bowen ratio method to avoid the energy imbalance problem and adopted a rough scheme of roughness lengths and only build a data driven model for the surface conductance in the framework of the modified penman monteith equation therefore the sole error source of evapotranspiration estimation was surface conductance although there are some disputes in their work such as enforcing closure for the energy imbalance problem and parameter compensation issue we can get an inspiration that minimizing the interdependent subprocesses can contribute to the improvement of the hybrid models the combination of data and knowledge such as hybrid modeling and theory guided data science is a recent research hotpot one key to integrating data with knowledge is the sufficient accuracy of knowledge our present work employs hybrid modeling to decrease the uncertainties from model parameters and model structure but some inaccurate knowledge including the assumption of constant z0m during a short time the iteration process of atmospheric stability correction and unknown factors for energy imbalance problem hinder the further improvement of evapotranspiration estimation another typical way of integrating data and knowledge is theory guided or physical informed machine learning which adds extra loss related to knowledge one famous method the physics informed neural network raissi et al 2019 has been widely applied to solve nonlinear partial differential equations the key to their success is that the pre defined governing equations are unbiased however the current applications of the physics informed neural network such as simulation of fluid dynamics raissi et al 2020 and subsurface flow wang et al 2020 still stay at the stage of virtual examples and there are few successful cases in real situations the main obstacle is the high uncertainty of the governing equations in real cases for the problem of evapotranspiration estimation the typical governing equations including flux gradient similarity relationship energy balance equation complementary relationship contain high uncertainty and thus are unsuitable to serve as the additional term of the loss function exploring more quantifiable inherent characteristics of the evapotranspiration process may promote the advancement of data knowledge coupling evapotranspiration models in summary the pure data driven method is recommended to estimate evapotranspiration if focusing on accuracy the sebs model clearly describes the physical process of evapotranspiration and owns good interpretability but the large parameters error and structural error which are hard to be solved by calibrating the model shown in the supplementary material limit its application although the current hybrid model fails to reach the accuracy level of data driven models the great potential of the hybrid model can be expected 4 conclusion in this study we evaluated the three modeling strategies including the physical based model data driven model and hybrid model for instantaneous evapotranspiration estimation specifically several state of the art search strategies were utilized to optimize the hyperparameters of machine learning algorithms all models were interpreted using the shapley additive explanations in addition a thorough analysis of different modeling strategies was conducted the main conclusions are summarized as follows 1 data driven models can acquire the best evapotranspiration estimation the performance of data driven models varies with the machine learning algorithm and optimization technique rf based model and dnn based model obtain the best evapotranspiration estimates with similar accuracy in comparison the error of the sr based model is relatively large shapley value reveals that different machine learning algorithms learn different relationships the dnn based model emphasizes the role of net radiation air temperature and land surface temperature while in rf based and sr based models the net radiation and soil water content make great contributions to evapotranspiration estimation dnn based model is more likely to learn a relatively correct relationship between evapotranspiration and environmental factors 2 the physical based model the sebs model performs worst by replacing the schemes of key parameters and subprocesses including surface roughness length and energy imbalance induced structural error with data driven solutions the hybrid model can improve the accuracy of evapotranspiration estimation but still underperforms the data driven model 3 under extreme weather conditions including extreme dry and wet weather heatwave and cold wave data driven models still present better performances than the physical based model and hybrid model 4 data driven model is recommended to estimate evapotranspiration when focusing on accuracy the hybrid model can be further improved by deeply understanding the evapotranspiration process s physical mechanism and decreasing interdependent subprocesses of the evapotranspiration model despite the insufficient accuracy of the current hybrid model in comparison with the data driven model the great potential of the hybrid model cannot be denied because the hybrid model retains the constraints of both data and physical laws finding other valuable features to improve the performance of data driven parameters and structural error models and adopting the physical based models with more robust are the feasible solutions to upgrade hybrid models credit authorship contribution statement xiaolong hu conceptualization methodology software writing original draft liangsheng shi conceptualization writing review editing supervision guang lin methodology writing review editing lin lin writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this study was supported by the national natural science foundation of china grant 51979200 51861125202 and 51779180 the authors gratefully acknowledge all of the researchers for their contributions behind each flux site and the organizers of the fluxnet database appendix a table a1 details the 49 sites used in this study appendix b supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126592 appendix b supplementary data the following are the supplementary data to this article supplementary data 1 
4287,obtaining accurate estimates of evapotranspiration is a key issue in many fields like hydrology ecology and agriculture there exist different ways including physical based and data driven approaches to estimate evapotranspiration here the physical based model the surface energy balance system sebs data driven models using three machine learning techniques deep neural network dnn random forest rf and symbolic regression sr and hybrid model were compared using the fluxnet2015 dataset more importantly different search strategies were investigated to optimize the network architecture and to explore the maximum accuracy of data driven models the shapley additive explanations shap was introduced to quantify the contributions of input features to evapotranspiration estimation the results show that there is a large error in the sebs model with rmse of 121 w m 2 while the data driven models acquire the best evapotranspiration estimation with rmse of 32 53 w m 2 the hybrid approach whose rmse is 60 w m 2 improves the sebs model but still underperforms data driven models the complexity of data driven models influences the accuracy of evapotranspiration estimations by optimizing the network architecture dnn and rf obtain results with similar precision but the performance of sr which generates a simple algebraic formula for evapotranspiration estimation is significantly degraded shap reveals that all models regard net radiation as the most crucial feature the sebs and hybrid models attach much importance to temperature and humidity three data driven models learn the different relationships between input features and evapotranspiration the dnn based model is likely to learn a relatively correct relationship among the data driven models because it has a similar feature importances pattern with physical based and hybrid models keywords evapotranspiration physical based data driven hybrid modeling 1 introduction evapotranspiration which contains soil evaporation plant transpiration and canopy rainfall interception is the water loss from land surface to atmosphere and involves a phase change of water from liquid to gas plant transpiration also couples with photosynthesis via the stoma therefore evapotranspiration is the nexus of the water cycle energy balance and carbon cycle fisher et al 2017 how to acquire accurate evapotranspiration information is the key issue in the fields of hydrology ecology agriculture and climate change etc morton 1983 fisher et al 2011 maes and steppe 2012 helbig et al 2020 many methods have been proposed for evapotranspiration estimation these methods generally can be categorized into two types physical based models and data driven models the physical based models build the evapotranspiration equations based on various theoretical hypotheses such as energy conservation gradient flux similarity complementary relationship budyko hypothesis there are some classical evapotranspiration models including the penman monteith model penman 1948 monteith 1965 priestley taylor equation priestley and taylor 1972 surface energy balance system sebs su 2002 complementary relationship model bouchet 1963 morton 1978 brutsaert and stricker 1979 granger 1989 budyko coupled water energy balance equations budyko 1974 by contrast the data driven models consider fewer physical mechanisms and directly estimate evapotranspiration from forcing data using all sorts of machine learning algorithms such as linear regression symbolic regression support vector machine neural network tree method kumar et al 2002 yang et al 2006 parasuraman et al 2007 wang et al 2007 2010 jung et al 2009 specificly xu et al 2018 compared various machine learning algorithms in estimating watershed evapotranspiration both types of methods have achieved great success and help us acquire evapotranspiration information from instantaneous scale to annual scale and from leaf scale to a global scale however it should be pointed out that there still exist many limitations in current evapotranspiration models recent studies reported relatively high errors in evapotranspiration modeling running et al 2019 showed that the modis global terrestrial evapotranspiration product mod16a2 collection6 has a mean absolute error of 0 33 mm day 1 for daily evapotranspiration modeling which account for 24 6 of the evapotranspiration measurements chen et al 2019b reported that the sebs model obtained the instantaneous evapotranspiration with the rmse ranging from 44 to 100 w m 2 and daily evapotranspiration with the rmse of 1 47 mm day 1 these errors mainly attribute to the uncertainty of key parameters and model structure in the framework of energy balance type models such as the penman monteith model and sebs model the key parameters include surface roughness lengths and surface resistance in addition the energy imbalance problem which means the sum of latent heat flux and sensible heat flux is not equivalent to available energy indicates a model structural error in the typically used energy balance equation the energy imbalance problem also brings uncertainty to surface resistance measurement wohlfahrt et al 2009 therefore a large number of studies focus on physical mechanisms and parameterization schemes of these key parameters jarvis 1976 brutsaert 1982 stewart 1988 kustas et al 1989 raupach 1992 1994 massman 1997 1999 su et al 2001 yang et al 2002 gokmen et al 2012 yebra et al 2013 chen et al 2013 2019a 2019b hu et al 2018 2020 and energy imbalance induced structure error li and wang 2020 wei et al 2020 hu et al 2021 parameter error and structural error also exist in other physical based evapotranspiration models the data driven evapotranspiration models ignore the physical mechanisms and only care about the accuracy of evapotranspiration modeling thus there are no concepts of structure error and parameter error however the lack of physical constraint has some adverse impacts such as weak interpretability and high risks of learning spurious relationships the essence of machine learning algorithms is to find the potential relationship within the data therefore the result is highly dependent on the training set moreover the hyperparameters of machine learning algorithms have an important influence on the performance of data driven models but finding the optimal hyperparameters is a difficult task there is a growing consensus that novel methodologies that couple physical based models and machine learning techniques are promising approaches for complex science problems one of the integration methods hybrid modeling can be a plausible solution to maintain accuracy and interpretability reichstein et al 2019 under the guidance of hybrid modeling the fundamental physical laws should be conserved while the key parameters and the ill described subprocesses can be quantified using machine learning algorithms compared with model calibration the advantage of hybrid modeling is that the powerful approximation ability of machine learning algorithms is utilized to replace the original parameterization schemes of parameters and subprocess which may contain considerable uncertainty besides by clearly defining model structural error the hybrid modeling can reduce the parameter compensation issue that the parameter estimate deviates from its true value due to treating model structural error as a part of model parameter error zhang et al 2019 therefore it is worthwhile to answer a question that which modeling strategies among physical based data driven and hybrid model is optimal to estimate evapotranspiration hyperparameter optimization and interpretation are two obstacles to the application of machine learning techniques despite the lack of mature and unified theories for the two issues at present some potentially useful tools have been proposed for hyperparameter optimization several strategies including grid search random search bergstra and bengio 2012 bayesian optimization snoek et al 2012 genetic programming stanley et al 2009 have been widely applied in various machine learning algorithms the abovementioned methods are suitable for the search space with low dimensions when it comes to deep learning the network architecture is so flexible that the search space is much too large accordingly some novel algorithms for example reinforcement learning based network architecture search algorithm zoph and le 2016 efficient neural architecture search via parameter sharing method pham et al 2018 differentiable architecture search algorithm liu et al 2018 are designed new methods for machine learning interpretability are also published at breakneck speed some simple machine learning techniques such as linear regression and decision trees are inherently interpretable the more universal interpretation methods are model agnostic interpretation tools for example partial dependence plots feature importance global surrogate models local surrogate models shapley value explanations counterfactual explanations this kind of method works by measuring the effect of changing input on the prediction output molnar 2019 to gain a better understanding of different modeling strategis on evapotranspiration estimation this paper evaluates three methods including the physical based data driven and hybrid modeling approach using the fluxnet2015 global surface flux measurements dataset a famous physical based model the sebs model is selected as the benchmark model the hybrid model is built by modifying the original parameterization schemes of parameters and quantifying the structural errors in the sebs model using the data driven method moreover three different machine learning algorithms including deep neural network random forest and symbolic regression combined with state of the art hyperparameter optimization techniques are adopted to comprehensively evaluate the performance of data driven evapotranspiration models our contribution in this paper is three fold 1 we build the hybrid evapotranspiration model by combining the sebs model with the surrogate models of surface roughness lengths and energy imbalance induced structure error and compare the accuracy of physical based data driven and hybrid modeling approaches for evapotranspiration estimation 2 explore the contribution of environmental factors to evapotranspiration in different models using the shap method 3 evaluate the pros and cons of different modeling strategies for evapotranspiration estimation the paper is structured as follows section 2 provides the dataset the framework of evapotranspiration models and shap method section 3 lists the results of evapotranspiration estimation and presents a discussion section 4 delivers our conclusions 2 material and methods 2 1 site and data this study selected 49 flux tower sites from the fluxnet2015 dataset table a1 and fig 1 these sites covered eight land cover types including evergreen needleleaf forest enf evergreen broadleaf forest ebf deciduous needleleaf forest dbf closed shrubland csh open shrubland osh woody savannas wsa grasslands gra cropland cro they sampled half hourly or hourly latent heat flux and sensible heat flux which were denoted as instantaneous fluxes aubinet et al 2012 recommended that high quality data can be used for the development of parameterizations moreover the energy imbalance problem was regarded as the structural error of the classical energy balance models in this study the explanation of the energy imbalance problem was shown in the supplementary material therefore only measured data without any gap filled and energy balance correction was selected the corresponding meteorological data wind speed air temperature air humidity air pressure ambient co2 concentration radiation observations including shortwave radiation longwave radiation incoming photosynthetic photon flux density as well as soil heat flux and soil water content observations were also offered by fluxnet2015 dataset the actual canopy height and instrument heights were obtained from the biological ancillar disturbance management badm database and they were furtherly interpolated to the daily interval the 16 day normalized difference vegetation index ndvi and enhance vegetation index evi were obtained from mod myd13q1 datasets the observations with low quality were removed then the missing data were filled in using the temporal spatial filter method finally daily ndvi and lai were obtained by linear interpolation ndvi and lai were assumed to maintain constant for the whole day the boundary layer height zi was acquired from the european center for medium range weather forecasts ecmwf reanalysis interim era interim dataset with a spatial resolution of 0 125 and a temporal resolution of 3 h the 3 hour zi data were interpolated to the half hour or hourly interval 2 2 measurement of surface roughness lengths and energy imbalance ratio the surface roughness lengths include aerodynamic roughness z0m and the thermodynamic roughness length z0h represented by excess resistance kb 1 ln z0h z0m typically z0m is assumed as a constant over a short period of time yang et al 2003 while kb 1 is an instantaneously time varying parameter verhoef et al 1997 the daily z0m observation was acquired by minimizing the following cost function 1 j u o b s u e s t 2 where u obs is the friction velocity observation from the eddy covariance system and u est is the friction velocity estimated by the following equation 2 u κ u ln z m d z 0 m ψ m z m d l ψ m z 0 m l 1 where κ is the von karman constant 0 4 u is the friction velocity m s 1 u is the wind speed at measurement height m s 1 d is the zero plane displacement height m set as 2 3 hc hc is the canopy height ψ m is the stability correction function for momentum transfer l is the obukhov length m the instantaneous kb 1 observation was inferred using the following equation 3 k b 1 κ u ρ c p t s t a h ln z h d z 0 m ψ h z h d l ψ h z 0 h l where h is sensible heat flux w m 2 ρ is the air density kg m 3 cp is the specific heat for air j kg 1 k 1 ts is the land surface temperature k ta is the air temperature at height z h k ψh is the stability correction function for heat transfer in most cases eq 3 can be solved by simple iteration while the simple iteration will fail in some stable atmospheric conditions the fsolve tool of the scipy package was further used to obtain accurate solutions ts was obtained from longwave radiation as 4 t s r lu 1 ε r ld ε σ 1 4 where σ is the stefan boltzmann constant 5 67 10 8 w m 2 k 4 rlu and rld are the upwelling and downwelling longwave radiation w m 2 respectively ε is the surface emissivity calculated as follow 5 ε f v c ε v 1 f v c ε s where fvc is the fractional vegetation cover εv and εs are the vegetation and soil emissivity respectively fvc is estimated as follows 6 fvc ndvi n d v i s ndv i v n d v i s 2 where ndviv and ndvis refer to the ndvi of vegetation and soil respectively in eqs 2 and 3 stability correction functions for momentum and heat transfer are required in this study the stability correction functions of högström 1996 were adopted 7 ψ m ζ ln 1 x 2 2 1 x 2 2 2 tan 1 x π 2 ζ 0 5 3 ζ ζ 0 8 ψ h ζ 2 ln 1 y 2 ζ 0 8 ζ ζ 0 where ζ z l x 1 19 ζ 1 4 y 0 95 1 11 6 ζ 1 2 and l is the obukhov length defined as 9 l ρ c p u 3 t a p 0 p a 0 286 kgh where p 0 is the reference pressure 105 pa p a is actual atmospheric pressure pa g is the acceleration of gravity 9 81 m s 2 the energy imbalance induced structural error was indicated using the energy balance ratio ebr 10 ebr le h r n g where rn is the net radiation w m 2 g is the soil heat flux w m 2 le is the latent heat flux w m 2 h is the sensible heat flux w m 2 to ensure the quality of surface roughness lengthss and energy balance ratio observations several criteria were used to filter data 1 the turbulence flux measurements with low quality the quality flag is not equal to 0 which means that the data is produced using the gap filling method the le and h whose absolute value is below the detection limit 10 w m 2 and ex situ meteorological measurement were excluded 2 the measurements during rainfall were rejected 3 for the calculation of z0m data with wind speed lower than 1 m s 1 and friction velocity lower than 0 1 m s 1 were dropped 4 for the calculation of kb 1 data with the difference between land surface temperature and air temperature lower than 0 1 k and counter gradient heat fluxes namely h ts ta 0 were removed 5 the outlier thresholds of kb 1 measurement were set as 10 and 60 and the kb 1 measurement exceeding the bounds were removed 6 the outlier thresholds of ebr measurement were set as 1 and 2 according to cui chui 2019 and the ebr measurement exceeding the bounds were removed the outlier thresholds of kb 1 were determined based on the 5 and 95 percentile the 5 and 95 percentile for most sites were located in the range of 10 60 except the au wac site whose 95 percentile was 256 finally we obtained about 785 099 samples it should be pointed out that the roughness sublayer correction was not adopted when calculated z0m and kb 1 because our previous work hu et al 2020 demonstrated that whether considered roughness sublayer correction had little impact on the estimation of turbulence fluxes 2 3 sebs model the benchmark model in this study the sebs model has a simple and clear structure and needs few manual inferences compared with other classical evapotranspiration models such as the two source energy balance model tseb norman et al 1995 and surface energy balance algorithm for land sebal bastiaanssen et al 1998 in the sesb model the friction velocity and sensible heat flux were estimated using eqs 2 and 11 11 h κ ρ c p u t s t a ln z h d z 0 h ψ h z h d l ψ h z 0 h l 1 the latent heat flux was estimated by introducing the concepts of dry limit and wet limit 12 le λ r l e wet 13 l e wet r n g 14 λ r 1 h h wet h dry h wet 15 h dry r n g 16 h wet r n g ρ c p r ew e s e a γ 1 δ γ where λr is the relative evaporation lewet is the latent heat flux under the wet limit w m 2 hdry and hwet are the sensible heat flux under the dry limit and wet limit respectively w m 2 rew is the aerodynamic resistance under the wet limit s m 1 es and ea are saturation vapor pressure and actual vapor pressure kpa respectively γ is the psychrometric constant and δ is the slope of saturation vapor pressure curve the detail of the sebs model including the parameterization schemes of z0m kb 1 and rew can be found in su 2002 and chen et al 2019a some previous studies such as chen et al 2019b attempted to improve the performance of the sebs model by calibrating some parameters we found that the calibrating parameters contributed little to improving the sebs models therefore the parameters of the sebs model adopted the values recommended by su 2002 and chen et al 2019a in this work the detailed process of calibrating parameters was offered in the supplementary material 2 4 data driven evapotranspiration models three types of machine learning algorithms including deep neural network random forest and symbolic regression combined with state of the art hyperparameter optimization techniques were used to build data driven evapotranspiration models the three algorithms own different characteristics and complexity the deep neural network is a kind of parametric method and requires a pre defined network architecture that consists of a large number of weight and bias parameters the forest random is a kind of non parametric method and contains a set of a multitude of decision trees with different split nodes the complicated mathematical expression of these two algorithms ensures the powerful approximation ability in comparison symbolic regression can extract a simple and clear algebraic expression from data fourteen variables were selected as the input features of the data driven model they were wind speed u air temperature ta actual vapor pressure ea air pressure pa land surface temperature ts net radiation rn soil heat flux g canopy height hc leaf area index lai fraction vegetation cover fvc land cover type lct soil water content swc ambient co2 concentration co2 incoming photosynthetic photon flux density ppfdin the land cover type was represented using the numerical coding method and displayed in table a1 the column named lct the first 11 variables are the input of the sebs model the last 3 variables were used to estimate evapotranspiration in some studies zhao et al 2019 and thus were adopted in this work when using the deep neural network algorithm all input variables except land cover type were standardized to have a mean of zero and a standard deviation of one when using the random forest and symbolic regression no data preprocessing was conducted because the two algorithms are not fitted by the gradient descent method only four mathematical operators were used in the symbolic regression algorithm the dataset was randomly apportioned into training validation and test sets with a 60 20 20 split they were used to train the models tune the hyperparameters and evaluate the generalization error respectively the mean square error was selected as the loss function for all of the three machine learning algorithms the pre defined network architecture and forest structure are required in the deep neural network and random forest algorithms due to numerous combinations of the activation functions neuron number and the connection ways of hidden layers such as chain structure multiple branches skip connection as well as stacking cells the search space of network architecture is too large in this study five different search strategies including bayesian optimization bo 1 1 bo network architecture search was implemented by auto keras jin et al 2019 genetic programming gp 2 2 gp network architecture search was implemented using code from https github com joeddav devol reinforcement learning rl 3 3 rl network architecture search was implemented using code from https github com titu1994 neural architecture search efficient neural network search via parameter sharing method enas 4 4 enas was implemented using code from https github com carpedm20 enas pytorch and differentiable architecture search darts 5 5 darts was implemented using the code from https github com quark0 darts were used to find the optimal network architecture the detailed descriptions of these five search strategies can be found in snoek et al 2012 stanley et al 2009 zoph and le 2016 and pham et al 2018 differentiable architecture search algorithm liu et al 2018 the mean square error in the validation dataset was used as the objective or reward for network architecture search it should be pointed out that we did not unify the search space for these search strategies bayesian optimization genetic programming and reinforcement learning were employed to search the optimal chain structure the enas and darts were employed to search the optimal structure with multiple branches and skip connection the maximum hidden layer node was set as 6 to limit the complexity of the network the structure of the random forest is relatively simple it mainly depends on five hyperparameters including the number of trees in the forest n estimators the maximum depth of the tree max depth the minimum number of samples required to split an internal node min samples split the minimum number of sample to be at a leaf node min samples leaf the number of features to consider when looking for the best split max features however the computational cost of grid search for these hyperparameters is still huge therefore we first evaluated the effect of a single hyperparameter then combined the optimal value of every hyperparameter 2 5 hybrid evapotranspiration model in the sebs model the model error is mainly from the uncertainty of roughness lengths and the energy imbalance induced structural errors our previous works comprehensively investigated the data driven solutions to the model parameters and structural errors hu et al 2020 2021 in this study we utilized the random forest algorithm to build the data driven daily z0m instantaneous kb 1 and instantaneous ebr models the data driven solutions to these three variables were shown as follows 17 z 0 m f z 0 m h c l a i f c v u daily t a d a i l y 18 k b 1 f k b 1 u t a e a p a t s d t s w c h c f v c l a i l c t 19 ebr f ebr u t a v p d d t a dt dvpd dt t s u ζ z z i s w c h c f c v σ evi l c t where udaily and ta daily are daily average wind speed m s 1 and air temperature k the reason for using daily average data is that the z0m is assumed to be constant for the whole day dt is the difference between air temperature and land surface temperature k vpd is the vapor pressure deficit kpa dta dt and dvpd dt are the time derivative of air temperature k h 1 and vapor pressure deficit kpa h 1 ζ is the atmospheric stability z zi is the ratio of measurement height to boundary layer height σ evi is the standard deviation of evi across 20 km 20 km region the data driven z0m and kb 1 models combined with eqs 2 and 11 were used to estimate instantaneous h then the instantaneous le is obtained using the data driven ebr model 20 le e b r m r n g h where ebrm is the estimated ebr value it should be noted that it is more reasonable to unify the input variables when comparing the physical based data driven and hybrid models however the input variables vary in different models for example the sebs model does not consider soil water content ambient co2 incoming photosynthetic photon flux density while the three variables are related to the evapotranspiration process thus used in the data driven models this issue causes that the three types of evapotranspiration models are not comparable in some sense but it seems unavoidable therefore the effect of inconsistent input variables was ignored in this study 2 6 shapley additive explanations shap shap lundberg and lee 2017 is a game theoretic approach to explain the performance of the machine learning model it can quantify the contribution of the input feature to the prediction for an individual sample shap specifies the explanation using the additive feature attribution method 21 f x g x ϕ 0 i 1 m ϕ i x where f x is the original model g x is the explanation model with simplified input x x 0 1 m x and x are related via a mapping function x hx x m represents the number of input feature ϕi is the feature attribution for the feature i the explanation model g has a unique solution 22 ϕ i f x z x z m z 1 m f x z f x z i where z represents the number of non zero entries in z and z x f x f hx z e f z zs and s is the set of non zero indexes in z in this study all evapotranspiration models were analyzed by the shap method 3 results and discussion 3 1 optimization of pure data driven models the process of network architecture search for the deep neural network was displayed in fig 2 the five algorithms searched hundreds of network architectures the best network architectures from bo gp rl enas darts algorithms had valid rmse of 36 26 36 15 35 72 35 35 and 56 24 w m 2 respectively it indicated that most network architectures had a similar performance for evapotranspiration estimation bo and gp approaches displayed a convergence tendency the performance of network architectures found by darts was significantly poorer than other algorithms the reason is that darts uses the mixture of all candidate operations for each node during searching but replaces each mixed operation with the most likely operation when determining the final network architectures several bad network architectures occurred during the search process of the rl approach this phenomenon is due to the exploration exploitation strategy in the reinforcement learning algorithm when adopting the exploration strategy the rl approach will randomly generate a network architecture rather than produce a network architecture based on the reward of the last architecture the best network architecture was found by the enas algorithm and was diagramed in fig 3 this architecture had four branches shu et al 2020 claimed that existing neural architecture search algorithms favor architectures with wide and shallow cell structures which seems to support the fact the multiple branch structure was selected however it can be observed that the performance gap between multiple branch structure and chain structure was small which meant that both multiple branch and chain structures were suitable for evapotranspiration estimation moreover the physical meaning of this network architecture is still unclear we cannot infer the connection between this architecture and the mechanisms of evapotranspiration see fig 3 fig 4 illustrated the influence of hyperparameters on the performance of the rf based evapotranspiration model it can be observed that n estimators and max features had little impact on the accuracy of evapotranspiration estimation in contrast the performance of the rf based evapotranspiration model can be improved by decreasing min samples leaf and min samples split and increasing max depth finally the n estimators max depth min samples leaf min samples split and max feature were set as 100 2 2 auto respectively the hyperparameters of symbolic regression were set as the default values the prediction formula of evapotranspiration was shown as follow 23 le u t a 2 l a i 0 314 f v c r n s w c fvc l c t r n 2 pa l c t r n c o 2 l c t rh p p f d in 3 18 r n rh r n g t s c o 2 compared with previous studies parasuraman et al 2007 izadifar and elshorbagy 2010 eq 23 consistently revealed the critical role of net radiation in the evapotranspiration process however the last term in eq 23 is too complicated there are several meaningless operations in the last term thus it is not easy to extract some physical mechanism of evapotranspiration from the equation directly 3 2 evapotranspiration estimation the performance of the sebs model data driven models and hybrid models was shown in fig 5 the metrics including correlation coefficient r root mean square error rmse median absolute percentage error mdape and linear regression were adopted to evaluated these models it can be found that the sebs model performs worst the r was 0 66 the rmse and mdape were up to 121 w m 2 and 100 respectively in contrast the three data driven models acquired more accurate evapotranspiration estimation the rf based model obtained the best result with the r of 0 93 rmse of 32 w m 2 and mdape of 22 on the validation and test dataset the dnn based model reached a similar accuracy the r rmse and mdape were 0 91 37 w m 2 28 on the valid and test datasets respectively the error in the sr based model was relatively large the r decreased to 0 80 while rmse and mdape increased to 53 w m 2 and 40 respectively dnn based and sr based models had similar accuracy on training validation and test dataset but the training accuracy was obviously higher than validation and test accuracy in the rf based model the performance of the hybrid model was between the sebs model and the data driven models the r rmse and mdape were 0 81 60 w m 2 and 46 on the validation and test dataset respectively from the perspective of linear regression most models except the sr based model had a slope close to 1 and interception approaching 0 in the sr based model the slope was only 0 62 indicating an obvious bias 3 3 shap analysis fig 6 displayed the summary plots for the three data driven models using the 10 000 samples from the whole dataset each point on the plot represents the shapley value of a specific feature for a sample and the color indicated the value of the input feature the y axis indicates the input variables in the order of importance from top to bottom it can be found that all models consistently detected the net radiation as the most critical factor and revealed the positive correlation relationship between evapotranspiration and net radiation however the contributions of the rest feature varied in different models in the dnn based model the air temperature and land surface temperature also made a high contribution to evapotranspiration estimation the impact of the rest features was much smaller than the top three features in the rf based model fraction vegetation cover became the second important feature and air temperature remained high contribution but the importance of land surface decreased significantly some other features also contributed much to the evapotranspiration estimation in the sr based model the fraction vegetation cover and soil water content were the second and third important features respectively in contrast the contribution of soil water content was much less than the top two features the sebs model and the hybrid model contain a logarithm operation eqs 2 and 11 if using samples from the whole dataset there will be situations that the canopy height was higher than the measurement height when calculating the background values resulting in invalid results therefore we selected one site to compare the shapley values of different models fig 7 showed the summary plots of shapley value in the ca sf1 site enf 3991 samples for the three machine learning algorithms the main characteristics of shapley value distribution remained stable in the dnn based model the net radiation air temperature and land surface temperature still were the most critical features in the rf based model the net radiation fraction vegetation cover and air temperature made the most contribution to evapotranspiration estimation which was consistent with the result in fig 6 in the sr based model net radiation and fraction vegetation cover were still the top two essential features while air temperature replaced soil water content as the third essential feature soil water content still made a considerable contribution to evapotranspiration estimation in comparison the sebs model attached much importance to net radiation air temperature actual vapor pressure and land surface temperature land surface temperature air temperature and temperature difference contributed much to the hybrid models it can be seen that the sebs model and dnn based model shared a similar pattern of feature importance the net radiation air temperature land surface temperature and air humidity which were indicated by actual vapor pressure and relative humidity in the two models were the main factors impacting evapotranspiration fraction vegetation cover which played an essential role in rf based and sr based models made minor contributions in both the sebs and hybrid models the range of shapley values in the hybrid model was significantly larger than the other models in fig 7 e the shapley value was constrained in the range of 10 000 10 000 the constraint dropped 2 samples the high variation of shapley value is likely because some features are repeatedly used in different subprocesses 3 4 error propagation in the hybrid model in the hybrid model the data driven solutions were used to parameterize the roughness lengths and energy imbalance induced structural error table 1 listed the error of evapotranspiration estimation from different subprocesses it can be found that when using observed roughness lengths and ebr the r rmse and mdape were about 0 90 41 w m 2 and 16 respectively this error was due to the assumption of constant z0m over a short period of time and the uncertainty in the iteration process of atmospheric stability correction fig 8 a presented the evapotranspiration estimation using observed u l kb 1 and ebr in this case the evapotranspiration estimation obtained an excellent result in fig 8 b the observed u was replaced with estimated u and the other variables remained the observed values the evapotranspiration estimation had r rmse and mdpae of 0 87 50 59 w m 2 22 09 respectively this error quantified the uncertainty of the assumption of constant z0m for several days which directly resulted in the relatively poor performance of the hybrid model in fig 8 c u kb 1 and ebr were set as observed values then l and evapotranspiration were calculated using eqs 11 and 20 in this case the error source was sole the iteration process of atmospheric stability correction it can be observed that the atmospheric stability correction introduced an error with r of 0 97 rmse of 23 13 w m 2 mdape of 0 84 the failure of atmospheric stability correction mainly occurred in stable atmospheric conditions when using estimated roughness lengths the r decreased to 0 85 while rmse and mdape increased to 57 w m 2 and 40 compared with pure data driven evapotranspiration models the individual modification of energy imbalance induced structural error also failed to generate better evapotranspiration estimation with r of 0 82 0 89 rmse of 41 10 52 87 w m 2 and mdape of 26 96 39 53 when using the hybrid model with modifications of surface roughness length and energy imbalance induced structural error the accuracy of evapotranspiration estimation further degraded with r of 0 80 0 84 rmse of 52 11 60 52 w m 2 and mdape of 35 85 46 39 the error propagation analysis of the hybrid model indicated that deeper understandings of the roughness lengths the atmospheric stability correction and the energy imbalance problem are required on the one hand the assumption of constant z0m during several days causes significant error in friction velocity estimation and furtherly decreases the accuracy of evapotranspiration estimation moreover it is difficult to obtain accurate turbulence fluxes by the current scheme of atmospheric stability correction on the other hand machine learning algorithms are promising methods to quantify the subprocesses of evapotranspiration however current data driven solutions have met with limited success especially for the estimation of kb 1 and ebr the uncertainty from subprocesses models results in the fact that the hybrid model still underperforms the data driven models for energy imbalance induced structural error even the data driven method fails to achieve a satisfactory result the reason is likely due to missing some key features when building the ebr models 3 5 further discussion rethinking the modeling strategies for evapotranspiration estimation this study evaluated three modeling strategies for evapotranspiration estimation from the perspective of practicability the pure data driven model is likely to be the best choice for evapotranspiration modeling it does not contain any physical mechanism thus has no necessity to consider model parameters error and model structural error state of the art optimization techniques can help to acquire optimal hyperparameters the main issues of the pure data driven method are the representativeness of data and interpretability scientific problems involve many physical variables and physical variables commonly show intricate and non stationary patterns that dynamically change over time karpatne et al 2017 therefore the paucity of representative training samples may be inevitable in scientific problems zhao et al 2019 claimed that the pure data driven evapotranspiration model underperformed the hybrid evapotranspiration model under extreme weather conditions such as droughts and heatwaves the performance of the physical based model data driven models and hybrid model under extreme weather conditions was also evaluated in this work as shown in fig 9 the extreme weather in this study was defined from the aspect of soil moisture air temperature and relative humidity respectively the soil water content and relative humidity indicate extreme dry and wet weather and air temperature indicates heatwave and cold wave the 5 quantile and 95 quantile in the whole dataset were taken as the extreme weather threshold value zhu toth 2013 for example when investigating the model performances under extreme soil water content conditions the 5 quantile and 95 quantile of soil water content in the whole dataset are calculated samples with soil water content varying between the two threshold values in the original training dataset were used as the new training dataset the observation with soil water content lower than 5 quantile and higher than 95 quantile in the whole dataset was selected as the testing dataset a similar analysis was carried out from the aspect of air temperature and air humidity it should be emphasized that the thresholds in this analysis do not define the real extreme weather because the study of extreme weather requires long time series data for example 100 years essentially the performance under the extreme weather in the study reveals the extrapolation ability of models from the aspect of soil water content air temperature and relative humidity respectively the result showed that the data driven models still outperformed the physical based model and hybrid model the mdape of the hybrid model increased significantly under extreme weather conditions which is different from the conclusion of zhao et al 2019 we think the main reasons are 1 the insufficient prediction ability of current data driven parameters and structural error models especially the relatively high error in the data driven ebr model 2 the similar variation range of net radiation which is the most important variable for evapotranspiration estimation occurring in both normal weather and extreme weather which ensure the good performance of data driven models in extreme weather under extreme relative humidity conditions the rmse of sebs and hybrid model decreased obviously the reason is that the variation range of le is relatively narrow under low and high relative humidity conditions different machine learning algorithms usually learn different relationships from the same data the shapley value can help to tell whether the data driven model learns the correct relationship in this study the rf based and sr based evapotranspiration models are at high risk of learning a spurious relationship because their pattern of feature contributions is obviously different from that in physical based and hybrid models nevertheless this method is a post hoc analysis it is impossible to make a judgment before training a model in conclusion pure data driven evapotranspiration models can acquire accurate estimates but are at risk of distorting the relationship between evapotranspiration and input features in comparison the physical based and hybrid models retain the primary physical mechanism including the relation between flux and gradient and conservation law in physical based models the formulas of key parameters and subprocesses are derived based on some theoretical hypotheses and calibrated by limited laboratory observations these formulas can describe the variation tendency of parameters and subprocesses but may deviate from the true values the uncertainties in some subprocesses result in a large error for evapotranspiration estimation and severely limit the application of the physical based model the hybrid model quantifies these subprocesses using true observations which can achieve improvement to some degree the domain knowledge retained in the physical based and hybrid models tell us where the error comes from and how the error is propagated this information can guide us to further improve the model our result showed a large gap between pure data driven models and physical based hybrid models for evapotranspiration estimation zhao et al 2019 also built a framework for hybrid modeling of half hourly evapotranspiration their hybrid model achieved similar performance in comparison with the pure data driven model the small gap in their work is likely due to that they simplified the subprocess of evapotranspiration they used sensible and latent heat fluxes corrected by the bowen ratio method to avoid the energy imbalance problem and adopted a rough scheme of roughness lengths and only build a data driven model for the surface conductance in the framework of the modified penman monteith equation therefore the sole error source of evapotranspiration estimation was surface conductance although there are some disputes in their work such as enforcing closure for the energy imbalance problem and parameter compensation issue we can get an inspiration that minimizing the interdependent subprocesses can contribute to the improvement of the hybrid models the combination of data and knowledge such as hybrid modeling and theory guided data science is a recent research hotpot one key to integrating data with knowledge is the sufficient accuracy of knowledge our present work employs hybrid modeling to decrease the uncertainties from model parameters and model structure but some inaccurate knowledge including the assumption of constant z0m during a short time the iteration process of atmospheric stability correction and unknown factors for energy imbalance problem hinder the further improvement of evapotranspiration estimation another typical way of integrating data and knowledge is theory guided or physical informed machine learning which adds extra loss related to knowledge one famous method the physics informed neural network raissi et al 2019 has been widely applied to solve nonlinear partial differential equations the key to their success is that the pre defined governing equations are unbiased however the current applications of the physics informed neural network such as simulation of fluid dynamics raissi et al 2020 and subsurface flow wang et al 2020 still stay at the stage of virtual examples and there are few successful cases in real situations the main obstacle is the high uncertainty of the governing equations in real cases for the problem of evapotranspiration estimation the typical governing equations including flux gradient similarity relationship energy balance equation complementary relationship contain high uncertainty and thus are unsuitable to serve as the additional term of the loss function exploring more quantifiable inherent characteristics of the evapotranspiration process may promote the advancement of data knowledge coupling evapotranspiration models in summary the pure data driven method is recommended to estimate evapotranspiration if focusing on accuracy the sebs model clearly describes the physical process of evapotranspiration and owns good interpretability but the large parameters error and structural error which are hard to be solved by calibrating the model shown in the supplementary material limit its application although the current hybrid model fails to reach the accuracy level of data driven models the great potential of the hybrid model can be expected 4 conclusion in this study we evaluated the three modeling strategies including the physical based model data driven model and hybrid model for instantaneous evapotranspiration estimation specifically several state of the art search strategies were utilized to optimize the hyperparameters of machine learning algorithms all models were interpreted using the shapley additive explanations in addition a thorough analysis of different modeling strategies was conducted the main conclusions are summarized as follows 1 data driven models can acquire the best evapotranspiration estimation the performance of data driven models varies with the machine learning algorithm and optimization technique rf based model and dnn based model obtain the best evapotranspiration estimates with similar accuracy in comparison the error of the sr based model is relatively large shapley value reveals that different machine learning algorithms learn different relationships the dnn based model emphasizes the role of net radiation air temperature and land surface temperature while in rf based and sr based models the net radiation and soil water content make great contributions to evapotranspiration estimation dnn based model is more likely to learn a relatively correct relationship between evapotranspiration and environmental factors 2 the physical based model the sebs model performs worst by replacing the schemes of key parameters and subprocesses including surface roughness length and energy imbalance induced structural error with data driven solutions the hybrid model can improve the accuracy of evapotranspiration estimation but still underperforms the data driven model 3 under extreme weather conditions including extreme dry and wet weather heatwave and cold wave data driven models still present better performances than the physical based model and hybrid model 4 data driven model is recommended to estimate evapotranspiration when focusing on accuracy the hybrid model can be further improved by deeply understanding the evapotranspiration process s physical mechanism and decreasing interdependent subprocesses of the evapotranspiration model despite the insufficient accuracy of the current hybrid model in comparison with the data driven model the great potential of the hybrid model cannot be denied because the hybrid model retains the constraints of both data and physical laws finding other valuable features to improve the performance of data driven parameters and structural error models and adopting the physical based models with more robust are the feasible solutions to upgrade hybrid models credit authorship contribution statement xiaolong hu conceptualization methodology software writing original draft liangsheng shi conceptualization writing review editing supervision guang lin methodology writing review editing lin lin writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this study was supported by the national natural science foundation of china grant 51979200 51861125202 and 51779180 the authors gratefully acknowledge all of the researchers for their contributions behind each flux site and the organizers of the fluxnet database appendix a table a1 details the 49 sites used in this study appendix b supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126592 appendix b supplementary data the following are the supplementary data to this article supplementary data 1 
4288,numerous studies have separated the impacts of climate change and human activities on streamflow however the uncertainties of various methods applied for separating such impacts are seldom studied here we comprehensively investigated the uncertainty and causality of eight methods two statistical methods two sensitivity coefficient methods and four hydrological models for separating the contributions of climate change and human activities to streamflow over 20 catchments from 1952 to 2016 within the yellow river basin the ensemble mean of the eight methods indicates that human activities play a leading role in streamflow changes in most selected catchments however the contributions vary greatly across different methods the contribution of human activities in change period ii is greater than that in change period i in most catchments that have two change periods showing a gradually increasing trend in the contribution of human activities with the increase in the contribution of climate change or human activities to streamflow the uncertainty first increases before the contribution reaches 50 and then decreases our study suggests that it is useful to use multiple methods to reduce uncertainty in quantifying the impacts in catchments where climate change and human activity have similar influences keywords uncertainty climate change human activities streamflow hydrological model yellow river basin 1 introduction climate change and human activity are two major drivers that alter hydrological processes leading to significant changes in the spatiotemporal distribution of water availability dey and mishra 2017 for example increases in extreme rainstorms extreme floods yin et al 2018 zhang et al 2018b and global water shortages schewe et al 2014 have been triggered by climate change in addition accelerated glacier and snow melting caused by global warming has resulted in changes in the temporal distribution of streamflow barnett et al 2005 regarding human activity more than half of the world s rivers are affected by dams which have changed the natural streamflow in basins nilsson et al 2005 the increased crop evapotranspiration due to agricultural irrigation a kind of human activity has caused variations in streamflow jaramillo and destouni 2015 ma et al 2019 piao et al 2007 additionally the regional water cycle has also been severely affected by other human activities such as afforestation or deforestation it has been reported that the revegetation of the loess plateau is approaching the limit of the sustainable use of local water resources after the implementation of the grain to green program in 1999 feng et al 2016 zhang et al 2018a accurately and quantitatively separating the impacts of climate change and human activities on streamflow can provide important guidance not only for water resource management but also for achieving sustainable development goals at present numerous methods have been utilized for separating the impact of climate variability and human activities on streamflow which primarily include 1 statistical analysis methods du and shi 2012 gao et al 2017 miao et al 2011 sun et al 2020 wang et al 2012 zhang et al 2018c 2 the budyko hypothesis liang 2017 wang and hejazi 2011 xu et al 2014 yang et al 2018 zhao et al 2014 zhou et al 2019 3 climate and hydrology analysis methods liang et al 2013 liu et al 2013 2012b zhao et al 2013 and 4 hydrological models feng et al 2018 jehanzaib et al 2020a 2020b li et al 2021 liang et al 2013 yan et al 2018 zhang et al 2019 details of these methods are summarized in table 1 the study by chang et al 2016 in the jing river basin showed that three methods an elasticity coefficient method based on budyko topmodel and the vic hydrological model produced very similar results where the contributions of climate change and human activities were 20 and 80 respectively wu et al 2017a found that the results were similar among elasticity coefficient methods based on eight budyko equations in 17 catchments on the loess plateau liu et al 2013 analyzed the attribution of streamflow changes in the yiluo river basin and found that the results obtained by the hydrological sensitivity analysis method and the abcd hydrological model were also similar however zhao et al 2014 showed that the results of the elasticity coefficient method based on the budyko hypothesis and linear regression were different at 12 hydrological stations with an average difference of 13 8 xue et al 2017 quantitatively analyzed the impact of climatic and anthropogenic factors on streamflow in the tarim river basin using the precipitation runoff double mass curve dmc method and three elasticity coefficient methods based on the budyko hypothesis they found that the contributions of climatic variables obtained by the four methods differed by 23 2 and 88 5 during two separate impact periods wu et al 2017b found that elasticity coefficient methods and hydrological modeling methods produced similar estimates in the yan river basin but the estimates made from the statistical analysis method were largely different the above results indicate that the uncertainty of different separation approaches is great and remains unclear among various basins moreover few studies have comprehensively evaluated the uncertainty caused by various methods to separate the impact of climate change and human activities on streamflow which requires further analysis therefore the purpose of our study is to investigate the size and patterns of the uncertainty among different methods used for separating the impacts of climate change and human activities on streamflow this can be useful for water resource planning and sustainable development at the catchment scale the yellow river basin yrb is a typical semiarid basin zhang and huang 2001 with serious water shortage problems there are various human activities that have strong impacts on the underlying surface water in the yellow river basin such as afforestation returning farmland to forest and grassland reservoir construction and coal mining fu et al 2011 2017 li et al 2017 wang et al 2015 zhao et al 2014 in the last few decades the land use types in the yellow river basin have changed drastically and water flux and sediment load have changed significantly under the influence of both human and natural factors miao et al 2011 therefore the yellow river basin is an ideal place for studying the uncertainties in the methods of separating the impacts of climate change and human activities on streamflow change in the present study we selected 20 typical catchments within the yellow river basin as the research areas and applied the nonparametric mann kendall test to identify the abrupt change points in streamflow for all catchments the study period 1952 2016 was then divided into a baseline period and impact periods according to the abrupt change points after that eight separation methods were applied with the following objectives i applying different methods in multiple catchments to distinguish the impacts of climate change and human activities on streamflow ii analyzing the uncertainty of the separation of the effects of climate change and human activities on streamflow due to different methods and iii evaluating the applicability of different separation methods in different catchments 2 materials and methods 2 1 study region located between 95 53 119 05 e and 32 10 41 50 n the yellow river originates on the northern tibetan plateau flows through the loess plateau and the north china plain and eventually empties into the bohai sea in eastern china the yellow river is the second longest river in china with a total length of 5464 km and a drainage area of 795 000 km2 including 42 000 km2 of internal flow areas cuo et al 2013 the climatic conditions over the entire basin are obviously different with semi humid conditions in the southeast semiarid conditions in the middle and arid conditions in the northwest water scarcity is severe in the yellow river basin this study selects 20 catchments from upstream to downstream in the yellow river basin as the research areas the location and name of each catchment are shown in fig 1 among them only the huangshui river datong river and tao river are located in the upper reaches and the remaining catchments are located in the middle reaches of the yellow river basin the attributes of each catchment are shown in table 2 catchment ids catchment names hydrological stations catchment area average elevation average annual precipitation for 1952 2016 average annual temperature average annual potential evapotranspiration average annual streamflow depth forest coverage rate in the 1970s and the length of the streamflow time series during the study period these 20 catchments are the main tributaries of the yellow river and can represent the diverse hydroclimatic conditions of the entire yellow river basin 2 2 data monthly streamflow data with different lengths of available time series table 2 for these 20 hydrological stations were used in the study they were collected from the hydrological yearbook of the people s republic of china meteorological data consisting of daily precipitation maximum temperature minimum temperature and average wind speed for the period of 1952 2012 were collected from the institute of geographic sciences and natural resources reseach igsnrr data zhang et al 2014a zhang and tang 2015 with a spatial resolution of 0 25 the daily sunshine hours and actual vapor pressure at 121 stations in the yellow river basin for the period of 1952 2012 were from the china meteorological administration cma daily meteorological data consisting of precipitation maximum and minimum temperature downward shortwave radiation specific humidity and wind speed for the period of 2013 2016 were from the climate meteorological forcing dataset cmfd http data tpdc ac cn yang and he 2018 he et al 2020 with a spatial resolution of 0 1 albedo data required to calculate net radiation were obtained from the 8 day modis mcd43b bidirectional reflectance distribution function product at 1 km resolution the savitzky and golay sg savitzky and golay 1964 filter algorithm was used to smooth the 8 day albedo data and to generate data on a daily timescale the meteorological and albedo data for grid cells located within a catchment were averaged to obtain catchment aggregated inputs for catchment scale modeling except for the swat model which is a fully distributed model the elevation data were extracted from the nasa advanced spaceborne thermal emission and reflection radiometer global digital elevation model aster gdem with a spatial resolution of 30m the soil attribute data soil distribution map 1 1 000 000 and land use land cover lulc data 1 1 000 000 of the 1970s were obtained from the data center for resources and environmental sciences chinese academy of sciences http www resdc cn 2 3 trend analysis and abrupt change detection the nonparametric mann kendall mk method mann 1945 kendall 1975 hamed and rao 1998 burn and elnur 2002 has been widely used to analyze abrupt changes in hydrological time series the mann kendall test was used to carry out trend and abrupt change analyses on the streamflow from the study catchments for time series data x x 1 x 2 xn the mk trend test statistic s is defined as follows 1 s i 1 n 1 j i 1 n sgn x j x i 2 sgn x j x i 1 x j x i 0 x j x i 1 x j x i where n is the number of samples which is the length of the time series i and j are serial numbers and xi and xj are the hydrologic variables when the time series data are i and j the mk statistical test value z is 3 z s 1 v a r s s 0 0 s 0 s 1 v a r s s 0 4 v a r s n n 1 2 n 5 18 when z 0 the time series shows an upward trend and when z 0 it indicates a downward trend when the significance level α 0 01 z1 α 2 2 58 and when α 0 05 z1 α 2 1 96 for the mk abrupt change test the statistic sk is as follows 5 s k i 1 k r i 2 k n 6 r i 1 x i x j 0 x i x j j 1 2 i where xi and xj are the hydrologic variables when the time series data are i and j and sk is the count for the x series when xi is larger than xj under the assumption that the time series is stochastically independent the formulations for the mean e sk and variance var sk of sk are 7 e s k k k 1 4 8 v a r s k k k 1 2 k 5 72 subsequently ufk is used to evaluate the positive sequence of the variable x 9 u f k s k e s k v a r s k the time series is reversed and the aforementioned procedure is repeated to yield ubk to evaluate the inverted sequence in addition ufk is defined as ubk if the value of ufk 0 the time series shows an upward trend if ufk 0 the time series shows a downward trend if the ufk curve exceeds the critical line α 0 05 z1 α 2 1 96 it indicates that the time series has a significant upward or downward trend if the crossing point between the ufk and ubk curves is located within the confidence interval this point marks the beginning of an abrupt change in the time series 2 4 methods for separating the impacts of climate change and human activities on streamflow eight approaches were selected in this study to separate the effects of climate change and human activities on streamflow which includes almost all available approaches shown in table 1 the precipitation runoff double mass curve dmc method the slope change ratio of cumulative quantity method scrcq the sensitivity coefficient methods based on budyko of fu and yang budykofu and budykoyang respectively and four hydrological models the hydrologiska byrans vattenbalansavdelning hbv model simulation of hydrology simhyd model xinanjing xaj model and soil and water assessment tool swat model 2 4 1 double mass curve method the dmc method is a common method to test the consistency and the change in the relationship between two variables the method consists of comparing the slope of continuous accumulation values of two variables in the different periods which are drawn in the rectangular coordinate system kohler 1949 searcy and hardison 1960 for two variables x reference variable or benchmark variable x represents precipitation in this study and y tested variable y is streamflow in this study xi and yi represent their observations during the period of n years where i 1 2 3 n first the cumulative values of x and y are calculated year by year according to 10 and 11 respectively the yearly cumulative time series xi and yi are calculated as follows 10 x i i 1 n x i 11 y i i 1 n y i then the relationship between the cumulative values corresponding to the two variables is plotted in the cartesian coordinate system for the double mass curve of streamflow and precipitation if the slope of the curve does not deviate significantly it indicates that human activities have a marginal effect on river streamflow and if the slope of the curve significantly deviates it indicates that human activities have a noticeable effect 2 4 2 slope change ratio of cumulative quantity scrcq method the scrcq method wang et al 2012 was used to quantify the relative influences of climate change i e precipitation and temperature and human activities on streamflow changes for convenience the baseline period is set as period a and the impact period is set as period b the slopes of the change in cumulative streamflow cumulative precipitation and cumulative temperature with time are represented as sra spa and sta in period a and as srb spb and stb in period b respectively the change rates of the slope of cumulative streamflow rr cumulative precipitation rp and cumulative temperature rt can be obtained by subtracting the slopes of cumulative streamflow cumulative precipitation and cumulative temperature in the two periods respectively it is assumed in this method that precipitation and streamflow are positively correlated and that temperature and streamflow are negatively correlated the contributions of precipitation ηp and temperature ηt to streamflow changes are defined as 12 η p r p r r 100 13 η t r t r r 100 where rr rp and rt are the change rates of the slope of cumulative streamflow cumulative precipitation and cumulative temperature in the impact period relative to the baseline period respectively the contributions of climate change ηc and human activities ηh to streamflow are calculated as 14 η c η p η t 15 η h 1 η c 2 4 3 two sensitivity coefficient methods based on the budyko framework budyko discovered that long term average actual evapotranspiration e is mainly determined by the balance between the atmospheric water supply precipitation p and the evapotranspiration capacity potential evapotranspiration ep based on this theory the budyko hypothesis was proposed budyko 1948 1974 since then multiple mathematical equations have been developed to describe the budyko hypothesis fu 1981 zhang et al 2001 choudhury 1999 yang et al 2007 2008 wang and tang 2014 this study used two budyko equations from fu 1981 and yang et al 2007 yang et al 2008 the formula fu 1981 is 16 e p 1 q p 1 e p p 1 e p p ω 1 ω the equation from yang et al 2007 yang et al 2008 is 17 q p e p e p p p n e p n 1 n where q p e and ep are the mean annual streamflow depth mm mean annual precipitation mm mean annual actual evaporation mm and mean annual potential evapotranspiration mm respectively and ω and n are catchment specific parameters the parameters ω and n are directly deduced using catchment mean annual q p and ep to quantify the response degree of climate factors p and ep to streamflow the sensitivity coefficient method was used to calculate the sensitivity of streamflow to p and ep liu et al 2012a 18 δ q c q p δ p q e p δ e p where δqc is the change in streamflow caused by climate change q p and q e p represent the sensitivity coefficients of streamflow to p and ep respectively and δp and δep are the changes in p and ep respectively the two sensitivity coefficients calculated from 16 are 19 q p p ω 1 e p ω p ω 1 ω 1 20 q e p e p ω 1 e p ω p ω 1 ω 1 1 the two sensitivity coefficients calculated from 17 are 21 q p 1 e p e p n p n e p n 22 q e p e e p p n p n e p n the change in streamflow caused by human activities can then be calculated as 23 δ q h δ q δ q c in which δqh is the change in streamflow caused by human activities and δq is the actual change in streamflow 2 4 4 hbv simhyd and xaj models three conceptual rainfall runoff models were used in this study hbv ding et al 2018 krysanova et al 1999 seibert 1997 1999 simhyd chiew et al 2010 li et al 2014 2013 zhang and chiew 2009 zhang et al 2014b and xaj hydrological models zhao 1992 the basic concept of these three models is to use a series of mathematical equations to characterize the conversion relationships among precipitation evaporation and streamflow as well as the changes in soil water and groundwater processes there are differences in the assumptions of soil structure runoff generation mechanism and runoff composition among these three models details of specific model structures are provided in appendix a the three hydrological models were driven by daily meteorological data of precipitation maximum temperature minimum temperature sunshine hours 1952 2012 or incoming solar radiation 2013 2016 and actual vapor pressure from 1952 to 2016 due to the different establishment times of these 20 hydrological stations the model initialization time was different for each catchment the modeling periods are summarized in table 2 the three models have a daily time resolution and catchment scale spatial resolution daily potential evapotranspiration was calculated using the priestley taylor equation priestley and taylor 1972 with the daily maximum and minimum temperature actual vapor pressure data sunshine hours or incoming solar radiation and albedo 2 4 5 swat model the soil and water assessment tool swat model arnold and allen 1996 arnold et al 1998 2012 is a physical based model developed by the united states department of agriculture it has been widely used because of its strong physical mechanism simple inputs and good performance this model can be applied for catchment water balance accounting assessment of nitrogen and phosphorus pollution in rivers from point sources and nonpoint sources and investigating the impact of management measures climate and land use changes on the water quality and quantity in basins mosbahi and benabdallah 2019 the terrestrial hydrological cycle processes in the swat model are divided into two stages the first stage is the ground flow calculation which mainly controls the water flows sediment pollutants etc the second stage is the calculation of river confluence which refers to the migration processes of water sediment nutrients etc that are formed in the first stage and flow to the water outlet the model is based on the water balance equation as follows 24 s w t s w 0 i 1 t p day i q surf i e a i w seep i q gw i where swt mm represents the soil water content at the end of the calculation period sw0 mm represents the soil water content at the initial moment t represents the time period of the hydrological cycle process pday i mm represents the precipitation on the ith day qsurf i mm represents the surface streamflow on the ith day ea i mm represents the evapotranspiration on the ith day wseep i mm represents the water amount infiltrating the vadose zone on the ith day and qgw i mm represents the return flow from the groundwater on the ith day the swat model is driven by dem data lulc data soil data and meteorological data i e precipitation maximum temperature minimum temperature and wind speed from 1952 to 2016 in this study with a daily time resolution and a spatial resolution of 0 25 2 5 calibration and validation of the four hydrological models to quantitatively distinguish the impacts of climate change and human activities on the streamflow in the four hydrological models according to mann kendall burn and elnur 2002 hamed and rao 1998 kendall 1975 mann 1945 abrupt change analysis results of streamflow time series the period before the first abrupt change point of each catchment was used as the baseline period and the period after the first abrupt change point was defined as the impact period a catchment with two abrupt change points has two impact periods namely impact period i and impact period ii the first two years of the baseline period were used for model spin up the remaining baseline period for each catchment was divided into a calibration phase 75 of the selected period and a validation phase 25 of the selected period 2 5 1 calibration and validation of hbv simhyd and xaj models a global optimizer the particle swarm optimization pso toolbox eberhart and kennedy 1995 in matlab was used to optimize the parameters of the three conceptual hydrological models in this study a population size of 300 and the maximum generation of 100 were used to search the optimum solution by the genetic algorithm in the pso toolbox the objective function used for calibrating the model in this study is the nash sutcliffe efficiency nse nash and sutcliffe 1970 25 f 1 n s e 5 l n 1 b i a s 2 5 26 nse 1 i 1 n q obs i q sim i 2 i 1 n q obs i q obs 2 27 bias i 1 n q obs i i 1 n q sim i i 1 n q obs i where qsim and qobs are the simulated and observed monthly streamflows respectively q obs is the mean value of the observed monthly streamflow i is the ith month and n is the total number of months in the calibration period the goal of calibration is to minimize the f value the nse value was used to evaluate the results of calibration and validation when nse 1 0 it indicates perfect agreement between the modeled and observed monthly streamflow the bias value measures the error between the modeled and observed streamflows with bias 0 indicating that the mean simulated monthly streamflow is the same as the mean observed monthly streamflow the standards for model calibration and validation moriasi et al 2007 are shown in table 3 2 5 2 calibration and validation of swat model to maximize nse and minimize bias at the same time in the swat model parameter calibration process we applied the latest version of swat cup premium https www 2w2e com for parameter calibration to ensure that the objective function of the swat model is consistent with the above three hydrological models moreover it is not only convenient for comparison with other models but also has better calibration results and reduces the model error 2 5 3 calibration and validation results of four hydrological models fig 2 summarizes the calibration and validation results of monthly streamflow for the four hydrological models they perform well in most catchments there are more than 70 catchments with nse greater than 0 5 in both the calibration and validation phases the absolute values of bias for the simhyd and swat models are all less than 20 in the calibration phase and the absolute values of bias of the hbv model and xaj model are greater than 20 for only two catchments the absolute values of bias are less than 20 in more than 14 catchments and less than 40 in almost all catchments in the validation phase these results demonstrate that the four hydrological models can be applied to the 20 catchments to separate the impacts of climate change and human activities on catchment streamflow 2 6 calculation of contribution for all approaches except scrcq this study takes the period before the first abrupt change point as the baseline period and the period after the first abrupt change point as the impact period for each year thereafter the change in streamflow caused by climate change and anthropogenic activities can be calculated as follows 28 δ q q past q pre δ q c δ q h 29 δ q h q past q sim 30 δ q c δ q δ q h q sim q pre where δq is the total change in streamflow and δqc and δqh are the changes in streamflow caused by climate variability and anthropogenic activities respectively qpast and qpre are the observed annual average streamflows in the periods after the abrupt change and before the abrupt change respectively qsim is the multiyear average streamflow that is based on using the meteorological data after the abrupt change as input to the model to simulate under the influence of only climate change factors the relative contributions of climate variability ηc and human activities ηh to the change in streamflow are defined as follows 31 η c δ q c δ q c δ q h 100 32 η h δ q h δ q c δ q h 100 2 7 calculation of uncertainty among eight methods in this study the standard deviation of the results obtained by the eight methods was used to represent the uncertainty standard deviation is calculated as follows 33 σ i 1 n η i η 2 n where n represents the number of approaches 8 in this study ηi represents the relative contribution of climate variability or anthropogenic activities to the streamflow for every method and η represents the averaged relative contribution of the eight methods 3 results and discussions 3 1 trend and abrupt change point detection of annual streamflow table 4 summarizes the trend results for the 20 selected catchments the annual streamflow decreased significantly at the 95 or 99 confidence level over most catchments except the huangshui river where streamflow decreased non significantly fig 3 shows the abrupt change point results the time of the abrupt change points varied greatly within the selected catchments but most of them occurred in the early 1970s and mid late 1990s there were two abrupt change points in 13 catchments and one abrupt change point in 7 catchments 3 2 contributions of climate change and human activities to streamflow changes table 5 summarizes the contributions of climate change and human activity to streamflow changes in the kuye river and qin river catchments in the kuye river catchment the contribution of climate change to streamflow ranges from 13 67 scrcq to 93 5 hbv during change period i and the contribution of climate change to streamflow is 0 9 xaj to 35 3 hbv during change period ii in the qin river catchment the contribution of climate change to streamflow varies from 18 0 scrcq to 63 1 simhyd in change period i and from 24 3 scrcq to 68 6 budykoyang in change period ii this result indicates that the contributions obtained from different methods are quite different even in the same catchment fig 4 shows that the contributions of climate change to streamflow obtained by different methods vary greatly in each catchment indicating that there are great uncertainties among different methods overall the sensitivity coefficient methods using the two budyko equations budykofu and budykoyang obtain similar results i e climate change dominates the streamflow change in most of the 20 catchments this is because the two commonly used budyko equations have the same physical mechanism and meaning the results obtained by the swat model show that climate change and human activities contribute almost equally to streamflow changes while other methods indicate a greater contribution of human activities the latter case is especially obvious for the xaj model which shows that all catchments are dominated by human activities the ensemble of the eight methods indicates that streamflow changes in most catchments are caused by human activities and human activities play a leading role in the streamflow changes in the yellow river for the catchments that have two abrupt change points the contribution of human activities in change period ii is greater than that in change period i this indicates that the impact of human activities on streamflow has increased in recent years over most catchments our findings are consistent with those of previous studies by chang et al 2015 kong et al 2016 li et al 2016 and wei et al 2016 comparing the results of the two impact periods in 13 catchments the contribution of human activities to streamflow changes gradually increases which is consistent with previous results liu et al 2017a luan et al 2020 3 3 attribution analysis of uncertainty to investigate potential reasons for the uncertainty due to the separation methods we analyzed the relationship between the uncertainty standard deviations of separation methods and catchment attributes which include the catchment area aridity index precipitation average elevation average annual streamflow volume and average annual streamflow depth as the influencing factors fig 5 shows that the correlations between the catchment characteristics and uncertainty are all very poor p 0 05 suggesting that the uncertainty of the separation methods has no direct relationship with the catchment characteristics the relationship between the uncertainties and the contribution of climate change or human activities to streamflow changes was further analyzed fig 6 shows that when the contribution of climate change to streamflow was less than 50 i e the streamflow change was due mainly to human activities the uncertainty gradually increased with the increase in contribution when the contribution of climate change to streamflow was greater than 50 i e the streamflow change was due mainly to climate change however the uncertainty decreased with the increase in contribution since the selected catchments with a contribution of climate change greater than 50 in this study are limited this phenomenon cannot be fully displayed nevertheless the current results indicate the existence of this downward trend the closer the contributions of climate change and human activities to streamflow changes 50 each the greater the uncertainty of the separation method in contrast the greater the difference in the contribution between the two factors the less the uncertainty of the separation method the relationship between the uncertainty and contribution of climate change or human activities to streamflow is symmetrical in which the uncertainty increases with the increase in contribution of climate change at first and then decreases when the contribution of climate change exceeds 50 3 4 stability analysis of different methods referring to the concept of box plots the contributions with frequencies between 25 and 75 among the eight methods are considered stable otherwise they are considered unstable li and zhang 2017 liu et al 2017b the two sensitivity coefficient methods based on budyko budykofu and budykoyang and the xaj model have low stability in contrast the hbv model has good stability fig 7 the reason that sensitivity coefficient methods based on budyko are not stable is possibly related to their assumption that the water storage of the catchment remains unchanged however in 13 catchments there are two abrupt change points which divide the entire streamflow time series into three time periods as a result some short term baseline periods or impact periods were produced which caused some errors in the results and are the reason that the water balance of the catchment on a relatively short time scale is difficult to achieve the reason for the low stability of the xaj model is probably that the mechanism of the xaj model is runoff yield under saturated storage which is not suitable for the yellow river basin especially the loess plateau the above stability analysis can provide guidance for selecting suitable hydrological models for the catchments of the yellow river basin 3 5 choosing a reliable separation method our results indicate that there are obvious uncertainties in the separation of the impacts of climate change and human activity on streamflow due to the attribution methods therefore choosing a reliable method is critical when analyzing the contribution of climate change and human activity to streamflow in one catchment some studies have suggested that empirical statistics tend to be more suitable at a large regional scale kong et al 2016 miao et al 2011 from the law of large numbers the method with the closest results to the mean can be regarded as the most reliable method guo and li 2021 according to this standard table 6 lists the most reliable method for each research period in all catchments the xaj model and the two sensitivity coefficient methods based on budyko are not reliable the xaj model does not appear and the two sensitivity coefficient methods appear only once the simhyd model was the most reliable since it appeared 11 times accounting for 1 3 of the total this result is consistent with the results in sections 3 2 and 3 4 from this perspective the simhyd model shows the best adaptability in the yellow river basin and the xaj model shows the worst application ability the reason for this may be because the yellow river basin is mainly located in a vast arid and semiarid area and the selected 20 research catchments are mainly located on the loess plateau with a thick loess layer the streamflow mode on the loess plateau is mainly based on the runoff yield under excess infiltration mechanism zhao 1992 zhang et al 2016 this mechanism is in accordance with the theory of the streamflow calculation in the simhyd model therefore the adaptability of the simhyd model is relatively strong in this area for the sensitivity coefficient methods based on budyko the premise of the application of these methods is the multiyear water balance which considers that the water storage of the catchment remains unchanged however in some catchments there are two abrupt change points which divide the entire streamflow time series into three time periods causing some baseline period or impact periods to be relatively short in time series which causes errors in the results reflecting that this method is relatively unsuitable for those catchments 3 6 relationship between uncertainty and the contributions of climate change human activities to streamflow fig 6 shows that the relationship between uncertainty and the contribution of climate change or human activities to streamflow is symmetrical in which the uncertainty first increases with the increase in the contribution of climate change and then decreases after the contribution of climate change exceeds 50 to make the selected method more representative we analyzed the relationship between the uncertainty of only six separation methods two statistical methods dmc and scrcq two sensitivity coefficient methods and two hydrological models a lumped hydrological model and a distributed hydrological model namely the simhyd model and swat model respectively and the contribution of climate change or human activities to streamflow the relationship between uncertainty and the contribution of climate change or human activities is consistent when comparing fig 8 with fig 6 and the uncertainty reaches its maximum at a contribution of approximately 35 although the data for climate change contributions greater than 50 are relatively limited they display a decreasing trend in fig 8 that is highly consistent with that in fig 6 indicating the reliability of the symmetrical relationship it can be predicted that those relationships would be more significant with sufficient data the reason for this result can be explained by the theory of information entropy the water resource system is regarded as a dissipative structure chang et al 2002 and there is a certain relationship between entropy and structural order that is the information entropy of the system is large and its degree of order is low conversely the higher the order of the system the lower its entropy climate change and human activities can be considered two states in the water resource system according to the extreme value of entropy shannon 1948 when the probability of each state in the system is equal to each other the entropy value reaches the maximum at this point the water resource system has the lowest degree of order and reaches the most disordered state i e the greatest uncertainty when the contributions of climate change and human activity are closer to each other 3 7 limitations this study focuses on the uncertainty of the methods for separating the contributions of climate and human impacts on streamflow however the assumptions for quantitatively separating the impact of climate change and human activities on catchment streamflow are that streamflow in the baseline period was not affected by human activities and that climate change and human activities are independent of each other these factors may cause small errors in the results as climate change and human activities could have interactive effects in addition since the two statistical methods and the budyko methods can be used for only an annual scale we did not consider the change in seasonal streamflow in the present study which may need further exploration in the future moreover due to the availability of the time series of the dataset various meteorological data sources with different accuracies in different periods were used in this study which might cause small errors in the results however we used the exact same datasets within each method which can eliminate the impact of those problems however it is better to use only one data source if the time series are sufficient and available in the future 4 conclusions this study aimed to investigate the uncertainty of different methods used for separating climate change and human activity impacts on streamflow we used eight methods two statistical methods two sensitivity coefficient methods and four hydrological models to quantify the uncertainty in separating climate change and human activity impacts on streamflow over 20 catchments in the yellow river basin we found that large uncertainty exists among the various methods in general the sensitivity coefficient methods indicate that climate change is the dominant factor over most catchments while the swat model shows that climate change and human activities contribute almost equally to the streamflow changes and other methods especially the xaj model indicate a greater contribution of human activities in most catchments the uncertainty of different methods has no relationship with catchment attributes however the relationship between the uncertainty and contribution of climate change or human activities to streamflow is symmetrical in which the uncertainty increases with the increase in contribution of climate change at first and then decreases when the contribution of climate change exceeds 50 we also found that the hbv model and simhyd model are relatively stable and the two sensitivity coefficient methods and the xaj model are relatively unstable overall the impact of human activities is greater than that of climate change on streamflow changes in the yellow river basin the contribution of human activities in change period ⅱ is greater than that in change period ι in most catchments that have two change periods showing a gradually increasing trend when the catchment is less or more affected by human activities the uncertainty of the attribution method is smaller while when the impact of climate change and human activities is similar the uncertainty of the attribution analysis method becomes larger this strong correlation provides theoretical and methodological guidance for selecting the method of separating streamflow changes laying a foundation for the accurate attribution of streamflow changes this is useful for planning and managing catchment water resources author contributions yongqiang zhang conceived this study jinkai luan performed data analyses and modeling prepared the figures and drafted the manuscript all the authors contributed to the writing and interpretation of the results declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the national natural science foundation of china grant no 41971032 cas pioneer hundred talents program and the science for a better development of inner mongolia program of the bureau of science and technology of the inner mongolia province we acknowledge the daily meteorological forcing data provided by xuejun zhang and kun yang we thank anonymous reviewers and editors for constructive comments on this study appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126605 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4288,numerous studies have separated the impacts of climate change and human activities on streamflow however the uncertainties of various methods applied for separating such impacts are seldom studied here we comprehensively investigated the uncertainty and causality of eight methods two statistical methods two sensitivity coefficient methods and four hydrological models for separating the contributions of climate change and human activities to streamflow over 20 catchments from 1952 to 2016 within the yellow river basin the ensemble mean of the eight methods indicates that human activities play a leading role in streamflow changes in most selected catchments however the contributions vary greatly across different methods the contribution of human activities in change period ii is greater than that in change period i in most catchments that have two change periods showing a gradually increasing trend in the contribution of human activities with the increase in the contribution of climate change or human activities to streamflow the uncertainty first increases before the contribution reaches 50 and then decreases our study suggests that it is useful to use multiple methods to reduce uncertainty in quantifying the impacts in catchments where climate change and human activity have similar influences keywords uncertainty climate change human activities streamflow hydrological model yellow river basin 1 introduction climate change and human activity are two major drivers that alter hydrological processes leading to significant changes in the spatiotemporal distribution of water availability dey and mishra 2017 for example increases in extreme rainstorms extreme floods yin et al 2018 zhang et al 2018b and global water shortages schewe et al 2014 have been triggered by climate change in addition accelerated glacier and snow melting caused by global warming has resulted in changes in the temporal distribution of streamflow barnett et al 2005 regarding human activity more than half of the world s rivers are affected by dams which have changed the natural streamflow in basins nilsson et al 2005 the increased crop evapotranspiration due to agricultural irrigation a kind of human activity has caused variations in streamflow jaramillo and destouni 2015 ma et al 2019 piao et al 2007 additionally the regional water cycle has also been severely affected by other human activities such as afforestation or deforestation it has been reported that the revegetation of the loess plateau is approaching the limit of the sustainable use of local water resources after the implementation of the grain to green program in 1999 feng et al 2016 zhang et al 2018a accurately and quantitatively separating the impacts of climate change and human activities on streamflow can provide important guidance not only for water resource management but also for achieving sustainable development goals at present numerous methods have been utilized for separating the impact of climate variability and human activities on streamflow which primarily include 1 statistical analysis methods du and shi 2012 gao et al 2017 miao et al 2011 sun et al 2020 wang et al 2012 zhang et al 2018c 2 the budyko hypothesis liang 2017 wang and hejazi 2011 xu et al 2014 yang et al 2018 zhao et al 2014 zhou et al 2019 3 climate and hydrology analysis methods liang et al 2013 liu et al 2013 2012b zhao et al 2013 and 4 hydrological models feng et al 2018 jehanzaib et al 2020a 2020b li et al 2021 liang et al 2013 yan et al 2018 zhang et al 2019 details of these methods are summarized in table 1 the study by chang et al 2016 in the jing river basin showed that three methods an elasticity coefficient method based on budyko topmodel and the vic hydrological model produced very similar results where the contributions of climate change and human activities were 20 and 80 respectively wu et al 2017a found that the results were similar among elasticity coefficient methods based on eight budyko equations in 17 catchments on the loess plateau liu et al 2013 analyzed the attribution of streamflow changes in the yiluo river basin and found that the results obtained by the hydrological sensitivity analysis method and the abcd hydrological model were also similar however zhao et al 2014 showed that the results of the elasticity coefficient method based on the budyko hypothesis and linear regression were different at 12 hydrological stations with an average difference of 13 8 xue et al 2017 quantitatively analyzed the impact of climatic and anthropogenic factors on streamflow in the tarim river basin using the precipitation runoff double mass curve dmc method and three elasticity coefficient methods based on the budyko hypothesis they found that the contributions of climatic variables obtained by the four methods differed by 23 2 and 88 5 during two separate impact periods wu et al 2017b found that elasticity coefficient methods and hydrological modeling methods produced similar estimates in the yan river basin but the estimates made from the statistical analysis method were largely different the above results indicate that the uncertainty of different separation approaches is great and remains unclear among various basins moreover few studies have comprehensively evaluated the uncertainty caused by various methods to separate the impact of climate change and human activities on streamflow which requires further analysis therefore the purpose of our study is to investigate the size and patterns of the uncertainty among different methods used for separating the impacts of climate change and human activities on streamflow this can be useful for water resource planning and sustainable development at the catchment scale the yellow river basin yrb is a typical semiarid basin zhang and huang 2001 with serious water shortage problems there are various human activities that have strong impacts on the underlying surface water in the yellow river basin such as afforestation returning farmland to forest and grassland reservoir construction and coal mining fu et al 2011 2017 li et al 2017 wang et al 2015 zhao et al 2014 in the last few decades the land use types in the yellow river basin have changed drastically and water flux and sediment load have changed significantly under the influence of both human and natural factors miao et al 2011 therefore the yellow river basin is an ideal place for studying the uncertainties in the methods of separating the impacts of climate change and human activities on streamflow change in the present study we selected 20 typical catchments within the yellow river basin as the research areas and applied the nonparametric mann kendall test to identify the abrupt change points in streamflow for all catchments the study period 1952 2016 was then divided into a baseline period and impact periods according to the abrupt change points after that eight separation methods were applied with the following objectives i applying different methods in multiple catchments to distinguish the impacts of climate change and human activities on streamflow ii analyzing the uncertainty of the separation of the effects of climate change and human activities on streamflow due to different methods and iii evaluating the applicability of different separation methods in different catchments 2 materials and methods 2 1 study region located between 95 53 119 05 e and 32 10 41 50 n the yellow river originates on the northern tibetan plateau flows through the loess plateau and the north china plain and eventually empties into the bohai sea in eastern china the yellow river is the second longest river in china with a total length of 5464 km and a drainage area of 795 000 km2 including 42 000 km2 of internal flow areas cuo et al 2013 the climatic conditions over the entire basin are obviously different with semi humid conditions in the southeast semiarid conditions in the middle and arid conditions in the northwest water scarcity is severe in the yellow river basin this study selects 20 catchments from upstream to downstream in the yellow river basin as the research areas the location and name of each catchment are shown in fig 1 among them only the huangshui river datong river and tao river are located in the upper reaches and the remaining catchments are located in the middle reaches of the yellow river basin the attributes of each catchment are shown in table 2 catchment ids catchment names hydrological stations catchment area average elevation average annual precipitation for 1952 2016 average annual temperature average annual potential evapotranspiration average annual streamflow depth forest coverage rate in the 1970s and the length of the streamflow time series during the study period these 20 catchments are the main tributaries of the yellow river and can represent the diverse hydroclimatic conditions of the entire yellow river basin 2 2 data monthly streamflow data with different lengths of available time series table 2 for these 20 hydrological stations were used in the study they were collected from the hydrological yearbook of the people s republic of china meteorological data consisting of daily precipitation maximum temperature minimum temperature and average wind speed for the period of 1952 2012 were collected from the institute of geographic sciences and natural resources reseach igsnrr data zhang et al 2014a zhang and tang 2015 with a spatial resolution of 0 25 the daily sunshine hours and actual vapor pressure at 121 stations in the yellow river basin for the period of 1952 2012 were from the china meteorological administration cma daily meteorological data consisting of precipitation maximum and minimum temperature downward shortwave radiation specific humidity and wind speed for the period of 2013 2016 were from the climate meteorological forcing dataset cmfd http data tpdc ac cn yang and he 2018 he et al 2020 with a spatial resolution of 0 1 albedo data required to calculate net radiation were obtained from the 8 day modis mcd43b bidirectional reflectance distribution function product at 1 km resolution the savitzky and golay sg savitzky and golay 1964 filter algorithm was used to smooth the 8 day albedo data and to generate data on a daily timescale the meteorological and albedo data for grid cells located within a catchment were averaged to obtain catchment aggregated inputs for catchment scale modeling except for the swat model which is a fully distributed model the elevation data were extracted from the nasa advanced spaceborne thermal emission and reflection radiometer global digital elevation model aster gdem with a spatial resolution of 30m the soil attribute data soil distribution map 1 1 000 000 and land use land cover lulc data 1 1 000 000 of the 1970s were obtained from the data center for resources and environmental sciences chinese academy of sciences http www resdc cn 2 3 trend analysis and abrupt change detection the nonparametric mann kendall mk method mann 1945 kendall 1975 hamed and rao 1998 burn and elnur 2002 has been widely used to analyze abrupt changes in hydrological time series the mann kendall test was used to carry out trend and abrupt change analyses on the streamflow from the study catchments for time series data x x 1 x 2 xn the mk trend test statistic s is defined as follows 1 s i 1 n 1 j i 1 n sgn x j x i 2 sgn x j x i 1 x j x i 0 x j x i 1 x j x i where n is the number of samples which is the length of the time series i and j are serial numbers and xi and xj are the hydrologic variables when the time series data are i and j the mk statistical test value z is 3 z s 1 v a r s s 0 0 s 0 s 1 v a r s s 0 4 v a r s n n 1 2 n 5 18 when z 0 the time series shows an upward trend and when z 0 it indicates a downward trend when the significance level α 0 01 z1 α 2 2 58 and when α 0 05 z1 α 2 1 96 for the mk abrupt change test the statistic sk is as follows 5 s k i 1 k r i 2 k n 6 r i 1 x i x j 0 x i x j j 1 2 i where xi and xj are the hydrologic variables when the time series data are i and j and sk is the count for the x series when xi is larger than xj under the assumption that the time series is stochastically independent the formulations for the mean e sk and variance var sk of sk are 7 e s k k k 1 4 8 v a r s k k k 1 2 k 5 72 subsequently ufk is used to evaluate the positive sequence of the variable x 9 u f k s k e s k v a r s k the time series is reversed and the aforementioned procedure is repeated to yield ubk to evaluate the inverted sequence in addition ufk is defined as ubk if the value of ufk 0 the time series shows an upward trend if ufk 0 the time series shows a downward trend if the ufk curve exceeds the critical line α 0 05 z1 α 2 1 96 it indicates that the time series has a significant upward or downward trend if the crossing point between the ufk and ubk curves is located within the confidence interval this point marks the beginning of an abrupt change in the time series 2 4 methods for separating the impacts of climate change and human activities on streamflow eight approaches were selected in this study to separate the effects of climate change and human activities on streamflow which includes almost all available approaches shown in table 1 the precipitation runoff double mass curve dmc method the slope change ratio of cumulative quantity method scrcq the sensitivity coefficient methods based on budyko of fu and yang budykofu and budykoyang respectively and four hydrological models the hydrologiska byrans vattenbalansavdelning hbv model simulation of hydrology simhyd model xinanjing xaj model and soil and water assessment tool swat model 2 4 1 double mass curve method the dmc method is a common method to test the consistency and the change in the relationship between two variables the method consists of comparing the slope of continuous accumulation values of two variables in the different periods which are drawn in the rectangular coordinate system kohler 1949 searcy and hardison 1960 for two variables x reference variable or benchmark variable x represents precipitation in this study and y tested variable y is streamflow in this study xi and yi represent their observations during the period of n years where i 1 2 3 n first the cumulative values of x and y are calculated year by year according to 10 and 11 respectively the yearly cumulative time series xi and yi are calculated as follows 10 x i i 1 n x i 11 y i i 1 n y i then the relationship between the cumulative values corresponding to the two variables is plotted in the cartesian coordinate system for the double mass curve of streamflow and precipitation if the slope of the curve does not deviate significantly it indicates that human activities have a marginal effect on river streamflow and if the slope of the curve significantly deviates it indicates that human activities have a noticeable effect 2 4 2 slope change ratio of cumulative quantity scrcq method the scrcq method wang et al 2012 was used to quantify the relative influences of climate change i e precipitation and temperature and human activities on streamflow changes for convenience the baseline period is set as period a and the impact period is set as period b the slopes of the change in cumulative streamflow cumulative precipitation and cumulative temperature with time are represented as sra spa and sta in period a and as srb spb and stb in period b respectively the change rates of the slope of cumulative streamflow rr cumulative precipitation rp and cumulative temperature rt can be obtained by subtracting the slopes of cumulative streamflow cumulative precipitation and cumulative temperature in the two periods respectively it is assumed in this method that precipitation and streamflow are positively correlated and that temperature and streamflow are negatively correlated the contributions of precipitation ηp and temperature ηt to streamflow changes are defined as 12 η p r p r r 100 13 η t r t r r 100 where rr rp and rt are the change rates of the slope of cumulative streamflow cumulative precipitation and cumulative temperature in the impact period relative to the baseline period respectively the contributions of climate change ηc and human activities ηh to streamflow are calculated as 14 η c η p η t 15 η h 1 η c 2 4 3 two sensitivity coefficient methods based on the budyko framework budyko discovered that long term average actual evapotranspiration e is mainly determined by the balance between the atmospheric water supply precipitation p and the evapotranspiration capacity potential evapotranspiration ep based on this theory the budyko hypothesis was proposed budyko 1948 1974 since then multiple mathematical equations have been developed to describe the budyko hypothesis fu 1981 zhang et al 2001 choudhury 1999 yang et al 2007 2008 wang and tang 2014 this study used two budyko equations from fu 1981 and yang et al 2007 yang et al 2008 the formula fu 1981 is 16 e p 1 q p 1 e p p 1 e p p ω 1 ω the equation from yang et al 2007 yang et al 2008 is 17 q p e p e p p p n e p n 1 n where q p e and ep are the mean annual streamflow depth mm mean annual precipitation mm mean annual actual evaporation mm and mean annual potential evapotranspiration mm respectively and ω and n are catchment specific parameters the parameters ω and n are directly deduced using catchment mean annual q p and ep to quantify the response degree of climate factors p and ep to streamflow the sensitivity coefficient method was used to calculate the sensitivity of streamflow to p and ep liu et al 2012a 18 δ q c q p δ p q e p δ e p where δqc is the change in streamflow caused by climate change q p and q e p represent the sensitivity coefficients of streamflow to p and ep respectively and δp and δep are the changes in p and ep respectively the two sensitivity coefficients calculated from 16 are 19 q p p ω 1 e p ω p ω 1 ω 1 20 q e p e p ω 1 e p ω p ω 1 ω 1 1 the two sensitivity coefficients calculated from 17 are 21 q p 1 e p e p n p n e p n 22 q e p e e p p n p n e p n the change in streamflow caused by human activities can then be calculated as 23 δ q h δ q δ q c in which δqh is the change in streamflow caused by human activities and δq is the actual change in streamflow 2 4 4 hbv simhyd and xaj models three conceptual rainfall runoff models were used in this study hbv ding et al 2018 krysanova et al 1999 seibert 1997 1999 simhyd chiew et al 2010 li et al 2014 2013 zhang and chiew 2009 zhang et al 2014b and xaj hydrological models zhao 1992 the basic concept of these three models is to use a series of mathematical equations to characterize the conversion relationships among precipitation evaporation and streamflow as well as the changes in soil water and groundwater processes there are differences in the assumptions of soil structure runoff generation mechanism and runoff composition among these three models details of specific model structures are provided in appendix a the three hydrological models were driven by daily meteorological data of precipitation maximum temperature minimum temperature sunshine hours 1952 2012 or incoming solar radiation 2013 2016 and actual vapor pressure from 1952 to 2016 due to the different establishment times of these 20 hydrological stations the model initialization time was different for each catchment the modeling periods are summarized in table 2 the three models have a daily time resolution and catchment scale spatial resolution daily potential evapotranspiration was calculated using the priestley taylor equation priestley and taylor 1972 with the daily maximum and minimum temperature actual vapor pressure data sunshine hours or incoming solar radiation and albedo 2 4 5 swat model the soil and water assessment tool swat model arnold and allen 1996 arnold et al 1998 2012 is a physical based model developed by the united states department of agriculture it has been widely used because of its strong physical mechanism simple inputs and good performance this model can be applied for catchment water balance accounting assessment of nitrogen and phosphorus pollution in rivers from point sources and nonpoint sources and investigating the impact of management measures climate and land use changes on the water quality and quantity in basins mosbahi and benabdallah 2019 the terrestrial hydrological cycle processes in the swat model are divided into two stages the first stage is the ground flow calculation which mainly controls the water flows sediment pollutants etc the second stage is the calculation of river confluence which refers to the migration processes of water sediment nutrients etc that are formed in the first stage and flow to the water outlet the model is based on the water balance equation as follows 24 s w t s w 0 i 1 t p day i q surf i e a i w seep i q gw i where swt mm represents the soil water content at the end of the calculation period sw0 mm represents the soil water content at the initial moment t represents the time period of the hydrological cycle process pday i mm represents the precipitation on the ith day qsurf i mm represents the surface streamflow on the ith day ea i mm represents the evapotranspiration on the ith day wseep i mm represents the water amount infiltrating the vadose zone on the ith day and qgw i mm represents the return flow from the groundwater on the ith day the swat model is driven by dem data lulc data soil data and meteorological data i e precipitation maximum temperature minimum temperature and wind speed from 1952 to 2016 in this study with a daily time resolution and a spatial resolution of 0 25 2 5 calibration and validation of the four hydrological models to quantitatively distinguish the impacts of climate change and human activities on the streamflow in the four hydrological models according to mann kendall burn and elnur 2002 hamed and rao 1998 kendall 1975 mann 1945 abrupt change analysis results of streamflow time series the period before the first abrupt change point of each catchment was used as the baseline period and the period after the first abrupt change point was defined as the impact period a catchment with two abrupt change points has two impact periods namely impact period i and impact period ii the first two years of the baseline period were used for model spin up the remaining baseline period for each catchment was divided into a calibration phase 75 of the selected period and a validation phase 25 of the selected period 2 5 1 calibration and validation of hbv simhyd and xaj models a global optimizer the particle swarm optimization pso toolbox eberhart and kennedy 1995 in matlab was used to optimize the parameters of the three conceptual hydrological models in this study a population size of 300 and the maximum generation of 100 were used to search the optimum solution by the genetic algorithm in the pso toolbox the objective function used for calibrating the model in this study is the nash sutcliffe efficiency nse nash and sutcliffe 1970 25 f 1 n s e 5 l n 1 b i a s 2 5 26 nse 1 i 1 n q obs i q sim i 2 i 1 n q obs i q obs 2 27 bias i 1 n q obs i i 1 n q sim i i 1 n q obs i where qsim and qobs are the simulated and observed monthly streamflows respectively q obs is the mean value of the observed monthly streamflow i is the ith month and n is the total number of months in the calibration period the goal of calibration is to minimize the f value the nse value was used to evaluate the results of calibration and validation when nse 1 0 it indicates perfect agreement between the modeled and observed monthly streamflow the bias value measures the error between the modeled and observed streamflows with bias 0 indicating that the mean simulated monthly streamflow is the same as the mean observed monthly streamflow the standards for model calibration and validation moriasi et al 2007 are shown in table 3 2 5 2 calibration and validation of swat model to maximize nse and minimize bias at the same time in the swat model parameter calibration process we applied the latest version of swat cup premium https www 2w2e com for parameter calibration to ensure that the objective function of the swat model is consistent with the above three hydrological models moreover it is not only convenient for comparison with other models but also has better calibration results and reduces the model error 2 5 3 calibration and validation results of four hydrological models fig 2 summarizes the calibration and validation results of monthly streamflow for the four hydrological models they perform well in most catchments there are more than 70 catchments with nse greater than 0 5 in both the calibration and validation phases the absolute values of bias for the simhyd and swat models are all less than 20 in the calibration phase and the absolute values of bias of the hbv model and xaj model are greater than 20 for only two catchments the absolute values of bias are less than 20 in more than 14 catchments and less than 40 in almost all catchments in the validation phase these results demonstrate that the four hydrological models can be applied to the 20 catchments to separate the impacts of climate change and human activities on catchment streamflow 2 6 calculation of contribution for all approaches except scrcq this study takes the period before the first abrupt change point as the baseline period and the period after the first abrupt change point as the impact period for each year thereafter the change in streamflow caused by climate change and anthropogenic activities can be calculated as follows 28 δ q q past q pre δ q c δ q h 29 δ q h q past q sim 30 δ q c δ q δ q h q sim q pre where δq is the total change in streamflow and δqc and δqh are the changes in streamflow caused by climate variability and anthropogenic activities respectively qpast and qpre are the observed annual average streamflows in the periods after the abrupt change and before the abrupt change respectively qsim is the multiyear average streamflow that is based on using the meteorological data after the abrupt change as input to the model to simulate under the influence of only climate change factors the relative contributions of climate variability ηc and human activities ηh to the change in streamflow are defined as follows 31 η c δ q c δ q c δ q h 100 32 η h δ q h δ q c δ q h 100 2 7 calculation of uncertainty among eight methods in this study the standard deviation of the results obtained by the eight methods was used to represent the uncertainty standard deviation is calculated as follows 33 σ i 1 n η i η 2 n where n represents the number of approaches 8 in this study ηi represents the relative contribution of climate variability or anthropogenic activities to the streamflow for every method and η represents the averaged relative contribution of the eight methods 3 results and discussions 3 1 trend and abrupt change point detection of annual streamflow table 4 summarizes the trend results for the 20 selected catchments the annual streamflow decreased significantly at the 95 or 99 confidence level over most catchments except the huangshui river where streamflow decreased non significantly fig 3 shows the abrupt change point results the time of the abrupt change points varied greatly within the selected catchments but most of them occurred in the early 1970s and mid late 1990s there were two abrupt change points in 13 catchments and one abrupt change point in 7 catchments 3 2 contributions of climate change and human activities to streamflow changes table 5 summarizes the contributions of climate change and human activity to streamflow changes in the kuye river and qin river catchments in the kuye river catchment the contribution of climate change to streamflow ranges from 13 67 scrcq to 93 5 hbv during change period i and the contribution of climate change to streamflow is 0 9 xaj to 35 3 hbv during change period ii in the qin river catchment the contribution of climate change to streamflow varies from 18 0 scrcq to 63 1 simhyd in change period i and from 24 3 scrcq to 68 6 budykoyang in change period ii this result indicates that the contributions obtained from different methods are quite different even in the same catchment fig 4 shows that the contributions of climate change to streamflow obtained by different methods vary greatly in each catchment indicating that there are great uncertainties among different methods overall the sensitivity coefficient methods using the two budyko equations budykofu and budykoyang obtain similar results i e climate change dominates the streamflow change in most of the 20 catchments this is because the two commonly used budyko equations have the same physical mechanism and meaning the results obtained by the swat model show that climate change and human activities contribute almost equally to streamflow changes while other methods indicate a greater contribution of human activities the latter case is especially obvious for the xaj model which shows that all catchments are dominated by human activities the ensemble of the eight methods indicates that streamflow changes in most catchments are caused by human activities and human activities play a leading role in the streamflow changes in the yellow river for the catchments that have two abrupt change points the contribution of human activities in change period ii is greater than that in change period i this indicates that the impact of human activities on streamflow has increased in recent years over most catchments our findings are consistent with those of previous studies by chang et al 2015 kong et al 2016 li et al 2016 and wei et al 2016 comparing the results of the two impact periods in 13 catchments the contribution of human activities to streamflow changes gradually increases which is consistent with previous results liu et al 2017a luan et al 2020 3 3 attribution analysis of uncertainty to investigate potential reasons for the uncertainty due to the separation methods we analyzed the relationship between the uncertainty standard deviations of separation methods and catchment attributes which include the catchment area aridity index precipitation average elevation average annual streamflow volume and average annual streamflow depth as the influencing factors fig 5 shows that the correlations between the catchment characteristics and uncertainty are all very poor p 0 05 suggesting that the uncertainty of the separation methods has no direct relationship with the catchment characteristics the relationship between the uncertainties and the contribution of climate change or human activities to streamflow changes was further analyzed fig 6 shows that when the contribution of climate change to streamflow was less than 50 i e the streamflow change was due mainly to human activities the uncertainty gradually increased with the increase in contribution when the contribution of climate change to streamflow was greater than 50 i e the streamflow change was due mainly to climate change however the uncertainty decreased with the increase in contribution since the selected catchments with a contribution of climate change greater than 50 in this study are limited this phenomenon cannot be fully displayed nevertheless the current results indicate the existence of this downward trend the closer the contributions of climate change and human activities to streamflow changes 50 each the greater the uncertainty of the separation method in contrast the greater the difference in the contribution between the two factors the less the uncertainty of the separation method the relationship between the uncertainty and contribution of climate change or human activities to streamflow is symmetrical in which the uncertainty increases with the increase in contribution of climate change at first and then decreases when the contribution of climate change exceeds 50 3 4 stability analysis of different methods referring to the concept of box plots the contributions with frequencies between 25 and 75 among the eight methods are considered stable otherwise they are considered unstable li and zhang 2017 liu et al 2017b the two sensitivity coefficient methods based on budyko budykofu and budykoyang and the xaj model have low stability in contrast the hbv model has good stability fig 7 the reason that sensitivity coefficient methods based on budyko are not stable is possibly related to their assumption that the water storage of the catchment remains unchanged however in 13 catchments there are two abrupt change points which divide the entire streamflow time series into three time periods as a result some short term baseline periods or impact periods were produced which caused some errors in the results and are the reason that the water balance of the catchment on a relatively short time scale is difficult to achieve the reason for the low stability of the xaj model is probably that the mechanism of the xaj model is runoff yield under saturated storage which is not suitable for the yellow river basin especially the loess plateau the above stability analysis can provide guidance for selecting suitable hydrological models for the catchments of the yellow river basin 3 5 choosing a reliable separation method our results indicate that there are obvious uncertainties in the separation of the impacts of climate change and human activity on streamflow due to the attribution methods therefore choosing a reliable method is critical when analyzing the contribution of climate change and human activity to streamflow in one catchment some studies have suggested that empirical statistics tend to be more suitable at a large regional scale kong et al 2016 miao et al 2011 from the law of large numbers the method with the closest results to the mean can be regarded as the most reliable method guo and li 2021 according to this standard table 6 lists the most reliable method for each research period in all catchments the xaj model and the two sensitivity coefficient methods based on budyko are not reliable the xaj model does not appear and the two sensitivity coefficient methods appear only once the simhyd model was the most reliable since it appeared 11 times accounting for 1 3 of the total this result is consistent with the results in sections 3 2 and 3 4 from this perspective the simhyd model shows the best adaptability in the yellow river basin and the xaj model shows the worst application ability the reason for this may be because the yellow river basin is mainly located in a vast arid and semiarid area and the selected 20 research catchments are mainly located on the loess plateau with a thick loess layer the streamflow mode on the loess plateau is mainly based on the runoff yield under excess infiltration mechanism zhao 1992 zhang et al 2016 this mechanism is in accordance with the theory of the streamflow calculation in the simhyd model therefore the adaptability of the simhyd model is relatively strong in this area for the sensitivity coefficient methods based on budyko the premise of the application of these methods is the multiyear water balance which considers that the water storage of the catchment remains unchanged however in some catchments there are two abrupt change points which divide the entire streamflow time series into three time periods causing some baseline period or impact periods to be relatively short in time series which causes errors in the results reflecting that this method is relatively unsuitable for those catchments 3 6 relationship between uncertainty and the contributions of climate change human activities to streamflow fig 6 shows that the relationship between uncertainty and the contribution of climate change or human activities to streamflow is symmetrical in which the uncertainty first increases with the increase in the contribution of climate change and then decreases after the contribution of climate change exceeds 50 to make the selected method more representative we analyzed the relationship between the uncertainty of only six separation methods two statistical methods dmc and scrcq two sensitivity coefficient methods and two hydrological models a lumped hydrological model and a distributed hydrological model namely the simhyd model and swat model respectively and the contribution of climate change or human activities to streamflow the relationship between uncertainty and the contribution of climate change or human activities is consistent when comparing fig 8 with fig 6 and the uncertainty reaches its maximum at a contribution of approximately 35 although the data for climate change contributions greater than 50 are relatively limited they display a decreasing trend in fig 8 that is highly consistent with that in fig 6 indicating the reliability of the symmetrical relationship it can be predicted that those relationships would be more significant with sufficient data the reason for this result can be explained by the theory of information entropy the water resource system is regarded as a dissipative structure chang et al 2002 and there is a certain relationship between entropy and structural order that is the information entropy of the system is large and its degree of order is low conversely the higher the order of the system the lower its entropy climate change and human activities can be considered two states in the water resource system according to the extreme value of entropy shannon 1948 when the probability of each state in the system is equal to each other the entropy value reaches the maximum at this point the water resource system has the lowest degree of order and reaches the most disordered state i e the greatest uncertainty when the contributions of climate change and human activity are closer to each other 3 7 limitations this study focuses on the uncertainty of the methods for separating the contributions of climate and human impacts on streamflow however the assumptions for quantitatively separating the impact of climate change and human activities on catchment streamflow are that streamflow in the baseline period was not affected by human activities and that climate change and human activities are independent of each other these factors may cause small errors in the results as climate change and human activities could have interactive effects in addition since the two statistical methods and the budyko methods can be used for only an annual scale we did not consider the change in seasonal streamflow in the present study which may need further exploration in the future moreover due to the availability of the time series of the dataset various meteorological data sources with different accuracies in different periods were used in this study which might cause small errors in the results however we used the exact same datasets within each method which can eliminate the impact of those problems however it is better to use only one data source if the time series are sufficient and available in the future 4 conclusions this study aimed to investigate the uncertainty of different methods used for separating climate change and human activity impacts on streamflow we used eight methods two statistical methods two sensitivity coefficient methods and four hydrological models to quantify the uncertainty in separating climate change and human activity impacts on streamflow over 20 catchments in the yellow river basin we found that large uncertainty exists among the various methods in general the sensitivity coefficient methods indicate that climate change is the dominant factor over most catchments while the swat model shows that climate change and human activities contribute almost equally to the streamflow changes and other methods especially the xaj model indicate a greater contribution of human activities in most catchments the uncertainty of different methods has no relationship with catchment attributes however the relationship between the uncertainty and contribution of climate change or human activities to streamflow is symmetrical in which the uncertainty increases with the increase in contribution of climate change at first and then decreases when the contribution of climate change exceeds 50 we also found that the hbv model and simhyd model are relatively stable and the two sensitivity coefficient methods and the xaj model are relatively unstable overall the impact of human activities is greater than that of climate change on streamflow changes in the yellow river basin the contribution of human activities in change period ⅱ is greater than that in change period ι in most catchments that have two change periods showing a gradually increasing trend when the catchment is less or more affected by human activities the uncertainty of the attribution method is smaller while when the impact of climate change and human activities is similar the uncertainty of the attribution analysis method becomes larger this strong correlation provides theoretical and methodological guidance for selecting the method of separating streamflow changes laying a foundation for the accurate attribution of streamflow changes this is useful for planning and managing catchment water resources author contributions yongqiang zhang conceived this study jinkai luan performed data analyses and modeling prepared the figures and drafted the manuscript all the authors contributed to the writing and interpretation of the results declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the national natural science foundation of china grant no 41971032 cas pioneer hundred talents program and the science for a better development of inner mongolia program of the bureau of science and technology of the inner mongolia province we acknowledge the daily meteorological forcing data provided by xuejun zhang and kun yang we thank anonymous reviewers and editors for constructive comments on this study appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126605 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4289,drought is a slowly developing phenomenon and possibly influences a wide domain drought index is one of the ways in monitoring and surveying drought hence palmer drought severity index pdsi has been used as a valid and operational model in this study the discrete wavelet transform dwt tool is incorporated with fuzzy k nearest neighbour knn and support vector machine svm modelling tools to improve forecasting accuracy and extend lead time dwt is further used to decompose original pdsi data into wavelets sub series which in turn are used as inputs into the fuzzy knn and svm models for the development of a new model in forecasting pdsi for longer lead times from 1 to 12 months dwt combined with fuzzy knn and svm models are termed as w fuzzy w knn and w svm models the predictive models are implemented in the marmara region of turkey the accuracy of combined hybrid w fuzzy w knn and w svm models are compared with stand alone fuzzy knn and svm models by using mean square error mse coefficient of efficiency ce and coefficient of determination r2 as performance indicators the results of this study reveal that developed hybrid w fuzzy w knn and w svm models performed very well up to lead time of 6 months furthermore combined w fuzzy w knn and w svm models are performed better than stand alone fuzzy knn and svm models however the prediction performance of w fuzzy model is slightly better than those of w knn and w svm models for all lead time predictions in terms of performance indicator criteria mse ce and r2 keywords drought palmer drought severity index hybrid models stand alone models 1 introduction drought is defined as a shortage of precipitation and named as agricultural drought or hydrological drought if occurs during thegrowing seasonresulting in crop damage or the winterrun offandpercolationseason affecting water supplies respectively american meteorological society 2000 drought differs from most other natural hazards in many ways particularly in prediction difficulty of the beginning date ending date and the current intensity mckee et al 1993 long lasting drought has a great impact on the nation s economy and society accurate drought prediction helps to mitigate devastating economic effects on people and ecosystems mo et al 2009 in monitoring droughts the meteorological drought indicators the palmer drought severity index pdsi standardized precipitation index spi reconnaissance drought index rdi and standardized precipitation evapotranspiration index spei widely utilized palmer 1965 mckee et al 1993 tsakiris et al 2007 vicente serrano et al 2010 mehdizadeh et al 2020 researchers have suggested several methods to predict drought index among different indices the palmer drought severity index pdsi is the most popular one for agro climatological analysis palmer 1965 in the last few decades drought has become a repetitive phenomenon for many countries european environment agency 2001 lloyd hughes and saunders 2002 in turkey crucial drought conditions occurred in late 1980s and following effects lasted until the late 1990s repeated droughts affect the countries in terms of water resources agricultural sectors and ecosystems sönmez et al 2005 improved version of the the palmer drought severity index pdsi palmer 1965 is currently used with precipitation and temperature data to evaluate relative drought the palmer drought index is based on a supply and demand model of soil moisture developed for the united states and tested using the regional climates of the u s sönmez et al 2005 mehdizadeh et al 2020 standardized precipitation index spi and a modified spi were used in previous researches in analyzing the probability of drought over turkey however there is a lack of study about drought index especially pdsi in marmara region and pdsi data in turkey is significantly scarce the studies of drought forecasting studies have been increased in recent years mishra and singh 2009 and ozger et al 2011 developed a predictive model to estimate pdsi data using a wavelet fuzzy logic model based on meteorological variables the model is satisfactorily carried out to predict pdsi data for 10 climate divisions in texas mokhtarzad et al 2017 studied drought forecasting by using artificial neural network ann adaptive neuro fuzzy interface system anfis and support vector machine svm and compared the results of these models in their study standardized precipitation index spi is used for 3 month time scales in the bojnourd province iran and the results showed that the svm model provides more accurate values for forecasting murugesakumar et al 2016 applied various data mining techniques and applications to classify soil fertility including ann k nearest neighbour knn decision tree dt bayesian network bn fuzzy svm and k means km and addressed the importance of the use of information technology in agriculture can change the way decisions are made and farmers can perform better mehdizadeh et al 2020 used classic time series and hybrid wavelet gene expression programming w gep approach to simulate drought phenomenon the standardized precipitation evapotranspiration index spei obtained from six meteorology stations located in turkey is used in their study they found that the hybrid w gep model generated accurate prediction results arıkan and kahya 2016 performed the linear genetic programming lgp model to forecast drought conditions with 3 6 and 12 months lead times in konya province turkey using the observed north atlantic oscillation index naoi and palmer s drought severity index pdsi as predictors kisi and cimen 2012 used the svm conjunction model in forecasting the precipitation of the stations located in izmir and afyon provinces of turkey they reported that the conjunction method performs better than the single svm and could increase the forecast accuracy advantages of fuzzy approach according to altunkaynak 2010 and altunkaynak and wang 2011 have the capability of improving the accuracy of traditional models and does not require solving complicated mathematical equations such as partial differential equations fuzzy method relates any linguistic input to output via using verbal statements if then fuzzy rules based on expert knowledge or historical observed data in addition fuzzy tool has a simple procedure for model development and ability to utilize expert view for model simulation that is to say that an appropriate model can be developed via using expert knowledge even without having available data opposite to classical regression fuzzy method has no restrictive assumption such as normality homoscedasticity linearity etc disadvantages of fuzzy approach according to bizimana and altunkaynak 2020 are that fuzzy model becomes complicated when many variables and subsets are required as inputs into the model accordingly high dimensional feature vectors lead to exponential increase in the number of fuzzy rules which induces complexity and computational time advantages of support vector machine svm according to altunkaynak and kartal 2021 have the ability to handle high dimensional feature vectors although the dimensions of the feature vectors are greater than that of sample data svm can be utilized to solve nonlinear regression and pattern classification problems via using ε insensitive loss function it provides a general solution by expressing complex processes with a decision hyperplane with the use of high dimensional feature vectors svm method is utilized to overcome the challenging nature of usability of only linear functions it is well suited to analyze the high dimensional feature vectors with small sample data disadvantage of svm according to awad and khanna 2015 is that it cannot generate probability predictions which are computed utilizing so unfeasible expensive and fivefold cross validation advantage of k nearest neighbour knn according to yamaç et al 2020 is that the knn tool has a simple and robustness learning procedure and a good agreement with the concept of statistical probabilistic therefore it can generate very good model results with using a simple algorithm disadvantages of knn according to altunkaynak and kartal 2021 the selection of suitable parameters for the development of the knn model is pretty challenging and may have negative effects on the processing performance the knn tool has no mapping function that relates input to output and also makes extrapolation this implies that it cannot predict relatively high values without historical observed data independent data this means that its accuracy is highly limited when used for real time predictions wavelet tool is a procedure that is widely utilized to decompose the original time series data into sub series spectral bands and eliminate the trend and periodicity in other words wavelet technique removes the trend component convers a non stationary time series data into stationary time series fernandes 2001 adamowski and sun 2010 altunkaynak 2014 mehr et al 2014 djerbouai and souag gamane 2016 in this study wavelet is basically used as a pre processing tool to eliminate the seasonal patterns of monthly pdsi data so that tangible analysis can be undertaken and accurate prediction results can be obtained with longer lead times for this reason wavelet as a successful preprocessing technique is central in developing a predictive model for prediction of monthly pdsi time series data accurately even for longer lead times the objective of using the combined w fuzzy w svm and w knn models was to predict monthly pdsi time series data accurately for lead times of 1 up to 12 months to the best of our knowledge this procedure has not been used with combination of fuzzy svm and knn for pdsi time series data for improving prediction accuracy and extension of lead time predictions of pdsi data even though there have been some attempts to develop techniques for predicting pdsi data at a monthly scale most of them were recommended for very short lead time liu and hwang 2015 beyaztas et al 2018 therefore further studies should be undertaken to develop models for accurate prediction of monthly pdsi time series data for long lead times the objective of this study was to develop predictive models with combination of wavelet as a pre processing technique with the motivation that wavelet is the most widely and accurately used pre processing technique in recent hydrological studies and compare the stand alone fuzzy svm and knn models performance with combined w fuzzy w svm and w knn models fuzzy svm and knn models were selected and used as modelling tools because they have simple implementation procedures the objective in developing combined models were to obtain more accurate and longer lead time predictions of pdsi data it is obvious that predictions with high accuracy are very important in terms of better planning and dealing with water management problems more effectively drought is uncontrollable yet its damages can be diminished by running correct programs and logical management accordingly the objectives of this study are to 1 develop stand alone fuzzy knn svm w fuzzy w svm and w knn models to enhance forecasting accuracy and improve palmer drought severity index pdsi forecasting lead time 2 investigate the performance of stand alone fuzzy knn and svm and hybrid w fuzzy w knn w svm models and compare these models considering mean square error mse coefficient of efficiency ce and coefficient of determination r2 as performance evaluation criteria 2 material and methods 2 1 data collection and analysis in the 1st geography congress held in ankara city between 6 and 21 june 1941 it was decided to partition turkey in seven geographical regions with respect to their location vegetation transportation climate agricultural diversities etc the marmara region is a significant one located in the northwest of turkey between longitudes 38 e and 42 e and latitudes 29 n and 32 n with an area of 67 000 km 2 it generally has a warm and moderate climate winter 5 c and summer 25 c erinç 1996 yet in winter the temperature may drop below 0 c sertel et al 2011 the average annual temperature and precipitation are respectively 15 16 c 600 700 mm in the region throughout the region although small there is a frequent stream network sakarya ergene susurluk meriç and biga stream are the main rivers of the region because the impact of economic social and environmental dimensions is considered high the marmara region is in a situation that can be more severely affected by climate change and drought coban et al 2021 time series data of the palmer drought severity index pdsi is investigated for the marmara region of turkey due to the complex topography dominated over the study region the high spatio temporally consistent pdsi data are not achievable easily through metrological stations thus global pdsi dataset which is spatially consistent could be a proper approach to monitor drought in these regions furthermore the global pdsi dataset offers high historical data which might be useful for numerous drought related applications so monthly time series pdsi data is obtained from the university of east anglia climatic research unit website https crudata uea ac uk cru data drought and used for 10 point stations on the marmara region as shown in fig 1 the common observation period of the data is from 1960 through 2016 fig 2 2 2 description of the models 2 2 1 stand alone fuzzy model fuzzy logic is a decision system that uses partial truth instead of absolute judgments such as completely true and completely wrong as in classical aristotle logic fuzzy decision systems offer a flexible working area with soft borders that is compatible with the human thinking system without restrictive decisions mamdani fuzzy inference system mamdani fis and sugeno fuzzy inference system sugeno fis are two basic modeling tools to simulate hydrologic hydraulic hydro meteorological phenomena to name a few tütmez et al 2007 compared the spatial interpolation of mechanical properties of rocks by using mamdani and sugeno fuzzy models and concluded that the sugeno fuzzy model was better than mamdani fuzzy model in defining the randomness present in mechanical properties of rocks furthermore sugeno fuzzy approach can be very economical in the number of input fuzzy sets compared to mamdani fuzzy approach when nontrapezoidal and or nontriangular inputs fuzzy sets are used ying 1999 according to bizimana and altunkaynak 2019 mamdani fis has a shortcoming i e a missing systematic training algorithm for the calibration of the model parameters in general mamdani implication optimizes inputs outputs and fuzzy rules via a conventional trial and error process however due to the time consuming nature of manipulation by hand this process is neither practical nor efficient but anfis tool has a capability to train antecedent and consequent parameters fuzzy sets rules and parameters of functions via systematic training procedure in the present study the sugeno fis is used in predicting monthly pdsi data for longer lead times the adaptive network based fuzzy inference system anfis tool which is introduced by jang 1993 is developed by using sugeno fis the anfis optimizes the antecedent parameters of the membership functions and consequent parameters of constant or linear functions altunkaynak 2010 bizimana and altunkaynak 2019 rules in the sugenofis are 1 if inputs 1 is x and 2 isy then output isz ax by c 2 if a b 0 then z c constant each rule weights its output level z i by the firing strength of the rule w i and an and rule with input 1 xand input 2 y where w i is expressed as 3 w i f 1 x f 2 y here f 1 a n d f 2 are the membership functions for inputs the average of all outputs is the final result of the model which is given by the following expression 4 f i n a l r e s u l t i 1 n w i z i i 1 n w i the consequent parts that are used as a hybrid learning algorithm utilizes gradient descent and least squares ls methods however frequently the relatively simple and effective neural network back propagation learning algorithm is utilized to determine the parameters of the fuzzy membership functions altunkaynak 2010 uyumaz et al 2006 2 2 2 stand alone k nearest neighbour model data driven modelling technique can be used to extract useful information from massive amounts of data in searching hidden patterns relationships and trends between them via applying advanced mathematical functions and algorithms the support vector machine svm and k nearest neighbour knn based machine learningtools automatically learn and models are improved based on the experimental data a nonparametric method knn is widely utilized in regression models and especially in pattern classification it classifies an unknown instance according to the known classification of its neighbours and accordingly the model is developed using training data and classification process is implemented fadaei kermani et al 2017 in the present study 480 data points months corresponding to 60 of the data is employed for the training phase and the remaining 271 data points months corresponding to 40 of data is used for validation of the model number of the k in knn which has to be determined in advance has a significant influence on the accuracy of the model the relatively low number of k produce inaccurate predictions while according to kutyłowska 2018 if a relatively large number of knn are provided the model sufferes from overfitting the first step in using this model is finding a method and a relationship to calculate the distance between the training and testing data the euclidean distance norm is widely utilized to calculate the distance for training data and testing data the euclidean distance can be calculated as follows 5 d x p x p 2 where x is the new point and p is the learning example euclidean distance which is calculated using training and testing data and arranged in ascending order from minimum distance highest similarity to the maximum distance lowest similarity is related to sample data length the next step in this method is to identify the optimal neighbours number k usually the best value of k can be calculated by using the cross validation operation 2 2 3 stand alone support vector machine model according to burges 1998 the geometrical interpretation of the support vector machine svm approach is the optimal separation surface which may be considered as a hyperplane in the sense that the surface is equidistant from the two classes the svm method is outlined first for the linearly separable case kernel functions are then introduced in order to deal with non linear decision surfaces in problems where the data is not linearly separable the data is mapped into multidimensional feature space so that they are amenable to linear separation in this new space for the svm method many kernel functions exist to perform the mapping in this study the radial basis function rbf kernel is implemented the kernel function is defined as 6 x i x j exp γ x i x j 2 γ 0 where γ is the kernel parameter 2 2 3 1 support vector regression support vector regression svr which is slightly different from support vector machine svm is a regression procedure enabling to work with continuous values such as prediction of time series data instead of svm classification the relationship between the input variables x x1 x2 x3 xn and the corresponding output set y y1 y2 y3 yn is determined by the svm regression function f x the main difference between svr and classical regression analysis is that the decision function has digression tolerance up to ε insensitive parameters simple regression tries to minimize error rate but in svr the error is adapted within a certain boundary and for the case that the limit exceeds the ε insensitive parameter it contains the lost function in the optimization of the regression function boundaries the terms ξ i and ξ i are added as error penalties in general the aim is to minimize the following equation subject to below constraints min 1 2 w t w c n ξ i ξ i 7 subject to y i w x i b ε ξ i i w x i b y i ε ξ i i ξ i ξ i 0 i the svr model can be written in a dual form as follows 8 m a x w 1 2 i 1 n î i î i î j î j x i x j ε i 1 n α i α i y i i 1 n α i α i wherewis the normal vectorto the hyperplane ξ i a n d ξ i are the slack variables representing upper and lower constraints on the outputs of the system respectively α and α are the lagrange multipliers and ε and b 0 are the insensitive loss function and bias parameter respectively the svr method is a powerful analysis tool for the description of nonlinear problems due to its ability to perform operations in the kernel space in this study the svr method is developed for the prediction of palmer drought severity index data in the marmara region of turkey 2 2 4 discrete wavelet transform wavelets are waveform sets defined via mathematical expressions the wavelet has a limited duration and a finite length as opposed to sinusoids that are defined theoretically from minus to plus infinity fugal 2009 the wavelets are used to decompose a signal data into its frequency components the resolution of each component is equal to its scale the most important property of the wavelet transformation is its ability to extract both the event s frequency and location of that frequency in time in other words it can be matched with a hidden event and then can extract its frequency and location in time torrence and compo 1998 yet it can further help in decision making analysis data transfer etc a discrete wavelet transform dwt may also be utilized to eliminate frequency components from signal data at specific times it has a strong capability to remove undesired part of the data while keeping the desired part of the data for denoising or compression altunkaynak 2019 original data can be divided into a number of frequency components sub series via dwt the simplest shortest and first invented discrete wavelet function is the haar wavelet haar wavelet is appropriate in edge detection and reconstruction pair pulses fugal 2009 in dwt analysis it is common to select multiples of 2 as the scale and position parameters for a fixed scale value a0 b0 is the position of the wave on the time axis when the values are selected 2 and 1 in sequence continuous wavelet expression leads to 9 ψ a b x 1 a 0 m ψ x a 0 b 0 n a 0 m 1 2 m ψ 2 m x n according to the definition of the dwt the time series size n must be equal to two times of m therefore if the current time series does not have the appropriate size for conversion the time series can be expanded into appropriate x t series for m steps of a x t series wavelet transform is 10 d w t x 1 2 m t 0 n 1 x t ψ 2 m x n where t is the time x t is the discrete time series a and b are the fixed scale value and position respectively and ψ n and m are the wavelet function time series size and wavelet transformation step respectively original data signal can be separeted into sub series approximate a and detail d components by dwt tool without losing any signal information while the approximate signal a represents low frequency signal content with a wide range of time information e g the trend cycle named as smoothed signal the detail signal includes the high frequency information of the signal which is named as noise signal see fig 5 the w fuzzy is a hybrid forecasting model that combines the power of dwt with fuzzy for accuracy improvement purposes the schematic of the structure of the proposed w fuzzy model is illustrated in fig 3 2 2 5 performance evaluation criteria nash and sutcliffe 1970 bowden et al 2013 and bizimana and altunkaynak 2019 mentioned that mean squared error mse is an excellent diagnostic metric for the accuracy of a model if the mse is equal to 0 the model is considered as perfect as the mse value increases the performance of the model decreases in general according to moriasi et al 2007 and altunkaynak 2019 coefficient of efficiency ce and coefficient of determination r2 values greater than 0 5 correspond to an acceptable performance level the ce value greater than 0 5 is considered as an acceptable level of performance the ce value is considerred in the range of 0 65 0 75 well in the range of 0 75 0 85 and has a very good performance if the ce value is higher than 0 85 the performances of stand alone fuzzy svm knn hybrid w fuzzy w svm and w knn models are evaluated by means of mse ce and r2 which are defined as 11 mse 1 n i 1 n p d s i pi p d s i mi 2 12 ce 1 i 1 n pds i pi p d s i mi i 1 n pds i mi p d s i am 2 2 13 r 2 i 1 n pds i mi p d s i am pds i pi p d s i ap 2 i 1 n pds i mi p d s i am 2 i 1 n pds i pi p d s i ap 2 where n is the total number of measurements pdsi p i pdsi m i pdsi a p and pdsi a m are the predicted measured mean of predicted and mean of measured pdsi values respectively 3 results and discussion prediction of the drought characteristics is very important for planning and management of water resources in the present study fuzzy the support vector machine svm and k nearest neighbour knn based machine learning tools are developed in predicting monthly palmer drought severity index pdsi accurately for relatively long lead times discrete wavelet transform dwt is widely utilized as a pre processing technique to remove trend and seasonality from the monthly palmer drought severity index pdsi data therefore to improve prediction accuracy and extend prediction lead time hybrid wavelet fuzzy w fuzzy wavelet support vector machine w svm and wavelet k nearest neighbour w knn models are developed with combination of stand alone fuzzy svm knn models with wavelet tool the stand alone fuzzy svm knn w fuzzy w svm and w knn models are implemented to predict monthly pdsi time series data accurately even for long lead times while 480 data points corresponding to 60 of monthly pdsi data are employed for the training phase the remaining 271 data points corresponding to 40 of monthly pdsi data are used to validate the models to predict current monthly pdsi t value from two previous values pdsi t 2 and pdsi t 1 up to five previous values pdsi t 5 pdsi t 4 pdsi t 3 pdsi t 2 and pdsi t 1 are tested to find the best topology of the model the results showed that using two previous values namely pdsi t 2 and pdsi t 1 yields the best model architecture in addition the performances of stand alone fuzzy svm knn hybrid w fuzzy w svm and w knn models are evaluated for lead times of 1 2 3 6 9 and 12 months utilizing mean square error mse and coefficient of efficiency ce as indicator parameters 3 1 stand alone models as can be seen from table 1 for the prediction lead time of 1 month the average mean squared error mse values of 10 point stations for stand alone fuzzy support vector machine svm and k nearest neighbour knn models are found to be 0 77 0 66 and 0 94 respectively the average coefficient of determination r2 values of ten point stations for fuzzy svm and knn models are calculated as 0 83 0 84 and 0 80 respectively the average coefficient of efficiency ce values of ten point stations provided by stand alone fuzzy svm and knn models are 0 83 0 84 and 0 78 respectively the fuzzy model does not suffer from restrictive decisions and is compatible with the flexible human thinking system therefore expert opinion or expert knowledge is foundational for the method svm tool is a machine learning algorithm that can be used for both classification and regression predictive models however it is rather widely usedinclassification prediction problems wang et al 2005 on the other hand the knn method is used extensively for both categorization and regression models in this study the knn method is carried out due to its computational practicality and less computationally intensive nature in comparison svm is more complex and computationally expensive calculated r2 and ce values of svm model are slightly higher than those of fuzzy and knn models for the lead time of 1 month the performance of fuzzy svm and knn models falls in the very good category values shown in table 1 further illustrates that it can safely be stated that stand alone fuzzy svm and knn models performed well and can be used for accurate prediction of pdsi data for until lead time of 3 month in other words the stand alone fuzzy svm and knn models generate poor prediction results for pdsi data over lead time of 3 month see fig 8 3 2 hybrid wavelet transform models the original pdsi data is decomposed into three sub series spectral bands by wavelet transforms in order to separate data into trend seasonal and noise components which are used as inputs into the fuzzy svm and knn models for the development of a novel hybrid model in forecasting palmer drought severity index data for longer lead times from 1 to 12 months these models can safely be used in practical applications fig 4 depicts the sub series bands of pdsi time series data for the kirklareli 2 station for prediction lead time of one month to see the accuracy improvement provided by hybrid w fuzzy w svm and w knn models the performance evulation results of these models for pdsi testing data is presented in table 2 according to table 2 for prediction lead time of one month the average mse and r2 values of ten point stations for the w fuzzy w svm and w knn models are found to be 0 18 0 20 and 0 36 and 0 96 0 95 and 0 92 respectively further average ce values of ten point stations are calculated as 0 96 0 95 and 0 92 respectively according to the results presented in tables 1 and 2 show that the hybrid w fuzzy w svm and w knn models performed much better than the stand alone fuzzy svm and knn models for all ten station points the combined w fuzzy w svm and w knn models enhanced the prediction accuracy of the models considerably according to donigian and love 2003 and altunkaynak 2019 for lead time of 1 month all models performed very well based on ce values at all ten station points finally the station points that have the largest ce r2 and the smallest mse are selected to be shown in the scatter plots to analyse the performance of all models presented in this study in the above sections the prediction results of one month lead time with both stand alone and hybrid models has been showed but for long lead time prediction only hybrid form of models were used and the results are depicted in scatter plots and table 3 accurate prediction of drought with lead times of 3 6 9 and 12 months is crucial so that early and pertinent preventive measurements can be taken into account accordingly for the kirklareli 2 station point the performance evaluation results of hybrid w fuzzy w svm and w knn models at lead time of 3 6 9 and 12 months are presented in table 3 the hybrid w fuzzy w svm and w knn models performed very good in predicting pdsi data for lead time of 1 3 and 6 months while the performance of these models is found to be unacceptable for lead time of 9 and 12 months in other words hybrid w fuzzy w svm and w knn models cannot be used for the prediction of pdsi data for lead time of 9 and 12 months the performance evaluation criteria are used to evaluate the success of developed the stand alone fuzzy svm knn and hybrid w fuzzy w svm and w knn models in addition the scatter plot of the data around the perfect model line 1 1 line is utilized to analyse the performance of these models in predicting monthly pdsi values used in this study for lead time of 1 month fig 6 illustrates the scatter plot of the predicted values by stand alone fuzzy svm knn and hybrid w fuzzy w svm and w knn models and corresponding observed data around the perfect model line 1 1 line for lead time of 1 month fig 6 a and b indicate a good agreement between predicted pdsi values by stand alone fuzzy and svm models and corresponding observed pdsi data as oppose to stand alone fuzzy and svm models the predicted pdsi values by stand alone knn model are sligthly more scattered around 1 1 line as shown in fig 6 c fig 7 illustrates the scatter plots of the predicted values by hybrid w fuzzy w svm and w knn models and correponding observed pdsi data respectively a visual inspection of the results for the lead time of 3 and 6 months reveal that for the lead time of 3 month fig 7 a with a remarkable fit around 1 1 line an excellent good agreement is observed between pdsi data and w fuzzy model prediction values which are slightly better than w svm and w knn model results as shown in fig 7 b and c nevertheless the w svm and w knn models yielded a good agreement with corresponding observed pdsi data as illustrated in fig 7 b and c the performances of the w svm and w knn models are close to each other fig 7 d e and f are the scatter plots of w fuzzy w svm and w knn model values versus corresponding observed pdsi data for lead time of 6 month respectively it is clearly observed that the performance of the w fuzzy w svm and w knn models are found to be fair in predicting pdsi data for lead time of 6 month respectively for lead time of 6 month the prediction values of the w fuzzy model are found to be similar to those of w svm and w knn model values as fig 7 d e and f illustrates it is noted that combined hybrid w fuzzy w svm and w knn model results tend to follow the observed psdi data very closely for lead time of 1 and 3 months according to donigian and love 2003 the w fuzzy w svm and w knn models generated perfect prediction results for lead times of 1 and 3 months predictions for longer lead time of 6 month ce values of w fuzzy w svm and w knn models are found to be 0 63 0 62 and 0 60 respectively this means that according to the donigian and love 2003 and moriasi et al 2007 the prediction performance of w fuzzy w svm and w knn models falls in the acceptable range for lead time of 6 month the ce values of the stand alone fuzzy svm and knn models and also combined w fuzzy w svm and w knn models for prediction lead time of 9 and 12 months are found to be less than 0 5 this implies that stand alone fuzzy svm and knn models and also combined the w fuzzy w svm w knn models cannot be used in predicting pdsi data for a lead time of 9 and 12 months for the lead times of 1 3 6 9 and 12 month the ce values of all the devolped models in this study are depicted in fig 8 the results show that the hybrid w fuzzy w svm and w knn models performed very well up to lead time of 3 months while their performances fall in acceptable level for the lead time of 6 month as evident from fig 8 the prediction results of stand alone knn model are worse than those of stand alone fuzzy and svm models at all lead times however the results illustrate that the w fuzzy model performed better than the stand alone fuzzy svm and knn models and slightly better than combined w svm and w knn models in the k nearest neighbours knn model the nearest neighbours values are functions of a euclidean distance which is a metric that measures the similarity of feature vectors this implies that the results of models are calculated based on the closest euclidean distance to the corresponding data accordingly the major limitation is the pre assumed linear structure of the model this means that a linear correlation is assumed among pdsi time series values and thereby nonlinear patterns cannot be identified accurately by the knn model in addition there is no matching function that relates input to output in the svm approach nonlinear model may be established based on a kind of kernel function therefore svm model has capability to predict nonlinear data with high accuracy in comparison to knn model the fuzzy modelling tool depends on the concept of membership function which consists of fuzzy subsets membership degrees and expert knowledge that is to say that the nonlinear data patterns can easily and accurately be captured by the fuzzy and svm models therefore taking non linear pdsi data into consideration in this study fuzzy and svm models provided slightly better pdsi prediction values over the knn method in summary the results indicated that the hybrid w fuzzy w svm and w knn models can be used to predict monthly pdsi data accurately with up to a 6 month lead time the combined w fuzzy w svm and w knn models respectively can be used to predict monthly pdsi data up to 6 months in advance with good agreement whereas the stand alone fuzzy svm and knn models can be used to predict the pdsi data up to 2 months in advance the combined w fuzzy w svm and w knn models outperformed the stand alone fuzzy svm and knn models based on the mean squared error mse and the coefficient of efficiency ce as performance evaluation criteria this implies that the wavelet transform can effectively eliminate periodicity and trend from original data and therefore converts a non stationary time series into stationary time series in general as the prediction lead time increases the prediction performance of models decreases looking at the values of the rmse and the ce values presented in table 3 there is an increase in the rmse values and a decrease in the ce values these show that similar to the performance of the stand alone fuzzy svm knn and hybrid w fuzzy w svm w knn models the results depict nothing but the superiority of wavelet tool in changing non stationary data into stationary data over stand alone models consequently the fuzzy svm and knn models should be combined with a pre processing technique for more accurate and longer lead time predictions 4 conclusions in the pesented study stand alone fuzzy svm knn w fuzzy w svm and w knn predictive models are developed to improve prediction accuracy and extend lead time prediction of montly pdsi data for the period from 1960 through 2016 the developted models are trained with 480 data points months corresponding to 60 of data and validated with 271 data points months corresponding to 40 of data the performances of stand alone fuzzy svm knn w fuzzy w svm and w knn models are evaluated by means of mean square error mse coefficient of efficiency ce and coefficient of determination r2 as indicator parameters stand alone fuzzy svm and knn models generated good results for lead time of 1 month while these models are found to be in the acceptable level category in predicting pdsi values for lead time of 3 month however stand alone fuzzy svm and knn models have poor performances in predicting pdsi data more than lead time of 3 month on the other hand the combined w fuzzy w svm and w knn models have poor performance in predicting pdsi data beyond lead times of 6 month among those models the w fuzzy model is found to be slightly better than w svm and w knn models the wavelet transform helps to easily remove seasonal and trend cycle components from original pdsi data therefore the fuzzy svm and knn models with the combination of preprocessing via wavelet transform generated accurate prediction results for relatively long lead times the results of this study highlight that the stand alone fuzzy svm and knn models may be successfully combined with wavelet transform method not only for improving overall prediction accuracy and but also for obtaining more accurate result for extended lead times hence it is benefical to divide the original data into sub spectral bands sub series before development of model in order to improve the overall model performance with extended lead times credit authorship contribution statement abdüsselam altunkaynak writing review editing methodology validation supervision akbar jalilzadnezamabad conceptualization methodology software data curation writing original draft visualization investigation validation writing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
4289,drought is a slowly developing phenomenon and possibly influences a wide domain drought index is one of the ways in monitoring and surveying drought hence palmer drought severity index pdsi has been used as a valid and operational model in this study the discrete wavelet transform dwt tool is incorporated with fuzzy k nearest neighbour knn and support vector machine svm modelling tools to improve forecasting accuracy and extend lead time dwt is further used to decompose original pdsi data into wavelets sub series which in turn are used as inputs into the fuzzy knn and svm models for the development of a new model in forecasting pdsi for longer lead times from 1 to 12 months dwt combined with fuzzy knn and svm models are termed as w fuzzy w knn and w svm models the predictive models are implemented in the marmara region of turkey the accuracy of combined hybrid w fuzzy w knn and w svm models are compared with stand alone fuzzy knn and svm models by using mean square error mse coefficient of efficiency ce and coefficient of determination r2 as performance indicators the results of this study reveal that developed hybrid w fuzzy w knn and w svm models performed very well up to lead time of 6 months furthermore combined w fuzzy w knn and w svm models are performed better than stand alone fuzzy knn and svm models however the prediction performance of w fuzzy model is slightly better than those of w knn and w svm models for all lead time predictions in terms of performance indicator criteria mse ce and r2 keywords drought palmer drought severity index hybrid models stand alone models 1 introduction drought is defined as a shortage of precipitation and named as agricultural drought or hydrological drought if occurs during thegrowing seasonresulting in crop damage or the winterrun offandpercolationseason affecting water supplies respectively american meteorological society 2000 drought differs from most other natural hazards in many ways particularly in prediction difficulty of the beginning date ending date and the current intensity mckee et al 1993 long lasting drought has a great impact on the nation s economy and society accurate drought prediction helps to mitigate devastating economic effects on people and ecosystems mo et al 2009 in monitoring droughts the meteorological drought indicators the palmer drought severity index pdsi standardized precipitation index spi reconnaissance drought index rdi and standardized precipitation evapotranspiration index spei widely utilized palmer 1965 mckee et al 1993 tsakiris et al 2007 vicente serrano et al 2010 mehdizadeh et al 2020 researchers have suggested several methods to predict drought index among different indices the palmer drought severity index pdsi is the most popular one for agro climatological analysis palmer 1965 in the last few decades drought has become a repetitive phenomenon for many countries european environment agency 2001 lloyd hughes and saunders 2002 in turkey crucial drought conditions occurred in late 1980s and following effects lasted until the late 1990s repeated droughts affect the countries in terms of water resources agricultural sectors and ecosystems sönmez et al 2005 improved version of the the palmer drought severity index pdsi palmer 1965 is currently used with precipitation and temperature data to evaluate relative drought the palmer drought index is based on a supply and demand model of soil moisture developed for the united states and tested using the regional climates of the u s sönmez et al 2005 mehdizadeh et al 2020 standardized precipitation index spi and a modified spi were used in previous researches in analyzing the probability of drought over turkey however there is a lack of study about drought index especially pdsi in marmara region and pdsi data in turkey is significantly scarce the studies of drought forecasting studies have been increased in recent years mishra and singh 2009 and ozger et al 2011 developed a predictive model to estimate pdsi data using a wavelet fuzzy logic model based on meteorological variables the model is satisfactorily carried out to predict pdsi data for 10 climate divisions in texas mokhtarzad et al 2017 studied drought forecasting by using artificial neural network ann adaptive neuro fuzzy interface system anfis and support vector machine svm and compared the results of these models in their study standardized precipitation index spi is used for 3 month time scales in the bojnourd province iran and the results showed that the svm model provides more accurate values for forecasting murugesakumar et al 2016 applied various data mining techniques and applications to classify soil fertility including ann k nearest neighbour knn decision tree dt bayesian network bn fuzzy svm and k means km and addressed the importance of the use of information technology in agriculture can change the way decisions are made and farmers can perform better mehdizadeh et al 2020 used classic time series and hybrid wavelet gene expression programming w gep approach to simulate drought phenomenon the standardized precipitation evapotranspiration index spei obtained from six meteorology stations located in turkey is used in their study they found that the hybrid w gep model generated accurate prediction results arıkan and kahya 2016 performed the linear genetic programming lgp model to forecast drought conditions with 3 6 and 12 months lead times in konya province turkey using the observed north atlantic oscillation index naoi and palmer s drought severity index pdsi as predictors kisi and cimen 2012 used the svm conjunction model in forecasting the precipitation of the stations located in izmir and afyon provinces of turkey they reported that the conjunction method performs better than the single svm and could increase the forecast accuracy advantages of fuzzy approach according to altunkaynak 2010 and altunkaynak and wang 2011 have the capability of improving the accuracy of traditional models and does not require solving complicated mathematical equations such as partial differential equations fuzzy method relates any linguistic input to output via using verbal statements if then fuzzy rules based on expert knowledge or historical observed data in addition fuzzy tool has a simple procedure for model development and ability to utilize expert view for model simulation that is to say that an appropriate model can be developed via using expert knowledge even without having available data opposite to classical regression fuzzy method has no restrictive assumption such as normality homoscedasticity linearity etc disadvantages of fuzzy approach according to bizimana and altunkaynak 2020 are that fuzzy model becomes complicated when many variables and subsets are required as inputs into the model accordingly high dimensional feature vectors lead to exponential increase in the number of fuzzy rules which induces complexity and computational time advantages of support vector machine svm according to altunkaynak and kartal 2021 have the ability to handle high dimensional feature vectors although the dimensions of the feature vectors are greater than that of sample data svm can be utilized to solve nonlinear regression and pattern classification problems via using ε insensitive loss function it provides a general solution by expressing complex processes with a decision hyperplane with the use of high dimensional feature vectors svm method is utilized to overcome the challenging nature of usability of only linear functions it is well suited to analyze the high dimensional feature vectors with small sample data disadvantage of svm according to awad and khanna 2015 is that it cannot generate probability predictions which are computed utilizing so unfeasible expensive and fivefold cross validation advantage of k nearest neighbour knn according to yamaç et al 2020 is that the knn tool has a simple and robustness learning procedure and a good agreement with the concept of statistical probabilistic therefore it can generate very good model results with using a simple algorithm disadvantages of knn according to altunkaynak and kartal 2021 the selection of suitable parameters for the development of the knn model is pretty challenging and may have negative effects on the processing performance the knn tool has no mapping function that relates input to output and also makes extrapolation this implies that it cannot predict relatively high values without historical observed data independent data this means that its accuracy is highly limited when used for real time predictions wavelet tool is a procedure that is widely utilized to decompose the original time series data into sub series spectral bands and eliminate the trend and periodicity in other words wavelet technique removes the trend component convers a non stationary time series data into stationary time series fernandes 2001 adamowski and sun 2010 altunkaynak 2014 mehr et al 2014 djerbouai and souag gamane 2016 in this study wavelet is basically used as a pre processing tool to eliminate the seasonal patterns of monthly pdsi data so that tangible analysis can be undertaken and accurate prediction results can be obtained with longer lead times for this reason wavelet as a successful preprocessing technique is central in developing a predictive model for prediction of monthly pdsi time series data accurately even for longer lead times the objective of using the combined w fuzzy w svm and w knn models was to predict monthly pdsi time series data accurately for lead times of 1 up to 12 months to the best of our knowledge this procedure has not been used with combination of fuzzy svm and knn for pdsi time series data for improving prediction accuracy and extension of lead time predictions of pdsi data even though there have been some attempts to develop techniques for predicting pdsi data at a monthly scale most of them were recommended for very short lead time liu and hwang 2015 beyaztas et al 2018 therefore further studies should be undertaken to develop models for accurate prediction of monthly pdsi time series data for long lead times the objective of this study was to develop predictive models with combination of wavelet as a pre processing technique with the motivation that wavelet is the most widely and accurately used pre processing technique in recent hydrological studies and compare the stand alone fuzzy svm and knn models performance with combined w fuzzy w svm and w knn models fuzzy svm and knn models were selected and used as modelling tools because they have simple implementation procedures the objective in developing combined models were to obtain more accurate and longer lead time predictions of pdsi data it is obvious that predictions with high accuracy are very important in terms of better planning and dealing with water management problems more effectively drought is uncontrollable yet its damages can be diminished by running correct programs and logical management accordingly the objectives of this study are to 1 develop stand alone fuzzy knn svm w fuzzy w svm and w knn models to enhance forecasting accuracy and improve palmer drought severity index pdsi forecasting lead time 2 investigate the performance of stand alone fuzzy knn and svm and hybrid w fuzzy w knn w svm models and compare these models considering mean square error mse coefficient of efficiency ce and coefficient of determination r2 as performance evaluation criteria 2 material and methods 2 1 data collection and analysis in the 1st geography congress held in ankara city between 6 and 21 june 1941 it was decided to partition turkey in seven geographical regions with respect to their location vegetation transportation climate agricultural diversities etc the marmara region is a significant one located in the northwest of turkey between longitudes 38 e and 42 e and latitudes 29 n and 32 n with an area of 67 000 km 2 it generally has a warm and moderate climate winter 5 c and summer 25 c erinç 1996 yet in winter the temperature may drop below 0 c sertel et al 2011 the average annual temperature and precipitation are respectively 15 16 c 600 700 mm in the region throughout the region although small there is a frequent stream network sakarya ergene susurluk meriç and biga stream are the main rivers of the region because the impact of economic social and environmental dimensions is considered high the marmara region is in a situation that can be more severely affected by climate change and drought coban et al 2021 time series data of the palmer drought severity index pdsi is investigated for the marmara region of turkey due to the complex topography dominated over the study region the high spatio temporally consistent pdsi data are not achievable easily through metrological stations thus global pdsi dataset which is spatially consistent could be a proper approach to monitor drought in these regions furthermore the global pdsi dataset offers high historical data which might be useful for numerous drought related applications so monthly time series pdsi data is obtained from the university of east anglia climatic research unit website https crudata uea ac uk cru data drought and used for 10 point stations on the marmara region as shown in fig 1 the common observation period of the data is from 1960 through 2016 fig 2 2 2 description of the models 2 2 1 stand alone fuzzy model fuzzy logic is a decision system that uses partial truth instead of absolute judgments such as completely true and completely wrong as in classical aristotle logic fuzzy decision systems offer a flexible working area with soft borders that is compatible with the human thinking system without restrictive decisions mamdani fuzzy inference system mamdani fis and sugeno fuzzy inference system sugeno fis are two basic modeling tools to simulate hydrologic hydraulic hydro meteorological phenomena to name a few tütmez et al 2007 compared the spatial interpolation of mechanical properties of rocks by using mamdani and sugeno fuzzy models and concluded that the sugeno fuzzy model was better than mamdani fuzzy model in defining the randomness present in mechanical properties of rocks furthermore sugeno fuzzy approach can be very economical in the number of input fuzzy sets compared to mamdani fuzzy approach when nontrapezoidal and or nontriangular inputs fuzzy sets are used ying 1999 according to bizimana and altunkaynak 2019 mamdani fis has a shortcoming i e a missing systematic training algorithm for the calibration of the model parameters in general mamdani implication optimizes inputs outputs and fuzzy rules via a conventional trial and error process however due to the time consuming nature of manipulation by hand this process is neither practical nor efficient but anfis tool has a capability to train antecedent and consequent parameters fuzzy sets rules and parameters of functions via systematic training procedure in the present study the sugeno fis is used in predicting monthly pdsi data for longer lead times the adaptive network based fuzzy inference system anfis tool which is introduced by jang 1993 is developed by using sugeno fis the anfis optimizes the antecedent parameters of the membership functions and consequent parameters of constant or linear functions altunkaynak 2010 bizimana and altunkaynak 2019 rules in the sugenofis are 1 if inputs 1 is x and 2 isy then output isz ax by c 2 if a b 0 then z c constant each rule weights its output level z i by the firing strength of the rule w i and an and rule with input 1 xand input 2 y where w i is expressed as 3 w i f 1 x f 2 y here f 1 a n d f 2 are the membership functions for inputs the average of all outputs is the final result of the model which is given by the following expression 4 f i n a l r e s u l t i 1 n w i z i i 1 n w i the consequent parts that are used as a hybrid learning algorithm utilizes gradient descent and least squares ls methods however frequently the relatively simple and effective neural network back propagation learning algorithm is utilized to determine the parameters of the fuzzy membership functions altunkaynak 2010 uyumaz et al 2006 2 2 2 stand alone k nearest neighbour model data driven modelling technique can be used to extract useful information from massive amounts of data in searching hidden patterns relationships and trends between them via applying advanced mathematical functions and algorithms the support vector machine svm and k nearest neighbour knn based machine learningtools automatically learn and models are improved based on the experimental data a nonparametric method knn is widely utilized in regression models and especially in pattern classification it classifies an unknown instance according to the known classification of its neighbours and accordingly the model is developed using training data and classification process is implemented fadaei kermani et al 2017 in the present study 480 data points months corresponding to 60 of the data is employed for the training phase and the remaining 271 data points months corresponding to 40 of data is used for validation of the model number of the k in knn which has to be determined in advance has a significant influence on the accuracy of the model the relatively low number of k produce inaccurate predictions while according to kutyłowska 2018 if a relatively large number of knn are provided the model sufferes from overfitting the first step in using this model is finding a method and a relationship to calculate the distance between the training and testing data the euclidean distance norm is widely utilized to calculate the distance for training data and testing data the euclidean distance can be calculated as follows 5 d x p x p 2 where x is the new point and p is the learning example euclidean distance which is calculated using training and testing data and arranged in ascending order from minimum distance highest similarity to the maximum distance lowest similarity is related to sample data length the next step in this method is to identify the optimal neighbours number k usually the best value of k can be calculated by using the cross validation operation 2 2 3 stand alone support vector machine model according to burges 1998 the geometrical interpretation of the support vector machine svm approach is the optimal separation surface which may be considered as a hyperplane in the sense that the surface is equidistant from the two classes the svm method is outlined first for the linearly separable case kernel functions are then introduced in order to deal with non linear decision surfaces in problems where the data is not linearly separable the data is mapped into multidimensional feature space so that they are amenable to linear separation in this new space for the svm method many kernel functions exist to perform the mapping in this study the radial basis function rbf kernel is implemented the kernel function is defined as 6 x i x j exp γ x i x j 2 γ 0 where γ is the kernel parameter 2 2 3 1 support vector regression support vector regression svr which is slightly different from support vector machine svm is a regression procedure enabling to work with continuous values such as prediction of time series data instead of svm classification the relationship between the input variables x x1 x2 x3 xn and the corresponding output set y y1 y2 y3 yn is determined by the svm regression function f x the main difference between svr and classical regression analysis is that the decision function has digression tolerance up to ε insensitive parameters simple regression tries to minimize error rate but in svr the error is adapted within a certain boundary and for the case that the limit exceeds the ε insensitive parameter it contains the lost function in the optimization of the regression function boundaries the terms ξ i and ξ i are added as error penalties in general the aim is to minimize the following equation subject to below constraints min 1 2 w t w c n ξ i ξ i 7 subject to y i w x i b ε ξ i i w x i b y i ε ξ i i ξ i ξ i 0 i the svr model can be written in a dual form as follows 8 m a x w 1 2 i 1 n î i î i î j î j x i x j ε i 1 n α i α i y i i 1 n α i α i wherewis the normal vectorto the hyperplane ξ i a n d ξ i are the slack variables representing upper and lower constraints on the outputs of the system respectively α and α are the lagrange multipliers and ε and b 0 are the insensitive loss function and bias parameter respectively the svr method is a powerful analysis tool for the description of nonlinear problems due to its ability to perform operations in the kernel space in this study the svr method is developed for the prediction of palmer drought severity index data in the marmara region of turkey 2 2 4 discrete wavelet transform wavelets are waveform sets defined via mathematical expressions the wavelet has a limited duration and a finite length as opposed to sinusoids that are defined theoretically from minus to plus infinity fugal 2009 the wavelets are used to decompose a signal data into its frequency components the resolution of each component is equal to its scale the most important property of the wavelet transformation is its ability to extract both the event s frequency and location of that frequency in time in other words it can be matched with a hidden event and then can extract its frequency and location in time torrence and compo 1998 yet it can further help in decision making analysis data transfer etc a discrete wavelet transform dwt may also be utilized to eliminate frequency components from signal data at specific times it has a strong capability to remove undesired part of the data while keeping the desired part of the data for denoising or compression altunkaynak 2019 original data can be divided into a number of frequency components sub series via dwt the simplest shortest and first invented discrete wavelet function is the haar wavelet haar wavelet is appropriate in edge detection and reconstruction pair pulses fugal 2009 in dwt analysis it is common to select multiples of 2 as the scale and position parameters for a fixed scale value a0 b0 is the position of the wave on the time axis when the values are selected 2 and 1 in sequence continuous wavelet expression leads to 9 ψ a b x 1 a 0 m ψ x a 0 b 0 n a 0 m 1 2 m ψ 2 m x n according to the definition of the dwt the time series size n must be equal to two times of m therefore if the current time series does not have the appropriate size for conversion the time series can be expanded into appropriate x t series for m steps of a x t series wavelet transform is 10 d w t x 1 2 m t 0 n 1 x t ψ 2 m x n where t is the time x t is the discrete time series a and b are the fixed scale value and position respectively and ψ n and m are the wavelet function time series size and wavelet transformation step respectively original data signal can be separeted into sub series approximate a and detail d components by dwt tool without losing any signal information while the approximate signal a represents low frequency signal content with a wide range of time information e g the trend cycle named as smoothed signal the detail signal includes the high frequency information of the signal which is named as noise signal see fig 5 the w fuzzy is a hybrid forecasting model that combines the power of dwt with fuzzy for accuracy improvement purposes the schematic of the structure of the proposed w fuzzy model is illustrated in fig 3 2 2 5 performance evaluation criteria nash and sutcliffe 1970 bowden et al 2013 and bizimana and altunkaynak 2019 mentioned that mean squared error mse is an excellent diagnostic metric for the accuracy of a model if the mse is equal to 0 the model is considered as perfect as the mse value increases the performance of the model decreases in general according to moriasi et al 2007 and altunkaynak 2019 coefficient of efficiency ce and coefficient of determination r2 values greater than 0 5 correspond to an acceptable performance level the ce value greater than 0 5 is considered as an acceptable level of performance the ce value is considerred in the range of 0 65 0 75 well in the range of 0 75 0 85 and has a very good performance if the ce value is higher than 0 85 the performances of stand alone fuzzy svm knn hybrid w fuzzy w svm and w knn models are evaluated by means of mse ce and r2 which are defined as 11 mse 1 n i 1 n p d s i pi p d s i mi 2 12 ce 1 i 1 n pds i pi p d s i mi i 1 n pds i mi p d s i am 2 2 13 r 2 i 1 n pds i mi p d s i am pds i pi p d s i ap 2 i 1 n pds i mi p d s i am 2 i 1 n pds i pi p d s i ap 2 where n is the total number of measurements pdsi p i pdsi m i pdsi a p and pdsi a m are the predicted measured mean of predicted and mean of measured pdsi values respectively 3 results and discussion prediction of the drought characteristics is very important for planning and management of water resources in the present study fuzzy the support vector machine svm and k nearest neighbour knn based machine learning tools are developed in predicting monthly palmer drought severity index pdsi accurately for relatively long lead times discrete wavelet transform dwt is widely utilized as a pre processing technique to remove trend and seasonality from the monthly palmer drought severity index pdsi data therefore to improve prediction accuracy and extend prediction lead time hybrid wavelet fuzzy w fuzzy wavelet support vector machine w svm and wavelet k nearest neighbour w knn models are developed with combination of stand alone fuzzy svm knn models with wavelet tool the stand alone fuzzy svm knn w fuzzy w svm and w knn models are implemented to predict monthly pdsi time series data accurately even for long lead times while 480 data points corresponding to 60 of monthly pdsi data are employed for the training phase the remaining 271 data points corresponding to 40 of monthly pdsi data are used to validate the models to predict current monthly pdsi t value from two previous values pdsi t 2 and pdsi t 1 up to five previous values pdsi t 5 pdsi t 4 pdsi t 3 pdsi t 2 and pdsi t 1 are tested to find the best topology of the model the results showed that using two previous values namely pdsi t 2 and pdsi t 1 yields the best model architecture in addition the performances of stand alone fuzzy svm knn hybrid w fuzzy w svm and w knn models are evaluated for lead times of 1 2 3 6 9 and 12 months utilizing mean square error mse and coefficient of efficiency ce as indicator parameters 3 1 stand alone models as can be seen from table 1 for the prediction lead time of 1 month the average mean squared error mse values of 10 point stations for stand alone fuzzy support vector machine svm and k nearest neighbour knn models are found to be 0 77 0 66 and 0 94 respectively the average coefficient of determination r2 values of ten point stations for fuzzy svm and knn models are calculated as 0 83 0 84 and 0 80 respectively the average coefficient of efficiency ce values of ten point stations provided by stand alone fuzzy svm and knn models are 0 83 0 84 and 0 78 respectively the fuzzy model does not suffer from restrictive decisions and is compatible with the flexible human thinking system therefore expert opinion or expert knowledge is foundational for the method svm tool is a machine learning algorithm that can be used for both classification and regression predictive models however it is rather widely usedinclassification prediction problems wang et al 2005 on the other hand the knn method is used extensively for both categorization and regression models in this study the knn method is carried out due to its computational practicality and less computationally intensive nature in comparison svm is more complex and computationally expensive calculated r2 and ce values of svm model are slightly higher than those of fuzzy and knn models for the lead time of 1 month the performance of fuzzy svm and knn models falls in the very good category values shown in table 1 further illustrates that it can safely be stated that stand alone fuzzy svm and knn models performed well and can be used for accurate prediction of pdsi data for until lead time of 3 month in other words the stand alone fuzzy svm and knn models generate poor prediction results for pdsi data over lead time of 3 month see fig 8 3 2 hybrid wavelet transform models the original pdsi data is decomposed into three sub series spectral bands by wavelet transforms in order to separate data into trend seasonal and noise components which are used as inputs into the fuzzy svm and knn models for the development of a novel hybrid model in forecasting palmer drought severity index data for longer lead times from 1 to 12 months these models can safely be used in practical applications fig 4 depicts the sub series bands of pdsi time series data for the kirklareli 2 station for prediction lead time of one month to see the accuracy improvement provided by hybrid w fuzzy w svm and w knn models the performance evulation results of these models for pdsi testing data is presented in table 2 according to table 2 for prediction lead time of one month the average mse and r2 values of ten point stations for the w fuzzy w svm and w knn models are found to be 0 18 0 20 and 0 36 and 0 96 0 95 and 0 92 respectively further average ce values of ten point stations are calculated as 0 96 0 95 and 0 92 respectively according to the results presented in tables 1 and 2 show that the hybrid w fuzzy w svm and w knn models performed much better than the stand alone fuzzy svm and knn models for all ten station points the combined w fuzzy w svm and w knn models enhanced the prediction accuracy of the models considerably according to donigian and love 2003 and altunkaynak 2019 for lead time of 1 month all models performed very well based on ce values at all ten station points finally the station points that have the largest ce r2 and the smallest mse are selected to be shown in the scatter plots to analyse the performance of all models presented in this study in the above sections the prediction results of one month lead time with both stand alone and hybrid models has been showed but for long lead time prediction only hybrid form of models were used and the results are depicted in scatter plots and table 3 accurate prediction of drought with lead times of 3 6 9 and 12 months is crucial so that early and pertinent preventive measurements can be taken into account accordingly for the kirklareli 2 station point the performance evaluation results of hybrid w fuzzy w svm and w knn models at lead time of 3 6 9 and 12 months are presented in table 3 the hybrid w fuzzy w svm and w knn models performed very good in predicting pdsi data for lead time of 1 3 and 6 months while the performance of these models is found to be unacceptable for lead time of 9 and 12 months in other words hybrid w fuzzy w svm and w knn models cannot be used for the prediction of pdsi data for lead time of 9 and 12 months the performance evaluation criteria are used to evaluate the success of developed the stand alone fuzzy svm knn and hybrid w fuzzy w svm and w knn models in addition the scatter plot of the data around the perfect model line 1 1 line is utilized to analyse the performance of these models in predicting monthly pdsi values used in this study for lead time of 1 month fig 6 illustrates the scatter plot of the predicted values by stand alone fuzzy svm knn and hybrid w fuzzy w svm and w knn models and corresponding observed data around the perfect model line 1 1 line for lead time of 1 month fig 6 a and b indicate a good agreement between predicted pdsi values by stand alone fuzzy and svm models and corresponding observed pdsi data as oppose to stand alone fuzzy and svm models the predicted pdsi values by stand alone knn model are sligthly more scattered around 1 1 line as shown in fig 6 c fig 7 illustrates the scatter plots of the predicted values by hybrid w fuzzy w svm and w knn models and correponding observed pdsi data respectively a visual inspection of the results for the lead time of 3 and 6 months reveal that for the lead time of 3 month fig 7 a with a remarkable fit around 1 1 line an excellent good agreement is observed between pdsi data and w fuzzy model prediction values which are slightly better than w svm and w knn model results as shown in fig 7 b and c nevertheless the w svm and w knn models yielded a good agreement with corresponding observed pdsi data as illustrated in fig 7 b and c the performances of the w svm and w knn models are close to each other fig 7 d e and f are the scatter plots of w fuzzy w svm and w knn model values versus corresponding observed pdsi data for lead time of 6 month respectively it is clearly observed that the performance of the w fuzzy w svm and w knn models are found to be fair in predicting pdsi data for lead time of 6 month respectively for lead time of 6 month the prediction values of the w fuzzy model are found to be similar to those of w svm and w knn model values as fig 7 d e and f illustrates it is noted that combined hybrid w fuzzy w svm and w knn model results tend to follow the observed psdi data very closely for lead time of 1 and 3 months according to donigian and love 2003 the w fuzzy w svm and w knn models generated perfect prediction results for lead times of 1 and 3 months predictions for longer lead time of 6 month ce values of w fuzzy w svm and w knn models are found to be 0 63 0 62 and 0 60 respectively this means that according to the donigian and love 2003 and moriasi et al 2007 the prediction performance of w fuzzy w svm and w knn models falls in the acceptable range for lead time of 6 month the ce values of the stand alone fuzzy svm and knn models and also combined w fuzzy w svm and w knn models for prediction lead time of 9 and 12 months are found to be less than 0 5 this implies that stand alone fuzzy svm and knn models and also combined the w fuzzy w svm w knn models cannot be used in predicting pdsi data for a lead time of 9 and 12 months for the lead times of 1 3 6 9 and 12 month the ce values of all the devolped models in this study are depicted in fig 8 the results show that the hybrid w fuzzy w svm and w knn models performed very well up to lead time of 3 months while their performances fall in acceptable level for the lead time of 6 month as evident from fig 8 the prediction results of stand alone knn model are worse than those of stand alone fuzzy and svm models at all lead times however the results illustrate that the w fuzzy model performed better than the stand alone fuzzy svm and knn models and slightly better than combined w svm and w knn models in the k nearest neighbours knn model the nearest neighbours values are functions of a euclidean distance which is a metric that measures the similarity of feature vectors this implies that the results of models are calculated based on the closest euclidean distance to the corresponding data accordingly the major limitation is the pre assumed linear structure of the model this means that a linear correlation is assumed among pdsi time series values and thereby nonlinear patterns cannot be identified accurately by the knn model in addition there is no matching function that relates input to output in the svm approach nonlinear model may be established based on a kind of kernel function therefore svm model has capability to predict nonlinear data with high accuracy in comparison to knn model the fuzzy modelling tool depends on the concept of membership function which consists of fuzzy subsets membership degrees and expert knowledge that is to say that the nonlinear data patterns can easily and accurately be captured by the fuzzy and svm models therefore taking non linear pdsi data into consideration in this study fuzzy and svm models provided slightly better pdsi prediction values over the knn method in summary the results indicated that the hybrid w fuzzy w svm and w knn models can be used to predict monthly pdsi data accurately with up to a 6 month lead time the combined w fuzzy w svm and w knn models respectively can be used to predict monthly pdsi data up to 6 months in advance with good agreement whereas the stand alone fuzzy svm and knn models can be used to predict the pdsi data up to 2 months in advance the combined w fuzzy w svm and w knn models outperformed the stand alone fuzzy svm and knn models based on the mean squared error mse and the coefficient of efficiency ce as performance evaluation criteria this implies that the wavelet transform can effectively eliminate periodicity and trend from original data and therefore converts a non stationary time series into stationary time series in general as the prediction lead time increases the prediction performance of models decreases looking at the values of the rmse and the ce values presented in table 3 there is an increase in the rmse values and a decrease in the ce values these show that similar to the performance of the stand alone fuzzy svm knn and hybrid w fuzzy w svm w knn models the results depict nothing but the superiority of wavelet tool in changing non stationary data into stationary data over stand alone models consequently the fuzzy svm and knn models should be combined with a pre processing technique for more accurate and longer lead time predictions 4 conclusions in the pesented study stand alone fuzzy svm knn w fuzzy w svm and w knn predictive models are developed to improve prediction accuracy and extend lead time prediction of montly pdsi data for the period from 1960 through 2016 the developted models are trained with 480 data points months corresponding to 60 of data and validated with 271 data points months corresponding to 40 of data the performances of stand alone fuzzy svm knn w fuzzy w svm and w knn models are evaluated by means of mean square error mse coefficient of efficiency ce and coefficient of determination r2 as indicator parameters stand alone fuzzy svm and knn models generated good results for lead time of 1 month while these models are found to be in the acceptable level category in predicting pdsi values for lead time of 3 month however stand alone fuzzy svm and knn models have poor performances in predicting pdsi data more than lead time of 3 month on the other hand the combined w fuzzy w svm and w knn models have poor performance in predicting pdsi data beyond lead times of 6 month among those models the w fuzzy model is found to be slightly better than w svm and w knn models the wavelet transform helps to easily remove seasonal and trend cycle components from original pdsi data therefore the fuzzy svm and knn models with the combination of preprocessing via wavelet transform generated accurate prediction results for relatively long lead times the results of this study highlight that the stand alone fuzzy svm and knn models may be successfully combined with wavelet transform method not only for improving overall prediction accuracy and but also for obtaining more accurate result for extended lead times hence it is benefical to divide the original data into sub spectral bands sub series before development of model in order to improve the overall model performance with extended lead times credit authorship contribution statement abdüsselam altunkaynak writing review editing methodology validation supervision akbar jalilzadnezamabad conceptualization methodology software data curation writing original draft visualization investigation validation writing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
