index,text
24515,compartmental sir and seir models have become the state of the art tools to study infection cycles of arthropod borne viruses such as west nile virus in specific areas in 2018 the virus was detected for the first time in germany and incidents have been reported in humans birds and horses the aim of the work presented here was to provide a tool for estimating west nile virus infection scenarios local hotspots and dispersal routes following its introduction into new locations through the movements of mosquitoes for this purpose we adapted a seir model for west nile virus to the conditions in germany temperatures geographical latitude bird and mosquito species densities and the characteristic transmission and life trait parameter of a possible host bird and vector mosquito species we further extended it by a spatial component an agent based flight simulator for vector mosquitoes it demonstrates how the female mosquitoes move within the landscape due to habitat structures and wind conditions and about how many of them leave the region in the different cardinal directions we applied the space time coupled model with a daily temporal and spatial resolution of 100m 100m to the eurasian magpie pica pica and the asian bush mosquito aedes japonicus japonicus both species are widely distributed in germany and discussed as important hosts and vectors respectively we also applied the model to three study regions in germany each representing slightly different climatic conditions and containing significantly different pattern of suitable habitats for the mosquito species graphical abstract keywords agent based models aedes japonicus japonicus germany pica pica seir sir models spatial component 1 introduction 1 1 background west nile virus wnv is an arthropod borne pathogen maintained in enzootic transmission cycles between birds amplifying hosts and ornithophilic mosquitoes vectors chancey et al 2015 marini et al 2018 humans horses and other mammals may be dead end hosts in 2018 europe experienced an intense and long heat wave bringing the continent its worst wnv epizootics and epidemics to date germany was affected for the first time with 12 confirmed infections in birds and 2 in horses ziegler et al 2019 kampen et al 2020 ziegler et al 2020 in the following years repeated cases occurred in the affected regions in germany and beyond indicating that the virus hibernates in local mosquito populations kampen et al 2020 ziegler et al 2020 neupert 2020 pietsch et al 2020 many bird species seem susceptible to the virus linke et al 2007 but only some develop high viraemiae and death rates jourdain et al 2007 pérez ramírez et al 2014 especially birds of prey and corvids were observed to have high mortality from wnv 2 in europe severely affected species include northern goshawk accipiter gentilis house sparrow passer domesticus eurasian magpie pica pica and hooded crow corvus cornix calistri et al 2010 zehender et al 2017 bażanów et al 2018 la puente et al 2018 hubálek et al 2018 2019 napp et al 2019 based on field studies in spain napp et al 2019 propose the eurasian magpie as a sentinel species it is one of the most common corvid species in europe sedentary and showed high virus susceptibility virus titres and mortality in experimental studies de oya et al 2018 the main vectors of wnv in europe are supposed to be mosquitoes of the widespread cx pipiens complex including the two biotypes cx p pipiens and cx p molestus as well as cx torrentium and cx modestus leggewie et al 2016 tran et al 2017 bhowmick et al 2020 holicki et al 2020 besides those ae vexans and ae japonicus japonicus are also considered species kampen et al 2020 especially the potential future role of the invasive asian bush mosquito ae j japonicus is currently hotly debated schaffner et al 2009 kampen et al 2020 laboratory experiments with specimens collected in switzerland and the us revealed a significantly shorter virus incubation period turell et al 2001 and significantly higher dissemination and transmission rates than cx pipiens sl veronesi et al 2018 wagner et al 2018 turell et al 2001 sardelis and turell 2001 but another laboratory study with individuals caught in germany showed a resistance to infections with west nile virus huber et al 2014 aedes j japonicus was detected in germany in 2008 koban et al 2019 and is mainly established in the western and southern part of the country kampen et al 2020 because of the medical relevance of the virus it is highly important to take precautionary measures in the potential risk areas models shall help to understand the complex interrelationships that contribute to the establishment of an epizootic identify high risk areas and assess the effect of precautionary measures so far wnv models focused either on the spatial or the systemic component the spatial models identify potential risk areas by modelling the habitats of vector mosquitoes cooke et al 2006 diuk wasser et al 2006 pape et al 2008 host birds durand et al 2017 or an overlap of both tran et al 2017 other spatial approaches aim to identify wnv risk areas by analysing the climate and other spatial features of areas where epizootics have occurred brownstein et al 2002 harrigan et al 2014 tran et al 2014 compartment models based on differential equations are much more complex and focus on the systemic component they consider both seasonal and temperature dependent population densities of host birds and vector mosquitoes and simulate the development of the infection processes after virus introduction in a given region since about 20 years these models have been successfully used to study arbovirus infection cycles like that of wnv thomas and urena 2001 wonham et al 2004 laperriere et al 2011 simpson et al 2012 the models are called sir or seir models which refers to the infection stages in which the model organisms can be found susceptible exposed infected infectious and only valid for the vertebrate hosts recovered and immune they assume a homogeneous distribution of host birds and vector mosquitoes in a given outbreak region and are usually calibrated by means of the number of encountered dead birds rubel et al 2008 laperriere et al 2011 due to the assumption of homogeneity in previous compartmental wnv models it was not possible to locate the risk areas more precisely to investigate influences of regionally different contact rates between hosts and vectors and to estimate simultaneously the spread of the virus within the region and beyond to achieve this one needs a spatial component that considers the locations and movements of the animals in the work presented here we will extend a compartment model for wnv by a spatial component a flight simulator and localiser for vector mosquitoes we focus on the local occurrence and movements of vector mosquitoes to estimate the virus spread because it can be effectively controlled by decimating mosquito populations on the wild bird side no vaccination exists so far and population control would be difficult to establish and not be a socially accepted measure furthermore the active autonomous movements of mosquitoes are usually of smaller distance and more predictable than those of the vector birds we further discovered that in existing compartmental wnv models wonham et al 2004 laperriere et al 2011 the calculation of an unknown parameter in the infection equations the vector population size in the epidemic area is problematic this is because the contact rate of vector mosquitoes with host birds has a huge impact on the equations in these models but is solely derived from observations of temperature dependent blood digestion the linkage between the duration of blood digestion and frequency of host contacts is plausible however it was numerically not considered that the vector mosquitoes integrated in the model an aggregation of culex pipiens sl and other culex species especially cx tarsalis do not feed exclusively on the host birds with every required blood meal other birds as well as mammals amphibians and reptilians are for example also used by both biotypes of cx pipiens apperson et al 2004 as a result of this set up the population density of the vector mosquitoes was calculated to be significantly too low in our opinion conversely if the model is applied to new epidemic areas with only a few case numbers and if mosquito densities confirmed by monitoring campaigns are integrated the model will considerably overestimate the course of infection due to the high contact numbers the problem becomes even more apparent when the model is applied to the mosquito species ae j japonicus which is mammophilic and therefore seeks out humans and mammals more frequently than birds for its blood meal molaei et al 2009 schönenberger et al 2016 the model thus needs a factor for the proportion of mosquito blood meals taken on the host birds 1 2 objectives we aimed to provide a model that after introduction of the virus into a new area can i predict the potential regional extent of an epizootic based on realistic density data of host birds and amplifying vector mosquitoes ii identify high risk transmission hotspots within the region and iii estimate the local spread of the virus into surrounding areas by mosquito emigration the latter two model features are intended to support targeted mosquito control measures to contain the virus furthermore we are investigating the effects of consistent population losses on the mosquito side due to unfavourable regional landscape patterns on infection chains 1 3 model implementation and applications we numerically adapted an existing model for wnv implemented for minneapolis in the us laperriere et al 2011 and extended it by a spatial component an agent based flight simulator for vector mosquitoes agent based models abms have successfully been used for the dispersion modelling of insects and other mosquitoes knighton et al 2014 parry et al 2006 manore et al 2015 the advantage of this type of model is that it can represent environmentally induced behaviour changes random decisions interactions between individuals the agents and agent heterogeneity de almeida et al 2010 the space time coupled model is applied to 3 study regions in germany with a size of 625km 2 each but a considerably different number and distribution of vector mosquito habitats and slightly different climatic conditions the host birds in the model are represented by the eurasian magpie p pica and the vector mosquitoes by the asian bush mosquito ae j japonicus the latter was used for the development of the spatial component because a well validated model based habitat map for the species in germany already exists kerkow et al 2019 due to its high resolution it is a suitable basis for flight simulations and local density estimates the magpie on the other hand was integrated into the model not only because of its host characteristics described in section 1 1 but also because the species occurs in urban habitats especially in parks cemeteries allotment gardens as well as in semi open and open landscapes geodon et al 2014 therefore its habitat may overlap with that of ae j japonicus to a large extent kerkow et al 2019 principally allowing for frequent contacts with the mosquito species 1 4 summary of model innovations our work presents the following innovations to existing wnv models i a numerical adaptation that considers mosquito blood meals on organisms other than the host birds this is useful for the integration of real density data of vector mosquitoes and thus enables the model to be applied to regions where the virus has not yet circulated for a long time and where case numbers are still low ii the extension by a spatial component an agent based flight simulator for vector mosquitoes which illustrates the possible regional distribution and taking into account the habitat structure simulates the self motion of the mosquitoes and estimates how many of them would probably leave the region towards which cardinal points iii an adjustment in the calculation of infection trajectories by estimated habitat related persistent population losses on the mosquito side 2 materials and methods 2 1 overview the model has two components that interact with each other these are on the one hand a temporal component an adaptation of the seir model of laperriere et al 2011 that describes the population dynamics of host birds and vector mosquitoes by means of temperature and seasonal dependent ordinary differential equations and calculates the proportions of the mosquito and bird specimens in their respective infection stages on the other hand there is a spatial component that describes local occurrences and movements of vector mosquitoes and estimates the impact of different landscape structures on populations as well as the daily emigration rate from a possible epidemic area towards the different cardinal points by manipulating the mosquito population the spatial component intervenes in the differential equations of the temporal component the composite model has a daily time resolution and a spatial resolution of 100m 100m entities in the model are eurasian magpies pica pica female mosquito imagoes and female mosquitoes in pre imaginal aquatic stages males have no blood meals and thus do not contribute to the trans sylvatic transmission cycle the mosquitoes belong to the species aedes japonicus japonicus asian bush mosquito for the sake of simplicity we call the imagoes mosquitoes and the mosquitoes in the preimaginal stages larvae as it is done in laperriere et al 2011 the spatial component is based on a two dimensional habitat suitability map for ae j japonicus the map has been developed using a nested modelling approach consisting of i a part that models the global climatic requirements wieland et al 2017 früh et al 2018 kerkow et al 2020 and ii a separate part that integrates local land use requirements and the influence of wind speed kerkow et al 2019 it covers the area of germany has a resolution of 100m 100m and shows the habitat suitability as values between 0 and 1 the grid map can be freely downloaded under the link https doi org 10 4228 zalf dk 90 due to its high score in evaluation as measured by the hit rate of data that were not included in a model training we assume that it correlates with the larval density in areas where the invasive species is already established and widely distributed since several years process overview and scheduling a main simulation calls both the temporal component seir model and the spatial component flight simulator and synchronises the mosquito population size and the number of infectious mosquitoes at each time step first the numbers of mosquitoes and birds in their respective infection stage is changed by the daily hatching and mortality rates implemented in the temporal component the temporal component uses the information stored by the main model for the previous day for the calculations the numbers of infectious and non infectious mosquitoes are then communicated to the spatial component which may reduce it by simulated deaths due to large energy consumption e g after long flights or long stays in unsuitable landscapes the reduced number is then transmitted to the main component at the beginning of the simulation the temporal component uses initialisation parameters 2 2 study regions we selected three regions within the grid based habitat suitability map with sizes of 625km 2 25km 25km for model applications figs 1 and 2 in each of them the occurrence of ae j japonicus has been documented for several years werner and kampen 2013 kampen et al 2016 walther and kampen 2017 kampen et al 2017 koban et al 2019 in areas that include our study regions 2 and 3 the species has spread rapidly and the larval numbers on the sampling sites have increased dramatically since the first evidence region 1 appeared to have a lower spreading potential and larval numbers at the collection sites were partially declining the regions differ in their climatic conditions the average annual temperature and the number of hot days average temperature above 30 increases from north to south fig 1 the occurrence of a high number of hot days is an important risk indicator for the occurrence of mosquito borne diseases brugger and rubel 2009 filippelli et al 2020 furthermore the regions differ in their average habitat suitability for ae j japonicus as calculated by kerkow et al 2019 it is 0 35 in region 1 0 66 in region 2 and 0 79 in region 3 fig 2 2 3 temporal component 2 3 1 compartments the model is based on 9 compartments ordinary differential equations that describe the populations and infection stages of mosquitoes and birds by means of a density dependent approach an overview of the seir model including the influence of the flight simulator is given in fig 3 the mosquito compartments include larvae l m virus susceptible s m exposed e m and infectious mosquitoes i m the mosquitoes develop from the larvae whose number is initially determined by the average estimated habitat suitability of the region see section 2 3 3 both larvae and mosquitoes have general temperature dependent mortality rates but cannot succumb to infection the number of susceptible and infectious mosquitoes is also corrected by losses x s m x i m communicated by the flight simulator the bird compartments are susceptible s b exposed e b infectious i b recovered r b and dead birds r b chicks are always virus succeptible after hatching recovered birds have always acquired immunity and the dead birds refer only to those that have succumbed to wnv like the mosquitoes all birds have a general temperature dependent mortality rate infection occurs upon mixing a fraction of infectious and susceptible mosquitoes or birds respectively vertical virus transmission from mosquito females to offspring as well as horizontal transmission between birds is neglected the compartment equations eq 1 9 are taken from previous compartment models for usutu virus and wnv rubel et al 2008 laperriere et al 2011 but we introduced a species specific probability of the mosquitoes taking blood meals on a bird and an additional probability of taking blood meals on a host bird when feeding on a bird both factors affect the virus transmission rates see eqs 10 11 mosquitoes 1 d l m d t b l t δ m d n m m m t l m 1 l m k m b m t l m 2 d s m d t b m t l m m m t s m λ b m t d s m x s m 3 d e m d t λ b m t d s m γ m t e m m m t e m 4 d i m d t γ m t e m m m t i m x i m birds 5 d s b d t b b b b m b n b k b n b λ m b t d s b m b s b 6 d e b d t λ m b t d s b γ b e b m b e b 7 d i b d t γ b e b α b i b m b i b 8 d r b d t 1 ν b α b i b m b r b 9 d d b d t ν b α b i b the number of susceptible mosquitoes exposed on a simulation day λ b m depends on the proportion of active mosquitoes δ m the transmission rate from infectious bird to susceptible mosquito β b see table 3 and the average ratio of infectious birds to all p pica host birds i b k b eq 10 the number of exposed birds λ m b depends on the fraction of active mosquitoes the transmission rate from infectious mosquito to susceptible bird β m see table 3 and the average ratio of infectious mosquitoes to p pica host birds i m k b eq 11 10 λ b m d t δ m d β b t i b k b 11 λ m b d t δ m d β m t i m k b the differential equations were solved with the euler method a comparative test for the solution of the decoupled seir model with the runge kutta 4 method showed only a marginal deviation compared to the calculation with the euler method uncertainties in the parameter estimation have a greater influence on the calculated infections to trigger west nile virus infections in the study regions during a model application we introduce infectious birds into the system 3 times a year 2 at the beginning of march after the arrival of migratory birds 2 at the end of july end of the main chick hatching period and 4 at the beginning of october as some wnv vector bird species migrate intercontinental in autumn 2 3 2 temperature and day length the temporal component is driven by means of daily average temperature data and the day length temperature data was obtained from the german weather service we chose one to three weather stations close to every study region fig 1 and if they were several calculated the average temperature the temperature values are smoothed with a weighted average filter and a window size of 2 fig af1 in the appendix for the calculation of the day lengths fig af2 in the appendix we apply the brock model brock 1981 forsythe et al 1995 which maps the latitude of the location and the day of the year on the day length equation ae2 in the appendix our study regions are located at latitudes 48 9 50 6 and 52 4 we run all model applications by the average day length of the regions of 50 6 tests showed that the slightly different latitudes of the regions do not lead to any difference in the model results regarding the number of infected birds and mosquitoes 2 3 3 initialisation the initial conditions and initialisation parameters of the temporal component are listed in table 1 our model applications start on january 1st and we assume that no infection has yet been introduced into the region hence all mosquitoes and birds are assigned as virus succeptible as in the model applications of laperriere et al 2011 the bird population is set to the maximum as defined by the carrying capacity of the region and the minimum number of mosquitoes required to prevent extinction is 15 of the carrying capacity of the larvae the estimation of the respective regional carrying capacities for mosquito larvae is given below for birds it is explained in the appendix note that the carrying capacity of the bird population makes it appear that the number can be determined that accurately but this is not the case at an early stage of modelling we tried to estimate the number precisely because the original seir model was unreasonably sensitive to that parameter by integrating the blood meal rate on vector birds we made the model no longer sensitive to small changes in bird numbers carrying capacity of mosquito larvae to estimate the capacity for any model region in germany we first studied the literature to find the maximum density in a perfect habitat in central europe we then adjusted this value to the size of the model region and multiplied it by the mean percentage habitat suitability according to kerkow et al 2019 to determine the highest possible population density we considered a study in the netherlands ibañez justicia et al 2018 in which several sample plots were examined in large allotment garden complexes where ae j japonicus has been established for several years allotment gardens are ideal habitats for ae j japonicus due to their rich vegetation structure irrigation systems and the presence of numerous suitable breeding habitats rain barrels flower pots etc all possible breeding habitats were counted in the study and the larvae identified at the time of the highest larval density september 2015 242 containers on an area of 6 8ha contained 4 335 larvae of ae j japonicus this results in 63 750 larvae km 2 of which an estimated 31 875 are female assuming an equal distribution of the sexes based on these observations we have set the maximum carrying capacity k m m a x to 19 900 000 for our study regions which cover 625km 2 2 3 4 parameter estimation the constant parameters in the differential equations are summarised in table 2 they were each determined on the basis of the results of literature research see chapter constant parameters in the appendix for further explanations temperature and daylength dependent parameters are summarised in table table 3 again a detailed description of these parameter calculations can be found in the appendix however we would like to be more precise about the calculation of the transmission rate β b t at this point the transmission rate from an infectious bird to a susceptible mosquito β b t is the product of the bird biting rate the proportion of bird bites on host birds and the transmission efficiency p b to what extent ae j japonicus visit the wnv host bird species compared to other bird species is not specifically known for central europe it is likely that bird species whose habitats overlap with those of the mosquitoes will be preferred and that a high bird species diversity reduces the likelihood of a vector mosquito encountering a host bird we made model applications with the assumption that specimens of the species ae j japonicus do not prefer any bird species for their blood meals since in germany the magpie accounts for about 5 7 of the total bird population geodon et al 2014 p 59 and p 397 we integrated that factor in the transmission rates and found that with this setting transmission cycles cannot occur in any scenario only when at least 50 of the avian blood meals are taken on this host bird epizootics can be triggered in the warmest region of germany r3 this is why we work with a 75 preference factor for magpies over other bird species in the model applications presented here 2 4 spatial component 2 4 1 agents in the spatial component the mosquitoes are bundled together to form super agents super mosquitoes which only unite individuals with the same infection status super agents are a common way to speed up the runtime of an abm with a large number of agents parry and bithell 2012 one super mosquito can comprise 10 100 or 1 000 individuals depending on the setting we here present model applications with a super agent factor of 10 for the visualisation of infectious mosquitoes the factor should not exceed 100 for the visualisation of all mosquitoes however a factor of 1 000 is advisable to keep the computing time at an acceptable level the super mosquitoes are characterised by the study region the position within the grid row column the stage of infection either infectious or not infectious and an energy level it is not energy in the biological sense but rather a kind of probability of further survival in addition it is recorded whether a super mosquito tried to leave the region during the entire model run and if so in which cardinal direction birds are not implemented on an individual level in the model and not exactly located we assume the vector birds to move widely in comparison to the mosquitoes and being equally present throughout interaction between birds and mosquitoes only exists in so far as the mosquitoes visit birds for their blood meals however since we assume an equal spatial distribution of the birds the proportion of infected mosquitoes and birds caused by the infection forces is only numerically calculated and then the infectious mosquitoes are added as super mosquitoes to or removed from the spatial flight simulation 2 4 2 flight behaviour with each simulation step the super mosquitoes can move on the grid map with 100m 100m resolution and a size of 625km 2 we call it mosquito world in any direction within the moore neighbourhood the distance they travel has some stochasticity but it is controlled by a flight motivation resulting from the habitat suitability of the current location and additionally by the main wind direction in the study region when the habitat suitability at the current location is poor if the habitat is well suited a super mosquito will most likely remain there or not fly far in cells with medium habitat quality it mostly stays there but sometimes flies further to meet its needs in an unsuitable habitat it is more likely to fly long distances than in habitats with medium suitability this enables the super mosquito to leave this location more quickly every super mosquito constantly loses energy every day to a small extent and a potentially large amount due to long distance flights the energy can be recharged during stays in good habitats if a certain threshold value is exceeded they die the energy equation was set up in such a way that observations on population trends in the regions in germany where ae j japonicus occurs can be reproduced the motivations and resulting distances are defined based on the following considerations flight motivations active dispersal rates of female mosquitoes are generally dependent on the density and distribution of their preferred blood hosts the availability of breeding habitats terrain characteristics and weather petrić et al 2014 verdonschot and besse lototskaya 2014 regarding terrain characteristics vegetation and land use play a particularly important role they can represent natural barriers ecological corridors and stepping stones for dispersal landscapes that support the spread of ae j japonicus are mosaics of smaller deciduous forests less than 500ha vineyards and areas with private houses and gardens barriers however are e g large forest areas and intensively cultivated fields sáringer kenyeres et al 2020 seidel et al 2016 tannich 2015 based on the insights described above we have introduced a flight motivation in the flight simulator which is landscape dependent we differentiate between low medium and high motivations which are assigned to the mosquitoes when they are in cells with values 0 8 to 1 0 0 3 to 0 8 and 0 to 0 3 according to the model of kerkow et al 2019 whose output we use as a basis for the mosquito worlds the category with the highest habitat quality 1 0 to 0 8 includes discontinuous urban fabrics green urban areas cemeteries gardens zoos and deciduous forests the middle one 0 8 to 0 3 covers most notably mixed forests woodland shrub transition zones fruit and berry plantations and the last one 0 3 to 0 mainly landscapes with an open character such as farmland pastures and airports but also continuous urban fabrics and coniferous forests flight distances for ae j japonicus we are not aware of any published results of mark recapture experiments that would help to estimate the flight distances in certain landscapes and under certain weather conditions there is evidence that individuals in a perfect habitat do not fly long distances and hardly spread out which may explain the findings that larger contiguous forest areas sometimes act more as barriers than as corridors for a location in belgium a second hand tire company with a neighbouring small woodland no evidence of dispersion could be found even after 6 years although there are suitable stepping stones a settlement in direct connection as well as further woodlands and tree rows at distances of only a few hundred metres linear distance egizi et al 2016 also species of the genus aedes and especially the urban domestic container breeding species are known to be rather weak flyers verdonschot and besse lototskaya 2014 and no behaviour like that of long distance fliers was documented for ae j japonicus i e ascending high into the air immediately after adult emergence facilitating far wind drifts service 1980 an approximate indication of flight distances is given by a documentation of the spread of ae j japonicus in west germany north rhine westphalia kampen et al 2016 there an average dispersal of about 10km to 20km per year was recorded between 2012 and 2015 with some exceptions of up to 50km as it is known that ae j japonicus also spreads passively to a large extent especially along roads egizi et al 2016 we suggest that the exceptional dispersal rates exceeding 2km year are due to this cause as stated before the flight simulator only takes into account self motion of mosquitoes and no passive dispersal assuming that the annual main activity and thus the dispersal period is 200days year from mid march to mid october the maximum flight distances would range from 500m to 1km day evaluations of mark recapture experiments of various mosquito species show that most individuals remain at the site and the probability of recapture decreases with increasing distance verdonschot and besse lototskaya 2014 to the summarised data on ae albopictus which is also described as a weak flyer like ae j japonicus and which has similar habitat requirements we have fitted a normal distribution fig 4a to generate probabilities for the flight ranges of ae j japonicus super agents with medium flight motivation we did not consider a fat tail distribution as often used in dispersal modelling of e g pollen nathan et al 2012 since we do not model passive motions that would allow for increased long distance dispersal the data was divided by 100 before the fitting to convert the metres to map units the distribution has the mean value at zero and a standard deviation σ of 2 4 for super mosquitoes with low flight motivation we have reduced the standard deviation of the fitted normal distribution to 0 6 so that they rarely fly further than 100m or 200m and the probability of staying in the cell is relatively high fig 4b to determine the flight direction and next location of a low and medium motivated super mosquito on the grid map its flight range is randomly divided into two segments westward eastward and northward southward the direction taken in each case is determined by the algebraic sign of the randomly generated flight distance and by means of another random generator we assume that the mosquitoes fly longer distances in unsuitable habitats as they are not able to satisfy all their needs availability of breeding habitats host animals or shelter provided by vegetation therefore we implemented a random generator for the super mosquitoes in these habitats which generates equally distributed flight distances between 0 map units and 3 to 4 map units depending on wind conditions for westward eastward and the northward southward movements respectfully this results in a maximum flight distance of 424m 3 map units to 566m 4 map units per day when the super mosquito flies the direct route in a diagonal direction of the moore neighborhood various studies in wind tunnels and in the field show that mosquitoes are more likely to fly upwind than downwind kennedy 1940 midega et al 2012 endo and eltahir 2018 this is probably due to the appetising flights in which they follow smells that are transported by the wind verdonschot and besse lototskaya 2014 at wind speeds of 3km h and above however many species stop flying and seek shelter on the ground or in the vegetation service 1980 as stated above the poor mosquito habitats are mainly open landscapes offering limited protection so we assume that the influence of the wind is particularly noticeable in these using data from the surrounding weather stations of the study regions we analysed the main wind directions and found that for each region movement in a westerly and southerly direction would be more likely fig 5 hence we let the super mosquitoes fly up to 400m towards west and south and up to 300m towards north or east this results in a 1 3 times higher probability of a super mosquito flying in the direction with the stronger wind conditions 2 4 3 boundary effects we have implemented two options for the area boundaries of the study regions in open mode the super mosquitoes can leave the region and the loss is compensated by hatchings see section 2 4 5 of new super mosquitoes with the same infection status this mode merely prevents a potential mass accumulation at the edge of the study region in closed mode the super mosquitoes cannot leave the region an emigration attempt is registered and the cardinal point is saved on the first time however the flight is not executed and the super mosquito remains in its cell the distribution pattern hardly differs between the applications of both options we could not observe any mass accumulation of super mosquitoes at the borders in closed mode however the calculation time is significantly longer in the open mode so we will only apply the closed mode in this work 2 4 4 energy the super mosquitoes in the flight simulator have an energy level that causes them to die during long stays in unsuitable habitats or after covering large distances this makes large areas with unfavourable conditions to dispersion barriers it is known that long distance flights are highly energy consuming for mosquitoes verdonschot and besse lototskaya 2014 but we have no information about the distance covered by ae j japonicus under certain habitat conditions we thus adapted the energy control in a way that a significant reduction of the population can occur in region 1 but the population remains stable in regions 2 and 3 this is consistent with observations made in systematic monitorings koban et al 2019 kampen et al 2016 for the energy level of a super mosquito which can take on values between 1 and 100 we use the following balance equation 12 d e d t δ prev e δ const δ flight f b q where δ prev is the inverse time unit e is the energy on the previous time unit δ const is a constant energy loss per time unit δ flight is the energy loss per flight distance and time unit f is the euclidian flight distance between the start and destination cells the cells have a resolution of 100 100m2 so the distance is given in hectometres b is a boosting factor per time unit and q is the quality value of the new cell the quality values are between 0 and 1 and we handle them equivalent to energy units per time unit for the simulations we set δ prev 1 per time unit δ const 4 eu energy units per time unit δ flight 8 eu per time unit and flight distance and b 50 eu per time unit 2 4 5 control of all super mosquitoes to apply certain processes hatchings deaths to all super mosquitoes in the simulation we have drawn up two lists at a higher hierarchical level in the programme they contain the infectious and non infectious super mosquitoes with all their characteristics on this level we also count the number of super mosquitoes that have tried to leave the region and whether it was the first time hatching the hatching function is used for 3 different purposes firstly to locate the super mosquitoes on the first day of simulation spatial initialisation secondly when the seir model calculates an increase in mosquitoes compared to the previous day and thirdly when super mosquitoes have emigrated in open model mode and this loss is to be compensated by hatchings the super mosquitoes appear at random locations in the study area but preferably in patches with good habitat qualities the larvae are not represented in the spatial component for runtime reasons but the mosquitoes hatch in the larval breeding sites which are implemented based on the following considerations the greater the habitat suitability the more breeding sites should be available since the presence of these was one of the main considerations when preparing the habitat suitability map kerkow et al 2019 the breeding sites of ae j japonicus are water filled natural or artificial containers such as flower dishes cemetery vases wells or tree holes they are often not permanently present and filled with water so their location should be habitat related but also have a stochastic component furthermore breeding habitats may be located outside but close to actual main habitats to achieve this we have created copies from the habitat maps and reduced its spatial resolution to 500m 500m in the following we refer to 100m 100m units on the map as cells and larger areas measuring 500m 500m as patches the values of all individual habitat qualities within each 25ha patch were summed up and again scaled to values between 0 and 1 for each study region the super mosquitoes first hatch on the low resolution map a weighted random generator ensures higher hatching rates with increasingly better habitat suitability the super mosquitoes are then transferred back to the original map with 100m 100m resolution the allocation within each 25ha patch is random all newly hatched super mosquitoes start with the maximum energy level of 100 deaths if the temporal model component reduces the number of mosquitoes compared to the previous day this happens almost every day in autumn and if as a result the number of mosquitoes is lower than in the spatial component then the corresponding number of super mosquitoes in the respective infection stage is also removed from the spatial component the selection is random super mosquitoes that have died due to a loss of energy are already included in the comparison 2 4 6 observation for each time step the number of larvae the number of mosquitoes and birds in their respective infection states and the number of super mosquitoes that have emigrated open mode or tried to emigrate at least once closed mode in the respective directions see chap 2 4 3 can be displayed for this purpose the data are stored during the simulation furthermore the spatial distribution of all super mosquitoes and the infected super mosquitoes is stored in arrays using these we display i the movements of the mosquitoes during the entire simulation period in a video and ii the distribution of the super mosquitoes on the day with the highest infections in a single map 3 results as the composite model is not validated does not include all major wnv hosts and vectors and as the rate of blood meals on the host birds is unknown it can vary considerably from region to region the calculated amplitude of wnv case numbers in birds and the infection rate in mosquitoes is not yet reliable for the sake of completeness we have presented these results in the appendix the results of the spatial distributions of the ae j japonicus populations in late summer at the time when most infectious mosquitoes are present show that the super mosquitoes accumulate strongly in cells with very good habitat qualities values from 0 8 to 1 fig 6 the majority of these cells contain deciduous forests and human settlements in all 3 study regions see fig 2 in region 1 very poor and very good habitats are particularly strongly separated from each other fig 1a this enables to assess the spatial extent at which a dispersion barrier is effective the energy and flight distance settings resulted in the super mosquitoes moving a maximum of about 2km away from the very good habitats already at a distance of 1km the super mosquito density decreases rapidly as a result the area with the poor conditions in the centre was not a strong dispersion barrier but an area in the north east of the region remained super mosquito free throughout the simulation video s1 fig 6a also in region 2 many super mosquitoes are able to cross the area with poor habitat characteristics which extends from the north west to the centre and is mainly characterised by arable land video s2 fig 6b small towns and villages between the crop lands serve as stepping stones fig 2e the number of super mosquitoes being eliminated from the simulation during the entire simulation period due to low energy levels was about 228 700 53 600 and 134 200 for regions 1 2 and 3 respectively table 4 the reduction in total maximum mosquito population from applications of the linked model in 2018 compared to applications of the seir model without spatial extension was 9 82 in region 1 1 1 in region 2 and 0 05 in region 3 table 5 in region 1 repeated use of model applications resulted in a higher risk of infected super mosquitoes being prematurely removed from the simulation than in the regions 2 and 3 this is due to the large proportion of unfavourable habitats in region 1 the number of total emigration attempts is almost three times higher in region 3 and almost twice as high in region 2 than in region 1 however if only the first emigration attempts are considered the differences are smaller table 4 fig 6 in region 1 approximately the same number of super mosquitoes emigrate towards south and west during the entire simulation on the one hand these are the main wind directions in all study regions fig 5 and on the other hand more areas with high occurrence probabilities have intersections with the borders in the west and south of region 1 in region 2 about the same number of super mosquitoes made the first attempt to emigrate towards the north east and south much less good and very good mosquito habitats border the eastern edge of the region and only a third of the super mosquitoes tried to leave the region for the first time in this direction in region 3 there were about twice as many first attempts to emigrate towards the east and south as towards the north or west also here the result is related to the very good mosquito habitats located along the edge of the region and not to the main wind directions runtime the application of the coupled model to the year 2018 on a machine with an intel r core tm i7 4510u processor with 4cpu lasts 9min 20min and 28min for the 3 study regions respectively and a super mosquito factor of 100 without saving the arrays for each simulation day which serves to create the flight videos the runtime is reduced by about 3min with a super mosquito factor of 1 000 the runtime can be reduced even more to a maximum of 3min however with a factor of 10 the runtime is 6h 13min for region 1 1d 1h 47min for region 2 and 1d 6 h 22min for region 3 4 discussion we introduce the first compartment model for west nile virus which also simulates the abundance and movements of a vector mosquito species in a spatial extension and thus helps to estimate where virus hotspots could be located and towards which direction the virus is likely to be carried from a region by active flights of the mosquitoes the temporal component seir model is exploratory this means that the results are not yet validated the seir model was adapted to the conditions in central europe and a realistic size of the mosquito population originally the seir model was implemented for minneapolis in the us and validated with the number of detected dead sentinel birds laperriere et al 2011 the flight simulator is implemented on the basis of literature studies and we scaled it in such a way that population development data available for all three study regions could be reproduced 4 1 temporal model component validation of the results of our exploratory seir model applications is not possible because i the evidence of wnv rna in german wild bird populations is still very low ii it is uncertain whether the eurasian magpie is or will be a major vector in central europe iii there are very likely several bird and mosquito species that act as efficient hosts and vectors so the model should be extended to deal with this and iv there is still a lack of clarity about multiple factors that influence the vector competence of ae j japonicus this includes in particular the degree of ornitophily and the rate of blood meals on the corresponding host bird species furthermore we coupled the model components in such a way that poor habitat structures negatively affect mosquito populations thus the spatial model plausibly intervenes in the equations of the original seir model other uncertainties include that data on the virus incubation period among vector mosquitoes in relation to temperature is extremely limited and that the function used here is based solely on an experiment with cx tarsalis in addition the results of laboratory experiments on ae j japonicus to investigate the dissemination rate and transmission efficiency for wnv are not consistent while huber et al 2014 found resistance to infection in individuals from south west germany and could not identify co infections with other flavi viruses or the wolbachia bacterium of the mosquitoes which could bias the results veronesi et al 2018 were able to demonstrate dissemination rates of 15 6 for strain ny99 and 18 3 for fin in swiss individuals furthermore v the carrying capacity of ae j japonicus larvae in the study regions is only estimated based on a habitat map derived from a nested modelling approach kerkow et al 2019 and on a study indicating the larval abundance in an ideal habitat the habitat map however was not validated with abundance data but with occurrence data mainly derived from the citizen science project mueckenatlas walther and kampen 2017 a check of the correlation between abundance data from a systematic monitoring and of the different habitat qualities as performed for example in the studies of mushinzimana et al 2006 and chaves and moji 2017 is therefore an important project for the future there are additional factors that may play a role in the development of a wnv epizootic that we have not considered to focus on the essential factors and to not excessively modify the evaluated seir baseline model first the development of the mosquito population in the model is dependent on the carrying capacity of the larvae temperature dependent hatching and death rates and the proportion of non diapausing mosquitoes as a function of the season in fact winter frosts reuss et al 2018 and precipitation chianese et al 2019 also affect population development moreover there is evidence that some species of mammals and amphibians e g squirrels rabbits and frogs are also susceptible to wnv infection and develop high levels of viraemia this way of transmission however is supposed to play only a minor role chancey et al 2015 the model neglects vertical transmission paths for mosquitoes and horizontal paths for host birds however there are indications for vertical trans ovarian transmissions in different species of the culex genus the transmission efficiency can vary between 10 to 40 nelms et al 2013 it is also assumed that vertically infected mosquitoes facilitate the hibernation of the virus in many regions calistri et al 2010 ciota 2017 dohm et al 2002 nelms et al 2013 however no published results are yet available indicating vertical transmission of wnv in ae j japonicus birds can become infected horizontally through consumption of infected birds of prey feather picking and oral contact with the faeces of other birds horizontal transmission in birds could play a major role it is suspected to be the reason why birds of prey and feather pickers such as crows and hawks become infected in nature frequently komar et al 2003 yaremych et al 2004 pérez ramírez et al 2014 scenario analyses to investigate the effects of different trans ovarian transmission rates in mosquitoes and horizontal transmission rates in birds remain an important future task for disease modellers but adjustments can easily be made in the seir model the influence of infections of the birds and mosquitoes with other pathogens is also neglected in our model however the susceptibility of host birds may be affected by previous infections with viruses from the group of japanese encephalitis viruses which includes the usutu virus occurring in germany pérez ramírez et al 2014 the vector competence of the mosquitoes as well as population size and sex ratio can also be influenced by cross infection with the bacterium wolbachia pipientis ciota 2017 gao et al 2020 4 2 spatial model component the flight simulator can predict the locations of mosquito hotspots within a region as well as dispersion barriers and stepping stones for potentially infected mosquitoes of the species ae j japonicus the flight simulations can also be used to assess how efficiently the virus can spread from a region to the respective cardinal points through active flights of the mosquitoes this is useful after a sudden local introduction of the virus as it was the case in 2018 in some places in germany as the model is freely available and based on free software it can be adapted to new research results and applied to other regions as mentioned in chapter 4 1 the model needs to be extended for other vector mosquito species we have implemented the flight simulator for the japanese bush mosquito ae j japonicus since there are yet no comparable high resolution habitat maps for germany available for other vector species like cx pipiens further species of the culex agg or ae vexans although numerous studies provide information on the propagation speed of the invasive japanese bush mosquito damiens et al 2014 seidel et al 2016 egizi et al 2016 kampen et al 2016 montarsi et al 2019 it is not possible to determine the extent of the influence of passive propagation by traffic in any of the observations studies suggest that ae j japonicus and other invasive species of the genus aedes spread over longer distances by means of transport egizi et al 2016 eritja et al 2017 however in our model we have concentrated on the active spread of the mosquito one reason for this is that transport assisted dispersal must involve different control measures than dispersal away from transport routes by the self motion of mosquitoes on the other hand there are already models that estimate long distance spreads of the virus by birds maidana and yang 2008 2009 or a combination of long distance spread by both birds and mosquitoes liu et al 2006 the flight simulator is implemented as an agent based model abms are computationally intensive and therefore not well suited to deal with large numbers of individuals such as millions of mosquitoes in our case however by bundling several mosquitoes into super mosquitoes we were able to bring the run times into an acceptable range of only several minutes with a super mosquito factor of 1 000 the other side of agent models is that they can be extended in many ways thus additional host bird and vector mosquito species each with different virus transmission characteristics could be added in the future resulting in a multi agent model 5 conclusions we have adapted a wnv compartment susceptible exposed infectious removed model for both a potential host bird and vector mosquito species pica pica and aedes japonicus japonicus occurring in germany and coupled it with a flight simulator for the vector mosquitoes the flight simulator is an agent based model built on a habitat map for the mosquito species being invasive in germany data on local temperature and wind conditions and studies on the flight behaviour of this and other mosquito species the spatial extension of the seir model is the first step in developing a tool that can estimate for a region i whether an epizootic can emerge after virus introduction ii how large the vector mosquito population is and iii where vector mosquito hot spots dispersal corridors stepping stones and barriers are located in addition iv the model can calculate the probability of infectious mosquitoes leaving the region in the respective cardinal directions the model extension is not only a visualisation tool but also intervenes in the differential equations of the seir model this applies in particular to regions with few suitable habitats where the potential size of the mosquito population is reduced on a daily basis as a result of long flight distances since many bird and mosquito species are hosts and vectors of west nile virus the current version of the model cannot yet reliably determine the extent of an epizootic in a next step it must be expanded to include other important bird and mosquito species with their respective life trait parameters virus incubation times transmission rates and so forth moreover we plan to extend the model further so that the coupled model can run in parallel for many somewhat smaller patches with presumably different numbers of host birds the spatially extended wnv model implemented in python 3 7 is freely available under the creative commons attribution non commercial 4 0 https github com akerkow bush mosquito flight simulator and a tool aimed at modellers involved in planning control measures for wnv vector mosquitoes it is particularly useful for applications in regions where the virus has been recently introduced for model applications we recommend selecting the size of the study area to cover the territories of the host birds surrounding the reported wnv cases local ornithologists may be consulted to assist with this it would also be advantageous if blood meal data were available for the relevant mosquito species for the region under study credit authorship contribution statement antje kerkow conception of the study conducted the literature research designed the model analysed and interpreted the model results drafted the manuscript ralf wieland designed the model critically revised the manuscript jörn m gethmann contributed parasitological and epidemiological expert knowledge critically revised the manuscript franz hölker contributed expert knowledge for the conception of agent based models critically revised the manuscript hartmut h k lentz supported the data analyses critically revised the manuscript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper funding this work was supported by the federal ministry of food and agriculture germany bmel grant no 2819105315 and the ministry of science research and culture of the federal state of brandenburg mwfk germany appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ecolmodel 2021 109840 appendix a supplementary data the following is the supplementary material related to this article contains additional equations figures and explanations video s1 2d flight simulations of female super mosquitoes n 10 at all stages of infection in study region 1 video s2 2d flight simulations of female super mosquitoes n 10 at all stages of infection in study region 2 video s3 2d flight simulations of female super mosquitoes n 10 at all stages of infection in study region 3 video s4 2d flight simulations of infectious super mosquitoes n 10 in study region 1 video s5 2d flight simulations of infectious super mosquitoes n 10 in study region 2 video s6 2d flight simulations of infectious super mosquitoes n 10 in study region 3 mmc s7 
24515,compartmental sir and seir models have become the state of the art tools to study infection cycles of arthropod borne viruses such as west nile virus in specific areas in 2018 the virus was detected for the first time in germany and incidents have been reported in humans birds and horses the aim of the work presented here was to provide a tool for estimating west nile virus infection scenarios local hotspots and dispersal routes following its introduction into new locations through the movements of mosquitoes for this purpose we adapted a seir model for west nile virus to the conditions in germany temperatures geographical latitude bird and mosquito species densities and the characteristic transmission and life trait parameter of a possible host bird and vector mosquito species we further extended it by a spatial component an agent based flight simulator for vector mosquitoes it demonstrates how the female mosquitoes move within the landscape due to habitat structures and wind conditions and about how many of them leave the region in the different cardinal directions we applied the space time coupled model with a daily temporal and spatial resolution of 100m 100m to the eurasian magpie pica pica and the asian bush mosquito aedes japonicus japonicus both species are widely distributed in germany and discussed as important hosts and vectors respectively we also applied the model to three study regions in germany each representing slightly different climatic conditions and containing significantly different pattern of suitable habitats for the mosquito species graphical abstract keywords agent based models aedes japonicus japonicus germany pica pica seir sir models spatial component 1 introduction 1 1 background west nile virus wnv is an arthropod borne pathogen maintained in enzootic transmission cycles between birds amplifying hosts and ornithophilic mosquitoes vectors chancey et al 2015 marini et al 2018 humans horses and other mammals may be dead end hosts in 2018 europe experienced an intense and long heat wave bringing the continent its worst wnv epizootics and epidemics to date germany was affected for the first time with 12 confirmed infections in birds and 2 in horses ziegler et al 2019 kampen et al 2020 ziegler et al 2020 in the following years repeated cases occurred in the affected regions in germany and beyond indicating that the virus hibernates in local mosquito populations kampen et al 2020 ziegler et al 2020 neupert 2020 pietsch et al 2020 many bird species seem susceptible to the virus linke et al 2007 but only some develop high viraemiae and death rates jourdain et al 2007 pérez ramírez et al 2014 especially birds of prey and corvids were observed to have high mortality from wnv 2 in europe severely affected species include northern goshawk accipiter gentilis house sparrow passer domesticus eurasian magpie pica pica and hooded crow corvus cornix calistri et al 2010 zehender et al 2017 bażanów et al 2018 la puente et al 2018 hubálek et al 2018 2019 napp et al 2019 based on field studies in spain napp et al 2019 propose the eurasian magpie as a sentinel species it is one of the most common corvid species in europe sedentary and showed high virus susceptibility virus titres and mortality in experimental studies de oya et al 2018 the main vectors of wnv in europe are supposed to be mosquitoes of the widespread cx pipiens complex including the two biotypes cx p pipiens and cx p molestus as well as cx torrentium and cx modestus leggewie et al 2016 tran et al 2017 bhowmick et al 2020 holicki et al 2020 besides those ae vexans and ae japonicus japonicus are also considered species kampen et al 2020 especially the potential future role of the invasive asian bush mosquito ae j japonicus is currently hotly debated schaffner et al 2009 kampen et al 2020 laboratory experiments with specimens collected in switzerland and the us revealed a significantly shorter virus incubation period turell et al 2001 and significantly higher dissemination and transmission rates than cx pipiens sl veronesi et al 2018 wagner et al 2018 turell et al 2001 sardelis and turell 2001 but another laboratory study with individuals caught in germany showed a resistance to infections with west nile virus huber et al 2014 aedes j japonicus was detected in germany in 2008 koban et al 2019 and is mainly established in the western and southern part of the country kampen et al 2020 because of the medical relevance of the virus it is highly important to take precautionary measures in the potential risk areas models shall help to understand the complex interrelationships that contribute to the establishment of an epizootic identify high risk areas and assess the effect of precautionary measures so far wnv models focused either on the spatial or the systemic component the spatial models identify potential risk areas by modelling the habitats of vector mosquitoes cooke et al 2006 diuk wasser et al 2006 pape et al 2008 host birds durand et al 2017 or an overlap of both tran et al 2017 other spatial approaches aim to identify wnv risk areas by analysing the climate and other spatial features of areas where epizootics have occurred brownstein et al 2002 harrigan et al 2014 tran et al 2014 compartment models based on differential equations are much more complex and focus on the systemic component they consider both seasonal and temperature dependent population densities of host birds and vector mosquitoes and simulate the development of the infection processes after virus introduction in a given region since about 20 years these models have been successfully used to study arbovirus infection cycles like that of wnv thomas and urena 2001 wonham et al 2004 laperriere et al 2011 simpson et al 2012 the models are called sir or seir models which refers to the infection stages in which the model organisms can be found susceptible exposed infected infectious and only valid for the vertebrate hosts recovered and immune they assume a homogeneous distribution of host birds and vector mosquitoes in a given outbreak region and are usually calibrated by means of the number of encountered dead birds rubel et al 2008 laperriere et al 2011 due to the assumption of homogeneity in previous compartmental wnv models it was not possible to locate the risk areas more precisely to investigate influences of regionally different contact rates between hosts and vectors and to estimate simultaneously the spread of the virus within the region and beyond to achieve this one needs a spatial component that considers the locations and movements of the animals in the work presented here we will extend a compartment model for wnv by a spatial component a flight simulator and localiser for vector mosquitoes we focus on the local occurrence and movements of vector mosquitoes to estimate the virus spread because it can be effectively controlled by decimating mosquito populations on the wild bird side no vaccination exists so far and population control would be difficult to establish and not be a socially accepted measure furthermore the active autonomous movements of mosquitoes are usually of smaller distance and more predictable than those of the vector birds we further discovered that in existing compartmental wnv models wonham et al 2004 laperriere et al 2011 the calculation of an unknown parameter in the infection equations the vector population size in the epidemic area is problematic this is because the contact rate of vector mosquitoes with host birds has a huge impact on the equations in these models but is solely derived from observations of temperature dependent blood digestion the linkage between the duration of blood digestion and frequency of host contacts is plausible however it was numerically not considered that the vector mosquitoes integrated in the model an aggregation of culex pipiens sl and other culex species especially cx tarsalis do not feed exclusively on the host birds with every required blood meal other birds as well as mammals amphibians and reptilians are for example also used by both biotypes of cx pipiens apperson et al 2004 as a result of this set up the population density of the vector mosquitoes was calculated to be significantly too low in our opinion conversely if the model is applied to new epidemic areas with only a few case numbers and if mosquito densities confirmed by monitoring campaigns are integrated the model will considerably overestimate the course of infection due to the high contact numbers the problem becomes even more apparent when the model is applied to the mosquito species ae j japonicus which is mammophilic and therefore seeks out humans and mammals more frequently than birds for its blood meal molaei et al 2009 schönenberger et al 2016 the model thus needs a factor for the proportion of mosquito blood meals taken on the host birds 1 2 objectives we aimed to provide a model that after introduction of the virus into a new area can i predict the potential regional extent of an epizootic based on realistic density data of host birds and amplifying vector mosquitoes ii identify high risk transmission hotspots within the region and iii estimate the local spread of the virus into surrounding areas by mosquito emigration the latter two model features are intended to support targeted mosquito control measures to contain the virus furthermore we are investigating the effects of consistent population losses on the mosquito side due to unfavourable regional landscape patterns on infection chains 1 3 model implementation and applications we numerically adapted an existing model for wnv implemented for minneapolis in the us laperriere et al 2011 and extended it by a spatial component an agent based flight simulator for vector mosquitoes agent based models abms have successfully been used for the dispersion modelling of insects and other mosquitoes knighton et al 2014 parry et al 2006 manore et al 2015 the advantage of this type of model is that it can represent environmentally induced behaviour changes random decisions interactions between individuals the agents and agent heterogeneity de almeida et al 2010 the space time coupled model is applied to 3 study regions in germany with a size of 625km 2 each but a considerably different number and distribution of vector mosquito habitats and slightly different climatic conditions the host birds in the model are represented by the eurasian magpie p pica and the vector mosquitoes by the asian bush mosquito ae j japonicus the latter was used for the development of the spatial component because a well validated model based habitat map for the species in germany already exists kerkow et al 2019 due to its high resolution it is a suitable basis for flight simulations and local density estimates the magpie on the other hand was integrated into the model not only because of its host characteristics described in section 1 1 but also because the species occurs in urban habitats especially in parks cemeteries allotment gardens as well as in semi open and open landscapes geodon et al 2014 therefore its habitat may overlap with that of ae j japonicus to a large extent kerkow et al 2019 principally allowing for frequent contacts with the mosquito species 1 4 summary of model innovations our work presents the following innovations to existing wnv models i a numerical adaptation that considers mosquito blood meals on organisms other than the host birds this is useful for the integration of real density data of vector mosquitoes and thus enables the model to be applied to regions where the virus has not yet circulated for a long time and where case numbers are still low ii the extension by a spatial component an agent based flight simulator for vector mosquitoes which illustrates the possible regional distribution and taking into account the habitat structure simulates the self motion of the mosquitoes and estimates how many of them would probably leave the region towards which cardinal points iii an adjustment in the calculation of infection trajectories by estimated habitat related persistent population losses on the mosquito side 2 materials and methods 2 1 overview the model has two components that interact with each other these are on the one hand a temporal component an adaptation of the seir model of laperriere et al 2011 that describes the population dynamics of host birds and vector mosquitoes by means of temperature and seasonal dependent ordinary differential equations and calculates the proportions of the mosquito and bird specimens in their respective infection stages on the other hand there is a spatial component that describes local occurrences and movements of vector mosquitoes and estimates the impact of different landscape structures on populations as well as the daily emigration rate from a possible epidemic area towards the different cardinal points by manipulating the mosquito population the spatial component intervenes in the differential equations of the temporal component the composite model has a daily time resolution and a spatial resolution of 100m 100m entities in the model are eurasian magpies pica pica female mosquito imagoes and female mosquitoes in pre imaginal aquatic stages males have no blood meals and thus do not contribute to the trans sylvatic transmission cycle the mosquitoes belong to the species aedes japonicus japonicus asian bush mosquito for the sake of simplicity we call the imagoes mosquitoes and the mosquitoes in the preimaginal stages larvae as it is done in laperriere et al 2011 the spatial component is based on a two dimensional habitat suitability map for ae j japonicus the map has been developed using a nested modelling approach consisting of i a part that models the global climatic requirements wieland et al 2017 früh et al 2018 kerkow et al 2020 and ii a separate part that integrates local land use requirements and the influence of wind speed kerkow et al 2019 it covers the area of germany has a resolution of 100m 100m and shows the habitat suitability as values between 0 and 1 the grid map can be freely downloaded under the link https doi org 10 4228 zalf dk 90 due to its high score in evaluation as measured by the hit rate of data that were not included in a model training we assume that it correlates with the larval density in areas where the invasive species is already established and widely distributed since several years process overview and scheduling a main simulation calls both the temporal component seir model and the spatial component flight simulator and synchronises the mosquito population size and the number of infectious mosquitoes at each time step first the numbers of mosquitoes and birds in their respective infection stage is changed by the daily hatching and mortality rates implemented in the temporal component the temporal component uses the information stored by the main model for the previous day for the calculations the numbers of infectious and non infectious mosquitoes are then communicated to the spatial component which may reduce it by simulated deaths due to large energy consumption e g after long flights or long stays in unsuitable landscapes the reduced number is then transmitted to the main component at the beginning of the simulation the temporal component uses initialisation parameters 2 2 study regions we selected three regions within the grid based habitat suitability map with sizes of 625km 2 25km 25km for model applications figs 1 and 2 in each of them the occurrence of ae j japonicus has been documented for several years werner and kampen 2013 kampen et al 2016 walther and kampen 2017 kampen et al 2017 koban et al 2019 in areas that include our study regions 2 and 3 the species has spread rapidly and the larval numbers on the sampling sites have increased dramatically since the first evidence region 1 appeared to have a lower spreading potential and larval numbers at the collection sites were partially declining the regions differ in their climatic conditions the average annual temperature and the number of hot days average temperature above 30 increases from north to south fig 1 the occurrence of a high number of hot days is an important risk indicator for the occurrence of mosquito borne diseases brugger and rubel 2009 filippelli et al 2020 furthermore the regions differ in their average habitat suitability for ae j japonicus as calculated by kerkow et al 2019 it is 0 35 in region 1 0 66 in region 2 and 0 79 in region 3 fig 2 2 3 temporal component 2 3 1 compartments the model is based on 9 compartments ordinary differential equations that describe the populations and infection stages of mosquitoes and birds by means of a density dependent approach an overview of the seir model including the influence of the flight simulator is given in fig 3 the mosquito compartments include larvae l m virus susceptible s m exposed e m and infectious mosquitoes i m the mosquitoes develop from the larvae whose number is initially determined by the average estimated habitat suitability of the region see section 2 3 3 both larvae and mosquitoes have general temperature dependent mortality rates but cannot succumb to infection the number of susceptible and infectious mosquitoes is also corrected by losses x s m x i m communicated by the flight simulator the bird compartments are susceptible s b exposed e b infectious i b recovered r b and dead birds r b chicks are always virus succeptible after hatching recovered birds have always acquired immunity and the dead birds refer only to those that have succumbed to wnv like the mosquitoes all birds have a general temperature dependent mortality rate infection occurs upon mixing a fraction of infectious and susceptible mosquitoes or birds respectively vertical virus transmission from mosquito females to offspring as well as horizontal transmission between birds is neglected the compartment equations eq 1 9 are taken from previous compartment models for usutu virus and wnv rubel et al 2008 laperriere et al 2011 but we introduced a species specific probability of the mosquitoes taking blood meals on a bird and an additional probability of taking blood meals on a host bird when feeding on a bird both factors affect the virus transmission rates see eqs 10 11 mosquitoes 1 d l m d t b l t δ m d n m m m t l m 1 l m k m b m t l m 2 d s m d t b m t l m m m t s m λ b m t d s m x s m 3 d e m d t λ b m t d s m γ m t e m m m t e m 4 d i m d t γ m t e m m m t i m x i m birds 5 d s b d t b b b b m b n b k b n b λ m b t d s b m b s b 6 d e b d t λ m b t d s b γ b e b m b e b 7 d i b d t γ b e b α b i b m b i b 8 d r b d t 1 ν b α b i b m b r b 9 d d b d t ν b α b i b the number of susceptible mosquitoes exposed on a simulation day λ b m depends on the proportion of active mosquitoes δ m the transmission rate from infectious bird to susceptible mosquito β b see table 3 and the average ratio of infectious birds to all p pica host birds i b k b eq 10 the number of exposed birds λ m b depends on the fraction of active mosquitoes the transmission rate from infectious mosquito to susceptible bird β m see table 3 and the average ratio of infectious mosquitoes to p pica host birds i m k b eq 11 10 λ b m d t δ m d β b t i b k b 11 λ m b d t δ m d β m t i m k b the differential equations were solved with the euler method a comparative test for the solution of the decoupled seir model with the runge kutta 4 method showed only a marginal deviation compared to the calculation with the euler method uncertainties in the parameter estimation have a greater influence on the calculated infections to trigger west nile virus infections in the study regions during a model application we introduce infectious birds into the system 3 times a year 2 at the beginning of march after the arrival of migratory birds 2 at the end of july end of the main chick hatching period and 4 at the beginning of october as some wnv vector bird species migrate intercontinental in autumn 2 3 2 temperature and day length the temporal component is driven by means of daily average temperature data and the day length temperature data was obtained from the german weather service we chose one to three weather stations close to every study region fig 1 and if they were several calculated the average temperature the temperature values are smoothed with a weighted average filter and a window size of 2 fig af1 in the appendix for the calculation of the day lengths fig af2 in the appendix we apply the brock model brock 1981 forsythe et al 1995 which maps the latitude of the location and the day of the year on the day length equation ae2 in the appendix our study regions are located at latitudes 48 9 50 6 and 52 4 we run all model applications by the average day length of the regions of 50 6 tests showed that the slightly different latitudes of the regions do not lead to any difference in the model results regarding the number of infected birds and mosquitoes 2 3 3 initialisation the initial conditions and initialisation parameters of the temporal component are listed in table 1 our model applications start on january 1st and we assume that no infection has yet been introduced into the region hence all mosquitoes and birds are assigned as virus succeptible as in the model applications of laperriere et al 2011 the bird population is set to the maximum as defined by the carrying capacity of the region and the minimum number of mosquitoes required to prevent extinction is 15 of the carrying capacity of the larvae the estimation of the respective regional carrying capacities for mosquito larvae is given below for birds it is explained in the appendix note that the carrying capacity of the bird population makes it appear that the number can be determined that accurately but this is not the case at an early stage of modelling we tried to estimate the number precisely because the original seir model was unreasonably sensitive to that parameter by integrating the blood meal rate on vector birds we made the model no longer sensitive to small changes in bird numbers carrying capacity of mosquito larvae to estimate the capacity for any model region in germany we first studied the literature to find the maximum density in a perfect habitat in central europe we then adjusted this value to the size of the model region and multiplied it by the mean percentage habitat suitability according to kerkow et al 2019 to determine the highest possible population density we considered a study in the netherlands ibañez justicia et al 2018 in which several sample plots were examined in large allotment garden complexes where ae j japonicus has been established for several years allotment gardens are ideal habitats for ae j japonicus due to their rich vegetation structure irrigation systems and the presence of numerous suitable breeding habitats rain barrels flower pots etc all possible breeding habitats were counted in the study and the larvae identified at the time of the highest larval density september 2015 242 containers on an area of 6 8ha contained 4 335 larvae of ae j japonicus this results in 63 750 larvae km 2 of which an estimated 31 875 are female assuming an equal distribution of the sexes based on these observations we have set the maximum carrying capacity k m m a x to 19 900 000 for our study regions which cover 625km 2 2 3 4 parameter estimation the constant parameters in the differential equations are summarised in table 2 they were each determined on the basis of the results of literature research see chapter constant parameters in the appendix for further explanations temperature and daylength dependent parameters are summarised in table table 3 again a detailed description of these parameter calculations can be found in the appendix however we would like to be more precise about the calculation of the transmission rate β b t at this point the transmission rate from an infectious bird to a susceptible mosquito β b t is the product of the bird biting rate the proportion of bird bites on host birds and the transmission efficiency p b to what extent ae j japonicus visit the wnv host bird species compared to other bird species is not specifically known for central europe it is likely that bird species whose habitats overlap with those of the mosquitoes will be preferred and that a high bird species diversity reduces the likelihood of a vector mosquito encountering a host bird we made model applications with the assumption that specimens of the species ae j japonicus do not prefer any bird species for their blood meals since in germany the magpie accounts for about 5 7 of the total bird population geodon et al 2014 p 59 and p 397 we integrated that factor in the transmission rates and found that with this setting transmission cycles cannot occur in any scenario only when at least 50 of the avian blood meals are taken on this host bird epizootics can be triggered in the warmest region of germany r3 this is why we work with a 75 preference factor for magpies over other bird species in the model applications presented here 2 4 spatial component 2 4 1 agents in the spatial component the mosquitoes are bundled together to form super agents super mosquitoes which only unite individuals with the same infection status super agents are a common way to speed up the runtime of an abm with a large number of agents parry and bithell 2012 one super mosquito can comprise 10 100 or 1 000 individuals depending on the setting we here present model applications with a super agent factor of 10 for the visualisation of infectious mosquitoes the factor should not exceed 100 for the visualisation of all mosquitoes however a factor of 1 000 is advisable to keep the computing time at an acceptable level the super mosquitoes are characterised by the study region the position within the grid row column the stage of infection either infectious or not infectious and an energy level it is not energy in the biological sense but rather a kind of probability of further survival in addition it is recorded whether a super mosquito tried to leave the region during the entire model run and if so in which cardinal direction birds are not implemented on an individual level in the model and not exactly located we assume the vector birds to move widely in comparison to the mosquitoes and being equally present throughout interaction between birds and mosquitoes only exists in so far as the mosquitoes visit birds for their blood meals however since we assume an equal spatial distribution of the birds the proportion of infected mosquitoes and birds caused by the infection forces is only numerically calculated and then the infectious mosquitoes are added as super mosquitoes to or removed from the spatial flight simulation 2 4 2 flight behaviour with each simulation step the super mosquitoes can move on the grid map with 100m 100m resolution and a size of 625km 2 we call it mosquito world in any direction within the moore neighbourhood the distance they travel has some stochasticity but it is controlled by a flight motivation resulting from the habitat suitability of the current location and additionally by the main wind direction in the study region when the habitat suitability at the current location is poor if the habitat is well suited a super mosquito will most likely remain there or not fly far in cells with medium habitat quality it mostly stays there but sometimes flies further to meet its needs in an unsuitable habitat it is more likely to fly long distances than in habitats with medium suitability this enables the super mosquito to leave this location more quickly every super mosquito constantly loses energy every day to a small extent and a potentially large amount due to long distance flights the energy can be recharged during stays in good habitats if a certain threshold value is exceeded they die the energy equation was set up in such a way that observations on population trends in the regions in germany where ae j japonicus occurs can be reproduced the motivations and resulting distances are defined based on the following considerations flight motivations active dispersal rates of female mosquitoes are generally dependent on the density and distribution of their preferred blood hosts the availability of breeding habitats terrain characteristics and weather petrić et al 2014 verdonschot and besse lototskaya 2014 regarding terrain characteristics vegetation and land use play a particularly important role they can represent natural barriers ecological corridors and stepping stones for dispersal landscapes that support the spread of ae j japonicus are mosaics of smaller deciduous forests less than 500ha vineyards and areas with private houses and gardens barriers however are e g large forest areas and intensively cultivated fields sáringer kenyeres et al 2020 seidel et al 2016 tannich 2015 based on the insights described above we have introduced a flight motivation in the flight simulator which is landscape dependent we differentiate between low medium and high motivations which are assigned to the mosquitoes when they are in cells with values 0 8 to 1 0 0 3 to 0 8 and 0 to 0 3 according to the model of kerkow et al 2019 whose output we use as a basis for the mosquito worlds the category with the highest habitat quality 1 0 to 0 8 includes discontinuous urban fabrics green urban areas cemeteries gardens zoos and deciduous forests the middle one 0 8 to 0 3 covers most notably mixed forests woodland shrub transition zones fruit and berry plantations and the last one 0 3 to 0 mainly landscapes with an open character such as farmland pastures and airports but also continuous urban fabrics and coniferous forests flight distances for ae j japonicus we are not aware of any published results of mark recapture experiments that would help to estimate the flight distances in certain landscapes and under certain weather conditions there is evidence that individuals in a perfect habitat do not fly long distances and hardly spread out which may explain the findings that larger contiguous forest areas sometimes act more as barriers than as corridors for a location in belgium a second hand tire company with a neighbouring small woodland no evidence of dispersion could be found even after 6 years although there are suitable stepping stones a settlement in direct connection as well as further woodlands and tree rows at distances of only a few hundred metres linear distance egizi et al 2016 also species of the genus aedes and especially the urban domestic container breeding species are known to be rather weak flyers verdonschot and besse lototskaya 2014 and no behaviour like that of long distance fliers was documented for ae j japonicus i e ascending high into the air immediately after adult emergence facilitating far wind drifts service 1980 an approximate indication of flight distances is given by a documentation of the spread of ae j japonicus in west germany north rhine westphalia kampen et al 2016 there an average dispersal of about 10km to 20km per year was recorded between 2012 and 2015 with some exceptions of up to 50km as it is known that ae j japonicus also spreads passively to a large extent especially along roads egizi et al 2016 we suggest that the exceptional dispersal rates exceeding 2km year are due to this cause as stated before the flight simulator only takes into account self motion of mosquitoes and no passive dispersal assuming that the annual main activity and thus the dispersal period is 200days year from mid march to mid october the maximum flight distances would range from 500m to 1km day evaluations of mark recapture experiments of various mosquito species show that most individuals remain at the site and the probability of recapture decreases with increasing distance verdonschot and besse lototskaya 2014 to the summarised data on ae albopictus which is also described as a weak flyer like ae j japonicus and which has similar habitat requirements we have fitted a normal distribution fig 4a to generate probabilities for the flight ranges of ae j japonicus super agents with medium flight motivation we did not consider a fat tail distribution as often used in dispersal modelling of e g pollen nathan et al 2012 since we do not model passive motions that would allow for increased long distance dispersal the data was divided by 100 before the fitting to convert the metres to map units the distribution has the mean value at zero and a standard deviation σ of 2 4 for super mosquitoes with low flight motivation we have reduced the standard deviation of the fitted normal distribution to 0 6 so that they rarely fly further than 100m or 200m and the probability of staying in the cell is relatively high fig 4b to determine the flight direction and next location of a low and medium motivated super mosquito on the grid map its flight range is randomly divided into two segments westward eastward and northward southward the direction taken in each case is determined by the algebraic sign of the randomly generated flight distance and by means of another random generator we assume that the mosquitoes fly longer distances in unsuitable habitats as they are not able to satisfy all their needs availability of breeding habitats host animals or shelter provided by vegetation therefore we implemented a random generator for the super mosquitoes in these habitats which generates equally distributed flight distances between 0 map units and 3 to 4 map units depending on wind conditions for westward eastward and the northward southward movements respectfully this results in a maximum flight distance of 424m 3 map units to 566m 4 map units per day when the super mosquito flies the direct route in a diagonal direction of the moore neighborhood various studies in wind tunnels and in the field show that mosquitoes are more likely to fly upwind than downwind kennedy 1940 midega et al 2012 endo and eltahir 2018 this is probably due to the appetising flights in which they follow smells that are transported by the wind verdonschot and besse lototskaya 2014 at wind speeds of 3km h and above however many species stop flying and seek shelter on the ground or in the vegetation service 1980 as stated above the poor mosquito habitats are mainly open landscapes offering limited protection so we assume that the influence of the wind is particularly noticeable in these using data from the surrounding weather stations of the study regions we analysed the main wind directions and found that for each region movement in a westerly and southerly direction would be more likely fig 5 hence we let the super mosquitoes fly up to 400m towards west and south and up to 300m towards north or east this results in a 1 3 times higher probability of a super mosquito flying in the direction with the stronger wind conditions 2 4 3 boundary effects we have implemented two options for the area boundaries of the study regions in open mode the super mosquitoes can leave the region and the loss is compensated by hatchings see section 2 4 5 of new super mosquitoes with the same infection status this mode merely prevents a potential mass accumulation at the edge of the study region in closed mode the super mosquitoes cannot leave the region an emigration attempt is registered and the cardinal point is saved on the first time however the flight is not executed and the super mosquito remains in its cell the distribution pattern hardly differs between the applications of both options we could not observe any mass accumulation of super mosquitoes at the borders in closed mode however the calculation time is significantly longer in the open mode so we will only apply the closed mode in this work 2 4 4 energy the super mosquitoes in the flight simulator have an energy level that causes them to die during long stays in unsuitable habitats or after covering large distances this makes large areas with unfavourable conditions to dispersion barriers it is known that long distance flights are highly energy consuming for mosquitoes verdonschot and besse lototskaya 2014 but we have no information about the distance covered by ae j japonicus under certain habitat conditions we thus adapted the energy control in a way that a significant reduction of the population can occur in region 1 but the population remains stable in regions 2 and 3 this is consistent with observations made in systematic monitorings koban et al 2019 kampen et al 2016 for the energy level of a super mosquito which can take on values between 1 and 100 we use the following balance equation 12 d e d t δ prev e δ const δ flight f b q where δ prev is the inverse time unit e is the energy on the previous time unit δ const is a constant energy loss per time unit δ flight is the energy loss per flight distance and time unit f is the euclidian flight distance between the start and destination cells the cells have a resolution of 100 100m2 so the distance is given in hectometres b is a boosting factor per time unit and q is the quality value of the new cell the quality values are between 0 and 1 and we handle them equivalent to energy units per time unit for the simulations we set δ prev 1 per time unit δ const 4 eu energy units per time unit δ flight 8 eu per time unit and flight distance and b 50 eu per time unit 2 4 5 control of all super mosquitoes to apply certain processes hatchings deaths to all super mosquitoes in the simulation we have drawn up two lists at a higher hierarchical level in the programme they contain the infectious and non infectious super mosquitoes with all their characteristics on this level we also count the number of super mosquitoes that have tried to leave the region and whether it was the first time hatching the hatching function is used for 3 different purposes firstly to locate the super mosquitoes on the first day of simulation spatial initialisation secondly when the seir model calculates an increase in mosquitoes compared to the previous day and thirdly when super mosquitoes have emigrated in open model mode and this loss is to be compensated by hatchings the super mosquitoes appear at random locations in the study area but preferably in patches with good habitat qualities the larvae are not represented in the spatial component for runtime reasons but the mosquitoes hatch in the larval breeding sites which are implemented based on the following considerations the greater the habitat suitability the more breeding sites should be available since the presence of these was one of the main considerations when preparing the habitat suitability map kerkow et al 2019 the breeding sites of ae j japonicus are water filled natural or artificial containers such as flower dishes cemetery vases wells or tree holes they are often not permanently present and filled with water so their location should be habitat related but also have a stochastic component furthermore breeding habitats may be located outside but close to actual main habitats to achieve this we have created copies from the habitat maps and reduced its spatial resolution to 500m 500m in the following we refer to 100m 100m units on the map as cells and larger areas measuring 500m 500m as patches the values of all individual habitat qualities within each 25ha patch were summed up and again scaled to values between 0 and 1 for each study region the super mosquitoes first hatch on the low resolution map a weighted random generator ensures higher hatching rates with increasingly better habitat suitability the super mosquitoes are then transferred back to the original map with 100m 100m resolution the allocation within each 25ha patch is random all newly hatched super mosquitoes start with the maximum energy level of 100 deaths if the temporal model component reduces the number of mosquitoes compared to the previous day this happens almost every day in autumn and if as a result the number of mosquitoes is lower than in the spatial component then the corresponding number of super mosquitoes in the respective infection stage is also removed from the spatial component the selection is random super mosquitoes that have died due to a loss of energy are already included in the comparison 2 4 6 observation for each time step the number of larvae the number of mosquitoes and birds in their respective infection states and the number of super mosquitoes that have emigrated open mode or tried to emigrate at least once closed mode in the respective directions see chap 2 4 3 can be displayed for this purpose the data are stored during the simulation furthermore the spatial distribution of all super mosquitoes and the infected super mosquitoes is stored in arrays using these we display i the movements of the mosquitoes during the entire simulation period in a video and ii the distribution of the super mosquitoes on the day with the highest infections in a single map 3 results as the composite model is not validated does not include all major wnv hosts and vectors and as the rate of blood meals on the host birds is unknown it can vary considerably from region to region the calculated amplitude of wnv case numbers in birds and the infection rate in mosquitoes is not yet reliable for the sake of completeness we have presented these results in the appendix the results of the spatial distributions of the ae j japonicus populations in late summer at the time when most infectious mosquitoes are present show that the super mosquitoes accumulate strongly in cells with very good habitat qualities values from 0 8 to 1 fig 6 the majority of these cells contain deciduous forests and human settlements in all 3 study regions see fig 2 in region 1 very poor and very good habitats are particularly strongly separated from each other fig 1a this enables to assess the spatial extent at which a dispersion barrier is effective the energy and flight distance settings resulted in the super mosquitoes moving a maximum of about 2km away from the very good habitats already at a distance of 1km the super mosquito density decreases rapidly as a result the area with the poor conditions in the centre was not a strong dispersion barrier but an area in the north east of the region remained super mosquito free throughout the simulation video s1 fig 6a also in region 2 many super mosquitoes are able to cross the area with poor habitat characteristics which extends from the north west to the centre and is mainly characterised by arable land video s2 fig 6b small towns and villages between the crop lands serve as stepping stones fig 2e the number of super mosquitoes being eliminated from the simulation during the entire simulation period due to low energy levels was about 228 700 53 600 and 134 200 for regions 1 2 and 3 respectively table 4 the reduction in total maximum mosquito population from applications of the linked model in 2018 compared to applications of the seir model without spatial extension was 9 82 in region 1 1 1 in region 2 and 0 05 in region 3 table 5 in region 1 repeated use of model applications resulted in a higher risk of infected super mosquitoes being prematurely removed from the simulation than in the regions 2 and 3 this is due to the large proportion of unfavourable habitats in region 1 the number of total emigration attempts is almost three times higher in region 3 and almost twice as high in region 2 than in region 1 however if only the first emigration attempts are considered the differences are smaller table 4 fig 6 in region 1 approximately the same number of super mosquitoes emigrate towards south and west during the entire simulation on the one hand these are the main wind directions in all study regions fig 5 and on the other hand more areas with high occurrence probabilities have intersections with the borders in the west and south of region 1 in region 2 about the same number of super mosquitoes made the first attempt to emigrate towards the north east and south much less good and very good mosquito habitats border the eastern edge of the region and only a third of the super mosquitoes tried to leave the region for the first time in this direction in region 3 there were about twice as many first attempts to emigrate towards the east and south as towards the north or west also here the result is related to the very good mosquito habitats located along the edge of the region and not to the main wind directions runtime the application of the coupled model to the year 2018 on a machine with an intel r core tm i7 4510u processor with 4cpu lasts 9min 20min and 28min for the 3 study regions respectively and a super mosquito factor of 100 without saving the arrays for each simulation day which serves to create the flight videos the runtime is reduced by about 3min with a super mosquito factor of 1 000 the runtime can be reduced even more to a maximum of 3min however with a factor of 10 the runtime is 6h 13min for region 1 1d 1h 47min for region 2 and 1d 6 h 22min for region 3 4 discussion we introduce the first compartment model for west nile virus which also simulates the abundance and movements of a vector mosquito species in a spatial extension and thus helps to estimate where virus hotspots could be located and towards which direction the virus is likely to be carried from a region by active flights of the mosquitoes the temporal component seir model is exploratory this means that the results are not yet validated the seir model was adapted to the conditions in central europe and a realistic size of the mosquito population originally the seir model was implemented for minneapolis in the us and validated with the number of detected dead sentinel birds laperriere et al 2011 the flight simulator is implemented on the basis of literature studies and we scaled it in such a way that population development data available for all three study regions could be reproduced 4 1 temporal model component validation of the results of our exploratory seir model applications is not possible because i the evidence of wnv rna in german wild bird populations is still very low ii it is uncertain whether the eurasian magpie is or will be a major vector in central europe iii there are very likely several bird and mosquito species that act as efficient hosts and vectors so the model should be extended to deal with this and iv there is still a lack of clarity about multiple factors that influence the vector competence of ae j japonicus this includes in particular the degree of ornitophily and the rate of blood meals on the corresponding host bird species furthermore we coupled the model components in such a way that poor habitat structures negatively affect mosquito populations thus the spatial model plausibly intervenes in the equations of the original seir model other uncertainties include that data on the virus incubation period among vector mosquitoes in relation to temperature is extremely limited and that the function used here is based solely on an experiment with cx tarsalis in addition the results of laboratory experiments on ae j japonicus to investigate the dissemination rate and transmission efficiency for wnv are not consistent while huber et al 2014 found resistance to infection in individuals from south west germany and could not identify co infections with other flavi viruses or the wolbachia bacterium of the mosquitoes which could bias the results veronesi et al 2018 were able to demonstrate dissemination rates of 15 6 for strain ny99 and 18 3 for fin in swiss individuals furthermore v the carrying capacity of ae j japonicus larvae in the study regions is only estimated based on a habitat map derived from a nested modelling approach kerkow et al 2019 and on a study indicating the larval abundance in an ideal habitat the habitat map however was not validated with abundance data but with occurrence data mainly derived from the citizen science project mueckenatlas walther and kampen 2017 a check of the correlation between abundance data from a systematic monitoring and of the different habitat qualities as performed for example in the studies of mushinzimana et al 2006 and chaves and moji 2017 is therefore an important project for the future there are additional factors that may play a role in the development of a wnv epizootic that we have not considered to focus on the essential factors and to not excessively modify the evaluated seir baseline model first the development of the mosquito population in the model is dependent on the carrying capacity of the larvae temperature dependent hatching and death rates and the proportion of non diapausing mosquitoes as a function of the season in fact winter frosts reuss et al 2018 and precipitation chianese et al 2019 also affect population development moreover there is evidence that some species of mammals and amphibians e g squirrels rabbits and frogs are also susceptible to wnv infection and develop high levels of viraemia this way of transmission however is supposed to play only a minor role chancey et al 2015 the model neglects vertical transmission paths for mosquitoes and horizontal paths for host birds however there are indications for vertical trans ovarian transmissions in different species of the culex genus the transmission efficiency can vary between 10 to 40 nelms et al 2013 it is also assumed that vertically infected mosquitoes facilitate the hibernation of the virus in many regions calistri et al 2010 ciota 2017 dohm et al 2002 nelms et al 2013 however no published results are yet available indicating vertical transmission of wnv in ae j japonicus birds can become infected horizontally through consumption of infected birds of prey feather picking and oral contact with the faeces of other birds horizontal transmission in birds could play a major role it is suspected to be the reason why birds of prey and feather pickers such as crows and hawks become infected in nature frequently komar et al 2003 yaremych et al 2004 pérez ramírez et al 2014 scenario analyses to investigate the effects of different trans ovarian transmission rates in mosquitoes and horizontal transmission rates in birds remain an important future task for disease modellers but adjustments can easily be made in the seir model the influence of infections of the birds and mosquitoes with other pathogens is also neglected in our model however the susceptibility of host birds may be affected by previous infections with viruses from the group of japanese encephalitis viruses which includes the usutu virus occurring in germany pérez ramírez et al 2014 the vector competence of the mosquitoes as well as population size and sex ratio can also be influenced by cross infection with the bacterium wolbachia pipientis ciota 2017 gao et al 2020 4 2 spatial model component the flight simulator can predict the locations of mosquito hotspots within a region as well as dispersion barriers and stepping stones for potentially infected mosquitoes of the species ae j japonicus the flight simulations can also be used to assess how efficiently the virus can spread from a region to the respective cardinal points through active flights of the mosquitoes this is useful after a sudden local introduction of the virus as it was the case in 2018 in some places in germany as the model is freely available and based on free software it can be adapted to new research results and applied to other regions as mentioned in chapter 4 1 the model needs to be extended for other vector mosquito species we have implemented the flight simulator for the japanese bush mosquito ae j japonicus since there are yet no comparable high resolution habitat maps for germany available for other vector species like cx pipiens further species of the culex agg or ae vexans although numerous studies provide information on the propagation speed of the invasive japanese bush mosquito damiens et al 2014 seidel et al 2016 egizi et al 2016 kampen et al 2016 montarsi et al 2019 it is not possible to determine the extent of the influence of passive propagation by traffic in any of the observations studies suggest that ae j japonicus and other invasive species of the genus aedes spread over longer distances by means of transport egizi et al 2016 eritja et al 2017 however in our model we have concentrated on the active spread of the mosquito one reason for this is that transport assisted dispersal must involve different control measures than dispersal away from transport routes by the self motion of mosquitoes on the other hand there are already models that estimate long distance spreads of the virus by birds maidana and yang 2008 2009 or a combination of long distance spread by both birds and mosquitoes liu et al 2006 the flight simulator is implemented as an agent based model abms are computationally intensive and therefore not well suited to deal with large numbers of individuals such as millions of mosquitoes in our case however by bundling several mosquitoes into super mosquitoes we were able to bring the run times into an acceptable range of only several minutes with a super mosquito factor of 1 000 the other side of agent models is that they can be extended in many ways thus additional host bird and vector mosquito species each with different virus transmission characteristics could be added in the future resulting in a multi agent model 5 conclusions we have adapted a wnv compartment susceptible exposed infectious removed model for both a potential host bird and vector mosquito species pica pica and aedes japonicus japonicus occurring in germany and coupled it with a flight simulator for the vector mosquitoes the flight simulator is an agent based model built on a habitat map for the mosquito species being invasive in germany data on local temperature and wind conditions and studies on the flight behaviour of this and other mosquito species the spatial extension of the seir model is the first step in developing a tool that can estimate for a region i whether an epizootic can emerge after virus introduction ii how large the vector mosquito population is and iii where vector mosquito hot spots dispersal corridors stepping stones and barriers are located in addition iv the model can calculate the probability of infectious mosquitoes leaving the region in the respective cardinal directions the model extension is not only a visualisation tool but also intervenes in the differential equations of the seir model this applies in particular to regions with few suitable habitats where the potential size of the mosquito population is reduced on a daily basis as a result of long flight distances since many bird and mosquito species are hosts and vectors of west nile virus the current version of the model cannot yet reliably determine the extent of an epizootic in a next step it must be expanded to include other important bird and mosquito species with their respective life trait parameters virus incubation times transmission rates and so forth moreover we plan to extend the model further so that the coupled model can run in parallel for many somewhat smaller patches with presumably different numbers of host birds the spatially extended wnv model implemented in python 3 7 is freely available under the creative commons attribution non commercial 4 0 https github com akerkow bush mosquito flight simulator and a tool aimed at modellers involved in planning control measures for wnv vector mosquitoes it is particularly useful for applications in regions where the virus has been recently introduced for model applications we recommend selecting the size of the study area to cover the territories of the host birds surrounding the reported wnv cases local ornithologists may be consulted to assist with this it would also be advantageous if blood meal data were available for the relevant mosquito species for the region under study credit authorship contribution statement antje kerkow conception of the study conducted the literature research designed the model analysed and interpreted the model results drafted the manuscript ralf wieland designed the model critically revised the manuscript jörn m gethmann contributed parasitological and epidemiological expert knowledge critically revised the manuscript franz hölker contributed expert knowledge for the conception of agent based models critically revised the manuscript hartmut h k lentz supported the data analyses critically revised the manuscript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper funding this work was supported by the federal ministry of food and agriculture germany bmel grant no 2819105315 and the ministry of science research and culture of the federal state of brandenburg mwfk germany appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ecolmodel 2021 109840 appendix a supplementary data the following is the supplementary material related to this article contains additional equations figures and explanations video s1 2d flight simulations of female super mosquitoes n 10 at all stages of infection in study region 1 video s2 2d flight simulations of female super mosquitoes n 10 at all stages of infection in study region 2 video s3 2d flight simulations of female super mosquitoes n 10 at all stages of infection in study region 3 video s4 2d flight simulations of infectious super mosquitoes n 10 in study region 1 video s5 2d flight simulations of infectious super mosquitoes n 10 in study region 2 video s6 2d flight simulations of infectious super mosquitoes n 10 in study region 3 mmc s7 
24516,simulating the population dynamics of a stage structured population requires the knowledge of development mortality and fecundity rate functions characterizing the species in general development and fecundity can satisfactorily be estimated starting from literature data unfortunately this is often not the case for the mortality function due to the lack of experimental data to overcome this problem we estimate the mortality rate function from field data on the abundance of the species the mortality is expressed as a linear combination of cubic splines and the estimation method allows to determine its coefficients taking into account the observations measurement error moreover the variability in the estimate is quantified using the confidence bands for both mortality and dynamics the presented method allows obtaining a more flexible shape for the mortality rate functions compared with previous methods applied to the same pest the method has been applied to the case of lobesia botrana the main pest in the european vineyards with abundance data collected for five consecutive years in an experimental field in the north of italy data collected over three years are used to estimate the mortality and to analyse the variability in the estimate and its effects on the population dynamics while the other two datasets are used to validate the model simulating the dynamics using the estimated mortality keywords stage structured population physiologically based demographic model mortality estimate population abundance time series lobesia botrana 1 introduction population dynamics models play an important role in pest control predictive information of the temporal dynamics of a pest population can help decision makers in the choice of the best strategy in terms of the application of phytosanitary treatments this is a fundamental task in light of the directive 2009 128 ec on the sustainable use of pesticides in europe to realistically describe the population dynamics of a pest it is necessary to take into account climatic factors phenology of the plant and in general physical biological characteristics of the environment in the site of interest all these factors affect the biology of the species mathematically described by biodemographic functions namely development mortality and reproduction rate functions the dynamics of the species can be represented by mechanistic models that allow describing the physiological response of the species to environmental driving variables these models are known as physiologically based models gutierrez 1996 and describe the species life history through the biodemographic functions each individual of the population is characterized by a physiological age which is a biometric descriptor of its development physiologically based models allow representing a non linear relationship between environmental drivers and physiological processes describing the population dynamics capture processes at different trophic levels and supply predictions on pest population dynamics taking into account biological and ecological variability especially when combined with weather forecasts they can be used to predict the population dynamics phenology and distribution of a pest model outputs can guide farmers in the rational use of pesticides for these reasons and in particular for the ability to provide information on the dynamics and the phenology of a species they are important tools to support integrated pest management gutierrez et al 2012 gutierrez and wilson 1989 sporleder et al 2009 physiologically based models can be used to predict both the cumulated emergence of individuals in the different stages phenological models and the population abundance over time demographic models phenological models can be applied starting from a fixed initial condition considering development rate functions only but also mortality and fecundity rate functions can be introduced effects of mortality and fecundity rate functions in phenological models are discussed in pasquali et al 2019 physiologically based demographic models pbdms allow predicting population abundance over time taking into account the environmental variables influencing the dynamics of a species these mechanistic models have been used for a long time see for instance de wit and goudriaan 1974 gutierrez et al 1975 mcdonald et al 1989 and wang et al 1977 the life cycle of an insect is characterized by several immature stages and one adult reproductive stage each developmental stage responds in different ways with respect to biotic and abiotic driver most of the pests are dangerous for the crop only in a particular phase of their lifecycle then it is often useful to consider the population organized in stages through the so called stage structured population models cushing 1998 iannelli 1994 iannelli and milner 2010 each stage is characterized by development and mortality rate functions while the adult stage is defined also through a reproductive function pbdms have been widely used in the last years to describe pest population dynamics for stage structured populations ainseba et al 2011 blum et al 2018 ewing et al 2016 gilioli et al 2016 2017 2014 marini et al 2016 metz and diekmann 1986 pasquali et al 2020 rossini et al 2020 here we consider a physiologically based demographic model for a stage structured population described by a system of partial differential equations which is a particular case of a more general stage structured population model presented in buffoni and pasquali 2007 the output of the model is the abundance of the population in each stage in time and physiological age defined as the percentage of development within a stage it is based on stage specific biodemographic functions dependent on environmental variables mainly temperature a reliable estimate of the biodemographic functions allows obtaining a reliable model for population dynamics in general these rate functions are estimated starting from literature data on the biology of the species for instance temperature dependent duration within a stage for the development function number of eggs produced by an adult female at different temperatures for the fecundity function starting from these data a simple least square method allows estimating the parameters of a biodemographic function of a given functional form unfortunately data for the estimation of the mortality functions are often lacking in the literature in this case different methods of estimation can be applied see for instance wood and nisbet 2013 for a survey of mortality estimation methods when laboratory data on the mortality rate are not available the mortality estimate can rely on the knowledge of time series data on population dynamics different methods to estimate mortality starting from population dynamics time series data have been proposed in the last years ellner et al 2002 proposed a non parametric regression model picart and ainseba 2011 solved the problem using a numerical analysis based on a quasi newton method in gilioli et al 2016 a method based on least squares was presented while in lanzarone et al 2017 a bayesian estimation method was described in the last two approaches a functional form for the mortality is required and the estimate concerns only parameters appearing in these functions in particular the authors introduced mortality composed of two terms an intrinsic temperature dependent abiotic mortality depending on the development rate function and a constant generation dependent extrinsic mortality likely related to external natural control factors to be estimated using time series field data on the population dynamics ainseba et al 2011 also proposed mortality rate functions of a known form depending on both environmental variables and age assuming the mortality of a known functional form can be restrictive in some cases where having more flexibility for the behavior of the mortality rate function with respect to the temperature is preferable we decided to follow the approach proposed by wood 2001 which does not require a functional form but rather expresses the mortality as a linear combination of elements of a suitable basis the parameter vector containing the coefficient of the linear combination is estimated by minimizing a weighted least squares term that measures the distance between the simulated and the observed population abundance different weights can be considered for the various stages of the population and or for the various generations here differently from wood 2001 we modify the functional to be minimized to take into account the measurement error typical of field observations the new objective is to minimize the sum of the weighted distance between the simulated abundance and the observations range of variability furthermore also the variability in the mortality estimates has been taken into account and leads to variability in the population dynamics both quantified through confidence bands since the estimator of the parameter vector is a random variable confidence bands are obtained by drawing a certain number of values for the parameter vector from its distribution the mortality estimation method is applied to the case study of the grape berry moth lobesia botrana which is considered one of the most dangerous pests in european vineyards the description of the population dynamics of the grape berry moth has been widely studied in the past ainseba et al 2011 baumgärtner and baronio 1988 gutierrez et al 2012 gilioli et al 2016 in our study we consider four developmental stages for l botrana population eggs larvae pupae and adults to check the convergence of the estimation method we initially consider the case of population abundances simulated by the model more precisely we fix the mortality rate functions of the different stages in particular we consider artificial mortalities with a bathtub shape and generate the abundances in all the stages from the population dynamics model obtained with these mortalities and the known development and fecundity rate functions when we apply the estimation method starting from the simulated abundances we correctly reconstruct the mortality rate functions which means that the estimation procedure is suitable for obtaining a reliable approximation of the mortality rate functions then the method is applied to a field case data on population abundances for all the stages of the grape berry moth have been collected in colognola ai colli verona italy in the period 2008 2012 for the cultivar garganega the dataset is split into two groups population abundances of years 2008 2009 and 2011 are used to estimate the mortality while data of 2010 and 2012 are used to validate the model the proposed method allows knowing the behavior of the mortality rates as a function of the temperature since the grape berry moth is dangerous only in its larval stage it is useful to assign a higher weight to this stage when considering the least square term in the estimation procedure in this way we aim to obtain better estimates for the abundances of the larvae than for the other stages this can be useful to the end of grape berry moth control in vineyards picart et al 2011 picart and milner 2014 picart et al 2015 because a finer approximation of the number of larvae in the field allows better defining the timing of application of control treatments against the stage the population dynamics model with the estimated mortalities can be used to forecast the pest abundance furthermore the estimated mortality rate functions as the other biodemographic functions represent the physiological responses of the species and thus they are independent from the context of application moreover since the estimation method here described is sufficiently general it can also be applied to other stage structured populations the paper is organized as follows in section 2 the mathematical model describing the dynamics of the population is presented while in section 3 the biodemographic functions of the grape berry moth are specified section 4 describes the mortality estimation method and the method to determine the confidence bands in section 5 the estimation method is applied to the grape berry moth for both the case of simulated data and field data finally section 6 is devoted to discussion and concluding remarks the matlab code implementing the mortality estimation method can be found on github pasquali and soresina 2021 2 the mathematical model the demographic model is based on a system of partial differential equations that allows to obtain the temporal dynamics of the stage structured population and their distribution over physiological age within each stage let ϕ i t x d x number of individuals in stage i at time t with physiological age in x x d x for i 1 2 s where s is the number of stages stages from 1 to s 1 are immature stages and stage s represents the reproductive stage adult individuals note that t denotes the chronological time while x represents the physiological age indicating the percentage of development within the stage over time buffoni and pasquali 2007 2010 2013 di cola et al 1999 instead of a deterministic setting in which the population dynamics is described through von foerster equations buffoni and pasquali 2007 we prefer to consider a stochastic approach that allows taking into account the variability of the development rate among the individuals buffoni and pasquali 2010 2013 the dynamics is described in terms of the forward kolmogorov equations gardiner 1986 carpi and di cola 1988 1 ϕ i t x v i t ϕ i σ i ϕ i x m i t ϕ i 0 t t 0 x 0 1 2 v i t ϕ i t x σ i ϕ i x x 0 f i t 3 σ i ϕ i x x 1 0 4 ϕ i t 0 x ϕ ˆ i x where i 1 2 s v i t and m i t are the stage specific development and mortality rates respectively assumed to be independent of the age x ϕ ˆ i x are the initial conditions namely the initial distributions of the individuals with respect to the physiological age while σ i are constant diffusion coefficients the boundary condition at x 0 assigns the input flux into stage i while the boundary condition at x 1 means that the output flux from stage i is due only to the advective component v i t ϕ i t 1 buffoni and pasquali 2007 moreover the fluxes f i t in the boundary conditions 2 are evaluated as follows the term f 1 t is the eggs production flux and is given by 5 f 1 t v s t 0 1 β t x ϕ s t x d x where v s t β t x is the fertility rate in particular we consider 6 v s t β t x b t f x e g g s a d u l t f e m a l e s w i t h a g e i n x x d x t i m e u n i t where b t takes into account the effect due to both diet and temperature and f x is the oviposition profile the other terms f i t when i 1 are the individual fluxes from stage i 1 to stage i and are given by 7 f i t v i 1 t ϕ i 1 t 1 i 1 the functions ϕ i t x allow to obtain the number of individuals in stage i at time t n i t 0 1 ϕ i t x d x system 1 4 requires an explicit formulation depending on a certain number of parameters of basic biodemographic rate functions development fecundity and mortality that models the physiological response of individuals to environmental forcing variables for the grape berry moth as for all the ectotherms the temperature is one of the main driving variables influencing individuals physiological responses then these biodemographic rate functions are formulated in terms of temperature which depends on the chronological time it is also possible to take into account the dependence on other environmental variables schmidt et al 2003 3 biodemografic functions for lobesia botrana lobesia botrana has a stage structured population generally considered composed of four stages eggs larvae pupae and adults s 4 each stage is characterized by its own biodemographic functions development mortality and only for adults fecundity we suppose that development and mortality rate functions depend on time only through temperature while the fecundity rate function depends also on the physiological age as done in gilioli et al 2016 in particular in this paper we consider the same development rate functions estimated in gilioli et al 2016 while for the fecundity rate function we use the function b t estimated in gilioli et al 2016 but a different expression for the oviposition profile f x appearing in 6 experimental laboratory data are used to estimate developmental and fecundity rates average duration in a stage at different temperatures for development and the average number of eggs produced by a reproductive female at different temperatures and physiological ages for fecundity on the contrary mortality rates are very difficult to measure due to continuous reproduction and partially overlapping generations manly 1989 gilioli et al 2016 then to estimate mortality rate functions we rely on the observed abundances for all four stages of the l botrana population using a modified version of the method proposed by wood 2001 for formulating and fitting partially specified models 3 1 development rate function the development rate function v t appearing in 1 describes the development rate as a function of time through temperature typically there is no development below a low temperature threshold while the development rate increases and reaches a maximum at an optimal temperature and then it declines rapidly approaching zero at a thermal maximum namely the temperature at which life processes can no longer be maintained for prolonged periods of time logan et al 1976 several functional expressions have been proposed in the literature to describe development kontodimas et al 2004 here as in gilioli et al 2016 we consider a lactin function lactin et al 1995 to represent the development of all the stages 8 v i t δ i max 0 e α i t t e α i t m t m t t β i γ i where t m 36 c is the thermal maximum α i is the slope parameter describing the acceleration of the function from the low temperature threshold to the optimal temperature β i is the width of the high temperature decline zone γ i is a parameter that allows the curve to intersect the abscissa giving a minimum temperature of development and δ i is a coefficient of amplification of the curve parameters of the development rate functions are estimated by means of a least square method in gilioli et al 2016 using the datasets in baumgärtner and baronio 1988 and brière and pracros 1998 and are reported in table 1 3 2 fecundity rate function as assumed in 6 eggs production depends both on the physiological age of the adults and on the chronological time through temperature and phenological stage of the host plant as environmental variables the oviposition profile f x in eq 6 as function of the physiological age x is assumed to be of the functional form f x a x r 1 exp c x where the parameters a r c are usually estimated from experimental data in particular the number of eggs produced by a female at different physiological ages this class of functions reproducing the shape of a gamma distribution is sufficiently general to allow the shift of the peak of fecundity in all values of the physiological age interval i e different sets of parameters a r c shift the maximum production of eggs from low physiological ages to high physiological ages the term b t in eq 6 takes into account the influence of environmental variables temperature t t and phenological stage of the plant p t varying with the chronological time it is expressed by the product gilioli et al 2016 gutierrez et al 2012 b t b 0 p t a 0 t t where b 0 is a step function indicating the insect diet changing over time due to the plant maturation process and a 0 t 1 t t l t 0 t 0 2 captures the effect of temperature the parameter t l indicates the minimum temperature of reproduction while t 0 the half width of the temperature reproduction interval regarding the case study of l botrana the parameters appearing in the function f x of the fecundity rate are obtained by fitting the corresponding oviposition profile in baumgärtner and baronio 1988 suitably converted as a function of the physiological age in particular we rescale the fecundity rate function by assuming that physiological age 1 corresponds to 400 degree days in figure iii of baumgärtner and baronio 1988 then the estimated parameters are a 74270 r 4 06 c 15 33 the values appearing in the function a 0 t already obtained in gilioli et al 2016 and gutierrez et al 2012 and here reported for the reader s convenience are t l 17 c t 0 7 5 c the product f x a 0 t eggs femaleday 1 as a function of temperature c and physiological age x is illustrated in fig 1 function b 0 p t which depends on the phenological age p of the plant expressed in terms of bbch scale lorenz et al 1994 is a step function with steps at the bbch stages indicated in table 2 gutierrez et al 2012 3 3 mortality rate function since mortality rates are very difficult to measure the functional form of the mortality rate m t cannot be easily determined as the development and the fecundity rate functions in this paper we consider the mortality m t as unknown and we apply a modified version of the estimation method proposed by wood 2001 for formulating and fitting partially specified models thanks to this approach the obtained mortality carries out both extrinsic and intrinsic mortality factors see gilioli et al 2016 moreover since we want to estimate the mortality rates without assuming a specific functional form for them we do not specify an analytical expression but only consider some biologically meaningful hypotheses the mortality rate depends on the chronological time through temperature the mortality rate is a non negative continuous function of temperature the mortality rate is strictly positive at two reference temperatures these assumptions will constitute the constraints on the shape of the mortality rates in the sequel 4 estimation of the mortality rate function the estimation method of the mortality rate functions here presented allows dealing with mortality of unknown form guaranteeing more flexibility for its shape than in gilioli et al 2016 to apply this method we need a dataset of observations of the abundance of the different stages over time the abundances are collected in the field at different frequencies for example weekly and can concern all the stages or only some stages these observations are subject to a measurement error depending on the stage because measuring the abundance of a stage might be trickier than for others for this reason we want the estimation method from field data to be flexible enough to incorporate such measurement errors 4 1 the estimation method we consider system 1 4 in which the development functions and the fecundity function are chosen as stated in the previous section and the mortality rates are unspecified we want to find the mortality functions m i t i 1 s that result in the best fit of the model to field data of populations densities for the observed stages once the biodemographic functions are fixed system 1 4 can be numerically solved and produce a vector of model estimates μ representing the population abundances calculated at the same times of the observations y usually observations are affected by errors in particular in our case study it is very difficult to detect insects in some stages of their life meaning that the observations namely the field data could underestimate the real abundances we denote by u the vector representing the measurement error then we expect the real abundances included in the interval y y u the goodness of the fit can be quantitatively measured as a weighted sum of squared distance of each observation y k from the interval y k y k u k k 1 d max 0 y k μ k w k y k u k μ k where d is the number of data obtained as the sum of the number of observations for all the stages and w k are the weights associated with each measurement then the best fitting functions m i are those which minimize this quantity the unknown functions m i can be expressed as linear combination of elements of a suitable basis ξ i j t i 1 s j 1 n i for instance a polynomial or cubic spline basis m i t j 1 n i p i j ξ i j t thanks to this choice the mortality is then very general and it is not limited to a fixed form the problem of finding the best fitting functions m i is reduced to finding under some constraints the best fitting parameters p i j i 1 s j 1 n i collected into the vector p p 11 p 1 n 1 p s n s t which produces the model estimates μ p the total number of parameters in vector p is denoted as n p n 1 n s then our objective is to minimize q p k 1 d max 0 y k μ k p w k y k u k μ k p the procedure which leads to an estimates of the coefficients p is the following 1 given an initial guess of the model parameter vector p denoted by p g the model equations are numerically solved and model estimates μ are obtained 2 by repeatedly solving the model with slight changes in parameters we obtain an estimate of the d n p matrix j where j i j μ i p j we use the approximation j i j μ i p g δ j e j μ i p g δ j e j 2 δ j where δ j is a small number and e j are vectors of the canonical basis 3 the quantity μ and j are used to construct a quadratic model of the fitting objective as a functional of p q p k 1 d max 0 y ˆ k h 1 n p j k h p h w k y ˆ k u k h 1 n p j k h p h where y ˆ k y k μ k p g h 1 n p j k h p h g 4 we find the new direction to modify p g minimizing with respect to p the quadratic model of the real fitting objective q p together with the constraints a new value of the parameter vector p g is found 5 with the new value p g we iterate steps 1 4 to convergence obtaining the estimate p it is worthwhile to note that even though this procedure follows the method proposed in wood 2001 the quadratic functional to be minimized has been suitably modified to take into account the measurement error in the observations 4 2 confidence bands in addition to the uncertainty on the collected data the estimation procedure itself produces variability in the mortality rate functions to account for this effect we consider confidence bands for both the mortality rate functions and the population dynamics to this end we observe that denoting by p ˆ argmin p q p the estimator the parameter covariance matrix is given by marsili libelli et al 2003 9 c j p ˆ q p ˆ d n p j t w 1 j 1 for large samples p ˆ has approximately a multivariate normal distribution with mean p and covariance matrix c j p wood 2001 since the multivariate normal distribution does not ensure non negative mortality rate functions we introduce a more restrictive constraint drawing the parameter from a truncated multivariate normal distribution we draw a certain number of values of the parameter vector corresponding to different mortality functions used to obtain confidence bands for mortality then we run the model for all the mortalities to determine the confidence bands for the population dynamics 5 the case of l botrana to estimate the mortality rate functions of the grape berry moth we need abundance data we consider two cases in section 5 1 we generate from model 1 4 a dataset of abundances for the four stages of the grape berry moth to check the convergence of the estimation method then we consider the same dataset used in gilioli et al 2016 concerning the dynamics of the grape berry moth in a vineyard of garganega located in colognola ai colli verona veneto region in the north east of italy during the time frame 2008 2012 the experimental field was not treated with pesticides the abundances have been sampled weekly for eggs larvae pupae and adults adult males were detected using pheromone traps while immature stages were counted on samples of 100 bunches for a more detailed description of the data collection see gilioli et al 2016 to estimate the mortality rates functions we used the field data collected at colognola ai colli during the three years 2008 2009 and 2011 section 5 2 data collected during the other two years 2010 and 2012 were used to validate the model section 5 3 keeping all the other parameters of development and fecundity fixed in both cases development and fecundity rate functions are those defined in section 3 and the values of the diffusion coefficients are set σ i 0 0001 i 1 2 3 4 as in gilioli et al 2016 and lanzarone et al 2017 to make the comparison with the other approaches easier hourly temperature data collected by a meteorological station close to the vineyard are used as a driver environmental variable for the model simulation the times at which the phenological stage of the plant p t reaches the bbchs reported in table 2 vary over the years they are reported in table 3 for the vineyard of garganega located in colognola ai colli for the years 2008 2012 it is also important to take into account that observed abundances are subject to a measurement error depending on the stage for instance it is very difficult to detect eggs and pupae in fact to count first generation eggs it is necessary to pick up small grape bunches and to analyse them in a laboratory using a stereomicroscope for the other generations a magnifying glass is used to observe bunches in the field and this operation requires particular attention from the third generation pupae are under the rhytidome while second generation pupae can be hidden either in the grape berries or under the rhytidome making the detection of this stage particularly difficult then based on the experience of one of the authors in collecting data in vineyards for eggs and pupae we consider a measurement error up to 50 of the collected abundance larvae are more visible due to the damage they produce then we suppose to have a measurement error of up to 10 for this stage these assumptions about measurement error are based on field observations in our specific case adults males are caught with pheromone traps then we assume they are correctly measured the sex ratio is assumed to be 0 5 as in gutierrez et al 2012 therefore the number of males caught in traps is equal to the number of adult females moreover we consider a population composed only of females responsible for reproduction the mortality rate functions are expressed as linear combination of cubic b splines the basis is built on the nodes 0 20 40 being 0 40 a suitable interval of temperature and hence it consists in five polynomials ξ j t t j 1 5 defined on this interval the mortality rates function are m i t t j 1 5 p i j ξ j t t i 1 4 the constraint minimization of q p fourth point of the estimation method explained in section 4 1 has been carried out using the fmincon matlab routine in this setting it is possible to include the constraints on the mortality rates stated in section 3 3 as linear inequalities involving the parameters p i j 5 1 method validation to check the convergence of the estimation method described in the previous subsection we need a dataset obtained from known biodemographic functions then we generate data of population abundance for three years using the available hourly temperatures in colognola ai colli for the years 2008 2009 2011 we run the model 1 4 using the development and fecundity rate functions defined in section 3 with an initial condition of 100 adults with physiological age 0 at may 1st and the artificial mortality rate functions represented with red lines in fig 2 which have a bathtub shape realistic for a mortality rate function we pick a value of abundance every 10 days for all the stages starting from may 1st up to the end of the year to reproduce the measurement error for each abundance we draw a value u from a uniform distribution over the interval 0 0 5 for eggs and pupae and over the interval 0 0 1 for the larvae and multiply the abundances by 1 u obtaining the underestimated population abundances to avoid confusion with the field case these data are referred to as artificial observations and will be used in the estimation procedure to check the convergence of the estimation method proposed the measurement error also defines the interval of the variability of the artificial observations we apply the estimation method considering equal weights for all the data we have to minimize the sum of the weighted squared differences q p between simulated dynamics and artificial observations for all three years 2008 2009 2011 more precisely the number of artificial observations will be d d 2008 d 2009 d 2011 where d y is the number of artificial observations generated for the year y intended as the sum of the observations for all the stages applying the method described in section 4 1 we obtain the estimated mortality reported in fig 2 with a blue continuous line it can be seen that the estimated mortalities well approximate the artificial mortalities with bathtub shape used to generate data red dashed lines in particular in the central part of the temperature interval for low and high values of temperatures some differences between the two curves can be observed due to the scarcity of artificial observations for these temperatures which are unlikely in the temperature dataset used here however looking at fig 3 it is evident that these differences do not produce significant variations between simulated population dynamics and artificial observations because indeed low and high temperatures are very unlikely in temperate regions such as colognola ai colli in the period may september the simulated dynamics for immature stages denoted with a continuous blue line in fig 3 almost perfectly fit the artificial observations meaning that the simulated trajectories cross nearly all the intervals of variability of the artificial observations represented by the vertical red intervals in fig 3 this result shows that the algorithm can provide a reliable approximation of the mortality functions and can be usefully applied to the case of field data we remark that in this case we do not report the confidence bands for mortality rate functions and population dynamics because they are extremely thin in both cases 5 2 model calibration in the case of field data we must collect information on the population densities at the beginning of the season to drive the simulation during the entire growing season in our study the number of adults caught by pheromone traps at the first collection date in the favourable season is used as the initial condition of the model then as done in gilioli et al 2016 to avoid the extinction of the population due to a period of low temperatures additional inputs are introduced into the system every week on the adults caught by the traps until the first larvae of the first generation are observed as in the previous case we have to minimize the sum of the weighted squared differences q p between simulated dynamics and observations for all three years 2008 2009 2011 with d d 2008 d 2009 d 2011 total observations as an initial guess for the estimation algorithm we used a linear combination of cubic b splines that approximate the mortality rates already used in gilioli et al 2016 in the case of field data we do not consider equal weight for all the stages but we assign a higher weight to the larval stage this choice relies on the harmfulness of the larvae that in second generation cause severe damage to the grapes pavan et al 1998 pavan and sbrissa 1994 then it is important to obtain a reliable forecast of the larval abundance in particular to the end of pest control moreover data collected on larvae are more reliable than for the other stages for all these reasons the weights assigned to larval observations are one hundred times the weights of the observations assigned to the other stages to account for the effect of the variability in the parameters estimates we consider the confidence bands for both the mortality rate functions and the grape berry moth dynamics in particular we know that the probability distribution of the parameter p ˆ can be approximated by a multivariate normal distribution with mean p and covariance matrix 9 we draw 500 realizations of the vector parameter from this distribution that correspond to 500 mortalities for each stage expressed as max 0 j 1 7 p i j ξ i j t because they cannot be negative the 95 confidence bands of the mortality rate functions are obtained from these 500 mortalities using the matlab routine prctile to see the effects of the mortality variability in the population dynamics we run the model for the 500 mortalities computed to obtain the mortality confidence bands and then we determine the population dynamics bands the mortality rate functions obtained in the case of field data and the relative 95 confidence bands are represented in fig 4 it can be observed that confidence bands are tight in the central part of the temperature interval that is when temperatures are favourable to the pest growth this is due to the fact that the temperature datasets here considered contains mainly temperatures between 10 and 35 c allowing us to obtain a better estimate in this temperature range conversely they are largely outside this range which corresponds to unlikely temperatures when no data or few data on population abundance are available then there is more uncertainty in estimating mortalities outside the temperature interval 10 c 35 c and consequently the confidence bands will be larger moreover if a long period of very low temperatures is considered the population extinct making uncertain the mortality estimate in this case the estimated mortalities blue lines in fig 4 but especially the upper bounds of the confidence bands namely the upper bounds of the grey areas show for almost all stages an increase for both increasing and decreasing temperatures in particular the upper bounds of the grey areas present a bathtub shape realistic for a mortality function this behavior for extreme temperatures is in accordance with the mortality proposed in gilioli et al 2016 where second order degree polynomials were used to describe mortality for low and high temperatures in the central part of the temperature interval approximately between 10 c and 35 c mortality has lower values in line with the high survival obtained by brière and pracros 1998 the estimated larval mortality blue line is almost vanishing between 0 and 27 c but for cold temperatures it is compensated by high mortalities for the other three stages which instead have low mortalities for temperatures approaching 40 c however the large variability outside the interval 10 c 35 c makes the estimated mortalities highly uncertain allowing for low survival at extreme temperatures as reported by brière and pracros 1998 as in the previous case of artificial observations generated from system 1 4 the variability in the mortality for high and low temperatures does not negatively affect the dynamics of the pest because in the period considered here between mid april and the end of september temperatures outside the interval 10 c 35 c occasionally occur and therefore the mortality values corresponding to these temperatures occur only a few times the pest dynamics for the immature stages are reported in fig 5 we omit the adult stage because adults are sampled differently than immature stages and moreover they do not cause direct damage to plants the fit of the immature stages is satisfactory also taking into account the large measurement error we have considered to quantify the distance between the simulated dynamics and the observed abundance interval of variability we consider the normalized root mean square error nrmse related to the stage i and year y defined as 10 nrmse y i 1 max y y i min y y i k 1 d y i max 0 y k μ k p y k u k μ k p 2 d y i where y y i denotes the vector of observations in year y for the stage i of length d y i the computed nrmse for the immature stages in the years 2008 2009 and 2011 are reported in table 4 as expected population dynamics obtained considering a mortality function estimated with a higher weight for larvae present a better fit for the larval stage than for the other stages as indicated in table 4 by the mean of the nrmses over the years we also observe that the means of the nrmse here obtained are lower than those computed for the model in gilioli et al 2016 respectively 0 9455 for eggs 0 3062 for larvae 0 406 for pupae intended as the distance between the simulated and the observed abundances moreover taking into account the uncertainty in the estimates looking at fig 5 we observe that for all the three considered years the confidence bands for the larval stage include the majority of the observed abundance intervals of variability or cross these intervals for eggs and pupae only in some cases the observed values fall in the 95 confidence bands but the estimated dynamics allow to obtain values for larvae not far from the observed abundance intervals of variability see values of nrmses in table 4 the confidence bands of the simulated dynamics are particularly large near to the peaks of the dynamics namely there is higher uncertainty in the estimates of maximum population abundances especially for the larval stage with an impact on pest management strategies 5 3 model validation the datasets recorded in colognola ai colli in the years 2010 and 2012 were used to validating the model we run model 1 4 using the mortalities estimated in the previous subsection and keeping all the other parameters of development and fecundity fixed as in the model calibration the simulated dynamics of the immature stages for the years 2010 and 2012 obtained using the estimated mortality in fig 4 are represented in fig 6 while the nrmses for all the stages are shown in table 5 as for the calibration phase we do not consider the adult stage because the data for adults are collected differently than the immature stages and the adults do not cause direct damage to the grapevines the nrmse values in table 5 are comparable with those in table 4 relative to the estimation phase ensuring a satisfactory representation of the immature dynamics fig 6 moreover as in the previous section many of the observed values fall into the 95 confidence bands or their variability intervals intersect the confidence bands these results suggest that the method presented allows obtaining relevant estimates of the stage specific mortality rate functions the model implemented using the novel mortality rates provides reliable estimates of the population dynamics of the pest based on temperature finally we remark that the nrmses obtained for the years 2010 and 2012 are smaller than the corresponding values computed for the dynamics in gilioli et al 2016 for all the immature stages in fact the nrmses in gilioli et al 2016 for the year 2010 are 0 2734 for the eggs 0 2226 for the larvae and 0 3913 for the pupae while for the year 2012 are 0 8764 for the eggs 0 6323 for the larvae and 0 4384 for the pupae 6 discussion and concluding remarks a realistic simulation of the population dynamics relies on the knowledge of the biodemographic functions describing the biology of the species development and fecundity rate functions can be estimated using for example a simple least square method starting from literature data on duration at different temperatures or data on the average number of eggs produced however literature data on mortality are not available because mortality rates are difficult to measure due to continuous reproduction more complex methods have been developed to estimate biodemographic functions in particular mortality based on population dynamics datasets in case no such data are available ellner et al 2002 gilioli et al 2016 lanzarone et al 2017 wood 2001 here we consider the case of the grape berry moth for which we dispose of 5 years of data on population dynamics in the same location three years 2008 2009 and 2011 are used in the calibration phase to estimate the mortality rate functions then these estimated mortalities are used in the validation phase to test the capacity of the model to predict the observed population dynamics in the years 2010 and 2012 the observations are affected by a measurement error here we assume that the measurement error is a percentage of the abundance in a stage according to the experience of one of the authors in collecting data in vineyards to estimate the mortality rate functions of the different stages we propose a method based on the minimization of the sum of weighted squared differences between simulated dynamics and observations the method relies on the work of wood 2001 but the functional to be minimized is suitably replaced by a new functional able to take into account the variability in the observations the estimation method considered in the present paper has some advantages compared to the method proposed in gilioli et al 2016 and lanzarone et al 2017 for the grape berry moth mortality estimation in gilioli et al 2016 and lanzarone et al 2017 the mortality was represented as the sum of two terms intrinsic mortality due to abiotic factors and extrinsic mortality due to biotic factors the intrinsic mortality was estimated using literature data while for the extrinsic mortality estimation methods based on population dynamics observations were proposed since as a function of temperature intrinsic mortality was of a known fixed form it would not be useful to apply the estimation method proposed here only to extrinsic mortality in the present paper mortality is considered as a whole and represented as a linear combination of cubic splines this assures greater flexibility on the shape of the mortality function in this work the splines only depend on temperature which is the main driver but other environmental variables or biotic factors can be included to further generalize the functions to check the convergence of the estimation procedure an application to a synthetic dataset where data are generated from system 1 4 with known mortality rate functions is considered to mimic the real case the observations are then disturbed by an error the applied method using equal weights for all stages allows us to obtain a precise estimate of both the mortality rate functions and the population dynamics guaranteeing the convergence of the estimation algorithm then we consider the case of field data we decided to assign a higher weight to larval observations because based on the field experience of one of the authors the measurements of larvae are more precise than for the other immature stages due to the evident damage they produce to vineyards pavan et al 1998 pavan and sbrissa 1994 then it is important to have an accurate description of larval dynamics on the contrary it is very hard to detect eggs and pupae then we suppose the abundances in these two stages are subject to 50 errors while for larvae only a 10 error is considered the estimation procedure is subject to variability in particular the parameter estimator is a random variable whose distribution can be approximated by a multivariate normal distribution drawing 500 values of the parameter vector from this distribution we can obtain confidence bands for the mortality running the model for the 500 mortalities we obtain the confidence bands also for the population dynamics the estimated mortalities confidence bands fig 4 are thin in the central part of the interval for favourable temperatures and large for extreme values of the temperatures showing an increase for high and low temperature values this behavior is in agreement with the assumptions made in gilioli et al 2016 where the mortality is defined as a second order degree polynomial for small and large temperatures that infrequently occur the simulated population dynamics show a satisfactory approximation of the phenology of the species a better fit is observed for the larval stage for which a higher weight was considered in the estimation procedure indeed most of the larval observations intervals fall into the 95 confidence bands or their variability ranges intersect the confidence bands this is important in pest control mainly based on the control of larvae thus we can obtain a satisfactory larval abundance forecast that allows better planning of pesticides treatments in our case study it has been observed that the confidence bands of the simulated dynamics are particularly large near to the peaks of the dynamics this implies a higher uncertainty in the estimates of maximum population abundances especially for the larval stage and it can lead to different strategies in pest management in detail it may happen that the simulated larval dynamics blue lines in fig 5 does not reach the alert threshold but the threshold is crossed by the upper limit of the confidence band we can decide to treat with pesticides when the confidence band cross the alert threshold or when the simulated larval dynamics reaches that threshold depending on our risk aversion in the first case we have a conservative approach and it is more likely to treat with pesticides than in the second case once it is decided to follow the simulated dynamics or a limit of the confidence bands the most appropriate periods to carry out phytosanitary treatments can be easily determined thus allowing for more rational use of pesticides the satisfactory representation of the phenology and dynamics of the species over five years 2008 2012 provides indications about the capacity of the newly estimated mortality rate functions to represent temperature dependent physiological responses of the species independently from the context of application as well as development and fecundity rate functions thus it may be possible to use the model to support pest management at other sites to clarify this issue further the model should also be tested at other locations abundance data from other experimental fields are being collected and will be analysed in future works moreover the estimation method here presented is sufficiently general to be applied to other pests the weighted squared differences to be minimized in the estimation procedure allow to differentiate the weights for every single observation in this way it is possible to stress the observations relative to a more sensible stage as in our case or the observations of one or more particularly dangerous generations in addition it is possible to quantify the range of variability of the dynamics giving a measure of the error of the predicted population dynamics in conclusion the approach adds more realism to the stage structured population model and it enhances its capability to predict population dynamics which are key issues in developing strategies for pest management credit authorship contribution statement s pasquali conceptualization methodology software formal analysis writing review editing validation c soresina conceptualization methodology software formal analysis writing review editing validation e marchesini investigation data curation validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements support by indam gnfm is gratefully acknowledged by cs the authors would like to thank tommaso del viscio cnr imati enrico magenes for technical support 
24516,simulating the population dynamics of a stage structured population requires the knowledge of development mortality and fecundity rate functions characterizing the species in general development and fecundity can satisfactorily be estimated starting from literature data unfortunately this is often not the case for the mortality function due to the lack of experimental data to overcome this problem we estimate the mortality rate function from field data on the abundance of the species the mortality is expressed as a linear combination of cubic splines and the estimation method allows to determine its coefficients taking into account the observations measurement error moreover the variability in the estimate is quantified using the confidence bands for both mortality and dynamics the presented method allows obtaining a more flexible shape for the mortality rate functions compared with previous methods applied to the same pest the method has been applied to the case of lobesia botrana the main pest in the european vineyards with abundance data collected for five consecutive years in an experimental field in the north of italy data collected over three years are used to estimate the mortality and to analyse the variability in the estimate and its effects on the population dynamics while the other two datasets are used to validate the model simulating the dynamics using the estimated mortality keywords stage structured population physiologically based demographic model mortality estimate population abundance time series lobesia botrana 1 introduction population dynamics models play an important role in pest control predictive information of the temporal dynamics of a pest population can help decision makers in the choice of the best strategy in terms of the application of phytosanitary treatments this is a fundamental task in light of the directive 2009 128 ec on the sustainable use of pesticides in europe to realistically describe the population dynamics of a pest it is necessary to take into account climatic factors phenology of the plant and in general physical biological characteristics of the environment in the site of interest all these factors affect the biology of the species mathematically described by biodemographic functions namely development mortality and reproduction rate functions the dynamics of the species can be represented by mechanistic models that allow describing the physiological response of the species to environmental driving variables these models are known as physiologically based models gutierrez 1996 and describe the species life history through the biodemographic functions each individual of the population is characterized by a physiological age which is a biometric descriptor of its development physiologically based models allow representing a non linear relationship between environmental drivers and physiological processes describing the population dynamics capture processes at different trophic levels and supply predictions on pest population dynamics taking into account biological and ecological variability especially when combined with weather forecasts they can be used to predict the population dynamics phenology and distribution of a pest model outputs can guide farmers in the rational use of pesticides for these reasons and in particular for the ability to provide information on the dynamics and the phenology of a species they are important tools to support integrated pest management gutierrez et al 2012 gutierrez and wilson 1989 sporleder et al 2009 physiologically based models can be used to predict both the cumulated emergence of individuals in the different stages phenological models and the population abundance over time demographic models phenological models can be applied starting from a fixed initial condition considering development rate functions only but also mortality and fecundity rate functions can be introduced effects of mortality and fecundity rate functions in phenological models are discussed in pasquali et al 2019 physiologically based demographic models pbdms allow predicting population abundance over time taking into account the environmental variables influencing the dynamics of a species these mechanistic models have been used for a long time see for instance de wit and goudriaan 1974 gutierrez et al 1975 mcdonald et al 1989 and wang et al 1977 the life cycle of an insect is characterized by several immature stages and one adult reproductive stage each developmental stage responds in different ways with respect to biotic and abiotic driver most of the pests are dangerous for the crop only in a particular phase of their lifecycle then it is often useful to consider the population organized in stages through the so called stage structured population models cushing 1998 iannelli 1994 iannelli and milner 2010 each stage is characterized by development and mortality rate functions while the adult stage is defined also through a reproductive function pbdms have been widely used in the last years to describe pest population dynamics for stage structured populations ainseba et al 2011 blum et al 2018 ewing et al 2016 gilioli et al 2016 2017 2014 marini et al 2016 metz and diekmann 1986 pasquali et al 2020 rossini et al 2020 here we consider a physiologically based demographic model for a stage structured population described by a system of partial differential equations which is a particular case of a more general stage structured population model presented in buffoni and pasquali 2007 the output of the model is the abundance of the population in each stage in time and physiological age defined as the percentage of development within a stage it is based on stage specific biodemographic functions dependent on environmental variables mainly temperature a reliable estimate of the biodemographic functions allows obtaining a reliable model for population dynamics in general these rate functions are estimated starting from literature data on the biology of the species for instance temperature dependent duration within a stage for the development function number of eggs produced by an adult female at different temperatures for the fecundity function starting from these data a simple least square method allows estimating the parameters of a biodemographic function of a given functional form unfortunately data for the estimation of the mortality functions are often lacking in the literature in this case different methods of estimation can be applied see for instance wood and nisbet 2013 for a survey of mortality estimation methods when laboratory data on the mortality rate are not available the mortality estimate can rely on the knowledge of time series data on population dynamics different methods to estimate mortality starting from population dynamics time series data have been proposed in the last years ellner et al 2002 proposed a non parametric regression model picart and ainseba 2011 solved the problem using a numerical analysis based on a quasi newton method in gilioli et al 2016 a method based on least squares was presented while in lanzarone et al 2017 a bayesian estimation method was described in the last two approaches a functional form for the mortality is required and the estimate concerns only parameters appearing in these functions in particular the authors introduced mortality composed of two terms an intrinsic temperature dependent abiotic mortality depending on the development rate function and a constant generation dependent extrinsic mortality likely related to external natural control factors to be estimated using time series field data on the population dynamics ainseba et al 2011 also proposed mortality rate functions of a known form depending on both environmental variables and age assuming the mortality of a known functional form can be restrictive in some cases where having more flexibility for the behavior of the mortality rate function with respect to the temperature is preferable we decided to follow the approach proposed by wood 2001 which does not require a functional form but rather expresses the mortality as a linear combination of elements of a suitable basis the parameter vector containing the coefficient of the linear combination is estimated by minimizing a weighted least squares term that measures the distance between the simulated and the observed population abundance different weights can be considered for the various stages of the population and or for the various generations here differently from wood 2001 we modify the functional to be minimized to take into account the measurement error typical of field observations the new objective is to minimize the sum of the weighted distance between the simulated abundance and the observations range of variability furthermore also the variability in the mortality estimates has been taken into account and leads to variability in the population dynamics both quantified through confidence bands since the estimator of the parameter vector is a random variable confidence bands are obtained by drawing a certain number of values for the parameter vector from its distribution the mortality estimation method is applied to the case study of the grape berry moth lobesia botrana which is considered one of the most dangerous pests in european vineyards the description of the population dynamics of the grape berry moth has been widely studied in the past ainseba et al 2011 baumgärtner and baronio 1988 gutierrez et al 2012 gilioli et al 2016 in our study we consider four developmental stages for l botrana population eggs larvae pupae and adults to check the convergence of the estimation method we initially consider the case of population abundances simulated by the model more precisely we fix the mortality rate functions of the different stages in particular we consider artificial mortalities with a bathtub shape and generate the abundances in all the stages from the population dynamics model obtained with these mortalities and the known development and fecundity rate functions when we apply the estimation method starting from the simulated abundances we correctly reconstruct the mortality rate functions which means that the estimation procedure is suitable for obtaining a reliable approximation of the mortality rate functions then the method is applied to a field case data on population abundances for all the stages of the grape berry moth have been collected in colognola ai colli verona italy in the period 2008 2012 for the cultivar garganega the dataset is split into two groups population abundances of years 2008 2009 and 2011 are used to estimate the mortality while data of 2010 and 2012 are used to validate the model the proposed method allows knowing the behavior of the mortality rates as a function of the temperature since the grape berry moth is dangerous only in its larval stage it is useful to assign a higher weight to this stage when considering the least square term in the estimation procedure in this way we aim to obtain better estimates for the abundances of the larvae than for the other stages this can be useful to the end of grape berry moth control in vineyards picart et al 2011 picart and milner 2014 picart et al 2015 because a finer approximation of the number of larvae in the field allows better defining the timing of application of control treatments against the stage the population dynamics model with the estimated mortalities can be used to forecast the pest abundance furthermore the estimated mortality rate functions as the other biodemographic functions represent the physiological responses of the species and thus they are independent from the context of application moreover since the estimation method here described is sufficiently general it can also be applied to other stage structured populations the paper is organized as follows in section 2 the mathematical model describing the dynamics of the population is presented while in section 3 the biodemographic functions of the grape berry moth are specified section 4 describes the mortality estimation method and the method to determine the confidence bands in section 5 the estimation method is applied to the grape berry moth for both the case of simulated data and field data finally section 6 is devoted to discussion and concluding remarks the matlab code implementing the mortality estimation method can be found on github pasquali and soresina 2021 2 the mathematical model the demographic model is based on a system of partial differential equations that allows to obtain the temporal dynamics of the stage structured population and their distribution over physiological age within each stage let ϕ i t x d x number of individuals in stage i at time t with physiological age in x x d x for i 1 2 s where s is the number of stages stages from 1 to s 1 are immature stages and stage s represents the reproductive stage adult individuals note that t denotes the chronological time while x represents the physiological age indicating the percentage of development within the stage over time buffoni and pasquali 2007 2010 2013 di cola et al 1999 instead of a deterministic setting in which the population dynamics is described through von foerster equations buffoni and pasquali 2007 we prefer to consider a stochastic approach that allows taking into account the variability of the development rate among the individuals buffoni and pasquali 2010 2013 the dynamics is described in terms of the forward kolmogorov equations gardiner 1986 carpi and di cola 1988 1 ϕ i t x v i t ϕ i σ i ϕ i x m i t ϕ i 0 t t 0 x 0 1 2 v i t ϕ i t x σ i ϕ i x x 0 f i t 3 σ i ϕ i x x 1 0 4 ϕ i t 0 x ϕ ˆ i x where i 1 2 s v i t and m i t are the stage specific development and mortality rates respectively assumed to be independent of the age x ϕ ˆ i x are the initial conditions namely the initial distributions of the individuals with respect to the physiological age while σ i are constant diffusion coefficients the boundary condition at x 0 assigns the input flux into stage i while the boundary condition at x 1 means that the output flux from stage i is due only to the advective component v i t ϕ i t 1 buffoni and pasquali 2007 moreover the fluxes f i t in the boundary conditions 2 are evaluated as follows the term f 1 t is the eggs production flux and is given by 5 f 1 t v s t 0 1 β t x ϕ s t x d x where v s t β t x is the fertility rate in particular we consider 6 v s t β t x b t f x e g g s a d u l t f e m a l e s w i t h a g e i n x x d x t i m e u n i t where b t takes into account the effect due to both diet and temperature and f x is the oviposition profile the other terms f i t when i 1 are the individual fluxes from stage i 1 to stage i and are given by 7 f i t v i 1 t ϕ i 1 t 1 i 1 the functions ϕ i t x allow to obtain the number of individuals in stage i at time t n i t 0 1 ϕ i t x d x system 1 4 requires an explicit formulation depending on a certain number of parameters of basic biodemographic rate functions development fecundity and mortality that models the physiological response of individuals to environmental forcing variables for the grape berry moth as for all the ectotherms the temperature is one of the main driving variables influencing individuals physiological responses then these biodemographic rate functions are formulated in terms of temperature which depends on the chronological time it is also possible to take into account the dependence on other environmental variables schmidt et al 2003 3 biodemografic functions for lobesia botrana lobesia botrana has a stage structured population generally considered composed of four stages eggs larvae pupae and adults s 4 each stage is characterized by its own biodemographic functions development mortality and only for adults fecundity we suppose that development and mortality rate functions depend on time only through temperature while the fecundity rate function depends also on the physiological age as done in gilioli et al 2016 in particular in this paper we consider the same development rate functions estimated in gilioli et al 2016 while for the fecundity rate function we use the function b t estimated in gilioli et al 2016 but a different expression for the oviposition profile f x appearing in 6 experimental laboratory data are used to estimate developmental and fecundity rates average duration in a stage at different temperatures for development and the average number of eggs produced by a reproductive female at different temperatures and physiological ages for fecundity on the contrary mortality rates are very difficult to measure due to continuous reproduction and partially overlapping generations manly 1989 gilioli et al 2016 then to estimate mortality rate functions we rely on the observed abundances for all four stages of the l botrana population using a modified version of the method proposed by wood 2001 for formulating and fitting partially specified models 3 1 development rate function the development rate function v t appearing in 1 describes the development rate as a function of time through temperature typically there is no development below a low temperature threshold while the development rate increases and reaches a maximum at an optimal temperature and then it declines rapidly approaching zero at a thermal maximum namely the temperature at which life processes can no longer be maintained for prolonged periods of time logan et al 1976 several functional expressions have been proposed in the literature to describe development kontodimas et al 2004 here as in gilioli et al 2016 we consider a lactin function lactin et al 1995 to represent the development of all the stages 8 v i t δ i max 0 e α i t t e α i t m t m t t β i γ i where t m 36 c is the thermal maximum α i is the slope parameter describing the acceleration of the function from the low temperature threshold to the optimal temperature β i is the width of the high temperature decline zone γ i is a parameter that allows the curve to intersect the abscissa giving a minimum temperature of development and δ i is a coefficient of amplification of the curve parameters of the development rate functions are estimated by means of a least square method in gilioli et al 2016 using the datasets in baumgärtner and baronio 1988 and brière and pracros 1998 and are reported in table 1 3 2 fecundity rate function as assumed in 6 eggs production depends both on the physiological age of the adults and on the chronological time through temperature and phenological stage of the host plant as environmental variables the oviposition profile f x in eq 6 as function of the physiological age x is assumed to be of the functional form f x a x r 1 exp c x where the parameters a r c are usually estimated from experimental data in particular the number of eggs produced by a female at different physiological ages this class of functions reproducing the shape of a gamma distribution is sufficiently general to allow the shift of the peak of fecundity in all values of the physiological age interval i e different sets of parameters a r c shift the maximum production of eggs from low physiological ages to high physiological ages the term b t in eq 6 takes into account the influence of environmental variables temperature t t and phenological stage of the plant p t varying with the chronological time it is expressed by the product gilioli et al 2016 gutierrez et al 2012 b t b 0 p t a 0 t t where b 0 is a step function indicating the insect diet changing over time due to the plant maturation process and a 0 t 1 t t l t 0 t 0 2 captures the effect of temperature the parameter t l indicates the minimum temperature of reproduction while t 0 the half width of the temperature reproduction interval regarding the case study of l botrana the parameters appearing in the function f x of the fecundity rate are obtained by fitting the corresponding oviposition profile in baumgärtner and baronio 1988 suitably converted as a function of the physiological age in particular we rescale the fecundity rate function by assuming that physiological age 1 corresponds to 400 degree days in figure iii of baumgärtner and baronio 1988 then the estimated parameters are a 74270 r 4 06 c 15 33 the values appearing in the function a 0 t already obtained in gilioli et al 2016 and gutierrez et al 2012 and here reported for the reader s convenience are t l 17 c t 0 7 5 c the product f x a 0 t eggs femaleday 1 as a function of temperature c and physiological age x is illustrated in fig 1 function b 0 p t which depends on the phenological age p of the plant expressed in terms of bbch scale lorenz et al 1994 is a step function with steps at the bbch stages indicated in table 2 gutierrez et al 2012 3 3 mortality rate function since mortality rates are very difficult to measure the functional form of the mortality rate m t cannot be easily determined as the development and the fecundity rate functions in this paper we consider the mortality m t as unknown and we apply a modified version of the estimation method proposed by wood 2001 for formulating and fitting partially specified models thanks to this approach the obtained mortality carries out both extrinsic and intrinsic mortality factors see gilioli et al 2016 moreover since we want to estimate the mortality rates without assuming a specific functional form for them we do not specify an analytical expression but only consider some biologically meaningful hypotheses the mortality rate depends on the chronological time through temperature the mortality rate is a non negative continuous function of temperature the mortality rate is strictly positive at two reference temperatures these assumptions will constitute the constraints on the shape of the mortality rates in the sequel 4 estimation of the mortality rate function the estimation method of the mortality rate functions here presented allows dealing with mortality of unknown form guaranteeing more flexibility for its shape than in gilioli et al 2016 to apply this method we need a dataset of observations of the abundance of the different stages over time the abundances are collected in the field at different frequencies for example weekly and can concern all the stages or only some stages these observations are subject to a measurement error depending on the stage because measuring the abundance of a stage might be trickier than for others for this reason we want the estimation method from field data to be flexible enough to incorporate such measurement errors 4 1 the estimation method we consider system 1 4 in which the development functions and the fecundity function are chosen as stated in the previous section and the mortality rates are unspecified we want to find the mortality functions m i t i 1 s that result in the best fit of the model to field data of populations densities for the observed stages once the biodemographic functions are fixed system 1 4 can be numerically solved and produce a vector of model estimates μ representing the population abundances calculated at the same times of the observations y usually observations are affected by errors in particular in our case study it is very difficult to detect insects in some stages of their life meaning that the observations namely the field data could underestimate the real abundances we denote by u the vector representing the measurement error then we expect the real abundances included in the interval y y u the goodness of the fit can be quantitatively measured as a weighted sum of squared distance of each observation y k from the interval y k y k u k k 1 d max 0 y k μ k w k y k u k μ k where d is the number of data obtained as the sum of the number of observations for all the stages and w k are the weights associated with each measurement then the best fitting functions m i are those which minimize this quantity the unknown functions m i can be expressed as linear combination of elements of a suitable basis ξ i j t i 1 s j 1 n i for instance a polynomial or cubic spline basis m i t j 1 n i p i j ξ i j t thanks to this choice the mortality is then very general and it is not limited to a fixed form the problem of finding the best fitting functions m i is reduced to finding under some constraints the best fitting parameters p i j i 1 s j 1 n i collected into the vector p p 11 p 1 n 1 p s n s t which produces the model estimates μ p the total number of parameters in vector p is denoted as n p n 1 n s then our objective is to minimize q p k 1 d max 0 y k μ k p w k y k u k μ k p the procedure which leads to an estimates of the coefficients p is the following 1 given an initial guess of the model parameter vector p denoted by p g the model equations are numerically solved and model estimates μ are obtained 2 by repeatedly solving the model with slight changes in parameters we obtain an estimate of the d n p matrix j where j i j μ i p j we use the approximation j i j μ i p g δ j e j μ i p g δ j e j 2 δ j where δ j is a small number and e j are vectors of the canonical basis 3 the quantity μ and j are used to construct a quadratic model of the fitting objective as a functional of p q p k 1 d max 0 y ˆ k h 1 n p j k h p h w k y ˆ k u k h 1 n p j k h p h where y ˆ k y k μ k p g h 1 n p j k h p h g 4 we find the new direction to modify p g minimizing with respect to p the quadratic model of the real fitting objective q p together with the constraints a new value of the parameter vector p g is found 5 with the new value p g we iterate steps 1 4 to convergence obtaining the estimate p it is worthwhile to note that even though this procedure follows the method proposed in wood 2001 the quadratic functional to be minimized has been suitably modified to take into account the measurement error in the observations 4 2 confidence bands in addition to the uncertainty on the collected data the estimation procedure itself produces variability in the mortality rate functions to account for this effect we consider confidence bands for both the mortality rate functions and the population dynamics to this end we observe that denoting by p ˆ argmin p q p the estimator the parameter covariance matrix is given by marsili libelli et al 2003 9 c j p ˆ q p ˆ d n p j t w 1 j 1 for large samples p ˆ has approximately a multivariate normal distribution with mean p and covariance matrix c j p wood 2001 since the multivariate normal distribution does not ensure non negative mortality rate functions we introduce a more restrictive constraint drawing the parameter from a truncated multivariate normal distribution we draw a certain number of values of the parameter vector corresponding to different mortality functions used to obtain confidence bands for mortality then we run the model for all the mortalities to determine the confidence bands for the population dynamics 5 the case of l botrana to estimate the mortality rate functions of the grape berry moth we need abundance data we consider two cases in section 5 1 we generate from model 1 4 a dataset of abundances for the four stages of the grape berry moth to check the convergence of the estimation method then we consider the same dataset used in gilioli et al 2016 concerning the dynamics of the grape berry moth in a vineyard of garganega located in colognola ai colli verona veneto region in the north east of italy during the time frame 2008 2012 the experimental field was not treated with pesticides the abundances have been sampled weekly for eggs larvae pupae and adults adult males were detected using pheromone traps while immature stages were counted on samples of 100 bunches for a more detailed description of the data collection see gilioli et al 2016 to estimate the mortality rates functions we used the field data collected at colognola ai colli during the three years 2008 2009 and 2011 section 5 2 data collected during the other two years 2010 and 2012 were used to validate the model section 5 3 keeping all the other parameters of development and fecundity fixed in both cases development and fecundity rate functions are those defined in section 3 and the values of the diffusion coefficients are set σ i 0 0001 i 1 2 3 4 as in gilioli et al 2016 and lanzarone et al 2017 to make the comparison with the other approaches easier hourly temperature data collected by a meteorological station close to the vineyard are used as a driver environmental variable for the model simulation the times at which the phenological stage of the plant p t reaches the bbchs reported in table 2 vary over the years they are reported in table 3 for the vineyard of garganega located in colognola ai colli for the years 2008 2012 it is also important to take into account that observed abundances are subject to a measurement error depending on the stage for instance it is very difficult to detect eggs and pupae in fact to count first generation eggs it is necessary to pick up small grape bunches and to analyse them in a laboratory using a stereomicroscope for the other generations a magnifying glass is used to observe bunches in the field and this operation requires particular attention from the third generation pupae are under the rhytidome while second generation pupae can be hidden either in the grape berries or under the rhytidome making the detection of this stage particularly difficult then based on the experience of one of the authors in collecting data in vineyards for eggs and pupae we consider a measurement error up to 50 of the collected abundance larvae are more visible due to the damage they produce then we suppose to have a measurement error of up to 10 for this stage these assumptions about measurement error are based on field observations in our specific case adults males are caught with pheromone traps then we assume they are correctly measured the sex ratio is assumed to be 0 5 as in gutierrez et al 2012 therefore the number of males caught in traps is equal to the number of adult females moreover we consider a population composed only of females responsible for reproduction the mortality rate functions are expressed as linear combination of cubic b splines the basis is built on the nodes 0 20 40 being 0 40 a suitable interval of temperature and hence it consists in five polynomials ξ j t t j 1 5 defined on this interval the mortality rates function are m i t t j 1 5 p i j ξ j t t i 1 4 the constraint minimization of q p fourth point of the estimation method explained in section 4 1 has been carried out using the fmincon matlab routine in this setting it is possible to include the constraints on the mortality rates stated in section 3 3 as linear inequalities involving the parameters p i j 5 1 method validation to check the convergence of the estimation method described in the previous subsection we need a dataset obtained from known biodemographic functions then we generate data of population abundance for three years using the available hourly temperatures in colognola ai colli for the years 2008 2009 2011 we run the model 1 4 using the development and fecundity rate functions defined in section 3 with an initial condition of 100 adults with physiological age 0 at may 1st and the artificial mortality rate functions represented with red lines in fig 2 which have a bathtub shape realistic for a mortality rate function we pick a value of abundance every 10 days for all the stages starting from may 1st up to the end of the year to reproduce the measurement error for each abundance we draw a value u from a uniform distribution over the interval 0 0 5 for eggs and pupae and over the interval 0 0 1 for the larvae and multiply the abundances by 1 u obtaining the underestimated population abundances to avoid confusion with the field case these data are referred to as artificial observations and will be used in the estimation procedure to check the convergence of the estimation method proposed the measurement error also defines the interval of the variability of the artificial observations we apply the estimation method considering equal weights for all the data we have to minimize the sum of the weighted squared differences q p between simulated dynamics and artificial observations for all three years 2008 2009 2011 more precisely the number of artificial observations will be d d 2008 d 2009 d 2011 where d y is the number of artificial observations generated for the year y intended as the sum of the observations for all the stages applying the method described in section 4 1 we obtain the estimated mortality reported in fig 2 with a blue continuous line it can be seen that the estimated mortalities well approximate the artificial mortalities with bathtub shape used to generate data red dashed lines in particular in the central part of the temperature interval for low and high values of temperatures some differences between the two curves can be observed due to the scarcity of artificial observations for these temperatures which are unlikely in the temperature dataset used here however looking at fig 3 it is evident that these differences do not produce significant variations between simulated population dynamics and artificial observations because indeed low and high temperatures are very unlikely in temperate regions such as colognola ai colli in the period may september the simulated dynamics for immature stages denoted with a continuous blue line in fig 3 almost perfectly fit the artificial observations meaning that the simulated trajectories cross nearly all the intervals of variability of the artificial observations represented by the vertical red intervals in fig 3 this result shows that the algorithm can provide a reliable approximation of the mortality functions and can be usefully applied to the case of field data we remark that in this case we do not report the confidence bands for mortality rate functions and population dynamics because they are extremely thin in both cases 5 2 model calibration in the case of field data we must collect information on the population densities at the beginning of the season to drive the simulation during the entire growing season in our study the number of adults caught by pheromone traps at the first collection date in the favourable season is used as the initial condition of the model then as done in gilioli et al 2016 to avoid the extinction of the population due to a period of low temperatures additional inputs are introduced into the system every week on the adults caught by the traps until the first larvae of the first generation are observed as in the previous case we have to minimize the sum of the weighted squared differences q p between simulated dynamics and observations for all three years 2008 2009 2011 with d d 2008 d 2009 d 2011 total observations as an initial guess for the estimation algorithm we used a linear combination of cubic b splines that approximate the mortality rates already used in gilioli et al 2016 in the case of field data we do not consider equal weight for all the stages but we assign a higher weight to the larval stage this choice relies on the harmfulness of the larvae that in second generation cause severe damage to the grapes pavan et al 1998 pavan and sbrissa 1994 then it is important to obtain a reliable forecast of the larval abundance in particular to the end of pest control moreover data collected on larvae are more reliable than for the other stages for all these reasons the weights assigned to larval observations are one hundred times the weights of the observations assigned to the other stages to account for the effect of the variability in the parameters estimates we consider the confidence bands for both the mortality rate functions and the grape berry moth dynamics in particular we know that the probability distribution of the parameter p ˆ can be approximated by a multivariate normal distribution with mean p and covariance matrix 9 we draw 500 realizations of the vector parameter from this distribution that correspond to 500 mortalities for each stage expressed as max 0 j 1 7 p i j ξ i j t because they cannot be negative the 95 confidence bands of the mortality rate functions are obtained from these 500 mortalities using the matlab routine prctile to see the effects of the mortality variability in the population dynamics we run the model for the 500 mortalities computed to obtain the mortality confidence bands and then we determine the population dynamics bands the mortality rate functions obtained in the case of field data and the relative 95 confidence bands are represented in fig 4 it can be observed that confidence bands are tight in the central part of the temperature interval that is when temperatures are favourable to the pest growth this is due to the fact that the temperature datasets here considered contains mainly temperatures between 10 and 35 c allowing us to obtain a better estimate in this temperature range conversely they are largely outside this range which corresponds to unlikely temperatures when no data or few data on population abundance are available then there is more uncertainty in estimating mortalities outside the temperature interval 10 c 35 c and consequently the confidence bands will be larger moreover if a long period of very low temperatures is considered the population extinct making uncertain the mortality estimate in this case the estimated mortalities blue lines in fig 4 but especially the upper bounds of the confidence bands namely the upper bounds of the grey areas show for almost all stages an increase for both increasing and decreasing temperatures in particular the upper bounds of the grey areas present a bathtub shape realistic for a mortality function this behavior for extreme temperatures is in accordance with the mortality proposed in gilioli et al 2016 where second order degree polynomials were used to describe mortality for low and high temperatures in the central part of the temperature interval approximately between 10 c and 35 c mortality has lower values in line with the high survival obtained by brière and pracros 1998 the estimated larval mortality blue line is almost vanishing between 0 and 27 c but for cold temperatures it is compensated by high mortalities for the other three stages which instead have low mortalities for temperatures approaching 40 c however the large variability outside the interval 10 c 35 c makes the estimated mortalities highly uncertain allowing for low survival at extreme temperatures as reported by brière and pracros 1998 as in the previous case of artificial observations generated from system 1 4 the variability in the mortality for high and low temperatures does not negatively affect the dynamics of the pest because in the period considered here between mid april and the end of september temperatures outside the interval 10 c 35 c occasionally occur and therefore the mortality values corresponding to these temperatures occur only a few times the pest dynamics for the immature stages are reported in fig 5 we omit the adult stage because adults are sampled differently than immature stages and moreover they do not cause direct damage to plants the fit of the immature stages is satisfactory also taking into account the large measurement error we have considered to quantify the distance between the simulated dynamics and the observed abundance interval of variability we consider the normalized root mean square error nrmse related to the stage i and year y defined as 10 nrmse y i 1 max y y i min y y i k 1 d y i max 0 y k μ k p y k u k μ k p 2 d y i where y y i denotes the vector of observations in year y for the stage i of length d y i the computed nrmse for the immature stages in the years 2008 2009 and 2011 are reported in table 4 as expected population dynamics obtained considering a mortality function estimated with a higher weight for larvae present a better fit for the larval stage than for the other stages as indicated in table 4 by the mean of the nrmses over the years we also observe that the means of the nrmse here obtained are lower than those computed for the model in gilioli et al 2016 respectively 0 9455 for eggs 0 3062 for larvae 0 406 for pupae intended as the distance between the simulated and the observed abundances moreover taking into account the uncertainty in the estimates looking at fig 5 we observe that for all the three considered years the confidence bands for the larval stage include the majority of the observed abundance intervals of variability or cross these intervals for eggs and pupae only in some cases the observed values fall in the 95 confidence bands but the estimated dynamics allow to obtain values for larvae not far from the observed abundance intervals of variability see values of nrmses in table 4 the confidence bands of the simulated dynamics are particularly large near to the peaks of the dynamics namely there is higher uncertainty in the estimates of maximum population abundances especially for the larval stage with an impact on pest management strategies 5 3 model validation the datasets recorded in colognola ai colli in the years 2010 and 2012 were used to validating the model we run model 1 4 using the mortalities estimated in the previous subsection and keeping all the other parameters of development and fecundity fixed as in the model calibration the simulated dynamics of the immature stages for the years 2010 and 2012 obtained using the estimated mortality in fig 4 are represented in fig 6 while the nrmses for all the stages are shown in table 5 as for the calibration phase we do not consider the adult stage because the data for adults are collected differently than the immature stages and the adults do not cause direct damage to the grapevines the nrmse values in table 5 are comparable with those in table 4 relative to the estimation phase ensuring a satisfactory representation of the immature dynamics fig 6 moreover as in the previous section many of the observed values fall into the 95 confidence bands or their variability intervals intersect the confidence bands these results suggest that the method presented allows obtaining relevant estimates of the stage specific mortality rate functions the model implemented using the novel mortality rates provides reliable estimates of the population dynamics of the pest based on temperature finally we remark that the nrmses obtained for the years 2010 and 2012 are smaller than the corresponding values computed for the dynamics in gilioli et al 2016 for all the immature stages in fact the nrmses in gilioli et al 2016 for the year 2010 are 0 2734 for the eggs 0 2226 for the larvae and 0 3913 for the pupae while for the year 2012 are 0 8764 for the eggs 0 6323 for the larvae and 0 4384 for the pupae 6 discussion and concluding remarks a realistic simulation of the population dynamics relies on the knowledge of the biodemographic functions describing the biology of the species development and fecundity rate functions can be estimated using for example a simple least square method starting from literature data on duration at different temperatures or data on the average number of eggs produced however literature data on mortality are not available because mortality rates are difficult to measure due to continuous reproduction more complex methods have been developed to estimate biodemographic functions in particular mortality based on population dynamics datasets in case no such data are available ellner et al 2002 gilioli et al 2016 lanzarone et al 2017 wood 2001 here we consider the case of the grape berry moth for which we dispose of 5 years of data on population dynamics in the same location three years 2008 2009 and 2011 are used in the calibration phase to estimate the mortality rate functions then these estimated mortalities are used in the validation phase to test the capacity of the model to predict the observed population dynamics in the years 2010 and 2012 the observations are affected by a measurement error here we assume that the measurement error is a percentage of the abundance in a stage according to the experience of one of the authors in collecting data in vineyards to estimate the mortality rate functions of the different stages we propose a method based on the minimization of the sum of weighted squared differences between simulated dynamics and observations the method relies on the work of wood 2001 but the functional to be minimized is suitably replaced by a new functional able to take into account the variability in the observations the estimation method considered in the present paper has some advantages compared to the method proposed in gilioli et al 2016 and lanzarone et al 2017 for the grape berry moth mortality estimation in gilioli et al 2016 and lanzarone et al 2017 the mortality was represented as the sum of two terms intrinsic mortality due to abiotic factors and extrinsic mortality due to biotic factors the intrinsic mortality was estimated using literature data while for the extrinsic mortality estimation methods based on population dynamics observations were proposed since as a function of temperature intrinsic mortality was of a known fixed form it would not be useful to apply the estimation method proposed here only to extrinsic mortality in the present paper mortality is considered as a whole and represented as a linear combination of cubic splines this assures greater flexibility on the shape of the mortality function in this work the splines only depend on temperature which is the main driver but other environmental variables or biotic factors can be included to further generalize the functions to check the convergence of the estimation procedure an application to a synthetic dataset where data are generated from system 1 4 with known mortality rate functions is considered to mimic the real case the observations are then disturbed by an error the applied method using equal weights for all stages allows us to obtain a precise estimate of both the mortality rate functions and the population dynamics guaranteeing the convergence of the estimation algorithm then we consider the case of field data we decided to assign a higher weight to larval observations because based on the field experience of one of the authors the measurements of larvae are more precise than for the other immature stages due to the evident damage they produce to vineyards pavan et al 1998 pavan and sbrissa 1994 then it is important to have an accurate description of larval dynamics on the contrary it is very hard to detect eggs and pupae then we suppose the abundances in these two stages are subject to 50 errors while for larvae only a 10 error is considered the estimation procedure is subject to variability in particular the parameter estimator is a random variable whose distribution can be approximated by a multivariate normal distribution drawing 500 values of the parameter vector from this distribution we can obtain confidence bands for the mortality running the model for the 500 mortalities we obtain the confidence bands also for the population dynamics the estimated mortalities confidence bands fig 4 are thin in the central part of the interval for favourable temperatures and large for extreme values of the temperatures showing an increase for high and low temperature values this behavior is in agreement with the assumptions made in gilioli et al 2016 where the mortality is defined as a second order degree polynomial for small and large temperatures that infrequently occur the simulated population dynamics show a satisfactory approximation of the phenology of the species a better fit is observed for the larval stage for which a higher weight was considered in the estimation procedure indeed most of the larval observations intervals fall into the 95 confidence bands or their variability ranges intersect the confidence bands this is important in pest control mainly based on the control of larvae thus we can obtain a satisfactory larval abundance forecast that allows better planning of pesticides treatments in our case study it has been observed that the confidence bands of the simulated dynamics are particularly large near to the peaks of the dynamics this implies a higher uncertainty in the estimates of maximum population abundances especially for the larval stage and it can lead to different strategies in pest management in detail it may happen that the simulated larval dynamics blue lines in fig 5 does not reach the alert threshold but the threshold is crossed by the upper limit of the confidence band we can decide to treat with pesticides when the confidence band cross the alert threshold or when the simulated larval dynamics reaches that threshold depending on our risk aversion in the first case we have a conservative approach and it is more likely to treat with pesticides than in the second case once it is decided to follow the simulated dynamics or a limit of the confidence bands the most appropriate periods to carry out phytosanitary treatments can be easily determined thus allowing for more rational use of pesticides the satisfactory representation of the phenology and dynamics of the species over five years 2008 2012 provides indications about the capacity of the newly estimated mortality rate functions to represent temperature dependent physiological responses of the species independently from the context of application as well as development and fecundity rate functions thus it may be possible to use the model to support pest management at other sites to clarify this issue further the model should also be tested at other locations abundance data from other experimental fields are being collected and will be analysed in future works moreover the estimation method here presented is sufficiently general to be applied to other pests the weighted squared differences to be minimized in the estimation procedure allow to differentiate the weights for every single observation in this way it is possible to stress the observations relative to a more sensible stage as in our case or the observations of one or more particularly dangerous generations in addition it is possible to quantify the range of variability of the dynamics giving a measure of the error of the predicted population dynamics in conclusion the approach adds more realism to the stage structured population model and it enhances its capability to predict population dynamics which are key issues in developing strategies for pest management credit authorship contribution statement s pasquali conceptualization methodology software formal analysis writing review editing validation c soresina conceptualization methodology software formal analysis writing review editing validation e marchesini investigation data curation validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements support by indam gnfm is gratefully acknowledged by cs the authors would like to thank tommaso del viscio cnr imati enrico magenes for technical support 
24517,with increased global production of plastics since the 1950s marine environments have experienced an increase in plastic pollution this pollution has the potential to contaminate marine organisms with microplastics which in turn may have deleterious effects on humans that consume seafood plastic pollution is often presented as a global issue however its sources are often based on local actions and potential health effects occur at an individual level environmental management to control this problem also can occur on a local scale to draw attention to the issue and demonstrate the need to take management actions to reduce plastic inflow we have developed a proof of concept model that connects inflow of plastic in a small scale marine environment to a contaminants based food web model we use ecotracer in the ecopath with ecosim modeling suite to estimate current organism concentrations of microplastics and then use model outputs to calculate human health effects the model is used to project future microplastic concentrations in marine organisms and human health effects under different environmental plastic inflow rate scenarios the model is parameterized to simulate the maryland coastal bays ecosystem which is adjacent to ocean city maryland usa a region dependent on the tourism and seafood industries we consider this a proof of concept model because data for the system are limited this approach helps to illustrate local consequences of a global problem in addition it provides a summary of pertinent regional data on the issues and helps identify gaps for future monitoring and research graphical abstract image graphical abstract keywords ecosystem modelling microplastics contaminant biotransport ecopath with ecosim ecotracer 1 introduction global plastic production has emerged with heightened importance since the 1950s with production increasing from 2 million tonnes mt in 1950 to over 380 mt currently geyer et al 2017 uses range from single use food packaging to children s toys to synthetic textiles boucher and billard 2019 with this mass production of plastic new pollutant issues arise such as plastic contamination in marine environments in 2010 alone more than 8 million metric tons of plastic entered the ocean national oceanic and atmospheric administration 2020a as these plastics break down they retain their polymer composition as microplastics which are defined as plastic particles that are less than 5 mm in size national oceanic and atmospheric administration 2020b microplastics are of increasing concern as they are unable to degrade quickly and completely in marine environments and are emerging pollutants of concern to both aquatic and terrestrial ecosystems alimba and faggio 2019 gallo et al 2018 thompson 2004 in turn aquatic ecosystem organisms are at risk to being entangled in plastic debris suffocating on smaller pieces or accumulating such particles in their guts thereby reducing the availability for nourishment guzzetti et al 2018 santillo et al 2017 welden and cowie 2016 they also have the potential to absorb toxic compounds like polychlorinated biphenyls pcbs perfluoroalkyl substances pfass polycyclic aromatic hydrocarbons pahs antibiotics and other persistent organic pollutants pops andrady 2011 li et al 2018 llorca et al 2018 sørensen et al 2020 velzeboer et al 2014 as such microplastics have the potential to cause deleterious effects on the marine organisms that consume them ultimately transferring microplastics and any associated contaminants to each trophic level and in turn to people who consume plastic contaminated food though microplastic pollution is often reported as a global concern its cause is often based in local and individual actions e g litter on beaches and streets through local water treatment facilities vince and hardesty 2017 a recent report by the joint group of experts on scientific aspects of marine protection indicates that people s perceptions and behaviours contribute to the problem but are also crucial in any solutions suggested gesamp 2015 however surveys indicate that microplastic pollution is not perceived as a major problem in the marine environment seafood consumption is a major risk pathway for human exposure to microplastics smith et al 2018 in coastal communities residents and tourists value local seafood that is safe from pollutants thus connecting local actions that cause microplastic pollution to local outcomes for seafood safety may help in drawing attention to the issue and in implementing solutions jodice and norman 2020 to that end we developed a model that connects environmental sources of microplastic pollution to seafood consumption through a regional food web model ocean city maryland usa invests heavily in and generates considerable tax revenue from tourism maryland tourism development board and maryland department of commerce 2017 ocean city is adjacent to the maryland coastal bays which serve as a source of local seafood and fishing opportunities for the region the maryland coastal bays mcbs are an ecosystem susceptible to emerging environmental pressures like microplastics the mcbs consist of five watersheds and encompass one of the most ecologically diverse estuaries on the eastern coast of the united states maryland coastal bays program 2020 the mcbs are home to several commercially important species as well as 108 rare endangered and threatened species marking this region as a critical ecosystem maryland coastal bays program 2020 the mcbs ecosystem consists of primary producers like macroalgae submerged aquatic vegetation sav and phytoplankton lower trophic level species include epibenthic invertebrates epi infauna copepods blue crab callinectus sapidus and atlantic menhaden brevoortia tyrannus upper trophic level species include forage fish benthic demersal fish planktivorous fish ctenophores bay anchovy anchoa mitchilli summer flounder paralichthys dentatus spot leiostomus xanthurus black sea bass centropristis striata weakfish cynoscion regalis terrapin and piscivorous fish the mcbs is also home to over 360 bird species the high diversity in this region is related to the shallow water habitats that provide food as well as breeding and overwintering habitats for waterbirds maryland department of natural resources 2016 colonial nesting waterbirds such as herons egrets gulls skimmers pelicans and terns utilize the mcbs watershed for habitat snow geese canada geese american black duck mallard and bufflehead are just a few of the most abundant migratory waterbirds that use the mcbs as overwintering habitats maryland department of natural resources 2016 local commercial and recreational fisheries are a large part of this ecosystem as well the most abundant fisheries fleets for the mcbs include blue crab summer flounder atlantic menhaden and spot however with the rise of economic development and human population growth the mcbs show signs of stress with populations of aquatic wildlife already degraded maryland coastal bays program 2018 also due to its shallow depths and limited inlets to the ocean the mcbs are capable of retaining microplastics and other aquatic contaminants due to poor estuarine flushing wazniak et al 2005 consequently mcbs commercially important species like blue crab and summer flounder have the capability to consume increased concentrations of microplastics compared to species in open ocean environments wu et al 2020 rare endangered and threatened species are greatly affected by microplastic accumulation and could in turn reduce the successes of recent recovery efforts plough et al 2021 valdivia et al 2019 in some recovery plans for endangered species of the sea turtle kemp s ridley lepidochelys kempii loggerhead caretta caretta green chelonia mydas and leatherback dermochelys coriacea microplastics and other marine debris are one of the highest priority threats for their survival and recovery stephen guertin 2019 as there is no data on microplastic concentrations in the mcbs and the concentrations of microplastics within each of the mcb organisms are not known at the present an ecosystem model can help to address these unknowns and evaluate reasonable concentration predictions for the mcbs species fig 1 as the trophic pathways of the mcbs trophic groups are known specific patterns of microplastic bioaccumulation can be estimated using an ecosystem based modeling approach such as ecopath with ecosim ewe ewe incorporates data points from multiple aspects of food web dynamics to provide a holistic view of an ecosystem christensen and walters 2004 ewe contains three main modules that provide mass balance analysis and dynamic modeling capabilities over time ecopath ecosim and ecospace an additional module ecotracer is capable of tracking contaminant concentrations in the environment and biota over time and has been used in several studies to trace mercury 137cesium pcbs pahs and other radionuclides through marine ecosystems booth and zeller 2005 booth et al 2020 mcgill et al 2017 larsen et al 2016 tierney et al 2017 in this end the ecotracer software could be used to model the flow of contaminants like microplastics through the trophic levels and its accumulation within species humans may be greatly affected by the microplastic accumulation in the aquatic species groups commercially important species like adult blue crab black sea bass summer flounder and bluefish pomatomus saltatrix are readily caught prepared sold shipped and consumed in this region atlantic menhaden is also a commercially important species as it is used in the production of omega 3 fish oil supplements sold nationwide microplastics although commonly found in the digestive tracts of aquatic species are capable of translocating into the gills the tissues and the circulatory system of these species smith et al 2018 this allows these smaller plastics to enter the human food stream additionally bivalves and small fish that are eaten whole are of great concern to the human diet as all of the accumulated microplastic could transfer to humans smith et al 2018 the objective of this study was to use the ecotracer module of the ewe software to create a proof of concept model to simulate the flow of microplastic contamination through the mcb estuarine food web under varying conditions we modeled the flow of plastics in the ecosystem using a four step process 1 parameterize the ecotracer module 2 evaluate the model s applicability to the system 3 simulate current conditions 1990 2017 and 4 simulate future potential conditions based on environmental plastic inflow rate scenarios simulations were run forward in time to determine the accumulation within species under different plastic inflow scenarios by modifying initial concentrations and environmental flow rates human dietary intake hdi of microplastic was also calculated based on microplastic accumulation within the aquatic species the results of this study would better inform management on key species likely to be contaminated with microplastic debris in the mcbs as well as possible pathways for microplastics to enter human food streams as this is a proof of concept model it is not designed for tactical management decision making but rather as a strategic framework to inform environmental managers of the likely connections between plastic pollution in the coastal environment and of the potential impacts on both the food web and humans this framework can be used to help managers decide on future research and monitoring to improve the model and better address the potential impacts of microplastic pollution in the system 2 materials and methods 2 1 study system the mcbs consist of five ecologically diverse estuaries and represents the most species diverse region in maryland and supports several commercially important species maryland coastal bays program 2020 with two inlets for tidal exchange flushing the mcbs is extremely slow thereby allowing nutrients and contaminants to accumulate in the mcbs rather than disperse to the atlantic ocean wazniak et al 2005 the mcbs are susceptible to human population growth and economic expansion and show signs of stress with degraded aquatic populations 2 2 ecosystem modelling the ecopath with ecosim ewe software has three main modules ecopath ecosim and ecospace the ecopath module provides a snapshot of an ecosystem that is in mass balance and can be used for trophic interaction analysis christensen and walters 2004 its master equations relate the production of a species or group of species to its consumption and can also include biomass accumulation immigration and emigration walters and christensen 2018 ecosim is a time dynamic simulation tool that can show ecosystem change using time series of changes such as fisheries mortality or importantly here environmental contaminant changes christensen and walters 2004 walters and christensen 2018 ecospace is used to model spatial temporal dynamics including groups biomasses or contaminant concentrations on a defined grid map by applying ecosim equations to individual grid cells christensen and walters 2004 it can be used to visualize the placement of local marine protected areas and the impact of this protection walters and christensen 2018 or to analyze the impact of fisheries management actions on a marine ecosystem over time couce montero et al 2021 the limitation to this module is that it requires a large data set that is not always available for a region because of data limitations this module has not been applied for this proof of concept module ecotracer is an additional module within ewe which models contaminant concentrations in the environment and biological groups christensen and walters 2004 walters and christensen 2018 ecotracer using the time dynamics of ecosim or ecospace highlights groups within the aquatic food web that are more affected by contaminant accumulation and details the pathway of contaminant transfer between the trophic levels christensen and walters 2004 while ecosim biomass dynamic equations are solved over time ecotracer tracks the movement and accumulation of food web contaminants in parallel christensen and walters 2004 the ecotracer module simulates the gains of contaminant into the biota from the environment via direct uptake through uptake from food and the concentration in immigrant biomass against the losses of contaminant from the biota through predation non predation mortality emigration metabolism and contaminant decay christensen and walters 2004 walters and christensen 2018 more information on these modules including their respective equations can be found in supplementary material 2 3 ecopath and ecosim model the ecopath model used in this study was adapted from rubalcava et al submitted a brief summary of the model is presented here the model was mass balanced by fulfilling two equations that relate production to consumption christensen and walters 2004 christensen et al 2005 it was then tuned to a calibration data set time series of biomass indices on trophic groups forcing functions represent environmental factors that can affect interactions of trophic species in a food web christensen et al 2005 in our model fishing effort primary production and environmental time series data were used as drivers and forcing functions in the ecosim modules the calibration period for the model was 1990 2017 and the scenario period was 2018 2090 these time frames were also used for calibration and scenario analysis of the ecotracer model the ecopath model contains 21 aquatic species groups representing the mcb ecosystem in 1990 the first year of available data fig 2 the input data used for the model came from local surveys and nearby estuaries with similar ecological characteristics specifically the biomass inputs for the functional groups were estimated from the maryland department of natural resources md dnr through their coastal bays fisheries investigation cbfi trawl and beach seine survey other input parameters including production biomass p b ratios consumption biomass q b ratios and total mortality year were borrowed from a well known nearby estuary chesapeake bay christensen et al 2009 or previous models built of the mcbs black 2009 species were grouped into functional groups based on similar life history traits and on availability of data from the md dnr trawl and seine survey specifically the species in the piscivorous fishes functional group included bluefish pomatomus saltatrix crevalle jack caranx hippos atlantic needlefish strongylura marina scup stenotomus chrysops and spotted hake urophycis regia forage fish transient functional group contained white mullet mugil curema northern kingfish menticirrhus saxatilis inshore lizardfish synodus foetens pinfish lagodon rhomboides northern puffer sphoeroides maculatus northern pipefish syngnathus fuscus and the northern searobin prionotus carolinus the forage fish resident functional group includes mummichog fundulus heteroclitus white perch morone americana american eel anguilla rostrata oyster toadfish opsanus tau green goby microgobius thalassinus and rainwater killifish lucania parva benthic demersal fish group is comprised of winter flounder pseudopleuronectes americanus atlantic croaker micropogonias undulatus hogchoker trinectes maculatus smallmouth flounder etropus microstomus and black drum pogonias cromis the planktivorous fish functional group includes atlantic silverside menidia menidia striped anchovy anchoa hepsetus alewife alosa pseudoharengus rough silverside membras martinica blueback herring alosa aestivalis atlantic herring clupea harengus butterfish peprilus triacanthus and striped killifish fundulus majalis epibenthic invertebrates functional group comprises of grass shrimp palaemonetes pugio sand shrimp crangon septemspinosa brown shrimp farfantepenaeus aztecus mud crab paneopus spp hermit crab pagurus spp spider crab libinia emarginata lady crab ovalipes ocellatus horseshoe crab limulus polyphemus and mantis shrimp squilla empusa finally the epi infauna functional group contains forbes sea star asterias forbesi and hairy sea cucumbers sclerodactyla briareus species including blue crab black sea bass bay anchovy spot and summer flounder stood alone in the model because they are focal species for fisheries or a forage fish and enough data for input parameters for these species was available blue crab is broken down into multi stanza groups because adequate data were available from the md dnr trawl and seine surveys diet data for the ecopath model is based on diet studies conducted in the region as well as literature the commercial landings data for the four fleets blue crab summer flounder spot and atlantic menhaden were obtained from md dnr they have available commercial fishery data from the early 1990s that was used as input data for the model the ecopath model was established with a base year of 1990 so that the ecosim module could be used and fitted to time series data and vulnerability parameters estimated vulnerability was estimated using the auto fitting procedure built into ecosim christensen and walters 2004 as this is a proof of concept model for demonstration purposes thorough investigation of model fit was limited to testing a few forcing functions with a priori expectations that they would influence fit if this model were to be further developed for tactical management advice a more thorough and systematic analysis of model fit would be warranted the 1990 ecopath model was made time dynamic in ecosim by fitting the model to observed biomass time series data the time series was obtained from the md dnr through their trawl and seine survey that has been conducted since 1990 in the mcbs biomass was estimated for each functional group based on the catch per tow data from the survey from 1990 to 2017 to drive fishing related changes in the ecosystem fishing effort was modeled by using rescaled catch data from md dnr the primary production forcing function used in the ecosim model was created from a chlorophyll a index that was applied to the phytoplankton group the chlorophyll a time series was scaled to the 1990 value the rescaled value was then used as a multiplier for the phytoplankton production chlorophyll a concentrations are measured monthly or bimonthly at 74 sites in the mcbs by the md dnr continuous monitoring program cmp eyes on the bay n d the median value is calculated to create the chlorophyll a index ecohealth report card n d environmental forcing functions were created using temperature and salinity data from the cmp median values were used for the forcing functions environmental responses for trophic groups were developed from literature values of preferred temperatures and salinities for the species or the major species for aggregate groups the modeled biomass time series was fit to biomass time series indices using the fit to time series tool this procedure was set up to adjust groupwise vulnerability parameters in ecosim the vulnerability parameter modifies the consumption rate in the simulation christensen et al 2005 combinations of primary production and environmental forcing functions were tested to determine which external drivers had an appreciable influence on the production of the trophic groups i e improved the fit to biomass indices the final model included a primary production forcing function a salinity forcing function applied to weakfish and blue crab yoy and adult and a temperature environmental forcing function applied to piscivorous fishes weakfish atlantic menhaden and blue crab yoy and adult also the sum of squared deviations ss for the best fitted time series was 167 with an akaike information criteria aic of 403 1 further manual adjustment of the vulnerability parameter produced the final model used for the ecotracer simulations 2 4 ecotracer modelling 2 4 1 parameters we used ecotracer to model the trophic transfer of microplastics and their subsequent accumulation within each of the aquatic groups in this study we used the ecotracer module with the time dynamics of ecosim rather than ecospace due to data deficiency and this being a proof of concept model ecotracer requires four input parameters a initial pool concentrations of some biotic trophic groups including environmental concentration b direct uptake parameters as rates per time per biomass per species c concentrations per biomass in immigrating biomass and d metabolism and decay rates of the contaminant for each biotic species overall ecotracer uses these parameters to track the flow of the contaminant through the biological organism groups and the environment 2 4 2 inputs 2 4 2 1 biota inputs 2 4 2 1 1 initial concentrations initial concentrations of microplastics for each trophic group were compiled from a variety of sources sources were either from the mcbs area the broader chesapeake bay area estuaries or similar systems open ocean systems or laboratory and synthetic systems in order to quantify the quality of the input data a ranking system was used with data from the mcbs scoring 1 the chesapeake bay area scoring 2 estuarine and similar systems scoring 3 open ocean systems scoring 4 and laboratory and synthetic systems scoring 5 table 1 the initial concentrations were adjusted to appropriate units by considering 65 of microplastic particles being fibers length 500 1000 um and 35 beads spherules length 500 um average 350 um using this approach enabled us to have initial values for each trophic level and to assess the quality of the input data similar to using the pedigree index of ecopath furthermore we deemed that these values were suitable to test the ability of ecotracer to trace microplastics in the underlying ecopath model the basis for the increase of microplastics in the mcb are based on changes seen in the accumulation of microplastics in aquatic species from around the world in one study the consumption of plastics by north sea fulmars fulmaris glacialis had increased in 2010 from 1975 to 1990 by between two and three fold van franeker and law 2015 we assume that the increase in accumulation in fulmars corresponds to an increased availability of microplastics in the environment additionally a study on freshwater fish in chicago found that microplastic concentration increased from between 1 5 particles fish to 2 0 particles fish in 1990 to between 3 particles fish to 5 particles fish in 2018 hou et al 2021 this corresponds to an increase between two and three fold as well finally a systematic review of plastic ingestion in marine fish worldwide found that plastic ingestion rates increased by 2 4 0 4 per year after 2010 savoca et al 2021 this also correlates to both of the other study s rates therefore we hypothesize that the mcbs have had a tripling of microplastics over a thirty year time period as an upper approximation therefore we reduced the current concentrations reported in the literature to 30 of their value to be indicative of the initial conditions in the mcb for 1990 we then ran simulations from 1990 forward in time with the tripling effect to reflect our estimate of the amount of microplastics in the mcb in 2017 2 4 2 1 2 direct absorption rates from the literature review direct absorption rate trends were recorded and entered into the model macroalgae submerged aquatic vegetation sav and phytoplankton all contributed to their microplastic concentrations via biofilm formation and entrapment of microplastics floating through the mcbs water or through plastic settling on the bottom of the mcbs macroalgae sav and phytoplankton were assigned direct absorption rates of 1 440 0 090 and 1 200 respectively booth et al 2020 walters and christensen 2018 2 4 2 1 3 proportion of contaminant excreted the standard excretion rate used for most aquatic trophic groups was 0 35 to represent small molecule 100 um excretion ability and 0 50 to represent small molecule and medium molecule 100 um 500 um excretion ability table 2 hoss and settle 1990 sherr et al 2017 2 4 2 1 4 other data points physical and metabolic decay rates were set to zero as microplastics do not readily decompose in aquatic organisms concentration in immigrating biomass and base volume exchange loss were also set to zero 2 4 2 2 environmental input data 2 4 2 2 1 initial concentration the initial concentration was set to 3 33 10 7 t km2 from values found in yonkos et al 2014 the initial concentration used the same assumption as for aquatic species the current literature value was reduced to 30 of its value to represent the 1990s value 2 4 2 2 2 base inflow rate we used the amount of wastewater treatment plant wwtp effluent released to the mcbs of 40 million liters per day maryland department of the environment 2014 combined with an estimate of an input of 1 51 109 microplastic particles year mason et al 2016 to derive the current base inflow rate bir we used wwtp data as billions of microplastic particles are released by wwtps into waterways every day mason et al 2016 we reduced the current bir to 30 of its value to reflect the 1990s birs of microplastics 2 4 2 2 3 environmental decay rate environmental decay rate was set to 0 232 per year due to potential photodegradation of plastic compounds in the shallow waters of the mcbs zhu et al 2020 2 4 3 forcing functions in order to simulate changing environmental plastic inflow rates we created environmental inflow forcing functions the environmental inflow forcing functions change the environmental inflow rate to account for the tripling of microplastics in the environment every 30 years and to create new projected environmental plastic inflow scenarios 2 5 plastic inflow forecasting scenarios using the calibrated model we investigated three environmental plastic inflow scenarios increasing trend reduced inflow and zero inflow to determine the microplastic accumulation response of each organismal group the forecasting simulation period was from 2018 to 2090 the scenarios are summarized in table 3 these scenarios include constant future fishing effort and constant primary production there are no other environmental drivers that may affect the future ecosystem results 2 6 human health impact human dietary intake hdi of microplastic accumulation in aquatic species was modeled by equations adapted from booth zeller 2005 it was calculated by multiplying the grams of seafood consumed per day r by the concentration of microplastic within the organism in ug g c hdi σ rc the absolute concentration values were used from the simulated runs in this study the fda advice about eating fish page was used to determine the dietary intake of each fish center for food safety and applied nutrition 2020a the recommended maximum servings of each fish species per week were used to calculate the grams of seafood consumed per day values 3 results 3 1 calibration absolute microplastic concentration was shown to increase rapidly over time with the tripling trend with most species having an increase of 1 2 orders of magnitude root mean squared logarithmic error rmsle was used to analyze the error of the system table 4 and the overall model has a rmsle of 0 000278 without the outlier species group copepods the rmsle is 1 93 10 5 this indicates that there are significant differences in some species between the reported literature values and model estimates with the model concentrations generally being less than those calculated from literature values like the starting concentrations species in the lower trophic levels have greater concentrations of microplastics than species in upper trophic levels all species increased in microplastic concentration except for weakfish which experienced a biomass decrease in 2017 thereby decreasing the microplastic abundance accumulated as well commercially important species also saw high increases of microplastic concentration 3 2 data ranking results we used a ranking score to analyze the quality of the data used in constructing our model the overall score was 3 2 species groups in trophic level 1 had an average rank of 3 0 groups in trophic level 2 had an average rank of 3 3 groups in trophic level 3 had an average rank of 3 4 finally species groups in trophic level 4 had an average rank of 3 2 with a rank between 3 0 and 3 4 for all trophic levels and the overall score the data most corresponds to estuary or similar system data 3 3 environmental plastic inflow forecasting scenarios the increasing inflow trend saw great increases in microplastics concentrations during the simulation period adult blue crab increased by over 1132 other commercially important species saw greatly increased concentrations piscivorous fishes 362 summer flounder 384 black sea bass 418 and atlantic menhaden 209 the highest trophic level and the lowest trophic level groups saw the greatest increase in microplastic concentration from 1990 to 2090 when implementing the two plastic inflow scenarios both reduction scenarios saw a decrease in microplastic concentrations table 5 the reduced inflow scenario saw a lesser decrease than the zero inflow scenario in all species both of the plastic inflow scenarios reduced the concentration of microplastics compared to the 2017 concentrations the reduced inflow scenario decreased the microplastic accumulation in species by an average of 86 the zero inflow scenario decreased the microplastic accumulation in species by an average of 96 for both of these scenarios the smallest decrease occurred in the piscivorous fishes group and the greatest decrease was in the phytoplankton group the commercially important species saw improvements in their microplastic concentrations table 5 and fig 3 with the environmental plastic inflow scenarios adult blue crab reduced its 2090 projected concentration from 1 72 10 5 increasing inflow to 2 56 10 6 reduced inflow or 7 78 10 7 zero inflow fig 4 the hdi of microplastics from the commercially important species in 2090 was modeled with and without a change in plastic inflow table 6 and table 7 with no change in microplastic inflow or changes in dietary preferences and if the tripling trend continues people in 2090 could be consuming microplastics concentrations between 1 08 ug day in atlantic menhaden when consuming 2000 mg fish oil tablets to 835 92 ug day from the consumption of adult blue crab with the two reduction scenarios in place these values decrease by over 95 a human consuming atlantic menhaden fish oil tablets and adult blue crab could instead consume 0 15 and 124 42 ug day respectively from the 1 08 and 835 92 ug day if there was no change in environmental plastic inflow 4 discussion many studies have assessed the accumulation of microplastics in aquatic organisms i e diepens and koelmans 2018 ma and you 2021 this study investigates the future impact of microplastic accumulation in aquatic species of different trophic levels with three environmental plastic inflow scenarios in the setting of the mcbs as local data on microplastics needed to parameterize ecotracer are sparse and not necessarily indicative of the actual conditions in the mcbs this study should be considered a proof of concept model that is the model is useful for 1 organizing data and knowledge about microplastics in the mcbs ecosystem 2 providing information on potential human health effects and 3 it can be used to draw attention to the issue and provide a framework for organizing new data and research on the system however additional work would be needed before the model is suitable for being used to provide environmental management decisions for this model to be used for management some data deficiencies would need to be overcome our ranking score implies that there could be a substantial improvement when incorporating more local data as there is very little aquatic microplastics data for the mcbs our data also includes data from the chesapeake bay estuarine and similar systems the open ocean and laboratory and synthetic systems most of the data came from estuarine and similar systems thereby making the model not entirely representative of the mcbs but as the data was from similar nearby systems the results with mcb specific data would likely produce results in similar ranges this is why we consider that the model can be used for demonstration purposes as it does not have the reliability and local data necessary to accurately inform managers and researchers of exact microplastic accumulation in the mcbs species present in this ecosystem to improve upon this model microplastic data for each trophic group within the mcbs ecosystem would be needed to explore potential plastics management plans subsamples of catch data through a trawl and beach seine surveys could be analyzed for plastics to fill this data gap and increase the accuracy of the model additional groups should be added to the model as well as recreational fishing is a large part of the ecosystem adding a recreational fishery time series dataset would improve the model s accuracy adding a local seabird trophic group with data from future trawl and beach seine surveys would also be a priority for future model improvement as seabirds are an ecologically important part of the ecosystem the results from this model could help identify future environmental plastic inflow rate targets for future management plans additionally uncertainty assessments that explore uncertainty in the model parameters and environmental plastic inflow concentration rates would enhance the model s credibility tools like the monte carlo routine multisim and ecosampler in the ewe platform could be used to provide a more robust assessment ecosampler could capture parameter sensitivity of our ecosim calibration and ecotracer parameters in future versions of this mcbs model for management applications steenbeek et al 2018 another tool that would enhance the model is using ecospace in conjunction with ecotracer ecospace would track changes in the concentrations of microplastics originating from a point source or as a result of changes in water currents or tidal flows this may allow for a better understanding of the local dynamics of the microplastic accumulation in the modelled trophic groups doing so would require a sampling of microplastics as described above but could help visualize the impact of the varying environmental plastic inflow rates on regions within the mcbs with these additions in the future this proof of concept model could be capable of simulating possible outcomes of environmental management decisions it could identify species most affected by microplastic accumulation and explore the impact of proposed plastic management plans based on current and future trends in the present study the plastic inflow rate was used as the parameter of change to determine the degree of microplastic accumulation change in aquatic species from 1990 to 2090 with each of our three environmental plastic inflow rates increased inflow reduced inflow zero inflow we also included a human health component to show the hdi of microplastics to detail how microplastics enter human food streams as well this study also detailed the abundance of microplastics in each of the species and the increase of microplastic concentration over time commercially important species in the mcbs saw tremendous increases in their concentrations which brings great implications for the seafood industry adult blue crab and black sea bass saw the greatest increase of plastic concentration from 1990 to 2090 however all trophic levels are being greatly affected by microplastic pollution some bioaccumulation is also displayed as the higher trophic level organisms increased to a greater average percentage 303 than the lower trophic level organisms 286 excluding adult blue crab simulated environmental plastic inflow plans were shown to be effective in reducing the concentration of microplastics in each aquatic species in 2090 primary producers saw the greatest decrease of microplastic concentrations with the reduced inflow and zero inflow scenarios the zero inflow scenario was capable of reducing the 2090 plastic concentrations within the species to below the 2017 values to a greater degree than the reduced inflow scenario as expected for each species microplastic concentrations were reduced by over 85 in the reduced inflow scenario and by over 95 in the zero inflow scenario microplastics are also of great concern to human health as plastics leach into aquatic species tissues and bloodstream smith et al 2018 previous studies have detected microplastics in human feces showing that humans are indeed consuming microplastics in their daily diets schwabl et al 2019 this limited proof of concept model shows that if plastic inflow rates triple every 30 years adult blue crab and summer flounder will see increased microplastic concentrations of 1132 and 384 respectively from 1990 to 2090 with dramatic increases in human dietary intake of microplastics this brings great risk to humans as the definitive effects of microplastics on human health are not definitively known although it is known that most plastics have estrogenic activity which have adverse effects on fetal and juvenile mammals yang et al 2011 this emphasizes the likely need for environmental plastic inflow rates to be reduced and microplastic management plans heightened especially for the highest microplastic polluters such endeavors entail designing wastewater treatment plant and washing machine filters capable of trapping microplastics and microplastic fibers before they reach waterways plastic pollution regulation can also be heightened to reduce such waste as many countries and regions have started efforts to ban single use plastics or grocery store plastic bags greater impact can result from greater legislation the microbead free waters act of 2015 prohibiting microbeads in personal care products is one such effort that resulted in trillions of beads no longer reaching the waters center for food safety and applied nutrition 2020b this also involves plastic reduction and collection plans for when the microplastics reach the waterways scientific advancement of remediation procedures in terms of biological chemical and physical degradation and removal are of great importance as the rise of microplastic pollution will continue to increase without microplastic management plans this proof of concept model demonstrates the need for further investigation of microplastic accumulation in the mcbs aquatic organisms some studies have looked into the effects of microplastics on fish health however few have determined how often ingested microplastics contain absorbed toxic compounds and heavy metals diepens and koelmans 2018 rodrigues et al 2019 this in turn increases comorbidity juvenile defects and starvation rates amongst aquatic species more detailed study on the abundance and effects of microplastic accumulation in aquatic species is required for a more accurate understanding of this ever increasing problem 5 conclusions microplastics are an increasingly important issue to address as accumulation is a risk factor for all aquatic species these microplastics particles have the potential to contaminate marine organisms which can provide deleterious effects on both the organism and the humans that consume the seafood plastic management plans are needed to help mitigate this issue as less plastic in the oceans bays and waterways will prevent severe accumulation in aquatic species and ultimately humans as well ecosystem models such as the study s proof of concept model presented herein can be used to demonstrate and understand the trophic pathways that lead to microplastic accumulation in aquatic ecosystems and ultimately human consumption with some additional research and monitoring data this model can be used to inform management by demonstrating potential scenarios for microplastic accumulation in the aquatic species of the mcbs as well as in the humans who consume commercially important species taken from the waters of the mcbs ecosystem as this model was developed using modeling software that has widespread use around the world this modeling approach can be adapted to other regions for this purpose anthropogenic activity has resulted in considerable microplastic pollution of our world s ocean perceptions about the risk and the broad global nature of the problem may result in limited or no action to resolve the issue more local scale modeling such as what we have demonstrated here which connects the local sources of the pollution to local impacts may be a useful way to organize information to develop local solutions author statement jessica boyer conceptualization writing reviewing and editing methodology data curation investigation kasondra rubalcava visualization reviewing and editing methodology software howard townsend conceptualization reviewing and editing methodology software writing shawn booth methodology troubleshooting reviewing and editing software funding this work was supported and funded in part by the ernest f hollings scholarship through the national oceanic and atmospheric administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2021 109849 appendix supplementary materials image application 1 
24517,with increased global production of plastics since the 1950s marine environments have experienced an increase in plastic pollution this pollution has the potential to contaminate marine organisms with microplastics which in turn may have deleterious effects on humans that consume seafood plastic pollution is often presented as a global issue however its sources are often based on local actions and potential health effects occur at an individual level environmental management to control this problem also can occur on a local scale to draw attention to the issue and demonstrate the need to take management actions to reduce plastic inflow we have developed a proof of concept model that connects inflow of plastic in a small scale marine environment to a contaminants based food web model we use ecotracer in the ecopath with ecosim modeling suite to estimate current organism concentrations of microplastics and then use model outputs to calculate human health effects the model is used to project future microplastic concentrations in marine organisms and human health effects under different environmental plastic inflow rate scenarios the model is parameterized to simulate the maryland coastal bays ecosystem which is adjacent to ocean city maryland usa a region dependent on the tourism and seafood industries we consider this a proof of concept model because data for the system are limited this approach helps to illustrate local consequences of a global problem in addition it provides a summary of pertinent regional data on the issues and helps identify gaps for future monitoring and research graphical abstract image graphical abstract keywords ecosystem modelling microplastics contaminant biotransport ecopath with ecosim ecotracer 1 introduction global plastic production has emerged with heightened importance since the 1950s with production increasing from 2 million tonnes mt in 1950 to over 380 mt currently geyer et al 2017 uses range from single use food packaging to children s toys to synthetic textiles boucher and billard 2019 with this mass production of plastic new pollutant issues arise such as plastic contamination in marine environments in 2010 alone more than 8 million metric tons of plastic entered the ocean national oceanic and atmospheric administration 2020a as these plastics break down they retain their polymer composition as microplastics which are defined as plastic particles that are less than 5 mm in size national oceanic and atmospheric administration 2020b microplastics are of increasing concern as they are unable to degrade quickly and completely in marine environments and are emerging pollutants of concern to both aquatic and terrestrial ecosystems alimba and faggio 2019 gallo et al 2018 thompson 2004 in turn aquatic ecosystem organisms are at risk to being entangled in plastic debris suffocating on smaller pieces or accumulating such particles in their guts thereby reducing the availability for nourishment guzzetti et al 2018 santillo et al 2017 welden and cowie 2016 they also have the potential to absorb toxic compounds like polychlorinated biphenyls pcbs perfluoroalkyl substances pfass polycyclic aromatic hydrocarbons pahs antibiotics and other persistent organic pollutants pops andrady 2011 li et al 2018 llorca et al 2018 sørensen et al 2020 velzeboer et al 2014 as such microplastics have the potential to cause deleterious effects on the marine organisms that consume them ultimately transferring microplastics and any associated contaminants to each trophic level and in turn to people who consume plastic contaminated food though microplastic pollution is often reported as a global concern its cause is often based in local and individual actions e g litter on beaches and streets through local water treatment facilities vince and hardesty 2017 a recent report by the joint group of experts on scientific aspects of marine protection indicates that people s perceptions and behaviours contribute to the problem but are also crucial in any solutions suggested gesamp 2015 however surveys indicate that microplastic pollution is not perceived as a major problem in the marine environment seafood consumption is a major risk pathway for human exposure to microplastics smith et al 2018 in coastal communities residents and tourists value local seafood that is safe from pollutants thus connecting local actions that cause microplastic pollution to local outcomes for seafood safety may help in drawing attention to the issue and in implementing solutions jodice and norman 2020 to that end we developed a model that connects environmental sources of microplastic pollution to seafood consumption through a regional food web model ocean city maryland usa invests heavily in and generates considerable tax revenue from tourism maryland tourism development board and maryland department of commerce 2017 ocean city is adjacent to the maryland coastal bays which serve as a source of local seafood and fishing opportunities for the region the maryland coastal bays mcbs are an ecosystem susceptible to emerging environmental pressures like microplastics the mcbs consist of five watersheds and encompass one of the most ecologically diverse estuaries on the eastern coast of the united states maryland coastal bays program 2020 the mcbs are home to several commercially important species as well as 108 rare endangered and threatened species marking this region as a critical ecosystem maryland coastal bays program 2020 the mcbs ecosystem consists of primary producers like macroalgae submerged aquatic vegetation sav and phytoplankton lower trophic level species include epibenthic invertebrates epi infauna copepods blue crab callinectus sapidus and atlantic menhaden brevoortia tyrannus upper trophic level species include forage fish benthic demersal fish planktivorous fish ctenophores bay anchovy anchoa mitchilli summer flounder paralichthys dentatus spot leiostomus xanthurus black sea bass centropristis striata weakfish cynoscion regalis terrapin and piscivorous fish the mcbs is also home to over 360 bird species the high diversity in this region is related to the shallow water habitats that provide food as well as breeding and overwintering habitats for waterbirds maryland department of natural resources 2016 colonial nesting waterbirds such as herons egrets gulls skimmers pelicans and terns utilize the mcbs watershed for habitat snow geese canada geese american black duck mallard and bufflehead are just a few of the most abundant migratory waterbirds that use the mcbs as overwintering habitats maryland department of natural resources 2016 local commercial and recreational fisheries are a large part of this ecosystem as well the most abundant fisheries fleets for the mcbs include blue crab summer flounder atlantic menhaden and spot however with the rise of economic development and human population growth the mcbs show signs of stress with populations of aquatic wildlife already degraded maryland coastal bays program 2018 also due to its shallow depths and limited inlets to the ocean the mcbs are capable of retaining microplastics and other aquatic contaminants due to poor estuarine flushing wazniak et al 2005 consequently mcbs commercially important species like blue crab and summer flounder have the capability to consume increased concentrations of microplastics compared to species in open ocean environments wu et al 2020 rare endangered and threatened species are greatly affected by microplastic accumulation and could in turn reduce the successes of recent recovery efforts plough et al 2021 valdivia et al 2019 in some recovery plans for endangered species of the sea turtle kemp s ridley lepidochelys kempii loggerhead caretta caretta green chelonia mydas and leatherback dermochelys coriacea microplastics and other marine debris are one of the highest priority threats for their survival and recovery stephen guertin 2019 as there is no data on microplastic concentrations in the mcbs and the concentrations of microplastics within each of the mcb organisms are not known at the present an ecosystem model can help to address these unknowns and evaluate reasonable concentration predictions for the mcbs species fig 1 as the trophic pathways of the mcbs trophic groups are known specific patterns of microplastic bioaccumulation can be estimated using an ecosystem based modeling approach such as ecopath with ecosim ewe ewe incorporates data points from multiple aspects of food web dynamics to provide a holistic view of an ecosystem christensen and walters 2004 ewe contains three main modules that provide mass balance analysis and dynamic modeling capabilities over time ecopath ecosim and ecospace an additional module ecotracer is capable of tracking contaminant concentrations in the environment and biota over time and has been used in several studies to trace mercury 137cesium pcbs pahs and other radionuclides through marine ecosystems booth and zeller 2005 booth et al 2020 mcgill et al 2017 larsen et al 2016 tierney et al 2017 in this end the ecotracer software could be used to model the flow of contaminants like microplastics through the trophic levels and its accumulation within species humans may be greatly affected by the microplastic accumulation in the aquatic species groups commercially important species like adult blue crab black sea bass summer flounder and bluefish pomatomus saltatrix are readily caught prepared sold shipped and consumed in this region atlantic menhaden is also a commercially important species as it is used in the production of omega 3 fish oil supplements sold nationwide microplastics although commonly found in the digestive tracts of aquatic species are capable of translocating into the gills the tissues and the circulatory system of these species smith et al 2018 this allows these smaller plastics to enter the human food stream additionally bivalves and small fish that are eaten whole are of great concern to the human diet as all of the accumulated microplastic could transfer to humans smith et al 2018 the objective of this study was to use the ecotracer module of the ewe software to create a proof of concept model to simulate the flow of microplastic contamination through the mcb estuarine food web under varying conditions we modeled the flow of plastics in the ecosystem using a four step process 1 parameterize the ecotracer module 2 evaluate the model s applicability to the system 3 simulate current conditions 1990 2017 and 4 simulate future potential conditions based on environmental plastic inflow rate scenarios simulations were run forward in time to determine the accumulation within species under different plastic inflow scenarios by modifying initial concentrations and environmental flow rates human dietary intake hdi of microplastic was also calculated based on microplastic accumulation within the aquatic species the results of this study would better inform management on key species likely to be contaminated with microplastic debris in the mcbs as well as possible pathways for microplastics to enter human food streams as this is a proof of concept model it is not designed for tactical management decision making but rather as a strategic framework to inform environmental managers of the likely connections between plastic pollution in the coastal environment and of the potential impacts on both the food web and humans this framework can be used to help managers decide on future research and monitoring to improve the model and better address the potential impacts of microplastic pollution in the system 2 materials and methods 2 1 study system the mcbs consist of five ecologically diverse estuaries and represents the most species diverse region in maryland and supports several commercially important species maryland coastal bays program 2020 with two inlets for tidal exchange flushing the mcbs is extremely slow thereby allowing nutrients and contaminants to accumulate in the mcbs rather than disperse to the atlantic ocean wazniak et al 2005 the mcbs are susceptible to human population growth and economic expansion and show signs of stress with degraded aquatic populations 2 2 ecosystem modelling the ecopath with ecosim ewe software has three main modules ecopath ecosim and ecospace the ecopath module provides a snapshot of an ecosystem that is in mass balance and can be used for trophic interaction analysis christensen and walters 2004 its master equations relate the production of a species or group of species to its consumption and can also include biomass accumulation immigration and emigration walters and christensen 2018 ecosim is a time dynamic simulation tool that can show ecosystem change using time series of changes such as fisheries mortality or importantly here environmental contaminant changes christensen and walters 2004 walters and christensen 2018 ecospace is used to model spatial temporal dynamics including groups biomasses or contaminant concentrations on a defined grid map by applying ecosim equations to individual grid cells christensen and walters 2004 it can be used to visualize the placement of local marine protected areas and the impact of this protection walters and christensen 2018 or to analyze the impact of fisheries management actions on a marine ecosystem over time couce montero et al 2021 the limitation to this module is that it requires a large data set that is not always available for a region because of data limitations this module has not been applied for this proof of concept module ecotracer is an additional module within ewe which models contaminant concentrations in the environment and biological groups christensen and walters 2004 walters and christensen 2018 ecotracer using the time dynamics of ecosim or ecospace highlights groups within the aquatic food web that are more affected by contaminant accumulation and details the pathway of contaminant transfer between the trophic levels christensen and walters 2004 while ecosim biomass dynamic equations are solved over time ecotracer tracks the movement and accumulation of food web contaminants in parallel christensen and walters 2004 the ecotracer module simulates the gains of contaminant into the biota from the environment via direct uptake through uptake from food and the concentration in immigrant biomass against the losses of contaminant from the biota through predation non predation mortality emigration metabolism and contaminant decay christensen and walters 2004 walters and christensen 2018 more information on these modules including their respective equations can be found in supplementary material 2 3 ecopath and ecosim model the ecopath model used in this study was adapted from rubalcava et al submitted a brief summary of the model is presented here the model was mass balanced by fulfilling two equations that relate production to consumption christensen and walters 2004 christensen et al 2005 it was then tuned to a calibration data set time series of biomass indices on trophic groups forcing functions represent environmental factors that can affect interactions of trophic species in a food web christensen et al 2005 in our model fishing effort primary production and environmental time series data were used as drivers and forcing functions in the ecosim modules the calibration period for the model was 1990 2017 and the scenario period was 2018 2090 these time frames were also used for calibration and scenario analysis of the ecotracer model the ecopath model contains 21 aquatic species groups representing the mcb ecosystem in 1990 the first year of available data fig 2 the input data used for the model came from local surveys and nearby estuaries with similar ecological characteristics specifically the biomass inputs for the functional groups were estimated from the maryland department of natural resources md dnr through their coastal bays fisheries investigation cbfi trawl and beach seine survey other input parameters including production biomass p b ratios consumption biomass q b ratios and total mortality year were borrowed from a well known nearby estuary chesapeake bay christensen et al 2009 or previous models built of the mcbs black 2009 species were grouped into functional groups based on similar life history traits and on availability of data from the md dnr trawl and seine survey specifically the species in the piscivorous fishes functional group included bluefish pomatomus saltatrix crevalle jack caranx hippos atlantic needlefish strongylura marina scup stenotomus chrysops and spotted hake urophycis regia forage fish transient functional group contained white mullet mugil curema northern kingfish menticirrhus saxatilis inshore lizardfish synodus foetens pinfish lagodon rhomboides northern puffer sphoeroides maculatus northern pipefish syngnathus fuscus and the northern searobin prionotus carolinus the forage fish resident functional group includes mummichog fundulus heteroclitus white perch morone americana american eel anguilla rostrata oyster toadfish opsanus tau green goby microgobius thalassinus and rainwater killifish lucania parva benthic demersal fish group is comprised of winter flounder pseudopleuronectes americanus atlantic croaker micropogonias undulatus hogchoker trinectes maculatus smallmouth flounder etropus microstomus and black drum pogonias cromis the planktivorous fish functional group includes atlantic silverside menidia menidia striped anchovy anchoa hepsetus alewife alosa pseudoharengus rough silverside membras martinica blueback herring alosa aestivalis atlantic herring clupea harengus butterfish peprilus triacanthus and striped killifish fundulus majalis epibenthic invertebrates functional group comprises of grass shrimp palaemonetes pugio sand shrimp crangon septemspinosa brown shrimp farfantepenaeus aztecus mud crab paneopus spp hermit crab pagurus spp spider crab libinia emarginata lady crab ovalipes ocellatus horseshoe crab limulus polyphemus and mantis shrimp squilla empusa finally the epi infauna functional group contains forbes sea star asterias forbesi and hairy sea cucumbers sclerodactyla briareus species including blue crab black sea bass bay anchovy spot and summer flounder stood alone in the model because they are focal species for fisheries or a forage fish and enough data for input parameters for these species was available blue crab is broken down into multi stanza groups because adequate data were available from the md dnr trawl and seine surveys diet data for the ecopath model is based on diet studies conducted in the region as well as literature the commercial landings data for the four fleets blue crab summer flounder spot and atlantic menhaden were obtained from md dnr they have available commercial fishery data from the early 1990s that was used as input data for the model the ecopath model was established with a base year of 1990 so that the ecosim module could be used and fitted to time series data and vulnerability parameters estimated vulnerability was estimated using the auto fitting procedure built into ecosim christensen and walters 2004 as this is a proof of concept model for demonstration purposes thorough investigation of model fit was limited to testing a few forcing functions with a priori expectations that they would influence fit if this model were to be further developed for tactical management advice a more thorough and systematic analysis of model fit would be warranted the 1990 ecopath model was made time dynamic in ecosim by fitting the model to observed biomass time series data the time series was obtained from the md dnr through their trawl and seine survey that has been conducted since 1990 in the mcbs biomass was estimated for each functional group based on the catch per tow data from the survey from 1990 to 2017 to drive fishing related changes in the ecosystem fishing effort was modeled by using rescaled catch data from md dnr the primary production forcing function used in the ecosim model was created from a chlorophyll a index that was applied to the phytoplankton group the chlorophyll a time series was scaled to the 1990 value the rescaled value was then used as a multiplier for the phytoplankton production chlorophyll a concentrations are measured monthly or bimonthly at 74 sites in the mcbs by the md dnr continuous monitoring program cmp eyes on the bay n d the median value is calculated to create the chlorophyll a index ecohealth report card n d environmental forcing functions were created using temperature and salinity data from the cmp median values were used for the forcing functions environmental responses for trophic groups were developed from literature values of preferred temperatures and salinities for the species or the major species for aggregate groups the modeled biomass time series was fit to biomass time series indices using the fit to time series tool this procedure was set up to adjust groupwise vulnerability parameters in ecosim the vulnerability parameter modifies the consumption rate in the simulation christensen et al 2005 combinations of primary production and environmental forcing functions were tested to determine which external drivers had an appreciable influence on the production of the trophic groups i e improved the fit to biomass indices the final model included a primary production forcing function a salinity forcing function applied to weakfish and blue crab yoy and adult and a temperature environmental forcing function applied to piscivorous fishes weakfish atlantic menhaden and blue crab yoy and adult also the sum of squared deviations ss for the best fitted time series was 167 with an akaike information criteria aic of 403 1 further manual adjustment of the vulnerability parameter produced the final model used for the ecotracer simulations 2 4 ecotracer modelling 2 4 1 parameters we used ecotracer to model the trophic transfer of microplastics and their subsequent accumulation within each of the aquatic groups in this study we used the ecotracer module with the time dynamics of ecosim rather than ecospace due to data deficiency and this being a proof of concept model ecotracer requires four input parameters a initial pool concentrations of some biotic trophic groups including environmental concentration b direct uptake parameters as rates per time per biomass per species c concentrations per biomass in immigrating biomass and d metabolism and decay rates of the contaminant for each biotic species overall ecotracer uses these parameters to track the flow of the contaminant through the biological organism groups and the environment 2 4 2 inputs 2 4 2 1 biota inputs 2 4 2 1 1 initial concentrations initial concentrations of microplastics for each trophic group were compiled from a variety of sources sources were either from the mcbs area the broader chesapeake bay area estuaries or similar systems open ocean systems or laboratory and synthetic systems in order to quantify the quality of the input data a ranking system was used with data from the mcbs scoring 1 the chesapeake bay area scoring 2 estuarine and similar systems scoring 3 open ocean systems scoring 4 and laboratory and synthetic systems scoring 5 table 1 the initial concentrations were adjusted to appropriate units by considering 65 of microplastic particles being fibers length 500 1000 um and 35 beads spherules length 500 um average 350 um using this approach enabled us to have initial values for each trophic level and to assess the quality of the input data similar to using the pedigree index of ecopath furthermore we deemed that these values were suitable to test the ability of ecotracer to trace microplastics in the underlying ecopath model the basis for the increase of microplastics in the mcb are based on changes seen in the accumulation of microplastics in aquatic species from around the world in one study the consumption of plastics by north sea fulmars fulmaris glacialis had increased in 2010 from 1975 to 1990 by between two and three fold van franeker and law 2015 we assume that the increase in accumulation in fulmars corresponds to an increased availability of microplastics in the environment additionally a study on freshwater fish in chicago found that microplastic concentration increased from between 1 5 particles fish to 2 0 particles fish in 1990 to between 3 particles fish to 5 particles fish in 2018 hou et al 2021 this corresponds to an increase between two and three fold as well finally a systematic review of plastic ingestion in marine fish worldwide found that plastic ingestion rates increased by 2 4 0 4 per year after 2010 savoca et al 2021 this also correlates to both of the other study s rates therefore we hypothesize that the mcbs have had a tripling of microplastics over a thirty year time period as an upper approximation therefore we reduced the current concentrations reported in the literature to 30 of their value to be indicative of the initial conditions in the mcb for 1990 we then ran simulations from 1990 forward in time with the tripling effect to reflect our estimate of the amount of microplastics in the mcb in 2017 2 4 2 1 2 direct absorption rates from the literature review direct absorption rate trends were recorded and entered into the model macroalgae submerged aquatic vegetation sav and phytoplankton all contributed to their microplastic concentrations via biofilm formation and entrapment of microplastics floating through the mcbs water or through plastic settling on the bottom of the mcbs macroalgae sav and phytoplankton were assigned direct absorption rates of 1 440 0 090 and 1 200 respectively booth et al 2020 walters and christensen 2018 2 4 2 1 3 proportion of contaminant excreted the standard excretion rate used for most aquatic trophic groups was 0 35 to represent small molecule 100 um excretion ability and 0 50 to represent small molecule and medium molecule 100 um 500 um excretion ability table 2 hoss and settle 1990 sherr et al 2017 2 4 2 1 4 other data points physical and metabolic decay rates were set to zero as microplastics do not readily decompose in aquatic organisms concentration in immigrating biomass and base volume exchange loss were also set to zero 2 4 2 2 environmental input data 2 4 2 2 1 initial concentration the initial concentration was set to 3 33 10 7 t km2 from values found in yonkos et al 2014 the initial concentration used the same assumption as for aquatic species the current literature value was reduced to 30 of its value to represent the 1990s value 2 4 2 2 2 base inflow rate we used the amount of wastewater treatment plant wwtp effluent released to the mcbs of 40 million liters per day maryland department of the environment 2014 combined with an estimate of an input of 1 51 109 microplastic particles year mason et al 2016 to derive the current base inflow rate bir we used wwtp data as billions of microplastic particles are released by wwtps into waterways every day mason et al 2016 we reduced the current bir to 30 of its value to reflect the 1990s birs of microplastics 2 4 2 2 3 environmental decay rate environmental decay rate was set to 0 232 per year due to potential photodegradation of plastic compounds in the shallow waters of the mcbs zhu et al 2020 2 4 3 forcing functions in order to simulate changing environmental plastic inflow rates we created environmental inflow forcing functions the environmental inflow forcing functions change the environmental inflow rate to account for the tripling of microplastics in the environment every 30 years and to create new projected environmental plastic inflow scenarios 2 5 plastic inflow forecasting scenarios using the calibrated model we investigated three environmental plastic inflow scenarios increasing trend reduced inflow and zero inflow to determine the microplastic accumulation response of each organismal group the forecasting simulation period was from 2018 to 2090 the scenarios are summarized in table 3 these scenarios include constant future fishing effort and constant primary production there are no other environmental drivers that may affect the future ecosystem results 2 6 human health impact human dietary intake hdi of microplastic accumulation in aquatic species was modeled by equations adapted from booth zeller 2005 it was calculated by multiplying the grams of seafood consumed per day r by the concentration of microplastic within the organism in ug g c hdi σ rc the absolute concentration values were used from the simulated runs in this study the fda advice about eating fish page was used to determine the dietary intake of each fish center for food safety and applied nutrition 2020a the recommended maximum servings of each fish species per week were used to calculate the grams of seafood consumed per day values 3 results 3 1 calibration absolute microplastic concentration was shown to increase rapidly over time with the tripling trend with most species having an increase of 1 2 orders of magnitude root mean squared logarithmic error rmsle was used to analyze the error of the system table 4 and the overall model has a rmsle of 0 000278 without the outlier species group copepods the rmsle is 1 93 10 5 this indicates that there are significant differences in some species between the reported literature values and model estimates with the model concentrations generally being less than those calculated from literature values like the starting concentrations species in the lower trophic levels have greater concentrations of microplastics than species in upper trophic levels all species increased in microplastic concentration except for weakfish which experienced a biomass decrease in 2017 thereby decreasing the microplastic abundance accumulated as well commercially important species also saw high increases of microplastic concentration 3 2 data ranking results we used a ranking score to analyze the quality of the data used in constructing our model the overall score was 3 2 species groups in trophic level 1 had an average rank of 3 0 groups in trophic level 2 had an average rank of 3 3 groups in trophic level 3 had an average rank of 3 4 finally species groups in trophic level 4 had an average rank of 3 2 with a rank between 3 0 and 3 4 for all trophic levels and the overall score the data most corresponds to estuary or similar system data 3 3 environmental plastic inflow forecasting scenarios the increasing inflow trend saw great increases in microplastics concentrations during the simulation period adult blue crab increased by over 1132 other commercially important species saw greatly increased concentrations piscivorous fishes 362 summer flounder 384 black sea bass 418 and atlantic menhaden 209 the highest trophic level and the lowest trophic level groups saw the greatest increase in microplastic concentration from 1990 to 2090 when implementing the two plastic inflow scenarios both reduction scenarios saw a decrease in microplastic concentrations table 5 the reduced inflow scenario saw a lesser decrease than the zero inflow scenario in all species both of the plastic inflow scenarios reduced the concentration of microplastics compared to the 2017 concentrations the reduced inflow scenario decreased the microplastic accumulation in species by an average of 86 the zero inflow scenario decreased the microplastic accumulation in species by an average of 96 for both of these scenarios the smallest decrease occurred in the piscivorous fishes group and the greatest decrease was in the phytoplankton group the commercially important species saw improvements in their microplastic concentrations table 5 and fig 3 with the environmental plastic inflow scenarios adult blue crab reduced its 2090 projected concentration from 1 72 10 5 increasing inflow to 2 56 10 6 reduced inflow or 7 78 10 7 zero inflow fig 4 the hdi of microplastics from the commercially important species in 2090 was modeled with and without a change in plastic inflow table 6 and table 7 with no change in microplastic inflow or changes in dietary preferences and if the tripling trend continues people in 2090 could be consuming microplastics concentrations between 1 08 ug day in atlantic menhaden when consuming 2000 mg fish oil tablets to 835 92 ug day from the consumption of adult blue crab with the two reduction scenarios in place these values decrease by over 95 a human consuming atlantic menhaden fish oil tablets and adult blue crab could instead consume 0 15 and 124 42 ug day respectively from the 1 08 and 835 92 ug day if there was no change in environmental plastic inflow 4 discussion many studies have assessed the accumulation of microplastics in aquatic organisms i e diepens and koelmans 2018 ma and you 2021 this study investigates the future impact of microplastic accumulation in aquatic species of different trophic levels with three environmental plastic inflow scenarios in the setting of the mcbs as local data on microplastics needed to parameterize ecotracer are sparse and not necessarily indicative of the actual conditions in the mcbs this study should be considered a proof of concept model that is the model is useful for 1 organizing data and knowledge about microplastics in the mcbs ecosystem 2 providing information on potential human health effects and 3 it can be used to draw attention to the issue and provide a framework for organizing new data and research on the system however additional work would be needed before the model is suitable for being used to provide environmental management decisions for this model to be used for management some data deficiencies would need to be overcome our ranking score implies that there could be a substantial improvement when incorporating more local data as there is very little aquatic microplastics data for the mcbs our data also includes data from the chesapeake bay estuarine and similar systems the open ocean and laboratory and synthetic systems most of the data came from estuarine and similar systems thereby making the model not entirely representative of the mcbs but as the data was from similar nearby systems the results with mcb specific data would likely produce results in similar ranges this is why we consider that the model can be used for demonstration purposes as it does not have the reliability and local data necessary to accurately inform managers and researchers of exact microplastic accumulation in the mcbs species present in this ecosystem to improve upon this model microplastic data for each trophic group within the mcbs ecosystem would be needed to explore potential plastics management plans subsamples of catch data through a trawl and beach seine surveys could be analyzed for plastics to fill this data gap and increase the accuracy of the model additional groups should be added to the model as well as recreational fishing is a large part of the ecosystem adding a recreational fishery time series dataset would improve the model s accuracy adding a local seabird trophic group with data from future trawl and beach seine surveys would also be a priority for future model improvement as seabirds are an ecologically important part of the ecosystem the results from this model could help identify future environmental plastic inflow rate targets for future management plans additionally uncertainty assessments that explore uncertainty in the model parameters and environmental plastic inflow concentration rates would enhance the model s credibility tools like the monte carlo routine multisim and ecosampler in the ewe platform could be used to provide a more robust assessment ecosampler could capture parameter sensitivity of our ecosim calibration and ecotracer parameters in future versions of this mcbs model for management applications steenbeek et al 2018 another tool that would enhance the model is using ecospace in conjunction with ecotracer ecospace would track changes in the concentrations of microplastics originating from a point source or as a result of changes in water currents or tidal flows this may allow for a better understanding of the local dynamics of the microplastic accumulation in the modelled trophic groups doing so would require a sampling of microplastics as described above but could help visualize the impact of the varying environmental plastic inflow rates on regions within the mcbs with these additions in the future this proof of concept model could be capable of simulating possible outcomes of environmental management decisions it could identify species most affected by microplastic accumulation and explore the impact of proposed plastic management plans based on current and future trends in the present study the plastic inflow rate was used as the parameter of change to determine the degree of microplastic accumulation change in aquatic species from 1990 to 2090 with each of our three environmental plastic inflow rates increased inflow reduced inflow zero inflow we also included a human health component to show the hdi of microplastics to detail how microplastics enter human food streams as well this study also detailed the abundance of microplastics in each of the species and the increase of microplastic concentration over time commercially important species in the mcbs saw tremendous increases in their concentrations which brings great implications for the seafood industry adult blue crab and black sea bass saw the greatest increase of plastic concentration from 1990 to 2090 however all trophic levels are being greatly affected by microplastic pollution some bioaccumulation is also displayed as the higher trophic level organisms increased to a greater average percentage 303 than the lower trophic level organisms 286 excluding adult blue crab simulated environmental plastic inflow plans were shown to be effective in reducing the concentration of microplastics in each aquatic species in 2090 primary producers saw the greatest decrease of microplastic concentrations with the reduced inflow and zero inflow scenarios the zero inflow scenario was capable of reducing the 2090 plastic concentrations within the species to below the 2017 values to a greater degree than the reduced inflow scenario as expected for each species microplastic concentrations were reduced by over 85 in the reduced inflow scenario and by over 95 in the zero inflow scenario microplastics are also of great concern to human health as plastics leach into aquatic species tissues and bloodstream smith et al 2018 previous studies have detected microplastics in human feces showing that humans are indeed consuming microplastics in their daily diets schwabl et al 2019 this limited proof of concept model shows that if plastic inflow rates triple every 30 years adult blue crab and summer flounder will see increased microplastic concentrations of 1132 and 384 respectively from 1990 to 2090 with dramatic increases in human dietary intake of microplastics this brings great risk to humans as the definitive effects of microplastics on human health are not definitively known although it is known that most plastics have estrogenic activity which have adverse effects on fetal and juvenile mammals yang et al 2011 this emphasizes the likely need for environmental plastic inflow rates to be reduced and microplastic management plans heightened especially for the highest microplastic polluters such endeavors entail designing wastewater treatment plant and washing machine filters capable of trapping microplastics and microplastic fibers before they reach waterways plastic pollution regulation can also be heightened to reduce such waste as many countries and regions have started efforts to ban single use plastics or grocery store plastic bags greater impact can result from greater legislation the microbead free waters act of 2015 prohibiting microbeads in personal care products is one such effort that resulted in trillions of beads no longer reaching the waters center for food safety and applied nutrition 2020b this also involves plastic reduction and collection plans for when the microplastics reach the waterways scientific advancement of remediation procedures in terms of biological chemical and physical degradation and removal are of great importance as the rise of microplastic pollution will continue to increase without microplastic management plans this proof of concept model demonstrates the need for further investigation of microplastic accumulation in the mcbs aquatic organisms some studies have looked into the effects of microplastics on fish health however few have determined how often ingested microplastics contain absorbed toxic compounds and heavy metals diepens and koelmans 2018 rodrigues et al 2019 this in turn increases comorbidity juvenile defects and starvation rates amongst aquatic species more detailed study on the abundance and effects of microplastic accumulation in aquatic species is required for a more accurate understanding of this ever increasing problem 5 conclusions microplastics are an increasingly important issue to address as accumulation is a risk factor for all aquatic species these microplastics particles have the potential to contaminate marine organisms which can provide deleterious effects on both the organism and the humans that consume the seafood plastic management plans are needed to help mitigate this issue as less plastic in the oceans bays and waterways will prevent severe accumulation in aquatic species and ultimately humans as well ecosystem models such as the study s proof of concept model presented herein can be used to demonstrate and understand the trophic pathways that lead to microplastic accumulation in aquatic ecosystems and ultimately human consumption with some additional research and monitoring data this model can be used to inform management by demonstrating potential scenarios for microplastic accumulation in the aquatic species of the mcbs as well as in the humans who consume commercially important species taken from the waters of the mcbs ecosystem as this model was developed using modeling software that has widespread use around the world this modeling approach can be adapted to other regions for this purpose anthropogenic activity has resulted in considerable microplastic pollution of our world s ocean perceptions about the risk and the broad global nature of the problem may result in limited or no action to resolve the issue more local scale modeling such as what we have demonstrated here which connects the local sources of the pollution to local impacts may be a useful way to organize information to develop local solutions author statement jessica boyer conceptualization writing reviewing and editing methodology data curation investigation kasondra rubalcava visualization reviewing and editing methodology software howard townsend conceptualization reviewing and editing methodology software writing shawn booth methodology troubleshooting reviewing and editing software funding this work was supported and funded in part by the ernest f hollings scholarship through the national oceanic and atmospheric administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2021 109849 appendix supplementary materials image application 1 
24518,conceptual context wildlife crop consumption is a worldwide problem this paper builds on the theoretical framework of profit and utility maximization from economics as established in the theory of optimal foraging bringing this perspective to the issue of wildlife crop consumption by testing whether elephants forage for crops in an optimal way methodological approach using combinatorial optimization in an agent based model in which elephants objective is to find a valid walk that maximizes their energy balance we used empirical data from gps collars on african savanna elephants to train and test the model main results and conclusions when we focused solely on which terrain blocks the elephants of gnp visit and spend time in our abm got 56 percent of these blocks correct our abm performed roughly 25 percent better than two alternative models including the random walk model in both subsamples of data that we looked at the abm performed better in terms of fitting the data on real walks than the alternative models the abm s performance improved and the alternative models performance worsened when we only looked at data on real walks that involve crop consumption this suggests that there is more randomness involved when elephants are engaged in foraging activity that do not include crop consumption at the same time elephant walks involving crop consumption seem to more closely follow optimizing principles findings from this abm approach support ecological understanding of elephant crop foraging highlighting the optimal movements involved in crop foraging events as well as the importance of trespassing costs and landscape configuration it may give conservationists and policy makers a starting point to use in formulating policies to minimize the harms and costs that result from elephant crop consumption keywords crop consumption crop foraging crop raiding individual based models agent based models optimal foraging combinatorial optimization lattice walk 1 introduction wildlife crop consumption is a worldwide problem driven by complex interactions between animal foraging behavior and agricultural decision making madden 2004 hill 2018 marchini et al 2019 interdisciplinary research that aims to understand the phenomenon from multiple angles is key to finding both the drivers and potential solutions shaffer et al 2019 methods and perspectives from several research fields have increased our understanding of key elements of elephant crop consumption among which are foraging ecology pretorius et al 2012 movement ecology branco et al 2019 landscape ecology buchholtz et al 2020 psychology jadhav and barua 2012 and political ecology mariki et al 2015 yet until now there has been limited involvement of economic sciences taruvinga and gumpo 2018 in order to bring an economic perspective to the understanding of the complex interactions between wildlife and their environment we apply the theoretical framework of profit and utility maximization from economics as established in the theory of optimal foraging and apply this to wildlife movements and crop consumption the theory of optimal foraging originates from combining the economic theory of maximization with natural selection principles and was originally used to assess the decision rules animals use to maximize their net rate of food intake while foraging krebs 1977 macarthur and pianka 1966 the framework of optimal foraging led to the development of optimal diet theory according to which qualitative differences in food types influence the choice of an optimal diet pulliam 2016 this theory often accurately predicts the dietary decisions of herbivores sih and christensen 2001 animals choose their diet to maximize energy and micro nutrient intake and adjust their diet selection to seasonal changes while minimizing intake of secondary compounds as tannins pretorius et al 2012 schmitt et al 2016 vogel et al 2020a with their high levels of nutritional quality chiyo et al 2005 rode et al 2006 crop consumption can thus be considered an optimal foraging strategy sukumar 1990 therefore combining optimal foraging theory with agent based models based on economic concepts such as the mean value theorem can provide useful insights into wildlife foraging behavior nonaka and holme 2007 agent based models are well suited to test processes and theoretical frameworks behind herbivore foraging behavior dumont and hill 2004 agent or individual based modeling abm ibm is a computational approach that simulates the interactions among individual agents or components in a system in order to understand the overall properties of the system based on those interactions mclane et al 2011 citing grimm et al 2005 abm based approaches are increasingly used in ecology to model the movement of individual animals and their interactions with the landscape agents within the simulation models can be designed to be aware of their environment to interact with and adapt to it and to be goal driven in their movements mclane et al 2011 the parameterization of the model allows researchers to test certain questions about movement internal states external factors navigation and wildlife environment interactions that include and extend work based on empirical movement data tang and bennett 2010 abms have been increasingly applied to ecology in a broad range of systems they have been used to investigate for example interactions between animals and their dynamic habitats how variation in resources influences livestock foraging fust and schlecht 2018 how jaguar populations interact with their habitats watkins et al 2015 and whether animals forage in optimal ways nonaka and holme 2007 they have also been used to answer applied conservation and management questions such as whether agriculture creates ecological traps simon and fortin 2020 the most effective means of eradicating agricultural pests such as wild pigs burton et al 2013 or if partial fencing can help reduce wildlife vehicle collisions ascensão et al 2013 the conservation challenges of wildlife crop foraging are a particularly useful application for abms many factors play a role in the drivers and consequences of human wildlife interactions ranging from nutritional demands to spatial configuration of the landscape data and predictions about these factors can then inform the parameterization and application of abms to test hypotheses and simulate wildlife environment interactions under different situations the african savanna elephant is one species of conservation concern that is widely implicated in crop consumption resulting in a wide variety of mitigation efforts being employed denninger and rentsch 2020 mamboleo et al 2021 used abms to investigate the adverse impacts of human elephant interactions including crop foraging however abms may also be applied to better understand the patterns of movement that are associated with crop foraging behavior elephants which have the sensory and memory capabilities to perceive and intelligently navigate the landscape polansky et al 2015 tsalyuk et al 2019 provide an opportunity to study optimized movement in the context of crop foraging in this paper we use optimal foraging theory to explore in depth how foraging decisions inform the movement of elephants engaged in crop consumption we present a computational model of elephant foraging based on the principle of energy balance maximization our objective was to use an abm to test whether elephant foraging for crops fits into this framework of maximization we employed techniques from combinatorial optimization to solve an elephant s problem of maximizing energy balance which is the benefit of consumption net of the cost of foraging and we calibrated the model using the method of particle swarm optimization kennedy and eberhart 1995 we used an existing dataset of movements of male elephants in gorongosa national park gnp mozambique to calibrate our model and estimate the abm parameter values we found that the abm performs 25 percent better than a random walk model and another model which we call the local maximization model based on simon and fortin 2020 at predicting elephant movement on the landscape indicating that elephant foraging follows a global maximization pattern rather than one that is purely random or opportunistic moreover when we focused on the subset of the elephant movement data that involves crop consumption our abm performed more than 50 percent better than the random walk and local maximization models at predicting elephant movement our model shows that elephants derive a high benefit from consuming crops but that a high cost of trespassing reduces the net benefit of crop consumption and disincentivizes this behavior 2 materials and methods a complete detailed description of our model following the odd overview design concepts details protocol grimm et al 2006 2020 is given in appendix a here we provide an overview and summary of it 2 1 model description overall the purpose of our model is to predict the spatial movement and foraging patterns of elephants using an optimization framework in order to better understand elephant crop consumption we note that although crop raiding is the more commonly used term to refer to elephants entering agricultural fields and consuming or destroying crops cultivated by farmers we follow vogel 2018 in using the term crop consumption instead the model consists of the following elements an agent representing an elephant and a discrete two dimensional space i e lattice in which the elephant moves and forages for descriptive and visualization purposes we represent each element of the lattice which we will also refer to as the model map as a block rather than a point to incorporate food and water sources into the model each block of the model map is specified as one of the following four types water block representing where there is a water source tree block representing where there are grass and trees crop block representing where there are croplands and farms and savanna block representing where there is no food or water source see appendix b for the algorithm that we used to classify the terrain blocks in our model in addition some blocks of the model map are designated as refuge blocks which represent the daytime resting places of the elephant based on observations from the dataset we have on the movements of elephants in gnp we assumed in our model that the elephant starts each day of foraging from a refuge block and at the end of the day no matter what path he 1 1 since the elephant movement data we have come from male elephants only we use he him his in talking about the elephant in our model chooses he must return to a refuge block an illustration of the model space and the types of blocks in the model is given in fig 1 at a block with water or food the elephant consumes at a constant rate a water at a water block a tree at a tree block and a crop at a crop block for our purposes we are interested in the total amount of food γf which is a function of a tree and a crop and the total amount of water γw which is a function of a water that the elephant can obtain in a day of foraging we assumed that a crop a tree since crops are generally of higher nutritional quality compared to trees or grass see table 1 for a list of all parameters for our abm walking is a costly activity in terms of energy expenditure so the model keeps track of how many steps where a step is a movement from one block to a neighboring block that the elephant takes in one day visiting crop blocks and staying there to consume crops is a risky activity in the sense that the elephant could get hurt if farmers have put in place protective measures to prevent animals from consuming their crops and the longer the elephant stays in a crop block presumably the greater the potential harm that the elephant will suffer hence the model also keeps track of the amount of time the elephant spends in crop blocks in a day of foraging in terms of temporal scale the model generates the movement of the elephant over one day we assumed that the elephant has k discrete time periods in a day to forage and we used data we have on the movements of elephants in gnp to set the value for k our model map is based on gnp specifically the region between 33 96 e and 34 7 e in longitude and between 18 6 s and 19 3 s in latitude an area that is approximately 78 km 78 km we discretized this region to obtain a 30 30 lattice which allows us to preserve most of the details of the land cover map of gnp while allowing our computational algorithm to run in a reasonable amount of time see appendix a section 5 for details regarding the discretization see appendix c for how the model map varies with respect to block size this yields 900 square blocks each with an area of 2 596 km 2 596 km or 6 7 km2 fig 2 shows the land cover map of gnp and our discretized version of the map our computational work consists of two main procedures 1 finding an optimal path given a model map an initial position for the elephant and the time constraint on foraging find a path that maximizes the elephant s objective function which takes into account the total food and water that can be obtained as well as the costs from walking and trespassing on croplands the algorithm we have developed for this purpose is described in detail in appendix a 2 finding the best fitting parameter values for the model using data from elephants in gnp we employed a similarity measure in order to quantify the goodness of fit between the elephant movements predicted by our model and the movements of elephants in gnp we then used an optimization algorithm to find the parameter values for the model that best fit the data that we have this estimation strategy of calibration is widely employed in economics a trend that was started by kydland and prescott 1982 in terms of design principles the basic idea behind our model is to utilize optimal foraging theory and conceive of an elephant as an optimizing agent that chooses a path of movement and foraging to maximize the difference between the benefit from consumption of resources and the costs from movement and trespassing on farmlands which for convenience we will refer to as energy balance charnov 1976 in related work boult et al 2018 used individual based modeling to study how changes in food availability affect the behavior of elephants that research however focused on demographic changes and population dynamics which we do not address since we are interested in elephant movement and foraging behavior within a single day the study by simon and fortin 2020 is closer in spirit and objective to our work specifically they presented an individual based model of crop consumption by bison within an optimal foraging framework there are significant differences between their model and ours however first whether the agent in simon and fortin s model changes location or stays in its current area at each time step is fixed probabilistically by the modeler and not based on optimization principles in our framework whether the elephant stays or moves in every time period is determined by the solution to a maximization problem second the agent in simon and fortin s model behaves myopically in the sense that each time the agent changes location it chooses where to move to next by only considering the gains from that move without taking into account how that move could impact the gains from subsequent moves this means that in their model there is no guarantee that the agent will obtain the diet that is optimal in a global sense in contrast the optimal movement derived from our model is global in that every move the elephant makes is part of the path that maximizes his net benefit over the course of a day third the energy expenditure of movement is not captured by the model in simon and fortin 2020 this cost is explicitly incorporated in our model in addition to the cost of trespassing on croplands our algorithm for finding the elephant s optimal path in the model map requires that the algorithm be able to compute for any location that the elephant is at and in any time period of the day the set of paths that satisfy the spatio temporal constraints that we impose in this respect our concept of a single trip neighborhood defined formally in appendix a is analogous to that of a space time prism used in loraamm 2020 note however that our model is conceptually distinct from that described in loraamm 2020 our model is built on an optimization foundation which allows us to make predictions about agent movements based on the assumption that the agent behaves so as to maximize an objective function while the loraamm model is not for the elephant s objective or energy balance function we used the following specific functional form γ f α γ w 1 α m c move t c tres where 0 α 1 c move is the cost of moving from one block to a neighboring block c tres is the cost of trespassing on a crop block in one time period m is the number of movements the elephant makes in a day of foraging and t is the number of periods the elephant spends in crop blocks in a day the cobb douglas function γ f α γ w 1 α for the benefit from consumption is a commonly used functional form for utility functions and production functions in economics deaton and muellbauer 1980 the functional form we used has two key properties 1 there is constant returns to scale i e doubling the amount of food and water consumption exactly doubles the benefit from consumption and 2 without any water any consumption of food yields no energy revenue similarly without any food any consumption of water yields no energy revenue the latter property thus rules out outcomes in which the elephant will only search for water and neglect food or only search for food without looking for water we note however that nothing in our modeling framework depends on the benefit from consumption having the specific functional form given i e other specifications could be utilized as well without changing the model setup or framework 2 2 empirical data we used a movement dataset for 12 male elephants living in gnp between december 2015 and november 2017 with gps locations reported at 30 minute intervals branco et al 2019 we removed any movement data which appeared to have measurement or recording errors e g points reported in north america which left us with 246 139 observations of 10 elephants the extent of the study area including these movements falls within 33 96 e and 34 7 e in longitude and between 18 6 s and 19 3 s in latitude crop consumption data was based on an enumerator dataset provided by branco et al 2019 that gives detailed information on crop consumption events by elephants along the pungue river from august 2016 to january 2018 we processed the data with python s pandas library mckinney 2010 based on seasonal patterns of the elephants movement and crop consumption behavior see appendix d we restricted our attention to the late dry and early wet season august to december which is the period during which most crop consumption events take place we used data from december 2015 and august december 2016 to fit the parameters of our model as data from 2017 were likely impacted by the construction of fences in various locations along the pungue river for research on elephant crop consumption deterrents branco et al 2020 by examining the elephants diurnal movement patterns see appendix a section 5 we made the assumption that foraging takes place between 4pm and 6am of the next day a total of 14 hours since the elephants gps collar data are recorded every half hour we can get a list of 29 locations starting at 4pm from the same elephant in the dataset for each of these locations we identified which block in the model map he occupied and recorded the location of this block this set of block locations from an elephant constitutes the actual walk data the real walks that we used to compare our simulated walk data to based on the date and time range we are interested in our dataset yields a total of 1442 real walks for reference fig 3 shows the gps collar data from one elephant in the dataset manoel over one week in december 2015 and the discretized version of this movement data we visualized the data with python libraries opencv and matplotlib hunter 2007 bradski 2000 2 3 model parametrization and calibration in this section we give an overview of the procedure we used to estimate the parameter values of our model for a full description see appendix a we assumed in our model that an elephant can forage 6 times in a day in the dataset we used elephant walks that include visits to crop blocks average 5 3 steps while walks that do not involve crop blocks average 3 8 steps since k represents the upper bound for how many block steps the elephant can take in a day of foraging we chose to round up from 5 3 and use 6 steps to quantify the goodness of fit between the real walks in our dataset and the simulated walks produced by our abm we employed a slight variation of the overlap coefficient oc which is also known as the szymkiewicz simpson coefficient vijaymeena and kavitha 2016 this index is a similarity measure that quantifies the overlap between two finite sets and ranges between 0 and 1 with a higher number indicating greater similarity between the two datasets that are being compared we chose to use the overlap coefficient in this paper because we are interested in the extent to which the blocks that the elephant visits in our abm coincide with the blocks that the elephants in gnp go to or spend time in because the elephants in our model obtain the same energy balance by traversing the blocks in reverse order the direction of movement has no effect on energy balance therefore given any path of elephant movement we are not concerned about matching the temporal dimension of the elephant s path i e the timing is not important rather we focus only on maximizing the goodness of fit of our model along the spatial dimension i e where the elephant actually goes to we employed the following modified overlap coefficient moc moc x y x y x where x is the set of unique blocks visited in a real walk and y is the set of unique blocks visited in a simulated walk using moc as our similarity measure allows us to directly interpret its value as the proportion of blocks that the real elephants visit that is predicted by our abm notice that the moc also allows us to directly compare the predictive power of different models since the value in the denominator would remain the same for all models for our model we need to estimate six parameters a crop a tree a water c move c tres and α due to the large search space we have we calibrated our model using particle swarm optimization pso kennedy and eberhart 1995 pso is an algorithm that solves an optimization problem by iteratively trying to improve a candidate solution given some performance metric the moc in our case it solves a problem by using a population of particles which represent candidate solutions and moving these particles around in the search space a particle s movement over time is influenced not only by its own best position local influence but the particle is also guided toward the best known global positions in the search space which are updated as better positions are found by other particles social or global influence this process is expected to move the swarm of particles towards the best solutions after a sufficient number of iterations we implemented pso to find the best fitting set of parameter values for our abm using the pyswarm package in python miranda 2018 2 4 model performance and validation to get a benchmark that we can use to compare our results to we simulated elephant movement using a naïve model in which the elephant chooses a path randomly starting from a refuge block a detailed description is given in appendix e we considered two versions of this random walk model one in which the elephant is not constrained to return to a refuge block at the end of the day rw 1 and one in which the elephant has to return to a refuge block at the end of the day rw 2 for another benchmark we also simulated another model that is based on the simon and fortin 2020 model for convenience we refer to this model as the local maximization model a detailed description is given in appendix f since each time the elephant makes a move in this model he only considers whether the move is optimal in a local sense not in a global sense like in our model just like with the random walk model we tested two versions of the local maximization model lm 1 in which the elephant is not constrained to return to a refuge block at the end of the day and lm 2 in which the elephant is subject to the constraint that he must return to a refuge block at the end of the day to determine whether there are significant differences between real walks that included crop consumption and those that did not involve any visits to crop blocks we divided the dataset of real walks into two sub samples the first consisted of only real walks involving crop consumption the crop consumption sample and the second of only real walks that do not include visits to crop blocks the non crop consumption sample we then calibrated our abm using each subset separately and estimated the model parameter values twice once using only the crop consumption sample and once using only the non crop consumption sample for each of these calibration exercises we also simulated elephant walks using the random walk model and the local maximization model so that we can again see how well the abm performs relative to the other models for our model validation exercise we employed the 80 20 train test validation method we also used k fold cross validation in addition we performed sensitivity analysis of our parameter estimates to check how changing their values affected our model s goodness of fit with the data 3 results 3 1 the main results when we focused solely on which blocks the elephants of gnp visit and spend time in our abm gets 56 percent of these blocks correct table 2 while there was only a slight difference between the performances of the random walk model and the local maximization model based on simulated data compared to real elephant data our abm performed about 25 percent better than these alternative models to gain a better understanding of elephant crop consumption behavior we examined our dataset of real walks to find out how often elephants engaged in crop consumption of the 1442 real walks in our sample 257 of them which is about 18 of the total involved visits to at least one crop block in other words for the time period we looked at the elephants of gnp did not engage in crop consumption at a significantly high level tables 3 and 4 show the results when we split our dataset into two subsets one consisting of real walks involving visits to crop blocks and one consisting of real walks that do not and calibrated our abm separately the tables also give the results from using the random walk model and the local maximization model in both samples the abm performed better in terms of fitting the data on real walks than the random walk or the local maximization model furthermore the abm s performance improved and both the random walk model and the local maximization model performed worse when we only looked at data on real walks that involve crop consumption table 3 henceforth we focus on the results obtained from the crop consumption sample fig 4 gives a visual comparison of our model with the random walk model and the local maximization model it shows the set of blocks in the model space that are visited by elephants in gnp in our crop consumption sample as well as the set of blocks that are visited by the elephant agent in our abm the random walk model and the local maximization model 3 2 model validation and sensitivity analysis in order to check the reliability of the goodness of fit figures we obtained from calibrating our model we used an 80 20 train test split of the data specifically we trained our abm by randomly selecting 80 percent of the real walks in the crop consumption sample and calibrating or tuning our model using this training dataset using the parameter values obtained from calibrating our model on this training set we then checked how well the trained model predicted the observations in the remaining 20 percent of the dataset the testing set the training score in terms of moc we obtained was 0 657 and the testing score again in terms of moc was 0 602 this is in line with the moc for our abm presented in table 3 and shows that our model performs at least 50 percent better than the random walk or the local maximization model for a robustness check we also performed 8 fold cross validation speficially we randomly partitioned our sample of real walks into eight subsets we can selected seven of those subsets as our training dataset to calibrate our abm once we have obtained the parameter estimates from our calibration exercise we then used the remaining subset of data as our testing set to see how well the calibrated model fits the data we performed the calibration exercise eight times so that each subset of data was used as the testing dataset once the average training score in terms of moc we obtained is 0 628 and the average testing score is 0 617 we also performed local sensitivity analysis cacuci 2003 of our parameter estimates for our abm more specifically for each of the six parameters a crop a tree a water c move c tres α we varied its value while fixing the rest of the parameters at their estimated values to see how moc our measure of goodness of fit was affected fig 5 shows the results using the crop consumption sample notice that moving the value of a parameter away from our estimate either does not change the goodness of fit or worsens the fit of our model 3 3 implications of parameter estimates to get a sense of the meaning and the implications of the parameter estimates given in tables 2 4 let us consider the following thought experiment suppose given the elephant s current location he is faced with the following two options go to a crop block x blocks away and consume for one period or go to a tree block y blocks away and consume for one period where x y assuming that the elephant has so far consumed f units of food and w units of water his gain from going to the crop block is g f a crop w x c move c tres g f w and his gain from going to the tree block is g f a tree w y c move g f w hence going to the crop block is preferable i e the gain from the crop block is higher than the gain from the tree block if g f a crop w x y c move c tres g f a tree w 0 while going to the tree block is the better option if this inequality is reversed notice that once we have the values of a crop a tree c move c tres and α whether the tree block or the crop block is preferred depends on f w and x y for convenience let us refer to the set of food water combinations f w such that g f a crop w x y c move c tres g f a tree w 0 for a given value of x y 0 as the crop tree indifference curve based on the parameter estimates given in table 3 derived from the crop consumption sample we plotted the crop tree indifference curve in fig 6 assuming that x y 0 i e assuming that the tree block and the crop block are the same distance away from an elephant the set of food water combinations for which the elephant prefers the crop block are those that lie above the crop tree indifference curve and the combinations for which the elephant prefers the tree block are below the indifference curve several observations about crop consumption behavior can be obtained by looking at fig 6 based on the model parameter estimates derived from the crop consumption sample of real elephant walks we can see that all else being fixed the elephants derive a high net benefit from crops this follows because the set of food water combinations f w which represent the elephant s consumption of food and water up to that point for which the elephant gains a higher net benefit from visiting a crop block is much larger than the set of food water combinations that lead to a higher net benefit from a tree block another observation is that the cost of trespassing c tres affects the placement of the crop tree indifference curve and hence the set of food water combinations for which the crop block yields higher energy balance specifically increasing the cost of trespassing moves the crop tree indifference curve upwards and thus reduces the set of food water combinations that lead to a higher net benefit from visiting a crop block a third observation is that changing the distance of the crop block or the tree block from the elephant alters the placement of the crop tree indifference curve if there is a cost associated with movement i e c move 0 then making the crop block further away relative to the tree block moves the crop tree indifference curve upwards as well with our calibrated abm we are able to perform some numerical experiments to study how changes in the elephant s landscape or environment can affect his optimal walk and hence his propensity to consume crops fig 7 shows how the total number of periods the elephant spends in crop blocks over 10 simulations varies with respect to the cost of trespassing on crop blocks where the other parameter values are as given in table 3 as the results show the incidence of crop consumption decreases monotonically as the cost of trespassing increases and crop consumption drops significantly once the trespassing cost reaches a threshold level 4 discussion understanding the drivers of wildlife crop foraging is a particularly important aspect of the interactions among wildlife people and the environment in social ecological systems our approach grounded in economic and ecological theories provides new insights into the decisions behind elephant crop foraging movements based on empirical movement and landscape data from mozambique our abm revealed that elephant crop foraging does fit into a framework of optimization applying the ecological theory of optimal foraging in this way therefore helps us understand patterns of crop foraging our abm based on the principle of energy balance maximization outperformed a random walk model and a local maximization model in predicting the movements of elephants in gnp furthermore our model s performance improved both in absolute terms and in relative terms when compared to the random walk and local maximization models when we focused only on elephant walks that involve crop consumption activity this indicates that during crop foraging events elephants move more optimally than would be expected with a random walk or with a myopic planning horizon elephants have strong sensory and memory capability that allow them to perceive and remember locations of resources such as crops hart et al 2008 and by moving along optimal routes to those crops they may forage more efficiently than if they only encountered crops during undirected foraging movements our results also suggest that elephants derive relatively large gains from consuming crops this corresponds to previous longitudinal studies and can be explained by the optimal foraging theory as crops are highly nutritious and easily digestible food sources pretorius et al 2012 vogel et al 2020a resulting in high gains to compensate for this prevention and mitigation of crop foraging may rely on increasing the risk or cost to wildlife to forage in agricultural areas our findings support the idea that optimal foraging theory can be used to understand elephant movement for crop foraging for example our model highlighted that increasing the cost of going into a crop block affected the crop tree indifference curve moving it upwards and therefore reducing the food water combinations that lead elephants to prefer crops over trees our results also showed that increasing the cost of visiting crop blocks reduces the total time that the elephant spends in them physical and sensory obstacles like chili fences but also increasing the landscape of fear by simulating threats to elephants are examples of actions that could increase the cost that elephants perceive and or experience associated with crop foraging denninger and rentsch 2020 additionally our model revealed the importance of landscape configuration the distance between crops and non agricultural foraging represented by tree blocks influenced the crop tree indifference curve given our assumption that movement is costly thus elephants were less likely to prefer foraging on crops when the crops were more distant than trees this underlines the importance of deliberate land use planning that allows for increased distance between agricultural fields and areas of high elephant use songhurst et al 2016 note that in contrast to many existing models of elephant movement boult et al 2018 2019 mamboleo et al 2021 we are able to study in greater depth the significance of landscape configuration or the effects of crop barriers in our model because we have explicitly accounted for the cost of movement or trespassing on farms in our model our results point to several avenues for future research one is a deeper examination of the difference between walks involving crop consumption and walks that do not the predictive power of the random walk and local maximization models is higher when they are applied to walks that do not go to croplands this suggests that there is more randomness or less foresight involved when elephants are engaged in foraging activity that do not include crop consumption at the same time elephant walks involving crop consumption seem to more closely follow optimizing principles one possible explanation for this difference is that crop consumption is a risky activity due to measures that may have been put in place by farmers to protect their crops hence it may be more prudent for elephants to plan out their routes and find the optimal ones when they choose to visit farmlands on the other hand walks that do not include crop consumption are less risky and may not require as much foresight and planning future work could test the validity of this hypothesis as well as investigate whether there is any connection to recent findings that show that african elephants exhibit both fast exploratory movements and slow wandering encamped movements vogel et al 2020b another issue to explore is how individual differences between the elephants affect their propensity to engage in crop consumption it is known for example that male african elephants movement and behavior depend on their age and reproductive state taylor et al 2020 a major source of difference we found between crop consumption walks and non crop consumption walks may thus stem from heterogeneity in the sample of elephants in our dataset since our model can easily accommodate individual differences along various dimensions future research could look at accounting for such heterogeneity when calibrating the model extensions of the current work should also consider using alternative similarity measures to quantify the goodness of fit between the real walks and the simulated walks in particular we should note that the metric we used a slight variation of the overlap coefficient adapted for our purposes ignores how often or how long an elephant visits the blocks in the model map using a different similarity measure that captures this frequency information may improve the predictive power of our model relative to the random walk and local maximization models it may also yield additional insights about elephant crop consumption behavior that we are not able to gain with the metric we used to calibrate our model a methodological issue that should be addressed in the future is the choice of block or grid size for the model map pasquaretta et al 2021 and how this choice affects the predictive power and goodness of fit of the model we note that with the overlap coefficient as our similarity measure one way we could improve the measured goodness of fit of our model is to simply make the block size bigger this however does not imply that the model s true predictive power has increased by any means in fact one could argue that making the block size bigger actually reduces the predictive power of the model because a bigger block size essentially requires less precision in the model s predictions of elephant movement hence it is important in future work to consider what should be the optimal block size for modeling purposes and to employ a similarity measure that is invariant with respect to block size another direction for future research is to consider alternative functional forms for the energy balance function specifically the portion that represents the benefit of consumption in this paper we used the cobb douglas function that has total consumption of water and food as the only arguments future work could examine whether other functional forms could improve the fit of our model and also consider specifications whereby the food component is divided into several smaller components consisting of the major nutrients in the diet of elephants since our abm models the behavior of a single elephant agent an obvious extension to pursue in the future is to incorporate multiple elephants in the model this would allow us to study the interactions between the elephants as well as how landscape configuration and resource constraints affect those interactions having multiple elephants in our optimization framework would introduce strategic considerations into the analysis since the optimal behavior of any elephant would depend on his beliefs and forecasts regarding the behavior of other elephants put differently the optimization problems of the elephants would be intertwined and interdependent and solving them would require the use of game theory fudenberg and tirole 1991 this is a potentially novel and promising direction to move in however calibrating such a model would require a far richer dataset than we have it would necessitate having data on how the movement and foraging behavior of individual elephants depend on the presence and behavior of other elephants although the motivation for our modeling work comes from our desire to understand and minimize elephant human conflicts we note that our modeling framework could be adapted and applied to study the movement and foraging behavior of other large herbivores for these applications the types of terrain blocks used in the model map as well as the energy balance function chosen as the agent s objective function would need to be modified to suit the context of interest and for some species additional cost components such as the risk of predation may need to be added to the objective function to capture all the relevant energy expenditures and risks that the animals incur or face 5 conclusions findings from this abm approach support ecological understanding of elephant crop foraging highlighting the optimal movements involved in crop foraging events as well as the importance of trespassing costs and landscape configuration although looking only at the crop tree indifference curve ignores the dynamic and temporal dimensions of the elephant s decision problem e g how much distance has the elephant walked thus far and how far away is he from his refuge block it gives us a sense of some of the trade offs that are involved in solving the elephant s maximization problem as such it may give conservationists and policy makers a starting point to use in formulating policies to minimize the harms and costs that result from elephant crop consumption funding this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors credit authorship contribution statement haosen he conceptualization methodology software formal analysis investigation writing original draft writing review editing erin buchholtz writing original draft writing review editing frederick chen conceptualization methodology writing original draft writing review editing susanne vogel writing original draft writing review editing chu a alex yu methodology writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments comments and suggestions from participants at the ecology and evolution lunch series at wake forest university an editor of the journal and anonymous reviewers are gratefully acknowledged hh also thanks the department of mathematics statistics at wake forest university for awarding him the walter low tatum scholarship during the writing of this manuscript a special shout out goes to fritz vollrath whose question to fc about elephant crop consumption inspired this research appendix a odd protocol of the model the description of our model below follows the odd overview design concepts details protocol for describing agent based models grimm et al 2006 which was later updated grimm et al 2020 all codes for our modeling work the data used and visualization packages can be found here https github com haosenhe elephant crop raiding 1 purpose and patterns the purpose of our model is to predict the movement and foraging patterns of elephants the motivation for the study and the ultimate purpose of the model is to understand elephant crop consumption behavior in order to minimize the damages caused by human elephant conflict because we have gps collar data from elephants we are interested in the locations that elephants go to over the course of a day the specific goal for our modeling work is to provide a model that would produce predicted movements i e locations of elephants that match the observed movements 2 entities state variables and sclaes entities our model consists of the following entities agent elephant this is the entity in the model whose movement we are interested in studying lattice in our model the elephant moves around in a discrete two dimensional space lattice each element of the lattice is an ordered pair v a b where a and b are integers hence our model space is the set of ordered integers z 2 for visualization purposes we will represent each element of the lattice as a colored block rather than as a point terrain blocks each block of our model space is assigned to be one of the following types crop tree water and savanna a crop block is a block of the lattice that contains crops farmlands a tree bock is a block of the lattice that contains trees and grass and a water block is a block of the lattice that contains water together the crop blocks and the tree blocks comprise the set of food blocks we assume that a block cannot simultaneously contain water and food the savanna blocks are the blocks in the lattice that contain neither water nor food refuge blocks some of the blocks in the lattice are designated as refuge blocks these are the daytime refugia of the elephant the blocks that the elephant returns to during the day to rest and likely represent areas that feel safe for the elephant jachowski et al 2012 see also appendix a section 5 hence when the elephant starts looking for food and water he must start at a refuge block and at the end of each night he must return to a possibly different refuge block state variables consumption of food and water every food block is initially endowed with some amount of food φ 0 r this initial endowment is allowed to vary across the food blocks in the model in a food block the elephant consumes a constant amount of food per time period a crop 0 in a crop block and a tree 0 in a tree block we assume that a crop a tree to represent the higher nutritional quality of crops if the amount of food remaining in a food block is less than the elephant s consumption capability then the elephant will consume all the remaining food in that block every water block is endowed with some amount of water ω 0 r the elephant also consumes some constant amount of water a water 0 per period in a water block let γ f denote the total units of food from crop and tree blocks the elephant consumes in a day and let γ w denote the total units of water the elephant consumes in a day movement of the elephant in every time period of the model the elephant has the choice to stay in a block or go to one of the neighboring blocks we say that the elephant makes a move or a movement when he goes from one block to a neighboring block we denote the total number of movements the elephant makes in one day of foraging by the integer m and the total number of periods he spends in crop blocks in a day by the integer t scales temporal scales the model generates the movement of the elephant over the course of a day we assume that the elephant moves and forages only during the night and rests during the daytime this time constraint along with the restriction that the elephant must return to a refuge block after foraging implicitly limit how much distance the elephant can travel in the model or equivalently how many blocks the elephant can reach we assume that the elephant has k discrete time periods during the night to forage where k 0 is a parameter that depends on how fast elephants can walk note that k is also the maximum number of movements as defined above the elephant can make in one day spatial scales our model space or lattice is based on gorongosa national park gnp in mozambique specifically the region between 33 96 e and 34 7 e in longitude and between 18 6 s and 19 3 s in latitude an area that is approximately 78 km 78 km we discretize this region to obtain a set of coarser resolution blocks the choice of block size necessitates making non trivial tradeoffs involving computational time on the one hand making the blocks small gives our model map a high resolution however this increases the amount of computations and time for running our model on the other hand the resolution of our model map decreases if we make the blocks bigger to reduce computation time after some experimentation with the number of blocks we chose to go with a 30 30 lattice which allows us to preserve most of the details of the land cover map of gnp while allowing our computational algorithm to run in a reasonable amount of time this yields 900 square blocks each with an area of 2 596 km 2 596 km or 6 7 km2 see appendix c for how the model map looks with different numbers of blocks 3 process overview and scheduling our computational work consists of two general procedures procedure 1 finding the elephant s optimal movements 1 1 once all the blocks in our model map lattice have been assigned a terrain type and once the refuge blocks have been assigned the elephant is placed at one of the refuge blocks 1 2 using our computational algorithms described in detail in section 7 and given values for the model parameters the elephant picks blocks in the model map to move to subject to the constraints that i he will return to a refuge block by the end of the day and ii there are k periods in a day for him to move and forage we call a set of blocks that satisfy these constraints a valid walk for the elephant 1 3 for each valid walk that the elephant chooses we obtain the total amount of food γf and water γw that he consumes the total number of movements he makes m and the total number of periods he stays in crop blocks t this information is then used to calculate the score from that valid path our algorithm will then select the set of valid walks that yield the highest score i e the set of optimal walks below we provide an intuitive description of how our computational algorithm works because the elephant needs both food and water to derive positive energy revenue we consider every possible pairing of a food block and a water block and we ask the following questions regarding each pair is there at least one valid walk that contains that pair of food and water blocks if not then we can disregard that pair from our computations if there is then we consider the following questions what are all the valid walks that contain that pair of food and water blocks and of these what is the set of valid walks that yield the highest energy balance for the elephant by going through every possible pair of food and water blocks and finding the best valid walk if there is one associated with each one we can then compare these best valid walks to identify the one or ones that maximize the elephant s objective function over all possible valid walks procedure 2 calibrating the model using movement data of real elephants finding the best fitting parameter values for the model using actual data of elephant movements we calibrate the model and estimate the parameter values of the model as follows 2 1 randomly select parameter values for the model with these values use the steps described in procedure 1 to find the elephant s optimal walk compare this optimal walk to data of actual elephant movements to derive a goodness of fit 2 2 repeat step 2 1 100 times this step yields 100 optimal walks each associated with its own set of parameter values each set of parameter values is thus associated with a goodness of fit with the data on real elephant movements the set of parameter values with the highest goodness of fit is our candidate for the best fitting set of parameter values 2 3 using the candidate for the best fitting set of parameter values obtained from step 2 2 as a starting point and using the particle swarm optimization pso algorithm iteratively update and revise the candidate for the best fitting set of parameter values until the process converges the final candidate for the best fitting set of parameter values that we obtain is our estimate of the parameter values for the model 4 design concepts basic principles the basic idea behind our model is to utilize optimal foraging theory and conceive of an elephant as an optimizing agent that chooses a path of movement and foraging to maximize the difference between the benefit from consumption of resources and the costs from movement and trespassing on farmlands emergence given values for the model parameters the assignment of terrain type to each block in the lattice the specification of refuge blocks and the initial location of the elephant our model produces a set of optimal walks i e set of blocks to visit for the elephant adaptation given the terrain blocks in the lattice and the refuge blocks our model s algorithms 1 find the set of valid walks i e the movement patterns that satisfy the constraints that are imposed for the elephant and 2 select the set of valid walks that maximize an objective function direct objective seeking objectives the objective function has as inputs the state variables of the model total units of food consumed during a valid walk γf total units of water consumed during a valid walk γw total movements made during a valid walk m and total periods spent in crop blocks during a valid walk t the specific functional form we used is the following γ f α γ w 1 α m c move t c tres where c move is the cost of a movement and c tres is the cost of trespassing on a crop block in one time period learning our model does not include learning prediction in finding the elephant s optimal walk our model implicitly assumes that the elephant can accurately predict the future consequences of every movement he makes within a day of foraging sensing we assume throughout that the elephant has complete information about the lattice at any point in time he knows the type of every block in the model space the model parameter values as well as the amount of food water remaining in each food water block while this assumption of complete information may seem extreme we employ it for now to provide a benchmark model against which other versions of the model which assume the elephant has less information about the terrain could be compared to in future work interaction our model has a single elephant hence it does not include interaction stochasticity there are two sources of stochasticity in our model procedure 1 as described in section 3 because an optimal walk is generally not unique our algorithms will randomly with equal probability select one if there are multiple optimal walks this implies that given the same layout of terrain blocks starting position of the elephant and parameter values the model need not generate the same outcome when run multiple times procedure 2 as described in section 3 the initial values used for the calibration step are chosen randomly as described in section 3 in addition the updating step of the pso algorithm involves generating random numbers this is part of the pso algorithm in the search for the best fitting parameter values collectives our model does not include collectives observation the output of our model consists of the elephant s set of optimal walks an optimal walk yields the following observations that are recorded the set of blocks that the elephant visits the total amount of food and water consumed during the optimal walk the total number of movements made and the number of periods the elephant spends in crop blocks 5 initialization land cover we used the european space agency s climate change initiative land cover classification for the study region https climate esa int en projects land cover about land cover in and around gnp included tree cover open water cropland shrub cover grassland and built up areas based on visual ground truthing using satellite imagery from the same year us geological survey https landlook usgs gov landlook viewer html 2016 we identified that some pixels within the park that were classified as cropland and built up areas were likely misclassified and we assigned them to the grassland class we then combined shrub cover and grassland classes into a single savannah land cover class this provided us with a land cover classification with four types of land cover trees savanna crop and water to apply our computational model see fig a1 since our elephant moves from block to block in our model we discretized the land cover map and converted it into a set of coarser resolution blocks see spatial scales in section 2 we created a classification algorithm to aggregate the land cover classes to the lattice resolution blocks were assigned to land cover types based on the following thresholds in this order water 1 open water crop 20 cropland tree 50 tree cover savanna all else blocks that contained water were deliberately weighted to ensure that the distribution of land cover types in the model lattice matched the distribution of cover types in the study area at the original resolution below are more specific details of our terrain classification algorithm because each of the blocks in our map of gnp may contain more than one type of terrain e g along the pungue river a block of land could contain open water cropland and trees cover areas we need to consider how to classify every block into one of the four types our model uses the pungue river and lake urema which are located in the center of the park are two of the main sources of water for elephants in gnp gaynor et al 2018 we deliberately put more weight on the open water areas in our classification algorithm to ensure that the distribution of terrain types in our model map matches the distribution in the reduced land cover map without putting substantial weight on the open water areas in a block the river would not appear in the discretized model map meaning that the elephant would not have the river as a source for water consumption fig a2 shows our terrain classification algorithm in flowchart form how well our model map of gnp captures the land cover data we have for the park depends on the parameter values we specify for our terrain classification algorithm in appendix b we show how our model map of gnp changes as we vary the criteria that we use to classify a map block as water crop tree or savanna diurnal patterns of elephant movement and identification of elephant refuge our abm of elephant movement and foraging assumes that the elephant has a refuge block that he returns to each day to justify this assumption and identify the refuge blocks of the elephants in gnp from our dataset we proceeded as follows for every hour of the day we compared an elephant s location at that time to his location at the same time in the previous day we quantified this comparison by the square of the euclidean distance between the two locations because gnp is not far from the equator one degree latitude and one degree longitude have approximately the same length 111 km thus we treat degree latitude or longitude as a unit of length and calculate euclidean distances using longitude and latitude data more formally the distance between an elephant s location x y on some given day where x is degree longitude and y is degree latitude and his location x y the previous day at the same hour is x x 2 y y 2 hence the distance squared is x x 2 y y 2 we computed this measure for all 10 elephants that we looked at in our dataset we then used these results to calculate the average squared distance between an elephant s location on two consecutive days at the same hour for convenience we refer to this measure as the elephants location inconsistency intuitively location inconsistency gives us an idea of whether an elephant likes to be in certain areas at the same time every day for example if location inconsistency is low for a certain hour of the day then that means an elephant tends to be in the same location at that hour of the day on the other hand a high level of location inconsistency for some hour of the day indicates that at that hour of the day the elephant does not have a favorite place to be and is in different places on different days fig a3 shows the average location inconsistency across all 10 elephants for each hour of the day notice that the elephants locations are very consistent or stable between 6am and 4pm we also computed location inconsistency from comparing an elephant s location to the average location of the elephant from the previous three days at the same hour i e time of day the results are shown in fig a4 and exhibit the same pattern based on this finding we chose the elephants location at 4pm as their refuge block in simulating their movements using our abm for the purposes of our modeling exercise we also used this result to make the assumption that foraging takes place between 4pm and 6am the next day a total of 14 h fig a5 shows the refuge blocks of the 10 elephants in our dataset on four different dates initial endowment of food and water we are interested in modeling an elephant s movement at the timescale of a day therefore we assumed that the initial endowment in a food block φ 0 is sufficiently high so that each food block contains more than enough food for an elephant to consume in a day intuitively this assumption implies that when the elephant moves from one block to another it cannot be due to the former block running out of food this allows us to focus on how the spatial distribution of resource rather than quantity constraints on resources affects the movement pattern of the elephant at the temporal scale we use for the same reason we assumed that the initial endowment of water ω 0 is sufficiently high relative to the rate of water consumption a water 6 input data the model does not use input data to represent time varying processes 7 submodels procedure 1 finding the elephant s optimal movements model description in every time period the elephant given the block he is located at chooses to remain at his current block or move to one of the eight closest neighboring blocks we define distance in the model in terms of the minimum number of periods it takes the elephant to go from one block to another more formally the distance between two blocks v a b and v a b is d v v max a a b b for any integer k 0 a path that the elephant takes in k periods starting from some block v 0 can be represented as a lattice walk of length k which is a sequence of ordered pairs v 0 v 1 v k where v i z 2 for all i 0 1 k such that d v i v i 1 1 for all i 0 1 k 1 we note that the same block may appear more than once in a lattice walk this is because the elephant can stay in a block for more than one period and because the elephant can visit a block multiple times because the elephant can stay in a block rather than move to another block we will say that the elephant makes a move or a movement from v to v if d v v 1 a trivial walk τ is a lattice walk v 0 v 1 v k such that v i v 0 for all i 0 1 k we assume that the elephant moves and forages only during the night and rests during the day see section 5 this time constraint implicitly limits how much distance the elephant can travel in the model let us assume that the elephant has k time periods during the daytime to forage where k 0 is some given integer i e he can choose any lattice walk of length k starting from his initial block in any day we will denote the terrain blocks as follows n the set of crop blocks m the set of tree blocks w the set of water blocks d the set of savanna blocks together the crop blocks and the tree blocks comprise the set of food blocks f i e f n m we assume that a block cannot simultaneously contain water and food f w the savanna blocks are those in the model that contain neither water nor food i e d z 2 f w the set of refuge blocks is denoted by r we assume that r w r n let us denote by ψ the set of lattice walks of length k that start and end at refuge blocks i e the lattice walk v 0 v 1 v k is in ψ if v 0 r and v k r the set ψ gives us all the possible routes which we will refer to as valid walks that the elephant can take in one night of foraging based on the elephant movement data from mozambique that we examined see section 5 we chose r to be a singleton set that consists of only one block r elephant s objective moving and foraging are costly in terms of energy for the elephant whenever the elephant makes a move from one block to another one in a time period he incurs a moving cost c move 0 foraging in a crop block is risky as the elephant s activity may be discovered by farmers who may take actions to chase away or harm the elephant we thus assume that the elephant incurs a trespassing cost c t r e s 0 for every period he is in a crop block therefore from a valid walk in which the elephant makes m movements and spends t periods in crop blocks the total cost incurred is c m t m c move t c tres the elephant obtains energy from consumption of food and water if the elephant consumes γ f units of food and γ w units of water during a valid walk then his energy revenue or gain is given by the function g γ f γ w in all of our analysis below we utilize the cobb douglas function g γ f γ w γ f α γ w 1 α where α 0 which is a commonly used specification for utility functions and production functions in economics putting everything together given any walk that has m movements involves spending t periods in crop blocks and yields γ f units of food and γ w units of water the elephant s objective function is v γ f γ w m t g γ f γ w c m t γ f α γ w 1 α m c move t c tres we need to restrict our attention to valid walks however let z ψ r 2 z 2 be the function that given a valid walk yields γ f γ w m t where γ f and γ w respectively are the amounts of food and water consumed in that walk m is the number of movements made during the walk and t is the number of periods spent in crop blocks during the walk therefore given a valid walk ψ the elephant s utility in the jargon of economics gained from that walk can be expressed as u ψ v z ψ for convenience we will refer to the elephant s objective function as his energy balance function we assume that in each day the elephant s goal is to find a valid walk that maximizes his energy balance function i e the elephant s optimization problem is max ψ ψ u ψ this is therefore a combinatorial optimization problem subject to the constraint that the elephant must return to a refuge at the end of each day let ψ denote the set of valid walks that are optimal i e ψ arg max ψ ψ u ψ below we describe a computational algorithm for solving the elephant s optimization problem remark given a valid walk ψ the energy balance the elephant gains from ψ is the same as the energy balance he gains from walking ψ in reverse order since both walks produce the same γ f γ w m and t hence in our computational model we consider a valid walk and the same walk in reverse order to be equivalent finding all valid walks the p visit algorithm first we devise an algorithm that finds all the possible lattice walks of some length x between two blocks v and v that do not pass through the set of prohibited blocks r for convenience we will refer to this algorithm as the p visit algorithm this algorithm is used to create segments sub walks of a valid walk and we connect these segments together to create a valid walk when connecting sub walks the ending block of one sub walk is the same as the starting bock of the next sub walk to avoid double counting of blocks the sub walks generated by the p visit algorithm does not include the ending block given some block v and integer x define the single trip neighborhood s t n v x to be the set of blocks that the elephant can reach in x periods starting from block v let ω be a walk from block v to block v that takes x periods we know that for any block v in ω if it takes y periods to go from block v to block v then the sub walk from block v to block v must take x y periods this means that v s t n v y s t n v x y because we cannot have blocks in r we get v s t n v y s t n v x y r by varying y from 0 to x and combining the blocks that we get we can find the set of all lattice walks between block v and block v that take x periods and do not pass through any refuge blocks as the following cartesian product 1 s t n v 0 s t n v x r s t n v 1 s t n v x 1 r s t n v x 1 s t n v 1 r if s t n v y s t n v x y r for some y 0 1 x 1 then there exists no lattice walk of length x between v and v remark as noted above we do not include the last block s t n v x s t n v 0 r in our algorithm because it is the ending block v which overlaps with the following sub walk we note also that some of the elements in the cartesian product 1 may not be well defined lattice walks in a lattice walk the elephant can move a distance of at most one block in a single time period however the algorithm given by 1 does not guarantee this for example given v 0 0 v 1 1 x 3 and r one of the outputs of 1 is 0 0 0 0 2 2 1 1 but d 0 0 2 2 1 to resolve this issue we devised a special cartesian product generator that only yields well defined lattice walks this generator is a revised version of the product function in the python itertools package van rossum 2020 we denote this special cartesian product as π to summarize here are the steps for the p visit algorithm for finding valid walks step 1 receive locations v and v length x and the set of habitat locations r step 2 calculate π y 0 x 1 s t n v y s t n v x y r and return boolean false if s t n v y s t n v x y r for some y 0 1 x 1 reducing the search space the main algorithm the goal of our main algorithm is to produce the solution set ψ given the habitat block r and the number of periods to forage k however this is a np hard problem hence a brute force algorithm that exhaustively searches all elements in ψ would take too long instead we reduce the search space by finding a superset of ψ that is much smaller than ψ we utilize the nature of the elephant s objective function to reduce the search space the objective function has two components the benefit from food and water consumption and the cost from moving and being inside protected crop blocks the first component is non negative and the second component is non positive based on the energy balance function we can prove the following lemmas lemma 1 u τ 0 proof since no food or water is consumed in this case and no movement or trespassing cost is incurred the elephant s energy balance must be 0 lemma 2 for all ψ ψ u ψ 0 proof since the elephant can guarantee an energy balance of 0 by not moving at all lemma 1 the optimized energy balance must be non negative lemma 3 for all ψ ψ either ψ τ or there exist blocks a and b in ψ such that a w and b f proof consider the following two possibilities case 1 τ ψ in this case u ψ 0 for all ψ ψ for this to be true either ψ τ or there exists ψ ψ such that ψ τ and u ψ 0 if ψ τ then the number of movements m the elephant makes is non zero hence the total cost incurred from the walk ψ is strictly positive to ensure u ψ 0 the elephant s energy revenue from the walk must be strictly positive therefore ψ must contain both elements in f and elements in w case 2 τ ψ in this case we must have u ψ 0 for all ψ ψ for this to be true the elephant s energy revenue from an optimal walk must be strictly positive hence all walks in ψ must contain both elements in f and elements in w these two cases exhaust all possibilities given block v and a positive integer x define the roundtrip neighborhood r t n v x to be the set of blocks v such that the elephant can go from block v to block v and then back to v in x periods lemma 4 for all blocks v in ψ ψ v r t n r k proof if block v r t n r k then v cannot be an element of a valid walk hence it cannot be an element of an optimal walk let ψ be a subset of ψ such that for all ψ ψ there exist blocks a and b in ψ so that a w and b f i e ψ is the set of valid walks that contain both food and water blocks by lemma 3 we know that ψ ψ τ therefore if we restrict our search to ψ τ we are guaranteed to get the set of optimal walks our algorithm first initializes a set ψ to store the optimal walks and a float variable maxfit to store the highest score or utility from the walks based on lemma 1 we start out assigning ψ τ and maxfit 0 and then search through every element in ψ to update ψ and maxfit for some ψ ψ if u ψ maxfit then we reset ψ ψ and maxfit u ψ if for some ψ ψ u ψ maxfit then we simply add ψ to ψ if u ψ maxfit we do nothing since we start out with τ and search through ψ we search through ψ τ which is a superset of ψ hence at the end of our search we must have ψ ψ this shows that our algorithm guarantees finding the set of optimal walks we will now describe a method to search through every element in ψ recall that by the definition of ψ every valid walk ψ ψ must contain blocks w and f such that w w and f f however some water food pairs w f are not elements of valid walks and these water food pairs should be removed from consideration consider some water food pair w f by lemma 4 if w and f are elements of a valid walk then w f r t n r k thus any elements in w and f that are not in r t n r k can be discarded from our search our algorithm removes these elements by creating the sets f f r t n r k and w w r t n r k and searches for the optimal walks using only water food pairs in w f now given any water block w w and any food block f f in a walk ψ that starts and ends at r we can divide ψ into three segments or sub walks the sub walk from r to f the sub walk from f to w and the sub walk from w to r note that the walking order r f w r is the same as r w f r in our modeling framework so we will only consider walks in one order denote by ψ r f ψ f w and ψ w r respectively the sub walks from r to f from f to w and from w to r since the length of a valid walk is k we must have 2 ψ r f ψ f w ψ w r k where the notation a denotes the number of elements i e length of the sub walk a therefore if d r f d f w d w r k where d a b is the shortest length between block a and block b then the water food pair w f cannot be elements of a valid walk at the same time our algorithm thus checks given any water food pair w f w f if d r f d f w d w r k we say that the pair w f w f is eligible if this condition is satisfied given an eligible water food pair w f we will find all valid walks that contain w and f as follows first we will enumerate all possible combinations of the lengths of the possible sub walks ψ r f ψ f w and ψ w r we know that ψ r f ψ f w and ψ w r must satisfy the constraints d r f ψ r f k d f w d w r d f w ψ f w k d r f d w r d w r ψ w r k d r f d f w to begin fix ψ r f to be d r f and let ψ f w vary from d f w to k d r f d w r once ψ r f and ψ f w are determined the value of ψ w r is set from 2 next increase the value of ψ r f by 1 and repeat the process allow ψ r f to increase until it reaches k d f w d w r this way we can enumerate all possible combinations of sub walk lengths given an eligible pair w f for each combination of sub walk lengths we can use the p visit algorithm described previously to find the set of all possible walks from r to f from f to w and from w to r denote these three sets of possible walks by ψ r f ψ f w and ψ w r respectively the cartesian product ψ r f ψ f w ψ w r r is thus the set of all valid walks given the eligible pair w f and the sub walk lengths ψ r f ψ f w and ψ w r remark the above steps may yield redundant computations consider two eligible pairs w 1 f and w 2 f where w 1 w 2 after searching all possible valid walks containing w 1 f it is possible that some of them also contain w 2 f therefore when searching for all valid walks containing w 2 f we do not need to include those walks also containing w 1 f for this purpose given a food block f we initialize an empty set of prohibited blocks r and add to r any water block w that forms an eligible pair with f after all valid walks containing w f have been searched when we search for valid walks containing another water food pair w f using the p visit algorithm this specification of the set of prohibited blocks r allows us to skip the valid walks that had already been searched before thus eliminating any redundant computations fig a6 shows our lattice walk algorithm in flowchart form procedure 2 calibrating the model using movement data of real elephants finding the best fitting parameter values for the model similarity measure in order to compare the real walks in our dataset to the simulated walks produced by our abm we need some kind of metric or criterion that tells us how well our model fits the real elephant movement data we have since mathematically a real walk or a simulated walk is simply a set of data there are several similarity measures we could use to compare two datasets choi et al 2010 vijaymeena and kavitha 2016 for our metric we used a variation of the overlap coefficient oc which is also known as the szymkiewicz simpson coefficient vijaymeena and kavitha 2016 mathematically given two sets x and y the overlap coefficient is given by oc x y x y min x y this index gives us a number between 0 and 1 with a higher number indicating greater overlap i e similarity between the two sets for example if x a b c d and y l m a n c then oc x y 2 4 1 2 indicating that relative to the smaller set x the overlap between them is 50 percent we employed the following modified overlap coefficient moc moc x y x y x where x is the set of unique blocks visited in a real walk and y is the set of unique blocks visited in a simulated walk using moc as our similarity measure allows us to directly interpret its value as the proportion of blocks that the real elephants visit that is predicted by our abm notice that the moc also allows us to directly compare the predictive power of different models since the value in the denominator would remain the same for all models calibrating the abm using pso the optimization problem is to search through a 6 dimensional space to find the values for a crop a tree a water c move c tres α that maximize the similarity between the simulated walks produced by our abm and the real walks in our dataset a particle is a vector a crop a tree a water c move c tres α in r 6 and a swarm is a collection of such particles let x i t denote the position of particle i after iteration t let v i t denote the velocity of particle i after iteration t let p i t denote the best solution that particle i has found after iteration t and let g t denote the best solution that the swarm has found after iteration t pso is a dynamical system of a swarm in which the movement of each particle is given as follows 3 x i t 1 x i t v i t 1 v i t 1 w v i t c 1 r 1 p i t x i t c 2 r 2 g t x i t here w c 1 and c 2 are parameters of the pso and r 1 and r 2 are random numbers drawn uniformly randomly from 0 1 for each iteration the parameter w determines the inertia of a particle i e how much the particle continues in the direction of its previous step the parameter c 1 is the force of the local cognitive component that governs how much a particle moves toward the best location it has found on its own finally c 2 is the force of the social component that determines how much a particle moves toward the best location the swarm has found we note that as long as the values of w c 1 and c 2 are appropriate shi 2001 pso will yield the optimal set of values for a crop a tree a water c move c tres α given enough rounds of iterations we apply the rule of thumb w 0 8 and c 1 c 2 2 shi 2001 we also need to set the number of particles and the number of iterations a good rule of thumb is to use 10 particles for every parameter therefore we set the number of particles to be 60 we set the number of iterations to be 1000 although we found that the pso converged much faster than we had expected pso will automatically search all of r 6 if we do not restrict the search space therefore we also set upper and lower bounds for each parameter value it is clear that α is bounded between 0 and 1 for the other 5 parameters we set them to be bounded between 0 and 10 while we could have set other bounds such as 0 to 1000 that would simply result in a change of scale and would not affect our goodness of fit results we implement the single globalbestpso function in the python pyswarm package this function is actually designed to minimize a cost function instead of maximizing a function note however that we can transform moc into a cost function by simply adding a negative sign in front of it therefore we maximize moc by minimizing moc below we give the detailed steps of our implementation step 1 randomly generate 60 particles where each particle is a vector with six entries representing the six parameters of interest step 2 for each particle plug its elements as values of the parameters for our abm for each of the real walks in the dataset take the first entry and plug into our abm as the refuge block our model will now produce a set of simulated walks calculate the moc between the real walks and the simulated walks add a negative sign this is the value of the cost function for this particle step 3 once we have the cost for each of the 60 particles the one with the lowest cost is chosen to be the global best solution at this point since this is the first iteration all particle s own best positions are their current positions we utilize the pso system described above eq 3 to update the positions of the 60 particles which can be done using the pyswarm package in python step 4 repeat steps 2 and 3 until 1000 iterations have been completed keep updating the global best and each particle s own best position which can be done using the pyswarm package step 5 output the global best solution this particle vector is the optimal set of parameter values also output the measured goodness of fit obtained by running step 2 using the global best solution appendix b specification of the terrain classification algorithm classification of water blocks fig b1 shows how the model map of gnp changes as we vary the minimum amount of water that needs to be in a block in order for it to be classified as a water block notice that if we require the amount of water in a block to be too high in order for it to be classified as a water block then the pungue river would not appear in the model map for this reason we set the threshold amount of water that a water block needs to have to be very low classification of crop blocks fixing the minimum amount of water needed for a water block at 1 we varied the minimum amount of cropland that is necessary for a block to be classified as a crop block some selected results are shown in fig b2 classification of tree blocks fixing the minimum amount of water needed for a water block at 1 and the minimum amount of cropland needed for a crop block at 20 we varied the minimum amount of trees in a block that is required to classify it as a tree block some selected results are shown in fig b3 appendix c block size of model map fig c1 shows the model map of gnp at different resolutions using the same terrain classification scheme as given in fig a2 appendix d seasonal patterns of elephant movement and crop consumption as the histogram below shows fig d1 most crop consumption incidents happen during the 4 months from august to november which correspond to the late dry season april to october and early wet season november to march of mozambique note that this is when maize the main crop in this region ripens it is also important to note that when we looked at the movements of the elephants by location and time fig d2 the elephants movements are more spread out in the wet season when water sources are more abundant and more restricted or confined in the late dry and early wet season appendix e random walk model of elephant movement with minor and obvious modifications the first six elements of the odd protocol for the random walk model follow the first six elements in appendix a below we provide the details for element 7 submodels for the random walk model submodel 1 generating a lattice walk for the elephant rw 1 the elephant is not constrained to return to the refuge block at the end of its walk starting from the refuge block the elephant randomly selects a block in s t n c l 1 as its next block where s t n is as defined in appendix a cl denotes the elephant s current block and each block in s t n c l 1 has the same probability of being selected the process ends at the end of k periods rw 2 the elephant is constrained to return to the refuge block at the end of k periods starting from the refuge block the agent elephant randomly selects a block in s t n c l 1 s t n r e f u g e p e r i o d s l e f t 1 where periods left denotes the number of periods left in the walk and each block in s t n c l 1 s t n r e f u g e p e r i o d s l e f t 1 has the same probability of being selected submodel 2 calculating moc for each real walk in the dataset used use its refuge block as the refuge block in the random walk model either rw 1 or rw 2 execute the program and obtain a simulated elephant walk compute the moc between the real walk and the simulated walk this yields a moc for each real walk compute the average moc over all real walks in the dataset used this is the moc for one trial of running the random walk model perform 100 trials of running the random walk model and compute the average moc over all 100 trials this yields the moc reported in tables 2 4 we note that the results did not change significantly with a different number of trials appendix f local maximization model of elephant movement in simon and fortin 2020 an agent in every period stays in its current polygon with probability 0 5 and moves to another polygon with probability 0 5 if it stays then it chooses a location in its current polygon randomly if it moves then it chooses the location with the highest score a location s score is determined by the resources in it from among a set of randomly generated feasible locations the blocks in our setting are the analogues of the polygons in their setting however we do not model movement within a block here we describe the local maximization model that is based on simon and fortin s setup with minor and obvious modifications the first six elements of the odd protocol for the local maximization model follow the first six elements in appendix a below we provide the details for element 7 submodels for the local maximization model submodel 1 generating a lattice walk for the elephant lm 1 the elephant is not constrained to return to the refuge block at the end of its walk starting from the refuge block the elephant in each period stays in his current block with probability 0 5 and moves to a neighboring block with probability 0 5 if he moves then he evaluates each of the neighboring blocks as follows let γf denote his current total consumption of food and let γw denote his current total consumption of water the score of a neighboring block which is based on the energy revenue function in our model is given by γ f α γ w 1 α if it is a savanna block γ f a tree α γ w 1 α if it is a tree block γ f a crop α γ w 1 α if it is a crop block γ f α γ w a water 1 α if it is a water block the elephant then chooses the neighboring block with the highest score in case of a tie he chooses a block randomly from among the set of blocks with the highest score the process ends at the end of k periods lm 2 the elephant is constrained to return to the refuge block at the end of k periods the elephant starts from the refuge block in each period the elephant determines whether he has to move in order to satisfy the return to refuge constraint if yes then he chooses the block with the highest score as specified above from among the set of blocks he can move to in case of a tie he randomly chooses one of the highest scoring blocks if no then his decision rule is the same as in lm 1 the process ends at the end of k periods submodel 2 calculating moc for each real walk in the dataset used use its refuge block as the refuge block in the local maximization model either lm 1 or lm 2 execute the program and obtain a simulated elephant walk compute the moc between the real walk and the simulated walk this yields a moc for each real walk compute the average moc over all real walks in the dataset used this is the moc for one trial of running the local maximization model perform 100 trials of running the local maximization model and compute the average moc over all 100 trials this yields the moc reported in tables 2 4 we note that the results did not change significantly will a different number of trials for the results reported in table 2 the values of the parameters a crop a tree a water α used to run the local maximization model are the estimated values for the corresponding parameters of our abm shown in table 2 the same remark applies to the results shown in tables 3 and 4 
24518,conceptual context wildlife crop consumption is a worldwide problem this paper builds on the theoretical framework of profit and utility maximization from economics as established in the theory of optimal foraging bringing this perspective to the issue of wildlife crop consumption by testing whether elephants forage for crops in an optimal way methodological approach using combinatorial optimization in an agent based model in which elephants objective is to find a valid walk that maximizes their energy balance we used empirical data from gps collars on african savanna elephants to train and test the model main results and conclusions when we focused solely on which terrain blocks the elephants of gnp visit and spend time in our abm got 56 percent of these blocks correct our abm performed roughly 25 percent better than two alternative models including the random walk model in both subsamples of data that we looked at the abm performed better in terms of fitting the data on real walks than the alternative models the abm s performance improved and the alternative models performance worsened when we only looked at data on real walks that involve crop consumption this suggests that there is more randomness involved when elephants are engaged in foraging activity that do not include crop consumption at the same time elephant walks involving crop consumption seem to more closely follow optimizing principles findings from this abm approach support ecological understanding of elephant crop foraging highlighting the optimal movements involved in crop foraging events as well as the importance of trespassing costs and landscape configuration it may give conservationists and policy makers a starting point to use in formulating policies to minimize the harms and costs that result from elephant crop consumption keywords crop consumption crop foraging crop raiding individual based models agent based models optimal foraging combinatorial optimization lattice walk 1 introduction wildlife crop consumption is a worldwide problem driven by complex interactions between animal foraging behavior and agricultural decision making madden 2004 hill 2018 marchini et al 2019 interdisciplinary research that aims to understand the phenomenon from multiple angles is key to finding both the drivers and potential solutions shaffer et al 2019 methods and perspectives from several research fields have increased our understanding of key elements of elephant crop consumption among which are foraging ecology pretorius et al 2012 movement ecology branco et al 2019 landscape ecology buchholtz et al 2020 psychology jadhav and barua 2012 and political ecology mariki et al 2015 yet until now there has been limited involvement of economic sciences taruvinga and gumpo 2018 in order to bring an economic perspective to the understanding of the complex interactions between wildlife and their environment we apply the theoretical framework of profit and utility maximization from economics as established in the theory of optimal foraging and apply this to wildlife movements and crop consumption the theory of optimal foraging originates from combining the economic theory of maximization with natural selection principles and was originally used to assess the decision rules animals use to maximize their net rate of food intake while foraging krebs 1977 macarthur and pianka 1966 the framework of optimal foraging led to the development of optimal diet theory according to which qualitative differences in food types influence the choice of an optimal diet pulliam 2016 this theory often accurately predicts the dietary decisions of herbivores sih and christensen 2001 animals choose their diet to maximize energy and micro nutrient intake and adjust their diet selection to seasonal changes while minimizing intake of secondary compounds as tannins pretorius et al 2012 schmitt et al 2016 vogel et al 2020a with their high levels of nutritional quality chiyo et al 2005 rode et al 2006 crop consumption can thus be considered an optimal foraging strategy sukumar 1990 therefore combining optimal foraging theory with agent based models based on economic concepts such as the mean value theorem can provide useful insights into wildlife foraging behavior nonaka and holme 2007 agent based models are well suited to test processes and theoretical frameworks behind herbivore foraging behavior dumont and hill 2004 agent or individual based modeling abm ibm is a computational approach that simulates the interactions among individual agents or components in a system in order to understand the overall properties of the system based on those interactions mclane et al 2011 citing grimm et al 2005 abm based approaches are increasingly used in ecology to model the movement of individual animals and their interactions with the landscape agents within the simulation models can be designed to be aware of their environment to interact with and adapt to it and to be goal driven in their movements mclane et al 2011 the parameterization of the model allows researchers to test certain questions about movement internal states external factors navigation and wildlife environment interactions that include and extend work based on empirical movement data tang and bennett 2010 abms have been increasingly applied to ecology in a broad range of systems they have been used to investigate for example interactions between animals and their dynamic habitats how variation in resources influences livestock foraging fust and schlecht 2018 how jaguar populations interact with their habitats watkins et al 2015 and whether animals forage in optimal ways nonaka and holme 2007 they have also been used to answer applied conservation and management questions such as whether agriculture creates ecological traps simon and fortin 2020 the most effective means of eradicating agricultural pests such as wild pigs burton et al 2013 or if partial fencing can help reduce wildlife vehicle collisions ascensão et al 2013 the conservation challenges of wildlife crop foraging are a particularly useful application for abms many factors play a role in the drivers and consequences of human wildlife interactions ranging from nutritional demands to spatial configuration of the landscape data and predictions about these factors can then inform the parameterization and application of abms to test hypotheses and simulate wildlife environment interactions under different situations the african savanna elephant is one species of conservation concern that is widely implicated in crop consumption resulting in a wide variety of mitigation efforts being employed denninger and rentsch 2020 mamboleo et al 2021 used abms to investigate the adverse impacts of human elephant interactions including crop foraging however abms may also be applied to better understand the patterns of movement that are associated with crop foraging behavior elephants which have the sensory and memory capabilities to perceive and intelligently navigate the landscape polansky et al 2015 tsalyuk et al 2019 provide an opportunity to study optimized movement in the context of crop foraging in this paper we use optimal foraging theory to explore in depth how foraging decisions inform the movement of elephants engaged in crop consumption we present a computational model of elephant foraging based on the principle of energy balance maximization our objective was to use an abm to test whether elephant foraging for crops fits into this framework of maximization we employed techniques from combinatorial optimization to solve an elephant s problem of maximizing energy balance which is the benefit of consumption net of the cost of foraging and we calibrated the model using the method of particle swarm optimization kennedy and eberhart 1995 we used an existing dataset of movements of male elephants in gorongosa national park gnp mozambique to calibrate our model and estimate the abm parameter values we found that the abm performs 25 percent better than a random walk model and another model which we call the local maximization model based on simon and fortin 2020 at predicting elephant movement on the landscape indicating that elephant foraging follows a global maximization pattern rather than one that is purely random or opportunistic moreover when we focused on the subset of the elephant movement data that involves crop consumption our abm performed more than 50 percent better than the random walk and local maximization models at predicting elephant movement our model shows that elephants derive a high benefit from consuming crops but that a high cost of trespassing reduces the net benefit of crop consumption and disincentivizes this behavior 2 materials and methods a complete detailed description of our model following the odd overview design concepts details protocol grimm et al 2006 2020 is given in appendix a here we provide an overview and summary of it 2 1 model description overall the purpose of our model is to predict the spatial movement and foraging patterns of elephants using an optimization framework in order to better understand elephant crop consumption we note that although crop raiding is the more commonly used term to refer to elephants entering agricultural fields and consuming or destroying crops cultivated by farmers we follow vogel 2018 in using the term crop consumption instead the model consists of the following elements an agent representing an elephant and a discrete two dimensional space i e lattice in which the elephant moves and forages for descriptive and visualization purposes we represent each element of the lattice which we will also refer to as the model map as a block rather than a point to incorporate food and water sources into the model each block of the model map is specified as one of the following four types water block representing where there is a water source tree block representing where there are grass and trees crop block representing where there are croplands and farms and savanna block representing where there is no food or water source see appendix b for the algorithm that we used to classify the terrain blocks in our model in addition some blocks of the model map are designated as refuge blocks which represent the daytime resting places of the elephant based on observations from the dataset we have on the movements of elephants in gnp we assumed in our model that the elephant starts each day of foraging from a refuge block and at the end of the day no matter what path he 1 1 since the elephant movement data we have come from male elephants only we use he him his in talking about the elephant in our model chooses he must return to a refuge block an illustration of the model space and the types of blocks in the model is given in fig 1 at a block with water or food the elephant consumes at a constant rate a water at a water block a tree at a tree block and a crop at a crop block for our purposes we are interested in the total amount of food γf which is a function of a tree and a crop and the total amount of water γw which is a function of a water that the elephant can obtain in a day of foraging we assumed that a crop a tree since crops are generally of higher nutritional quality compared to trees or grass see table 1 for a list of all parameters for our abm walking is a costly activity in terms of energy expenditure so the model keeps track of how many steps where a step is a movement from one block to a neighboring block that the elephant takes in one day visiting crop blocks and staying there to consume crops is a risky activity in the sense that the elephant could get hurt if farmers have put in place protective measures to prevent animals from consuming their crops and the longer the elephant stays in a crop block presumably the greater the potential harm that the elephant will suffer hence the model also keeps track of the amount of time the elephant spends in crop blocks in a day of foraging in terms of temporal scale the model generates the movement of the elephant over one day we assumed that the elephant has k discrete time periods in a day to forage and we used data we have on the movements of elephants in gnp to set the value for k our model map is based on gnp specifically the region between 33 96 e and 34 7 e in longitude and between 18 6 s and 19 3 s in latitude an area that is approximately 78 km 78 km we discretized this region to obtain a 30 30 lattice which allows us to preserve most of the details of the land cover map of gnp while allowing our computational algorithm to run in a reasonable amount of time see appendix a section 5 for details regarding the discretization see appendix c for how the model map varies with respect to block size this yields 900 square blocks each with an area of 2 596 km 2 596 km or 6 7 km2 fig 2 shows the land cover map of gnp and our discretized version of the map our computational work consists of two main procedures 1 finding an optimal path given a model map an initial position for the elephant and the time constraint on foraging find a path that maximizes the elephant s objective function which takes into account the total food and water that can be obtained as well as the costs from walking and trespassing on croplands the algorithm we have developed for this purpose is described in detail in appendix a 2 finding the best fitting parameter values for the model using data from elephants in gnp we employed a similarity measure in order to quantify the goodness of fit between the elephant movements predicted by our model and the movements of elephants in gnp we then used an optimization algorithm to find the parameter values for the model that best fit the data that we have this estimation strategy of calibration is widely employed in economics a trend that was started by kydland and prescott 1982 in terms of design principles the basic idea behind our model is to utilize optimal foraging theory and conceive of an elephant as an optimizing agent that chooses a path of movement and foraging to maximize the difference between the benefit from consumption of resources and the costs from movement and trespassing on farmlands which for convenience we will refer to as energy balance charnov 1976 in related work boult et al 2018 used individual based modeling to study how changes in food availability affect the behavior of elephants that research however focused on demographic changes and population dynamics which we do not address since we are interested in elephant movement and foraging behavior within a single day the study by simon and fortin 2020 is closer in spirit and objective to our work specifically they presented an individual based model of crop consumption by bison within an optimal foraging framework there are significant differences between their model and ours however first whether the agent in simon and fortin s model changes location or stays in its current area at each time step is fixed probabilistically by the modeler and not based on optimization principles in our framework whether the elephant stays or moves in every time period is determined by the solution to a maximization problem second the agent in simon and fortin s model behaves myopically in the sense that each time the agent changes location it chooses where to move to next by only considering the gains from that move without taking into account how that move could impact the gains from subsequent moves this means that in their model there is no guarantee that the agent will obtain the diet that is optimal in a global sense in contrast the optimal movement derived from our model is global in that every move the elephant makes is part of the path that maximizes his net benefit over the course of a day third the energy expenditure of movement is not captured by the model in simon and fortin 2020 this cost is explicitly incorporated in our model in addition to the cost of trespassing on croplands our algorithm for finding the elephant s optimal path in the model map requires that the algorithm be able to compute for any location that the elephant is at and in any time period of the day the set of paths that satisfy the spatio temporal constraints that we impose in this respect our concept of a single trip neighborhood defined formally in appendix a is analogous to that of a space time prism used in loraamm 2020 note however that our model is conceptually distinct from that described in loraamm 2020 our model is built on an optimization foundation which allows us to make predictions about agent movements based on the assumption that the agent behaves so as to maximize an objective function while the loraamm model is not for the elephant s objective or energy balance function we used the following specific functional form γ f α γ w 1 α m c move t c tres where 0 α 1 c move is the cost of moving from one block to a neighboring block c tres is the cost of trespassing on a crop block in one time period m is the number of movements the elephant makes in a day of foraging and t is the number of periods the elephant spends in crop blocks in a day the cobb douglas function γ f α γ w 1 α for the benefit from consumption is a commonly used functional form for utility functions and production functions in economics deaton and muellbauer 1980 the functional form we used has two key properties 1 there is constant returns to scale i e doubling the amount of food and water consumption exactly doubles the benefit from consumption and 2 without any water any consumption of food yields no energy revenue similarly without any food any consumption of water yields no energy revenue the latter property thus rules out outcomes in which the elephant will only search for water and neglect food or only search for food without looking for water we note however that nothing in our modeling framework depends on the benefit from consumption having the specific functional form given i e other specifications could be utilized as well without changing the model setup or framework 2 2 empirical data we used a movement dataset for 12 male elephants living in gnp between december 2015 and november 2017 with gps locations reported at 30 minute intervals branco et al 2019 we removed any movement data which appeared to have measurement or recording errors e g points reported in north america which left us with 246 139 observations of 10 elephants the extent of the study area including these movements falls within 33 96 e and 34 7 e in longitude and between 18 6 s and 19 3 s in latitude crop consumption data was based on an enumerator dataset provided by branco et al 2019 that gives detailed information on crop consumption events by elephants along the pungue river from august 2016 to january 2018 we processed the data with python s pandas library mckinney 2010 based on seasonal patterns of the elephants movement and crop consumption behavior see appendix d we restricted our attention to the late dry and early wet season august to december which is the period during which most crop consumption events take place we used data from december 2015 and august december 2016 to fit the parameters of our model as data from 2017 were likely impacted by the construction of fences in various locations along the pungue river for research on elephant crop consumption deterrents branco et al 2020 by examining the elephants diurnal movement patterns see appendix a section 5 we made the assumption that foraging takes place between 4pm and 6am of the next day a total of 14 hours since the elephants gps collar data are recorded every half hour we can get a list of 29 locations starting at 4pm from the same elephant in the dataset for each of these locations we identified which block in the model map he occupied and recorded the location of this block this set of block locations from an elephant constitutes the actual walk data the real walks that we used to compare our simulated walk data to based on the date and time range we are interested in our dataset yields a total of 1442 real walks for reference fig 3 shows the gps collar data from one elephant in the dataset manoel over one week in december 2015 and the discretized version of this movement data we visualized the data with python libraries opencv and matplotlib hunter 2007 bradski 2000 2 3 model parametrization and calibration in this section we give an overview of the procedure we used to estimate the parameter values of our model for a full description see appendix a we assumed in our model that an elephant can forage 6 times in a day in the dataset we used elephant walks that include visits to crop blocks average 5 3 steps while walks that do not involve crop blocks average 3 8 steps since k represents the upper bound for how many block steps the elephant can take in a day of foraging we chose to round up from 5 3 and use 6 steps to quantify the goodness of fit between the real walks in our dataset and the simulated walks produced by our abm we employed a slight variation of the overlap coefficient oc which is also known as the szymkiewicz simpson coefficient vijaymeena and kavitha 2016 this index is a similarity measure that quantifies the overlap between two finite sets and ranges between 0 and 1 with a higher number indicating greater similarity between the two datasets that are being compared we chose to use the overlap coefficient in this paper because we are interested in the extent to which the blocks that the elephant visits in our abm coincide with the blocks that the elephants in gnp go to or spend time in because the elephants in our model obtain the same energy balance by traversing the blocks in reverse order the direction of movement has no effect on energy balance therefore given any path of elephant movement we are not concerned about matching the temporal dimension of the elephant s path i e the timing is not important rather we focus only on maximizing the goodness of fit of our model along the spatial dimension i e where the elephant actually goes to we employed the following modified overlap coefficient moc moc x y x y x where x is the set of unique blocks visited in a real walk and y is the set of unique blocks visited in a simulated walk using moc as our similarity measure allows us to directly interpret its value as the proportion of blocks that the real elephants visit that is predicted by our abm notice that the moc also allows us to directly compare the predictive power of different models since the value in the denominator would remain the same for all models for our model we need to estimate six parameters a crop a tree a water c move c tres and α due to the large search space we have we calibrated our model using particle swarm optimization pso kennedy and eberhart 1995 pso is an algorithm that solves an optimization problem by iteratively trying to improve a candidate solution given some performance metric the moc in our case it solves a problem by using a population of particles which represent candidate solutions and moving these particles around in the search space a particle s movement over time is influenced not only by its own best position local influence but the particle is also guided toward the best known global positions in the search space which are updated as better positions are found by other particles social or global influence this process is expected to move the swarm of particles towards the best solutions after a sufficient number of iterations we implemented pso to find the best fitting set of parameter values for our abm using the pyswarm package in python miranda 2018 2 4 model performance and validation to get a benchmark that we can use to compare our results to we simulated elephant movement using a naïve model in which the elephant chooses a path randomly starting from a refuge block a detailed description is given in appendix e we considered two versions of this random walk model one in which the elephant is not constrained to return to a refuge block at the end of the day rw 1 and one in which the elephant has to return to a refuge block at the end of the day rw 2 for another benchmark we also simulated another model that is based on the simon and fortin 2020 model for convenience we refer to this model as the local maximization model a detailed description is given in appendix f since each time the elephant makes a move in this model he only considers whether the move is optimal in a local sense not in a global sense like in our model just like with the random walk model we tested two versions of the local maximization model lm 1 in which the elephant is not constrained to return to a refuge block at the end of the day and lm 2 in which the elephant is subject to the constraint that he must return to a refuge block at the end of the day to determine whether there are significant differences between real walks that included crop consumption and those that did not involve any visits to crop blocks we divided the dataset of real walks into two sub samples the first consisted of only real walks involving crop consumption the crop consumption sample and the second of only real walks that do not include visits to crop blocks the non crop consumption sample we then calibrated our abm using each subset separately and estimated the model parameter values twice once using only the crop consumption sample and once using only the non crop consumption sample for each of these calibration exercises we also simulated elephant walks using the random walk model and the local maximization model so that we can again see how well the abm performs relative to the other models for our model validation exercise we employed the 80 20 train test validation method we also used k fold cross validation in addition we performed sensitivity analysis of our parameter estimates to check how changing their values affected our model s goodness of fit with the data 3 results 3 1 the main results when we focused solely on which blocks the elephants of gnp visit and spend time in our abm gets 56 percent of these blocks correct table 2 while there was only a slight difference between the performances of the random walk model and the local maximization model based on simulated data compared to real elephant data our abm performed about 25 percent better than these alternative models to gain a better understanding of elephant crop consumption behavior we examined our dataset of real walks to find out how often elephants engaged in crop consumption of the 1442 real walks in our sample 257 of them which is about 18 of the total involved visits to at least one crop block in other words for the time period we looked at the elephants of gnp did not engage in crop consumption at a significantly high level tables 3 and 4 show the results when we split our dataset into two subsets one consisting of real walks involving visits to crop blocks and one consisting of real walks that do not and calibrated our abm separately the tables also give the results from using the random walk model and the local maximization model in both samples the abm performed better in terms of fitting the data on real walks than the random walk or the local maximization model furthermore the abm s performance improved and both the random walk model and the local maximization model performed worse when we only looked at data on real walks that involve crop consumption table 3 henceforth we focus on the results obtained from the crop consumption sample fig 4 gives a visual comparison of our model with the random walk model and the local maximization model it shows the set of blocks in the model space that are visited by elephants in gnp in our crop consumption sample as well as the set of blocks that are visited by the elephant agent in our abm the random walk model and the local maximization model 3 2 model validation and sensitivity analysis in order to check the reliability of the goodness of fit figures we obtained from calibrating our model we used an 80 20 train test split of the data specifically we trained our abm by randomly selecting 80 percent of the real walks in the crop consumption sample and calibrating or tuning our model using this training dataset using the parameter values obtained from calibrating our model on this training set we then checked how well the trained model predicted the observations in the remaining 20 percent of the dataset the testing set the training score in terms of moc we obtained was 0 657 and the testing score again in terms of moc was 0 602 this is in line with the moc for our abm presented in table 3 and shows that our model performs at least 50 percent better than the random walk or the local maximization model for a robustness check we also performed 8 fold cross validation speficially we randomly partitioned our sample of real walks into eight subsets we can selected seven of those subsets as our training dataset to calibrate our abm once we have obtained the parameter estimates from our calibration exercise we then used the remaining subset of data as our testing set to see how well the calibrated model fits the data we performed the calibration exercise eight times so that each subset of data was used as the testing dataset once the average training score in terms of moc we obtained is 0 628 and the average testing score is 0 617 we also performed local sensitivity analysis cacuci 2003 of our parameter estimates for our abm more specifically for each of the six parameters a crop a tree a water c move c tres α we varied its value while fixing the rest of the parameters at their estimated values to see how moc our measure of goodness of fit was affected fig 5 shows the results using the crop consumption sample notice that moving the value of a parameter away from our estimate either does not change the goodness of fit or worsens the fit of our model 3 3 implications of parameter estimates to get a sense of the meaning and the implications of the parameter estimates given in tables 2 4 let us consider the following thought experiment suppose given the elephant s current location he is faced with the following two options go to a crop block x blocks away and consume for one period or go to a tree block y blocks away and consume for one period where x y assuming that the elephant has so far consumed f units of food and w units of water his gain from going to the crop block is g f a crop w x c move c tres g f w and his gain from going to the tree block is g f a tree w y c move g f w hence going to the crop block is preferable i e the gain from the crop block is higher than the gain from the tree block if g f a crop w x y c move c tres g f a tree w 0 while going to the tree block is the better option if this inequality is reversed notice that once we have the values of a crop a tree c move c tres and α whether the tree block or the crop block is preferred depends on f w and x y for convenience let us refer to the set of food water combinations f w such that g f a crop w x y c move c tres g f a tree w 0 for a given value of x y 0 as the crop tree indifference curve based on the parameter estimates given in table 3 derived from the crop consumption sample we plotted the crop tree indifference curve in fig 6 assuming that x y 0 i e assuming that the tree block and the crop block are the same distance away from an elephant the set of food water combinations for which the elephant prefers the crop block are those that lie above the crop tree indifference curve and the combinations for which the elephant prefers the tree block are below the indifference curve several observations about crop consumption behavior can be obtained by looking at fig 6 based on the model parameter estimates derived from the crop consumption sample of real elephant walks we can see that all else being fixed the elephants derive a high net benefit from crops this follows because the set of food water combinations f w which represent the elephant s consumption of food and water up to that point for which the elephant gains a higher net benefit from visiting a crop block is much larger than the set of food water combinations that lead to a higher net benefit from a tree block another observation is that the cost of trespassing c tres affects the placement of the crop tree indifference curve and hence the set of food water combinations for which the crop block yields higher energy balance specifically increasing the cost of trespassing moves the crop tree indifference curve upwards and thus reduces the set of food water combinations that lead to a higher net benefit from visiting a crop block a third observation is that changing the distance of the crop block or the tree block from the elephant alters the placement of the crop tree indifference curve if there is a cost associated with movement i e c move 0 then making the crop block further away relative to the tree block moves the crop tree indifference curve upwards as well with our calibrated abm we are able to perform some numerical experiments to study how changes in the elephant s landscape or environment can affect his optimal walk and hence his propensity to consume crops fig 7 shows how the total number of periods the elephant spends in crop blocks over 10 simulations varies with respect to the cost of trespassing on crop blocks where the other parameter values are as given in table 3 as the results show the incidence of crop consumption decreases monotonically as the cost of trespassing increases and crop consumption drops significantly once the trespassing cost reaches a threshold level 4 discussion understanding the drivers of wildlife crop foraging is a particularly important aspect of the interactions among wildlife people and the environment in social ecological systems our approach grounded in economic and ecological theories provides new insights into the decisions behind elephant crop foraging movements based on empirical movement and landscape data from mozambique our abm revealed that elephant crop foraging does fit into a framework of optimization applying the ecological theory of optimal foraging in this way therefore helps us understand patterns of crop foraging our abm based on the principle of energy balance maximization outperformed a random walk model and a local maximization model in predicting the movements of elephants in gnp furthermore our model s performance improved both in absolute terms and in relative terms when compared to the random walk and local maximization models when we focused only on elephant walks that involve crop consumption activity this indicates that during crop foraging events elephants move more optimally than would be expected with a random walk or with a myopic planning horizon elephants have strong sensory and memory capability that allow them to perceive and remember locations of resources such as crops hart et al 2008 and by moving along optimal routes to those crops they may forage more efficiently than if they only encountered crops during undirected foraging movements our results also suggest that elephants derive relatively large gains from consuming crops this corresponds to previous longitudinal studies and can be explained by the optimal foraging theory as crops are highly nutritious and easily digestible food sources pretorius et al 2012 vogel et al 2020a resulting in high gains to compensate for this prevention and mitigation of crop foraging may rely on increasing the risk or cost to wildlife to forage in agricultural areas our findings support the idea that optimal foraging theory can be used to understand elephant movement for crop foraging for example our model highlighted that increasing the cost of going into a crop block affected the crop tree indifference curve moving it upwards and therefore reducing the food water combinations that lead elephants to prefer crops over trees our results also showed that increasing the cost of visiting crop blocks reduces the total time that the elephant spends in them physical and sensory obstacles like chili fences but also increasing the landscape of fear by simulating threats to elephants are examples of actions that could increase the cost that elephants perceive and or experience associated with crop foraging denninger and rentsch 2020 additionally our model revealed the importance of landscape configuration the distance between crops and non agricultural foraging represented by tree blocks influenced the crop tree indifference curve given our assumption that movement is costly thus elephants were less likely to prefer foraging on crops when the crops were more distant than trees this underlines the importance of deliberate land use planning that allows for increased distance between agricultural fields and areas of high elephant use songhurst et al 2016 note that in contrast to many existing models of elephant movement boult et al 2018 2019 mamboleo et al 2021 we are able to study in greater depth the significance of landscape configuration or the effects of crop barriers in our model because we have explicitly accounted for the cost of movement or trespassing on farms in our model our results point to several avenues for future research one is a deeper examination of the difference between walks involving crop consumption and walks that do not the predictive power of the random walk and local maximization models is higher when they are applied to walks that do not go to croplands this suggests that there is more randomness or less foresight involved when elephants are engaged in foraging activity that do not include crop consumption at the same time elephant walks involving crop consumption seem to more closely follow optimizing principles one possible explanation for this difference is that crop consumption is a risky activity due to measures that may have been put in place by farmers to protect their crops hence it may be more prudent for elephants to plan out their routes and find the optimal ones when they choose to visit farmlands on the other hand walks that do not include crop consumption are less risky and may not require as much foresight and planning future work could test the validity of this hypothesis as well as investigate whether there is any connection to recent findings that show that african elephants exhibit both fast exploratory movements and slow wandering encamped movements vogel et al 2020b another issue to explore is how individual differences between the elephants affect their propensity to engage in crop consumption it is known for example that male african elephants movement and behavior depend on their age and reproductive state taylor et al 2020 a major source of difference we found between crop consumption walks and non crop consumption walks may thus stem from heterogeneity in the sample of elephants in our dataset since our model can easily accommodate individual differences along various dimensions future research could look at accounting for such heterogeneity when calibrating the model extensions of the current work should also consider using alternative similarity measures to quantify the goodness of fit between the real walks and the simulated walks in particular we should note that the metric we used a slight variation of the overlap coefficient adapted for our purposes ignores how often or how long an elephant visits the blocks in the model map using a different similarity measure that captures this frequency information may improve the predictive power of our model relative to the random walk and local maximization models it may also yield additional insights about elephant crop consumption behavior that we are not able to gain with the metric we used to calibrate our model a methodological issue that should be addressed in the future is the choice of block or grid size for the model map pasquaretta et al 2021 and how this choice affects the predictive power and goodness of fit of the model we note that with the overlap coefficient as our similarity measure one way we could improve the measured goodness of fit of our model is to simply make the block size bigger this however does not imply that the model s true predictive power has increased by any means in fact one could argue that making the block size bigger actually reduces the predictive power of the model because a bigger block size essentially requires less precision in the model s predictions of elephant movement hence it is important in future work to consider what should be the optimal block size for modeling purposes and to employ a similarity measure that is invariant with respect to block size another direction for future research is to consider alternative functional forms for the energy balance function specifically the portion that represents the benefit of consumption in this paper we used the cobb douglas function that has total consumption of water and food as the only arguments future work could examine whether other functional forms could improve the fit of our model and also consider specifications whereby the food component is divided into several smaller components consisting of the major nutrients in the diet of elephants since our abm models the behavior of a single elephant agent an obvious extension to pursue in the future is to incorporate multiple elephants in the model this would allow us to study the interactions between the elephants as well as how landscape configuration and resource constraints affect those interactions having multiple elephants in our optimization framework would introduce strategic considerations into the analysis since the optimal behavior of any elephant would depend on his beliefs and forecasts regarding the behavior of other elephants put differently the optimization problems of the elephants would be intertwined and interdependent and solving them would require the use of game theory fudenberg and tirole 1991 this is a potentially novel and promising direction to move in however calibrating such a model would require a far richer dataset than we have it would necessitate having data on how the movement and foraging behavior of individual elephants depend on the presence and behavior of other elephants although the motivation for our modeling work comes from our desire to understand and minimize elephant human conflicts we note that our modeling framework could be adapted and applied to study the movement and foraging behavior of other large herbivores for these applications the types of terrain blocks used in the model map as well as the energy balance function chosen as the agent s objective function would need to be modified to suit the context of interest and for some species additional cost components such as the risk of predation may need to be added to the objective function to capture all the relevant energy expenditures and risks that the animals incur or face 5 conclusions findings from this abm approach support ecological understanding of elephant crop foraging highlighting the optimal movements involved in crop foraging events as well as the importance of trespassing costs and landscape configuration although looking only at the crop tree indifference curve ignores the dynamic and temporal dimensions of the elephant s decision problem e g how much distance has the elephant walked thus far and how far away is he from his refuge block it gives us a sense of some of the trade offs that are involved in solving the elephant s maximization problem as such it may give conservationists and policy makers a starting point to use in formulating policies to minimize the harms and costs that result from elephant crop consumption funding this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors credit authorship contribution statement haosen he conceptualization methodology software formal analysis investigation writing original draft writing review editing erin buchholtz writing original draft writing review editing frederick chen conceptualization methodology writing original draft writing review editing susanne vogel writing original draft writing review editing chu a alex yu methodology writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments comments and suggestions from participants at the ecology and evolution lunch series at wake forest university an editor of the journal and anonymous reviewers are gratefully acknowledged hh also thanks the department of mathematics statistics at wake forest university for awarding him the walter low tatum scholarship during the writing of this manuscript a special shout out goes to fritz vollrath whose question to fc about elephant crop consumption inspired this research appendix a odd protocol of the model the description of our model below follows the odd overview design concepts details protocol for describing agent based models grimm et al 2006 which was later updated grimm et al 2020 all codes for our modeling work the data used and visualization packages can be found here https github com haosenhe elephant crop raiding 1 purpose and patterns the purpose of our model is to predict the movement and foraging patterns of elephants the motivation for the study and the ultimate purpose of the model is to understand elephant crop consumption behavior in order to minimize the damages caused by human elephant conflict because we have gps collar data from elephants we are interested in the locations that elephants go to over the course of a day the specific goal for our modeling work is to provide a model that would produce predicted movements i e locations of elephants that match the observed movements 2 entities state variables and sclaes entities our model consists of the following entities agent elephant this is the entity in the model whose movement we are interested in studying lattice in our model the elephant moves around in a discrete two dimensional space lattice each element of the lattice is an ordered pair v a b where a and b are integers hence our model space is the set of ordered integers z 2 for visualization purposes we will represent each element of the lattice as a colored block rather than as a point terrain blocks each block of our model space is assigned to be one of the following types crop tree water and savanna a crop block is a block of the lattice that contains crops farmlands a tree bock is a block of the lattice that contains trees and grass and a water block is a block of the lattice that contains water together the crop blocks and the tree blocks comprise the set of food blocks we assume that a block cannot simultaneously contain water and food the savanna blocks are the blocks in the lattice that contain neither water nor food refuge blocks some of the blocks in the lattice are designated as refuge blocks these are the daytime refugia of the elephant the blocks that the elephant returns to during the day to rest and likely represent areas that feel safe for the elephant jachowski et al 2012 see also appendix a section 5 hence when the elephant starts looking for food and water he must start at a refuge block and at the end of each night he must return to a possibly different refuge block state variables consumption of food and water every food block is initially endowed with some amount of food φ 0 r this initial endowment is allowed to vary across the food blocks in the model in a food block the elephant consumes a constant amount of food per time period a crop 0 in a crop block and a tree 0 in a tree block we assume that a crop a tree to represent the higher nutritional quality of crops if the amount of food remaining in a food block is less than the elephant s consumption capability then the elephant will consume all the remaining food in that block every water block is endowed with some amount of water ω 0 r the elephant also consumes some constant amount of water a water 0 per period in a water block let γ f denote the total units of food from crop and tree blocks the elephant consumes in a day and let γ w denote the total units of water the elephant consumes in a day movement of the elephant in every time period of the model the elephant has the choice to stay in a block or go to one of the neighboring blocks we say that the elephant makes a move or a movement when he goes from one block to a neighboring block we denote the total number of movements the elephant makes in one day of foraging by the integer m and the total number of periods he spends in crop blocks in a day by the integer t scales temporal scales the model generates the movement of the elephant over the course of a day we assume that the elephant moves and forages only during the night and rests during the daytime this time constraint along with the restriction that the elephant must return to a refuge block after foraging implicitly limit how much distance the elephant can travel in the model or equivalently how many blocks the elephant can reach we assume that the elephant has k discrete time periods during the night to forage where k 0 is a parameter that depends on how fast elephants can walk note that k is also the maximum number of movements as defined above the elephant can make in one day spatial scales our model space or lattice is based on gorongosa national park gnp in mozambique specifically the region between 33 96 e and 34 7 e in longitude and between 18 6 s and 19 3 s in latitude an area that is approximately 78 km 78 km we discretize this region to obtain a set of coarser resolution blocks the choice of block size necessitates making non trivial tradeoffs involving computational time on the one hand making the blocks small gives our model map a high resolution however this increases the amount of computations and time for running our model on the other hand the resolution of our model map decreases if we make the blocks bigger to reduce computation time after some experimentation with the number of blocks we chose to go with a 30 30 lattice which allows us to preserve most of the details of the land cover map of gnp while allowing our computational algorithm to run in a reasonable amount of time this yields 900 square blocks each with an area of 2 596 km 2 596 km or 6 7 km2 see appendix c for how the model map looks with different numbers of blocks 3 process overview and scheduling our computational work consists of two general procedures procedure 1 finding the elephant s optimal movements 1 1 once all the blocks in our model map lattice have been assigned a terrain type and once the refuge blocks have been assigned the elephant is placed at one of the refuge blocks 1 2 using our computational algorithms described in detail in section 7 and given values for the model parameters the elephant picks blocks in the model map to move to subject to the constraints that i he will return to a refuge block by the end of the day and ii there are k periods in a day for him to move and forage we call a set of blocks that satisfy these constraints a valid walk for the elephant 1 3 for each valid walk that the elephant chooses we obtain the total amount of food γf and water γw that he consumes the total number of movements he makes m and the total number of periods he stays in crop blocks t this information is then used to calculate the score from that valid path our algorithm will then select the set of valid walks that yield the highest score i e the set of optimal walks below we provide an intuitive description of how our computational algorithm works because the elephant needs both food and water to derive positive energy revenue we consider every possible pairing of a food block and a water block and we ask the following questions regarding each pair is there at least one valid walk that contains that pair of food and water blocks if not then we can disregard that pair from our computations if there is then we consider the following questions what are all the valid walks that contain that pair of food and water blocks and of these what is the set of valid walks that yield the highest energy balance for the elephant by going through every possible pair of food and water blocks and finding the best valid walk if there is one associated with each one we can then compare these best valid walks to identify the one or ones that maximize the elephant s objective function over all possible valid walks procedure 2 calibrating the model using movement data of real elephants finding the best fitting parameter values for the model using actual data of elephant movements we calibrate the model and estimate the parameter values of the model as follows 2 1 randomly select parameter values for the model with these values use the steps described in procedure 1 to find the elephant s optimal walk compare this optimal walk to data of actual elephant movements to derive a goodness of fit 2 2 repeat step 2 1 100 times this step yields 100 optimal walks each associated with its own set of parameter values each set of parameter values is thus associated with a goodness of fit with the data on real elephant movements the set of parameter values with the highest goodness of fit is our candidate for the best fitting set of parameter values 2 3 using the candidate for the best fitting set of parameter values obtained from step 2 2 as a starting point and using the particle swarm optimization pso algorithm iteratively update and revise the candidate for the best fitting set of parameter values until the process converges the final candidate for the best fitting set of parameter values that we obtain is our estimate of the parameter values for the model 4 design concepts basic principles the basic idea behind our model is to utilize optimal foraging theory and conceive of an elephant as an optimizing agent that chooses a path of movement and foraging to maximize the difference between the benefit from consumption of resources and the costs from movement and trespassing on farmlands emergence given values for the model parameters the assignment of terrain type to each block in the lattice the specification of refuge blocks and the initial location of the elephant our model produces a set of optimal walks i e set of blocks to visit for the elephant adaptation given the terrain blocks in the lattice and the refuge blocks our model s algorithms 1 find the set of valid walks i e the movement patterns that satisfy the constraints that are imposed for the elephant and 2 select the set of valid walks that maximize an objective function direct objective seeking objectives the objective function has as inputs the state variables of the model total units of food consumed during a valid walk γf total units of water consumed during a valid walk γw total movements made during a valid walk m and total periods spent in crop blocks during a valid walk t the specific functional form we used is the following γ f α γ w 1 α m c move t c tres where c move is the cost of a movement and c tres is the cost of trespassing on a crop block in one time period learning our model does not include learning prediction in finding the elephant s optimal walk our model implicitly assumes that the elephant can accurately predict the future consequences of every movement he makes within a day of foraging sensing we assume throughout that the elephant has complete information about the lattice at any point in time he knows the type of every block in the model space the model parameter values as well as the amount of food water remaining in each food water block while this assumption of complete information may seem extreme we employ it for now to provide a benchmark model against which other versions of the model which assume the elephant has less information about the terrain could be compared to in future work interaction our model has a single elephant hence it does not include interaction stochasticity there are two sources of stochasticity in our model procedure 1 as described in section 3 because an optimal walk is generally not unique our algorithms will randomly with equal probability select one if there are multiple optimal walks this implies that given the same layout of terrain blocks starting position of the elephant and parameter values the model need not generate the same outcome when run multiple times procedure 2 as described in section 3 the initial values used for the calibration step are chosen randomly as described in section 3 in addition the updating step of the pso algorithm involves generating random numbers this is part of the pso algorithm in the search for the best fitting parameter values collectives our model does not include collectives observation the output of our model consists of the elephant s set of optimal walks an optimal walk yields the following observations that are recorded the set of blocks that the elephant visits the total amount of food and water consumed during the optimal walk the total number of movements made and the number of periods the elephant spends in crop blocks 5 initialization land cover we used the european space agency s climate change initiative land cover classification for the study region https climate esa int en projects land cover about land cover in and around gnp included tree cover open water cropland shrub cover grassland and built up areas based on visual ground truthing using satellite imagery from the same year us geological survey https landlook usgs gov landlook viewer html 2016 we identified that some pixels within the park that were classified as cropland and built up areas were likely misclassified and we assigned them to the grassland class we then combined shrub cover and grassland classes into a single savannah land cover class this provided us with a land cover classification with four types of land cover trees savanna crop and water to apply our computational model see fig a1 since our elephant moves from block to block in our model we discretized the land cover map and converted it into a set of coarser resolution blocks see spatial scales in section 2 we created a classification algorithm to aggregate the land cover classes to the lattice resolution blocks were assigned to land cover types based on the following thresholds in this order water 1 open water crop 20 cropland tree 50 tree cover savanna all else blocks that contained water were deliberately weighted to ensure that the distribution of land cover types in the model lattice matched the distribution of cover types in the study area at the original resolution below are more specific details of our terrain classification algorithm because each of the blocks in our map of gnp may contain more than one type of terrain e g along the pungue river a block of land could contain open water cropland and trees cover areas we need to consider how to classify every block into one of the four types our model uses the pungue river and lake urema which are located in the center of the park are two of the main sources of water for elephants in gnp gaynor et al 2018 we deliberately put more weight on the open water areas in our classification algorithm to ensure that the distribution of terrain types in our model map matches the distribution in the reduced land cover map without putting substantial weight on the open water areas in a block the river would not appear in the discretized model map meaning that the elephant would not have the river as a source for water consumption fig a2 shows our terrain classification algorithm in flowchart form how well our model map of gnp captures the land cover data we have for the park depends on the parameter values we specify for our terrain classification algorithm in appendix b we show how our model map of gnp changes as we vary the criteria that we use to classify a map block as water crop tree or savanna diurnal patterns of elephant movement and identification of elephant refuge our abm of elephant movement and foraging assumes that the elephant has a refuge block that he returns to each day to justify this assumption and identify the refuge blocks of the elephants in gnp from our dataset we proceeded as follows for every hour of the day we compared an elephant s location at that time to his location at the same time in the previous day we quantified this comparison by the square of the euclidean distance between the two locations because gnp is not far from the equator one degree latitude and one degree longitude have approximately the same length 111 km thus we treat degree latitude or longitude as a unit of length and calculate euclidean distances using longitude and latitude data more formally the distance between an elephant s location x y on some given day where x is degree longitude and y is degree latitude and his location x y the previous day at the same hour is x x 2 y y 2 hence the distance squared is x x 2 y y 2 we computed this measure for all 10 elephants that we looked at in our dataset we then used these results to calculate the average squared distance between an elephant s location on two consecutive days at the same hour for convenience we refer to this measure as the elephants location inconsistency intuitively location inconsistency gives us an idea of whether an elephant likes to be in certain areas at the same time every day for example if location inconsistency is low for a certain hour of the day then that means an elephant tends to be in the same location at that hour of the day on the other hand a high level of location inconsistency for some hour of the day indicates that at that hour of the day the elephant does not have a favorite place to be and is in different places on different days fig a3 shows the average location inconsistency across all 10 elephants for each hour of the day notice that the elephants locations are very consistent or stable between 6am and 4pm we also computed location inconsistency from comparing an elephant s location to the average location of the elephant from the previous three days at the same hour i e time of day the results are shown in fig a4 and exhibit the same pattern based on this finding we chose the elephants location at 4pm as their refuge block in simulating their movements using our abm for the purposes of our modeling exercise we also used this result to make the assumption that foraging takes place between 4pm and 6am the next day a total of 14 h fig a5 shows the refuge blocks of the 10 elephants in our dataset on four different dates initial endowment of food and water we are interested in modeling an elephant s movement at the timescale of a day therefore we assumed that the initial endowment in a food block φ 0 is sufficiently high so that each food block contains more than enough food for an elephant to consume in a day intuitively this assumption implies that when the elephant moves from one block to another it cannot be due to the former block running out of food this allows us to focus on how the spatial distribution of resource rather than quantity constraints on resources affects the movement pattern of the elephant at the temporal scale we use for the same reason we assumed that the initial endowment of water ω 0 is sufficiently high relative to the rate of water consumption a water 6 input data the model does not use input data to represent time varying processes 7 submodels procedure 1 finding the elephant s optimal movements model description in every time period the elephant given the block he is located at chooses to remain at his current block or move to one of the eight closest neighboring blocks we define distance in the model in terms of the minimum number of periods it takes the elephant to go from one block to another more formally the distance between two blocks v a b and v a b is d v v max a a b b for any integer k 0 a path that the elephant takes in k periods starting from some block v 0 can be represented as a lattice walk of length k which is a sequence of ordered pairs v 0 v 1 v k where v i z 2 for all i 0 1 k such that d v i v i 1 1 for all i 0 1 k 1 we note that the same block may appear more than once in a lattice walk this is because the elephant can stay in a block for more than one period and because the elephant can visit a block multiple times because the elephant can stay in a block rather than move to another block we will say that the elephant makes a move or a movement from v to v if d v v 1 a trivial walk τ is a lattice walk v 0 v 1 v k such that v i v 0 for all i 0 1 k we assume that the elephant moves and forages only during the night and rests during the day see section 5 this time constraint implicitly limits how much distance the elephant can travel in the model let us assume that the elephant has k time periods during the daytime to forage where k 0 is some given integer i e he can choose any lattice walk of length k starting from his initial block in any day we will denote the terrain blocks as follows n the set of crop blocks m the set of tree blocks w the set of water blocks d the set of savanna blocks together the crop blocks and the tree blocks comprise the set of food blocks f i e f n m we assume that a block cannot simultaneously contain water and food f w the savanna blocks are those in the model that contain neither water nor food i e d z 2 f w the set of refuge blocks is denoted by r we assume that r w r n let us denote by ψ the set of lattice walks of length k that start and end at refuge blocks i e the lattice walk v 0 v 1 v k is in ψ if v 0 r and v k r the set ψ gives us all the possible routes which we will refer to as valid walks that the elephant can take in one night of foraging based on the elephant movement data from mozambique that we examined see section 5 we chose r to be a singleton set that consists of only one block r elephant s objective moving and foraging are costly in terms of energy for the elephant whenever the elephant makes a move from one block to another one in a time period he incurs a moving cost c move 0 foraging in a crop block is risky as the elephant s activity may be discovered by farmers who may take actions to chase away or harm the elephant we thus assume that the elephant incurs a trespassing cost c t r e s 0 for every period he is in a crop block therefore from a valid walk in which the elephant makes m movements and spends t periods in crop blocks the total cost incurred is c m t m c move t c tres the elephant obtains energy from consumption of food and water if the elephant consumes γ f units of food and γ w units of water during a valid walk then his energy revenue or gain is given by the function g γ f γ w in all of our analysis below we utilize the cobb douglas function g γ f γ w γ f α γ w 1 α where α 0 which is a commonly used specification for utility functions and production functions in economics putting everything together given any walk that has m movements involves spending t periods in crop blocks and yields γ f units of food and γ w units of water the elephant s objective function is v γ f γ w m t g γ f γ w c m t γ f α γ w 1 α m c move t c tres we need to restrict our attention to valid walks however let z ψ r 2 z 2 be the function that given a valid walk yields γ f γ w m t where γ f and γ w respectively are the amounts of food and water consumed in that walk m is the number of movements made during the walk and t is the number of periods spent in crop blocks during the walk therefore given a valid walk ψ the elephant s utility in the jargon of economics gained from that walk can be expressed as u ψ v z ψ for convenience we will refer to the elephant s objective function as his energy balance function we assume that in each day the elephant s goal is to find a valid walk that maximizes his energy balance function i e the elephant s optimization problem is max ψ ψ u ψ this is therefore a combinatorial optimization problem subject to the constraint that the elephant must return to a refuge at the end of each day let ψ denote the set of valid walks that are optimal i e ψ arg max ψ ψ u ψ below we describe a computational algorithm for solving the elephant s optimization problem remark given a valid walk ψ the energy balance the elephant gains from ψ is the same as the energy balance he gains from walking ψ in reverse order since both walks produce the same γ f γ w m and t hence in our computational model we consider a valid walk and the same walk in reverse order to be equivalent finding all valid walks the p visit algorithm first we devise an algorithm that finds all the possible lattice walks of some length x between two blocks v and v that do not pass through the set of prohibited blocks r for convenience we will refer to this algorithm as the p visit algorithm this algorithm is used to create segments sub walks of a valid walk and we connect these segments together to create a valid walk when connecting sub walks the ending block of one sub walk is the same as the starting bock of the next sub walk to avoid double counting of blocks the sub walks generated by the p visit algorithm does not include the ending block given some block v and integer x define the single trip neighborhood s t n v x to be the set of blocks that the elephant can reach in x periods starting from block v let ω be a walk from block v to block v that takes x periods we know that for any block v in ω if it takes y periods to go from block v to block v then the sub walk from block v to block v must take x y periods this means that v s t n v y s t n v x y because we cannot have blocks in r we get v s t n v y s t n v x y r by varying y from 0 to x and combining the blocks that we get we can find the set of all lattice walks between block v and block v that take x periods and do not pass through any refuge blocks as the following cartesian product 1 s t n v 0 s t n v x r s t n v 1 s t n v x 1 r s t n v x 1 s t n v 1 r if s t n v y s t n v x y r for some y 0 1 x 1 then there exists no lattice walk of length x between v and v remark as noted above we do not include the last block s t n v x s t n v 0 r in our algorithm because it is the ending block v which overlaps with the following sub walk we note also that some of the elements in the cartesian product 1 may not be well defined lattice walks in a lattice walk the elephant can move a distance of at most one block in a single time period however the algorithm given by 1 does not guarantee this for example given v 0 0 v 1 1 x 3 and r one of the outputs of 1 is 0 0 0 0 2 2 1 1 but d 0 0 2 2 1 to resolve this issue we devised a special cartesian product generator that only yields well defined lattice walks this generator is a revised version of the product function in the python itertools package van rossum 2020 we denote this special cartesian product as π to summarize here are the steps for the p visit algorithm for finding valid walks step 1 receive locations v and v length x and the set of habitat locations r step 2 calculate π y 0 x 1 s t n v y s t n v x y r and return boolean false if s t n v y s t n v x y r for some y 0 1 x 1 reducing the search space the main algorithm the goal of our main algorithm is to produce the solution set ψ given the habitat block r and the number of periods to forage k however this is a np hard problem hence a brute force algorithm that exhaustively searches all elements in ψ would take too long instead we reduce the search space by finding a superset of ψ that is much smaller than ψ we utilize the nature of the elephant s objective function to reduce the search space the objective function has two components the benefit from food and water consumption and the cost from moving and being inside protected crop blocks the first component is non negative and the second component is non positive based on the energy balance function we can prove the following lemmas lemma 1 u τ 0 proof since no food or water is consumed in this case and no movement or trespassing cost is incurred the elephant s energy balance must be 0 lemma 2 for all ψ ψ u ψ 0 proof since the elephant can guarantee an energy balance of 0 by not moving at all lemma 1 the optimized energy balance must be non negative lemma 3 for all ψ ψ either ψ τ or there exist blocks a and b in ψ such that a w and b f proof consider the following two possibilities case 1 τ ψ in this case u ψ 0 for all ψ ψ for this to be true either ψ τ or there exists ψ ψ such that ψ τ and u ψ 0 if ψ τ then the number of movements m the elephant makes is non zero hence the total cost incurred from the walk ψ is strictly positive to ensure u ψ 0 the elephant s energy revenue from the walk must be strictly positive therefore ψ must contain both elements in f and elements in w case 2 τ ψ in this case we must have u ψ 0 for all ψ ψ for this to be true the elephant s energy revenue from an optimal walk must be strictly positive hence all walks in ψ must contain both elements in f and elements in w these two cases exhaust all possibilities given block v and a positive integer x define the roundtrip neighborhood r t n v x to be the set of blocks v such that the elephant can go from block v to block v and then back to v in x periods lemma 4 for all blocks v in ψ ψ v r t n r k proof if block v r t n r k then v cannot be an element of a valid walk hence it cannot be an element of an optimal walk let ψ be a subset of ψ such that for all ψ ψ there exist blocks a and b in ψ so that a w and b f i e ψ is the set of valid walks that contain both food and water blocks by lemma 3 we know that ψ ψ τ therefore if we restrict our search to ψ τ we are guaranteed to get the set of optimal walks our algorithm first initializes a set ψ to store the optimal walks and a float variable maxfit to store the highest score or utility from the walks based on lemma 1 we start out assigning ψ τ and maxfit 0 and then search through every element in ψ to update ψ and maxfit for some ψ ψ if u ψ maxfit then we reset ψ ψ and maxfit u ψ if for some ψ ψ u ψ maxfit then we simply add ψ to ψ if u ψ maxfit we do nothing since we start out with τ and search through ψ we search through ψ τ which is a superset of ψ hence at the end of our search we must have ψ ψ this shows that our algorithm guarantees finding the set of optimal walks we will now describe a method to search through every element in ψ recall that by the definition of ψ every valid walk ψ ψ must contain blocks w and f such that w w and f f however some water food pairs w f are not elements of valid walks and these water food pairs should be removed from consideration consider some water food pair w f by lemma 4 if w and f are elements of a valid walk then w f r t n r k thus any elements in w and f that are not in r t n r k can be discarded from our search our algorithm removes these elements by creating the sets f f r t n r k and w w r t n r k and searches for the optimal walks using only water food pairs in w f now given any water block w w and any food block f f in a walk ψ that starts and ends at r we can divide ψ into three segments or sub walks the sub walk from r to f the sub walk from f to w and the sub walk from w to r note that the walking order r f w r is the same as r w f r in our modeling framework so we will only consider walks in one order denote by ψ r f ψ f w and ψ w r respectively the sub walks from r to f from f to w and from w to r since the length of a valid walk is k we must have 2 ψ r f ψ f w ψ w r k where the notation a denotes the number of elements i e length of the sub walk a therefore if d r f d f w d w r k where d a b is the shortest length between block a and block b then the water food pair w f cannot be elements of a valid walk at the same time our algorithm thus checks given any water food pair w f w f if d r f d f w d w r k we say that the pair w f w f is eligible if this condition is satisfied given an eligible water food pair w f we will find all valid walks that contain w and f as follows first we will enumerate all possible combinations of the lengths of the possible sub walks ψ r f ψ f w and ψ w r we know that ψ r f ψ f w and ψ w r must satisfy the constraints d r f ψ r f k d f w d w r d f w ψ f w k d r f d w r d w r ψ w r k d r f d f w to begin fix ψ r f to be d r f and let ψ f w vary from d f w to k d r f d w r once ψ r f and ψ f w are determined the value of ψ w r is set from 2 next increase the value of ψ r f by 1 and repeat the process allow ψ r f to increase until it reaches k d f w d w r this way we can enumerate all possible combinations of sub walk lengths given an eligible pair w f for each combination of sub walk lengths we can use the p visit algorithm described previously to find the set of all possible walks from r to f from f to w and from w to r denote these three sets of possible walks by ψ r f ψ f w and ψ w r respectively the cartesian product ψ r f ψ f w ψ w r r is thus the set of all valid walks given the eligible pair w f and the sub walk lengths ψ r f ψ f w and ψ w r remark the above steps may yield redundant computations consider two eligible pairs w 1 f and w 2 f where w 1 w 2 after searching all possible valid walks containing w 1 f it is possible that some of them also contain w 2 f therefore when searching for all valid walks containing w 2 f we do not need to include those walks also containing w 1 f for this purpose given a food block f we initialize an empty set of prohibited blocks r and add to r any water block w that forms an eligible pair with f after all valid walks containing w f have been searched when we search for valid walks containing another water food pair w f using the p visit algorithm this specification of the set of prohibited blocks r allows us to skip the valid walks that had already been searched before thus eliminating any redundant computations fig a6 shows our lattice walk algorithm in flowchart form procedure 2 calibrating the model using movement data of real elephants finding the best fitting parameter values for the model similarity measure in order to compare the real walks in our dataset to the simulated walks produced by our abm we need some kind of metric or criterion that tells us how well our model fits the real elephant movement data we have since mathematically a real walk or a simulated walk is simply a set of data there are several similarity measures we could use to compare two datasets choi et al 2010 vijaymeena and kavitha 2016 for our metric we used a variation of the overlap coefficient oc which is also known as the szymkiewicz simpson coefficient vijaymeena and kavitha 2016 mathematically given two sets x and y the overlap coefficient is given by oc x y x y min x y this index gives us a number between 0 and 1 with a higher number indicating greater overlap i e similarity between the two sets for example if x a b c d and y l m a n c then oc x y 2 4 1 2 indicating that relative to the smaller set x the overlap between them is 50 percent we employed the following modified overlap coefficient moc moc x y x y x where x is the set of unique blocks visited in a real walk and y is the set of unique blocks visited in a simulated walk using moc as our similarity measure allows us to directly interpret its value as the proportion of blocks that the real elephants visit that is predicted by our abm notice that the moc also allows us to directly compare the predictive power of different models since the value in the denominator would remain the same for all models calibrating the abm using pso the optimization problem is to search through a 6 dimensional space to find the values for a crop a tree a water c move c tres α that maximize the similarity between the simulated walks produced by our abm and the real walks in our dataset a particle is a vector a crop a tree a water c move c tres α in r 6 and a swarm is a collection of such particles let x i t denote the position of particle i after iteration t let v i t denote the velocity of particle i after iteration t let p i t denote the best solution that particle i has found after iteration t and let g t denote the best solution that the swarm has found after iteration t pso is a dynamical system of a swarm in which the movement of each particle is given as follows 3 x i t 1 x i t v i t 1 v i t 1 w v i t c 1 r 1 p i t x i t c 2 r 2 g t x i t here w c 1 and c 2 are parameters of the pso and r 1 and r 2 are random numbers drawn uniformly randomly from 0 1 for each iteration the parameter w determines the inertia of a particle i e how much the particle continues in the direction of its previous step the parameter c 1 is the force of the local cognitive component that governs how much a particle moves toward the best location it has found on its own finally c 2 is the force of the social component that determines how much a particle moves toward the best location the swarm has found we note that as long as the values of w c 1 and c 2 are appropriate shi 2001 pso will yield the optimal set of values for a crop a tree a water c move c tres α given enough rounds of iterations we apply the rule of thumb w 0 8 and c 1 c 2 2 shi 2001 we also need to set the number of particles and the number of iterations a good rule of thumb is to use 10 particles for every parameter therefore we set the number of particles to be 60 we set the number of iterations to be 1000 although we found that the pso converged much faster than we had expected pso will automatically search all of r 6 if we do not restrict the search space therefore we also set upper and lower bounds for each parameter value it is clear that α is bounded between 0 and 1 for the other 5 parameters we set them to be bounded between 0 and 10 while we could have set other bounds such as 0 to 1000 that would simply result in a change of scale and would not affect our goodness of fit results we implement the single globalbestpso function in the python pyswarm package this function is actually designed to minimize a cost function instead of maximizing a function note however that we can transform moc into a cost function by simply adding a negative sign in front of it therefore we maximize moc by minimizing moc below we give the detailed steps of our implementation step 1 randomly generate 60 particles where each particle is a vector with six entries representing the six parameters of interest step 2 for each particle plug its elements as values of the parameters for our abm for each of the real walks in the dataset take the first entry and plug into our abm as the refuge block our model will now produce a set of simulated walks calculate the moc between the real walks and the simulated walks add a negative sign this is the value of the cost function for this particle step 3 once we have the cost for each of the 60 particles the one with the lowest cost is chosen to be the global best solution at this point since this is the first iteration all particle s own best positions are their current positions we utilize the pso system described above eq 3 to update the positions of the 60 particles which can be done using the pyswarm package in python step 4 repeat steps 2 and 3 until 1000 iterations have been completed keep updating the global best and each particle s own best position which can be done using the pyswarm package step 5 output the global best solution this particle vector is the optimal set of parameter values also output the measured goodness of fit obtained by running step 2 using the global best solution appendix b specification of the terrain classification algorithm classification of water blocks fig b1 shows how the model map of gnp changes as we vary the minimum amount of water that needs to be in a block in order for it to be classified as a water block notice that if we require the amount of water in a block to be too high in order for it to be classified as a water block then the pungue river would not appear in the model map for this reason we set the threshold amount of water that a water block needs to have to be very low classification of crop blocks fixing the minimum amount of water needed for a water block at 1 we varied the minimum amount of cropland that is necessary for a block to be classified as a crop block some selected results are shown in fig b2 classification of tree blocks fixing the minimum amount of water needed for a water block at 1 and the minimum amount of cropland needed for a crop block at 20 we varied the minimum amount of trees in a block that is required to classify it as a tree block some selected results are shown in fig b3 appendix c block size of model map fig c1 shows the model map of gnp at different resolutions using the same terrain classification scheme as given in fig a2 appendix d seasonal patterns of elephant movement and crop consumption as the histogram below shows fig d1 most crop consumption incidents happen during the 4 months from august to november which correspond to the late dry season april to october and early wet season november to march of mozambique note that this is when maize the main crop in this region ripens it is also important to note that when we looked at the movements of the elephants by location and time fig d2 the elephants movements are more spread out in the wet season when water sources are more abundant and more restricted or confined in the late dry and early wet season appendix e random walk model of elephant movement with minor and obvious modifications the first six elements of the odd protocol for the random walk model follow the first six elements in appendix a below we provide the details for element 7 submodels for the random walk model submodel 1 generating a lattice walk for the elephant rw 1 the elephant is not constrained to return to the refuge block at the end of its walk starting from the refuge block the elephant randomly selects a block in s t n c l 1 as its next block where s t n is as defined in appendix a cl denotes the elephant s current block and each block in s t n c l 1 has the same probability of being selected the process ends at the end of k periods rw 2 the elephant is constrained to return to the refuge block at the end of k periods starting from the refuge block the agent elephant randomly selects a block in s t n c l 1 s t n r e f u g e p e r i o d s l e f t 1 where periods left denotes the number of periods left in the walk and each block in s t n c l 1 s t n r e f u g e p e r i o d s l e f t 1 has the same probability of being selected submodel 2 calculating moc for each real walk in the dataset used use its refuge block as the refuge block in the random walk model either rw 1 or rw 2 execute the program and obtain a simulated elephant walk compute the moc between the real walk and the simulated walk this yields a moc for each real walk compute the average moc over all real walks in the dataset used this is the moc for one trial of running the random walk model perform 100 trials of running the random walk model and compute the average moc over all 100 trials this yields the moc reported in tables 2 4 we note that the results did not change significantly with a different number of trials appendix f local maximization model of elephant movement in simon and fortin 2020 an agent in every period stays in its current polygon with probability 0 5 and moves to another polygon with probability 0 5 if it stays then it chooses a location in its current polygon randomly if it moves then it chooses the location with the highest score a location s score is determined by the resources in it from among a set of randomly generated feasible locations the blocks in our setting are the analogues of the polygons in their setting however we do not model movement within a block here we describe the local maximization model that is based on simon and fortin s setup with minor and obvious modifications the first six elements of the odd protocol for the local maximization model follow the first six elements in appendix a below we provide the details for element 7 submodels for the local maximization model submodel 1 generating a lattice walk for the elephant lm 1 the elephant is not constrained to return to the refuge block at the end of its walk starting from the refuge block the elephant in each period stays in his current block with probability 0 5 and moves to a neighboring block with probability 0 5 if he moves then he evaluates each of the neighboring blocks as follows let γf denote his current total consumption of food and let γw denote his current total consumption of water the score of a neighboring block which is based on the energy revenue function in our model is given by γ f α γ w 1 α if it is a savanna block γ f a tree α γ w 1 α if it is a tree block γ f a crop α γ w 1 α if it is a crop block γ f α γ w a water 1 α if it is a water block the elephant then chooses the neighboring block with the highest score in case of a tie he chooses a block randomly from among the set of blocks with the highest score the process ends at the end of k periods lm 2 the elephant is constrained to return to the refuge block at the end of k periods the elephant starts from the refuge block in each period the elephant determines whether he has to move in order to satisfy the return to refuge constraint if yes then he chooses the block with the highest score as specified above from among the set of blocks he can move to in case of a tie he randomly chooses one of the highest scoring blocks if no then his decision rule is the same as in lm 1 the process ends at the end of k periods submodel 2 calculating moc for each real walk in the dataset used use its refuge block as the refuge block in the local maximization model either lm 1 or lm 2 execute the program and obtain a simulated elephant walk compute the moc between the real walk and the simulated walk this yields a moc for each real walk compute the average moc over all real walks in the dataset used this is the moc for one trial of running the local maximization model perform 100 trials of running the local maximization model and compute the average moc over all 100 trials this yields the moc reported in tables 2 4 we note that the results did not change significantly will a different number of trials for the results reported in table 2 the values of the parameters a crop a tree a water α used to run the local maximization model are the estimated values for the corresponding parameters of our abm shown in table 2 the same remark applies to the results shown in tables 3 and 4 
24519,in recent years wild boar sus scrofa populations have increased rapidly causing serious problems such as crop damage and disease transmission in the present study we built an individual based model to explore how heterogeneous landscapes and the interactions of wild boars and hunters affect wild boar population control the simulated wild boars in the model move on a heterogeneous landscape to make the movement more realistic we included randomness in the simulated boar behavior the simulated hunters either walk to move one site during a one time step or jump to move multiple sites at once simulation results showed that the randomness positively contributed to the increase in population size while the remaining variables contributed negatively the randomness had the greatest impact on population size followed by the landscape heterogeneity and the hunting success probability on the other hand the jumping movement probability had the least effect interestingly the effect of jumping on the population size could be understood as a result of two effects cancelling one another the hunters are trapped in the preferred area and the hunters move to another area without removing all simulated boars gathered in the preferred area furthermore we briefly mentioned which ecological approaches can be used to control wild boar population growth with regard to our simulation results and proposed some ideas to improve the model and make it more realistic graphical abstract image graphical abstract keywords wild boar population size control hunting pressure individual based model 1 introduction the wild boar sus scrofa is one of the most widely distributed mammals worldwide either native or introduced ballari et al 2015 snow et al 2017 in europe the number of wild boars has increased dramatically over the past 40 years because of several causes one of the main being climate change it is well known that climate change has a significant impact on population growth and population structure of various species bay et al 2018 jones et al 2018 lindmark et al 2018 parmesan 2006 some species are at risk of extinction while others thrive in response to climate change walther et al 2002 the wild boar is one of the species that thrive in the climate change scenario because its reproduction rate significantly increases under conditions of prolonged summer or high temperatures vetter et al 2015 wild boars have the highest reproductive rate among ungulates and their annual population growth rate exceeds 2 0 bieber and ruf 2005 keuling et al 2013 thus persistent climate change has the potential to accelerate the current increase in wild boar populations markov et al 2019 vetter et al 2015 besides negatively affecting human society the rapid reproduction and or expansion of wild boar populations also leads to ecosystem dysfunction these negative impacts include destruction of forest habitats loss of plants and animals crop damage vehicle crashes and damage to anthropogenic infrastructures giménez anaya et al 2008 graitson et al 2018 in addition wild boars even affect urban areas by causing extensive damage to private gardens parks playgrounds and cemeteries cahill et al 2012 stillfried et al 2017 recently wild boars have become a threat as they are the carriers of diseases such as african swine fever asf and classical swine fever resulting in negative economic impacts guinat et al 2017 guo et al 2016 halasa et al 2016 mentaberre et al 2014 as no cure or vaccines have been developed for the asf virus yet the mortality rate in infected boars and pigs is nearly 100 the native distribution range of wild boars is from the tropical region of asia to siberian forests including semi desertic and temperate ecosystems where they pose serious problems and can be destructive to wildlife ecosystems in natural environments one of the problems associated with wild boars is that they prey on other animal species both vertebrates and invertebrates by scavenging or actively preying when possible focardi et al 2008 gamelon et al 2012 this has a negative impact on biodiversity furthermore wild boar activity in rivers also decreases water quality by increasing turbidity excessive silt and particle suspension and bacterial contamination it was reported that deteriorated water quality over time affected a variety of native aquatic organisms such as fish amphibians and insect larvae and may adversely affect river ecosystem stability kaller and kelso 2006 for these reasons researchers have been exploring various management methods to control wild boar population growth apollonio et al 2010 massei et al 2015 among these methods hunting has been widely used throughout europe apollonio et al 2010 massei et al 2015 nores et al 2008 reported that hunting related mortality was greater than predator related mortality and o keuling et al 2013 showed that hunting is the main cause of wild boar mortality on the other hand some studies have reported that with the decline in wild boar populations as a consequence of hunting other species thrive facilitating conflicts between humans and wildlife e g benhaiem et al 2008 kamei et al 2010 sunde et al 2009 furthermore it has been reported that the density and range of wild boar populations continue to increase despite vigorous hunting activities bengsen and sparkes 2016 o keuling et al 2016 therefore it is necessary to implement a different hunting strategy by comprehensively considering wild boar behavior hunting intensity and environmental conditions while minimizing the negative impact of wild boars in other words hunting should be selective as it may or may not be effective depending on various ecological variables o keuling et al 2008a in order to improve the performance of selective hunting it is essential to understand the behavior of both hunters and wild boars morales et al 2010 in particular it is important to predict wild boar behavior which is a result of both intrinsic and extrinsic motivations intrinsic motivations include spatial memory social behavior and reproductive desire spitz and janeau 1995 whereas extrinsic motivations include food resource acquisition and predator escape o keuling et al 2008b however to the best of our knowledge few studies have been conducted on the combinatorial effects of hunter behavior wild boar behavior and landscape on wild boar population size this is because it is difficult to quantify the ecological factors and also technically demanding to obtain independent data for each factor through field experiments in the present study to overcome this difficulty we constructed an individual based model to mimic the interactions between the ecological factors using the constructed model we explored the interaction between wild boars hunters and landscape heterogeneity on wild boar population size in the discussion we mentioned the limitations of the model and proposed ideas for its improvements to obtain a more realistic model 2 materials and methods 2 1 individual based model we constructed an individual based model to simulate an ecosystem consisting of simulated hunters sim hunters and simulated wild boars sim boars inhabiting heterogeneous simulated landscapes on a 100 100 grid space each grid site was characterized by a number h ranging from 0 0 to 1 0 which indicated the degree to which it is suitable for inhabitation by sim boars the physical unit of iteration time t was set to days to determine the values of variables used in the model the simulation was set to end when t 5000 and a periodic boundary condition was applied to minimize boundary effects caused by simulation space size limitations for each parameter condition we performed 20 simulations population size dynamics for each repetition were expressed as ϕ k t k represents the k th repetition and n t is the average of ϕ k t over k we then averaged n t over the time range 4000 t 5000 to determine the population size n this calculation process can be mathematically described as follows 1 n t 1 20 k 1 20 ϕ k t n 1 1 000 t 4 001 5 000 n t in order to increase the understanding of the model we added the descriptions and values of the parameters used in the model in table 1 some of the values were based on experimentally obtained data p 0 and p n and others p r r d r sens p j and ph were appropriately selected in consideration of simulation stability notably it is technically difficult to experimentally verify the appropriately selected values and is beyond the scope of this study for example to determine the p j value it is necessary to acquire and analyze the traveling trajectory data of wild boar under various ecological conditions in addition in order to estimate the p r value it is necessary to measure the wild boar reproduction rate as a function of environmental conditions the other parameters h h and β used the full range of values that can be taken mathematically in this study we used the matlab ver 2021a to build the simulation model and the functions provided by the software to analyze the simulation results 2 2 heterogeneous landscape to reflect the habitat characteristics in the model we created a simulated landscape with spatial heterogeneity using a neutral landscape model with 1997 the landscape was represented as a map called h map with a 100 100 grid fig 1 the landscape model is based on real landscapes which have partial spatial structures present in whole landscape structures this model uses a fractal algorithm that accurately reflects the structural characteristics and controls the degree of spatial autocorrelation by adjusting the variable h in the algorithm palmer 1992 landscapes with low spatial autocorrelation low h are bulkier and have highly variable surfaces e g sharp peaks adjacent to deep valleys among several fractal algorithms we used the intermediate displacement algorithm described by saupe 1988 to generate a heterogeneous landscape as a result the fragmentation degree of the areas preferred by wild boars can be characterized by the h value in the h map the higher the h value the lower the fragmentation degree we assigned each grid a value of h between 0 0 and 1 0 we interpreted the values as the degree to which wild boars preferred sites with these values i e wild boars preferred sites presented higher h values the characteristics of the h map are determined by the h value between 0 0 and 1 0 the higher lower the h value the more less clustered grids with lower higher h values when h 0 0 grids with high h values tend to be mostly fragmented whereas grids with high h values form larger clusters as they approach h 1 0 gardner 1999 gardner et al 1987 lee 2018 2 3 wild boar simulations 2 3 1 traveling behavior considering that individual differences in wild boars and unknown external stimuli may cause differences in individual walking paths we included randomness in the h map for this purpose an r map with a 100 100 grid was built fig 1 each grid of the r map was given a randomly generated value between 0 0 and 1 0 then using a β variable the h map and the r map were combined to generate a w map that simulates sim boar traveling behavior as follows 2 w i j 1 β h i j β r i j where i and j represent the i th and j th grid position in space respectively as the β value approaches 0 0 the h map becomes dominant whereas as the β value approaches 1 0 the r map becomes dominant fig 2 using the w map we can calculate the probability p i j that the sim boar located at the site i j will move to its neighboring site i j according to the following equation below 3 p i i s j j t w i s j t p q 1 0 1 w i p j q s t 1 0 1 2 3 2 reproduction behavior sim boars were designed to reproduce and have offspring using probability density functions obtained from the annual offspring reproduction rate for actual wild boars halasa et al 2019 a random number was generated at each iteration time and compared to a given value of p 0 0 0027 if the random number value was less than p 0 it decided to reproduce p 0 was derived from the assumption that sim boars reproduce once a year when a sim boar had offspring the process of determining the number of offspring ran to determine the number of offspring a new random number was generated and compared with the probability value p r determined from the sigmoid function fig 3 a the sigmoid function was used to allow sim boars to generate more offspring in better habitat conditions 4 p r p 0 1 exp 6 12 h i j if the random number was less than p r a minimum of one to a maximum of eight offspring are generated probabilities of 0 012 0 075 0 17 0 25 0 25 0 17 0 075 0 025 and 0 005 were given for the number of offspring from 1 to 8 respectively lange 2015 here h i j represents the degree of preference of wild boars in the i th and j th grid site in the w map in fact various functions allow the simulated wild boar to have a low reproduction rate when the habitat conditions are unfavorable and a high reproduction rate when conditions are favorable among the functions we used the sigmoid function because mathematically the function appears more frequently in population dynamics the exponential term 6 12h i j was introduced to mathematically simplify the function curve this term makes the reproduction rate 1 2 p 0 when h i j 0 5 the initial position of newly born sim boars was the same as that of their parents in this model we excluded the mating algorithm from the sim boar reproduction process to avoid complicating the model algorithms if we implement the mating behavior in the model the sim boars should be divided into male and female boars in addition it should be possible to probabilistically reproduce only when a female and a male wild boar meet each other moreover p r is described as a function of two variables the meeting frequency of male and female wild boars and habitat preference in this case it becomes difficult to control the model to have a reasonable p 0 value 2 3 3 death dead boar carcasses are sometimes exposed to other animals for several days this is one of the main factors for diseases such as asf spreading however as our study did not address disease spread carcass status was not considered therefore sim boars were immediately removed from the simulation space upon death sim boars have four types of death processes fig 3b the first type is natural death this process was implemented with an algorithm that generates a random number for each sim boar at every iteration time and removes the sim boar if this value is less than p n 0 0014 halasa et al 2019 the second type is death by hunting when a sim boar enters the hunter s hunting range i e when it is within a certain radius of the hunter it is removed with a certain probability all sim hunters have the same ph value and the simulation was performed for different ph values from 0 2 to 1 0 for example when ph 1 0 sim boars are immediately removed as soon as they enter the circle with d h the third type is the death of old age considering the actual lifespan of wild boars the sim boar was set to have a lifespan of 10 years t 3650 the fourth type is death due to carrying capacity excess caused by too high boar density when other sim boars within the detection distance r sens 5 grids of one sim boar exceed a certain threshold 15 individuals the sim boar was forcibly removed for the implementation of the carrying capacity algorithm we calculated the number of wild boars within the sensing range of a wild boar in random order when the wild boar had more than 15 neighboring boars within the sensing range the boar was eliminated the removed boar may result in another wild boar being removed alive simulation repetition and random ordering serve to overcome the problems caused by asynchronous algorithms if we adopt a synchronization algorithm for the carrying capacity an unrealistic simulation can be made in which wild boars in a small area are collectively eliminated 2 4 hunter simulations to represent the hunter behavior during wild boar tracking in the model we assumed that the sim hunters either walk to move one site during a one time step or jump to move multiple sites at once fig 4 a the path for the walking movement is determined by the h map fig 4a the number of sim hunters was set to five actual hunters may hunt by changing hunting sites far away from each other according to hunting strategies ecological and environmental conditions we implemented the changing behavior by allowing the sim hunter to make random jumps with the probability p j fig 4b the random jump implies that the site change event does not depend on any conditions the jumping means moving to all sites except itself in the simulation space and the walking means moving to a site adjacent to its own site p w represents the probability values of moving to the eight adjacent sites the hunting range of a sim hunter was set to be a circle with the radius r h 5 grid sim boars that were found within this range were hunted according to the probability ph fig 4c 2 5 sensitivity analysis we analyzed the effects of four variables 1 sim boar behavior β 2 and 3 sim hunter behavior p j and ph and 4 landscape heterogeneity h on wild boar population size n using partial rank correlation coefficient prcc which is a global sensitivity analysis that has been shown as the most reliable and efficient sampling based method marino et al 2008 to obtain the prcc we calculated the correlation coefficient cc between input x j and output y as follows 5 cc x j y i 1 n x i j x y i y i 1 n x i j x 2 1 n y i y 2 j 1 2 k where n is the number of samples and k is the size of the input vector the partial correlation coefficient pcc measures the strength of the linear relationship between input x j and output y after the linear influence of the other variables has been eliminated the pcc between x j and y is defined by the cc of x j x j and y y where x j and y are represented by the following linear regression models 6 x j c 0 p 1 n c p x p y b 0 p 1 n b p x p where b and c denote the regression coefficients and the hat signifies a regression fitted variable prcc performs a partial correlation using the linear regression models described in eq 6 which is computed on rank transformed data x j and y note that the prcc lies between 1 and 1 positive negative values indicate a positive negative correlation of the parameter with the model output a positive negative correlation implies that a positive negative change in the parameter increases decreases the model output therefore the larger the absolute prcc value the greater the correlation of the parameter with the output in the present study we used the latin hypercube sampling lhs method to generate samples of input variables that can avoid repetitive sampling the lhs method is one of the stratified sampling methods mckay et al 1979 and can significantly reduce the required number of simulations compared to that in the conventional monte carlo method iman and helton 1988 a total of 1000 simulations were performed wherein a set of parameter values was selected from the uniform distribution for the performance we used the prcc function in matlab ver 2021a 3 results fig 5 shows the change in sim boar population size n averaged over the number of simulation repetitions at h 0 0 when the β value varied from 0 0 to 1 0 in the absence of sim hunters with the increase in the β value the n tended to increase for β 0 8 the n was saturated below 150 whereas for β 0 8 it was saturated with values between 250 and 300 left in fig 5 this showed that it was more advantageous for sim boars to inhabit areas in a scattered manner a level at which β 0 8 rather than concentrating in their preferred areas to show the relative change n in n under different β values over time we used the area function in matlab ver 2021a right of fig 5 this function sequentially plots time series by adding it to the plotted time series n can be mathematically expressed as 7 n k 1 k p n k where k has values of 1 2 6 for β 0 0 0 2 1 0 respectively the n increased at first and then was saturated when t 4000 this indicated that sim boars which were randomly located at the beginning of the simulation moved to a preferred area over time where their reproductive rate became high resulting in a stable β effect see the red box in the right of fig 5 the color of the figure is the same as the color used to distinguish the different β values on the left of fig 5 fig 6 shows the change in n values when h 1 0 as β increased the value of n tended to increase when β 0 8 the value of n was stabilized in the range of 250 and 300 considering figs 5 and 6 the n value decreased as the h value increased this indicates that h had an effect on the decrease in population size this tendency is illustrated by the n plot shown in fig 6b to visually confirm the h effect we investigated the positional movement of sim boars over time fig 7 when h 0 0 sim boars which were randomly distributed in the simulation space at the initial stage gathered along the h map to their preferred regions over time after sufficient time passed t 1500 the sim boars were divided into several small groups and the populations within the groups stabilized without significant changes indicated by the dotted rectangle in fig 7a the small sized groups had an advantage as they had less chance of being limited in number by carrying capacity p e this had a positive effect on the overall sim boar population growth on the other hand when h 1 0 many sim boars flocked to a few preferred areas and population growth was limited by the p e effect which in turn negatively affected the increase in n n as defined in eq 1 represents the average of n over the time between 4000 t 5000 in order to comprehensively demonstrate the results described above we expressed the change in n value with respect to the change in h and β values on a grid map fig 8 the value of n decreased with the increase in h whereas it increased with the increase in β the degree of change in n value for an increase in h value tended to be more pronounced when β values were high fig 9 shows the changes in n values versus the changes in h and β values in the presence of a hunter for p j 0 00 and 0 06 and ph 0 4 and 0 8 similar to the tendency shown in fig 8 the n value decreased as the h value increased and it increased as the β value increased this tendency was evident regardless of the p j value the effect of the p j value on n appeared to be positive or negative depending on h and β values to understand the p j effect more intuitively we investigated the interaction of sim boars and sim hunters over time at p j 0 0 and 0 06 with h 0 5 β 0 0 and ph 1 0 fig 10 to prevent sim boars from being hunted while migrating to the preferred areas a value of ph 0 0 was given at 0 t 1500 and it changed to 1 0 at t 1500 in the case of p j 0 0 fig 10a sim boars were randomly distributed in the early stage followed by gradual moving to and inhabiting the preferred area sim hunters also moved to the preferred area and hunted the gathered sim boars indicated by dotted circles in fig 10a after sufficient time all sim boars in the preferred area were removed and sim hunters no longer had any boars to hunt indicated by dotted squares in fig 10a particularly sim hunters were trapped in the preferred areas with no target to hunt for comparison in the case of p j 0 06 fig 10b sim hunters could avoid being trapped in a preferred area they entered indicated by the dotted rectangle in fig 10b however the ability to jump also prevented sim hunters from eliminating all sim boars that have gathered in the preferred area consequently the remaining sim boars were able to reproduce resulting in population growth the combinatorial effect is underlying p j influence which was not clear in fig 9 we performed prcc analysis to explore to which extent h β p j and ph contributed quantitatively to the n value fig 11 we found that β contributed the most to the increase in n value 0 9287 whereas the other three variables contributed to the decrease in n value among the latter three variables h was the most influential 0 3944 followed by ph 0 3212 whereas p j was the least influential 0 0121 4 discussion and conclusion in the present study we built an individual based model to explore the effects of four ecological variables on wild boar population size n the studied variables included landscape heterogeneity h wild boar migration behavior β hunter s spatial jumping behavior p j and hunting success probability ph a great increase in wild boar populations causes various problems to human society on the other hand if their population is heavily reduced the stability of the ecosystem is threatened therefore it is necessary to control the population size and maintain it at an appropriate level our simulation results showed that β made a positive contribution to the increase in n value furthermore h and ph contributed negatively and p j had little effect on n fig 11 this showed that we can determine the optimal population size to reduce wild boar damage and maintain ecosystem stability through β control strategies which increase wild boar populations and h and ph control strategies which decrease wild boar populations as a realistic way to implement the β strategy partial fences or nets can be built around areas with a high density of wild boars in order to artificially change their migration path lavelle et al 2011 alternatively certain sounds that might disturb wild boars e g gunshots sirens etc can be used to repel them krol et al 2019 as a practical approach to h and ph control strategies it is possible to increase h values by providing wild boars with fewer large habitats rather than many smaller ones large habitats can be large forests with a high abundance of food and refuge places for wild boars although this method is not intuitively accepted it is understandable that many boar grouping enhance the density limiting effect of excess carrying capacity and provide an opportunity for hunters to achieve effective hunting performance with minimal changes in hunting sites although our study may help develop practical and ecological wild boar population control strategies some important ecological features and processes were omitted in the simplification of the model in our model we designed sim hunters to hunt independently and individually whereas actual hunters mainly hunt with the help of beats and dogs it is necessary to introduce simulated hounds and bitters into the model and include the algorithm that enables cooperative behavior between hunters in addition in the present study the behavior of sim boars related to better habitats depended only on habitat conditions regardless of the presence of hunters however actual wild boars tend to run away when they feel hunting pressure therefore it is necessary to improve the model by adding an algorithm for this escape behavior actual wild boars have different characteristic behaviors depending on the age of the individual for example young wild boars follow their parents and become independent when they become adults however our model assumed that all sim boars are physically and physiologically identical which prevented the simulation of characteristic behaviors thus implementing algorithms for these characteristic behaviors could improve the model and make it more realistic our simulation results for the p j effect were the combination of two effects one was related to sim hunters jumping to another area with a p j probability before eliminating all sim boars within the sim hunter s preferred area the other was related to keeping the sim hunters hunting by avoiding them being trapped in the preferred area and allowing them to jump these two effects canceled each other out and consequently had little effect on the population size n this indicated that it is inefficient for hunters to change hunting sites although the model proposed in the present study can be improved as described above we believe that this study is valuable as it not only provided a newly developed ecosystem model for exploring the methods of wild boar population size control but it also suggested possible ways in which the model can be applied in the field author contributions s h l writing original draft modeling conceptualization and data analysis writing review and editing c m p discussion regarding methodology data analysis and programming algorithms all authors contributed to data interpretation critically reviewed revised and approved the final manuscript declaration of competing interest all authors declare no competing interests acknowledgments this work was supported by korea institute of planning and evaluation for technology in food agriculture and forestry ipet through animal disease management technology development program funded by ministry of agriculture food and rural affairs mafra grant number 320055 2 and national institute for mathematical sciences 
24519,in recent years wild boar sus scrofa populations have increased rapidly causing serious problems such as crop damage and disease transmission in the present study we built an individual based model to explore how heterogeneous landscapes and the interactions of wild boars and hunters affect wild boar population control the simulated wild boars in the model move on a heterogeneous landscape to make the movement more realistic we included randomness in the simulated boar behavior the simulated hunters either walk to move one site during a one time step or jump to move multiple sites at once simulation results showed that the randomness positively contributed to the increase in population size while the remaining variables contributed negatively the randomness had the greatest impact on population size followed by the landscape heterogeneity and the hunting success probability on the other hand the jumping movement probability had the least effect interestingly the effect of jumping on the population size could be understood as a result of two effects cancelling one another the hunters are trapped in the preferred area and the hunters move to another area without removing all simulated boars gathered in the preferred area furthermore we briefly mentioned which ecological approaches can be used to control wild boar population growth with regard to our simulation results and proposed some ideas to improve the model and make it more realistic graphical abstract image graphical abstract keywords wild boar population size control hunting pressure individual based model 1 introduction the wild boar sus scrofa is one of the most widely distributed mammals worldwide either native or introduced ballari et al 2015 snow et al 2017 in europe the number of wild boars has increased dramatically over the past 40 years because of several causes one of the main being climate change it is well known that climate change has a significant impact on population growth and population structure of various species bay et al 2018 jones et al 2018 lindmark et al 2018 parmesan 2006 some species are at risk of extinction while others thrive in response to climate change walther et al 2002 the wild boar is one of the species that thrive in the climate change scenario because its reproduction rate significantly increases under conditions of prolonged summer or high temperatures vetter et al 2015 wild boars have the highest reproductive rate among ungulates and their annual population growth rate exceeds 2 0 bieber and ruf 2005 keuling et al 2013 thus persistent climate change has the potential to accelerate the current increase in wild boar populations markov et al 2019 vetter et al 2015 besides negatively affecting human society the rapid reproduction and or expansion of wild boar populations also leads to ecosystem dysfunction these negative impacts include destruction of forest habitats loss of plants and animals crop damage vehicle crashes and damage to anthropogenic infrastructures giménez anaya et al 2008 graitson et al 2018 in addition wild boars even affect urban areas by causing extensive damage to private gardens parks playgrounds and cemeteries cahill et al 2012 stillfried et al 2017 recently wild boars have become a threat as they are the carriers of diseases such as african swine fever asf and classical swine fever resulting in negative economic impacts guinat et al 2017 guo et al 2016 halasa et al 2016 mentaberre et al 2014 as no cure or vaccines have been developed for the asf virus yet the mortality rate in infected boars and pigs is nearly 100 the native distribution range of wild boars is from the tropical region of asia to siberian forests including semi desertic and temperate ecosystems where they pose serious problems and can be destructive to wildlife ecosystems in natural environments one of the problems associated with wild boars is that they prey on other animal species both vertebrates and invertebrates by scavenging or actively preying when possible focardi et al 2008 gamelon et al 2012 this has a negative impact on biodiversity furthermore wild boar activity in rivers also decreases water quality by increasing turbidity excessive silt and particle suspension and bacterial contamination it was reported that deteriorated water quality over time affected a variety of native aquatic organisms such as fish amphibians and insect larvae and may adversely affect river ecosystem stability kaller and kelso 2006 for these reasons researchers have been exploring various management methods to control wild boar population growth apollonio et al 2010 massei et al 2015 among these methods hunting has been widely used throughout europe apollonio et al 2010 massei et al 2015 nores et al 2008 reported that hunting related mortality was greater than predator related mortality and o keuling et al 2013 showed that hunting is the main cause of wild boar mortality on the other hand some studies have reported that with the decline in wild boar populations as a consequence of hunting other species thrive facilitating conflicts between humans and wildlife e g benhaiem et al 2008 kamei et al 2010 sunde et al 2009 furthermore it has been reported that the density and range of wild boar populations continue to increase despite vigorous hunting activities bengsen and sparkes 2016 o keuling et al 2016 therefore it is necessary to implement a different hunting strategy by comprehensively considering wild boar behavior hunting intensity and environmental conditions while minimizing the negative impact of wild boars in other words hunting should be selective as it may or may not be effective depending on various ecological variables o keuling et al 2008a in order to improve the performance of selective hunting it is essential to understand the behavior of both hunters and wild boars morales et al 2010 in particular it is important to predict wild boar behavior which is a result of both intrinsic and extrinsic motivations intrinsic motivations include spatial memory social behavior and reproductive desire spitz and janeau 1995 whereas extrinsic motivations include food resource acquisition and predator escape o keuling et al 2008b however to the best of our knowledge few studies have been conducted on the combinatorial effects of hunter behavior wild boar behavior and landscape on wild boar population size this is because it is difficult to quantify the ecological factors and also technically demanding to obtain independent data for each factor through field experiments in the present study to overcome this difficulty we constructed an individual based model to mimic the interactions between the ecological factors using the constructed model we explored the interaction between wild boars hunters and landscape heterogeneity on wild boar population size in the discussion we mentioned the limitations of the model and proposed ideas for its improvements to obtain a more realistic model 2 materials and methods 2 1 individual based model we constructed an individual based model to simulate an ecosystem consisting of simulated hunters sim hunters and simulated wild boars sim boars inhabiting heterogeneous simulated landscapes on a 100 100 grid space each grid site was characterized by a number h ranging from 0 0 to 1 0 which indicated the degree to which it is suitable for inhabitation by sim boars the physical unit of iteration time t was set to days to determine the values of variables used in the model the simulation was set to end when t 5000 and a periodic boundary condition was applied to minimize boundary effects caused by simulation space size limitations for each parameter condition we performed 20 simulations population size dynamics for each repetition were expressed as ϕ k t k represents the k th repetition and n t is the average of ϕ k t over k we then averaged n t over the time range 4000 t 5000 to determine the population size n this calculation process can be mathematically described as follows 1 n t 1 20 k 1 20 ϕ k t n 1 1 000 t 4 001 5 000 n t in order to increase the understanding of the model we added the descriptions and values of the parameters used in the model in table 1 some of the values were based on experimentally obtained data p 0 and p n and others p r r d r sens p j and ph were appropriately selected in consideration of simulation stability notably it is technically difficult to experimentally verify the appropriately selected values and is beyond the scope of this study for example to determine the p j value it is necessary to acquire and analyze the traveling trajectory data of wild boar under various ecological conditions in addition in order to estimate the p r value it is necessary to measure the wild boar reproduction rate as a function of environmental conditions the other parameters h h and β used the full range of values that can be taken mathematically in this study we used the matlab ver 2021a to build the simulation model and the functions provided by the software to analyze the simulation results 2 2 heterogeneous landscape to reflect the habitat characteristics in the model we created a simulated landscape with spatial heterogeneity using a neutral landscape model with 1997 the landscape was represented as a map called h map with a 100 100 grid fig 1 the landscape model is based on real landscapes which have partial spatial structures present in whole landscape structures this model uses a fractal algorithm that accurately reflects the structural characteristics and controls the degree of spatial autocorrelation by adjusting the variable h in the algorithm palmer 1992 landscapes with low spatial autocorrelation low h are bulkier and have highly variable surfaces e g sharp peaks adjacent to deep valleys among several fractal algorithms we used the intermediate displacement algorithm described by saupe 1988 to generate a heterogeneous landscape as a result the fragmentation degree of the areas preferred by wild boars can be characterized by the h value in the h map the higher the h value the lower the fragmentation degree we assigned each grid a value of h between 0 0 and 1 0 we interpreted the values as the degree to which wild boars preferred sites with these values i e wild boars preferred sites presented higher h values the characteristics of the h map are determined by the h value between 0 0 and 1 0 the higher lower the h value the more less clustered grids with lower higher h values when h 0 0 grids with high h values tend to be mostly fragmented whereas grids with high h values form larger clusters as they approach h 1 0 gardner 1999 gardner et al 1987 lee 2018 2 3 wild boar simulations 2 3 1 traveling behavior considering that individual differences in wild boars and unknown external stimuli may cause differences in individual walking paths we included randomness in the h map for this purpose an r map with a 100 100 grid was built fig 1 each grid of the r map was given a randomly generated value between 0 0 and 1 0 then using a β variable the h map and the r map were combined to generate a w map that simulates sim boar traveling behavior as follows 2 w i j 1 β h i j β r i j where i and j represent the i th and j th grid position in space respectively as the β value approaches 0 0 the h map becomes dominant whereas as the β value approaches 1 0 the r map becomes dominant fig 2 using the w map we can calculate the probability p i j that the sim boar located at the site i j will move to its neighboring site i j according to the following equation below 3 p i i s j j t w i s j t p q 1 0 1 w i p j q s t 1 0 1 2 3 2 reproduction behavior sim boars were designed to reproduce and have offspring using probability density functions obtained from the annual offspring reproduction rate for actual wild boars halasa et al 2019 a random number was generated at each iteration time and compared to a given value of p 0 0 0027 if the random number value was less than p 0 it decided to reproduce p 0 was derived from the assumption that sim boars reproduce once a year when a sim boar had offspring the process of determining the number of offspring ran to determine the number of offspring a new random number was generated and compared with the probability value p r determined from the sigmoid function fig 3 a the sigmoid function was used to allow sim boars to generate more offspring in better habitat conditions 4 p r p 0 1 exp 6 12 h i j if the random number was less than p r a minimum of one to a maximum of eight offspring are generated probabilities of 0 012 0 075 0 17 0 25 0 25 0 17 0 075 0 025 and 0 005 were given for the number of offspring from 1 to 8 respectively lange 2015 here h i j represents the degree of preference of wild boars in the i th and j th grid site in the w map in fact various functions allow the simulated wild boar to have a low reproduction rate when the habitat conditions are unfavorable and a high reproduction rate when conditions are favorable among the functions we used the sigmoid function because mathematically the function appears more frequently in population dynamics the exponential term 6 12h i j was introduced to mathematically simplify the function curve this term makes the reproduction rate 1 2 p 0 when h i j 0 5 the initial position of newly born sim boars was the same as that of their parents in this model we excluded the mating algorithm from the sim boar reproduction process to avoid complicating the model algorithms if we implement the mating behavior in the model the sim boars should be divided into male and female boars in addition it should be possible to probabilistically reproduce only when a female and a male wild boar meet each other moreover p r is described as a function of two variables the meeting frequency of male and female wild boars and habitat preference in this case it becomes difficult to control the model to have a reasonable p 0 value 2 3 3 death dead boar carcasses are sometimes exposed to other animals for several days this is one of the main factors for diseases such as asf spreading however as our study did not address disease spread carcass status was not considered therefore sim boars were immediately removed from the simulation space upon death sim boars have four types of death processes fig 3b the first type is natural death this process was implemented with an algorithm that generates a random number for each sim boar at every iteration time and removes the sim boar if this value is less than p n 0 0014 halasa et al 2019 the second type is death by hunting when a sim boar enters the hunter s hunting range i e when it is within a certain radius of the hunter it is removed with a certain probability all sim hunters have the same ph value and the simulation was performed for different ph values from 0 2 to 1 0 for example when ph 1 0 sim boars are immediately removed as soon as they enter the circle with d h the third type is the death of old age considering the actual lifespan of wild boars the sim boar was set to have a lifespan of 10 years t 3650 the fourth type is death due to carrying capacity excess caused by too high boar density when other sim boars within the detection distance r sens 5 grids of one sim boar exceed a certain threshold 15 individuals the sim boar was forcibly removed for the implementation of the carrying capacity algorithm we calculated the number of wild boars within the sensing range of a wild boar in random order when the wild boar had more than 15 neighboring boars within the sensing range the boar was eliminated the removed boar may result in another wild boar being removed alive simulation repetition and random ordering serve to overcome the problems caused by asynchronous algorithms if we adopt a synchronization algorithm for the carrying capacity an unrealistic simulation can be made in which wild boars in a small area are collectively eliminated 2 4 hunter simulations to represent the hunter behavior during wild boar tracking in the model we assumed that the sim hunters either walk to move one site during a one time step or jump to move multiple sites at once fig 4 a the path for the walking movement is determined by the h map fig 4a the number of sim hunters was set to five actual hunters may hunt by changing hunting sites far away from each other according to hunting strategies ecological and environmental conditions we implemented the changing behavior by allowing the sim hunter to make random jumps with the probability p j fig 4b the random jump implies that the site change event does not depend on any conditions the jumping means moving to all sites except itself in the simulation space and the walking means moving to a site adjacent to its own site p w represents the probability values of moving to the eight adjacent sites the hunting range of a sim hunter was set to be a circle with the radius r h 5 grid sim boars that were found within this range were hunted according to the probability ph fig 4c 2 5 sensitivity analysis we analyzed the effects of four variables 1 sim boar behavior β 2 and 3 sim hunter behavior p j and ph and 4 landscape heterogeneity h on wild boar population size n using partial rank correlation coefficient prcc which is a global sensitivity analysis that has been shown as the most reliable and efficient sampling based method marino et al 2008 to obtain the prcc we calculated the correlation coefficient cc between input x j and output y as follows 5 cc x j y i 1 n x i j x y i y i 1 n x i j x 2 1 n y i y 2 j 1 2 k where n is the number of samples and k is the size of the input vector the partial correlation coefficient pcc measures the strength of the linear relationship between input x j and output y after the linear influence of the other variables has been eliminated the pcc between x j and y is defined by the cc of x j x j and y y where x j and y are represented by the following linear regression models 6 x j c 0 p 1 n c p x p y b 0 p 1 n b p x p where b and c denote the regression coefficients and the hat signifies a regression fitted variable prcc performs a partial correlation using the linear regression models described in eq 6 which is computed on rank transformed data x j and y note that the prcc lies between 1 and 1 positive negative values indicate a positive negative correlation of the parameter with the model output a positive negative correlation implies that a positive negative change in the parameter increases decreases the model output therefore the larger the absolute prcc value the greater the correlation of the parameter with the output in the present study we used the latin hypercube sampling lhs method to generate samples of input variables that can avoid repetitive sampling the lhs method is one of the stratified sampling methods mckay et al 1979 and can significantly reduce the required number of simulations compared to that in the conventional monte carlo method iman and helton 1988 a total of 1000 simulations were performed wherein a set of parameter values was selected from the uniform distribution for the performance we used the prcc function in matlab ver 2021a 3 results fig 5 shows the change in sim boar population size n averaged over the number of simulation repetitions at h 0 0 when the β value varied from 0 0 to 1 0 in the absence of sim hunters with the increase in the β value the n tended to increase for β 0 8 the n was saturated below 150 whereas for β 0 8 it was saturated with values between 250 and 300 left in fig 5 this showed that it was more advantageous for sim boars to inhabit areas in a scattered manner a level at which β 0 8 rather than concentrating in their preferred areas to show the relative change n in n under different β values over time we used the area function in matlab ver 2021a right of fig 5 this function sequentially plots time series by adding it to the plotted time series n can be mathematically expressed as 7 n k 1 k p n k where k has values of 1 2 6 for β 0 0 0 2 1 0 respectively the n increased at first and then was saturated when t 4000 this indicated that sim boars which were randomly located at the beginning of the simulation moved to a preferred area over time where their reproductive rate became high resulting in a stable β effect see the red box in the right of fig 5 the color of the figure is the same as the color used to distinguish the different β values on the left of fig 5 fig 6 shows the change in n values when h 1 0 as β increased the value of n tended to increase when β 0 8 the value of n was stabilized in the range of 250 and 300 considering figs 5 and 6 the n value decreased as the h value increased this indicates that h had an effect on the decrease in population size this tendency is illustrated by the n plot shown in fig 6b to visually confirm the h effect we investigated the positional movement of sim boars over time fig 7 when h 0 0 sim boars which were randomly distributed in the simulation space at the initial stage gathered along the h map to their preferred regions over time after sufficient time passed t 1500 the sim boars were divided into several small groups and the populations within the groups stabilized without significant changes indicated by the dotted rectangle in fig 7a the small sized groups had an advantage as they had less chance of being limited in number by carrying capacity p e this had a positive effect on the overall sim boar population growth on the other hand when h 1 0 many sim boars flocked to a few preferred areas and population growth was limited by the p e effect which in turn negatively affected the increase in n n as defined in eq 1 represents the average of n over the time between 4000 t 5000 in order to comprehensively demonstrate the results described above we expressed the change in n value with respect to the change in h and β values on a grid map fig 8 the value of n decreased with the increase in h whereas it increased with the increase in β the degree of change in n value for an increase in h value tended to be more pronounced when β values were high fig 9 shows the changes in n values versus the changes in h and β values in the presence of a hunter for p j 0 00 and 0 06 and ph 0 4 and 0 8 similar to the tendency shown in fig 8 the n value decreased as the h value increased and it increased as the β value increased this tendency was evident regardless of the p j value the effect of the p j value on n appeared to be positive or negative depending on h and β values to understand the p j effect more intuitively we investigated the interaction of sim boars and sim hunters over time at p j 0 0 and 0 06 with h 0 5 β 0 0 and ph 1 0 fig 10 to prevent sim boars from being hunted while migrating to the preferred areas a value of ph 0 0 was given at 0 t 1500 and it changed to 1 0 at t 1500 in the case of p j 0 0 fig 10a sim boars were randomly distributed in the early stage followed by gradual moving to and inhabiting the preferred area sim hunters also moved to the preferred area and hunted the gathered sim boars indicated by dotted circles in fig 10a after sufficient time all sim boars in the preferred area were removed and sim hunters no longer had any boars to hunt indicated by dotted squares in fig 10a particularly sim hunters were trapped in the preferred areas with no target to hunt for comparison in the case of p j 0 06 fig 10b sim hunters could avoid being trapped in a preferred area they entered indicated by the dotted rectangle in fig 10b however the ability to jump also prevented sim hunters from eliminating all sim boars that have gathered in the preferred area consequently the remaining sim boars were able to reproduce resulting in population growth the combinatorial effect is underlying p j influence which was not clear in fig 9 we performed prcc analysis to explore to which extent h β p j and ph contributed quantitatively to the n value fig 11 we found that β contributed the most to the increase in n value 0 9287 whereas the other three variables contributed to the decrease in n value among the latter three variables h was the most influential 0 3944 followed by ph 0 3212 whereas p j was the least influential 0 0121 4 discussion and conclusion in the present study we built an individual based model to explore the effects of four ecological variables on wild boar population size n the studied variables included landscape heterogeneity h wild boar migration behavior β hunter s spatial jumping behavior p j and hunting success probability ph a great increase in wild boar populations causes various problems to human society on the other hand if their population is heavily reduced the stability of the ecosystem is threatened therefore it is necessary to control the population size and maintain it at an appropriate level our simulation results showed that β made a positive contribution to the increase in n value furthermore h and ph contributed negatively and p j had little effect on n fig 11 this showed that we can determine the optimal population size to reduce wild boar damage and maintain ecosystem stability through β control strategies which increase wild boar populations and h and ph control strategies which decrease wild boar populations as a realistic way to implement the β strategy partial fences or nets can be built around areas with a high density of wild boars in order to artificially change their migration path lavelle et al 2011 alternatively certain sounds that might disturb wild boars e g gunshots sirens etc can be used to repel them krol et al 2019 as a practical approach to h and ph control strategies it is possible to increase h values by providing wild boars with fewer large habitats rather than many smaller ones large habitats can be large forests with a high abundance of food and refuge places for wild boars although this method is not intuitively accepted it is understandable that many boar grouping enhance the density limiting effect of excess carrying capacity and provide an opportunity for hunters to achieve effective hunting performance with minimal changes in hunting sites although our study may help develop practical and ecological wild boar population control strategies some important ecological features and processes were omitted in the simplification of the model in our model we designed sim hunters to hunt independently and individually whereas actual hunters mainly hunt with the help of beats and dogs it is necessary to introduce simulated hounds and bitters into the model and include the algorithm that enables cooperative behavior between hunters in addition in the present study the behavior of sim boars related to better habitats depended only on habitat conditions regardless of the presence of hunters however actual wild boars tend to run away when they feel hunting pressure therefore it is necessary to improve the model by adding an algorithm for this escape behavior actual wild boars have different characteristic behaviors depending on the age of the individual for example young wild boars follow their parents and become independent when they become adults however our model assumed that all sim boars are physically and physiologically identical which prevented the simulation of characteristic behaviors thus implementing algorithms for these characteristic behaviors could improve the model and make it more realistic our simulation results for the p j effect were the combination of two effects one was related to sim hunters jumping to another area with a p j probability before eliminating all sim boars within the sim hunter s preferred area the other was related to keeping the sim hunters hunting by avoiding them being trapped in the preferred area and allowing them to jump these two effects canceled each other out and consequently had little effect on the population size n this indicated that it is inefficient for hunters to change hunting sites although the model proposed in the present study can be improved as described above we believe that this study is valuable as it not only provided a newly developed ecosystem model for exploring the methods of wild boar population size control but it also suggested possible ways in which the model can be applied in the field author contributions s h l writing original draft modeling conceptualization and data analysis writing review and editing c m p discussion regarding methodology data analysis and programming algorithms all authors contributed to data interpretation critically reviewed revised and approved the final manuscript declaration of competing interest all authors declare no competing interests acknowledgments this work was supported by korea institute of planning and evaluation for technology in food agriculture and forestry ipet through animal disease management technology development program funded by ministry of agriculture food and rural affairs mafra grant number 320055 2 and national institute for mathematical sciences 
