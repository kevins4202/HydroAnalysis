index,text
22000,the fuel costs which constitute the highest proportion of sailing costs vary considerably depending on ocean condition although ships sail on the same route among various ocean conditions a wave height is one of the most significant factors to be considered for economic routing which aims at reducing fuel expenses in this study we propose deep neural network based approaches for real time significant wave height estimation from solely raw ocean images first we estimate significant wave height level from single ocean image convolutional neural network cnn based classification model is constructed by investigating the four cnn structures and two performance improvement methods second we propose a regression model that estimates real valued significant wave heights from sequential ocean images this model is based on convolutional long short term memory to extract spatio temporal features from time series images experimental results on national data buoy center dataset showed that the proposed classification model yielded an accuracy of 84 in addition the proposed regression model yielded a mean squared error of 0 0177 on the proposed dataset which consisted of serial ocean images captured from a container ship keywords real time significant wave height estimation ocean wave image processing convolutional neural network convolutional long short term memory 1 introduction information on wave heights is necessary in planning many operation related activities in the ocean deo and naidu 1998 wave conditions are important for the economic sailing because shipping routes can be optimized by avoiding rough seas thereby reducing the sailing time and fuel expense james et al 2018 therefore efficient course selection based on wave height estimation is an effective strategy to save fuel cost which accounts for a great part of navigation expenses in actual navigation it is impossible to measure the significant wave height in real time because expensive equipment is required to collect relevant data however since the meteorological data and ocean images are available more cheaply than wave data itself important knowledge for the waves can be obtained indirectly from them deo et al 2001 two approaches have been developed for wave height estimation as follows 1 numerical methods and 2 soft computing methods savitha et al 2017 numerical wave models are based on the concept of a wind wave energy spectrum that wave energy grows and decays in response to changes in the wind field malekmohamadi et al 2011 numerical methods estimating the significant wave height based on the spectral energy balance equation can be represented as follows komen et al 1996 hasselmann et al 1973 booij et al 1999 tolman et al 2009 1 e σ θ t t s s i n s n l s d s where e σ θ t is a two dimensional wave spectrum depending on frequency σ and propagation direction θ s is the net source function that depends on s i n the external wave making factors such as local wind and local current s n l the non linear energy transfer by wave wave interactions and s d s the dissipation savitha et al 2017 in a numerical model the energy input term s i n is generally expressed by the resonant interaction between waves and turbulent pressure patterns in the air phillips 1957 and the feedback between growing waves and induced turbulent pressure patterns miles 1957 the dissipation term s d s depends on the existing energy in the waves and on the wave steepness and is formulated in the wave model as a function of wave steepness hasselmann et al 1973 in numerical methods representing nonlinear s i n becomes a challenging task and therefore wam komen et al 1996 jonswap hasselmann et al 1973 swan booij et al 1999 and wavewatch iii tolman et al 2009 had been developed based on how input term is expressed however numerical models involve a certain degree of uncertainty because their estimations result from the solution of differential equations which are based on approximations of wave energy from the available wind information furthermore they also involve complex mathematics for wave forecasting in wide areas of ocean soft computing methods attempt to estimate significant wave height not based on physical equations but based on soft computing algorithms artificial neural network support vector machine bayesian network and fuzzy inference system are popular machine learning techniques that have widespread applications in regression and classification artificial neural network approaches attempted to learn the complex relationship between inputs and outputs from a large amount of data using neural network architectures bazargan et al 2007 berbić et al 2017 deo et al 2001 deo and naidu 1998 londhe and panchang 2006 makarynskyy 2004 mandal and prabaharan 2006 tsai et al 2002 these models generally used weather information as a source of input variables deo et al 2001 solved the problem based on three layered feed forward network with generating wind speed as inputs kumar et al 2018 adopted transfer learning of neural networks and savitha et al 2017 attempted sequential learning furthermore morimoto and nakamura 2012 formulated the wave height estimation as a classification problem and used physical features extracted from a part of the ocean images as input variables support vector machine has been an alternative machine learning based wave height estimation model yielding superior performance mahjoobi and mosabbeb 2009 used wind data while salcedo sanz et al 2015 and cornejo bueno et al 2016 used features extracted from x band radar images as a source of input variables the approaches based on bayesian network represented the probabilistic relationships between the wind and wave conditions scotto and soares 2007 estimated long term significant wave height by combining bayesian methodology and extreme value techniques finally fuzzy inference system models estimated wave conditions by modeling parameters of fuzzy models from data kazeminezhad et al 2005 mahjoobi et al 2008 although the aforementioned soft computing methods reported noticeable wave height estimation performances but these achievements mainly result from various features that were come up with by expert engineers such as wind conditions wave data and radar images to the best of our knowledge there has been no machine learning models that attempted to estimate the significant wave heights based solely on raw ocean images from the perspective of data source it is very difficult to utilize real time weather information and radar image data which are mainly used in numerical and soft computing methods generally collecting precise wind data is not possible because satellite images are not reliable in coastal areas and the resolution of wind measurements is not sufficient since it is collected from scarce buoys and occasional ship reports malekmohamadi et al 2011 in addition there is economic difficulty in collecting radar images since an expensive equipment such as wamos ii system is required therefore we propose deep neural network based models to estimate wave heights in real time based solely on ocean images without meteorological data in this study we build real time significant wave height estimation models that are trained based on raw ocean images which can be captured in real time and inexpensively using an optical camera first we estimate significant wave height level from single raw ocean image using convolutional neural network cnn based classification model to determine the most suitable cnn architecture for processing ocean images we investigate four well known cnn structures i e vggnet simonyan and zisserman 2014 inception v3 szegedy et al 2016 resnet he et al 2016 and densenet huang et al 2017 which yielded high performances in various image classification problems then we improve the accuracy by applying transfer learning and modifying cnn architecture so that more delicate and diverse features can be learned from raw ocean images in addition we build a convolutional long short term memory convlstm based regression model to accurately estimate wave height from a sequence of ocean images to verify the proposed models we conducted experiments based on two datasets the classification model was tested on the dataset collected from the national data buoy center ndbc and the regression model was evaluated using a proposed dataset consisting of serial ocean images captured from optical cameras on sailing ship the remainder of this paper is organized as follows in section 2 we briefly review base architectures used in the proposed models in section 3 we describe our classification approach including candidate cnn model structures and performance improvement methods in section 4 we describe our regression approach for estimating real valued wave heights instead of discrete wave height levels in section 5 datasets are explained followed by the experimental results and discussions finally in section 6 we conclude our study with some future research directions 2 base architectures for 2d and 3d deep neural networks 2 1 convolutional neural network cnn is a class of deep neural networks and has been most commonly applied to image processing simonyan and zisserman 2014 cnn consists of convolutional layer pooling layer and fully connected layer as shown in fig 1 first the convolutional layer extracts latent features from an image by applying convolution filters to the input the parameters of convolutional layer consist of a set of learnable filters connected only to a local region in the input volume spatially but to the full depth these weights are shared across the input the detailed operation of convolutional layer can be represented as follows 2 x i j l g x l 1 w l i j g m n x i m j n l 1 w m n l where x i j l is i j th value of l th layer and w m n l is m n th weight of convolution filter in the l th layer g is a non linear activation function thus if the dimension of the l 1 th layer is the width w height h and channel c and the dimension of convolution filter in l th layer is the width f height f and channel c then the l th layer is derived by applying nonlinear activation function g to the convolution operation of x l 1 r w h c and w l r f f c sigmoid hyperbolic tangent and rectified linear unit relu are generally used activation functions which enable the model to capture nonlinear relationship between the previous and the following layers in addition convolution operation is described in fig 2 a a 3 3 convolution filter is convolved across the width and height of the 4 4 input with the stride size of 1 computing the sum of element wise dot products between the entries of the filter and the input in doing so a two dimensional activation map is produced which gives the responses of the filter at every spatial position the parameters of convolution filter in each layer which extract the local connectivity between layers are learned by gradient descent optimization method the pooling layer periodically inserted between convolutional layers reduces an amount of parameters and computation in the network and also controls overfitting a pooling operation reduces spatial size of input by selecting representative value in specific area based on a specific rule as shown in fig 2 b max pooling uses max operation to choose the representative values the average operation is applied to the input in average pooling as shown in fig 2 c finally neurons in a fully connected layer have full connections to all activations in the previous layers their activations are computed with a matrix multiplication the fully connected layer which generally comes after a repeated set of convolutional and pooling layers performs decision making based on the latent features extracted from the previous layers various cnn models can be constructed by stacking convolutional layers pooling layers and fully connected layers lecun et al 2010 2 2 convolutional long short term memory convlstm xingjian et al 2015 is a layer to extract features from a sequence of images instead of from a single image the model to process sequential images requires the ability to extract both spatial and temporal information from images as it should adapt to changes over time therefore convlstm involves convolution operations to generate a good spatial representation of each frame and lstm hochreiter and schmidhuber 1997 to encode the temporal changes in sequences lstm is a class of recurrent neural network mikolov et al 2010 that can process sequential data lstm was introduced to solve the vanishing gradient problem encountered in recurrent neural networks when processing long sequences lstm incorporates memory units that contain information about the inputs that the lstm units have seen and is regulated using several fully connected gates because the main purpose of processing image sequences is to discover changes in both spatial and temporal dimensions convlstm encodes spatio temporal information using the convolutional gates in lstm fig 3 shows the convlstm layer where its operation can be expressed as follows 3 i t σ w x i x t w h i h t 1 b i 4 f t σ w x f x t w h f h t 1 b f 5 c t σ w x c x t w h c h t 1 b c 6 o t σ w x o x t w h o h t 1 b o 7 c t c t 1 f t c t i t 8 h t o t t a n c t where x t h t and c t are the t th input hidden state and cell state respectively the various forms of w represent the weights of different gates in convlstm in addition represents the convolutional operation and refers to the hadamard product the gate activations i t and f t contain information about the degrees to which the new and past cell states should be incorporated respectively and o t indicates the degree to which the current cell state is used to compute the current hidden state in addition x t h t c t i t f t and o t are all 3d tensors in the case of convlstm 3 significant wave height level classification 3 1 candidate cnn models cnn models which show good performance in image processing have developed from alexnet krizhevsky et al 2012 in this paper we employ four candidate cnn structures i e vggnet inception v3 resnet and densenet to find a suitable significant wave height classification model vggnet is a simple cnn architecture constructed by deeply stacking small 3 3 convolutional layers vggnet suggests that the depth of neural network is a key success factor for image processing improving model performance by increasing the depth of cnn this network performs only 3 3 convolutions and 2 2 pooling operations from the beginning to the end and therefore it can extract features in wider area of the image with fewer parameters in addition there are two forms of vggnet vgg16 and vgg19 according to the number of learnable layers for example vgg16 is composed of 13 convolutional layers followed by 3 fully connected layers as shown in fig 4 a whereas vgg19 is composed of 16 convolutional layers followed by 3 fully connected layers we used vgg16 in this study inception v3 is an advanced model of googlenet szegedy et al 2015 that makes efficient use of parameters in the network googlenet reduces the number of parameters by introducing an inception module which is constructed by a horizontal arrangement of convolution layers with 1 1 3 3 and 5 5 filters it also uses 1 1 convolutions as dimension reduction modules to reduce computational bottlenecks in doing so it can increase both depth and width of networks without significant performance penalty szegedy et al 2015 furthermore inception v2 changes the inception modules using convolution factorization and introduces reduction modules that efficiently decrease the network volume in details convolution factorization reduces the number of parameters by decomposing n n convolution to multiplication of n 1 vector and 1 n vector the reduction module also makes lower computation by concatenating outputs of convolution and pooling operations finally inception v3 improves performance of inception v2 with label smoothing and fine tuning as can be seen in fig 4 b it is composed of various inception and reduction modules resnet is a residual learning framework for deeper cnn structures it alleviates the vanishing gradient problem and strengthens feature propagation using a skip connection which adds the identity to the output of the layer an architecture of resnet used in this study is illustrated in fig 4 c it consists of residual blocks where skip connection performs identity mapping between convolutional layers finally densenet is a cnn architecture that uses skip connections more densely while resnet adds the short connection from one layer to other layer only once densenet connects each layer to every other layer in each dense block however the role of skip connection between the resnet and densenet is different an identity feature map is added to the output of the output layers in resnet but the feature maps in previous layers are concatenated to the feature maps in the following layers hence the number of channels are not changed in the resnet whereas it is monotonically increasing in the densenet within the building block an densenet example in fig 4 d has three dense blocks where the feature maps are accumulated in a way demonstrated above 3 2 methods for classification performance improvement in addition to searching the cnn architecture for processing raw ocean images we also attempt to improve the classification performance using two additional methods first we apply transfer learning to cnn based classification model transfer learning is proposed to alleviate difficulties in training an entire cnn model from scratch using insufficient examples it can improve model performance by transferring learned knowledge from a large dataset to the model used to train a new dataset specifically a cnn model pretrained on a very large dataset is used either as a fixed feature extractor or initialization for the tasks of interest the former replaces the last fully connected layer of a pretrained model to one whose output nodes fit to a new dataset and treats the rest of the model as a fixed feature extractor the latter not only replaces the classifier on top of the pretrained cnn but also fine tunes other layers by continuing the backpropagation on the new dataset in addition the degree of fine tuning depends on the difference between the dataset of interest and that on which the cnn was pretrained in this study we attempt to apply transfer learning to cnn models with fine tuning fig 5 describes the application of transfer learning in vggnet as an example we pretrain a cnn model on the imagenet dataset which contains 1 2 million images with 1000 categories we then fine tune all layers of this model as a gap exists between the images in the imagenet dataset and ocean images specifically the last fully connected layer of the pretrained model is replaced by one with two output nodes and the parameters of the remaining layers are used to initialize the wave height classification model we also attempt to improve the classification performance by modifying the cnn architecture which is illustrated in fig 6 the main architectural change is that we insert the three global feature extractors between the last convolution layer and the fully connected layer global max pooling gmp global average pooling gap and convolution operation as shown in fig 7 a gmp is an extended operation of max pooling mentioned in the previous section 2 1 gmp selects the maximum value of each channel as the representative value and produces feature vector whose dimension is same as the number of channels gap also makes the feature vector that consists of the average value of each channel finally as can be seen in fig 7 c convolution operation in the modification of cnn uses many convolution filters which have same dimension with input this operation produces the feature vector whose dimension is same as the number of filters in this study we use 512 filters in this convolution operation 4 real valued significant wave height regression 4 1 convlstm based model convlstm xingjian et al 2015 has been commonly applied to video processing related tasks we build the convlstm based regression model by modifying the architecture of the model proposed in sudhakaran and lanz 2017 fig 8 shows the network architecture used to estimate the real valued significant wave heights in this model instead of applying the input frame itself we use the difference between two adjacent frames as the input to process their changes sudhakaran and lanz 2017 the proposed regression model is constructed by stacking convolutional convlstm and fully connected layers specifically spatial features extracted from convolutional layers are fed into the convlstm to generate spatio temporal information in addition bi directional convlstm is employed to incorporate both forward and backward temporal information once all frames are processed the hidden state of each bi directional convlstm cell contains a representation of each input frame pair finally we generate representations of all input images by applying gap to the concatenated vector of forward and backward hidden states and a series of fully connected layers are connected between the gap layer and final output node for regression in the proposed model vggnet pretrained on the imagenet dataset is used for the frame level feature extractor in the convlstm we use 256 filters in all gates with a filter size of 3 3 and stride 1 relu nonlinear activation is applied after each convolutional and fully connected layer 5 experiments 5 1 datasets the proposed models were evaluated on two datasets the cnn based classification model was tested on the publicly available ndbc dataset 1 1 https www ndbc noaa gov and the convlstm based regression model was evaluated on a new dataset of time series ocean images collected by a container ship the ndbc dataset consisted of ocean images captured on 20 buoys at 10 min after every hour and significant wave heights measured at 40 min after every hour between march 6 2018 and may 10 2018 although the ocean images were captured on 20 buoys floating in different ocean areas we could integrate these images into one dataset because the representative video datasets soomro et al 2012 karpathy et al 2014 carreira and zisserman 2017 used in deep learning are commonly composed of videos filmed with different cameras situations and locations moreover we matched the wave heights to the images captured 30 min after the wave measurement time because a 30 min gap existed between the collection times of ocean images and wave information for example the significant wave height value measured at 10 40 am was assigned to the ocean image captured at 11 10 am this label matching method was based on the fact that significant wave heights demonstrated a smooth trend in the time series plot in addition we transformed the continuous dependent variable into categorical one to classify the level of significant wave height binary classes of wave conditions were constructed by selecting only low and high classes among the three classes uniformly divided from continuous variable specifically significant wave heights less than 1 52m were classified as low class and those higher than 3 05m were considered as high class it was reasonable to classify the level of wave height from this data because distribution based label processing was similar to the criterion by which practitioners judged the degree of wave height as fig 9 shows ocean images were collected at various times and under different weather conditions images such as those shown in fig 9 a and b were suitable for training the cnn model however the image in fig 9 c was likely to interfere with cnn model training because strong sunlight hid the shape of the wave in addition as shown in fig 9 d the dark image captured at night could not be used for model training because the shape of the wave was not identified therefore we removed the unsuitable images based on the average brightness of images specifically we eliminated images in which the mean rgb pixel value was less than 30 or greater than 190 as they are inappropriate for training cnn models consequently we used 44 620 pairs of ocean images and wave height classes and divided them into 35 696 training and 8924 test examples furthermore we trimmed the lower halves of the images contained in the ndbc dataset because a large portion of the upper halves depicted not ocean but sky finally the images were resized to 224 224 pixels to be inputted to the pretrained cnn models because the ndbc dataset consists of snapshot images with 1 h intervals we used another dataset consisting of serial images having very short intervals captured from optical cameras with the corresponding wave height information measured by radar equipment both cameras and wave radar were installed in a container ship and the images and wave information were collected while sailing as fig 10 shows the second dataset consisted of significant wave heights and image clips that represent sets of continuous ocean images this dataset contains 97 458 ocean images captured every second and wave heights measured every 10 min between october 9 and november 23 2018 because of the difference in collection times between ocean images and wave data we applied a new label matching method to this dataset we matched the wave heights to images captured for five min before and after measurement time of the wave data furthermore we cropped only the sea region of 224 224 pixels in the same location of the ocean images and then produced the clip containing 16 consecutive images having the same wave height as a result we used 3019 image clips with the corresponding significant wave heights and divided them into 2675 training and 344 test examples 5 2 evaluation metrics in this study we used various metrics to evaluate the proposed classification and regression models first four classification performance measures were used simple accuracy acc true positive rate tpr true negative rate tnr and balanced correction rate bcr which were calculated from the elements of confusion matrix shown in table 1 in this study we considered high class as positive because of its importance in real sailing environment acc represents the proportion of observations correctly classified regardless of their original class labels and is calculated as follows 9 a c c t p t n t p t n f p f n 100 tpr and tnr are computed as shown in eqs 10 and 11 tpr measures the proportion of actual high class images that are correctly identified as high class tnr is the proportion of the actual low class images which are correctly classified as low class finally bcr is the geometric mean of tpr and tnr 10 t p r t p t p f n 100 11 t n r t n t n f p 100 12 b c r t p r t n r 100 in addition four regression performance metrics were used mean squared error mse root mean squared error rmse mean absolute error mae and mean absolute percentage error mape all measures were calculated from the difference between the actual value a i and predicted value p i therefore the higher the measures the higher the performance four metrics for the regression task are computed as follows 13 m s e 1 n i 1 n a i p i 2 14 r m s e 1 n i 1 n a i p i 2 15 m a e 1 n i 1 n a i p i 16 m a p e 100 n i 1 n a i p i a i 5 3 experimental results 5 3 1 significant wave height level classification results as explained in section 3 we employed four cnn architectures to which transfer learning and architecture modification were attempted table 2 presents the average test classification performance of 10 replicates for each basic candidate cnn model resnet yielded the best performance because not only were its acc tnr and bcr the highest but also its training time was the shortest the classification performances of vggnet and densenet were slightly lower than that of resnet however vggnet outperformed densenet in terms of training time therefore vggnet and resnet were selected as the two cnn structure candidates for significant wave height classification furthermore we attempted to apply the data preprocessing method to improve training efficiency when the grayscale data preprocessing method was used the original ocean images were converted into grayscale images which had one input channel this could reduce the training time by decreasing the depth of the convolution filters in the first convolutional layer table 3 details the effects of the data preprocessing method because vggnet and resnet were selected as our basic cnn structures we applied the grayscale method only to these models when the grayscale method was applied the training time of vggnet decreased 149 min 24 s 137 min 19 s however the test acc also decreased 77 09 73 33 similar to those of vggnet both the training time and test performance of resnet also decreased when image grayscale was applied therefore we used original rgb images for training because of the performance degradation by the data preprocessing method table 4 presents the effects of transfer learning and cnn modification on classification performance and they are denoted as tl and cm respectively in table 4 the proposed architecture with different feature extractors inserted between the last convolution layer and the first fully connected layer trained by transfer learning resulted in high classification performance in both vggnet and resnet when transfer learning was applied not only was the test acc of vggnet improved 77 09 83 45 and 78 38 84 05 with cnn modification but also the performance of resnet was improved 77 32 83 26 and 77 90 83 89 with cnn modification furthermore when cnn modification was applied to vggnet with and without transfer learning the test acc increased from 83 45 to 84 05 and from 77 09 to 78 38 respectively similar to that of vggnet the classification performance of resnet was improved by applying cnn modification the effect on the performance improvement was more significant with transfer learning than with cnn architecture modification when transfer learning was applied the test acc increased by 5 67 6 36 with both vggnet and resnet whereas cnn modification only increased the performance by 0 58 1 29 consequently vggnet and resnet based classification models on which transfer learning and cnn modification were implemented yielded an acc of 84 based on these performances we concluded that it is possible to estimate wave heights from only raw ocean images based on deep neural networks the ndbc dataset contains images captured from six cameras on each buoy using this data we evaluated the effects generated from variations in camera positions we generated the six training and test datasets containing the ocean images captured from each camera we trained the resnet with transfer learning and cnn modification on one training dataset and tested all the six test datasets based on the trained model as a result six iterations of training and testing were performed on the six datasets table 5 lists the testing accuracies for each training test dataset combination the classification performance was the highest when the training and test datasets derived from the same camera although the classification performances on the test datasets derived from different cameras were slightly lower than the best performance their variations were not significant in most cases therefore we concluded that the proposed classification model can be robust to variations in camera position 5 3 2 real valued significant wave height regression results encouraged by the accurate performance of the classification models we also attempted to estimate more precise wave heights using 3d deep neural networks as presented in section 4 we proposed a wave height regression model based on bi directional convlstm with the cnn feature extractor the regression performance tested on the proposed convlstm based model is presented in table 6 the regression model yielded 0 0886 m of mae which means that the absolute difference between the actual value and estimated one was only 0 0886 m in addition mape showed that the actual value to estimated error ratio was only 5 8803 therefore the convlstm based significant wave height regression model showed a favorable performance in both absolute and relative error metrics fig 11 shows the actual significant wave heights and estimated values by the proposed model it can be observed that although the actual significant wave heights showed large variations the proposed model could successfully capture the trend and estimate at a low error rate in most cases 6 conclusion the significant wave height is one of the key factors to be considered in ship routing decisions for operational economic efficiency correct estimation of wave conditions can reduce the fuel costs which constitute the largest portion of operational costs during sailing however complex equations must be solved for wave forecasting in wide area of ocean based on existing numerical methods additionally real time estimation based on soft computing approaches requires expensive data such as weather information wave data and radar image data although there has been an attempt to use ocean images as an input to the wave height estimation model their usability is limited because of the extraction of hand crafted features from parts of images therefore we attempted to estimate significant wave heights in real time from only raw ocean images which are local and precise areas captured from sailing ships based on this estimation sailing ships could optimize shipping routes through a real time information network of ships on which is installed wave condition estimation equipment based on the proposed methods in this study we proposed the neural networks to estimate the significant wave height in real time from only raw ocean images first we estimated significant wave height level from the single ocean image the proposed method was constructed through two steps to find the suitable cnn model for ocean image processing we investigated four candidate models i e vggnet inception v3 resnet and densenet next we applied the transfer learning and cnn structure modification to improve the model performance experimental results showed that the vggnet and resnet based models using transfer learning combined with various feature extractors yielded favorable performance on significant wave height classification moreover we proposed the bi directional convlstm based regression model to estimate real valued significant wave heights from a set of sequential ocean images the model estimated wave heights by extracting spatio temporal features from consecutive images using vggnet and convlstm experimental result showed that the proposed model yielded a very low error rate in terms of mae and mape although the experimental performance was noticeable there are some limitations in current study which lead us to future research directions our method which makes real time wave height estimation cannot estimate the other wave conditions i e direction and period although the significant wave height is practically sufficient in optimal routing decision making additional information of wave conditions can be more useful if it is correctly estimated credit authorship contribution statement heejeong choi methodology investigation validation writing original draft visualization minsik park software investigation resources data curation gyubin son software methodology visualization jaeyun jeong resources validation jaesun park resources methodology kyounghyun mo methodology investigation pilsung kang conceptualization writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported in part by the national research foundation of korea nrf grants funded by the korean government msit under grant nrf 2019r1f1a1060338 and grant nrf 2019r1a4a1024732 and in part by the korea institute for advancement of technology kiat grant funded by the korean government motie the competency development program for industry specialist under grant p0008691 
22000,the fuel costs which constitute the highest proportion of sailing costs vary considerably depending on ocean condition although ships sail on the same route among various ocean conditions a wave height is one of the most significant factors to be considered for economic routing which aims at reducing fuel expenses in this study we propose deep neural network based approaches for real time significant wave height estimation from solely raw ocean images first we estimate significant wave height level from single ocean image convolutional neural network cnn based classification model is constructed by investigating the four cnn structures and two performance improvement methods second we propose a regression model that estimates real valued significant wave heights from sequential ocean images this model is based on convolutional long short term memory to extract spatio temporal features from time series images experimental results on national data buoy center dataset showed that the proposed classification model yielded an accuracy of 84 in addition the proposed regression model yielded a mean squared error of 0 0177 on the proposed dataset which consisted of serial ocean images captured from a container ship keywords real time significant wave height estimation ocean wave image processing convolutional neural network convolutional long short term memory 1 introduction information on wave heights is necessary in planning many operation related activities in the ocean deo and naidu 1998 wave conditions are important for the economic sailing because shipping routes can be optimized by avoiding rough seas thereby reducing the sailing time and fuel expense james et al 2018 therefore efficient course selection based on wave height estimation is an effective strategy to save fuel cost which accounts for a great part of navigation expenses in actual navigation it is impossible to measure the significant wave height in real time because expensive equipment is required to collect relevant data however since the meteorological data and ocean images are available more cheaply than wave data itself important knowledge for the waves can be obtained indirectly from them deo et al 2001 two approaches have been developed for wave height estimation as follows 1 numerical methods and 2 soft computing methods savitha et al 2017 numerical wave models are based on the concept of a wind wave energy spectrum that wave energy grows and decays in response to changes in the wind field malekmohamadi et al 2011 numerical methods estimating the significant wave height based on the spectral energy balance equation can be represented as follows komen et al 1996 hasselmann et al 1973 booij et al 1999 tolman et al 2009 1 e σ θ t t s s i n s n l s d s where e σ θ t is a two dimensional wave spectrum depending on frequency σ and propagation direction θ s is the net source function that depends on s i n the external wave making factors such as local wind and local current s n l the non linear energy transfer by wave wave interactions and s d s the dissipation savitha et al 2017 in a numerical model the energy input term s i n is generally expressed by the resonant interaction between waves and turbulent pressure patterns in the air phillips 1957 and the feedback between growing waves and induced turbulent pressure patterns miles 1957 the dissipation term s d s depends on the existing energy in the waves and on the wave steepness and is formulated in the wave model as a function of wave steepness hasselmann et al 1973 in numerical methods representing nonlinear s i n becomes a challenging task and therefore wam komen et al 1996 jonswap hasselmann et al 1973 swan booij et al 1999 and wavewatch iii tolman et al 2009 had been developed based on how input term is expressed however numerical models involve a certain degree of uncertainty because their estimations result from the solution of differential equations which are based on approximations of wave energy from the available wind information furthermore they also involve complex mathematics for wave forecasting in wide areas of ocean soft computing methods attempt to estimate significant wave height not based on physical equations but based on soft computing algorithms artificial neural network support vector machine bayesian network and fuzzy inference system are popular machine learning techniques that have widespread applications in regression and classification artificial neural network approaches attempted to learn the complex relationship between inputs and outputs from a large amount of data using neural network architectures bazargan et al 2007 berbić et al 2017 deo et al 2001 deo and naidu 1998 londhe and panchang 2006 makarynskyy 2004 mandal and prabaharan 2006 tsai et al 2002 these models generally used weather information as a source of input variables deo et al 2001 solved the problem based on three layered feed forward network with generating wind speed as inputs kumar et al 2018 adopted transfer learning of neural networks and savitha et al 2017 attempted sequential learning furthermore morimoto and nakamura 2012 formulated the wave height estimation as a classification problem and used physical features extracted from a part of the ocean images as input variables support vector machine has been an alternative machine learning based wave height estimation model yielding superior performance mahjoobi and mosabbeb 2009 used wind data while salcedo sanz et al 2015 and cornejo bueno et al 2016 used features extracted from x band radar images as a source of input variables the approaches based on bayesian network represented the probabilistic relationships between the wind and wave conditions scotto and soares 2007 estimated long term significant wave height by combining bayesian methodology and extreme value techniques finally fuzzy inference system models estimated wave conditions by modeling parameters of fuzzy models from data kazeminezhad et al 2005 mahjoobi et al 2008 although the aforementioned soft computing methods reported noticeable wave height estimation performances but these achievements mainly result from various features that were come up with by expert engineers such as wind conditions wave data and radar images to the best of our knowledge there has been no machine learning models that attempted to estimate the significant wave heights based solely on raw ocean images from the perspective of data source it is very difficult to utilize real time weather information and radar image data which are mainly used in numerical and soft computing methods generally collecting precise wind data is not possible because satellite images are not reliable in coastal areas and the resolution of wind measurements is not sufficient since it is collected from scarce buoys and occasional ship reports malekmohamadi et al 2011 in addition there is economic difficulty in collecting radar images since an expensive equipment such as wamos ii system is required therefore we propose deep neural network based models to estimate wave heights in real time based solely on ocean images without meteorological data in this study we build real time significant wave height estimation models that are trained based on raw ocean images which can be captured in real time and inexpensively using an optical camera first we estimate significant wave height level from single raw ocean image using convolutional neural network cnn based classification model to determine the most suitable cnn architecture for processing ocean images we investigate four well known cnn structures i e vggnet simonyan and zisserman 2014 inception v3 szegedy et al 2016 resnet he et al 2016 and densenet huang et al 2017 which yielded high performances in various image classification problems then we improve the accuracy by applying transfer learning and modifying cnn architecture so that more delicate and diverse features can be learned from raw ocean images in addition we build a convolutional long short term memory convlstm based regression model to accurately estimate wave height from a sequence of ocean images to verify the proposed models we conducted experiments based on two datasets the classification model was tested on the dataset collected from the national data buoy center ndbc and the regression model was evaluated using a proposed dataset consisting of serial ocean images captured from optical cameras on sailing ship the remainder of this paper is organized as follows in section 2 we briefly review base architectures used in the proposed models in section 3 we describe our classification approach including candidate cnn model structures and performance improvement methods in section 4 we describe our regression approach for estimating real valued wave heights instead of discrete wave height levels in section 5 datasets are explained followed by the experimental results and discussions finally in section 6 we conclude our study with some future research directions 2 base architectures for 2d and 3d deep neural networks 2 1 convolutional neural network cnn is a class of deep neural networks and has been most commonly applied to image processing simonyan and zisserman 2014 cnn consists of convolutional layer pooling layer and fully connected layer as shown in fig 1 first the convolutional layer extracts latent features from an image by applying convolution filters to the input the parameters of convolutional layer consist of a set of learnable filters connected only to a local region in the input volume spatially but to the full depth these weights are shared across the input the detailed operation of convolutional layer can be represented as follows 2 x i j l g x l 1 w l i j g m n x i m j n l 1 w m n l where x i j l is i j th value of l th layer and w m n l is m n th weight of convolution filter in the l th layer g is a non linear activation function thus if the dimension of the l 1 th layer is the width w height h and channel c and the dimension of convolution filter in l th layer is the width f height f and channel c then the l th layer is derived by applying nonlinear activation function g to the convolution operation of x l 1 r w h c and w l r f f c sigmoid hyperbolic tangent and rectified linear unit relu are generally used activation functions which enable the model to capture nonlinear relationship between the previous and the following layers in addition convolution operation is described in fig 2 a a 3 3 convolution filter is convolved across the width and height of the 4 4 input with the stride size of 1 computing the sum of element wise dot products between the entries of the filter and the input in doing so a two dimensional activation map is produced which gives the responses of the filter at every spatial position the parameters of convolution filter in each layer which extract the local connectivity between layers are learned by gradient descent optimization method the pooling layer periodically inserted between convolutional layers reduces an amount of parameters and computation in the network and also controls overfitting a pooling operation reduces spatial size of input by selecting representative value in specific area based on a specific rule as shown in fig 2 b max pooling uses max operation to choose the representative values the average operation is applied to the input in average pooling as shown in fig 2 c finally neurons in a fully connected layer have full connections to all activations in the previous layers their activations are computed with a matrix multiplication the fully connected layer which generally comes after a repeated set of convolutional and pooling layers performs decision making based on the latent features extracted from the previous layers various cnn models can be constructed by stacking convolutional layers pooling layers and fully connected layers lecun et al 2010 2 2 convolutional long short term memory convlstm xingjian et al 2015 is a layer to extract features from a sequence of images instead of from a single image the model to process sequential images requires the ability to extract both spatial and temporal information from images as it should adapt to changes over time therefore convlstm involves convolution operations to generate a good spatial representation of each frame and lstm hochreiter and schmidhuber 1997 to encode the temporal changes in sequences lstm is a class of recurrent neural network mikolov et al 2010 that can process sequential data lstm was introduced to solve the vanishing gradient problem encountered in recurrent neural networks when processing long sequences lstm incorporates memory units that contain information about the inputs that the lstm units have seen and is regulated using several fully connected gates because the main purpose of processing image sequences is to discover changes in both spatial and temporal dimensions convlstm encodes spatio temporal information using the convolutional gates in lstm fig 3 shows the convlstm layer where its operation can be expressed as follows 3 i t σ w x i x t w h i h t 1 b i 4 f t σ w x f x t w h f h t 1 b f 5 c t σ w x c x t w h c h t 1 b c 6 o t σ w x o x t w h o h t 1 b o 7 c t c t 1 f t c t i t 8 h t o t t a n c t where x t h t and c t are the t th input hidden state and cell state respectively the various forms of w represent the weights of different gates in convlstm in addition represents the convolutional operation and refers to the hadamard product the gate activations i t and f t contain information about the degrees to which the new and past cell states should be incorporated respectively and o t indicates the degree to which the current cell state is used to compute the current hidden state in addition x t h t c t i t f t and o t are all 3d tensors in the case of convlstm 3 significant wave height level classification 3 1 candidate cnn models cnn models which show good performance in image processing have developed from alexnet krizhevsky et al 2012 in this paper we employ four candidate cnn structures i e vggnet inception v3 resnet and densenet to find a suitable significant wave height classification model vggnet is a simple cnn architecture constructed by deeply stacking small 3 3 convolutional layers vggnet suggests that the depth of neural network is a key success factor for image processing improving model performance by increasing the depth of cnn this network performs only 3 3 convolutions and 2 2 pooling operations from the beginning to the end and therefore it can extract features in wider area of the image with fewer parameters in addition there are two forms of vggnet vgg16 and vgg19 according to the number of learnable layers for example vgg16 is composed of 13 convolutional layers followed by 3 fully connected layers as shown in fig 4 a whereas vgg19 is composed of 16 convolutional layers followed by 3 fully connected layers we used vgg16 in this study inception v3 is an advanced model of googlenet szegedy et al 2015 that makes efficient use of parameters in the network googlenet reduces the number of parameters by introducing an inception module which is constructed by a horizontal arrangement of convolution layers with 1 1 3 3 and 5 5 filters it also uses 1 1 convolutions as dimension reduction modules to reduce computational bottlenecks in doing so it can increase both depth and width of networks without significant performance penalty szegedy et al 2015 furthermore inception v2 changes the inception modules using convolution factorization and introduces reduction modules that efficiently decrease the network volume in details convolution factorization reduces the number of parameters by decomposing n n convolution to multiplication of n 1 vector and 1 n vector the reduction module also makes lower computation by concatenating outputs of convolution and pooling operations finally inception v3 improves performance of inception v2 with label smoothing and fine tuning as can be seen in fig 4 b it is composed of various inception and reduction modules resnet is a residual learning framework for deeper cnn structures it alleviates the vanishing gradient problem and strengthens feature propagation using a skip connection which adds the identity to the output of the layer an architecture of resnet used in this study is illustrated in fig 4 c it consists of residual blocks where skip connection performs identity mapping between convolutional layers finally densenet is a cnn architecture that uses skip connections more densely while resnet adds the short connection from one layer to other layer only once densenet connects each layer to every other layer in each dense block however the role of skip connection between the resnet and densenet is different an identity feature map is added to the output of the output layers in resnet but the feature maps in previous layers are concatenated to the feature maps in the following layers hence the number of channels are not changed in the resnet whereas it is monotonically increasing in the densenet within the building block an densenet example in fig 4 d has three dense blocks where the feature maps are accumulated in a way demonstrated above 3 2 methods for classification performance improvement in addition to searching the cnn architecture for processing raw ocean images we also attempt to improve the classification performance using two additional methods first we apply transfer learning to cnn based classification model transfer learning is proposed to alleviate difficulties in training an entire cnn model from scratch using insufficient examples it can improve model performance by transferring learned knowledge from a large dataset to the model used to train a new dataset specifically a cnn model pretrained on a very large dataset is used either as a fixed feature extractor or initialization for the tasks of interest the former replaces the last fully connected layer of a pretrained model to one whose output nodes fit to a new dataset and treats the rest of the model as a fixed feature extractor the latter not only replaces the classifier on top of the pretrained cnn but also fine tunes other layers by continuing the backpropagation on the new dataset in addition the degree of fine tuning depends on the difference between the dataset of interest and that on which the cnn was pretrained in this study we attempt to apply transfer learning to cnn models with fine tuning fig 5 describes the application of transfer learning in vggnet as an example we pretrain a cnn model on the imagenet dataset which contains 1 2 million images with 1000 categories we then fine tune all layers of this model as a gap exists between the images in the imagenet dataset and ocean images specifically the last fully connected layer of the pretrained model is replaced by one with two output nodes and the parameters of the remaining layers are used to initialize the wave height classification model we also attempt to improve the classification performance by modifying the cnn architecture which is illustrated in fig 6 the main architectural change is that we insert the three global feature extractors between the last convolution layer and the fully connected layer global max pooling gmp global average pooling gap and convolution operation as shown in fig 7 a gmp is an extended operation of max pooling mentioned in the previous section 2 1 gmp selects the maximum value of each channel as the representative value and produces feature vector whose dimension is same as the number of channels gap also makes the feature vector that consists of the average value of each channel finally as can be seen in fig 7 c convolution operation in the modification of cnn uses many convolution filters which have same dimension with input this operation produces the feature vector whose dimension is same as the number of filters in this study we use 512 filters in this convolution operation 4 real valued significant wave height regression 4 1 convlstm based model convlstm xingjian et al 2015 has been commonly applied to video processing related tasks we build the convlstm based regression model by modifying the architecture of the model proposed in sudhakaran and lanz 2017 fig 8 shows the network architecture used to estimate the real valued significant wave heights in this model instead of applying the input frame itself we use the difference between two adjacent frames as the input to process their changes sudhakaran and lanz 2017 the proposed regression model is constructed by stacking convolutional convlstm and fully connected layers specifically spatial features extracted from convolutional layers are fed into the convlstm to generate spatio temporal information in addition bi directional convlstm is employed to incorporate both forward and backward temporal information once all frames are processed the hidden state of each bi directional convlstm cell contains a representation of each input frame pair finally we generate representations of all input images by applying gap to the concatenated vector of forward and backward hidden states and a series of fully connected layers are connected between the gap layer and final output node for regression in the proposed model vggnet pretrained on the imagenet dataset is used for the frame level feature extractor in the convlstm we use 256 filters in all gates with a filter size of 3 3 and stride 1 relu nonlinear activation is applied after each convolutional and fully connected layer 5 experiments 5 1 datasets the proposed models were evaluated on two datasets the cnn based classification model was tested on the publicly available ndbc dataset 1 1 https www ndbc noaa gov and the convlstm based regression model was evaluated on a new dataset of time series ocean images collected by a container ship the ndbc dataset consisted of ocean images captured on 20 buoys at 10 min after every hour and significant wave heights measured at 40 min after every hour between march 6 2018 and may 10 2018 although the ocean images were captured on 20 buoys floating in different ocean areas we could integrate these images into one dataset because the representative video datasets soomro et al 2012 karpathy et al 2014 carreira and zisserman 2017 used in deep learning are commonly composed of videos filmed with different cameras situations and locations moreover we matched the wave heights to the images captured 30 min after the wave measurement time because a 30 min gap existed between the collection times of ocean images and wave information for example the significant wave height value measured at 10 40 am was assigned to the ocean image captured at 11 10 am this label matching method was based on the fact that significant wave heights demonstrated a smooth trend in the time series plot in addition we transformed the continuous dependent variable into categorical one to classify the level of significant wave height binary classes of wave conditions were constructed by selecting only low and high classes among the three classes uniformly divided from continuous variable specifically significant wave heights less than 1 52m were classified as low class and those higher than 3 05m were considered as high class it was reasonable to classify the level of wave height from this data because distribution based label processing was similar to the criterion by which practitioners judged the degree of wave height as fig 9 shows ocean images were collected at various times and under different weather conditions images such as those shown in fig 9 a and b were suitable for training the cnn model however the image in fig 9 c was likely to interfere with cnn model training because strong sunlight hid the shape of the wave in addition as shown in fig 9 d the dark image captured at night could not be used for model training because the shape of the wave was not identified therefore we removed the unsuitable images based on the average brightness of images specifically we eliminated images in which the mean rgb pixel value was less than 30 or greater than 190 as they are inappropriate for training cnn models consequently we used 44 620 pairs of ocean images and wave height classes and divided them into 35 696 training and 8924 test examples furthermore we trimmed the lower halves of the images contained in the ndbc dataset because a large portion of the upper halves depicted not ocean but sky finally the images were resized to 224 224 pixels to be inputted to the pretrained cnn models because the ndbc dataset consists of snapshot images with 1 h intervals we used another dataset consisting of serial images having very short intervals captured from optical cameras with the corresponding wave height information measured by radar equipment both cameras and wave radar were installed in a container ship and the images and wave information were collected while sailing as fig 10 shows the second dataset consisted of significant wave heights and image clips that represent sets of continuous ocean images this dataset contains 97 458 ocean images captured every second and wave heights measured every 10 min between october 9 and november 23 2018 because of the difference in collection times between ocean images and wave data we applied a new label matching method to this dataset we matched the wave heights to images captured for five min before and after measurement time of the wave data furthermore we cropped only the sea region of 224 224 pixels in the same location of the ocean images and then produced the clip containing 16 consecutive images having the same wave height as a result we used 3019 image clips with the corresponding significant wave heights and divided them into 2675 training and 344 test examples 5 2 evaluation metrics in this study we used various metrics to evaluate the proposed classification and regression models first four classification performance measures were used simple accuracy acc true positive rate tpr true negative rate tnr and balanced correction rate bcr which were calculated from the elements of confusion matrix shown in table 1 in this study we considered high class as positive because of its importance in real sailing environment acc represents the proportion of observations correctly classified regardless of their original class labels and is calculated as follows 9 a c c t p t n t p t n f p f n 100 tpr and tnr are computed as shown in eqs 10 and 11 tpr measures the proportion of actual high class images that are correctly identified as high class tnr is the proportion of the actual low class images which are correctly classified as low class finally bcr is the geometric mean of tpr and tnr 10 t p r t p t p f n 100 11 t n r t n t n f p 100 12 b c r t p r t n r 100 in addition four regression performance metrics were used mean squared error mse root mean squared error rmse mean absolute error mae and mean absolute percentage error mape all measures were calculated from the difference between the actual value a i and predicted value p i therefore the higher the measures the higher the performance four metrics for the regression task are computed as follows 13 m s e 1 n i 1 n a i p i 2 14 r m s e 1 n i 1 n a i p i 2 15 m a e 1 n i 1 n a i p i 16 m a p e 100 n i 1 n a i p i a i 5 3 experimental results 5 3 1 significant wave height level classification results as explained in section 3 we employed four cnn architectures to which transfer learning and architecture modification were attempted table 2 presents the average test classification performance of 10 replicates for each basic candidate cnn model resnet yielded the best performance because not only were its acc tnr and bcr the highest but also its training time was the shortest the classification performances of vggnet and densenet were slightly lower than that of resnet however vggnet outperformed densenet in terms of training time therefore vggnet and resnet were selected as the two cnn structure candidates for significant wave height classification furthermore we attempted to apply the data preprocessing method to improve training efficiency when the grayscale data preprocessing method was used the original ocean images were converted into grayscale images which had one input channel this could reduce the training time by decreasing the depth of the convolution filters in the first convolutional layer table 3 details the effects of the data preprocessing method because vggnet and resnet were selected as our basic cnn structures we applied the grayscale method only to these models when the grayscale method was applied the training time of vggnet decreased 149 min 24 s 137 min 19 s however the test acc also decreased 77 09 73 33 similar to those of vggnet both the training time and test performance of resnet also decreased when image grayscale was applied therefore we used original rgb images for training because of the performance degradation by the data preprocessing method table 4 presents the effects of transfer learning and cnn modification on classification performance and they are denoted as tl and cm respectively in table 4 the proposed architecture with different feature extractors inserted between the last convolution layer and the first fully connected layer trained by transfer learning resulted in high classification performance in both vggnet and resnet when transfer learning was applied not only was the test acc of vggnet improved 77 09 83 45 and 78 38 84 05 with cnn modification but also the performance of resnet was improved 77 32 83 26 and 77 90 83 89 with cnn modification furthermore when cnn modification was applied to vggnet with and without transfer learning the test acc increased from 83 45 to 84 05 and from 77 09 to 78 38 respectively similar to that of vggnet the classification performance of resnet was improved by applying cnn modification the effect on the performance improvement was more significant with transfer learning than with cnn architecture modification when transfer learning was applied the test acc increased by 5 67 6 36 with both vggnet and resnet whereas cnn modification only increased the performance by 0 58 1 29 consequently vggnet and resnet based classification models on which transfer learning and cnn modification were implemented yielded an acc of 84 based on these performances we concluded that it is possible to estimate wave heights from only raw ocean images based on deep neural networks the ndbc dataset contains images captured from six cameras on each buoy using this data we evaluated the effects generated from variations in camera positions we generated the six training and test datasets containing the ocean images captured from each camera we trained the resnet with transfer learning and cnn modification on one training dataset and tested all the six test datasets based on the trained model as a result six iterations of training and testing were performed on the six datasets table 5 lists the testing accuracies for each training test dataset combination the classification performance was the highest when the training and test datasets derived from the same camera although the classification performances on the test datasets derived from different cameras were slightly lower than the best performance their variations were not significant in most cases therefore we concluded that the proposed classification model can be robust to variations in camera position 5 3 2 real valued significant wave height regression results encouraged by the accurate performance of the classification models we also attempted to estimate more precise wave heights using 3d deep neural networks as presented in section 4 we proposed a wave height regression model based on bi directional convlstm with the cnn feature extractor the regression performance tested on the proposed convlstm based model is presented in table 6 the regression model yielded 0 0886 m of mae which means that the absolute difference between the actual value and estimated one was only 0 0886 m in addition mape showed that the actual value to estimated error ratio was only 5 8803 therefore the convlstm based significant wave height regression model showed a favorable performance in both absolute and relative error metrics fig 11 shows the actual significant wave heights and estimated values by the proposed model it can be observed that although the actual significant wave heights showed large variations the proposed model could successfully capture the trend and estimate at a low error rate in most cases 6 conclusion the significant wave height is one of the key factors to be considered in ship routing decisions for operational economic efficiency correct estimation of wave conditions can reduce the fuel costs which constitute the largest portion of operational costs during sailing however complex equations must be solved for wave forecasting in wide area of ocean based on existing numerical methods additionally real time estimation based on soft computing approaches requires expensive data such as weather information wave data and radar image data although there has been an attempt to use ocean images as an input to the wave height estimation model their usability is limited because of the extraction of hand crafted features from parts of images therefore we attempted to estimate significant wave heights in real time from only raw ocean images which are local and precise areas captured from sailing ships based on this estimation sailing ships could optimize shipping routes through a real time information network of ships on which is installed wave condition estimation equipment based on the proposed methods in this study we proposed the neural networks to estimate the significant wave height in real time from only raw ocean images first we estimated significant wave height level from the single ocean image the proposed method was constructed through two steps to find the suitable cnn model for ocean image processing we investigated four candidate models i e vggnet inception v3 resnet and densenet next we applied the transfer learning and cnn structure modification to improve the model performance experimental results showed that the vggnet and resnet based models using transfer learning combined with various feature extractors yielded favorable performance on significant wave height classification moreover we proposed the bi directional convlstm based regression model to estimate real valued significant wave heights from a set of sequential ocean images the model estimated wave heights by extracting spatio temporal features from consecutive images using vggnet and convlstm experimental result showed that the proposed model yielded a very low error rate in terms of mae and mape although the experimental performance was noticeable there are some limitations in current study which lead us to future research directions our method which makes real time wave height estimation cannot estimate the other wave conditions i e direction and period although the significant wave height is practically sufficient in optimal routing decision making additional information of wave conditions can be more useful if it is correctly estimated credit authorship contribution statement heejeong choi methodology investigation validation writing original draft visualization minsik park software investigation resources data curation gyubin son software methodology visualization jaeyun jeong resources validation jaesun park resources methodology kyounghyun mo methodology investigation pilsung kang conceptualization writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported in part by the national research foundation of korea nrf grants funded by the korean government msit under grant nrf 2019r1f1a1060338 and grant nrf 2019r1a4a1024732 and in part by the korea institute for advancement of technology kiat grant funded by the korean government motie the competency development program for industry specialist under grant p0008691 
22001,sonobuoy usually consists of buoying underwater lumped submerged masses and hydrophone in order to reduce the vertical effect of waves on hydrophones it is necessary to design a sonobuoy suspension heave reduction system however the current dynamic analysis of the system has various shortcomings in this paper we designed a sonobuoy suspension system composed of bungee cord and damping disk and established its mathematical model considering the added mass and non constant drag coefficient the mathematical result was obtained by matlab besides in order to make the finite element simulation simple and effective we carried out the equivalent transformation of the nonlinear fluid resistance and the equivalent damping coefficient was input to ansys for the simulation calculation based on the similarity criterion a sonobuoy suspension heave reduction system experiment was designed to verify the effectiveness of the sonobuoy suspension system and explore the influence of excitation frequency and suspension mass on the heave reduction effect base on this the experimental results were compared with the mathematical and simulation results and the inertia coefficient was adjusted to reduce the error rate of mathematical and simulation calculation this provides a more accurate mathematical and simulation calculation method for the heave response analysis keywords sonobuoy suspension system heave reduction mathematical calculation simulation experiment 1 introduction the sonobuoy consists of low density buoys underwater submerged masses and sensor collecting underwater acoustic signals din et al 2018 due to functional characteristics of hydrophones displacement vibration will result in additional noise which will affect the acquisition and extraction of acoustic signals besides the buoy will produce a large vertical displacement with the sea wave motion it will transmit to the hydrophone through hanging rope and affect its work in order to maintain the stability of hydrophones many sonobuoy suspension systems are proposed zhang 2012 took the bungee cord as a sonobuoy suspension system and simplified the cord vibration to the longitudinal vibration of the rods through mathematical simulation and experimental verification it is concluded that the vibration state of the cord is mainly related to the young s modulus of the cord and the increase of the cord young s modulus is beneficial to the system at very low frequency dale et al 1973 and everett et al 1970 designed sonobuoy systems respectively their design principles and schemes were different but both of them used bungee cords and damping disks to block vertical waves huang et al 2018 found that waves can cause vertical heave of sonobuoys and flow noise after mathematical and simulation calculations of heave and flow noise they found that choosing bungee cords with appropriate elastic coefficients can effectively suppress the heave thus reduce the flow noise of sonobuoys din et al 2018 designed a double layer damping suspension structure composed of two bungee cords and a damping disk for this structure a mathematical model of two degree of freedom damped forced vibration was established and the finite element analysis ignoring the effect of damping disk was carried out to verify the accuracy of the mathematical model when the damping was 0 zhou 2016b also used two damping disks and bungee cords to form a double vibration absorber structure in the hydrophone suspension system and then the experiment was carried out it draws the conclusion that the heave reducer effect of the double layer structure is better than that of the single layer structure chapman and kezele 2008 established a mathematical model of one degree of freedom damped forced vibration for the suspension system composed of bungee cord and damping plate the added mass and damping disk are considered and the analysis process can be simplified by using equivalent method the experimental results show that the mathematical model is more accurate it can be found that although there are plenty of researches on the design calculation and simulation methods of the sonobuoy suspension system there are still some problems existed when the suspension system heaves underwater the influence of water can t be neglected such as the added mass and the underwater resistance of the damping disk however due to its complexity there are few accurate mathematics models at present the heave reduction principle of damping disk is mainly due to its underwater resistance but this resistance is complex and different from the viscous damping force which makes it difficult to carry out finite element simulation in this paper we use the sonobuoy suspension system consisting of bungee cord and damping disk and it is simplified as a single degree of freedom system considering the added mass and non constant drag coefficient its accurate mathematical model is established and solved by matlab and the mathematical result is obtained besides the complex non linear fluid resistance is equivalent to the linear damping force and the equivalent damping coefficient is obtained thus the simulation result can be obtained by ansys according to the similarity criterion a sonobuoy suspension heave reduction system test is designed and the test results are obtained by comparing the experimental results the effectiveness of the sonobuoy suspension system is verified the influence of excitation frequency and suspension mass on heave reduction is also discussed at the same time the experimental results are compared with the theoretical solution and the simulation solution and the value of the inertia coefficient in the numerical model is modified to ensure the accuracy of the mathematical model 2 research object sonobuoy is used to detect the sound of underwater targets in order to isolate the vertical displacement caused by waves a sonobuoy suspension heave reduction system is designed as shown in fig 1 the sonobuoy suspension system is composed of buoy bungee cord and damping disk the vertical displacement of the wave is transmitted from the floating buoy to the lower member the bungee cord connects the buoy and the damping disk and its elastic deformation has the function of restraining the heave the damping disk will produce fluid resistance when it moves in water thus the effect of heave reduction can be achieved by providing forces opposite to the direction of motion when the area of each damping disk is equal the influence of different shape damping disks on the heave response is almost the same in the frequency and time domain analysis zhou et al 2017 zhou 2016a in this paper the circular damping disk is chosen as the research object this paper mainly studies the displacement response of the sonobuoy suspension system the general flow chart is shown in fig 2 3 mathematical calculation method 3 1 overall vibration analysis 3 1 1 vibration theory the real suspension system is complex so it can t be analyzed from all aspects because the main function of sonobuoy suspension system is to control the vertical motion of hydrophone and isolate the vertical displacement excitation of wave the system can be simplified the whole model can be simplified to a single degree of system as showed in fig 3 the buoy is used to transfer displacement excitation and its mass doesn t affect the response result so the buoy can be neglected the damping disk is simplified to mass and the bungee cord is simplified to spring the force exerted on the system consists of restoring force caused by spring deformation damping force related to speed inertia force and external force for this system the displacement excitation loads s and the corresponding force load f of the upper end of the spring are respectively 1 s q s i n ω t 2 f k q s i n ω t so the differential equation of vibration is yu and zou 2015 3 m x c x k x k q s i n ω t where m is mass kg c is damping coefficient k is stiffness coefficient n m x is displacement response m so x is velocity m s x is acceleration m s 2 q is displacement excitation amplitude m ω is frequency of displacement excitation 1 s t is time s for a single degree of system without initial conditions the displacement response solution can be divided into two parts free vibration x 1 t and pure forced vibration x 2 t 4 x 1 t a e ε t s i n φ c o s ω ε ε s i n φ θ c o s φ ω ε s i n ω ε t 5 x 2 t a s i n ω t φ where ω 0 2 k m 2 ε c m the free vibration will gradually decay due to the damping effect the steady state response is pure forced vibration and the steady state amplitude is a the amplification factor is 6 σ a q 1 1 r 2 2 4 ξ 2 r 2 where r ω ω 0 ξ ε ω 0 from the above results it can be found that we can reduce the amplification factor to achieve the heave reduction however this mathematical model is still insufficient firstly the damping disk s mass should include the added mass the added mass is not a constant because it is related to the amplitude of the disk secondly the underwater resistance of the damping disk is not proportional to the velocity but to the square of the velocity finally the inertia coefficient of the damping disk is uncertain when it moves sinusoidally and the non constant of the drag coefficient is related to the amplitude therefore these defects will be corrected and more accurate mathematical calculation equations will be put forward 3 1 2 added mass of water the disk moves along its normal direction in incompressible fluid as showed in fig 4 the disk will produce added mass of water teng et al 2010 7 δ m c i ρ s l c i ρ d 3 where c i is inertia coefficient dimensionless ρ is fluid density kg m 3 s is disk area m 2 l is thin plate scale m d is disk diameter m according to teng et al 2010 the inertia coefficient of veneer is about 0 5 3 1 3 nonlinear fluid resistance of damping disk the resistance r of an object immersed in an incompressible fluid depends on the object s geometric shape and surface roughness the fluid s density viscosity and velocity wu et al 2009 its expression is 8 r 1 8 c d ρ π d 2 v 2 where c d is the drag coefficient v is the relative velocity of object and fluid m s according to the above formula when the size of the disk is fixed the drag is proportional to the square of the relative velocity of the fluid and the object in the formula the expression of drag coefficient c d is chapman and kezele 2008 9 c d 2 2 a d 1 2 so the fluid resistance of the disk is 10 r 11 40 ρ π d 5 2 a 1 2 v 2 in this system the bungee cord deformation is assumed to be in the linear elastic range therefore the cord damping is negligible compared with the fluid damping the damping force is simplified as the fluid resistance of the damping disk in summary the actual vibration differential equation of the buoy suspension system is as follows 11 m δm x 1 8 c d ρ π d 2 x x k x k q s i n ω t the solution of this equation is the displacement response of the damping disk because of the complexity of the equation we need computer to solve it 3 2 matlab calculation as a tool for simulating the dynamic behavior of systems matlab simulink has been widely used in academic research its graphical user interface helps to understand the computational process of mathematical calculations by block diagrams fan et al 2018 abdulrahman and radman 2019 du et al 2019 through the analysis of the damping disk s motion the differential equation of the sonobuoy suspension system s motion is solved by matlab inertial force is the product of total mass and acceleration damping force is the resistance of the damping disk in water which can be obtained from formula 10 external force is got from formula 2 the differential equation of motion is 12 m a 0 5 ρ s c d v v k x k q s i n ω t where a is the acceleration of the damping disk m s 2 m is the total mass which is the sum of the mass of the damping disk and the added mass kg equation 12 is simplified according to the actual situation 13 a k x sin w t x 1 2 ρ s c d v v m equation 13 needs a laplace transform to get the velocity response and two laplace transforms to get the displacement response the flow chart of simulink solution is showed in fig 5 and the calculation of bungee cord compensation system is showed in fig 6 4 finite element simulation analysis ansys is a large general finite element analysis software it has powerful functions and is easy to operate now it has become the most popular finite element analysis software its mechanical analysis results have been accepted by all walks therefore it is necessary to apply ansys to the dynamic simulation of the sonobuoy suspension system this chapter presents an equivalent method for the non linear fluid resistance so that ansys can carry out fast and effective calculation 4 1 equivalent damping coefficient the ansys software uses rayleigh damping coefficient to represent the damping value yang et al 2012 ma and xu 2014 yue et al 2018 the formula is 14 c α m β k where α and β are damping coefficients m is the mass matrix and k is the stiffness matrix in order to equivalent the nonlinear fluid resistance to the linear damping force the energy loss of the two must be equal in one cycle chen and cao 1987 assuming that the equivalent viscous damping coefficient of the non linear fluid resistance is c eq the work done by the non linear fluid resistance u p and the equivalent damping force u c should be as follows 15 u p 4 0 t 4 1 8 c d ρ π d 2 x 2 x d t 1 3 ρ c d π d 2 a 3 ω 2 16 u c 0 t c eq x x d t c eq π a 2 ω if the non linear fluid resistance is equivalent to the viscous damping force the work they do in one cycle is equal that is u c u p it is concluded that 17 c eq 1 3 ρ c d d 2 a ω 11 15 ρ d 5 2 a 1 2 ω therefore the differential equation of the overall heave of the system is 18 m δ m x c e q x k x k q s i n ω t its solution is the displacement response of a damping disk 4 2 parameter settings for the simulation since what to be analyzed is the vertical displacement heave reduction under the influence of vertical wave loads the horizontal degree of freedom is limited and only the vertical degree of freedom is left the wave load is transformed into a table in ansys and then applied by displacement excitation first establish the model the buoy is simplified as a point which is connected to the bungee cord and displacement excitation is applied on it in practice the bungee cord in the system has a k only in the direction of tension and no force in compression the heave of the damping disk is always moving in the extension range of the bungee cord when the weight is suspended at the bottom so we can use spring element to replace it in the simulation then the study focuses on the stable amplitude of the lower point which is irrelevant to the pre deformation therefore in order to compare the calculation results clearly the pre deformation is ignored since the specific deformation of the bungee cord is not the key points in this calculation it can be simplified to a simple straight line with the element combine14 without detailed modeling for this system the damping disk moves underwater mainly to produce the added mass and provide the damping force for the system therefore the two dimensional disk element shell181 is used to simulate the damping disk and the added mass is attached to the damping disk by mass 21 the material parameters at this point are used to define the damping in order to input to ansys the c eq must be converted to rayleigh damping coefficient there is no k on damping disk so the β can be omitted the mass of the damping disk is m so the formula for rayleigh damping coefficient can be simplified as follows 19 α c e q m the final finite element model and its details are showed in fig 7 in this chapter the equivalent damping coefficient is proposed the damping parameters are calculated according to rayleigh damping which can be input into ansys for finite element simulation calculation thus the simulation solution can be obtained the flow chart is showed in fig 8 5 experiment in order to verify the heave reduction effect of the sonobuoy suspension system under actual sea conditions and to increase the accuracy of the mathematical model by modifying the inertia coefficient of the mathematical calculation and the simulation calculation furthermore the experimental device of the sonobuoy suspension heave reduction system will explore the influence of the mass of the damper disk and the period of excitation on the heave reduction effect 5 1 design of experiment system the experiment system mainly consists of ship model towing tank wave maker tank trailer computer underwater scale underwater camera float ball bungee cord damping disk weight and so on the sonobuoy suspension heave reduction system experiment device is composed of sea surface simulated wave making system as showed in fig 9 and fig 10 is simulated suspension system the ship model towing tank and wave making mechanism are the main parts of the sea surface simulated wave making system the ship model towing tank is used to simulate the ocean while the wave maker can generate the wave with specified parameters in the towing tank the simulated suspension system consists of floating ball bungee cord damping disk and weights the floating ball simulates the buoy compared with the actual situation the damping disk is simplified and only retains its function of damping through fluid resistance in addition tank trailer computer underwater scale and underwater camera are used for measurement and auxiliary test as a loading platform in the test the tank trailer is used to carry the test personnel and the instruments and equipment and to find the optimal test position for experiment by adjusting the distance between the trailer and the wave maker the underwater displacement motion of the damping disk is measured by an underwater scale and an underwater camera and stored by a computer 5 2 contents of the experiment the ship model towing tank is 170 m long 7 m wide and 3 5 m deep when simulating the real sea conditions according to the similarity criterion the floating ball motion function under the real sea conditions should be converted into the equivalent parameters in the ship model towing tank the similarity criterion is showed in the following formula yang et al 2008 20 λ h s h m t s t m 2 where h s is the actual sea state wave height h m is the wave height of the test pond t s is the actual wave period t m is the experimental wave period the floating ball is connected with the damping disk and the bungee cord in the order as shown in fig 11 after installation put it into the ship model towing tank slowly then turn on the wave maker while the floating ball moves with the wave the motion displacement of the damping disk is observed by the underwater camera after the displacement is stabilized the response displacement of the damping disk is recorded with an underwater scale according to the data obtained the time history diagram of the motion response of the damping disk is drawn by comparing the period and peak value of the time history diagram of the damping disk s motion response the simulation calculation method s rationality can be determined 6 examples and discussions in order to explore the accuracy of mathematical calculation and finite element simulation matlab and ansys are used to carry out mathematical calculation and finite element simulation under six experiment conditions by comparing and analyzing the experimental results the effectiveness of the sonobuoy suspension heave reduction system can be verified and the influence of excitation frequency and suspension mass on the heave reduction is discussed besides by comparing the experimental results with the mathematical and simulation results the inertia coefficient in the mathematical model is corrected to increase the accuracy of the mathematical and simulation calculation methods 6 1 example working conditions the moderate situation is selected as the example so the wave parameters are simulated in the towing tank the buoy motion function under moderate situation is wu 2016 21 η 2 745 c o s 1 611 t the average wave height is h s 1 5 49 m and the period is t s 1 3 9 s for the moderate situation the maximum wave height of the ship model towing tank is h m 1 0 5 m according to formula 20 the period of the wave created in the ship model towing tank should be t m 1 1 s because changing the damping disk s area and the stiffness coefficient of the bungee cord requires dismantling and replacing the sonobuoy suspension system and the stiffness coefficient of the bungee cord after replacement is difficult to control in the experiment we choose changing the suspension mass and wave excitation period of the system to get more groups of results these results are convincing to explore the influence of the mass of the damping and the excitation period on the heave reduction therefore two sets of wave generator parameters which are wave height of 0 05 m and period of 0 857s wave height of 0 05 m and period of 1s these can be used to simulate the sea conditions of different excitation periods the circular damping disk material is the 304 stainless steel with the diameter of 0 2 m and mass of 0 67 kg and weights are selected to change the mass of the damping disk the mass of each weight is 0 9 kg the length of the bungee cord is 2 1 m with the stiffness coefficient of 22n m the diameter of the floating ball is 0 14 m six test conditions are showed in table 1 6 2 results discussion firstly according to the experiment working conditions set the corresponding excitation for mathematical and simulation calculation of which q 1 2 λ 0 025 m and ω 2 π t according to teng et al 2010 c i 0 5 and δ m can be calculated by substituting c i into formula 7 and then m m δ m can be obtained c eq can be calculated by formula 17 and α can be obtained by formula 19 the parameters required for mathematical and simulation calculation of various working conditions are shown in table 2 the amplitude comparison of mathematical calculation finite element calculation and experimental response is showed in fig 12 the calculation results of each method and the comparison error values of these results are showed in table 3 from the chart it can be seen that there are some errors between mathematical calculation finite element simulation and experimental response amplitude when inertia coefficient is 0 5 the mathematical and simulation results are larger than the experimental results and the error is generally more than 10 this shows that the mathematical model is inaccurate and needs to be adjusted the adjustable parameters in the differential equation of general vibration are c i and c d according to chapman and kezele 2008 c d can be obtained by formula 9 so the value of c i determines the accuracy of mathematical calculation so we can reduce the error between mathematical simulation and experimental results by adjusting c i amplitude amplification factor can be obtained by simplifying formula 6 22 σ k k m ω 2 2 c eq 2 ω 2 the stiffness coefficient k 22n m the smaller excitation frequency ω min 6 28 hz so m k ω 2 therefore in order to make the mathematical response amplitude closer to the smaller experimental amplitude the mass should be increased when k and ω are fixed the formula 7 shows that only by increasing the value of c i can the mass be increased we take the step size of 0 1 increase the c i calculate the added mass and heave response of each step and get the error by comparing with the experimental results finally we choose the c i with the smallest error as the optimal value the flow chart of obtaining the c i optimum value is shown in fig 13 the optimum c i value is 0 53 and the displacement response under six working conditions comparison chart is showed in fig 14 the calculated parameters and response amplitudes are showed in table 4 firstly by comparing the excitation amplitude with the response amplitude the heave reduction effect is up to 90 so the sonobuoy suspension heave reduction system is effective secondly by comparing the response amplitudes under different excitation frequencies it s obvious that the increase of frequency can enhance the effect of heave reduction for different mass of damping disk combining the experimental results with the theoretical analysis of formula 22 it can be seen that when m k ω 2 the larger the mass the better the effect of heave reduction comparing the simulation results with the experimental results when c i 0 53 the error between mathematical and simulation results and experimental results is smaller and the error of mathematical results is reduced to less than 3 in the finite element calculation the discrete model is approximate and the fluid resistance is equivalent to the damping coefficient so the error is larger but it is still less than 8 therefore both mathematical calculation and finite element simulation can accurately simulate the displacement response of the sonobuoy suspension system and the mathematical calculation is more accurate to simulate the actual situation this calculation method is effective for most simple passive damping sonobuoy suspension systems for the suspension system with elastic elements lutes et al 1968 dale et al 1973 tallman et al 1974 the resistance term in equation 11 can be ignored and the coefficient k can be adjusted according to the actual system condition for the suspension system with damping bennett and inventor 1978 duel et al 1976 its resistance can be calculated by converting the content of section 3 1 into damping coefficient besides when the area of each damping disk is equal the influence of different shape damping disks on the heave response is almost the same in the frequency and time domain analysis so through the change of coefficient s and m the heave response of different shape damping disks can be calculated by this method 7 conclusion the research object of this paper is a commonly used sonobuoy suspension heave reduction system which is composed of bungee cord and damping disk the purpose of this study is to propose an effective and accurate method for calculating the heave displacement response of the system and to explore the influence of different excitation frequencies and different mass of damping disks on the heave reduction effect of the system firstly based on the dynamic vibration differential equation by changing the added mass and the non linear fluid resistance the actual heave differential equation of the sonobuoy suspension system is obtained the simulink module of matlab is used to solve the equation and the mathematical displacement response is obtained then the equivalent damping coefficient is proposed for the complexity of the non linear fluid resistance it can be applied to the finite element analysis software ansys so that the system can be simulated simply and effectively by finite element method and finally the simulation response results can be obtained what s more in order to verify the heave reduction effect of the sonobuoy suspension system under actual sea conditions the sonobuoy suspension system experiment was designed by comparing the experimental results with the mathematical results of wave excitation the heave reduction effect of the system is effective and the maximum heave reduction ratio is up to 90 in this paper there are six working conditions with different frequency and mass to explore the influence of the mass of the damping and the period of the excitation on the heave reduction it can be seen that the increase of frequency can enhance the effect of heave reduction combined with the experimental results and theoretical analysis the heave reduction effect becomes better with the increase of mass under the condition of m k ω 2 the displacement response under six working conditions is calculated by mathematical calculation and finite element simulation by mathematical analysis we confirm that the inertia coefficient is the main influencing parameters its optimal value is 0 53 which reduces the error rate of mathematical calculation to less than 3 and the error rate of finite element simulation to about 8 in contrast mathematical calculation is more rapid and accurate but it needs strong theoretical basis to carry out mathematical modeling so it is suitable for professionals to analyze simpler systems although the accuracy of finite element simulation is lower but only by inputting parameters complex results such as displacement stress and strain can be obtained so it is suitable for more complex systems requiring dynamic analysis this study provides a more accurate mathematical model and a simpler finite element simulation method for the response calculation of sonobuoy suspension system which is of great significance in engineering application this study uses a simpler method to realize the dynamic calculation of the sonobuoy suspension system and the calculation method is modified by experiments to make it more accurate it is of great significance in engineering application in this paper only the vertical heave response of the sonobuoy suspension systems is analyzed in the further research there are many aspects that will be considered including the motion response of the suspension system with multiple degrees of freedom the effect of damping disks with different transmissivity on the response of sonobuoy suspension systems and so on more experiments are needed to make the calculation method of the suspension system more accurate credit authorship contribution statement guan guan conceptualization methodology project administration funding acquisition supervision resources writing review editing jiahong geng formal analysis investigation software data curation writing original draft lei wang formal analysis visualization validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the authors are grateful to the national natural science foundation of china 51609036 and the fundamental research funds for the central universities dut18jc05 for its financial support appendix a supplementary data the following is are the supplementary data to this article oe d 19 02134 dataprofile oe d 19 02134 dataprofile appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 107141 
22001,sonobuoy usually consists of buoying underwater lumped submerged masses and hydrophone in order to reduce the vertical effect of waves on hydrophones it is necessary to design a sonobuoy suspension heave reduction system however the current dynamic analysis of the system has various shortcomings in this paper we designed a sonobuoy suspension system composed of bungee cord and damping disk and established its mathematical model considering the added mass and non constant drag coefficient the mathematical result was obtained by matlab besides in order to make the finite element simulation simple and effective we carried out the equivalent transformation of the nonlinear fluid resistance and the equivalent damping coefficient was input to ansys for the simulation calculation based on the similarity criterion a sonobuoy suspension heave reduction system experiment was designed to verify the effectiveness of the sonobuoy suspension system and explore the influence of excitation frequency and suspension mass on the heave reduction effect base on this the experimental results were compared with the mathematical and simulation results and the inertia coefficient was adjusted to reduce the error rate of mathematical and simulation calculation this provides a more accurate mathematical and simulation calculation method for the heave response analysis keywords sonobuoy suspension system heave reduction mathematical calculation simulation experiment 1 introduction the sonobuoy consists of low density buoys underwater submerged masses and sensor collecting underwater acoustic signals din et al 2018 due to functional characteristics of hydrophones displacement vibration will result in additional noise which will affect the acquisition and extraction of acoustic signals besides the buoy will produce a large vertical displacement with the sea wave motion it will transmit to the hydrophone through hanging rope and affect its work in order to maintain the stability of hydrophones many sonobuoy suspension systems are proposed zhang 2012 took the bungee cord as a sonobuoy suspension system and simplified the cord vibration to the longitudinal vibration of the rods through mathematical simulation and experimental verification it is concluded that the vibration state of the cord is mainly related to the young s modulus of the cord and the increase of the cord young s modulus is beneficial to the system at very low frequency dale et al 1973 and everett et al 1970 designed sonobuoy systems respectively their design principles and schemes were different but both of them used bungee cords and damping disks to block vertical waves huang et al 2018 found that waves can cause vertical heave of sonobuoys and flow noise after mathematical and simulation calculations of heave and flow noise they found that choosing bungee cords with appropriate elastic coefficients can effectively suppress the heave thus reduce the flow noise of sonobuoys din et al 2018 designed a double layer damping suspension structure composed of two bungee cords and a damping disk for this structure a mathematical model of two degree of freedom damped forced vibration was established and the finite element analysis ignoring the effect of damping disk was carried out to verify the accuracy of the mathematical model when the damping was 0 zhou 2016b also used two damping disks and bungee cords to form a double vibration absorber structure in the hydrophone suspension system and then the experiment was carried out it draws the conclusion that the heave reducer effect of the double layer structure is better than that of the single layer structure chapman and kezele 2008 established a mathematical model of one degree of freedom damped forced vibration for the suspension system composed of bungee cord and damping plate the added mass and damping disk are considered and the analysis process can be simplified by using equivalent method the experimental results show that the mathematical model is more accurate it can be found that although there are plenty of researches on the design calculation and simulation methods of the sonobuoy suspension system there are still some problems existed when the suspension system heaves underwater the influence of water can t be neglected such as the added mass and the underwater resistance of the damping disk however due to its complexity there are few accurate mathematics models at present the heave reduction principle of damping disk is mainly due to its underwater resistance but this resistance is complex and different from the viscous damping force which makes it difficult to carry out finite element simulation in this paper we use the sonobuoy suspension system consisting of bungee cord and damping disk and it is simplified as a single degree of freedom system considering the added mass and non constant drag coefficient its accurate mathematical model is established and solved by matlab and the mathematical result is obtained besides the complex non linear fluid resistance is equivalent to the linear damping force and the equivalent damping coefficient is obtained thus the simulation result can be obtained by ansys according to the similarity criterion a sonobuoy suspension heave reduction system test is designed and the test results are obtained by comparing the experimental results the effectiveness of the sonobuoy suspension system is verified the influence of excitation frequency and suspension mass on heave reduction is also discussed at the same time the experimental results are compared with the theoretical solution and the simulation solution and the value of the inertia coefficient in the numerical model is modified to ensure the accuracy of the mathematical model 2 research object sonobuoy is used to detect the sound of underwater targets in order to isolate the vertical displacement caused by waves a sonobuoy suspension heave reduction system is designed as shown in fig 1 the sonobuoy suspension system is composed of buoy bungee cord and damping disk the vertical displacement of the wave is transmitted from the floating buoy to the lower member the bungee cord connects the buoy and the damping disk and its elastic deformation has the function of restraining the heave the damping disk will produce fluid resistance when it moves in water thus the effect of heave reduction can be achieved by providing forces opposite to the direction of motion when the area of each damping disk is equal the influence of different shape damping disks on the heave response is almost the same in the frequency and time domain analysis zhou et al 2017 zhou 2016a in this paper the circular damping disk is chosen as the research object this paper mainly studies the displacement response of the sonobuoy suspension system the general flow chart is shown in fig 2 3 mathematical calculation method 3 1 overall vibration analysis 3 1 1 vibration theory the real suspension system is complex so it can t be analyzed from all aspects because the main function of sonobuoy suspension system is to control the vertical motion of hydrophone and isolate the vertical displacement excitation of wave the system can be simplified the whole model can be simplified to a single degree of system as showed in fig 3 the buoy is used to transfer displacement excitation and its mass doesn t affect the response result so the buoy can be neglected the damping disk is simplified to mass and the bungee cord is simplified to spring the force exerted on the system consists of restoring force caused by spring deformation damping force related to speed inertia force and external force for this system the displacement excitation loads s and the corresponding force load f of the upper end of the spring are respectively 1 s q s i n ω t 2 f k q s i n ω t so the differential equation of vibration is yu and zou 2015 3 m x c x k x k q s i n ω t where m is mass kg c is damping coefficient k is stiffness coefficient n m x is displacement response m so x is velocity m s x is acceleration m s 2 q is displacement excitation amplitude m ω is frequency of displacement excitation 1 s t is time s for a single degree of system without initial conditions the displacement response solution can be divided into two parts free vibration x 1 t and pure forced vibration x 2 t 4 x 1 t a e ε t s i n φ c o s ω ε ε s i n φ θ c o s φ ω ε s i n ω ε t 5 x 2 t a s i n ω t φ where ω 0 2 k m 2 ε c m the free vibration will gradually decay due to the damping effect the steady state response is pure forced vibration and the steady state amplitude is a the amplification factor is 6 σ a q 1 1 r 2 2 4 ξ 2 r 2 where r ω ω 0 ξ ε ω 0 from the above results it can be found that we can reduce the amplification factor to achieve the heave reduction however this mathematical model is still insufficient firstly the damping disk s mass should include the added mass the added mass is not a constant because it is related to the amplitude of the disk secondly the underwater resistance of the damping disk is not proportional to the velocity but to the square of the velocity finally the inertia coefficient of the damping disk is uncertain when it moves sinusoidally and the non constant of the drag coefficient is related to the amplitude therefore these defects will be corrected and more accurate mathematical calculation equations will be put forward 3 1 2 added mass of water the disk moves along its normal direction in incompressible fluid as showed in fig 4 the disk will produce added mass of water teng et al 2010 7 δ m c i ρ s l c i ρ d 3 where c i is inertia coefficient dimensionless ρ is fluid density kg m 3 s is disk area m 2 l is thin plate scale m d is disk diameter m according to teng et al 2010 the inertia coefficient of veneer is about 0 5 3 1 3 nonlinear fluid resistance of damping disk the resistance r of an object immersed in an incompressible fluid depends on the object s geometric shape and surface roughness the fluid s density viscosity and velocity wu et al 2009 its expression is 8 r 1 8 c d ρ π d 2 v 2 where c d is the drag coefficient v is the relative velocity of object and fluid m s according to the above formula when the size of the disk is fixed the drag is proportional to the square of the relative velocity of the fluid and the object in the formula the expression of drag coefficient c d is chapman and kezele 2008 9 c d 2 2 a d 1 2 so the fluid resistance of the disk is 10 r 11 40 ρ π d 5 2 a 1 2 v 2 in this system the bungee cord deformation is assumed to be in the linear elastic range therefore the cord damping is negligible compared with the fluid damping the damping force is simplified as the fluid resistance of the damping disk in summary the actual vibration differential equation of the buoy suspension system is as follows 11 m δm x 1 8 c d ρ π d 2 x x k x k q s i n ω t the solution of this equation is the displacement response of the damping disk because of the complexity of the equation we need computer to solve it 3 2 matlab calculation as a tool for simulating the dynamic behavior of systems matlab simulink has been widely used in academic research its graphical user interface helps to understand the computational process of mathematical calculations by block diagrams fan et al 2018 abdulrahman and radman 2019 du et al 2019 through the analysis of the damping disk s motion the differential equation of the sonobuoy suspension system s motion is solved by matlab inertial force is the product of total mass and acceleration damping force is the resistance of the damping disk in water which can be obtained from formula 10 external force is got from formula 2 the differential equation of motion is 12 m a 0 5 ρ s c d v v k x k q s i n ω t where a is the acceleration of the damping disk m s 2 m is the total mass which is the sum of the mass of the damping disk and the added mass kg equation 12 is simplified according to the actual situation 13 a k x sin w t x 1 2 ρ s c d v v m equation 13 needs a laplace transform to get the velocity response and two laplace transforms to get the displacement response the flow chart of simulink solution is showed in fig 5 and the calculation of bungee cord compensation system is showed in fig 6 4 finite element simulation analysis ansys is a large general finite element analysis software it has powerful functions and is easy to operate now it has become the most popular finite element analysis software its mechanical analysis results have been accepted by all walks therefore it is necessary to apply ansys to the dynamic simulation of the sonobuoy suspension system this chapter presents an equivalent method for the non linear fluid resistance so that ansys can carry out fast and effective calculation 4 1 equivalent damping coefficient the ansys software uses rayleigh damping coefficient to represent the damping value yang et al 2012 ma and xu 2014 yue et al 2018 the formula is 14 c α m β k where α and β are damping coefficients m is the mass matrix and k is the stiffness matrix in order to equivalent the nonlinear fluid resistance to the linear damping force the energy loss of the two must be equal in one cycle chen and cao 1987 assuming that the equivalent viscous damping coefficient of the non linear fluid resistance is c eq the work done by the non linear fluid resistance u p and the equivalent damping force u c should be as follows 15 u p 4 0 t 4 1 8 c d ρ π d 2 x 2 x d t 1 3 ρ c d π d 2 a 3 ω 2 16 u c 0 t c eq x x d t c eq π a 2 ω if the non linear fluid resistance is equivalent to the viscous damping force the work they do in one cycle is equal that is u c u p it is concluded that 17 c eq 1 3 ρ c d d 2 a ω 11 15 ρ d 5 2 a 1 2 ω therefore the differential equation of the overall heave of the system is 18 m δ m x c e q x k x k q s i n ω t its solution is the displacement response of a damping disk 4 2 parameter settings for the simulation since what to be analyzed is the vertical displacement heave reduction under the influence of vertical wave loads the horizontal degree of freedom is limited and only the vertical degree of freedom is left the wave load is transformed into a table in ansys and then applied by displacement excitation first establish the model the buoy is simplified as a point which is connected to the bungee cord and displacement excitation is applied on it in practice the bungee cord in the system has a k only in the direction of tension and no force in compression the heave of the damping disk is always moving in the extension range of the bungee cord when the weight is suspended at the bottom so we can use spring element to replace it in the simulation then the study focuses on the stable amplitude of the lower point which is irrelevant to the pre deformation therefore in order to compare the calculation results clearly the pre deformation is ignored since the specific deformation of the bungee cord is not the key points in this calculation it can be simplified to a simple straight line with the element combine14 without detailed modeling for this system the damping disk moves underwater mainly to produce the added mass and provide the damping force for the system therefore the two dimensional disk element shell181 is used to simulate the damping disk and the added mass is attached to the damping disk by mass 21 the material parameters at this point are used to define the damping in order to input to ansys the c eq must be converted to rayleigh damping coefficient there is no k on damping disk so the β can be omitted the mass of the damping disk is m so the formula for rayleigh damping coefficient can be simplified as follows 19 α c e q m the final finite element model and its details are showed in fig 7 in this chapter the equivalent damping coefficient is proposed the damping parameters are calculated according to rayleigh damping which can be input into ansys for finite element simulation calculation thus the simulation solution can be obtained the flow chart is showed in fig 8 5 experiment in order to verify the heave reduction effect of the sonobuoy suspension system under actual sea conditions and to increase the accuracy of the mathematical model by modifying the inertia coefficient of the mathematical calculation and the simulation calculation furthermore the experimental device of the sonobuoy suspension heave reduction system will explore the influence of the mass of the damper disk and the period of excitation on the heave reduction effect 5 1 design of experiment system the experiment system mainly consists of ship model towing tank wave maker tank trailer computer underwater scale underwater camera float ball bungee cord damping disk weight and so on the sonobuoy suspension heave reduction system experiment device is composed of sea surface simulated wave making system as showed in fig 9 and fig 10 is simulated suspension system the ship model towing tank and wave making mechanism are the main parts of the sea surface simulated wave making system the ship model towing tank is used to simulate the ocean while the wave maker can generate the wave with specified parameters in the towing tank the simulated suspension system consists of floating ball bungee cord damping disk and weights the floating ball simulates the buoy compared with the actual situation the damping disk is simplified and only retains its function of damping through fluid resistance in addition tank trailer computer underwater scale and underwater camera are used for measurement and auxiliary test as a loading platform in the test the tank trailer is used to carry the test personnel and the instruments and equipment and to find the optimal test position for experiment by adjusting the distance between the trailer and the wave maker the underwater displacement motion of the damping disk is measured by an underwater scale and an underwater camera and stored by a computer 5 2 contents of the experiment the ship model towing tank is 170 m long 7 m wide and 3 5 m deep when simulating the real sea conditions according to the similarity criterion the floating ball motion function under the real sea conditions should be converted into the equivalent parameters in the ship model towing tank the similarity criterion is showed in the following formula yang et al 2008 20 λ h s h m t s t m 2 where h s is the actual sea state wave height h m is the wave height of the test pond t s is the actual wave period t m is the experimental wave period the floating ball is connected with the damping disk and the bungee cord in the order as shown in fig 11 after installation put it into the ship model towing tank slowly then turn on the wave maker while the floating ball moves with the wave the motion displacement of the damping disk is observed by the underwater camera after the displacement is stabilized the response displacement of the damping disk is recorded with an underwater scale according to the data obtained the time history diagram of the motion response of the damping disk is drawn by comparing the period and peak value of the time history diagram of the damping disk s motion response the simulation calculation method s rationality can be determined 6 examples and discussions in order to explore the accuracy of mathematical calculation and finite element simulation matlab and ansys are used to carry out mathematical calculation and finite element simulation under six experiment conditions by comparing and analyzing the experimental results the effectiveness of the sonobuoy suspension heave reduction system can be verified and the influence of excitation frequency and suspension mass on the heave reduction is discussed besides by comparing the experimental results with the mathematical and simulation results the inertia coefficient in the mathematical model is corrected to increase the accuracy of the mathematical and simulation calculation methods 6 1 example working conditions the moderate situation is selected as the example so the wave parameters are simulated in the towing tank the buoy motion function under moderate situation is wu 2016 21 η 2 745 c o s 1 611 t the average wave height is h s 1 5 49 m and the period is t s 1 3 9 s for the moderate situation the maximum wave height of the ship model towing tank is h m 1 0 5 m according to formula 20 the period of the wave created in the ship model towing tank should be t m 1 1 s because changing the damping disk s area and the stiffness coefficient of the bungee cord requires dismantling and replacing the sonobuoy suspension system and the stiffness coefficient of the bungee cord after replacement is difficult to control in the experiment we choose changing the suspension mass and wave excitation period of the system to get more groups of results these results are convincing to explore the influence of the mass of the damping and the excitation period on the heave reduction therefore two sets of wave generator parameters which are wave height of 0 05 m and period of 0 857s wave height of 0 05 m and period of 1s these can be used to simulate the sea conditions of different excitation periods the circular damping disk material is the 304 stainless steel with the diameter of 0 2 m and mass of 0 67 kg and weights are selected to change the mass of the damping disk the mass of each weight is 0 9 kg the length of the bungee cord is 2 1 m with the stiffness coefficient of 22n m the diameter of the floating ball is 0 14 m six test conditions are showed in table 1 6 2 results discussion firstly according to the experiment working conditions set the corresponding excitation for mathematical and simulation calculation of which q 1 2 λ 0 025 m and ω 2 π t according to teng et al 2010 c i 0 5 and δ m can be calculated by substituting c i into formula 7 and then m m δ m can be obtained c eq can be calculated by formula 17 and α can be obtained by formula 19 the parameters required for mathematical and simulation calculation of various working conditions are shown in table 2 the amplitude comparison of mathematical calculation finite element calculation and experimental response is showed in fig 12 the calculation results of each method and the comparison error values of these results are showed in table 3 from the chart it can be seen that there are some errors between mathematical calculation finite element simulation and experimental response amplitude when inertia coefficient is 0 5 the mathematical and simulation results are larger than the experimental results and the error is generally more than 10 this shows that the mathematical model is inaccurate and needs to be adjusted the adjustable parameters in the differential equation of general vibration are c i and c d according to chapman and kezele 2008 c d can be obtained by formula 9 so the value of c i determines the accuracy of mathematical calculation so we can reduce the error between mathematical simulation and experimental results by adjusting c i amplitude amplification factor can be obtained by simplifying formula 6 22 σ k k m ω 2 2 c eq 2 ω 2 the stiffness coefficient k 22n m the smaller excitation frequency ω min 6 28 hz so m k ω 2 therefore in order to make the mathematical response amplitude closer to the smaller experimental amplitude the mass should be increased when k and ω are fixed the formula 7 shows that only by increasing the value of c i can the mass be increased we take the step size of 0 1 increase the c i calculate the added mass and heave response of each step and get the error by comparing with the experimental results finally we choose the c i with the smallest error as the optimal value the flow chart of obtaining the c i optimum value is shown in fig 13 the optimum c i value is 0 53 and the displacement response under six working conditions comparison chart is showed in fig 14 the calculated parameters and response amplitudes are showed in table 4 firstly by comparing the excitation amplitude with the response amplitude the heave reduction effect is up to 90 so the sonobuoy suspension heave reduction system is effective secondly by comparing the response amplitudes under different excitation frequencies it s obvious that the increase of frequency can enhance the effect of heave reduction for different mass of damping disk combining the experimental results with the theoretical analysis of formula 22 it can be seen that when m k ω 2 the larger the mass the better the effect of heave reduction comparing the simulation results with the experimental results when c i 0 53 the error between mathematical and simulation results and experimental results is smaller and the error of mathematical results is reduced to less than 3 in the finite element calculation the discrete model is approximate and the fluid resistance is equivalent to the damping coefficient so the error is larger but it is still less than 8 therefore both mathematical calculation and finite element simulation can accurately simulate the displacement response of the sonobuoy suspension system and the mathematical calculation is more accurate to simulate the actual situation this calculation method is effective for most simple passive damping sonobuoy suspension systems for the suspension system with elastic elements lutes et al 1968 dale et al 1973 tallman et al 1974 the resistance term in equation 11 can be ignored and the coefficient k can be adjusted according to the actual system condition for the suspension system with damping bennett and inventor 1978 duel et al 1976 its resistance can be calculated by converting the content of section 3 1 into damping coefficient besides when the area of each damping disk is equal the influence of different shape damping disks on the heave response is almost the same in the frequency and time domain analysis so through the change of coefficient s and m the heave response of different shape damping disks can be calculated by this method 7 conclusion the research object of this paper is a commonly used sonobuoy suspension heave reduction system which is composed of bungee cord and damping disk the purpose of this study is to propose an effective and accurate method for calculating the heave displacement response of the system and to explore the influence of different excitation frequencies and different mass of damping disks on the heave reduction effect of the system firstly based on the dynamic vibration differential equation by changing the added mass and the non linear fluid resistance the actual heave differential equation of the sonobuoy suspension system is obtained the simulink module of matlab is used to solve the equation and the mathematical displacement response is obtained then the equivalent damping coefficient is proposed for the complexity of the non linear fluid resistance it can be applied to the finite element analysis software ansys so that the system can be simulated simply and effectively by finite element method and finally the simulation response results can be obtained what s more in order to verify the heave reduction effect of the sonobuoy suspension system under actual sea conditions the sonobuoy suspension system experiment was designed by comparing the experimental results with the mathematical results of wave excitation the heave reduction effect of the system is effective and the maximum heave reduction ratio is up to 90 in this paper there are six working conditions with different frequency and mass to explore the influence of the mass of the damping and the period of the excitation on the heave reduction it can be seen that the increase of frequency can enhance the effect of heave reduction combined with the experimental results and theoretical analysis the heave reduction effect becomes better with the increase of mass under the condition of m k ω 2 the displacement response under six working conditions is calculated by mathematical calculation and finite element simulation by mathematical analysis we confirm that the inertia coefficient is the main influencing parameters its optimal value is 0 53 which reduces the error rate of mathematical calculation to less than 3 and the error rate of finite element simulation to about 8 in contrast mathematical calculation is more rapid and accurate but it needs strong theoretical basis to carry out mathematical modeling so it is suitable for professionals to analyze simpler systems although the accuracy of finite element simulation is lower but only by inputting parameters complex results such as displacement stress and strain can be obtained so it is suitable for more complex systems requiring dynamic analysis this study provides a more accurate mathematical model and a simpler finite element simulation method for the response calculation of sonobuoy suspension system which is of great significance in engineering application this study uses a simpler method to realize the dynamic calculation of the sonobuoy suspension system and the calculation method is modified by experiments to make it more accurate it is of great significance in engineering application in this paper only the vertical heave response of the sonobuoy suspension systems is analyzed in the further research there are many aspects that will be considered including the motion response of the suspension system with multiple degrees of freedom the effect of damping disks with different transmissivity on the response of sonobuoy suspension systems and so on more experiments are needed to make the calculation method of the suspension system more accurate credit authorship contribution statement guan guan conceptualization methodology project administration funding acquisition supervision resources writing review editing jiahong geng formal analysis investigation software data curation writing original draft lei wang formal analysis visualization validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the authors are grateful to the national natural science foundation of china 51609036 and the fundamental research funds for the central universities dut18jc05 for its financial support appendix a supplementary data the following is are the supplementary data to this article oe d 19 02134 dataprofile oe d 19 02134 dataprofile appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 107141 
22002,the water entry of a slender hull with 5 degrees of freedom 5 dof except surge at a prescribed speed is investigated through a strip theory together with the boundary element method the hull is cut into a series of slices the motion of each slice is equivalent to the water entry of a two dimensional 2d wedge which can be solved through the boundary element method in the time domain with the fully nonlinear boundary conditions imposed on the free surface in each slice or cross plane the pressure on the body can be calculated through an auxiliary function method the total force and moment can then be obtained through an integration scheme along the longitudinal direction of hull results are provided for pressure distribution free surface deformation the forces and moments and the influence of the hull velocities is discussed in depth keywords slamming loads slender hull water entry boundary element method strip theory 1 introduction when a ship sails in a hostile sea it is common to see that its bow or stern emerges from water and then re enters into water at a high speed large pressure will be generated and slamming will occur in this process the bottom slamming can also happen in the in other fields abrate 2011 such as the launching of lifeboats and the landing of seaplanes severe hazard can be posed by violent attack from the seawater and great damage can be caused to sailing ships in general the ship enters water with multi degrees of freedom and thus the slamming force is not symmetrical about the middle plane of ship that will lead to a large overturning moment which may greatly affect the motion of the ship the whole process is highly complex and to simulate this process is a major challenge there has been much work on water entry through cfd methods and both eulerian and lagrangian approaches have been used in lagrangian approach the fluid is described by a discrete set of the particles in their lagrangian motion maruzewski et al 2010 simulated a 3d ship hull entering water based on a 3d parallelized smoothed particle hydrodynamics sph method eulerian methods are mainly depending on an interface capturing method in which the position of the free surface is traced yang and qiu 2012 solved the 3d water entry problem a constrained interpolation profile cip based finite difference method on a fixed cartesian grid by using another free surface capturing method the volume of fluid vof method wang and soares 2014 simulated 3d bodies through explicit finite element method facci et al 2016 studies a solid body impacting on the water surface based on the method of finite volume and vof phenomena with strongly nonlinear effect during water entry such as spray flow detachment and cavity can be found it is still challenging and time consuming to simulate water entry of a 3d body with strongly nonlinear effect although cfd methods have recently achieved great progress in computational speed and accuracy as slamming usually lasts for a very short period of time the viscosity effect may not be important as it takes time to develop therefore fully nonlinear 3d potential flow theory is also often adopted for water entry of a 3d body most of existing works were concentrated on vertical entry of an axisymmetric body zhao and faltinsen 1998 simulated an arbitrary axisymmetric body entering water at a varying speed and considered flow detachment from the knuckle yan and liu 2011 investigated vertical entry of a cone and a sphere at a constant speed with the gravity effect xu et al 2011 considered a cone entering water in free fall motion in fact the problem of vertical entry of an axisymmetric body can be solved in a two dimensional domain under a cylindrical coordinate system sun and wu 2013 investigated oblique water entry of a cone into calm water and effect of three dimension is considered wu and sun 2014 studied similarity solution of an expanding paraboloid obliquely entering water without the gravity effect however flow detachment was not included in their works for most practical ships its hull form is slender newman 1970 reviewed analytical progress in the application of slender body at that time based on slender body theory the method of 2d t theory can be applied in studying hydrodynamics of the slender ship with a forward speed in which the 3d problem can be approximated by time dependent 2d problems in cross planes maruo 1989 considered a slender ship moving through waves in which the longitudinal perturbation velocity was included in the linearized body boundary condition more work on applications of 2d t theory was reviewed in fontaine and tulin 1998 a thin flow will be formed along the body surface when a body impacts water as the movement of the jet flow is prone to the numerical error sun and faltinse 2007 cut most of jet flow according to their numerical results that the cut technique seems not to change the force on the body significantly in fact almost half of the energy is transferred to the jet flow when a blunt body enters water cointe and armand 1987 cointe et al 2004 consequently some analytical or numerical methods have been adopted to keep the jet flow during water entry of wedges with infinite width xu et al 2010 sun et al 2015 cheng et al 2018 or finite width iafrati and battistin 2003 bao et al 2019 the physical feature of splash is commonly observed at the bow of a ship based on a boundary integral method chan 1987 numerical studied a case of slender ship moving at a high speed and a spray formation was shown clearly in the results the splash can also be treated by the 2d t theory battistin and iafrati 2003 and sun and faltinsen 2007 2011 extended their own works of 2d water entry of finite width wedges to study prismatic hull planing with a constant forward speed and the splash was simulated certainly 2d cfd method can also be used together with 2d t theory such as marrone et al 2011 wang and soares 2016 and zheng et al 2019 however the motion of the ships in the above papers was symmetrical about the longitudinal section in center plane the present work is based on the principle of dividing the hull into a series of 2d sections as common in the strip theory slamming phenomenon is investigated for a ship with a zero forward speed five degrees of freedom are considered not only including the heave and pitch which is often considered but also the sway roll and yaw which is less considered in the past work correspondingly for a 2d section of the above model 3 degrees of freedom need to be considered in the process of ships sailing flow often detaches from the hull which will be investigated in depth in present paper and a pioneering work has been finished in bao et al 2016 for a 2d finite wedge the impact force and bending moment on the hull are calculated the pressure distribution and free surface deformation are provided and their physical meaning is discussed 2 mathematical model and numerical procedure 2 1 governing equation and boundary conditions the sketch of a slender hull entering calm water is shown in fig 1 two coordinate systems are established an earth fixed cartesian coordinate system o xyz is defined in which the origin is on the undisturbed water surface x axis is from the stern to bow when the ship is at its mean position z axis is vertically upward and y axis is from the starboard to the port we consider the case in which the forepart of the hull has emerged from the water the origin point o or the o yz plan x 0 is at the intersection point between the keel of the hull which has an initial inclined angle and the calm free surface when t 0 a moving coordinate system o xyz is fixed at the rotational center o r the x axis is along the longitudinal direction and pointing to the bow the y axis is towards the port and the z axis is normal to o xy plane the hull has in motion with 5 dof with displacement η i i 2 6 in sway heave roll pitch and yaw except surge η 1 the fluid is assumed to be incompressible and inviscid and the flow to be irrotational a velocity potential φ which satisfies laplace equation can then be introduced 1 2 φ x 2 2 φ y 2 2 φ z 2 0 in the fluid domain on the body surface s b the impermeable condition takes the form as 2 φ n u n where u is the velocity of the point on the hull surface and n is the normal vector of the body surface and positive for pointing out of the fluid domain the lagrangian form of the kinematic and dynamic conditions on the free surface in the frame o xyz can be written as 3 d x d t φ x d y d t φ y d z d t φ z 4 d φ d t 1 2 φ x 2 φ y 2 φ z 2 g z the atmospheric pressure on the water surface has been assumed as a constant in addition a far field condition is specified 5 φ n 0 x 2 y 2 z 2 as the hull in this paper is assumed as a slender body the above 3d problem can be simplified into a sequence of 2d water entry problem in cross sections as in the strip theory for ship motion in waves a slenderness ratio ε b l is introduced we then have x o ε y o 1 and z o 1 the term of o ε 2 order in the governing equation and boundary conditions for 3d problem can be neglected as the surge motion of the hull is neglected and the pitch and yaw motion are small it is assumed that y y and z z thus the 2d boundary value problem in a cross plane can be written as follows the potential ϕ of the flow in the cross plane satisfies the laplace equation 6 2 ϕ y 2 2 ϕ z 2 0 the body surface boundary condition can be written as 7 ϕ n η 2 x η 6 y η 4 n y η 3 x η 5 z η 4 n z where x y z is the position vector measured from the rotational center o r n y n z is 2d normal vector on the body surface in the cross plane as shown in fig 2 b and η i i 2 6 with a overdot indicates the first time derivative of position namely velocity in each direction the motion of the cross section at x is equivalent to that with a rotational speed of ω η 4 a vertical heave speed of v 8 v η 3 x η 5 and a horizontal sway speed of u 9 u η 2 x η 6 the lagrangian form of the kinematic and dynamic conditions on the free surface s f can be written as 10 d y d t ϕ y d z d t ϕ z 11 d ϕ d t 1 2 ϕ y 2 ϕ z 2 g z the far field boundary condition takes the form as 12 ϕ n 0 y 2 z 2 2 2 boundary integral equation and numerical schemes based on green s second theorem the governing equation for a cross plane can be transformed into the following boundary integral equation 13 a p ϕ p s ln r p q ϕ q n q ϕ q n q ln r p q d s q where a p is the solid angle of point p on the fluid boundary and r pq is the distance between points p and q s in eq 13 includes all the boundary surfaces in fig 2b which is discretized into linear elements on each element the values of ϕ and ϕ n are defined at the both nodes and their values within the element can be obtained by using the shape functions 14 f n 1 ξ f 1 n 2 ξ f 2 where f stands for either ϕ or ϕ n and 15 n 1 ξ 1 ξ n 2 ξ ξ the local coordinate ξ in the above equations varies from 0 at one node to 1 at the other eq 13 can then be written as 16 a p ϕ p k 1 n e i 1 2 ϕ k i q 0 1 n q ln r p q n i ξ l k d ξ k 1 n e i 1 2 ϕ k i q n q 0 1 ln r p q n i ξ l k d ξ once the solution of eq 16 at each time step has been obtained the free surface profile can be updated through the kinematic boundary conditions given by eq 10 and the velocity potential on the free surface through the dynamic boundary condition in eq 11 a long and thin jet due to the water entry of a wedge would pose some difficulties in the numerical simulation to solve this problem the jet attached on the surface of the wedge is treated through the shallow water equation by wu 2007 and the free jet flow detached from the knuckle is treated through the momentum equation by bao et al 2016 it is assumed that the flow leaves the knuckle tangentially bao et al 2017 thus at the knuckle φ n is therefore continuous and is known from the body surface boundary condition while φ is unknown and can be obtained through eq 16 a five point least square technique is applied to smooth the free surface profile and the velocity potential on the free surface and a cubic spline technique is used to regrid elements on the free surface 2 3 calculation procedure and impact force an earth fixed coordinate system o xyz and a moving coordinate system o xyz shown in fig 1 are established to describe the 3d water entry problem the hull with an initial pitch angle enters water at a constant translational and rotational speed with its forepart out of the calm water the hull from the origin o to the front end of the bow is cut into n vertical cross planes which is shown in fig 3 to improve the numerical accuracy more planes are taken at the bow of the hull as time increases these cross sections will be immerged into water from the origin o to bow in sequence at a certain time t whether ith cross plane has penetrated into water or not will be determined by the vertical coordinate z i t of the keel at ith cross plane in o xyz to be more specific z i t 0 means the ith cross section has touched water and its wetted part would contribute to the resultant force of ship however this wetted part at the initial moment is extremely small which may arise numerical difficulties and this can be treated in a stretched coordinate system wu 2007 with a similarity solution as initial solution xu et al 2008 the coordinate x i t of the keel at ith cross plane in the frame o xyz can be obtained through the relationship between the coordinates of the keel at ith cross planes in two coordinate systems o xyz and o xyz is 17 x i t r z t r y t r x t x i x r t where r z t r y t and r x t are the coordinate transform matrixes at time t 18 r x t 1 0 0 0 cos η 4 t sin η 4 t 0 sin η 4 t cos η 4 t 19 r y t cos η 5 t 0 sin η 5 t 0 1 0 sin η 5 t 0 cos η 5 t 20 r z t cos η 6 t sin η 6 t 0 sin η 6 t cos η 6 t 0 0 0 1 x i x i 0 z i is the coordinate of the keel at the ith cross plane in o xyz which can be obtained from the hull shape x r t are the coordinates of the rotational center o r in o xyz 21 x r t x r t y r t z r t at t 0 the keel at 1st cross plane first touches the water which corresponds to the plane at which the origin point o is located the coordinates of the keel for the 1st cross plane x 1 0 0 0 0 and x r 0 can then be obtained from eq 17 22 x r 0 r z 0 r y 0 r x 0 x 1 thus x r t can be updated based on the relationship 23 x r t x r 0 0 t η τ d τ the coordinate x i t of the keel at ith cross plane can be obtained by eq 17 when the potential at a cross plane has been found through the method in sect 2 2 the bernoulli equation can be used to obtain the pressure at a cross plane 24 p ϕ t 1 2 ϕ ϕ g z it is difficult to deal with the term of ϕ t which is still not explicitly known even when ϕ is found here we adopt the approach proposed by wu and eatock taylor 2003 and a detailed description of this approach is given in bao et al 2016 the sectional force f y x i t f z x i t and moment m x x i t can be obtained by integrating the pressure along the body surface 25 f y x i t s 0 p n y d s 26 f z x i t s 0 p n z d s 27 m x x i t s 0 p y n z z n y d s it should be noted that n y n y and n z n z as the pitch angle η 5 and the yaw angle η 6 are small at time t the number of cross planes which have been immersed into water is n the water entry of the cross section in each cross plane will be simulated by the same process as above and its sectional forces and moment will be obtained from eq 25 27 thus the sway force f y the heave force f z the roll moment m x the pitch moment m y and the yaw moment m z at different time t can be obtained through the integration of sectional force along the x direction as sketched in fig 4 where f 2d represents sectional force or moment in one direction 28 f y t f y d x i 0 n f y x i t d x i 29 f z t f z d x i 0 n f z x i t d x i 30 m x t m x d x i 0 n m x x i t d x i 31 m y t x f z d x i 0 n x i f z x i t d x i 32 m z t x f y d x i 0 n x i f y x i t d x i 3 numerical results and discussions 3 1 geometry of a fridsma hull a series of model tests was carried out by fridsma 1969 to study planing hull in waves as a typical slender body fridsma hull models have been widely used for numerical simulations to study hydrodynamic performances of a planing hull sailing on the free surface sun and faltinsen 2007 2011 in the present paper one of fridsma hull models is chosen to be used in the following simulations the hull model has a planform with a length of l a breadth of b and a draught of h as shown in table 1 the parameters with are dimensional here the water density ρ 1000 kg m3 the gravity acceleration g 9 81 m s2 and the breadth b of the hull are used for the nondimensionalisation the geometry of the hull model is depicted in fig 5 and all the parameters have been nondimensionalized l f is the length of the initial wetted part in calm water with a given value 0 55l if not specified the distance between the rotational center o r and the stern along the keel line is l r and that between o r and the keel along the direction perpendicular to the keel is h r the pictures of the hull in top and side view are shown in fig 5a and c respectively the whole hull can be divided into two parts the straight part and the bow part and the dividing point between them is denoted as o b the straight part corresponds to the part on the left hand side of o b along which the keel is straight and has a length l s while that beyond o b is named as the bow part the shapes of the waterplan and the keel in the bow part are elliptical as shown in fig 5a and c respectively in the o xyz frame the horizontal coordinate of o b is x 2 5 each cross section is equivalent to a wedge with the same deadrise angle γ as shown in fig 5d but the size of the section in the bow part decreases as x increases the deadrise angle is large enough to ignore air cushioning effect during water entry 3 2 convergence and validation study the fridsma hull entering water with a heave velocity of η 3 3 and a pitch velocity of η 5 0 4 is considered the bow part of the hull is out of water at t 0 with an initial pitch angle of η 5 4 the number of cross planes between x 0 and the stern is n fig 6 a shows the total vertical force f z varying with time at different numbers of cross planes n it is expected that more cross planes will improve the calculation accuracy but in fact it does not significantly improve calculation accuracy when the number of cross planes reaches a certain number it can be seen in fig 6 that the results will not change significantly for n 12 thus we can conclude that the choice of n 12 is accurate enough for the total force in the following simulation the total number of cross planes n is taken as 14 to validate the numerical procedure we now consider a prismatic hull vertically entering calm water with a vertical velocity of η 3 3 and a pitch angle of η 5 4 as shown in fig 7 the difference between geometrical shapes of the prismatic hull in fig 7 and the fridsma hull in fig 5 is at the bow part as the shape and velocity for each section of a prismatic hull is the same all sections will experience the same 2d water entry η 5 in the present case is a negative number which implies that the section with a larger x will entre water later and the delay time dτ between two cross planes with an interval of dx is 33 d τ η 5 d x η 3 thus if the whole forepart has been immerged into water the time difference between its back end and front end is 34 δ t η 5 η 3 l l f fig 8 shows the vertical force f z of a 2d wedge with the same size as the section of the prismatic hull entering water at a vertical speed of η 3 3 through the numerical method by bao et al 2016 at every instant the total vertical force f z on the prismatic hull can be obtained through the integration of f z with respect to time 35 f z t x 0 x n f z x d x η 3 η 5 t s t f z τ d τ t s 0 t δ t t s t δ t t δ t fig 9 presents the comparison of results obtained by the methods through eq 35 and eq 29 the two sets of results are in good coincidence this implies that the results of the present numerical simulation are reliable 3 3 the longitudinal motion 3 3 1 hydrodynamic performance analysis to investigate the case of fig 6 in depth more details are provided the free surface profiles and pressure distribution at different time are displayed in fig 10 a and fig 10b during water entry of the cross section at x 2 2625 a thin jet flow will be generated along the body surface during water entry the movement of the jet root greatly affect the pressure distribution thereby the force on the body surface due to the sharp change of the flow direction a large pressure gradient can be observed near the jet root sun et al 2015 which disappears rapidly after the detachment of the jet root from the knuckle bao et al 2016 the cross sections at other x will experience a similar process the sectional force histories f z is shown in fig 11 as well as the free surface profiles in fig 12 and the pressure distributions fig 13 here it is important to note that only the results for the cross sections in fig 3 can be directly obtained through numerical simulation and that on other areas is obtained by interpolation before t 0 06 the rapid increase of f z can be attributed to two reasons the first one is the increase of pressure in fig 11 it can be seen that the sectional force increases noticeably for most of sections between t 0 04 and 0 06 this is due to the fact that before t 0 06 the spray roots for most of cross planes will move to the knuckle successively and during this period the detachment of flow does not occur yet the pressures in figs 13a and b say that the pressure gradient is large and the free surfaces in figs 12a and b show that the flow does not detach from the knuckle and this both implies that the pressure is large during this stage not only that fig 13a and b also show that the wetted surface of the hull increases rapidly before t 0 06 and this is another more important reason for the rapid increase of total vertical force in fig 6 at the initial stage between t 0 06 and t 0 12 the sections in the bow part which correspond to x 2 5 in fig 11 start to enter into water following the discussion above the water entry of bow part will increase the total pressure however the truth is that during this stage f z in fig 6 decreases quickly this can be explained through the decrease of pressure in straight part for which the spray root has detached from the knuckle and the pressure will decrease based on the discussion of bao et al 2016 the free surfaces in fig 12c d e say that the bow is entering water and the splash jet has formed after knuckle detachment in straight part in fig 13c d e it can be seen that the largest pressure has move to the bow part after t 0 14 the sectional spray roots in bow part have detached from the knuckle and the large pressure gradient area has disappeared in fig 13f f z decreases slowly as the influence of the hydrostatic pressure is most important 3 3 2 the effect of the hull bow to study the effect of the bow shape the comparison between prismatic hull and fridsma hull is made the breadth and height of prismatic hull is kept the same as that of the straight part of the fridsma hull the heave velocity pitch velocity and pitch angle are also the same fig 14 shows the time histories of total vertical force f z for two hulls before t 0 04 the sections in the bow part for a fridsma hull has not touched the calm surface in other words hull sections for two ships below water by now are absolutely the same and therefore the two forces in fig 14 are the same as time increases the difference between the two forces begins to appear and grows wider due to the difference of bow shapes in strip theory the three dimensional is neglected the numerical result of the force and moment on the hull will be larger than that occurs in practice the 3d effect for the fridsma hull is stronger than that for prismatic hull thus the difference between the forces on the two hulls in reality can be more obvious than the results in fig 14 for the fridsma hull the profile of the keel in the bow part is elliptical which means the height of the keel will rise as x increases and the section in the bow part will therefore enter water later in contrast the prismatic hull with a straight bow will enter water earlier for example the cross plane of x 1 98 at t 0 10 the spray root of the fridsma is still attached on the body surface while that of the prismatic hull has detached from the knuckle as shown in fig 15 a this leads to a significant difference between pressure distributions shown in fig 15b fig 16 shows the free surface profiles and the pressure distribution on the body surface of the prismatic hull and the fridsma hull at t 0 10 respectively the difference between the two sets of results is reflected in the bow part the peak pressure for the fridsma hull is larger while the wetted surface for the prismatic hull is larger but the latter is more important thus f z in fig 14 is larger for the prismatic hull 3 4 the transverse motion 3 4 1 the effect of the sway velocity in xu et al 2010 sun et al 2015 bao et al 2016 the horizontal velocity is considered during water entry of a 2d wedge the motion relative to the flow in horizontal leads to the imbalance of the pressure on the both sides of the wedge morabito 2015 analyzed a planing hull with a fixed yaw angle based on the 2d oblique water entry together with 2d t theory we now consider water entry of the hull with a heave velocity of η 3 3 a pitch velocity of η 5 0 4 and different sway velocities η 2 fig 17 shows the force and moment components in 5 modes overall the influence of η 2 on the heave force f z in fig 17b and the pitch moment m y in fig 17d is not obvious when η 2 is positive the flow at the starboard will be pushed away and the free surface at the same side will also be higher that will lead to a negative sway force f y as shown in fig 17a and a negative yaw moment m z in fig 17e and their magnitude will be enhanced by a larger η 2 initially in the section which has been immerged into water only a small part near the tip of the wedge is below water and its position is lower than the corresponding rotational center thus a negative f y will lead to a negative m x after reaching a small extreme value m x decreases in value and then change its sign as the negative f y and the wetted surface increase after reaching their peak at about t 0 06 the value f y m x and m z reduce quickly as shown in fig 17 the free surface profiles and the pressure distribution at t 0 04 and t 0 06 are provided in fig 18 and fig 19 respectively owing to the existence of the sway velocity the wetted surface and pressure distribution are not symmetrical when t 0 04 the spray root is still below the knuckle in fig 18a and a large pressure gradient can be clearly observed in fig 19a as η 2 is positive the pressure on the right hand side is much higher than that on the left hand side when t 0 08 the spray root in the straight part has detached from the knuckle in fig 18b and the large pressure gradient in the straight part has disappeared in fig 19b however in this area the pressure on the right hand side is still higher than that on the left hand side though a large pressure gradient area appears in bow part the sharp reduction of the pressure in the straight part leads to that the value of f y rapidly decreases as well as m x and m z 3 4 2 the effect of the roll velocity as discussed in xu et al 2010 when a wedge rolls in one direction during water entry the restoring moment will increase rapidly and then change the roll direction however when the wedge has finite width bao et al 2017 the restoring moment can decease significantly and the wedge may capsize we now consider water entry of the hull with a heave velocity of η 3 3 a pitch velocity of η 5 0 4 and different roll velocities η 4 fig 20 shows the force and moment components in 5 modes the influence of roll velocity η 4 on the f z and m y is not evident since the roll velocity η 4 is negative the right deadrise angle of a cross section decreases and the left deadrise angle increases a smaller deadrise angle leads to a larger pressure on the corresponding body surface a negative sway force f y is formed by imbalance pressure on the two sides of the wedge body in fig 20a at the early stage as the part which has been immerged into water is lower than the rotational center the negative f y leads to a clockwise moment m x as shown in fig 20c m x will rapidly change its sign and increases when the flow is above the rotational center the free surface profile and pressure distribution at t 0 04 and t 0 08 are provided in fig 21 and fig 22 respectively from these figures we can find that the spray root in the straight part will gradually detach from the knuckle at between t 0 04 and t 0 08 the right deadrise angle is smaller and thus the spray root on the right hand side will detach from the knuckle earlier and then the positive sectional force f y and negative sectional moment m x will be developed because the pressure on the right hand side reduces as time increases in more cross planes f y becomes positive and m x becomes negative and thus f y in fig 20a changes its sign and increases rapidly as well as m x in fig 20c when the spray root on the left hand side detached from the knuckle the pressure on the left hand side will decrease as well as positive f y in fig 20a and negative m x in fig 20c about between t 0 08 and t 0 10 the spray root in the bow part will gradually detach from the knuckle as the size of the section in the bow part is small the change of its sectional force before and after spray root detachment has a limited influence on the f z and m y however the amplitudes of f y m x and m z are not very large and thus the curves in fig 20a c and e take the form of sawtooth at between t 0 08 and t 0 10 3 4 3 the effect of the yaw velocity we finally consider water entry of the hull with a heave velocity of η 3 3 a pitch velocity of η 5 0 4 and different yaw velocities η 6 fig 23 shows the force and moment components in 5 modes from eq 9 a positive η 6 is equivalent to that the cross section in the forepart has a positive sway velocity η 2 thus the influence of η 6 on the forces and moments in fig 23 is very similar to the case in fig 17 from eq 9 for a section at larger x its horizontal velocity u will be larger as well if we compare the case of η 6 0 6 in fig 23 with the case of η 2 1 2 in fig 17 it can be noticed that for the section at x 2 its u in the case of η 6 0 6 will be larger and conversely the case of η 2 1 2 larger this can be confirmed by fig 24 a and fig 24b which respectively show the comparison of pressure distribution on the section at x 1 5875 and x 2 4875 between the case of η 2 0 0 η 6 0 6 and η 2 1 2 η 6 0 0 the discontinuity of pressure in fig 24 is because the tangential velocity is not continuous at the tip of wedge which is can be treated with kutta condition xu and wu 2015 since its effect is very local and will not exert noticeably effect on the resultant force thus it is not considered in current work 4 conclusions the water entry of a slender hull with 5 degrees of freedom 5 dof at a prescribed speed is investigated through a strip theory in which the hull is cut into a series of cross planes the motion of each plane is equivalent to the water entry of a two dimensional wedge which can be solved through the boundary element method in the time domain with the fully nonlinear boundary conditions imposed on the free surface the pressure on the body is calculated through the auxiliary function method the total force and moment of the hull are obtained by integrating the sectional force and moment along the longitudinal direction through the obtained results the following conclusions can be draw 1 when a fridsma hull enters water with heave and pitch velocities as the wetted surface and impact pressure both increases when t is small the heave force and the pitch moment increase significantly during this period after that they will both decrease when the detachment of spay root from the knuckle occurs 2 the hull with an elliptical bow enters water more slowly that with straight bow this may lead to a larger local peak pressure but can firmly lead to a smaller wetted surface the latter is apparently more important and thus the overall force for the hull with an elliptical bow is therefore smaller 3 when a hull has a velocity in the sway roll or yaw direction the loads on the hull are in 5 modes and the force or moment on one mode will be affected by the others if the hull is free its motion will be extremely complex credit authorship contribution statement chaoming bao writing original draft writing review editing shiyan sun writing original draft writing review editing gang xu writing original draft writing review editing linfeng chen writing original draft writing review editing acknowledgements this work is supported by lloyd s register foundation through the joint center involving university college london shanghai jiaotong university and harbin engineering university to which the authors are most grateful lloyd s register foundation helps to protect life and property by supporting engineering related education public engagement and the application of research this work is also supported by the natural science foundation of jiangsu province china grants number sbk2018040999 national natural science foundation of china grants number 51879123 51809123 
22002,the water entry of a slender hull with 5 degrees of freedom 5 dof except surge at a prescribed speed is investigated through a strip theory together with the boundary element method the hull is cut into a series of slices the motion of each slice is equivalent to the water entry of a two dimensional 2d wedge which can be solved through the boundary element method in the time domain with the fully nonlinear boundary conditions imposed on the free surface in each slice or cross plane the pressure on the body can be calculated through an auxiliary function method the total force and moment can then be obtained through an integration scheme along the longitudinal direction of hull results are provided for pressure distribution free surface deformation the forces and moments and the influence of the hull velocities is discussed in depth keywords slamming loads slender hull water entry boundary element method strip theory 1 introduction when a ship sails in a hostile sea it is common to see that its bow or stern emerges from water and then re enters into water at a high speed large pressure will be generated and slamming will occur in this process the bottom slamming can also happen in the in other fields abrate 2011 such as the launching of lifeboats and the landing of seaplanes severe hazard can be posed by violent attack from the seawater and great damage can be caused to sailing ships in general the ship enters water with multi degrees of freedom and thus the slamming force is not symmetrical about the middle plane of ship that will lead to a large overturning moment which may greatly affect the motion of the ship the whole process is highly complex and to simulate this process is a major challenge there has been much work on water entry through cfd methods and both eulerian and lagrangian approaches have been used in lagrangian approach the fluid is described by a discrete set of the particles in their lagrangian motion maruzewski et al 2010 simulated a 3d ship hull entering water based on a 3d parallelized smoothed particle hydrodynamics sph method eulerian methods are mainly depending on an interface capturing method in which the position of the free surface is traced yang and qiu 2012 solved the 3d water entry problem a constrained interpolation profile cip based finite difference method on a fixed cartesian grid by using another free surface capturing method the volume of fluid vof method wang and soares 2014 simulated 3d bodies through explicit finite element method facci et al 2016 studies a solid body impacting on the water surface based on the method of finite volume and vof phenomena with strongly nonlinear effect during water entry such as spray flow detachment and cavity can be found it is still challenging and time consuming to simulate water entry of a 3d body with strongly nonlinear effect although cfd methods have recently achieved great progress in computational speed and accuracy as slamming usually lasts for a very short period of time the viscosity effect may not be important as it takes time to develop therefore fully nonlinear 3d potential flow theory is also often adopted for water entry of a 3d body most of existing works were concentrated on vertical entry of an axisymmetric body zhao and faltinsen 1998 simulated an arbitrary axisymmetric body entering water at a varying speed and considered flow detachment from the knuckle yan and liu 2011 investigated vertical entry of a cone and a sphere at a constant speed with the gravity effect xu et al 2011 considered a cone entering water in free fall motion in fact the problem of vertical entry of an axisymmetric body can be solved in a two dimensional domain under a cylindrical coordinate system sun and wu 2013 investigated oblique water entry of a cone into calm water and effect of three dimension is considered wu and sun 2014 studied similarity solution of an expanding paraboloid obliquely entering water without the gravity effect however flow detachment was not included in their works for most practical ships its hull form is slender newman 1970 reviewed analytical progress in the application of slender body at that time based on slender body theory the method of 2d t theory can be applied in studying hydrodynamics of the slender ship with a forward speed in which the 3d problem can be approximated by time dependent 2d problems in cross planes maruo 1989 considered a slender ship moving through waves in which the longitudinal perturbation velocity was included in the linearized body boundary condition more work on applications of 2d t theory was reviewed in fontaine and tulin 1998 a thin flow will be formed along the body surface when a body impacts water as the movement of the jet flow is prone to the numerical error sun and faltinse 2007 cut most of jet flow according to their numerical results that the cut technique seems not to change the force on the body significantly in fact almost half of the energy is transferred to the jet flow when a blunt body enters water cointe and armand 1987 cointe et al 2004 consequently some analytical or numerical methods have been adopted to keep the jet flow during water entry of wedges with infinite width xu et al 2010 sun et al 2015 cheng et al 2018 or finite width iafrati and battistin 2003 bao et al 2019 the physical feature of splash is commonly observed at the bow of a ship based on a boundary integral method chan 1987 numerical studied a case of slender ship moving at a high speed and a spray formation was shown clearly in the results the splash can also be treated by the 2d t theory battistin and iafrati 2003 and sun and faltinsen 2007 2011 extended their own works of 2d water entry of finite width wedges to study prismatic hull planing with a constant forward speed and the splash was simulated certainly 2d cfd method can also be used together with 2d t theory such as marrone et al 2011 wang and soares 2016 and zheng et al 2019 however the motion of the ships in the above papers was symmetrical about the longitudinal section in center plane the present work is based on the principle of dividing the hull into a series of 2d sections as common in the strip theory slamming phenomenon is investigated for a ship with a zero forward speed five degrees of freedom are considered not only including the heave and pitch which is often considered but also the sway roll and yaw which is less considered in the past work correspondingly for a 2d section of the above model 3 degrees of freedom need to be considered in the process of ships sailing flow often detaches from the hull which will be investigated in depth in present paper and a pioneering work has been finished in bao et al 2016 for a 2d finite wedge the impact force and bending moment on the hull are calculated the pressure distribution and free surface deformation are provided and their physical meaning is discussed 2 mathematical model and numerical procedure 2 1 governing equation and boundary conditions the sketch of a slender hull entering calm water is shown in fig 1 two coordinate systems are established an earth fixed cartesian coordinate system o xyz is defined in which the origin is on the undisturbed water surface x axis is from the stern to bow when the ship is at its mean position z axis is vertically upward and y axis is from the starboard to the port we consider the case in which the forepart of the hull has emerged from the water the origin point o or the o yz plan x 0 is at the intersection point between the keel of the hull which has an initial inclined angle and the calm free surface when t 0 a moving coordinate system o xyz is fixed at the rotational center o r the x axis is along the longitudinal direction and pointing to the bow the y axis is towards the port and the z axis is normal to o xy plane the hull has in motion with 5 dof with displacement η i i 2 6 in sway heave roll pitch and yaw except surge η 1 the fluid is assumed to be incompressible and inviscid and the flow to be irrotational a velocity potential φ which satisfies laplace equation can then be introduced 1 2 φ x 2 2 φ y 2 2 φ z 2 0 in the fluid domain on the body surface s b the impermeable condition takes the form as 2 φ n u n where u is the velocity of the point on the hull surface and n is the normal vector of the body surface and positive for pointing out of the fluid domain the lagrangian form of the kinematic and dynamic conditions on the free surface in the frame o xyz can be written as 3 d x d t φ x d y d t φ y d z d t φ z 4 d φ d t 1 2 φ x 2 φ y 2 φ z 2 g z the atmospheric pressure on the water surface has been assumed as a constant in addition a far field condition is specified 5 φ n 0 x 2 y 2 z 2 as the hull in this paper is assumed as a slender body the above 3d problem can be simplified into a sequence of 2d water entry problem in cross sections as in the strip theory for ship motion in waves a slenderness ratio ε b l is introduced we then have x o ε y o 1 and z o 1 the term of o ε 2 order in the governing equation and boundary conditions for 3d problem can be neglected as the surge motion of the hull is neglected and the pitch and yaw motion are small it is assumed that y y and z z thus the 2d boundary value problem in a cross plane can be written as follows the potential ϕ of the flow in the cross plane satisfies the laplace equation 6 2 ϕ y 2 2 ϕ z 2 0 the body surface boundary condition can be written as 7 ϕ n η 2 x η 6 y η 4 n y η 3 x η 5 z η 4 n z where x y z is the position vector measured from the rotational center o r n y n z is 2d normal vector on the body surface in the cross plane as shown in fig 2 b and η i i 2 6 with a overdot indicates the first time derivative of position namely velocity in each direction the motion of the cross section at x is equivalent to that with a rotational speed of ω η 4 a vertical heave speed of v 8 v η 3 x η 5 and a horizontal sway speed of u 9 u η 2 x η 6 the lagrangian form of the kinematic and dynamic conditions on the free surface s f can be written as 10 d y d t ϕ y d z d t ϕ z 11 d ϕ d t 1 2 ϕ y 2 ϕ z 2 g z the far field boundary condition takes the form as 12 ϕ n 0 y 2 z 2 2 2 boundary integral equation and numerical schemes based on green s second theorem the governing equation for a cross plane can be transformed into the following boundary integral equation 13 a p ϕ p s ln r p q ϕ q n q ϕ q n q ln r p q d s q where a p is the solid angle of point p on the fluid boundary and r pq is the distance between points p and q s in eq 13 includes all the boundary surfaces in fig 2b which is discretized into linear elements on each element the values of ϕ and ϕ n are defined at the both nodes and their values within the element can be obtained by using the shape functions 14 f n 1 ξ f 1 n 2 ξ f 2 where f stands for either ϕ or ϕ n and 15 n 1 ξ 1 ξ n 2 ξ ξ the local coordinate ξ in the above equations varies from 0 at one node to 1 at the other eq 13 can then be written as 16 a p ϕ p k 1 n e i 1 2 ϕ k i q 0 1 n q ln r p q n i ξ l k d ξ k 1 n e i 1 2 ϕ k i q n q 0 1 ln r p q n i ξ l k d ξ once the solution of eq 16 at each time step has been obtained the free surface profile can be updated through the kinematic boundary conditions given by eq 10 and the velocity potential on the free surface through the dynamic boundary condition in eq 11 a long and thin jet due to the water entry of a wedge would pose some difficulties in the numerical simulation to solve this problem the jet attached on the surface of the wedge is treated through the shallow water equation by wu 2007 and the free jet flow detached from the knuckle is treated through the momentum equation by bao et al 2016 it is assumed that the flow leaves the knuckle tangentially bao et al 2017 thus at the knuckle φ n is therefore continuous and is known from the body surface boundary condition while φ is unknown and can be obtained through eq 16 a five point least square technique is applied to smooth the free surface profile and the velocity potential on the free surface and a cubic spline technique is used to regrid elements on the free surface 2 3 calculation procedure and impact force an earth fixed coordinate system o xyz and a moving coordinate system o xyz shown in fig 1 are established to describe the 3d water entry problem the hull with an initial pitch angle enters water at a constant translational and rotational speed with its forepart out of the calm water the hull from the origin o to the front end of the bow is cut into n vertical cross planes which is shown in fig 3 to improve the numerical accuracy more planes are taken at the bow of the hull as time increases these cross sections will be immerged into water from the origin o to bow in sequence at a certain time t whether ith cross plane has penetrated into water or not will be determined by the vertical coordinate z i t of the keel at ith cross plane in o xyz to be more specific z i t 0 means the ith cross section has touched water and its wetted part would contribute to the resultant force of ship however this wetted part at the initial moment is extremely small which may arise numerical difficulties and this can be treated in a stretched coordinate system wu 2007 with a similarity solution as initial solution xu et al 2008 the coordinate x i t of the keel at ith cross plane in the frame o xyz can be obtained through the relationship between the coordinates of the keel at ith cross planes in two coordinate systems o xyz and o xyz is 17 x i t r z t r y t r x t x i x r t where r z t r y t and r x t are the coordinate transform matrixes at time t 18 r x t 1 0 0 0 cos η 4 t sin η 4 t 0 sin η 4 t cos η 4 t 19 r y t cos η 5 t 0 sin η 5 t 0 1 0 sin η 5 t 0 cos η 5 t 20 r z t cos η 6 t sin η 6 t 0 sin η 6 t cos η 6 t 0 0 0 1 x i x i 0 z i is the coordinate of the keel at the ith cross plane in o xyz which can be obtained from the hull shape x r t are the coordinates of the rotational center o r in o xyz 21 x r t x r t y r t z r t at t 0 the keel at 1st cross plane first touches the water which corresponds to the plane at which the origin point o is located the coordinates of the keel for the 1st cross plane x 1 0 0 0 0 and x r 0 can then be obtained from eq 17 22 x r 0 r z 0 r y 0 r x 0 x 1 thus x r t can be updated based on the relationship 23 x r t x r 0 0 t η τ d τ the coordinate x i t of the keel at ith cross plane can be obtained by eq 17 when the potential at a cross plane has been found through the method in sect 2 2 the bernoulli equation can be used to obtain the pressure at a cross plane 24 p ϕ t 1 2 ϕ ϕ g z it is difficult to deal with the term of ϕ t which is still not explicitly known even when ϕ is found here we adopt the approach proposed by wu and eatock taylor 2003 and a detailed description of this approach is given in bao et al 2016 the sectional force f y x i t f z x i t and moment m x x i t can be obtained by integrating the pressure along the body surface 25 f y x i t s 0 p n y d s 26 f z x i t s 0 p n z d s 27 m x x i t s 0 p y n z z n y d s it should be noted that n y n y and n z n z as the pitch angle η 5 and the yaw angle η 6 are small at time t the number of cross planes which have been immersed into water is n the water entry of the cross section in each cross plane will be simulated by the same process as above and its sectional forces and moment will be obtained from eq 25 27 thus the sway force f y the heave force f z the roll moment m x the pitch moment m y and the yaw moment m z at different time t can be obtained through the integration of sectional force along the x direction as sketched in fig 4 where f 2d represents sectional force or moment in one direction 28 f y t f y d x i 0 n f y x i t d x i 29 f z t f z d x i 0 n f z x i t d x i 30 m x t m x d x i 0 n m x x i t d x i 31 m y t x f z d x i 0 n x i f z x i t d x i 32 m z t x f y d x i 0 n x i f y x i t d x i 3 numerical results and discussions 3 1 geometry of a fridsma hull a series of model tests was carried out by fridsma 1969 to study planing hull in waves as a typical slender body fridsma hull models have been widely used for numerical simulations to study hydrodynamic performances of a planing hull sailing on the free surface sun and faltinsen 2007 2011 in the present paper one of fridsma hull models is chosen to be used in the following simulations the hull model has a planform with a length of l a breadth of b and a draught of h as shown in table 1 the parameters with are dimensional here the water density ρ 1000 kg m3 the gravity acceleration g 9 81 m s2 and the breadth b of the hull are used for the nondimensionalisation the geometry of the hull model is depicted in fig 5 and all the parameters have been nondimensionalized l f is the length of the initial wetted part in calm water with a given value 0 55l if not specified the distance between the rotational center o r and the stern along the keel line is l r and that between o r and the keel along the direction perpendicular to the keel is h r the pictures of the hull in top and side view are shown in fig 5a and c respectively the whole hull can be divided into two parts the straight part and the bow part and the dividing point between them is denoted as o b the straight part corresponds to the part on the left hand side of o b along which the keel is straight and has a length l s while that beyond o b is named as the bow part the shapes of the waterplan and the keel in the bow part are elliptical as shown in fig 5a and c respectively in the o xyz frame the horizontal coordinate of o b is x 2 5 each cross section is equivalent to a wedge with the same deadrise angle γ as shown in fig 5d but the size of the section in the bow part decreases as x increases the deadrise angle is large enough to ignore air cushioning effect during water entry 3 2 convergence and validation study the fridsma hull entering water with a heave velocity of η 3 3 and a pitch velocity of η 5 0 4 is considered the bow part of the hull is out of water at t 0 with an initial pitch angle of η 5 4 the number of cross planes between x 0 and the stern is n fig 6 a shows the total vertical force f z varying with time at different numbers of cross planes n it is expected that more cross planes will improve the calculation accuracy but in fact it does not significantly improve calculation accuracy when the number of cross planes reaches a certain number it can be seen in fig 6 that the results will not change significantly for n 12 thus we can conclude that the choice of n 12 is accurate enough for the total force in the following simulation the total number of cross planes n is taken as 14 to validate the numerical procedure we now consider a prismatic hull vertically entering calm water with a vertical velocity of η 3 3 and a pitch angle of η 5 4 as shown in fig 7 the difference between geometrical shapes of the prismatic hull in fig 7 and the fridsma hull in fig 5 is at the bow part as the shape and velocity for each section of a prismatic hull is the same all sections will experience the same 2d water entry η 5 in the present case is a negative number which implies that the section with a larger x will entre water later and the delay time dτ between two cross planes with an interval of dx is 33 d τ η 5 d x η 3 thus if the whole forepart has been immerged into water the time difference between its back end and front end is 34 δ t η 5 η 3 l l f fig 8 shows the vertical force f z of a 2d wedge with the same size as the section of the prismatic hull entering water at a vertical speed of η 3 3 through the numerical method by bao et al 2016 at every instant the total vertical force f z on the prismatic hull can be obtained through the integration of f z with respect to time 35 f z t x 0 x n f z x d x η 3 η 5 t s t f z τ d τ t s 0 t δ t t s t δ t t δ t fig 9 presents the comparison of results obtained by the methods through eq 35 and eq 29 the two sets of results are in good coincidence this implies that the results of the present numerical simulation are reliable 3 3 the longitudinal motion 3 3 1 hydrodynamic performance analysis to investigate the case of fig 6 in depth more details are provided the free surface profiles and pressure distribution at different time are displayed in fig 10 a and fig 10b during water entry of the cross section at x 2 2625 a thin jet flow will be generated along the body surface during water entry the movement of the jet root greatly affect the pressure distribution thereby the force on the body surface due to the sharp change of the flow direction a large pressure gradient can be observed near the jet root sun et al 2015 which disappears rapidly after the detachment of the jet root from the knuckle bao et al 2016 the cross sections at other x will experience a similar process the sectional force histories f z is shown in fig 11 as well as the free surface profiles in fig 12 and the pressure distributions fig 13 here it is important to note that only the results for the cross sections in fig 3 can be directly obtained through numerical simulation and that on other areas is obtained by interpolation before t 0 06 the rapid increase of f z can be attributed to two reasons the first one is the increase of pressure in fig 11 it can be seen that the sectional force increases noticeably for most of sections between t 0 04 and 0 06 this is due to the fact that before t 0 06 the spray roots for most of cross planes will move to the knuckle successively and during this period the detachment of flow does not occur yet the pressures in figs 13a and b say that the pressure gradient is large and the free surfaces in figs 12a and b show that the flow does not detach from the knuckle and this both implies that the pressure is large during this stage not only that fig 13a and b also show that the wetted surface of the hull increases rapidly before t 0 06 and this is another more important reason for the rapid increase of total vertical force in fig 6 at the initial stage between t 0 06 and t 0 12 the sections in the bow part which correspond to x 2 5 in fig 11 start to enter into water following the discussion above the water entry of bow part will increase the total pressure however the truth is that during this stage f z in fig 6 decreases quickly this can be explained through the decrease of pressure in straight part for which the spray root has detached from the knuckle and the pressure will decrease based on the discussion of bao et al 2016 the free surfaces in fig 12c d e say that the bow is entering water and the splash jet has formed after knuckle detachment in straight part in fig 13c d e it can be seen that the largest pressure has move to the bow part after t 0 14 the sectional spray roots in bow part have detached from the knuckle and the large pressure gradient area has disappeared in fig 13f f z decreases slowly as the influence of the hydrostatic pressure is most important 3 3 2 the effect of the hull bow to study the effect of the bow shape the comparison between prismatic hull and fridsma hull is made the breadth and height of prismatic hull is kept the same as that of the straight part of the fridsma hull the heave velocity pitch velocity and pitch angle are also the same fig 14 shows the time histories of total vertical force f z for two hulls before t 0 04 the sections in the bow part for a fridsma hull has not touched the calm surface in other words hull sections for two ships below water by now are absolutely the same and therefore the two forces in fig 14 are the same as time increases the difference between the two forces begins to appear and grows wider due to the difference of bow shapes in strip theory the three dimensional is neglected the numerical result of the force and moment on the hull will be larger than that occurs in practice the 3d effect for the fridsma hull is stronger than that for prismatic hull thus the difference between the forces on the two hulls in reality can be more obvious than the results in fig 14 for the fridsma hull the profile of the keel in the bow part is elliptical which means the height of the keel will rise as x increases and the section in the bow part will therefore enter water later in contrast the prismatic hull with a straight bow will enter water earlier for example the cross plane of x 1 98 at t 0 10 the spray root of the fridsma is still attached on the body surface while that of the prismatic hull has detached from the knuckle as shown in fig 15 a this leads to a significant difference between pressure distributions shown in fig 15b fig 16 shows the free surface profiles and the pressure distribution on the body surface of the prismatic hull and the fridsma hull at t 0 10 respectively the difference between the two sets of results is reflected in the bow part the peak pressure for the fridsma hull is larger while the wetted surface for the prismatic hull is larger but the latter is more important thus f z in fig 14 is larger for the prismatic hull 3 4 the transverse motion 3 4 1 the effect of the sway velocity in xu et al 2010 sun et al 2015 bao et al 2016 the horizontal velocity is considered during water entry of a 2d wedge the motion relative to the flow in horizontal leads to the imbalance of the pressure on the both sides of the wedge morabito 2015 analyzed a planing hull with a fixed yaw angle based on the 2d oblique water entry together with 2d t theory we now consider water entry of the hull with a heave velocity of η 3 3 a pitch velocity of η 5 0 4 and different sway velocities η 2 fig 17 shows the force and moment components in 5 modes overall the influence of η 2 on the heave force f z in fig 17b and the pitch moment m y in fig 17d is not obvious when η 2 is positive the flow at the starboard will be pushed away and the free surface at the same side will also be higher that will lead to a negative sway force f y as shown in fig 17a and a negative yaw moment m z in fig 17e and their magnitude will be enhanced by a larger η 2 initially in the section which has been immerged into water only a small part near the tip of the wedge is below water and its position is lower than the corresponding rotational center thus a negative f y will lead to a negative m x after reaching a small extreme value m x decreases in value and then change its sign as the negative f y and the wetted surface increase after reaching their peak at about t 0 06 the value f y m x and m z reduce quickly as shown in fig 17 the free surface profiles and the pressure distribution at t 0 04 and t 0 06 are provided in fig 18 and fig 19 respectively owing to the existence of the sway velocity the wetted surface and pressure distribution are not symmetrical when t 0 04 the spray root is still below the knuckle in fig 18a and a large pressure gradient can be clearly observed in fig 19a as η 2 is positive the pressure on the right hand side is much higher than that on the left hand side when t 0 08 the spray root in the straight part has detached from the knuckle in fig 18b and the large pressure gradient in the straight part has disappeared in fig 19b however in this area the pressure on the right hand side is still higher than that on the left hand side though a large pressure gradient area appears in bow part the sharp reduction of the pressure in the straight part leads to that the value of f y rapidly decreases as well as m x and m z 3 4 2 the effect of the roll velocity as discussed in xu et al 2010 when a wedge rolls in one direction during water entry the restoring moment will increase rapidly and then change the roll direction however when the wedge has finite width bao et al 2017 the restoring moment can decease significantly and the wedge may capsize we now consider water entry of the hull with a heave velocity of η 3 3 a pitch velocity of η 5 0 4 and different roll velocities η 4 fig 20 shows the force and moment components in 5 modes the influence of roll velocity η 4 on the f z and m y is not evident since the roll velocity η 4 is negative the right deadrise angle of a cross section decreases and the left deadrise angle increases a smaller deadrise angle leads to a larger pressure on the corresponding body surface a negative sway force f y is formed by imbalance pressure on the two sides of the wedge body in fig 20a at the early stage as the part which has been immerged into water is lower than the rotational center the negative f y leads to a clockwise moment m x as shown in fig 20c m x will rapidly change its sign and increases when the flow is above the rotational center the free surface profile and pressure distribution at t 0 04 and t 0 08 are provided in fig 21 and fig 22 respectively from these figures we can find that the spray root in the straight part will gradually detach from the knuckle at between t 0 04 and t 0 08 the right deadrise angle is smaller and thus the spray root on the right hand side will detach from the knuckle earlier and then the positive sectional force f y and negative sectional moment m x will be developed because the pressure on the right hand side reduces as time increases in more cross planes f y becomes positive and m x becomes negative and thus f y in fig 20a changes its sign and increases rapidly as well as m x in fig 20c when the spray root on the left hand side detached from the knuckle the pressure on the left hand side will decrease as well as positive f y in fig 20a and negative m x in fig 20c about between t 0 08 and t 0 10 the spray root in the bow part will gradually detach from the knuckle as the size of the section in the bow part is small the change of its sectional force before and after spray root detachment has a limited influence on the f z and m y however the amplitudes of f y m x and m z are not very large and thus the curves in fig 20a c and e take the form of sawtooth at between t 0 08 and t 0 10 3 4 3 the effect of the yaw velocity we finally consider water entry of the hull with a heave velocity of η 3 3 a pitch velocity of η 5 0 4 and different yaw velocities η 6 fig 23 shows the force and moment components in 5 modes from eq 9 a positive η 6 is equivalent to that the cross section in the forepart has a positive sway velocity η 2 thus the influence of η 6 on the forces and moments in fig 23 is very similar to the case in fig 17 from eq 9 for a section at larger x its horizontal velocity u will be larger as well if we compare the case of η 6 0 6 in fig 23 with the case of η 2 1 2 in fig 17 it can be noticed that for the section at x 2 its u in the case of η 6 0 6 will be larger and conversely the case of η 2 1 2 larger this can be confirmed by fig 24 a and fig 24b which respectively show the comparison of pressure distribution on the section at x 1 5875 and x 2 4875 between the case of η 2 0 0 η 6 0 6 and η 2 1 2 η 6 0 0 the discontinuity of pressure in fig 24 is because the tangential velocity is not continuous at the tip of wedge which is can be treated with kutta condition xu and wu 2015 since its effect is very local and will not exert noticeably effect on the resultant force thus it is not considered in current work 4 conclusions the water entry of a slender hull with 5 degrees of freedom 5 dof at a prescribed speed is investigated through a strip theory in which the hull is cut into a series of cross planes the motion of each plane is equivalent to the water entry of a two dimensional wedge which can be solved through the boundary element method in the time domain with the fully nonlinear boundary conditions imposed on the free surface the pressure on the body is calculated through the auxiliary function method the total force and moment of the hull are obtained by integrating the sectional force and moment along the longitudinal direction through the obtained results the following conclusions can be draw 1 when a fridsma hull enters water with heave and pitch velocities as the wetted surface and impact pressure both increases when t is small the heave force and the pitch moment increase significantly during this period after that they will both decrease when the detachment of spay root from the knuckle occurs 2 the hull with an elliptical bow enters water more slowly that with straight bow this may lead to a larger local peak pressure but can firmly lead to a smaller wetted surface the latter is apparently more important and thus the overall force for the hull with an elliptical bow is therefore smaller 3 when a hull has a velocity in the sway roll or yaw direction the loads on the hull are in 5 modes and the force or moment on one mode will be affected by the others if the hull is free its motion will be extremely complex credit authorship contribution statement chaoming bao writing original draft writing review editing shiyan sun writing original draft writing review editing gang xu writing original draft writing review editing linfeng chen writing original draft writing review editing acknowledgements this work is supported by lloyd s register foundation through the joint center involving university college london shanghai jiaotong university and harbin engineering university to which the authors are most grateful lloyd s register foundation helps to protect life and property by supporting engineering related education public engagement and the application of research this work is also supported by the natural science foundation of jiangsu province china grants number sbk2018040999 national natural science foundation of china grants number 51879123 51809123 
22003,conical structures are widely used in marine engineering in ice covered area because of their icebreaking capability the ice loads acting on the conical structures are closely related to the failure modes of sea ice the discrete element method dem is adopted to simulate the ice failure modes and ice loads during the interaction between sea ice and conical structure in this study the accuracy of dem simulations is validated by comparing the simulated ice loads with the measured ice loads from the model tests in hamburg ship model basin hsva a bending failure occurs when the sea ice interacts on the conical structure and the sea ice breaks into many fragments with different breaking lengths the influence of ice thickness ice velocity cone diameter at waterline and cone angle are considered to analyze the characteristics of ice breaking length the simulation results show that the ice breaking length increases with the increase of ice thickness the increase of ice velocity and cone diameter can lead to the change of sea ice failure mode which can reduce the breaking length of sea ice and increase the ice load the decrease of ice breaking length indicates that the failure mode of sea ice changes from the bending failure to the crushing failure a static ice force formula considering the effect of ice breaking length can be proposed to predict the ice load of the structure and verify the reliability of the structure keywords discrete element method dem ice load conical structure ice breaking length ice failure mode 1 introduction the conical structure with a better ice breaking performance has been widely applied in cold regions such as jacket platforms in the bohai sea e g jz20 2 muq yue and bi 2000 confederation bridge brown et al 2010 and kemi i lighthouse brown and määttänen 2009 the failure mode of sea ice is closely related to the shape of the structures when sea ice interacts with vertical structure it can be broken into fine particles by crushing failure when sea ice interacts with conical structure it can be broken into ice fragments by bending failures sodhi 2001 timco and o brien 1994 because the compressive strength of sea ice is about 2 5 times of the flexural strength conical structures can effectively reduce ice load and ice induced structural vibration moslet 2007 shazly and prakash 2009 the amplitude and period are two key parameters of the ice load on cones which are closely related to the ice breaking length l b on the cones when the ice velocity is constant the ice load period is proportional to l b in addition the breaking length can directly reflect the failure mode of sea ice which will inevitably affect the ice load amplitude timco et al 2017 xu et al 2011 the ice load and breaking length during the interaction between ice and conical structures can be studied with different approaches including field measurements model tests theoretical analysis and numerical simulations suominen et al 2017 li et al 2018 brown et al 2010 ice thickness ice velocity cone diameter and cone angle are the important factors affecting the failure mode of sea ice during the interaction between sea ice and conical structures are studied frederking and sudom 2006 timco and weeks 2010 huang et al 2007 some measurements show that the breaking length of sea ice is about 7 05 times of the ice thickness yue et al 2007 however some tests show the ratio of the breaking length to ice thickness can be lower to 4 2 barker et al 2005 gravesen et al 2005 it is because that the breaking length can be changed by other factors such as ice velocity and structural size when the ice velocity increases the sea ice acting on the cone can also have crushing failure sodhi and haehnel 2003 the different failure modes of ice cover appear on the narrow and wide cones with the observations from model tests and field data yue and bi 2000 xu et al 2015 the wedge shaped failure mode is always observed on the cone with the small diameter and the corresponding breaking length is about 5 7 times of ice thickness the plate shaped failure mode is observed on the cone with the large diameter and the corresponding breaking length is 3 4 times of ice thickness through theoretical analysis lu et al 2016 found that the breaking length of sea ice caused by the bending failure during the action with the wide structure should be less than 2 times of its characteristic length the reasons and conditions for these factors to affect the sea ice failure mode need to be further studied moreover the empirical formula of the ice load on conical structures was established by model tests data edwards and croasdale 1976 hirayama and obara 1986 kato 1986 which can be split into two components including the breaking force of ice cover and the climbing force of broken ice the formula of ice load has to consider the factors which can affect the ice load and failure mode of sea ice such as ice strength ice thickness ice velocity and structural size parameters angle and diameter however it is difficult to fully consider all the factors in the calculation formula of ice force obtained by theoretical derivation or experimental measurement therefore these ice force formulas can only be used under specific conditions which limit their applicability in the field measurement and model test the breaking process of sea ice can only be observed from a macro perspective and it is difficult to measure the initiation and development of the cracks in sea ice therefore the advantages of numerical simulation can be highlighted which can calculate the ice load simulate the process of sea ice damage and effectively analyze the generation of sea ice cracks su et al 2010 lu et al 2016 2017 the finite element method fem has the characteristics of basic continuum theory and mature development and it has been widely acknowledged to solve engineering problems with high reliability however most of the fem software is general purpose software which is not easy to be directly used in the calculation of the interaction between sea ice and structure in recent years the coupling method of fem and dem has also been developed the two dimensional and three dimensional dem codes have been formed to simulate the ice load under various working conditions hopkins 1997 paavilainen and tuhkuri 2013 in this method the action between ice fragments is calculated by dem while the internal force inside an ice fragment is calculated by fem this method can simulate the deformation and collision of sea ice fragments in addition the cohesive element method smoothed particle hydrodynamics sph and peridynamics pd are also used in sea ice simulation lu et al 2014 wang et al 2018 staroszczyk 2017 generally these methods can obtain a reasonable ice load but the simulation of sea ice failure mode remains to be studied since the 1980s the discrete element method has been applied to the study of sea ice rheology and pancake ice dynamics shen et al 1986 dem can be used not only to simulate the collision between pancake ice at small scale but also to analyze the formation of ice ridges the generation of ice cracks and the evolution of the sea ice in the peri glacial region at mesoscale hopkins et al 2004 recently the research on the interaction between sea ice and platform structure or ship hull based on the dem has made great progress lau et al 2011 ranta et al 2018 tuhkuri and polojärvi 2018 jou et al 2019 it can reasonably simulate the failure process of sea ice and ocean structure and calculate the ice load and pressure distribution of the structure in addition it also has excellent computational performance in describing the discontinuous distribution characteristics of the shape and size of the ice floe liu and ji 2018 van den berg et al 2018 in the simulation of the sea ice with dem computational parameters can be verified by simulating the tests of ice mechanical properties such as compression bending and direct shearing ji et al 2016 polojärvi et al 2015 with the gpu parallel technology the computational efficiency and scale of dem have been greatly improved which makes it more widely used in sea ice engineering govender et al 2014 this study analyzes the breaking length of ice cover and ice load on narrow conical structures by using the gpu based dem the numerical model will be verified against the measured data obtained in the bohai sea and the model test data of hsva the influence of ice thickness ice velocity and cone diameter on the ice breaking length and the ice load on narrow conical structures are discussed using the dem results 2 discrete element method of sea ice 2 1 parallel bond model sea ice with spherical particles the spherical particles with regular packing pattern are adopted to simulate the sea ice in the dem simulation ji et al 2015 the particles are bonded with the parallel bond model as shown in fig 1 an elastic bonding disk between two particles is set to transfer the bond force and moment potyondy and cundall 2004 thus the bonding disk can be regarded as elastic springs with the constant normal and shear stiffness which are distributed over a circular disk lying on the contact plane and centered at the contact point the forces and moments in the normal direction and shear directions associated with the parallel bond are denoted by f n f s m n and m s the maxiumum normal and shear stresses acting on the bonding disk are defined based on the beam theory and can be written as 1 σ max f n a m s i r τ max f s a m n j r where r is the radius of the bonding disk a is the section area of the bonding disk i is the moment of inertia of the bonding disk section and j is the polar moment of inertia of the bonding disk section here a i and j can be written as 2 a π r 2 i 1 4 π r 4 j 1 2 π r 4 2 2 failure criterion of bonded particles the fracture process of brittle materials begins with the initiation and propagation of cracks and eventually the material is transformed from continuum to discontinuous medium an appropriate failure criterion in dem is important to describe the crack evolution and fracture patterns of ice cover the failure criterion in this study has been widely adopted for the simulation of brittle materials such as rock and concrete hentz et al 2004 wang and tonon 2010 as shown in fig 2 in the failure criterion the stress states of two bonded particles can be divided into two portions tension and compression which is determined according to the distance between the two bonded particles it is in tensile state if the distance between two particles centers is more than the sum of their radius when the maxiumum normal stress σ max exceeds the normal strength σ t or the maxiumum shear stress τ max exceeds the shear strength τ t the bonded disk will break in tensile failure or shear failure in this study the normal tensile strength σ t is defined as 3 σ t σ b n where σ b n is the normal bonding strength of the bonded particles which is a function of ice salinity temperature load rate and particle size ji et al 2016 based on the mohr coulomb criterion the shear strength τ t of bonded particles can be defined as 4 τ t σ b s μ b σ max where σ b s is the shear bonding strength of bonded particles μ b tan φ is the friction coefficient between bonded particles and φ is the friction angle of particles when the distance of two particles is less than the sum of their radius they are in compressive states under this circumstance the bonded particles will break via shear failure when the maxiumum shear stress τ max exceeds the shear strength τ t the contact force will be considered instead of the bonding force after tensile or shear failure occurs the contact force between them can be calculated with the hertz contact model dintwa et al 2008 the failure of particles leads to the development of the cracking in sea ice therefore the values of σ b n σ b s and μ b have obvious influences on the failure pattern of sea ice the ratio of the normal bonding strength to the shear bonding strength of the particle is set to 1 0 according to the studies about the simulation of brittle materials by the dem potyondy and cundall 2004 wang and tonon 2010 the relationship between the macro ice strength and the micro dem parameters σ b n σ b s and μ b is verified by the simulation of uniaxial compression test and three point bending test of sea ice long et al 2019 ji et al 2016 when the strength of sea ice is known the parameters in the bond model and failure criterion of the dem can be determined which makes the dem more suitable for simulating the failure process of sea ice 3 dem modelling and validation of ice load and ice breaking length 3 1 setup of hsva model test in dem simulations a comparison with some model tests is employed to validate the dem model of sea ice in this study the model tests in hsva were established on the ice conditions and structural parameters of jz 20 2 muq platform in the bohai sea xu et al 2015 the conical structures in the bohai sea and hsva model tests are shown in fig 3 a and b respectively fig 3 c shows the dimension of the conical structure in the hsva model test which is a small scaled size on the jacket platform in the bohai sea the scaling factor is set to reduce the actual structural parameters and sea ice parameters to the size suitable for the model test the actual ice load on the jacket platform in the bohai sea also can be calculated with the ice load in hsva test according to the scaling factor therefore the comparison between the results of dem and hsva test is also a verification of the measured data in the bohai sea the actual flexural strength of sea ice is in the range from 0 2 mpa to 1 6 mpa and the level ice thickness is in the range of 0 05 0 3 m according to the field measurement in the bohai sea ji et al 2011 in the model test when the scaling factor is set as 6 the flexural strength σ f of the model ice is 60 6 kpa the ice thickness h is 0 032 m the ice velocity v is 0 2 m s and the cone diameter at the waterline d is 0 61 m xu et al 2015 the ice cover is constructed with bonded spherical particles using regular packing pattern in dem to simulate the interaction between the sea ice and the conical structure as shown in fig 4 spring boundaries are set on three edges of the ice sheet except the edge interacting on the conical structure the stiffness between the sea ice particles and the spring boundary equals to the contact stiffness between bonded particles the stiffness in the horizontal direction is set as the normal contact stiffness between particles k n and the stiffness in the vertical direction is set as the tangential contact stiffness between particles k s the spring boundary moves with the ice sheet in the same velocity the size of ice sheet l w is 5 0 m 3 5 m the structure can be regarded as a rigid body by only considering the translation and rotation meanwhile the hydrodynamic effect on the breakage of ice cover is also very important lubbad et al 2008 in the dem simulation the hydrodynamic force is considered to simplify into buoyancy and drag force the drag force is calculated by a constant drag coefficient the buoyancy is calculated according to the volume of the particles immersed in the water and the resultant force of the buoyancy of the particles is the buoyancy of the sea ice the computational parameters of the dem simulations are directly related to the physical and mechanical properties of sea ice the study about relationship between the micro parameters in dem and the macro strengths of sea ice indicates that the particle diameter d p and the bonding strength σ b have a significant effect on the strengths of ice specimens long et al 2019 the flexural strength of ice will increase with the decreased particle diameter d p and the increased bonding strength σ b respectively the inter particle bonding strength σ b in dem can be determined with the flexural strength of sea ice σ f and the ice thickness h ice as following long et al 2019 5 σ b σ f 1 77 1 81 e h ice d p 4 78 hence the bonding strength between particles can be calculated from the flexural strength of the model ice used in hsva test the other main parameters of dem in this simulation are listed in table 1 3 2 determination of ice breaking length with dem simulations in dem simulations after the ice cover is broken the ice fragments are made up of several cohesive particle elements the size of the fragments is determined by the number and location of the particle elements contained in the fragments the determination of the ice fragments in dem simulation can be divided into two steps as shown in fig 5 the contact relationship between particles can be judged according to the position of particles and a contact neighbor list can be established as shown in table a of fig 5 the contact list is used to calculate the interaction force between particles the principle of establishing contact list is to make the particle index in list 1 always less than that in list 2 which can avoid the repetition of judging the contact relationship between particles the bonding relationship between particles is checked according to the order in which the particles contact their neighbors in the contact list and the bonding particles are marked in the bond list the particles are classified according to the bonding relationship the initial block index of each particle is set to 1 the block index of the first bonding pair can be set to 2 if any particle in second bonding pair is the same with the first one the block indexes of both particles in the second are set to 2 conversely the block indexes of the particles in the second pair are set to 3 similarly the ice block index for all particles can be determined after checking all the bonding pairs those are listed in the bond list the ice block index with only one particle is always set to 1 accordingly the block indexes of the particles in this case are listed in table b of fig 5 fig 6 a shows that the ice fragments produced during the ice structure interaction can be marked as different colors in the dem simulation the size and distribution of ice fragments can be obtained by calculating the number and position of the particles in each ice fragments the breaking length of ice cover l b can be determined as shown in fig 6 b the breaking length used in this paper is the average value of the ice breaking length at different time in the simulation this method can clearly describe the cracking process of ice cover facilitate the statistics of the size and distribution of ice fragments and analyze the failure mode of sea ice according to the breaking length of sea ice the ice cover can be broken into smaller segments with secondary breaking pattern during its interaction with conical structure the magnitude and frequency of ice load are affected obviously by the secondary breakage of ice cover lu et al 2014 3 3 validation with the hsva experiments the ice load on the conical structure is a random process since the complex failure mode of ice cover hence the accuracy of the dem parameters should be verified from two aspects the failure mode of ice cover and the dynamic process of ice load during the simulation the ice load at the current time can be calculated by the total contact force of particles acting on the structure therefore the ice load will change with the action time of the sea ice on the structure during the interaction between ice cover and conical structure the failure processes of ice cover in the hsva experiments and dem simulations are shown in fig 7 in both cases the sea ice cover performs bending failure when interacting with the cone when the internal cracks run through the ice cover the circumferential and radical cracks are both observed the broken ice fragments are pushed to climb along the structure by the subsequent ice cover and fall into the water and drift away during the climbing process of ice cover the broken ice can accumulate around the conical structure and be removed by the subsequent ice cover the failure process of ice cover in the dem simulation is similar to the model test in hsva the bending failure process of ice cover dominates the total ice load on the conical structure the dynamic load on the conical structure indicates that a complete ice load period generally includes two steps loading and unloading as shown in fig 8 during the loading process the ice cover interacts with the structure directly and continuously in the unloading process the broken ice climbs along structure and drop into water eventually hence both the dynamic ice loads in the dem simulation and the hsva test change periodically the red dots present the peak forces for each ice load period in fig 8 here we compare the mean and maximum values of the peak force in dem simulations and hsva tests here f max is the maximum value of the ice load during the simulation and f mean is the mean value of all selected peak forces as marked in red in fig 8 the breaking period of sea ice t represents the average time interval between two peaks the two comparison results are listed in table 2 which shows that they are quite close it can also be found that the ice load periods obtained with hsva model test and dem simulation are not the same exactly since the random characteristics of dynamic ice load nevertheless the basic features of ice load on conical structure can still be obtained from the dem results fig 9 shows the power spectral density psd of the time history curve of the ice load obtained from the hsva test and dem simulation the psd is generally fourier transform of time domain signals and then the spectrum energy distribution map of frequency domain can be obtained qu et al 2006 the energy of the ice load is concentrated in the frequency band of 0 2 hz 4 hz the dominant frequency corresponding to the psd curve of hsva test is 0 98 hz the dominant frequency corresponding to the psd curve of dem simulation is 0 78 hz the results show that the dominant frequencies of the two ice loads are close the above analysis of peak ice load sea ice breaking period and main frequency shows that the dem is a valid approach to simulate the ice cone interactions and calculate the ice loads 4 influence factors on ice load and breaking length of ice cover the breaking length of sea ice is an important parameter to characterize its failure mode it is also closely related to the amplitude and period of ice load on cone in order to analyze the influencing factors of breaking length and ice load the related parameters of cone structure and sea ice are simulated by using the method of control variables according to the hsva model test the dem results are compared with those of hsva test and field measurement in the bohai sea finally the static ice force formula of the narrow cone can be summarized considering ice thickness ice velocity cone diameter and other factors the other main parameters in the dem simulations are selected as the values listed in table 1 4 1 influence of ice thickness the ice thickness has obvious effect on the breaking length of sea ice during its interaction with conical structure based on the field tests yue and bi 1998 proposed that the mean ratio of the breaking length to the ice thickness is 7 0 qu et al 2006 found that the ratio varies from about 1 0 to 14 0 and the mean value is 6 4 based on the field observations in the bohai sea although the range of the ratio is relatively large with the effect of the environment it is mainly concentrated in the range of 6 0 7 0 in this simulation the ice thickness is set from 0 01 m to 0 06 m the ice velocity is 0 2 m s and the cone diameter is 0 61 m when the ice thicknesses are 0 02 m and 0 05 m respectively the breaking patterns of ice cover simulated with dem are plotted in fig 10 the results show that the size of ice fragments and its accumulation in front of the cone decreases with the decrease of ice thickness fig 11 a shows the relationship between the ice breaking length and the ice thickness in the dem simulations it can be found that the ice breaking length increases with the ice thickness linearly with a slope ratio 7 0 which is similar to the measured results in the bohai sea fig 11 b shows that the ice load also increases with the ice thickness because of the contact area between ice and cone increases 4 2 influence of ice velocity in this simulation the ice thickness is 0 032 m the ice velocity is set from 0 05 m s to 0 38 m s and the cone diameter is 0 61 m the failure processes of ice cover with different ice velocities v ice are shown in fig 12 with the increase of ice velocity the size of ice fragments decreases and the number of ice fragments increases moreover these ice fragments are not easy to be cleared and thus accumulate on the surface of the structure fig 13 a shows that the ratio of ice breaking length to ice thickness can decrease with the increase of ice velocity fig 13 b shows that the ice load increases with the increased ice velocity both the dem results in fig 13 a and b are in good agreement with hsva tests xu et al 2015 the ice load simulated with dem in fig 13 b is the mean value of peak forces in the time series of ice load the decrease of the breaking length of sea ice indicates that the more cracks are generated in the ice during bending failure so it is necessary to provide more breaking energy for the ice cover which ultimately leads to the increase of the ice load acting on the structure the simulation results indicate that under a large difference of ice velocity the failure mode of ice cover can be change which leads to the different ice load 4 3 influence of cone diameter another factor affecting the breaking length of ice cover is the cone diameter at the waterline in this simulation the ice thickness is 0 032 m the ice velocity is 0 2 m s and the cone diameter is set from 0 4 m to 1 4 m the failure processes of ice simulated with dem are plotted in fig 14 when the cone diameter d 0 4 m and d 1 2 m respectively the results show that the sizes of broken ice decrease with the increase of cone diameter meanwhile ice fragments accumulate clearly when the cone diameter is larger the dem results show that the cone diameter has a significant influence on the failure process of sea ice for the smaller cone diameter the ice cover has radial cracks first and then shows circumferential cracks as shown in fig 15 a and b under this condition the ice cover breaks into wedge shaped fragments for the larger cone diameter the ice cover breaks with circumferential cracks first and then radial cracks as shown in fig 15 c and d under this condition the sea ice cover breaks into smaller plate shaped fragments comparing the two ice failure modes it can be found that the cone diameter can change the mode of ice crack formation when the cone diameter is large the breaking length of the ice under plate shaped failure is smaller and the number of the ice fragments is larger the sea ice fragments cannot be removed in time and is more likely to accumulate in front of the cone with a larger diameter generally the cone type can be classified as the wide cone and narrow cone by checking whether the sea ice accumulates in front of the cone yue et al 2007 for the ice load on the wide cone the influence of both the ice breaking force and the climbing force are considered simultaneously while the ice breaking force is considered only for the ice load on the narrow cone in fact whether the accumulation of ice fragments occurs is caused by the different ways of crack propagation after the interaction of sea ice and cone therefore the ice breaking cone can also be defined as wide or narrow cone according to the breaking mode of ice cover for the narrow ice breaking cone radial cracks are generated in ice cover firstly during the interaction between ice cover and cone for the wide ice breaking cone circumferential cracks are generated firstly in the ice cover the crack generation mode in ice cover is dominated with the parameters of angle and diameter of cone ice thickness strength of ice cover in this study we mainly work on the breaking characteristics of ice cover and ice load on the narrow conical structure the transition of ice breaking mode will be studied in details considering the influence of cone diameter in the next work fig 16 a indicates the relationship between the breaking length and cone diameter at the waterline in this figure the measured results in the bohai sea and hsva experiments are also plotted to validate the dem results the comparison illustrates that dem results have good agreement with the data of field observation and model experiment fig 16 b shows the ice load increases with the increase of cone diameter therefore the influence of cone diameter on ice load is not only related to the contact area of sea ice and structure but also to the failure mode of sea ice 4 4 influence of cone angle the influence of ice thickness ice velocity and cone diameter on ice loads above are simulated with the constant cone angle of 60 to study the influence of cone angle on the ice load the cone angle is set to change from 40 to 80 and the other parameters are referred to the simulation in section 3 3 from fig 17 it can be seen that the ice cover is broken into larger fragments under bending failure mode when the cone angle is small the mean size of broken ice fragments decreases with increasing the cone angle as shown in fig 18 a fig 18 b shows that the ice load increases gradually with the increase of cone angle and the ice load with 80 cone angle can be 6 times larger than that with 60 cone angle the breaking length of ice cover decreases and the ice load increases significantly due to the difference of ice failure mode especially when the cone angle exceeds 65 comparing with the larger cone angle more than 65 the ice load on conical structure increases slowly during in the range of 45 60 this means the influences of cone angle on the ice load and ice breaking length are not significant under the practical range of cone angles 5 relationship between ice load and breaking length of ice cover with the analysis above we can find the breaking length of ice cover is influenced by the ice thickness ice velocity cone diameter and cone angle meanwhile with the effect of these three factors the ice load can also be changed by the breaking length of ice in engineering practice the influence of ice thickness and cone diameter on ice load is more important comparing with the hsva test result and the field measurement in the bohai sea the relationship between the ice load and the breaking length of ice acting on the cone can be determined based on the dem simulations in the hsva model tests the ice velocity of 0 38 m s can be converted to the actual ice velocity 2 28 m s when the scaling factor is 6 0 xu et al 2015 during the field observations in the bohai sea the mean ice velocity is about 0 4 m s and cannot exceed 0 8 m s normally since the ice velocity measured in the bohai sea has a small variation range the influence of ice velocity on ice load and ice failure mode can be ignored in the calculation of the ice load on narrow cone in this study during the interaction of ice and narrow cones the broken ice will not be accumulated in front of the narrow conical structure as it can be removed quickly for the narrow conical structure the ice load is induced mainly by the bending failure of the ice cover the empirical formula of static ice load on the narrow conical structure has been established with physical experiments by hirayama and obara 1986 written as 6 f ice k σ f h ice 2 d l b α where k and α are empirical constants σ f is the flexural strength of sea ice eq 6 can also be applied to determine the maximum ice load for the dynamic ice load on conical structure here the parameters k and α are determined based on the dem simulations in fig 19 the dem results and the data obtained from the field measurements in the bohai sea and the model experiments in hsva are plotted together li et al 2009 xu et al 2015 it shows that the variation trend of ice load with d l b obtained by the three methods is close which can also verify the rationality of the empirical formula besides a fitting curve is given following the format of eq 6 with k 2 04 and α 0 34 this formula for static ice load on narrow conical structure has applicability considering the influences of ice thickness breaking length of ice cover flexural strength of sea ice and cone diameter with the change of cone angle this formula should be modified considering the influence of cone angle even this influence is not very obvious in the practical range of cone angles 6 conclusions in this paper the dem simulation is used to study the relationship between the breaking length of sea ice and ice load under the change of ice failure mode caused by different factors the computational parameters in the dem simulations are validated by comparing the dem results with the model tests in hsva the breaking length of ice cover and ice load are mainly related to the ice thickness ice velocity cone diameter at the waterline and cone angle the ice thickness has a linear relationship with the breaking length of ice cover the ratio of the breaking length to the ice thickness simulated with dem is about 7 05 which is close to the measurement on a conical jacket platform in the bohai sea with the increase of ice velocity the failure mode of sea ice will change from bending failure to crushing failure the increase of cone diameters can convert the failure mode of ice cover from the wedge shape fracture to the plate shape fracture this transformation of ice failure modes results in the decrease of ice breaking length which leads to the increase of the ice load on the conical structure only when the cone angle is greater than 65 the ice load and the ice breaking length are greatly affected finally a formula of ice load is proposed by dem simulations considering the effect of ice breaking length which can be used to calculate the ice load on a narrow cone of offshore jacket platform author contributions section in the study of this manuscript xue long gave the contributions including all cases of numerical simulations most portion of manuscript writing shewen liu gave the main idea of ice load analysis on conical structure shunying ji as the corresponding author contributed to the conception of the dem study and performed the theoretical analysis all authors have read and approved this manuscript declaration of competing interest the authors declare that they have no conflict of interest acknowledgements this study is financially supported by the national key research and development program of china grant nos 2016yfc1402706 2016ycf1401505 and 2018yfa0605902 the national natural science foundation of china grant nos 41576179 and 51639004 and dmu polar shipping and safety research institute of china grant no 3132019306 
22003,conical structures are widely used in marine engineering in ice covered area because of their icebreaking capability the ice loads acting on the conical structures are closely related to the failure modes of sea ice the discrete element method dem is adopted to simulate the ice failure modes and ice loads during the interaction between sea ice and conical structure in this study the accuracy of dem simulations is validated by comparing the simulated ice loads with the measured ice loads from the model tests in hamburg ship model basin hsva a bending failure occurs when the sea ice interacts on the conical structure and the sea ice breaks into many fragments with different breaking lengths the influence of ice thickness ice velocity cone diameter at waterline and cone angle are considered to analyze the characteristics of ice breaking length the simulation results show that the ice breaking length increases with the increase of ice thickness the increase of ice velocity and cone diameter can lead to the change of sea ice failure mode which can reduce the breaking length of sea ice and increase the ice load the decrease of ice breaking length indicates that the failure mode of sea ice changes from the bending failure to the crushing failure a static ice force formula considering the effect of ice breaking length can be proposed to predict the ice load of the structure and verify the reliability of the structure keywords discrete element method dem ice load conical structure ice breaking length ice failure mode 1 introduction the conical structure with a better ice breaking performance has been widely applied in cold regions such as jacket platforms in the bohai sea e g jz20 2 muq yue and bi 2000 confederation bridge brown et al 2010 and kemi i lighthouse brown and määttänen 2009 the failure mode of sea ice is closely related to the shape of the structures when sea ice interacts with vertical structure it can be broken into fine particles by crushing failure when sea ice interacts with conical structure it can be broken into ice fragments by bending failures sodhi 2001 timco and o brien 1994 because the compressive strength of sea ice is about 2 5 times of the flexural strength conical structures can effectively reduce ice load and ice induced structural vibration moslet 2007 shazly and prakash 2009 the amplitude and period are two key parameters of the ice load on cones which are closely related to the ice breaking length l b on the cones when the ice velocity is constant the ice load period is proportional to l b in addition the breaking length can directly reflect the failure mode of sea ice which will inevitably affect the ice load amplitude timco et al 2017 xu et al 2011 the ice load and breaking length during the interaction between ice and conical structures can be studied with different approaches including field measurements model tests theoretical analysis and numerical simulations suominen et al 2017 li et al 2018 brown et al 2010 ice thickness ice velocity cone diameter and cone angle are the important factors affecting the failure mode of sea ice during the interaction between sea ice and conical structures are studied frederking and sudom 2006 timco and weeks 2010 huang et al 2007 some measurements show that the breaking length of sea ice is about 7 05 times of the ice thickness yue et al 2007 however some tests show the ratio of the breaking length to ice thickness can be lower to 4 2 barker et al 2005 gravesen et al 2005 it is because that the breaking length can be changed by other factors such as ice velocity and structural size when the ice velocity increases the sea ice acting on the cone can also have crushing failure sodhi and haehnel 2003 the different failure modes of ice cover appear on the narrow and wide cones with the observations from model tests and field data yue and bi 2000 xu et al 2015 the wedge shaped failure mode is always observed on the cone with the small diameter and the corresponding breaking length is about 5 7 times of ice thickness the plate shaped failure mode is observed on the cone with the large diameter and the corresponding breaking length is 3 4 times of ice thickness through theoretical analysis lu et al 2016 found that the breaking length of sea ice caused by the bending failure during the action with the wide structure should be less than 2 times of its characteristic length the reasons and conditions for these factors to affect the sea ice failure mode need to be further studied moreover the empirical formula of the ice load on conical structures was established by model tests data edwards and croasdale 1976 hirayama and obara 1986 kato 1986 which can be split into two components including the breaking force of ice cover and the climbing force of broken ice the formula of ice load has to consider the factors which can affect the ice load and failure mode of sea ice such as ice strength ice thickness ice velocity and structural size parameters angle and diameter however it is difficult to fully consider all the factors in the calculation formula of ice force obtained by theoretical derivation or experimental measurement therefore these ice force formulas can only be used under specific conditions which limit their applicability in the field measurement and model test the breaking process of sea ice can only be observed from a macro perspective and it is difficult to measure the initiation and development of the cracks in sea ice therefore the advantages of numerical simulation can be highlighted which can calculate the ice load simulate the process of sea ice damage and effectively analyze the generation of sea ice cracks su et al 2010 lu et al 2016 2017 the finite element method fem has the characteristics of basic continuum theory and mature development and it has been widely acknowledged to solve engineering problems with high reliability however most of the fem software is general purpose software which is not easy to be directly used in the calculation of the interaction between sea ice and structure in recent years the coupling method of fem and dem has also been developed the two dimensional and three dimensional dem codes have been formed to simulate the ice load under various working conditions hopkins 1997 paavilainen and tuhkuri 2013 in this method the action between ice fragments is calculated by dem while the internal force inside an ice fragment is calculated by fem this method can simulate the deformation and collision of sea ice fragments in addition the cohesive element method smoothed particle hydrodynamics sph and peridynamics pd are also used in sea ice simulation lu et al 2014 wang et al 2018 staroszczyk 2017 generally these methods can obtain a reasonable ice load but the simulation of sea ice failure mode remains to be studied since the 1980s the discrete element method has been applied to the study of sea ice rheology and pancake ice dynamics shen et al 1986 dem can be used not only to simulate the collision between pancake ice at small scale but also to analyze the formation of ice ridges the generation of ice cracks and the evolution of the sea ice in the peri glacial region at mesoscale hopkins et al 2004 recently the research on the interaction between sea ice and platform structure or ship hull based on the dem has made great progress lau et al 2011 ranta et al 2018 tuhkuri and polojärvi 2018 jou et al 2019 it can reasonably simulate the failure process of sea ice and ocean structure and calculate the ice load and pressure distribution of the structure in addition it also has excellent computational performance in describing the discontinuous distribution characteristics of the shape and size of the ice floe liu and ji 2018 van den berg et al 2018 in the simulation of the sea ice with dem computational parameters can be verified by simulating the tests of ice mechanical properties such as compression bending and direct shearing ji et al 2016 polojärvi et al 2015 with the gpu parallel technology the computational efficiency and scale of dem have been greatly improved which makes it more widely used in sea ice engineering govender et al 2014 this study analyzes the breaking length of ice cover and ice load on narrow conical structures by using the gpu based dem the numerical model will be verified against the measured data obtained in the bohai sea and the model test data of hsva the influence of ice thickness ice velocity and cone diameter on the ice breaking length and the ice load on narrow conical structures are discussed using the dem results 2 discrete element method of sea ice 2 1 parallel bond model sea ice with spherical particles the spherical particles with regular packing pattern are adopted to simulate the sea ice in the dem simulation ji et al 2015 the particles are bonded with the parallel bond model as shown in fig 1 an elastic bonding disk between two particles is set to transfer the bond force and moment potyondy and cundall 2004 thus the bonding disk can be regarded as elastic springs with the constant normal and shear stiffness which are distributed over a circular disk lying on the contact plane and centered at the contact point the forces and moments in the normal direction and shear directions associated with the parallel bond are denoted by f n f s m n and m s the maxiumum normal and shear stresses acting on the bonding disk are defined based on the beam theory and can be written as 1 σ max f n a m s i r τ max f s a m n j r where r is the radius of the bonding disk a is the section area of the bonding disk i is the moment of inertia of the bonding disk section and j is the polar moment of inertia of the bonding disk section here a i and j can be written as 2 a π r 2 i 1 4 π r 4 j 1 2 π r 4 2 2 failure criterion of bonded particles the fracture process of brittle materials begins with the initiation and propagation of cracks and eventually the material is transformed from continuum to discontinuous medium an appropriate failure criterion in dem is important to describe the crack evolution and fracture patterns of ice cover the failure criterion in this study has been widely adopted for the simulation of brittle materials such as rock and concrete hentz et al 2004 wang and tonon 2010 as shown in fig 2 in the failure criterion the stress states of two bonded particles can be divided into two portions tension and compression which is determined according to the distance between the two bonded particles it is in tensile state if the distance between two particles centers is more than the sum of their radius when the maxiumum normal stress σ max exceeds the normal strength σ t or the maxiumum shear stress τ max exceeds the shear strength τ t the bonded disk will break in tensile failure or shear failure in this study the normal tensile strength σ t is defined as 3 σ t σ b n where σ b n is the normal bonding strength of the bonded particles which is a function of ice salinity temperature load rate and particle size ji et al 2016 based on the mohr coulomb criterion the shear strength τ t of bonded particles can be defined as 4 τ t σ b s μ b σ max where σ b s is the shear bonding strength of bonded particles μ b tan φ is the friction coefficient between bonded particles and φ is the friction angle of particles when the distance of two particles is less than the sum of their radius they are in compressive states under this circumstance the bonded particles will break via shear failure when the maxiumum shear stress τ max exceeds the shear strength τ t the contact force will be considered instead of the bonding force after tensile or shear failure occurs the contact force between them can be calculated with the hertz contact model dintwa et al 2008 the failure of particles leads to the development of the cracking in sea ice therefore the values of σ b n σ b s and μ b have obvious influences on the failure pattern of sea ice the ratio of the normal bonding strength to the shear bonding strength of the particle is set to 1 0 according to the studies about the simulation of brittle materials by the dem potyondy and cundall 2004 wang and tonon 2010 the relationship between the macro ice strength and the micro dem parameters σ b n σ b s and μ b is verified by the simulation of uniaxial compression test and three point bending test of sea ice long et al 2019 ji et al 2016 when the strength of sea ice is known the parameters in the bond model and failure criterion of the dem can be determined which makes the dem more suitable for simulating the failure process of sea ice 3 dem modelling and validation of ice load and ice breaking length 3 1 setup of hsva model test in dem simulations a comparison with some model tests is employed to validate the dem model of sea ice in this study the model tests in hsva were established on the ice conditions and structural parameters of jz 20 2 muq platform in the bohai sea xu et al 2015 the conical structures in the bohai sea and hsva model tests are shown in fig 3 a and b respectively fig 3 c shows the dimension of the conical structure in the hsva model test which is a small scaled size on the jacket platform in the bohai sea the scaling factor is set to reduce the actual structural parameters and sea ice parameters to the size suitable for the model test the actual ice load on the jacket platform in the bohai sea also can be calculated with the ice load in hsva test according to the scaling factor therefore the comparison between the results of dem and hsva test is also a verification of the measured data in the bohai sea the actual flexural strength of sea ice is in the range from 0 2 mpa to 1 6 mpa and the level ice thickness is in the range of 0 05 0 3 m according to the field measurement in the bohai sea ji et al 2011 in the model test when the scaling factor is set as 6 the flexural strength σ f of the model ice is 60 6 kpa the ice thickness h is 0 032 m the ice velocity v is 0 2 m s and the cone diameter at the waterline d is 0 61 m xu et al 2015 the ice cover is constructed with bonded spherical particles using regular packing pattern in dem to simulate the interaction between the sea ice and the conical structure as shown in fig 4 spring boundaries are set on three edges of the ice sheet except the edge interacting on the conical structure the stiffness between the sea ice particles and the spring boundary equals to the contact stiffness between bonded particles the stiffness in the horizontal direction is set as the normal contact stiffness between particles k n and the stiffness in the vertical direction is set as the tangential contact stiffness between particles k s the spring boundary moves with the ice sheet in the same velocity the size of ice sheet l w is 5 0 m 3 5 m the structure can be regarded as a rigid body by only considering the translation and rotation meanwhile the hydrodynamic effect on the breakage of ice cover is also very important lubbad et al 2008 in the dem simulation the hydrodynamic force is considered to simplify into buoyancy and drag force the drag force is calculated by a constant drag coefficient the buoyancy is calculated according to the volume of the particles immersed in the water and the resultant force of the buoyancy of the particles is the buoyancy of the sea ice the computational parameters of the dem simulations are directly related to the physical and mechanical properties of sea ice the study about relationship between the micro parameters in dem and the macro strengths of sea ice indicates that the particle diameter d p and the bonding strength σ b have a significant effect on the strengths of ice specimens long et al 2019 the flexural strength of ice will increase with the decreased particle diameter d p and the increased bonding strength σ b respectively the inter particle bonding strength σ b in dem can be determined with the flexural strength of sea ice σ f and the ice thickness h ice as following long et al 2019 5 σ b σ f 1 77 1 81 e h ice d p 4 78 hence the bonding strength between particles can be calculated from the flexural strength of the model ice used in hsva test the other main parameters of dem in this simulation are listed in table 1 3 2 determination of ice breaking length with dem simulations in dem simulations after the ice cover is broken the ice fragments are made up of several cohesive particle elements the size of the fragments is determined by the number and location of the particle elements contained in the fragments the determination of the ice fragments in dem simulation can be divided into two steps as shown in fig 5 the contact relationship between particles can be judged according to the position of particles and a contact neighbor list can be established as shown in table a of fig 5 the contact list is used to calculate the interaction force between particles the principle of establishing contact list is to make the particle index in list 1 always less than that in list 2 which can avoid the repetition of judging the contact relationship between particles the bonding relationship between particles is checked according to the order in which the particles contact their neighbors in the contact list and the bonding particles are marked in the bond list the particles are classified according to the bonding relationship the initial block index of each particle is set to 1 the block index of the first bonding pair can be set to 2 if any particle in second bonding pair is the same with the first one the block indexes of both particles in the second are set to 2 conversely the block indexes of the particles in the second pair are set to 3 similarly the ice block index for all particles can be determined after checking all the bonding pairs those are listed in the bond list the ice block index with only one particle is always set to 1 accordingly the block indexes of the particles in this case are listed in table b of fig 5 fig 6 a shows that the ice fragments produced during the ice structure interaction can be marked as different colors in the dem simulation the size and distribution of ice fragments can be obtained by calculating the number and position of the particles in each ice fragments the breaking length of ice cover l b can be determined as shown in fig 6 b the breaking length used in this paper is the average value of the ice breaking length at different time in the simulation this method can clearly describe the cracking process of ice cover facilitate the statistics of the size and distribution of ice fragments and analyze the failure mode of sea ice according to the breaking length of sea ice the ice cover can be broken into smaller segments with secondary breaking pattern during its interaction with conical structure the magnitude and frequency of ice load are affected obviously by the secondary breakage of ice cover lu et al 2014 3 3 validation with the hsva experiments the ice load on the conical structure is a random process since the complex failure mode of ice cover hence the accuracy of the dem parameters should be verified from two aspects the failure mode of ice cover and the dynamic process of ice load during the simulation the ice load at the current time can be calculated by the total contact force of particles acting on the structure therefore the ice load will change with the action time of the sea ice on the structure during the interaction between ice cover and conical structure the failure processes of ice cover in the hsva experiments and dem simulations are shown in fig 7 in both cases the sea ice cover performs bending failure when interacting with the cone when the internal cracks run through the ice cover the circumferential and radical cracks are both observed the broken ice fragments are pushed to climb along the structure by the subsequent ice cover and fall into the water and drift away during the climbing process of ice cover the broken ice can accumulate around the conical structure and be removed by the subsequent ice cover the failure process of ice cover in the dem simulation is similar to the model test in hsva the bending failure process of ice cover dominates the total ice load on the conical structure the dynamic load on the conical structure indicates that a complete ice load period generally includes two steps loading and unloading as shown in fig 8 during the loading process the ice cover interacts with the structure directly and continuously in the unloading process the broken ice climbs along structure and drop into water eventually hence both the dynamic ice loads in the dem simulation and the hsva test change periodically the red dots present the peak forces for each ice load period in fig 8 here we compare the mean and maximum values of the peak force in dem simulations and hsva tests here f max is the maximum value of the ice load during the simulation and f mean is the mean value of all selected peak forces as marked in red in fig 8 the breaking period of sea ice t represents the average time interval between two peaks the two comparison results are listed in table 2 which shows that they are quite close it can also be found that the ice load periods obtained with hsva model test and dem simulation are not the same exactly since the random characteristics of dynamic ice load nevertheless the basic features of ice load on conical structure can still be obtained from the dem results fig 9 shows the power spectral density psd of the time history curve of the ice load obtained from the hsva test and dem simulation the psd is generally fourier transform of time domain signals and then the spectrum energy distribution map of frequency domain can be obtained qu et al 2006 the energy of the ice load is concentrated in the frequency band of 0 2 hz 4 hz the dominant frequency corresponding to the psd curve of hsva test is 0 98 hz the dominant frequency corresponding to the psd curve of dem simulation is 0 78 hz the results show that the dominant frequencies of the two ice loads are close the above analysis of peak ice load sea ice breaking period and main frequency shows that the dem is a valid approach to simulate the ice cone interactions and calculate the ice loads 4 influence factors on ice load and breaking length of ice cover the breaking length of sea ice is an important parameter to characterize its failure mode it is also closely related to the amplitude and period of ice load on cone in order to analyze the influencing factors of breaking length and ice load the related parameters of cone structure and sea ice are simulated by using the method of control variables according to the hsva model test the dem results are compared with those of hsva test and field measurement in the bohai sea finally the static ice force formula of the narrow cone can be summarized considering ice thickness ice velocity cone diameter and other factors the other main parameters in the dem simulations are selected as the values listed in table 1 4 1 influence of ice thickness the ice thickness has obvious effect on the breaking length of sea ice during its interaction with conical structure based on the field tests yue and bi 1998 proposed that the mean ratio of the breaking length to the ice thickness is 7 0 qu et al 2006 found that the ratio varies from about 1 0 to 14 0 and the mean value is 6 4 based on the field observations in the bohai sea although the range of the ratio is relatively large with the effect of the environment it is mainly concentrated in the range of 6 0 7 0 in this simulation the ice thickness is set from 0 01 m to 0 06 m the ice velocity is 0 2 m s and the cone diameter is 0 61 m when the ice thicknesses are 0 02 m and 0 05 m respectively the breaking patterns of ice cover simulated with dem are plotted in fig 10 the results show that the size of ice fragments and its accumulation in front of the cone decreases with the decrease of ice thickness fig 11 a shows the relationship between the ice breaking length and the ice thickness in the dem simulations it can be found that the ice breaking length increases with the ice thickness linearly with a slope ratio 7 0 which is similar to the measured results in the bohai sea fig 11 b shows that the ice load also increases with the ice thickness because of the contact area between ice and cone increases 4 2 influence of ice velocity in this simulation the ice thickness is 0 032 m the ice velocity is set from 0 05 m s to 0 38 m s and the cone diameter is 0 61 m the failure processes of ice cover with different ice velocities v ice are shown in fig 12 with the increase of ice velocity the size of ice fragments decreases and the number of ice fragments increases moreover these ice fragments are not easy to be cleared and thus accumulate on the surface of the structure fig 13 a shows that the ratio of ice breaking length to ice thickness can decrease with the increase of ice velocity fig 13 b shows that the ice load increases with the increased ice velocity both the dem results in fig 13 a and b are in good agreement with hsva tests xu et al 2015 the ice load simulated with dem in fig 13 b is the mean value of peak forces in the time series of ice load the decrease of the breaking length of sea ice indicates that the more cracks are generated in the ice during bending failure so it is necessary to provide more breaking energy for the ice cover which ultimately leads to the increase of the ice load acting on the structure the simulation results indicate that under a large difference of ice velocity the failure mode of ice cover can be change which leads to the different ice load 4 3 influence of cone diameter another factor affecting the breaking length of ice cover is the cone diameter at the waterline in this simulation the ice thickness is 0 032 m the ice velocity is 0 2 m s and the cone diameter is set from 0 4 m to 1 4 m the failure processes of ice simulated with dem are plotted in fig 14 when the cone diameter d 0 4 m and d 1 2 m respectively the results show that the sizes of broken ice decrease with the increase of cone diameter meanwhile ice fragments accumulate clearly when the cone diameter is larger the dem results show that the cone diameter has a significant influence on the failure process of sea ice for the smaller cone diameter the ice cover has radial cracks first and then shows circumferential cracks as shown in fig 15 a and b under this condition the ice cover breaks into wedge shaped fragments for the larger cone diameter the ice cover breaks with circumferential cracks first and then radial cracks as shown in fig 15 c and d under this condition the sea ice cover breaks into smaller plate shaped fragments comparing the two ice failure modes it can be found that the cone diameter can change the mode of ice crack formation when the cone diameter is large the breaking length of the ice under plate shaped failure is smaller and the number of the ice fragments is larger the sea ice fragments cannot be removed in time and is more likely to accumulate in front of the cone with a larger diameter generally the cone type can be classified as the wide cone and narrow cone by checking whether the sea ice accumulates in front of the cone yue et al 2007 for the ice load on the wide cone the influence of both the ice breaking force and the climbing force are considered simultaneously while the ice breaking force is considered only for the ice load on the narrow cone in fact whether the accumulation of ice fragments occurs is caused by the different ways of crack propagation after the interaction of sea ice and cone therefore the ice breaking cone can also be defined as wide or narrow cone according to the breaking mode of ice cover for the narrow ice breaking cone radial cracks are generated in ice cover firstly during the interaction between ice cover and cone for the wide ice breaking cone circumferential cracks are generated firstly in the ice cover the crack generation mode in ice cover is dominated with the parameters of angle and diameter of cone ice thickness strength of ice cover in this study we mainly work on the breaking characteristics of ice cover and ice load on the narrow conical structure the transition of ice breaking mode will be studied in details considering the influence of cone diameter in the next work fig 16 a indicates the relationship between the breaking length and cone diameter at the waterline in this figure the measured results in the bohai sea and hsva experiments are also plotted to validate the dem results the comparison illustrates that dem results have good agreement with the data of field observation and model experiment fig 16 b shows the ice load increases with the increase of cone diameter therefore the influence of cone diameter on ice load is not only related to the contact area of sea ice and structure but also to the failure mode of sea ice 4 4 influence of cone angle the influence of ice thickness ice velocity and cone diameter on ice loads above are simulated with the constant cone angle of 60 to study the influence of cone angle on the ice load the cone angle is set to change from 40 to 80 and the other parameters are referred to the simulation in section 3 3 from fig 17 it can be seen that the ice cover is broken into larger fragments under bending failure mode when the cone angle is small the mean size of broken ice fragments decreases with increasing the cone angle as shown in fig 18 a fig 18 b shows that the ice load increases gradually with the increase of cone angle and the ice load with 80 cone angle can be 6 times larger than that with 60 cone angle the breaking length of ice cover decreases and the ice load increases significantly due to the difference of ice failure mode especially when the cone angle exceeds 65 comparing with the larger cone angle more than 65 the ice load on conical structure increases slowly during in the range of 45 60 this means the influences of cone angle on the ice load and ice breaking length are not significant under the practical range of cone angles 5 relationship between ice load and breaking length of ice cover with the analysis above we can find the breaking length of ice cover is influenced by the ice thickness ice velocity cone diameter and cone angle meanwhile with the effect of these three factors the ice load can also be changed by the breaking length of ice in engineering practice the influence of ice thickness and cone diameter on ice load is more important comparing with the hsva test result and the field measurement in the bohai sea the relationship between the ice load and the breaking length of ice acting on the cone can be determined based on the dem simulations in the hsva model tests the ice velocity of 0 38 m s can be converted to the actual ice velocity 2 28 m s when the scaling factor is 6 0 xu et al 2015 during the field observations in the bohai sea the mean ice velocity is about 0 4 m s and cannot exceed 0 8 m s normally since the ice velocity measured in the bohai sea has a small variation range the influence of ice velocity on ice load and ice failure mode can be ignored in the calculation of the ice load on narrow cone in this study during the interaction of ice and narrow cones the broken ice will not be accumulated in front of the narrow conical structure as it can be removed quickly for the narrow conical structure the ice load is induced mainly by the bending failure of the ice cover the empirical formula of static ice load on the narrow conical structure has been established with physical experiments by hirayama and obara 1986 written as 6 f ice k σ f h ice 2 d l b α where k and α are empirical constants σ f is the flexural strength of sea ice eq 6 can also be applied to determine the maximum ice load for the dynamic ice load on conical structure here the parameters k and α are determined based on the dem simulations in fig 19 the dem results and the data obtained from the field measurements in the bohai sea and the model experiments in hsva are plotted together li et al 2009 xu et al 2015 it shows that the variation trend of ice load with d l b obtained by the three methods is close which can also verify the rationality of the empirical formula besides a fitting curve is given following the format of eq 6 with k 2 04 and α 0 34 this formula for static ice load on narrow conical structure has applicability considering the influences of ice thickness breaking length of ice cover flexural strength of sea ice and cone diameter with the change of cone angle this formula should be modified considering the influence of cone angle even this influence is not very obvious in the practical range of cone angles 6 conclusions in this paper the dem simulation is used to study the relationship between the breaking length of sea ice and ice load under the change of ice failure mode caused by different factors the computational parameters in the dem simulations are validated by comparing the dem results with the model tests in hsva the breaking length of ice cover and ice load are mainly related to the ice thickness ice velocity cone diameter at the waterline and cone angle the ice thickness has a linear relationship with the breaking length of ice cover the ratio of the breaking length to the ice thickness simulated with dem is about 7 05 which is close to the measurement on a conical jacket platform in the bohai sea with the increase of ice velocity the failure mode of sea ice will change from bending failure to crushing failure the increase of cone diameters can convert the failure mode of ice cover from the wedge shape fracture to the plate shape fracture this transformation of ice failure modes results in the decrease of ice breaking length which leads to the increase of the ice load on the conical structure only when the cone angle is greater than 65 the ice load and the ice breaking length are greatly affected finally a formula of ice load is proposed by dem simulations considering the effect of ice breaking length which can be used to calculate the ice load on a narrow cone of offshore jacket platform author contributions section in the study of this manuscript xue long gave the contributions including all cases of numerical simulations most portion of manuscript writing shewen liu gave the main idea of ice load analysis on conical structure shunying ji as the corresponding author contributed to the conception of the dem study and performed the theoretical analysis all authors have read and approved this manuscript declaration of competing interest the authors declare that they have no conflict of interest acknowledgements this study is financially supported by the national key research and development program of china grant nos 2016yfc1402706 2016ycf1401505 and 2018yfa0605902 the national natural science foundation of china grant nos 41576179 and 51639004 and dmu polar shipping and safety research institute of china grant no 3132019306 
22004,a numerical method to compute the nonlinear fluid structure interactions fsi of yacht sails is presented in this paper the inviscid lifting line flow model is used by including a quadrature method to efficiently compute sail pressure loads the structural calculation is performed with a quasi static resolution by using a dynamic backward euler scheme in order to improve the computation convergence a specific thickness sail approach is also proposed to make the fsi solving easier the assembly of these flow and structural methods leads to a fast and robust strategy to compute nonlinear fsi on yacht sails and the proposed approach is applied on a complex semi rigid composite mainsail keywords fluid structure numerical fast robust sail membrane 1 introduction in most cases yacht sails are made of thin fabrics that can be subjected to large structural displacements and deformations due to the complex wind aerodynamic load pressure viola and flay 2011 the flying shape of sails deparday et al 2018 depends on the wind the mast and sail geometries and structural properties calì et al 2018 in addition to the rig trimming ghelardi et al 2019 similarly the wind pressure field depends on the sail shape and it is therefore necessary to consider a nonlinear coupled problem to correctly model the sails fluid structure interactions fsi physics bak and yoo 2019 fsi modeling of yacht sails has now been studying for a few years spalatelu lazar et al 2008 trimarchi et al 2009 bak et al 2013 durand et al 2014 the numerical state of the art shows that fsi solvers have been compared and validated with experiments augier et al 2012 aubin et al 2016 ghelardi et al 2018 and they are now also applied to several optimization problems ranzenbach et al 2013 sacher et al 2017 however due to the very complex aero elastic phenomena of yacht sails such nonlinear fsi computations remain challenging the modeling issues can concern the fluid and structural solvers in addition to the coupling strategy structural solvers are usually based on finite element methods while for flow solvers inviscid models fluck et al 2010 are widely used because of their fast computing time in comparison to the viscous flow ones graf et al 2014 in many cases these computations are still very expensive in addition to convergence problems sometimes as a result they are used little or not at all in industrial projects and there is a real need today for some companies to have fast and robust fsi yacht sails models for precise design processes in a moderate engineering time following the fsi model concern the present paper focuses on an original fast and robust approach to compute fsi effects on a yacht mainsail the two main methods used in this work are the lifting line theory and finite element analysis to solve fluid and structural problems respectively these procedures have also been employed for kite design of towing containers leloup et al 2014 and are presently improved and detailed in this paper specifically the proposed strategy uses the lifting line theory prandtl 1920 katz and plotkin 2001 combined with an innovative semi analytical chebyshev gauss quadrature method polyanin and manzhirov 1998 mason and handscomb 2002 eshkuvatov et al 2009 that allows efficient aerodynamic sail pressures computations regarding the structural part the present method uses the abaqus tm 2017 finite element software a quasi static resolution with a dynamic backward euler scheme hairer et al 2008 is carried out it facilitates the convergence of nonlinear static equilibrium owing to dynamic relaxation and the natural damping of scheme a standard newton raphson nonlinear static resolution is then performed to ensure the exact static convergence the sail membrane is modeled by shell elements and a specific thickness approach is employed in order to make the nonlinear sail fsi resolution solving maison et al 2017 easier the present work is applied within a large industrial project and enables sail fsi computing on a real case study indeed this project aims to develop new designs of rigid sails the main benefit of such sails concerns the life cycle which is significantly increased and then makes it possible to consider this kind of sail design for large merchant ships viola et al 2015 however the industrial design of rigid sails is a complex problem that requires accurate numerical models to avoid large weights in the top rig parts a 300 m2 mainsail prototype was built under the project and it has the specificity to be composed of 21 articulated composite panels see fig 1 each panel is set with 2 battens and it is linked to its neighbors through flexible loops at both luff and leech synchronization straps are also used in order to reduce possible relative transverse displacements the sail is to be considered as semi rigid since membranes flexibility s are close to a conventional soft sail as membrane thickness at the central part of the panel is about 0 5 mm the following sections present the computation approach for the fsi problem of the prototype mainsail and are organized as follows section 2 presents the numerical modeling methods by including the proposed fsi strategy numerical results are then reported in section 3 and finally conclusions of this work and future development paths are provided in section 4 2 numerical modeling numerical methods used to compute fsi on the prototype mainsail as shown in fig 1 are presented in this section 2 in the current work the study is limited to an upwind sailing case mast deformations are neglected and the jib is not modeled we also assume that the yacht mainsail fsi problem has a steady solution which allows us to couple flow and structural solvers with a quasi static approach the flow and structural solvers are described below 2 1 inviscid flow solver the flow solver relies on the well known lifting line theory prandtl 1920 and is firstly summarized in the following section 2 1 1 then section 2 1 2 describes the leading idea to use a semi analytical method to efficiently compute the aerodynamic sail pressure loads 2 1 1 lifting line theory the lifting line theory llt was established by prandtl 1920 based on previous lanchester 1907 research work this model allows to compute the spanwise distribution of section lift and induced drag of a three dimensional finite wing for an incompressible and inviscid flow the wing or sail is modeled as a single vortex line located at the quarter chord position and an associated shed vortex sheet fig 2 illustrates this assumption and introduces related parameters the distance y across the sail span measured from the boom the sail half span b the circulation γ y the reference flow velocity u 0 y the induced flow velocity ω i y the effective flow velocity u e y the angle of attack α y the induced angle of attack α i y and finally the effective angle of attack α e y as shown in fig 2 b the effective flow velocity and angle of attack at each sail section is affected by the three dimensional shed vortices also known as downwash effects the biot savart s law gives rise to the induced velocity definition with 1 ω i y 1 4 π b b d γ y 0 d y y y 0 d y 0 b y b and by assuming low α y values the linearization α i ω i u 0 allows the effective angle of attack computation with 2 α e y α y α i y 3 α y 1 4 π u 0 y b b d γ y 0 d y y y 0 d y 0 the lift spanwise distribution per unit length is computed by 4 l y ρ 0 u e y γ y 5 1 2 ρ 0 c y u e 2 y c l y where ρ 0 is the reference fluid density and c l y 2 π sin α e y α 0 y is the section lift coefficient the fundamental prandtl s integro differential equation is then obtained from the linearization of the kutta relation 4 and 5 it is given by 6 γ y k y c y u 0 y α y α 0 y 1 4 π u 0 y b b d γ y 0 d y y y 0 d y 0 where k y π and α 0 y is the two dimensional sail section zero lift angle by neglecting the sweep and dihedral sail effects an analytical solution of 6 can be obtained in terms of a fourier sine series glauert 1983 katz and plotkin 2001 for a given sail geometry with a known spanwise distribution of u 0 y c y α y α 0 y the circulation distribution is written as a truncated fourier series where the fourier coefficients are determined by forcing the lifting line equation to be satisfied at n specific sail sections along the span in these conditions and from the change of variables y b cos θ the circulation distribution is then given by 7 γ θ 4 b u 0 θ n 1 n a n sin n θ 0 θ π while the induced velocity is 8 ω i θ u 0 θ n 1 n n a n sin n θ sin θ finally after substituting the circulation distribution and induced angle of attack in 6 the fourier coefficient a n are determined from the relation 9 n 1 n sin n θ 4 b k θ c θ n sin θ a n α θ α 0 θ the zero lift angle of attack at each θ in 9 can be computed from the thin sections of the sail geometry indeed abbott and von doenhoff 1959 suggest the following expression to compute the zero lift angle of attack of a thin profile section 10 α 0 0 1 η c x c μ x c d x c 0 x c 1 where η c x is the profile camber law and μ x c is given by μ x c 1 π 1 x c x c 1 x c in the present work the spanwise distribution of α 0 is computed with 10 by using η c x interpolations based on chebyshev polynomials mason and handscomb 2002 from 9 the lift and induced drag coefficients are obtained with 11 c l π λ a 1 12 c d i π λ n 1 n n a n 2 where λ b 2 s is the sail aspect ratio in this form the lifting line method does not allow to evaluate the aerodynamic sail pressure loads indeed global loads such as lift and induced drag are computed by the llt but it is necessary to add a calculation step to get the aerodynamic pressures that are locally applied to the sail this step is presented in the next section 2 1 2 2 1 2 semi analytical method for the aerodynamic pressure field as shown previously the llt method alone is not able to compute the local aerodynamic sail pressure loads to do this the present work uses small disturbance flow over the two dimensional sail sections based on singularity element distributions specifically a vortex distribution based model is implemented as suggested for thin lifting airfoil by katz and plotkin 2001 a two dimensional sail section is presently considered with a camber law η c x a chord length c and an effective angle of attack α e the flow velocity is u e and vortex elements are distributed along the section chord axis the unknown vortex distribution γ x has to satisfy the zero normal flow boundary condition on the sail section in other words the flow remains tangent to the camberline and leads to following equation 13 1 2 π 0 c γ x 0 d x 0 x x 0 u e d η c x d x α e 0 x c which is the integral equation for γ x to be determined the sail section pressure differences δ p can then be computed by the steady state bernoulli equation katz and plotkin 2001 with 14 δ p x ρ 0 u e γ x the computation of γ x in 13 is now presented equation 13 is firstly rewritten in the form 15 0 c φ x 0 x 0 x d x 0 f x where φ x 0 γ x 0 2 π 0 x 0 c f x u e d η c x d x α e 0 x c from the following variables change t 2 x 0 c 1 1 t 1 χ 2 x c 1 1 χ 1 and φ t φ x 0 f χ f x equation 15 becomes 16 1 1 φ t t χ d t f χ 1 χ 1 this last equation 16 is of a specific form that is called a singular integral equation of the first kind polyanin and manzhirov 1998 if φ is unbounded in χ 1 and bounded in χ 1 to agree with the kutta condition at the trailing edge a complete analytical solution polyanin and manzhirov 1998 of 16 is given by 17 φ χ 1 π 2 1 χ 1 χ 1 1 1 t 1 t f t t χ d t 1 χ 1 however the analytical calculation cannot be performed further since the camber shape is not always given as a known function it is then necessary to rely on quadrature methods such as the chebyshev gauss ones proposed by eshkuvatov et al 2009 specifically chebyshev polynomials of the fourth kind are used to build an approximation φ n of the unknown function φ in 16 this polynomial function is defined by 18 φ n χ w χ i 0 n β i w i χ where β i are unknown coefficients the weight function w and the chebyshev polynomials w i in 18 are defined by w χ 1 χ 1 χ w i χ sin i 1 2 cos 1 χ sin 1 2 cos 1 χ substituting the approximate solution 18 in 16 gives 19 i 0 n β i 1 1 1 t 1 t w i t t χ d t f χ 1 χ 1 from the following equation mason and handscomb 2002 20 1 1 1 t 1 t w i t t χ d t π v i χ where v i are the chebyshev polynomials of the third kind given by v i χ cos i 1 2 cos 1 χ cos 1 2 cos 1 χ and by using the zeros of v n 1 polynomials given by 21 χ k cos k 1 2 π n 3 2 k 1 n 1 the β i coefficients are solved with 22 i 0 n β i v i χ k f χ k π k 1 n 1 the approximate solution of 16 is finally given by 23 φ χ w χ i 0 n β i w i χ that is used to compute sail pressure loads in 14 with 24 γ x 2 π φ 2 x c 1 0 x c 2 2 structural solver the structural model is built within the abaqus tm 2017 finite element analysis fea software this powerful commercial code is able to compute nonlinear fea over a wide range of element types using various integration schemes and including possible complex contacts under transient loads 2 2 1 numerical model the numerical model is based on the mainsail previously presented in fig 1 it is composed of 21 composite panels connected to each other thanks to spring elements see fig 3 axial spring models stiffness s k is defined as 25 k s 0 e l 0 where l 0 s 0 and e are respectively the cable length at rest the cable section area and the cable young s modulus stiffness k is computed using the mass modulus e m determined by tensile tests for dyneema sk78 cables thanks to the relation 26 k μ 0 e m l 0 where μ 0 is the mass per unit length in g m at rest and e m 1 02 10 5 j g that is relatively independent of the cable diameter the sail battens are modeled with equivalent beam stringer elements b33 and stri3 thin shell kirchhoff elements batoz et al 1980 are used for the modeling of composite panel membranes b33 are euler bernoulli beam elements that use cubic interpolation of the transverse displacement along the beam axis and do not contain any transverse shear energy stri3 are kirchhoff triangular elements that use the quadratic interpolation of normal rotation on the element and do not contain any transverse shear energy shear locking does not appear in both elements draping layers composed of carbon and glass fibers are applied on each panel from a membrane cutting plan a rigid link is applied between the luff of the panels and associated references points that can rotate and move along the rigid mast rail see fig 3 the mainsail head is hooked and the first bottom panel is linked to a rigid boom with 2 axial springs connected to 2 references points that have fixed translations and free rotations as degrees of freedom regarding the mainsail loads the gravity is taken into account and aerodynamic loads are applied by using uniform pressures on each shell element face and a consistent approach for nodal force calculation structural computations of thin sail membranes are usually complex due to nonlinear behaviours indeed sail deformations generate possible buckling related wrinkles trimarchi et al 2013 and make challenging problem solving because of numerical instabilities wrinkles models have been developed heppel 2002 wong and pellegrino 2006 durand 2012 when using membrane elements to account for local deformations with a reasonable number of elements in this work shell kirchhoff type elements that are suitable for very thin plate and not subjected to locking phenomena belytschko et al 2013 are used such elements are furthermore able to numerically reproduce the wrinkling development however because of the challenging problem solving in presence of wrinkles a specific shell thickness approach is implemented to enhance the computation stability this strategy allows to correctly capture the sail deformations by neglecting the low structural effects due to small wrinkle scales from the plate theory and under the kirchhoff hypothesis timoshenko and woinowsky krieger 1959 reddy 2014 the plates are supposed to be thin and straight lines perpendicular to the mid surface x y before deformation are supposed to remain straight after deformation by considering that the relations between stresses σ and strains ε are hooke s law the plane stress reduced constitutive equations for such thin isotropic plates can be expressed as 27 σ x x σ y y σ x y e 1 ν 2 1 ν 0 ν 1 0 0 0 1 ν ε x x ε y y ε x y where e and ν are the young s modulus and the poisson s ratio kirchhoff s kinematics reddy 2006 leads to strain decomposition as follows 28 ε ε p z χ where ε p and χ are respectively the plane strain reduced and the curvature matrix of the mid surface the forces and moments per unit length for a thin plate thickness h are given by 29 n x x n y y n x y h 2 h 2 σ x x σ y y σ x y d z m x x m y y m x y h 2 h 2 σ x x σ y y σ x y z d z and by using 27 and 28 the relations in 29 become 30 n x x n y y n x y c 1 ν 0 ν 1 0 0 0 1 ν ε p x x ε p y y ε p x y m x x m y y m x y d 1 ν 0 ν 1 0 0 0 1 ν χ x x χ y y χ x y where the extensional stiffness c and bending stiffness d are written as 31 c e h 1 ν 2 32 d e h 3 12 1 ν 2 the dimensionless ratio d c s p where s p is a reference surface of a thin plate allows to quantify the ratio of bending material stiffness to extension stiffness in nonlinear geometric consideration for a fixed s p and by modifying the thickness h the d c s p ratio can vary if it is very low the shell mechanical behavior is getting similar to the membrane one and numerical instabilities may appear during the problem solving if d c s p is large numerical instabilities drop but the shell is no more close to a membrane behavior in the present work the sail panels are of elongated shapes between the luff and the leech in addition given the overall behavior of the sail under aerodynamic loading the main bending direction of sail panels is along the chord the geometrical bending stiffness in this direction is computed with c l p 2 where l p is the averaged luff to leech panel length which leads to replace s p in the d c s p ratio by l p 2 this ratio finally only depends on h l p for homogeneous material timoshenko and woinowsky krieger 1959 a convergence study representative of a bending loading case along the main direction of sail panels has been performed on a single mainsail panel to determined the optimal d c s p value to be used in future fsi computations specifically a uniform pressure of 200 pa is imposed on the gp7 panel which is held at the luff and the leech with free rotations but no displacements see red areas in fig 4 a the d c s p ratio is then set to vary in 10 9 10 4 and the relative error between the fictive membrane and the real one in terms of maximum membrane displacement is computed this study is performed on two structural meshes having typical cell sizes d mesh of 0 05 m and 0 1 m fig 4 b illustrates the finest mesh with d mesh 0 05 m and the convergence results are reported in fig 5 a fast decrease of the relative error is seen when d c s p 10 7 10 4 while for lower ratio values than 10 7 the error appears to converge to approximately 0 in view of results presented above a good compromise of d c l p 2 10 7 was found and used to define the fictive shell thickness panels h f of the mainsail indeed the fictive shell thickness for a panel reference length l p is given by 33 h f l p 12 10 7 and the effective shell mechanical properties e g and ρ are replaced by fictive magnitudes as following in order to keep constant the membrane properties in 31 34 e f e h h f g f g h h f ρ f ρ h h f where e f g f and ρ f are respectively the fictive young s modulus the fictive shear modulus and the fictive density 2 2 2 problem solving solving the problem of fluid structure interaction on the semi rigid sail is usually not straightforward indeed this fluid structure problem is highly nonlinear and several solving strategies can be applied standard non linear procedures suggested by abaqus tm 2017 to solve global post buckling and local instabilities are the riks method powell and simons 1981 and the automatic damping stabilization with artificial viscous forces liu and gorman 1995 thanks to proportional mass rayleigh damping the first one is not perfectly adapted to solve the problem of wrinkles indeed some tests were carried out on the semi rigid composite mainsail without being successful in convergence in the second one abaqus tm 2017 uses an artificial unit mass matrix considering a unit density for all materials involved in the calculation for the computation of the artificial damping matrix this method uses a standard quasi static newton raphson approach without dynamic nodal forces and requires a calibration of the damping factor which is difficult to estimate and which must be evaluated for any modification of the mainsail material geometry pretension etc consequently an alternative procedure is suggested in this study in the present work the nonlinear problem solving is performed with a specific quasi static resolution which is not problem dependent based on a dynamic backward euler scheme hairer et al 2008 the natural damping of this scheme helps the convergence towards a nonlinear static equilibrium an initial modal analysis computation step is also carried out to extract the first natural frequency f 1 this frequency is then used to set up the total computation time t end 3 f 1 the initial time step t 0 0 05 f 1 and the minimal time step value t min t 0 10 4 that are required for the automatic time step increments rossi et al 2014 of the dynamic scheme this specific calculation time set up which is based on the expertise of the authors is an important point to succeed of computing high nonlinear quasi static problems finally a standard newton raphson nonlinear static resolution is performed to ensure the exact static convergence as shown previously in fig 3 b the initial mainsail geometry is fully flat this non deformed sail is a very complex starting configuration to perform fsi computations additionally to the fact that mainsail panels do not have any membrane pretension to overcome this the structural analysis requires a total of 7 steps detailed hereafter and performed prior to fsi iterations load case 1 the mainsail head is free to move along the mast rail all nodes are set in the same plan x z and a halyard pretension is imposed 1 linear modal analysis 2 linear static analysis 3 nonlinear implicit dynamic quasi static analysis with calculation time set up given by 1 4 nonlinear static analysis load case 2 the mainsail head is hooked planar node set and the halyard pretension are removed and a low uniform pressure field is imposed on shell element faces 5 nonlinear modal analysis 6 nonlinear implicit dynamic quasi static analysis with calculation time set up given by 5 7 nonlinear static analysis indeed a direct calculation with real boundary conditions load case 2 did not work because of too many numerical instabilities to avoid this kind of issue load case 1 was performed first to enable a smoother start of the calculation finally fsi iterations of the coupled problem see next section 2 3 can restart from the nonlinear converged static solution obtained in step 7 it should be noted that fsi iterations could have been started from the beginning of load case 2 without using a low uniform pressure field however in order to save computation time steps 5 to 7 are currently applied 2 3 coupled problem the fsi problem is solved by coupling together the abaqus tm 2017 finite element software and the lifting line flow model the numerical procedure achieved through implemented python scripts is presented below a sail delaunay triangulation is firstly performed on the unstructured node grid provided by the structural solver see fig 6 horizontal x y plane intersections with the triangulated sail are then used to extract a sail section distribution along z as it can be seen in fig 6 these sections red points are distributed along z according to a cosine law see section 2 1 1 in order to be directly transferred to the llt model the η c x camber law of each section is then fitted with chebyshev polynomials mason and handscomb 2002 and allows the computation of α 0 θ with 10 after solving 9 and computing ω i θ with 8 the aerodynamic pressure field of each sail section was determined with the semi analytical method proposed in section 2 1 2 the aerodynamic pressure field is finally computed for each structural shell element centroids by using bi linear interpolations with lagrange polynomials see fig 7 a an example of such δ p reconstruction is given in fig 7 b the nonlinear structural solving is then performed with a restart from step 7 see end of section 2 2 2 this is achieved by a first nonlinear implicit dynamic quasi static analysis and a second nonlinear static analysis from the deformed sail shape a new pressure field distribution can be computed and the iterative process is repeated until a convergence is reached in practice fsi iterations are stopped when relative differences between consecutive iterations of different relevant macroscopic mechanical parameters e g maximum displacement mainsail reaction forces strain energy etc decrease as a power law of the iteration number image 1 the full fsi computation on the semi rigid mainsail is reported in algorithm 1 for this mainsail fsi problem it is interesting to note that there is no need to use any relaxation methods on one hand and that the typical number of fsi iterations before convergence is about 5 10 on the other hand 3 fsi results in the present study an upwind point of sail is considered including a 1 6 wind power law profile hsu et al 1994 the boat and true wind speeds at a reference height of 50 m are 10 kts and 28 9 kts respectively the true wind angle is 60 deg and a boom angle of 27 3 deg were also taken into account the air density is set to ρ 0 1 225 kg m3 numerical results of the mainsail fsi problem are now presented the purpose of these results is to illustrate the quickness and robustness of the fsi approach presented in this study a mesh convergence study has been carried out to determine the required number of shell elements and is presented in section 3 1 the impact of the halyard pretension has also been investigated in terms of maximum sail displacement and reaction forces in addition to local loop and membrane shell forces results on the halyard pretension effects are presented in section 3 2 at the last section 3 3 effects of loop stiffness s are shown with in particular results on the mainsail flying shape wrinkles appearance loop forces and membrane shell forces 3 1 structural mesh convergences the convergence study is performed with 7 structural meshes having 6 249 6 755 7 924 9 895 25 574 75 418 and 126 966 shell elements respectively the corresponding average sizes of the shell elements are respectively as follows 2 m 1 25 m 0 75 m 0 5 m 0 2 m 0 1 m and 0 075 m for each one the mainsail fsi problem is solved for both 5 t and 10 t metric ton of halyard pretension and under a number of iterations set at 10 results are analyzed in terms of relative differences to the finest mesh and of relative differences between 2 consecutive fsi iterations fig 8 shows relative differences to the finest mesh for both 5 t and 10 t of halyard pretension in terms of maximum displacement u max total strain energy allse clew reaction force r clew tack reaction force r tack head reaction force r head and side force r y a convergence trend is seen to appear at the fifth mesh 0 2 m of average element size and 25 574 shell elements for both halyard pretension settings computing times needed for solving fsi problems with 10 fsi iterations on a classical 4 cpu desktop computer for the first to the seventh meshes are about 0 51 h 0 56 h 0 61 h 0 71 h 1 46 h 1 94 h and 2 42 h respectively these times are relatively low given the complex fsi problems to be solved and they can even be reduced more by reducing the number of fsi iterations indeed as shown in fig 9 where relative differences between 2 consecutive fsi iterations for the finest mesh are plotted the solving of the fsi problems appears to be already converged at the fifth or sixth iteration the robustness of the proposed approach without a need of relaxation methods is also highlighted in fig 9 where straight convergence lines in log scale are visible based on convergence results and solving times the sixth structural mesh was chosen to investigate the impact of the mainsail halyard pretension in section 3 2 3 2 impacts of the mainsail halyard pretension the mainsail halyard pretension is an important parameter and it can furthermore vary during sailing the sail flying shape will depend on this pretension as will the forces on the rig and it must therefore be taken into account during the design process in the present study clew and tack mainsail points do not have any pretension fig 10 shows global impacts of the halyard pretension when it varies from 1 25 t to 10 t it should be noted that a pretension of about 1 t is very low regarding the mainsail model weight which is presently of about 0 9 t the is linearly maximum sail displacement decreasing of about 20 when the pretension increases see fig 10 a this is related to the general decrease of the mainsail twist that also affects aerodynamic forces such as the side force r y plotted in fig 10 b which shows a linear increase of about 20 the mainsail head and tack points have a different trend as reactions forces have a linear increase from 1 25 t to approximately 5 t of pretension before a visible change in slope this change in slope is due to the low tension values in luff connections of bottom panels when the pretension is below of about 5 t above 5 t luff connections are all fully loaded and a part of the mainsail halyard pretension can pass from the head to the tack points by the luff the clew reaction force is linearly increasing with the halyard pretension when the sail is under aerodynamic pressure an internal load transfer is performed trough panel membranes from the leech to the luff this load transfer increases with the halyard pretension that produces a faster increase in reaction forces at head and tack mainsail points in comparison to the clew point fig 11 illustrates forces in panel loop connections at both luff and leech as functions of the halyard pretension and loop vertical locations force functions are plotted with colored surface contours thanks to linear interpolations of loop forces that are represented by dashed black curves this representation allows to visualize the increase of low luff force values in bottom panels locations when the halyard pretension is increasing see fig 11 a for low halyard pretensions loop forces in the last third of the mainsail height appear to be almost constant for both luff and leech then as long as the halyard pretension increases loop forces in this mainsail region are no longer constant and the luff presents a local maximum of loop forces at a height of about 25 m 63 of the overall height while it is a local minimum of loop forces for the leech this result shows the importance of considering an advanced nonlinear mainsail model to correctly capture nonlinearities that occur in structural loads the loop design must take into account both halyard pretension and loop mainsail location internal loads of mainsail panel membranes are presented in the next following figures where two halyard pretensions of 1 25 t and 10 t are considered fig 12 shows n 11 membrane stress forces direction 1 is the projection of the global x axis onto the deformed membrane surface the first half height panels appear to be more n 11 loaded and the load transfer increases from the leech to the luff are clearly visible when the halyard pretension change from 1 25 t to 10 t a diagonal direction loading starting from the leech is also shown for the first bottom panels it is a typical result of panel wrinkles phenomenon fig 13 shows n 22 membrane stress forces where direction 2 is deduced from 3 1 where direction 3 denotes the normal of the deformed membrane surface the loop forces distributions previously shown in fig 11 are also qualitatively described in addition to n 22 loads arising from loop connections it is shown that a part of n 22 goes through synchronization straps in the first half mainsail height 3 3 effects of loop stiffness s mainsail panels are linked to each other thanks to axial spring models having stiffness k see section 2 2 1 in the present section 3 3 several computations are performed to investigate possible impacts of using different cable stiffnesses this is achieved considering several dyneema sk78 cable diameters φ that are given below in table 1 calculations are carried out using a halyard pretension of 5 t fig 14 shows mainsail shapes results at fsi convergence results show that decreasing cable diameters leads to a low increase of the mainsail twist while cambers are slightly increased in the first mainsail half height loop forces along the mast are provided in fig 15 differences in results are more pronounced when varying cable diameters indeed when using a diameter of 9 mm instead of 36 mm luff loop forces are decreased of about 1000 n for z 20 m at the leech loop forces are decreased in the order on the entire height a leech force transition at z 20 m is seen when using φ 9 mm this is due to the presence of a large diagonal panel wrinkle at this height as shown in fig 16 fig 17 shows n 11 membrane stress forces onto the undeformed membrane surface the diagonal panel wrinkle formation can be seen when φ 9 mm maximum stress forces are decreased by about 30 when using a cable diameter of 9 mm instead of 36 mm these results on loop stiffness s effects show that the cable diameter choice is an important design parameter indeed large diagonal panel wrinkles may be avoided in addition to reduce membrane stress forces when reducing the cable diameter without having a large impact onto the mainsail flying shape 4 conclusion a fast and robust strategy to solve nonlinear fsi on yacht sails has been presented in this paper this study is part of a large industrial project who s purpose is to develop new designs of rigid sails a 300 m2 semi rigid composite mainsail prototype composed of 21 articulated panels was numerically modeled and the proposed solving strategy was applied for the flow solver an implemented lifting line model including a semi analytical method for the aerodynamic pressure field computation is proposed this model relies on an efficient chebyshev gauss quadrature to approximate the two dimensional vortex distribution of sail sections pressure distributions at each section are thus quickly determined and the overall mainsail pressure field is computed using linear interpolations mainsail panels are modeled by thin shell elements including a specific thickness approach to enhance the numerical stability that is possibly affected by membrane winkles the nonlinear solving is performed by a quasi static resolution with a dynamic backward euler scheme the assembly of these flow and structural methods leads to a fast and robust approach to compute nonlinear fsi on yacht sails as no relaxation methods are needed a mesh convergence study has been carried out to determine the required number of shell elements for computing the mainsail prototype fsi problem results have shown the computing efficiency of the proposed method in terms of both time and robustness impacts of the mainsail halyard pretension have also been investigated the pretension varied from 1 25 t to 10 t and overall dependent results have been shown in addition to the nonlinear response of structural connection loops these results demonstrated the robustness of the nonlinear structural method in particular for computations with low halyard pretension values last results present effects of loop stiffnesses where it has been shown that the cable diameter is an important design parameter to possibly avoid large diagonal panel wrinkle in addition to reduce membrane stress forces without having a large impact onto the mainsail flying shape an experimental campaign definition with a 50 m2 composite mainsail is on progress methods described in this paper will be applied to compute the structural response of this sail and experimental data will be used to validate the proposed fluid structure interaction method future developments will concern aerodynamic jib effects and mast deformations bak and yoo 2019 considerations the two dimensional rans lifting line method proposed by graf et al 2014 seems also promising and could be well adapted to the present work too the overall mainsail design may also be improved for example with several weight reductions through advanced optimization methods sacher et al 2018 credit authorship contribution statement matthieu sacher conceptualization methodology software writing original draft writing review editing jean baptiste leroux conceptualization methodology writing review editing alain nême conceptualization methodology writing review editing project administration funding acquisition christian jochum conceptualization methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study takes part in the solid sail 2 0 project funded by the région bretagne and approved by the pôle emc2 and the pôle mer bretagne atlantique this project involves a consortium of 3 industrial partners chantiers de l atlantique gsea design and multiplast in collaboration with ensta bretagne a graduate and post graduate school of engineering as an academic partner the chantiers de l atlantique gsea design and multiplast companies are gratefully acknowledged by the authors for their technical support and successful collaboration 
22004,a numerical method to compute the nonlinear fluid structure interactions fsi of yacht sails is presented in this paper the inviscid lifting line flow model is used by including a quadrature method to efficiently compute sail pressure loads the structural calculation is performed with a quasi static resolution by using a dynamic backward euler scheme in order to improve the computation convergence a specific thickness sail approach is also proposed to make the fsi solving easier the assembly of these flow and structural methods leads to a fast and robust strategy to compute nonlinear fsi on yacht sails and the proposed approach is applied on a complex semi rigid composite mainsail keywords fluid structure numerical fast robust sail membrane 1 introduction in most cases yacht sails are made of thin fabrics that can be subjected to large structural displacements and deformations due to the complex wind aerodynamic load pressure viola and flay 2011 the flying shape of sails deparday et al 2018 depends on the wind the mast and sail geometries and structural properties calì et al 2018 in addition to the rig trimming ghelardi et al 2019 similarly the wind pressure field depends on the sail shape and it is therefore necessary to consider a nonlinear coupled problem to correctly model the sails fluid structure interactions fsi physics bak and yoo 2019 fsi modeling of yacht sails has now been studying for a few years spalatelu lazar et al 2008 trimarchi et al 2009 bak et al 2013 durand et al 2014 the numerical state of the art shows that fsi solvers have been compared and validated with experiments augier et al 2012 aubin et al 2016 ghelardi et al 2018 and they are now also applied to several optimization problems ranzenbach et al 2013 sacher et al 2017 however due to the very complex aero elastic phenomena of yacht sails such nonlinear fsi computations remain challenging the modeling issues can concern the fluid and structural solvers in addition to the coupling strategy structural solvers are usually based on finite element methods while for flow solvers inviscid models fluck et al 2010 are widely used because of their fast computing time in comparison to the viscous flow ones graf et al 2014 in many cases these computations are still very expensive in addition to convergence problems sometimes as a result they are used little or not at all in industrial projects and there is a real need today for some companies to have fast and robust fsi yacht sails models for precise design processes in a moderate engineering time following the fsi model concern the present paper focuses on an original fast and robust approach to compute fsi effects on a yacht mainsail the two main methods used in this work are the lifting line theory and finite element analysis to solve fluid and structural problems respectively these procedures have also been employed for kite design of towing containers leloup et al 2014 and are presently improved and detailed in this paper specifically the proposed strategy uses the lifting line theory prandtl 1920 katz and plotkin 2001 combined with an innovative semi analytical chebyshev gauss quadrature method polyanin and manzhirov 1998 mason and handscomb 2002 eshkuvatov et al 2009 that allows efficient aerodynamic sail pressures computations regarding the structural part the present method uses the abaqus tm 2017 finite element software a quasi static resolution with a dynamic backward euler scheme hairer et al 2008 is carried out it facilitates the convergence of nonlinear static equilibrium owing to dynamic relaxation and the natural damping of scheme a standard newton raphson nonlinear static resolution is then performed to ensure the exact static convergence the sail membrane is modeled by shell elements and a specific thickness approach is employed in order to make the nonlinear sail fsi resolution solving maison et al 2017 easier the present work is applied within a large industrial project and enables sail fsi computing on a real case study indeed this project aims to develop new designs of rigid sails the main benefit of such sails concerns the life cycle which is significantly increased and then makes it possible to consider this kind of sail design for large merchant ships viola et al 2015 however the industrial design of rigid sails is a complex problem that requires accurate numerical models to avoid large weights in the top rig parts a 300 m2 mainsail prototype was built under the project and it has the specificity to be composed of 21 articulated composite panels see fig 1 each panel is set with 2 battens and it is linked to its neighbors through flexible loops at both luff and leech synchronization straps are also used in order to reduce possible relative transverse displacements the sail is to be considered as semi rigid since membranes flexibility s are close to a conventional soft sail as membrane thickness at the central part of the panel is about 0 5 mm the following sections present the computation approach for the fsi problem of the prototype mainsail and are organized as follows section 2 presents the numerical modeling methods by including the proposed fsi strategy numerical results are then reported in section 3 and finally conclusions of this work and future development paths are provided in section 4 2 numerical modeling numerical methods used to compute fsi on the prototype mainsail as shown in fig 1 are presented in this section 2 in the current work the study is limited to an upwind sailing case mast deformations are neglected and the jib is not modeled we also assume that the yacht mainsail fsi problem has a steady solution which allows us to couple flow and structural solvers with a quasi static approach the flow and structural solvers are described below 2 1 inviscid flow solver the flow solver relies on the well known lifting line theory prandtl 1920 and is firstly summarized in the following section 2 1 1 then section 2 1 2 describes the leading idea to use a semi analytical method to efficiently compute the aerodynamic sail pressure loads 2 1 1 lifting line theory the lifting line theory llt was established by prandtl 1920 based on previous lanchester 1907 research work this model allows to compute the spanwise distribution of section lift and induced drag of a three dimensional finite wing for an incompressible and inviscid flow the wing or sail is modeled as a single vortex line located at the quarter chord position and an associated shed vortex sheet fig 2 illustrates this assumption and introduces related parameters the distance y across the sail span measured from the boom the sail half span b the circulation γ y the reference flow velocity u 0 y the induced flow velocity ω i y the effective flow velocity u e y the angle of attack α y the induced angle of attack α i y and finally the effective angle of attack α e y as shown in fig 2 b the effective flow velocity and angle of attack at each sail section is affected by the three dimensional shed vortices also known as downwash effects the biot savart s law gives rise to the induced velocity definition with 1 ω i y 1 4 π b b d γ y 0 d y y y 0 d y 0 b y b and by assuming low α y values the linearization α i ω i u 0 allows the effective angle of attack computation with 2 α e y α y α i y 3 α y 1 4 π u 0 y b b d γ y 0 d y y y 0 d y 0 the lift spanwise distribution per unit length is computed by 4 l y ρ 0 u e y γ y 5 1 2 ρ 0 c y u e 2 y c l y where ρ 0 is the reference fluid density and c l y 2 π sin α e y α 0 y is the section lift coefficient the fundamental prandtl s integro differential equation is then obtained from the linearization of the kutta relation 4 and 5 it is given by 6 γ y k y c y u 0 y α y α 0 y 1 4 π u 0 y b b d γ y 0 d y y y 0 d y 0 where k y π and α 0 y is the two dimensional sail section zero lift angle by neglecting the sweep and dihedral sail effects an analytical solution of 6 can be obtained in terms of a fourier sine series glauert 1983 katz and plotkin 2001 for a given sail geometry with a known spanwise distribution of u 0 y c y α y α 0 y the circulation distribution is written as a truncated fourier series where the fourier coefficients are determined by forcing the lifting line equation to be satisfied at n specific sail sections along the span in these conditions and from the change of variables y b cos θ the circulation distribution is then given by 7 γ θ 4 b u 0 θ n 1 n a n sin n θ 0 θ π while the induced velocity is 8 ω i θ u 0 θ n 1 n n a n sin n θ sin θ finally after substituting the circulation distribution and induced angle of attack in 6 the fourier coefficient a n are determined from the relation 9 n 1 n sin n θ 4 b k θ c θ n sin θ a n α θ α 0 θ the zero lift angle of attack at each θ in 9 can be computed from the thin sections of the sail geometry indeed abbott and von doenhoff 1959 suggest the following expression to compute the zero lift angle of attack of a thin profile section 10 α 0 0 1 η c x c μ x c d x c 0 x c 1 where η c x is the profile camber law and μ x c is given by μ x c 1 π 1 x c x c 1 x c in the present work the spanwise distribution of α 0 is computed with 10 by using η c x interpolations based on chebyshev polynomials mason and handscomb 2002 from 9 the lift and induced drag coefficients are obtained with 11 c l π λ a 1 12 c d i π λ n 1 n n a n 2 where λ b 2 s is the sail aspect ratio in this form the lifting line method does not allow to evaluate the aerodynamic sail pressure loads indeed global loads such as lift and induced drag are computed by the llt but it is necessary to add a calculation step to get the aerodynamic pressures that are locally applied to the sail this step is presented in the next section 2 1 2 2 1 2 semi analytical method for the aerodynamic pressure field as shown previously the llt method alone is not able to compute the local aerodynamic sail pressure loads to do this the present work uses small disturbance flow over the two dimensional sail sections based on singularity element distributions specifically a vortex distribution based model is implemented as suggested for thin lifting airfoil by katz and plotkin 2001 a two dimensional sail section is presently considered with a camber law η c x a chord length c and an effective angle of attack α e the flow velocity is u e and vortex elements are distributed along the section chord axis the unknown vortex distribution γ x has to satisfy the zero normal flow boundary condition on the sail section in other words the flow remains tangent to the camberline and leads to following equation 13 1 2 π 0 c γ x 0 d x 0 x x 0 u e d η c x d x α e 0 x c which is the integral equation for γ x to be determined the sail section pressure differences δ p can then be computed by the steady state bernoulli equation katz and plotkin 2001 with 14 δ p x ρ 0 u e γ x the computation of γ x in 13 is now presented equation 13 is firstly rewritten in the form 15 0 c φ x 0 x 0 x d x 0 f x where φ x 0 γ x 0 2 π 0 x 0 c f x u e d η c x d x α e 0 x c from the following variables change t 2 x 0 c 1 1 t 1 χ 2 x c 1 1 χ 1 and φ t φ x 0 f χ f x equation 15 becomes 16 1 1 φ t t χ d t f χ 1 χ 1 this last equation 16 is of a specific form that is called a singular integral equation of the first kind polyanin and manzhirov 1998 if φ is unbounded in χ 1 and bounded in χ 1 to agree with the kutta condition at the trailing edge a complete analytical solution polyanin and manzhirov 1998 of 16 is given by 17 φ χ 1 π 2 1 χ 1 χ 1 1 1 t 1 t f t t χ d t 1 χ 1 however the analytical calculation cannot be performed further since the camber shape is not always given as a known function it is then necessary to rely on quadrature methods such as the chebyshev gauss ones proposed by eshkuvatov et al 2009 specifically chebyshev polynomials of the fourth kind are used to build an approximation φ n of the unknown function φ in 16 this polynomial function is defined by 18 φ n χ w χ i 0 n β i w i χ where β i are unknown coefficients the weight function w and the chebyshev polynomials w i in 18 are defined by w χ 1 χ 1 χ w i χ sin i 1 2 cos 1 χ sin 1 2 cos 1 χ substituting the approximate solution 18 in 16 gives 19 i 0 n β i 1 1 1 t 1 t w i t t χ d t f χ 1 χ 1 from the following equation mason and handscomb 2002 20 1 1 1 t 1 t w i t t χ d t π v i χ where v i are the chebyshev polynomials of the third kind given by v i χ cos i 1 2 cos 1 χ cos 1 2 cos 1 χ and by using the zeros of v n 1 polynomials given by 21 χ k cos k 1 2 π n 3 2 k 1 n 1 the β i coefficients are solved with 22 i 0 n β i v i χ k f χ k π k 1 n 1 the approximate solution of 16 is finally given by 23 φ χ w χ i 0 n β i w i χ that is used to compute sail pressure loads in 14 with 24 γ x 2 π φ 2 x c 1 0 x c 2 2 structural solver the structural model is built within the abaqus tm 2017 finite element analysis fea software this powerful commercial code is able to compute nonlinear fea over a wide range of element types using various integration schemes and including possible complex contacts under transient loads 2 2 1 numerical model the numerical model is based on the mainsail previously presented in fig 1 it is composed of 21 composite panels connected to each other thanks to spring elements see fig 3 axial spring models stiffness s k is defined as 25 k s 0 e l 0 where l 0 s 0 and e are respectively the cable length at rest the cable section area and the cable young s modulus stiffness k is computed using the mass modulus e m determined by tensile tests for dyneema sk78 cables thanks to the relation 26 k μ 0 e m l 0 where μ 0 is the mass per unit length in g m at rest and e m 1 02 10 5 j g that is relatively independent of the cable diameter the sail battens are modeled with equivalent beam stringer elements b33 and stri3 thin shell kirchhoff elements batoz et al 1980 are used for the modeling of composite panel membranes b33 are euler bernoulli beam elements that use cubic interpolation of the transverse displacement along the beam axis and do not contain any transverse shear energy stri3 are kirchhoff triangular elements that use the quadratic interpolation of normal rotation on the element and do not contain any transverse shear energy shear locking does not appear in both elements draping layers composed of carbon and glass fibers are applied on each panel from a membrane cutting plan a rigid link is applied between the luff of the panels and associated references points that can rotate and move along the rigid mast rail see fig 3 the mainsail head is hooked and the first bottom panel is linked to a rigid boom with 2 axial springs connected to 2 references points that have fixed translations and free rotations as degrees of freedom regarding the mainsail loads the gravity is taken into account and aerodynamic loads are applied by using uniform pressures on each shell element face and a consistent approach for nodal force calculation structural computations of thin sail membranes are usually complex due to nonlinear behaviours indeed sail deformations generate possible buckling related wrinkles trimarchi et al 2013 and make challenging problem solving because of numerical instabilities wrinkles models have been developed heppel 2002 wong and pellegrino 2006 durand 2012 when using membrane elements to account for local deformations with a reasonable number of elements in this work shell kirchhoff type elements that are suitable for very thin plate and not subjected to locking phenomena belytschko et al 2013 are used such elements are furthermore able to numerically reproduce the wrinkling development however because of the challenging problem solving in presence of wrinkles a specific shell thickness approach is implemented to enhance the computation stability this strategy allows to correctly capture the sail deformations by neglecting the low structural effects due to small wrinkle scales from the plate theory and under the kirchhoff hypothesis timoshenko and woinowsky krieger 1959 reddy 2014 the plates are supposed to be thin and straight lines perpendicular to the mid surface x y before deformation are supposed to remain straight after deformation by considering that the relations between stresses σ and strains ε are hooke s law the plane stress reduced constitutive equations for such thin isotropic plates can be expressed as 27 σ x x σ y y σ x y e 1 ν 2 1 ν 0 ν 1 0 0 0 1 ν ε x x ε y y ε x y where e and ν are the young s modulus and the poisson s ratio kirchhoff s kinematics reddy 2006 leads to strain decomposition as follows 28 ε ε p z χ where ε p and χ are respectively the plane strain reduced and the curvature matrix of the mid surface the forces and moments per unit length for a thin plate thickness h are given by 29 n x x n y y n x y h 2 h 2 σ x x σ y y σ x y d z m x x m y y m x y h 2 h 2 σ x x σ y y σ x y z d z and by using 27 and 28 the relations in 29 become 30 n x x n y y n x y c 1 ν 0 ν 1 0 0 0 1 ν ε p x x ε p y y ε p x y m x x m y y m x y d 1 ν 0 ν 1 0 0 0 1 ν χ x x χ y y χ x y where the extensional stiffness c and bending stiffness d are written as 31 c e h 1 ν 2 32 d e h 3 12 1 ν 2 the dimensionless ratio d c s p where s p is a reference surface of a thin plate allows to quantify the ratio of bending material stiffness to extension stiffness in nonlinear geometric consideration for a fixed s p and by modifying the thickness h the d c s p ratio can vary if it is very low the shell mechanical behavior is getting similar to the membrane one and numerical instabilities may appear during the problem solving if d c s p is large numerical instabilities drop but the shell is no more close to a membrane behavior in the present work the sail panels are of elongated shapes between the luff and the leech in addition given the overall behavior of the sail under aerodynamic loading the main bending direction of sail panels is along the chord the geometrical bending stiffness in this direction is computed with c l p 2 where l p is the averaged luff to leech panel length which leads to replace s p in the d c s p ratio by l p 2 this ratio finally only depends on h l p for homogeneous material timoshenko and woinowsky krieger 1959 a convergence study representative of a bending loading case along the main direction of sail panels has been performed on a single mainsail panel to determined the optimal d c s p value to be used in future fsi computations specifically a uniform pressure of 200 pa is imposed on the gp7 panel which is held at the luff and the leech with free rotations but no displacements see red areas in fig 4 a the d c s p ratio is then set to vary in 10 9 10 4 and the relative error between the fictive membrane and the real one in terms of maximum membrane displacement is computed this study is performed on two structural meshes having typical cell sizes d mesh of 0 05 m and 0 1 m fig 4 b illustrates the finest mesh with d mesh 0 05 m and the convergence results are reported in fig 5 a fast decrease of the relative error is seen when d c s p 10 7 10 4 while for lower ratio values than 10 7 the error appears to converge to approximately 0 in view of results presented above a good compromise of d c l p 2 10 7 was found and used to define the fictive shell thickness panels h f of the mainsail indeed the fictive shell thickness for a panel reference length l p is given by 33 h f l p 12 10 7 and the effective shell mechanical properties e g and ρ are replaced by fictive magnitudes as following in order to keep constant the membrane properties in 31 34 e f e h h f g f g h h f ρ f ρ h h f where e f g f and ρ f are respectively the fictive young s modulus the fictive shear modulus and the fictive density 2 2 2 problem solving solving the problem of fluid structure interaction on the semi rigid sail is usually not straightforward indeed this fluid structure problem is highly nonlinear and several solving strategies can be applied standard non linear procedures suggested by abaqus tm 2017 to solve global post buckling and local instabilities are the riks method powell and simons 1981 and the automatic damping stabilization with artificial viscous forces liu and gorman 1995 thanks to proportional mass rayleigh damping the first one is not perfectly adapted to solve the problem of wrinkles indeed some tests were carried out on the semi rigid composite mainsail without being successful in convergence in the second one abaqus tm 2017 uses an artificial unit mass matrix considering a unit density for all materials involved in the calculation for the computation of the artificial damping matrix this method uses a standard quasi static newton raphson approach without dynamic nodal forces and requires a calibration of the damping factor which is difficult to estimate and which must be evaluated for any modification of the mainsail material geometry pretension etc consequently an alternative procedure is suggested in this study in the present work the nonlinear problem solving is performed with a specific quasi static resolution which is not problem dependent based on a dynamic backward euler scheme hairer et al 2008 the natural damping of this scheme helps the convergence towards a nonlinear static equilibrium an initial modal analysis computation step is also carried out to extract the first natural frequency f 1 this frequency is then used to set up the total computation time t end 3 f 1 the initial time step t 0 0 05 f 1 and the minimal time step value t min t 0 10 4 that are required for the automatic time step increments rossi et al 2014 of the dynamic scheme this specific calculation time set up which is based on the expertise of the authors is an important point to succeed of computing high nonlinear quasi static problems finally a standard newton raphson nonlinear static resolution is performed to ensure the exact static convergence as shown previously in fig 3 b the initial mainsail geometry is fully flat this non deformed sail is a very complex starting configuration to perform fsi computations additionally to the fact that mainsail panels do not have any membrane pretension to overcome this the structural analysis requires a total of 7 steps detailed hereafter and performed prior to fsi iterations load case 1 the mainsail head is free to move along the mast rail all nodes are set in the same plan x z and a halyard pretension is imposed 1 linear modal analysis 2 linear static analysis 3 nonlinear implicit dynamic quasi static analysis with calculation time set up given by 1 4 nonlinear static analysis load case 2 the mainsail head is hooked planar node set and the halyard pretension are removed and a low uniform pressure field is imposed on shell element faces 5 nonlinear modal analysis 6 nonlinear implicit dynamic quasi static analysis with calculation time set up given by 5 7 nonlinear static analysis indeed a direct calculation with real boundary conditions load case 2 did not work because of too many numerical instabilities to avoid this kind of issue load case 1 was performed first to enable a smoother start of the calculation finally fsi iterations of the coupled problem see next section 2 3 can restart from the nonlinear converged static solution obtained in step 7 it should be noted that fsi iterations could have been started from the beginning of load case 2 without using a low uniform pressure field however in order to save computation time steps 5 to 7 are currently applied 2 3 coupled problem the fsi problem is solved by coupling together the abaqus tm 2017 finite element software and the lifting line flow model the numerical procedure achieved through implemented python scripts is presented below a sail delaunay triangulation is firstly performed on the unstructured node grid provided by the structural solver see fig 6 horizontal x y plane intersections with the triangulated sail are then used to extract a sail section distribution along z as it can be seen in fig 6 these sections red points are distributed along z according to a cosine law see section 2 1 1 in order to be directly transferred to the llt model the η c x camber law of each section is then fitted with chebyshev polynomials mason and handscomb 2002 and allows the computation of α 0 θ with 10 after solving 9 and computing ω i θ with 8 the aerodynamic pressure field of each sail section was determined with the semi analytical method proposed in section 2 1 2 the aerodynamic pressure field is finally computed for each structural shell element centroids by using bi linear interpolations with lagrange polynomials see fig 7 a an example of such δ p reconstruction is given in fig 7 b the nonlinear structural solving is then performed with a restart from step 7 see end of section 2 2 2 this is achieved by a first nonlinear implicit dynamic quasi static analysis and a second nonlinear static analysis from the deformed sail shape a new pressure field distribution can be computed and the iterative process is repeated until a convergence is reached in practice fsi iterations are stopped when relative differences between consecutive iterations of different relevant macroscopic mechanical parameters e g maximum displacement mainsail reaction forces strain energy etc decrease as a power law of the iteration number image 1 the full fsi computation on the semi rigid mainsail is reported in algorithm 1 for this mainsail fsi problem it is interesting to note that there is no need to use any relaxation methods on one hand and that the typical number of fsi iterations before convergence is about 5 10 on the other hand 3 fsi results in the present study an upwind point of sail is considered including a 1 6 wind power law profile hsu et al 1994 the boat and true wind speeds at a reference height of 50 m are 10 kts and 28 9 kts respectively the true wind angle is 60 deg and a boom angle of 27 3 deg were also taken into account the air density is set to ρ 0 1 225 kg m3 numerical results of the mainsail fsi problem are now presented the purpose of these results is to illustrate the quickness and robustness of the fsi approach presented in this study a mesh convergence study has been carried out to determine the required number of shell elements and is presented in section 3 1 the impact of the halyard pretension has also been investigated in terms of maximum sail displacement and reaction forces in addition to local loop and membrane shell forces results on the halyard pretension effects are presented in section 3 2 at the last section 3 3 effects of loop stiffness s are shown with in particular results on the mainsail flying shape wrinkles appearance loop forces and membrane shell forces 3 1 structural mesh convergences the convergence study is performed with 7 structural meshes having 6 249 6 755 7 924 9 895 25 574 75 418 and 126 966 shell elements respectively the corresponding average sizes of the shell elements are respectively as follows 2 m 1 25 m 0 75 m 0 5 m 0 2 m 0 1 m and 0 075 m for each one the mainsail fsi problem is solved for both 5 t and 10 t metric ton of halyard pretension and under a number of iterations set at 10 results are analyzed in terms of relative differences to the finest mesh and of relative differences between 2 consecutive fsi iterations fig 8 shows relative differences to the finest mesh for both 5 t and 10 t of halyard pretension in terms of maximum displacement u max total strain energy allse clew reaction force r clew tack reaction force r tack head reaction force r head and side force r y a convergence trend is seen to appear at the fifth mesh 0 2 m of average element size and 25 574 shell elements for both halyard pretension settings computing times needed for solving fsi problems with 10 fsi iterations on a classical 4 cpu desktop computer for the first to the seventh meshes are about 0 51 h 0 56 h 0 61 h 0 71 h 1 46 h 1 94 h and 2 42 h respectively these times are relatively low given the complex fsi problems to be solved and they can even be reduced more by reducing the number of fsi iterations indeed as shown in fig 9 where relative differences between 2 consecutive fsi iterations for the finest mesh are plotted the solving of the fsi problems appears to be already converged at the fifth or sixth iteration the robustness of the proposed approach without a need of relaxation methods is also highlighted in fig 9 where straight convergence lines in log scale are visible based on convergence results and solving times the sixth structural mesh was chosen to investigate the impact of the mainsail halyard pretension in section 3 2 3 2 impacts of the mainsail halyard pretension the mainsail halyard pretension is an important parameter and it can furthermore vary during sailing the sail flying shape will depend on this pretension as will the forces on the rig and it must therefore be taken into account during the design process in the present study clew and tack mainsail points do not have any pretension fig 10 shows global impacts of the halyard pretension when it varies from 1 25 t to 10 t it should be noted that a pretension of about 1 t is very low regarding the mainsail model weight which is presently of about 0 9 t the is linearly maximum sail displacement decreasing of about 20 when the pretension increases see fig 10 a this is related to the general decrease of the mainsail twist that also affects aerodynamic forces such as the side force r y plotted in fig 10 b which shows a linear increase of about 20 the mainsail head and tack points have a different trend as reactions forces have a linear increase from 1 25 t to approximately 5 t of pretension before a visible change in slope this change in slope is due to the low tension values in luff connections of bottom panels when the pretension is below of about 5 t above 5 t luff connections are all fully loaded and a part of the mainsail halyard pretension can pass from the head to the tack points by the luff the clew reaction force is linearly increasing with the halyard pretension when the sail is under aerodynamic pressure an internal load transfer is performed trough panel membranes from the leech to the luff this load transfer increases with the halyard pretension that produces a faster increase in reaction forces at head and tack mainsail points in comparison to the clew point fig 11 illustrates forces in panel loop connections at both luff and leech as functions of the halyard pretension and loop vertical locations force functions are plotted with colored surface contours thanks to linear interpolations of loop forces that are represented by dashed black curves this representation allows to visualize the increase of low luff force values in bottom panels locations when the halyard pretension is increasing see fig 11 a for low halyard pretensions loop forces in the last third of the mainsail height appear to be almost constant for both luff and leech then as long as the halyard pretension increases loop forces in this mainsail region are no longer constant and the luff presents a local maximum of loop forces at a height of about 25 m 63 of the overall height while it is a local minimum of loop forces for the leech this result shows the importance of considering an advanced nonlinear mainsail model to correctly capture nonlinearities that occur in structural loads the loop design must take into account both halyard pretension and loop mainsail location internal loads of mainsail panel membranes are presented in the next following figures where two halyard pretensions of 1 25 t and 10 t are considered fig 12 shows n 11 membrane stress forces direction 1 is the projection of the global x axis onto the deformed membrane surface the first half height panels appear to be more n 11 loaded and the load transfer increases from the leech to the luff are clearly visible when the halyard pretension change from 1 25 t to 10 t a diagonal direction loading starting from the leech is also shown for the first bottom panels it is a typical result of panel wrinkles phenomenon fig 13 shows n 22 membrane stress forces where direction 2 is deduced from 3 1 where direction 3 denotes the normal of the deformed membrane surface the loop forces distributions previously shown in fig 11 are also qualitatively described in addition to n 22 loads arising from loop connections it is shown that a part of n 22 goes through synchronization straps in the first half mainsail height 3 3 effects of loop stiffness s mainsail panels are linked to each other thanks to axial spring models having stiffness k see section 2 2 1 in the present section 3 3 several computations are performed to investigate possible impacts of using different cable stiffnesses this is achieved considering several dyneema sk78 cable diameters φ that are given below in table 1 calculations are carried out using a halyard pretension of 5 t fig 14 shows mainsail shapes results at fsi convergence results show that decreasing cable diameters leads to a low increase of the mainsail twist while cambers are slightly increased in the first mainsail half height loop forces along the mast are provided in fig 15 differences in results are more pronounced when varying cable diameters indeed when using a diameter of 9 mm instead of 36 mm luff loop forces are decreased of about 1000 n for z 20 m at the leech loop forces are decreased in the order on the entire height a leech force transition at z 20 m is seen when using φ 9 mm this is due to the presence of a large diagonal panel wrinkle at this height as shown in fig 16 fig 17 shows n 11 membrane stress forces onto the undeformed membrane surface the diagonal panel wrinkle formation can be seen when φ 9 mm maximum stress forces are decreased by about 30 when using a cable diameter of 9 mm instead of 36 mm these results on loop stiffness s effects show that the cable diameter choice is an important design parameter indeed large diagonal panel wrinkles may be avoided in addition to reduce membrane stress forces when reducing the cable diameter without having a large impact onto the mainsail flying shape 4 conclusion a fast and robust strategy to solve nonlinear fsi on yacht sails has been presented in this paper this study is part of a large industrial project who s purpose is to develop new designs of rigid sails a 300 m2 semi rigid composite mainsail prototype composed of 21 articulated panels was numerically modeled and the proposed solving strategy was applied for the flow solver an implemented lifting line model including a semi analytical method for the aerodynamic pressure field computation is proposed this model relies on an efficient chebyshev gauss quadrature to approximate the two dimensional vortex distribution of sail sections pressure distributions at each section are thus quickly determined and the overall mainsail pressure field is computed using linear interpolations mainsail panels are modeled by thin shell elements including a specific thickness approach to enhance the numerical stability that is possibly affected by membrane winkles the nonlinear solving is performed by a quasi static resolution with a dynamic backward euler scheme the assembly of these flow and structural methods leads to a fast and robust approach to compute nonlinear fsi on yacht sails as no relaxation methods are needed a mesh convergence study has been carried out to determine the required number of shell elements for computing the mainsail prototype fsi problem results have shown the computing efficiency of the proposed method in terms of both time and robustness impacts of the mainsail halyard pretension have also been investigated the pretension varied from 1 25 t to 10 t and overall dependent results have been shown in addition to the nonlinear response of structural connection loops these results demonstrated the robustness of the nonlinear structural method in particular for computations with low halyard pretension values last results present effects of loop stiffnesses where it has been shown that the cable diameter is an important design parameter to possibly avoid large diagonal panel wrinkle in addition to reduce membrane stress forces without having a large impact onto the mainsail flying shape an experimental campaign definition with a 50 m2 composite mainsail is on progress methods described in this paper will be applied to compute the structural response of this sail and experimental data will be used to validate the proposed fluid structure interaction method future developments will concern aerodynamic jib effects and mast deformations bak and yoo 2019 considerations the two dimensional rans lifting line method proposed by graf et al 2014 seems also promising and could be well adapted to the present work too the overall mainsail design may also be improved for example with several weight reductions through advanced optimization methods sacher et al 2018 credit authorship contribution statement matthieu sacher conceptualization methodology software writing original draft writing review editing jean baptiste leroux conceptualization methodology writing review editing alain nême conceptualization methodology writing review editing project administration funding acquisition christian jochum conceptualization methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study takes part in the solid sail 2 0 project funded by the région bretagne and approved by the pôle emc2 and the pôle mer bretagne atlantique this project involves a consortium of 3 industrial partners chantiers de l atlantique gsea design and multiplast in collaboration with ensta bretagne a graduate and post graduate school of engineering as an academic partner the chantiers de l atlantique gsea design and multiplast companies are gratefully acknowledged by the authors for their technical support and successful collaboration 
