index,text
1615,metadata from on going site investigations at u s air force sites impacted by aqueous film forming foam afff were used to evaluate primary factors that affect transport of poly and perfluoroalkyl substances pfas within source zones soil to groundwater ratios γsoil gw were calculated for each site and pfas as an empirical transport metric and regressed against select soil chemical and physical properties as well as relevant interactions thereof using analysis of covariance ancova total organic carbon and percent total clay content were significant covariates and best fit log transformed γsoil gw with a parallel lines model regression parameters were used to derive apparent koc estimates for 15 perfluoroalkyl acids perfluorooctane sulfonamide and the 6 2 and 8 2 fluorotelomer sulfonates which were bimodal where significant differences were primarily observed between pfas with fewer than 8 perfluorinated carbons including perfluorooctoanoic acid pfoa and those with 8 or more including perfluorooctane sulfonate pfos surprisingly clay content was observed with a negative slope i e γsoil gw decreased with increasing clay content which may reflect greater retardation at more permeable sites due to air water interfacial partitioning further analysis demonstrated that γsoil gw is also affected by the degree of flushing in a way that suggests mass transfer as opposed to hysteretic desorption primarily controls mass discharge at poorly flushed sites overall this meta analysis demonstrates that pfas retention in soil is significant but depends on a combination of fundamental partitioning mechanisms that may not be predictable in all cases based on transport models that assume an equilibrium condition keywords pfas sorption soil properties equilibrium 1 introduction the u s department of defense dod is currently in the process of investigating thousands of sites potentially impacted by poly and perfluoroalkyl substances pfas due to historic use of aqueous film forming foam afff of primary importance is the assessment and mitigation of potential drinking water exposures however the full extent of pfas within legacy afff formulations is still evolving backe et al 2013 barzen hanson et al 2017a and the transport potential of prevalent pfas is highly uncertain field and seow 2017 xiao 2017 as a result risk management decisions which are often made with limited data are difficult and currently rely on conservative and thus costly assumptions comprehensive transport models such as the multi compartment model recently proposed by brusseau et al 2018 are desperately needed to prioritize sites based on the potential for down gradient exposure and to optimize on going field investigations but require rigorous field validation before universal application the rate and extent of pfas transport from source zones is both pfas and soil specific given that many pfas particularly the perfluoroalkyl acids pfaas are not readily degradable understanding partitioning processes are critically important to establishing subsurface transport potential key soil properties include total organic carbon toc due to hydrophobic partitioning which increases with increasing perfluorinated chain length guelfo and higgins 2013 milinovic et al 2015 anderson et al 2016 xiao et al 2017 and cation anion exchange capacity cec and aec respectively due to electrostatic interactions that depend both on the surface charge of soil particles and the pfas functional moiety jeon et al 2011 guelfo and higgins 2013 zhao et al 2014 as a result of the charge dependence of these electrostatic processes geochemical conditions e g ph can exert complex influences on partitioning weber et al 2017 this includes altering the charge of soil particles and or pfas molecules contributing positively charged species that may promote bridging between soils and anionic pfas or decreasing the affinity of sorbents through electrical double layer compression you et al 2010 du et al 2014 soil partitioning may also be affected by interactions with other pfas through competitive sorption guelfo and higgins 2013 the presence of non aqueous phase liquid napl guelfo and higgins 2013 mckenzie et al 2016 air water interfacial affinity meng et al 2014 lyu et al 2018 brusseau 2018 brusseau et al 2018 micelle formation bhhatarai and gramatica 2010 and changes induced by remediation efforts mcguire et al 2014 importantly significant hysteresis has also been consistently observed in batch experiments suggesting some fraction of sorbed pfas may be irreversible milinovic et al 2015 miao et al 2017 and thus equilibrium is a crucial assumption with tremendous implications appropriate transport models must account for the relative magnitude and permanence of these complex and potentially interactive processes accordingly the growing database from u s air force usaf sites was used to evaluate primary factors that affect transport of prevalent pfas within source zones at afff impacted sites in fact afff impacted sites have been among the most extensively characterized environmental sources of pfas to date e g mcguire et al 2014 anderson et al 2016 weber et al 2017 bräunig et al 2019 specifically the usaf has systematically conducted focused field investigations since 2016 to confirm pfas contamination at all sites where afff releases are suspected anderson and kempisty 2019 while these investigations are ongoing the current database includes hundreds of source zones across a diverse continuum of site conditions critically the current database includes measurements of 24 pfas as well as select soil properties likely to mitigate transport inter site variability in soil to groundwater ratios γsoil gw was specifically evaluated with these field data such empirically derived metrics have inherent limitations but there is a paucity of pfas partitioning measures and there is considerable inconsistency among published studies guelfo and higgins 2013 for example recent comprehensive summaries illustrate few and highly variable published estimates for organic carbon partitioning koc a range exceeding an order of magnitude has been reported in the case of pfos itrc 2018a li et al 2018 this inconsistency can be attributed to methodological differences among studies e g sorption vs desorption experiments as well as the use of different soils and sediments with highly variable chemical and physical composition thus the empirical γsoil gw estimates evaluated herein may in fact provide a more robust validation of fundamental sorption processes given the scale of the available data the overarching objective of this meta analysis is to determine and or validate the primary factors that mitigate pfas transport within source zones results are intended to facilitate the development and parameterization of predictive tools that model pfas subsurface transport 2 methods 2 1 field data data used for these analyses were generated by the usaf during on going pfas investigation efforts since 2016 the usaf has systematically conducted focused field investigations to confirm pfas contamination at all suspected sites where afff was released directly to the environment see anderson and kempisty 2019 each of these source zone investigations typically includes 3 to 7 boreholes with drilling methods determined by site specific geology as close as possible to the most likely location of afff infiltration pfas are measured from discrete soil samples at multiple depths throughout the vadose zone and from groundwater sampled directly at the water table using analytical methods generally consistent with u s epa s method 537 for drinking water which utilizes liquid chromatography with tandem mass spectrometry lc ms ms additionally at a subset of sites select soil properties are measured from composite samples across all boreholes for each depth discrete soil samples are collected for pfas analysis all soil properties are measured in the lab and generally follow industry standard methods each lab has their own proprietary modifications and consist of soil ph 1 1 soil deionized water toc by dry combustion after pretreatment to remove inorganic c and percent clay content 0 002 mm by sedimentation using a hydrometer all analyses pfas and soil properties are conducted by commercial analytical labs accredited by the u s dod environmental laboratory accreditation program in accordance with the requirements of the dod quality systems manual for environmental laboratories dod 2018 specifically see table b 15 for pfas specific analytical quality assurance quality control requirements reported pfas vary among the contracted labs but typically consist of 18 24 analytes including a suite of perfluoroalkyl carboxylates pfcas and perfluoroalkyl sulfonates pfsas perfluorooctane sulfonamide pfosa the 6 2 and 8 2 fluorotelomer sulfonates ftss n ethyl perfluorooctane sulfonamido acetic acid etfosaa and n methyl perfluorooctane sulfonamido acetic acid mefosaa and reflect the summation of all structural isomers as applicable additional acronyms for specific pfas presented herein are defined in itrc 2018b although potentially co occurring contaminants e g petroleum products were not measured no obvious napl was evident in any sample used in these analyses also 1 previous remediation efforts at these sites were limited only to a relatively small number of sites e g select fire training areas but were not considered in these analyses due to available data limitations and 2 all soil samples used in these analyses were collected from upland locations with aerobic geochemistry 2 2 data management soil to groundwater ratios γsoil gw were calculated for each measured pfas at each site after standardizing the respective units to parts per billion ppb μg kg 1 and μg l 1 for soil and groundwater respectively initial estimates were calculated for each pfas and borehole only the soil sample with the highest pfas concentration was used regardless of depth if the soil samples for a given borehole consisted of all non detects nds for a given pfas that borehole was omitted for that pfas groundwater nds among the remaining boreholes 19 were substituted with ½ the reporting limit rl which were generally 10 ng l 1 for each pfas estimated or j flagged results were used quantitatively subsequently the site wide γsoil gw was defined as the median value among all remaining boreholes for a given site and pfas and is considered a robust metric representative of each source zone pfas with fewer than 50 site wide γsoil gw estimates were excluded from all analyses because 1 the max soil concentration for a given pfas potentially occurred at different depths among the various boreholes at a given site and 2 the soil property data represent depth specific composite samples site wide γsoil gw estimates were subjectively paired to the soil property data from among the various depths based on whichever sample was thought to represent the greatest potential effect on transport for toc and clay content the depth sample with the maximum value was retained whereas for soil ph the sample with the minimum value was retained the maximum toc value which occurred in the surface sample in the majority 56 of boreholes was justified by the presumption that hydrophobic sorption increases with increasing toc concentrations conversely greater acidity increases the potential magnitude of pfas sorption by electrostatic anion exchange from clays with ph dependent charge justifying the minimum soil ph value since all pfas measured are either anionic the pfcas pfsas and the 6 2 and 8 2 ftss or uncharged fosa etfosaa and mefosaa at environmentally relevant ph itrc 2018b the maximum clay content value was retained based on the initial assumption that soils with lower permeability would be coincident with reduced groundwater recharge and thus higher γsoil gw and or potentially greater aec pansu and gautheyrou 2006 clearly measuring aec directly would have been superior but proved impractical due to limited commercial availability among accredited labs additional data were obtained specifically to test the hypothesis that γsoil gw also depends on the degree of flushing a categorical variable flushed was operationally defined based on a combination of the site specific static groundwater depth and the 30 year mean annual rainfall for a given installation rainfall records were obtained for the closest municipality to each installation from the daymet dataset archived and distributed through oak ridge national laboratory s distributed active archive center https daymet ornl gov the flushed variable was created with three categories low medium and high that reflect the relative degree of flushing at a site the low category was defined as any site with groundwater 30 ft below ground surface bgs and 30 in of rain year as determined by the 30 year mean annual estimate the high category was defined as any site with groundwater 10 ft bgs and 50 in year all other sites were assigned to the medium category the flushed categories were created specifically to contrast relatively dry and deep sites from those that are relatively shallow and wet as well as to distribute the data among the categories as evenly as possible although that proved difficult given relatively few dry and deep sites the low medium and high categories contain 8 n 26 61 n 198 and 31 n 100 of the sites respectively 2 3 statistical analyses data analyses were conducted in two phases first the effects of toc clay content and soil ph on log transformed γsoil gw were evaluated log transformation of γsoil gw was required given observed lognormality see results because γsoil gw is a continuous dependent variable and toc clay content and soil ph are all continuous regressors and whether or not the data supported unique estimates for each pfas was of interest analysis of covariance ancova was utilized to determine significant effects linearity was confirmed ad hoc by careful evaluation of fit statistics the optimum covariate structure to include the model without any covariates the null model was determined by multimodel inference based on the akaike information criterion aic with small sample bias correction aicc according to burnham and anderson 2002 all possible combinations of the covariates were evaluated both independently additive model and multiplicatively interaction model where it made sense specifically the clay ph interaction was of interest as a surrogate for aec soils with high aec would be expected to have relatively low ph and high clay content with ph dependent charge because both anionic pfas and uncharged pfas are included in these analyses however the constraint was applied that all candidate models that included ph did so with the ph pfas interaction electrostatic interactions are not expected to play a major role in mitigating transport for uncharged pfas this meant that to test the significance of the clay ph interaction it was necessary to evaluate the three way clay ph pfas interaction similarly candidate models were fitted for each covariate including the pfas covariate interaction to determine if a parallel lines model or unequal slopes model best fit the data aicc was used to rank candidate models aicc 2 log ℓ max 2 k n n k 1 where ℓmaxis the maximized likelihood the likelihood evaluated with parameters set equal to respective maximum likelihood estimates k is the number of estimated model parameters and n is the sample size to further assess candidate models where r denotes the number of models the difference between each model and the model with the lowest aicc value the most parsimonious model was computed δaicc subsequently the overall weight w of each model among the suite of hypothesized candidate models was computed and is considered the proportional weight of evidence for each model w i exp δ aicc i 2 r 1 r exp δ aicc r 2 once the most parsimonious ancova model was determined residuals observed predicted were recovered and used to test differences among the flushed categories using standard analysis of variance anova residuals reflect to degree to which the ancova model parameterized exclusively with soil properties reflecting sorption processes either over or under predicted log transformed γsoil gw lack of a significant flushed effect would suggest reversible sorption under a pseudo equilibrium condition i e γsoil gw is unaffected by the degree of flushing after controlling for sorption effects to the contrary a significant trend where residual γsoil gw consistently increases or decreases with the degree of flushing i e concordance would require interpretation based on the relative magnitude of mean estimates all analyses were performed using proc mixed in sas version 9 4 with the default fitting criterion restricted maximum likelihood aicc values were recovered from output and used to derive w i given the relatively small number of flushed low sites n 26 the anova was performed with site as a random variable specifically to distinguish within vs among site variation if not based on aicc all analyses were considered significant at p 05 2 4 assumptions notwithstanding potential confounding effects from unmeasured co occurring contaminants and past remediation efforts two primary assumptions are prerequisite for valid inference herein both the length of time since the last afff release i e the duration of leaching and weathering to include potential precursor biotransformation and the groundwater seepage velocity at a given site are potential artifacts that obviously could confound the results since no information was readily available for either parameter however the assumption is made that both are randomly distributed among the sites to specifically include the flushed categories while these assumptions are likely valid given no apparent rational to suggest otherwise omission of these critical factors is recognized as a significant potential source of observed error 3 results eighteen pfas were observed with nsite 50 from among 324 sites across 56 installations distributed throughout the continental u s with paired γsoil gw estimates and soil chemical and physical property measurements the grand distribution of γsoil gw across all sites and pfas was observed to vary lognormally over 8 orders of magnitude fig 1 approximately 13 of the log transformed γsoil gw estimates were negative reflecting greater groundwater concentrations whereas the vast majority 87 reflect greater soil concentrations in respective units of ppb log transformed γsoil gw estimates ranged from 1 98 to 6 92 ancova of log transformed γsoil gw resulted in two candidate models with cumulative akaike weight 99 table 1 the most parsimonious model accounted for 90 of the weight and consisted of a parallel lines model i e separate y intercepts for each pfas and a common slope were estimated with toc and clay content regressors the second best fitting candidate model also included the ph pfas interaction providing marginal support for a ph effect but was not considered significant based on the disparity in cumulative akaike weight surprisingly clay content was observed with a negative slope fig 2 whereas toc was observed with a positive slope fig 3 as expected clearly evident in figs 2 and 3 are two distinct clusters of regression lines discussed further below since toc was a significant regressor anocva output pfas specific y intercepts and the common toc slope parameter were used to derive apparent log koc estimates for each pfas log koc estimates were calculated according to log k oc log γ soil gw log f oc where log f oc is the fraction of organic carbon simulated across the range of observed log transformed toc values and log γsoil gw is predicted from the ancova where clay content 0 mean log koc estimates are presented in fig 4 importantly estimates were relatively constant 3 7 based on the pfas observed with highest coefficient of variation over the entire range in observed toc data not shown pair wise differences with tukey p value adjustment were used to determine statistical differences in log koc based on the ancova output since the y intercepts were the only parameter that differed across the various pfas although some additional relatively minor significant differences were observed apparent log koc estimates primarily clustered between pfas with fewer than 8 perfluorinated carbons including pfoa and those with 8 or more including pfos fig 4 anova of the ancova residuals across the flushed categories resulted in significant differences p 0001 mean residuals are presented in fig 5 a concordant trend was observed where the most parsimonious ancova model under predicted γsoil gw at flushed low sites and slightly over predicted γsoil gw at flushed high sites whereas flushed med sites were observed with an intermediate mean residual very close to zero observed predicted over an order of magnitude 12 difference was observed in mean residuals between the flushed low and flushed high site categories 4 discussion a negative association between γsoil gw and clay content was unexpected fig 2 the initial assumption was that soils with higher clay content would result in higher γsoil gw estimates due to reduced groundwater recharge and or potentially greater aec given well established anionic sorption processes e g xiao et al 2011 zhao et al 2014 thus a positive slope or a significant interaction with ph was expected a significant negative slope clearly implicates alternative process es to our knowledge this is the first study to clearly associate total soil clay content with pfas transport although aec typically represents only a minor fraction of the total exchange complex in most soils across the continental u s secondary soil clay minerals with ph dependent charge e g iron oxides are common pansu and gautheyrou 2006 thus anionic pfas retardation is likely in acidic soils with an abundance of variably charged clay minerals however direct measurement of aec was not evaluated and aec also depends on soil solution chemistry e g ionic strength and cation composition such that clay content and soil ph may not be sufficient surrogates tang et al 2010 chen et al 2013 moreover cec which dominates the exchange complex of most u s soils may actually enhance anionic pfas transport due to anionic repulsion wang et al 2015 which is a candidate explanation for the negative association between γsoil gw and clay content observed here because percent clay content is an indiscriminant measure of soil particles 0 002 mm regardless of composition and surface charge the relative contributions of applicable electrostatic interactions on observed γsoil gw estimates cannot be determined an alternative and perhaps more likely explanation could be related to air water interfacial partitioning within a given soil type greater retardation has been demonstrated under unsaturated flow for amphiphilic pfas lyu et al 2018 brusseau 2018 brusseau et al 2018 because soils with relatively lower clay content are better drained and less prone to saturation during precipitation events all else equal the significant negative association between γsoil gw and clay content observed here could reflect air water interfacial partitioning either independently or potentially in combination with anionic repulsion specifically gas phase partitioning experiments have shown that the magnitude of the air water interfacial areas increase with decreasing water saturation peng and brusseau 2005 moreover soils with higher clay content retain relatively larger volumetric water content following precipitation events resulting in longer reaction time between solutes and mineral surfaces thus kinetic limited pfas sorption wei et al 2017 would promote greater partitioning in higher clay content soils which was not observed here the relative effects of air water interfacial partitioning and electrostatic interactions should therefore be further studied to fully qualify the role of soil clay content a routine field measurement on pfas transport while the ancova results provide marginal evidence of a ph pfas effect on γsoil gw table 1 the model was not considered significant the interaction model was prescribed a priori because ph was specifically evaluated as a potential surrogate for aec and the final working dataset consisted of both anionic and uncharged i e pfosa pfas thus separate regression parameters were estimated for each pfas with the expectation that at least pfosa would be observed without a significant association similarly li et al 2018 also recently performed a meta analysis of sorption data albeit limited to previously published data primarily for pfoa and pfos and also observed highly variable and largely insignificant associations between soil partitioning and soil ph in this context the results presented here suggest that either 1 pfas partitioning and retention processes thought to be most strongly influenced by soil ph are relatively less important than processes that might be less ph sensitive e g hydrophobic partitioning and flushing or 2 soil ph does not adequately reflect the combined effects of all relevant electrostatic processes as noted above while soil ph is a critical variable it only partially approximates the aec of a particular soil given the lack of aec or cec for that matter data at sites where pfas partitioning has been studied highlighted by li et al 2018 further study is also needed to fully qualify the role of aec on pfas transport aec and cec should therefore become routine measurements in both field studies that describe spatial distribution of pfas as well as lab studies focused on fundamental transport processes contrary to li et al 2018 toc was observed as a highly significant factor associated with γsoil gw in these analyses toc appeared in both candidate models with cumulative akaike weight 99 table 1 in general the positive association between γsoil gw and toc is consistent with the prevailing assumption that the presence of natural organic matter increases the potential for hydrophobic partitioning of pfas following their release to soils guelfo and higgins 2013 because a parallel lines model best fit the data however deriving koc estimates was challenging ancova was utilized specifically to evaluate whether or not the data supported unique regression estimates for each pfas as defaulted by li et al 2018 slope parameters theoretically reflect the magnitude of partitioning proportionality constant but in this case on a semi log scale the y intercept parameter statistically discriminated partitioning affinities among the various pfas because the y intercept estimates reflect the net effect of all operative partitioning mechanisms and the respective affinities of each pfas koc estimates fig 4 should be regarded as approximations of the respective hydrophobicity of each pfas as opposed to their amphiphilicity and or electrostaticity for example this is particularly evident by the lack of an obvious correlation with perfluorinated chain length within the two clusters of koc estimates fig 4 nevertheless these results provide insight into the relative soil partitioning affinities of the various pfas that overwhelmingly discriminates between long and short chain pfas most likely due to differences in hydrophobicity guelfo and higgins 2013 fig 4 presents koc estimates for 18 pfas which were bimodal where significant differences were primarily observed between pfas with fewer than 8 perfluorinated carbons including pfoa and those with 8 or more including pfos in general these results are consistent with the literature in that soil partitioning of ftss is largely due to hydrophobic sorption barzen hanson et al 2017b partitioning to toc depends on perfluorinated chain length guelfo and higgins 2013 milinovic et al 2015 anderson et al 2016 xiao et al 2017 and pfsas partition to toc to a greater extent than pfcas of equal total chain length zhou et al 2010 sepulvado et al 2011 however the threshold between short and long chain pfas is less clear typically short chained pfas include pfcas and pfsas with fewer than 8 and 6 total carbons respectively buck et al 2011 thus pfoa and pfhxs are typically considered long chain pfas while significant differences were observed within the two clusters of koc estimates to specifically include pfoa and select shorter chain pfas fig 4 these results suggest that pfoa and pfhxs partition to toc more similarly to conventional short chain pfas anova of the ancova residuals confirms that the degree of flushing is highly relevant to empirical soil partitioning at source zones from legacy afff sites while long term leaching of pfas from source zones has been demonstrated stahl et al 2013 bräunig et al 2019 the extent to which mass discharge is controlled by desorption at legacy sites 40 years since afff was last released in some cases is questionable given complicated pseudo second order and variable sorption and presumably desorption kinetics wei et al 2017 equilibrium is a crucial assumption as hysteresis should result in diminishing mass discharge over time milinovic et al 2015 miao et al 2017 and thus higher γsoil gw estimates at legacy sites that are more flushed all else equal γsoil gw estimates reflect total soil concentrations which are measured from organic solvent extracts and should include at least some fraction of irreversibly sorbed pfas van leeuwen and de boer 2007 whereas under a reversible desorption condition γsoil gw should remain constant regardless of the degree of flushing because a decreasing concordant trend was observed fig 5 hysteretic desorption cannot be validated given the relative magnitude of mean residual estimates fig 5 soil concentrations at the flushed low sites are most likely anomalously high on average presumably due to limited mass transfer this is particularly the case because soil samples are extracted and analyzed by the labs including hydroscopic water content results are reported on a dry weight equivalent basis and thus γsoil gw estimates include dissolved phase pfas from soil solution entrained in the samples at the time of collection however 23 of the 26 flushed low sites were observed with at least some quantifiable pfas in groundwater excluding j flagged results and thus mass discharge at the flushed low sites is confirmed the observed γsoil gw estimates are not biased to any appreciable extent based on the substitution of groundwater nds with ½ the rl therefore the possibility remains that groundwater pfas concentrations at the flushed high sites may be slightly higher than what would be expected under equilibrium because the ancova which accounts for sorption over predicted γsoil gw regardless these results suggest that the degree of flushing is highly relevant to empirical soil partitioning at legacy source zones such that transport models e g brusseau et al 2018 should be validated at multiple sites that span the flushing continuum to rigorously test equilibrium assumptions in summary these analyses were performed to evaluate and validate primary factors that mitigate transport of pfas within source zones at afff impacted sites based on the results obtained across a large number of highly diverse sites toc reflecting hydrophobic partitioning clay content presumably reflecting at least some degree of air water interfacial partitioning and the degree of flushing were observed to significantly affect site wide soil to groundwater ratios γsoil gw which were lognormally distributed bimodal koc estimates were derived where the greatest significant differences occurred between pfas with fewer than 8 perfluorinated carbons including pfoa and those with 8 or more including pfos overall these analyses accounted for 35 of the total variance in log γsoil gw which is considerable given that site history i e time since last afff release and past remediation efforts groundwater seepage velocity potential co occurring contaminants and direct measures of soil ion exchange capacity were unfortunately omitted from the analyses due to available data limitations while the need for additional research is discussed these results conclusively demonstrate that pfas retention in soil is significant but depends on a combination of fundamental partitioning mechanisms that may not be predictable in all cases based on transport models that assume an equilibrium condition acknowledgements special thanks is given to darwin ockerman from the u s geological survey usgs for compiling the rainfall data and to three anonymous reviewers for greatly improving the overall quality of this manuscript 
1615,metadata from on going site investigations at u s air force sites impacted by aqueous film forming foam afff were used to evaluate primary factors that affect transport of poly and perfluoroalkyl substances pfas within source zones soil to groundwater ratios γsoil gw were calculated for each site and pfas as an empirical transport metric and regressed against select soil chemical and physical properties as well as relevant interactions thereof using analysis of covariance ancova total organic carbon and percent total clay content were significant covariates and best fit log transformed γsoil gw with a parallel lines model regression parameters were used to derive apparent koc estimates for 15 perfluoroalkyl acids perfluorooctane sulfonamide and the 6 2 and 8 2 fluorotelomer sulfonates which were bimodal where significant differences were primarily observed between pfas with fewer than 8 perfluorinated carbons including perfluorooctoanoic acid pfoa and those with 8 or more including perfluorooctane sulfonate pfos surprisingly clay content was observed with a negative slope i e γsoil gw decreased with increasing clay content which may reflect greater retardation at more permeable sites due to air water interfacial partitioning further analysis demonstrated that γsoil gw is also affected by the degree of flushing in a way that suggests mass transfer as opposed to hysteretic desorption primarily controls mass discharge at poorly flushed sites overall this meta analysis demonstrates that pfas retention in soil is significant but depends on a combination of fundamental partitioning mechanisms that may not be predictable in all cases based on transport models that assume an equilibrium condition keywords pfas sorption soil properties equilibrium 1 introduction the u s department of defense dod is currently in the process of investigating thousands of sites potentially impacted by poly and perfluoroalkyl substances pfas due to historic use of aqueous film forming foam afff of primary importance is the assessment and mitigation of potential drinking water exposures however the full extent of pfas within legacy afff formulations is still evolving backe et al 2013 barzen hanson et al 2017a and the transport potential of prevalent pfas is highly uncertain field and seow 2017 xiao 2017 as a result risk management decisions which are often made with limited data are difficult and currently rely on conservative and thus costly assumptions comprehensive transport models such as the multi compartment model recently proposed by brusseau et al 2018 are desperately needed to prioritize sites based on the potential for down gradient exposure and to optimize on going field investigations but require rigorous field validation before universal application the rate and extent of pfas transport from source zones is both pfas and soil specific given that many pfas particularly the perfluoroalkyl acids pfaas are not readily degradable understanding partitioning processes are critically important to establishing subsurface transport potential key soil properties include total organic carbon toc due to hydrophobic partitioning which increases with increasing perfluorinated chain length guelfo and higgins 2013 milinovic et al 2015 anderson et al 2016 xiao et al 2017 and cation anion exchange capacity cec and aec respectively due to electrostatic interactions that depend both on the surface charge of soil particles and the pfas functional moiety jeon et al 2011 guelfo and higgins 2013 zhao et al 2014 as a result of the charge dependence of these electrostatic processes geochemical conditions e g ph can exert complex influences on partitioning weber et al 2017 this includes altering the charge of soil particles and or pfas molecules contributing positively charged species that may promote bridging between soils and anionic pfas or decreasing the affinity of sorbents through electrical double layer compression you et al 2010 du et al 2014 soil partitioning may also be affected by interactions with other pfas through competitive sorption guelfo and higgins 2013 the presence of non aqueous phase liquid napl guelfo and higgins 2013 mckenzie et al 2016 air water interfacial affinity meng et al 2014 lyu et al 2018 brusseau 2018 brusseau et al 2018 micelle formation bhhatarai and gramatica 2010 and changes induced by remediation efforts mcguire et al 2014 importantly significant hysteresis has also been consistently observed in batch experiments suggesting some fraction of sorbed pfas may be irreversible milinovic et al 2015 miao et al 2017 and thus equilibrium is a crucial assumption with tremendous implications appropriate transport models must account for the relative magnitude and permanence of these complex and potentially interactive processes accordingly the growing database from u s air force usaf sites was used to evaluate primary factors that affect transport of prevalent pfas within source zones at afff impacted sites in fact afff impacted sites have been among the most extensively characterized environmental sources of pfas to date e g mcguire et al 2014 anderson et al 2016 weber et al 2017 bräunig et al 2019 specifically the usaf has systematically conducted focused field investigations since 2016 to confirm pfas contamination at all sites where afff releases are suspected anderson and kempisty 2019 while these investigations are ongoing the current database includes hundreds of source zones across a diverse continuum of site conditions critically the current database includes measurements of 24 pfas as well as select soil properties likely to mitigate transport inter site variability in soil to groundwater ratios γsoil gw was specifically evaluated with these field data such empirically derived metrics have inherent limitations but there is a paucity of pfas partitioning measures and there is considerable inconsistency among published studies guelfo and higgins 2013 for example recent comprehensive summaries illustrate few and highly variable published estimates for organic carbon partitioning koc a range exceeding an order of magnitude has been reported in the case of pfos itrc 2018a li et al 2018 this inconsistency can be attributed to methodological differences among studies e g sorption vs desorption experiments as well as the use of different soils and sediments with highly variable chemical and physical composition thus the empirical γsoil gw estimates evaluated herein may in fact provide a more robust validation of fundamental sorption processes given the scale of the available data the overarching objective of this meta analysis is to determine and or validate the primary factors that mitigate pfas transport within source zones results are intended to facilitate the development and parameterization of predictive tools that model pfas subsurface transport 2 methods 2 1 field data data used for these analyses were generated by the usaf during on going pfas investigation efforts since 2016 the usaf has systematically conducted focused field investigations to confirm pfas contamination at all suspected sites where afff was released directly to the environment see anderson and kempisty 2019 each of these source zone investigations typically includes 3 to 7 boreholes with drilling methods determined by site specific geology as close as possible to the most likely location of afff infiltration pfas are measured from discrete soil samples at multiple depths throughout the vadose zone and from groundwater sampled directly at the water table using analytical methods generally consistent with u s epa s method 537 for drinking water which utilizes liquid chromatography with tandem mass spectrometry lc ms ms additionally at a subset of sites select soil properties are measured from composite samples across all boreholes for each depth discrete soil samples are collected for pfas analysis all soil properties are measured in the lab and generally follow industry standard methods each lab has their own proprietary modifications and consist of soil ph 1 1 soil deionized water toc by dry combustion after pretreatment to remove inorganic c and percent clay content 0 002 mm by sedimentation using a hydrometer all analyses pfas and soil properties are conducted by commercial analytical labs accredited by the u s dod environmental laboratory accreditation program in accordance with the requirements of the dod quality systems manual for environmental laboratories dod 2018 specifically see table b 15 for pfas specific analytical quality assurance quality control requirements reported pfas vary among the contracted labs but typically consist of 18 24 analytes including a suite of perfluoroalkyl carboxylates pfcas and perfluoroalkyl sulfonates pfsas perfluorooctane sulfonamide pfosa the 6 2 and 8 2 fluorotelomer sulfonates ftss n ethyl perfluorooctane sulfonamido acetic acid etfosaa and n methyl perfluorooctane sulfonamido acetic acid mefosaa and reflect the summation of all structural isomers as applicable additional acronyms for specific pfas presented herein are defined in itrc 2018b although potentially co occurring contaminants e g petroleum products were not measured no obvious napl was evident in any sample used in these analyses also 1 previous remediation efforts at these sites were limited only to a relatively small number of sites e g select fire training areas but were not considered in these analyses due to available data limitations and 2 all soil samples used in these analyses were collected from upland locations with aerobic geochemistry 2 2 data management soil to groundwater ratios γsoil gw were calculated for each measured pfas at each site after standardizing the respective units to parts per billion ppb μg kg 1 and μg l 1 for soil and groundwater respectively initial estimates were calculated for each pfas and borehole only the soil sample with the highest pfas concentration was used regardless of depth if the soil samples for a given borehole consisted of all non detects nds for a given pfas that borehole was omitted for that pfas groundwater nds among the remaining boreholes 19 were substituted with ½ the reporting limit rl which were generally 10 ng l 1 for each pfas estimated or j flagged results were used quantitatively subsequently the site wide γsoil gw was defined as the median value among all remaining boreholes for a given site and pfas and is considered a robust metric representative of each source zone pfas with fewer than 50 site wide γsoil gw estimates were excluded from all analyses because 1 the max soil concentration for a given pfas potentially occurred at different depths among the various boreholes at a given site and 2 the soil property data represent depth specific composite samples site wide γsoil gw estimates were subjectively paired to the soil property data from among the various depths based on whichever sample was thought to represent the greatest potential effect on transport for toc and clay content the depth sample with the maximum value was retained whereas for soil ph the sample with the minimum value was retained the maximum toc value which occurred in the surface sample in the majority 56 of boreholes was justified by the presumption that hydrophobic sorption increases with increasing toc concentrations conversely greater acidity increases the potential magnitude of pfas sorption by electrostatic anion exchange from clays with ph dependent charge justifying the minimum soil ph value since all pfas measured are either anionic the pfcas pfsas and the 6 2 and 8 2 ftss or uncharged fosa etfosaa and mefosaa at environmentally relevant ph itrc 2018b the maximum clay content value was retained based on the initial assumption that soils with lower permeability would be coincident with reduced groundwater recharge and thus higher γsoil gw and or potentially greater aec pansu and gautheyrou 2006 clearly measuring aec directly would have been superior but proved impractical due to limited commercial availability among accredited labs additional data were obtained specifically to test the hypothesis that γsoil gw also depends on the degree of flushing a categorical variable flushed was operationally defined based on a combination of the site specific static groundwater depth and the 30 year mean annual rainfall for a given installation rainfall records were obtained for the closest municipality to each installation from the daymet dataset archived and distributed through oak ridge national laboratory s distributed active archive center https daymet ornl gov the flushed variable was created with three categories low medium and high that reflect the relative degree of flushing at a site the low category was defined as any site with groundwater 30 ft below ground surface bgs and 30 in of rain year as determined by the 30 year mean annual estimate the high category was defined as any site with groundwater 10 ft bgs and 50 in year all other sites were assigned to the medium category the flushed categories were created specifically to contrast relatively dry and deep sites from those that are relatively shallow and wet as well as to distribute the data among the categories as evenly as possible although that proved difficult given relatively few dry and deep sites the low medium and high categories contain 8 n 26 61 n 198 and 31 n 100 of the sites respectively 2 3 statistical analyses data analyses were conducted in two phases first the effects of toc clay content and soil ph on log transformed γsoil gw were evaluated log transformation of γsoil gw was required given observed lognormality see results because γsoil gw is a continuous dependent variable and toc clay content and soil ph are all continuous regressors and whether or not the data supported unique estimates for each pfas was of interest analysis of covariance ancova was utilized to determine significant effects linearity was confirmed ad hoc by careful evaluation of fit statistics the optimum covariate structure to include the model without any covariates the null model was determined by multimodel inference based on the akaike information criterion aic with small sample bias correction aicc according to burnham and anderson 2002 all possible combinations of the covariates were evaluated both independently additive model and multiplicatively interaction model where it made sense specifically the clay ph interaction was of interest as a surrogate for aec soils with high aec would be expected to have relatively low ph and high clay content with ph dependent charge because both anionic pfas and uncharged pfas are included in these analyses however the constraint was applied that all candidate models that included ph did so with the ph pfas interaction electrostatic interactions are not expected to play a major role in mitigating transport for uncharged pfas this meant that to test the significance of the clay ph interaction it was necessary to evaluate the three way clay ph pfas interaction similarly candidate models were fitted for each covariate including the pfas covariate interaction to determine if a parallel lines model or unequal slopes model best fit the data aicc was used to rank candidate models aicc 2 log ℓ max 2 k n n k 1 where ℓmaxis the maximized likelihood the likelihood evaluated with parameters set equal to respective maximum likelihood estimates k is the number of estimated model parameters and n is the sample size to further assess candidate models where r denotes the number of models the difference between each model and the model with the lowest aicc value the most parsimonious model was computed δaicc subsequently the overall weight w of each model among the suite of hypothesized candidate models was computed and is considered the proportional weight of evidence for each model w i exp δ aicc i 2 r 1 r exp δ aicc r 2 once the most parsimonious ancova model was determined residuals observed predicted were recovered and used to test differences among the flushed categories using standard analysis of variance anova residuals reflect to degree to which the ancova model parameterized exclusively with soil properties reflecting sorption processes either over or under predicted log transformed γsoil gw lack of a significant flushed effect would suggest reversible sorption under a pseudo equilibrium condition i e γsoil gw is unaffected by the degree of flushing after controlling for sorption effects to the contrary a significant trend where residual γsoil gw consistently increases or decreases with the degree of flushing i e concordance would require interpretation based on the relative magnitude of mean estimates all analyses were performed using proc mixed in sas version 9 4 with the default fitting criterion restricted maximum likelihood aicc values were recovered from output and used to derive w i given the relatively small number of flushed low sites n 26 the anova was performed with site as a random variable specifically to distinguish within vs among site variation if not based on aicc all analyses were considered significant at p 05 2 4 assumptions notwithstanding potential confounding effects from unmeasured co occurring contaminants and past remediation efforts two primary assumptions are prerequisite for valid inference herein both the length of time since the last afff release i e the duration of leaching and weathering to include potential precursor biotransformation and the groundwater seepage velocity at a given site are potential artifacts that obviously could confound the results since no information was readily available for either parameter however the assumption is made that both are randomly distributed among the sites to specifically include the flushed categories while these assumptions are likely valid given no apparent rational to suggest otherwise omission of these critical factors is recognized as a significant potential source of observed error 3 results eighteen pfas were observed with nsite 50 from among 324 sites across 56 installations distributed throughout the continental u s with paired γsoil gw estimates and soil chemical and physical property measurements the grand distribution of γsoil gw across all sites and pfas was observed to vary lognormally over 8 orders of magnitude fig 1 approximately 13 of the log transformed γsoil gw estimates were negative reflecting greater groundwater concentrations whereas the vast majority 87 reflect greater soil concentrations in respective units of ppb log transformed γsoil gw estimates ranged from 1 98 to 6 92 ancova of log transformed γsoil gw resulted in two candidate models with cumulative akaike weight 99 table 1 the most parsimonious model accounted for 90 of the weight and consisted of a parallel lines model i e separate y intercepts for each pfas and a common slope were estimated with toc and clay content regressors the second best fitting candidate model also included the ph pfas interaction providing marginal support for a ph effect but was not considered significant based on the disparity in cumulative akaike weight surprisingly clay content was observed with a negative slope fig 2 whereas toc was observed with a positive slope fig 3 as expected clearly evident in figs 2 and 3 are two distinct clusters of regression lines discussed further below since toc was a significant regressor anocva output pfas specific y intercepts and the common toc slope parameter were used to derive apparent log koc estimates for each pfas log koc estimates were calculated according to log k oc log γ soil gw log f oc where log f oc is the fraction of organic carbon simulated across the range of observed log transformed toc values and log γsoil gw is predicted from the ancova where clay content 0 mean log koc estimates are presented in fig 4 importantly estimates were relatively constant 3 7 based on the pfas observed with highest coefficient of variation over the entire range in observed toc data not shown pair wise differences with tukey p value adjustment were used to determine statistical differences in log koc based on the ancova output since the y intercepts were the only parameter that differed across the various pfas although some additional relatively minor significant differences were observed apparent log koc estimates primarily clustered between pfas with fewer than 8 perfluorinated carbons including pfoa and those with 8 or more including pfos fig 4 anova of the ancova residuals across the flushed categories resulted in significant differences p 0001 mean residuals are presented in fig 5 a concordant trend was observed where the most parsimonious ancova model under predicted γsoil gw at flushed low sites and slightly over predicted γsoil gw at flushed high sites whereas flushed med sites were observed with an intermediate mean residual very close to zero observed predicted over an order of magnitude 12 difference was observed in mean residuals between the flushed low and flushed high site categories 4 discussion a negative association between γsoil gw and clay content was unexpected fig 2 the initial assumption was that soils with higher clay content would result in higher γsoil gw estimates due to reduced groundwater recharge and or potentially greater aec given well established anionic sorption processes e g xiao et al 2011 zhao et al 2014 thus a positive slope or a significant interaction with ph was expected a significant negative slope clearly implicates alternative process es to our knowledge this is the first study to clearly associate total soil clay content with pfas transport although aec typically represents only a minor fraction of the total exchange complex in most soils across the continental u s secondary soil clay minerals with ph dependent charge e g iron oxides are common pansu and gautheyrou 2006 thus anionic pfas retardation is likely in acidic soils with an abundance of variably charged clay minerals however direct measurement of aec was not evaluated and aec also depends on soil solution chemistry e g ionic strength and cation composition such that clay content and soil ph may not be sufficient surrogates tang et al 2010 chen et al 2013 moreover cec which dominates the exchange complex of most u s soils may actually enhance anionic pfas transport due to anionic repulsion wang et al 2015 which is a candidate explanation for the negative association between γsoil gw and clay content observed here because percent clay content is an indiscriminant measure of soil particles 0 002 mm regardless of composition and surface charge the relative contributions of applicable electrostatic interactions on observed γsoil gw estimates cannot be determined an alternative and perhaps more likely explanation could be related to air water interfacial partitioning within a given soil type greater retardation has been demonstrated under unsaturated flow for amphiphilic pfas lyu et al 2018 brusseau 2018 brusseau et al 2018 because soils with relatively lower clay content are better drained and less prone to saturation during precipitation events all else equal the significant negative association between γsoil gw and clay content observed here could reflect air water interfacial partitioning either independently or potentially in combination with anionic repulsion specifically gas phase partitioning experiments have shown that the magnitude of the air water interfacial areas increase with decreasing water saturation peng and brusseau 2005 moreover soils with higher clay content retain relatively larger volumetric water content following precipitation events resulting in longer reaction time between solutes and mineral surfaces thus kinetic limited pfas sorption wei et al 2017 would promote greater partitioning in higher clay content soils which was not observed here the relative effects of air water interfacial partitioning and electrostatic interactions should therefore be further studied to fully qualify the role of soil clay content a routine field measurement on pfas transport while the ancova results provide marginal evidence of a ph pfas effect on γsoil gw table 1 the model was not considered significant the interaction model was prescribed a priori because ph was specifically evaluated as a potential surrogate for aec and the final working dataset consisted of both anionic and uncharged i e pfosa pfas thus separate regression parameters were estimated for each pfas with the expectation that at least pfosa would be observed without a significant association similarly li et al 2018 also recently performed a meta analysis of sorption data albeit limited to previously published data primarily for pfoa and pfos and also observed highly variable and largely insignificant associations between soil partitioning and soil ph in this context the results presented here suggest that either 1 pfas partitioning and retention processes thought to be most strongly influenced by soil ph are relatively less important than processes that might be less ph sensitive e g hydrophobic partitioning and flushing or 2 soil ph does not adequately reflect the combined effects of all relevant electrostatic processes as noted above while soil ph is a critical variable it only partially approximates the aec of a particular soil given the lack of aec or cec for that matter data at sites where pfas partitioning has been studied highlighted by li et al 2018 further study is also needed to fully qualify the role of aec on pfas transport aec and cec should therefore become routine measurements in both field studies that describe spatial distribution of pfas as well as lab studies focused on fundamental transport processes contrary to li et al 2018 toc was observed as a highly significant factor associated with γsoil gw in these analyses toc appeared in both candidate models with cumulative akaike weight 99 table 1 in general the positive association between γsoil gw and toc is consistent with the prevailing assumption that the presence of natural organic matter increases the potential for hydrophobic partitioning of pfas following their release to soils guelfo and higgins 2013 because a parallel lines model best fit the data however deriving koc estimates was challenging ancova was utilized specifically to evaluate whether or not the data supported unique regression estimates for each pfas as defaulted by li et al 2018 slope parameters theoretically reflect the magnitude of partitioning proportionality constant but in this case on a semi log scale the y intercept parameter statistically discriminated partitioning affinities among the various pfas because the y intercept estimates reflect the net effect of all operative partitioning mechanisms and the respective affinities of each pfas koc estimates fig 4 should be regarded as approximations of the respective hydrophobicity of each pfas as opposed to their amphiphilicity and or electrostaticity for example this is particularly evident by the lack of an obvious correlation with perfluorinated chain length within the two clusters of koc estimates fig 4 nevertheless these results provide insight into the relative soil partitioning affinities of the various pfas that overwhelmingly discriminates between long and short chain pfas most likely due to differences in hydrophobicity guelfo and higgins 2013 fig 4 presents koc estimates for 18 pfas which were bimodal where significant differences were primarily observed between pfas with fewer than 8 perfluorinated carbons including pfoa and those with 8 or more including pfos in general these results are consistent with the literature in that soil partitioning of ftss is largely due to hydrophobic sorption barzen hanson et al 2017b partitioning to toc depends on perfluorinated chain length guelfo and higgins 2013 milinovic et al 2015 anderson et al 2016 xiao et al 2017 and pfsas partition to toc to a greater extent than pfcas of equal total chain length zhou et al 2010 sepulvado et al 2011 however the threshold between short and long chain pfas is less clear typically short chained pfas include pfcas and pfsas with fewer than 8 and 6 total carbons respectively buck et al 2011 thus pfoa and pfhxs are typically considered long chain pfas while significant differences were observed within the two clusters of koc estimates to specifically include pfoa and select shorter chain pfas fig 4 these results suggest that pfoa and pfhxs partition to toc more similarly to conventional short chain pfas anova of the ancova residuals confirms that the degree of flushing is highly relevant to empirical soil partitioning at source zones from legacy afff sites while long term leaching of pfas from source zones has been demonstrated stahl et al 2013 bräunig et al 2019 the extent to which mass discharge is controlled by desorption at legacy sites 40 years since afff was last released in some cases is questionable given complicated pseudo second order and variable sorption and presumably desorption kinetics wei et al 2017 equilibrium is a crucial assumption as hysteresis should result in diminishing mass discharge over time milinovic et al 2015 miao et al 2017 and thus higher γsoil gw estimates at legacy sites that are more flushed all else equal γsoil gw estimates reflect total soil concentrations which are measured from organic solvent extracts and should include at least some fraction of irreversibly sorbed pfas van leeuwen and de boer 2007 whereas under a reversible desorption condition γsoil gw should remain constant regardless of the degree of flushing because a decreasing concordant trend was observed fig 5 hysteretic desorption cannot be validated given the relative magnitude of mean residual estimates fig 5 soil concentrations at the flushed low sites are most likely anomalously high on average presumably due to limited mass transfer this is particularly the case because soil samples are extracted and analyzed by the labs including hydroscopic water content results are reported on a dry weight equivalent basis and thus γsoil gw estimates include dissolved phase pfas from soil solution entrained in the samples at the time of collection however 23 of the 26 flushed low sites were observed with at least some quantifiable pfas in groundwater excluding j flagged results and thus mass discharge at the flushed low sites is confirmed the observed γsoil gw estimates are not biased to any appreciable extent based on the substitution of groundwater nds with ½ the rl therefore the possibility remains that groundwater pfas concentrations at the flushed high sites may be slightly higher than what would be expected under equilibrium because the ancova which accounts for sorption over predicted γsoil gw regardless these results suggest that the degree of flushing is highly relevant to empirical soil partitioning at legacy source zones such that transport models e g brusseau et al 2018 should be validated at multiple sites that span the flushing continuum to rigorously test equilibrium assumptions in summary these analyses were performed to evaluate and validate primary factors that mitigate transport of pfas within source zones at afff impacted sites based on the results obtained across a large number of highly diverse sites toc reflecting hydrophobic partitioning clay content presumably reflecting at least some degree of air water interfacial partitioning and the degree of flushing were observed to significantly affect site wide soil to groundwater ratios γsoil gw which were lognormally distributed bimodal koc estimates were derived where the greatest significant differences occurred between pfas with fewer than 8 perfluorinated carbons including pfoa and those with 8 or more including pfos overall these analyses accounted for 35 of the total variance in log γsoil gw which is considerable given that site history i e time since last afff release and past remediation efforts groundwater seepage velocity potential co occurring contaminants and direct measures of soil ion exchange capacity were unfortunately omitted from the analyses due to available data limitations while the need for additional research is discussed these results conclusively demonstrate that pfas retention in soil is significant but depends on a combination of fundamental partitioning mechanisms that may not be predictable in all cases based on transport models that assume an equilibrium condition acknowledgements special thanks is given to darwin ockerman from the u s geological survey usgs for compiling the rainfall data and to three anonymous reviewers for greatly improving the overall quality of this manuscript 
1616,unsupervised machine learning ml is becoming increasingly popular for solving various types of data analytics problems including feature extraction blind source separation exploratory analyses model diagnostics etc here we have developed a new unsupervised ml method based on nonnegative tensor factorization ntf for identification of the original groundwater types including contaminant sources present in geochemical mixtures observed in an aquifer frequently groundwater types with different geochemical signatures are related to different background and or contamination sources the characterization of groundwater mixing processes is a challenging but very important task critical for any environmental management project aiming to characterize the fate and transport of contaminants in the subsurface and perform contaminant remediation this task typically requires solving complex inverse models representing groundwater flow and geochemical transport in the aquifer where the inverse analysis accounts for available site data usually the model is calibrated against the available data characterizing the spatial and temporal distribution of the observed geochemical types numerous different geochemical constituents and processes may need to be simulated in these models which further complicates the analyses additionally the application of inverse methods may introduce biases in the analyses through the assumptions made in the model development process here we substitute the model inversion with unsupervised ml analysis the ml analysis does not make any assumptions about underlying physical and geochemical processes occurring in the aquifer our ml methodology called ntfk is capable of identifying 1 the unknown number of groundwater types contaminant sources present in the aquifer 2 the original geochemical concentrations signatures of these groundwater types and 3 spatial and temporal dynamics in the mixing of these groundwater types these results are obtained only from the measured geochemical data without any additional site information in general the ntfk methodology allows for interpretation of large high dimensional datasets representing diverse spatial and temporal components such as state variables and velocities ntfk has been tested on synthetic and real world site three dimensional datasets the ntfk algorithm is designed to work with geochemical data represented in the form of concentrations ratios of two constituents for example isotope ratios and delta notations standard normalized stable isotope ratios keywords nonnegative tensor factorization tucker decomposition feature extraction exploratory analysis blind source separation robustness analysis unsupervised machine learning groundwater contamination source identification advection diffusion transport geochemical signatures 1 introduction characterizing contaminated groundwater sites presents a number of major challenges and these challenges have remained key areas of research in subsurface hydrology for several decades gelhar 1993 fetter and fetter 1999 vengosh et al 2014 one of the major challenges is the manifold of uncertainties that are present in these subsurface environments characterizing the source s of the contamination is often of paramount importance and this alone comes with uncertainties in the location geochemical signature and even the number of contaminant sources similarities in the geochemical signatures of different groundwater types geochemical interference between groundwater types and complex physical and geochemical processes advection diffusion dispersion sorption retardation precipitation phase partitioning biodegradation biogeochemical reactions etc during transport from the source location to the observation location often make source identification extremely challenging furthermore the geochemical measurement data are affected by random and systematic errors which additionally complicates the analyses the water at a given time and location in the subsurface is a mixture of water with different origins and geochemical signatures which we call groundwater types deutsch and siegel 1997 these groundwater types might be associated with potentially contaminated sources of groundwater recharge or different upstream regions in the subsurface which can be called background sources in addition groundwater flows through different regions of the subsurface with different rock types and geochemical properties that can modify its geochemical signatures via physical and chemical processes e g reactions and ion exchanges groundwater samples collected at multiple wells over time can be used to glean information about these groundwater types the identification of these groundwater types is an important task in characterizing a contaminated aquifer site wagner 1992 böhlke and denver 1995 lapworth et al 2012 the typical approach to identifying these groundwater types utilizes numerical models that simulate flow and transport in the aquifer and model calibration techniques to enable the model to accurately reproduce the observed site data wagner 1992 neupauer et al 2000 atmadja and bagtzoglou 2001 michalak and kitanidis n d guan et al 2006 mamonov and tsai 2013 hamdi and mahfoudhi 2013 murray bruce and dragotti 2014 borukhov and zayats 2015 these models are often very complex requiring the simulation of numerous geochemical constituents cf hammond et al 2014 hansen et al 2017 which can make these analyses computationally expensive often requiring compromises between fidelity to the physics chemistry and computational efficiency this is closely related to contaminant source zone identification for which numerous sophisticated methods have been developed one common approach uses partitioning tracers to estimate heterogeneous permeability and nonaqueous phase liquid saturation jin et al 1995 james et al 2000 zhang and graham 2001 yeh and zhu n d illman et al 2010 additionally these complex model based approaches often require the set up of site specific grids in real world cases gzyl et al 2014 the overarching theme of these approaches is to combine a numerical model with an optimization scheme ayvaz 2010 though sometimes model uncertainty is also considered sun et al 2006 recently methods for analyzing sources of groundwater contamination have been developed that utilize machine learning ml and statistical techniques chan and huang 2003 rasekh and brumbelow 2012 methods such as factor harman 1976 and principal component jolliffe 2002 analysis have been used to describe variations and evolution in the chemical composition of water types knudson et al 1977 helena et al 2000 in addition unsupervised ml techniques such as discriminant scholkopft and mullert 1999 and clustering diday and simon 1980 analysis can group objects into two or more classes shrestha and kazama 2007 tariq et al 2008 unsupervised ml based on nonnegative matrix factorization nmf methods throckmorton et al 2016 vesselinov et al n d a have been used to identify groundwater types and their mixing ratios another approach is to use supervised ml techniques such as neural networks yegnanarayana 2009 support vector machines drucker et al 1999 locally weighted projection regression vijayakumar and schaal 2000 and relevance vector machines tipping 2001 to replace or supplement the complex numerical models previously mentioned these ml developed models can be used to make predictions related at groundwater contamination sites khalil et al n d quasi optimal learning cervone et al 2010 has been used to explore a symbolic supervised ml classification method to understand the relationship between different chemical species in ground and surface water the drawback of the supervised ml methods compared to the unsupervised ml method is that they require extensive training based on subject matter expertise existing site data or physics model outputs the process is computationally intensive and can introduce bias in the analyses the unsupervised nonnegative tensor factorization ntf approach proposed here is similar to nonnegative matrix factorization nmf methods developed recently throckmorton et al 2016 vesselinov et al n d a to understand the advance from the nmf method to the ntf method we must first consider the structure of the data the data that are assimilated by these methods comes from the observation of 1 chemical species at different 2 locations and 3 times the nmf methods can only consider variability in two of these three components at once for example observations of different species at different locations but at a fixed time vesselinov et al n d a this comes from the fact that a matrix has two indices one can be associated with the locations and another with the species but none remains to be associated with the different times the ntf method allows for an arbitrary number of indices enabling it to consider variability in all three species location time providing an advantage compared to nmf both the nmf and ntf methods provide a means of analysis that does not rely on complex inverse models making it less computationally expensive and with fewer assumptions built in the main goal of the paper is to present and demonstrate the applicability of a novel unsupervised ml algorithm called ntfk ntfk performs a blind source separation bss analysis belouchrani et al 1997 based on nonnegative tensor factorization ntf cichocki et al 2009 combined with a custom clustering algorithm vesselinov et al n d a alexandrov and vesselinov 2014 here ntfk is applied to unmix the geochemical signatures in the observations and identify the contaminant sources as a result ntfk is capable of identifying 1 the unknown number of groundwater types contaminant sources present in the aquifer 2 the original geochemical concentrations signatures of these groundwater types and 3 spatial and temporal dynamics in the mixing of these groundwater types since the problem involves mixing ntfk here is implemented applying additional optimization constraints ntfk is a high dimensional extension of our existing matrix based nmfk methodology developed in throckmorton et al 2016 vesselinov et al n d a alexandrov and vesselinov 2014 using synthetic and real world site data we demonstrate that ntfk is capable of accurately determining the unknown number of contaminant sources from observation samples of their mixtures without any additional information in addition our methodology can also estimate the source locations based on the estimated mixing coefficients at the monitoring wells and monitoring well location coordinates our methodology also allows for generation of spatial and temporal maps of estimated contaminant mass distribution in the subsurface the ntfk methodology is coded in julia bezanson et al n d and an open source code implementing our algorithm will be released soon the ntfk algorithm works with geochemical data represented in the form of concentrations ratios of two constituents for example isotope ratios and delta notations standard normalized stable isotope ratios despite the methodological complexities discussed below the algorithm is fast and relatively easy to implement 2 methodology 2 1 blind source separation bss in the analyses discussed here we assume that the geochemical observations are taken at several detectors sampling points typically monitoring wells distributed in space when there are multiple contamination sources in the aquifer each detector registers a mixture of contamination fields plumes over time originating from different sources release locations our objective is to identify the unknown number of original contamination sources which necessitates decomposing the recorded transient mixtures to their original components through the ml analyses we also identify geochemical concentrations signatures of the original sources and characterize spatial and temporal dynamics in the mixing of contaminant sources in the aquifer these results are obtained only based on the observed concentration data without any other site information our novel unsupervised ml methodology ntfk is a method for feature extraction and exploratory analysis capable of revealing features hidden in data ntfk is based on ntf which is an emerging research area in the field of data analytics and data compression cichocki et al 2009 kolda and bader 2009 in addition to extracting hidden features that are buried in large high dimensional datasets ntf based methods are also used in blind source separation bss techniques are typically based on matrix factorization methods such as principal component analysis pca jolliffe 1986 independent component analysis ica amari et al 1996 and nmf paatero and tapper 1994 these techniques form a class of unsupervised machine learning ml methods that are instrumental in model free feature extraction and dimensionality reduction when a bss technique is applied in signal processing the extracted features are the unique original signals that form the mixtures recorded by a set of spatially distributed sensors e g the voices of several speakers recorded by multiple microphones placed at different locations in a ballroom haykin and chen 2005 however the matrix based methods are inherently deficient for examining high dimensional datasets i e tensor datasets which are natural extensions of the matrix datasets many real world datasets are high dimensional and often represent one or more state variables at a discrete set of locations in space and time and as a result are ideal for tensor based analyses there are multiple tensor factorization methods hitchcock 1927 harshman and lundy 1994 de lathauwer et al 2000 and among them we utilize the tucker decomposition tucker 1966 andersson and bro 2000 examples of tucker models for three dimensional datasets are presented in fig 1 note that multiple possible tucker models can be used there are 7 possible tucker models in the three dimensional case 1 with 3 factor matrices 3 with 2 factor matrices and 3 with 1 factor matrix to apply tucker decomposition to a given dataset we need to find not only which of the possible models to use but we also need to identify the size of core tensor g in fig 1 typically we do not have prior knowledge about the specific tucker model and the core size to find the optimal decomposition model and core size ntfk applies analyses of the ntf solution robustness and parsimony as discussed in section 2 2 below herein using ntfk we analyze three dimensional data that represent the evolution in time and space of concentrations of a series of geochemical species observed at a series of monitoring wells in time by tucker decomposition the analyzed data tensor c has three dimensions s w t where s indicates a geochemical species w a monitoring well and t an observation time the tucker 3 decomposition fig 1 of the three dimensional tensor c s w t 1 c s w t g w s h w v t ε w s t where denotes a tensor product the decomposition of the tensor c s w t c ℝ 0 k m n can be expressed by components 2 c ijl p 1 k q 1 m r 1 n g pqr w ip h jq v lr ε ijl i j l where all the elements of c g w h and v are nonnegative 3 c ijl g pqr w ip h jq v lr 0 i j l p q r here i ranges from 1 to k where k is the number of geochemical species j ranges from 1 to m where m is the number of monitoring wells and l ranges from 1 to n where n is the number of time frames snapshots the ntfk methodology allows the tensor c to be sparse i e some of the observations can be missing in this case the tucker decomposition includes i a core tensor g g ℝ 0 k m n that represents the interactions between the s w and t components of w s h w and v t ii a factor matrix w w ℝ 0 k k representing geochemical signatures of each groundwater type iii a factor matrix h h ℝ 0 m m accounting for dependence on the monitoring points and iv a factor matrix v v ℝ 0 n n that captures the time dependence ℝ 0 denotes the set of nonnegative real numbers ℝ 0 x ℝ x 0 additionally ε ε ℝ k m n in eq 2 denotes the unknown discrepancy between the original data c and the tucker estimate c c g w h v the discrepancy ε can be caused by the presence of random measurement errors in the data tensor c the discrepancy can also be caused by the inadequacy of the tucker decomposition c to represent the data the tucker decomposition c can be viewed as linear combinations of geochemical spatial well location and temporal features where each of these features can have any complex nonlinear shape the features are represented in the factor matrices w h and v and the linear combinations among them are given by the core tensor g if there are nonlinear interactions among the features ntfk cannot resolve them in its current form however for the geochemical analyses presented here nonlinear interactions were not needed to characterize data mathematically the solution of the nonnegative tucker tensor decomposition is a solution of a multi dimensional optimization problem with nonnegative constraints given by 4 min g w h v 0 c g w h v f 2 to extract the unknown core tensor g and factor matrices w h and v different optimization algorithms can be applied to solve the geochemical problems discussed here we reduce the nonnegative tucker 3 decomposition presented in eq 2 to tucker 1 where fig 1 5 c ijl p 1 k g pjl w ip ε ijl i j l now the tucker decomposition includes only i an unknown core tensor g g ℝ 0 k m n and ii an unknown factor matrix w w ℝ 0 k k representing the changes in c associated with geochemical species the species component here the w matrix can be viewed as a source matrix representing concentrations of k geochemical species in k contaminant sources groundwater types the core g represents the mixing ratios of these k contaminant sources groundwater types at each well over time for example g 1 2 3 will define the mixing ratio of the source groundwater type 1 in well 2 at time frame 3 therefore here we assume that the observational data c is formed by a linear mixing of k original signals represented by the source matrix w and blended by a mixing core tensor g at each observation point and time in addition we impose constraints on the core tensor elements 6 j 1 m g pjl 1 p l where we require that all the mixing ratios at each time for each monitoring point well add up to 1 these constraints represent conservation of mass to analyze the tensor c we utilize a constrained version of the sparse nonnegative tucker 1 decomposition model mørup et al 2008 our constraints are imposed so that the tensor decomposition accounts for the underlying mixing processes the constraints are similar to the approach applied by vesselinov et al n d a for the matrix factorization problem our choice for nonnegative constraints is motivated by i the fact that concentrations are inherently nonnegative and ii our goal to relate the extracted features to easily interpretable quantities without introducing any prior assumptions indeed a meaningful interpretation of the obtained results requires the extracted features to be parts of the original data lee and seung 1999 and the nonnegative constraints lead to extraction of strictly additive components which are parts of the original data ross and zemel 2006 thus ntfk has the ability to identify readily understandable structure preserving features that enable the discovery of new causal structures and unknown mechanisms hidden in the data cichocki et al 2009 2 2 ntfk algorithm the ntfk algorithm starts with a random guess for w and g elements and proceeds by minimizing the cost objective function o which in our case is the frobenius norm 7 o 1 2 c g w f 2 during each iteration minimizing the frobenius norm eq 7 with nonnegativity constraints eq 6 is equivalent to representing the discrepancies between the observations c and the reconstruction g w as white noise due to the constraints in eq 6 the classical multiplicative ntf optimization algorithms cichocki et al 2009 are not applicable instead a nonconvex nonlinear optimization algorithm is needed and for this purpose we utilized the nonlinear minimization procedure provided by julia packages jump jl and ipopt jl jump jl is a modeling language for mathematical optimization embedded in julia dunning et al n d it supports a number of open source and commercial solvers for a variety of optimization problems jump jl is coupled with ipopt interior point optimizer an open software package for large scale nonlinear optimization wächter 2002 wächter and biegler 2005 wächter and biegler 2006 here ipopt is applied to perform nonconvex constrained second order minimization if we knew the number of sources k solving eq 7 is all we need to perform the best solution of eq 7 we would estimate matrix tensor elements and solve the inverse problem however the true number of sources is typically unknown and thus the number of the sources is an unknown parameter which we have to identify from the observations a naive approach would be to 1 explore all of the possible solutions of eq 7 for a range of a possible number of sources k and 2 select the solution with the smallest norm to identify the number of sources k s however this is a flawed approach more free parameters higher k will generally lead to a better fit irrespective of how close the estimated number of sources is to the actual number of sources this would cause the naive approach to over estimate the number of sources to resolve this issue ntfk considers all possible numbers of sources k ranging from 1 to d k 1 2 d for each value of k z different factorizations are performed with different random initial guesses ntfk then estimates the accuracy and robustness of the large set of solutions z with a different number of sources in ntfk the maximum number of explored sources d should not exceed the expected number of observed geochemical components k although theoretically the minimization algorithm used here can be applied for any k 1 thus ntfk performs z sets of simulations called ntf runs where each run is using a different number of sources k 1 2 d with random initial guesses for all the unknown matrix tensor elements at the end of each ntf run we get a set of z solutions u k where each solution contains two arrays the matrix w k j and the tensor g k j for k original sources and j 1 2 z 8 u k w k 1 g k 1 w k 2 g k 2 w k z g k z after that ntfk leverages a custom clustering algorithm to assign each of these z solutions in a given set u d to one of k specific clusters this clustering method is based on k means clustering that keeps the number of solutions in each cluster equal to the number of ntf runs cf vesselinov et al n d a alexandrov and vesselinov 2014 for example for the case with k 2 after the execution of z 1 000 ntf runs performed with random initial guesses for the w and g elements each of the two clusters will contain 1 000 solutions in the cases when the ntf problem is under parametrized i e low number of sources the final solution is generally not very sensitive to the random initial guesses this suggests there is a single global minimum which can be identified regardless of the initial guesses for matrix tensor elements in the cases when the ntf problem is over parametrized i e high number of sources the final solution is generally very sensitive to the initial guesses this suggests that potentially there are multiple local global minima which are identified using random initial guesses note that we have to enforce the condition that the clusters have an equal number of solutions since each ntf simulation contributes an equal number of solutions for each source during the clustering the similarity between sources w i1 and w i2 is measured using the cosine distance vesselinov et al n d a alexandrov and vesselinov 2014 pang ning et al 2006 the cosine distance measures the angle between the two sources and effectively ignores their magnitude the main idea for estimating the unknown number of sources in ntfk is to use the separation between the clusters as a measure of how good a particular choice of k is as an accurate estimate of the number of unknown sources we estimate the degree of clustering for a different number of sources and plot it as a function of k and we expect a sharp drop after we cross k s the optimal number of sources vesselinov et al n d a alexandrov and vesselinov 2014 to quantify this behavior after the clustering we compute a measure s k called the average silhouette width rousseeuw 1987 of how well the solutions are clustered for a given number of original sources k this measure of how well clustered the ntfk solutions are for different values of k can be applied to evaluate the optimal number of contaminant sources k s in general s k declines as k increases theoretically s k varies between 1 and 1 when s k is close to 1 that indicates that the data is well clustered i e the average distance between points within a cluster is small compared to the average distance between points in different clusters as s k decreases the quality of the clusters decreases typically s k declines sharply after the optimal number of contaminant sources k s is reached in ntfk in addition to the robustness the average reconstruction error eq 7 is used to evaluate the accuracy with which the derived average cluster solutions w k a g k a reproduce the observations c in general the solution accuracy increases while the solution robustness decreases when k goes up hence the average silhouette width and frobenius norm for each of the k cluster solutions can be used to define the optimal number of contaminant sources k s specifically k s can be set equal to the minimum number of sources that accurately reconstruct the observations i e the frobenius norm is less than a given value or hit a plateau and the clusters of solutions are sufficiently robust e g the average silhouette width s is bigger than 0 8 when some of the source geochemical compositions are very close to each other or do not demonstrate clear features it is also useful to formulate another criteriion for the ntfk solution robustness which is based on the akaike information criterion aic akaike 2011 specifically to compare the ntf models with a different number of sources we calculate for each of them the aic value to calculate aic we take from each of the sets of solutions with a different number of sources u k the best ntf solution and use the corresponding frobenius norm o k in the aic formula 9 aic 2 q 2 ln l 2 k mn k mn kmn ln o k kmn here the number of adjustable ntfk parameters q is equal to the number of components in the matrix w and the tensor g minus the number of constraints for each observation well time cf 6 which reduces the number of adjustable parameters thus we have q k 1 mn kk k mn k mn where k is the number of sources m is the number of wells and n is the number of the observation time frames l is the likelihood functions of the ntf solution with given k and we define it using the reconstruction error o k of the ntf solutions ln l kmn 2 ln o k kmn kmn is the total number of observational data points in the tensor c if there is missing data the empty tensor elements are not counted the aic is a measure of the relative quality of statistical models which takes into account both the likelihood function in our case determined by the reconstruction error and the independent degrees of freedom needed to achieve this level of likelihood the elements of the matrices w and h choosing the model that minimizes aic helps avoid overfitting in general aic decreases as the number of sources k increases typically aic substantially drops when k k s for k k s the aic values commonly plateau and do not exhibit substantial changes comparisons between different solutions using aic capture the parsimony principal models with a smaller number of parameters are favored when the reconstruction qualities of the models are similar in general both the average silhouette width s and aic should estimate the same number of sources k s if there is a discrepancy s based estimate is typically smaller than the aic based estimate this type of situation is discussed in the results section below in general the s based estimate of k s should be preferred because the solutions for k k s are potentially over fitting the data the ntfk algorithm is coded in julia and will be available as open source code soon it is fast and easy to use with the only user s input being the processed data tensor 3 results 3 1 ntfk analysis of synthetic data first we apply the ntfk unsupervised ml algorithm described above to identify the source concentrations from two synthetic randomly generated data sets representing scenarios generally consistent with real world conditions in terms of number of wells number of geochemical constituents and the number of temporal observations these two problems are presented in sections 3 1 1 and 3 1 2 they are applied to test the ntfk algorithm and demonstrate its general applicability here the concentrations are generated randomly and they do not represent an actual groundwater contaminant transport problem through the first two synthetic problems we also demonstrate that ntfk can be applied even in situations when the concentrations and respective mixing ratios vary erratically the third synthetic problem presented in the section 3 1 3 is designed to represent a groundwater contamination problem obtained through model simulation of an advective dispersive transport in an aquifer 3 1 1 example 1 3 sources 4 geochemical constituents 5 wells and 5 time frames we consider an example randomly generated to represent three unknown synthetic sources groundwater types the true concentrations of four geochemical constituents a b c d representing the three synthetic sources are presented in table 1 this is the true matrix w eq 7 these sources are mixed at each well using random mixing coefficient representing the core tensor g eq 7 the true w and g are applied to estimate the true concentrations c table 2 of four geochemical constituents a b c d at five monitoring wells and five different time frames here the measurement errors are assumed to be zero when we apply ntfk w and g are unknown the number of sources groundwater types is also unknown the only information provided to ntfk is data tensor c here and in the examples presented below the source concentrations and well mixing coefficients are generated using standard pseudo random number generation capabilities provided in julia bezanson et al 2014 the random numbers have uniform distribution between 0 and 1 for convenience and without loss of generality the source concentrations are scaled so that the maximum concentration at the sources for each species is 1 the random mixing coefficients are also scaled so that the mixing ratios for each well time frame add up to 1 as discussed above this requirement comes from the problem setup the groundwater concentrations at each well are expected to be defined by mixing of all the sources we used the data tensor c in ntfk to estimate the number of sources and reconstruct the unknown source concentrations and mixing coefficients at the wells over time to identity the number of sources the algorithm performs analyses where the number of sources k is equal to 2 3 and 4 for each of these 3 cases ntfk processes the reconstruction quality o silhouette width s and aic the results are presented in table 3 based on table 3 the number of sources is three this is estimated based on the behavior of the robustness silhouette width s and aic criteria the silhouette width s is close to 1 for the cases of 2 and 3 sources however it drops substantially for 4 sources this suggests that the solution for 4 sources is not stable and non unique therefore the solution for 3 sources should be preferred similarly aic shows a substantial drop between cases of 2 and 3 sources this also suggests that the solution with 3 sources should be selected the same conclusion can be also drawn here by the reconstruction quality clearly the solution for 3 sources produces a much better fit to the data than the solution for 2 sources the solution for 4 sources produces a slightly better match than the solution for 3 sources but using far more model parameters i e more degrees of freedom in this case the 3 source solution has 62 adjustable model parameters 5 5 2 3 4 while the 4 source solutions has 91 adjustable model parameters 5 5 3 4 4 there are only 100 observations 5 5 4 in all cases the ntfk estimated concentrations of the four geochemical constituents a b c d representing three synthetic sources are presented in table 1 as can be seen the algorithm accurately estimates the geochemical signatures of the sources it is also capable of accurately reproducing the observed concentrations table 2 the same synthetic problem was executed 1000 times with different randomly generated concentrations using different randomly generated mixing coefficients and species concentrations in all 1000 cases the algorithm correctly identified the true number of sources the minimum silhouette width s from the 1000 runs for k 3 was 0 951 the maximum silhouette width s for k 4 was 0 573 this demonstrates that the gap in the minimum silhouette width s between the optimal solution k 3 and the next solution with one extra source k 4 is sufficiently large and this criteria is adequate by itself to select the optimal number of sources in all the 1000 test cases the same synthetic problem was also rerun 1000 times adding random noise to the concentrations in the data tensor c the applied noise is normally distributed mean equal to zero and standard deviation equal to 0 01 representing random measurement errors again the algorithm correctly identified the true number of sources in all test cases the minimum silhouette width s from all the 1000 runs for k 3 was 0 593 the maximum silhouette width s for k 4 was 0 168 again in all the 1000 cases the solution for k 3 will be selected based on the silhouette width s 3 1 2 example 2 5 sources 8 geochemical constituents 12 wells and 12 time frames as a second test we consider an example randomly generated to represent five unknown synthetic sources groundwater types observed at 12 observation points over 12 time frames each source is represented by varying concentrations of 8 geochemical species the number of wells observation points time frames and geochemical species is consistent with the real problem presented in section 3 2 the random concentrations are generated following the procedure outlined in the previous section 3 1 2 the concentration data are perturbed by adding random noise from a normal distribution mean equal to zero and standard deviation equal to 0 01 representing measurement errors the concentration tensor c is provided to ntfk to estimate the number of sources and spatial temporal dynamics of the contaminant mixing based on ntfk results listed in table 4 the number of sources is five this is estimated by the behavior of the average silhouette width s and aic criteria as a function of the number of sources k the average silhouette width s is close to 1 for the cases when k 5 s drops slightly for k 5 but it is still close to 1 a substantial drop for s occurs for k 5 this suggests that the solution for more than 5 sources is non unique and depends strongly on the random initial guesses for the unknown components of matrix w and tensor g aic shows a substantial drop between cases of 4 and 5 sources this also suggests that the solution with 5 sources should be selected the same conclusion can be also drawn here by the reconstruction quality o clearly the solution for 5 sources produces a much better fit to the data than the solution for 4 sources the solution for 6 sources also produces a good match but based on the parsimony principal also captured by aic it should be rejected because it is using far more model adjustable parameters in this case the 5 source ntfk solution has 616 adjustable parameters 12 12 4 5 8 while the 6 source solution has 768 adjustable parameters 12 12 5 6 8 in all cases there are only 1152 observations 12 12 8 the same synthetic problem was rerun 1000 times with different randomly generated true concentrations c all the runs are performed adding random noise from a normal distribution mean equal to zero and standard deviation equal to 0 01 in all the 1000 cases the algorithm correctly identified the true number of sources the minimum silhouette width s from all the 1000 runs for k 5 was 0 870 the maximum silhouette width s for k 6 was 0 162 based on this in all the 1000 cases the solution for k 5 will be selected 3 1 3 example 3 3 sources 4 geochemical constituents 15 wells and 101 time frames ntfk is applied to analyze a synthetic groundwater contamination problem generated using a model simulating advective dispersive transport a map showing locations of monitoring wells providing data to characterize three point contaminant sources is presented in fig 2 the concentration of geochemical species released from the source are estimated using an analytical solution of three dimensional advective dispersive contaminant transport wexler and wexler 1992 park and zhan 2001 the concentrations are computed using open source codes anasol jl o malley and vesselinov 2018 and mads jl vesselinov and o malley 2016a vesselinov and o malley 2016b written in julia bezanson et al 2014 in these computations it is assumed that each of the three sources is characterized by four geochemical species a b c and d in addition there is also an unknown source representing the background concentrations of these species the true unknown concentrations in ppm of the geochemical species a b c and d are shown in table 5 the concentrations of the four geochemical species at the 15 monitoring wells are computed for 101 annual time frames from 0 to 100 years concentration curves for six of the monitoring wells are presented in fig 3 random uniform measurement errors of 10 have been added to the concentration data the flow and transport parameters applied to compute the contraction transient are advective linear pore velocity 10 m yr logitudinal dispersivity 70 m transverse horizontal dispersivity 15 m transverse vertical dispersivity 0 3 m porosity 0 1 contaminant flux 50 kg yr constant at each point source the first second and third sources are activated at times equal to 0 20 and 40 years the three dimensional data tensor with size 15 4 101 representing concentrations in 15 wells of 4 geochemical constituents for 101 time frames is analyzed using ntfk again this is the only information provided to the algorithm ntfk automatically identifies the number of sources 4 and the concentrations of geochemical species a b c and d at the 4 sources the results for parameters applied to estimate the number of sources are listed in table 6 clearly the aic drops substantially once the solution reaches 4 sources due to substantial decrease of the reconstruction quality o aic and o do not substantially improve for 5 sources the silhouette width s also declines below 1 for 5 sources which also indicated that the solution with 4 sources is the correct one the ntfk estimates of the source concentrations are shown in table 5 a comparison between the true and ntfk estimated concentrations for six of the wells are presented in fig 3 similarly the true and estimated mixing coefficients are presented in fig 4 the ntfk estimates provide a very good representation of the mixing coefficients at each well over time this demonstrates the capability of ntfk to predict the spatial and temporal dynamics of contaminant mixing the results for the other monitoring wells not shown in the figures are consistent with the results presented in figs 3 and 4 3 2 ntfk analysis of site data ntfk is applied to analyze the groundwater geochemistry data observed in the regional aquifer beneath the los alamos national laboratory lanl the aquifer is contaminated with chromium cr 6 and there are several contaminant sources that might have contributed to the contaminant plume beneath the lanl site near sandia and mortandad canyons fig 5 the investigation of the contaminant plume is ongoing vesselinov et al 2013 vesselinov et al n d b lanl 2009 lanl 2012 lanl 2018a the site conceptual model describing the physical and biogeochemical processes controlling the movement of groundwater and contaminants in the environment is presented in detail in vesselinov et al n d a lanl 2009 lanl 2012 lanl 2018a lanl 2018b it is important to note that due to site complexities it is unknown how many different contaminant sources groundwater types are mixed in the regional aquifer the geochemical signatures associated with these sources are also unknown in addition to chromium some of the contaminant sources are expected to have elevated tritium 3 h nitrate no 3 chloride cl and perchlorate clo 4 different contaminant sources are expected to have different geochemical signatures representing a mixture of different contaminants the contaminants have been released along los alamos sandia and mortandad canyons fig 5 however due to complexities of the three dimensional flow in vadose zone including perching horizons the contaminants have been mixed before they entered the regional aquifer in the general area between sandia and mortandad canyons fig 5 furthermore contaminant releases along the same canyon are expected to have different signatures over time due to transients in the infiltration and contaminant mass fluxes lanl 2018a a subset of the geochemical data collected at the site is applied for the ntfk analysis and is presented in fig 6 the data comes from 19 monitoring well screens r 67 r 14 1 r 1 r 15 r 62 r 43 1 r 43 2 r 42 r 28 r 50 1 r 11 r 45 1 r 45 2 r 44 1 r 13 r 35a r 35b r 36 and simr 2 the number after represent screen number within multi screen wells ordered vertically from top to bottom the screen names without indicate single screen wells the well order approximately follows the direction of the groundwater flow which is from west to east the data include representative measurements for eight geochemical species chromium cr chloride cl perchlorate clo 4 tritium 3 h nitrate no 3 calcium ca magnesium mg and sulfate so 4 other geochemical species have been measured at these wells however prior geochemical analyses of the site data lanl 2018a have identified the above subset of geochemical species to be the most representative of the site conditions the analyzed data represents annual averages for each year between 2005 and 2016 fig 6 annual averages are processed not due to methodological or computational limitations but due to irregularities in the sampling events the geochemical data are collected on a quarterly basis but sampling events are on different dates for different wells in addition there are numerous irregular sampling events due to general irregularity of the sampling events we computed yearly averages the final dataset includes 12 geochemical time snapshots in total note that there are gaps in the processed dataset fig 6 the dataset was analyzed using ntfk to define the potential groundwater sources groundwater types that are represented as geochemical mixtures in the monitoring data over time the ntfk analysis accounts for the mixing of different groundwater types where some of the types might be associated with background groundwater types and others might be caused by the contamination sources the ntfk results are presented in table 7 ntfk identifies 7 original groundwater sources with different geochemical composition are mixed in the aquifer this estimate is based on the silhouette width s values note that s 1 for k 7 the aic values suggest the existence of 7 sources as well the ntfk estimated concentrations of each of the eight geochemical species prior to mixing with regional aquifer water for the identified seven sources groundwater types are presented in table 8 these are the concentrations of the groundwater types that are mixed to reproduce the observed concentrations at the wells over time fig 6 shows the observed versus estimated geochemical concentrations at monitoring wells over time ntfk accurately reproduces the geochemical transients observed at all the site monitoring wells note that all the identified sources groundwater types have distinct geochemistry table 8 sources 1 2 4 5 and 6 are clearly associated with contaminant sources because of the presence of constituent concentrations above background source 1 has elevated values for cr cl no 3 ca mg and so 4 this is the main source of chromium that constitutes the majority of the plume footprint this source is a combination of releases on the ground surface along sandia canyon the estimated chromium concentration of about 3000 ppb is corroborated by the source concentrations estimated using hydrogeologic data and techniques lanl 2018a source 2 has elevated clo 4 which is a known contaminant released on the ground surface in mortandad canyon lanl 2009 lanl 2012 source 4 has increased no 3 and potentially comes from los alamos sandia or mortandad canyons source 5 has elevated 3 h cr cl ca mg and so 4 are also high this is potentially a mixed source where contaminants originating along los alamos sandia and mortandad canyons are mixing in perched groundwater horizons in the vadose zone before their arrival at the regional aquifer lanl 2009 lanl 2012 source 6 has elevated cl ca mg and so 4 and cr this might be groundwater originating from the same source as earlier chromium contaminated water released in sandia canyon since it has very low concentrations of 3 h the above interpretations of the ntfk estimated source groundwater types are consistent with the site conceptual model but provide new insights about the contaminant fate and transport at the site sources 3 and 7 table 8 represent the non contaminated groundwater signature in the plume area background groundwater types the variations in the mixing of these two background groundwater types represent variability in the background compositions potentially as a result of some mixing with contaminated groundwater sources the temporal dynamics of sources 3 and 7 may represent geochemical reactions occurring in the aquifer due to the mixing of groundwater with different geochemistry or heterogeneity in the aquifer materials causing changes in the groundwater geochemistry ntfk also provides estimates of the mixing dynamics of the sources over time the estimated temporal evolution of how the seven groundwater types are represented and mixed at each monitoring well is presented in fig 7 all seven groundwater types are observed at appreciable levels in only two of the monitoring wells r 42 and r 28 fig 7h and i these wells have the highest chromium concentrations fig 6h and i and are located in the center of the chromium plume fig 5 at both wells the mixing ratios for background source 7 are decreasing over time while the mixing ratios for contaminant source 6 are increasing over time source 4 at r 28 seems to be decreasing as well the r 42 transients may suggest a peak mixing ratio for sources 1 and 5 at r 42 in 2013 results for wells r 43 r 62 and r 67 upgradient from r 42 and r 28 fig 5 potentially represent recent arrival of contaminants in this area the mixing transients observed in the upper and lower screens in r 43 r 43 1 and r 43 2 respectively are very different r 43 1 is dominated by source 4 although the contribution seems to be diminishing in time while the contribution of contaminant source 1 appears to be sharply increasing fig 7f r 43 2 is observing increasing contributions of sources 4 and 6 fig 7g which might be caused by slow vertical groundwater flow and transport from shallow portions into deeper portions of the aquifer at r 62 the background source 7 is decreasing but the sources 1 2 4 and 5 are increasing fig 7e r 67 is dominated by background sources 3 and 7 but their contribution is decreasing fig 7a while the impact of source 4 is increasing which suggests a contaminant arrival fig 6a the further upgradient wells r 14 and r 1 fig 5 are dominated by background sources 3 and 7 fig 7b and c and there are no contaminant sources detected at these wells the near field downgradient wells from r 42 and r 28 r 50 1 r 11 r 45 1 r 45 2 r 44 1 r 13 and simr 2 also show transients that represent arrival of contaminated groundwater at r 50 1 the contributions of the background groundwater types are changing over time fig 7j and there is an increase in contaminated source 1 r 11 mixing ratios show increasing contributions of contaminated sources 4 and 6 fig 7k source 2 is going up while the sources 1 and 5 might be slightly going down in time at the upper screen of r 45 r 45 1 the contaminated sources 1 2 4 and 5 are increasing in contrast at the lower screen r 45 2 source 4 is decreasing over time the difference in the behavior of source 4 in r 45 1 increasing and r 45 2 decreasing potentially suggests complex groundwater flow transport conditions and or differences in the geochemical processes associated with different rock types within the regional aquifer r 44 1 is dominated by sources 3 4 and 7 fig 7n the contribution of sources 1 and 2 is slightly increasing r 13 shows fig 7o a slight increase of source 4 simr 2 is affected by low proportions of contaminant sources 2 4 and 6 fig 7s r 35b and r 35a are shallower and deeper wells screened at different depths next to an existing water supply well r 35b is completed close to the regional water table and contaminant sources 2 4 and 6 appear to be are present fig 7q the vertical location of the r 35a screen matches the top of supply wells louvers r 36b is dominated by background sources 3 and 7 however contaminant sources 2 and 6 are potentially present at this well in low proportions fig 7p r 36 is anomalous and very different from all the other wells all groundwater types are present here except source 1 fig 7r this is extremely surprising considering the well location and the mixing ratios observed at the nearby wells groundwater screened at r 36 may represent an area of infiltration with geochemical composition very different from all the other wells however a more probable explanation is that r 36 might be tapping groundwater in a perched saturated horizon in the vadose zone which is above the regional aquifer water table and detached from the regional aquifer sometime in the past in this case the water observed at r 36 may represent old aquifer groundwater which was flowing in the aquifer in the past before the perched zone was detached from the regional aquifer this interpretation is also corroborated by the water level data observed at r 36 lanl 2018a as a result r 36 is probably not representative of the aquifer conditions it is quite possible that very different contaminant conditions might exist within the regional aquifer at the location of r 36 r 15 is also very different from the other wells it is predominantly influenced by source 2 clo 4 which appears to show an increasing contribution over time fig 7d source 2 has been also detected at r 50 1 and simr 2 the analyses also suggest anomalous behavior in 2010 at r 43 2 fig 7g and in 2014 at r 28 fig 7i this might be caused by systematic errors associated with the field sampling of these two wells for example issues with bore hole water sampling systems systematic errors caused by laboratory sample analyses can be ruled out because most of the well samples are processed simultaneously in batches lanl 2018a alternative explanation is that these anomalies might represent the effects of field activities conducted at these wells lanl 2018a it is important to note that even though limited data are available for some of the wells e g r 67 fig 6a and simr 2 fig 6s the ntfk analyses are capable to extract meaningful information about the geochemical mixing at these wells the mixing information presented in fig 7 is also shown as spatial maps in fig 8 the maps depict the transient mixing ratios of the seven groundwater types sources identified as present at the site monitoring wells the maps show the mixing ratios of each source groundwater type the mixing ratios are estimated at the wells and interpolated in space between the wells using kriging the interpolation is performed for each temporal time frame separately an exponential variogram is applied with an integration scaling coefficient equal to 1000 m the maps represent 12 temporal snapshots of mixing different sources groundwater types from 2005 to 2016 based on the averaged geochemical data fig 6 based on the maps in fig 8 contaminant sources 1 5 and 6 are centered in the area of r 28 and r 42 the changes in the shape of the estimated spatial extent of these sources groundwater types are predominantly driven by the addition of new monitoring wells over the years see fig 6 the major difference between sources 1 5 and 6 is that source 5 is not dominant in r 62 and r 43 however sources 1 and 6 are present at r 62 and r 43 source 2 is centered in the area of r 15 source 4 is in the area of r 43 and r 11 it has been also observed in r 62 and r 15 however its impact seems to be diminishing at the r 62 r 15 area and increasing at r 11 in recent years the transients in the mixing ratios between 2008 and 2013 snapshots for source 4 in fig 8 may suggest impacts of lateral plume migration or shifts in the infiltration pathways within the vadose zone the background groundwater types captured as source 3 represents the temporal and spatial dynamics of the cl ca and mg geochemical species background source 7 represents the so 4 dynamics diminished background mixing ratios are shown in the center of the chromium plume area of the wells detecting sources 1 5 and 6 the temporal dynamics of the mixing ratios in the area of chromium plume represent shifts in the mixing of background and contaminated groundwater these dynamics can also represent geochemical processes occurring between water infiltrated from the vadose zone e g sources 1 5 and 6 interacting with the background regional groundwater the maps presented in fig 8 are unrealistic because the spatial distribution of the groundwater types contaminant plumes are expected to have much more complex shapes due to aquifer heterogeneity and complexity of the physical and geochemical processes impacting contaminant transport however even with this limitation they provide a visual representation of the potential plume shapes it is important to note that the ntfk analyses are very fast the results presented here take minutes to generate based on our site modeling experience lanl 2018a similar geochemical inverse model analyses of all the data presented here will take months of computational work the development and testing of the simulation models will make this process even longer for example the current lanl site model is open source and available at gitlab vesselinov et al 2018 the model includes more than 140 000 calibration targets of pressure and concentration transients and more than 200 adjustable model parameters estimated during the model calibration currently only the chromium transients are applied in the inversion process and the model calibration takes about a month in parallel utilizing up to 640 processors the ntfk results presented and discussed above are consistent with more complicated inverse analyses using numerical models applied to solve this problem vesselinov et al 2013 vesselinov et al n d b lanl 2012 lanl 2018a the results are also generally consistent with machine learning analyses obtained using a matrix based technique nmfk vesselinov et al n d a in the future the ntfk results will be applied as input to inverse analyses of site numerical models in this way instead of calibrating against all the geochemical data the numerical models would be calibrated against the ntfk predicted geochemical mixtures the anomalies detected at r 36 r 43 2 and r 28 through our unsupervised ml algorithm demonstrate its power for exploratory data analyses 4 conclusions we have developed a novel unsupervised machine learning ml method based on nonnegative tensor factorization ntf combined with a custom k means clustering called ntfk our work demonstrates the applicability of our ntfk algorithm for blind source separation bss ntfk has been applied to identify contaminant sources based on high dimensional tensor datasets representing spatial and temporal variation of observed geochemical species the ntfk approach is an extension of our matrix based machine learning methods presented in vesselinov et al n d a alexandrov and vesselinov 2014 our results demonstrate that ntfk can be applied to identify 1 the unknown number of groundwater types contaminant sources present in an aquifer 2 the original geochemical concentrations signatures of these groundwater types before their mixing in the aquifer and 3 spatial and temporal dynamics in the mixing of these groundwater types the inverse problem solved in the ntfk analysis is under determined to address this the ntfk algorithm thoroughly explores the plausible inverse solutions and seeks to narrow the set of possible solutions by estimating the number of contaminant source signals needed to robustly and accurately reconstruct the observed data in the synthetic tests we generated datasets representing unknown contaminant sources detected as a set of mixed signals groundwater types contamination sources at a series of monitoring wells detectors sensors and for a series of time frames snapshots using only the synthetic datasets representing the observed concentrations at the monitoring wells ntfk correctly identified the number of contaminant sources the geochemical signatures of the original groundwater types before being mixed and mixing coefficients at the wells over time we also applied ntfk on a real world dataset related to the lanl chromium contamination site the results of this analysis are consistent with previous data and model analyses conducted at the site vesselinov et al n d a vesselinov et al 2013 vesselinov et al n d b lanl 2012 lanl 2018a and provide additional insights we highlight two insights in particular the first is that the differences observed at the upper and lower screens r 43 suggest a late arriving contaminant source that has not had an opportunity to penetrate the deeper portion of the aquifer the lack of 3 h in r 43 1 indicates that this late arriving source in the regional aquifer may be associated with an early contaminant release that took a long time to move through the vadose zone the second is that the anomalous mixing ratios at r 36 indicate that it may be in a perched zone that is disconnected from the regional aquifer if so it may be beneficial to add a monitoring well near r 36 that goes deeper into the subsurface the anomalous hydrologic data at this location further corroborates the hypothesis that r 36 is disconnected from the aquifer lanl 2018a in addition to these insights the ntfk algorithm demonstrated its capabilities to identify systematic errors and anomalies in lanl site data ntfk allows the contaminant fields observed at a series of the detectors to be unmixed into a series of independent plumes with different geochemical signatures this results from the ntfk analyses can be applied to guide the conceptualization of the site conditions and the design of numerical models that are developed to represent these conditions in some cases decoupled model analyses might be applied to independently analyze the groundwater transport of each contaminant source which can be computationally much more efficient ntfk results coupled with model analysis can yield crucial information needed to 1 development of site contaminant fate and transport conceptual models 2 make predictions of contaminant behavior 3 assess contamination risks and 4 guide remediation strategies the ntfk analyses are fast and relatively easy to implement an open source code written in julia bezanson et al 2014 is in development and will be released soon all the analyses presented in the paper take several minutes to execute in serial since most of the computations are independent the algorithm can be performed also in parallel which further increases its computational efficiency and scalability it is important to note that the presented ntf analyses are following the classical bss formulation assuming a linear mixing problem however since the ntf problem is solved using nonlinear minimization procedure as discussed in section 2 1 the bss problem can be expanded to account for nonlinear mixing or geochemical processes this will increase the number of unknowns as well as the computational complexity but as long as data are available to represent nonlinear processes the bss problem can be solved we plan to extend our ml analyses to account for nonlinear processes in the future in summary the major pros of the proposed methodology are that it is fast scalable and unbiased it can be applied to tackle large high dimensional site datasets without prior site knowledge and assumptions the cons are that it assumes linearity in its current form and requires informative monitoring data if the latter is an issue our ml methodology can be applied to evaluate information content of the data and guide additional data collection strategies that can provide informative data the possible applications of the ntfk approach are not limited to groundwater contamination problems ntfk can be readily used to identify contaminant sources based on soil and air pollution data ntfk can be applied to analyze any mixture of ingredients in this case our constrained ntfk algorithm can be applied to identify the ingredients of the sources that are mixed to produce observed mixtures ntfk is applicable for unsupervised ml analyses for solving various types of data analytics problems including feature extraction and exploratory analyses ntfk can also be applied to large high dimensional datasets with constraints only related to physical memory of the computational resources that are used acknowledgments this research was funded by the environmental programs directorate and ldrd grants 20180060dr and 20190020dr of the los alamos national laboratory in addition velimir v vesselinov and daniel o malley were supported by the diamond project an integrated multifaceted approach to mathematics at the interfaces of data models and decisions u s department of energy office of science grant 11145687 this research used resources provided by the los alamos national laboratory institutional computing program which is supported by the u s department of energy national nuclear security administration the authors also want to acknowledge the excellent comments provided by the anonymous reviewers that substantially improved the manuscript 
1616,unsupervised machine learning ml is becoming increasingly popular for solving various types of data analytics problems including feature extraction blind source separation exploratory analyses model diagnostics etc here we have developed a new unsupervised ml method based on nonnegative tensor factorization ntf for identification of the original groundwater types including contaminant sources present in geochemical mixtures observed in an aquifer frequently groundwater types with different geochemical signatures are related to different background and or contamination sources the characterization of groundwater mixing processes is a challenging but very important task critical for any environmental management project aiming to characterize the fate and transport of contaminants in the subsurface and perform contaminant remediation this task typically requires solving complex inverse models representing groundwater flow and geochemical transport in the aquifer where the inverse analysis accounts for available site data usually the model is calibrated against the available data characterizing the spatial and temporal distribution of the observed geochemical types numerous different geochemical constituents and processes may need to be simulated in these models which further complicates the analyses additionally the application of inverse methods may introduce biases in the analyses through the assumptions made in the model development process here we substitute the model inversion with unsupervised ml analysis the ml analysis does not make any assumptions about underlying physical and geochemical processes occurring in the aquifer our ml methodology called ntfk is capable of identifying 1 the unknown number of groundwater types contaminant sources present in the aquifer 2 the original geochemical concentrations signatures of these groundwater types and 3 spatial and temporal dynamics in the mixing of these groundwater types these results are obtained only from the measured geochemical data without any additional site information in general the ntfk methodology allows for interpretation of large high dimensional datasets representing diverse spatial and temporal components such as state variables and velocities ntfk has been tested on synthetic and real world site three dimensional datasets the ntfk algorithm is designed to work with geochemical data represented in the form of concentrations ratios of two constituents for example isotope ratios and delta notations standard normalized stable isotope ratios keywords nonnegative tensor factorization tucker decomposition feature extraction exploratory analysis blind source separation robustness analysis unsupervised machine learning groundwater contamination source identification advection diffusion transport geochemical signatures 1 introduction characterizing contaminated groundwater sites presents a number of major challenges and these challenges have remained key areas of research in subsurface hydrology for several decades gelhar 1993 fetter and fetter 1999 vengosh et al 2014 one of the major challenges is the manifold of uncertainties that are present in these subsurface environments characterizing the source s of the contamination is often of paramount importance and this alone comes with uncertainties in the location geochemical signature and even the number of contaminant sources similarities in the geochemical signatures of different groundwater types geochemical interference between groundwater types and complex physical and geochemical processes advection diffusion dispersion sorption retardation precipitation phase partitioning biodegradation biogeochemical reactions etc during transport from the source location to the observation location often make source identification extremely challenging furthermore the geochemical measurement data are affected by random and systematic errors which additionally complicates the analyses the water at a given time and location in the subsurface is a mixture of water with different origins and geochemical signatures which we call groundwater types deutsch and siegel 1997 these groundwater types might be associated with potentially contaminated sources of groundwater recharge or different upstream regions in the subsurface which can be called background sources in addition groundwater flows through different regions of the subsurface with different rock types and geochemical properties that can modify its geochemical signatures via physical and chemical processes e g reactions and ion exchanges groundwater samples collected at multiple wells over time can be used to glean information about these groundwater types the identification of these groundwater types is an important task in characterizing a contaminated aquifer site wagner 1992 böhlke and denver 1995 lapworth et al 2012 the typical approach to identifying these groundwater types utilizes numerical models that simulate flow and transport in the aquifer and model calibration techniques to enable the model to accurately reproduce the observed site data wagner 1992 neupauer et al 2000 atmadja and bagtzoglou 2001 michalak and kitanidis n d guan et al 2006 mamonov and tsai 2013 hamdi and mahfoudhi 2013 murray bruce and dragotti 2014 borukhov and zayats 2015 these models are often very complex requiring the simulation of numerous geochemical constituents cf hammond et al 2014 hansen et al 2017 which can make these analyses computationally expensive often requiring compromises between fidelity to the physics chemistry and computational efficiency this is closely related to contaminant source zone identification for which numerous sophisticated methods have been developed one common approach uses partitioning tracers to estimate heterogeneous permeability and nonaqueous phase liquid saturation jin et al 1995 james et al 2000 zhang and graham 2001 yeh and zhu n d illman et al 2010 additionally these complex model based approaches often require the set up of site specific grids in real world cases gzyl et al 2014 the overarching theme of these approaches is to combine a numerical model with an optimization scheme ayvaz 2010 though sometimes model uncertainty is also considered sun et al 2006 recently methods for analyzing sources of groundwater contamination have been developed that utilize machine learning ml and statistical techniques chan and huang 2003 rasekh and brumbelow 2012 methods such as factor harman 1976 and principal component jolliffe 2002 analysis have been used to describe variations and evolution in the chemical composition of water types knudson et al 1977 helena et al 2000 in addition unsupervised ml techniques such as discriminant scholkopft and mullert 1999 and clustering diday and simon 1980 analysis can group objects into two or more classes shrestha and kazama 2007 tariq et al 2008 unsupervised ml based on nonnegative matrix factorization nmf methods throckmorton et al 2016 vesselinov et al n d a have been used to identify groundwater types and their mixing ratios another approach is to use supervised ml techniques such as neural networks yegnanarayana 2009 support vector machines drucker et al 1999 locally weighted projection regression vijayakumar and schaal 2000 and relevance vector machines tipping 2001 to replace or supplement the complex numerical models previously mentioned these ml developed models can be used to make predictions related at groundwater contamination sites khalil et al n d quasi optimal learning cervone et al 2010 has been used to explore a symbolic supervised ml classification method to understand the relationship between different chemical species in ground and surface water the drawback of the supervised ml methods compared to the unsupervised ml method is that they require extensive training based on subject matter expertise existing site data or physics model outputs the process is computationally intensive and can introduce bias in the analyses the unsupervised nonnegative tensor factorization ntf approach proposed here is similar to nonnegative matrix factorization nmf methods developed recently throckmorton et al 2016 vesselinov et al n d a to understand the advance from the nmf method to the ntf method we must first consider the structure of the data the data that are assimilated by these methods comes from the observation of 1 chemical species at different 2 locations and 3 times the nmf methods can only consider variability in two of these three components at once for example observations of different species at different locations but at a fixed time vesselinov et al n d a this comes from the fact that a matrix has two indices one can be associated with the locations and another with the species but none remains to be associated with the different times the ntf method allows for an arbitrary number of indices enabling it to consider variability in all three species location time providing an advantage compared to nmf both the nmf and ntf methods provide a means of analysis that does not rely on complex inverse models making it less computationally expensive and with fewer assumptions built in the main goal of the paper is to present and demonstrate the applicability of a novel unsupervised ml algorithm called ntfk ntfk performs a blind source separation bss analysis belouchrani et al 1997 based on nonnegative tensor factorization ntf cichocki et al 2009 combined with a custom clustering algorithm vesselinov et al n d a alexandrov and vesselinov 2014 here ntfk is applied to unmix the geochemical signatures in the observations and identify the contaminant sources as a result ntfk is capable of identifying 1 the unknown number of groundwater types contaminant sources present in the aquifer 2 the original geochemical concentrations signatures of these groundwater types and 3 spatial and temporal dynamics in the mixing of these groundwater types since the problem involves mixing ntfk here is implemented applying additional optimization constraints ntfk is a high dimensional extension of our existing matrix based nmfk methodology developed in throckmorton et al 2016 vesselinov et al n d a alexandrov and vesselinov 2014 using synthetic and real world site data we demonstrate that ntfk is capable of accurately determining the unknown number of contaminant sources from observation samples of their mixtures without any additional information in addition our methodology can also estimate the source locations based on the estimated mixing coefficients at the monitoring wells and monitoring well location coordinates our methodology also allows for generation of spatial and temporal maps of estimated contaminant mass distribution in the subsurface the ntfk methodology is coded in julia bezanson et al n d and an open source code implementing our algorithm will be released soon the ntfk algorithm works with geochemical data represented in the form of concentrations ratios of two constituents for example isotope ratios and delta notations standard normalized stable isotope ratios despite the methodological complexities discussed below the algorithm is fast and relatively easy to implement 2 methodology 2 1 blind source separation bss in the analyses discussed here we assume that the geochemical observations are taken at several detectors sampling points typically monitoring wells distributed in space when there are multiple contamination sources in the aquifer each detector registers a mixture of contamination fields plumes over time originating from different sources release locations our objective is to identify the unknown number of original contamination sources which necessitates decomposing the recorded transient mixtures to their original components through the ml analyses we also identify geochemical concentrations signatures of the original sources and characterize spatial and temporal dynamics in the mixing of contaminant sources in the aquifer these results are obtained only based on the observed concentration data without any other site information our novel unsupervised ml methodology ntfk is a method for feature extraction and exploratory analysis capable of revealing features hidden in data ntfk is based on ntf which is an emerging research area in the field of data analytics and data compression cichocki et al 2009 kolda and bader 2009 in addition to extracting hidden features that are buried in large high dimensional datasets ntf based methods are also used in blind source separation bss techniques are typically based on matrix factorization methods such as principal component analysis pca jolliffe 1986 independent component analysis ica amari et al 1996 and nmf paatero and tapper 1994 these techniques form a class of unsupervised machine learning ml methods that are instrumental in model free feature extraction and dimensionality reduction when a bss technique is applied in signal processing the extracted features are the unique original signals that form the mixtures recorded by a set of spatially distributed sensors e g the voices of several speakers recorded by multiple microphones placed at different locations in a ballroom haykin and chen 2005 however the matrix based methods are inherently deficient for examining high dimensional datasets i e tensor datasets which are natural extensions of the matrix datasets many real world datasets are high dimensional and often represent one or more state variables at a discrete set of locations in space and time and as a result are ideal for tensor based analyses there are multiple tensor factorization methods hitchcock 1927 harshman and lundy 1994 de lathauwer et al 2000 and among them we utilize the tucker decomposition tucker 1966 andersson and bro 2000 examples of tucker models for three dimensional datasets are presented in fig 1 note that multiple possible tucker models can be used there are 7 possible tucker models in the three dimensional case 1 with 3 factor matrices 3 with 2 factor matrices and 3 with 1 factor matrix to apply tucker decomposition to a given dataset we need to find not only which of the possible models to use but we also need to identify the size of core tensor g in fig 1 typically we do not have prior knowledge about the specific tucker model and the core size to find the optimal decomposition model and core size ntfk applies analyses of the ntf solution robustness and parsimony as discussed in section 2 2 below herein using ntfk we analyze three dimensional data that represent the evolution in time and space of concentrations of a series of geochemical species observed at a series of monitoring wells in time by tucker decomposition the analyzed data tensor c has three dimensions s w t where s indicates a geochemical species w a monitoring well and t an observation time the tucker 3 decomposition fig 1 of the three dimensional tensor c s w t 1 c s w t g w s h w v t ε w s t where denotes a tensor product the decomposition of the tensor c s w t c ℝ 0 k m n can be expressed by components 2 c ijl p 1 k q 1 m r 1 n g pqr w ip h jq v lr ε ijl i j l where all the elements of c g w h and v are nonnegative 3 c ijl g pqr w ip h jq v lr 0 i j l p q r here i ranges from 1 to k where k is the number of geochemical species j ranges from 1 to m where m is the number of monitoring wells and l ranges from 1 to n where n is the number of time frames snapshots the ntfk methodology allows the tensor c to be sparse i e some of the observations can be missing in this case the tucker decomposition includes i a core tensor g g ℝ 0 k m n that represents the interactions between the s w and t components of w s h w and v t ii a factor matrix w w ℝ 0 k k representing geochemical signatures of each groundwater type iii a factor matrix h h ℝ 0 m m accounting for dependence on the monitoring points and iv a factor matrix v v ℝ 0 n n that captures the time dependence ℝ 0 denotes the set of nonnegative real numbers ℝ 0 x ℝ x 0 additionally ε ε ℝ k m n in eq 2 denotes the unknown discrepancy between the original data c and the tucker estimate c c g w h v the discrepancy ε can be caused by the presence of random measurement errors in the data tensor c the discrepancy can also be caused by the inadequacy of the tucker decomposition c to represent the data the tucker decomposition c can be viewed as linear combinations of geochemical spatial well location and temporal features where each of these features can have any complex nonlinear shape the features are represented in the factor matrices w h and v and the linear combinations among them are given by the core tensor g if there are nonlinear interactions among the features ntfk cannot resolve them in its current form however for the geochemical analyses presented here nonlinear interactions were not needed to characterize data mathematically the solution of the nonnegative tucker tensor decomposition is a solution of a multi dimensional optimization problem with nonnegative constraints given by 4 min g w h v 0 c g w h v f 2 to extract the unknown core tensor g and factor matrices w h and v different optimization algorithms can be applied to solve the geochemical problems discussed here we reduce the nonnegative tucker 3 decomposition presented in eq 2 to tucker 1 where fig 1 5 c ijl p 1 k g pjl w ip ε ijl i j l now the tucker decomposition includes only i an unknown core tensor g g ℝ 0 k m n and ii an unknown factor matrix w w ℝ 0 k k representing the changes in c associated with geochemical species the species component here the w matrix can be viewed as a source matrix representing concentrations of k geochemical species in k contaminant sources groundwater types the core g represents the mixing ratios of these k contaminant sources groundwater types at each well over time for example g 1 2 3 will define the mixing ratio of the source groundwater type 1 in well 2 at time frame 3 therefore here we assume that the observational data c is formed by a linear mixing of k original signals represented by the source matrix w and blended by a mixing core tensor g at each observation point and time in addition we impose constraints on the core tensor elements 6 j 1 m g pjl 1 p l where we require that all the mixing ratios at each time for each monitoring point well add up to 1 these constraints represent conservation of mass to analyze the tensor c we utilize a constrained version of the sparse nonnegative tucker 1 decomposition model mørup et al 2008 our constraints are imposed so that the tensor decomposition accounts for the underlying mixing processes the constraints are similar to the approach applied by vesselinov et al n d a for the matrix factorization problem our choice for nonnegative constraints is motivated by i the fact that concentrations are inherently nonnegative and ii our goal to relate the extracted features to easily interpretable quantities without introducing any prior assumptions indeed a meaningful interpretation of the obtained results requires the extracted features to be parts of the original data lee and seung 1999 and the nonnegative constraints lead to extraction of strictly additive components which are parts of the original data ross and zemel 2006 thus ntfk has the ability to identify readily understandable structure preserving features that enable the discovery of new causal structures and unknown mechanisms hidden in the data cichocki et al 2009 2 2 ntfk algorithm the ntfk algorithm starts with a random guess for w and g elements and proceeds by minimizing the cost objective function o which in our case is the frobenius norm 7 o 1 2 c g w f 2 during each iteration minimizing the frobenius norm eq 7 with nonnegativity constraints eq 6 is equivalent to representing the discrepancies between the observations c and the reconstruction g w as white noise due to the constraints in eq 6 the classical multiplicative ntf optimization algorithms cichocki et al 2009 are not applicable instead a nonconvex nonlinear optimization algorithm is needed and for this purpose we utilized the nonlinear minimization procedure provided by julia packages jump jl and ipopt jl jump jl is a modeling language for mathematical optimization embedded in julia dunning et al n d it supports a number of open source and commercial solvers for a variety of optimization problems jump jl is coupled with ipopt interior point optimizer an open software package for large scale nonlinear optimization wächter 2002 wächter and biegler 2005 wächter and biegler 2006 here ipopt is applied to perform nonconvex constrained second order minimization if we knew the number of sources k solving eq 7 is all we need to perform the best solution of eq 7 we would estimate matrix tensor elements and solve the inverse problem however the true number of sources is typically unknown and thus the number of the sources is an unknown parameter which we have to identify from the observations a naive approach would be to 1 explore all of the possible solutions of eq 7 for a range of a possible number of sources k and 2 select the solution with the smallest norm to identify the number of sources k s however this is a flawed approach more free parameters higher k will generally lead to a better fit irrespective of how close the estimated number of sources is to the actual number of sources this would cause the naive approach to over estimate the number of sources to resolve this issue ntfk considers all possible numbers of sources k ranging from 1 to d k 1 2 d for each value of k z different factorizations are performed with different random initial guesses ntfk then estimates the accuracy and robustness of the large set of solutions z with a different number of sources in ntfk the maximum number of explored sources d should not exceed the expected number of observed geochemical components k although theoretically the minimization algorithm used here can be applied for any k 1 thus ntfk performs z sets of simulations called ntf runs where each run is using a different number of sources k 1 2 d with random initial guesses for all the unknown matrix tensor elements at the end of each ntf run we get a set of z solutions u k where each solution contains two arrays the matrix w k j and the tensor g k j for k original sources and j 1 2 z 8 u k w k 1 g k 1 w k 2 g k 2 w k z g k z after that ntfk leverages a custom clustering algorithm to assign each of these z solutions in a given set u d to one of k specific clusters this clustering method is based on k means clustering that keeps the number of solutions in each cluster equal to the number of ntf runs cf vesselinov et al n d a alexandrov and vesselinov 2014 for example for the case with k 2 after the execution of z 1 000 ntf runs performed with random initial guesses for the w and g elements each of the two clusters will contain 1 000 solutions in the cases when the ntf problem is under parametrized i e low number of sources the final solution is generally not very sensitive to the random initial guesses this suggests there is a single global minimum which can be identified regardless of the initial guesses for matrix tensor elements in the cases when the ntf problem is over parametrized i e high number of sources the final solution is generally very sensitive to the initial guesses this suggests that potentially there are multiple local global minima which are identified using random initial guesses note that we have to enforce the condition that the clusters have an equal number of solutions since each ntf simulation contributes an equal number of solutions for each source during the clustering the similarity between sources w i1 and w i2 is measured using the cosine distance vesselinov et al n d a alexandrov and vesselinov 2014 pang ning et al 2006 the cosine distance measures the angle between the two sources and effectively ignores their magnitude the main idea for estimating the unknown number of sources in ntfk is to use the separation between the clusters as a measure of how good a particular choice of k is as an accurate estimate of the number of unknown sources we estimate the degree of clustering for a different number of sources and plot it as a function of k and we expect a sharp drop after we cross k s the optimal number of sources vesselinov et al n d a alexandrov and vesselinov 2014 to quantify this behavior after the clustering we compute a measure s k called the average silhouette width rousseeuw 1987 of how well the solutions are clustered for a given number of original sources k this measure of how well clustered the ntfk solutions are for different values of k can be applied to evaluate the optimal number of contaminant sources k s in general s k declines as k increases theoretically s k varies between 1 and 1 when s k is close to 1 that indicates that the data is well clustered i e the average distance between points within a cluster is small compared to the average distance between points in different clusters as s k decreases the quality of the clusters decreases typically s k declines sharply after the optimal number of contaminant sources k s is reached in ntfk in addition to the robustness the average reconstruction error eq 7 is used to evaluate the accuracy with which the derived average cluster solutions w k a g k a reproduce the observations c in general the solution accuracy increases while the solution robustness decreases when k goes up hence the average silhouette width and frobenius norm for each of the k cluster solutions can be used to define the optimal number of contaminant sources k s specifically k s can be set equal to the minimum number of sources that accurately reconstruct the observations i e the frobenius norm is less than a given value or hit a plateau and the clusters of solutions are sufficiently robust e g the average silhouette width s is bigger than 0 8 when some of the source geochemical compositions are very close to each other or do not demonstrate clear features it is also useful to formulate another criteriion for the ntfk solution robustness which is based on the akaike information criterion aic akaike 2011 specifically to compare the ntf models with a different number of sources we calculate for each of them the aic value to calculate aic we take from each of the sets of solutions with a different number of sources u k the best ntf solution and use the corresponding frobenius norm o k in the aic formula 9 aic 2 q 2 ln l 2 k mn k mn kmn ln o k kmn here the number of adjustable ntfk parameters q is equal to the number of components in the matrix w and the tensor g minus the number of constraints for each observation well time cf 6 which reduces the number of adjustable parameters thus we have q k 1 mn kk k mn k mn where k is the number of sources m is the number of wells and n is the number of the observation time frames l is the likelihood functions of the ntf solution with given k and we define it using the reconstruction error o k of the ntf solutions ln l kmn 2 ln o k kmn kmn is the total number of observational data points in the tensor c if there is missing data the empty tensor elements are not counted the aic is a measure of the relative quality of statistical models which takes into account both the likelihood function in our case determined by the reconstruction error and the independent degrees of freedom needed to achieve this level of likelihood the elements of the matrices w and h choosing the model that minimizes aic helps avoid overfitting in general aic decreases as the number of sources k increases typically aic substantially drops when k k s for k k s the aic values commonly plateau and do not exhibit substantial changes comparisons between different solutions using aic capture the parsimony principal models with a smaller number of parameters are favored when the reconstruction qualities of the models are similar in general both the average silhouette width s and aic should estimate the same number of sources k s if there is a discrepancy s based estimate is typically smaller than the aic based estimate this type of situation is discussed in the results section below in general the s based estimate of k s should be preferred because the solutions for k k s are potentially over fitting the data the ntfk algorithm is coded in julia and will be available as open source code soon it is fast and easy to use with the only user s input being the processed data tensor 3 results 3 1 ntfk analysis of synthetic data first we apply the ntfk unsupervised ml algorithm described above to identify the source concentrations from two synthetic randomly generated data sets representing scenarios generally consistent with real world conditions in terms of number of wells number of geochemical constituents and the number of temporal observations these two problems are presented in sections 3 1 1 and 3 1 2 they are applied to test the ntfk algorithm and demonstrate its general applicability here the concentrations are generated randomly and they do not represent an actual groundwater contaminant transport problem through the first two synthetic problems we also demonstrate that ntfk can be applied even in situations when the concentrations and respective mixing ratios vary erratically the third synthetic problem presented in the section 3 1 3 is designed to represent a groundwater contamination problem obtained through model simulation of an advective dispersive transport in an aquifer 3 1 1 example 1 3 sources 4 geochemical constituents 5 wells and 5 time frames we consider an example randomly generated to represent three unknown synthetic sources groundwater types the true concentrations of four geochemical constituents a b c d representing the three synthetic sources are presented in table 1 this is the true matrix w eq 7 these sources are mixed at each well using random mixing coefficient representing the core tensor g eq 7 the true w and g are applied to estimate the true concentrations c table 2 of four geochemical constituents a b c d at five monitoring wells and five different time frames here the measurement errors are assumed to be zero when we apply ntfk w and g are unknown the number of sources groundwater types is also unknown the only information provided to ntfk is data tensor c here and in the examples presented below the source concentrations and well mixing coefficients are generated using standard pseudo random number generation capabilities provided in julia bezanson et al 2014 the random numbers have uniform distribution between 0 and 1 for convenience and without loss of generality the source concentrations are scaled so that the maximum concentration at the sources for each species is 1 the random mixing coefficients are also scaled so that the mixing ratios for each well time frame add up to 1 as discussed above this requirement comes from the problem setup the groundwater concentrations at each well are expected to be defined by mixing of all the sources we used the data tensor c in ntfk to estimate the number of sources and reconstruct the unknown source concentrations and mixing coefficients at the wells over time to identity the number of sources the algorithm performs analyses where the number of sources k is equal to 2 3 and 4 for each of these 3 cases ntfk processes the reconstruction quality o silhouette width s and aic the results are presented in table 3 based on table 3 the number of sources is three this is estimated based on the behavior of the robustness silhouette width s and aic criteria the silhouette width s is close to 1 for the cases of 2 and 3 sources however it drops substantially for 4 sources this suggests that the solution for 4 sources is not stable and non unique therefore the solution for 3 sources should be preferred similarly aic shows a substantial drop between cases of 2 and 3 sources this also suggests that the solution with 3 sources should be selected the same conclusion can be also drawn here by the reconstruction quality clearly the solution for 3 sources produces a much better fit to the data than the solution for 2 sources the solution for 4 sources produces a slightly better match than the solution for 3 sources but using far more model parameters i e more degrees of freedom in this case the 3 source solution has 62 adjustable model parameters 5 5 2 3 4 while the 4 source solutions has 91 adjustable model parameters 5 5 3 4 4 there are only 100 observations 5 5 4 in all cases the ntfk estimated concentrations of the four geochemical constituents a b c d representing three synthetic sources are presented in table 1 as can be seen the algorithm accurately estimates the geochemical signatures of the sources it is also capable of accurately reproducing the observed concentrations table 2 the same synthetic problem was executed 1000 times with different randomly generated concentrations using different randomly generated mixing coefficients and species concentrations in all 1000 cases the algorithm correctly identified the true number of sources the minimum silhouette width s from the 1000 runs for k 3 was 0 951 the maximum silhouette width s for k 4 was 0 573 this demonstrates that the gap in the minimum silhouette width s between the optimal solution k 3 and the next solution with one extra source k 4 is sufficiently large and this criteria is adequate by itself to select the optimal number of sources in all the 1000 test cases the same synthetic problem was also rerun 1000 times adding random noise to the concentrations in the data tensor c the applied noise is normally distributed mean equal to zero and standard deviation equal to 0 01 representing random measurement errors again the algorithm correctly identified the true number of sources in all test cases the minimum silhouette width s from all the 1000 runs for k 3 was 0 593 the maximum silhouette width s for k 4 was 0 168 again in all the 1000 cases the solution for k 3 will be selected based on the silhouette width s 3 1 2 example 2 5 sources 8 geochemical constituents 12 wells and 12 time frames as a second test we consider an example randomly generated to represent five unknown synthetic sources groundwater types observed at 12 observation points over 12 time frames each source is represented by varying concentrations of 8 geochemical species the number of wells observation points time frames and geochemical species is consistent with the real problem presented in section 3 2 the random concentrations are generated following the procedure outlined in the previous section 3 1 2 the concentration data are perturbed by adding random noise from a normal distribution mean equal to zero and standard deviation equal to 0 01 representing measurement errors the concentration tensor c is provided to ntfk to estimate the number of sources and spatial temporal dynamics of the contaminant mixing based on ntfk results listed in table 4 the number of sources is five this is estimated by the behavior of the average silhouette width s and aic criteria as a function of the number of sources k the average silhouette width s is close to 1 for the cases when k 5 s drops slightly for k 5 but it is still close to 1 a substantial drop for s occurs for k 5 this suggests that the solution for more than 5 sources is non unique and depends strongly on the random initial guesses for the unknown components of matrix w and tensor g aic shows a substantial drop between cases of 4 and 5 sources this also suggests that the solution with 5 sources should be selected the same conclusion can be also drawn here by the reconstruction quality o clearly the solution for 5 sources produces a much better fit to the data than the solution for 4 sources the solution for 6 sources also produces a good match but based on the parsimony principal also captured by aic it should be rejected because it is using far more model adjustable parameters in this case the 5 source ntfk solution has 616 adjustable parameters 12 12 4 5 8 while the 6 source solution has 768 adjustable parameters 12 12 5 6 8 in all cases there are only 1152 observations 12 12 8 the same synthetic problem was rerun 1000 times with different randomly generated true concentrations c all the runs are performed adding random noise from a normal distribution mean equal to zero and standard deviation equal to 0 01 in all the 1000 cases the algorithm correctly identified the true number of sources the minimum silhouette width s from all the 1000 runs for k 5 was 0 870 the maximum silhouette width s for k 6 was 0 162 based on this in all the 1000 cases the solution for k 5 will be selected 3 1 3 example 3 3 sources 4 geochemical constituents 15 wells and 101 time frames ntfk is applied to analyze a synthetic groundwater contamination problem generated using a model simulating advective dispersive transport a map showing locations of monitoring wells providing data to characterize three point contaminant sources is presented in fig 2 the concentration of geochemical species released from the source are estimated using an analytical solution of three dimensional advective dispersive contaminant transport wexler and wexler 1992 park and zhan 2001 the concentrations are computed using open source codes anasol jl o malley and vesselinov 2018 and mads jl vesselinov and o malley 2016a vesselinov and o malley 2016b written in julia bezanson et al 2014 in these computations it is assumed that each of the three sources is characterized by four geochemical species a b c and d in addition there is also an unknown source representing the background concentrations of these species the true unknown concentrations in ppm of the geochemical species a b c and d are shown in table 5 the concentrations of the four geochemical species at the 15 monitoring wells are computed for 101 annual time frames from 0 to 100 years concentration curves for six of the monitoring wells are presented in fig 3 random uniform measurement errors of 10 have been added to the concentration data the flow and transport parameters applied to compute the contraction transient are advective linear pore velocity 10 m yr logitudinal dispersivity 70 m transverse horizontal dispersivity 15 m transverse vertical dispersivity 0 3 m porosity 0 1 contaminant flux 50 kg yr constant at each point source the first second and third sources are activated at times equal to 0 20 and 40 years the three dimensional data tensor with size 15 4 101 representing concentrations in 15 wells of 4 geochemical constituents for 101 time frames is analyzed using ntfk again this is the only information provided to the algorithm ntfk automatically identifies the number of sources 4 and the concentrations of geochemical species a b c and d at the 4 sources the results for parameters applied to estimate the number of sources are listed in table 6 clearly the aic drops substantially once the solution reaches 4 sources due to substantial decrease of the reconstruction quality o aic and o do not substantially improve for 5 sources the silhouette width s also declines below 1 for 5 sources which also indicated that the solution with 4 sources is the correct one the ntfk estimates of the source concentrations are shown in table 5 a comparison between the true and ntfk estimated concentrations for six of the wells are presented in fig 3 similarly the true and estimated mixing coefficients are presented in fig 4 the ntfk estimates provide a very good representation of the mixing coefficients at each well over time this demonstrates the capability of ntfk to predict the spatial and temporal dynamics of contaminant mixing the results for the other monitoring wells not shown in the figures are consistent with the results presented in figs 3 and 4 3 2 ntfk analysis of site data ntfk is applied to analyze the groundwater geochemistry data observed in the regional aquifer beneath the los alamos national laboratory lanl the aquifer is contaminated with chromium cr 6 and there are several contaminant sources that might have contributed to the contaminant plume beneath the lanl site near sandia and mortandad canyons fig 5 the investigation of the contaminant plume is ongoing vesselinov et al 2013 vesselinov et al n d b lanl 2009 lanl 2012 lanl 2018a the site conceptual model describing the physical and biogeochemical processes controlling the movement of groundwater and contaminants in the environment is presented in detail in vesselinov et al n d a lanl 2009 lanl 2012 lanl 2018a lanl 2018b it is important to note that due to site complexities it is unknown how many different contaminant sources groundwater types are mixed in the regional aquifer the geochemical signatures associated with these sources are also unknown in addition to chromium some of the contaminant sources are expected to have elevated tritium 3 h nitrate no 3 chloride cl and perchlorate clo 4 different contaminant sources are expected to have different geochemical signatures representing a mixture of different contaminants the contaminants have been released along los alamos sandia and mortandad canyons fig 5 however due to complexities of the three dimensional flow in vadose zone including perching horizons the contaminants have been mixed before they entered the regional aquifer in the general area between sandia and mortandad canyons fig 5 furthermore contaminant releases along the same canyon are expected to have different signatures over time due to transients in the infiltration and contaminant mass fluxes lanl 2018a a subset of the geochemical data collected at the site is applied for the ntfk analysis and is presented in fig 6 the data comes from 19 monitoring well screens r 67 r 14 1 r 1 r 15 r 62 r 43 1 r 43 2 r 42 r 28 r 50 1 r 11 r 45 1 r 45 2 r 44 1 r 13 r 35a r 35b r 36 and simr 2 the number after represent screen number within multi screen wells ordered vertically from top to bottom the screen names without indicate single screen wells the well order approximately follows the direction of the groundwater flow which is from west to east the data include representative measurements for eight geochemical species chromium cr chloride cl perchlorate clo 4 tritium 3 h nitrate no 3 calcium ca magnesium mg and sulfate so 4 other geochemical species have been measured at these wells however prior geochemical analyses of the site data lanl 2018a have identified the above subset of geochemical species to be the most representative of the site conditions the analyzed data represents annual averages for each year between 2005 and 2016 fig 6 annual averages are processed not due to methodological or computational limitations but due to irregularities in the sampling events the geochemical data are collected on a quarterly basis but sampling events are on different dates for different wells in addition there are numerous irregular sampling events due to general irregularity of the sampling events we computed yearly averages the final dataset includes 12 geochemical time snapshots in total note that there are gaps in the processed dataset fig 6 the dataset was analyzed using ntfk to define the potential groundwater sources groundwater types that are represented as geochemical mixtures in the monitoring data over time the ntfk analysis accounts for the mixing of different groundwater types where some of the types might be associated with background groundwater types and others might be caused by the contamination sources the ntfk results are presented in table 7 ntfk identifies 7 original groundwater sources with different geochemical composition are mixed in the aquifer this estimate is based on the silhouette width s values note that s 1 for k 7 the aic values suggest the existence of 7 sources as well the ntfk estimated concentrations of each of the eight geochemical species prior to mixing with regional aquifer water for the identified seven sources groundwater types are presented in table 8 these are the concentrations of the groundwater types that are mixed to reproduce the observed concentrations at the wells over time fig 6 shows the observed versus estimated geochemical concentrations at monitoring wells over time ntfk accurately reproduces the geochemical transients observed at all the site monitoring wells note that all the identified sources groundwater types have distinct geochemistry table 8 sources 1 2 4 5 and 6 are clearly associated with contaminant sources because of the presence of constituent concentrations above background source 1 has elevated values for cr cl no 3 ca mg and so 4 this is the main source of chromium that constitutes the majority of the plume footprint this source is a combination of releases on the ground surface along sandia canyon the estimated chromium concentration of about 3000 ppb is corroborated by the source concentrations estimated using hydrogeologic data and techniques lanl 2018a source 2 has elevated clo 4 which is a known contaminant released on the ground surface in mortandad canyon lanl 2009 lanl 2012 source 4 has increased no 3 and potentially comes from los alamos sandia or mortandad canyons source 5 has elevated 3 h cr cl ca mg and so 4 are also high this is potentially a mixed source where contaminants originating along los alamos sandia and mortandad canyons are mixing in perched groundwater horizons in the vadose zone before their arrival at the regional aquifer lanl 2009 lanl 2012 source 6 has elevated cl ca mg and so 4 and cr this might be groundwater originating from the same source as earlier chromium contaminated water released in sandia canyon since it has very low concentrations of 3 h the above interpretations of the ntfk estimated source groundwater types are consistent with the site conceptual model but provide new insights about the contaminant fate and transport at the site sources 3 and 7 table 8 represent the non contaminated groundwater signature in the plume area background groundwater types the variations in the mixing of these two background groundwater types represent variability in the background compositions potentially as a result of some mixing with contaminated groundwater sources the temporal dynamics of sources 3 and 7 may represent geochemical reactions occurring in the aquifer due to the mixing of groundwater with different geochemistry or heterogeneity in the aquifer materials causing changes in the groundwater geochemistry ntfk also provides estimates of the mixing dynamics of the sources over time the estimated temporal evolution of how the seven groundwater types are represented and mixed at each monitoring well is presented in fig 7 all seven groundwater types are observed at appreciable levels in only two of the monitoring wells r 42 and r 28 fig 7h and i these wells have the highest chromium concentrations fig 6h and i and are located in the center of the chromium plume fig 5 at both wells the mixing ratios for background source 7 are decreasing over time while the mixing ratios for contaminant source 6 are increasing over time source 4 at r 28 seems to be decreasing as well the r 42 transients may suggest a peak mixing ratio for sources 1 and 5 at r 42 in 2013 results for wells r 43 r 62 and r 67 upgradient from r 42 and r 28 fig 5 potentially represent recent arrival of contaminants in this area the mixing transients observed in the upper and lower screens in r 43 r 43 1 and r 43 2 respectively are very different r 43 1 is dominated by source 4 although the contribution seems to be diminishing in time while the contribution of contaminant source 1 appears to be sharply increasing fig 7f r 43 2 is observing increasing contributions of sources 4 and 6 fig 7g which might be caused by slow vertical groundwater flow and transport from shallow portions into deeper portions of the aquifer at r 62 the background source 7 is decreasing but the sources 1 2 4 and 5 are increasing fig 7e r 67 is dominated by background sources 3 and 7 but their contribution is decreasing fig 7a while the impact of source 4 is increasing which suggests a contaminant arrival fig 6a the further upgradient wells r 14 and r 1 fig 5 are dominated by background sources 3 and 7 fig 7b and c and there are no contaminant sources detected at these wells the near field downgradient wells from r 42 and r 28 r 50 1 r 11 r 45 1 r 45 2 r 44 1 r 13 and simr 2 also show transients that represent arrival of contaminated groundwater at r 50 1 the contributions of the background groundwater types are changing over time fig 7j and there is an increase in contaminated source 1 r 11 mixing ratios show increasing contributions of contaminated sources 4 and 6 fig 7k source 2 is going up while the sources 1 and 5 might be slightly going down in time at the upper screen of r 45 r 45 1 the contaminated sources 1 2 4 and 5 are increasing in contrast at the lower screen r 45 2 source 4 is decreasing over time the difference in the behavior of source 4 in r 45 1 increasing and r 45 2 decreasing potentially suggests complex groundwater flow transport conditions and or differences in the geochemical processes associated with different rock types within the regional aquifer r 44 1 is dominated by sources 3 4 and 7 fig 7n the contribution of sources 1 and 2 is slightly increasing r 13 shows fig 7o a slight increase of source 4 simr 2 is affected by low proportions of contaminant sources 2 4 and 6 fig 7s r 35b and r 35a are shallower and deeper wells screened at different depths next to an existing water supply well r 35b is completed close to the regional water table and contaminant sources 2 4 and 6 appear to be are present fig 7q the vertical location of the r 35a screen matches the top of supply wells louvers r 36b is dominated by background sources 3 and 7 however contaminant sources 2 and 6 are potentially present at this well in low proportions fig 7p r 36 is anomalous and very different from all the other wells all groundwater types are present here except source 1 fig 7r this is extremely surprising considering the well location and the mixing ratios observed at the nearby wells groundwater screened at r 36 may represent an area of infiltration with geochemical composition very different from all the other wells however a more probable explanation is that r 36 might be tapping groundwater in a perched saturated horizon in the vadose zone which is above the regional aquifer water table and detached from the regional aquifer sometime in the past in this case the water observed at r 36 may represent old aquifer groundwater which was flowing in the aquifer in the past before the perched zone was detached from the regional aquifer this interpretation is also corroborated by the water level data observed at r 36 lanl 2018a as a result r 36 is probably not representative of the aquifer conditions it is quite possible that very different contaminant conditions might exist within the regional aquifer at the location of r 36 r 15 is also very different from the other wells it is predominantly influenced by source 2 clo 4 which appears to show an increasing contribution over time fig 7d source 2 has been also detected at r 50 1 and simr 2 the analyses also suggest anomalous behavior in 2010 at r 43 2 fig 7g and in 2014 at r 28 fig 7i this might be caused by systematic errors associated with the field sampling of these two wells for example issues with bore hole water sampling systems systematic errors caused by laboratory sample analyses can be ruled out because most of the well samples are processed simultaneously in batches lanl 2018a alternative explanation is that these anomalies might represent the effects of field activities conducted at these wells lanl 2018a it is important to note that even though limited data are available for some of the wells e g r 67 fig 6a and simr 2 fig 6s the ntfk analyses are capable to extract meaningful information about the geochemical mixing at these wells the mixing information presented in fig 7 is also shown as spatial maps in fig 8 the maps depict the transient mixing ratios of the seven groundwater types sources identified as present at the site monitoring wells the maps show the mixing ratios of each source groundwater type the mixing ratios are estimated at the wells and interpolated in space between the wells using kriging the interpolation is performed for each temporal time frame separately an exponential variogram is applied with an integration scaling coefficient equal to 1000 m the maps represent 12 temporal snapshots of mixing different sources groundwater types from 2005 to 2016 based on the averaged geochemical data fig 6 based on the maps in fig 8 contaminant sources 1 5 and 6 are centered in the area of r 28 and r 42 the changes in the shape of the estimated spatial extent of these sources groundwater types are predominantly driven by the addition of new monitoring wells over the years see fig 6 the major difference between sources 1 5 and 6 is that source 5 is not dominant in r 62 and r 43 however sources 1 and 6 are present at r 62 and r 43 source 2 is centered in the area of r 15 source 4 is in the area of r 43 and r 11 it has been also observed in r 62 and r 15 however its impact seems to be diminishing at the r 62 r 15 area and increasing at r 11 in recent years the transients in the mixing ratios between 2008 and 2013 snapshots for source 4 in fig 8 may suggest impacts of lateral plume migration or shifts in the infiltration pathways within the vadose zone the background groundwater types captured as source 3 represents the temporal and spatial dynamics of the cl ca and mg geochemical species background source 7 represents the so 4 dynamics diminished background mixing ratios are shown in the center of the chromium plume area of the wells detecting sources 1 5 and 6 the temporal dynamics of the mixing ratios in the area of chromium plume represent shifts in the mixing of background and contaminated groundwater these dynamics can also represent geochemical processes occurring between water infiltrated from the vadose zone e g sources 1 5 and 6 interacting with the background regional groundwater the maps presented in fig 8 are unrealistic because the spatial distribution of the groundwater types contaminant plumes are expected to have much more complex shapes due to aquifer heterogeneity and complexity of the physical and geochemical processes impacting contaminant transport however even with this limitation they provide a visual representation of the potential plume shapes it is important to note that the ntfk analyses are very fast the results presented here take minutes to generate based on our site modeling experience lanl 2018a similar geochemical inverse model analyses of all the data presented here will take months of computational work the development and testing of the simulation models will make this process even longer for example the current lanl site model is open source and available at gitlab vesselinov et al 2018 the model includes more than 140 000 calibration targets of pressure and concentration transients and more than 200 adjustable model parameters estimated during the model calibration currently only the chromium transients are applied in the inversion process and the model calibration takes about a month in parallel utilizing up to 640 processors the ntfk results presented and discussed above are consistent with more complicated inverse analyses using numerical models applied to solve this problem vesselinov et al 2013 vesselinov et al n d b lanl 2012 lanl 2018a the results are also generally consistent with machine learning analyses obtained using a matrix based technique nmfk vesselinov et al n d a in the future the ntfk results will be applied as input to inverse analyses of site numerical models in this way instead of calibrating against all the geochemical data the numerical models would be calibrated against the ntfk predicted geochemical mixtures the anomalies detected at r 36 r 43 2 and r 28 through our unsupervised ml algorithm demonstrate its power for exploratory data analyses 4 conclusions we have developed a novel unsupervised machine learning ml method based on nonnegative tensor factorization ntf combined with a custom k means clustering called ntfk our work demonstrates the applicability of our ntfk algorithm for blind source separation bss ntfk has been applied to identify contaminant sources based on high dimensional tensor datasets representing spatial and temporal variation of observed geochemical species the ntfk approach is an extension of our matrix based machine learning methods presented in vesselinov et al n d a alexandrov and vesselinov 2014 our results demonstrate that ntfk can be applied to identify 1 the unknown number of groundwater types contaminant sources present in an aquifer 2 the original geochemical concentrations signatures of these groundwater types before their mixing in the aquifer and 3 spatial and temporal dynamics in the mixing of these groundwater types the inverse problem solved in the ntfk analysis is under determined to address this the ntfk algorithm thoroughly explores the plausible inverse solutions and seeks to narrow the set of possible solutions by estimating the number of contaminant source signals needed to robustly and accurately reconstruct the observed data in the synthetic tests we generated datasets representing unknown contaminant sources detected as a set of mixed signals groundwater types contamination sources at a series of monitoring wells detectors sensors and for a series of time frames snapshots using only the synthetic datasets representing the observed concentrations at the monitoring wells ntfk correctly identified the number of contaminant sources the geochemical signatures of the original groundwater types before being mixed and mixing coefficients at the wells over time we also applied ntfk on a real world dataset related to the lanl chromium contamination site the results of this analysis are consistent with previous data and model analyses conducted at the site vesselinov et al n d a vesselinov et al 2013 vesselinov et al n d b lanl 2012 lanl 2018a and provide additional insights we highlight two insights in particular the first is that the differences observed at the upper and lower screens r 43 suggest a late arriving contaminant source that has not had an opportunity to penetrate the deeper portion of the aquifer the lack of 3 h in r 43 1 indicates that this late arriving source in the regional aquifer may be associated with an early contaminant release that took a long time to move through the vadose zone the second is that the anomalous mixing ratios at r 36 indicate that it may be in a perched zone that is disconnected from the regional aquifer if so it may be beneficial to add a monitoring well near r 36 that goes deeper into the subsurface the anomalous hydrologic data at this location further corroborates the hypothesis that r 36 is disconnected from the aquifer lanl 2018a in addition to these insights the ntfk algorithm demonstrated its capabilities to identify systematic errors and anomalies in lanl site data ntfk allows the contaminant fields observed at a series of the detectors to be unmixed into a series of independent plumes with different geochemical signatures this results from the ntfk analyses can be applied to guide the conceptualization of the site conditions and the design of numerical models that are developed to represent these conditions in some cases decoupled model analyses might be applied to independently analyze the groundwater transport of each contaminant source which can be computationally much more efficient ntfk results coupled with model analysis can yield crucial information needed to 1 development of site contaminant fate and transport conceptual models 2 make predictions of contaminant behavior 3 assess contamination risks and 4 guide remediation strategies the ntfk analyses are fast and relatively easy to implement an open source code written in julia bezanson et al 2014 is in development and will be released soon all the analyses presented in the paper take several minutes to execute in serial since most of the computations are independent the algorithm can be performed also in parallel which further increases its computational efficiency and scalability it is important to note that the presented ntf analyses are following the classical bss formulation assuming a linear mixing problem however since the ntf problem is solved using nonlinear minimization procedure as discussed in section 2 1 the bss problem can be expanded to account for nonlinear mixing or geochemical processes this will increase the number of unknowns as well as the computational complexity but as long as data are available to represent nonlinear processes the bss problem can be solved we plan to extend our ml analyses to account for nonlinear processes in the future in summary the major pros of the proposed methodology are that it is fast scalable and unbiased it can be applied to tackle large high dimensional site datasets without prior site knowledge and assumptions the cons are that it assumes linearity in its current form and requires informative monitoring data if the latter is an issue our ml methodology can be applied to evaluate information content of the data and guide additional data collection strategies that can provide informative data the possible applications of the ntfk approach are not limited to groundwater contamination problems ntfk can be readily used to identify contaminant sources based on soil and air pollution data ntfk can be applied to analyze any mixture of ingredients in this case our constrained ntfk algorithm can be applied to identify the ingredients of the sources that are mixed to produce observed mixtures ntfk is applicable for unsupervised ml analyses for solving various types of data analytics problems including feature extraction and exploratory analyses ntfk can also be applied to large high dimensional datasets with constraints only related to physical memory of the computational resources that are used acknowledgments this research was funded by the environmental programs directorate and ldrd grants 20180060dr and 20190020dr of the los alamos national laboratory in addition velimir v vesselinov and daniel o malley were supported by the diamond project an integrated multifaceted approach to mathematics at the interfaces of data models and decisions u s department of energy office of science grant 11145687 this research used resources provided by the los alamos national laboratory institutional computing program which is supported by the u s department of energy national nuclear security administration the authors also want to acknowledge the excellent comments provided by the anonymous reviewers that substantially improved the manuscript 
1617,geochemical reactions taking place at the rock surface and pore water interface and rapid preferential water flow through waste rock piles are identified as two primary steps for acid rock drainage ard and metal leaching ml processes this paper part i develops a water film model to describe the interactions among sulphide minerals pore water and oxygen which considers the reactive surface areas as the primary sites to capture geochemical reactions including sulphide oxidation and neutralization reactions and also considers acid and metal ion storage in pore water in addition the proposed water film model is further coupled with a pile scale mass transport model to investigate a specific case of the main waste rock pile at the equity silver mine canada overall the simulated profile of oxygen concentration matches the historical monitoring data the modeling results revealed potential controlling mechanisms for ard generation inside the waste rock pile and provided insights into the impact of an engineered cover on the waste rock pile keywords water film model geochemical reactions mass transport acid rock drainage waste rock pile equity silver mine 1 introduction waste rocks are produced in mining operations in particular open pit mines they are placed at or near mine sites forming waste rock piles they can pose environmental hazards and can have high management costs over time waste rock piles accumulate in volume and can contain over one hundred million tonnes with an areal extent over square kilometers waste rocks are also produced by civil construction projects such as highways railways airports and hydroelectric structures many waste rocks contain sulphide minerals such as pyrite pyrrhotite sphalerite galena arsenopyrite chalcopyrite tetrahedrite and molybdenite once sulphide minerals are exposed to oxygen and water they oxidize and dissolved metal ions protons and sulphate ions can be remobilized to surface water and groundwater it is common that the ph value of waste rock pile drainage is as low as 2 4 mayer 2017 and metal ion concentrations such as copper zinc and aluminum can be as high as a few hundred to a few thousand mg l significantly higher than water quality criteria morin et al 2012 when this happens drainage from the waste rock pile has to be collected and treated for meeting mine drainage release regulations this problem is called acid rock drainage and metal leaching ard ml it is in the interest of the mining industry and governments to predict ard ml through time so that the long term cost associated with ard ml and the pollution of surface water and groundwater by ard ml can be minimized modeling and numerical simulation is one of the methods that have been developed and used for predicting ard ml overviews of the basic concepts of modeling and numerical simulation of ard ml are given by lefebvre et al 2001a pantelis et al 2002 molson et al 2005 fala et al 2005 da silva et al 2009 and mayer 2017 the most important aspect of a set of models is how well they can represent the physical processes of full scale waste rock piles and their boundary conditions generally speaking capturing geochemical reactions taking place at the interfaces between rock surfaces and liquid pore water is essential for accurately predicting drainage chemistry another essential process is to capture water flow through a waste rock pile to simulate the geochemical reactions of sulphide minerals a reasonably accurate representation of reality should address reaction areas the availability of reactants oxygen water and ferric ions and the storage of the reaction products reaction core models levenspiel 1972 davis and ritchie 1986 elberling et al 1994 lefebvre et al 2001b use the rock particle s radius as the primary variable for capturing the surface areas for geochemical reactions and mass transport phenomena of rocks in particular for capturing the diffusion of oxygen into rocks from their surfaces this concept could work well when used for simulating hydrometallurgical processes however the radius of waste rock fragments is difficult to characterize in the field as waste rock grain size can vary from a micrometer clay size fraction to meter scale boulders in addition recent experimental evidence suggests that oxidation and leaching from large particles occur only at the surface and in subsurface regions which are accessible from the surface by cracks ghorbani et al 2001 as cracks develop inside large particles during weathering the reaction core models may not well represent the scenarios in the field this first paper part i proposes a particle level water film model in which surface area is used as the primary variable for capturing geochemical reactions including sulphide oxidation and neutralization reactions and also for capturing the major phenomena of acid and metal ion storage coupled with pile scale mass transport model the geochemical reactions inside a full scale waste rock pile can be evaluated furthermore a second paper part ii will present an integrated approach to predict leachate chemistry for ard ml by accurately modeling preferential flows and groundwater through waste rock piles 2 ard ml processes in waste rock piles a variety of coupled physical geochemical and microbial processes control the generation of ard ml the processes include transport of 1 air and oxygen 2 heat 3 water 4 acidification neutralization reactions and also 5 microbial activities the exposure of the rock surface to the air provides oxygen for the oxidation reactions this exposure also provides water to the oxidation reactions since the gas phase in the pores contains water moisture that can condense and or evaporate on the rock surface when water moisture condenses on the rock surface it is in the form of tiny water droplets or a very thin water film also when it rains water infiltrates through waste rock piles and some rocks would become wet with a thin film of water on their surfaces in addition this would raise relative humidity of the gas phase inside the waste rock pile and can produce more condensed water droplets on the rock surface when external groundwater flows into and through the waste rock pile rocks below the water table are saturated however some rocks just above the water table would become wet due to capillary rise from the water table and the temporal variability of the water table introduces water and air to other rock surfaces in addition groundwater that flows through the bottom part of the waste rock pile would carry downward migrating reaction products in general water flow through the unsaturated waste rock can be characterized as two types of flow li 1999 amos et al 2015 1 matrix flow through the network made of a finer grained matrix of low hydraulic conductivity and 2 macro pore or non capillary flow through the network composed of coarser channels of high hydraulic conductivity the flow mechanism is strongly controlled by the material properties of the waste rock and the hydrological conditions particularly the magnitude and timing of precipitation and infiltration events perkins et al 1995 amos et al 2015 for geochemical reactions and heat generation current models focus on matrix flow because most of the particle surface area resides inside many piles typically having a lower proportions of coarse channels matrix flow is dominated by capillary or surface tension forces a triple phase boundary water oxygen and sulphide minerals in the pore networks is considered as the reactor for the generation of acid rock drainage the acid and metal ions produced within the oxidation stage are stored inside the water film on rock surfaces and or water droplets trapped in pores and rock cracks the latter macro pore water flow is referred to as channeling preferential flow and stratification by nichol et al 2005 and amos et al 2015 which is controlled by gravity viscous and inertia forces where flow is rapid and channelized the interaction between pore water and preferential flow determines the leachate chemistry our approach to calculate the leachate chemistry for ard ml is to model the geochemical reactions on the sites in contact with pore water part i to model preferential flow through the entire waste rock pile separately and then couple the geochemical reactions with mass transport of preferential flow together part ii 3 water film models 3 1 concept of water film models consider a rock particle inside a waste rock pile the rock particle contains sulphide minerals which appear on the rock surface and inside the rock in the form of discrete small patches the contribution of sulphide minerals inside the rock to the geochemical reactions is neglected as they are far away from the triple phase boundary to reach reactants so reaction rates and rates of transporting products out are assumed to be much lower than those occurring on the rock surfaces the above described surfaces have to be captured in order to accurately simulate the geochemical reactions here the above surfaces are simplified into a thin water film covering a rock surface that contains sulphide minerals on one side of the water film is the rock surface the other side faces the gas phase in the pore network extending throughout the entire waste rock pile in general fig 1 shows the concept of the entire water film model in terms of abiotic acid generation the aqueous oxidation of sulphide minerals particularly pyrite by dissolved oxygen and ferric ions were considered to take place on the water rock interface bottom surface bs which separates the water film and rock particles the geochemical reactions and the corresponding abiotic kinetics are given as otwinowski 1994 williamson and rimstidt 1994 1 2fes 2 7o 2 2h 2 o 2fe 2 4so 4 2 4h 2 k bs fes 2 10 8 19 o 2 0 5 h 0 11 mol m 2 s 3 14 fe 3 fes 2 8h 2 o 15 fe 2 2so 4 2 16 h 4 k bs fe 3 10 8 58 fe 3 0 3 fe 2 0 47 h 0 32 mol m 2 s to consider the effect of neutralization processes in the water film model a dissolution rate on the bottom water rock interface to release equivalent of calcium carbonate can be simply estimated as a polynomial function of ph according to palandri and kharaka 2004 as 5 k bs co 3 2 k bs ca 2 f neu ph in addition the following geochemical reaction was included within the water film domain to consider the oxidation of ferrous to ferric iron 6 4fe 2 o 2 4h 4fe 3 2h 2 o the corresponding oxidation rate in the water film wf for eq 6 can be estimated from singer and stumm 1970 as 7 q wf fe 2 2 91 10 9 1 33 10 12 oh 2 p o 2 fe 2 mol m 3 s where p o2 in eq 7 is the oxygen partial pressure atm which can be approximately estimated by 8 p o 2 o 2 h where h is the henry s law constant moreover the ionization equilibrium equations for water and equivalent neutralization ions have also been integrated in the water film model as follows 9 h oh h2o 10 h co3 2 hco3 11 h hco3 h2o co2 in order to investigate how oxygen and other ions migrate within the water film the following species diffusion equation in the solution phase was adopted here 12 t c wf i d i c wf i q wf i where c wf i is the concentration for species i in the water film d i is the corresponding diffusion coefficient within the water phase and q wf i sink or source term represents a generation or consumption rate for each species inside the water film the value of d i can be found in the reference cussler 1997 to validate the proposed model a set of experiments from michael and hubert 1986 was simulated by using the water film models and their testing data is used to compare with the simulation results in micheal s experiments 3 g prepared pyrite immersed in 800 ml prepared oxidant solutions of ferric and oxygen from the schematic diagram of experimental apparatus used in their study the effective thickness of water film is estimated about 3 cm the total pyrite active surface area were also measured which is about 750 cm2 the oxidation rates for pyrite under 100 and 21 ambient oxygen concentration at ph 1 9 were measured in addition a series of oxidation rates at 100 ambient oxygen concentration from different ph were also measured the quantitative comparison between measurements and the curve fitted by simulation results are given in fig 2 and fig 3 respectively which shows reasonable agreement 3 2 parametric studies using the water film model in this section parametric studies on the oxygen concentration at the water air surface and on the thickness of the water film were performed to determine how these factors impact on overall oxidation reactions inside the water film according to onsite monitoring data the oxygen concentration within the waste rock pile could vary from near zero to ambient oxygen concentration thus fractions of 10 50 and 100 of the ambient oxygen concentration were studied in addition the thickness of the water film is typically 10 to 100 μm perkins et al 1995 as a result three scenarios with 10 μm 100 μm and 500 μm thickness were also selected to investigate the effect of the water film thickness the results of the parametric studies are shown in figs 4 and 5 fig 4 shows that when the water film thickness is fixed at 100 μm the accumulated oxygen consumption inside the water film accelerates with the increase of oxygen concentration on the top of the water film which is consistent with the relationship shown in eq 2 in fig 5 the relative oxygen concentration is fixed at 50 while the thickness of water film varies it is observed that the 10 μm water film has a higher reaction rate in the beginning because the oxygen diffuses faster through a thinner water film however eq 2 also indicates that the ard reaction rate is inversely proportion to the acid concentration as the volume of the thinner water film is much smaller the acid concentration goes up faster than in the thicker water film the reaction rate for a 10 μm water film eventually is exceeded by 100 μm and 500 μm scenarios in general the results from these parametric studies illustrate that the water film model is able to capture the concerning geochemical reactions and mass transport mechanisms at particle level 4 pile scale mass transport model the water film model simulates geochemical reactions on the waste rock surface contacting water the supply of reactants transport of products and reactive heat in the full waste rock pile are then calculated using a fully coupled mass transport model described in this section the pile scale mass transport model is mainly for simulating matrix and air flows in pore networks product transport in pore water oxygen convection and reactive heat conduction and convection 4 1 matrix and air flows to describe the pattern of matrix and air flows in pore networks two phase darcy s law was applied to consider the capillary effects from both air and water phases here the saturation of each phase s α is defined as the fraction of the pore space occupied by a given fluid 13 s α θ α φ where θ α is the volume content for phase α and φ is the porosity here the sum of the air and water saturations must be equal to one 14 s a s w 1 in addition the definition of effective saturation for phase α is also given as following 15 s eα s α s α min s α max s α min the capillary pressure in the pore is defined as the pressure difference between water and air at the darcy scale the capillary pressure is commonly assumed to be a function of the water saturation 16 p c p a p w p c s ew the relationship between capillary pressure and water saturation is called the water retention curve for which van genuchten 1980 introduced a very well known form 17 p c s ew p g s ew 1 m g 1 1 n g where p g is defined as the capillary entry pressure the exponents m g and n g with their linkage are related to the pore size distribution by applying darcy s law the velocities of air and water inside the pile can be determined using 18 q α k α s α μ α p α ρ α g k α s α h α where k α and k α are permeability and conductivity tensors which depend on the saturation of the phase α h α is the fluid potential the permeability under unsaturated conditions k α in eq 18 is different from that for saturated conditions k sα in the porous structure if m g 1 1 n g is assumed mualem 1976 proposed that the relative permeability functions of air and water phases in the waste rock pile can also be deduced from the water saturation as given below 19 k a s a k sa k ra s ew k sa 1 s ew κ 1 s ew 1 m g 2 m g 20 k w s w k sw k rw s ew k sw s ew κ 1 1 s ew 1 m g m g 2 where the connectivity factor κ can be treated as a fitting parameter of the model in the waste rock pile the water density ρ w for darcy s equation is considered as constant and also the air density ρ a can be estimated by 21 ρ a p t p a rt where r 8 31447j mol k is the universal gas constant 4 2 reactant and product transport with matrix and air flow to investigate the transport of all geochemical species in the matrix water phase related to ard ml processes inside a waste rock pile a general species transport equation is adopted as 22 t θ w c i θ w d i c i q w c i q i where c i and d i are the concentration and diffusion coefficient for species i q w is the darcy velocity and q i sink or source term is the generation or consumption rate similarly the supply of oxygen with air flow concentration c o 2 to geochemical reactions can be calculated as 23 t θ a c o 2 d o 2 c o 2 q a c o 2 q o 2 4 3 heat transfer to consider the effect of reaction heat and cyclic ambient temperature on ard ml processes the equation for heat transfer in the waste rock pile is also included 24 c p ρ t t c w ρ w t q w k t q h where c p is the specific heat capacity q h denotes the heat generation rate from geochemical reactions the effective mass density ρ and the effective thermal conductivity k are defined as 25 c p ρ φρ w s w c w 1 φ ρ s c s 26 k k dry s w k wet k dry where c w and c s are heat capacities for water and solid waste rock particles k dry and k wet are the thermal conductivities for waste rocks in dry and wet conditions respectively 5 coupling between water film model and pile scale mass transport model fig 6 summarizes the functions of the pile transport model and the coupling with the water film model at each function in eqs 22 and 23 q i and q o2 are coupled with the water film model respectively in eq 24 q h is the heat generation rate calculated from the water film model based on the theory of mass conservation an assumption was made that the parameters for the pile scale mass transport model and the particle scale water film model can be coupled together in the following way 27 q i mol m 3 s k us i mol m 2 s β m 2 m 3 γ δ where q i denotes the sink or source term for species i in the pile model k us i is the inward or outward flux for species i at the upper surface us in the water film model β is the surface to volume ratio measured from waste rock pile γ is area ratio for sulphide minerals on the surface of waste rock particle and δ is the area ratio for water coverage on the waste rock surface in real engineering practice β γ and δ are dynamic and it is difficult to measure and monitor them inside the waste rock pile parameter calibration may be required at current stage which may limit the applications of the proposed model regarding the area ratio for water coverage δ it is roughly assumed to be proportional to the water content θ w 28 δ θ w φ where φ is the porosity of the waste rock pile in the pile scale mass transport model the ambient temperature and infiltration rate are applied as boundary conditions temperature oxygen and water content concentration distributions are calculated and proton ion concentrations are the outcomes from the coupled models 6 case study of the main waste rock pile at equity silver mine 6 1 application of the models to the waste rock pile at equity silver mine in this section the water film model coupled with the pile scale mass transport model are applied to the waste rock pile at the equity silver mine as an example to illustrate the capabilities of the proposed coupling models all models are built and implemented in the commercial software package comsol 5 3a the equity silver mine site is described in detail in aziz and ferguson 1997 the site is located in the central interior of british columbia canada and contains approximately 80 million tons of waste rock covering an area of approximately 1 4 km2 the waste rock piles of the equity silver mine have been producing acid rock drainage with high concentrations of metal ions since the 1980s the temperature and oxygen concentrations at different lateral locations and different depths of the waste rock piles have been constantly monitored since 1990 which has provided valuable information to understand the acid generating and metal leaching processes in the field extensive research has been conducted at the equity silver since the 1990s o kane et al 1995 herasymuik 1996 saretzky 1998 morin et al 2010 2012 these studies have focused on hydrogeological characterization cover system modeling modeling of infiltration and drainage chemistry etc nevertheless the ard ml processes within the equity silver waste rock are still not fully understood full scale monitoring shows the spatial and temporal complexities of the mobile pore gases within the piles which need further study the equity silver mine is situated on a plateau in a humid alpine environment the mine site elevation is about 1300 m historical site records indicate that the average annual precipitation is about 600 mm with approximate 60 of the precipitation occurring as snow which occurs from november to april snow starts to melt in april the rainy season starts from late april and ends by the end of june a soil cover system was installed on the waste rock piles during 1990 1994 with an average thickness of 0 5 m of compacted till and 0 3 m of uncompacted till for reducing the amount of infiltrated water and oxygen the precipitation and ambient temperature data at the equity silver mine site can be retrieved from the website of the environment canada however some data for the time period before 1991 was incomplete as a result the data starting from jan 1991 to jan 2001 was applied for the simulation which is plotted in fig 7 the simulation was initialized by a simplified uniform condition and the first 3 years simulated the uncovered conditions to establish the initial geochemical reactions and mass transport conditions inside the waste rock pile starting from jan 1994 the effect of the soil cover system was included in the simulation which is consistent with the completion time for the real cover installation on the main pile the calculations continued until jan 2001 to simulate seven years for the scenario with the soil cover system the parameters used for the case study are given in table 1 which are mainly from previous characterization work at the equity silver mine and data from similar mine sites study except for intrinsic air and water permeability most of properties for the cover system is not available so same value to waste rock was adopted in the simulation for simplification a 2 d cross section in the main dump as shown in fig 8 the red line was simulated in this study the schematic of the cross section is plotted in fig 9 with more geometry information the monitoring point p 7 17 m depth is at the left side of the 2d section which is approximately considered as the center of the main dump all of the waste rocks are piled on a bedrock slope the height of the pile is around 50 m and the width is about 1000 m the model mesh consists of totally 1843 cells and the whole simulation lasts for 73 h 26 min and 52 s intel xeon e5 1650 v4 ram 64g for matrix flow calculation the boundary condition bc on the top side of the domain was defined as a flow rate calculated based on total precipitation data times a net infiltration rate the net infiltration rate was estimated as 40 before the cover was installed a 5 infiltration rate was used after the cover was placed o kane et al 1995 later studies show there is more than 5 passing through but the actual number is still not clear the bc for the bottom side was assumed to be the water table which means fully saturated below this boundary in terms of the air flow in the waste rock pile the bcs that enclose the whole waste rock pile are defined as open air pressure the elevation dependent air pressure is given in the form of 29 p p 0 exp gmh rt where m 0 0289644kg mol is the molar mass of the air h is the elevation and p 0 is the pressure at h 0 which represents the sea level regarding the thermal calculation for the waste rock pile the profile of ambient temperature shown in fig 7 is set for the thermal bc on the top side of the pile for simplicity the thermal bc for the bottom side is considered to be insulated as reaction heat is generated inside the waste rock pile due to the oxidation of sulphide air convection must be considered for oxygen transport as a result both air inflow and outflow may exist on the top surface of the pile and open boundary conditions for oxygen transport are applied as follows 30 n d o 2 c o 2 0 if n q a 0 c o 2 c o 2 atm if n q a 0 6 2 results and discussions due to limited information on site characterization and conditions not all of the parameters can be directly measured in the field or estimated from other mine sites for example β and γ in eq 27 are difficult to characterize in practice however they are critical to the evaluation of total reaction rates for the ard processes involved as a result a parametric sweep for β m2 m3 γ was performed to find a calibrated value that enables the simulated temperature profile inside the waste rock pile to match the pattern observed from monitoring data fig 10 shows the measured temperature profile at 4 m 11 m and 17 m depth at p 7 location from 1994 to 1995 when the cover was just installed in field with minimum impact from the ambient environment the temperature near the pile core may better reflect the total reaction rate in the waste rock pile so the deepest monitoring temperature at 17 m depth of the p 7 point is used for this calibration based on the simulation results β m2 m3 γ is calibrated to 4000 1 m for the waste rock pile to simplify the calculation a constant water film thickness of 100 μm was used since the range of variation of water content is very small less than 5 for the matrix flow saretzky 1998 noel and ritchie 1999 eqs 2 4 and 7 show that the total acid generation is directly related to the oxygen consumption and potential of neutralization as the cycle of ambient temperature during a year may change the air convection as well as the oxygen supply in the waste rock pile analyzing the competition of oxygen consumption and oxygen supply becomes essential to understand the limiting factors in ard process as shown in the monitoring data of the waste rock pile morin et al 2010 2012 the oxygen concentration in air phase within the pile fluctuates through the seasons fig 11 shows the comparison of oxygen concentration between measurement and simulation at 17 m depth of the p 7 point it should be repeated that the effect of a cover system was applied starting from january 1994 in the model whereas the real cover system onsite was progressively installed from 1990 to 1993 the shaded area in fig 11 is thus the initialization process of the simulation the first observation is that starting from january 1994 the simulated oxygen concentration has a similar fluctuation pattern to that observed high concentration in winter and low concentration in summer measurements are missing from winter 1996 to spring 1997 but it is believed that the oxygen concentration rose during this period based on its historical trend another observation is that the simulated oxygen concentration decreases on average during the first several years after the installation of the cover system while the measurements also show a similar downward trend note that real grain size distribution groundwater flow pattern and rate real water infiltration rate water content distribution and microbial activity inside the piles etc are still not clear due to lack of characterization data or difficult to measure on site therefore it s difficult for the simulation results to completely match the monitoring data point by point but matching the trend of the monitoring data can still reveal the mechanisms controlling the ard generation processes the explanation for above observations is that the installed cover system significantly changed the air flow pathway in the waste rock pile fig 12 shows the oxygen concentration and the air flow unscaled vector driven by convection in dec 1993 right before the cover installation in the simulation the convective flow entered into the pile through the bottom toe area and eventually vented out from the top of the pile as a result oxygen concentrations gradually decreased along the air flow pathway due to ard reaction consumption figs 13 and 14 illustrate the corresponding status in dec 1996 and aug 1997 respectively the results indicate that the low permeability cover seemed to successfully block the main air flow outlet on the top side as a result the air had to circulate within the pile which increased the length of the air flow pathway and reduced the average oxygen concentration level in the pile fig 13 also indicates that in the winter it is possible that some fresh air penetrates through the top side into the waste rock pile with inverse air flow which is a result of air density change driven by a temperature difference meanwhile the effect of oxygen diffusion which is originally suppressed at the top side due to air outflow may resume and additionally enhance the oxygen penetration as the air flow is inverted from outflow to inflow at this stage this observation indicates that diffusive and advective oxygen transports may be dominant under different conditions in the pile which is consistent to the conclusions from the studies by binning et al 2007 molins and mayer 2007 in conclusion after the cover was installed the air outflow at the top of the pile is almost blocked by the cover when oxygen is depleted at the end of the air flow pathway in the top region diffusion of oxygen starts to play a dominant role and increases the oxygen concentration the competition of oxygen consumption and supply causes the annual fluctuation furthermore fig 15 illustrates the total amount of acidity generated from ard reactions within the cross section the plot shows that the total amount of acidity generation also fluctuated after the cover was installed which is due to oxygen concentration fluctuation the current model only considers matrix flow while the leaching process related to channeling flow and the effect of lateral external groundwater inflow is not considered these two factors will be studied in our future work 7 conclusions to comprehensively understand the physical and chemical processes involved in ard ml generation in waste rock piles a particle level water film model and a pile scale mass transport model is presented in this paper the water film model considers the impact of water film thickness oxygen concentration as well as geochemical kinetics on the total ard ml generation at the particle level which is fully coupled with a pile scale mass transport model dealing with reactant product transport and also heat transfer the water film model was validated with the experiments in literature parametric studies on the water film model were performed and the results indicate that the effects of water saturation thickness of the water film and ph level on local geochemical reaction rate are included which shows the advantages of the model in addition the developed model is coupled into a pile scale mass transport model to investigate ard ml generation in the main waste rock pile at the equity silver mine the observations from the case study shows that the simulated oxygen concentration has the same annual fluctuation pattern with the monitoring data which means the proposed model is capable of capturing the main ard chemical and physical mechanisms through analyzing the simulation data it is confirmed that the cover system increases the length of the air flow pathway through the pile thus reduces the average oxygen concentration level and the total geochemical reaction rate inside the pile the proposed model can be a useful and effective tool to optimize waste rock pile configurations and evaluate the design of cover systems to prevent or reduce ard ml generation acknowledgement the authors gratefully acknowledge mr mike o kane and dr lindsay tallon from m a o kane consultants inc for valuable technical discussions and constructive comments on the research carried out at the equity silver mine site 
1617,geochemical reactions taking place at the rock surface and pore water interface and rapid preferential water flow through waste rock piles are identified as two primary steps for acid rock drainage ard and metal leaching ml processes this paper part i develops a water film model to describe the interactions among sulphide minerals pore water and oxygen which considers the reactive surface areas as the primary sites to capture geochemical reactions including sulphide oxidation and neutralization reactions and also considers acid and metal ion storage in pore water in addition the proposed water film model is further coupled with a pile scale mass transport model to investigate a specific case of the main waste rock pile at the equity silver mine canada overall the simulated profile of oxygen concentration matches the historical monitoring data the modeling results revealed potential controlling mechanisms for ard generation inside the waste rock pile and provided insights into the impact of an engineered cover on the waste rock pile keywords water film model geochemical reactions mass transport acid rock drainage waste rock pile equity silver mine 1 introduction waste rocks are produced in mining operations in particular open pit mines they are placed at or near mine sites forming waste rock piles they can pose environmental hazards and can have high management costs over time waste rock piles accumulate in volume and can contain over one hundred million tonnes with an areal extent over square kilometers waste rocks are also produced by civil construction projects such as highways railways airports and hydroelectric structures many waste rocks contain sulphide minerals such as pyrite pyrrhotite sphalerite galena arsenopyrite chalcopyrite tetrahedrite and molybdenite once sulphide minerals are exposed to oxygen and water they oxidize and dissolved metal ions protons and sulphate ions can be remobilized to surface water and groundwater it is common that the ph value of waste rock pile drainage is as low as 2 4 mayer 2017 and metal ion concentrations such as copper zinc and aluminum can be as high as a few hundred to a few thousand mg l significantly higher than water quality criteria morin et al 2012 when this happens drainage from the waste rock pile has to be collected and treated for meeting mine drainage release regulations this problem is called acid rock drainage and metal leaching ard ml it is in the interest of the mining industry and governments to predict ard ml through time so that the long term cost associated with ard ml and the pollution of surface water and groundwater by ard ml can be minimized modeling and numerical simulation is one of the methods that have been developed and used for predicting ard ml overviews of the basic concepts of modeling and numerical simulation of ard ml are given by lefebvre et al 2001a pantelis et al 2002 molson et al 2005 fala et al 2005 da silva et al 2009 and mayer 2017 the most important aspect of a set of models is how well they can represent the physical processes of full scale waste rock piles and their boundary conditions generally speaking capturing geochemical reactions taking place at the interfaces between rock surfaces and liquid pore water is essential for accurately predicting drainage chemistry another essential process is to capture water flow through a waste rock pile to simulate the geochemical reactions of sulphide minerals a reasonably accurate representation of reality should address reaction areas the availability of reactants oxygen water and ferric ions and the storage of the reaction products reaction core models levenspiel 1972 davis and ritchie 1986 elberling et al 1994 lefebvre et al 2001b use the rock particle s radius as the primary variable for capturing the surface areas for geochemical reactions and mass transport phenomena of rocks in particular for capturing the diffusion of oxygen into rocks from their surfaces this concept could work well when used for simulating hydrometallurgical processes however the radius of waste rock fragments is difficult to characterize in the field as waste rock grain size can vary from a micrometer clay size fraction to meter scale boulders in addition recent experimental evidence suggests that oxidation and leaching from large particles occur only at the surface and in subsurface regions which are accessible from the surface by cracks ghorbani et al 2001 as cracks develop inside large particles during weathering the reaction core models may not well represent the scenarios in the field this first paper part i proposes a particle level water film model in which surface area is used as the primary variable for capturing geochemical reactions including sulphide oxidation and neutralization reactions and also for capturing the major phenomena of acid and metal ion storage coupled with pile scale mass transport model the geochemical reactions inside a full scale waste rock pile can be evaluated furthermore a second paper part ii will present an integrated approach to predict leachate chemistry for ard ml by accurately modeling preferential flows and groundwater through waste rock piles 2 ard ml processes in waste rock piles a variety of coupled physical geochemical and microbial processes control the generation of ard ml the processes include transport of 1 air and oxygen 2 heat 3 water 4 acidification neutralization reactions and also 5 microbial activities the exposure of the rock surface to the air provides oxygen for the oxidation reactions this exposure also provides water to the oxidation reactions since the gas phase in the pores contains water moisture that can condense and or evaporate on the rock surface when water moisture condenses on the rock surface it is in the form of tiny water droplets or a very thin water film also when it rains water infiltrates through waste rock piles and some rocks would become wet with a thin film of water on their surfaces in addition this would raise relative humidity of the gas phase inside the waste rock pile and can produce more condensed water droplets on the rock surface when external groundwater flows into and through the waste rock pile rocks below the water table are saturated however some rocks just above the water table would become wet due to capillary rise from the water table and the temporal variability of the water table introduces water and air to other rock surfaces in addition groundwater that flows through the bottom part of the waste rock pile would carry downward migrating reaction products in general water flow through the unsaturated waste rock can be characterized as two types of flow li 1999 amos et al 2015 1 matrix flow through the network made of a finer grained matrix of low hydraulic conductivity and 2 macro pore or non capillary flow through the network composed of coarser channels of high hydraulic conductivity the flow mechanism is strongly controlled by the material properties of the waste rock and the hydrological conditions particularly the magnitude and timing of precipitation and infiltration events perkins et al 1995 amos et al 2015 for geochemical reactions and heat generation current models focus on matrix flow because most of the particle surface area resides inside many piles typically having a lower proportions of coarse channels matrix flow is dominated by capillary or surface tension forces a triple phase boundary water oxygen and sulphide minerals in the pore networks is considered as the reactor for the generation of acid rock drainage the acid and metal ions produced within the oxidation stage are stored inside the water film on rock surfaces and or water droplets trapped in pores and rock cracks the latter macro pore water flow is referred to as channeling preferential flow and stratification by nichol et al 2005 and amos et al 2015 which is controlled by gravity viscous and inertia forces where flow is rapid and channelized the interaction between pore water and preferential flow determines the leachate chemistry our approach to calculate the leachate chemistry for ard ml is to model the geochemical reactions on the sites in contact with pore water part i to model preferential flow through the entire waste rock pile separately and then couple the geochemical reactions with mass transport of preferential flow together part ii 3 water film models 3 1 concept of water film models consider a rock particle inside a waste rock pile the rock particle contains sulphide minerals which appear on the rock surface and inside the rock in the form of discrete small patches the contribution of sulphide minerals inside the rock to the geochemical reactions is neglected as they are far away from the triple phase boundary to reach reactants so reaction rates and rates of transporting products out are assumed to be much lower than those occurring on the rock surfaces the above described surfaces have to be captured in order to accurately simulate the geochemical reactions here the above surfaces are simplified into a thin water film covering a rock surface that contains sulphide minerals on one side of the water film is the rock surface the other side faces the gas phase in the pore network extending throughout the entire waste rock pile in general fig 1 shows the concept of the entire water film model in terms of abiotic acid generation the aqueous oxidation of sulphide minerals particularly pyrite by dissolved oxygen and ferric ions were considered to take place on the water rock interface bottom surface bs which separates the water film and rock particles the geochemical reactions and the corresponding abiotic kinetics are given as otwinowski 1994 williamson and rimstidt 1994 1 2fes 2 7o 2 2h 2 o 2fe 2 4so 4 2 4h 2 k bs fes 2 10 8 19 o 2 0 5 h 0 11 mol m 2 s 3 14 fe 3 fes 2 8h 2 o 15 fe 2 2so 4 2 16 h 4 k bs fe 3 10 8 58 fe 3 0 3 fe 2 0 47 h 0 32 mol m 2 s to consider the effect of neutralization processes in the water film model a dissolution rate on the bottom water rock interface to release equivalent of calcium carbonate can be simply estimated as a polynomial function of ph according to palandri and kharaka 2004 as 5 k bs co 3 2 k bs ca 2 f neu ph in addition the following geochemical reaction was included within the water film domain to consider the oxidation of ferrous to ferric iron 6 4fe 2 o 2 4h 4fe 3 2h 2 o the corresponding oxidation rate in the water film wf for eq 6 can be estimated from singer and stumm 1970 as 7 q wf fe 2 2 91 10 9 1 33 10 12 oh 2 p o 2 fe 2 mol m 3 s where p o2 in eq 7 is the oxygen partial pressure atm which can be approximately estimated by 8 p o 2 o 2 h where h is the henry s law constant moreover the ionization equilibrium equations for water and equivalent neutralization ions have also been integrated in the water film model as follows 9 h oh h2o 10 h co3 2 hco3 11 h hco3 h2o co2 in order to investigate how oxygen and other ions migrate within the water film the following species diffusion equation in the solution phase was adopted here 12 t c wf i d i c wf i q wf i where c wf i is the concentration for species i in the water film d i is the corresponding diffusion coefficient within the water phase and q wf i sink or source term represents a generation or consumption rate for each species inside the water film the value of d i can be found in the reference cussler 1997 to validate the proposed model a set of experiments from michael and hubert 1986 was simulated by using the water film models and their testing data is used to compare with the simulation results in micheal s experiments 3 g prepared pyrite immersed in 800 ml prepared oxidant solutions of ferric and oxygen from the schematic diagram of experimental apparatus used in their study the effective thickness of water film is estimated about 3 cm the total pyrite active surface area were also measured which is about 750 cm2 the oxidation rates for pyrite under 100 and 21 ambient oxygen concentration at ph 1 9 were measured in addition a series of oxidation rates at 100 ambient oxygen concentration from different ph were also measured the quantitative comparison between measurements and the curve fitted by simulation results are given in fig 2 and fig 3 respectively which shows reasonable agreement 3 2 parametric studies using the water film model in this section parametric studies on the oxygen concentration at the water air surface and on the thickness of the water film were performed to determine how these factors impact on overall oxidation reactions inside the water film according to onsite monitoring data the oxygen concentration within the waste rock pile could vary from near zero to ambient oxygen concentration thus fractions of 10 50 and 100 of the ambient oxygen concentration were studied in addition the thickness of the water film is typically 10 to 100 μm perkins et al 1995 as a result three scenarios with 10 μm 100 μm and 500 μm thickness were also selected to investigate the effect of the water film thickness the results of the parametric studies are shown in figs 4 and 5 fig 4 shows that when the water film thickness is fixed at 100 μm the accumulated oxygen consumption inside the water film accelerates with the increase of oxygen concentration on the top of the water film which is consistent with the relationship shown in eq 2 in fig 5 the relative oxygen concentration is fixed at 50 while the thickness of water film varies it is observed that the 10 μm water film has a higher reaction rate in the beginning because the oxygen diffuses faster through a thinner water film however eq 2 also indicates that the ard reaction rate is inversely proportion to the acid concentration as the volume of the thinner water film is much smaller the acid concentration goes up faster than in the thicker water film the reaction rate for a 10 μm water film eventually is exceeded by 100 μm and 500 μm scenarios in general the results from these parametric studies illustrate that the water film model is able to capture the concerning geochemical reactions and mass transport mechanisms at particle level 4 pile scale mass transport model the water film model simulates geochemical reactions on the waste rock surface contacting water the supply of reactants transport of products and reactive heat in the full waste rock pile are then calculated using a fully coupled mass transport model described in this section the pile scale mass transport model is mainly for simulating matrix and air flows in pore networks product transport in pore water oxygen convection and reactive heat conduction and convection 4 1 matrix and air flows to describe the pattern of matrix and air flows in pore networks two phase darcy s law was applied to consider the capillary effects from both air and water phases here the saturation of each phase s α is defined as the fraction of the pore space occupied by a given fluid 13 s α θ α φ where θ α is the volume content for phase α and φ is the porosity here the sum of the air and water saturations must be equal to one 14 s a s w 1 in addition the definition of effective saturation for phase α is also given as following 15 s eα s α s α min s α max s α min the capillary pressure in the pore is defined as the pressure difference between water and air at the darcy scale the capillary pressure is commonly assumed to be a function of the water saturation 16 p c p a p w p c s ew the relationship between capillary pressure and water saturation is called the water retention curve for which van genuchten 1980 introduced a very well known form 17 p c s ew p g s ew 1 m g 1 1 n g where p g is defined as the capillary entry pressure the exponents m g and n g with their linkage are related to the pore size distribution by applying darcy s law the velocities of air and water inside the pile can be determined using 18 q α k α s α μ α p α ρ α g k α s α h α where k α and k α are permeability and conductivity tensors which depend on the saturation of the phase α h α is the fluid potential the permeability under unsaturated conditions k α in eq 18 is different from that for saturated conditions k sα in the porous structure if m g 1 1 n g is assumed mualem 1976 proposed that the relative permeability functions of air and water phases in the waste rock pile can also be deduced from the water saturation as given below 19 k a s a k sa k ra s ew k sa 1 s ew κ 1 s ew 1 m g 2 m g 20 k w s w k sw k rw s ew k sw s ew κ 1 1 s ew 1 m g m g 2 where the connectivity factor κ can be treated as a fitting parameter of the model in the waste rock pile the water density ρ w for darcy s equation is considered as constant and also the air density ρ a can be estimated by 21 ρ a p t p a rt where r 8 31447j mol k is the universal gas constant 4 2 reactant and product transport with matrix and air flow to investigate the transport of all geochemical species in the matrix water phase related to ard ml processes inside a waste rock pile a general species transport equation is adopted as 22 t θ w c i θ w d i c i q w c i q i where c i and d i are the concentration and diffusion coefficient for species i q w is the darcy velocity and q i sink or source term is the generation or consumption rate similarly the supply of oxygen with air flow concentration c o 2 to geochemical reactions can be calculated as 23 t θ a c o 2 d o 2 c o 2 q a c o 2 q o 2 4 3 heat transfer to consider the effect of reaction heat and cyclic ambient temperature on ard ml processes the equation for heat transfer in the waste rock pile is also included 24 c p ρ t t c w ρ w t q w k t q h where c p is the specific heat capacity q h denotes the heat generation rate from geochemical reactions the effective mass density ρ and the effective thermal conductivity k are defined as 25 c p ρ φρ w s w c w 1 φ ρ s c s 26 k k dry s w k wet k dry where c w and c s are heat capacities for water and solid waste rock particles k dry and k wet are the thermal conductivities for waste rocks in dry and wet conditions respectively 5 coupling between water film model and pile scale mass transport model fig 6 summarizes the functions of the pile transport model and the coupling with the water film model at each function in eqs 22 and 23 q i and q o2 are coupled with the water film model respectively in eq 24 q h is the heat generation rate calculated from the water film model based on the theory of mass conservation an assumption was made that the parameters for the pile scale mass transport model and the particle scale water film model can be coupled together in the following way 27 q i mol m 3 s k us i mol m 2 s β m 2 m 3 γ δ where q i denotes the sink or source term for species i in the pile model k us i is the inward or outward flux for species i at the upper surface us in the water film model β is the surface to volume ratio measured from waste rock pile γ is area ratio for sulphide minerals on the surface of waste rock particle and δ is the area ratio for water coverage on the waste rock surface in real engineering practice β γ and δ are dynamic and it is difficult to measure and monitor them inside the waste rock pile parameter calibration may be required at current stage which may limit the applications of the proposed model regarding the area ratio for water coverage δ it is roughly assumed to be proportional to the water content θ w 28 δ θ w φ where φ is the porosity of the waste rock pile in the pile scale mass transport model the ambient temperature and infiltration rate are applied as boundary conditions temperature oxygen and water content concentration distributions are calculated and proton ion concentrations are the outcomes from the coupled models 6 case study of the main waste rock pile at equity silver mine 6 1 application of the models to the waste rock pile at equity silver mine in this section the water film model coupled with the pile scale mass transport model are applied to the waste rock pile at the equity silver mine as an example to illustrate the capabilities of the proposed coupling models all models are built and implemented in the commercial software package comsol 5 3a the equity silver mine site is described in detail in aziz and ferguson 1997 the site is located in the central interior of british columbia canada and contains approximately 80 million tons of waste rock covering an area of approximately 1 4 km2 the waste rock piles of the equity silver mine have been producing acid rock drainage with high concentrations of metal ions since the 1980s the temperature and oxygen concentrations at different lateral locations and different depths of the waste rock piles have been constantly monitored since 1990 which has provided valuable information to understand the acid generating and metal leaching processes in the field extensive research has been conducted at the equity silver since the 1990s o kane et al 1995 herasymuik 1996 saretzky 1998 morin et al 2010 2012 these studies have focused on hydrogeological characterization cover system modeling modeling of infiltration and drainage chemistry etc nevertheless the ard ml processes within the equity silver waste rock are still not fully understood full scale monitoring shows the spatial and temporal complexities of the mobile pore gases within the piles which need further study the equity silver mine is situated on a plateau in a humid alpine environment the mine site elevation is about 1300 m historical site records indicate that the average annual precipitation is about 600 mm with approximate 60 of the precipitation occurring as snow which occurs from november to april snow starts to melt in april the rainy season starts from late april and ends by the end of june a soil cover system was installed on the waste rock piles during 1990 1994 with an average thickness of 0 5 m of compacted till and 0 3 m of uncompacted till for reducing the amount of infiltrated water and oxygen the precipitation and ambient temperature data at the equity silver mine site can be retrieved from the website of the environment canada however some data for the time period before 1991 was incomplete as a result the data starting from jan 1991 to jan 2001 was applied for the simulation which is plotted in fig 7 the simulation was initialized by a simplified uniform condition and the first 3 years simulated the uncovered conditions to establish the initial geochemical reactions and mass transport conditions inside the waste rock pile starting from jan 1994 the effect of the soil cover system was included in the simulation which is consistent with the completion time for the real cover installation on the main pile the calculations continued until jan 2001 to simulate seven years for the scenario with the soil cover system the parameters used for the case study are given in table 1 which are mainly from previous characterization work at the equity silver mine and data from similar mine sites study except for intrinsic air and water permeability most of properties for the cover system is not available so same value to waste rock was adopted in the simulation for simplification a 2 d cross section in the main dump as shown in fig 8 the red line was simulated in this study the schematic of the cross section is plotted in fig 9 with more geometry information the monitoring point p 7 17 m depth is at the left side of the 2d section which is approximately considered as the center of the main dump all of the waste rocks are piled on a bedrock slope the height of the pile is around 50 m and the width is about 1000 m the model mesh consists of totally 1843 cells and the whole simulation lasts for 73 h 26 min and 52 s intel xeon e5 1650 v4 ram 64g for matrix flow calculation the boundary condition bc on the top side of the domain was defined as a flow rate calculated based on total precipitation data times a net infiltration rate the net infiltration rate was estimated as 40 before the cover was installed a 5 infiltration rate was used after the cover was placed o kane et al 1995 later studies show there is more than 5 passing through but the actual number is still not clear the bc for the bottom side was assumed to be the water table which means fully saturated below this boundary in terms of the air flow in the waste rock pile the bcs that enclose the whole waste rock pile are defined as open air pressure the elevation dependent air pressure is given in the form of 29 p p 0 exp gmh rt where m 0 0289644kg mol is the molar mass of the air h is the elevation and p 0 is the pressure at h 0 which represents the sea level regarding the thermal calculation for the waste rock pile the profile of ambient temperature shown in fig 7 is set for the thermal bc on the top side of the pile for simplicity the thermal bc for the bottom side is considered to be insulated as reaction heat is generated inside the waste rock pile due to the oxidation of sulphide air convection must be considered for oxygen transport as a result both air inflow and outflow may exist on the top surface of the pile and open boundary conditions for oxygen transport are applied as follows 30 n d o 2 c o 2 0 if n q a 0 c o 2 c o 2 atm if n q a 0 6 2 results and discussions due to limited information on site characterization and conditions not all of the parameters can be directly measured in the field or estimated from other mine sites for example β and γ in eq 27 are difficult to characterize in practice however they are critical to the evaluation of total reaction rates for the ard processes involved as a result a parametric sweep for β m2 m3 γ was performed to find a calibrated value that enables the simulated temperature profile inside the waste rock pile to match the pattern observed from monitoring data fig 10 shows the measured temperature profile at 4 m 11 m and 17 m depth at p 7 location from 1994 to 1995 when the cover was just installed in field with minimum impact from the ambient environment the temperature near the pile core may better reflect the total reaction rate in the waste rock pile so the deepest monitoring temperature at 17 m depth of the p 7 point is used for this calibration based on the simulation results β m2 m3 γ is calibrated to 4000 1 m for the waste rock pile to simplify the calculation a constant water film thickness of 100 μm was used since the range of variation of water content is very small less than 5 for the matrix flow saretzky 1998 noel and ritchie 1999 eqs 2 4 and 7 show that the total acid generation is directly related to the oxygen consumption and potential of neutralization as the cycle of ambient temperature during a year may change the air convection as well as the oxygen supply in the waste rock pile analyzing the competition of oxygen consumption and oxygen supply becomes essential to understand the limiting factors in ard process as shown in the monitoring data of the waste rock pile morin et al 2010 2012 the oxygen concentration in air phase within the pile fluctuates through the seasons fig 11 shows the comparison of oxygen concentration between measurement and simulation at 17 m depth of the p 7 point it should be repeated that the effect of a cover system was applied starting from january 1994 in the model whereas the real cover system onsite was progressively installed from 1990 to 1993 the shaded area in fig 11 is thus the initialization process of the simulation the first observation is that starting from january 1994 the simulated oxygen concentration has a similar fluctuation pattern to that observed high concentration in winter and low concentration in summer measurements are missing from winter 1996 to spring 1997 but it is believed that the oxygen concentration rose during this period based on its historical trend another observation is that the simulated oxygen concentration decreases on average during the first several years after the installation of the cover system while the measurements also show a similar downward trend note that real grain size distribution groundwater flow pattern and rate real water infiltration rate water content distribution and microbial activity inside the piles etc are still not clear due to lack of characterization data or difficult to measure on site therefore it s difficult for the simulation results to completely match the monitoring data point by point but matching the trend of the monitoring data can still reveal the mechanisms controlling the ard generation processes the explanation for above observations is that the installed cover system significantly changed the air flow pathway in the waste rock pile fig 12 shows the oxygen concentration and the air flow unscaled vector driven by convection in dec 1993 right before the cover installation in the simulation the convective flow entered into the pile through the bottom toe area and eventually vented out from the top of the pile as a result oxygen concentrations gradually decreased along the air flow pathway due to ard reaction consumption figs 13 and 14 illustrate the corresponding status in dec 1996 and aug 1997 respectively the results indicate that the low permeability cover seemed to successfully block the main air flow outlet on the top side as a result the air had to circulate within the pile which increased the length of the air flow pathway and reduced the average oxygen concentration level in the pile fig 13 also indicates that in the winter it is possible that some fresh air penetrates through the top side into the waste rock pile with inverse air flow which is a result of air density change driven by a temperature difference meanwhile the effect of oxygen diffusion which is originally suppressed at the top side due to air outflow may resume and additionally enhance the oxygen penetration as the air flow is inverted from outflow to inflow at this stage this observation indicates that diffusive and advective oxygen transports may be dominant under different conditions in the pile which is consistent to the conclusions from the studies by binning et al 2007 molins and mayer 2007 in conclusion after the cover was installed the air outflow at the top of the pile is almost blocked by the cover when oxygen is depleted at the end of the air flow pathway in the top region diffusion of oxygen starts to play a dominant role and increases the oxygen concentration the competition of oxygen consumption and supply causes the annual fluctuation furthermore fig 15 illustrates the total amount of acidity generated from ard reactions within the cross section the plot shows that the total amount of acidity generation also fluctuated after the cover was installed which is due to oxygen concentration fluctuation the current model only considers matrix flow while the leaching process related to channeling flow and the effect of lateral external groundwater inflow is not considered these two factors will be studied in our future work 7 conclusions to comprehensively understand the physical and chemical processes involved in ard ml generation in waste rock piles a particle level water film model and a pile scale mass transport model is presented in this paper the water film model considers the impact of water film thickness oxygen concentration as well as geochemical kinetics on the total ard ml generation at the particle level which is fully coupled with a pile scale mass transport model dealing with reactant product transport and also heat transfer the water film model was validated with the experiments in literature parametric studies on the water film model were performed and the results indicate that the effects of water saturation thickness of the water film and ph level on local geochemical reaction rate are included which shows the advantages of the model in addition the developed model is coupled into a pile scale mass transport model to investigate ard ml generation in the main waste rock pile at the equity silver mine the observations from the case study shows that the simulated oxygen concentration has the same annual fluctuation pattern with the monitoring data which means the proposed model is capable of capturing the main ard chemical and physical mechanisms through analyzing the simulation data it is confirmed that the cover system increases the length of the air flow pathway through the pile thus reduces the average oxygen concentration level and the total geochemical reaction rate inside the pile the proposed model can be a useful and effective tool to optimize waste rock pile configurations and evaluate the design of cover systems to prevent or reduce ard ml generation acknowledgement the authors gratefully acknowledge mr mike o kane and dr lindsay tallon from m a o kane consultants inc for valuable technical discussions and constructive comments on the research carried out at the equity silver mine site 
1618,the rock matrix of granites is expected to be an important buffer against the dispersion of contaminants e g radionuclides and against the ingress of oxygenated glacial meltwater the influence of matrix heterogeneity on o2 diffusive transport is assessed here by means of numerical experiments based on a micro discrete fracture network micro dfn representation of the diffusion available pore space along with random realisations of idealized biotite grains to simulate the heterogeneous nature of granitic rocks a homogeneous based analytical solution is also presented and used to assess possible deviations of the numerical experiments from the assumption of homogeneity the analytical solution is also used to test upscaled values of mineral surface area the numerical experiments show that the matrix behaves as a composite system with the coexistence of fast and slow diffusive pathways this behavior is more evident at low damköhler numbers our interpretation of the numerical experiments points out the importance to properly characterise the heterogeneity of the rock matrix keywords oxygen transport mineralogical heterogeneity micro dfn high performance computing 1 introduction granitic rocks and other crystalline rocks are under consideration by different countries as an option for hosting deep geological repositories for spent nuclear fuel some of these repositories will possibly be built at moderate to high latitudes which makes the question relevant of how a glacier terminus laying above the repository location could affect the hydrogeological and hydrogeochemical conditions at repository depth one of the possible effects is that o2 rich glacial meltwater driven by the high hydrological gradients expected during a glacial cycle vidstrand et al 2013 2014 could infiltrate deep into the geological system understanding the buffering capacity of the host rock is then important to evaluate whether the redox perturbation may reach repository depth and e g induce canister corrosion as well as enhance radionuclide mobility banwart et al 1999 although microbes are diligent in metabolizing organic matter with oxygen the expected low concentrations of organic carbon in subglacial environments implies that microbial processes can not be relied on when evaluating the fate of oxygen in glacial meltwaters infiltrating deeply into the ground the main abiotic processes involved in the depletion of dissolved oxygen i e the oxidation of dissolved fe2 and of fe ii bearing minerals have been included in a number of homogeneous based analytical sidborn and neretnieks 2007 sidborn et al 2010 antonellini et al 2017 and numerical glynn et al 1999 auqué et al 2006 guimerà et al 2006 spiessl et al 2008 2009 macquarrie et al 2010 models in these models heterogeneity due to e g the sparse distribution of geochemically reactive minerals is assessed by means of sensitivity analyses where specific parameters e g the mineral surface area or the mineral volume fraction are varied over plausible ranges an explicit analysis of the combined role of physical and mineralogical heterogeneity on the buffering capacity of fractured crystalline rocks has been carried out in two recent articles by trinchero et al 2017 2018 however these studies focused on the role of fracture coating minerals here we assess how rock matrix heterogeneity affects the buffering capacity of a granitic rock we also evaluate how small scale heterogeneity can be upscaled by means of an equivalent mineral surface area approach 2 problem statement 2 1 the heterogeneous nature of granitic rocks granitic rocks are heterogeneous at several scales at the regional and repository site scale several rock units with different types of granitic and crystalline rocks are generally found as seen in the examples of olkiluoto posiva 2013 and forsmark andersson et al 2013 the prospective sites for spent nuclear fuel repositories in finland and sweden respectively in the context of the diffusive transport of reactive solutes two types of heterogeneity are important physical heterogeneity which is related to the distribution of the diffusion available pore space and mineralogical heterogeneity which refers to sparse distribution of the different mineral types and their respective size variability physical heterogeneity of granitic and crystalline rocks is generally evident from micro scale analyses for instance fig 1 shows the autoradiograph of a granodiorite sample widestrand et al 2010 from the äspö hard rock laboratory at oskarshamn sweden impregnated with 14c pmma polymethylmethacrylate the dark areas in the autoradiograph indicate connected porosity sammaljärvi et al 2017 describe the pore space in crystalline rocks as the sum of microfractures inter granular grain boundary pores which surround mineral grains and the intra granular porosity found within mineral grains despite the complexity of the structure of the pore space svensson et al 2018 have recently shown that it can be fairly well approximated by a micro discrete fracture network micro dfn besides the pore space the different mineral grains are also heterogeneously distributed in a random manner in granites but foliated distributions are observed in gneissic rocks in the context of granitic rock a particularly interesting mineral phase is biotite k mg fe 3a1si3o10 oh 2 an iron ii bearing mineral that has the potential to retain potentially harmful dissolved radionuclides kyllönen et al 2014 and that can also reduce and buffer the ingress of o2 rich waters sidborn and neretnieks 2007 malmström and banwart 1997 as exemplified by the photograph shown in fig 1 biotite grains are dispersed in a random manner in äspö granodiorite observations made with microscopy in a granitic rock sample taken at forsmark sweden suggest that typical biotite grains there have an average size of 400 200 μm2 0 08 mm2 although aggregates of grains up to 2 mm2 can also be found drake et al 2006 the influence of the physical and mineralogical heterogeneity of the rock matrix on buffering mechanisms against oxygen diffusive penetration is studied in this paper the investigation is carried out using a micro dfn model combined with random distributions of mineral grains an analytical solution is first introduced which is used to interpret the results of the numerical experiments as well as to evaluate upscaled parameters of mineral surface area 2 2 oxygen transport and abiotic buffering mechanisms we consider a hydraulically active fracture with a continuous recharge of oxygenated water at the upstream boundary oxygen in the fracture diffuses from the fracture into the rock matrix where it is consumed by the dissolution of a fe ii bearing reduced mineral i e biotite 2 2 1 governing equations the conceptual model is first solved analytically here the model is comprised of a dual porosity domain that includes a fracture where transport is dominated by advection and an adjacent rock matrix where transport is dominated by diffusion equations describing the mass balance of dissolved oxygen ferrous iron and biotite are expressed for the rock matrix in eq 1 and for the fracture in eq 2 1a c 1 t d p 2 c 1 z 2 fr ox 1b c 2 t d p 2 c 2 z 2 r diss r ox 1c c 3 t r diss 2a c 1 t d w 2 c 1 x 2 v c 1 x d e 2 δ c 1 z z 0 f r ox 2b c 2 t d w 2 c 2 x 2 v c 2 x d e 2 δ c 2 z z 0 r ox where c 1 x z t c 2 x z t and c 3 x z t mol lw with subscript w denoting water are respectively the matrix pore water concentrations of o2 fe2 and fe ii in biotite expressed based on the volume of pore water concentrations are dependent on the spatial location along the flowing fracture x the normal distance from the fracture surface into the rock matrix z and vary transiently with time t corresponding concentrations of o2 and fe2 in the flowing fracture i e at z 0 are denoted without apostrophes biotite grains are present in the matrix only the advective water velocity in the fracture and the fracture aperture width are denoted v m s and δ m respectively d p m2 s d w m2 s and d e m2 s are the pore diffusivity in the rock matrix diffusivity in the fracture water and the effective diffusivity in the rock matrix respectively the effective diffusion coefficient is defined as d e d w ϕ τ d 2 where ϕ is the diffusion available porosity and τ d is the effective tortuosity of the porous medium see svensson et al 2018 while the pore diffusion coefficient is d p d e ϕ that is d p d w τ d 2 in this model oxygen is consumed abiotically through a serial process involving non oxidative dissolution of ferrous iron in biotite followed by homogeneous oxidation of dissolved ferrous ions by oxygen fe2 0 25o2 2 5h2o fe oh 3 am 2h with a reaction stoichiometry factor f 0 25 moles o2 per mol fe the rates of these individual reactions are assumed to be described by the rate expressions in eq 3 expressed in terms of the oxidation dissolution of ferrous iron 3a r ox mol fe l w 1 s 1 k r c 1 c 2 c oh 2 k h 3b r diss mol fe l w 1 s 1 k fe diss a s 1 000 ϕ c 3 c 30 2 3 1 c 2 c 20 where ϕ is the matrix porosity a s m2 m3 is the initial biotite specific surface area note that the specific surface area is here expressed relative to the bulk volume and c 20 mol lw and c 30 mol lw are respectively the ferrous ion concentration at steady state and the initial concentration of fe ii in biotite in the matrix field observations at the forsmark hallbeck and pedersen 2012 drake et al 2018 and olkiluoto bomberg et al 2015 sites show that the iron ii concentration in deep groundwaters varies in general between 0 1to40 10 6 mol lw a value c 20 1 8 10 6 mol lw is used in the calculations hereafter the other parameters of eq 3 are specified in table 1 except for the values of a s c 10 ϕ and d p which are case specific 2 2 2 oxidation limited by reactions kinetics initially when the biotite in the rock matrix is unaltered i e the ferrous content in biotite is c 3 c 30 the overall reaction rate is controlled by dissolution or oxidation reaction kinetics rather than constrained by diffusive transport these reactions are assumed to occur serially with an overall rate determined by the slower of the two reaction steps the overall rate can then be described by either of the rate expressions r diss r ox for the condition 4 c 2 c 20 k 2 k 2 k 1 c 1 where k 1 k r kh c 20 c oh 2 and k 2 k fe diss a s 1 000ϕ c 3 c 30 2 3 substituting eq 4 in the rate expression r ox eq 3a and assuming pseudo steady state which implies that c 1 t 0 the mass balance equation for oxygen eq 1 reduces to 5 d p 2 c 1 z 2 f c 1 k 1 1 c 1 k 1 k 2 the right hand side of this expression describes a reaction rate that gradually changes from zero order to first order with respect to the dissolved oxygen concentration c 1 for k 1 k 2 c 1 1 c 1 k 1 1 c 1 k 1 k 2 k 2 zero order kinetics for k 1 k 2 c 1 1 c 1 k 1 1 c 1 k 1 k 2 0 5 k 1 c 1 0 5 k 2 transition for k 1 k 2 c 1 1 c 1 k 1 1 c 1 k 1 k 2 k 1 c 1 first order kinetics close to the fracture the oxygen concentration may be sufficiently high for the rate to be zero order deep in the matrix the oxygen concentration approaches zero and at some distance z c from the fracture there is a transition from zero order to first order kinetics the concentration at this distance is c 1 z z c k 2 k 1 the general solution to eq 5 can be written 6 c 1 a 1 e z z c α a 2 e z z c α for z z c β 2 z 2 a 3 z a 4 for z z c where α fk 1 d p and β fk 2 d p respectively note that α and β c 1 are dimensionless measures of the relative rates of reaction and diffusive transport for the domains of first order kinetics and zero order kinetics respectively commonly referred to as the second damköhler numbers the particular solution is derived for the boundary conditions 7 c 1 0 at z a 1 0 c 1 k 2 k 1 at z z c a 2 k 2 k 1 β α c 1 c 1 at z 0 a 4 c 1 the integration constant a 3 which can be interpreted as the concentration gradient at the fracture matrix interface c 1 z z 0 and the distance z c are finally obtained by assuming that both the concentration and the concentration gradient are continuous at the location of transition z z c the concentration of oxygen in the porous rock matrix is then obtained in eq 8 as a function of α β the concentration c 1 of oxygen in the fracture and the distance into the rock matrix z 8 c 1 β α e z z c α for z z c β 2 z 2 a 3 z c 1 for z z c where z c 2 c 1 β 1 α 1 α and a 3 2 c 1 β β 2 α eq 8 has been used to assess the possible penetration of oxygen in the last swedish safety analysis of the potential nuclear waste repository at forsmark sidborn et al 2010 an illustrative result for the o2 concentration profile as a function of distance in the rock matrix is shown in fig 2 for the case of a fracture concentration of oxygen c 1 3 10 5 molo2 lw a biotite specific surface a s 11 000 m2m 3 a porosity ϕ 0 0018 and a pore diffusivity d p 1 17 10 11 m2 s skb 2010 additional parameters are given in table 1 2 2 3 oxidation limited by diffusion resistance with time diffusion resistance becomes increasingly important as ferrous iron in biotite close to the fracture is exhausted at some point the diffusion of dissolved species in the pores of the matrix becomes slow compared to the dissolution reaction rates and the reactive process is governed by the diffusion transport resistance this implies a sharp reaction front that propagates further into the matrix with time in the fully transient system described by eq 1 the dissolution reaction front propagates into the rock matrix with time coupled with a change in concentration profiles with the diffusion of dissolved species in the pores of the matrix being fast compared to the front displacement the concentration profiles are always at steady state for a certain front location an analytical solution for this pseudo steady state is derived in sidborn and neretnieks 2007 an equivalent expression was derived by rajaram and arshadi 2016 using a similarity solution for reaction front propagation 2 3 numerical experiments the inter granular space of a synthetic granitic rock is described here using a micro discrete fracture model svensson et al 2018 i e three different fracture sets of length from one to a few millimeters are used to mimic grain boundary pores as well as micro fractures that transect different mineral grains the micro dfn and the equivalent continuous porous medium model based on this micro dfn were generated using the finite volume groundwater flow simulator darcytools svensson et al 2010 svensson and ferry 2014 details on the method to generate the micro dfn used here is provided in svensson et al 2018 the parameters describing each fracture set are listed in table 2 these parameters are the same used in svensson et al 2018 to mimic diffusive properties of a granitic rock sample from borehole kfm02a of forsmark however the numerical grid of this continuum model differs from that of svensson et al 2018 in refinement topology and in the fact that here no cells are deactivated and thus the model should be regarded as synthetic the properties of the base case model which are discussed in detail in section 3 1 resemble those of a tight granitic rock with a relatively low amount of exposed mineral surface area dfn derived pore diffusivity and porosity ϕ values were assigned to all the active cells of the continuum model using the approach described by svensson 2001a 2001b i e intersecting volumes between fractures and grid cells were computed and the contributions from all intersecting fractures were added to the related parameters of each grid cell the fracture surface i e the total fracture surface that intersects a given grid cell s f m2 was also retrieved at each grid cell all the cells that were not in contact with the generated fractures and cells in contact with isolated fractures and their contacting cells were assigned a minimum value of porosity ϕ 1 10 4 and pore diffusivity d p 1 1 10 15 m2 s the resulting distribution of porosity pore diffusivity and fracture surface is shown in fig 3 note that the bulk pore diffusivity is here obtained by fitting penetration profiles of a conservative tracer as described in section 3 1 the bulk porosity of the model is ϕ 2 2 10 3 the dimension of the continuum model domain is 3 0 10 2 m 4 75 10 3 m 1 25 10 1 m and is discretized with 118 19 500 1 121 000 rectangular cuboids with constant refinement δ cont 2 5 10 4 m biotite grain distributions were generated over an independent grid using binary random uncorrelated realisations that simulate the presence or absence of a biotite grain the distribution of biotite grains for the different considered cases is shown in fig 4 notice that all the considered cases are discussed in detail further below the discretization δ grain of this biotite grain grid coincides with the considered biotite grain size 6 3 10 4 m in the continuum model mineral dissolution is then parameterised by assuming that for the i th grid cell the exposed biotite specific surface area is given by 9 a s i ε i s f i δ cont 3 where ε i is the volume fraction of the cell occupied by biotite each random realisation of biotite is characterised a priori using equivalent values of specific surface area 10 a s bulk δ cont 3 v b a s i where δ cont m is the discretisation of the continuum model and v b is the bulk volume of the rock 1 75 10 5 m3 a s bulk is the total fracture surface in contact with the reactive mineral biotite divided by the bulk volume of the model and it can be directly derived from the underlying dfn the system is considered to be initially anoxic and a constant oxygen concentration of 1 5 10 3 mol l w 48 mg l w is applied at z 0 the left boundary in figs 3 to 6 this value of oxygen concentration was used elsewhere to simulate the ingress of glacial meltwater in a previous work trinchero et al 2017 a conservative tracer is also added to the boundary water the numerical calculations were carried out using pflotran hammond and lichtner 2010 which was run in the supercomputer juqueen of the jülich supercomputing centre stephan and docter 2015 the geochemical reactions included in pflotran are those discussed in sub section oxidation limited by reactions kinetics and the related parameters are those listed in table 1 except for the biotite specific surface area that is given by eq 9 four numerical experiments are considered a base case bc and three variant cases each simulation having a different distribution of biotite and or different sets of physical parameters table 3 in variant case 1 vc1 the pore diffusivity was scaled by multiplying each cell value by a factor of 100 mimicking a more altered granitic rock in variant case 2 vc2 the average amount of biotite was doubled as compared to the bc while keeping all other parameters unchanged and for the variant case 3 vc3 the average size of the biotite grains was increased to approximately the double as compared to the bc to 1 2 10 3 m c f table 3 with all other parameters kept unchanged concerning the amount of biotite used in these models it is convenient to refer here to the work of drake et al 2006 which contains a comprehensive analysis of rock mineralogy at two swedish sites forsmark and laxemar in this work it is reported that the main rock type at the forsmark site contains biotite in a range of 0 8 8 vol while at the laxemar site the three main rock types ävrö granite quartz monzodiorite and fine grained dioritoid contain up to 49 vol of biotite thus the amount of biotite used in all the numerical experiments described in table 3 should be considered to represent some of the variability that may be expected in granitic rocks 3 results snapshots of oxygen concentration at steady state for the four numerical experiments are shown in fig 5 for all the experiments steady state conditions are attained after 15y approximately except for the variant case with higher diffusivity vc1 where a steady state penetration profile is observed at 2y approximately a summary of the results of the four experiment along with the parameters used to interpret the numerical profiles is provided in table 4 3 1 base case bc numerical experiment the bc numerical experiment was extended in time until a steady state oxygen concentration was observed 15 yr the results are analysed here mostly in terms of penetration profiles which are computed along 118 different transects one transect per each grid cell in a row of cells taken at the x y plane and with y 2 4 10 3 m parallel to the z direction the direction of the oxygen concentration gradient the x y location of each transect is the centroid of the corresponding grid cell first the penetration patterns of the conservative tracer fig 6 are analysed in order to infer an equivalent value of pore diffusivity to be used in the subsequent analysis of oxygen transport the transient penetration profiles of the conservative tracer are visually fitted to the analytical solution for diffusion in a plane sheet carslaw and jaeger 1959 crank 1979 fig 7 the best fit is obtained with a value of pore diffusivity of 3 5 10 13 m2 s this value along with the bulk value of porosity is used as input for the analytical solution of oxygen transport the computed penetration profiles of oxygen at steady state are shown in fig 8a thin gray lines along with the average penetration profile i e penetration profile obtained with the arithmetic mean of the 118 transects the analysis of biotite concentration shows that for the considered simulation time frame the consumption of biotite is modest even close to the injection boundary results not shown here for the sake of brevity thus the results are interpreted here using the analytical solution provided by eq 8 along with the parameters listed in table 1 the same approach has been used for the rest of numerical experiments in fig 8a the penetration profile obtained with eq 8 using a s bulk is also shown this profile significantly overestimates the buffering capacity of the rock i e the capacity of the rock to buffer the redox perturbation the analytical solution is also used to fit the average concentration profiles here the biotite specific surface area is the only fitting parameter and the resulting best fit value is 320 m2 m3 the analytical solution captures well the first part of the profile but deviates from the numerical results at low concentrations in fig 8b the analytical solution is used to span all the observed penetration distances i e maximum penetration for a given mineral specific surface area this is done by first computing the two bounding curves a s equal to 695 m 2 m 3 i e shortest penetration and a s equal to 135 m 2 m 3 i e longest penetration and then plotting the other curves with a step size of 5 m 2 m 3 interestingly the penetration profile obtained by averaging all these analytically computed curves agrees well with the numerically computed average penetration profile this indicates that the medium indeed behaves as a composite system with the average penetration profile being the result of multiple parallel diffusive pathway characterised by different reactivity to further explore this effect we propose here an alternative simplified analytical model based on two parallel diffusive pathways 11 c 1 f hr c 1 hr 1 f hr c 1 lr where f hr is the fraction of oxygen that is driven through the high reactive pathway superscript hr and 1 f hr is the remaining part that diffuses along the low reactive pathway superscript lr both the concentration of oxygen in the high reactive and low reactive pathway c 1 hr and c 1 lr are calculated using eq 8 a similar two pathways model was used to simulate preferential flow through an unsaturated mining waste rock pile trinchero et al 2011 the influence of the second less reactive pathway is visually illustrated in fig 9 where oxygen penetration profiles are simulated with arbitrarily selected values and with a range of f hr that spans from 0 to 1 from the figure it is evident that the low reactive pathway even if present only in a very small fraction controls the maximum penetration depth of oxygen while f hr controls the transition part of the profile the two pathways model eq 11 was visually fitted to the experimental results with the following parameters table 4 giving a reasonable good match with the experiment fig 10a thick green dashed line f hr 0 95 a s hr 320 m2 m3 i e same specific surface area used for the single pathway analytical model eq 8 and a s lr a s hr 2 35 3 2 vc1 numerical experiment higher diffusivity this variant case tries to mimic a more altered granitic rock by scaling the diffusivity of each cell by a factor of 100 the higher values of diffusivity are close to 1 10 9 m2 s i e the value of molecular diffusion in pure water the results of this numerical experiment along with the different fits with the analytical solutions are shown in fig 10b for the single pathway analytical model fig 10b thick green continuous line the fit was obtained with a value of biotite specific surface area of 600 m2 m3 in the two pathways model fig 10b thick green dashed line the same value was used to define a s hr whereas f hr was set to 0 99 and a s lr a s hr 1 2 table 4 3 3 vc2 numerical experiment larger amount of biotite the results of the vc2 numerical experiment are shown in fig 10c the single pathway analytical model eq 8 is best fitted to the numerical average profile using a value of specific surface area of 400 m2 m3 the two pathways model eq 11 is computed by setting a s hr equal to the value used for the single pathway model f hr equal to 0 95 and a s lr a s hr 2 35 3 4 vc3 numerical experiment larger biotite grains fig 10d shows the penetration profiles of the vc3 numerical experiment the analytical profile single pathway model giving the best fit is computed using a value of specific surface area of 252 m2 m3 the two pathway model eq 11 is best fitted by setting a s hr equal to the value used for the single pathway model f hr equal to 0 95 and a s lr a s hr 2 8 4 discussion in safety assessment studies for the geological disposal of spent nuclear fuel fractured crystalline rock systems are typically conceptualised as dual porosity media with a few hundreds to thousands sparsely distributed fractures and deformation zones that control advective flow patterns and the surrounding intact rock matrix being mostly affected by diffusion processes the intact rock matrix is in turn usually described by homogeneous equivalent parameters i e pore diffusivity porosity and in the presence of geochemical reactions mineral abundance and surface area skb 2011 posiva 2012 however there is striking evidence that the intact rock matrix is far from being intact as it is characterised by a multi scale network of micro fractures which in turn intersect a complex and heterogeneous distribution of different types of mineral grains iraola et al 2017 here we have carried out four numerical experiments focused on assessing the implication of this physical and mineralogical heterogeneous structure on oxygen transport for a conservative tracer the heterogeneous distribution of porosity and pore diffusivity denoted here as physical heterogeneity leads to finger shaped penetration patterns however we have shown that the average penetration profile can be described fairly well by a standard analytical solution based on an equivalent value of diffusivity and porosity the results of oxygen concentration are interpreted using a homogeneous based analytical solution that is presented in the methodological part of this paper in contrast to the conservative tracer which is not affected by geochemical reactions and thus is not influenced by mineralogical heterogeneity the penetration profiles of oxygen from the micro dfn based heterogeneous continuum model deviate from those expected when the assumption of homogeneity is invoked this deviation which is particularly significant for three out of the four experiments i e bc vc2 and vc3 see fig 10 affects the last part of the penetration profiles i e low concentration maximum penetration depth the divergence from the homogeneous behavior is interpreted here in terms of an interplay between physical and mineralogical heterogeneity in particular in the presence of geochemical reactions and sparsely distributed active grains the medium behaves as a composite system where a large amount of the oxygen is consumed in highly reactive parts of the domain and a low amount of oxygen can diffuse longer distances along less reactive regions this effect is quantified using a simplified analytical two pathway model eq 11 that gives an estimation of the relative amount between high and low reactive regions f hr and the relative reactivity between the two regions the latter is quantified as the ratio between the biotite specific surface area of the high and low reactive region a s hr a s lr in bc vc2 and vc3 a significant part of the mass of oxygen 5 corresponding to f hr 0 95 see table 4 is shown to diffuse along the less reactive pathway whose specific surface area is more than twice lower than that of the high reactive system this composite behavior is less evident for the case with higher diffusivity vc1 where both f hr and a s hr a s lr are close to unity this different response is related to the different timescales for diffusion and reactions the ratio of these timescales is quantified using a global diffusive damköhler number d a which is however typically employed with n th order kinetic reactions here we approximate d a as in molins et al 2012 12 d a 1 1000 k fe diss l c 20 d p where l m is the characteristic length for diffusion which is set here equal to the maximum penetration depth of oxygen 1 10 2 m for bc vc2 and vc3 and 6 10 2 m for vc1 see fig 10 for bc vc2 and vc3 the damköhler number is approximately 8 6 this means that in these numerical experiments chemical reactions are dominant over diffusive processes and this explains the evident signature of heterogeneity in the resulting average profiles seen in fig 10 in vc1 with a higher diffusivity d a 0 5 i e diffusion becomes dominant and smooths out the irregular mineral distribution thus leading to more homogeneous average profiles also in vc1 a higher value of a s hr is used table 4 as high diffusive processes make more biotite grains available for reactions other interesting results are the influence of biotite abundance and mineral grain size on the extent of oxygen penetration when a higher amount of biotite is available vc2 vs bc the penetration depth of oxygen is slightly lower however the system seems to be more sensitive to mineral grain size in fact when larger mineral grains are considered vc3 vs bc a considerable larger extent of oxygen penetration is observed as a result of the lower equivalent biotite specific surface an equivalent value of biotite specific surface has also been tested a s bulk which is the average exposed biotite specific surface area in the whole bulk volume of the rock in all the considered cases the penetration profiles computed using this equivalent parameter under estimate the actual oxygen penetration see figs 8 and 10 this under estimation is significant for those cases characterised by a high damköhler number on the contrary for vc1 the equivalent solution provides a reasonable approximation to the results of the numerical experiment particularly at high oxygen concentrations this better agreement is due to the importance of diffusion processes for this numerical experiment which makes more surface area available for reactions in a practical application such as the evaluation of the potential corrosion of a copper canister in a nuclear waste repository only relatively high oxygen concentrations are of concern in fact the copper corrosion rate is linearly dependent on oxygen concentration king et al 2012 thus we evaluate here the relative difference between the analytical solution based on a s bulk when used to compute the penetration distance for an oxygen concentration of 1 10 5 mol l 0 5 mg l the difference ξ is calculated as 13 ξ l 0 5 l 0 5 bulk l 0 5 where l 0 5 m and l 0 5 bulk m are respectively the penetration depth computed using the average penetration profile from the related numerical experiment and the analytical solution based on a s bulk the results are summarised in the last column of table 4 for the three cases characterised by a high damköhler number the equivalent homogeneous based solution under estimates the penetration depth by between 45 and 56 the under estimation is slightly higher for the variant case with larger biotite grain sizes vc3 because the available mineral surface is clustered in bigger grains and thus only the external surface is actually exposed to high oxygen fluxes for low damköhler numbers i e vc1 the deviation is significantly decreased 6 a direct comparison of our calculated oxygen penetration depths into the rock matrix with those published in other studies is not straightforward due to the different parameterisation of the different studies and because none of the previous studies aimed at investigating the role of mineral heterogeneity the main discrepancies between the parameters for the calculations reported by both spiessl et al 2008 and macquarrie et al 2010 as compared with our base case are in the reactive surface area 66 m2 m3 versus 695 m2 m3 and in the pore diffusivity 1 1 10 10 m2 s versus 3 5 10 13 m2 s and these differences leads in our calculations to a shorter penetration of oxygen into the rock matrix the 1d and 2d calculations reported by sidborn et al 2010 showed a good agreement between the analytical expression eq 8 and their numerical results appendix e in sidborn et al 2010 based on geometrical grain size considerations and a biotite volume fraction of 7 4 sidborn et al 2010 deduced a reactive surface area of 11 100 m2 m3 larger than the a s bulk value obtained from our micro dfn model 695 m2 m3 with this value of reactive surface area they obtained similar penetration profiles as those computed in the present work for the base case simulation the agreement is due to the fact that the smaller value of surface area used in the base case simulation present work is counterbalanced by the larger pore diffusivity value used in sidborn et al 2010 another practical implication that is of high relevance for the safety of a deep geological repository is how the heterogeneous behaviour discussed in this work can affect oxygen advective flow pathways in the surrounding flowing fractures to discuss this issue we recall that the steady state oxygen penetration along a flowing fracture depends on the amount of oxygen mass transfer with the surrounding rock matrix sidborn et al 2010 for the same value of effective diffusion this mass transfer is a function of the interfacial oxygen gradient for instance an increased reaction rate e g due to a larger equivalent mineral specific surface implies a steeper interfacial gradient with an increased rate of oxygen mass exchange when equivalent fluxes computed using the analytical solution based on a s bulk are compared with the fluxes computed in the four numerical cases it is found that the homogeneous analytical solution underestimates the average oxygen interfacial flux by a factor between approximately 3 and 4 depending on the numerical case 5 conclusions in fractured crystalline systems the rock matrix is an important buffer that can e g retard the migration of radionuclides or consume a part of the oxygen that diffuses from the surface after a glaciation deglaciation event in safety analyses of deep geological repositories the rock matrix is typically treated as a secondary continuum with homogeneous physical and mineralogical parameters skb 2011 posiva 2012 here we have assessed this assumption considering a problem of concern for the afore mentioned safety analyses the diffusive penetration of oxygen into an anoxic and initially reducing rock system our numerical models have indicated that the combined effect of physical and mineralogical heterogeneity results in oxygen travelling deeper into the rock matrix than estimated by the single pathway homogeneous analytical model the evidence of the crystalline rock matrix behaving as a composite system with the coexistence of fast and slow or high reactive and low reactive diffusive pathways is consistent with observations made in different laboratory and field experiments tsukamoto and ohe 1993 johansson et al 1998 nilsson et al 2010 our interpretation of the numerical experiments shows that when assessing the diffusive penetration of oxygen in fractured crystalline systems the heterogeneity of the rock matrix should be considered moreover a careful characterisation of physical and mineralogical heterogeneity e g by means of scanning electron microscopy sem or x ray computed micro tomography x ray microct steefel et al 2015 can provide valuable input for model parameterisation an equivalent value of specific surface area a s bulk i e the average exposed mineral specific surface area in the whole bulk volume of the rock can be used with the analytical solution presented in this paper to provide approximate estimations of the o2 fluxes into the rock matrix from the groundwaters flowing in fractures the analysis presented here has focused on o2 reactive transport processes in the rock matrix occurring at mm sub mm scale in the direction normal to the principal flowpaths along flow bearing fractures the extrapolation of these results along the flowpaths to predict the effect of rock matrix heterogeneity on o2 ingress at to the mesoscale e g the scale assessed in in situ experiments e g banwart et al 1999 or the site scale i e the scale of interest for safety assessment studies for deep geological disposal is still an open issue that requires further investigation acknowledgements pt ms us he and jm thank the swedish nuclear fuel and waste management company skb for the financial support the authors gratefully acknowledge the computing time granted through jara hpc on the supercomputer juqueen at forschungszentrum jülich 
1618,the rock matrix of granites is expected to be an important buffer against the dispersion of contaminants e g radionuclides and against the ingress of oxygenated glacial meltwater the influence of matrix heterogeneity on o2 diffusive transport is assessed here by means of numerical experiments based on a micro discrete fracture network micro dfn representation of the diffusion available pore space along with random realisations of idealized biotite grains to simulate the heterogeneous nature of granitic rocks a homogeneous based analytical solution is also presented and used to assess possible deviations of the numerical experiments from the assumption of homogeneity the analytical solution is also used to test upscaled values of mineral surface area the numerical experiments show that the matrix behaves as a composite system with the coexistence of fast and slow diffusive pathways this behavior is more evident at low damköhler numbers our interpretation of the numerical experiments points out the importance to properly characterise the heterogeneity of the rock matrix keywords oxygen transport mineralogical heterogeneity micro dfn high performance computing 1 introduction granitic rocks and other crystalline rocks are under consideration by different countries as an option for hosting deep geological repositories for spent nuclear fuel some of these repositories will possibly be built at moderate to high latitudes which makes the question relevant of how a glacier terminus laying above the repository location could affect the hydrogeological and hydrogeochemical conditions at repository depth one of the possible effects is that o2 rich glacial meltwater driven by the high hydrological gradients expected during a glacial cycle vidstrand et al 2013 2014 could infiltrate deep into the geological system understanding the buffering capacity of the host rock is then important to evaluate whether the redox perturbation may reach repository depth and e g induce canister corrosion as well as enhance radionuclide mobility banwart et al 1999 although microbes are diligent in metabolizing organic matter with oxygen the expected low concentrations of organic carbon in subglacial environments implies that microbial processes can not be relied on when evaluating the fate of oxygen in glacial meltwaters infiltrating deeply into the ground the main abiotic processes involved in the depletion of dissolved oxygen i e the oxidation of dissolved fe2 and of fe ii bearing minerals have been included in a number of homogeneous based analytical sidborn and neretnieks 2007 sidborn et al 2010 antonellini et al 2017 and numerical glynn et al 1999 auqué et al 2006 guimerà et al 2006 spiessl et al 2008 2009 macquarrie et al 2010 models in these models heterogeneity due to e g the sparse distribution of geochemically reactive minerals is assessed by means of sensitivity analyses where specific parameters e g the mineral surface area or the mineral volume fraction are varied over plausible ranges an explicit analysis of the combined role of physical and mineralogical heterogeneity on the buffering capacity of fractured crystalline rocks has been carried out in two recent articles by trinchero et al 2017 2018 however these studies focused on the role of fracture coating minerals here we assess how rock matrix heterogeneity affects the buffering capacity of a granitic rock we also evaluate how small scale heterogeneity can be upscaled by means of an equivalent mineral surface area approach 2 problem statement 2 1 the heterogeneous nature of granitic rocks granitic rocks are heterogeneous at several scales at the regional and repository site scale several rock units with different types of granitic and crystalline rocks are generally found as seen in the examples of olkiluoto posiva 2013 and forsmark andersson et al 2013 the prospective sites for spent nuclear fuel repositories in finland and sweden respectively in the context of the diffusive transport of reactive solutes two types of heterogeneity are important physical heterogeneity which is related to the distribution of the diffusion available pore space and mineralogical heterogeneity which refers to sparse distribution of the different mineral types and their respective size variability physical heterogeneity of granitic and crystalline rocks is generally evident from micro scale analyses for instance fig 1 shows the autoradiograph of a granodiorite sample widestrand et al 2010 from the äspö hard rock laboratory at oskarshamn sweden impregnated with 14c pmma polymethylmethacrylate the dark areas in the autoradiograph indicate connected porosity sammaljärvi et al 2017 describe the pore space in crystalline rocks as the sum of microfractures inter granular grain boundary pores which surround mineral grains and the intra granular porosity found within mineral grains despite the complexity of the structure of the pore space svensson et al 2018 have recently shown that it can be fairly well approximated by a micro discrete fracture network micro dfn besides the pore space the different mineral grains are also heterogeneously distributed in a random manner in granites but foliated distributions are observed in gneissic rocks in the context of granitic rock a particularly interesting mineral phase is biotite k mg fe 3a1si3o10 oh 2 an iron ii bearing mineral that has the potential to retain potentially harmful dissolved radionuclides kyllönen et al 2014 and that can also reduce and buffer the ingress of o2 rich waters sidborn and neretnieks 2007 malmström and banwart 1997 as exemplified by the photograph shown in fig 1 biotite grains are dispersed in a random manner in äspö granodiorite observations made with microscopy in a granitic rock sample taken at forsmark sweden suggest that typical biotite grains there have an average size of 400 200 μm2 0 08 mm2 although aggregates of grains up to 2 mm2 can also be found drake et al 2006 the influence of the physical and mineralogical heterogeneity of the rock matrix on buffering mechanisms against oxygen diffusive penetration is studied in this paper the investigation is carried out using a micro dfn model combined with random distributions of mineral grains an analytical solution is first introduced which is used to interpret the results of the numerical experiments as well as to evaluate upscaled parameters of mineral surface area 2 2 oxygen transport and abiotic buffering mechanisms we consider a hydraulically active fracture with a continuous recharge of oxygenated water at the upstream boundary oxygen in the fracture diffuses from the fracture into the rock matrix where it is consumed by the dissolution of a fe ii bearing reduced mineral i e biotite 2 2 1 governing equations the conceptual model is first solved analytically here the model is comprised of a dual porosity domain that includes a fracture where transport is dominated by advection and an adjacent rock matrix where transport is dominated by diffusion equations describing the mass balance of dissolved oxygen ferrous iron and biotite are expressed for the rock matrix in eq 1 and for the fracture in eq 2 1a c 1 t d p 2 c 1 z 2 fr ox 1b c 2 t d p 2 c 2 z 2 r diss r ox 1c c 3 t r diss 2a c 1 t d w 2 c 1 x 2 v c 1 x d e 2 δ c 1 z z 0 f r ox 2b c 2 t d w 2 c 2 x 2 v c 2 x d e 2 δ c 2 z z 0 r ox where c 1 x z t c 2 x z t and c 3 x z t mol lw with subscript w denoting water are respectively the matrix pore water concentrations of o2 fe2 and fe ii in biotite expressed based on the volume of pore water concentrations are dependent on the spatial location along the flowing fracture x the normal distance from the fracture surface into the rock matrix z and vary transiently with time t corresponding concentrations of o2 and fe2 in the flowing fracture i e at z 0 are denoted without apostrophes biotite grains are present in the matrix only the advective water velocity in the fracture and the fracture aperture width are denoted v m s and δ m respectively d p m2 s d w m2 s and d e m2 s are the pore diffusivity in the rock matrix diffusivity in the fracture water and the effective diffusivity in the rock matrix respectively the effective diffusion coefficient is defined as d e d w ϕ τ d 2 where ϕ is the diffusion available porosity and τ d is the effective tortuosity of the porous medium see svensson et al 2018 while the pore diffusion coefficient is d p d e ϕ that is d p d w τ d 2 in this model oxygen is consumed abiotically through a serial process involving non oxidative dissolution of ferrous iron in biotite followed by homogeneous oxidation of dissolved ferrous ions by oxygen fe2 0 25o2 2 5h2o fe oh 3 am 2h with a reaction stoichiometry factor f 0 25 moles o2 per mol fe the rates of these individual reactions are assumed to be described by the rate expressions in eq 3 expressed in terms of the oxidation dissolution of ferrous iron 3a r ox mol fe l w 1 s 1 k r c 1 c 2 c oh 2 k h 3b r diss mol fe l w 1 s 1 k fe diss a s 1 000 ϕ c 3 c 30 2 3 1 c 2 c 20 where ϕ is the matrix porosity a s m2 m3 is the initial biotite specific surface area note that the specific surface area is here expressed relative to the bulk volume and c 20 mol lw and c 30 mol lw are respectively the ferrous ion concentration at steady state and the initial concentration of fe ii in biotite in the matrix field observations at the forsmark hallbeck and pedersen 2012 drake et al 2018 and olkiluoto bomberg et al 2015 sites show that the iron ii concentration in deep groundwaters varies in general between 0 1to40 10 6 mol lw a value c 20 1 8 10 6 mol lw is used in the calculations hereafter the other parameters of eq 3 are specified in table 1 except for the values of a s c 10 ϕ and d p which are case specific 2 2 2 oxidation limited by reactions kinetics initially when the biotite in the rock matrix is unaltered i e the ferrous content in biotite is c 3 c 30 the overall reaction rate is controlled by dissolution or oxidation reaction kinetics rather than constrained by diffusive transport these reactions are assumed to occur serially with an overall rate determined by the slower of the two reaction steps the overall rate can then be described by either of the rate expressions r diss r ox for the condition 4 c 2 c 20 k 2 k 2 k 1 c 1 where k 1 k r kh c 20 c oh 2 and k 2 k fe diss a s 1 000ϕ c 3 c 30 2 3 substituting eq 4 in the rate expression r ox eq 3a and assuming pseudo steady state which implies that c 1 t 0 the mass balance equation for oxygen eq 1 reduces to 5 d p 2 c 1 z 2 f c 1 k 1 1 c 1 k 1 k 2 the right hand side of this expression describes a reaction rate that gradually changes from zero order to first order with respect to the dissolved oxygen concentration c 1 for k 1 k 2 c 1 1 c 1 k 1 1 c 1 k 1 k 2 k 2 zero order kinetics for k 1 k 2 c 1 1 c 1 k 1 1 c 1 k 1 k 2 0 5 k 1 c 1 0 5 k 2 transition for k 1 k 2 c 1 1 c 1 k 1 1 c 1 k 1 k 2 k 1 c 1 first order kinetics close to the fracture the oxygen concentration may be sufficiently high for the rate to be zero order deep in the matrix the oxygen concentration approaches zero and at some distance z c from the fracture there is a transition from zero order to first order kinetics the concentration at this distance is c 1 z z c k 2 k 1 the general solution to eq 5 can be written 6 c 1 a 1 e z z c α a 2 e z z c α for z z c β 2 z 2 a 3 z a 4 for z z c where α fk 1 d p and β fk 2 d p respectively note that α and β c 1 are dimensionless measures of the relative rates of reaction and diffusive transport for the domains of first order kinetics and zero order kinetics respectively commonly referred to as the second damköhler numbers the particular solution is derived for the boundary conditions 7 c 1 0 at z a 1 0 c 1 k 2 k 1 at z z c a 2 k 2 k 1 β α c 1 c 1 at z 0 a 4 c 1 the integration constant a 3 which can be interpreted as the concentration gradient at the fracture matrix interface c 1 z z 0 and the distance z c are finally obtained by assuming that both the concentration and the concentration gradient are continuous at the location of transition z z c the concentration of oxygen in the porous rock matrix is then obtained in eq 8 as a function of α β the concentration c 1 of oxygen in the fracture and the distance into the rock matrix z 8 c 1 β α e z z c α for z z c β 2 z 2 a 3 z c 1 for z z c where z c 2 c 1 β 1 α 1 α and a 3 2 c 1 β β 2 α eq 8 has been used to assess the possible penetration of oxygen in the last swedish safety analysis of the potential nuclear waste repository at forsmark sidborn et al 2010 an illustrative result for the o2 concentration profile as a function of distance in the rock matrix is shown in fig 2 for the case of a fracture concentration of oxygen c 1 3 10 5 molo2 lw a biotite specific surface a s 11 000 m2m 3 a porosity ϕ 0 0018 and a pore diffusivity d p 1 17 10 11 m2 s skb 2010 additional parameters are given in table 1 2 2 3 oxidation limited by diffusion resistance with time diffusion resistance becomes increasingly important as ferrous iron in biotite close to the fracture is exhausted at some point the diffusion of dissolved species in the pores of the matrix becomes slow compared to the dissolution reaction rates and the reactive process is governed by the diffusion transport resistance this implies a sharp reaction front that propagates further into the matrix with time in the fully transient system described by eq 1 the dissolution reaction front propagates into the rock matrix with time coupled with a change in concentration profiles with the diffusion of dissolved species in the pores of the matrix being fast compared to the front displacement the concentration profiles are always at steady state for a certain front location an analytical solution for this pseudo steady state is derived in sidborn and neretnieks 2007 an equivalent expression was derived by rajaram and arshadi 2016 using a similarity solution for reaction front propagation 2 3 numerical experiments the inter granular space of a synthetic granitic rock is described here using a micro discrete fracture model svensson et al 2018 i e three different fracture sets of length from one to a few millimeters are used to mimic grain boundary pores as well as micro fractures that transect different mineral grains the micro dfn and the equivalent continuous porous medium model based on this micro dfn were generated using the finite volume groundwater flow simulator darcytools svensson et al 2010 svensson and ferry 2014 details on the method to generate the micro dfn used here is provided in svensson et al 2018 the parameters describing each fracture set are listed in table 2 these parameters are the same used in svensson et al 2018 to mimic diffusive properties of a granitic rock sample from borehole kfm02a of forsmark however the numerical grid of this continuum model differs from that of svensson et al 2018 in refinement topology and in the fact that here no cells are deactivated and thus the model should be regarded as synthetic the properties of the base case model which are discussed in detail in section 3 1 resemble those of a tight granitic rock with a relatively low amount of exposed mineral surface area dfn derived pore diffusivity and porosity ϕ values were assigned to all the active cells of the continuum model using the approach described by svensson 2001a 2001b i e intersecting volumes between fractures and grid cells were computed and the contributions from all intersecting fractures were added to the related parameters of each grid cell the fracture surface i e the total fracture surface that intersects a given grid cell s f m2 was also retrieved at each grid cell all the cells that were not in contact with the generated fractures and cells in contact with isolated fractures and their contacting cells were assigned a minimum value of porosity ϕ 1 10 4 and pore diffusivity d p 1 1 10 15 m2 s the resulting distribution of porosity pore diffusivity and fracture surface is shown in fig 3 note that the bulk pore diffusivity is here obtained by fitting penetration profiles of a conservative tracer as described in section 3 1 the bulk porosity of the model is ϕ 2 2 10 3 the dimension of the continuum model domain is 3 0 10 2 m 4 75 10 3 m 1 25 10 1 m and is discretized with 118 19 500 1 121 000 rectangular cuboids with constant refinement δ cont 2 5 10 4 m biotite grain distributions were generated over an independent grid using binary random uncorrelated realisations that simulate the presence or absence of a biotite grain the distribution of biotite grains for the different considered cases is shown in fig 4 notice that all the considered cases are discussed in detail further below the discretization δ grain of this biotite grain grid coincides with the considered biotite grain size 6 3 10 4 m in the continuum model mineral dissolution is then parameterised by assuming that for the i th grid cell the exposed biotite specific surface area is given by 9 a s i ε i s f i δ cont 3 where ε i is the volume fraction of the cell occupied by biotite each random realisation of biotite is characterised a priori using equivalent values of specific surface area 10 a s bulk δ cont 3 v b a s i where δ cont m is the discretisation of the continuum model and v b is the bulk volume of the rock 1 75 10 5 m3 a s bulk is the total fracture surface in contact with the reactive mineral biotite divided by the bulk volume of the model and it can be directly derived from the underlying dfn the system is considered to be initially anoxic and a constant oxygen concentration of 1 5 10 3 mol l w 48 mg l w is applied at z 0 the left boundary in figs 3 to 6 this value of oxygen concentration was used elsewhere to simulate the ingress of glacial meltwater in a previous work trinchero et al 2017 a conservative tracer is also added to the boundary water the numerical calculations were carried out using pflotran hammond and lichtner 2010 which was run in the supercomputer juqueen of the jülich supercomputing centre stephan and docter 2015 the geochemical reactions included in pflotran are those discussed in sub section oxidation limited by reactions kinetics and the related parameters are those listed in table 1 except for the biotite specific surface area that is given by eq 9 four numerical experiments are considered a base case bc and three variant cases each simulation having a different distribution of biotite and or different sets of physical parameters table 3 in variant case 1 vc1 the pore diffusivity was scaled by multiplying each cell value by a factor of 100 mimicking a more altered granitic rock in variant case 2 vc2 the average amount of biotite was doubled as compared to the bc while keeping all other parameters unchanged and for the variant case 3 vc3 the average size of the biotite grains was increased to approximately the double as compared to the bc to 1 2 10 3 m c f table 3 with all other parameters kept unchanged concerning the amount of biotite used in these models it is convenient to refer here to the work of drake et al 2006 which contains a comprehensive analysis of rock mineralogy at two swedish sites forsmark and laxemar in this work it is reported that the main rock type at the forsmark site contains biotite in a range of 0 8 8 vol while at the laxemar site the three main rock types ävrö granite quartz monzodiorite and fine grained dioritoid contain up to 49 vol of biotite thus the amount of biotite used in all the numerical experiments described in table 3 should be considered to represent some of the variability that may be expected in granitic rocks 3 results snapshots of oxygen concentration at steady state for the four numerical experiments are shown in fig 5 for all the experiments steady state conditions are attained after 15y approximately except for the variant case with higher diffusivity vc1 where a steady state penetration profile is observed at 2y approximately a summary of the results of the four experiment along with the parameters used to interpret the numerical profiles is provided in table 4 3 1 base case bc numerical experiment the bc numerical experiment was extended in time until a steady state oxygen concentration was observed 15 yr the results are analysed here mostly in terms of penetration profiles which are computed along 118 different transects one transect per each grid cell in a row of cells taken at the x y plane and with y 2 4 10 3 m parallel to the z direction the direction of the oxygen concentration gradient the x y location of each transect is the centroid of the corresponding grid cell first the penetration patterns of the conservative tracer fig 6 are analysed in order to infer an equivalent value of pore diffusivity to be used in the subsequent analysis of oxygen transport the transient penetration profiles of the conservative tracer are visually fitted to the analytical solution for diffusion in a plane sheet carslaw and jaeger 1959 crank 1979 fig 7 the best fit is obtained with a value of pore diffusivity of 3 5 10 13 m2 s this value along with the bulk value of porosity is used as input for the analytical solution of oxygen transport the computed penetration profiles of oxygen at steady state are shown in fig 8a thin gray lines along with the average penetration profile i e penetration profile obtained with the arithmetic mean of the 118 transects the analysis of biotite concentration shows that for the considered simulation time frame the consumption of biotite is modest even close to the injection boundary results not shown here for the sake of brevity thus the results are interpreted here using the analytical solution provided by eq 8 along with the parameters listed in table 1 the same approach has been used for the rest of numerical experiments in fig 8a the penetration profile obtained with eq 8 using a s bulk is also shown this profile significantly overestimates the buffering capacity of the rock i e the capacity of the rock to buffer the redox perturbation the analytical solution is also used to fit the average concentration profiles here the biotite specific surface area is the only fitting parameter and the resulting best fit value is 320 m2 m3 the analytical solution captures well the first part of the profile but deviates from the numerical results at low concentrations in fig 8b the analytical solution is used to span all the observed penetration distances i e maximum penetration for a given mineral specific surface area this is done by first computing the two bounding curves a s equal to 695 m 2 m 3 i e shortest penetration and a s equal to 135 m 2 m 3 i e longest penetration and then plotting the other curves with a step size of 5 m 2 m 3 interestingly the penetration profile obtained by averaging all these analytically computed curves agrees well with the numerically computed average penetration profile this indicates that the medium indeed behaves as a composite system with the average penetration profile being the result of multiple parallel diffusive pathway characterised by different reactivity to further explore this effect we propose here an alternative simplified analytical model based on two parallel diffusive pathways 11 c 1 f hr c 1 hr 1 f hr c 1 lr where f hr is the fraction of oxygen that is driven through the high reactive pathway superscript hr and 1 f hr is the remaining part that diffuses along the low reactive pathway superscript lr both the concentration of oxygen in the high reactive and low reactive pathway c 1 hr and c 1 lr are calculated using eq 8 a similar two pathways model was used to simulate preferential flow through an unsaturated mining waste rock pile trinchero et al 2011 the influence of the second less reactive pathway is visually illustrated in fig 9 where oxygen penetration profiles are simulated with arbitrarily selected values and with a range of f hr that spans from 0 to 1 from the figure it is evident that the low reactive pathway even if present only in a very small fraction controls the maximum penetration depth of oxygen while f hr controls the transition part of the profile the two pathways model eq 11 was visually fitted to the experimental results with the following parameters table 4 giving a reasonable good match with the experiment fig 10a thick green dashed line f hr 0 95 a s hr 320 m2 m3 i e same specific surface area used for the single pathway analytical model eq 8 and a s lr a s hr 2 35 3 2 vc1 numerical experiment higher diffusivity this variant case tries to mimic a more altered granitic rock by scaling the diffusivity of each cell by a factor of 100 the higher values of diffusivity are close to 1 10 9 m2 s i e the value of molecular diffusion in pure water the results of this numerical experiment along with the different fits with the analytical solutions are shown in fig 10b for the single pathway analytical model fig 10b thick green continuous line the fit was obtained with a value of biotite specific surface area of 600 m2 m3 in the two pathways model fig 10b thick green dashed line the same value was used to define a s hr whereas f hr was set to 0 99 and a s lr a s hr 1 2 table 4 3 3 vc2 numerical experiment larger amount of biotite the results of the vc2 numerical experiment are shown in fig 10c the single pathway analytical model eq 8 is best fitted to the numerical average profile using a value of specific surface area of 400 m2 m3 the two pathways model eq 11 is computed by setting a s hr equal to the value used for the single pathway model f hr equal to 0 95 and a s lr a s hr 2 35 3 4 vc3 numerical experiment larger biotite grains fig 10d shows the penetration profiles of the vc3 numerical experiment the analytical profile single pathway model giving the best fit is computed using a value of specific surface area of 252 m2 m3 the two pathway model eq 11 is best fitted by setting a s hr equal to the value used for the single pathway model f hr equal to 0 95 and a s lr a s hr 2 8 4 discussion in safety assessment studies for the geological disposal of spent nuclear fuel fractured crystalline rock systems are typically conceptualised as dual porosity media with a few hundreds to thousands sparsely distributed fractures and deformation zones that control advective flow patterns and the surrounding intact rock matrix being mostly affected by diffusion processes the intact rock matrix is in turn usually described by homogeneous equivalent parameters i e pore diffusivity porosity and in the presence of geochemical reactions mineral abundance and surface area skb 2011 posiva 2012 however there is striking evidence that the intact rock matrix is far from being intact as it is characterised by a multi scale network of micro fractures which in turn intersect a complex and heterogeneous distribution of different types of mineral grains iraola et al 2017 here we have carried out four numerical experiments focused on assessing the implication of this physical and mineralogical heterogeneous structure on oxygen transport for a conservative tracer the heterogeneous distribution of porosity and pore diffusivity denoted here as physical heterogeneity leads to finger shaped penetration patterns however we have shown that the average penetration profile can be described fairly well by a standard analytical solution based on an equivalent value of diffusivity and porosity the results of oxygen concentration are interpreted using a homogeneous based analytical solution that is presented in the methodological part of this paper in contrast to the conservative tracer which is not affected by geochemical reactions and thus is not influenced by mineralogical heterogeneity the penetration profiles of oxygen from the micro dfn based heterogeneous continuum model deviate from those expected when the assumption of homogeneity is invoked this deviation which is particularly significant for three out of the four experiments i e bc vc2 and vc3 see fig 10 affects the last part of the penetration profiles i e low concentration maximum penetration depth the divergence from the homogeneous behavior is interpreted here in terms of an interplay between physical and mineralogical heterogeneity in particular in the presence of geochemical reactions and sparsely distributed active grains the medium behaves as a composite system where a large amount of the oxygen is consumed in highly reactive parts of the domain and a low amount of oxygen can diffuse longer distances along less reactive regions this effect is quantified using a simplified analytical two pathway model eq 11 that gives an estimation of the relative amount between high and low reactive regions f hr and the relative reactivity between the two regions the latter is quantified as the ratio between the biotite specific surface area of the high and low reactive region a s hr a s lr in bc vc2 and vc3 a significant part of the mass of oxygen 5 corresponding to f hr 0 95 see table 4 is shown to diffuse along the less reactive pathway whose specific surface area is more than twice lower than that of the high reactive system this composite behavior is less evident for the case with higher diffusivity vc1 where both f hr and a s hr a s lr are close to unity this different response is related to the different timescales for diffusion and reactions the ratio of these timescales is quantified using a global diffusive damköhler number d a which is however typically employed with n th order kinetic reactions here we approximate d a as in molins et al 2012 12 d a 1 1000 k fe diss l c 20 d p where l m is the characteristic length for diffusion which is set here equal to the maximum penetration depth of oxygen 1 10 2 m for bc vc2 and vc3 and 6 10 2 m for vc1 see fig 10 for bc vc2 and vc3 the damköhler number is approximately 8 6 this means that in these numerical experiments chemical reactions are dominant over diffusive processes and this explains the evident signature of heterogeneity in the resulting average profiles seen in fig 10 in vc1 with a higher diffusivity d a 0 5 i e diffusion becomes dominant and smooths out the irregular mineral distribution thus leading to more homogeneous average profiles also in vc1 a higher value of a s hr is used table 4 as high diffusive processes make more biotite grains available for reactions other interesting results are the influence of biotite abundance and mineral grain size on the extent of oxygen penetration when a higher amount of biotite is available vc2 vs bc the penetration depth of oxygen is slightly lower however the system seems to be more sensitive to mineral grain size in fact when larger mineral grains are considered vc3 vs bc a considerable larger extent of oxygen penetration is observed as a result of the lower equivalent biotite specific surface an equivalent value of biotite specific surface has also been tested a s bulk which is the average exposed biotite specific surface area in the whole bulk volume of the rock in all the considered cases the penetration profiles computed using this equivalent parameter under estimate the actual oxygen penetration see figs 8 and 10 this under estimation is significant for those cases characterised by a high damköhler number on the contrary for vc1 the equivalent solution provides a reasonable approximation to the results of the numerical experiment particularly at high oxygen concentrations this better agreement is due to the importance of diffusion processes for this numerical experiment which makes more surface area available for reactions in a practical application such as the evaluation of the potential corrosion of a copper canister in a nuclear waste repository only relatively high oxygen concentrations are of concern in fact the copper corrosion rate is linearly dependent on oxygen concentration king et al 2012 thus we evaluate here the relative difference between the analytical solution based on a s bulk when used to compute the penetration distance for an oxygen concentration of 1 10 5 mol l 0 5 mg l the difference ξ is calculated as 13 ξ l 0 5 l 0 5 bulk l 0 5 where l 0 5 m and l 0 5 bulk m are respectively the penetration depth computed using the average penetration profile from the related numerical experiment and the analytical solution based on a s bulk the results are summarised in the last column of table 4 for the three cases characterised by a high damköhler number the equivalent homogeneous based solution under estimates the penetration depth by between 45 and 56 the under estimation is slightly higher for the variant case with larger biotite grain sizes vc3 because the available mineral surface is clustered in bigger grains and thus only the external surface is actually exposed to high oxygen fluxes for low damköhler numbers i e vc1 the deviation is significantly decreased 6 a direct comparison of our calculated oxygen penetration depths into the rock matrix with those published in other studies is not straightforward due to the different parameterisation of the different studies and because none of the previous studies aimed at investigating the role of mineral heterogeneity the main discrepancies between the parameters for the calculations reported by both spiessl et al 2008 and macquarrie et al 2010 as compared with our base case are in the reactive surface area 66 m2 m3 versus 695 m2 m3 and in the pore diffusivity 1 1 10 10 m2 s versus 3 5 10 13 m2 s and these differences leads in our calculations to a shorter penetration of oxygen into the rock matrix the 1d and 2d calculations reported by sidborn et al 2010 showed a good agreement between the analytical expression eq 8 and their numerical results appendix e in sidborn et al 2010 based on geometrical grain size considerations and a biotite volume fraction of 7 4 sidborn et al 2010 deduced a reactive surface area of 11 100 m2 m3 larger than the a s bulk value obtained from our micro dfn model 695 m2 m3 with this value of reactive surface area they obtained similar penetration profiles as those computed in the present work for the base case simulation the agreement is due to the fact that the smaller value of surface area used in the base case simulation present work is counterbalanced by the larger pore diffusivity value used in sidborn et al 2010 another practical implication that is of high relevance for the safety of a deep geological repository is how the heterogeneous behaviour discussed in this work can affect oxygen advective flow pathways in the surrounding flowing fractures to discuss this issue we recall that the steady state oxygen penetration along a flowing fracture depends on the amount of oxygen mass transfer with the surrounding rock matrix sidborn et al 2010 for the same value of effective diffusion this mass transfer is a function of the interfacial oxygen gradient for instance an increased reaction rate e g due to a larger equivalent mineral specific surface implies a steeper interfacial gradient with an increased rate of oxygen mass exchange when equivalent fluxes computed using the analytical solution based on a s bulk are compared with the fluxes computed in the four numerical cases it is found that the homogeneous analytical solution underestimates the average oxygen interfacial flux by a factor between approximately 3 and 4 depending on the numerical case 5 conclusions in fractured crystalline systems the rock matrix is an important buffer that can e g retard the migration of radionuclides or consume a part of the oxygen that diffuses from the surface after a glaciation deglaciation event in safety analyses of deep geological repositories the rock matrix is typically treated as a secondary continuum with homogeneous physical and mineralogical parameters skb 2011 posiva 2012 here we have assessed this assumption considering a problem of concern for the afore mentioned safety analyses the diffusive penetration of oxygen into an anoxic and initially reducing rock system our numerical models have indicated that the combined effect of physical and mineralogical heterogeneity results in oxygen travelling deeper into the rock matrix than estimated by the single pathway homogeneous analytical model the evidence of the crystalline rock matrix behaving as a composite system with the coexistence of fast and slow or high reactive and low reactive diffusive pathways is consistent with observations made in different laboratory and field experiments tsukamoto and ohe 1993 johansson et al 1998 nilsson et al 2010 our interpretation of the numerical experiments shows that when assessing the diffusive penetration of oxygen in fractured crystalline systems the heterogeneity of the rock matrix should be considered moreover a careful characterisation of physical and mineralogical heterogeneity e g by means of scanning electron microscopy sem or x ray computed micro tomography x ray microct steefel et al 2015 can provide valuable input for model parameterisation an equivalent value of specific surface area a s bulk i e the average exposed mineral specific surface area in the whole bulk volume of the rock can be used with the analytical solution presented in this paper to provide approximate estimations of the o2 fluxes into the rock matrix from the groundwaters flowing in fractures the analysis presented here has focused on o2 reactive transport processes in the rock matrix occurring at mm sub mm scale in the direction normal to the principal flowpaths along flow bearing fractures the extrapolation of these results along the flowpaths to predict the effect of rock matrix heterogeneity on o2 ingress at to the mesoscale e g the scale assessed in in situ experiments e g banwart et al 1999 or the site scale i e the scale of interest for safety assessment studies for deep geological disposal is still an open issue that requires further investigation acknowledgements pt ms us he and jm thank the swedish nuclear fuel and waste management company skb for the financial support the authors gratefully acknowledge the computing time granted through jara hpc on the supercomputer juqueen at forschungszentrum jülich 
1619,simulation of dissolution processes with a pore scale reactive transport model increases insight in coupled chemical physical transport processes however modelling of dissolution process often requires a large number of time steps especially when the buffering capacity of solid phases is high in this work we analyze the interplay between solid buffering on one hand and transport on the other based on this analysis we propose an approach to reduce the number of required time steps for simulating equilibrium dissolution processes the underlying idea is that the number of time step iterations can be reduced if the buffering is sufficient to bring the system to a steady state i e that the concentration field around solid is time invariant if this condition is satisfied then it is possible to reduce the physical and thus also computational time by adjusting the chemical system appropriately first we derived a dimensionless value called buffering number to determine under which conditions reduction in time can be made several examples illustrate that below a certain buffering number the physical time can be reduced without significant effect on result e g dissolution front as long as the solid volume fraction is sufficient this means that for a given solid liquid system the calculation time can be reduced either by the reduction of mass in solid or by the increase of equilibrium concentration solubility we also show that the calculation time for calcium leaching in cementitious systems can be reduced by 50 times with a negligible error keywords dissolution equilibrium chemistry acceleration pore scale modelling pacs 02 70 c 82 60 hc 1 introduction the process of dissolution occurs when a solute comes in contact with a solvent and dissolves to form a solution transport and dissolution in porous media is important in many hydrogeological problems involving contaminant release from nuclear disposal facilities contaminant transport in groundwater resources and geological storage of co2 the dissolution of a solid solute in a porous structure changes the geometry which among others leads to the evolution of physical properties reactive transport codes are well established tools to assess the chemical evolution of natural and engineered systems steefel et al 2015 more specifically these models are able to capture geochemical changes when two or more geochemical environments result in local thermodynamic disequilibruim due to geochemical gradients such conditions can be found in many natural and engineering applications bazilevskaya et al 2015 marty et al 2015 perko et al 2015 the main advantage of using numerical modelling is to obtain improved understanding of the system behaviour at the process level kang et al 2014 kang et al 2010 molins et al 2012 muljadi et al 2018 prasianakis et al 2017 especially in systems where processes are very slow and the assessment of long term behaviour is sought for one example is geochemical detrimental degradation processes in cement based systems which are typically very slow glasser et al 2008 jacques et al 2014 patel et al 2018 an emerging field of modelling is the study of the pore structure evolution as a consequence of geochemical processes at so called pore scale i e the scale where pore space and solid phases are explicitly resolved including heterogeneity in the solid phase composition e g huber et al 2014 molins et al 2017 seetha et al 2017 such studies aim at understanding the interaction between the microstructure of a porous medium the transport of species and geochemistry and investigate which pore scale features and processes affect properties and evolution on larger spatial scales so that more accurate and robust upscaled constitutive models can be developed for the continuum scale yoon et al 2015 coupled reactive transport modelling at pore scale gives again important insights in the processes of degradation but practical limitations arise from spatial resolution and numerical stability 1 in order to capture the critical features at the pore scale such as the presence of capillary pores or heterogeneity in mineral phases geometrically information with high resolution is needed often the purpose of a microstructural model is to upscale the information obtained at the pore to the continuum scale in practice this entails respecting representative elementary volume rev which in heterogeneous materials can be large thus detailed spatial information for a sufficient large simulation domain requires a fine and large computational discretization resulting in a large number of unknowns and huge memory and computational costs especially for three dimensional domains 2 in many chemical systems the solid phase content is large relative to the aqueous phase content such systems are characterized by a large buffering capacity consequently only a small fraction of the solid solute is consumed at each time step the time step is constrained by numerical stability criteria for example by neumann criteria for diffusion or courant friedrichs lewy cfl stability criterion for advection diffusion transport conditions these criteria are linked to the spatial discretization and smaller time steps are needed for finer spatial discretization this paper deals with low conductive porous media where diffusion process is a dominant transport process and advection is negligible these two aspects together bring numerical models potentially into a situation where the computational costs exceed practical limits in order to solve the problem one can use one or more of the following solutions 1 reduce the size of the computational domain which entails the risk of not respecting rev 2 increase spatial discretization by which we reduce the number of unknowns and increase the time step however the information on smaller scale e g smaller pores might be averaged out which could lead to inadequate description of the modelled system 3 increase computational capabilities by parallelizing the model usually the size of the numerical domain and its discretization are defined by the experimental settings and characterization methods consequently when more complex and larger models are imposed the most straight forward approach is to computationally optimize the solution either by parallelization of processes or by increasing of computational resources e g solve the problem on supercomputer gao et al 2015 liu and mostaghimi 2017 groen et al 2013 shown that lattice boltzmann method can be well scalable up to 32 000 cores with only 11 slowdown however even for a parallelized framework the number of time steps is fixed as it is defined by stability criteria enforced by the migration conditions either being diffusion or advection diffusion fixed by physics and spatial discretization fixed by the model this issue has also been recognised in blunt et al 2013 for flow simulations on pore scale another way of reducing computational time in a coupled reactive transport model is by making the computationally demanding geochemical calculations less demanding by e g look up tables huang et al 2018 first order estimations leal et al 2017 or surrogate modelling lucia et al 2017 mostly such approaches require adaption in the model code but they can give quite significant time profits especially by reducing the number of times that a geochemical calculation has to be performed in a summary for an effective acceleration we need to reduce the number of time steps in this work we explore the possibility to reduce the number of time steps without affecting the key properties and evolution of the system for equilibrium dissolution process and without changing the model code in the first part we define the hypothesis and we develop the approach to defend it for this purpose we derive a measure for evaluating the buffering capacity of solids in the system the hypothesis is tested in a second part on several cases of increasing complexity starting from a simple homogeneous material continuing with more complex heterogeneous material and finally tested on real cementitious system the analyses show that the evolution of pore structure resulting from the dissolution process remains the same for the accelerated system if the buffering conditions are satisfied 2 mass transport and chemical buffering in this study we consider a geochemical system of a solid phase in equilibrium with the aqueous phase when solutes are transported out of the domain at one boundary the solid phase with concentration c solid dissolves instantaneously to reach the aqueous equilibrium concentration c eq mass flux from solid to aqueous phase depends on the transport process in the domain if c solid is sufficiently high relative to the equilibrium concentration the solute concentration field approaches steady state before the spatial distribution of solid changes i e before the solid in a voxel is completely dissolved in other words the diffusive process relaxes to a steady state berezhkovskii et al 2010 before the geometry changes if the steady state is reached faster than the complete dissolution of the solid in a voxel occurs one could use this property for the reduction of the calculation time the purpose of this analysis is to determine to which extent the calculation time can be reduced based on the system parameters such as solid volume c solid c eq or mass distribution for this purpose we define a dimensionless value which we call a buffer number bu as the ratio between mass leached from the solid and mass in the solid 1 bu m out m solid where m solid is mass in solid and m out is mass migrated leached out of the solid in this derivation we limit ourselves to the diffusive transport process the reason is that diffusive processes are always present in porous media and also that the diffusive relaxation time to steady state is longer than the advective one in some porous media for example in cementitious systems diffusion is also a dominant transport mechanism for species when c eq is maintained sufficiently long at the boundary between solid and aqueous solution and the solid remains at the same position this concentration can be considered as a boundary condition for the purpose of derivation we define the reference distance between the boundaries two solids is l the time needed for the aqueous solution to be close to steady state can be determined from the amount of mass which is distributed within the length l the so called length patch or root mean square displacement einstein 1905 for a pure diffusion process the amount of mass that is distributed within the interval l at time t can be expressed in terms of standard deviation of mass in the domain σ 2 d t note that for simplicity the derivation is made for a one dimensional system but all arguments can be extended to higher dimensions with isotropic transport coefficients the length of mass patch due to diffusion with a diffusivity d at time t can be defined by the confidence interval ψ σ or 2 l ψ 2 d t where ψ is an arbitrary constant defining how many σ of mass is in the patch of length l with known characteristic length l which is the distance between solid particles we can estimate the time for this condition 3 t l 2 2 ψ 2 d at the boundary between solute and solid we consider a constant equilibrium concentration c eq at time t the concentration in the field is distributed spatially as 4 c x t c eq 1 erf x 4 d t where erf is the error function mass leaving from this boundary is governed by the diffusive flux j defined as 5 j s d c x where s is surface area of solid solute boundary calculation of spatial derivative over c in eq 4 combined with 5 gives 6 j s d c eq e x 2 4 d t π d t the flux at x 0 which is the boundary between solute and solid from where the mass is diffused is then 7 j s d c eq 1 π d t the cumulative mass which is diffused from the boundary is equal to 8 m out 0 t s d c eq 1 π d t considering time from eq 3 we get the total diffused mass 9 m out s c eq 2 l ψ π s l c eq all constants are left out of the final form finally we can define the dimensionless form which defines the buffering capacity 10 bu m out m solid s l c eq m solid s l c eq v solid c solid for simplicity we assume that the average reference length is defined by l v total s and the final form for bu number reads 11 bu v total c eq v solid c solid this dimensionless number depends only on the inverse of volumetric solid fraction multiplied by the ratio between equilibrium and solid concentration in the next section we will test the hypothesis that the calculation time in terms of number of time steps can be reduced if the system buffering is large enough to assure that the diffusive process relax to a steady state with different porous media configurations with different bu number we demonstrate that the physical time and thus the number of time steps required to dissolve the solid can be scaled by the bu number for example if time t 1 is required to fully dissolve a solid phase in a system with bu 1 the time can be according to eq 11 reduced by reducing either v solid c solid or increasing c eq in a real chemical system we could change v solid or c eq to accelerate the dissolution since the intention of this numerical analysis is to keep the pore geometry v solid intact we have a possibility to change either c solid solid grain density or c eq in order to numerically accelerate dissolution the time t 2 required to dissolve the same volume of solid with other c solid or c eq i e with an other bu 2 would be 12 t 2 t 1 bu 1 bu 2 where bu 2 is bu of the altered system expanding this relation with relation 11 we get 13 t 2 t 1 c eq 1 c solid 2 c solid 1 c eq 2 this means that in order to reduce the final time t 2 at given original solid concentration c solid 1 and given equilibrium concentration c eq 1 we can either decrease solid concentration c solid 2 or increase the equilibrium concentration c eq 2 the latter is typically done in accelerated experiments where the solubility is increased in order to accelerate the dissolution phung et al 2016 3 methods 3 1 solution procedure the lattice boltzmann method is used to solve the three dimensional diffusion reaction equation the description of the lattice boltzmann solution procedure for solute transport exceeds the scope of this paper but can be found in numerous existing literature chen et al 2013 kang et al 2006 suga 2006 sukop and thorne 2010 in this work we use single relaxation time lattice boltzmann d3q7 lattice formulation defined as 14 f i r e i δ t t δ t f i r t δ t τ f i eq r t f i r t δ t r i r t where r is position vector f i represents particle distribution function along lattice i th direction in velocity space e i is the velocity vector in i th direction r i r t is the source term δt is the lattice boltzmann time step defined as 1 τ is relaxation time and f i eq is the particle equilibrium distribution function given by eq 15 15 f i eq r t w i c 1 e i u e s 2 where w i are the weights for particle distribution function along i th direction defined as w 0 1 4 w 1 6 1 8 and e s 1 2 is pseudo sound speed lt 1 macroscopic concentrations are recovered from the summation of particle distributions f i 16 c i f i for all calculations the relaxation time τ 1 is used which assures that the neumann criteria for reactions is respected boundary conditions see section 3 2 are defined as nodal bounce back for zero flux and as constant concentration on one boundary defined as 17 f j c boundary i j f i and j is the unknown distribution out of the boundary for the calculations yantra modelling framework is used patel et al 2014 the macroscopic equation which is considered in this work is defined as 18 c x t t d c x t r x t where c is the solute concentration mol m3 d is diffusion coefficient m2 s and r is a source sink term mol m3 s defining the dissolution process each voxel in the domain can be represented by one of the two components void space or solid for some systems where void spaces are too small to be explicitly resolved by the numerical discretization a special type of voxel is defined as a porous medium see e g the calcium silicate phases in cement in section 4 3 the reactive source term is defined as 19 r x t c eq x t c x t δ t x solid this means that the solute concentration in a solid voxel i e voxel adjacent to a solute is renewed each time step as long as sufficient amounts of solid are present at each time step the solid mass is reduced for the amount which is diffused away from the solid and results in a concentration c hence c eq c mass is deducted from the solid voxel as 20 c solid x t δ t c solid x t c eq x t c x t x solid this is repeated until the amount of solid is less than c eq the solid is turns into liquid and r 0 mol m3 s a more detailed description of the solution procedure can be found in patel et al 2014 3 2 numerical analysis the numerical domain consists of a cube with 50 50 50 voxels the dimension of the cube is 5 345 10 4 m for all cases the sandstone image used later in the discussion section has the resolution 5 345 10 6 m and the field of view of the original image is 2 134 10 3 m dong and blunt 2009 but only a part was used for our simulations the volume is occupied by a solid and void spaces filled by an aqueous phase initial solute concentration is 1 mol m3 which is equal to the arbitrarily chosen equilibrium concentration c eq to obtain different bu numbers we modify c solid the domain is bounded by a neumann zero flux boundary conditions from all sides except for one boundary the right boundary on all figures where we keep the concentration equal to 0 mol m3 at this boundary instantaneous and cumulative boundary fluxes are calculated the results are discussed in terms of remaining solid m solid t at time t normalized by the solid at time zero m solid t 0 21 δ m m solid t m solid t 0 m solid t v c solid t dv and t 0 is initial time relative difference of remaining mass δ2 between the two systems with different bu numbers is given as the difference between δ m high and δ m low when log2 bu would change for factor 2 with this approach we define the convergence of results with bu number the reason to use this approach is that the reference solution on the basis of which one would be able to calculate relative error is not known for the regular irregular systems described further for real cementitious system in section 4 3 the relative error is calculated on the basis of real not accelerated system which is used as a reference the convergence factor δ2 is defined as 22 δ 2 δ m high δ m low log 2 b u low log 2 b u high 100 subscripts high and low represent the case with higher and lower solid equilibrium concentration ratio respectively the final time of the simulation for all presented cases except for the real cementitious systems is chosen until approximately half of the mass is leached out of the system see e g fig 2 this time relates to c solid c eq as 23 t end t ref c solid c eq and t ref 4 s is chosen on the basis of the time when the solid in 3 3 system see fig 3 is leached until the half of the domain 4 results and discussion 4 1 regular media in a first step the dissolution of a number of regular configurations are used to determine the volume fraction of solids needed to assure that the diffusive length is small enough to satisfy the steady state criteria used in the derivation of bu furthermore we analyze the error in the normalized remaining solid δ2 when bu increases by a factor 2 the regular systems consist of a repetitive sequence of voxels with solids block and voxels with a solution space selected block space distributions are defined to asses the validity of hypothesis they are denoted as n block n space further the modelled cases include equal block space distribution 1 1 3 3 and 6 6 systems with less solid blocks and more space 1 2 1 4 and 3 6 and systems with more solid with less space 6 3 resulting in specific v solid v total ratios table 1 fig 1 illustrates the spatial arrangement of some cases with these analyses we determine the sufficient solid volume fraction of which assures that diffusive length is small enough to satisfy the steady state criteria of bu number derivation for some configurations the ratio is the same e g for 2 1 and 6 3 the remaining total mass in the system proxy for the position of dissolution front at a final time eq 12 depends on the bu number fig 1 compares the difference between cases when bu doubles as defined in eq 22 δ2 decreases exponentially when bu decreases given the volume fraction of solid v solid v total is sufficient the behaviour becomes non monotonous at higher bu numbers thus if there is not enough buffer capacity i e high c eq to c solid ratio the solute concentration c does not reach steady state and the geometry evolution depends on the specific solid distribution this behaviour is seen for the case 1 4 with less than 1 solid volume below bu 3 we observe exponential decrease in δ2 δ2 drops below 1 for the values of bu 0 2 as observed for other cases with sufficient solid volume fraction at bu 1 the difference is below 5 hence the relation between error and bu is well defined as long as v solid v total is larger than approximately 10 the solid distribution at the final time for different bu numbers is shown in fig 2 the dissolution front progresses faster with higher bu numbers because the solute concentration profile is not in equilibrium and the mass fluxes from the solid are higher visual difference between bu 0 9 and bu 0 2 is small which indicates that even with bu around 1 the results are within the order of few percent difference if bu doubles according to these calculations presented in fig 2 the critical ratio when δ2 drops with lower bu is when the volume of solid occupies around 10 of the total volume this is demonstrated by cases 1 1 3 3 and 6 3 on contrary the cases 1 2 1 4 and 3 6 represent examples with a lower buffer capacity from the results shown in fig 1 a higher v solid v total ratio leads to faster reduction of δ2 with lower bu number which is clearly demonstrated with cases 3 1 with v solid v total 30 and 4 1 with v solid v total 40 this also means that the number of time iterations and hence the calculation time can be reduced more in system with a volumetrically larger amount of solid in the domain the limit where the difference δ2 drops below 1 with doubling of mass is approximately at bu 0 2 for cases with lower ratio 1 2 1 4 and 3 6 the equilibrium chemistry is not appropriate because the diffusive length is too large and therefore the assumption of steady state is not valid to evaluate if the distribution clustering of the solid phase plays an important role the results of three configurations with the same volume fraction v solid v total 0 11 and different solid distribution 3 3 6 6 and 12 12 are compared fig 4 shows perfect overlap between different cases which confirms our hypothesis as a rule of thumb two criteria should be met to have sufficient accurate solutions when reducing the number of required time steps by decreasing bu volume fraction of solid should be more than 10 bu should be low enough our analysis show that bu 0 2 results in an error below 1 4 2 irregular media the solid phase spatial distribution in natural systems often exhibits a given level of randomness resulting in irregular patterns three examples are chosen to confirm the validity of the above defined criteria and the hypothesis one example still represents a periodic pattern and is composed out of three layers containing one layer of 6 6 configuration two times 3 3 and again one layer of 6 6 the second case represents a tomographic image of sandstone and the third case the inverse of the same image being a case with a large amount of solid all these cases have a v solid v total solid more than 10 to respect the criteria developed in the previous section as seen in fig 5 δ2 at final time shows relative small differences at the same bu for the different cases and confirms the general trend of decreasing errors with lower bu with δ2 below 1 for bu 0 2 δ2 as a function of c solid c eq is examined in fig 6 for a range of v solid v total for v solid v total around 10 δ2 is below 1 for c solid c eq ratio around 40 1 for larger v solid v total δ2 is below 1 even at lower c solid c eq ratios namely with 20 1 for v solid v total 20 and 10 1 for v solid v total 40 for the inverse sandstone configuration the ratio is below 10 1 in other words in real systems where v solid v total is easily above 70 a ratio between solid concentration and equilibrium concentration equals 100 see section 4 3 the simulations could be accelerated by at least 10 times with practically the same solid configuration i e pore geometry after dissolution fig 7 4 3 application to cementitious systems a cementitious system is a typical example of a system where a significant numerical acceleration can be obtained v solid v total and c solid c eq are high consequently ca leaching is a slow process which requires a lot of time steps to simulate to illustrate the gain in numerical speed we take an example from seetharam et al 2018 which describes leaching of a mortar the model consists of random spherical particles i e cement clinkers in space between two hypothetical aggregate surfaces respecting the initial water to cement w c ratio of mortar as well as the particle size distribution of the cement type the particle size distribution represents a cem i 42 5 n cement and a blaine fineness of 430 cm2 g with w c 0 35 the domain size is 2 5 5 5mm3 the volume fraction of aggregates is v agg 0 2 volumetric fraction of portlandite ch is v ch 0 154 and of the calcium silicate hydrates c s h is v csh 0 476 the diffusion coefficient in cement paste is 2 22 10 12 m2 s the calculation time of the original system calculation takes more than one month on intel xeon cpu e5 2643 v3 3 4 ghz for such a cement system the concentration of ca in ch is about 200 times larger than the aqueous equilibrium concentration which is significantly more than the required ratio of 40 1 described above in cement paste portlandite occupies around 15 however given the volume occupied by inert material aggregates and c s h 1 1 c s h is inert with respect to ch because it reduces the active volume of ch dissolution however in the simulation also c s h dissolves the actual volume fraction of portlandite in the active domain i e portlandite and pores is even larger consequently bu ca ch is calculated on the domain which occupies 1 v agg v csh of the total volume to change bu number in the model we increase the aqueous concentration of ca when in equilibrium with ch ca in c s h and si in c s h solid concentrations of ca and si in ch and c s h remain the same in all cases equilibrium concentrations are increased by factor 10 15 20 and 50 times which give the bu numbers as reported in table 2 note that the same effect would be obtained by reducing ch and c s h which is preferred for geochemical systems based on a thermodynamic model because the ionic strength of the solution will not change in seetharam et al 2018 the dependencies between ch vs ca and c s h vs ca and si are tabulated and was more convenient to increase the equilibrium values v total v solid is calculated as 1 v agg v csh v ch for ca in portlandite 1 v agg v ch v csh for ca and si in c s h initial solid concentration of ca in portlandite is c ca ch 3 86 mol dm3 in c ca csh 3 93 mol dm3 and si in c s h c si csh 2 42 mol dm3 initial solute concentrations are c ca 1 92 10 2mol dm3 and c si 3 1 10 5 mol dm3 which are those in equilibrium with ch and c s h bu ca ch is the limiting phase for the acceleration table 2 considering that accurate results are obtained with bu 0 2 it is expected that this simulation can 20 times be accelerated the acceleration could be much higher for c s h because of its larger volume the mass ratio c solid c eq at 20 times acceleration is 10 1 indeed an error analysis expressed as δ c accelerated c original c original 100 shows that errors are lower for c s h table 3 fig 8 shows the average concentration in the domain at different times up to 100 days the results demonstrate that there is perfect match of solid concentrations between the cases with original concentrations and with concentrations for acceleration by a factor 20 the difference for portlandite are larger when portlandite dissolution is higher at higher accelerations because of the restriction of a steady state assumption moreover the simulation time can be decreased even for 50 times with an error of only 3 5 for portlandite mass however as expected the differences related to c s h dissolution are negligible the right graph in fig 8 shows solute profiles of ca and si the difference in concentrations are due to the increase in bu number all curves would coincide if the would be scaled by c eq fig 9 depicts the dissolution front of portlandite and ca concentration contours visual difference between cases is very small since the calculation time of the original simulation was around 30 days we could obtain the same results in a few hours this allows for calculation of larger systems or to perform better sensitivity analysis in the same time 5 conclusions in this work we showed an approach to reduce calculation time in systems governed by diffusion and equilibrium dissolution processes the derived bu number defines that one could increase c eq or decrease c solid such that after appropriate time scaling similar dissolution patterns are obtained bu is derived from the ratio between leached mass out of the solid matrix and mass of solid the final form relates the solid concentration and the equilibrium concentration and the relative solid volume the approach to reduce dissolution time resembles the experimental techniques phung et al 2016 where solubility is increased this increases in fact bu in a similar way as we showed in this work there is one significant benefit of the numerical approach compared to the experimental one in experiments the reaction rate might change because of higher ionic strength or other elements changing the geochemical system while in the numerical approach the same chemistry and activity correction approach can be used in other words the acceleration can represent natural conditions with high fidelity the increase of bu directly translates to the reduction of number of time iterations and hence the calculation time we have shown that a minimum relative solid volume is around 10 in order to have good correlation between the difference in remaining mass and bu number for the difference in remaining solid mass to be below 1 if the concentration in solid doubles bu number is around 0 2 in most presented cases this occurred at c solid c eq 40 1 in cases with volumetric solid fraction above 60 this ratio can drop to c solid c eq 10 1 as shown in the case of inverse sandstone configuration and for the real mortar system the relation between bu number and error is shown to be consistent between all shown cases we showed on the example of cementitious systems that the acceleration can go as high as 50 times with an error of remaining portlandite mass of only 3 5 acknowledgement the research leading to these results has received funding from the european unions european atomic energy communitys euratom horizon 2020 programme nfrp 2014 2015 under grant agreement 662147 cebama the authors would like to thank suresh seetharam for providing the example on the cementitious system and for valuable discussions 
1619,simulation of dissolution processes with a pore scale reactive transport model increases insight in coupled chemical physical transport processes however modelling of dissolution process often requires a large number of time steps especially when the buffering capacity of solid phases is high in this work we analyze the interplay between solid buffering on one hand and transport on the other based on this analysis we propose an approach to reduce the number of required time steps for simulating equilibrium dissolution processes the underlying idea is that the number of time step iterations can be reduced if the buffering is sufficient to bring the system to a steady state i e that the concentration field around solid is time invariant if this condition is satisfied then it is possible to reduce the physical and thus also computational time by adjusting the chemical system appropriately first we derived a dimensionless value called buffering number to determine under which conditions reduction in time can be made several examples illustrate that below a certain buffering number the physical time can be reduced without significant effect on result e g dissolution front as long as the solid volume fraction is sufficient this means that for a given solid liquid system the calculation time can be reduced either by the reduction of mass in solid or by the increase of equilibrium concentration solubility we also show that the calculation time for calcium leaching in cementitious systems can be reduced by 50 times with a negligible error keywords dissolution equilibrium chemistry acceleration pore scale modelling pacs 02 70 c 82 60 hc 1 introduction the process of dissolution occurs when a solute comes in contact with a solvent and dissolves to form a solution transport and dissolution in porous media is important in many hydrogeological problems involving contaminant release from nuclear disposal facilities contaminant transport in groundwater resources and geological storage of co2 the dissolution of a solid solute in a porous structure changes the geometry which among others leads to the evolution of physical properties reactive transport codes are well established tools to assess the chemical evolution of natural and engineered systems steefel et al 2015 more specifically these models are able to capture geochemical changes when two or more geochemical environments result in local thermodynamic disequilibruim due to geochemical gradients such conditions can be found in many natural and engineering applications bazilevskaya et al 2015 marty et al 2015 perko et al 2015 the main advantage of using numerical modelling is to obtain improved understanding of the system behaviour at the process level kang et al 2014 kang et al 2010 molins et al 2012 muljadi et al 2018 prasianakis et al 2017 especially in systems where processes are very slow and the assessment of long term behaviour is sought for one example is geochemical detrimental degradation processes in cement based systems which are typically very slow glasser et al 2008 jacques et al 2014 patel et al 2018 an emerging field of modelling is the study of the pore structure evolution as a consequence of geochemical processes at so called pore scale i e the scale where pore space and solid phases are explicitly resolved including heterogeneity in the solid phase composition e g huber et al 2014 molins et al 2017 seetha et al 2017 such studies aim at understanding the interaction between the microstructure of a porous medium the transport of species and geochemistry and investigate which pore scale features and processes affect properties and evolution on larger spatial scales so that more accurate and robust upscaled constitutive models can be developed for the continuum scale yoon et al 2015 coupled reactive transport modelling at pore scale gives again important insights in the processes of degradation but practical limitations arise from spatial resolution and numerical stability 1 in order to capture the critical features at the pore scale such as the presence of capillary pores or heterogeneity in mineral phases geometrically information with high resolution is needed often the purpose of a microstructural model is to upscale the information obtained at the pore to the continuum scale in practice this entails respecting representative elementary volume rev which in heterogeneous materials can be large thus detailed spatial information for a sufficient large simulation domain requires a fine and large computational discretization resulting in a large number of unknowns and huge memory and computational costs especially for three dimensional domains 2 in many chemical systems the solid phase content is large relative to the aqueous phase content such systems are characterized by a large buffering capacity consequently only a small fraction of the solid solute is consumed at each time step the time step is constrained by numerical stability criteria for example by neumann criteria for diffusion or courant friedrichs lewy cfl stability criterion for advection diffusion transport conditions these criteria are linked to the spatial discretization and smaller time steps are needed for finer spatial discretization this paper deals with low conductive porous media where diffusion process is a dominant transport process and advection is negligible these two aspects together bring numerical models potentially into a situation where the computational costs exceed practical limits in order to solve the problem one can use one or more of the following solutions 1 reduce the size of the computational domain which entails the risk of not respecting rev 2 increase spatial discretization by which we reduce the number of unknowns and increase the time step however the information on smaller scale e g smaller pores might be averaged out which could lead to inadequate description of the modelled system 3 increase computational capabilities by parallelizing the model usually the size of the numerical domain and its discretization are defined by the experimental settings and characterization methods consequently when more complex and larger models are imposed the most straight forward approach is to computationally optimize the solution either by parallelization of processes or by increasing of computational resources e g solve the problem on supercomputer gao et al 2015 liu and mostaghimi 2017 groen et al 2013 shown that lattice boltzmann method can be well scalable up to 32 000 cores with only 11 slowdown however even for a parallelized framework the number of time steps is fixed as it is defined by stability criteria enforced by the migration conditions either being diffusion or advection diffusion fixed by physics and spatial discretization fixed by the model this issue has also been recognised in blunt et al 2013 for flow simulations on pore scale another way of reducing computational time in a coupled reactive transport model is by making the computationally demanding geochemical calculations less demanding by e g look up tables huang et al 2018 first order estimations leal et al 2017 or surrogate modelling lucia et al 2017 mostly such approaches require adaption in the model code but they can give quite significant time profits especially by reducing the number of times that a geochemical calculation has to be performed in a summary for an effective acceleration we need to reduce the number of time steps in this work we explore the possibility to reduce the number of time steps without affecting the key properties and evolution of the system for equilibrium dissolution process and without changing the model code in the first part we define the hypothesis and we develop the approach to defend it for this purpose we derive a measure for evaluating the buffering capacity of solids in the system the hypothesis is tested in a second part on several cases of increasing complexity starting from a simple homogeneous material continuing with more complex heterogeneous material and finally tested on real cementitious system the analyses show that the evolution of pore structure resulting from the dissolution process remains the same for the accelerated system if the buffering conditions are satisfied 2 mass transport and chemical buffering in this study we consider a geochemical system of a solid phase in equilibrium with the aqueous phase when solutes are transported out of the domain at one boundary the solid phase with concentration c solid dissolves instantaneously to reach the aqueous equilibrium concentration c eq mass flux from solid to aqueous phase depends on the transport process in the domain if c solid is sufficiently high relative to the equilibrium concentration the solute concentration field approaches steady state before the spatial distribution of solid changes i e before the solid in a voxel is completely dissolved in other words the diffusive process relaxes to a steady state berezhkovskii et al 2010 before the geometry changes if the steady state is reached faster than the complete dissolution of the solid in a voxel occurs one could use this property for the reduction of the calculation time the purpose of this analysis is to determine to which extent the calculation time can be reduced based on the system parameters such as solid volume c solid c eq or mass distribution for this purpose we define a dimensionless value which we call a buffer number bu as the ratio between mass leached from the solid and mass in the solid 1 bu m out m solid where m solid is mass in solid and m out is mass migrated leached out of the solid in this derivation we limit ourselves to the diffusive transport process the reason is that diffusive processes are always present in porous media and also that the diffusive relaxation time to steady state is longer than the advective one in some porous media for example in cementitious systems diffusion is also a dominant transport mechanism for species when c eq is maintained sufficiently long at the boundary between solid and aqueous solution and the solid remains at the same position this concentration can be considered as a boundary condition for the purpose of derivation we define the reference distance between the boundaries two solids is l the time needed for the aqueous solution to be close to steady state can be determined from the amount of mass which is distributed within the length l the so called length patch or root mean square displacement einstein 1905 for a pure diffusion process the amount of mass that is distributed within the interval l at time t can be expressed in terms of standard deviation of mass in the domain σ 2 d t note that for simplicity the derivation is made for a one dimensional system but all arguments can be extended to higher dimensions with isotropic transport coefficients the length of mass patch due to diffusion with a diffusivity d at time t can be defined by the confidence interval ψ σ or 2 l ψ 2 d t where ψ is an arbitrary constant defining how many σ of mass is in the patch of length l with known characteristic length l which is the distance between solid particles we can estimate the time for this condition 3 t l 2 2 ψ 2 d at the boundary between solute and solid we consider a constant equilibrium concentration c eq at time t the concentration in the field is distributed spatially as 4 c x t c eq 1 erf x 4 d t where erf is the error function mass leaving from this boundary is governed by the diffusive flux j defined as 5 j s d c x where s is surface area of solid solute boundary calculation of spatial derivative over c in eq 4 combined with 5 gives 6 j s d c eq e x 2 4 d t π d t the flux at x 0 which is the boundary between solute and solid from where the mass is diffused is then 7 j s d c eq 1 π d t the cumulative mass which is diffused from the boundary is equal to 8 m out 0 t s d c eq 1 π d t considering time from eq 3 we get the total diffused mass 9 m out s c eq 2 l ψ π s l c eq all constants are left out of the final form finally we can define the dimensionless form which defines the buffering capacity 10 bu m out m solid s l c eq m solid s l c eq v solid c solid for simplicity we assume that the average reference length is defined by l v total s and the final form for bu number reads 11 bu v total c eq v solid c solid this dimensionless number depends only on the inverse of volumetric solid fraction multiplied by the ratio between equilibrium and solid concentration in the next section we will test the hypothesis that the calculation time in terms of number of time steps can be reduced if the system buffering is large enough to assure that the diffusive process relax to a steady state with different porous media configurations with different bu number we demonstrate that the physical time and thus the number of time steps required to dissolve the solid can be scaled by the bu number for example if time t 1 is required to fully dissolve a solid phase in a system with bu 1 the time can be according to eq 11 reduced by reducing either v solid c solid or increasing c eq in a real chemical system we could change v solid or c eq to accelerate the dissolution since the intention of this numerical analysis is to keep the pore geometry v solid intact we have a possibility to change either c solid solid grain density or c eq in order to numerically accelerate dissolution the time t 2 required to dissolve the same volume of solid with other c solid or c eq i e with an other bu 2 would be 12 t 2 t 1 bu 1 bu 2 where bu 2 is bu of the altered system expanding this relation with relation 11 we get 13 t 2 t 1 c eq 1 c solid 2 c solid 1 c eq 2 this means that in order to reduce the final time t 2 at given original solid concentration c solid 1 and given equilibrium concentration c eq 1 we can either decrease solid concentration c solid 2 or increase the equilibrium concentration c eq 2 the latter is typically done in accelerated experiments where the solubility is increased in order to accelerate the dissolution phung et al 2016 3 methods 3 1 solution procedure the lattice boltzmann method is used to solve the three dimensional diffusion reaction equation the description of the lattice boltzmann solution procedure for solute transport exceeds the scope of this paper but can be found in numerous existing literature chen et al 2013 kang et al 2006 suga 2006 sukop and thorne 2010 in this work we use single relaxation time lattice boltzmann d3q7 lattice formulation defined as 14 f i r e i δ t t δ t f i r t δ t τ f i eq r t f i r t δ t r i r t where r is position vector f i represents particle distribution function along lattice i th direction in velocity space e i is the velocity vector in i th direction r i r t is the source term δt is the lattice boltzmann time step defined as 1 τ is relaxation time and f i eq is the particle equilibrium distribution function given by eq 15 15 f i eq r t w i c 1 e i u e s 2 where w i are the weights for particle distribution function along i th direction defined as w 0 1 4 w 1 6 1 8 and e s 1 2 is pseudo sound speed lt 1 macroscopic concentrations are recovered from the summation of particle distributions f i 16 c i f i for all calculations the relaxation time τ 1 is used which assures that the neumann criteria for reactions is respected boundary conditions see section 3 2 are defined as nodal bounce back for zero flux and as constant concentration on one boundary defined as 17 f j c boundary i j f i and j is the unknown distribution out of the boundary for the calculations yantra modelling framework is used patel et al 2014 the macroscopic equation which is considered in this work is defined as 18 c x t t d c x t r x t where c is the solute concentration mol m3 d is diffusion coefficient m2 s and r is a source sink term mol m3 s defining the dissolution process each voxel in the domain can be represented by one of the two components void space or solid for some systems where void spaces are too small to be explicitly resolved by the numerical discretization a special type of voxel is defined as a porous medium see e g the calcium silicate phases in cement in section 4 3 the reactive source term is defined as 19 r x t c eq x t c x t δ t x solid this means that the solute concentration in a solid voxel i e voxel adjacent to a solute is renewed each time step as long as sufficient amounts of solid are present at each time step the solid mass is reduced for the amount which is diffused away from the solid and results in a concentration c hence c eq c mass is deducted from the solid voxel as 20 c solid x t δ t c solid x t c eq x t c x t x solid this is repeated until the amount of solid is less than c eq the solid is turns into liquid and r 0 mol m3 s a more detailed description of the solution procedure can be found in patel et al 2014 3 2 numerical analysis the numerical domain consists of a cube with 50 50 50 voxels the dimension of the cube is 5 345 10 4 m for all cases the sandstone image used later in the discussion section has the resolution 5 345 10 6 m and the field of view of the original image is 2 134 10 3 m dong and blunt 2009 but only a part was used for our simulations the volume is occupied by a solid and void spaces filled by an aqueous phase initial solute concentration is 1 mol m3 which is equal to the arbitrarily chosen equilibrium concentration c eq to obtain different bu numbers we modify c solid the domain is bounded by a neumann zero flux boundary conditions from all sides except for one boundary the right boundary on all figures where we keep the concentration equal to 0 mol m3 at this boundary instantaneous and cumulative boundary fluxes are calculated the results are discussed in terms of remaining solid m solid t at time t normalized by the solid at time zero m solid t 0 21 δ m m solid t m solid t 0 m solid t v c solid t dv and t 0 is initial time relative difference of remaining mass δ2 between the two systems with different bu numbers is given as the difference between δ m high and δ m low when log2 bu would change for factor 2 with this approach we define the convergence of results with bu number the reason to use this approach is that the reference solution on the basis of which one would be able to calculate relative error is not known for the regular irregular systems described further for real cementitious system in section 4 3 the relative error is calculated on the basis of real not accelerated system which is used as a reference the convergence factor δ2 is defined as 22 δ 2 δ m high δ m low log 2 b u low log 2 b u high 100 subscripts high and low represent the case with higher and lower solid equilibrium concentration ratio respectively the final time of the simulation for all presented cases except for the real cementitious systems is chosen until approximately half of the mass is leached out of the system see e g fig 2 this time relates to c solid c eq as 23 t end t ref c solid c eq and t ref 4 s is chosen on the basis of the time when the solid in 3 3 system see fig 3 is leached until the half of the domain 4 results and discussion 4 1 regular media in a first step the dissolution of a number of regular configurations are used to determine the volume fraction of solids needed to assure that the diffusive length is small enough to satisfy the steady state criteria used in the derivation of bu furthermore we analyze the error in the normalized remaining solid δ2 when bu increases by a factor 2 the regular systems consist of a repetitive sequence of voxels with solids block and voxels with a solution space selected block space distributions are defined to asses the validity of hypothesis they are denoted as n block n space further the modelled cases include equal block space distribution 1 1 3 3 and 6 6 systems with less solid blocks and more space 1 2 1 4 and 3 6 and systems with more solid with less space 6 3 resulting in specific v solid v total ratios table 1 fig 1 illustrates the spatial arrangement of some cases with these analyses we determine the sufficient solid volume fraction of which assures that diffusive length is small enough to satisfy the steady state criteria of bu number derivation for some configurations the ratio is the same e g for 2 1 and 6 3 the remaining total mass in the system proxy for the position of dissolution front at a final time eq 12 depends on the bu number fig 1 compares the difference between cases when bu doubles as defined in eq 22 δ2 decreases exponentially when bu decreases given the volume fraction of solid v solid v total is sufficient the behaviour becomes non monotonous at higher bu numbers thus if there is not enough buffer capacity i e high c eq to c solid ratio the solute concentration c does not reach steady state and the geometry evolution depends on the specific solid distribution this behaviour is seen for the case 1 4 with less than 1 solid volume below bu 3 we observe exponential decrease in δ2 δ2 drops below 1 for the values of bu 0 2 as observed for other cases with sufficient solid volume fraction at bu 1 the difference is below 5 hence the relation between error and bu is well defined as long as v solid v total is larger than approximately 10 the solid distribution at the final time for different bu numbers is shown in fig 2 the dissolution front progresses faster with higher bu numbers because the solute concentration profile is not in equilibrium and the mass fluxes from the solid are higher visual difference between bu 0 9 and bu 0 2 is small which indicates that even with bu around 1 the results are within the order of few percent difference if bu doubles according to these calculations presented in fig 2 the critical ratio when δ2 drops with lower bu is when the volume of solid occupies around 10 of the total volume this is demonstrated by cases 1 1 3 3 and 6 3 on contrary the cases 1 2 1 4 and 3 6 represent examples with a lower buffer capacity from the results shown in fig 1 a higher v solid v total ratio leads to faster reduction of δ2 with lower bu number which is clearly demonstrated with cases 3 1 with v solid v total 30 and 4 1 with v solid v total 40 this also means that the number of time iterations and hence the calculation time can be reduced more in system with a volumetrically larger amount of solid in the domain the limit where the difference δ2 drops below 1 with doubling of mass is approximately at bu 0 2 for cases with lower ratio 1 2 1 4 and 3 6 the equilibrium chemistry is not appropriate because the diffusive length is too large and therefore the assumption of steady state is not valid to evaluate if the distribution clustering of the solid phase plays an important role the results of three configurations with the same volume fraction v solid v total 0 11 and different solid distribution 3 3 6 6 and 12 12 are compared fig 4 shows perfect overlap between different cases which confirms our hypothesis as a rule of thumb two criteria should be met to have sufficient accurate solutions when reducing the number of required time steps by decreasing bu volume fraction of solid should be more than 10 bu should be low enough our analysis show that bu 0 2 results in an error below 1 4 2 irregular media the solid phase spatial distribution in natural systems often exhibits a given level of randomness resulting in irregular patterns three examples are chosen to confirm the validity of the above defined criteria and the hypothesis one example still represents a periodic pattern and is composed out of three layers containing one layer of 6 6 configuration two times 3 3 and again one layer of 6 6 the second case represents a tomographic image of sandstone and the third case the inverse of the same image being a case with a large amount of solid all these cases have a v solid v total solid more than 10 to respect the criteria developed in the previous section as seen in fig 5 δ2 at final time shows relative small differences at the same bu for the different cases and confirms the general trend of decreasing errors with lower bu with δ2 below 1 for bu 0 2 δ2 as a function of c solid c eq is examined in fig 6 for a range of v solid v total for v solid v total around 10 δ2 is below 1 for c solid c eq ratio around 40 1 for larger v solid v total δ2 is below 1 even at lower c solid c eq ratios namely with 20 1 for v solid v total 20 and 10 1 for v solid v total 40 for the inverse sandstone configuration the ratio is below 10 1 in other words in real systems where v solid v total is easily above 70 a ratio between solid concentration and equilibrium concentration equals 100 see section 4 3 the simulations could be accelerated by at least 10 times with practically the same solid configuration i e pore geometry after dissolution fig 7 4 3 application to cementitious systems a cementitious system is a typical example of a system where a significant numerical acceleration can be obtained v solid v total and c solid c eq are high consequently ca leaching is a slow process which requires a lot of time steps to simulate to illustrate the gain in numerical speed we take an example from seetharam et al 2018 which describes leaching of a mortar the model consists of random spherical particles i e cement clinkers in space between two hypothetical aggregate surfaces respecting the initial water to cement w c ratio of mortar as well as the particle size distribution of the cement type the particle size distribution represents a cem i 42 5 n cement and a blaine fineness of 430 cm2 g with w c 0 35 the domain size is 2 5 5 5mm3 the volume fraction of aggregates is v agg 0 2 volumetric fraction of portlandite ch is v ch 0 154 and of the calcium silicate hydrates c s h is v csh 0 476 the diffusion coefficient in cement paste is 2 22 10 12 m2 s the calculation time of the original system calculation takes more than one month on intel xeon cpu e5 2643 v3 3 4 ghz for such a cement system the concentration of ca in ch is about 200 times larger than the aqueous equilibrium concentration which is significantly more than the required ratio of 40 1 described above in cement paste portlandite occupies around 15 however given the volume occupied by inert material aggregates and c s h 1 1 c s h is inert with respect to ch because it reduces the active volume of ch dissolution however in the simulation also c s h dissolves the actual volume fraction of portlandite in the active domain i e portlandite and pores is even larger consequently bu ca ch is calculated on the domain which occupies 1 v agg v csh of the total volume to change bu number in the model we increase the aqueous concentration of ca when in equilibrium with ch ca in c s h and si in c s h solid concentrations of ca and si in ch and c s h remain the same in all cases equilibrium concentrations are increased by factor 10 15 20 and 50 times which give the bu numbers as reported in table 2 note that the same effect would be obtained by reducing ch and c s h which is preferred for geochemical systems based on a thermodynamic model because the ionic strength of the solution will not change in seetharam et al 2018 the dependencies between ch vs ca and c s h vs ca and si are tabulated and was more convenient to increase the equilibrium values v total v solid is calculated as 1 v agg v csh v ch for ca in portlandite 1 v agg v ch v csh for ca and si in c s h initial solid concentration of ca in portlandite is c ca ch 3 86 mol dm3 in c ca csh 3 93 mol dm3 and si in c s h c si csh 2 42 mol dm3 initial solute concentrations are c ca 1 92 10 2mol dm3 and c si 3 1 10 5 mol dm3 which are those in equilibrium with ch and c s h bu ca ch is the limiting phase for the acceleration table 2 considering that accurate results are obtained with bu 0 2 it is expected that this simulation can 20 times be accelerated the acceleration could be much higher for c s h because of its larger volume the mass ratio c solid c eq at 20 times acceleration is 10 1 indeed an error analysis expressed as δ c accelerated c original c original 100 shows that errors are lower for c s h table 3 fig 8 shows the average concentration in the domain at different times up to 100 days the results demonstrate that there is perfect match of solid concentrations between the cases with original concentrations and with concentrations for acceleration by a factor 20 the difference for portlandite are larger when portlandite dissolution is higher at higher accelerations because of the restriction of a steady state assumption moreover the simulation time can be decreased even for 50 times with an error of only 3 5 for portlandite mass however as expected the differences related to c s h dissolution are negligible the right graph in fig 8 shows solute profiles of ca and si the difference in concentrations are due to the increase in bu number all curves would coincide if the would be scaled by c eq fig 9 depicts the dissolution front of portlandite and ca concentration contours visual difference between cases is very small since the calculation time of the original simulation was around 30 days we could obtain the same results in a few hours this allows for calculation of larger systems or to perform better sensitivity analysis in the same time 5 conclusions in this work we showed an approach to reduce calculation time in systems governed by diffusion and equilibrium dissolution processes the derived bu number defines that one could increase c eq or decrease c solid such that after appropriate time scaling similar dissolution patterns are obtained bu is derived from the ratio between leached mass out of the solid matrix and mass of solid the final form relates the solid concentration and the equilibrium concentration and the relative solid volume the approach to reduce dissolution time resembles the experimental techniques phung et al 2016 where solubility is increased this increases in fact bu in a similar way as we showed in this work there is one significant benefit of the numerical approach compared to the experimental one in experiments the reaction rate might change because of higher ionic strength or other elements changing the geochemical system while in the numerical approach the same chemistry and activity correction approach can be used in other words the acceleration can represent natural conditions with high fidelity the increase of bu directly translates to the reduction of number of time iterations and hence the calculation time we have shown that a minimum relative solid volume is around 10 in order to have good correlation between the difference in remaining mass and bu number for the difference in remaining solid mass to be below 1 if the concentration in solid doubles bu number is around 0 2 in most presented cases this occurred at c solid c eq 40 1 in cases with volumetric solid fraction above 60 this ratio can drop to c solid c eq 10 1 as shown in the case of inverse sandstone configuration and for the real mortar system the relation between bu number and error is shown to be consistent between all shown cases we showed on the example of cementitious systems that the acceleration can go as high as 50 times with an error of remaining portlandite mass of only 3 5 acknowledgement the research leading to these results has received funding from the european unions european atomic energy communitys euratom horizon 2020 programme nfrp 2014 2015 under grant agreement 662147 cebama the authors would like to thank suresh seetharam for providing the example on the cementitious system and for valuable discussions 
