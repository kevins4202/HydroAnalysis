index,text
23850,a high resolution third generation wave model based on unstructured grids wavewatch iii was used to investigate the wave climate of bass strait and south east australia over the period 1981 to 2020 the model results are extensively validated against a network of coastal buoys and demonstrate that the model can capture the overall wave characteristics in this region analyses of model outputs across the 40 year period show that significant wave height has increased by approximately 5 and a slight counterclockwise rotation of peak wave direction has occurred with likely implications for coastal processes seasonal variations show higher significant wave height in winter compared to summer which is driven by dominant southern ocean swell the peak wave direction in the eastern region shifts from south westerly in winter to south easterly in summer in autumn and winter there is a statistically significant correlation between wave conditions and the southern annular mode during these seasons a southward movement of southern ocean low pressure systems is associated with increased significant wave height an increase in the peak wave period and a counterclockwise rotation of the peak wave direction keywords wave climate wave hindcast unstructured grids wavewatch iii bass strait south east australia 1 introduction understanding regional ocean wave climate is critical for a range of reasons beach morphology and shoreline erosion are highly influenced by ocean waves kirezci et al 2020 leach et al 2021 mcsweeney and shulmeisterb 2018 and nearshore breaking waves play an important role in the stability and erosion accretion of beaches wave climate also influences the distribution and productivity of coastal and marine communities with wave energy influencing the morphology community structure and spatial organization of taxa in the marine coastal zone through a number of direct and indirect processes rattray et al 2015 young et al 2020b ocean waves also represent a major design input to the construction and operation of coastal facilities akpinar et al 2016 jenkins et al 2012 lv et al 2014 the increase in the offshore renewable energy industry has opened up the development of nearshore regions where an understanding of wave climate becomes an important design consideration ching piao et al 2012 cornett 2008 flocard et al 2016 morim et al 2014 2016 ribal et al 2020 ocean waves also define the aerodynamic roughness of the air water interface which impacts the flux of energy and gases across the interface and defines the shape of the atmospheric boundary layer jenkins et al 2012 numerous studies have investigated the wave climate at both global and regional scales using satellite observations lin et al 2019 liu et al 2016 young 1999 young et al 2020a young and ribal 2019 reanalysis datasets harley et al 2010 hemer et al 2010 and or ocean wave model hindcasts liang et al 2019 mori et al 2017 shimura and mori 2019 young et al 2020a the wave models used have included wavewatch iii ww3 ww3dg 2019 swan booij et al 1999 swan team 2019 and wam wamdi wamdi group 1998 relationships between observed or modelled wave parameters and climate indices have also been studied for example el niño southern oscillation harley et al 2010 hemer et al 2010 mcsweeney 2020 tsai et al 2012 southern annular mode cuttler et al 2020 harley et al 2010 hemer et al 2010 mcsweeney 2020 arctic oscillation liu et al 2016 and subtropical high pressure regime and intensity cuttler et al 2020 based on a 31 year long satellite dataset from 1985 to 2018 young and ribal 2019 found extreme conditions of global oceanic wind speed and significant wave height had increased over the study period with the largest impact in the southern ocean while the changes in the corresponding mean values were relatively small liu et al 2016 reported the arctic oscillation and arctic dipole anomaly have clear impacts on the wind and wave climate of the arctic ocean based upon 20 years of satellite observations by nesting a regional high resolution wavewatch iii ww3 model within a global model shimura and mori 2019 distinguished different wave spectra types around japan and attributed their variations to atmospheric conditions through empiric orthogonal function analysis the victorian coast in south east australia fig 1 is one of the most densely populated regions in australia morim et al 2016 understanding wave climate in this region is crucial for coastal applications the wave climate of this region is heavily influenced by southern ocean swell mcsweeney 2020 global scale observations young and ribal 2019 young et al 2011 and model hindcasts meucci et al 2020a morim et al 2019 have indicated that the wave climate in the southern ocean is changing faster than any other region on earth hence an understanding of the changes which have occurred in this nearshore region has both local and global significance over the past few decades satellite altimeters have provided global scale measurements of significant wave height ribal and young 2019 but such applications are limited to the deep oceans due to the finite footprint size of such satellite systems of order 10 km and the large satellite cross track separation of order 200 km liu et al 2018 ribal and young 2019 in situ buoy observations provide valuable point observations but they are typically of relatively short duration and spatially too sparse to quantify the wave climate across long and complex coastal areas mcsweeney 2020 third generation wave models have shown their ability to model ocean waves on global and regional scales abdolali et al 2020 ching piao et al 2012 cuttler et al 2020 harley et al 2010 hemer et al 2010 liang et al 2019 shimura and mori 2019 however there are still a limited number of studies of long term wave climate in complex coastal regions exposed to the southern ocean such as victoria mcsweeney 2020 studied spatio temporal variations of wave parameters at 10 offshore locations along the victorian coast offshore distances 33 41 km by extracting directional wave hindcast data from noaa s global ww3 model although valuable such large scale regionally unvalidated model studies may raise downscaling issues when applied to coastal regions the present paper aims to provide a comprehensive analysis of the wave climate of bass strait and south east australia over the 40 year period 1981 2020 the analysis utilizes a high resolution regional ocean wave model the ww3 model based on unstructured grids for bass strait and south east australia nested within a global ww3 model the model and the validation buoy data sources are described in section 2 section 3 describes the validation results against the extensive network of coastal buoys the wave climate of the region is discussed in section 4 including mean conditions and seasonal variations long term trends extreme conditions and the impact of multi decadal climate variability section 5 draws conclusions from the study 2 data and methods 2 1 research domain the model domain selected for the study is shown in fig 1 covering the area 137 155 e 35 45 s three australian coastal states span this domain victoria tasmania and southern new south wales victoria and tasmania are separated by the relatively shallow bass strait there are over 50 islands between victoria and tasmania including king island flinders island and cape barren island which greatly increase the bathymetric complexity of this region 2 2 wave model the ww3 model ww3dg 2019 is a third generation wave model developed at national centers for environmental prediction ncep national oceanographic and atmospheric administration noaa it has evolved into a wave modelling framework from the earlier wavewatch i tolman 1991 and wavewatch ii tolman 1992 versions the ww3 model solves the random phase spectral action balance equation it assumes that the wave field and properties of the medium current and water depth vary in space on a scale that is much larger than the scale of a single wave ww3dg 2019 in this study the ww3 version 6 07 1 model was initialized from quiescent conditions with the linear input source term proposed by cavaleri and rizzoli 1981 and a low frequency filter for wave energy as introduced by tolman 1992 wind input white cap dissipation swell dissipation and negative wind input were computed based on the observation consistent st6 source term package liu et al 2019 rogers et al 2012 zieger et al 2015 the wind input and white cap dissipation source terms are based on measurements at lake george australia the swell dissipation is based on laboratory experiments and field observations the negative wind input source term is based on laboratory tests ww3dg 2019 the nonlinear quadruplet wave wave interactions were modelled using the discrete interaction approximation dia method which was proposed by hasselmann et al 1985 the empirical jonswap bottom friction parameterization hasselmann et al 1973 was adopted for the study more sophisticated representations are available such as proposed by collins 1972 such forms account for differing bed material and the threshold behaviour of ripple generation on sandy beds nielsen 1983 as shown by young and gorman 1995 for a site west of our study region in the great australian bight such representations require detailed knowledge of bed material and how this may change over time this information was not available over the study region for the 40 year duration of the study in such circumstances young and gorman 1995 showed that the jonswap formulation for bottom friction actually performed better than apparently more sophisticated representations the energy dissipation model used to simulate depth induced wave breaking was proposed by battjes and janssen 1978 nonlinear triad wave wave interactions were not included due to their low accuracy at present ww3dg 2019 the ww3 model was run using the default third order propagation scheme which is the computationally quickest scheme combined with the ultimate total variance diminishing limiter ww3dg 2019 all the parameters used in the modelling were set to default values including the air sea coupling factor cdfac 1 unless otherwise stated liu et al 2021 the model setup adopted did not include impacts of currents on the waves ww3 does include the possibility of current impacts on refraction and potential impacts on atmospheric input due to current induced wave phase speed variability coastal areas such as bass strait can experience significant currents ridgway 2007 young et al 2020b in addition rapizo et al 2018 have shown that the inclusion of currents in global models can enhance performance particularly in the southern ocean as high resolution current data were not available over our computational domain for the 40 year hindcast period it was not possible to investigate the significance of wave current impacts examination of the global results of rapizo et al 2018 indicates that neglecting currents in this region will result in differences of only 2 in significant wave height currents along with limited resolution of the forcing wind fields represent potential error sources within the model setup water depth is an important factor in defining wave conditions in coastal regions and high resolution bathymetric data are needed for high quality coastal modelling hargreaves et al 2002 nearshore bathymetric data were obtained from the victorian coastal digital elevation model in which spatial resolution is provided down to 10 m these data can be downloaded from the australian ocean data network aodn https portal aodn org au for offshore regions the bathymetric data were provided by the australian bureau of meteorology bom http www bom gov au these data sources were combined to form a single bathymetry grid for the model region both structured and unstructured grids can be used in the ww3 model generally structured grids are rectilinear or curvilinear with 4 grid cells meeting at every internal grid point while unstructured grids can be triangular with grid cells meeting at each internal grid point due to the significant variations of wave spatial characteristics from offshore to nearshore the variation in water depth across the model domain and the need to adequately define coastlines unstructured grids offer many advantages for coastal modelling roberts et al 2019 in this study a triangular unstructured grid was designed to provide optimal resolution near the coast and adequately define the complex water depth in the coastal regions e g islands and irregular shorelines the oceanmesh2d grid generator was employed to generate the grid which determined the mesh size based on distance feature size wavelength topographic length scale and channel thalwegs polylines to control mesh size automatically roberts et al 2019 fig 2 shows the triangular unstructured grid that was generated based upon the bathymetric characteristics in fig 1 the grid consists of 184 195 elements and 97 276 nodes approximately 51 of the grid mesh is smaller than 1 km while 77 of the grid mesh is smaller than 2 km the unstructured grid has an offshore resolution ranging from 500 m to 10 000 m while the nearshore resolution is typically of order 500 m in this way the unstructured grid has high resolution in the coastal region while maintaining a coarse resolution in the deeper ocean that greatly improves the computational efficiency of the model the open boundary blue line in the insert of fig 1 conditions cover 170 points directional spectra were provided at each point from the global hindcast of liu et al 2021 the liu et al 2021 hindcast covers the period from 1981 to 2020 this hindcast uses the ww3 model with spectral output on the boundaries available at a time resolution of 1 h and spatial resolution of 0 25 this global hindcast used the st6 physics dia nonlinear term and the default jonswap bottom friction consistent with the present regional model liu et al 2021 era5 hourly wind data hersbach et al 2020 provided by the european centre for medium range weather forecasts ecmwf https www ecmwf int were used to force the regional ww3 model note that the global wave model that provided the boundary conditions used the same wind fields the era5 wind data cover the period from 1950 to present the original era5 model uses a 31 km cartesian grid with the data then being interpolated onto a spatial resolution of 0 25 and can be downloaded from the climate data store cds https cds climate copernicus eu the 0 25 resolution for the winds is relatively coarse for coastal domains and local impacts close to shore may not be adequately resolved by such winds higher resolution winds do exist but only in more recent years as model resolution has increased with enhanced computation resources at present the 0 25 era5 data represents the best available long term wind dataset ideally higher resolution winds would have been used but such wind data were not available over the computational domain and the 40 year hindcast period clearly however the wind field resolution is a limitation which may impact model performance following liu et al 2021 which provided the boundary conditions the regional model spectra were discretized with 36 direction bins with direction increment of 10 and 35 logarithmically distributed frequency bins from 0 037 hz to 0 953 hz examination of data from the most exposed buoy site of cape bridgewater see fig 1 showed that over the two year period 2020 2021 the lowest value of peak frequency was 0 04 hz recorded during a storm with h s 9 7 m this indicates that the lower frequency limit of the spectrum will generally be adequate with the exception of some very extreme cases future global wave modelling may need to extend to lower values of frequency to address the extremely long waves generated in the southern ocean the spin up time of the model was 1 month the model was run for the 40 year period from 1981 to 2020 with a time step of 20 min the integral wave parameters output across the computational grid including significant wave height h s peak wave frequency peak wave direction d p and partitioned wave quantities wind sea primary swell height secondary swell height the reciprocal of peak wave frequency is peak wave period t p full spectral output was provided at selected nearshore locations as shown in fig 1 purple locations 2 3 buoy and southern annular mode data buoy data from a range of nearshore sites were available for validation of the ww3 model results detailed information including the locations duration and available parameters are shown in table 1 the locations of the buoys are also shown in fig 1 short term approximately 1 year or 6 months records at a range of sites were provided from the vicwaves website https vicwaves com au and long term records were obtained from the port of melbourne gippsland ports https www gippslandports vic gov au and aodn in addition to the bulk wave parameters listed in table 1 approximately 1 year of directional spectral data were available at each of cape bridgewater wilson s promontory and lakes entrance 1 the buoy spectra cover frequencies up to 0 64 hz with a frequency increment of 0 005 hz and directional resolution of 3 the southern annular mode sam has been shown to have an impact on the southern ocean wave climate hemer et al 2010 marshall et al 2018 the sam is the principal mode of the atmospheric variability in the middle and high latitude regions of the southern hemisphere which influences the broadscale climate in this hemisphere marshall 2003 variations in the sam potentially impact ocean waves ocean circulation sea surface temperature and other aspects of southern hemisphere climate cuttler et al 2020 hemer et al 2010 marshall et al 2018 marshall 2003 mcsweeney 2020 the sam can be quantified by the southern annular mode index sami which is based on the zonal pressure difference between 40 s and 65 s marshall 2003 a positive negative sami phase is generally associated with a southward northward shift of southern ocean extra tropical storm belt cuttler et al 2020 mcsweeney 2020 the monthly sami can be downloaded from https legacy bas ac uk met gjma sam html which were calculated based on sea level pressure from 6 stations at 65 s and 6 stations at 40 s marshall 2003 2 4 model skill metrics there are different metrics commonly used to describe model performance against buoy data akpinar and bingölbali 2016 chawla et al 2013 lin et al 2019 in this study the following four metrics were used to evaluate the ww3 model performance akpinar and bingölbali 2016 the pearson correlation coefficient cc root mean square error rmse scatter index si and bias value bias 1 cc i 1 n o i o i p i p i i 1 n o i o i 2 i 1 n p i p i 2 where n is number of data points o p is the observation model data and o p is the mean value of the observation model data 2 rmse 1 n i 1 n p i o i 2 3 si rmse o 4 bias p o to display multiple skill metrics together i e taylor diagram taylor 2001 the normalized standard deviation nstd and normalized centred root mean square error crmse were also used chawla et al 2013 taylor 2001 which are defined by 5 nstd 1 n i 1 n p i p 2 1 n i 1 n o i o 2 6 crmse 1 n i 1 n p i p o i o 2 1 n i 1 n o i o 2 2 5 extreme wave analysis there are many extreme value analysis techniques which can be applied to wave data takbash et al 2019 vanem 2015 in all cases the aim is to fit an analytical extreme value probability distribution to the data and extrapolate to the desired probability level coles et al 2001 a common approach is to consider annual maxima where it can be shown that the data should theoretically follow a generalized extreme value gev distribution coles et al 2001 as such an approach excludes multiple peaks in a given year a common alternative is to consider peaks above a given threshold the peaks over threshold approach or pot in this case the probability distribution will follow a generalized pareto distribution gpd or its simplified form the exponential distribution coles et al 2001 takbash et al 2019 have analysed different methods from long duration satellite observations and found the peaks over threshold approach pot provides consist results when compared to long duration buoy records as the pot approach maximizes use of the available data it was adopted here it should be noted however that the details of the selected extreme value approach will impact the results takbash et al 2019 vanem 2015 following coles et al 2001 takbash et al 2019 takbash and young 2019 and young et al 2020a the pot approach was applied to the 40 years hindcast data as noted above pot data theoretically follows the gpd distribution the cumulative distribution function form of which is given by takbash et al 2019 7 f x 1 1 k x a b 1 k where f x is the cumulative distribution function x is significant wave height k and b are shape and scale parameters respectively the parameter a is the user defined threshold value which should be high enough to exclude bias effects but not so high that there are insufficient data to obtain a stable fit of the probability distribution function takbash et al 2019 thresholds selected at the 90th or 95th percentile values are commonly used meucci et al 2020b takbash et al 2019 vinoth and young 2011 in this study the 95th percentile significant wave height was used as the threshold value after sensitive tests using a range of values when applying the pot approach the expected probability level p for a n r p year return period is given by takbash et al 2019 8 p x x n rp 1 n y n rp n pot where n pot is the number of data points in the pot analysis n y is the number of years covered by the time series 40 years and n rp is the return period of interest expressed in years here n rp values of 100 50 20 10 have been applied representing 100 year 50 year 20 year and 10 year return periods respectively a basic assumption in the application of the approach described above is that the process is stationary that is that there is no significant trend in significant wave height as a function of time as will be shown subsequently there has been a small but measurable trend across the computational domain section 4 3 it is possible to modify the extreme value analysis described above to include non stationarity e g mentaschi et al 2016 takbash and young 2020 have applied this approach to global era5 significant wave height data to investigate global trends in extremes as the trend in historical wave height within our domain is small 5 see section 4 3 and projections for change in the future e g meucci et al 2020b and morim et al 2019 are similarly small the non stationarity of the record has been ignored in the present analysis 3 model validation before considering the ww3 model outputs to investigate the wave climate of bass strait and south east australia it is essential to validate the model against nearshore in situ observations therefore all available buoy observations table 1 and fig 1 along the coast were used to validate the ww3 model the bulk wave parameters used for validation include significant wave height peak wave period and peak wave direction hourly values of co located buoy and model data were considered for this purpose fig 3 shows colour contoured plots of the density of observations for the three wave parameters at several selected buoy locations the full results for all buoy locations are shown in the supplementary material figs s1 and s2 the locations shown in fig 3 include cape bridgewater in the west wilson s promontory in the centre bass strait lakes entrance 1 in the east and cape sorell on the west coast of tasmania most such wave model validations concentrate on significant wave height mean wave period and mean wave direction akpinar et al 2016 cuttler et al 2020 harley et al 2010 liang et al 2019 morim et al 2016 tsai et al 2012 here we validate the model performance against significant wave height and the more demanding peak wave period and peak wave direction for significant wave height fig 3a d the observations are tightly concentrated near the 1 1 line indicating good agreement between the ww3 model and buoy data the performance metrics eqs 1 to 4 are shown for all buoy locations in table 2 the good agreement between model and buoy seen in fig 3 is repeated across all buoys figs s1 and s2 the comparisons of significant wave height between the present model and buoy data show comparable model metrics to previous studies for the south east australia mcsweeney 2020 morim et al 2016 fig 3e h show the comparisons of peak wave period between the ww3 model and buoy observations peak wave period is a demanding parameter to estimate from discrete spectral data as a result there is more scatter in the validation plots than for significant wave height the agreement across all buoy locations is however again quite reasonable there is a tendency in fig 3e h and table 2 for the model to over estimate the values of peak wave period at the more exposed sites this appears to be a result of the global model boundary conditions predicting longer periods in the southern ocean which impact these exposed sites as swell as becomes clear in the plots for peak wave direction below the wave climate in the region is dominated by south westerly swell incoming direction of 225 measured clockwise from north from the southern ocean hence cape bridgewater and cape sorell are the most exposed sites with the largest values of significant wave height and longest peak wave periods at both locations the peak wave periods fig 3e and h are between 10 and 15 s in contrast wilson s promontory and lakes entrance 1 are protected by tasmania and hence the peak wave periods are significantly shorter 5 to 10 s fig 3f and g the comparisons between model and buoys for peak wave direction are shown in fig 3i to k note there is no directional information for cape sorell agreement between model and buoys at all locations is reasonable noting the limited directional resolving power of three component buoys young 1994 and the finite directional resolution of the model 10 at cape bridgewater the angular spread of peak wave directions is very narrow with data concentrated around 225 indicating that the wave climate year round is dominated by swell from the southern ocean the peak wave directions at wilson s promontory in central bass strait are much more complex with the dominant conditions being from slightly south of west 260 but with a second more broad spread of energy from the east to south of east 80 to 120 this bimodal directional distribution is consistent with the location of this site in bass strait where longer waves swell in particular are constrained to propagating east west through bass strait lakes entrance 1 is located in the east of the domain and the spread of peak wave directions is very broad from east to south west 90 to 220 this reflects the fact that swell can approach the site either along the east coast of tasmania or through bass strait in addition local easterly winds are more common at this site the buoy results show that the wave climate of this region is quite variable responding to the dominant southern ocean swell the complex sheltering provided by tasmania and the impact of local wind fields in all the locations where buoy data were available the model has reproduced the key features recorded by the buoys the four metrics eqs 1 4 shown in table 2 show the quality of the model performance across all the buoy locations it should be noted that some caution must be exercised in the calculation of such metrics for peak wave direction due to the cyclic nature of the parameter in the present domain however there is a relatively narrow range of directions that do not span the 0 360 discontinuity at all buoy locations hence the performance metrics are in this case also valid for peak wave direction it is worth noting that the peak wave direction in the model agrees reasonably well with the buoy observation at cape bridgewater fig 3i even though the correlation coefficient is only 0 68 table 2 the value of the correlation coefficient is rather misleading in this case as the spread of wave energy is very tightly concentrated around a single direction the point concentration in fig 3i in such a case the correlation coefficient is a poor indicator of model performance as noted above table 2 shows the detailed statistical validation results for significant wave height peak wave period and peak wave direction based upon the model skill metrics eqs 1 4 the contoured plots are shown in figs 3 s1 and s2 the statistical values in table 2 are presented graphically in the taylor diagrams in fig 4 as noted previously the agreement for h s is reasonable across all of the locations even the shallowest sites of portland port fairy apollo bay and lakes entrance 3 the performance for peak wave period and peak wave direction is more variable mainly due to the mixed sea conditions in this region all sites consist of a mix of local wind sea and swell buoy time series show rapid step changes in peak wave period and peak wave direction as one system becomes dominant over the other in such circumstances good agreement between model and buoys is challenging due to both instrumentation and model limitations the buoys are limited by their finite frequency resolution limits of peak wave period resolution and their limited directional resolving power 3 component measurements in order to represent such situations the model needs to accurately simulate the southern ocean swell generation region global model the propagation of energy to the site of interest swell dissipation and the local wind speed and direction local wind sea noting these limitations the results in figs 3 s1 s2 and 4 show that the key features of the regional wave climate are captured by the model fig 5 shows the bias distributions of significant wave height peak wave period and peak wave direction which demonstrates the level of agreement between model and buoys the domain of interest is a high wave energy environment with mean significant wave heights of order 4 m and peak wave periods of 12 s mcsweeney 2020 and analysis below noting this the results in fig 5 again show the model generally reproduces the buoy observations reasonably well the bias for significant wave height is between 0 3 m peak wave period between 2 s and the peak wave direction 15 as seen in fig 3 s1 and s2 the discrete frequency resolution of the buoy spectra limits estimates of peak wave period to approximately 2 s and the maximum likelihood method mlm analysis of the 3 component directional spectra typically means directional resolution less than 20 young 1994 with the exception of portland the model is biased slightly high in the western and central areas of the domain and slightly low in the eastern areas of the domain for significant wave height and peak wave period the positive bias in the southern ocean swell dominated regions of the domain are consistent with an over estimation of the wave energy in the indian ocean basin of the southern ocean young et al 2020a of the global model such an overestimation is reported by liu et al 2021 which provides the boundary conditions for the regional model the reason for the small underestimation in the eastern sections of the domain is less obvious but may reflect an under estimation in the strength of easterly winds in the relatively coarse era5 wind fields although model validation using the bulk wave parameters h s t p d p provides an overall assessment of model performance comparison of measured and model directional spectra provides significantly more information fig 6 shows a comparison of model and buoy mean directional spectra averaged over 2020 at cape bridgewater wilson s promontory and lakes entrance 1 as expected from the bulk parameters in fig 3 at cape bridgewater both the model and the buoy show clear waves from the south west the directional spread is narrow in both cases consistent with the earlier conclusion that the wave climate is dominated by the southern ocean swell interestingly the model shows a narrower directional spread than the buoy it is not clear if this is a limitation of the model or the limited directional resolving power of the 3 components directional buoy young 1994 the more complex wave climates at wilson s promontory and lakes entrance 1 are also clear in fig 6 at wilson s promontory both model and buoy show the dominant swell peak from slightly south of west the southern ocean swell penetrating bass strait the less energetic wave energy from the east is just visible in the contouring of the figure interestingly the model shows a directional split in the westerly energy apparently caused by a wave shadow to the east of king island see fig 1 the buoy does not show this wave shadow note that the model does not include the effects of diffraction which may result in an overestimation of the impacts of such wave shadowing conversely the buoy directional resolving power may be insufficient to resolve such an effect young 1994 at lakes entrance 1 both buoy and model show a dominant peak from the south west and directionally broad distribution of energy from the east to the south the model spectra clearly show the ability of the model to reproduce the key features of this quite complex coastal domain in general the ww3 model captures the key elements of the wave climate of the region as represented by significant wave height peak wave period and peak wave direction in the domain figs 3 s1 s2 and 4 the correlation coefficient root mean square error scatter index and bias values are comparable with other model hindcast studies liang et al 2019 lin et al 2019 morim et al 2016 tsai et al 2012 the directional spectra shown in fig 6 further demonstrate that the details of the complex multiple wave systems are also captured by the model as seen in figs 3 s1 and s2 differences between model and buoy t p and d p are not limited to the nearshore sites similar differences are also evident at cape bridgewater and cape sorell which are largely defined by the boundary conditions provided by the liu et al 2021 global model although this model was extensively validated as with all such global hindcasts validation data for t p and d p are limited to northern hemisphere buoys the data from these exposed buoys show the limitations of spectral model performance in representing southern ocean swell differences between buoy and model results at other sites may also reflect limitation in the model representation of physical processes e g currents and bottom friction as well as the relatively coarse resolution of the forcing winds over the domain noting these limitations the validation adds confidence that the nested regional model provides an adequate platform to investigate the long term wave climate of bass strait and south east australia 4 wave climate 4 1 mean conditions the 40 year time series of significant wave height peak wave period and peak wave direction were each averaged to obtain the corresponding mean conditions over the computational domain fig 7 both mean significant wave height fig 7a and mean peak wave period fig 7b show the largest magnitudes in the south western and southern regions of the domain the sheltering provided by tasmania is clear with a significantly reduced wave climate within bass strait and the eastern regions of the domain these results together with the results for the mean peak wave direction fig 7c clearly demonstrate the role which long period waves generated in the southern ocean play in defining the wave climate mcsweeney 2020 young et al 2020a as already demonstrated in the validation data fig 3j the wave direction becomes westerly in bass strait in the eastern portions of the domain the southern ocean swell propagates around tasmania east coast and results in a more southerly mean peak wave direction fig 7c 4 2 seasonality the 40 year time series of the three bulk parameters were also seasonally averaged spring son summer djf autumn mam winter jja and the results are shown in fig 8 all three parameters show very clear seasonal variations the mean seasonal significant wave height peaks in winter with the corresponding maximum of 4 m located in southern and western parts of the domain fig 8d in contrast the magnitudes decrease to 3 m in summer fig 8b mean seasonal variations of peak wave period fig 8e h show similar patterns to significant wave height with largest wave periods in winter and smaller values in summer mean peak wave directions in western regions of the domain are dominated by south westerly waves fig 8i l the mean direction of the waves in the south western regions of the domain rotates counterclockwise from winter to summer fig 8i l this is most likely caused by a combination of a less energetic southern ocean swell system and more persistent local easterly winds in summer these enhanced easterly winds are clearly seen in the eastern regions of the domain where there is a clear shift from southerly swell systems in winter to more easterly conditions in summer fig 8i l such seasonal variations in the energy of the southern ocean swell systems have previously been reported in global scale studies young 1999 young and donelan 2018 young et al 2020a the results in fig 8 show the interaction between these global scale systems and the more local wind forcing in the coastal domain 4 3 long term trends long term trends within the domain were also evaluated based on linear regression of annual values of significant wave height wind sea partition primary swell partition peak wave period and peak wave direction fig 9 regions which are statistically significant at the 95 level were determined using the p values from the regression and are shown by the areas without dots in fig 9 over the 40 years from 1981 to 2020 the significant wave height across the domain increased by approximately 5 fig 9a with the largest increases occurring in the south eastern regions of the domain little change occurred in the more sheltered regions of bass strait and the eastern areas near lakes entrance the magnitude of the increase in significant wave height over this period is comparable with global studies of trends in significant wave height in the southern ocean over similar periods meucci et al 2020a young and ribal 2019 both the wind sea fig 9b and primary swell partition fig 9c of the ww3 model show similar magnitude trends this indicates that the changes in significant wave height are not just a result of an increasing wave climate in the southern ocean rather there have also been increases in the predicted winds over the domain which are reflected in the positive trend in the wind sea this was also confirmed by trend analysis of the era5 wind speed used to force the ww3 model results not shown here the peak wave period shows increases up to 2 over the period not surprisingly the trend in peak wave period largely mirrors the changes in the significant wave height of the swell partition trends in peak wave direction show small counterclockwise rotations in the deep water regions of the western portions of the domain this is associated with the strengthening in the southern ocean swell over the period near cape barren island and offshore regions of eastern tasmania fig 9e there is a strong counterclockwise to clockwise discontinuity this can be attributed to the shadow region east of tasmania apparent in the mean conditions in fig 7c regions close to the east coast of tasmania are sheltered from the south westerly southern ocean swell and hence have a more southerly direction fig 7c as the southern ocean swell direction rotates slightly counterclockwise this allows more southerly swell to enter the area just east of tasmania hence there is a large counterclockwise rotation of the wave direction that is the shadow region moves closer to the east coast of tasmania further offshore the southern ocean swell can now reach these regions from the south west as a result the wave direction moves from southerly to more south westerly resulting in the rapid clockwise rotation of the wave climate for the coastal regions of victoria the peak wave direction trends generally show a small counterclockwise rotation 2 the exception to this is coastal regions from apollo bay to port phillip heads and the lakes entrance region in the east where there is either no change or a very small clockwise rotation 1 over the 40 year period changes in wave climate can have an impact on coastal morphology and beach erosion accretion based on the results in fig 9 one might expect more impacts along the coasts of western and central regions of the domain than in the eastern sections in these regions the combination of an increase in significant wave height peak wave period and a rotation of the peak wave direction may cause coastlines to evolve and realign this is largely consistent with areas where beach erosion has become an issue in recent decades leach et al 2021 4 4 extreme wave analysis extreme wave conditions were also investigated as part of this study fig 10 shows the 90th percentile the highest 10 and 99th percentile the highest 1 significant wave height the spatial distributions for both cases are very similar the 90th percentile significant wave height fig 10a shows maximum values of 5 5 m whilst the 99th percentile values fig 10b reach 7 5 m global evaluation of 90th or 99th percentile significant wave height also shows comparable magnitudes and broadly consistent spatial distributions for south east australia meucci et al 2020b young et al 2020a the extreme conditions shown in fig 10 follow a similar spatial distribution to the mean conditions in fig 7 again showing that the extremes are also influenced by the southern ocean swell mcsweeney 2020 young et al 2020a there are however some local differences in the spatial distributions of the extremes compared to mean conditions in particular the contours in the eastern part of the domain bend towards the eden area see fig 10 it is likely that this is a response to intense east coast low pressure systems that commonly occur along the south eastern australian coast dowdy et al 2019 extreme value analysis as described by eq 5 was also conducted for the model outputs of significant wave height the significant wave heights for different return periods 10 20 50 and 100 years are shown in fig 11 the spatial distributions of the extremes are similar across all return periods and are consistent with the upper percentile values in fig 10 the maximum values of extreme significant wave height in the exposed south western regions of the domain vary between 9 and 11 m depending on the return period within bass strait and the eastern parts of the domain these extreme values are reduced to approximately 6 to 7 m the results for the 100 year return period are consistent with global or southern ocean estimates based on satellite observations takbash et al 2019 young et al 2020a and ensemble datasets meucci et al 2018 takbash and young 2019 in may 2021 outside the validation period used above values of significant wave height of 9 5 m were recorded at the cape bridgewater buoy this same event resulted in 0 7 m diameter rocks being thrown up on the coastal road in the region such extreme conditions are not inconsistent with the modelled maximum h s 8 98 m at cape bridgewater over the period 1981 to 2020 4 5 impacts of southern annular mode numerous studies have investigated the correlation between wave climate and large scale interannual atmospheric climate variability cuttler et al 2020 harley et al 2010 hemer et al 2010 kumar et al 2016 marshall et al 2018 yang and oh 2020 young 1994 as previous studies have indicated the sam has an impact on wave climate in the region hemer et al 2010 marshall et al 2018 the influence of sam on wave parameters was investigated in the present study the sami time series as determined by marshall et al 2018 was downloaded from https legacy bas ac uk met gjma sam html fig 12a d shows the correlation coefficient between seasonal values of detrended significant wave height over the domain and sami consistent with the results of hemer et al 2010 and marshall et al 2018 the present data show a positive correlation between sami and significant wave height in autumn mam and winter jja fig 12c and d during spring son fig 12a there is a negative correlation summer djf fig 12b shows a negative correlation in the western parts of the domain and a positive correlation in the eastern regions correlations were also investigated without detrending the respective time series and produced results very similar to those shown in figs 12 s3 and s4 noting this the data were still detrended to ensure the potential for spurious correlations was minimized that is there is a long term positive trend in sami as there is in significant wave height fig 9a however there has also been a positive trend in both local winds and southern ocean winds hemer et al 2010 young and ribal 2019 therefore a positive correlation between long term sami and significant wave height may occur for a number of reasons not directly linked to the relationship between these variables a positive correlation in the detrended seasonal values indicates that a southern movement of the southern ocean low pressure systems is consistent with an increase in the significant wave height over the domain in winter fig 12d these low pressure systems are already at their most northerly position a further move north may increase local winds but it will reduce the effective fetch over which winds can blow hence this would result in a reduction in significant wave height conversely a movement of the low pressure systems south during winter will result in extended fetches and larger significant wave heights in summer fig 12b the low pressure systems are at their most southerly position a movement further south appears to result in them moving so far away from the southern coast of australia that the significant wave height decreases negative correlation in fig 12b these results are consistent with previous global scale studies cuttler et al 2020 harley et al 2010 hemer et al 2010 it should however be noted that the magnitudes of these correlations are relatively low absolute values generally less than 0 35 with the exception of spring fig 12a they are generally not statistically significant at the 95 level the correlation between detrended seasonal values of peak wave period and sami was also investigated see fig s3 for each of the four seasons there was a statistically significant positive correlation across most of the model domain this is not surprising and indicates that a southward movement of the southern ocean low pressure systems results in longer waves i e larger peak period across the domain this again emphasizes the dominant role of the southern ocean swell in this region furthermore the relationship between detrended peak wave direction and sami see fig s4 shows that the direction tends to shift counterclockwise when the sami is positive i e low pressure systems move south which is also consistent with previous studies cuttler et al 2020 mcsweeney 2020 5 conclusions the southern ocean remains a region where the wave climate is poorly understood in addition it is unique in that the extremely long fetches give rise to both large waves but also conditions with longer peak periods than any other oceanic basin as such the region is an interesting test of present day physics in spectral wave models such as ww3 the southern coast of australia is directly exposed to the southern ocean and tasmania bass strait and victoria represent a complex coastal region as such the modelling of these regions is an important test of finite depth model physics in this study a high resolution regional ocean wave model the ww3 model based on unstructured grids was developed to investigate the wave climate of bass strait and south east australia the model was validated against an extensive array of coastal buoy observations which shows good performance in simulating significant wave height and acceptable performance for peak wave period and peak wave direction table 2 figs 3 and 6 the wave climate of the region is a combination of southern ocean swell and local wind sea in addition the sheltering provided by tasmania means that the spatial gradients of significant wave height are significant between the exposed western regions of the domain and the more sheltered areas of bass strait as such this region is a demanding test of the physics of the wave model the wave climate of the region is largely controlled by southern ocean swell which represents the dominant waves for western victoria and western tasmania fig 7a there is a strong seasonal cycle in wave height with maximum significant wave heights in winter and minimums in summer fig 8b and d in the eastern regions of victoria the protection afforded by tasmania means that the swell direction moves to the south in winter but shifts south easterly in summer fig 8j and l which implies local winds dominate at this time of year over the period from 1981 to 2020 the significant wave height has increased by approximately 5 across the domain fig 9a this increase is a result of both an increase in the magnitude of the southern ocean swell and the local wind sea fig 9b and c during this same period there has been a small 2 counterclockwise rotation of the peak wave direction across the region extreme wave results show that the 90th 99th percentile significant wave height is approximately 5 5 m 7 5 m in the south western region of the domain fig 10 meanwhile the 100 year return period significant wave height can reach 11 m fig 11 the southern annular mode shows important impacts on wave parameters across the domain fig 12 in autumn and winter the sami is positively correlated with significant wave height indicating that southward movement of southern ocean extra tropical storm belt results in increases in significant wave height the correlation between sami and significant wave height is weaker in summer when the low pressure storm belt is at its most southern location this is consistent with a wave climate more controlled by local winds in summer fig 8b due to a lack of high resolution input data over the computational domain and 40 year hindcast period the model did not include potential impacts from wave current interaction in addition the era5 wind fields used to force the model are relatively coarse and may not adequately resolve local wind impacts these limitations may account for the observed differences between buoy and model values of peak wave period and direction in addition however limitations with accurate prediction of southern ocean wave conditions from the global model within which our regional grid is nested are clearly also an issue future studies of the region could further investigate both current and local wind impacts the present study indicates that the wave climate of the region has increased over the last 40 years largely as a result of strengthening wave conditions in the southern ocean this is associated with a long term trend to more positive values of the sami projections of global mean and extreme wave conditions hemer et al 2013 meucci et al 2020b morim et al 2019 2021 indicate this positive trend in significant wave height is projected to continue in the future as a result of global climate change as our study region is strongly impacted by southern ocean swell it is highly likely that southern australia will also experience positive trends in significant wave height and a continued counterclockwise rotation of wave direction over the 21st century this is clearly an area where future modelling of projected wave climate would be of value credit authorship contribution statement jin liu methodology software data curation writing original draft visualization writing review editing alberto meucci software writing review editing qingxiang liu data curation writing review editing alexander v babanin writing review editing daniel ierodiaconou data curation writing review editing ian r young conceptualization methodology data curation writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we acknowledge the ww3 development group for model development and providing source codes and the university of melbourne for providing the high performance computer cluster we also thank huy quang tran for sharing the combined bathymetric data wave buoy data were provided by the port of melbourne and gippsland ports wind data were provided by climate data store aodn wave data were sourced from australia s integrated marine observing system imos imos is enabled by the national collaborative research infrastructure strategy ncris wave buoy data was also provided by the victorian coastal monitoring program with funding through the department of environment land water and planning university of melbourne and deakin university see vicwaves com au jl acknowledges the support of the melbourne research scholarship provided by the university of melbourne appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ocemod 2022 101980 appendix a supplementary data the following is the supplementary material related to this article mmc s1 supplementary material shows additional model validation against buoy data and correlation with southern annular mode 
23850,a high resolution third generation wave model based on unstructured grids wavewatch iii was used to investigate the wave climate of bass strait and south east australia over the period 1981 to 2020 the model results are extensively validated against a network of coastal buoys and demonstrate that the model can capture the overall wave characteristics in this region analyses of model outputs across the 40 year period show that significant wave height has increased by approximately 5 and a slight counterclockwise rotation of peak wave direction has occurred with likely implications for coastal processes seasonal variations show higher significant wave height in winter compared to summer which is driven by dominant southern ocean swell the peak wave direction in the eastern region shifts from south westerly in winter to south easterly in summer in autumn and winter there is a statistically significant correlation between wave conditions and the southern annular mode during these seasons a southward movement of southern ocean low pressure systems is associated with increased significant wave height an increase in the peak wave period and a counterclockwise rotation of the peak wave direction keywords wave climate wave hindcast unstructured grids wavewatch iii bass strait south east australia 1 introduction understanding regional ocean wave climate is critical for a range of reasons beach morphology and shoreline erosion are highly influenced by ocean waves kirezci et al 2020 leach et al 2021 mcsweeney and shulmeisterb 2018 and nearshore breaking waves play an important role in the stability and erosion accretion of beaches wave climate also influences the distribution and productivity of coastal and marine communities with wave energy influencing the morphology community structure and spatial organization of taxa in the marine coastal zone through a number of direct and indirect processes rattray et al 2015 young et al 2020b ocean waves also represent a major design input to the construction and operation of coastal facilities akpinar et al 2016 jenkins et al 2012 lv et al 2014 the increase in the offshore renewable energy industry has opened up the development of nearshore regions where an understanding of wave climate becomes an important design consideration ching piao et al 2012 cornett 2008 flocard et al 2016 morim et al 2014 2016 ribal et al 2020 ocean waves also define the aerodynamic roughness of the air water interface which impacts the flux of energy and gases across the interface and defines the shape of the atmospheric boundary layer jenkins et al 2012 numerous studies have investigated the wave climate at both global and regional scales using satellite observations lin et al 2019 liu et al 2016 young 1999 young et al 2020a young and ribal 2019 reanalysis datasets harley et al 2010 hemer et al 2010 and or ocean wave model hindcasts liang et al 2019 mori et al 2017 shimura and mori 2019 young et al 2020a the wave models used have included wavewatch iii ww3 ww3dg 2019 swan booij et al 1999 swan team 2019 and wam wamdi wamdi group 1998 relationships between observed or modelled wave parameters and climate indices have also been studied for example el niño southern oscillation harley et al 2010 hemer et al 2010 mcsweeney 2020 tsai et al 2012 southern annular mode cuttler et al 2020 harley et al 2010 hemer et al 2010 mcsweeney 2020 arctic oscillation liu et al 2016 and subtropical high pressure regime and intensity cuttler et al 2020 based on a 31 year long satellite dataset from 1985 to 2018 young and ribal 2019 found extreme conditions of global oceanic wind speed and significant wave height had increased over the study period with the largest impact in the southern ocean while the changes in the corresponding mean values were relatively small liu et al 2016 reported the arctic oscillation and arctic dipole anomaly have clear impacts on the wind and wave climate of the arctic ocean based upon 20 years of satellite observations by nesting a regional high resolution wavewatch iii ww3 model within a global model shimura and mori 2019 distinguished different wave spectra types around japan and attributed their variations to atmospheric conditions through empiric orthogonal function analysis the victorian coast in south east australia fig 1 is one of the most densely populated regions in australia morim et al 2016 understanding wave climate in this region is crucial for coastal applications the wave climate of this region is heavily influenced by southern ocean swell mcsweeney 2020 global scale observations young and ribal 2019 young et al 2011 and model hindcasts meucci et al 2020a morim et al 2019 have indicated that the wave climate in the southern ocean is changing faster than any other region on earth hence an understanding of the changes which have occurred in this nearshore region has both local and global significance over the past few decades satellite altimeters have provided global scale measurements of significant wave height ribal and young 2019 but such applications are limited to the deep oceans due to the finite footprint size of such satellite systems of order 10 km and the large satellite cross track separation of order 200 km liu et al 2018 ribal and young 2019 in situ buoy observations provide valuable point observations but they are typically of relatively short duration and spatially too sparse to quantify the wave climate across long and complex coastal areas mcsweeney 2020 third generation wave models have shown their ability to model ocean waves on global and regional scales abdolali et al 2020 ching piao et al 2012 cuttler et al 2020 harley et al 2010 hemer et al 2010 liang et al 2019 shimura and mori 2019 however there are still a limited number of studies of long term wave climate in complex coastal regions exposed to the southern ocean such as victoria mcsweeney 2020 studied spatio temporal variations of wave parameters at 10 offshore locations along the victorian coast offshore distances 33 41 km by extracting directional wave hindcast data from noaa s global ww3 model although valuable such large scale regionally unvalidated model studies may raise downscaling issues when applied to coastal regions the present paper aims to provide a comprehensive analysis of the wave climate of bass strait and south east australia over the 40 year period 1981 2020 the analysis utilizes a high resolution regional ocean wave model the ww3 model based on unstructured grids for bass strait and south east australia nested within a global ww3 model the model and the validation buoy data sources are described in section 2 section 3 describes the validation results against the extensive network of coastal buoys the wave climate of the region is discussed in section 4 including mean conditions and seasonal variations long term trends extreme conditions and the impact of multi decadal climate variability section 5 draws conclusions from the study 2 data and methods 2 1 research domain the model domain selected for the study is shown in fig 1 covering the area 137 155 e 35 45 s three australian coastal states span this domain victoria tasmania and southern new south wales victoria and tasmania are separated by the relatively shallow bass strait there are over 50 islands between victoria and tasmania including king island flinders island and cape barren island which greatly increase the bathymetric complexity of this region 2 2 wave model the ww3 model ww3dg 2019 is a third generation wave model developed at national centers for environmental prediction ncep national oceanographic and atmospheric administration noaa it has evolved into a wave modelling framework from the earlier wavewatch i tolman 1991 and wavewatch ii tolman 1992 versions the ww3 model solves the random phase spectral action balance equation it assumes that the wave field and properties of the medium current and water depth vary in space on a scale that is much larger than the scale of a single wave ww3dg 2019 in this study the ww3 version 6 07 1 model was initialized from quiescent conditions with the linear input source term proposed by cavaleri and rizzoli 1981 and a low frequency filter for wave energy as introduced by tolman 1992 wind input white cap dissipation swell dissipation and negative wind input were computed based on the observation consistent st6 source term package liu et al 2019 rogers et al 2012 zieger et al 2015 the wind input and white cap dissipation source terms are based on measurements at lake george australia the swell dissipation is based on laboratory experiments and field observations the negative wind input source term is based on laboratory tests ww3dg 2019 the nonlinear quadruplet wave wave interactions were modelled using the discrete interaction approximation dia method which was proposed by hasselmann et al 1985 the empirical jonswap bottom friction parameterization hasselmann et al 1973 was adopted for the study more sophisticated representations are available such as proposed by collins 1972 such forms account for differing bed material and the threshold behaviour of ripple generation on sandy beds nielsen 1983 as shown by young and gorman 1995 for a site west of our study region in the great australian bight such representations require detailed knowledge of bed material and how this may change over time this information was not available over the study region for the 40 year duration of the study in such circumstances young and gorman 1995 showed that the jonswap formulation for bottom friction actually performed better than apparently more sophisticated representations the energy dissipation model used to simulate depth induced wave breaking was proposed by battjes and janssen 1978 nonlinear triad wave wave interactions were not included due to their low accuracy at present ww3dg 2019 the ww3 model was run using the default third order propagation scheme which is the computationally quickest scheme combined with the ultimate total variance diminishing limiter ww3dg 2019 all the parameters used in the modelling were set to default values including the air sea coupling factor cdfac 1 unless otherwise stated liu et al 2021 the model setup adopted did not include impacts of currents on the waves ww3 does include the possibility of current impacts on refraction and potential impacts on atmospheric input due to current induced wave phase speed variability coastal areas such as bass strait can experience significant currents ridgway 2007 young et al 2020b in addition rapizo et al 2018 have shown that the inclusion of currents in global models can enhance performance particularly in the southern ocean as high resolution current data were not available over our computational domain for the 40 year hindcast period it was not possible to investigate the significance of wave current impacts examination of the global results of rapizo et al 2018 indicates that neglecting currents in this region will result in differences of only 2 in significant wave height currents along with limited resolution of the forcing wind fields represent potential error sources within the model setup water depth is an important factor in defining wave conditions in coastal regions and high resolution bathymetric data are needed for high quality coastal modelling hargreaves et al 2002 nearshore bathymetric data were obtained from the victorian coastal digital elevation model in which spatial resolution is provided down to 10 m these data can be downloaded from the australian ocean data network aodn https portal aodn org au for offshore regions the bathymetric data were provided by the australian bureau of meteorology bom http www bom gov au these data sources were combined to form a single bathymetry grid for the model region both structured and unstructured grids can be used in the ww3 model generally structured grids are rectilinear or curvilinear with 4 grid cells meeting at every internal grid point while unstructured grids can be triangular with grid cells meeting at each internal grid point due to the significant variations of wave spatial characteristics from offshore to nearshore the variation in water depth across the model domain and the need to adequately define coastlines unstructured grids offer many advantages for coastal modelling roberts et al 2019 in this study a triangular unstructured grid was designed to provide optimal resolution near the coast and adequately define the complex water depth in the coastal regions e g islands and irregular shorelines the oceanmesh2d grid generator was employed to generate the grid which determined the mesh size based on distance feature size wavelength topographic length scale and channel thalwegs polylines to control mesh size automatically roberts et al 2019 fig 2 shows the triangular unstructured grid that was generated based upon the bathymetric characteristics in fig 1 the grid consists of 184 195 elements and 97 276 nodes approximately 51 of the grid mesh is smaller than 1 km while 77 of the grid mesh is smaller than 2 km the unstructured grid has an offshore resolution ranging from 500 m to 10 000 m while the nearshore resolution is typically of order 500 m in this way the unstructured grid has high resolution in the coastal region while maintaining a coarse resolution in the deeper ocean that greatly improves the computational efficiency of the model the open boundary blue line in the insert of fig 1 conditions cover 170 points directional spectra were provided at each point from the global hindcast of liu et al 2021 the liu et al 2021 hindcast covers the period from 1981 to 2020 this hindcast uses the ww3 model with spectral output on the boundaries available at a time resolution of 1 h and spatial resolution of 0 25 this global hindcast used the st6 physics dia nonlinear term and the default jonswap bottom friction consistent with the present regional model liu et al 2021 era5 hourly wind data hersbach et al 2020 provided by the european centre for medium range weather forecasts ecmwf https www ecmwf int were used to force the regional ww3 model note that the global wave model that provided the boundary conditions used the same wind fields the era5 wind data cover the period from 1950 to present the original era5 model uses a 31 km cartesian grid with the data then being interpolated onto a spatial resolution of 0 25 and can be downloaded from the climate data store cds https cds climate copernicus eu the 0 25 resolution for the winds is relatively coarse for coastal domains and local impacts close to shore may not be adequately resolved by such winds higher resolution winds do exist but only in more recent years as model resolution has increased with enhanced computation resources at present the 0 25 era5 data represents the best available long term wind dataset ideally higher resolution winds would have been used but such wind data were not available over the computational domain and the 40 year hindcast period clearly however the wind field resolution is a limitation which may impact model performance following liu et al 2021 which provided the boundary conditions the regional model spectra were discretized with 36 direction bins with direction increment of 10 and 35 logarithmically distributed frequency bins from 0 037 hz to 0 953 hz examination of data from the most exposed buoy site of cape bridgewater see fig 1 showed that over the two year period 2020 2021 the lowest value of peak frequency was 0 04 hz recorded during a storm with h s 9 7 m this indicates that the lower frequency limit of the spectrum will generally be adequate with the exception of some very extreme cases future global wave modelling may need to extend to lower values of frequency to address the extremely long waves generated in the southern ocean the spin up time of the model was 1 month the model was run for the 40 year period from 1981 to 2020 with a time step of 20 min the integral wave parameters output across the computational grid including significant wave height h s peak wave frequency peak wave direction d p and partitioned wave quantities wind sea primary swell height secondary swell height the reciprocal of peak wave frequency is peak wave period t p full spectral output was provided at selected nearshore locations as shown in fig 1 purple locations 2 3 buoy and southern annular mode data buoy data from a range of nearshore sites were available for validation of the ww3 model results detailed information including the locations duration and available parameters are shown in table 1 the locations of the buoys are also shown in fig 1 short term approximately 1 year or 6 months records at a range of sites were provided from the vicwaves website https vicwaves com au and long term records were obtained from the port of melbourne gippsland ports https www gippslandports vic gov au and aodn in addition to the bulk wave parameters listed in table 1 approximately 1 year of directional spectral data were available at each of cape bridgewater wilson s promontory and lakes entrance 1 the buoy spectra cover frequencies up to 0 64 hz with a frequency increment of 0 005 hz and directional resolution of 3 the southern annular mode sam has been shown to have an impact on the southern ocean wave climate hemer et al 2010 marshall et al 2018 the sam is the principal mode of the atmospheric variability in the middle and high latitude regions of the southern hemisphere which influences the broadscale climate in this hemisphere marshall 2003 variations in the sam potentially impact ocean waves ocean circulation sea surface temperature and other aspects of southern hemisphere climate cuttler et al 2020 hemer et al 2010 marshall et al 2018 marshall 2003 mcsweeney 2020 the sam can be quantified by the southern annular mode index sami which is based on the zonal pressure difference between 40 s and 65 s marshall 2003 a positive negative sami phase is generally associated with a southward northward shift of southern ocean extra tropical storm belt cuttler et al 2020 mcsweeney 2020 the monthly sami can be downloaded from https legacy bas ac uk met gjma sam html which were calculated based on sea level pressure from 6 stations at 65 s and 6 stations at 40 s marshall 2003 2 4 model skill metrics there are different metrics commonly used to describe model performance against buoy data akpinar and bingölbali 2016 chawla et al 2013 lin et al 2019 in this study the following four metrics were used to evaluate the ww3 model performance akpinar and bingölbali 2016 the pearson correlation coefficient cc root mean square error rmse scatter index si and bias value bias 1 cc i 1 n o i o i p i p i i 1 n o i o i 2 i 1 n p i p i 2 where n is number of data points o p is the observation model data and o p is the mean value of the observation model data 2 rmse 1 n i 1 n p i o i 2 3 si rmse o 4 bias p o to display multiple skill metrics together i e taylor diagram taylor 2001 the normalized standard deviation nstd and normalized centred root mean square error crmse were also used chawla et al 2013 taylor 2001 which are defined by 5 nstd 1 n i 1 n p i p 2 1 n i 1 n o i o 2 6 crmse 1 n i 1 n p i p o i o 2 1 n i 1 n o i o 2 2 5 extreme wave analysis there are many extreme value analysis techniques which can be applied to wave data takbash et al 2019 vanem 2015 in all cases the aim is to fit an analytical extreme value probability distribution to the data and extrapolate to the desired probability level coles et al 2001 a common approach is to consider annual maxima where it can be shown that the data should theoretically follow a generalized extreme value gev distribution coles et al 2001 as such an approach excludes multiple peaks in a given year a common alternative is to consider peaks above a given threshold the peaks over threshold approach or pot in this case the probability distribution will follow a generalized pareto distribution gpd or its simplified form the exponential distribution coles et al 2001 takbash et al 2019 have analysed different methods from long duration satellite observations and found the peaks over threshold approach pot provides consist results when compared to long duration buoy records as the pot approach maximizes use of the available data it was adopted here it should be noted however that the details of the selected extreme value approach will impact the results takbash et al 2019 vanem 2015 following coles et al 2001 takbash et al 2019 takbash and young 2019 and young et al 2020a the pot approach was applied to the 40 years hindcast data as noted above pot data theoretically follows the gpd distribution the cumulative distribution function form of which is given by takbash et al 2019 7 f x 1 1 k x a b 1 k where f x is the cumulative distribution function x is significant wave height k and b are shape and scale parameters respectively the parameter a is the user defined threshold value which should be high enough to exclude bias effects but not so high that there are insufficient data to obtain a stable fit of the probability distribution function takbash et al 2019 thresholds selected at the 90th or 95th percentile values are commonly used meucci et al 2020b takbash et al 2019 vinoth and young 2011 in this study the 95th percentile significant wave height was used as the threshold value after sensitive tests using a range of values when applying the pot approach the expected probability level p for a n r p year return period is given by takbash et al 2019 8 p x x n rp 1 n y n rp n pot where n pot is the number of data points in the pot analysis n y is the number of years covered by the time series 40 years and n rp is the return period of interest expressed in years here n rp values of 100 50 20 10 have been applied representing 100 year 50 year 20 year and 10 year return periods respectively a basic assumption in the application of the approach described above is that the process is stationary that is that there is no significant trend in significant wave height as a function of time as will be shown subsequently there has been a small but measurable trend across the computational domain section 4 3 it is possible to modify the extreme value analysis described above to include non stationarity e g mentaschi et al 2016 takbash and young 2020 have applied this approach to global era5 significant wave height data to investigate global trends in extremes as the trend in historical wave height within our domain is small 5 see section 4 3 and projections for change in the future e g meucci et al 2020b and morim et al 2019 are similarly small the non stationarity of the record has been ignored in the present analysis 3 model validation before considering the ww3 model outputs to investigate the wave climate of bass strait and south east australia it is essential to validate the model against nearshore in situ observations therefore all available buoy observations table 1 and fig 1 along the coast were used to validate the ww3 model the bulk wave parameters used for validation include significant wave height peak wave period and peak wave direction hourly values of co located buoy and model data were considered for this purpose fig 3 shows colour contoured plots of the density of observations for the three wave parameters at several selected buoy locations the full results for all buoy locations are shown in the supplementary material figs s1 and s2 the locations shown in fig 3 include cape bridgewater in the west wilson s promontory in the centre bass strait lakes entrance 1 in the east and cape sorell on the west coast of tasmania most such wave model validations concentrate on significant wave height mean wave period and mean wave direction akpinar et al 2016 cuttler et al 2020 harley et al 2010 liang et al 2019 morim et al 2016 tsai et al 2012 here we validate the model performance against significant wave height and the more demanding peak wave period and peak wave direction for significant wave height fig 3a d the observations are tightly concentrated near the 1 1 line indicating good agreement between the ww3 model and buoy data the performance metrics eqs 1 to 4 are shown for all buoy locations in table 2 the good agreement between model and buoy seen in fig 3 is repeated across all buoys figs s1 and s2 the comparisons of significant wave height between the present model and buoy data show comparable model metrics to previous studies for the south east australia mcsweeney 2020 morim et al 2016 fig 3e h show the comparisons of peak wave period between the ww3 model and buoy observations peak wave period is a demanding parameter to estimate from discrete spectral data as a result there is more scatter in the validation plots than for significant wave height the agreement across all buoy locations is however again quite reasonable there is a tendency in fig 3e h and table 2 for the model to over estimate the values of peak wave period at the more exposed sites this appears to be a result of the global model boundary conditions predicting longer periods in the southern ocean which impact these exposed sites as swell as becomes clear in the plots for peak wave direction below the wave climate in the region is dominated by south westerly swell incoming direction of 225 measured clockwise from north from the southern ocean hence cape bridgewater and cape sorell are the most exposed sites with the largest values of significant wave height and longest peak wave periods at both locations the peak wave periods fig 3e and h are between 10 and 15 s in contrast wilson s promontory and lakes entrance 1 are protected by tasmania and hence the peak wave periods are significantly shorter 5 to 10 s fig 3f and g the comparisons between model and buoys for peak wave direction are shown in fig 3i to k note there is no directional information for cape sorell agreement between model and buoys at all locations is reasonable noting the limited directional resolving power of three component buoys young 1994 and the finite directional resolution of the model 10 at cape bridgewater the angular spread of peak wave directions is very narrow with data concentrated around 225 indicating that the wave climate year round is dominated by swell from the southern ocean the peak wave directions at wilson s promontory in central bass strait are much more complex with the dominant conditions being from slightly south of west 260 but with a second more broad spread of energy from the east to south of east 80 to 120 this bimodal directional distribution is consistent with the location of this site in bass strait where longer waves swell in particular are constrained to propagating east west through bass strait lakes entrance 1 is located in the east of the domain and the spread of peak wave directions is very broad from east to south west 90 to 220 this reflects the fact that swell can approach the site either along the east coast of tasmania or through bass strait in addition local easterly winds are more common at this site the buoy results show that the wave climate of this region is quite variable responding to the dominant southern ocean swell the complex sheltering provided by tasmania and the impact of local wind fields in all the locations where buoy data were available the model has reproduced the key features recorded by the buoys the four metrics eqs 1 4 shown in table 2 show the quality of the model performance across all the buoy locations it should be noted that some caution must be exercised in the calculation of such metrics for peak wave direction due to the cyclic nature of the parameter in the present domain however there is a relatively narrow range of directions that do not span the 0 360 discontinuity at all buoy locations hence the performance metrics are in this case also valid for peak wave direction it is worth noting that the peak wave direction in the model agrees reasonably well with the buoy observation at cape bridgewater fig 3i even though the correlation coefficient is only 0 68 table 2 the value of the correlation coefficient is rather misleading in this case as the spread of wave energy is very tightly concentrated around a single direction the point concentration in fig 3i in such a case the correlation coefficient is a poor indicator of model performance as noted above table 2 shows the detailed statistical validation results for significant wave height peak wave period and peak wave direction based upon the model skill metrics eqs 1 4 the contoured plots are shown in figs 3 s1 and s2 the statistical values in table 2 are presented graphically in the taylor diagrams in fig 4 as noted previously the agreement for h s is reasonable across all of the locations even the shallowest sites of portland port fairy apollo bay and lakes entrance 3 the performance for peak wave period and peak wave direction is more variable mainly due to the mixed sea conditions in this region all sites consist of a mix of local wind sea and swell buoy time series show rapid step changes in peak wave period and peak wave direction as one system becomes dominant over the other in such circumstances good agreement between model and buoys is challenging due to both instrumentation and model limitations the buoys are limited by their finite frequency resolution limits of peak wave period resolution and their limited directional resolving power 3 component measurements in order to represent such situations the model needs to accurately simulate the southern ocean swell generation region global model the propagation of energy to the site of interest swell dissipation and the local wind speed and direction local wind sea noting these limitations the results in figs 3 s1 s2 and 4 show that the key features of the regional wave climate are captured by the model fig 5 shows the bias distributions of significant wave height peak wave period and peak wave direction which demonstrates the level of agreement between model and buoys the domain of interest is a high wave energy environment with mean significant wave heights of order 4 m and peak wave periods of 12 s mcsweeney 2020 and analysis below noting this the results in fig 5 again show the model generally reproduces the buoy observations reasonably well the bias for significant wave height is between 0 3 m peak wave period between 2 s and the peak wave direction 15 as seen in fig 3 s1 and s2 the discrete frequency resolution of the buoy spectra limits estimates of peak wave period to approximately 2 s and the maximum likelihood method mlm analysis of the 3 component directional spectra typically means directional resolution less than 20 young 1994 with the exception of portland the model is biased slightly high in the western and central areas of the domain and slightly low in the eastern areas of the domain for significant wave height and peak wave period the positive bias in the southern ocean swell dominated regions of the domain are consistent with an over estimation of the wave energy in the indian ocean basin of the southern ocean young et al 2020a of the global model such an overestimation is reported by liu et al 2021 which provides the boundary conditions for the regional model the reason for the small underestimation in the eastern sections of the domain is less obvious but may reflect an under estimation in the strength of easterly winds in the relatively coarse era5 wind fields although model validation using the bulk wave parameters h s t p d p provides an overall assessment of model performance comparison of measured and model directional spectra provides significantly more information fig 6 shows a comparison of model and buoy mean directional spectra averaged over 2020 at cape bridgewater wilson s promontory and lakes entrance 1 as expected from the bulk parameters in fig 3 at cape bridgewater both the model and the buoy show clear waves from the south west the directional spread is narrow in both cases consistent with the earlier conclusion that the wave climate is dominated by the southern ocean swell interestingly the model shows a narrower directional spread than the buoy it is not clear if this is a limitation of the model or the limited directional resolving power of the 3 components directional buoy young 1994 the more complex wave climates at wilson s promontory and lakes entrance 1 are also clear in fig 6 at wilson s promontory both model and buoy show the dominant swell peak from slightly south of west the southern ocean swell penetrating bass strait the less energetic wave energy from the east is just visible in the contouring of the figure interestingly the model shows a directional split in the westerly energy apparently caused by a wave shadow to the east of king island see fig 1 the buoy does not show this wave shadow note that the model does not include the effects of diffraction which may result in an overestimation of the impacts of such wave shadowing conversely the buoy directional resolving power may be insufficient to resolve such an effect young 1994 at lakes entrance 1 both buoy and model show a dominant peak from the south west and directionally broad distribution of energy from the east to the south the model spectra clearly show the ability of the model to reproduce the key features of this quite complex coastal domain in general the ww3 model captures the key elements of the wave climate of the region as represented by significant wave height peak wave period and peak wave direction in the domain figs 3 s1 s2 and 4 the correlation coefficient root mean square error scatter index and bias values are comparable with other model hindcast studies liang et al 2019 lin et al 2019 morim et al 2016 tsai et al 2012 the directional spectra shown in fig 6 further demonstrate that the details of the complex multiple wave systems are also captured by the model as seen in figs 3 s1 and s2 differences between model and buoy t p and d p are not limited to the nearshore sites similar differences are also evident at cape bridgewater and cape sorell which are largely defined by the boundary conditions provided by the liu et al 2021 global model although this model was extensively validated as with all such global hindcasts validation data for t p and d p are limited to northern hemisphere buoys the data from these exposed buoys show the limitations of spectral model performance in representing southern ocean swell differences between buoy and model results at other sites may also reflect limitation in the model representation of physical processes e g currents and bottom friction as well as the relatively coarse resolution of the forcing winds over the domain noting these limitations the validation adds confidence that the nested regional model provides an adequate platform to investigate the long term wave climate of bass strait and south east australia 4 wave climate 4 1 mean conditions the 40 year time series of significant wave height peak wave period and peak wave direction were each averaged to obtain the corresponding mean conditions over the computational domain fig 7 both mean significant wave height fig 7a and mean peak wave period fig 7b show the largest magnitudes in the south western and southern regions of the domain the sheltering provided by tasmania is clear with a significantly reduced wave climate within bass strait and the eastern regions of the domain these results together with the results for the mean peak wave direction fig 7c clearly demonstrate the role which long period waves generated in the southern ocean play in defining the wave climate mcsweeney 2020 young et al 2020a as already demonstrated in the validation data fig 3j the wave direction becomes westerly in bass strait in the eastern portions of the domain the southern ocean swell propagates around tasmania east coast and results in a more southerly mean peak wave direction fig 7c 4 2 seasonality the 40 year time series of the three bulk parameters were also seasonally averaged spring son summer djf autumn mam winter jja and the results are shown in fig 8 all three parameters show very clear seasonal variations the mean seasonal significant wave height peaks in winter with the corresponding maximum of 4 m located in southern and western parts of the domain fig 8d in contrast the magnitudes decrease to 3 m in summer fig 8b mean seasonal variations of peak wave period fig 8e h show similar patterns to significant wave height with largest wave periods in winter and smaller values in summer mean peak wave directions in western regions of the domain are dominated by south westerly waves fig 8i l the mean direction of the waves in the south western regions of the domain rotates counterclockwise from winter to summer fig 8i l this is most likely caused by a combination of a less energetic southern ocean swell system and more persistent local easterly winds in summer these enhanced easterly winds are clearly seen in the eastern regions of the domain where there is a clear shift from southerly swell systems in winter to more easterly conditions in summer fig 8i l such seasonal variations in the energy of the southern ocean swell systems have previously been reported in global scale studies young 1999 young and donelan 2018 young et al 2020a the results in fig 8 show the interaction between these global scale systems and the more local wind forcing in the coastal domain 4 3 long term trends long term trends within the domain were also evaluated based on linear regression of annual values of significant wave height wind sea partition primary swell partition peak wave period and peak wave direction fig 9 regions which are statistically significant at the 95 level were determined using the p values from the regression and are shown by the areas without dots in fig 9 over the 40 years from 1981 to 2020 the significant wave height across the domain increased by approximately 5 fig 9a with the largest increases occurring in the south eastern regions of the domain little change occurred in the more sheltered regions of bass strait and the eastern areas near lakes entrance the magnitude of the increase in significant wave height over this period is comparable with global studies of trends in significant wave height in the southern ocean over similar periods meucci et al 2020a young and ribal 2019 both the wind sea fig 9b and primary swell partition fig 9c of the ww3 model show similar magnitude trends this indicates that the changes in significant wave height are not just a result of an increasing wave climate in the southern ocean rather there have also been increases in the predicted winds over the domain which are reflected in the positive trend in the wind sea this was also confirmed by trend analysis of the era5 wind speed used to force the ww3 model results not shown here the peak wave period shows increases up to 2 over the period not surprisingly the trend in peak wave period largely mirrors the changes in the significant wave height of the swell partition trends in peak wave direction show small counterclockwise rotations in the deep water regions of the western portions of the domain this is associated with the strengthening in the southern ocean swell over the period near cape barren island and offshore regions of eastern tasmania fig 9e there is a strong counterclockwise to clockwise discontinuity this can be attributed to the shadow region east of tasmania apparent in the mean conditions in fig 7c regions close to the east coast of tasmania are sheltered from the south westerly southern ocean swell and hence have a more southerly direction fig 7c as the southern ocean swell direction rotates slightly counterclockwise this allows more southerly swell to enter the area just east of tasmania hence there is a large counterclockwise rotation of the wave direction that is the shadow region moves closer to the east coast of tasmania further offshore the southern ocean swell can now reach these regions from the south west as a result the wave direction moves from southerly to more south westerly resulting in the rapid clockwise rotation of the wave climate for the coastal regions of victoria the peak wave direction trends generally show a small counterclockwise rotation 2 the exception to this is coastal regions from apollo bay to port phillip heads and the lakes entrance region in the east where there is either no change or a very small clockwise rotation 1 over the 40 year period changes in wave climate can have an impact on coastal morphology and beach erosion accretion based on the results in fig 9 one might expect more impacts along the coasts of western and central regions of the domain than in the eastern sections in these regions the combination of an increase in significant wave height peak wave period and a rotation of the peak wave direction may cause coastlines to evolve and realign this is largely consistent with areas where beach erosion has become an issue in recent decades leach et al 2021 4 4 extreme wave analysis extreme wave conditions were also investigated as part of this study fig 10 shows the 90th percentile the highest 10 and 99th percentile the highest 1 significant wave height the spatial distributions for both cases are very similar the 90th percentile significant wave height fig 10a shows maximum values of 5 5 m whilst the 99th percentile values fig 10b reach 7 5 m global evaluation of 90th or 99th percentile significant wave height also shows comparable magnitudes and broadly consistent spatial distributions for south east australia meucci et al 2020b young et al 2020a the extreme conditions shown in fig 10 follow a similar spatial distribution to the mean conditions in fig 7 again showing that the extremes are also influenced by the southern ocean swell mcsweeney 2020 young et al 2020a there are however some local differences in the spatial distributions of the extremes compared to mean conditions in particular the contours in the eastern part of the domain bend towards the eden area see fig 10 it is likely that this is a response to intense east coast low pressure systems that commonly occur along the south eastern australian coast dowdy et al 2019 extreme value analysis as described by eq 5 was also conducted for the model outputs of significant wave height the significant wave heights for different return periods 10 20 50 and 100 years are shown in fig 11 the spatial distributions of the extremes are similar across all return periods and are consistent with the upper percentile values in fig 10 the maximum values of extreme significant wave height in the exposed south western regions of the domain vary between 9 and 11 m depending on the return period within bass strait and the eastern parts of the domain these extreme values are reduced to approximately 6 to 7 m the results for the 100 year return period are consistent with global or southern ocean estimates based on satellite observations takbash et al 2019 young et al 2020a and ensemble datasets meucci et al 2018 takbash and young 2019 in may 2021 outside the validation period used above values of significant wave height of 9 5 m were recorded at the cape bridgewater buoy this same event resulted in 0 7 m diameter rocks being thrown up on the coastal road in the region such extreme conditions are not inconsistent with the modelled maximum h s 8 98 m at cape bridgewater over the period 1981 to 2020 4 5 impacts of southern annular mode numerous studies have investigated the correlation between wave climate and large scale interannual atmospheric climate variability cuttler et al 2020 harley et al 2010 hemer et al 2010 kumar et al 2016 marshall et al 2018 yang and oh 2020 young 1994 as previous studies have indicated the sam has an impact on wave climate in the region hemer et al 2010 marshall et al 2018 the influence of sam on wave parameters was investigated in the present study the sami time series as determined by marshall et al 2018 was downloaded from https legacy bas ac uk met gjma sam html fig 12a d shows the correlation coefficient between seasonal values of detrended significant wave height over the domain and sami consistent with the results of hemer et al 2010 and marshall et al 2018 the present data show a positive correlation between sami and significant wave height in autumn mam and winter jja fig 12c and d during spring son fig 12a there is a negative correlation summer djf fig 12b shows a negative correlation in the western parts of the domain and a positive correlation in the eastern regions correlations were also investigated without detrending the respective time series and produced results very similar to those shown in figs 12 s3 and s4 noting this the data were still detrended to ensure the potential for spurious correlations was minimized that is there is a long term positive trend in sami as there is in significant wave height fig 9a however there has also been a positive trend in both local winds and southern ocean winds hemer et al 2010 young and ribal 2019 therefore a positive correlation between long term sami and significant wave height may occur for a number of reasons not directly linked to the relationship between these variables a positive correlation in the detrended seasonal values indicates that a southern movement of the southern ocean low pressure systems is consistent with an increase in the significant wave height over the domain in winter fig 12d these low pressure systems are already at their most northerly position a further move north may increase local winds but it will reduce the effective fetch over which winds can blow hence this would result in a reduction in significant wave height conversely a movement of the low pressure systems south during winter will result in extended fetches and larger significant wave heights in summer fig 12b the low pressure systems are at their most southerly position a movement further south appears to result in them moving so far away from the southern coast of australia that the significant wave height decreases negative correlation in fig 12b these results are consistent with previous global scale studies cuttler et al 2020 harley et al 2010 hemer et al 2010 it should however be noted that the magnitudes of these correlations are relatively low absolute values generally less than 0 35 with the exception of spring fig 12a they are generally not statistically significant at the 95 level the correlation between detrended seasonal values of peak wave period and sami was also investigated see fig s3 for each of the four seasons there was a statistically significant positive correlation across most of the model domain this is not surprising and indicates that a southward movement of the southern ocean low pressure systems results in longer waves i e larger peak period across the domain this again emphasizes the dominant role of the southern ocean swell in this region furthermore the relationship between detrended peak wave direction and sami see fig s4 shows that the direction tends to shift counterclockwise when the sami is positive i e low pressure systems move south which is also consistent with previous studies cuttler et al 2020 mcsweeney 2020 5 conclusions the southern ocean remains a region where the wave climate is poorly understood in addition it is unique in that the extremely long fetches give rise to both large waves but also conditions with longer peak periods than any other oceanic basin as such the region is an interesting test of present day physics in spectral wave models such as ww3 the southern coast of australia is directly exposed to the southern ocean and tasmania bass strait and victoria represent a complex coastal region as such the modelling of these regions is an important test of finite depth model physics in this study a high resolution regional ocean wave model the ww3 model based on unstructured grids was developed to investigate the wave climate of bass strait and south east australia the model was validated against an extensive array of coastal buoy observations which shows good performance in simulating significant wave height and acceptable performance for peak wave period and peak wave direction table 2 figs 3 and 6 the wave climate of the region is a combination of southern ocean swell and local wind sea in addition the sheltering provided by tasmania means that the spatial gradients of significant wave height are significant between the exposed western regions of the domain and the more sheltered areas of bass strait as such this region is a demanding test of the physics of the wave model the wave climate of the region is largely controlled by southern ocean swell which represents the dominant waves for western victoria and western tasmania fig 7a there is a strong seasonal cycle in wave height with maximum significant wave heights in winter and minimums in summer fig 8b and d in the eastern regions of victoria the protection afforded by tasmania means that the swell direction moves to the south in winter but shifts south easterly in summer fig 8j and l which implies local winds dominate at this time of year over the period from 1981 to 2020 the significant wave height has increased by approximately 5 across the domain fig 9a this increase is a result of both an increase in the magnitude of the southern ocean swell and the local wind sea fig 9b and c during this same period there has been a small 2 counterclockwise rotation of the peak wave direction across the region extreme wave results show that the 90th 99th percentile significant wave height is approximately 5 5 m 7 5 m in the south western region of the domain fig 10 meanwhile the 100 year return period significant wave height can reach 11 m fig 11 the southern annular mode shows important impacts on wave parameters across the domain fig 12 in autumn and winter the sami is positively correlated with significant wave height indicating that southward movement of southern ocean extra tropical storm belt results in increases in significant wave height the correlation between sami and significant wave height is weaker in summer when the low pressure storm belt is at its most southern location this is consistent with a wave climate more controlled by local winds in summer fig 8b due to a lack of high resolution input data over the computational domain and 40 year hindcast period the model did not include potential impacts from wave current interaction in addition the era5 wind fields used to force the model are relatively coarse and may not adequately resolve local wind impacts these limitations may account for the observed differences between buoy and model values of peak wave period and direction in addition however limitations with accurate prediction of southern ocean wave conditions from the global model within which our regional grid is nested are clearly also an issue future studies of the region could further investigate both current and local wind impacts the present study indicates that the wave climate of the region has increased over the last 40 years largely as a result of strengthening wave conditions in the southern ocean this is associated with a long term trend to more positive values of the sami projections of global mean and extreme wave conditions hemer et al 2013 meucci et al 2020b morim et al 2019 2021 indicate this positive trend in significant wave height is projected to continue in the future as a result of global climate change as our study region is strongly impacted by southern ocean swell it is highly likely that southern australia will also experience positive trends in significant wave height and a continued counterclockwise rotation of wave direction over the 21st century this is clearly an area where future modelling of projected wave climate would be of value credit authorship contribution statement jin liu methodology software data curation writing original draft visualization writing review editing alberto meucci software writing review editing qingxiang liu data curation writing review editing alexander v babanin writing review editing daniel ierodiaconou data curation writing review editing ian r young conceptualization methodology data curation writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we acknowledge the ww3 development group for model development and providing source codes and the university of melbourne for providing the high performance computer cluster we also thank huy quang tran for sharing the combined bathymetric data wave buoy data were provided by the port of melbourne and gippsland ports wind data were provided by climate data store aodn wave data were sourced from australia s integrated marine observing system imos imos is enabled by the national collaborative research infrastructure strategy ncris wave buoy data was also provided by the victorian coastal monitoring program with funding through the department of environment land water and planning university of melbourne and deakin university see vicwaves com au jl acknowledges the support of the melbourne research scholarship provided by the university of melbourne appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ocemod 2022 101980 appendix a supplementary data the following is the supplementary material related to this article mmc s1 supplementary material shows additional model validation against buoy data and correlation with southern annular mode 
23851,on the basis of the simple ocean data assimilation soda and the ocean general circulation model for the earth simulator ofes it is surprised that a distinct seasonal variation is found in the deep vertical velocity fields of the south china sea scs in summer an upwelling band extending from the northeast to the southwest across the scs deep basin is mainly located in the interior region of the basin surrounded by the downwelling areas situated in the marginal region of the basin in winter the vertical motion is almost completely reversed which is also enhanced in its strength and transport a more extended downwelling band in winter replaces the upwelling band in summer and the upwelling occurs in the marginal region the upwelling or downwelling in the interior region of the basin is compensated by the reverse flow near the marginal basin in summer or winter maintaining the balance of the whole deep basin without water exchange the seasonal structures of potential density and potential temperature are consistent with the seasonal variation of the scs deep vertical velocity in the interior region their isolines uplift in summer and drop in winter the seasonal variation of the scs deep vertical velocity in the interior region also has a good correspondence with that of basin scale horizontal circulation the seasonal pattern of which is cyclonic in summer and anticyclonic in winter just as the vertical transports always maintain a balanced the vorticity averaged over the entire basin always remains positive and the values in winter are one order of magnitude smaller than that in summer this correspondence can be explained by the sverdrup relation the mechanism of the seasonal variation of the scs deep vertical velocity may be related to the seasonal deepwater overflow through the luzon strait keywords south china sea deep vertical velocity seasonal variation sverdrup relation 1 introduction the south china sea scs is the largest semi enclosed marginal sea of the northwestern pacific with a total area of 3 5 10 6 km 2 and an average depth of over 2000 m the scs is bounded by the asian continent philippine islands and kalimantan island with connections to the surrounding oceans through straits chu et al 1999 the luzon strait between taiwan island and luzon island connects the scs with the pacific ocean with a sill depth of about 2400 m below the deepest sill the scs is a completely isolated basin with no direct water exchange to the surrounding oceans qu et al 2006 the deepest water is confined to a bowel type trench along the northeast southwest direction with the maximum depth around 4700 m wyrtki 1961 chu and li 2000 however the water property in the deep scs indicates that the deepwater overflow through the luzon strait can affect the isolated deep basin broecker et al 1986 qu 2002 and it is important for the scs deep circulation system wang et al 2011 lan et al 2013 the scs deep vertical velocity is one of the essential components of the scs deep circulation system and it is fundamentally important for the closure of the scs meridional overturning circulation moc shu et al 2014 the deep vertical velocity serves as a carrier of vertical transport of mass and energy allen et al 2005 thomas et al 2010 ferrari 2011 and plays an important role in uptake and redistribution of heat carbon and nutrients sarmiento et al 2004 frölicher et al 2015 it also has an influence on the stratification and distribution of water masses for instance upwelling can transport the scs deep water into the intermediate layer and even affect the upper layer while downwelling is one of the sources of the scs deep water wang et al 2012 liu and gan 2017 however since the vertical velocity in deep water is too hard to measure directly it is generally estimated by numerical simulation and various indirect means the average vertical velocity w in the scs deep basin can be obtained from dividing the deep transport volume q of luzon strait by the deep area a of the scs qu et al 2006 tian et al 2006 yang et al 2010 wang et al 2012 qu et al 2006 estimated q using a hydraulic theory and gave a rough estimate of upwelling speed at 24 cm day 1 tian et al 2006 and yang et al 2010 measured q based on observations and the average upwelling velocity was estimated to be 21 cm day 1 at a depth of about 1500 m wang et al 2012 calculated the nonuniform field of vertical velocity at the base of the thermocline around the depth of 200 m isobaths by two different methods with the parameterization and the dynamic diagnosis which is on the same order of 10 6 m s 1 as ekman pumping velocity yang et al 2016 derived vertical velocity by turbulent mixing and suggested the existence of a persistent upwelling varying with depth in the scs deep water which is 32 5 cm day 1 on average comparable to the average value of 28 cm day 1 for the estimating the circulation and climate of the ocean ecco version 4 release 1 the mean value of upwelling in this relatively small basin are different in previous studies but they are on the same order of 10 6 m s 1 i e 8 64 cm day 1 qu et al 2006 wang et al 2012 yang et al 2016 while it is on the order of 0 1 cm day 1 in the open ocean kunze et al 2006 the fact suggests that the upward moving and the renewal rate of the scs deep water are much faster than that of the deep water in the open ocean due to the strong mixing in the deep scs qu et al 2006 tian et al 2009 wang et al 2011 which means that compared with the open ocean the scs deep water may have a greater impact on the upper layers and the scs deep vertical velocity may play a more important role in deep circulation system previous studies qu et al 2006 wang et al 2012 yang et al 2016 suggested an average upwelling on the order of 10 6 m s 1 in the scs deep basin taking no account of its spatial distribution and temporal variability however the nonuniform upwelling shown in observations whitworth et al 1999 and the spatial inhomogeneity in vertical diffusivity hasumi and suginohara 1999 have pointed out that upwelling is nonuniform in spatial distribution in addition it can also be speculated that seasonal variation might exist in the spatial distribution of the upwelling the scs deep circulation system is affected by the deepwater overflow through the luzon strait to some extent the deep water crosses the luzon strait from the pacific driven by a persistent baroclinic pressure gradient sinks vertically in the northern deep basin wyrtki 1961 li and qu 2006 qu et al 2006 then upwells elsewhere in the scs deep basin as a result of enhanced mixing to compensate for this sinking tian et al 2009 and controls the basin scale horizontal circulation lan et al 2013 2015 under the influence of the seasonal deepwater overflow through the luzon strait zhao et al 2014 zhou et al 2014 lan et al 2015 the scs deep horizontal circulation quite exhibits some seasonal variation features lan et al 2013 2015 and so should the scs deep vertical velocity with the development of observations and algorithms for data assimilation more feasible numerical products are provided so we can study the seasonal variation of the scs deep vertical velocity in this paper in this study the seasonal variation of the scs deep vertical velocity is examined in detail by the simple ocean data assimilation version 2 2 4 soda2 2 4 and the ocean general circulation model for the earth simulator ofes the u s navy generalized digital environment model version 3 0 gdem3 0 and the world ocean atlas 2013 woa18 are designed to validate the fidelity and results of soda2 2 4 and ofes respectively the rest of the paper is organized as follows in section 2 we present the numerical products used for describing the scs deep circulation system and validate the fidelity of these products section 3 is devoted to a detailed description for the seasonal variation of the scs deep vertical velocity in section 4 we discuss the correspondence between vertical velocity fields and horizontal velocity fields on seasonal mean finally conclusions are given in section 5 2 data and methods 2 1 data the simple ocean data assimilation version 2 2 4 soda2 2 4 is derived from the ocean data assimilation procedure and uses a general circulation model based on parallel ocean program pop physics and gfdl modular ocean model 2 code mom2 with an average 0 25 0 4 horizontal and 40 level vertical resolution assimilated data include virtually all available hydrographic profile data from mbt xbt and ctd ocean station data moored temperature and salinity measurements sea surface temperature sst and altimeter sea level carton et al 2000 the monthly mean output used in this study is mapped onto a uniform 0 5 0 5 40 level from 5 01 to 5375 m ocean general circulation model for the earth simulator ofes is developed at the geophysical fluid dynamics laboratory the national oceanic and atmospheric administration gfdl noaa based on the modular ocean model 3 code mom3 sasaki et al 2008 it achieves a high spatial resolution with horizontal resolution of 0 1 0 1 and covers a near global region ranging from 75 s to 75 n except for the arctic ocean there are 54 vertical levels with varying distances between 5 m and 6065 m the simulation results include three dimensional velocity t s two dimensional sea surface height and so on the three dimensional velocity on monthly mean for soda2 2 4 and ofes are used to examine the seasonal variation of the scs deep vertical velocity in this study the world ocean atlas 2018 woa18 is the product of the noaa national centers for environmental information ncei us calculating the decadal mean climatological field every 10 years from 1955 to 2017 garcia et al 2019 and including annual seasonal and monthly means of temperature and salinity dissolved oxygen do and other information with horizontal resolution of 5 5 1 1 and 0 25 0 25 at 102 depth levels from the surface to the sea floor 5500 m depth or at 57 depth levels from the surface to 1500 m depth locarnini et al 2019 zweng et al 2019 what we use in this study is the seasonal mean of temperature and salinity every 10 years of 1985 1994 and 1995 2004 with horizontal resolution of 0 25 0 25 at 102 depth levels the potential density and potential temperature calculated by temperature and salinity from woa18 can reflect the variation of vertical velocity and validate the results of soda2 2 4 and ofes the isobath of figures in this paper is obtained from the etopo1 global relief model integrating land topography and ocean bathymetry with 1 arc minute resolution developed by the national geophysical data center ngdc an office of the national oceanic and atmospheric administration noaa generated from diverse global and regional digital data sets it is available in ice surface top of antarctic and greenland ice sheets and bedrock base of the ice sheets versions amante and eakins 2009 the u s navy generalized digital environment model gdem is served as the u s navy s global gridded ocean temperature and salinity climatology in gdem3 0 the monthly climatology of observed temperature and salinity is distinctively truncated to three decimal places 0 001 precision the domain of which extends from 40 s to 60 n globally with a horizontal resolution of 0 25 0 25 and 78 vertical levels from surface to 6600 m observational data were gridded onto each depth surface over the entire domain and was then objectively analyzed to a standard 1 4 grid values of temperature salinity and their respective variances were calculated at all grid points and the gridded data have been generated by 4 5 million observed t s profiles dating back to 1920 which is extracted from the mater oceanographic observational data set edited at the naval research laboratory nrl the gdem3 0 has been improved greatly in comparison with its previous version 2 6 the largest change in methodology is that gdem3 0 horizontally interpolates temperature or salinity values separately at each depth level instead of fitting temperature profiles to a prescribed nonlinear function the redesigned gridding algorithm and eliminated interpolation across land boundaries describe temperature and salinity fronts much better along land the boundaries at each depth based upon statistics derived from the profile data set a gradient correction algorithm is applied to reduce the bias and improve the vertical gradients of the averaged profiles particularly in shallow waters carnes 2009 2 2 methods the data of temperature and salinity on annual mean for gdem3 0 can be used to calculate the geostrophic velocity from the gdem3 0 through the thermal wind relation 1 u u 0 g f ρ 0 z 0 z ρ y d z 2 v v 0 g f ρ 0 z 0 z ρ x d z where g is the gravitational acceleration f is the coriolis parameter ρ is the seawater potential density ρ 0 is the characteristic potential density u v is the geostrophic velocity at depth z the reference geostrophic velocity u 0 v 0 is set to be 0 at a reference level z 0 the depth of 2400 m regarded as a level of no motion wang et al 2011 gan et al 2016 the fidelity of soda2 2 4 and ofes can be validated by the geostrophic velocity calculated from the gdem3 0 based on the thermal wind relation since the geostrophic velocity on annual mean obtained from gdem3 0 has been used in the study of the scs deep circulation and validated as able to give reliable results wang et al 2011 we describe annual mean horizontal velocity fields at the depth of about 2500 m for gdem3 0 soda2 2 4 and ofes fig 1 taken as the representative to reveal the distribution characteristics of the scs deep horizontal circulation in general the scs deep layer is defined as the water layer deeper than 1500 m qu et al 2006 compared density profiles on both sides of the luzon strait and found a bifurcation at the depth of 1489 m below 1489 m water in the scs is lighter than that in the pacific which provides a persistent baroclinic pressure gradient driving the deepwater overflow from the pacific into the scs through luzon strait and driving the scs deep circulation system comparing the circulation features for gdem3 0 with that for soda2 2 4 and ofes these three velocity fields in scs deep basin have similar features it can be seen that a strong western boundary current wbc heads southwest and an eastward current flows near the southern boundary which can be considered as the western and southern branches of the basin scale cyclonic circulation respectively we further calculate the vorticity averaged over the entire basin in the three velocity fields and the values are 5 36 10 9 s 1 5 61 10 9 s 1 and 1 05 10 8 s 1 respectively which are positive and similar in magnitude it also indicates that the basin scale circulation is cyclonic the features mentioned above are in reasonable agreement with the previous studies which suggest that the most obvious features of the horizontal velocity field in scs deep basin are basin scale cyclonic circulation and western intensification li and qu 2006 qu et al 2006 wang et al 2011 lan et al 2013 the results on annual mean simulated from soda2 2 4 and ofes in the scs deep basin are consistent with the geostrophic flow obtained from gdem3 0 base on the thermal wind relation and the horizontal velocity field for gdem3 0 shown as fig 1a is similar to fig 1d of wang et al 2011 which validate the fidelity of the scs deep horizontal circulations simulated from soda2 2 4 and ofes the deep western boundary current dwbc simulated by ofes is even in good agreement with the observation of zhou et al 2017 a wavelet analysis with the non orthogonal complex morlet function torrence and compo 1998 is performed to identify the characteristics of dominant timescales of the dwbc in the scs the time series of monthly dwbc is defined here as the spatially averaged meridional velocity over the region 13 n 17 n 113 e 116 e near the west boundary of the scs deep basin at around 2500 m the global power spectrum defined as the square of the absolute wavelet transform coefficients average in time shows that there are two prominent peaks on the seasonal and intraseasonal time scales for the dwbc during the period of 1980 2008 the most significant period of oscillation is around 1 a indicating the obvious seasonal variation of the basin scale horizontal circulation in the scs deep basin lan et al 2015 the other dominant period that exceeds the 90 confidence level is about 87 6 days zhou et al 2017 observed the dwbc with an array of 6 current meter moorings during the period from august 2012 to january 2014 and found that its core velocity is 2 0 cm s and its temporal variability is dominated by intraseasonal fluctuations with the period of about 90 days which are consistent with the results obtained from ofes by averaging the vertical velocities on annual mean for soda2 2 4 and ofes over the entire scs basin the results on regional mean for the entire basin at each depth are obtained table 1 and they can represent the vertical volume transport per unit area of the scs deep basin the regional mean values of upwelling and downwelling are both on the same order of 10 6 m s 1 which is consistent with the vertical rates in previous studies qu et al 2006 wang et al 2012 yang et al 2016 at the depth of 2000 m the values for both soda and ofes show that upwelling is stronger than downwelling indicating an upward vertical volume transport which is related to the deepwater overflow through luzon strait into the scs tian et al 2009 at the depths of 2500 and 3000 m the downwelling rates are always comparable with the upwelling rates for the two products suggesting that there is a balance between the transports of upwelling and downwelling on annual mean in the scs deep basin without water exchange which satisfies the law of mass conservation in an isolated basin it can further validate the fidelity of the scs deep vertical velocity simulated from soda2 2 4 and ofes 3 the seasonal variation of scs deep vertical velocity fields 3 1 the scs deep vertical velocity in order to understand the dominant timescales of the deep vertical velocity variations in the scs wavelet analysis to the deep vertical velocity anomalies is also employed here the time series of monthly vertical velocity is spatially averaged over the region 13 n 18 n 113 e 118 e in the center of the scs deep basin at around 2500 m fig 2 shows the time period diagram of the local wavelet spectrum during the period of 1980 2008 it can be found that the most significant time scale variation of the scs deep vertical velocity for ofes is about 1 a fig 2 so does soda2 2 4 not shown here and it indicates the obvious seasonal variation of the scs deep vertical velocity the scs deep vertical velocity quite displays a distinct spatial structure and seasonal variation fig 3 shows the vertical velocity fields for soda2 2 4 and ofes on seasonal mean at the depth of 2500 m which are taken to represent the seasonal features of the scs deep vertical velocity in summer july august september there appear to be a band of upwelling extending from the northeast to the southwest across the scs deep basin and the main part of which is located in the interior region of the basin 13 n 18 n 113 e 118 e this upwelling band is surrounded by the areas of downwelling situated in the marginal region of the basin in these vertical velocity fields we further calculate the proportion of distribution areas the strengths defined by the vertical velocity on regional mean over the areas and the transports of upwelling and downwelling tables 2 and 3 based on the average of the results for soda2 2 4 and ofes the strengths of upwelling and downwelling are 3 41 10 6 m s 1 and 3 50 10 6 m s 1 in their areas which account for 52 75 and 47 25 of the total area in velocity fields table 2 respectively it can be found that the proportion of distribution area of upwelling is 5 5 larger than that of downwelling and the strength of downwelling is 9 00 10 8 m s 1 higher than that of upwelling and the transport of upwelling 1 59 sv for soda2 2 4 is slightly higher than that of downwelling 1 33 sv while the result for ofes is contrary to that for soda2 2 4 with a slightly lower upward transport of 1 39 sv and a higher downward transport of 1 40 sv in winter january february march the upward moving of the scs deep water occurs in the marginal region of the basin especially the southeast and eastern boundaries whereas the upwelling band mentioned before is replaced by a more extended band of downwelling across the basin averaged the results for soda2 2 4 and ofes in table 3 we can find that upwelling occupies a larger area accounting for 56 28 of the total area with a lower strength of 3 78 10 6 m s 1 while downwelling lies in a smaller area accounting for 43 72 with a higher strength of 4 49 10 6 m s 1 compared with the results in summer the proportion difference between the areas of upwelling and downwelling are further increased to 12 56 and the strengths of upwelling and downwelling in winter enhance by 3 70 10 7 m s 1 and 9 90 10 7 m s 1 respectively in addition the transports of upwelling and downwelling for soda2 2 4 in winter are 1 78 sv and 1 50 sv and the transports for ofes are 1 74 sv and 1 76 sv due to the little difference it can be approximately considered that the seasonal mean transports of upwelling and downwelling and their intensification are in a state of balance especially for ofes there are about 0 18 sv and 0 36 sv intensification of the vertical transports for soda2 2 4 and ofes in winter relative to the values in summer respectively the scs deep vertical velocity is significantly enhanced in winter both in strength and transport 3 2 the vertical structures of potential density and potential temperature an evident seasonal variation is also found in the vertical structures of potential density reported as σ 2 hereinafter where σ 2 1000 kg m 3 denotes potential density referenced to 2000 decibar and potential temperature also referenced to 2000 decibar along 16 n and 117 e in the deep scs below 2400 m figs 4 and 5 which can provide some evidence for the existence of vertical motion and its seasonal variation in scs deep water in order to describe the trends of potential density and potential temperature with depth more quantitatively and visually in different seasons we average the values of each section in different depth ranges from 2400 m to 3000 m from 3000 m to the bottom and from 2400 m to the bottom respectively and get the characteristic isolines in these three depth ranges the amplitude of a characteristic isoline measured as the difference between the highest and lowest depths of the same isoline is used to quantify the fluctuation of isolines here in summer the mean values of potential density along 16 n in depth ranges from 2400 m to 3000 m from 3000 m to the bottom and from 2400 m to the bottom are 36 841 36 851 and 36 846 kg m 3 respectively fig 4a the contour lines uplift between 115 e and 117 e with the maximum amplitude about 1400 m occurring in the depth range from 2500 m to 4000 m and drop east of 117 e with an almost same maximum amplitude in fig 5a the characteristic isolines along 117 e in these three depth ranges mainly uplift north of 16 n and have a maximum amplitude of over 1200 m in fig 4c the mean values along 16 n are 2 319 from 2400 m to 3000 m 2 209 from 3000 m to the bottom and 2 256 from 2400 m to the bottom c respectively and the isotherms are approximately parallel to each other at the depths shallower than 3500 m inclining upward about 200 300 m from 115 e to 118 e and downward slightly east of 118 e in the section along 117 e fig 5c the isotherms have a maximum uplifting of about 300 m north of 14 n and a dropping between 12 n and 14 n it can be seen that the isolines of potential density and potential temperature mainly uplift in the interior region of the basin 13 n 18 n 113 e 118 e and drop in the southern and eastern marginal region of the basin in winter the scs deep water has lower potential density with the maximum of about 36 87 kg m 3 fig 4b and fig 5b rather than 36 88 kg m 3 in summer fig 4a and fig 5a and higher potential temperature with characteristic isotherms varying from 2 262 to 2 331 c fig 4d and fig 5d rather than from 2 209 to 2 321 c in summer fig 4c and fig 5c in fig 4b the maximum amplitude of these three characteristic isopycnal lines is about 800 m dropping from 2600 m at 119 e to 3400 m at 116 e in the basin along 16 n in fig 5b the dropping of the isolines mainly occurs in the latitude ranges from 14 n to 18 n with the maximum amplitude of the isopycnal fluctuation of about 1000 m in terms of potential temperature the isotherms along 16 n incline downward from west to east and the maximum dropping reaches about 400 m in the depth range from 2500 m to 2900 m fig 4d at the depths from 2400 m to 3000 m the isotherms along 117 e mainly drop between 13 n and 18 n with the maximum dropping over 400 m while the dropping occurring in the depth range from 3000 m to 4000 m can even reach 1000 m fig 5d in the interior region of the basin 13 n 18 n 113 e 118 e the isoline fluctuation of potential density and potential temperature in winter is approximately opposite to that in summer 4 discussion the seasonal variation of the scs deep vertical velocity has a good correspondence with that of the horizontal circulation for the interior region in the deep scs they have the similar dominant period of about 1 a indicating that they both have obvious seasonal variation fig 2 fig 6 shows a seasonal circulation pattern in the horizontal velocity fields for soda2 2 4 and ofes at the depth of 2500 m representing the seasonal features of the scs deep horizontal circulation the major features of the scs deep horizontal circulation are seasonal basin scale gyre and western intensification fig 6 in summer when upwelling dominates the interior region of vertical velocity fields fig 3a and fig 3b there is a strong and narrow wbc heading southward near the western boundary accompanied by a wide northward current to the east of the wbc forming a basin scale cyclonic circulation located in 13 n 18 n 113 e 118 e in horizontal flow fields fig 6a and fig 6b consistent with earlier descriptions of the annual mean circulation li and qu 2006 qu et al 2006 wang et al 2011 lan et al 2013 as the downwelling occupies the interior region of vertical velocity fields in winter fig 6c and fig 6d the wbc reverses and heads northward with the southward current to the east of the wbc which forms a basin scale anticyclonic circulation in horizontal velocity fields fig 6c and fig 6d we further calculate the vorticity averaged over the entire basin in these horizontal velocity fields the values in summer for soda2 2 4 and ofes are 1 01 10 8 s 1 and 1 92 10 8 s 1 while the values in winter are also positive but one order of magnitude smaller than that in summer which are 1 36 10 9 s 1 and 2 49 10 9 s 1 there is a seasonal reversal of the basin scale circulation in horizontal flow fields but the vorticity averaged over the entire basin remains positive due to the multi eddy structure just as the seasonal spatial pattern of upwelling and downwelling in the vertical flow fields their vertical velocity is reversed but the vertical transports always maintain a balanced the good correspondence between the vertical velocity and horizontal circulation on seasonal mean in the scs deep basin can be explained by the sverdrup relation 3 β 0 v g f w z where v g and w are the velocity components for the interior region in the northward and upward directions respectively and the factor w z indicates vertical stretching the vertical motion of the scs deep water would lead to the stretching w z 0 or squeezing w z 0 of a water column which demands a change of vorticity to ensure the conservation of potential vorticity pv and the main way to change the vorticity of water mass is to adjust its planetary vorticity through a meridional advection in boreal summer the upwelling in the interior region of the scs deep basin as shown in fig 3 stretches the water column w z 0 requiring a northward advection to make sure the consistency of the left and right signs in eq 3 and in boreal winter the downwelling in the interior region makes the water column squeeze w z 0 and a southward advection are required based on the law of mass conservation and the theory of western intensification the meridional advection for the interior region is returned in a reverse wbc to complete the closure of the seasonal basin scale circulation which is consistent with the seasonal horizontal circulation pattern in fig 6 integrating the sverdrup relation eq 3 zonally and vertically we can further get 4 d z v g d z w z w d a tan ϕ where v g and w are the zonal integrals of v g and w respectively a is the earth s radius ϕ is the reference latitude z 2500 m and d is about 3000 m the meridional transport in the interior region is compensated by the reverse transport of wbc in an enclosed basin according to the conservation of mass so d z v g d z in eq 4 can be replaced by d z v w b c d z and eq 4 can be expressed as d z v w b c d z w z w d a tan ϕ on the basis of the data on seasonal mean for soda2 2 4 at around 2500 m the two sides of this equation that is the w z related term and the wbc related term are calculated in table 4 indicating the vertical transport in the interior region and the meridional transport of wbc respectively as shown in table 4 in summer the w z related term and the wbc related term reflect an upward transport of 0 90 sv in the interior region and a southward transport of 0 98 sv near the western boundary respectively while there is a downward transport of 0 33 sv in the interior region and a northward transport of 0 39 sv near the western boundary in winter respectively it can be found that the w z related term and the wbc related term are comparable in magnitude in the same season which can validate the applicability of the mass conservation and the sverdrup relation for explaining the correspondence between the vertical velocity and horizontal circulation on seasonal mean in the scs deep basin 5 summary the previous studies show that the scs upper layer circulation has significant seasonal variation chu et al 1999 qu 2000 liu et al 2001 xue et al 2004 fang et al 2009 it is surprised that a distinct seasonal variation is also found in the scs deep vertical velocity fields in this study based on the support of various numerical products and data sets in summer there is an upwelling band in northeast southwest alignment mainly located in the interior region of the basin surrounded by the downwelling areas situated in the marginal region of the basin while in winter the scs deep vertical motion is almost completely reversed with the significant enhancement of its strength and transport a more extended band of downwelling appears in the interior region replacing the upwelling band mentioned before and the upwelling occurs in the marginal region of the basin the seasonal structures of potential density and potential temperature in vertical sections can be interpreted as evidence for the seasonal variation of the scs deep vertical velocity in the interior region the isolines of potential density and potential temperature uplift in summer and drop in winter the uplifting of isolines in summer suggests that the colder and denser scs deep water upwells to the upper layers in the interior region while the dropping in winter indicates that a downwelling carries the warmer and lighter water deep into the interior basin the upwelling or downwelling in the interior region of the basin is compensated by the reverse flow near the marginal basin in summer or winter maintaining the balance of the whole deep basin it is also found that the seasonal variation of the scs deep vertical velocity has a good correspondence with that of the horizontal circulation in the interior region of the deep basin in summer the interior region of the scs deep basin is dominated by an upwelling with a horizontal basin scale cyclonic circulation while in winter both vertical and horizontal velocity are reversed and downwelling occupies the interior region accompanied with an anticyclonic circulation the vorticity averaged over the entire basin in horizontal velocity fields remains positive and the values in winter are one order of magnitude smaller than that in summer this correspondence in the interior region of the scs deep velocity fields can be explained by the sverdrup relation the water column stretching caused by vertical motion demands a meridional advection to change the vorticity so that the conservation of pv is ensured and the interior meridional advection is a part of the scs deep horizontal circulation therefore it is suggested that the seasonal reversal of vertical velocity is accompanied with the seasonal adjustment of the horizontal circulation direction we have further calculated the transports of wbc i e the west branch of the horizontal circulation and the vertical velocity in the interior region in the form of sverdrup relation integration and found they are comparable in magnitude so that the applicability of the mass conservation and the sverdrup relation for explaining the correspondence between the vertical velocity and horizontal circulation on seasonal mean in the scs deep basin can be validated it is possible that such seasonal variation of vertical velocity fields in scs deep circulation system is largely driven by the deepwater overflow through luzon strait previous studies have suggested that the deepwater overflow through the luzon strait also exhibits distinct seasonal variation zhao et al 2014 zhou et al 2014 lan et al 2015 on the basis of the results from a high resolution hybrid coordinate ocean model hycom zhao et al 2014 revealed the existence of seasonal variability of the deepwater overflow with its maximum transport in winter and minimum transport in summer lan et al 2015 also used hycom as the control run to examined the seasonal variation of the deepwater overflow and the volume transport intensified in september to november and weakened in march to may as shown by the blue line in fig 4 of lan et al 2015 the 3 5 yr of continuous mooring observations conducted in the deep bashi channel and luzon trough is the existing longest direct measurement of the deepwater overflow through the luzon strait according to the observations zhou et al 2014 indicated that the deepwater overflow attained its seasonal maximum in late fall october december and its seasonal minimum in spring march may they also found that the density difference between two sides of the luzon strait is larger in winter possibly resulting in a stronger deepwater overflow than in summer based on pv integral constraints yang and price 2000 the seasonal deepwater overflow through the luzon strait can cause the change of the pv flux in the scs deep basin leading to the seasonal variation of the scs deep horizontal circulation and vertical motion lan et al 2015 wang et al 2019 in addition this seasonal variation in the deep scs may also be associated with internal ocean dynamics such as surface mesoscale ocean eddies topographic rossby waves and so on upper oceanic eddies can trigger bottom trapped topography rossby waves on the slope resulting in strong mixing and driving horizontal circulation and vertical motion in the scs deep basin chen et al 2015 shu et al 2016 wang et al 2019 which brings the seasonal variation of the upper layer to the deep layer what and how influencing factors contribute to the seasonal variation of the scs deep vertical velocity is still an interesting issue to address and we will leave it for future studies credit authorship contribution statement jiaqian li data curation investigation software visualization writing original draft writing review editing jian lan conceptualization supervision validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors wish to thank the two anonymous reviewers for their comments that helped to improve the manuscript this work was supported by the national natural science foundation of china grants 42076003 and 41676001 the authors are thankful for the data support from the department of atmospheric and oceanic science at the university of maryland the applications laboratory apl at jamstec the u s naval research laboratory the national centers for environmental information ncei of noaa the asia pacific data research center at the university of hawaii and the esme workbench software of boston university data used in this study can be downloaded from the following soda2 2 4 reanalysis data is obtained from http www atmos umd edu ocean the ofes simulation is conducted on the earth simulator under the support of jamstec and available from http apdrc soest hawaii edu datadoc ofes ncep 0 1 global mmean php the gdem3 0 can be accessed via https esme bu edu download woa18 data set can be found from https www ncei noaa gov data oceans woa woa18 and the etopo1 global relief model is provided by https www ngdc noaa gov mgg global 
23851,on the basis of the simple ocean data assimilation soda and the ocean general circulation model for the earth simulator ofes it is surprised that a distinct seasonal variation is found in the deep vertical velocity fields of the south china sea scs in summer an upwelling band extending from the northeast to the southwest across the scs deep basin is mainly located in the interior region of the basin surrounded by the downwelling areas situated in the marginal region of the basin in winter the vertical motion is almost completely reversed which is also enhanced in its strength and transport a more extended downwelling band in winter replaces the upwelling band in summer and the upwelling occurs in the marginal region the upwelling or downwelling in the interior region of the basin is compensated by the reverse flow near the marginal basin in summer or winter maintaining the balance of the whole deep basin without water exchange the seasonal structures of potential density and potential temperature are consistent with the seasonal variation of the scs deep vertical velocity in the interior region their isolines uplift in summer and drop in winter the seasonal variation of the scs deep vertical velocity in the interior region also has a good correspondence with that of basin scale horizontal circulation the seasonal pattern of which is cyclonic in summer and anticyclonic in winter just as the vertical transports always maintain a balanced the vorticity averaged over the entire basin always remains positive and the values in winter are one order of magnitude smaller than that in summer this correspondence can be explained by the sverdrup relation the mechanism of the seasonal variation of the scs deep vertical velocity may be related to the seasonal deepwater overflow through the luzon strait keywords south china sea deep vertical velocity seasonal variation sverdrup relation 1 introduction the south china sea scs is the largest semi enclosed marginal sea of the northwestern pacific with a total area of 3 5 10 6 km 2 and an average depth of over 2000 m the scs is bounded by the asian continent philippine islands and kalimantan island with connections to the surrounding oceans through straits chu et al 1999 the luzon strait between taiwan island and luzon island connects the scs with the pacific ocean with a sill depth of about 2400 m below the deepest sill the scs is a completely isolated basin with no direct water exchange to the surrounding oceans qu et al 2006 the deepest water is confined to a bowel type trench along the northeast southwest direction with the maximum depth around 4700 m wyrtki 1961 chu and li 2000 however the water property in the deep scs indicates that the deepwater overflow through the luzon strait can affect the isolated deep basin broecker et al 1986 qu 2002 and it is important for the scs deep circulation system wang et al 2011 lan et al 2013 the scs deep vertical velocity is one of the essential components of the scs deep circulation system and it is fundamentally important for the closure of the scs meridional overturning circulation moc shu et al 2014 the deep vertical velocity serves as a carrier of vertical transport of mass and energy allen et al 2005 thomas et al 2010 ferrari 2011 and plays an important role in uptake and redistribution of heat carbon and nutrients sarmiento et al 2004 frölicher et al 2015 it also has an influence on the stratification and distribution of water masses for instance upwelling can transport the scs deep water into the intermediate layer and even affect the upper layer while downwelling is one of the sources of the scs deep water wang et al 2012 liu and gan 2017 however since the vertical velocity in deep water is too hard to measure directly it is generally estimated by numerical simulation and various indirect means the average vertical velocity w in the scs deep basin can be obtained from dividing the deep transport volume q of luzon strait by the deep area a of the scs qu et al 2006 tian et al 2006 yang et al 2010 wang et al 2012 qu et al 2006 estimated q using a hydraulic theory and gave a rough estimate of upwelling speed at 24 cm day 1 tian et al 2006 and yang et al 2010 measured q based on observations and the average upwelling velocity was estimated to be 21 cm day 1 at a depth of about 1500 m wang et al 2012 calculated the nonuniform field of vertical velocity at the base of the thermocline around the depth of 200 m isobaths by two different methods with the parameterization and the dynamic diagnosis which is on the same order of 10 6 m s 1 as ekman pumping velocity yang et al 2016 derived vertical velocity by turbulent mixing and suggested the existence of a persistent upwelling varying with depth in the scs deep water which is 32 5 cm day 1 on average comparable to the average value of 28 cm day 1 for the estimating the circulation and climate of the ocean ecco version 4 release 1 the mean value of upwelling in this relatively small basin are different in previous studies but they are on the same order of 10 6 m s 1 i e 8 64 cm day 1 qu et al 2006 wang et al 2012 yang et al 2016 while it is on the order of 0 1 cm day 1 in the open ocean kunze et al 2006 the fact suggests that the upward moving and the renewal rate of the scs deep water are much faster than that of the deep water in the open ocean due to the strong mixing in the deep scs qu et al 2006 tian et al 2009 wang et al 2011 which means that compared with the open ocean the scs deep water may have a greater impact on the upper layers and the scs deep vertical velocity may play a more important role in deep circulation system previous studies qu et al 2006 wang et al 2012 yang et al 2016 suggested an average upwelling on the order of 10 6 m s 1 in the scs deep basin taking no account of its spatial distribution and temporal variability however the nonuniform upwelling shown in observations whitworth et al 1999 and the spatial inhomogeneity in vertical diffusivity hasumi and suginohara 1999 have pointed out that upwelling is nonuniform in spatial distribution in addition it can also be speculated that seasonal variation might exist in the spatial distribution of the upwelling the scs deep circulation system is affected by the deepwater overflow through the luzon strait to some extent the deep water crosses the luzon strait from the pacific driven by a persistent baroclinic pressure gradient sinks vertically in the northern deep basin wyrtki 1961 li and qu 2006 qu et al 2006 then upwells elsewhere in the scs deep basin as a result of enhanced mixing to compensate for this sinking tian et al 2009 and controls the basin scale horizontal circulation lan et al 2013 2015 under the influence of the seasonal deepwater overflow through the luzon strait zhao et al 2014 zhou et al 2014 lan et al 2015 the scs deep horizontal circulation quite exhibits some seasonal variation features lan et al 2013 2015 and so should the scs deep vertical velocity with the development of observations and algorithms for data assimilation more feasible numerical products are provided so we can study the seasonal variation of the scs deep vertical velocity in this paper in this study the seasonal variation of the scs deep vertical velocity is examined in detail by the simple ocean data assimilation version 2 2 4 soda2 2 4 and the ocean general circulation model for the earth simulator ofes the u s navy generalized digital environment model version 3 0 gdem3 0 and the world ocean atlas 2013 woa18 are designed to validate the fidelity and results of soda2 2 4 and ofes respectively the rest of the paper is organized as follows in section 2 we present the numerical products used for describing the scs deep circulation system and validate the fidelity of these products section 3 is devoted to a detailed description for the seasonal variation of the scs deep vertical velocity in section 4 we discuss the correspondence between vertical velocity fields and horizontal velocity fields on seasonal mean finally conclusions are given in section 5 2 data and methods 2 1 data the simple ocean data assimilation version 2 2 4 soda2 2 4 is derived from the ocean data assimilation procedure and uses a general circulation model based on parallel ocean program pop physics and gfdl modular ocean model 2 code mom2 with an average 0 25 0 4 horizontal and 40 level vertical resolution assimilated data include virtually all available hydrographic profile data from mbt xbt and ctd ocean station data moored temperature and salinity measurements sea surface temperature sst and altimeter sea level carton et al 2000 the monthly mean output used in this study is mapped onto a uniform 0 5 0 5 40 level from 5 01 to 5375 m ocean general circulation model for the earth simulator ofes is developed at the geophysical fluid dynamics laboratory the national oceanic and atmospheric administration gfdl noaa based on the modular ocean model 3 code mom3 sasaki et al 2008 it achieves a high spatial resolution with horizontal resolution of 0 1 0 1 and covers a near global region ranging from 75 s to 75 n except for the arctic ocean there are 54 vertical levels with varying distances between 5 m and 6065 m the simulation results include three dimensional velocity t s two dimensional sea surface height and so on the three dimensional velocity on monthly mean for soda2 2 4 and ofes are used to examine the seasonal variation of the scs deep vertical velocity in this study the world ocean atlas 2018 woa18 is the product of the noaa national centers for environmental information ncei us calculating the decadal mean climatological field every 10 years from 1955 to 2017 garcia et al 2019 and including annual seasonal and monthly means of temperature and salinity dissolved oxygen do and other information with horizontal resolution of 5 5 1 1 and 0 25 0 25 at 102 depth levels from the surface to the sea floor 5500 m depth or at 57 depth levels from the surface to 1500 m depth locarnini et al 2019 zweng et al 2019 what we use in this study is the seasonal mean of temperature and salinity every 10 years of 1985 1994 and 1995 2004 with horizontal resolution of 0 25 0 25 at 102 depth levels the potential density and potential temperature calculated by temperature and salinity from woa18 can reflect the variation of vertical velocity and validate the results of soda2 2 4 and ofes the isobath of figures in this paper is obtained from the etopo1 global relief model integrating land topography and ocean bathymetry with 1 arc minute resolution developed by the national geophysical data center ngdc an office of the national oceanic and atmospheric administration noaa generated from diverse global and regional digital data sets it is available in ice surface top of antarctic and greenland ice sheets and bedrock base of the ice sheets versions amante and eakins 2009 the u s navy generalized digital environment model gdem is served as the u s navy s global gridded ocean temperature and salinity climatology in gdem3 0 the monthly climatology of observed temperature and salinity is distinctively truncated to three decimal places 0 001 precision the domain of which extends from 40 s to 60 n globally with a horizontal resolution of 0 25 0 25 and 78 vertical levels from surface to 6600 m observational data were gridded onto each depth surface over the entire domain and was then objectively analyzed to a standard 1 4 grid values of temperature salinity and their respective variances were calculated at all grid points and the gridded data have been generated by 4 5 million observed t s profiles dating back to 1920 which is extracted from the mater oceanographic observational data set edited at the naval research laboratory nrl the gdem3 0 has been improved greatly in comparison with its previous version 2 6 the largest change in methodology is that gdem3 0 horizontally interpolates temperature or salinity values separately at each depth level instead of fitting temperature profiles to a prescribed nonlinear function the redesigned gridding algorithm and eliminated interpolation across land boundaries describe temperature and salinity fronts much better along land the boundaries at each depth based upon statistics derived from the profile data set a gradient correction algorithm is applied to reduce the bias and improve the vertical gradients of the averaged profiles particularly in shallow waters carnes 2009 2 2 methods the data of temperature and salinity on annual mean for gdem3 0 can be used to calculate the geostrophic velocity from the gdem3 0 through the thermal wind relation 1 u u 0 g f ρ 0 z 0 z ρ y d z 2 v v 0 g f ρ 0 z 0 z ρ x d z where g is the gravitational acceleration f is the coriolis parameter ρ is the seawater potential density ρ 0 is the characteristic potential density u v is the geostrophic velocity at depth z the reference geostrophic velocity u 0 v 0 is set to be 0 at a reference level z 0 the depth of 2400 m regarded as a level of no motion wang et al 2011 gan et al 2016 the fidelity of soda2 2 4 and ofes can be validated by the geostrophic velocity calculated from the gdem3 0 based on the thermal wind relation since the geostrophic velocity on annual mean obtained from gdem3 0 has been used in the study of the scs deep circulation and validated as able to give reliable results wang et al 2011 we describe annual mean horizontal velocity fields at the depth of about 2500 m for gdem3 0 soda2 2 4 and ofes fig 1 taken as the representative to reveal the distribution characteristics of the scs deep horizontal circulation in general the scs deep layer is defined as the water layer deeper than 1500 m qu et al 2006 compared density profiles on both sides of the luzon strait and found a bifurcation at the depth of 1489 m below 1489 m water in the scs is lighter than that in the pacific which provides a persistent baroclinic pressure gradient driving the deepwater overflow from the pacific into the scs through luzon strait and driving the scs deep circulation system comparing the circulation features for gdem3 0 with that for soda2 2 4 and ofes these three velocity fields in scs deep basin have similar features it can be seen that a strong western boundary current wbc heads southwest and an eastward current flows near the southern boundary which can be considered as the western and southern branches of the basin scale cyclonic circulation respectively we further calculate the vorticity averaged over the entire basin in the three velocity fields and the values are 5 36 10 9 s 1 5 61 10 9 s 1 and 1 05 10 8 s 1 respectively which are positive and similar in magnitude it also indicates that the basin scale circulation is cyclonic the features mentioned above are in reasonable agreement with the previous studies which suggest that the most obvious features of the horizontal velocity field in scs deep basin are basin scale cyclonic circulation and western intensification li and qu 2006 qu et al 2006 wang et al 2011 lan et al 2013 the results on annual mean simulated from soda2 2 4 and ofes in the scs deep basin are consistent with the geostrophic flow obtained from gdem3 0 base on the thermal wind relation and the horizontal velocity field for gdem3 0 shown as fig 1a is similar to fig 1d of wang et al 2011 which validate the fidelity of the scs deep horizontal circulations simulated from soda2 2 4 and ofes the deep western boundary current dwbc simulated by ofes is even in good agreement with the observation of zhou et al 2017 a wavelet analysis with the non orthogonal complex morlet function torrence and compo 1998 is performed to identify the characteristics of dominant timescales of the dwbc in the scs the time series of monthly dwbc is defined here as the spatially averaged meridional velocity over the region 13 n 17 n 113 e 116 e near the west boundary of the scs deep basin at around 2500 m the global power spectrum defined as the square of the absolute wavelet transform coefficients average in time shows that there are two prominent peaks on the seasonal and intraseasonal time scales for the dwbc during the period of 1980 2008 the most significant period of oscillation is around 1 a indicating the obvious seasonal variation of the basin scale horizontal circulation in the scs deep basin lan et al 2015 the other dominant period that exceeds the 90 confidence level is about 87 6 days zhou et al 2017 observed the dwbc with an array of 6 current meter moorings during the period from august 2012 to january 2014 and found that its core velocity is 2 0 cm s and its temporal variability is dominated by intraseasonal fluctuations with the period of about 90 days which are consistent with the results obtained from ofes by averaging the vertical velocities on annual mean for soda2 2 4 and ofes over the entire scs basin the results on regional mean for the entire basin at each depth are obtained table 1 and they can represent the vertical volume transport per unit area of the scs deep basin the regional mean values of upwelling and downwelling are both on the same order of 10 6 m s 1 which is consistent with the vertical rates in previous studies qu et al 2006 wang et al 2012 yang et al 2016 at the depth of 2000 m the values for both soda and ofes show that upwelling is stronger than downwelling indicating an upward vertical volume transport which is related to the deepwater overflow through luzon strait into the scs tian et al 2009 at the depths of 2500 and 3000 m the downwelling rates are always comparable with the upwelling rates for the two products suggesting that there is a balance between the transports of upwelling and downwelling on annual mean in the scs deep basin without water exchange which satisfies the law of mass conservation in an isolated basin it can further validate the fidelity of the scs deep vertical velocity simulated from soda2 2 4 and ofes 3 the seasonal variation of scs deep vertical velocity fields 3 1 the scs deep vertical velocity in order to understand the dominant timescales of the deep vertical velocity variations in the scs wavelet analysis to the deep vertical velocity anomalies is also employed here the time series of monthly vertical velocity is spatially averaged over the region 13 n 18 n 113 e 118 e in the center of the scs deep basin at around 2500 m fig 2 shows the time period diagram of the local wavelet spectrum during the period of 1980 2008 it can be found that the most significant time scale variation of the scs deep vertical velocity for ofes is about 1 a fig 2 so does soda2 2 4 not shown here and it indicates the obvious seasonal variation of the scs deep vertical velocity the scs deep vertical velocity quite displays a distinct spatial structure and seasonal variation fig 3 shows the vertical velocity fields for soda2 2 4 and ofes on seasonal mean at the depth of 2500 m which are taken to represent the seasonal features of the scs deep vertical velocity in summer july august september there appear to be a band of upwelling extending from the northeast to the southwest across the scs deep basin and the main part of which is located in the interior region of the basin 13 n 18 n 113 e 118 e this upwelling band is surrounded by the areas of downwelling situated in the marginal region of the basin in these vertical velocity fields we further calculate the proportion of distribution areas the strengths defined by the vertical velocity on regional mean over the areas and the transports of upwelling and downwelling tables 2 and 3 based on the average of the results for soda2 2 4 and ofes the strengths of upwelling and downwelling are 3 41 10 6 m s 1 and 3 50 10 6 m s 1 in their areas which account for 52 75 and 47 25 of the total area in velocity fields table 2 respectively it can be found that the proportion of distribution area of upwelling is 5 5 larger than that of downwelling and the strength of downwelling is 9 00 10 8 m s 1 higher than that of upwelling and the transport of upwelling 1 59 sv for soda2 2 4 is slightly higher than that of downwelling 1 33 sv while the result for ofes is contrary to that for soda2 2 4 with a slightly lower upward transport of 1 39 sv and a higher downward transport of 1 40 sv in winter january february march the upward moving of the scs deep water occurs in the marginal region of the basin especially the southeast and eastern boundaries whereas the upwelling band mentioned before is replaced by a more extended band of downwelling across the basin averaged the results for soda2 2 4 and ofes in table 3 we can find that upwelling occupies a larger area accounting for 56 28 of the total area with a lower strength of 3 78 10 6 m s 1 while downwelling lies in a smaller area accounting for 43 72 with a higher strength of 4 49 10 6 m s 1 compared with the results in summer the proportion difference between the areas of upwelling and downwelling are further increased to 12 56 and the strengths of upwelling and downwelling in winter enhance by 3 70 10 7 m s 1 and 9 90 10 7 m s 1 respectively in addition the transports of upwelling and downwelling for soda2 2 4 in winter are 1 78 sv and 1 50 sv and the transports for ofes are 1 74 sv and 1 76 sv due to the little difference it can be approximately considered that the seasonal mean transports of upwelling and downwelling and their intensification are in a state of balance especially for ofes there are about 0 18 sv and 0 36 sv intensification of the vertical transports for soda2 2 4 and ofes in winter relative to the values in summer respectively the scs deep vertical velocity is significantly enhanced in winter both in strength and transport 3 2 the vertical structures of potential density and potential temperature an evident seasonal variation is also found in the vertical structures of potential density reported as σ 2 hereinafter where σ 2 1000 kg m 3 denotes potential density referenced to 2000 decibar and potential temperature also referenced to 2000 decibar along 16 n and 117 e in the deep scs below 2400 m figs 4 and 5 which can provide some evidence for the existence of vertical motion and its seasonal variation in scs deep water in order to describe the trends of potential density and potential temperature with depth more quantitatively and visually in different seasons we average the values of each section in different depth ranges from 2400 m to 3000 m from 3000 m to the bottom and from 2400 m to the bottom respectively and get the characteristic isolines in these three depth ranges the amplitude of a characteristic isoline measured as the difference between the highest and lowest depths of the same isoline is used to quantify the fluctuation of isolines here in summer the mean values of potential density along 16 n in depth ranges from 2400 m to 3000 m from 3000 m to the bottom and from 2400 m to the bottom are 36 841 36 851 and 36 846 kg m 3 respectively fig 4a the contour lines uplift between 115 e and 117 e with the maximum amplitude about 1400 m occurring in the depth range from 2500 m to 4000 m and drop east of 117 e with an almost same maximum amplitude in fig 5a the characteristic isolines along 117 e in these three depth ranges mainly uplift north of 16 n and have a maximum amplitude of over 1200 m in fig 4c the mean values along 16 n are 2 319 from 2400 m to 3000 m 2 209 from 3000 m to the bottom and 2 256 from 2400 m to the bottom c respectively and the isotherms are approximately parallel to each other at the depths shallower than 3500 m inclining upward about 200 300 m from 115 e to 118 e and downward slightly east of 118 e in the section along 117 e fig 5c the isotherms have a maximum uplifting of about 300 m north of 14 n and a dropping between 12 n and 14 n it can be seen that the isolines of potential density and potential temperature mainly uplift in the interior region of the basin 13 n 18 n 113 e 118 e and drop in the southern and eastern marginal region of the basin in winter the scs deep water has lower potential density with the maximum of about 36 87 kg m 3 fig 4b and fig 5b rather than 36 88 kg m 3 in summer fig 4a and fig 5a and higher potential temperature with characteristic isotherms varying from 2 262 to 2 331 c fig 4d and fig 5d rather than from 2 209 to 2 321 c in summer fig 4c and fig 5c in fig 4b the maximum amplitude of these three characteristic isopycnal lines is about 800 m dropping from 2600 m at 119 e to 3400 m at 116 e in the basin along 16 n in fig 5b the dropping of the isolines mainly occurs in the latitude ranges from 14 n to 18 n with the maximum amplitude of the isopycnal fluctuation of about 1000 m in terms of potential temperature the isotherms along 16 n incline downward from west to east and the maximum dropping reaches about 400 m in the depth range from 2500 m to 2900 m fig 4d at the depths from 2400 m to 3000 m the isotherms along 117 e mainly drop between 13 n and 18 n with the maximum dropping over 400 m while the dropping occurring in the depth range from 3000 m to 4000 m can even reach 1000 m fig 5d in the interior region of the basin 13 n 18 n 113 e 118 e the isoline fluctuation of potential density and potential temperature in winter is approximately opposite to that in summer 4 discussion the seasonal variation of the scs deep vertical velocity has a good correspondence with that of the horizontal circulation for the interior region in the deep scs they have the similar dominant period of about 1 a indicating that they both have obvious seasonal variation fig 2 fig 6 shows a seasonal circulation pattern in the horizontal velocity fields for soda2 2 4 and ofes at the depth of 2500 m representing the seasonal features of the scs deep horizontal circulation the major features of the scs deep horizontal circulation are seasonal basin scale gyre and western intensification fig 6 in summer when upwelling dominates the interior region of vertical velocity fields fig 3a and fig 3b there is a strong and narrow wbc heading southward near the western boundary accompanied by a wide northward current to the east of the wbc forming a basin scale cyclonic circulation located in 13 n 18 n 113 e 118 e in horizontal flow fields fig 6a and fig 6b consistent with earlier descriptions of the annual mean circulation li and qu 2006 qu et al 2006 wang et al 2011 lan et al 2013 as the downwelling occupies the interior region of vertical velocity fields in winter fig 6c and fig 6d the wbc reverses and heads northward with the southward current to the east of the wbc which forms a basin scale anticyclonic circulation in horizontal velocity fields fig 6c and fig 6d we further calculate the vorticity averaged over the entire basin in these horizontal velocity fields the values in summer for soda2 2 4 and ofes are 1 01 10 8 s 1 and 1 92 10 8 s 1 while the values in winter are also positive but one order of magnitude smaller than that in summer which are 1 36 10 9 s 1 and 2 49 10 9 s 1 there is a seasonal reversal of the basin scale circulation in horizontal flow fields but the vorticity averaged over the entire basin remains positive due to the multi eddy structure just as the seasonal spatial pattern of upwelling and downwelling in the vertical flow fields their vertical velocity is reversed but the vertical transports always maintain a balanced the good correspondence between the vertical velocity and horizontal circulation on seasonal mean in the scs deep basin can be explained by the sverdrup relation 3 β 0 v g f w z where v g and w are the velocity components for the interior region in the northward and upward directions respectively and the factor w z indicates vertical stretching the vertical motion of the scs deep water would lead to the stretching w z 0 or squeezing w z 0 of a water column which demands a change of vorticity to ensure the conservation of potential vorticity pv and the main way to change the vorticity of water mass is to adjust its planetary vorticity through a meridional advection in boreal summer the upwelling in the interior region of the scs deep basin as shown in fig 3 stretches the water column w z 0 requiring a northward advection to make sure the consistency of the left and right signs in eq 3 and in boreal winter the downwelling in the interior region makes the water column squeeze w z 0 and a southward advection are required based on the law of mass conservation and the theory of western intensification the meridional advection for the interior region is returned in a reverse wbc to complete the closure of the seasonal basin scale circulation which is consistent with the seasonal horizontal circulation pattern in fig 6 integrating the sverdrup relation eq 3 zonally and vertically we can further get 4 d z v g d z w z w d a tan ϕ where v g and w are the zonal integrals of v g and w respectively a is the earth s radius ϕ is the reference latitude z 2500 m and d is about 3000 m the meridional transport in the interior region is compensated by the reverse transport of wbc in an enclosed basin according to the conservation of mass so d z v g d z in eq 4 can be replaced by d z v w b c d z and eq 4 can be expressed as d z v w b c d z w z w d a tan ϕ on the basis of the data on seasonal mean for soda2 2 4 at around 2500 m the two sides of this equation that is the w z related term and the wbc related term are calculated in table 4 indicating the vertical transport in the interior region and the meridional transport of wbc respectively as shown in table 4 in summer the w z related term and the wbc related term reflect an upward transport of 0 90 sv in the interior region and a southward transport of 0 98 sv near the western boundary respectively while there is a downward transport of 0 33 sv in the interior region and a northward transport of 0 39 sv near the western boundary in winter respectively it can be found that the w z related term and the wbc related term are comparable in magnitude in the same season which can validate the applicability of the mass conservation and the sverdrup relation for explaining the correspondence between the vertical velocity and horizontal circulation on seasonal mean in the scs deep basin 5 summary the previous studies show that the scs upper layer circulation has significant seasonal variation chu et al 1999 qu 2000 liu et al 2001 xue et al 2004 fang et al 2009 it is surprised that a distinct seasonal variation is also found in the scs deep vertical velocity fields in this study based on the support of various numerical products and data sets in summer there is an upwelling band in northeast southwest alignment mainly located in the interior region of the basin surrounded by the downwelling areas situated in the marginal region of the basin while in winter the scs deep vertical motion is almost completely reversed with the significant enhancement of its strength and transport a more extended band of downwelling appears in the interior region replacing the upwelling band mentioned before and the upwelling occurs in the marginal region of the basin the seasonal structures of potential density and potential temperature in vertical sections can be interpreted as evidence for the seasonal variation of the scs deep vertical velocity in the interior region the isolines of potential density and potential temperature uplift in summer and drop in winter the uplifting of isolines in summer suggests that the colder and denser scs deep water upwells to the upper layers in the interior region while the dropping in winter indicates that a downwelling carries the warmer and lighter water deep into the interior basin the upwelling or downwelling in the interior region of the basin is compensated by the reverse flow near the marginal basin in summer or winter maintaining the balance of the whole deep basin it is also found that the seasonal variation of the scs deep vertical velocity has a good correspondence with that of the horizontal circulation in the interior region of the deep basin in summer the interior region of the scs deep basin is dominated by an upwelling with a horizontal basin scale cyclonic circulation while in winter both vertical and horizontal velocity are reversed and downwelling occupies the interior region accompanied with an anticyclonic circulation the vorticity averaged over the entire basin in horizontal velocity fields remains positive and the values in winter are one order of magnitude smaller than that in summer this correspondence in the interior region of the scs deep velocity fields can be explained by the sverdrup relation the water column stretching caused by vertical motion demands a meridional advection to change the vorticity so that the conservation of pv is ensured and the interior meridional advection is a part of the scs deep horizontal circulation therefore it is suggested that the seasonal reversal of vertical velocity is accompanied with the seasonal adjustment of the horizontal circulation direction we have further calculated the transports of wbc i e the west branch of the horizontal circulation and the vertical velocity in the interior region in the form of sverdrup relation integration and found they are comparable in magnitude so that the applicability of the mass conservation and the sverdrup relation for explaining the correspondence between the vertical velocity and horizontal circulation on seasonal mean in the scs deep basin can be validated it is possible that such seasonal variation of vertical velocity fields in scs deep circulation system is largely driven by the deepwater overflow through luzon strait previous studies have suggested that the deepwater overflow through the luzon strait also exhibits distinct seasonal variation zhao et al 2014 zhou et al 2014 lan et al 2015 on the basis of the results from a high resolution hybrid coordinate ocean model hycom zhao et al 2014 revealed the existence of seasonal variability of the deepwater overflow with its maximum transport in winter and minimum transport in summer lan et al 2015 also used hycom as the control run to examined the seasonal variation of the deepwater overflow and the volume transport intensified in september to november and weakened in march to may as shown by the blue line in fig 4 of lan et al 2015 the 3 5 yr of continuous mooring observations conducted in the deep bashi channel and luzon trough is the existing longest direct measurement of the deepwater overflow through the luzon strait according to the observations zhou et al 2014 indicated that the deepwater overflow attained its seasonal maximum in late fall october december and its seasonal minimum in spring march may they also found that the density difference between two sides of the luzon strait is larger in winter possibly resulting in a stronger deepwater overflow than in summer based on pv integral constraints yang and price 2000 the seasonal deepwater overflow through the luzon strait can cause the change of the pv flux in the scs deep basin leading to the seasonal variation of the scs deep horizontal circulation and vertical motion lan et al 2015 wang et al 2019 in addition this seasonal variation in the deep scs may also be associated with internal ocean dynamics such as surface mesoscale ocean eddies topographic rossby waves and so on upper oceanic eddies can trigger bottom trapped topography rossby waves on the slope resulting in strong mixing and driving horizontal circulation and vertical motion in the scs deep basin chen et al 2015 shu et al 2016 wang et al 2019 which brings the seasonal variation of the upper layer to the deep layer what and how influencing factors contribute to the seasonal variation of the scs deep vertical velocity is still an interesting issue to address and we will leave it for future studies credit authorship contribution statement jiaqian li data curation investigation software visualization writing original draft writing review editing jian lan conceptualization supervision validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors wish to thank the two anonymous reviewers for their comments that helped to improve the manuscript this work was supported by the national natural science foundation of china grants 42076003 and 41676001 the authors are thankful for the data support from the department of atmospheric and oceanic science at the university of maryland the applications laboratory apl at jamstec the u s naval research laboratory the national centers for environmental information ncei of noaa the asia pacific data research center at the university of hawaii and the esme workbench software of boston university data used in this study can be downloaded from the following soda2 2 4 reanalysis data is obtained from http www atmos umd edu ocean the ofes simulation is conducted on the earth simulator under the support of jamstec and available from http apdrc soest hawaii edu datadoc ofes ncep 0 1 global mmean php the gdem3 0 can be accessed via https esme bu edu download woa18 data set can be found from https www ncei noaa gov data oceans woa woa18 and the etopo1 global relief model is provided by https www ngdc noaa gov mgg global 
23852,mesoscale eddy features are found ubiquitously throughout the world s oceans many needs exist for numerical products from operational oceanographic systems to provide information on eddy properties while numerous eddy identification and tracking methods have been developed for oceanic eddies specific methods and metrics tailored to verify the skill of ocean analyses and forecasts in capturing these features are lacking here we introduce a novel feature based verification methodology for operational oceanographic systems this methodology builds on previous efforts at eddy tracking and applies open source software to provide a robust method to evaluate the skill of operational oceanographic systems in terms of representing observed eddies we demonstrate that an eddy tracking methodology can discern clear improvements in analyses produced using a regional analysis system riops 1 12 grid resolution over a global system giops 1 4 grid resolution for eddies with amplitudes greater than 10 cm riops has a probability of detection 10 30 higher than giops with a false alarm ratio 5 10 lower a significant improvement in the spatial properties of simulated eddies in riops is also found in particular results show a marked improvement in radius and separation distance errors by 25 and 21 respectively with fewer occurrences of errors above 20 km in radius and 40 km in separation distance this basic demonstration opens the door for a more detailed examination of eddy features in ocean prediction systems keywords mesoscale eddies feature based verification gulf stream riops giops operational oceanography 1 introduction mesoscale eddy features are found ubiquitously throughout the world s oceans these features have spatial scales of 25 100 km and help maintain the ocean general circulation and climate mcwilliams 2008 eddies form coherent vortices that transport physical and biogeochemical tracers trapped in their cores lee et al 1997 zhang et al 2014 eddies also affect the curl of the surface stress driving vertical velocities that can bring deeper nutrients to the upper ocean where photosynthesis may occur frenger et al 2013 information on eddy properties as simulated by operational oceanographic numerical prediction systems is needed for many applications eddies affect the surface currents with impacts on search and rescue efforts davidson et al 2009 environmental emergency response e g oil spill feng et al 2019 biogeochemical tracers chelton et al 2011a route optimization for marine transportation yang et al 2020 and other drift applications such as for micro plastics brach et al 2018 the sub surface signature of eddies may affect acoustic propagation and range detection for naval and other applications heaney and campbell 2016 knowledge of the location of eddies could also be used for targeted fisheries arur et al 2020 the presence of warm cold core eddies has also been shown to have an impact on tropical cyclone intensification wu et al 2007 jaimes and shay 2009 wang et al 2018 as many operational numerical weather prediction centres are now moving towards coupled atmosphere ocean forecasting systems smith et al 2018 guiavarc h et al 2019 the accurate representation of eddies will also have an impact on weather forecasts in this study we aim to address the question of what is the current capacity of operational oceanographic prediction systems to capture observed eddy features two operational systems from the canadian centre for meteorological and environmental prediction ccmep of different resolutions are evaluated against a commonly used observational product using the open source eddy tracking package of mason et al 2014 these systems are the global ice ocean prediction system giops smith et al 2016 an eddy permitting model at 1 4 grid resolution and the regional ice ocean prediction system riops smith et al 2021 an eddy resolving model at 1 12 grid resolution the northwest atlantic region is chosen for this study due to the high mesoscale eddy activity found in the vicinity of the gulf stream the skill of oceanographic systems to accurately represent real world eddies is often only evaluated in terms of standard gaussian statistics mean standard deviation of sea surface height e g metzger et al 2014 ryan et al 2015 these metrics provide a straightforward and established way to evaluate errors using a small number of conventional summary statistics however they provide very little information regarding errors as a function of spatial scale or distance or physical attributes specific to the eddies and of interest to users spatial verification approaches were developed within the numerical weather prediction nwp verification community casati et al 2008 gilleland et al 2010 dorninger et al 2018 to address similar issues the verification technique introduced in this work is a spatial method belonging to the class of feature based approaches and aims to partially fulfil these gaps several eddy identification and tracking methods have been previously developed chelton et al 2011b mason et al 2014 faghmous et al 2015 conti et al 2016 abernathey and haller 2018 tarshish et al 2018 sinha et al 2019 the approaches used are mainly based on geometric okubo weiss and wavelet methods see souza et al 2011 for a review with the introduction of lagrangian methods more recently these methods have been applied over the satellite altimetry period to create datasets revealing the number and lifetime of eddies over the different ocean basins e g chelton et al 2011b several studies have applied eddy tracking methods to evaluate eddy features in numerical ocean analysis systems mason et al 2019 use a geometrical eddy tracking approach to identify the position and size of eddies in three systems produced by the copernicus marine environmental monitoring service cmems and then produce composites to investigate the mean eddy properties cipollone et al 2017 use both a surface and three dimensional eddy detection algorithm to demonstrate the positive impact that data assimilation has on the representation of eddies xie et al 2020 also demonstrate the positive impact of data assimilation in terms of the number and mean radius of eddies in the south china sea similarly de vos et al 2018 show the impact of data assimilation on eddy population density and lifetime in the agulhas region as noted by xie et al 2020 what is lacking from these studies is a direct one to one matching of eddies between numerical systems and observational analyses directly matching the eddies would make it possible to evaluate how well a system may capture a particular eddy and the accuracy of its representation e g size and radius in this study we introduce a novel feature based verification methodology to evaluate the accuracy of operational oceanographic prediction systems in capturing observed eddy features one novelty of the proposed verification approach is the use of a matching algorithm to make it possible to evaluate the skill of the two analysis systems in predicting the location and properties of eddies in the observational product once the eddy features are identified and matched between observational and model analyses we evaluate categorical scores for the matched features as in verification approaches commonly used to evaluate hurricane tracking e g zadra et al 2014 with this approach we show that it is possible to demonstrate the added value of the higher resolution analysis system in terms of the number of correctly predicted eddies and their properties the paper is organized as follows details regarding the two analysis systems and the observational product used are provided in section 2 section 3 provides a description of the identification and tracking method the matching algorithm and the verification metrics used results are presented in section 4 with conclusions and a discussion provided in section 5 2 description of ocean prediction systems observational product and evaluation approach in this study we illustrate the eddy verification approach by evaluating the analyses of two canadian ocean prediction systems giops and riops against a standard satellite altimetry gridded observational product the satellite altimetry product is described in section 2 1 and details of the ocean model and data assimilation schemes are provided in sections 2 2 and 2 3 section 2 4 describes the region and period of the study as well as some data processing performed prior to the verification 2 1 satellite altimetry product the observational product used here for the verification of the numerical analysis systems is the archiving validation and interpretation of satellite oceanographic aviso ssalto duacs global daily multi mission 1 4 gridded analysis product taburet et al 2019 the aviso ssalto duacs altimeter analyses are produced and distributed by the copernicus marine and environment monitoring service cmems http www marine copernicus eu sea level thematic assembly centre 2020a b due to the filtering properties of the optimal interpolation method used to combine the altimeter observations there is a degradation in the resolution of the aviso gridded product as compared to along track altimetry observations ballarotta et al 2019 estimate the eddy feature radius for mesoscale structures in the aviso gridded product at mid latitudes to be about 50 km which is roughly 1 6 times smaller than the spatial scale of eddies in this region chelton et al 2011b as a result the aviso analyses should provide sufficient detail to discern differences between the eddy properties in the two ocean analysis systems described in the next section however it should be noted that the resolution of the aviso gridded product does produce a lower limit on the scale of features that can be accurately verified in this study 2 2 model configurations the ocean model used in giops and riops is the océan parallelisé opa model as part of the nucleus for european modelling of the ocean nemov3 6 madec 2008 modelling framework opa is a primitive equation model on an arakawa c grid employing the non boussinesq and hydrostatic approximations the vertical coordinate is specified using a z level approach with partial cells at the bottom the sea ice model used in both systems is the los alamos community ice code version 4 0 cice hunke 2001 lipscomb et al 2007 hunke and lipscomb 2008 the particular model parameterization details and settings used are described in table 1 the primary difference between the two systems is the numerical grid used and the inclusion of tides in riops giops uses a 1 4 resolution tri polar orca grid madec and imbard 1996 the riops numerical grid is constructed from the 1 12 orca grid whereby grid points from the pacific section have been re mapped to the top of the grid to eliminate the north fold from the orca grid see dupont et al 2015 for details the resulting grid covers the atlantic ocean from 26 n the arctic ocean and the north pacific ocean down to 44 n the resulting grid has been previously referred to as the concepts regional grid creg and used in various studies e g roy et al 2015 chikhar et al 2019 boutin et al 2020 open boundary conditions in riops are specified using daily mean fields from giops tidal variations in sea surface height ssh and barotropic transport are applied along the open boundaries in the atlantic and pacific oceans using 13 tidal constituents extracted from the oregon state university product egbert and erofeeva 2002 self attraction and loading terms are prescribed following the finite element solution fes 2012 tidal product carrère et al 2012 an evaluation of tidal variations in the creg configuration is presented in lemieux et al 2018 2 3 data assimilation the system assimilation mercator version 2 sam2 ocean data assimilation system is used by both giops and riops in a similar configuration sam2 is a reduced order extended kalman filter using a singular evolutive extended kalman seek filter methodology pham et al 1998 with a fixed basis the main properties and features of the scheme are as described in lellouche et al 2013 2018 with modifications as described by smith et al 2016 2021 a brief description is provided below the background error is defined in terms of a static set of multi variate error modes obtained from sub monthly anomalies of a multi year forced simulation a 7 day assimilation window is used with innovations calculated online during the model integration in a first guess at appropriate time fgat approach analysis increments are applied gradually in an incremental analysis updating iau approach bloom et al 1996 giops uses a 1 day iau over the last day of the window whereas riops uses a 7 day window with overlapping linear ramps between cycles following benkiran and greiner 2008 a 3dvar bias correction approach is used for temperature and salinity profiles using mean innovations from the previous 4 cycles the mean dynamic topography used in sea level anomaly assimilation is the hybrid product described by lellouche et al 2018 this product combines the cnes cls13 mdt rio et al 2014 with mean increments calculated from the mercator ocean glorys2v3 reanalysis giops and riops assimilate the exact same observational dataset that includes satellite altimetry gridded sea surface temperature sst analyses and in situ temperature and salinity observations the near real time along track aviso ssalto duacs satellite altimetry product is used for assimilation of sea level anomaly sla observations this includes observations from jason2 jason3 saral altika cryosat2 and sentinel 3a and 3b note that these along track sla observations are also used in the preparation of the multi mission gridded sla analyses used here for verification see section 2 1 as a result there is a certain degree of incestuousness in the verification approach applied here and error estimates may be somewhat underestimated the daily gridded sst analyses produced by ccmep brasnett and colan 2016 is also assimilated by giops and riops this sst analysis is produced on a 0 1 resolution latitude longitude grid using an optimal interpolation oi approach that assimilates amsr 2 avhrr viirs and in situ observations from moorings ships and drifters in situ temperature and salinity observations are obtained from cmems and include argo floats xbts moorings field campaigns voluntary observing ships and marine mammals 2 4 verification period domain and data pre processing the giops and riops analyses verified in this study are from the latest development cycles produced as part of the pre operational evaluation and correspond to operation versions 3 3 0 and 2 2 0 respectively they cover the period 1 january 2016 to 31 december 2019 the verification domain spans the northwest atlantic from 29 87 n to 59 87 n and 80 13 w to 30 13 w fig 1 this region was chosen as it includes the gulf stream a region of high mesoscale eddy activity prior to verification the giops and riops analyses are interpolated onto the 1 4 resolution latitude longitude grid used for the aviso analyses the use of a common grid for all three analyses made it possible to use the same parameters for the spatial filtering and in the eddy identification algorithm described in section 3 2 in the case of riops this may result in the loss of some information however given the effective resolution of riops is roughly 35 km smith et al 2021 the use of a 1 4 grid is not expected to have a significant effect as it corresponds to 24 km at 30 n and 14 km at 60 n prior to performing the eddy identification all three analyses are spatially high passed filtered using a bessel filter with a 500 km cutoff following mason et al 2014 3 the eddy verification methodology here we use the py eddy tracker mason et al 2014 for eddy identification and tracking py eddy tracker is freely available open source python software under a gnu licence https github com antsimi py eddy tracker its use here is intended to facilitate the reproducibility of results for other operational ocean prediction systems towards a common approach used within the community this package has been evaluated and compared in detail to the method of chelton et al 2011b it has also been used previously to study eddy properties in the brazil malvinas confluence region mason et al 2017 and composite eddy structures by cmems models mason et al 2019 py eddy tracker is now also used by cmems to produce delayed mode and near real time eddy atlas products aviso 2016 the py eddy tracker is adapted here for matching eddies between the observational analyses from aviso and the two model analyses giops and riops this method is essentially the same as used for eddy tracking in time but with several minor modifications details of the eddy identification and tracking procedure are provided in section 3 1 followed by a description of the approach for eddy matching section 3 2 a description of the verification metrics used in the analysis is presented in section 3 3 3 1 identification and tracking the approach taken here by py eddy tracker is based on identifying closed contours of sla or absolute dynamic topography adt fields here we follow the methodology outlined by pegliasco et al 2020 and use the ssh fields as the sla field may incorrectly identify closed contours associated with meanders in the gulf stream note that this approach has also now been adopted in version 3 of the aviso eddy atlas aviso 2016 for a closed contour to be a valid eddy it must satisfy a number of criteria see mason et al 2014 for details first the closed contour must contain only one maxima or minima second the number of pixels included in a contour must be at least 5 and no larger than 2000 which implies a minimum radius of about 25 km the minimum and the maximum number of pixels are set to 5 and 2000 which is a larger interval than the values of 8 and 1000 used by mason et al 2014 to include the maximum number of eddies note that there is very little sensitivity on the upper limit of the number of pixels to prevent the erroneous identification of elongated structures the area of the closed contour must not differ by more than 55 from the area of a circle of the same radius finally the amplitude must be at least twice the contour interval here we use a contour interval of 0 2 cm resulting in a minimum amplitude of 0 4 cm following the identification of eddies for each date a tracking algorithm is employed to follow the evolution of each eddy over time for a particular eddy all eddies within a radius of 125 km in the following date are identified a cost function c based on the difference in amplitude a radius r and distance d between centres is used to identify the most likely match as 1 c a 1 a 2 a 1 2 r 1 r 2 r 1 2 d 125 k m 2 where the subscripts 1 and 2 refer to the two eddies being considered a minimum lifetime threshold prevents the identification of spurious eddies some studies have employed a minimum eddy lifetime of 28 days mason et al 2014 here we opt for a shorter lifetime threshold of 4 days similar to the value of 5 days used by mason et al 2019 as use of a large minimum lifetime threshold was found to result in an increase in matching errors due to some eddies having a shorter lifetime in either the aviso analyses or model analysis systems to ensure the robustness of the results the sensitivity to the choice of minimum eddy lifetime threshold was examined using 14 day and 28 day thresholds not shown the main impact of increasing the minimum eddy lifetime threshold is to reduce the number of small eddies amplitude less than 10 cm and radius less than 50 km there is also an impact on the specific values obtained for the verification metrics but the relative values between riops and giops remain the same the effective radius as defined by mason et al 2014 is used here that is the radius of a circle with the same area as the region enclosed by the closed contour that satisfies the criteria mason et al 2014 the amplitude is determined as the difference between the eddy maxima minima sla and the sla of the last contour enclosing the eddy an example showing the identification of anticyclonic and cyclonic eddies for 1 january 2017 using this procedure for aviso giops and riops is shown in fig 1 a strong correspondence between eddy contours and filtered ssh can be seen for all three analyses larger eddies are mainly concentrated along the path of the gulf stream with smaller eddies present throughout the domain eddies in the three analyses display qualitatively similar properties in terms of radius and amplitude fig 2 left panel many small eddies are detected with a radius below 50 km and amplitude less than 5 cm the minimum radius and amplitude in the eddy identification algorithm are set at 25 km and 0 4 cm as noted above generally larger amplitude eddies are also found to have larger radii 3 2 matching the eddy identification and tracking algorithms described above produce timeseries of anticyclonic and cyclonic eddies over the evaluation period for each set of analyses aviso giops and riops in order to match an eddy in one dataset with a corresponding eddy in another the same cost function used in the tracking algorithm is used eq 1 a cost function approach provides an objective means to match eddies from different analyses in terms of their physical properties radius amplitude and distance between eddy centres an alternative approach would be to consider overlapping eddies this approach was not used as it was found to produce spurious matches between very large and small eddies as well as leading to situations where multiple eddies may overlap additionally to be matched the eddies must have the same polarity i e both eddies are either cyclonic or anticyclonic fig 3 shows an example of the matching algorithm for cyclonic eddies on 1 january 2017 the matching algorithm provides a satisfactory assessment of corresponding eddies between the model and aviso analyses corresponding eddies in the model analyses are found for the majority of eddies identified in the aviso analyses which we consider here to be the truth however significant deviations can be seen in the size and shape of the eddies between the respective analyses the agreement between a particular eddy in a model analysis and the corresponding aviso eddy can differ substantially for example the eddy located near 58 w 38 n has broadly the same shape and size in riops and aviso but the contour identified in giops is much smaller in addition many eddies present in the aviso analysis are not matched by either model analysis to a lesser degree some eddies present in giops and riops are also not matched with a corresponding eddy in the aviso analysis 3 3 verification metrics here we build on established categorical verification approaches used in numerical weather prediction and other communities for dichotomous events e g tropical cyclone tracking precipitation walsh 1997 following the application of the matching algorithm described above fig 3 eddies identified in both the model analyses i e giops or riops and verifying analysis here the aviso product are referred to as hits eddies in the verifying analysis with no corresponding eddy in the model analysis are referred to as misses whereas eddies present in a model analysis but not in the verifying analysis are deemed false alarms statistics for hits misses and false alarms can be tabulated over the study area and over the full 4 year evaluation period to provide an indication of the skill of giops and riops analyses in representing observed eddies it is also interesting to consider what fraction of the observed eddies are captured by model analyses using the probability of detection pod defined as 2 p o d h i t s h i t s m i s s e s similarly one can consider what fraction of the predicted eddies in the model analyses did not occur using the false alarm ratio far defined as 3 f a r f a l s e a l a r m s h i t s f a l s e a l a r m s both pod and far have values between 0 1 with perfect values of 1 and 0 respectively 4 results here we present results from the application of the eddy identification tracking and matching algorithm described above applied to the evaluation of giops and riops analyses as compared to the aviso observational analyses the evaluation is made over a 4 year period spanning 1 january 2016 to 31 december 2019 first the results of the eddy identification in the three sets of analyses is presented in section 4 1 we then examine the matching statistics hits false alarms misses pod and far in terms of eddy radius and amplitude section 4 2 finally we assess errors in the properties of matched eddies due to the relative contributions to the matching cost function radius amplitude and separation distance 4 1 results of eddy identification over the 4 year period when considered over the full 4 year evaluation period fig 2 b c d the properties of identified eddies for all three sets of analyses are quite similar many small eddies are identified with an amplitude less than 10 cm and radii less than 50 km with many eddies near the lower threshold of detectability at 25 km the number of these eddies is sensitive to the choice of the minimum eddy lifetime threshold as noted in section 3 1 a lower limit on radius as a function of amplitude can be clearly seen such that for example 50 cm eddies occur only with radii of 75 km or greater and 100 cm eddies occur only for 100 km or greater this is to be expected as large amplitude eddies with a small radius would imply large geostrophic currents the total number of eddies identified for aviso is somewhat larger than for giops and riops for both anticyclonic and cyclonic eddies table 2 the number of long lived eddies i e with a lifetime greater than 50 days in both giops and riops is lower than in aviso not shown possibly as a result of the effects of data assimilation for example it may take several assimilation cycles to create an eddy in the analyses resulting in lower eddy lifetimes 4 2 eddy verification following the tabulation of hits misses and false alarms over the 4 year evaluation period the probability of detection pod and false alarm ratio far were calculated eqs 2 and 3 and are shown in figs 4 and 5 aggregated statistics are evaluated by summing all the counts of hits misses and false alarms for the whole verification period and then calculating the pod and far with those accumulated hits misses false alarms counts to determine the statistical significance of differences a 95 confidence intervals of the aggregated statistics are evaluated by a paired bootstrap where for each re sample the aggregated score is evaluated from the sum of the hits false alarm misses for randomly selected dates allowing repetition within the verification period while the domain averaged pod and far vary from day to day the statistics appear stationary in time with no apparent seasonal variability both systems provide an average pod above 50 and a far below 30 riops displays a statistically significant improvement over giops with a 2 5 higher pod and 4 1 lower far which are equivalent to differences 4 75 and 13 8 respectively from giops values table 3 note that when using larger values for the minimum eddy lifetime threshold the improvements in pod are no longer present nonetheless this suggests that riops has an improved capacity to represent observed eddies while generating fewer false alarms that being said a roughly 50 pod seems hardly satisfying and puts in question the usefulness of these analyses for many of the applications mentioned in section 1 we now turn our attention to the dependence of the eddy matching statistics on eddy properties namely radius fig 6 and amplitude fig 7 the greatest number of misses occurs for small eddies with radii less than 50 km and amplitudes below 4 cm for these small eddies the number of misses is greater than the number of hits by a significant margin resulting in a pod below 50 similarly there is a greater number of false alarms for small eddies resulting in far values above 30 as noted in section 3 1 the number of small eddies is quite sensitive to the minimum eddy lifetime threshold however even when using a 28 day minimum lifetime threshold there is a larger number of misses for small radii and amplitude albeit fewer than for a 4 day threshold as noted in section 2 1 ballarotta et al 2019 estimate the eddy feature radius in the aviso gridded product at mid latitudes to be about 50 km as a result many of these small eddies are likely spurious features that do not provide useful information regarding the quality of the analyses for example they may result from the incomplete coverage of along track nadir altimeter data in the aviso analyses the larger errors at small radii may also be due to spurious features resulting from the covariances used in the sam2 data assimilation system lellouche et al 2018 for giops and riops moreover the numerical models used are not able to fully resolve eddy features at these scales finally the identification of small eddies is sensitive to the choice of identification methodology e g minimum eddy lifetime threshold and thus these results are less robust they are included here for the sake of completeness but an improved method to objectively discriminate small eddies is necessary for radii and amplitude greater than 50 km and 4 cm respectively a much larger fraction of hits is found i e larger than both misses and false alarms with the pod increasing asymptotically to values of about 90 for eddies of radius greater than 120 km far statistics show a similar but inverse response with values decreasing to around 10 15 for radii greater than 120 km the sensitivity to amplitude is somewhat more acute with pod and far showing a sharp change around 10 cm the difference in matching statistics between riops and giops also show a strong dependence on radius and amplitude in particular for eddies with amplitudes greater than 10 cm riops has pod values 10 30 higher with far values 5 10 lower than giops differences in matching statistics between the two model analyses in terms of radius are less pronounced but improvements in far can nonetheless be seen for riops for large eddy radii it is also interesting to consider the integrated matching statistics as a function of radius and amplitude fig 8 it is then possible to answer questions such as below what radius do 90 of the false alarms occur or what percentage of hits occur above 10 cm the former question could assist in how to smooth model outputs to remove spurious eddy features while the latter question gives an indication of the system performance above a particular threshold of small eddy noise in our case we see that 90 of the false alarms occur in riops and giops for radii smaller than 79 km and 96 km respectively indicating a gain of 17 km with the higher resolution model for attaining the same level of performance similarly we can see that giops and riops have about 72 and 62 of their hits below 10 cm and thus 28 and 38 above 10 cm indicating that riops has 26 more hits than giops for eddies with amplitudes larger than 10 cm i e riops hits giops hits riops hits 4 3 errors in eddy properties while it is useful to know whether a particular observed eddy has a corresponding match in the model analyses this does not tell us how well that eddy is represented as can be seen in fig 3 some matched eddies have quite different shapes and sizes given that the model grid resolution of riops is a factor of 3 higher than giops one would expect an improved representation as such is it possible to detect differences in the properties of matched eddies between riops and giops to answer this question we can investigate the relative contribution of the different terms on the right hand side of eq 1 to the total cost function value for each matched eddy hit the value of the total cost function as well as errors in radius amplitude and separation distance are binned and then normalized by the total number of hits here we have chosen to assess the differences in the three quantities without the normalization factors applied in eq 1 i e a 1 r 1 and 125 km to provide errors in physical units while this makes an assessment of the direct contribution to the cost function less clear it facilitates a physical interpretation of the histograms the resulting normalized histograms are shown in fig 9 the distribution of cost function values shows a clear shift to lower values for riops suggesting that riops does represent the eddies better than giops especially in terms of radius and distances fig 9 b d indeed the mode of the cost function distribution is only 0 4 for riops as compared to 0 7 for giops the lower cost function values in riops result from lower values in radius amplitude and distance errors table 4 in particular marked improvements in radius and distance errors fig 9 b d are found for riops by 25 and 21 respectively with fewer occurrences of matched eddies with errors above 20 km in radius and 40 km in separation distance 5 conclusions and discussion here we introduce a novel feature based verification methodology for operational oceanographic systems this methodology builds on previous efforts at eddy tracking and applies open source software to provide a robust method to evaluate the skill of operational oceanographic systems in terms of representing observed eddies as an initial demonstration an evaluation of eddy properties is made using two operational systems of different grid resolutions 1 4 and 1 12 a variety of different statistical measures are applied to a 4 year long dataset showing statistically significant improvements in the representation of eddy features by the higher resolution system at a 95 confidence level categorical verification metrics evaluated on paired forecast observation eddy features suggest that both systems provide an overall performance with a pod only slightly better than 50 and a far slightly below 30 an improvement in the higher resolution riops system of 4 75 for pod and 13 8 for far is found a significant number of misses occur for eddies at small radii and amplitude for both systems for example for eddies with radii less than 50 km pod values are below 50 whereas pod values are around 90 for radii above 120 km these results underscore the need for a robust and ideally objective method to omit small eddies from the analysis these small eddies may be spurious features in the verifying analysis global aviso gridded product in the current study or in the model analyses and are less likely to be robust features indeed amores et al 2018 find that the minimum radius for eddies in the north atlantic ocean in the aviso analyses to be around 50 km and suggest that the number of eddies in the aviso analyses larger than this radius is overestimated due to an aliasing of smaller eddies due to this limitation in the gridded observational analyses it may not be possible to extend the approach presented here to ocean models of higher resolution e g 1 36 or greater however future wide swath altimetry missions may improve the detection of small eddies morrow et al 2019 ma et al 2020 moreover the limit of constrained scales in the model analyses is likely much larger jacobs et al 2021 suggesting that low pass filtering of model fields should improve the skill scores and product reliability despite the uncertainty in the verification of small eddies the results of this study demonstrate the added value of an eddy resolving model riops as compared to an eddy permitting model giops in terms of eddy features with statistically significant improvements in pod and far at a 95 confidence level for eddies with amplitudes greater than 10 cm riops has pod values 10 30 higher with far values 5 10 lower than giops moreover we see that the 90 false alarm threshold occurs in riops and giops for radii approaching 79 km and 96 km respectively 18 reduction in riops similarly we can see that giops and riops have about 28 and 38 of their hits above 10 cm respectively indicating that riops has 26 more hits above the 10 cm threshold than giops a significant improvement in the properties of simulated eddies in riops is also found in particular results show a marked improvement in the eddy radius errors and separation distances by 25 and 21 respectively with fewer occurrences of errors above 20 km in radius and 40 km in separation distance in the present study we have demonstrated that an eddy tracking methodology is able to discern clear improvements in analyses produced using a 1 12 grid resolution system over one at 1 4 grid resolution note that the use of higher resolution background error covariances and other details of the assimilation scheme may contribute to the improvements seen for riops nonetheless this basic demonstration opens the door for a more detailed examination of eddy features in ocean prediction systems ideally one would wish for such a method to be able to provide sufficient detail in errors to guide the development of forecasting system improvements such feature based verification would greatly assist in improving the quality and usefulness of operational oceanographic products by tailoring them directly to user applications for example the approach could be used to study the time evolution of errors as a function of forecast lead time which may assist in identifying the underlying sources of model error numerical schemes diffusion etc the approach presented here could also be applied to follow the error of particular eddies over time amplitude and track thereby shedding light on issues such as the continuity in time e g performance of iau which are important for reanalysis applications finally the feature based verification approach provides physically meaningful feedback i e as compared to standard metrics such as standard deviation mean absolute error etc and enables an assessment of improvements in model physics and data assimilation schemes explicitly in terms of their direct impact on the eddy features an extension of the present work that could be investigated in future is the coincidence status approach developed by ma et al 2020 for matching eddies between two analyses the coincidence status includes five cases matched split merged missed and artefact this would increase the complexity of the verification metrics but could provide additional detail regarding uncertain matches credit authorship contribution statement gregory c smith conceptualization methodology investigation writing original draft manuscript anne sophie fortin software visualization investigation reviewing and editing of the manuscript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we would like to thank evan mason for making his eddy tracking algorithm publicly available we would also like to express our sincere gratitude to antoine delepoulle for answering all of our questions and for helping us to resolve some technical issues we encountered while using the py eddy tracker algorithm special thanks to barbara casati for her important guidance on verification techniques and many thoughtful comments on the manuscript francois roy provided valuable technical assistance with python and ccmep systems we would also like to thank three anonymous reviewers for their constructive comments this study has been conducted using e u copernicus marine service information 
23852,mesoscale eddy features are found ubiquitously throughout the world s oceans many needs exist for numerical products from operational oceanographic systems to provide information on eddy properties while numerous eddy identification and tracking methods have been developed for oceanic eddies specific methods and metrics tailored to verify the skill of ocean analyses and forecasts in capturing these features are lacking here we introduce a novel feature based verification methodology for operational oceanographic systems this methodology builds on previous efforts at eddy tracking and applies open source software to provide a robust method to evaluate the skill of operational oceanographic systems in terms of representing observed eddies we demonstrate that an eddy tracking methodology can discern clear improvements in analyses produced using a regional analysis system riops 1 12 grid resolution over a global system giops 1 4 grid resolution for eddies with amplitudes greater than 10 cm riops has a probability of detection 10 30 higher than giops with a false alarm ratio 5 10 lower a significant improvement in the spatial properties of simulated eddies in riops is also found in particular results show a marked improvement in radius and separation distance errors by 25 and 21 respectively with fewer occurrences of errors above 20 km in radius and 40 km in separation distance this basic demonstration opens the door for a more detailed examination of eddy features in ocean prediction systems keywords mesoscale eddies feature based verification gulf stream riops giops operational oceanography 1 introduction mesoscale eddy features are found ubiquitously throughout the world s oceans these features have spatial scales of 25 100 km and help maintain the ocean general circulation and climate mcwilliams 2008 eddies form coherent vortices that transport physical and biogeochemical tracers trapped in their cores lee et al 1997 zhang et al 2014 eddies also affect the curl of the surface stress driving vertical velocities that can bring deeper nutrients to the upper ocean where photosynthesis may occur frenger et al 2013 information on eddy properties as simulated by operational oceanographic numerical prediction systems is needed for many applications eddies affect the surface currents with impacts on search and rescue efforts davidson et al 2009 environmental emergency response e g oil spill feng et al 2019 biogeochemical tracers chelton et al 2011a route optimization for marine transportation yang et al 2020 and other drift applications such as for micro plastics brach et al 2018 the sub surface signature of eddies may affect acoustic propagation and range detection for naval and other applications heaney and campbell 2016 knowledge of the location of eddies could also be used for targeted fisheries arur et al 2020 the presence of warm cold core eddies has also been shown to have an impact on tropical cyclone intensification wu et al 2007 jaimes and shay 2009 wang et al 2018 as many operational numerical weather prediction centres are now moving towards coupled atmosphere ocean forecasting systems smith et al 2018 guiavarc h et al 2019 the accurate representation of eddies will also have an impact on weather forecasts in this study we aim to address the question of what is the current capacity of operational oceanographic prediction systems to capture observed eddy features two operational systems from the canadian centre for meteorological and environmental prediction ccmep of different resolutions are evaluated against a commonly used observational product using the open source eddy tracking package of mason et al 2014 these systems are the global ice ocean prediction system giops smith et al 2016 an eddy permitting model at 1 4 grid resolution and the regional ice ocean prediction system riops smith et al 2021 an eddy resolving model at 1 12 grid resolution the northwest atlantic region is chosen for this study due to the high mesoscale eddy activity found in the vicinity of the gulf stream the skill of oceanographic systems to accurately represent real world eddies is often only evaluated in terms of standard gaussian statistics mean standard deviation of sea surface height e g metzger et al 2014 ryan et al 2015 these metrics provide a straightforward and established way to evaluate errors using a small number of conventional summary statistics however they provide very little information regarding errors as a function of spatial scale or distance or physical attributes specific to the eddies and of interest to users spatial verification approaches were developed within the numerical weather prediction nwp verification community casati et al 2008 gilleland et al 2010 dorninger et al 2018 to address similar issues the verification technique introduced in this work is a spatial method belonging to the class of feature based approaches and aims to partially fulfil these gaps several eddy identification and tracking methods have been previously developed chelton et al 2011b mason et al 2014 faghmous et al 2015 conti et al 2016 abernathey and haller 2018 tarshish et al 2018 sinha et al 2019 the approaches used are mainly based on geometric okubo weiss and wavelet methods see souza et al 2011 for a review with the introduction of lagrangian methods more recently these methods have been applied over the satellite altimetry period to create datasets revealing the number and lifetime of eddies over the different ocean basins e g chelton et al 2011b several studies have applied eddy tracking methods to evaluate eddy features in numerical ocean analysis systems mason et al 2019 use a geometrical eddy tracking approach to identify the position and size of eddies in three systems produced by the copernicus marine environmental monitoring service cmems and then produce composites to investigate the mean eddy properties cipollone et al 2017 use both a surface and three dimensional eddy detection algorithm to demonstrate the positive impact that data assimilation has on the representation of eddies xie et al 2020 also demonstrate the positive impact of data assimilation in terms of the number and mean radius of eddies in the south china sea similarly de vos et al 2018 show the impact of data assimilation on eddy population density and lifetime in the agulhas region as noted by xie et al 2020 what is lacking from these studies is a direct one to one matching of eddies between numerical systems and observational analyses directly matching the eddies would make it possible to evaluate how well a system may capture a particular eddy and the accuracy of its representation e g size and radius in this study we introduce a novel feature based verification methodology to evaluate the accuracy of operational oceanographic prediction systems in capturing observed eddy features one novelty of the proposed verification approach is the use of a matching algorithm to make it possible to evaluate the skill of the two analysis systems in predicting the location and properties of eddies in the observational product once the eddy features are identified and matched between observational and model analyses we evaluate categorical scores for the matched features as in verification approaches commonly used to evaluate hurricane tracking e g zadra et al 2014 with this approach we show that it is possible to demonstrate the added value of the higher resolution analysis system in terms of the number of correctly predicted eddies and their properties the paper is organized as follows details regarding the two analysis systems and the observational product used are provided in section 2 section 3 provides a description of the identification and tracking method the matching algorithm and the verification metrics used results are presented in section 4 with conclusions and a discussion provided in section 5 2 description of ocean prediction systems observational product and evaluation approach in this study we illustrate the eddy verification approach by evaluating the analyses of two canadian ocean prediction systems giops and riops against a standard satellite altimetry gridded observational product the satellite altimetry product is described in section 2 1 and details of the ocean model and data assimilation schemes are provided in sections 2 2 and 2 3 section 2 4 describes the region and period of the study as well as some data processing performed prior to the verification 2 1 satellite altimetry product the observational product used here for the verification of the numerical analysis systems is the archiving validation and interpretation of satellite oceanographic aviso ssalto duacs global daily multi mission 1 4 gridded analysis product taburet et al 2019 the aviso ssalto duacs altimeter analyses are produced and distributed by the copernicus marine and environment monitoring service cmems http www marine copernicus eu sea level thematic assembly centre 2020a b due to the filtering properties of the optimal interpolation method used to combine the altimeter observations there is a degradation in the resolution of the aviso gridded product as compared to along track altimetry observations ballarotta et al 2019 estimate the eddy feature radius for mesoscale structures in the aviso gridded product at mid latitudes to be about 50 km which is roughly 1 6 times smaller than the spatial scale of eddies in this region chelton et al 2011b as a result the aviso analyses should provide sufficient detail to discern differences between the eddy properties in the two ocean analysis systems described in the next section however it should be noted that the resolution of the aviso gridded product does produce a lower limit on the scale of features that can be accurately verified in this study 2 2 model configurations the ocean model used in giops and riops is the océan parallelisé opa model as part of the nucleus for european modelling of the ocean nemov3 6 madec 2008 modelling framework opa is a primitive equation model on an arakawa c grid employing the non boussinesq and hydrostatic approximations the vertical coordinate is specified using a z level approach with partial cells at the bottom the sea ice model used in both systems is the los alamos community ice code version 4 0 cice hunke 2001 lipscomb et al 2007 hunke and lipscomb 2008 the particular model parameterization details and settings used are described in table 1 the primary difference between the two systems is the numerical grid used and the inclusion of tides in riops giops uses a 1 4 resolution tri polar orca grid madec and imbard 1996 the riops numerical grid is constructed from the 1 12 orca grid whereby grid points from the pacific section have been re mapped to the top of the grid to eliminate the north fold from the orca grid see dupont et al 2015 for details the resulting grid covers the atlantic ocean from 26 n the arctic ocean and the north pacific ocean down to 44 n the resulting grid has been previously referred to as the concepts regional grid creg and used in various studies e g roy et al 2015 chikhar et al 2019 boutin et al 2020 open boundary conditions in riops are specified using daily mean fields from giops tidal variations in sea surface height ssh and barotropic transport are applied along the open boundaries in the atlantic and pacific oceans using 13 tidal constituents extracted from the oregon state university product egbert and erofeeva 2002 self attraction and loading terms are prescribed following the finite element solution fes 2012 tidal product carrère et al 2012 an evaluation of tidal variations in the creg configuration is presented in lemieux et al 2018 2 3 data assimilation the system assimilation mercator version 2 sam2 ocean data assimilation system is used by both giops and riops in a similar configuration sam2 is a reduced order extended kalman filter using a singular evolutive extended kalman seek filter methodology pham et al 1998 with a fixed basis the main properties and features of the scheme are as described in lellouche et al 2013 2018 with modifications as described by smith et al 2016 2021 a brief description is provided below the background error is defined in terms of a static set of multi variate error modes obtained from sub monthly anomalies of a multi year forced simulation a 7 day assimilation window is used with innovations calculated online during the model integration in a first guess at appropriate time fgat approach analysis increments are applied gradually in an incremental analysis updating iau approach bloom et al 1996 giops uses a 1 day iau over the last day of the window whereas riops uses a 7 day window with overlapping linear ramps between cycles following benkiran and greiner 2008 a 3dvar bias correction approach is used for temperature and salinity profiles using mean innovations from the previous 4 cycles the mean dynamic topography used in sea level anomaly assimilation is the hybrid product described by lellouche et al 2018 this product combines the cnes cls13 mdt rio et al 2014 with mean increments calculated from the mercator ocean glorys2v3 reanalysis giops and riops assimilate the exact same observational dataset that includes satellite altimetry gridded sea surface temperature sst analyses and in situ temperature and salinity observations the near real time along track aviso ssalto duacs satellite altimetry product is used for assimilation of sea level anomaly sla observations this includes observations from jason2 jason3 saral altika cryosat2 and sentinel 3a and 3b note that these along track sla observations are also used in the preparation of the multi mission gridded sla analyses used here for verification see section 2 1 as a result there is a certain degree of incestuousness in the verification approach applied here and error estimates may be somewhat underestimated the daily gridded sst analyses produced by ccmep brasnett and colan 2016 is also assimilated by giops and riops this sst analysis is produced on a 0 1 resolution latitude longitude grid using an optimal interpolation oi approach that assimilates amsr 2 avhrr viirs and in situ observations from moorings ships and drifters in situ temperature and salinity observations are obtained from cmems and include argo floats xbts moorings field campaigns voluntary observing ships and marine mammals 2 4 verification period domain and data pre processing the giops and riops analyses verified in this study are from the latest development cycles produced as part of the pre operational evaluation and correspond to operation versions 3 3 0 and 2 2 0 respectively they cover the period 1 january 2016 to 31 december 2019 the verification domain spans the northwest atlantic from 29 87 n to 59 87 n and 80 13 w to 30 13 w fig 1 this region was chosen as it includes the gulf stream a region of high mesoscale eddy activity prior to verification the giops and riops analyses are interpolated onto the 1 4 resolution latitude longitude grid used for the aviso analyses the use of a common grid for all three analyses made it possible to use the same parameters for the spatial filtering and in the eddy identification algorithm described in section 3 2 in the case of riops this may result in the loss of some information however given the effective resolution of riops is roughly 35 km smith et al 2021 the use of a 1 4 grid is not expected to have a significant effect as it corresponds to 24 km at 30 n and 14 km at 60 n prior to performing the eddy identification all three analyses are spatially high passed filtered using a bessel filter with a 500 km cutoff following mason et al 2014 3 the eddy verification methodology here we use the py eddy tracker mason et al 2014 for eddy identification and tracking py eddy tracker is freely available open source python software under a gnu licence https github com antsimi py eddy tracker its use here is intended to facilitate the reproducibility of results for other operational ocean prediction systems towards a common approach used within the community this package has been evaluated and compared in detail to the method of chelton et al 2011b it has also been used previously to study eddy properties in the brazil malvinas confluence region mason et al 2017 and composite eddy structures by cmems models mason et al 2019 py eddy tracker is now also used by cmems to produce delayed mode and near real time eddy atlas products aviso 2016 the py eddy tracker is adapted here for matching eddies between the observational analyses from aviso and the two model analyses giops and riops this method is essentially the same as used for eddy tracking in time but with several minor modifications details of the eddy identification and tracking procedure are provided in section 3 1 followed by a description of the approach for eddy matching section 3 2 a description of the verification metrics used in the analysis is presented in section 3 3 3 1 identification and tracking the approach taken here by py eddy tracker is based on identifying closed contours of sla or absolute dynamic topography adt fields here we follow the methodology outlined by pegliasco et al 2020 and use the ssh fields as the sla field may incorrectly identify closed contours associated with meanders in the gulf stream note that this approach has also now been adopted in version 3 of the aviso eddy atlas aviso 2016 for a closed contour to be a valid eddy it must satisfy a number of criteria see mason et al 2014 for details first the closed contour must contain only one maxima or minima second the number of pixels included in a contour must be at least 5 and no larger than 2000 which implies a minimum radius of about 25 km the minimum and the maximum number of pixels are set to 5 and 2000 which is a larger interval than the values of 8 and 1000 used by mason et al 2014 to include the maximum number of eddies note that there is very little sensitivity on the upper limit of the number of pixels to prevent the erroneous identification of elongated structures the area of the closed contour must not differ by more than 55 from the area of a circle of the same radius finally the amplitude must be at least twice the contour interval here we use a contour interval of 0 2 cm resulting in a minimum amplitude of 0 4 cm following the identification of eddies for each date a tracking algorithm is employed to follow the evolution of each eddy over time for a particular eddy all eddies within a radius of 125 km in the following date are identified a cost function c based on the difference in amplitude a radius r and distance d between centres is used to identify the most likely match as 1 c a 1 a 2 a 1 2 r 1 r 2 r 1 2 d 125 k m 2 where the subscripts 1 and 2 refer to the two eddies being considered a minimum lifetime threshold prevents the identification of spurious eddies some studies have employed a minimum eddy lifetime of 28 days mason et al 2014 here we opt for a shorter lifetime threshold of 4 days similar to the value of 5 days used by mason et al 2019 as use of a large minimum lifetime threshold was found to result in an increase in matching errors due to some eddies having a shorter lifetime in either the aviso analyses or model analysis systems to ensure the robustness of the results the sensitivity to the choice of minimum eddy lifetime threshold was examined using 14 day and 28 day thresholds not shown the main impact of increasing the minimum eddy lifetime threshold is to reduce the number of small eddies amplitude less than 10 cm and radius less than 50 km there is also an impact on the specific values obtained for the verification metrics but the relative values between riops and giops remain the same the effective radius as defined by mason et al 2014 is used here that is the radius of a circle with the same area as the region enclosed by the closed contour that satisfies the criteria mason et al 2014 the amplitude is determined as the difference between the eddy maxima minima sla and the sla of the last contour enclosing the eddy an example showing the identification of anticyclonic and cyclonic eddies for 1 january 2017 using this procedure for aviso giops and riops is shown in fig 1 a strong correspondence between eddy contours and filtered ssh can be seen for all three analyses larger eddies are mainly concentrated along the path of the gulf stream with smaller eddies present throughout the domain eddies in the three analyses display qualitatively similar properties in terms of radius and amplitude fig 2 left panel many small eddies are detected with a radius below 50 km and amplitude less than 5 cm the minimum radius and amplitude in the eddy identification algorithm are set at 25 km and 0 4 cm as noted above generally larger amplitude eddies are also found to have larger radii 3 2 matching the eddy identification and tracking algorithms described above produce timeseries of anticyclonic and cyclonic eddies over the evaluation period for each set of analyses aviso giops and riops in order to match an eddy in one dataset with a corresponding eddy in another the same cost function used in the tracking algorithm is used eq 1 a cost function approach provides an objective means to match eddies from different analyses in terms of their physical properties radius amplitude and distance between eddy centres an alternative approach would be to consider overlapping eddies this approach was not used as it was found to produce spurious matches between very large and small eddies as well as leading to situations where multiple eddies may overlap additionally to be matched the eddies must have the same polarity i e both eddies are either cyclonic or anticyclonic fig 3 shows an example of the matching algorithm for cyclonic eddies on 1 january 2017 the matching algorithm provides a satisfactory assessment of corresponding eddies between the model and aviso analyses corresponding eddies in the model analyses are found for the majority of eddies identified in the aviso analyses which we consider here to be the truth however significant deviations can be seen in the size and shape of the eddies between the respective analyses the agreement between a particular eddy in a model analysis and the corresponding aviso eddy can differ substantially for example the eddy located near 58 w 38 n has broadly the same shape and size in riops and aviso but the contour identified in giops is much smaller in addition many eddies present in the aviso analysis are not matched by either model analysis to a lesser degree some eddies present in giops and riops are also not matched with a corresponding eddy in the aviso analysis 3 3 verification metrics here we build on established categorical verification approaches used in numerical weather prediction and other communities for dichotomous events e g tropical cyclone tracking precipitation walsh 1997 following the application of the matching algorithm described above fig 3 eddies identified in both the model analyses i e giops or riops and verifying analysis here the aviso product are referred to as hits eddies in the verifying analysis with no corresponding eddy in the model analysis are referred to as misses whereas eddies present in a model analysis but not in the verifying analysis are deemed false alarms statistics for hits misses and false alarms can be tabulated over the study area and over the full 4 year evaluation period to provide an indication of the skill of giops and riops analyses in representing observed eddies it is also interesting to consider what fraction of the observed eddies are captured by model analyses using the probability of detection pod defined as 2 p o d h i t s h i t s m i s s e s similarly one can consider what fraction of the predicted eddies in the model analyses did not occur using the false alarm ratio far defined as 3 f a r f a l s e a l a r m s h i t s f a l s e a l a r m s both pod and far have values between 0 1 with perfect values of 1 and 0 respectively 4 results here we present results from the application of the eddy identification tracking and matching algorithm described above applied to the evaluation of giops and riops analyses as compared to the aviso observational analyses the evaluation is made over a 4 year period spanning 1 january 2016 to 31 december 2019 first the results of the eddy identification in the three sets of analyses is presented in section 4 1 we then examine the matching statistics hits false alarms misses pod and far in terms of eddy radius and amplitude section 4 2 finally we assess errors in the properties of matched eddies due to the relative contributions to the matching cost function radius amplitude and separation distance 4 1 results of eddy identification over the 4 year period when considered over the full 4 year evaluation period fig 2 b c d the properties of identified eddies for all three sets of analyses are quite similar many small eddies are identified with an amplitude less than 10 cm and radii less than 50 km with many eddies near the lower threshold of detectability at 25 km the number of these eddies is sensitive to the choice of the minimum eddy lifetime threshold as noted in section 3 1 a lower limit on radius as a function of amplitude can be clearly seen such that for example 50 cm eddies occur only with radii of 75 km or greater and 100 cm eddies occur only for 100 km or greater this is to be expected as large amplitude eddies with a small radius would imply large geostrophic currents the total number of eddies identified for aviso is somewhat larger than for giops and riops for both anticyclonic and cyclonic eddies table 2 the number of long lived eddies i e with a lifetime greater than 50 days in both giops and riops is lower than in aviso not shown possibly as a result of the effects of data assimilation for example it may take several assimilation cycles to create an eddy in the analyses resulting in lower eddy lifetimes 4 2 eddy verification following the tabulation of hits misses and false alarms over the 4 year evaluation period the probability of detection pod and false alarm ratio far were calculated eqs 2 and 3 and are shown in figs 4 and 5 aggregated statistics are evaluated by summing all the counts of hits misses and false alarms for the whole verification period and then calculating the pod and far with those accumulated hits misses false alarms counts to determine the statistical significance of differences a 95 confidence intervals of the aggregated statistics are evaluated by a paired bootstrap where for each re sample the aggregated score is evaluated from the sum of the hits false alarm misses for randomly selected dates allowing repetition within the verification period while the domain averaged pod and far vary from day to day the statistics appear stationary in time with no apparent seasonal variability both systems provide an average pod above 50 and a far below 30 riops displays a statistically significant improvement over giops with a 2 5 higher pod and 4 1 lower far which are equivalent to differences 4 75 and 13 8 respectively from giops values table 3 note that when using larger values for the minimum eddy lifetime threshold the improvements in pod are no longer present nonetheless this suggests that riops has an improved capacity to represent observed eddies while generating fewer false alarms that being said a roughly 50 pod seems hardly satisfying and puts in question the usefulness of these analyses for many of the applications mentioned in section 1 we now turn our attention to the dependence of the eddy matching statistics on eddy properties namely radius fig 6 and amplitude fig 7 the greatest number of misses occurs for small eddies with radii less than 50 km and amplitudes below 4 cm for these small eddies the number of misses is greater than the number of hits by a significant margin resulting in a pod below 50 similarly there is a greater number of false alarms for small eddies resulting in far values above 30 as noted in section 3 1 the number of small eddies is quite sensitive to the minimum eddy lifetime threshold however even when using a 28 day minimum lifetime threshold there is a larger number of misses for small radii and amplitude albeit fewer than for a 4 day threshold as noted in section 2 1 ballarotta et al 2019 estimate the eddy feature radius in the aviso gridded product at mid latitudes to be about 50 km as a result many of these small eddies are likely spurious features that do not provide useful information regarding the quality of the analyses for example they may result from the incomplete coverage of along track nadir altimeter data in the aviso analyses the larger errors at small radii may also be due to spurious features resulting from the covariances used in the sam2 data assimilation system lellouche et al 2018 for giops and riops moreover the numerical models used are not able to fully resolve eddy features at these scales finally the identification of small eddies is sensitive to the choice of identification methodology e g minimum eddy lifetime threshold and thus these results are less robust they are included here for the sake of completeness but an improved method to objectively discriminate small eddies is necessary for radii and amplitude greater than 50 km and 4 cm respectively a much larger fraction of hits is found i e larger than both misses and false alarms with the pod increasing asymptotically to values of about 90 for eddies of radius greater than 120 km far statistics show a similar but inverse response with values decreasing to around 10 15 for radii greater than 120 km the sensitivity to amplitude is somewhat more acute with pod and far showing a sharp change around 10 cm the difference in matching statistics between riops and giops also show a strong dependence on radius and amplitude in particular for eddies with amplitudes greater than 10 cm riops has pod values 10 30 higher with far values 5 10 lower than giops differences in matching statistics between the two model analyses in terms of radius are less pronounced but improvements in far can nonetheless be seen for riops for large eddy radii it is also interesting to consider the integrated matching statistics as a function of radius and amplitude fig 8 it is then possible to answer questions such as below what radius do 90 of the false alarms occur or what percentage of hits occur above 10 cm the former question could assist in how to smooth model outputs to remove spurious eddy features while the latter question gives an indication of the system performance above a particular threshold of small eddy noise in our case we see that 90 of the false alarms occur in riops and giops for radii smaller than 79 km and 96 km respectively indicating a gain of 17 km with the higher resolution model for attaining the same level of performance similarly we can see that giops and riops have about 72 and 62 of their hits below 10 cm and thus 28 and 38 above 10 cm indicating that riops has 26 more hits than giops for eddies with amplitudes larger than 10 cm i e riops hits giops hits riops hits 4 3 errors in eddy properties while it is useful to know whether a particular observed eddy has a corresponding match in the model analyses this does not tell us how well that eddy is represented as can be seen in fig 3 some matched eddies have quite different shapes and sizes given that the model grid resolution of riops is a factor of 3 higher than giops one would expect an improved representation as such is it possible to detect differences in the properties of matched eddies between riops and giops to answer this question we can investigate the relative contribution of the different terms on the right hand side of eq 1 to the total cost function value for each matched eddy hit the value of the total cost function as well as errors in radius amplitude and separation distance are binned and then normalized by the total number of hits here we have chosen to assess the differences in the three quantities without the normalization factors applied in eq 1 i e a 1 r 1 and 125 km to provide errors in physical units while this makes an assessment of the direct contribution to the cost function less clear it facilitates a physical interpretation of the histograms the resulting normalized histograms are shown in fig 9 the distribution of cost function values shows a clear shift to lower values for riops suggesting that riops does represent the eddies better than giops especially in terms of radius and distances fig 9 b d indeed the mode of the cost function distribution is only 0 4 for riops as compared to 0 7 for giops the lower cost function values in riops result from lower values in radius amplitude and distance errors table 4 in particular marked improvements in radius and distance errors fig 9 b d are found for riops by 25 and 21 respectively with fewer occurrences of matched eddies with errors above 20 km in radius and 40 km in separation distance 5 conclusions and discussion here we introduce a novel feature based verification methodology for operational oceanographic systems this methodology builds on previous efforts at eddy tracking and applies open source software to provide a robust method to evaluate the skill of operational oceanographic systems in terms of representing observed eddies as an initial demonstration an evaluation of eddy properties is made using two operational systems of different grid resolutions 1 4 and 1 12 a variety of different statistical measures are applied to a 4 year long dataset showing statistically significant improvements in the representation of eddy features by the higher resolution system at a 95 confidence level categorical verification metrics evaluated on paired forecast observation eddy features suggest that both systems provide an overall performance with a pod only slightly better than 50 and a far slightly below 30 an improvement in the higher resolution riops system of 4 75 for pod and 13 8 for far is found a significant number of misses occur for eddies at small radii and amplitude for both systems for example for eddies with radii less than 50 km pod values are below 50 whereas pod values are around 90 for radii above 120 km these results underscore the need for a robust and ideally objective method to omit small eddies from the analysis these small eddies may be spurious features in the verifying analysis global aviso gridded product in the current study or in the model analyses and are less likely to be robust features indeed amores et al 2018 find that the minimum radius for eddies in the north atlantic ocean in the aviso analyses to be around 50 km and suggest that the number of eddies in the aviso analyses larger than this radius is overestimated due to an aliasing of smaller eddies due to this limitation in the gridded observational analyses it may not be possible to extend the approach presented here to ocean models of higher resolution e g 1 36 or greater however future wide swath altimetry missions may improve the detection of small eddies morrow et al 2019 ma et al 2020 moreover the limit of constrained scales in the model analyses is likely much larger jacobs et al 2021 suggesting that low pass filtering of model fields should improve the skill scores and product reliability despite the uncertainty in the verification of small eddies the results of this study demonstrate the added value of an eddy resolving model riops as compared to an eddy permitting model giops in terms of eddy features with statistically significant improvements in pod and far at a 95 confidence level for eddies with amplitudes greater than 10 cm riops has pod values 10 30 higher with far values 5 10 lower than giops moreover we see that the 90 false alarm threshold occurs in riops and giops for radii approaching 79 km and 96 km respectively 18 reduction in riops similarly we can see that giops and riops have about 28 and 38 of their hits above 10 cm respectively indicating that riops has 26 more hits above the 10 cm threshold than giops a significant improvement in the properties of simulated eddies in riops is also found in particular results show a marked improvement in the eddy radius errors and separation distances by 25 and 21 respectively with fewer occurrences of errors above 20 km in radius and 40 km in separation distance in the present study we have demonstrated that an eddy tracking methodology is able to discern clear improvements in analyses produced using a 1 12 grid resolution system over one at 1 4 grid resolution note that the use of higher resolution background error covariances and other details of the assimilation scheme may contribute to the improvements seen for riops nonetheless this basic demonstration opens the door for a more detailed examination of eddy features in ocean prediction systems ideally one would wish for such a method to be able to provide sufficient detail in errors to guide the development of forecasting system improvements such feature based verification would greatly assist in improving the quality and usefulness of operational oceanographic products by tailoring them directly to user applications for example the approach could be used to study the time evolution of errors as a function of forecast lead time which may assist in identifying the underlying sources of model error numerical schemes diffusion etc the approach presented here could also be applied to follow the error of particular eddies over time amplitude and track thereby shedding light on issues such as the continuity in time e g performance of iau which are important for reanalysis applications finally the feature based verification approach provides physically meaningful feedback i e as compared to standard metrics such as standard deviation mean absolute error etc and enables an assessment of improvements in model physics and data assimilation schemes explicitly in terms of their direct impact on the eddy features an extension of the present work that could be investigated in future is the coincidence status approach developed by ma et al 2020 for matching eddies between two analyses the coincidence status includes five cases matched split merged missed and artefact this would increase the complexity of the verification metrics but could provide additional detail regarding uncertain matches credit authorship contribution statement gregory c smith conceptualization methodology investigation writing original draft manuscript anne sophie fortin software visualization investigation reviewing and editing of the manuscript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we would like to thank evan mason for making his eddy tracking algorithm publicly available we would also like to express our sincere gratitude to antoine delepoulle for answering all of our questions and for helping us to resolve some technical issues we encountered while using the py eddy tracker algorithm special thanks to barbara casati for her important guidance on verification techniques and many thoughtful comments on the manuscript francois roy provided valuable technical assistance with python and ccmep systems we would also like to thank three anonymous reviewers for their constructive comments this study has been conducted using e u copernicus marine service information 
23853,numerical models solving the wave action balance equation have been widely used to simulate wind waves in situ measurements albeit sparse are crucial to the calibration and validation of numerical wave models in this study a novel hybrid approach was developed by integrating a physics based simulating waves nearshore swan model with machine learning algorithms to predict wind waves in a shallow estuary two machine learning methods bagged regression tree brt and artificial neural network ann were employed it was found that the hybrid approach brt swan could be an efficient tool for modelers to identify sources of error and calibrate parameters in physics based models in this study the wind direction and bottom friction coefficient were determined as the main factors causing errors in swan simulated significant wave height and peak wave period respectively furthermore it turned out that brt swan ann ann trained with brt swan results could achieve a similar level of accuracy to obs ann ann trained with field observations of wind waves thus the hybrid approach can be applied to estimate wave parameters removing the limitation of using scarce observations in developing a predictive ann model keywords artificial neural network regression tree swan modeling wave prediction shallow estuary 1 introduction measurements of nearshore waves are essential for designing and operating many coastal projects such as wetland restoration flood protection port and harbor development and coastal zone management etc however in situ measurements are usually spatially and temporally sparse and time consuming to achieve thus various models have been developed to simulate nearshore wave conditions including semi empirical e g young and verhagen 1996 karimpour et al 2017 numerical e g booij et al 1999 chen et al 2000 tolman 1991 and soft computing based wave models e g makarynskyy 2006 parker and hill 2017 during the past several decades significant progress has been made in physics based numerical wave models based on wave action and momentum balance principles phase resolving models based on boussinesq type equations can only be applied for projects with a limited size of hundreds of meters in nearshore regions e g chen et al 2000 for larger domains extending thousands of meters from the shoreline e g estuaries continental shelves gulfs phase averaged spectral models are more appropriate such as simulating waves nearshore swan booij et al 1999 for deep oceans the wave model wam brown 2010 hasselmann et al 1988 and wavewatch model mentaschi et al 2015 tolman 1991 can be employed to predict ocean waves although these numerical models can provide satisfactory estimations of wave parameters in general open research problems still remain such as the inaccurate model input of wind and water level the inadequate knowledge of physical processes in shallow waters and the high demand for computational resources e g parker and hill 2017 fringer et al 2019 semi empirical methods could be applied in small areas where local effects are negligible such as smb sverdrup munk bretschneider and spm shore protection manual but they have a lower accuracy compared to physics based numerical models malekmohamadi et al 2011 in the last two decades various soft computing based models have been proposed to study nonlinear relationships between input features and labels for wave prediction problems e g cornejo bueno et al 2016 sadeghifar et al 2017 machine learning techniques such as artificial neural networks ann support vector machines svm bayesian networks bn fuzzy inference systems fis and decision trees dt have been adopted in soft computing based models e g jain et al 2011 peres et al 2015 londhe and panchang 2018 revealed that most papers applying ann theories in coastal engineering were published in 2004 2009 and that number dropped in the post 2010 period some possible reasons include that anns only provide the location specific wave prediction and the prediction performance for extreme events remains an elusive problem londhe and panchang 2018 stated that anns might be best used as a supplementary tool to improve the efficiency and reliability of physics based wave models when location specific wave predictions were required james et al 2018 used anns and svms to surrogate swan for predicting significant wave height h s and characteristic wave period respectively their model ran over 4 000 times faster than swan and exhibited a similar level of accuracy for wave prediction in the region of interest malekmohamadi et al 2011 compared the performance of svm bn ann and adaptive neuro fis methods for mapping wind data to wave height in lake superior usa and found that all these methods except bn provided acceptable predictions for h s other machine learning applications include applying the recurrent neural network for short and long term forecasts and reconstruction of h s and output power of ocean waves pirhooshyaran and snyder 2020 pirhooshyaran et al 2020 and using fuzzy systems to predict h s and wave energy flux at one buoy location along the california coast with observation data from nearby buoys as inputs cornejo bueno et al 2016 all these machine learning techniques have distinctive pros and cons for example anns can learn and model nonlinear and complex relationships that are common in real life however there is no established rule for determining the structure of anns so heuristic techniques are required to develop a predictive network structure mahjoobi et al 2008 furthermore classical anns produce black box models and can only be used in deterministic environments londhe and panchang 2018 by contrast the logics of bn fis and dt are transparent so users can easily understand and make decision rules via visual inspection in the post process stage ellenson et al 2020 moreover bns and svms are probabilistic models which can handle uncertainties in model inputs and provide uncertainty quantification malekmohamadi et al 2011 overall soft computing based algorithms can be very useful for many prediction and classification problems in the field of coastal engineering if researchers can employ them selectively and rigorously using hybrid approaches data driven methods have also been applied to uncover error patterns within physics based numerical models fringer et al 2019 pointed out that machine learning could be used to reduce subjectivity by understanding sources of uncertainty and quantifying parameter choices in coastal ocean modeling differences between physics based model results and measurements can be induced by errors within the model itself e g parameterizations or biases in the input forcing function parker and hill 2017 nkwunonwo et al 2020 the bias correction bc techniques were employed by parker and hill 2017 to test global wavewatch iii hindcast and forecast datasets against buoy observations at multiple locations they found that the bc of wave model outputs was an effective tool for aligning wave model outputs with observations makarynskyy 2006 improved the accuracy of wam by training anns with differences between wam outputs and measurements producing estimates of model errors with 3 hour lead times in ellenson et al 2020 the bagged regression tree brt was applied to analyze the errors in 24 h forecasts of h s made by the global wavewatch iii ellenson et al 2020 used wavewatch iii outputs as input features and deviations between modeled and observed h s as labels and successfully reduced the scatter index of predicted h s by 19 overall the existing studies mainly focused on predicting or forecasting wave parameters with measured or simulated data using different machine learning algorithms however measured wave parameters are usually sparse and outputs from physics based wave models can be biased due to errors within the model itself or biases in the input forcing parker and hill 2017 as a result it may not be ideal for applying them directly to train anns to the best of the authors knowledge soft computing based methods have not been used to identify the main factors causing simulation errors in physics based wave models therefore the purpose of this study is to develop a hybrid approach integrating the physics based model swan with machine learning algorithms i e brt and ann to estimate wave parameters in a shallow estuary and employ it as an efficient tool to identify sources of error in physics based models moreover the feasibility of applying brt corrected swan results as inputs to train anns will be investigated this could remove the limitation of using scarce observations in developing a predictive ann model it should be emphasized that we are not comparing the accuracy of physics based and hybrid methods for determining which one has a greater advantage for simulating wind waves in shallow estuaries in this study the comparison between simulation results of different models aims to validate the performance of the novel hybrid approach 2 methodology in this study four wave models were developed to simulate wind waves in upper terrebonne bay a shallow estuary in louisiana usa first swan was used to predict significant wave height and peak wave period t p however swan results may not be accurate as inaccurate forcing inputs to swan or biases within the model itself can introduce errors to outputs therefore a hybrid approach brt swan was developed to resolve the issue providing a novel way for modelers to identify sources of error and calibrate parameters in physics based models furthermore as field measurements in shallow estuaries are usually scarce brt swan outputs could be used as supplementary data when observations were insufficient to develop ann models in the end the prediction performance of brt swan ann was investigated by comparing simulation results with the ones from the ann model trained with measurements obs ann a summary of the four wave models is listed below swan a physics based wave model using local bathymetry wind and water level forcing functions as inputs brt swan a hybrid approach integrating brt and swan the output from this model is the correction to swan results in this study brt swan results are considered as brt corrected swan results which are the sum of corrections and swan outputs brt swan ann a feedforward neural network trained with brt swan results obs ann a feedforward neural network trained with measured wave parameters the prediction skill of different models was evaluated in terms of root mean square error rmse bias scatter index si and r 2 the definitions of which are provided in appendix a the training and testing datasets of each model were kept the same so that the prediction skills of different models could be evaluated equitably 2 1 study area the study site is in upper terrebonne bay located west of the mississippi river in the northern gulf of mexico fig 1 it is surrounded by wetlands and bounded offshore by barrier islands in the south terrebonne bay experiences a diurnal tidal cycle with a tidal range of 0 1 to 0 2 m during equatorial tides and 0 3 to 0 6 m during tropic tides leonard and luther 1995 it has an average water depth of 1 7 m and a maximum water depth of 3 0 m everett et al 2019 the upper terrebonne bay suffers from significant marsh erosion with a wetland loss rate of approximately 60 km2 observed each year from 1932 to 2010 couvillion et al 2011 2 2 wave measurements a bottom mounted ossi ocean sensor systems inc pressure transducer i e wave gauge was deployed at 29 13 21 07 n 90 36 24 56 w in upper terrebonne bay during the whole year of 2012 the wave gauge was set to record a burst of 20 min every 30 min i e 48 bursts per day with a sampling frequency of 10 hz so that short wind waves could be resolved with a high sampling frequency during this study period however it was noticed that the water pressure measurements were unreliable toward the end of august 2012 therefore only the data from 01 01 2012 to 08 20 2012 were used in this study during march and april 2017 an ossi pressure transducer was deployed at 29 13 20 4 n 90 36 26 43 w which was 54 m away from the one deployed in 2012 the measured wave parameters of 2017 were used as an independent dataset to further validate the prediction skills of the hybrid approach developed in this study the data processing and analysis applied to the raw time series pressure data closely followed methods outlined in karimpour and chen 2016 the raw pressure data were first converted to water depth and then a wave spectral analysis was performed to extract desired wave parameters the ocean wave analyzing toolbox oceanlyz v1 4 was used for the wave spectral analysis karimpour and chen 2017 in this study we only focused on wind waves and the method in hwang et al 2012 was employed to separate sea and swell energies given that t p from oceanlyz v1 4 can be miscalculated when h s is small small waves with h s 7 cm were removed from the rest of the analysis moreover waves with t p 4 s were excluded because only wind waves were considered in this study the time series of measured wave parameters wind sea water level and wind data during the study period of 2012 are shown in fig 2 2 3 physics based wave model swan swan is a third generation spectral wave model used to predict wind wave generation and transformation in coastal waters holthuijsen et al 2004 the model solves the wave action balance equation to calculate the wave spectral evolution in temporal geographical and spectral spaces booij et al 1999 the wave action balance equation is written as 1 n t c g x n x c g y n y c g σ n σ c g θ n θ s σ where n is the wave action density t is the time x y are the horizontal cartesian coordinates θ is the wave direction taken counterclockwise from the geographical east and σ is the intrinsic radian frequency c g x c g y c g σ and c g θ denote speeds of energy propagation in the x space y space σ space and θ space respectively chen et al 2005 whitham 1974 on the right hand side s represents the source terms of wave generation energy dissipation and nonlinear wave wave interactions in this study the swan model was set up to predict the wave climate driven by local wind in terrebonne bay in 2012 the 2d nonstationary mode of swan version 40 91 was implemented with the backward space backward time finite difference scheme the physics included whitecapping depth limited wave breaking bottom friction refraction diffraction quadruplet interactions and triad interactions depth induced wave breaking was calculated based on the battjes and janssen 1978 formulation with a constant breaker parameter γ 0 73 the resolution in directional space was set to 10 for the wind sea simulation covering a full directional range of 360 the semi empirical expression derived from the jonswap joint north sea wave project model was employed for simulating the bottom friction dissipation in swan booij et al 1999 hasselmann et al 1973 the bottom friction coefficient was initially set as the default value 0 038 m2 s 3 and then calibrated in this study the model domain is shown in fig 1 a structured rectangular mesh with a 50 m resolution was used which could accurately resolve the complex shoreline geometry and nearshore bathymetry in the study area the wind data were obtained from the luml1 station located at 29 15 17 9 9 n 90 39 50 4 2 w inside terrebonne bay the water level condition was obtained from the gisl1 station at 29 15 54 0 0 n 89 57 28 8 0 w as it had the most consistent dataset when compared with nearby stations for the year of 2012 the forcing functions of the wind and water level were applied uniformly over the entire model domain more details of the model setup and the calibration process can be found in everett et al 2019 2 4 data driven wave model 2 4 1 bagged regression tree the regression tree combined with the ensemble technique known as the bagged regression tree was used in this study to determine error patterns within swan simulated wave parameters the label y i was set as the difference between measured and estimated wave parameters 2 y i h s obs h s swan o r y i t p obs t p swan the positive negative y i indicates that the parameter is underestimated overestimated the factors that were most likely to introduce errors in swan results were fed into brt as input features x i including the model forcing and the energy transformation simulated by swan specifically the model forcing contained the u and v wind speed data the energy transformation swan outputs included the energy dissipation and redistribution due to bottom friction s fri whitecapping s wcap quadruplet wave interaction s nl 4 triad wave interaction s nl 3 and depth limited wave breaking s surf the regression tree can map input features to labels by splitting instances input target pairs into different partitions so that partitions of points with a similar overestimation underestimation and similar environmental context can be established ellenson et al 2020 in other words data points encompassed by the same final partition have similar input features i e model forcing and energy transformation simulated by swan and similar label values i e simulation errors the partitions were constructed by minimizing the sum of variances in y i across all the partitions etemad shahidi and mahjoobi 2009 etemad shahidi and bonakdar 2009 fig 3 shows an example of how instances were divided based on threshold values to detect error patterns in swan simulated t p as mentioned in breiman et al 1984 the feature importance can be quantified by summing the total variance reduction associated with each input feature a higher feature importance value suggests that the error pattern can be better revealed when instances are partitioned by that input feature since it provides the most information to the brt algorithm ellenson et al 2020 as the logic of the regression tree is transparent it can be applied as a diagnostic tool to determine systematic errors within the model through relationships revealed from data 2 4 2 artificial neural network 2 4 2 1 general description in this study a composite neural network was developed to estimate wave parameters in the shallow estuary in upper terrebonne bay this novel composite network was designed based on prior knowledge of wave responses to forcing functions as well as the relationship between wave parameters for predicting wind waves in a shallow estuary input features to the network should involve forcing functions of wind and tide etc thus the measured u and v wind speed and the water depth data were applied as inputs to the network for modeling h s fig 4 since the information about h s is also essential for the t p prediction h s was further used as the input together with the wind and water depth for modeling t p as a result the loss function of the entire composite network was defined as the sum of error functions of h s and t p it is worth mentioning that although two independent networks could also be used to predict h s and t p separately they were not applied in this study as the error propagation could occur when the predicted h s was taken as an input for estimating t p by another independent ann model the composite network can reduce error propagation by estimating h s and t p simultaneously in a unified network architecture as illustrated in fig 4 the input features and labels of the obs ann and brt swan ann models can be found in table 1 specifically labels of obs ann were set as the hourly measured h s and t p whereas for the brt swan ann model labels were set as the corresponding simulation results from brt swan in other words the brt corrected swan results were used for developing ann models through comparing prediction skills of both methods the feasibility of replacing obs ann with brt swan ann for estimating wave parameters when long term field observations are unavailable could be explored it should be noted that previous wave measurements e g wave parameters measured 3 or 6 h ago were not included as input features for training anns in this study that is because the measured wave parameters were not from a permanent station but from a wave gauge temporarily deployed in 2012 as a result if previous wave measurements were applied as one of the input features the developed ann model could not predict waves in 2020 as wave measurements in 2020 were unavailable in other words cause effect wave models were built in this study in which only forcing functions e g wind and water level data were used to predict wave parameters londhe and panchang 2018 it is noted that other machine learning methods can be used as alternative options for learning the relationship between input features and labels for wave prediction problems e g long short term memory however since the results obtained from the proposed composite network are satisfactory investigations on other machine learning models are beyond the scope of this study in this study the maximum learning epoch and mean square error mse defined in appendix a of predicted parameters were applied to control the training procedure specifically the training procedure was stopped once the iteration number reached 2000 or one of the mses of h s or t p ceased to decrease hyperbolic tangent tanh was utilized as the activation function the initial weights in each layer were set to follow xavier normal distribution glorot and bengio 2010 and the initial biases were all set to zero normalization was applied to keep the input and output between 1 and 1 so that the adverse effect of the significant difference between various parameters could be avoided the adam optimization algorithm adaptive moment estimation was used as the network training function kingma and ba 2014 the initial learning rate was set as 0 01 and then decayed by 0 1 every 1000 iterations additionally a grid search method was applied to validate the selection of the hyperparameters and optimization algorithm appendix b 2 4 2 2 selection of the neural network architecture the network structure has a crucial influence on the prediction skill of anns in this study a total of 1164 anns 2 5 hidden layers with 10 300 nodes per layer were created to investigate the predictive skills of obs ann and brt swan ann with different network structures to quantify the prediction performance of anns the composite performance score cps was calculated based on error matrices including bias si and r 2 appendix a as a result the structure providing the highest total composite performance score tcps was considered to be the optimal one which is equal to the mean value of cpss for the prediction of h s and t p given the limited data samples in this study a k fold block cross validation method was used for selecting the optimum network structure fig 5 in this study the value k was chosen as five to ensure each training and validation group of data samples is large enough to be statistically representative of the broader dataset the testing dataset containing continuous hourly data from 03 01 2012 to 03 20 2012 was applied as an independent measurement of network performance after training the rest of the dataset was then partitioned into five blocked subsamples for each structure the network was separately trained five times such that each subsample was used once for validation zheng et al 2020 as a result five tcpss could be obtained based on the validation results for each structure and the mean value was used to represent the prediction performance of a particular structure the optimal network structure was identified by comparing the tcpss of all structures 3 results 3 1 physics based wave model swan a comparison between measured and swan simulated wave parameters is shown in fig 6 to compare the performance of the hybrid approach with swan later only the data within the testing period are present here 03 01 2012 03 20 2012 although the swan model underestimated the majority of t p and large h s it simulated the general trend of rises and falls therefore it is desirable to determine the error pattern within swan outputs so that corrections can be applied to increase the prediction accuracy of swan 3 2 hybrid approach 3 2 1 brt swan use the brt algorithm to correct swan results fig 7 shows scatter plots of observed versus simulated wave parameters by swan and brt swan models compared with swan outputs the brt swan approach reduced rmse by 30 2 and 54 6 for the h s and t p simulation respectively table 2 thus the brt algorithm can identify the error pattern within swan and make corrections to the predicted wave parameters especially for the t p simulation of wind waves fig 3 presents an example on how the data were split on threshold values of input features for establishing a tree structure during the training of t p model furthermore brt is able to identify the most influential features causing errors within swan it can be seen that the energy sink term caused by bottom friction s fri was the primary source of error in simulating t p fig 8 to justify this finding the bottom friction coefficient was decreased to 0 019 m2 s 3 in swan to investigate whether a better prediction skill can be achieved as a result rmse values of swan simulated t p and h s were decreased by 24 6 and 11 3 respectively figs 6 9 and table 2 the improved swan prediction skill for t p simulation confirmed holthuijsen et al s 2004 suggestion that a lower value of friction coefficient 0 019 m2 s 3 should be utilized for wave simulation in the area with a smoother seafloor this finding indicates that 0 019 m2 s 3 is an appropriate choice of bottom friction coefficient for simulating waves in shallow estuaries in the mississippi river delta the wave parameters simulated with the lower friction coefficient 0 019 m2 s 3 were further processed by brt swan it was found that the decreased friction coefficient not only enhanced the skill of swan in simulating t p but also substantially improved the accuracy of brt swan results table 2 figs 7 and 10 the further improvement of brt swan simulated t p suggested that 0 019 m2 s 3 is still not the optimal friction coefficient for modeling t p in swan nevertheless decreasing the bottom friction coefficient is indeed a correct way to improve the prediction skill of swan for simulating t p furthermore fig 8 shows that the swan simulated h s was greatly impacted by both u and v wind speed data later in the discussion section the influences of wind speed and wind direction were examined to determine which one has a more significant impact on the prediction skill of swan for simulating h s 3 3 brt swan ann use brt swan results to train anns for predicting wave parameters because the prediction performance of swan increased when a reduced friction coefficient was applied the bottom friction coefficient was set to 0 019 m2 s 3 for the rest of the study to determine the optimal network structure for brt swan ann a total of 1164 structures were examined with the 5 fold block cross validation method fig 11 shows an example of the mean value of tcpss averaged over five groups of validation error statistics of h s and t p for selected models 2 5 hidden layers with 8 16 32 64 128 and 256 nodes per layer it can be observed that the simulation skills are similar when the networks have 2 4 hidden layers the model shows overfitting patterns when the structure has five layers with more than 100 nodes per layer reducing the simulation accuracy the optimal structure for brt swan ann was identified as two hidden layers of 26 nodes with the highest tcps of 0 860 to assess the prediction ability of the optimal structure for unseen cases the developed brt swan ann model was applied to simulate wave parameters and then compared with the measured data 03 01 2012 to 03 20 2012 among the five divisions of the dataset shown in fig 5 the first division produced the best prediction of h s and t p with the network structure of two hidden layers of 26 nodes therefore in this study the testing and validation datasets were set as the continuous hourly data from 03 01 2012 to 03 20 2012 and from 07 01 2012 to 08 20 2012 respectively the training dataset included the rest of the data the comparisons between the brt swan ann results and measurements are shown in fig 12 it can be seen that predictions correlate well with measurements suggesting that the brt swan ann model is able to learn the nonlinear relationship between input features and labels for wave prediction in the shallow estuary table 3 provides the error metrics of the observed and predicted data the small rmse and large r 2 values further substantiate that brt swan ann has a good predictive skill for estimating h s and t p of wind seas in the project site 3 4 data driven wave modeling obs ann the same procedure was carried out to identify the optimal structure for the obs ann model the structure with two layers of 16 nodes per layer turned out to be the optimal one for predicting h s and t p fig 13 shows the comparison between wave parameters measured and simulated by obs ann the error metrics of wave parameters simulated by obs ann are very close to the ones by brt swan ann table 3 therefore obs ann can be replaced by the integrated brt swan ann approach removing the limitation of developing a predictive ann using scarce measurements 4 discussion 4 1 the main factor inducing errors in swan simulated h s brt swan determined that the wind data and the bottom friction coefficient were major sources of errors for swan simulated h s and t p respectively fig 8 to verify the influence of the energy sink by bottom friction in swan simulation the bottom friction coefficient was decreased to 0 019 m2 s 3 as a result rmse values of swan simulated t p and h s were decreased by 24 6 and 11 3 respectively section 3 2 1 for the h s simulation the influence of wind speed and wind direction converted from the u and v wind speed data was discussed in this section as the study site is located inside a shallow estuary with several barrier islands offshore fig 1 the wind fetch can be very sensitive to the wind direction fig 14 shows the relation between wind fetch and wind direction with a resolution of 3 degrees the wind fetch across the gaps between barrier islands cannot be quantified precisely 45 km and is marked as black in the figure it can be observed that small changes in wind direction can significantly influence the fetch length e g around 130 and 160 furthermore the accuracy of measured wind direction by meteorological sensors wxt 520 at luml1 is 3 lumcon 2018 as a result a slight bias of the measured wind direction would greatly change the wind fetch leading to a huge deviation of the simulated h s by swan therefore the wind direction was determined as the major source of error in h s simulation the inaccurate input of wind speed can also cause errors in swan simulation however since the accuracy of measured wind speed is relatively high 0 3 m s at luml1 lumcon 2018 it was not considered as the main factor inducing simulation errors of h s in this study 4 2 further validation of brt swan ann using an independent dataset anns applied in coastal and ocean engineering are generally trained with measured wave data or simulated data from physics based wave models for wave prediction problems this study found that the hybrid brt swan approach can provide a novel way to develop a reliable dataset for training anns to predict the nearshore wave climate to further validate the prediction skill of the hybrid approach brt swan ann was used to simulate the wave climate at the same location in 2017 the wave gauge deployed during march and april 2017 was 54 m away from the one deployed in 2012 as the bathymetry and surroundings of the two wave gauges were similar it was assumed that wave measurements from 2017 could be utilized to validate the brt swan ann model developed with data in 2012 the input features to brt swan annincluded wind and water level conditions obtained from the same stations in 2017 fig 1 fig 15 shows the comparison between wave parameters measured and predicted by brt swan ann from 03 15 2017 to 04 15 2017 it can be observed that both simulated h s and t p have a relatively high level of accuracy thus the developed brt swan ann model shows a high prediction skill for simulating wave parameters in 2017 the advantage of the brt swan ann approach is that it removes the limitation of applying scarce observations in developing a predictive ann model however it should be emphasized that the available observations are required to be representative of the wave climate so that the brt algorithm can better learn error patterns and improve the accuracy of swan outputs for instance wave gauges can be deployed when extreme or representative events happen although this short period of measured data may not be sufficient to establish a predictive obs ann model brt swan ann enables datasets to be enlarged based on swan outputs so that the achieved model can have a higher prediction skill it is worth noting that in this study the available dataset only covers eight months in 2012 for developing brt swan ann so the seasonal and interannual variability of the wave climate in the estuary may not be fully captured this may limit the direct application of the developed brt swan ann model for rapid prediction of wave parameters during real time prediction in future research the brt swan ann model will be further trained with datasets from extreme events such as hurricanes and tropical storms furthermore more sophisticated neural networks e g pirhooshyaran et al 2020 will be explored as a result rapid predictions of wave parameters can be obtained at a much lower computational cost than swan 5 conclusions in situ measurements or simulated data from physics based wave models are usually applied to develop anns for wave prediction problems however measured wave parameters are generally spatially and temporally sparse and outputs from physics based wave models can be biased due to errors within the model itself parametrizations or biases in the input forcing functions as a result it may not be ideal for applying them directly to train anns in this study a novel hybrid modeling approach was developed to resolve this issue which integrated swan with machine learning algorithms i e brt and ann for predicting wave parameters in a shallow estuary brt swan identified that the bottom friction coefficient had the most significant influence on the swan prediction of t p this finding was examined by decreasing the friction coefficient from 0 038 m2 s 3 to 0 019 m2 s 3 in swan and it turned out that rmse of the swan simulated t p was reduced by 24 6 the improved simulation accuracy confirmed the suggestion of holthuijsen et al 2004 that a lower value of friction coefficient 0 019 m2 s 3 should be utilized for simulating waves in areas with smoother seafloors therefore this finding indicates that 0 019 m2 s 3 is a good selection of the bottom friction coefficient in swan for simulating waves in shallow estuaries of the mississippi river delta moreover the hybrid approach found that u and v wind speed data had a large influence on the prediction skill of swan for simulating h s from an engineering point of view the input of wind direction and wind speed were examined instead as the study site is located inside an estuary with several barrier islands offshore the wind fetch is very sensitive to the wind direction therefore a slight bias in the measured wind direction could change the wind fetch and cause a significant deviation of the simulated h s by swan additionally the accuracy of measured wind direction by the meteorological sensors wxt 520 at luml1 is 3 supporting the finding of brt swan that wind direction was the major source of error in h s simulation furthermore it was found that field measurements of wind waves can be replaced by brt swan results for training anns the results from brt swan ann exhibited a similar level of accuracy to the ones from obs ann for wave prediction in 2012 the prediction skill of brt swan ann was further validated against the observed data at the same location in 2017 one advantage of the brt swan ann model is that it removes the limitation of applying scarce observations in developing a predictive ann model although a short period of measured data may not be sufficient to establish a predictive obs ann model the brt swan ann enables the dataset to be enlarged based on swan outputs and the developed ann model can have a higher prediction skill overall this study shows that the hybrid modeling approach is a useful tool for predicting wind waves in terrebonne bay the hybrid approach can determine error patterns within the physics based wave model forming an efficient method for modelers to identify sources of error and calibrate parameters in physics based models furthermore it was validated that the hybrid approach brt swan ann can be applied to estimate wave parameters which greatly removes the limitation of using scarce observations in developing a predictive ann model credit authorship contribution statement nan wang methodology software writing original draft qin chen conceptualization methodology writing review editing supervision project administration funding acquisition ling zhu investigation writing review editing hao sun resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we are pleased to acknowledge the national science foundation award grant number 1856359 and the lsu high performance computing facility for providing access to the cluster supermic thanks to dr steve brandt for his assistance in hpc usage and ashley ellenson for open sourcing their brt codes appendix a statistical measures given below are utilized to evaluate the performance of the developed models 3 m s e m s e i n y i y i 2 n 4 r m s e r m s e i n y i y i 2 n 5 s i s i r m s e y 6 b i a s b i a s 1 n i n y i y i 7 r 2 r 2 i n y i y i 2 i n y i y i 2 i n y i y i 2 2 8 normalized s i performance s i 1 s i 9 normalized b i a s performance b i a s 1 a b s b i a s y 10 composite performance score c p s r 2 s i b i a s 3 11 total composite performance score t c p s 1 2 c p s h s c p s t p in which n is the number of samples y i is the estimated values and y i is the true value appendix b in this study a series of optimization algorithms were applied to develop neural networks including adam bayesian regulation backpropagation br levenberg marquardt backpropagation lm scaled conjugate gradient backpropagation scg bfrs quasi newton backpropagation bfg one step secant backpropagation oss and conjugate gradient backpropagation with powell bealerestarts cgb the results show that testing errors of wave parameters were lowest when the adam was used as the network training function table a 1 therefore adam was applied as the optimization algorithms in this study for both brt swan ann and obs ann training then a cross validation grid search method was used to select the optimal initial learning rate and get the best performing configuration for training the simulation outputs were generated using constant or annealing learning rates in adam table a 2 the results indicate that the best simulation results could be obtained when the initial learning rate was set as 0 01 and then decayed by 0 1 every 1000 iterations thus the annealing learning rate was used in this study to develop both brt swan ann and obs ann models 
23853,numerical models solving the wave action balance equation have been widely used to simulate wind waves in situ measurements albeit sparse are crucial to the calibration and validation of numerical wave models in this study a novel hybrid approach was developed by integrating a physics based simulating waves nearshore swan model with machine learning algorithms to predict wind waves in a shallow estuary two machine learning methods bagged regression tree brt and artificial neural network ann were employed it was found that the hybrid approach brt swan could be an efficient tool for modelers to identify sources of error and calibrate parameters in physics based models in this study the wind direction and bottom friction coefficient were determined as the main factors causing errors in swan simulated significant wave height and peak wave period respectively furthermore it turned out that brt swan ann ann trained with brt swan results could achieve a similar level of accuracy to obs ann ann trained with field observations of wind waves thus the hybrid approach can be applied to estimate wave parameters removing the limitation of using scarce observations in developing a predictive ann model keywords artificial neural network regression tree swan modeling wave prediction shallow estuary 1 introduction measurements of nearshore waves are essential for designing and operating many coastal projects such as wetland restoration flood protection port and harbor development and coastal zone management etc however in situ measurements are usually spatially and temporally sparse and time consuming to achieve thus various models have been developed to simulate nearshore wave conditions including semi empirical e g young and verhagen 1996 karimpour et al 2017 numerical e g booij et al 1999 chen et al 2000 tolman 1991 and soft computing based wave models e g makarynskyy 2006 parker and hill 2017 during the past several decades significant progress has been made in physics based numerical wave models based on wave action and momentum balance principles phase resolving models based on boussinesq type equations can only be applied for projects with a limited size of hundreds of meters in nearshore regions e g chen et al 2000 for larger domains extending thousands of meters from the shoreline e g estuaries continental shelves gulfs phase averaged spectral models are more appropriate such as simulating waves nearshore swan booij et al 1999 for deep oceans the wave model wam brown 2010 hasselmann et al 1988 and wavewatch model mentaschi et al 2015 tolman 1991 can be employed to predict ocean waves although these numerical models can provide satisfactory estimations of wave parameters in general open research problems still remain such as the inaccurate model input of wind and water level the inadequate knowledge of physical processes in shallow waters and the high demand for computational resources e g parker and hill 2017 fringer et al 2019 semi empirical methods could be applied in small areas where local effects are negligible such as smb sverdrup munk bretschneider and spm shore protection manual but they have a lower accuracy compared to physics based numerical models malekmohamadi et al 2011 in the last two decades various soft computing based models have been proposed to study nonlinear relationships between input features and labels for wave prediction problems e g cornejo bueno et al 2016 sadeghifar et al 2017 machine learning techniques such as artificial neural networks ann support vector machines svm bayesian networks bn fuzzy inference systems fis and decision trees dt have been adopted in soft computing based models e g jain et al 2011 peres et al 2015 londhe and panchang 2018 revealed that most papers applying ann theories in coastal engineering were published in 2004 2009 and that number dropped in the post 2010 period some possible reasons include that anns only provide the location specific wave prediction and the prediction performance for extreme events remains an elusive problem londhe and panchang 2018 stated that anns might be best used as a supplementary tool to improve the efficiency and reliability of physics based wave models when location specific wave predictions were required james et al 2018 used anns and svms to surrogate swan for predicting significant wave height h s and characteristic wave period respectively their model ran over 4 000 times faster than swan and exhibited a similar level of accuracy for wave prediction in the region of interest malekmohamadi et al 2011 compared the performance of svm bn ann and adaptive neuro fis methods for mapping wind data to wave height in lake superior usa and found that all these methods except bn provided acceptable predictions for h s other machine learning applications include applying the recurrent neural network for short and long term forecasts and reconstruction of h s and output power of ocean waves pirhooshyaran and snyder 2020 pirhooshyaran et al 2020 and using fuzzy systems to predict h s and wave energy flux at one buoy location along the california coast with observation data from nearby buoys as inputs cornejo bueno et al 2016 all these machine learning techniques have distinctive pros and cons for example anns can learn and model nonlinear and complex relationships that are common in real life however there is no established rule for determining the structure of anns so heuristic techniques are required to develop a predictive network structure mahjoobi et al 2008 furthermore classical anns produce black box models and can only be used in deterministic environments londhe and panchang 2018 by contrast the logics of bn fis and dt are transparent so users can easily understand and make decision rules via visual inspection in the post process stage ellenson et al 2020 moreover bns and svms are probabilistic models which can handle uncertainties in model inputs and provide uncertainty quantification malekmohamadi et al 2011 overall soft computing based algorithms can be very useful for many prediction and classification problems in the field of coastal engineering if researchers can employ them selectively and rigorously using hybrid approaches data driven methods have also been applied to uncover error patterns within physics based numerical models fringer et al 2019 pointed out that machine learning could be used to reduce subjectivity by understanding sources of uncertainty and quantifying parameter choices in coastal ocean modeling differences between physics based model results and measurements can be induced by errors within the model itself e g parameterizations or biases in the input forcing function parker and hill 2017 nkwunonwo et al 2020 the bias correction bc techniques were employed by parker and hill 2017 to test global wavewatch iii hindcast and forecast datasets against buoy observations at multiple locations they found that the bc of wave model outputs was an effective tool for aligning wave model outputs with observations makarynskyy 2006 improved the accuracy of wam by training anns with differences between wam outputs and measurements producing estimates of model errors with 3 hour lead times in ellenson et al 2020 the bagged regression tree brt was applied to analyze the errors in 24 h forecasts of h s made by the global wavewatch iii ellenson et al 2020 used wavewatch iii outputs as input features and deviations between modeled and observed h s as labels and successfully reduced the scatter index of predicted h s by 19 overall the existing studies mainly focused on predicting or forecasting wave parameters with measured or simulated data using different machine learning algorithms however measured wave parameters are usually sparse and outputs from physics based wave models can be biased due to errors within the model itself or biases in the input forcing parker and hill 2017 as a result it may not be ideal for applying them directly to train anns to the best of the authors knowledge soft computing based methods have not been used to identify the main factors causing simulation errors in physics based wave models therefore the purpose of this study is to develop a hybrid approach integrating the physics based model swan with machine learning algorithms i e brt and ann to estimate wave parameters in a shallow estuary and employ it as an efficient tool to identify sources of error in physics based models moreover the feasibility of applying brt corrected swan results as inputs to train anns will be investigated this could remove the limitation of using scarce observations in developing a predictive ann model it should be emphasized that we are not comparing the accuracy of physics based and hybrid methods for determining which one has a greater advantage for simulating wind waves in shallow estuaries in this study the comparison between simulation results of different models aims to validate the performance of the novel hybrid approach 2 methodology in this study four wave models were developed to simulate wind waves in upper terrebonne bay a shallow estuary in louisiana usa first swan was used to predict significant wave height and peak wave period t p however swan results may not be accurate as inaccurate forcing inputs to swan or biases within the model itself can introduce errors to outputs therefore a hybrid approach brt swan was developed to resolve the issue providing a novel way for modelers to identify sources of error and calibrate parameters in physics based models furthermore as field measurements in shallow estuaries are usually scarce brt swan outputs could be used as supplementary data when observations were insufficient to develop ann models in the end the prediction performance of brt swan ann was investigated by comparing simulation results with the ones from the ann model trained with measurements obs ann a summary of the four wave models is listed below swan a physics based wave model using local bathymetry wind and water level forcing functions as inputs brt swan a hybrid approach integrating brt and swan the output from this model is the correction to swan results in this study brt swan results are considered as brt corrected swan results which are the sum of corrections and swan outputs brt swan ann a feedforward neural network trained with brt swan results obs ann a feedforward neural network trained with measured wave parameters the prediction skill of different models was evaluated in terms of root mean square error rmse bias scatter index si and r 2 the definitions of which are provided in appendix a the training and testing datasets of each model were kept the same so that the prediction skills of different models could be evaluated equitably 2 1 study area the study site is in upper terrebonne bay located west of the mississippi river in the northern gulf of mexico fig 1 it is surrounded by wetlands and bounded offshore by barrier islands in the south terrebonne bay experiences a diurnal tidal cycle with a tidal range of 0 1 to 0 2 m during equatorial tides and 0 3 to 0 6 m during tropic tides leonard and luther 1995 it has an average water depth of 1 7 m and a maximum water depth of 3 0 m everett et al 2019 the upper terrebonne bay suffers from significant marsh erosion with a wetland loss rate of approximately 60 km2 observed each year from 1932 to 2010 couvillion et al 2011 2 2 wave measurements a bottom mounted ossi ocean sensor systems inc pressure transducer i e wave gauge was deployed at 29 13 21 07 n 90 36 24 56 w in upper terrebonne bay during the whole year of 2012 the wave gauge was set to record a burst of 20 min every 30 min i e 48 bursts per day with a sampling frequency of 10 hz so that short wind waves could be resolved with a high sampling frequency during this study period however it was noticed that the water pressure measurements were unreliable toward the end of august 2012 therefore only the data from 01 01 2012 to 08 20 2012 were used in this study during march and april 2017 an ossi pressure transducer was deployed at 29 13 20 4 n 90 36 26 43 w which was 54 m away from the one deployed in 2012 the measured wave parameters of 2017 were used as an independent dataset to further validate the prediction skills of the hybrid approach developed in this study the data processing and analysis applied to the raw time series pressure data closely followed methods outlined in karimpour and chen 2016 the raw pressure data were first converted to water depth and then a wave spectral analysis was performed to extract desired wave parameters the ocean wave analyzing toolbox oceanlyz v1 4 was used for the wave spectral analysis karimpour and chen 2017 in this study we only focused on wind waves and the method in hwang et al 2012 was employed to separate sea and swell energies given that t p from oceanlyz v1 4 can be miscalculated when h s is small small waves with h s 7 cm were removed from the rest of the analysis moreover waves with t p 4 s were excluded because only wind waves were considered in this study the time series of measured wave parameters wind sea water level and wind data during the study period of 2012 are shown in fig 2 2 3 physics based wave model swan swan is a third generation spectral wave model used to predict wind wave generation and transformation in coastal waters holthuijsen et al 2004 the model solves the wave action balance equation to calculate the wave spectral evolution in temporal geographical and spectral spaces booij et al 1999 the wave action balance equation is written as 1 n t c g x n x c g y n y c g σ n σ c g θ n θ s σ where n is the wave action density t is the time x y are the horizontal cartesian coordinates θ is the wave direction taken counterclockwise from the geographical east and σ is the intrinsic radian frequency c g x c g y c g σ and c g θ denote speeds of energy propagation in the x space y space σ space and θ space respectively chen et al 2005 whitham 1974 on the right hand side s represents the source terms of wave generation energy dissipation and nonlinear wave wave interactions in this study the swan model was set up to predict the wave climate driven by local wind in terrebonne bay in 2012 the 2d nonstationary mode of swan version 40 91 was implemented with the backward space backward time finite difference scheme the physics included whitecapping depth limited wave breaking bottom friction refraction diffraction quadruplet interactions and triad interactions depth induced wave breaking was calculated based on the battjes and janssen 1978 formulation with a constant breaker parameter γ 0 73 the resolution in directional space was set to 10 for the wind sea simulation covering a full directional range of 360 the semi empirical expression derived from the jonswap joint north sea wave project model was employed for simulating the bottom friction dissipation in swan booij et al 1999 hasselmann et al 1973 the bottom friction coefficient was initially set as the default value 0 038 m2 s 3 and then calibrated in this study the model domain is shown in fig 1 a structured rectangular mesh with a 50 m resolution was used which could accurately resolve the complex shoreline geometry and nearshore bathymetry in the study area the wind data were obtained from the luml1 station located at 29 15 17 9 9 n 90 39 50 4 2 w inside terrebonne bay the water level condition was obtained from the gisl1 station at 29 15 54 0 0 n 89 57 28 8 0 w as it had the most consistent dataset when compared with nearby stations for the year of 2012 the forcing functions of the wind and water level were applied uniformly over the entire model domain more details of the model setup and the calibration process can be found in everett et al 2019 2 4 data driven wave model 2 4 1 bagged regression tree the regression tree combined with the ensemble technique known as the bagged regression tree was used in this study to determine error patterns within swan simulated wave parameters the label y i was set as the difference between measured and estimated wave parameters 2 y i h s obs h s swan o r y i t p obs t p swan the positive negative y i indicates that the parameter is underestimated overestimated the factors that were most likely to introduce errors in swan results were fed into brt as input features x i including the model forcing and the energy transformation simulated by swan specifically the model forcing contained the u and v wind speed data the energy transformation swan outputs included the energy dissipation and redistribution due to bottom friction s fri whitecapping s wcap quadruplet wave interaction s nl 4 triad wave interaction s nl 3 and depth limited wave breaking s surf the regression tree can map input features to labels by splitting instances input target pairs into different partitions so that partitions of points with a similar overestimation underestimation and similar environmental context can be established ellenson et al 2020 in other words data points encompassed by the same final partition have similar input features i e model forcing and energy transformation simulated by swan and similar label values i e simulation errors the partitions were constructed by minimizing the sum of variances in y i across all the partitions etemad shahidi and mahjoobi 2009 etemad shahidi and bonakdar 2009 fig 3 shows an example of how instances were divided based on threshold values to detect error patterns in swan simulated t p as mentioned in breiman et al 1984 the feature importance can be quantified by summing the total variance reduction associated with each input feature a higher feature importance value suggests that the error pattern can be better revealed when instances are partitioned by that input feature since it provides the most information to the brt algorithm ellenson et al 2020 as the logic of the regression tree is transparent it can be applied as a diagnostic tool to determine systematic errors within the model through relationships revealed from data 2 4 2 artificial neural network 2 4 2 1 general description in this study a composite neural network was developed to estimate wave parameters in the shallow estuary in upper terrebonne bay this novel composite network was designed based on prior knowledge of wave responses to forcing functions as well as the relationship between wave parameters for predicting wind waves in a shallow estuary input features to the network should involve forcing functions of wind and tide etc thus the measured u and v wind speed and the water depth data were applied as inputs to the network for modeling h s fig 4 since the information about h s is also essential for the t p prediction h s was further used as the input together with the wind and water depth for modeling t p as a result the loss function of the entire composite network was defined as the sum of error functions of h s and t p it is worth mentioning that although two independent networks could also be used to predict h s and t p separately they were not applied in this study as the error propagation could occur when the predicted h s was taken as an input for estimating t p by another independent ann model the composite network can reduce error propagation by estimating h s and t p simultaneously in a unified network architecture as illustrated in fig 4 the input features and labels of the obs ann and brt swan ann models can be found in table 1 specifically labels of obs ann were set as the hourly measured h s and t p whereas for the brt swan ann model labels were set as the corresponding simulation results from brt swan in other words the brt corrected swan results were used for developing ann models through comparing prediction skills of both methods the feasibility of replacing obs ann with brt swan ann for estimating wave parameters when long term field observations are unavailable could be explored it should be noted that previous wave measurements e g wave parameters measured 3 or 6 h ago were not included as input features for training anns in this study that is because the measured wave parameters were not from a permanent station but from a wave gauge temporarily deployed in 2012 as a result if previous wave measurements were applied as one of the input features the developed ann model could not predict waves in 2020 as wave measurements in 2020 were unavailable in other words cause effect wave models were built in this study in which only forcing functions e g wind and water level data were used to predict wave parameters londhe and panchang 2018 it is noted that other machine learning methods can be used as alternative options for learning the relationship between input features and labels for wave prediction problems e g long short term memory however since the results obtained from the proposed composite network are satisfactory investigations on other machine learning models are beyond the scope of this study in this study the maximum learning epoch and mean square error mse defined in appendix a of predicted parameters were applied to control the training procedure specifically the training procedure was stopped once the iteration number reached 2000 or one of the mses of h s or t p ceased to decrease hyperbolic tangent tanh was utilized as the activation function the initial weights in each layer were set to follow xavier normal distribution glorot and bengio 2010 and the initial biases were all set to zero normalization was applied to keep the input and output between 1 and 1 so that the adverse effect of the significant difference between various parameters could be avoided the adam optimization algorithm adaptive moment estimation was used as the network training function kingma and ba 2014 the initial learning rate was set as 0 01 and then decayed by 0 1 every 1000 iterations additionally a grid search method was applied to validate the selection of the hyperparameters and optimization algorithm appendix b 2 4 2 2 selection of the neural network architecture the network structure has a crucial influence on the prediction skill of anns in this study a total of 1164 anns 2 5 hidden layers with 10 300 nodes per layer were created to investigate the predictive skills of obs ann and brt swan ann with different network structures to quantify the prediction performance of anns the composite performance score cps was calculated based on error matrices including bias si and r 2 appendix a as a result the structure providing the highest total composite performance score tcps was considered to be the optimal one which is equal to the mean value of cpss for the prediction of h s and t p given the limited data samples in this study a k fold block cross validation method was used for selecting the optimum network structure fig 5 in this study the value k was chosen as five to ensure each training and validation group of data samples is large enough to be statistically representative of the broader dataset the testing dataset containing continuous hourly data from 03 01 2012 to 03 20 2012 was applied as an independent measurement of network performance after training the rest of the dataset was then partitioned into five blocked subsamples for each structure the network was separately trained five times such that each subsample was used once for validation zheng et al 2020 as a result five tcpss could be obtained based on the validation results for each structure and the mean value was used to represent the prediction performance of a particular structure the optimal network structure was identified by comparing the tcpss of all structures 3 results 3 1 physics based wave model swan a comparison between measured and swan simulated wave parameters is shown in fig 6 to compare the performance of the hybrid approach with swan later only the data within the testing period are present here 03 01 2012 03 20 2012 although the swan model underestimated the majority of t p and large h s it simulated the general trend of rises and falls therefore it is desirable to determine the error pattern within swan outputs so that corrections can be applied to increase the prediction accuracy of swan 3 2 hybrid approach 3 2 1 brt swan use the brt algorithm to correct swan results fig 7 shows scatter plots of observed versus simulated wave parameters by swan and brt swan models compared with swan outputs the brt swan approach reduced rmse by 30 2 and 54 6 for the h s and t p simulation respectively table 2 thus the brt algorithm can identify the error pattern within swan and make corrections to the predicted wave parameters especially for the t p simulation of wind waves fig 3 presents an example on how the data were split on threshold values of input features for establishing a tree structure during the training of t p model furthermore brt is able to identify the most influential features causing errors within swan it can be seen that the energy sink term caused by bottom friction s fri was the primary source of error in simulating t p fig 8 to justify this finding the bottom friction coefficient was decreased to 0 019 m2 s 3 in swan to investigate whether a better prediction skill can be achieved as a result rmse values of swan simulated t p and h s were decreased by 24 6 and 11 3 respectively figs 6 9 and table 2 the improved swan prediction skill for t p simulation confirmed holthuijsen et al s 2004 suggestion that a lower value of friction coefficient 0 019 m2 s 3 should be utilized for wave simulation in the area with a smoother seafloor this finding indicates that 0 019 m2 s 3 is an appropriate choice of bottom friction coefficient for simulating waves in shallow estuaries in the mississippi river delta the wave parameters simulated with the lower friction coefficient 0 019 m2 s 3 were further processed by brt swan it was found that the decreased friction coefficient not only enhanced the skill of swan in simulating t p but also substantially improved the accuracy of brt swan results table 2 figs 7 and 10 the further improvement of brt swan simulated t p suggested that 0 019 m2 s 3 is still not the optimal friction coefficient for modeling t p in swan nevertheless decreasing the bottom friction coefficient is indeed a correct way to improve the prediction skill of swan for simulating t p furthermore fig 8 shows that the swan simulated h s was greatly impacted by both u and v wind speed data later in the discussion section the influences of wind speed and wind direction were examined to determine which one has a more significant impact on the prediction skill of swan for simulating h s 3 3 brt swan ann use brt swan results to train anns for predicting wave parameters because the prediction performance of swan increased when a reduced friction coefficient was applied the bottom friction coefficient was set to 0 019 m2 s 3 for the rest of the study to determine the optimal network structure for brt swan ann a total of 1164 structures were examined with the 5 fold block cross validation method fig 11 shows an example of the mean value of tcpss averaged over five groups of validation error statistics of h s and t p for selected models 2 5 hidden layers with 8 16 32 64 128 and 256 nodes per layer it can be observed that the simulation skills are similar when the networks have 2 4 hidden layers the model shows overfitting patterns when the structure has five layers with more than 100 nodes per layer reducing the simulation accuracy the optimal structure for brt swan ann was identified as two hidden layers of 26 nodes with the highest tcps of 0 860 to assess the prediction ability of the optimal structure for unseen cases the developed brt swan ann model was applied to simulate wave parameters and then compared with the measured data 03 01 2012 to 03 20 2012 among the five divisions of the dataset shown in fig 5 the first division produced the best prediction of h s and t p with the network structure of two hidden layers of 26 nodes therefore in this study the testing and validation datasets were set as the continuous hourly data from 03 01 2012 to 03 20 2012 and from 07 01 2012 to 08 20 2012 respectively the training dataset included the rest of the data the comparisons between the brt swan ann results and measurements are shown in fig 12 it can be seen that predictions correlate well with measurements suggesting that the brt swan ann model is able to learn the nonlinear relationship between input features and labels for wave prediction in the shallow estuary table 3 provides the error metrics of the observed and predicted data the small rmse and large r 2 values further substantiate that brt swan ann has a good predictive skill for estimating h s and t p of wind seas in the project site 3 4 data driven wave modeling obs ann the same procedure was carried out to identify the optimal structure for the obs ann model the structure with two layers of 16 nodes per layer turned out to be the optimal one for predicting h s and t p fig 13 shows the comparison between wave parameters measured and simulated by obs ann the error metrics of wave parameters simulated by obs ann are very close to the ones by brt swan ann table 3 therefore obs ann can be replaced by the integrated brt swan ann approach removing the limitation of developing a predictive ann using scarce measurements 4 discussion 4 1 the main factor inducing errors in swan simulated h s brt swan determined that the wind data and the bottom friction coefficient were major sources of errors for swan simulated h s and t p respectively fig 8 to verify the influence of the energy sink by bottom friction in swan simulation the bottom friction coefficient was decreased to 0 019 m2 s 3 as a result rmse values of swan simulated t p and h s were decreased by 24 6 and 11 3 respectively section 3 2 1 for the h s simulation the influence of wind speed and wind direction converted from the u and v wind speed data was discussed in this section as the study site is located inside a shallow estuary with several barrier islands offshore fig 1 the wind fetch can be very sensitive to the wind direction fig 14 shows the relation between wind fetch and wind direction with a resolution of 3 degrees the wind fetch across the gaps between barrier islands cannot be quantified precisely 45 km and is marked as black in the figure it can be observed that small changes in wind direction can significantly influence the fetch length e g around 130 and 160 furthermore the accuracy of measured wind direction by meteorological sensors wxt 520 at luml1 is 3 lumcon 2018 as a result a slight bias of the measured wind direction would greatly change the wind fetch leading to a huge deviation of the simulated h s by swan therefore the wind direction was determined as the major source of error in h s simulation the inaccurate input of wind speed can also cause errors in swan simulation however since the accuracy of measured wind speed is relatively high 0 3 m s at luml1 lumcon 2018 it was not considered as the main factor inducing simulation errors of h s in this study 4 2 further validation of brt swan ann using an independent dataset anns applied in coastal and ocean engineering are generally trained with measured wave data or simulated data from physics based wave models for wave prediction problems this study found that the hybrid brt swan approach can provide a novel way to develop a reliable dataset for training anns to predict the nearshore wave climate to further validate the prediction skill of the hybrid approach brt swan ann was used to simulate the wave climate at the same location in 2017 the wave gauge deployed during march and april 2017 was 54 m away from the one deployed in 2012 as the bathymetry and surroundings of the two wave gauges were similar it was assumed that wave measurements from 2017 could be utilized to validate the brt swan ann model developed with data in 2012 the input features to brt swan annincluded wind and water level conditions obtained from the same stations in 2017 fig 1 fig 15 shows the comparison between wave parameters measured and predicted by brt swan ann from 03 15 2017 to 04 15 2017 it can be observed that both simulated h s and t p have a relatively high level of accuracy thus the developed brt swan ann model shows a high prediction skill for simulating wave parameters in 2017 the advantage of the brt swan ann approach is that it removes the limitation of applying scarce observations in developing a predictive ann model however it should be emphasized that the available observations are required to be representative of the wave climate so that the brt algorithm can better learn error patterns and improve the accuracy of swan outputs for instance wave gauges can be deployed when extreme or representative events happen although this short period of measured data may not be sufficient to establish a predictive obs ann model brt swan ann enables datasets to be enlarged based on swan outputs so that the achieved model can have a higher prediction skill it is worth noting that in this study the available dataset only covers eight months in 2012 for developing brt swan ann so the seasonal and interannual variability of the wave climate in the estuary may not be fully captured this may limit the direct application of the developed brt swan ann model for rapid prediction of wave parameters during real time prediction in future research the brt swan ann model will be further trained with datasets from extreme events such as hurricanes and tropical storms furthermore more sophisticated neural networks e g pirhooshyaran et al 2020 will be explored as a result rapid predictions of wave parameters can be obtained at a much lower computational cost than swan 5 conclusions in situ measurements or simulated data from physics based wave models are usually applied to develop anns for wave prediction problems however measured wave parameters are generally spatially and temporally sparse and outputs from physics based wave models can be biased due to errors within the model itself parametrizations or biases in the input forcing functions as a result it may not be ideal for applying them directly to train anns in this study a novel hybrid modeling approach was developed to resolve this issue which integrated swan with machine learning algorithms i e brt and ann for predicting wave parameters in a shallow estuary brt swan identified that the bottom friction coefficient had the most significant influence on the swan prediction of t p this finding was examined by decreasing the friction coefficient from 0 038 m2 s 3 to 0 019 m2 s 3 in swan and it turned out that rmse of the swan simulated t p was reduced by 24 6 the improved simulation accuracy confirmed the suggestion of holthuijsen et al 2004 that a lower value of friction coefficient 0 019 m2 s 3 should be utilized for simulating waves in areas with smoother seafloors therefore this finding indicates that 0 019 m2 s 3 is a good selection of the bottom friction coefficient in swan for simulating waves in shallow estuaries of the mississippi river delta moreover the hybrid approach found that u and v wind speed data had a large influence on the prediction skill of swan for simulating h s from an engineering point of view the input of wind direction and wind speed were examined instead as the study site is located inside an estuary with several barrier islands offshore the wind fetch is very sensitive to the wind direction therefore a slight bias in the measured wind direction could change the wind fetch and cause a significant deviation of the simulated h s by swan additionally the accuracy of measured wind direction by the meteorological sensors wxt 520 at luml1 is 3 supporting the finding of brt swan that wind direction was the major source of error in h s simulation furthermore it was found that field measurements of wind waves can be replaced by brt swan results for training anns the results from brt swan ann exhibited a similar level of accuracy to the ones from obs ann for wave prediction in 2012 the prediction skill of brt swan ann was further validated against the observed data at the same location in 2017 one advantage of the brt swan ann model is that it removes the limitation of applying scarce observations in developing a predictive ann model although a short period of measured data may not be sufficient to establish a predictive obs ann model the brt swan ann enables the dataset to be enlarged based on swan outputs and the developed ann model can have a higher prediction skill overall this study shows that the hybrid modeling approach is a useful tool for predicting wind waves in terrebonne bay the hybrid approach can determine error patterns within the physics based wave model forming an efficient method for modelers to identify sources of error and calibrate parameters in physics based models furthermore it was validated that the hybrid approach brt swan ann can be applied to estimate wave parameters which greatly removes the limitation of using scarce observations in developing a predictive ann model credit authorship contribution statement nan wang methodology software writing original draft qin chen conceptualization methodology writing review editing supervision project administration funding acquisition ling zhu investigation writing review editing hao sun resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we are pleased to acknowledge the national science foundation award grant number 1856359 and the lsu high performance computing facility for providing access to the cluster supermic thanks to dr steve brandt for his assistance in hpc usage and ashley ellenson for open sourcing their brt codes appendix a statistical measures given below are utilized to evaluate the performance of the developed models 3 m s e m s e i n y i y i 2 n 4 r m s e r m s e i n y i y i 2 n 5 s i s i r m s e y 6 b i a s b i a s 1 n i n y i y i 7 r 2 r 2 i n y i y i 2 i n y i y i 2 i n y i y i 2 2 8 normalized s i performance s i 1 s i 9 normalized b i a s performance b i a s 1 a b s b i a s y 10 composite performance score c p s r 2 s i b i a s 3 11 total composite performance score t c p s 1 2 c p s h s c p s t p in which n is the number of samples y i is the estimated values and y i is the true value appendix b in this study a series of optimization algorithms were applied to develop neural networks including adam bayesian regulation backpropagation br levenberg marquardt backpropagation lm scaled conjugate gradient backpropagation scg bfrs quasi newton backpropagation bfg one step secant backpropagation oss and conjugate gradient backpropagation with powell bealerestarts cgb the results show that testing errors of wave parameters were lowest when the adam was used as the network training function table a 1 therefore adam was applied as the optimization algorithms in this study for both brt swan ann and obs ann training then a cross validation grid search method was used to select the optimal initial learning rate and get the best performing configuration for training the simulation outputs were generated using constant or annealing learning rates in adam table a 2 the results indicate that the best simulation results could be obtained when the initial learning rate was set as 0 01 and then decayed by 0 1 every 1000 iterations thus the annealing learning rate was used in this study to develop both brt swan ann and obs ann models 
23854,as waves interact with the slopes of coral reefs and other steep bathymetry profiles plunging breaking usually occurs where the free surface overturns and violent water motion is triggered resolving these surf zone processes pose significant challenges for conventional mesh based hydrodynamic models due to the rapidly deforming nature of the free surface and associated flows yet the accurate prediction of these surf zone hydrodynamics is critical for predicting a wide range of nearshore processes driven by wave breaking e g wave dissipation and energy transfers mean water levels and currents and wave runup in this study we assess the ability of the mesh free lagrangian particle based numerical modelling approach smoothed particle hydrodynamics sph based on dualsphysics to simulate the fine scale hydrodynamic processes driven by irregular wave transformation over a fringing reef profile by comparing results against detailed experimental observations from a physical modelling study to greatly improve the computational efficiency the sph model was coupled to the mesh based multi layer nonhydrostatic wave flow model swash with this coupled approach swash was used to efficiently simulate the evolution of non breaking waves from the wavemaker up to the fore reef slope with the sph model then used to simulate the detailed hydrodynamic processes over the reef from just offshore of the breakpoint to the shoreline the sph model was able to accurately reproduce the complex free surface deformations during plunging breaking the spectral evolution of waves across the reef flat including nonlinear wave shape the mean water levels and currents and wave runup at the shoreline using the long duration simulations 400 wave periods the model was able to reproduce the full range of wave motions over the reef from sea swell to infragravity frequencies including the increasing dominance of low frequency waves towards the shoreline and the large cross reef standing wave motions excited by the reef geometry keywords wave breaking surf zone wave runup wave modelling smoothed particle hydrodynamics dualsphysics 1 introduction energy within wind generated waves periods 1 25 s incident to coastlines drives a wide range of nearshore hydrodynamic processes that are responsible for wave driven coastal flooding sediment transport including coastal erosion and loads on coastal structures while the processes governing wave transformation in the nearshore have been widely investigated for many decades a complete understanding of the processes that control wave breaking in shallow water is still lacking including knowledge of how wave energy is dissipated and converted into other forms of water motion in the deep ocean where wind generated waves occur over a wide range of frequencies irregular waves propagate in groups which transform as they enter shallow water in the shoaling region and surf zone where rapid wave transformation occurs organised wave motion initially evolves into highly nonlinear wave shapes the free surface then overturns at the breakpoint and water motions spanning a wide range of spatial and temporal scales are generated ranging from small scale high frequency turbulence to larger scale slowly varying currents and wave driven mean water level variations wave setup svendsen 2006 the time variation of breaking waves of different height generated by wave groups also plays a critical role in nearshore hydrodynamics by generating low frequency infragravity waves that can often be a dominant source of water motion near shorelines bertin et al 2018 these low frequency waves can also reflect from shorelines creating cross shore partial standing waves that can become amplified by interactions with certain bathymetry profiles such as reefs e g buckley et al 2018 péquignet et al 2009 gawehn et al 2016 becker et al 2016 numerical wave models used to predict these nearshore hydrodynamics can be broadly classified as either phase averaged or phase resolving phase averaged or spectral models attempt to simulate the properties of waves usually based on linear wave theory lwt with empirical formulations to parameterise dissipation by wave breaking e g roelvink 1993 battjes 1978 thornton and guza 1983 phase resolving models aim to more directly simulate the nonlinear physics of individual waves with boussinesq e g shi et al 2012 madsen et al 1997 roeber et al 2010 and nonhydrostatic wave models e g zijlema et al 2011 ma et al 2012 being common examples while these models can directly predict how non breaking waves transform in the nearshore including through nonlinear wave wave interactions boussinesq and nonhydrostatic models do not capture all details of the wave breaking process as they only provide a single value representation of the free surface and hence cannot directly resolve the dynamics of overturning plunging waves that may influence how wave energy is dissipated blenkinsopp and chaplin 2007 while more computationally expensive than boussinesq and nonhydrostatic models phase resolving computational fluid dynamics cfd models attempt to more fully resolve the vertical structure of breaking through numerical solution of the navier stokes n s equations these cfd models can be broadly grouped into mesh based and mesh free models mesh based models simulate eulerian forms of the n s equations on numerical grids meshes mesh free models solve lagrangian forms of the n s equations which include those based on particle methods such as sph models where the motion of a fluid continuum is described using discrete fluid particles while mesh based cfd models have been successfully applied in a number of surf zone studies e g jacobsen et al 2012 higuera et al 2013 chella et al 2016 mostert and deike 2020 they still face a primary challenge in how to accurately and efficiently resolve the complex rapidly deforming free surfaces of breaking waves on fixed meshes numerical approaches have been developed to more accurately resolve the free surface such as the volume of fluid vof method hirt and nichols 1981 that has been most widely used in cfd applications of nearshore waves however these approaches can require high grid resolution at substantial computational expense to avoid significant errors in fluid properties near air water interfaces with development of optimal implementations still being an active area of research roenby et al 2016 lagrangian mesh free particle based models such as smoothed particle hydrodynamics sph used in the present study offer great appeal for simulating wave breaking given that fluid at the free surface does not need to conform to a specified grid violeau 2012 in addition numerical implementations of particle based models i e based on sph using weakly compressible flow theory are ideally suited for massive parallelisation e g on graphics processor units gpus e g domínguez et al 2013 allowing for larger scale cfd simulations to be conducted much more efficiently nevertheless despite many advances occurring over the past decade sph models also face a number challenges that are often distinct from mesh based models which have motivated considerable research over the past decade e g gotoh and khayyer 2018 violeau and rogers 2016 vacondio et al 2021 since early applications of sph models to study breaking waves dalrymple and rogers 2006 lo and shao 2002 sph applications to nearshore hydrodynamic problems have greatly accelerated over the past decade see gotoh and khayyer 2018 for a review initially computational limitations restricted these nearshore wave applications of sph models to relatively small domains and or using coarse resolution with simulations of relatively short duration just like mesh based cfd model counterparts hence focusing on regular or solitary waves that could be conducted within order 10s of wave periods e g dalrymple and rogers 2006 lo and shao 2002 gotoh et al 2004 with advances in computational performance larger scale and or longer duration applications of cfd models both mesh based and mesh free are becoming increasingly possible including simulations of more realistic irregular wave conditions that require simulating of order 100 wave periods or longer the ability to simulate irregular waves is often important to provide a more complete description of nearshore hydrodynamics as breaking wave groups generate infragravity waves that often become a dominant source of water motion near shorelines some cfd modelling studies have successfully simulated infragravity wave dynamics generated by irregular waves over sandy beaches and armoured foreshores e g torres freyermuth et al 2010 wen and ren 2018 which have tended to resolve approximately 100 wave periods that is sufficient to simulate higher frequency infragravity motions at wave group time scales however for other nearshore systems much longer period infragravity motions can often be dominant especially when these waves interact with larger scale bathymetric features such as reefs e g buckley et al 2018 gawehn et al 2016 becker et al 2016 in this study we applied the sph approach using dualsphysics domínguez et al 2021 to conduct highly resolved numerical simulations of irregular wave transformation over a fringing reef profile to investigate the capability of the model to predict the broad range of hydrodynamic processes that contribute to water level variability across the reef including the nonlinear evolution and dissipation of sea swell waves the generation and propagation of infragravity waves wave setup and mean currents and wave runup at the shoreline the model was validated using detailed measurements of waves velocities mean water levels and wave runup from a physical modelling study of a 1 36 scaled fringing reef profile with a steep fore reef slope and wide reef flat conducted in a 55 m long wave flume by buckley et al 2015 fig 1 in order to greatly boost computational efficiency the dualsphysics model was coupled to the phase resolving nonhydrostatic wave flow model swash zijlema et al 2011 that simulated waves in the region offshore of the reef thus concentrating the sph simulations in shallow water where wave transformation occurs over the reef profile using this coupled modelling approach long duration simulations were achieved duration 400 peak wave periods or equivalent to 90 min in field time scales which enabled the low frequency motions that make the dominant swash contribution to runup to be accurately resolved overall the results from these simulations provide an unprecedented view of the wave transformation within a reef surf zone at fine resolution providing new insight into the range of wave driven reef hydrodynamic processes that are responsible for wave runup at reef coastlines 2 model description 2 1 the sph approach the numerical simulations were conducted using the lagrangian mesh free sph approach where a fluid continuum is discretised into particles that represent computational nodal points where mass and momentum conservation laws n s equations are solved monaghan 1992 the kinematic and dynamic properties of each particle i e position density pressure and velocity are then determined by interpolation of the properties of neighbouring particles using a weighted kernel function w applied over a characteristic smoothing length h sph therefore in the sph approach any function f r in coordinate space r is mathematically defined by the integral expression 1 f r f r w r r h sph d r this function f can be discretised based on particles where the approximation of the function is interpolated at particle i and the summation is performed over all the particles j that are located within the kernel region 2 f r i j f r j w r i j h sph v j where v j m j ρ j is the volume associated with a neighbouring particle j r i j r i r j is the distance between particle i and j and m and ρ are mass and density respectively to achieve a sufficient number of particle interactions within the kernel while still constraining the number of neighbour particle interactions requiring computation the kernel function in eq 2 is implemented with a finite distance cut off note that in this study we use a quintic kernel where particle interactions at distances 2 h sph are neglected wendland 1995 in this study the n s equations are solved using the weakly compressible sph wcsph approach where following monaghan 1994 pressure p is efficiently obtained through its relation to density by solving an equation of state in the form batchelor 1974 3 p b ρ ρ 0 γ 1 where γ 7 is the polytropic constant and b c 0 2 ρ 0 γ is defined based on the reference density ρ 0 1000 kg m 3 and c 0 is the speed of sound at the reference density the ability to solve for pressure using eq 3 in an explicit form greatly reduces computational times and can also be more readily parallelised in numerical codes and is thus well suited for solution on gpus see below however the main drawback of wcsph is the potential for noise in the pressure density fields which is often mitigated by employing a range of density diffusion approaches molteni and colagrossi 2009 with use of the δ sph formulation being common antuono et al 2012 in the present study we use a new density diffusion term based on fourtakas et al 2019 that is less dissipative compared to the standard δ sph approach which as we show below offers improvements in the prediction of wave propagation over long distances within the wcsph approach conservation of mass is expressed as 4 d ρ i d t j m j u i j i w i j δ h sph c 0 j ψ i j i w i j v j where u i j u i u j with u i d r i d t representing the velocity of particle i and the last term in eq 4 is a diffusion term based on fourtakas et al 2019 here δ 0 1 is a specified coefficient and ψ i j is a density diffusion term see section 2 2 similarly conservation of momentum can be expressed as monaghan 1992 5 d u i d t j m j p i p j ρ i ρ j i w i j g γ i where g is gravitational acceleration and γ is a viscous dissipation stress term the viscous dissipation term is commonly described using an artificial viscosity approach monaghan 1992 but also variants based on turbulence closure models reviewed in gotoh and khayyer 2018 see section 2 2 2 2 the dualsphysics model in this study we applied version 5 0 of the open source sph model dualsphysics http dual sphysics org that solves the n s equations eqs 4 and 5 using the parallel computing power of either cpus and or gpus crespo et al 2015 domínguez et al 2021 the present model configuration and settings are generally similar to the study by lowe et al 2019 based on version 4 2 but include some improvements using new features in version 5 0 that are detailed below at the solid boundaries we applied a new modified dynamic boundary condition mdbc approach based on english et al 2021 this mdbc approach overcomes some of the drawbacks of the original dynamic boundary condition dbc approach in dualsphysics crespo et al 2007 resulting in less dissipation in flows near boundaries and reducing unphysical pressure density values for the boundary and adjacent fluid particles the mdbc approach employs ghost nodes using an extrapolation method similar to the one proposed in tafuni et al 2018 to calculate the properties of boundary particles requiring a layer consisting of several boundary particles to be included to avoid kernel truncation errors for fluid particles near the boundaries a layer of five boundary particles was used in this study which covers the distance of interaction defined by the kernel radius of 2 h sph while the mdbc can use the same boundary particle arrangement of the original dbc it defines the boundary interface at half the inter particle spacing dp from the inner most layer of boundary particles hence when simulating a physical model test the boundary interface must correspond to the physical boundary while the inner most layer of boundary particle is created at a distance equal to dp 2 in lowe et al 2019 the viscous dissipation term γ i in eq 5 was modelled based on the widely used artificial viscosity approach that is linearly proportional to local velocity gradients and parameterises the effect of a shear and bulk viscosity while the artificial viscosity approach is widely used in wave breaking applications de padova et al 2014 the scheme can be overly dissipative by generating excess shear forces taylor and miller 2012 which may affect coherent turbulent flow structures under breaking waves dalrymple and rogers 2006 therefore in the present study we also assessed the use of a laminar viscosity plus sub particle scale sps turbulence closure model gotoh et al 2004 dalrymple and rogers 2006 based on the large eddy simulation les approach smagorinsky 1963 analogous to sub grid scale sgs models used in turbulent incompressible flow simulations on fixed meshes for this approach the viscous dissipation term is expressed as 6 γ i j m j 4 ν 0 r i j i w i j ρ i ρ j r i j 2 ɛ 2 u i j laminar j m j τ i j i ρ i 2 τ i j j ρ j 2 i w i j sub particle scale turbulence where the first term describes the effect of laminar viscous stresses and second term represents the sps turbulent stresses here ν 0 is the kinematic viscosity ɛ 2 0 01 h sph 2 and τ i j is the sps stress tensor the sps stress tensor is defined as dalrymple and rogers 2006 based on a smagorinsky model smagorinsky 1963 7 τ i j ρ ν t 2 s i j 2 3 k δ i j 2 3 c i δ 2 δ i j s i j 2 where k is the sps turbulent kinetic energy s i j is the strain tensor δ is the initial inter particle spacing and c i 0 0066 is an empirical parameter the turbulent eddy viscosity ν t is defined as ν t c s δ 2 2 s i j s i j where c s 0 12 is the smagorinsky constant 2 3 swash coupling dualsphysics can generate waves using several different approaches in lowe et al 2019 moving boundary particles were used to simulate the movement of a piston wavemaker in a physical modelling study altomare et al 2017 which generated regular waves across two bathymetry profiles a plane beach ting and kirby 1996 ting 1995 and a fringing reef yao et al 2012 in that study lowe et al 2019 was able to substantially shorten the deep and flat offshore region in the flumes this greatly reduced computational times enabling an order 100 waves to be simulated while having negligible influence on the results due to the irregular wave conditions in the present study which required resolving the evolution of dispersing waves down the flume from the physical wave maker and simulating several hundred waves to achieve statistical convergence wave generation posed several challenges that required adopting new approaches thus in this present study the dualsphysics model was coupled to the nonhydrostatic wave flow model swash zijlema et al 2011 using a recently developed open boundary condition approach inlet outlet that passes flow properties from swash to dualsphysics verbrugghe et al 2019b in dualsphysics the open boundaries consist of a buffer zone width of 8 layers of particles when open boundaries are employed in coupled model applications physical quantities such as velocity pressure and surface elevation are imposed in the buffer zone the coupling uses a one way offline scheme with the swash model executed beforehand to provide the velocity and water surface elevation information at the coupling point location with swash run in multi layered mode velocities are interpolated between each swash layer and assigned to the sph particles within the buffer zone via postprocessing to avoid unwanted reflection at offshore inlet outlet boundary reflection compensation is also applied to correct the velocity and surface elevation imposed in the inlet zone the correction uses the measured free surface close to the buffer interface and linear long crested wave theory in shallow water to specify the reflection compensation verbrugghe et al 2019a altomare et al 2017 3 case study 3 1 experimental data buckley et al 2015 this study numerically simulates experimental results from buckley et al 2015 which measured wave transformation wave setup and wave runup across a scaled physical model of a fringing reef in a 55 m long wave flume fig 1a the bathymetry profile constructed from smooth marine plywood had a steep 1 5 fore reef slope a 14 m wide reef flat and a 1 12 sloping beach at the 1 36 geometric scaling used in the experiments the width of the reef flat is equivalent to 500 m at field scale which is typical of global averages falter et al 2013 irregular waves with a tma type spectrum were generated 31 m seaward of the reef crest with the crest defined as x 0 m by a piston type wave maker with second order wave generation and active reflection compensation in the experiments a wide range of incident wave conditions and offshore water levels were considered 16 runs in total table 2 of buckley et al 2015 due to the computational demand of the numerical simulations the present study focuses on investigating one of these experimental cases in detail run 2 which used a still water depth over the reef flat of h r 0 04 m equivalent to 1 4 m in field scale the wavemaker generated spectral waves with a root mean squared wave height of h r m s 0 0 06 m 2 2 m in field scale and a peak period t p 2 26 s 13 6 s in field scale this set of wave and water level conditions was intermediate and considered most representative of the broader range of conditions reported in the buckley et al 2015 experiment the experiment lasted 41 min during which time and water levels were measured at 18 locations along the flume with resistance type wave gauges and horizontal velocities were measured at 6 locations with electromagnetic current metres ecm with all instruments sampling synchronously at 40 hz fig 1a in addition georeferenced video imagery 2448 800 pixel resolution of the reef crest region from x 1 m to 1 m pixel resolution 1 mm was recorded at 25 hz images in pixel coordinates were converted to real world coordinates using six control points placed on the front glass of the flume and the methods outlined in bruder and brodie 2020 with this calibration the average horizontal and vertical root mean squared reprojection error was 1 2 mm 3 2 model configuration and numerical simulations the numerical simulations were conducted in a 2dv vertical plane the model domain extended from just seaward of the toe of the fore reef slope x 5 5 m coinciding with the swash coupling point see below to x 20 m fig 1a for the simulations an initial inter particle spacing of dp 3 mm was used with smaller values of dp having a negligible influence on the results see appendix a 1 this translated into 450 000 particles being simulated which varied on a wave by wave basis due to the inlet outlet boundary conditions the characteristic smoothing length h sph used for the kernel averaging eq 2 is related to the initial inter particle spacing according to h sph coefh 2 dp where coefh is a coefficient of order 1 that determines the spatial scale of interactions with surrounding particles if the value of coefh is too low this can lead to greater numerical dissipation e g wave attenuation when simulating relatively long wave flumes roselli et al 2018 due to weaker interactions with neighbouring particles however larger values of coefh reduce the effective model resolution in the present study a value of coefh 1 5 was used which fell within the range 1 2 1 8 that lowe et al 2019 found had minimal effect on wave transformation this was confirmed with initial testing with values of coefh between 1 4 and 1 8 having negligible influence on the results see table a 1 in appendix a 1 to model viscous dissipation both the artificial viscosity and laminar sps turbulence modelling approach eq 6 were considered in initial testing see appendix a 1 for a comparison of results with both approaches we note that for 2dv simulations the les based sps approach would only describe the 2d features of surf zone eddies and thus cannot resolve the small scale 3d turbulent flow structures that are required to properly resolve the turbulent energy cascade from large to small scale eddies where turbulent kinetic energy is dissipated nevertheless a number of 2d sph studies have found that use of an sps closure model can give robust results of surf zone hydrodynamics e g dalrymple and rogers 2006 gotoh et al 2004 makris et al 2016 shao and ji 2006 in appendix a 1 we found some slight improvement in wave transformation using the laminar sps approach compared to using artificial viscosity with less dissipation occurring within the inner surf zone following initial breaking which more closely matched the experiments therefore all results presented below are based on results using the laminar sps approach using a kinematic viscosity for water of ν 0 1 1 0 6 m2 s and default parameters within the smagorinsky turbulence model eq 7 the dualsphysics model was one way coupled to a larger swash model domain that extended to the offshore combined wave and velocity measurement location at x 15 3 m to x 20 m fig 1a the swash model was run in multi layer 2dv mode using a uniform horizontal resolution of 0 05 m and using 10 vertical sigma layers at the offshore open boundary a weakly reflective boundary condition was applied driven by fourier series coefficients amplitude frequency and phase that enabled arbitrary incident wave timeseries to be generated these fourier coefficients were derived from the incoming shoreward component of the water level timeseries from the offshore wave and velocity measurements at x 15 3 m with frequencies less than 1 2 the peak wave frequency removed to force the model with only incident ss waves following buckley et al 2015 the incoming water level signal was derived from the synchronised water level and velocity timeseries using a frequency domain algorithm in this approach fourier components of the water level and velocity spectra were applied with linear wave theory to compute directionally separated incoming and outgoing wave spectra with inverse fourier transformations used to generate timeseries of incoming and outgoing propagating wave signals refer to appendix b in buckley et al 2015 for details water levels and layer velocities output by swash at the x 5 5 m coupling location were converted offline to the inlet outlet boundary conditions water levels and velocities interpolated to particle locations to force dualsphysics the swash and dualsphysics models were run for a period commencing 10 min 600 s into the experiment for a duration of 16 min 960 s with output for both models stored at 20 hz based on the peak period t p 2 26 s this duration equates to 425 waves which was found to be adequate for the statistics of the full range of hydrodynamic processes to converge i e ss waves ig waves and wave setup see appendix a 1 the numerical simulations were conducted at the pawsey supercomputing centre in perth australia on its nimbus cloud computing infrastructure using a gpu enabled compute node housing an intel xeon silver 4215 2 50 ghz processor 8 core 16 thread 45 gb ram and a nvidia tesla v100 gpu 5120 cuda cores dualsphysics took 107 hr to simulate the 960 s experimental period using 450 000 particles with the swash model and wave boundary condition generation taking 24 min 3 3 post processing and data analysis to visualise features of the simulated breaking waves and relate these to the experimental georeferenced video imagery the air water interface was identified from the raw simulated particle data output by computing isosurfaces using the marching cubes algorithm lorensen and cline 1987 for quantitative comparison of the simulated water levels with the wave gauge data the densities of the particles were postprocessed to fixed grids resolution varying depending on application by interpolating onto the grid using a wendland kernel function with averaging length 2 h sph see section 2 1 post processing of the model output was used to compute surface elevations at a horizontal resolution δ x 5 cm we note that for cases where the free surface overturned there can be multiple air water interfaces and hence multiple definitions of the free surface lowe et al 2019 and that it is also unclear what water level a resistance wire wave gauge would exactly record when there is a mixture of water and air along the gauge within the surf zone stive and wind 1982 in this study we define the free surface elevation η by the vertical mass weighted average water level fig 2 8 η 1 ρ 0 h z ρ d z h which was obtained by vertically integrating the mass in the water column at δ z 1 mm vertical resolution from the bottom z h where h represents the still water depth fig 1b to the top of the interpolation grid denoted z z with the elevation z chosen to ensure the upper integration limit never contained water where by definition ρ 0 kg m 3 for void regions that do not contain water other gridded model output i e density pressure and velocity components were interpolated using the same wendland kernel function with different resolution chosen for different applications 1 a grid with resolution δ x 5 cm and δ z 5 mm extending over the full model domain and 2 a finer grid focused on the surf zone x 2 0 m to 4 0 m with resolution δ x 6 mm and δ z 3 mm to calculate wave runup a numerical water level gauge was implemented along the 1 12 beach slope at a height 3 mm above the bed equivalent to one dp the initial inter particle distance which searched for the runup elevation every 1 mm along the slope the results were analysed over the final 900 s of the dualsphysics simulations thus ignoring the initial 60 s of the simulation to allow time for the model results to spin up wave setup η was calculated from the time averaged water level relative to still water level by removing an offshore mean reference level defined by the spatial average between x 4 0 m to 2 0 m where wave setup setdown was negligible and the overbar denotes time averaging the wave component of water level variability η η η was used to compute wave spectra p η η f by applying welch s method using a hanning window with 50 overlap and a segment length of 212 samples 205 s equivalent to 20 min in field scale following buckley et al 2018 the spectra were separated into sea swell ss f 0 22 hz and infragravity ig f 0 22 hz frequency bands where 0 22 hz corresponds to one half of the peak frequency of the incident wave spectrum equivalent to a 27 s wave period in field scale the infragravity frequency band was further separated into high infragravity ig h 0 22 hz f 0 06 hz and low infragravity ig l f 0 06 hz contributions with the separation frequency equivalent to 100 s in field scale root mean squared wave heights h r m s for each frequency band were calculated as h r m s 8 m 0 where m 0 f l o w f h i g h p η η f d f is the zeroth spectral moment integrated over a range from f l o w to f h i g h based on the defined limits of each frequency band ss ig h and ig l other bulk wave parameters evaluated include the spectral period t m 1 0 a characteristic wave period that is commonly related to wave runup and overtopping predictions hofland et al 2017 which is defined as t m 1 0 m 1 m 0 where the n th spectral moment is m n 0 f n p η η f d f as well as the spectral width ν that measures how broadly distributed wave energy is across frequencies which is defined as ν m 0 m 2 m 1 2 1 to evaluate the cross shore evolution in the nonlinearity of wave shape the skewness sk and asymmetry as were calculated from the wave η timeseries as e g ruessink et al 2012 9 s k η 3 η 2 3 2 a s η h 3 η 2 3 2 where η h denotes the hilbert transform of η skewness describes how much more the crest is elevated and narrower relative to the trough while asymmetry describes how pitched forward backward i e saw toothed the waves are the skewness and asymmetry of the wave velocities across the reef were also investigated by replacing water level with velocity in eq 9 to investigate the generation and propagation of ig waves over the reef the relationship between the incident ss wave groups and ig waves were evaluated in the time domain by first filtering the water level timeseries into ss η s s and ig η i g wave components using a fifth order butterworth filter with a frequency cut off of f 0 22 hz using the ss water level timeseries at the offshore gauge location at x 15 34 m where synchronised wave and velocity timeseries were recorded fig 1a a hilbert transform was applied to the incoming component of the water level timeseries obtained by directional separation see section 3 2 to obtain the incoming ss wave envelope offshore ss e n v 0 by comparing lagged cross correlations between ss e n v 0 and the ig water level timeseries across the reef characteristic features of the ig wave generation and propagation including reflection were compared between the model predictions and observations e g janssen et al 2003 wave runup timeseries were used to compute the significant wave runup r s i g defined as 10 r s i g r setup r swash where r s e t u p is the steady mean runup elevation relative to the offshore mean water level i e wave setup at the shoreline and r s w a s h s s i g 2 is the swash contribution related to one half of the significant swash excursion s s i g the significant swash excursion was evaluated from the wave runup spectra as s s i g 4 m 0 where here m 0 is the zeroth spectral moment of the runup spectra similar to the approach used for wave heights the swash contribution to wave runup r s w a s h was decomposed into sea swell high infragravity and low infragravity contributions denoted r s w a s h s s r s w a s h i g h and r s w a s h i g l respectively 4 results 4 1 wave transformation and runup an illustrative example of a single breaking wave sequence simulated by the model is shown in fig 3 where the internal flow structure is visualised with colours representing the horizontal u component of velocity at the individual particle locations as the wave approaches the reef it becomes asymmetric with a near vertical face fig 3a the crest of the wave then overturns as a plunging jet fig 3b hitting a thin layer of water retreating down the fore reef slope which causes a splash up of the free surface fig 3c the volume of water in the breaking wave moves shoreward over a seaward directed bottom flow which oscillates vertically across the reef flat and generates a trail of surf zone eddies localised areas of negative velocities below positive velocities in the vertical plane fig 3d g the wave then develops into a more organised bore like feature that propagates shoreward across the reef flat fig 3 h j for comparison with the experimental observations this same breaking wave sequence is compared against georeferenced video imagery fig 4 with isosurfaces computed from the synchronised model predictions superimposed as red lines the sph model generally reproduces this free surface evolution well capturing the plunging jet the characteristics of the wave splash up and the propagation of a bore like feature across the reef flat for a longer 30 s sequence of the video record capturing 13 waves a time sequence of vertical columns of pixels are shown at two locations x 0 23 m and x 0 35 just seaward and shoreward of the reef crest respectively fig 4k l the superimposed free surface elevation timeseries agrees well with the video observations at both locations capturing the skewed and asymmetric shapes of the individual waves predictions of the transformation of individual waves height shape and phase across the reef also agree well with the full set of wave gauge measurements fig 5 the model captures the change in wave shape as they shoal on the fore reef slope near the crest where waves break i e gauges 7 9 fig 5 the height of the waves rapidly decreases and saw toothed bores emerge that are reproduced by the model as the back of the reef flat is approached the heights of the sea swell waves decrease appreciably within this back reef region individual waves tend to be associated with high frequency oscillations in the free surface which are present both in the observations and model predictions these high frequency oscillations are features of undular bores that are commonly observed during wave transformation over coral reef flats sous et al 2019 tissier et al 2018 the predicted sea swell wave heights h r m s s s closely follow the observations with h r m s s s initially shoaling on the fore reef rapidly decreasing after the breakpoint at x b 0 2 just seaward of the crest and then becoming nearly constant at h r m s s s 1 cm for x 1 m albeit still decaying towards shore at a low rate fig 6a there is only some discrepancy at the wave gauge at x 0 2 m located immediately at the break point where the observed h r m s s s is higher this gauge corresponds with the typical location of the overturning free surface during breaking fig 4 where the free surface takes multiple values and there would be significant entrainment of air both of which would likely add uncertainty to measurements at this location the height of the high frequency component of the ig waves h r m s i g h is also very well predicted fig 6b reproducing the growth observed on the fore reef the abrupt decrease in height near the breakpoint and the near constant values h r m s i g h 1 cm across the reef flat the variation in the low frequency component of the ig waves h r m s i g l across the reef is also generally reproduced accurately by the model predicting the increase in height shoreward of the reef crest and the oscillation in height with h r m s i g l varying from 0 5 to 1 cm across the reef flat fig 6c only the abrupt changes in h r m s i g l near the crest are not well reproduced by the model the growth of ig wave heights on the reef causes a substantial increase in the spectral period t m 1 0 shoreward of the reef crest including an oscillation in t m 1 0 due to the varying contribution of the low frequency ig component which is accurately predicted by the model fig 6d the growth in spectral width ν is also accurately reproduced with the model only slightly over predicting ν at the seaward limit of the reef flat x 0 3 m fig 6e the mean water level response to the breaking waves wave setup closely follows the observations with η plateauing to a value of 1 7 cm over the reef flat fig 6f as the waves transform across the reef the shapes skewness and asymmetry properties of individual waves change substantially the waves are initially symmetric s k 0 a s 0 on the fore reef but develop positive sk narrower crests wider troughs and negative as steeper faces as the reef crest is approached fig 7a the growth of negative as develops slightly earlier on the fore reef x 1 5 m whereas the positive sk develops near the reef crest x 0 m eventually on the reef flat x 3 m the sk and as become relatively constant decreasing only very slowly towards zero across the reef the model reproduces the spatial evolution of sk and as observed across the reef very well the detailed spectral evolution of waves across the reef is also accurately predicted where there is a change from a dominance of energy in ss frequencies on the fore reef x 0 fig 8a d a bimodal distribution of energy between ss and ig frequencies within the inner surf zone shoreward of the crest fig 8e and a gradual shifting to a dominance of ig wave energy towards the back of the reef flat fig 8f h wave runup predictions also agree well with the runup gauge measurements reproducing the range of low and high frequency water level contributions to runup at the shoreline fig 9a consistent with the wave spectra at the back of the reef the runup spectra are dominated by the low frequency component of ig motions which is accurately predicted by the model fig 9b when computing the significant runup r s i g using eq 10 both the observed and predicted values of r s i g are in excellent agreement table 1 the model also accurately reproduces the proportion of setup and swash contributions to r s i g 40 and 60 respectively as well as the ss ig h and ig l contributions to swash 30 30 and 40 respectively table 1 4 2 wave velocities and directionally separated wave properties to decompose incoming and outgoing wave motions using directional separation velocity timeseries predicted by the model were first compared at the five current metrelocations within the model domain fig 10 at all sites the velocity timeseries were accurately simulated fig 10 and trends in the velocity skewness and asymmetry across the reef were also reproduced fig 7b while the predictions of the velocity skewness closely matched the observations there was some discrepancy in the predictions of the velocity asymmetry at the two most seaward locations on the reef flat fig 7b the co located synchronised velocity and water level timeseries were used to directionally separate the incoming and outgoing reflected wave signals see sections 3 2 and 3 3 which was applied to both the experimental and model results for the ss waves the height of the incoming waves closely follows total h r m s s s due the minimal height of outgoing ss waves fig 11a on the fore reef the height of the incoming high frequency ig waves h r m s i g h is smaller than the outgoing waves fig 11b the incoming signal would be due to incident bound long waves longuet higgins and stewart 1962 and with the reflected heights being larger implies either the surf zone generation of ig waves and or any reflected ig waves from the reef and beach propagating offshore from the reef e g pomeroy et al 2012 the directionally separated low frequency ig wave heights h r m s i g l follow similar trends with the incoming heights smaller than the outgoing heights on the fore reef but with incoming heights becoming larger than outgoing heights on the reef flat x 0 m fig 11c unlike for the outgoing h r m s i g h which becomes higher on the fore reef relative to the reef flat the outgoing h r m s i g l is much more constant across both the fore reef and reef flat by converting these wave heights to a ratio of outgoing to incoming components we obtain an estimate of the local reflection coefficient r h r m s h r m s where the superscripts and denote the outgoing and incoming components respectively reflection coefficients are weak for the ss waves r 0 3 across the entire domain but much larger r 0 5 2 5 for the two ig components fig 11d on the reef flat r varies between 0 5 0 7 for the high ig waves and is larger r 0 7 1 0 for the low ig waves on the fore reef r values for the ig waves reach much higher values up to 2 5 consistent with the surf zone generation of outgoing ig waves and or strong reflection from the reef and beach while there are only five points of comparison where both co located wave and velocity measurements could be used for directional separation the agreement between the predicted and observed separated wave heights is generally good there is generally very good agreement at the three locations on the reef flat x 0 but r values for the high frequency ig components are slightly underpredicted at the fore reef location although similarly high values of r 1 5 are captured 4 3 low frequency wave dynamics given the importance of the ig wave contributions to the water level variability over the reef flat further aspects of ig wave dynamics are compared with the model predictions focusing on the ig frequency range f 0 22 hz the spectral distribution of wave energy across the reef shows spatial patterns with bands of high and low energy that are accurately reproduced by the model fig 12 these bands are formed by standing wave motions across the reef flat generated by interactions between incoming and outgoing ig waves which create a pattern of nodes locations of low potential energy and anti nodes locations of high potential energy buckley et al 2018 based on linear wave theory at a given cross shore location x the frequencies f n o d e where these nodes should occur can be theoretically predicted as buckley et al 2018 11 f n o d e 1 4 2 n 1 x x shoreline 1 g h η d x 1 where x s h o r e l i n e is the location of the shoreline and n is the standing wave mode number n 0 1 2 the theoretical frequencies of these nodes predicted using eq 11 as a function of distance x across the reef flat red lines fig 12 agree well with the nodes that are present in both the observations and model predictions this confirms that the ig wave energy on the reef flat is connected to standing wave motions linked to the reef bathymetry profile with these dynamics well reproduced by the model the forcing of infragravity waves in the nearshore is typically due to breaking wave groups longuet higgins and stewart 1962 battjes et al 2004 including over reef bathymetry profiles pomeroy et al 2012 péquignet et al 2009 becker et al 2016 buckley et al 2018 used the same experimental data to show how the groupiness of the incident ss waves generates ig wave motions in the surf zone that become standing waves over the reef flat that are amplified at the natural frequencies associated with the reef bathymetry profile to assess the ability of the model to predict the links between incident wave groups and ig wave generation fig 13 shows cross correlations between the offshore ss wave envelope ss e n v 0 and the low pass filtered ig water level signal η i g see section 3 3 at locations across the reef note that for the model comparison the ss e n v 0 was referenced to the swash water level timeseries at the offshore location x 15 3 m however the η i g timeseries was based on the swash results for locations offshore of the model coupling point x 5 5 m and based on dualsphysics results shoreward of this point fig 13b both the experimental observations and model predictions show very consistent patterns offshore of the reef crest x 0 m the correlation between ss e n v 0 and η i g is initially negative consistent with the presence of incident bound waves 180 deg out of phase that propagate at the group velocity red dashed lines fig 13 shoreward of the reef crest x 0 m the sign of the correlation switches to positive consistent with the generation of free ig waves via the breakpoint forcing mechanism and shoaling wave groups symonds et al 1982 pomeroy et al 2012 contardo et al 2021 that propagate shoreward at the shallow water free wave speed black dashed lines fig 13 also consistent with these infragravity wave generation mechanisms a negative correlation propagates seaward away from the surf zone which travels at the shallow water wave speed at the shoreline the positive correlation returns seaward consistent with reflection of the incoming free ig waves generated at the crest there is also evidence of some of this outgoing ig wave energy continuing to propagate offshore past the reef crest onto the fore reef although the correlation is much weaker than on the reef flat overall these results confirm that the model can accurately reproduce the main features of ig waves across the reef from generation to propagation moreover the excellent continuity in correlations across the boundary between the dualsphysics and swash models fig 13b indicates the model coupling approach provides a robust means to efficiently simulate both the irregular wave and associated ig wave dynamics 4 4 mean currents the detailed model output is used to investigate the mean current structure focusing on the region surrounding the reef crest 2 m x 5 m where wave transformation predominantly occurs in buckley et al 2015 the limited point measurements of velocities during the experiment did not make it possible to investigate the detailed vertically varying mean current fields generated over the reef e g undertow structure although these data can still provide useful points of comparison with the model predictions in the present study the modelled mean current field reveals a well defined undertow flow structure across the reef flat negative horizontal u velocities and a complex circulation pattern near the reef crest and along the fore reef slope fig 14b for reference the mean water level elevation solid grey line and representative crest and trough elevations defined based on the root mean squared wave amplitude h r m s 2 grey dashed lines are also superimposed the strength of the undertow decreases with distance across the reef flat x 0 m with these cross shore gradients in horizontal mass fluxes compensated by downward velocities that are strongest near the trough as the crest and trough elevations are defined here based on h r m s there is some onshore mass flux above the crest elevation due to the mass flux associated with the largest individual waves which is most pronounced near the crest there is also a highly concentrated region of strong flow down the fore reef slope x 0 m and strong upwelling occurring further above the slope this flow pattern leads to a clockwise eddy on the fore reef slope adjacent to the crest while on the reef flat the interface between onshore and offshore flow u 0 m s 1 white region coincides approximately with the trough elevation on the fore reef there is a substantial amount of onshore flow that occurs below the trough despite the limited point measurements of velocities available for comparison the modelled mean current velocities show consistency with the experimental observations with negative seaward directed mean currents at these locations that is characteristic of the undertow in the lower part of the water column fig 14c e the modelled undertow velocities generally agree well with the experimental measurements at these specific elevations although the modelled mean velocities are slightly stronger than the observations at the site on the fore reef slope x 1 8 m and at the most shoreward site x 4 25 m on the reef flat 5 discussion 5 1 model performance in this study we conducted a comprehensive investigation of the ability of the mesh free sph approach based on dualsphysics to accurately simulate the broad range of hydrodynamic processes across a fringing reef profile based on the experimental study by buckley et al 2015 this application posed several challenges notably the need to resolve the dynamics of the violently plunging waves while also requiring running long duration irregular wave simulations that have generally not been considered in analogous cfd models due to the prohibitive computational expense we demonstrated that the model was able to accurately predict the wide range of these complex hydrodynamic processes but only with new features recently implemented in dualsphysics including the improved model coupling with the nonhydrostatic model swash and using recent numerical improvements i e improved fluid solid boundary conditions and density diffusion terms that greatly reduced unphysical numerical dissipation see appendix a 1 in the buckley et al 2015 experimental setup a substantial portion of the length of the occupied region of the flume 30 contained the shallow 14 m wide reef flat which when converted to prototype field scale represented a 500 m reef flat that is typical of fringing coral reefs worldwide with the irregular wave breaking on the reef generating both substantial wave setup 2 cm and ig wave motions 2 cm height for the combined high and low ig contributions this represents a large portion of the initial still water depth 4 cm over the reef flat to supply this elevated water on the reef flat a substantial volume of water in the flume offshore of the reef must be transported onto the reef flat leading to a fall in the offshore water level i e any increase in the average water level over the reef will lead to a proportional 30 in this case decrease in the average offshore water level per mass conservation for the case of steady wave setup water can be added to the flume to compensate this effect of setup and maintain a desired offshore water level however for ig wave motions especially lower frequency contributions that can uniformly raise lower the entire water level over the reef this effect is unavoidable and can only be minimised by having a large volume of water offshore of the reef in the physical modelling experiment due to the height of these low ig waves being 1 cm fig 6c the offshore water level would vary at most by 3 mm at these low frequencies and hence is very small in the numerical model directly simulating the large offshore region spanning the complete flume would come at substantial computational expense which is especially undesirable considering that negligible wave transformation that occurs in this deep region to improve computational efficiency the offshore model domain can be truncated for example in the present study where the deep region offshore of the reef crest was shortened from 31 m to only 5 5 m the number of particles simulated decreases by a factor of 8 which implies a minimum eight fold increase in computational efficiency assuming approximate linear scaling with particle number yet this shorter offshore domain contains a much smaller volume of water that can substantially amplify offshore water levels as water flows on and off the reef flat therefore while it is possible to directly force this truncated domain at the offshore boundary using a numerical wavemaker or by coupling with the more efficient phase resolving model swash using the multi layered wavemaker or relaxation zone approach in dualsphysics altomare et al 2015b 2018 the constrained volume of water created by any impermeable offshore boundary condition is highly problematic instead in the present study we use new developments in model coupling using an inlet outlet approach in dualsphysics verbrugghe et al 2019b which enabled the volume of water in the sph domain to dynamically adjust in response to water levels and velocities imposed by large scale whole flume simulations conducted using swash our results indicate that this coupling approach is both accurate and robust enabling computationally efficient long duration simulations to be conducted at a fine resolution dp 3 mm such a fine resolution was necessary to accurately reproduce the hydrodynamic processes over the reef flat see appendix a 1 with the total h r m s averaging 2 5 cm on the reef flat the wave height to particle spacing ratio is equivalent to h r m s d p 8 which is comparable to the ratio of 10 that roselli et al 2018 recommended for wave propagation problems once waves rapidly transform in the surf zone near the reef crest the smaller residual waves that propagate across the shallow and wide reef flat can be sensitive to the cumulative effects of any numerical dissipation within the simulations for this reef profile initial model testing using the conventional numerical schemes for modelling fluid solid boundary interactions and density diffusion to reduce noise in dualsphysics schemes also widely used in other sph codes performed poorly for this application leading to large discrepancies in wave heights setup and runup over the reef see appendix a 1 2 using the new modified dynamic boundary condition mdbc formulation of english et al 2021 resulted in much better agreement in wave height and wave runup predictions and some slight improvement in wave setup see appendix a 1 2 table a 4 wave runup predictions were in particular grossly in error using the original dbc with the swash contribution to runup nearly completely attenuated at the shoreline see appendix a 1 2 fig a 3 due to the combination of excessive numerical dissipation occurring as waves propagate across the shallow reef flat and as they interact within the swash zone along the beach slope within the initial testing it was also apparent that use of a conventional artificial viscosity formulation with a typical artificial viscosity α value of order 0 01 was far too dissipative for simulating waves over this reef profile despite similar α values having been found to be optimal in many prior wcsph wave studies e g altomare et al 2015a roselli et al 2018 de padova et al 2014 the use of an artificial viscosity in wcsph simulations aims to not only parameterise the effect of physical combined bulk and shear viscosity but also to suppress noise arising from pressure density fluctuations inherent to wcsph test simulations conducted with low viscosity necessary to reduce numerical wave dissipation across the reef both using the artificial viscosity and laminar sps schemes were unstable necessitating the use of a density diffusion term ddt in the simulations yet using the original ddt based on molteni and colagrossi 2009 generated anomalous mean water levels in regions where wave breaking occurred see appendix a 1 2 figure a3b which is a known problem when applying this scheme to free surface problems antuono et al 2010 however using the new ddt scheme of fourtakas et al 2019 eliminated this issue resulting in accurate reproduction of the setup profile across the reef it is also noteworthy that the sph approach was able to accurately reproduce these complex hydrodynamic processes driven by plunging waves using essentially no tuning of model parameters the choice of parameters that gave optimum performance were all at default or typical values recommended in the literature including those found optimum in lowe et al 2019 for very different wave breaking conditions including for spilling waves breaking on a mild sloping beach however one important difference in the present simulations from those of lowe et al 2019 was the use of low viscosity due to how effective the new ddt was at suppressing noise in the absence of higher viscosity in the present study a laminar sps viscosity formulation was applied using a physically based kinematic viscosity of ν 0 1 1 0 6 m2 s for water which accurately reproduced both the wave transformation and runup however we also obtained comparable albeit slightly less accurate results using an artificial viscosity formulation with very low viscosity values i e α 1 0 4 much lower than typical values of α of order 10 2 common in the literature these results are broadly consistent with the analysis by meringolo et al 2019 who showed that due to both the artificial viscosity and ddt having dissipative properties that suppress noise in an wcsph scheme when an artificial viscosity is used in the absence of a ddt an important function of the artificial viscosity is simply noise suppression rather than incorporating the influence of actual physical viscosity while the present study found that the use of a sps turbulence model with a physically based kinematic viscosity performed well for this specific application as for the case of les applications on fixed grids the use of sps in 2dv cannot strictly resolve the range of turbulent motions that would be present including correctly resolving the turbulence energy cascade to fine scales that would require resolving 3d turbulent eddies to be able to properly assess an optimum approach to model turbulent viscosities would require direct measurements of the turbulent fields that were not available in buckley et al 2015 as well as comparing simulations conducted in 3d that would be considerably more computationally expensive 5 2 reef surf zone processes detailed experimental observations of the fine scale hydrodynamic processes within the roller region of depth limited breaking waves are still relatively limited with most of these studies tending to either miss a portion of data within the important crest to trough region inside the surf zone e g from optical interference due to aeration or have used conditions with mild breaking spilling conditions where a greater portion of the water column can be robustly sampled e g govender et al 2004 stive and wind 1982 huang et al 2009 kimmoun and branger 2007 ting and kirby 1994 stansby and feng 2005 for the extreme plunging waves on the steep reef slope in the buckley et al 2015 study where individual waves break on an effectively dry bed and the plunging jets tend to splash up well above incident crest heights fig 4 no analogous fine scale hydrodynamic observations exist within such breaking waves which may prove nearly impossible to achieve even using the most advanced experimental techniques presently available with these highly resolved sph simulations proving to be capable of very accurately reproducing the range of hydrodynamic processes that could be measured in buckley et al 2015 the use of the detailed model output provides a unique opportunity to fill these observational knowledge gaps while several studies have applied phase resolving boussinesq and nonhydrostatic models to investigate wave transformation across reefs e g lashley et al 2018 ma et al 2014 nwogu and demirbilek 2010 lashley et al 2020 rijnsdorp et al 2021 some studies have highlighted limitations with not directly resolving the vertical structure of overturning breaking waves within such models for example in simulations of the same buckley et al 2015 experiments using the depth averaged nonhydrostatic model xbeach nh lashley et al 2018 found that the model substantially underpredicted both wave setdown and setup this finding is broadly similar to other studies that have applied phase resolving depth averaged nonhydrostatic and boussinesq models to steeply sloping bathymetry profiles where both setdown and setup were also underpredicted e g skotner and apelt 1999 yao et al 2012 liu et al 2021 however we also note that da silva et al 2021 recently applied the multi layered nonhydrostatic model swash to this same buckley et al 2015 experimental case using two vertical layers and found both setdown and setup were better predicted than in lashley et al 2018 although still not predicted as accurately as in the present study by analysing the experimental data buckley et al 2015 compared setup predictions from radiation stress gradients estimated from linear wave theory where potential and kinetic energy are in balance finding that setdown setup were likewise substantially underpredicted instead they hypothesised that the dynamics within the wave roller were shifting radiation stress gradients shoreward into shallower water however given that the experimental observations of buckley et al 2015 were limited primarily to wave gauge observations with only limited near bed point velocities measurements most terms in the mean momentum balances could not be calculated to directly verify this further work is needed to quantify these mean momentum balances to assess how they can be most robustly captured in phase resolving e g boussinesq and nonhydrostatic wave models including the relative importance of incorporating both vertical resolution e g as in multi layered nonhydrostatic models and or directly simulating the overturning free surface e g as in detailed cfd models while wave setup made a substantial contribution to wave runup in this study contributing 40 to significant runup infragravity wave motions also had a comparably large influence on runup accounting for 75 of the significant swash contribution to runup equivalent to 45 of the total significant wave runup that includes setup sea swell contributions to wave runup for this reef case were small accounting for 25 of the swash contribution to runup equivalent to only 15 of the total significant runup this dominant contribution of wave setup and ig waves to wave runup is consistent with many prior observations over fringing reef bathymetry profiles e g cheriton et al 2016 shimozono et al 2015 nwogu and demirbilek 2010 for this particular experimental case buckley et al 2018 showed that the high frequency 0 22 hz f 0 06 hz portion of the ig wave spectrum was forced at time scales of the incident wave group forcing whereas the low frequency portion f 0 06 hz was resonantly amplified at the natural frequencies of the reef eq 11 especially for modes 0 and 1 fig 12 the sph model simulations were able to correctly reproduce these broad range of wave motions over the reef including rates of energy conversion and dissipation that were responsible for the swash contribution to wave runup over this reef profile 6 conclusions in this study we demonstrated the capability of the mesh free sph modelling approach based on dualsphysics to predict the complicated hydrodynamic processes generated by plunging irregular waves over a fringing reef by simulating the physical modelling study of buckley et al 2015 the bathymetry profile consisting of a steeply sloping fore reef slope where waves violently break followed by a wide and shallow reef flat where organised wave motions reform and propagate to the shoreline can create a number of challenges for numerical models in general while the wcsph approach used in this study has previously proven to be well suited for simulating nearshore wave breaking processes the numerics can have dissipative characteristics that can pose problems for applications where inviscid flow features must be accurately modelled for example applications where non breaking waves propagate over relatively long distances dalrymple and rogers 2006 results from this study show that conventional approaches to describe fluid solid boundary interactions i e based on the standard dbc approach and common techniques used to suppress noise in pressure fields in the wcsph method i e by using elevated artificial viscosities or applying a ddt based on the conventional δ sph approach were far too dissipative and or inaccurate to resolve the evolution of waves across the wide and shallow reef flat however using a new modified dbc approach based on english et al 2021 and a new ddt based on fourtakas et al 2019 dissipation and noise was able to be suppressed while using lower physically based viscosity values the most obvious drawback of conducting such highly resolved cfd model simulations in general is the required computation expense which has tended to limit many surf zone applications to simulations of relatively short duration driven by regular waves however the present model simulations were greatly accelerated by the efficient parallelisation of the weakly compressible sph approach on gpus and by substantially reducing the model domain by robust coupling to the nonhydrostatic wave flow model swash with this coupled modelling approach long duration irregular wave simulations were achieved using a single gpu which were necessary to resolve the critical low frequency portion of the wave spectrum over the reef that made a major contribution to wave runup at the shoreline while conventional phase averaged spectral models and phase resolving models e g boussinesq and nonhydrostatic that empirically parameterise the wave breaking process usually require some prior available experimental data to calibrate and verify model predictions an apparent advantage of the sph approach has been the limited need to tune model parameters this is supported by the fact that the numerical parameters used in this study closely mirrored those used in lowe et al 2019 that considered very different breaking wave conditions including spilling waves on a mild sloping plane beach the primary difference in the present study was the use of improved numerical methods in dualsphysics i e the new mdbc and ddt that reflect improvements designed to reduce numerical dissipation within the weakly compressible sph approach while the mesh free sph approach was successfully demonstrated in this study we must acknowledge that the application of mesh based cfd models to this case at similarly high resolution could prove to be equally capable of performing well such an assessment would require a comprehensive study comparing mesh based cfd model results e g from rans based models directly to these present sph simulations finally while the focus of this present study was on investigating the surf zone hydrodynamic processes over an idealised bathymetry profile there would likely be numerous other advantages with the mesh free sph approach when attempting to simulate more complex geometries including bathymetric topographic features and coastal structures that would likely confer some advantages over mesh based cfd models that may not naturally conform to fixed grids the sph approach is continuously proving its strength at simulating the hydrodynamics in a range of coastal applications including flows through complex porous structures fluid structure interactions with deformable objects and floating body problems that are ideally suited to the mesh free approach gotoh and khayyer 2018 lind et al 2020 domínguez et al 2021 due to the weakly compressible sph method being readily parallelisable including running efficiently on gpus that possess greater computing power relative to cpus both larger scale and longer duration applications will be increasingly feasible as computational resources continuously advance this will enable a number of new coastal problems to be simulated that have historically proven too computationally expensive for cfd model applications credit authorship contribution statement r j lowe conceptualisation methodology software validation formal analysis investigation writing original draft writing review editing visualisation project administration c altomare conceptualisation methodology software validation investigation writing review editing m l buckley conceptualisation methodology software formal analysis investigation writing review editing r f da silva software investigation writing review editing j e hansen writing review editing d p rijnsdorp writing review editing j m domínguez software writing review editing a j c crespo writing review editing declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests ryan lowe reports financial support and administrative support were provided by the university of western australia ryan lowe reports financial support was provided by australian research council acknowledgements this work was supported by resources provided by the pawsey supercomputing centre with funding from the australian government and the government of western australia we thank tomo suzuki and ben rogers for insightful discussions that helped improve the study at different stages this work was supported by funding from an australian research council discovery project grant dp200101545 the development of the dualsphysics code was partially financed by xunta de galicia spain consellería de cultura spain educación e universidade spain under project ed431c 2021 44 programa de consolidación e estructuración de unidades de investigación competitivas we thank falk feddersen and two anonymous reviewers for valuable comments that helped to improve the manuscript any use of trade firm or product names is for descriptive purposes only and does not imply endorsement by the u s government appendix a 1 statistical convergence and model parameter sensitivity a 1 1 influence of simulation duration on bulk parameter results in initial testing we assessed how the statistical properties of bulk parameters converged with the number n of individual ss waves simulated where n is defined as the duration of the simulation normalised by the offshore peak wave period t p fig a 1 the full duration 960 s simulation described in the main text thus corresponds to resolving n 425 individual ss waves to assess how the bulk parameter results converged as a function of the number of waves simulated we computed the root mean squared error rmse defined as a 1 rmse i 1 n x compare x r e f 2 n where x c o m p a r e denotes the variable that is being compared x r e f denotes a reference value that is being compared against and n denotes the number of data points used in the comparison using eq a 1 a normalised root mean squared error nrmse is then defined as a 2 nrmse rmse x ref max x ref min where the superscripts max and min denote the maximum and minimum values respectively to assess how key bulk wave parameter results converged to the full 960 s duration results we computed a normalised root mean squared error nrmse 960 s by defining x r e f in eqs a 1 and a 2 based on the 960 s results and comparing the results at all n model output locations fig a 1 by comparing results from different simulation durations we could then evaluate how nrmse 960 s varied with the number n of ss waves simulated for the case of wave runup we also computed an nrmse 960 s using the runup spectra by comparing each of the n data points in the spectrum from the full duration simulation to the corresponding points in the spectra at a given simulation duration fig a 1 shows that the nrmse 960 s values for ss wave heights h r m s s s high frequency ig wave heights h r m s i g h and wave setup all converged to approximately the full duration values i e nrmse 960 s 0 01 for simulation durations of n 100 120 waves equivalent to 220 270 s whereas the low frequency ig wave heights h r m s i g l took n 200 waves equivalent to 450 s to converge the wave runup spectra also took a relatively long time to converge to the full duration results with nrmse 960 s 0 01 occurring only after n 330 waves 740 s were simulated a 1 2 model parameter sensitivity several applications of sph models to simulate waves have investigated the sensitivity of model performance to various parameters especially 1 particle resolution defined by the initial inter particle distance dp 2 the smoothing coefficient coefh and 3 parameters associated with the viscosity formulation e g roselli et al 2018 gonzález cao et al 2019 de padova et al 2014 lowe et al 2019 here we evaluate how model predictions of the total root mean squared wave height h r m s setup η and wave runup η runup varied in response to these same parameters as well as some additional parameters related to numerical formulations namely treatment of solid boundary conditions and the density diffusion term in eq 4 model performance was similarly quantified using a normalised root mean squared error nrmse expt referenced to the experimentally measured by replacing x r e f in eqs a 1 and a 2 with x e x p t and here taking n as the number of independent data points being compared note that for both wave height and setup the nrmse expt values were computed using the series of h r m s and η values at the n 16 measurement locations within the model domain i e as in fig 6 whereas the nrmse expt for runup was defined based on comparing the series of frequency bins n 60 in the runup spectra i e as in fig 9b in addition to investigate how the model results converged with changes in dp we also computed a second measure of performance by comparing the results to those obtained at the finest resolution dp 2 mm considered i e by replacing x e x p t with x f i n e to calculate nrmse fine based on eqs a 1 and a 2 where the subscript fine denotes the finest resolution results in this way the scaling behaviour of model performance with dp becomes independent of any potential errors in the experimental measurements see fig a 2 for these sensitivity tests we consider the default case to have the settings used in the final simulation described in the main text i e with dp 3 mm coefh 1 5 and using the laminar sps viscosity formulation and then assess how changes in model parameters influence performance given the computational demand of the simulations these sensitivity tests used shorter 300 s simulations equivalent to n 132 waves which based on fig a 1 was adequate to resolve the spectral wave evolution across the reef except for a portion of very low frequency wave energy the wave setup profile and a portion of the wave runup spectra the results were largely insensitive to variations in the smoothing coefficient coefh values between 1 4 1 8 only for the smallest value coefh 1 2 was there some reduction in the accuracy of the wave height and setup predictions table a 1 thus for the final simulation an intermediate value coefh 1 5 was used the sensitivity tests conducted to investigate the influence of particle distance dp table a 2 show that the predictions of wave heights setup and runup rapidly converge towards the experimental measurements as dp decreases from 14 mm to 5 mm fig a 2 however there are only small reductions in nrmse expt for dp 5 mm to balance model performance with computational efficiency a dp 3 mm was used for the final simulation which reproduced the experimental observations of wave height setup and runup to within approximately 5 error table a 2 to investigate how the results converged based on the numerical output alone in fig a 2 we also include the response of the nrmse fine in which the error is referenced to the finest simulation with dp 2 mm while the nrmse fine for wave height and runup continues to decrease as dp decreases for all values nrmse fine displays a more complicated pattern for wave setup initially decreasing as dp is reduced from 14 mm to 9 mm but then showing no consistent improvement for dp 7 mm while the simulations reported in the main text used the laminar sps viscosity formulation we also considered the use of a conventional artificial viscosity term that treats the viscous dissipation term in eq 5 as a 3 γ i π i j i w i j where the artificial viscosity term π i j is defined as monaghan 1992 a 4 π i j α c i j μ i j ρ i j u i j r i j 0 0 u i j r i j 0 with μ i j h sph u i j r i j r i j 2 ɛ 2 for ɛ 2 0 01 h sph c i j 0 5 c i c j is the mean speed of sound and α is a coefficient termed artificial viscosity that determines the rate of viscous dissipation in these sensitivity tests we varied α from a large value α 0 04 to zero table a 3 the results for wave height and setup were not very sensitive to variations in α over this large range but showed some slight reduction in nrmse expt at the lower values of α however the runup predictions showed more variable performance with α with lowest nrmse expt for α 0 005 these results indicate that low to negligible values of artificial viscosity best reproduced the experimental observations which is different from the surf zone simulations by lowe et al 2019 and numerous other wave studies using sph e g de padova et al 2014 that have found optimal performance with α of order 0 01 finally we assessed how the new numerical formulations describing fluid solidboundary interactions and the density diffusion term affect model performance fig a 3 table a 4 when using the original dynamic boundary condition dbc approach crespo et al 2007 the model performance deteriorates substantially for both wave height and runup inspection of the wave height h r m s profiles in fig a 3 indicates that the conventional dbc approach leads to greater dissipation of wave energy across the wide and shallow reef flat as well as substantial energy loss in the shallow swash flows at the shoreline not shown which together substantially reduces wave runup at the shoreline likewise wave height and setup predictions using the new density diffusion term by fourtakas et al 2019 were generally much improved compared to results using the original density diffusion term of molteni and colagrossi 2009 with the original density diffusion term there are substantial water level anomalies affecting both h r m s and wave setup within the active breaking region of the surf zone 
23854,as waves interact with the slopes of coral reefs and other steep bathymetry profiles plunging breaking usually occurs where the free surface overturns and violent water motion is triggered resolving these surf zone processes pose significant challenges for conventional mesh based hydrodynamic models due to the rapidly deforming nature of the free surface and associated flows yet the accurate prediction of these surf zone hydrodynamics is critical for predicting a wide range of nearshore processes driven by wave breaking e g wave dissipation and energy transfers mean water levels and currents and wave runup in this study we assess the ability of the mesh free lagrangian particle based numerical modelling approach smoothed particle hydrodynamics sph based on dualsphysics to simulate the fine scale hydrodynamic processes driven by irregular wave transformation over a fringing reef profile by comparing results against detailed experimental observations from a physical modelling study to greatly improve the computational efficiency the sph model was coupled to the mesh based multi layer nonhydrostatic wave flow model swash with this coupled approach swash was used to efficiently simulate the evolution of non breaking waves from the wavemaker up to the fore reef slope with the sph model then used to simulate the detailed hydrodynamic processes over the reef from just offshore of the breakpoint to the shoreline the sph model was able to accurately reproduce the complex free surface deformations during plunging breaking the spectral evolution of waves across the reef flat including nonlinear wave shape the mean water levels and currents and wave runup at the shoreline using the long duration simulations 400 wave periods the model was able to reproduce the full range of wave motions over the reef from sea swell to infragravity frequencies including the increasing dominance of low frequency waves towards the shoreline and the large cross reef standing wave motions excited by the reef geometry keywords wave breaking surf zone wave runup wave modelling smoothed particle hydrodynamics dualsphysics 1 introduction energy within wind generated waves periods 1 25 s incident to coastlines drives a wide range of nearshore hydrodynamic processes that are responsible for wave driven coastal flooding sediment transport including coastal erosion and loads on coastal structures while the processes governing wave transformation in the nearshore have been widely investigated for many decades a complete understanding of the processes that control wave breaking in shallow water is still lacking including knowledge of how wave energy is dissipated and converted into other forms of water motion in the deep ocean where wind generated waves occur over a wide range of frequencies irregular waves propagate in groups which transform as they enter shallow water in the shoaling region and surf zone where rapid wave transformation occurs organised wave motion initially evolves into highly nonlinear wave shapes the free surface then overturns at the breakpoint and water motions spanning a wide range of spatial and temporal scales are generated ranging from small scale high frequency turbulence to larger scale slowly varying currents and wave driven mean water level variations wave setup svendsen 2006 the time variation of breaking waves of different height generated by wave groups also plays a critical role in nearshore hydrodynamics by generating low frequency infragravity waves that can often be a dominant source of water motion near shorelines bertin et al 2018 these low frequency waves can also reflect from shorelines creating cross shore partial standing waves that can become amplified by interactions with certain bathymetry profiles such as reefs e g buckley et al 2018 péquignet et al 2009 gawehn et al 2016 becker et al 2016 numerical wave models used to predict these nearshore hydrodynamics can be broadly classified as either phase averaged or phase resolving phase averaged or spectral models attempt to simulate the properties of waves usually based on linear wave theory lwt with empirical formulations to parameterise dissipation by wave breaking e g roelvink 1993 battjes 1978 thornton and guza 1983 phase resolving models aim to more directly simulate the nonlinear physics of individual waves with boussinesq e g shi et al 2012 madsen et al 1997 roeber et al 2010 and nonhydrostatic wave models e g zijlema et al 2011 ma et al 2012 being common examples while these models can directly predict how non breaking waves transform in the nearshore including through nonlinear wave wave interactions boussinesq and nonhydrostatic models do not capture all details of the wave breaking process as they only provide a single value representation of the free surface and hence cannot directly resolve the dynamics of overturning plunging waves that may influence how wave energy is dissipated blenkinsopp and chaplin 2007 while more computationally expensive than boussinesq and nonhydrostatic models phase resolving computational fluid dynamics cfd models attempt to more fully resolve the vertical structure of breaking through numerical solution of the navier stokes n s equations these cfd models can be broadly grouped into mesh based and mesh free models mesh based models simulate eulerian forms of the n s equations on numerical grids meshes mesh free models solve lagrangian forms of the n s equations which include those based on particle methods such as sph models where the motion of a fluid continuum is described using discrete fluid particles while mesh based cfd models have been successfully applied in a number of surf zone studies e g jacobsen et al 2012 higuera et al 2013 chella et al 2016 mostert and deike 2020 they still face a primary challenge in how to accurately and efficiently resolve the complex rapidly deforming free surfaces of breaking waves on fixed meshes numerical approaches have been developed to more accurately resolve the free surface such as the volume of fluid vof method hirt and nichols 1981 that has been most widely used in cfd applications of nearshore waves however these approaches can require high grid resolution at substantial computational expense to avoid significant errors in fluid properties near air water interfaces with development of optimal implementations still being an active area of research roenby et al 2016 lagrangian mesh free particle based models such as smoothed particle hydrodynamics sph used in the present study offer great appeal for simulating wave breaking given that fluid at the free surface does not need to conform to a specified grid violeau 2012 in addition numerical implementations of particle based models i e based on sph using weakly compressible flow theory are ideally suited for massive parallelisation e g on graphics processor units gpus e g domínguez et al 2013 allowing for larger scale cfd simulations to be conducted much more efficiently nevertheless despite many advances occurring over the past decade sph models also face a number challenges that are often distinct from mesh based models which have motivated considerable research over the past decade e g gotoh and khayyer 2018 violeau and rogers 2016 vacondio et al 2021 since early applications of sph models to study breaking waves dalrymple and rogers 2006 lo and shao 2002 sph applications to nearshore hydrodynamic problems have greatly accelerated over the past decade see gotoh and khayyer 2018 for a review initially computational limitations restricted these nearshore wave applications of sph models to relatively small domains and or using coarse resolution with simulations of relatively short duration just like mesh based cfd model counterparts hence focusing on regular or solitary waves that could be conducted within order 10s of wave periods e g dalrymple and rogers 2006 lo and shao 2002 gotoh et al 2004 with advances in computational performance larger scale and or longer duration applications of cfd models both mesh based and mesh free are becoming increasingly possible including simulations of more realistic irregular wave conditions that require simulating of order 100 wave periods or longer the ability to simulate irregular waves is often important to provide a more complete description of nearshore hydrodynamics as breaking wave groups generate infragravity waves that often become a dominant source of water motion near shorelines some cfd modelling studies have successfully simulated infragravity wave dynamics generated by irregular waves over sandy beaches and armoured foreshores e g torres freyermuth et al 2010 wen and ren 2018 which have tended to resolve approximately 100 wave periods that is sufficient to simulate higher frequency infragravity motions at wave group time scales however for other nearshore systems much longer period infragravity motions can often be dominant especially when these waves interact with larger scale bathymetric features such as reefs e g buckley et al 2018 gawehn et al 2016 becker et al 2016 in this study we applied the sph approach using dualsphysics domínguez et al 2021 to conduct highly resolved numerical simulations of irregular wave transformation over a fringing reef profile to investigate the capability of the model to predict the broad range of hydrodynamic processes that contribute to water level variability across the reef including the nonlinear evolution and dissipation of sea swell waves the generation and propagation of infragravity waves wave setup and mean currents and wave runup at the shoreline the model was validated using detailed measurements of waves velocities mean water levels and wave runup from a physical modelling study of a 1 36 scaled fringing reef profile with a steep fore reef slope and wide reef flat conducted in a 55 m long wave flume by buckley et al 2015 fig 1 in order to greatly boost computational efficiency the dualsphysics model was coupled to the phase resolving nonhydrostatic wave flow model swash zijlema et al 2011 that simulated waves in the region offshore of the reef thus concentrating the sph simulations in shallow water where wave transformation occurs over the reef profile using this coupled modelling approach long duration simulations were achieved duration 400 peak wave periods or equivalent to 90 min in field time scales which enabled the low frequency motions that make the dominant swash contribution to runup to be accurately resolved overall the results from these simulations provide an unprecedented view of the wave transformation within a reef surf zone at fine resolution providing new insight into the range of wave driven reef hydrodynamic processes that are responsible for wave runup at reef coastlines 2 model description 2 1 the sph approach the numerical simulations were conducted using the lagrangian mesh free sph approach where a fluid continuum is discretised into particles that represent computational nodal points where mass and momentum conservation laws n s equations are solved monaghan 1992 the kinematic and dynamic properties of each particle i e position density pressure and velocity are then determined by interpolation of the properties of neighbouring particles using a weighted kernel function w applied over a characteristic smoothing length h sph therefore in the sph approach any function f r in coordinate space r is mathematically defined by the integral expression 1 f r f r w r r h sph d r this function f can be discretised based on particles where the approximation of the function is interpolated at particle i and the summation is performed over all the particles j that are located within the kernel region 2 f r i j f r j w r i j h sph v j where v j m j ρ j is the volume associated with a neighbouring particle j r i j r i r j is the distance between particle i and j and m and ρ are mass and density respectively to achieve a sufficient number of particle interactions within the kernel while still constraining the number of neighbour particle interactions requiring computation the kernel function in eq 2 is implemented with a finite distance cut off note that in this study we use a quintic kernel where particle interactions at distances 2 h sph are neglected wendland 1995 in this study the n s equations are solved using the weakly compressible sph wcsph approach where following monaghan 1994 pressure p is efficiently obtained through its relation to density by solving an equation of state in the form batchelor 1974 3 p b ρ ρ 0 γ 1 where γ 7 is the polytropic constant and b c 0 2 ρ 0 γ is defined based on the reference density ρ 0 1000 kg m 3 and c 0 is the speed of sound at the reference density the ability to solve for pressure using eq 3 in an explicit form greatly reduces computational times and can also be more readily parallelised in numerical codes and is thus well suited for solution on gpus see below however the main drawback of wcsph is the potential for noise in the pressure density fields which is often mitigated by employing a range of density diffusion approaches molteni and colagrossi 2009 with use of the δ sph formulation being common antuono et al 2012 in the present study we use a new density diffusion term based on fourtakas et al 2019 that is less dissipative compared to the standard δ sph approach which as we show below offers improvements in the prediction of wave propagation over long distances within the wcsph approach conservation of mass is expressed as 4 d ρ i d t j m j u i j i w i j δ h sph c 0 j ψ i j i w i j v j where u i j u i u j with u i d r i d t representing the velocity of particle i and the last term in eq 4 is a diffusion term based on fourtakas et al 2019 here δ 0 1 is a specified coefficient and ψ i j is a density diffusion term see section 2 2 similarly conservation of momentum can be expressed as monaghan 1992 5 d u i d t j m j p i p j ρ i ρ j i w i j g γ i where g is gravitational acceleration and γ is a viscous dissipation stress term the viscous dissipation term is commonly described using an artificial viscosity approach monaghan 1992 but also variants based on turbulence closure models reviewed in gotoh and khayyer 2018 see section 2 2 2 2 the dualsphysics model in this study we applied version 5 0 of the open source sph model dualsphysics http dual sphysics org that solves the n s equations eqs 4 and 5 using the parallel computing power of either cpus and or gpus crespo et al 2015 domínguez et al 2021 the present model configuration and settings are generally similar to the study by lowe et al 2019 based on version 4 2 but include some improvements using new features in version 5 0 that are detailed below at the solid boundaries we applied a new modified dynamic boundary condition mdbc approach based on english et al 2021 this mdbc approach overcomes some of the drawbacks of the original dynamic boundary condition dbc approach in dualsphysics crespo et al 2007 resulting in less dissipation in flows near boundaries and reducing unphysical pressure density values for the boundary and adjacent fluid particles the mdbc approach employs ghost nodes using an extrapolation method similar to the one proposed in tafuni et al 2018 to calculate the properties of boundary particles requiring a layer consisting of several boundary particles to be included to avoid kernel truncation errors for fluid particles near the boundaries a layer of five boundary particles was used in this study which covers the distance of interaction defined by the kernel radius of 2 h sph while the mdbc can use the same boundary particle arrangement of the original dbc it defines the boundary interface at half the inter particle spacing dp from the inner most layer of boundary particles hence when simulating a physical model test the boundary interface must correspond to the physical boundary while the inner most layer of boundary particle is created at a distance equal to dp 2 in lowe et al 2019 the viscous dissipation term γ i in eq 5 was modelled based on the widely used artificial viscosity approach that is linearly proportional to local velocity gradients and parameterises the effect of a shear and bulk viscosity while the artificial viscosity approach is widely used in wave breaking applications de padova et al 2014 the scheme can be overly dissipative by generating excess shear forces taylor and miller 2012 which may affect coherent turbulent flow structures under breaking waves dalrymple and rogers 2006 therefore in the present study we also assessed the use of a laminar viscosity plus sub particle scale sps turbulence closure model gotoh et al 2004 dalrymple and rogers 2006 based on the large eddy simulation les approach smagorinsky 1963 analogous to sub grid scale sgs models used in turbulent incompressible flow simulations on fixed meshes for this approach the viscous dissipation term is expressed as 6 γ i j m j 4 ν 0 r i j i w i j ρ i ρ j r i j 2 ɛ 2 u i j laminar j m j τ i j i ρ i 2 τ i j j ρ j 2 i w i j sub particle scale turbulence where the first term describes the effect of laminar viscous stresses and second term represents the sps turbulent stresses here ν 0 is the kinematic viscosity ɛ 2 0 01 h sph 2 and τ i j is the sps stress tensor the sps stress tensor is defined as dalrymple and rogers 2006 based on a smagorinsky model smagorinsky 1963 7 τ i j ρ ν t 2 s i j 2 3 k δ i j 2 3 c i δ 2 δ i j s i j 2 where k is the sps turbulent kinetic energy s i j is the strain tensor δ is the initial inter particle spacing and c i 0 0066 is an empirical parameter the turbulent eddy viscosity ν t is defined as ν t c s δ 2 2 s i j s i j where c s 0 12 is the smagorinsky constant 2 3 swash coupling dualsphysics can generate waves using several different approaches in lowe et al 2019 moving boundary particles were used to simulate the movement of a piston wavemaker in a physical modelling study altomare et al 2017 which generated regular waves across two bathymetry profiles a plane beach ting and kirby 1996 ting 1995 and a fringing reef yao et al 2012 in that study lowe et al 2019 was able to substantially shorten the deep and flat offshore region in the flumes this greatly reduced computational times enabling an order 100 waves to be simulated while having negligible influence on the results due to the irregular wave conditions in the present study which required resolving the evolution of dispersing waves down the flume from the physical wave maker and simulating several hundred waves to achieve statistical convergence wave generation posed several challenges that required adopting new approaches thus in this present study the dualsphysics model was coupled to the nonhydrostatic wave flow model swash zijlema et al 2011 using a recently developed open boundary condition approach inlet outlet that passes flow properties from swash to dualsphysics verbrugghe et al 2019b in dualsphysics the open boundaries consist of a buffer zone width of 8 layers of particles when open boundaries are employed in coupled model applications physical quantities such as velocity pressure and surface elevation are imposed in the buffer zone the coupling uses a one way offline scheme with the swash model executed beforehand to provide the velocity and water surface elevation information at the coupling point location with swash run in multi layered mode velocities are interpolated between each swash layer and assigned to the sph particles within the buffer zone via postprocessing to avoid unwanted reflection at offshore inlet outlet boundary reflection compensation is also applied to correct the velocity and surface elevation imposed in the inlet zone the correction uses the measured free surface close to the buffer interface and linear long crested wave theory in shallow water to specify the reflection compensation verbrugghe et al 2019a altomare et al 2017 3 case study 3 1 experimental data buckley et al 2015 this study numerically simulates experimental results from buckley et al 2015 which measured wave transformation wave setup and wave runup across a scaled physical model of a fringing reef in a 55 m long wave flume fig 1a the bathymetry profile constructed from smooth marine plywood had a steep 1 5 fore reef slope a 14 m wide reef flat and a 1 12 sloping beach at the 1 36 geometric scaling used in the experiments the width of the reef flat is equivalent to 500 m at field scale which is typical of global averages falter et al 2013 irregular waves with a tma type spectrum were generated 31 m seaward of the reef crest with the crest defined as x 0 m by a piston type wave maker with second order wave generation and active reflection compensation in the experiments a wide range of incident wave conditions and offshore water levels were considered 16 runs in total table 2 of buckley et al 2015 due to the computational demand of the numerical simulations the present study focuses on investigating one of these experimental cases in detail run 2 which used a still water depth over the reef flat of h r 0 04 m equivalent to 1 4 m in field scale the wavemaker generated spectral waves with a root mean squared wave height of h r m s 0 0 06 m 2 2 m in field scale and a peak period t p 2 26 s 13 6 s in field scale this set of wave and water level conditions was intermediate and considered most representative of the broader range of conditions reported in the buckley et al 2015 experiment the experiment lasted 41 min during which time and water levels were measured at 18 locations along the flume with resistance type wave gauges and horizontal velocities were measured at 6 locations with electromagnetic current metres ecm with all instruments sampling synchronously at 40 hz fig 1a in addition georeferenced video imagery 2448 800 pixel resolution of the reef crest region from x 1 m to 1 m pixel resolution 1 mm was recorded at 25 hz images in pixel coordinates were converted to real world coordinates using six control points placed on the front glass of the flume and the methods outlined in bruder and brodie 2020 with this calibration the average horizontal and vertical root mean squared reprojection error was 1 2 mm 3 2 model configuration and numerical simulations the numerical simulations were conducted in a 2dv vertical plane the model domain extended from just seaward of the toe of the fore reef slope x 5 5 m coinciding with the swash coupling point see below to x 20 m fig 1a for the simulations an initial inter particle spacing of dp 3 mm was used with smaller values of dp having a negligible influence on the results see appendix a 1 this translated into 450 000 particles being simulated which varied on a wave by wave basis due to the inlet outlet boundary conditions the characteristic smoothing length h sph used for the kernel averaging eq 2 is related to the initial inter particle spacing according to h sph coefh 2 dp where coefh is a coefficient of order 1 that determines the spatial scale of interactions with surrounding particles if the value of coefh is too low this can lead to greater numerical dissipation e g wave attenuation when simulating relatively long wave flumes roselli et al 2018 due to weaker interactions with neighbouring particles however larger values of coefh reduce the effective model resolution in the present study a value of coefh 1 5 was used which fell within the range 1 2 1 8 that lowe et al 2019 found had minimal effect on wave transformation this was confirmed with initial testing with values of coefh between 1 4 and 1 8 having negligible influence on the results see table a 1 in appendix a 1 to model viscous dissipation both the artificial viscosity and laminar sps turbulence modelling approach eq 6 were considered in initial testing see appendix a 1 for a comparison of results with both approaches we note that for 2dv simulations the les based sps approach would only describe the 2d features of surf zone eddies and thus cannot resolve the small scale 3d turbulent flow structures that are required to properly resolve the turbulent energy cascade from large to small scale eddies where turbulent kinetic energy is dissipated nevertheless a number of 2d sph studies have found that use of an sps closure model can give robust results of surf zone hydrodynamics e g dalrymple and rogers 2006 gotoh et al 2004 makris et al 2016 shao and ji 2006 in appendix a 1 we found some slight improvement in wave transformation using the laminar sps approach compared to using artificial viscosity with less dissipation occurring within the inner surf zone following initial breaking which more closely matched the experiments therefore all results presented below are based on results using the laminar sps approach using a kinematic viscosity for water of ν 0 1 1 0 6 m2 s and default parameters within the smagorinsky turbulence model eq 7 the dualsphysics model was one way coupled to a larger swash model domain that extended to the offshore combined wave and velocity measurement location at x 15 3 m to x 20 m fig 1a the swash model was run in multi layer 2dv mode using a uniform horizontal resolution of 0 05 m and using 10 vertical sigma layers at the offshore open boundary a weakly reflective boundary condition was applied driven by fourier series coefficients amplitude frequency and phase that enabled arbitrary incident wave timeseries to be generated these fourier coefficients were derived from the incoming shoreward component of the water level timeseries from the offshore wave and velocity measurements at x 15 3 m with frequencies less than 1 2 the peak wave frequency removed to force the model with only incident ss waves following buckley et al 2015 the incoming water level signal was derived from the synchronised water level and velocity timeseries using a frequency domain algorithm in this approach fourier components of the water level and velocity spectra were applied with linear wave theory to compute directionally separated incoming and outgoing wave spectra with inverse fourier transformations used to generate timeseries of incoming and outgoing propagating wave signals refer to appendix b in buckley et al 2015 for details water levels and layer velocities output by swash at the x 5 5 m coupling location were converted offline to the inlet outlet boundary conditions water levels and velocities interpolated to particle locations to force dualsphysics the swash and dualsphysics models were run for a period commencing 10 min 600 s into the experiment for a duration of 16 min 960 s with output for both models stored at 20 hz based on the peak period t p 2 26 s this duration equates to 425 waves which was found to be adequate for the statistics of the full range of hydrodynamic processes to converge i e ss waves ig waves and wave setup see appendix a 1 the numerical simulations were conducted at the pawsey supercomputing centre in perth australia on its nimbus cloud computing infrastructure using a gpu enabled compute node housing an intel xeon silver 4215 2 50 ghz processor 8 core 16 thread 45 gb ram and a nvidia tesla v100 gpu 5120 cuda cores dualsphysics took 107 hr to simulate the 960 s experimental period using 450 000 particles with the swash model and wave boundary condition generation taking 24 min 3 3 post processing and data analysis to visualise features of the simulated breaking waves and relate these to the experimental georeferenced video imagery the air water interface was identified from the raw simulated particle data output by computing isosurfaces using the marching cubes algorithm lorensen and cline 1987 for quantitative comparison of the simulated water levels with the wave gauge data the densities of the particles were postprocessed to fixed grids resolution varying depending on application by interpolating onto the grid using a wendland kernel function with averaging length 2 h sph see section 2 1 post processing of the model output was used to compute surface elevations at a horizontal resolution δ x 5 cm we note that for cases where the free surface overturned there can be multiple air water interfaces and hence multiple definitions of the free surface lowe et al 2019 and that it is also unclear what water level a resistance wire wave gauge would exactly record when there is a mixture of water and air along the gauge within the surf zone stive and wind 1982 in this study we define the free surface elevation η by the vertical mass weighted average water level fig 2 8 η 1 ρ 0 h z ρ d z h which was obtained by vertically integrating the mass in the water column at δ z 1 mm vertical resolution from the bottom z h where h represents the still water depth fig 1b to the top of the interpolation grid denoted z z with the elevation z chosen to ensure the upper integration limit never contained water where by definition ρ 0 kg m 3 for void regions that do not contain water other gridded model output i e density pressure and velocity components were interpolated using the same wendland kernel function with different resolution chosen for different applications 1 a grid with resolution δ x 5 cm and δ z 5 mm extending over the full model domain and 2 a finer grid focused on the surf zone x 2 0 m to 4 0 m with resolution δ x 6 mm and δ z 3 mm to calculate wave runup a numerical water level gauge was implemented along the 1 12 beach slope at a height 3 mm above the bed equivalent to one dp the initial inter particle distance which searched for the runup elevation every 1 mm along the slope the results were analysed over the final 900 s of the dualsphysics simulations thus ignoring the initial 60 s of the simulation to allow time for the model results to spin up wave setup η was calculated from the time averaged water level relative to still water level by removing an offshore mean reference level defined by the spatial average between x 4 0 m to 2 0 m where wave setup setdown was negligible and the overbar denotes time averaging the wave component of water level variability η η η was used to compute wave spectra p η η f by applying welch s method using a hanning window with 50 overlap and a segment length of 212 samples 205 s equivalent to 20 min in field scale following buckley et al 2018 the spectra were separated into sea swell ss f 0 22 hz and infragravity ig f 0 22 hz frequency bands where 0 22 hz corresponds to one half of the peak frequency of the incident wave spectrum equivalent to a 27 s wave period in field scale the infragravity frequency band was further separated into high infragravity ig h 0 22 hz f 0 06 hz and low infragravity ig l f 0 06 hz contributions with the separation frequency equivalent to 100 s in field scale root mean squared wave heights h r m s for each frequency band were calculated as h r m s 8 m 0 where m 0 f l o w f h i g h p η η f d f is the zeroth spectral moment integrated over a range from f l o w to f h i g h based on the defined limits of each frequency band ss ig h and ig l other bulk wave parameters evaluated include the spectral period t m 1 0 a characteristic wave period that is commonly related to wave runup and overtopping predictions hofland et al 2017 which is defined as t m 1 0 m 1 m 0 where the n th spectral moment is m n 0 f n p η η f d f as well as the spectral width ν that measures how broadly distributed wave energy is across frequencies which is defined as ν m 0 m 2 m 1 2 1 to evaluate the cross shore evolution in the nonlinearity of wave shape the skewness sk and asymmetry as were calculated from the wave η timeseries as e g ruessink et al 2012 9 s k η 3 η 2 3 2 a s η h 3 η 2 3 2 where η h denotes the hilbert transform of η skewness describes how much more the crest is elevated and narrower relative to the trough while asymmetry describes how pitched forward backward i e saw toothed the waves are the skewness and asymmetry of the wave velocities across the reef were also investigated by replacing water level with velocity in eq 9 to investigate the generation and propagation of ig waves over the reef the relationship between the incident ss wave groups and ig waves were evaluated in the time domain by first filtering the water level timeseries into ss η s s and ig η i g wave components using a fifth order butterworth filter with a frequency cut off of f 0 22 hz using the ss water level timeseries at the offshore gauge location at x 15 34 m where synchronised wave and velocity timeseries were recorded fig 1a a hilbert transform was applied to the incoming component of the water level timeseries obtained by directional separation see section 3 2 to obtain the incoming ss wave envelope offshore ss e n v 0 by comparing lagged cross correlations between ss e n v 0 and the ig water level timeseries across the reef characteristic features of the ig wave generation and propagation including reflection were compared between the model predictions and observations e g janssen et al 2003 wave runup timeseries were used to compute the significant wave runup r s i g defined as 10 r s i g r setup r swash where r s e t u p is the steady mean runup elevation relative to the offshore mean water level i e wave setup at the shoreline and r s w a s h s s i g 2 is the swash contribution related to one half of the significant swash excursion s s i g the significant swash excursion was evaluated from the wave runup spectra as s s i g 4 m 0 where here m 0 is the zeroth spectral moment of the runup spectra similar to the approach used for wave heights the swash contribution to wave runup r s w a s h was decomposed into sea swell high infragravity and low infragravity contributions denoted r s w a s h s s r s w a s h i g h and r s w a s h i g l respectively 4 results 4 1 wave transformation and runup an illustrative example of a single breaking wave sequence simulated by the model is shown in fig 3 where the internal flow structure is visualised with colours representing the horizontal u component of velocity at the individual particle locations as the wave approaches the reef it becomes asymmetric with a near vertical face fig 3a the crest of the wave then overturns as a plunging jet fig 3b hitting a thin layer of water retreating down the fore reef slope which causes a splash up of the free surface fig 3c the volume of water in the breaking wave moves shoreward over a seaward directed bottom flow which oscillates vertically across the reef flat and generates a trail of surf zone eddies localised areas of negative velocities below positive velocities in the vertical plane fig 3d g the wave then develops into a more organised bore like feature that propagates shoreward across the reef flat fig 3 h j for comparison with the experimental observations this same breaking wave sequence is compared against georeferenced video imagery fig 4 with isosurfaces computed from the synchronised model predictions superimposed as red lines the sph model generally reproduces this free surface evolution well capturing the plunging jet the characteristics of the wave splash up and the propagation of a bore like feature across the reef flat for a longer 30 s sequence of the video record capturing 13 waves a time sequence of vertical columns of pixels are shown at two locations x 0 23 m and x 0 35 just seaward and shoreward of the reef crest respectively fig 4k l the superimposed free surface elevation timeseries agrees well with the video observations at both locations capturing the skewed and asymmetric shapes of the individual waves predictions of the transformation of individual waves height shape and phase across the reef also agree well with the full set of wave gauge measurements fig 5 the model captures the change in wave shape as they shoal on the fore reef slope near the crest where waves break i e gauges 7 9 fig 5 the height of the waves rapidly decreases and saw toothed bores emerge that are reproduced by the model as the back of the reef flat is approached the heights of the sea swell waves decrease appreciably within this back reef region individual waves tend to be associated with high frequency oscillations in the free surface which are present both in the observations and model predictions these high frequency oscillations are features of undular bores that are commonly observed during wave transformation over coral reef flats sous et al 2019 tissier et al 2018 the predicted sea swell wave heights h r m s s s closely follow the observations with h r m s s s initially shoaling on the fore reef rapidly decreasing after the breakpoint at x b 0 2 just seaward of the crest and then becoming nearly constant at h r m s s s 1 cm for x 1 m albeit still decaying towards shore at a low rate fig 6a there is only some discrepancy at the wave gauge at x 0 2 m located immediately at the break point where the observed h r m s s s is higher this gauge corresponds with the typical location of the overturning free surface during breaking fig 4 where the free surface takes multiple values and there would be significant entrainment of air both of which would likely add uncertainty to measurements at this location the height of the high frequency component of the ig waves h r m s i g h is also very well predicted fig 6b reproducing the growth observed on the fore reef the abrupt decrease in height near the breakpoint and the near constant values h r m s i g h 1 cm across the reef flat the variation in the low frequency component of the ig waves h r m s i g l across the reef is also generally reproduced accurately by the model predicting the increase in height shoreward of the reef crest and the oscillation in height with h r m s i g l varying from 0 5 to 1 cm across the reef flat fig 6c only the abrupt changes in h r m s i g l near the crest are not well reproduced by the model the growth of ig wave heights on the reef causes a substantial increase in the spectral period t m 1 0 shoreward of the reef crest including an oscillation in t m 1 0 due to the varying contribution of the low frequency ig component which is accurately predicted by the model fig 6d the growth in spectral width ν is also accurately reproduced with the model only slightly over predicting ν at the seaward limit of the reef flat x 0 3 m fig 6e the mean water level response to the breaking waves wave setup closely follows the observations with η plateauing to a value of 1 7 cm over the reef flat fig 6f as the waves transform across the reef the shapes skewness and asymmetry properties of individual waves change substantially the waves are initially symmetric s k 0 a s 0 on the fore reef but develop positive sk narrower crests wider troughs and negative as steeper faces as the reef crest is approached fig 7a the growth of negative as develops slightly earlier on the fore reef x 1 5 m whereas the positive sk develops near the reef crest x 0 m eventually on the reef flat x 3 m the sk and as become relatively constant decreasing only very slowly towards zero across the reef the model reproduces the spatial evolution of sk and as observed across the reef very well the detailed spectral evolution of waves across the reef is also accurately predicted where there is a change from a dominance of energy in ss frequencies on the fore reef x 0 fig 8a d a bimodal distribution of energy between ss and ig frequencies within the inner surf zone shoreward of the crest fig 8e and a gradual shifting to a dominance of ig wave energy towards the back of the reef flat fig 8f h wave runup predictions also agree well with the runup gauge measurements reproducing the range of low and high frequency water level contributions to runup at the shoreline fig 9a consistent with the wave spectra at the back of the reef the runup spectra are dominated by the low frequency component of ig motions which is accurately predicted by the model fig 9b when computing the significant runup r s i g using eq 10 both the observed and predicted values of r s i g are in excellent agreement table 1 the model also accurately reproduces the proportion of setup and swash contributions to r s i g 40 and 60 respectively as well as the ss ig h and ig l contributions to swash 30 30 and 40 respectively table 1 4 2 wave velocities and directionally separated wave properties to decompose incoming and outgoing wave motions using directional separation velocity timeseries predicted by the model were first compared at the five current metrelocations within the model domain fig 10 at all sites the velocity timeseries were accurately simulated fig 10 and trends in the velocity skewness and asymmetry across the reef were also reproduced fig 7b while the predictions of the velocity skewness closely matched the observations there was some discrepancy in the predictions of the velocity asymmetry at the two most seaward locations on the reef flat fig 7b the co located synchronised velocity and water level timeseries were used to directionally separate the incoming and outgoing reflected wave signals see sections 3 2 and 3 3 which was applied to both the experimental and model results for the ss waves the height of the incoming waves closely follows total h r m s s s due the minimal height of outgoing ss waves fig 11a on the fore reef the height of the incoming high frequency ig waves h r m s i g h is smaller than the outgoing waves fig 11b the incoming signal would be due to incident bound long waves longuet higgins and stewart 1962 and with the reflected heights being larger implies either the surf zone generation of ig waves and or any reflected ig waves from the reef and beach propagating offshore from the reef e g pomeroy et al 2012 the directionally separated low frequency ig wave heights h r m s i g l follow similar trends with the incoming heights smaller than the outgoing heights on the fore reef but with incoming heights becoming larger than outgoing heights on the reef flat x 0 m fig 11c unlike for the outgoing h r m s i g h which becomes higher on the fore reef relative to the reef flat the outgoing h r m s i g l is much more constant across both the fore reef and reef flat by converting these wave heights to a ratio of outgoing to incoming components we obtain an estimate of the local reflection coefficient r h r m s h r m s where the superscripts and denote the outgoing and incoming components respectively reflection coefficients are weak for the ss waves r 0 3 across the entire domain but much larger r 0 5 2 5 for the two ig components fig 11d on the reef flat r varies between 0 5 0 7 for the high ig waves and is larger r 0 7 1 0 for the low ig waves on the fore reef r values for the ig waves reach much higher values up to 2 5 consistent with the surf zone generation of outgoing ig waves and or strong reflection from the reef and beach while there are only five points of comparison where both co located wave and velocity measurements could be used for directional separation the agreement between the predicted and observed separated wave heights is generally good there is generally very good agreement at the three locations on the reef flat x 0 but r values for the high frequency ig components are slightly underpredicted at the fore reef location although similarly high values of r 1 5 are captured 4 3 low frequency wave dynamics given the importance of the ig wave contributions to the water level variability over the reef flat further aspects of ig wave dynamics are compared with the model predictions focusing on the ig frequency range f 0 22 hz the spectral distribution of wave energy across the reef shows spatial patterns with bands of high and low energy that are accurately reproduced by the model fig 12 these bands are formed by standing wave motions across the reef flat generated by interactions between incoming and outgoing ig waves which create a pattern of nodes locations of low potential energy and anti nodes locations of high potential energy buckley et al 2018 based on linear wave theory at a given cross shore location x the frequencies f n o d e where these nodes should occur can be theoretically predicted as buckley et al 2018 11 f n o d e 1 4 2 n 1 x x shoreline 1 g h η d x 1 where x s h o r e l i n e is the location of the shoreline and n is the standing wave mode number n 0 1 2 the theoretical frequencies of these nodes predicted using eq 11 as a function of distance x across the reef flat red lines fig 12 agree well with the nodes that are present in both the observations and model predictions this confirms that the ig wave energy on the reef flat is connected to standing wave motions linked to the reef bathymetry profile with these dynamics well reproduced by the model the forcing of infragravity waves in the nearshore is typically due to breaking wave groups longuet higgins and stewart 1962 battjes et al 2004 including over reef bathymetry profiles pomeroy et al 2012 péquignet et al 2009 becker et al 2016 buckley et al 2018 used the same experimental data to show how the groupiness of the incident ss waves generates ig wave motions in the surf zone that become standing waves over the reef flat that are amplified at the natural frequencies associated with the reef bathymetry profile to assess the ability of the model to predict the links between incident wave groups and ig wave generation fig 13 shows cross correlations between the offshore ss wave envelope ss e n v 0 and the low pass filtered ig water level signal η i g see section 3 3 at locations across the reef note that for the model comparison the ss e n v 0 was referenced to the swash water level timeseries at the offshore location x 15 3 m however the η i g timeseries was based on the swash results for locations offshore of the model coupling point x 5 5 m and based on dualsphysics results shoreward of this point fig 13b both the experimental observations and model predictions show very consistent patterns offshore of the reef crest x 0 m the correlation between ss e n v 0 and η i g is initially negative consistent with the presence of incident bound waves 180 deg out of phase that propagate at the group velocity red dashed lines fig 13 shoreward of the reef crest x 0 m the sign of the correlation switches to positive consistent with the generation of free ig waves via the breakpoint forcing mechanism and shoaling wave groups symonds et al 1982 pomeroy et al 2012 contardo et al 2021 that propagate shoreward at the shallow water free wave speed black dashed lines fig 13 also consistent with these infragravity wave generation mechanisms a negative correlation propagates seaward away from the surf zone which travels at the shallow water wave speed at the shoreline the positive correlation returns seaward consistent with reflection of the incoming free ig waves generated at the crest there is also evidence of some of this outgoing ig wave energy continuing to propagate offshore past the reef crest onto the fore reef although the correlation is much weaker than on the reef flat overall these results confirm that the model can accurately reproduce the main features of ig waves across the reef from generation to propagation moreover the excellent continuity in correlations across the boundary between the dualsphysics and swash models fig 13b indicates the model coupling approach provides a robust means to efficiently simulate both the irregular wave and associated ig wave dynamics 4 4 mean currents the detailed model output is used to investigate the mean current structure focusing on the region surrounding the reef crest 2 m x 5 m where wave transformation predominantly occurs in buckley et al 2015 the limited point measurements of velocities during the experiment did not make it possible to investigate the detailed vertically varying mean current fields generated over the reef e g undertow structure although these data can still provide useful points of comparison with the model predictions in the present study the modelled mean current field reveals a well defined undertow flow structure across the reef flat negative horizontal u velocities and a complex circulation pattern near the reef crest and along the fore reef slope fig 14b for reference the mean water level elevation solid grey line and representative crest and trough elevations defined based on the root mean squared wave amplitude h r m s 2 grey dashed lines are also superimposed the strength of the undertow decreases with distance across the reef flat x 0 m with these cross shore gradients in horizontal mass fluxes compensated by downward velocities that are strongest near the trough as the crest and trough elevations are defined here based on h r m s there is some onshore mass flux above the crest elevation due to the mass flux associated with the largest individual waves which is most pronounced near the crest there is also a highly concentrated region of strong flow down the fore reef slope x 0 m and strong upwelling occurring further above the slope this flow pattern leads to a clockwise eddy on the fore reef slope adjacent to the crest while on the reef flat the interface between onshore and offshore flow u 0 m s 1 white region coincides approximately with the trough elevation on the fore reef there is a substantial amount of onshore flow that occurs below the trough despite the limited point measurements of velocities available for comparison the modelled mean current velocities show consistency with the experimental observations with negative seaward directed mean currents at these locations that is characteristic of the undertow in the lower part of the water column fig 14c e the modelled undertow velocities generally agree well with the experimental measurements at these specific elevations although the modelled mean velocities are slightly stronger than the observations at the site on the fore reef slope x 1 8 m and at the most shoreward site x 4 25 m on the reef flat 5 discussion 5 1 model performance in this study we conducted a comprehensive investigation of the ability of the mesh free sph approach based on dualsphysics to accurately simulate the broad range of hydrodynamic processes across a fringing reef profile based on the experimental study by buckley et al 2015 this application posed several challenges notably the need to resolve the dynamics of the violently plunging waves while also requiring running long duration irregular wave simulations that have generally not been considered in analogous cfd models due to the prohibitive computational expense we demonstrated that the model was able to accurately predict the wide range of these complex hydrodynamic processes but only with new features recently implemented in dualsphysics including the improved model coupling with the nonhydrostatic model swash and using recent numerical improvements i e improved fluid solid boundary conditions and density diffusion terms that greatly reduced unphysical numerical dissipation see appendix a 1 in the buckley et al 2015 experimental setup a substantial portion of the length of the occupied region of the flume 30 contained the shallow 14 m wide reef flat which when converted to prototype field scale represented a 500 m reef flat that is typical of fringing coral reefs worldwide with the irregular wave breaking on the reef generating both substantial wave setup 2 cm and ig wave motions 2 cm height for the combined high and low ig contributions this represents a large portion of the initial still water depth 4 cm over the reef flat to supply this elevated water on the reef flat a substantial volume of water in the flume offshore of the reef must be transported onto the reef flat leading to a fall in the offshore water level i e any increase in the average water level over the reef will lead to a proportional 30 in this case decrease in the average offshore water level per mass conservation for the case of steady wave setup water can be added to the flume to compensate this effect of setup and maintain a desired offshore water level however for ig wave motions especially lower frequency contributions that can uniformly raise lower the entire water level over the reef this effect is unavoidable and can only be minimised by having a large volume of water offshore of the reef in the physical modelling experiment due to the height of these low ig waves being 1 cm fig 6c the offshore water level would vary at most by 3 mm at these low frequencies and hence is very small in the numerical model directly simulating the large offshore region spanning the complete flume would come at substantial computational expense which is especially undesirable considering that negligible wave transformation that occurs in this deep region to improve computational efficiency the offshore model domain can be truncated for example in the present study where the deep region offshore of the reef crest was shortened from 31 m to only 5 5 m the number of particles simulated decreases by a factor of 8 which implies a minimum eight fold increase in computational efficiency assuming approximate linear scaling with particle number yet this shorter offshore domain contains a much smaller volume of water that can substantially amplify offshore water levels as water flows on and off the reef flat therefore while it is possible to directly force this truncated domain at the offshore boundary using a numerical wavemaker or by coupling with the more efficient phase resolving model swash using the multi layered wavemaker or relaxation zone approach in dualsphysics altomare et al 2015b 2018 the constrained volume of water created by any impermeable offshore boundary condition is highly problematic instead in the present study we use new developments in model coupling using an inlet outlet approach in dualsphysics verbrugghe et al 2019b which enabled the volume of water in the sph domain to dynamically adjust in response to water levels and velocities imposed by large scale whole flume simulations conducted using swash our results indicate that this coupling approach is both accurate and robust enabling computationally efficient long duration simulations to be conducted at a fine resolution dp 3 mm such a fine resolution was necessary to accurately reproduce the hydrodynamic processes over the reef flat see appendix a 1 with the total h r m s averaging 2 5 cm on the reef flat the wave height to particle spacing ratio is equivalent to h r m s d p 8 which is comparable to the ratio of 10 that roselli et al 2018 recommended for wave propagation problems once waves rapidly transform in the surf zone near the reef crest the smaller residual waves that propagate across the shallow and wide reef flat can be sensitive to the cumulative effects of any numerical dissipation within the simulations for this reef profile initial model testing using the conventional numerical schemes for modelling fluid solid boundary interactions and density diffusion to reduce noise in dualsphysics schemes also widely used in other sph codes performed poorly for this application leading to large discrepancies in wave heights setup and runup over the reef see appendix a 1 2 using the new modified dynamic boundary condition mdbc formulation of english et al 2021 resulted in much better agreement in wave height and wave runup predictions and some slight improvement in wave setup see appendix a 1 2 table a 4 wave runup predictions were in particular grossly in error using the original dbc with the swash contribution to runup nearly completely attenuated at the shoreline see appendix a 1 2 fig a 3 due to the combination of excessive numerical dissipation occurring as waves propagate across the shallow reef flat and as they interact within the swash zone along the beach slope within the initial testing it was also apparent that use of a conventional artificial viscosity formulation with a typical artificial viscosity α value of order 0 01 was far too dissipative for simulating waves over this reef profile despite similar α values having been found to be optimal in many prior wcsph wave studies e g altomare et al 2015a roselli et al 2018 de padova et al 2014 the use of an artificial viscosity in wcsph simulations aims to not only parameterise the effect of physical combined bulk and shear viscosity but also to suppress noise arising from pressure density fluctuations inherent to wcsph test simulations conducted with low viscosity necessary to reduce numerical wave dissipation across the reef both using the artificial viscosity and laminar sps schemes were unstable necessitating the use of a density diffusion term ddt in the simulations yet using the original ddt based on molteni and colagrossi 2009 generated anomalous mean water levels in regions where wave breaking occurred see appendix a 1 2 figure a3b which is a known problem when applying this scheme to free surface problems antuono et al 2010 however using the new ddt scheme of fourtakas et al 2019 eliminated this issue resulting in accurate reproduction of the setup profile across the reef it is also noteworthy that the sph approach was able to accurately reproduce these complex hydrodynamic processes driven by plunging waves using essentially no tuning of model parameters the choice of parameters that gave optimum performance were all at default or typical values recommended in the literature including those found optimum in lowe et al 2019 for very different wave breaking conditions including for spilling waves breaking on a mild sloping beach however one important difference in the present simulations from those of lowe et al 2019 was the use of low viscosity due to how effective the new ddt was at suppressing noise in the absence of higher viscosity in the present study a laminar sps viscosity formulation was applied using a physically based kinematic viscosity of ν 0 1 1 0 6 m2 s for water which accurately reproduced both the wave transformation and runup however we also obtained comparable albeit slightly less accurate results using an artificial viscosity formulation with very low viscosity values i e α 1 0 4 much lower than typical values of α of order 10 2 common in the literature these results are broadly consistent with the analysis by meringolo et al 2019 who showed that due to both the artificial viscosity and ddt having dissipative properties that suppress noise in an wcsph scheme when an artificial viscosity is used in the absence of a ddt an important function of the artificial viscosity is simply noise suppression rather than incorporating the influence of actual physical viscosity while the present study found that the use of a sps turbulence model with a physically based kinematic viscosity performed well for this specific application as for the case of les applications on fixed grids the use of sps in 2dv cannot strictly resolve the range of turbulent motions that would be present including correctly resolving the turbulence energy cascade to fine scales that would require resolving 3d turbulent eddies to be able to properly assess an optimum approach to model turbulent viscosities would require direct measurements of the turbulent fields that were not available in buckley et al 2015 as well as comparing simulations conducted in 3d that would be considerably more computationally expensive 5 2 reef surf zone processes detailed experimental observations of the fine scale hydrodynamic processes within the roller region of depth limited breaking waves are still relatively limited with most of these studies tending to either miss a portion of data within the important crest to trough region inside the surf zone e g from optical interference due to aeration or have used conditions with mild breaking spilling conditions where a greater portion of the water column can be robustly sampled e g govender et al 2004 stive and wind 1982 huang et al 2009 kimmoun and branger 2007 ting and kirby 1994 stansby and feng 2005 for the extreme plunging waves on the steep reef slope in the buckley et al 2015 study where individual waves break on an effectively dry bed and the plunging jets tend to splash up well above incident crest heights fig 4 no analogous fine scale hydrodynamic observations exist within such breaking waves which may prove nearly impossible to achieve even using the most advanced experimental techniques presently available with these highly resolved sph simulations proving to be capable of very accurately reproducing the range of hydrodynamic processes that could be measured in buckley et al 2015 the use of the detailed model output provides a unique opportunity to fill these observational knowledge gaps while several studies have applied phase resolving boussinesq and nonhydrostatic models to investigate wave transformation across reefs e g lashley et al 2018 ma et al 2014 nwogu and demirbilek 2010 lashley et al 2020 rijnsdorp et al 2021 some studies have highlighted limitations with not directly resolving the vertical structure of overturning breaking waves within such models for example in simulations of the same buckley et al 2015 experiments using the depth averaged nonhydrostatic model xbeach nh lashley et al 2018 found that the model substantially underpredicted both wave setdown and setup this finding is broadly similar to other studies that have applied phase resolving depth averaged nonhydrostatic and boussinesq models to steeply sloping bathymetry profiles where both setdown and setup were also underpredicted e g skotner and apelt 1999 yao et al 2012 liu et al 2021 however we also note that da silva et al 2021 recently applied the multi layered nonhydrostatic model swash to this same buckley et al 2015 experimental case using two vertical layers and found both setdown and setup were better predicted than in lashley et al 2018 although still not predicted as accurately as in the present study by analysing the experimental data buckley et al 2015 compared setup predictions from radiation stress gradients estimated from linear wave theory where potential and kinetic energy are in balance finding that setdown setup were likewise substantially underpredicted instead they hypothesised that the dynamics within the wave roller were shifting radiation stress gradients shoreward into shallower water however given that the experimental observations of buckley et al 2015 were limited primarily to wave gauge observations with only limited near bed point velocities measurements most terms in the mean momentum balances could not be calculated to directly verify this further work is needed to quantify these mean momentum balances to assess how they can be most robustly captured in phase resolving e g boussinesq and nonhydrostatic wave models including the relative importance of incorporating both vertical resolution e g as in multi layered nonhydrostatic models and or directly simulating the overturning free surface e g as in detailed cfd models while wave setup made a substantial contribution to wave runup in this study contributing 40 to significant runup infragravity wave motions also had a comparably large influence on runup accounting for 75 of the significant swash contribution to runup equivalent to 45 of the total significant wave runup that includes setup sea swell contributions to wave runup for this reef case were small accounting for 25 of the swash contribution to runup equivalent to only 15 of the total significant runup this dominant contribution of wave setup and ig waves to wave runup is consistent with many prior observations over fringing reef bathymetry profiles e g cheriton et al 2016 shimozono et al 2015 nwogu and demirbilek 2010 for this particular experimental case buckley et al 2018 showed that the high frequency 0 22 hz f 0 06 hz portion of the ig wave spectrum was forced at time scales of the incident wave group forcing whereas the low frequency portion f 0 06 hz was resonantly amplified at the natural frequencies of the reef eq 11 especially for modes 0 and 1 fig 12 the sph model simulations were able to correctly reproduce these broad range of wave motions over the reef including rates of energy conversion and dissipation that were responsible for the swash contribution to wave runup over this reef profile 6 conclusions in this study we demonstrated the capability of the mesh free sph modelling approach based on dualsphysics to predict the complicated hydrodynamic processes generated by plunging irregular waves over a fringing reef by simulating the physical modelling study of buckley et al 2015 the bathymetry profile consisting of a steeply sloping fore reef slope where waves violently break followed by a wide and shallow reef flat where organised wave motions reform and propagate to the shoreline can create a number of challenges for numerical models in general while the wcsph approach used in this study has previously proven to be well suited for simulating nearshore wave breaking processes the numerics can have dissipative characteristics that can pose problems for applications where inviscid flow features must be accurately modelled for example applications where non breaking waves propagate over relatively long distances dalrymple and rogers 2006 results from this study show that conventional approaches to describe fluid solid boundary interactions i e based on the standard dbc approach and common techniques used to suppress noise in pressure fields in the wcsph method i e by using elevated artificial viscosities or applying a ddt based on the conventional δ sph approach were far too dissipative and or inaccurate to resolve the evolution of waves across the wide and shallow reef flat however using a new modified dbc approach based on english et al 2021 and a new ddt based on fourtakas et al 2019 dissipation and noise was able to be suppressed while using lower physically based viscosity values the most obvious drawback of conducting such highly resolved cfd model simulations in general is the required computation expense which has tended to limit many surf zone applications to simulations of relatively short duration driven by regular waves however the present model simulations were greatly accelerated by the efficient parallelisation of the weakly compressible sph approach on gpus and by substantially reducing the model domain by robust coupling to the nonhydrostatic wave flow model swash with this coupled modelling approach long duration irregular wave simulations were achieved using a single gpu which were necessary to resolve the critical low frequency portion of the wave spectrum over the reef that made a major contribution to wave runup at the shoreline while conventional phase averaged spectral models and phase resolving models e g boussinesq and nonhydrostatic that empirically parameterise the wave breaking process usually require some prior available experimental data to calibrate and verify model predictions an apparent advantage of the sph approach has been the limited need to tune model parameters this is supported by the fact that the numerical parameters used in this study closely mirrored those used in lowe et al 2019 that considered very different breaking wave conditions including spilling waves on a mild sloping plane beach the primary difference in the present study was the use of improved numerical methods in dualsphysics i e the new mdbc and ddt that reflect improvements designed to reduce numerical dissipation within the weakly compressible sph approach while the mesh free sph approach was successfully demonstrated in this study we must acknowledge that the application of mesh based cfd models to this case at similarly high resolution could prove to be equally capable of performing well such an assessment would require a comprehensive study comparing mesh based cfd model results e g from rans based models directly to these present sph simulations finally while the focus of this present study was on investigating the surf zone hydrodynamic processes over an idealised bathymetry profile there would likely be numerous other advantages with the mesh free sph approach when attempting to simulate more complex geometries including bathymetric topographic features and coastal structures that would likely confer some advantages over mesh based cfd models that may not naturally conform to fixed grids the sph approach is continuously proving its strength at simulating the hydrodynamics in a range of coastal applications including flows through complex porous structures fluid structure interactions with deformable objects and floating body problems that are ideally suited to the mesh free approach gotoh and khayyer 2018 lind et al 2020 domínguez et al 2021 due to the weakly compressible sph method being readily parallelisable including running efficiently on gpus that possess greater computing power relative to cpus both larger scale and longer duration applications will be increasingly feasible as computational resources continuously advance this will enable a number of new coastal problems to be simulated that have historically proven too computationally expensive for cfd model applications credit authorship contribution statement r j lowe conceptualisation methodology software validation formal analysis investigation writing original draft writing review editing visualisation project administration c altomare conceptualisation methodology software validation investigation writing review editing m l buckley conceptualisation methodology software formal analysis investigation writing review editing r f da silva software investigation writing review editing j e hansen writing review editing d p rijnsdorp writing review editing j m domínguez software writing review editing a j c crespo writing review editing declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests ryan lowe reports financial support and administrative support were provided by the university of western australia ryan lowe reports financial support was provided by australian research council acknowledgements this work was supported by resources provided by the pawsey supercomputing centre with funding from the australian government and the government of western australia we thank tomo suzuki and ben rogers for insightful discussions that helped improve the study at different stages this work was supported by funding from an australian research council discovery project grant dp200101545 the development of the dualsphysics code was partially financed by xunta de galicia spain consellería de cultura spain educación e universidade spain under project ed431c 2021 44 programa de consolidación e estructuración de unidades de investigación competitivas we thank falk feddersen and two anonymous reviewers for valuable comments that helped to improve the manuscript any use of trade firm or product names is for descriptive purposes only and does not imply endorsement by the u s government appendix a 1 statistical convergence and model parameter sensitivity a 1 1 influence of simulation duration on bulk parameter results in initial testing we assessed how the statistical properties of bulk parameters converged with the number n of individual ss waves simulated where n is defined as the duration of the simulation normalised by the offshore peak wave period t p fig a 1 the full duration 960 s simulation described in the main text thus corresponds to resolving n 425 individual ss waves to assess how the bulk parameter results converged as a function of the number of waves simulated we computed the root mean squared error rmse defined as a 1 rmse i 1 n x compare x r e f 2 n where x c o m p a r e denotes the variable that is being compared x r e f denotes a reference value that is being compared against and n denotes the number of data points used in the comparison using eq a 1 a normalised root mean squared error nrmse is then defined as a 2 nrmse rmse x ref max x ref min where the superscripts max and min denote the maximum and minimum values respectively to assess how key bulk wave parameter results converged to the full 960 s duration results we computed a normalised root mean squared error nrmse 960 s by defining x r e f in eqs a 1 and a 2 based on the 960 s results and comparing the results at all n model output locations fig a 1 by comparing results from different simulation durations we could then evaluate how nrmse 960 s varied with the number n of ss waves simulated for the case of wave runup we also computed an nrmse 960 s using the runup spectra by comparing each of the n data points in the spectrum from the full duration simulation to the corresponding points in the spectra at a given simulation duration fig a 1 shows that the nrmse 960 s values for ss wave heights h r m s s s high frequency ig wave heights h r m s i g h and wave setup all converged to approximately the full duration values i e nrmse 960 s 0 01 for simulation durations of n 100 120 waves equivalent to 220 270 s whereas the low frequency ig wave heights h r m s i g l took n 200 waves equivalent to 450 s to converge the wave runup spectra also took a relatively long time to converge to the full duration results with nrmse 960 s 0 01 occurring only after n 330 waves 740 s were simulated a 1 2 model parameter sensitivity several applications of sph models to simulate waves have investigated the sensitivity of model performance to various parameters especially 1 particle resolution defined by the initial inter particle distance dp 2 the smoothing coefficient coefh and 3 parameters associated with the viscosity formulation e g roselli et al 2018 gonzález cao et al 2019 de padova et al 2014 lowe et al 2019 here we evaluate how model predictions of the total root mean squared wave height h r m s setup η and wave runup η runup varied in response to these same parameters as well as some additional parameters related to numerical formulations namely treatment of solid boundary conditions and the density diffusion term in eq 4 model performance was similarly quantified using a normalised root mean squared error nrmse expt referenced to the experimentally measured by replacing x r e f in eqs a 1 and a 2 with x e x p t and here taking n as the number of independent data points being compared note that for both wave height and setup the nrmse expt values were computed using the series of h r m s and η values at the n 16 measurement locations within the model domain i e as in fig 6 whereas the nrmse expt for runup was defined based on comparing the series of frequency bins n 60 in the runup spectra i e as in fig 9b in addition to investigate how the model results converged with changes in dp we also computed a second measure of performance by comparing the results to those obtained at the finest resolution dp 2 mm considered i e by replacing x e x p t with x f i n e to calculate nrmse fine based on eqs a 1 and a 2 where the subscript fine denotes the finest resolution results in this way the scaling behaviour of model performance with dp becomes independent of any potential errors in the experimental measurements see fig a 2 for these sensitivity tests we consider the default case to have the settings used in the final simulation described in the main text i e with dp 3 mm coefh 1 5 and using the laminar sps viscosity formulation and then assess how changes in model parameters influence performance given the computational demand of the simulations these sensitivity tests used shorter 300 s simulations equivalent to n 132 waves which based on fig a 1 was adequate to resolve the spectral wave evolution across the reef except for a portion of very low frequency wave energy the wave setup profile and a portion of the wave runup spectra the results were largely insensitive to variations in the smoothing coefficient coefh values between 1 4 1 8 only for the smallest value coefh 1 2 was there some reduction in the accuracy of the wave height and setup predictions table a 1 thus for the final simulation an intermediate value coefh 1 5 was used the sensitivity tests conducted to investigate the influence of particle distance dp table a 2 show that the predictions of wave heights setup and runup rapidly converge towards the experimental measurements as dp decreases from 14 mm to 5 mm fig a 2 however there are only small reductions in nrmse expt for dp 5 mm to balance model performance with computational efficiency a dp 3 mm was used for the final simulation which reproduced the experimental observations of wave height setup and runup to within approximately 5 error table a 2 to investigate how the results converged based on the numerical output alone in fig a 2 we also include the response of the nrmse fine in which the error is referenced to the finest simulation with dp 2 mm while the nrmse fine for wave height and runup continues to decrease as dp decreases for all values nrmse fine displays a more complicated pattern for wave setup initially decreasing as dp is reduced from 14 mm to 9 mm but then showing no consistent improvement for dp 7 mm while the simulations reported in the main text used the laminar sps viscosity formulation we also considered the use of a conventional artificial viscosity term that treats the viscous dissipation term in eq 5 as a 3 γ i π i j i w i j where the artificial viscosity term π i j is defined as monaghan 1992 a 4 π i j α c i j μ i j ρ i j u i j r i j 0 0 u i j r i j 0 with μ i j h sph u i j r i j r i j 2 ɛ 2 for ɛ 2 0 01 h sph c i j 0 5 c i c j is the mean speed of sound and α is a coefficient termed artificial viscosity that determines the rate of viscous dissipation in these sensitivity tests we varied α from a large value α 0 04 to zero table a 3 the results for wave height and setup were not very sensitive to variations in α over this large range but showed some slight reduction in nrmse expt at the lower values of α however the runup predictions showed more variable performance with α with lowest nrmse expt for α 0 005 these results indicate that low to negligible values of artificial viscosity best reproduced the experimental observations which is different from the surf zone simulations by lowe et al 2019 and numerous other wave studies using sph e g de padova et al 2014 that have found optimal performance with α of order 0 01 finally we assessed how the new numerical formulations describing fluid solidboundary interactions and the density diffusion term affect model performance fig a 3 table a 4 when using the original dynamic boundary condition dbc approach crespo et al 2007 the model performance deteriorates substantially for both wave height and runup inspection of the wave height h r m s profiles in fig a 3 indicates that the conventional dbc approach leads to greater dissipation of wave energy across the wide and shallow reef flat as well as substantial energy loss in the shallow swash flows at the shoreline not shown which together substantially reduces wave runup at the shoreline likewise wave height and setup predictions using the new density diffusion term by fourtakas et al 2019 were generally much improved compared to results using the original density diffusion term of molteni and colagrossi 2009 with the original density diffusion term there are substantial water level anomalies affecting both h r m s and wave setup within the active breaking region of the surf zone 
