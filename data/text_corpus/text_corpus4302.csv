index,text
21510,in order to control lateral buckling buckle initiation techniques such as distributed buoyancy section dbs are employed to trigger lateral buckles at planned locations dual dbss with a gap between are sometimes employed as a buckled initiation method which may trigger either a symmetric or antisymmetric mode in this study analytical models for symmetric mode triggered by dual dbss are proposed which are validated by comparing with test data first the buckled configuration and the post buckling behaviour are analysed then a detailed analysis is carried out to present the effect of dual dbss on the characteristics of the buckling behaviour comparisons between symmetric and antisymmetric buckling mode triggered by the same dual dbss are discussed the results show that when dual dbss are utilised as the buckle initiation technique both the symmetric and antisymmetric mode can be triggered symmetric mode is prone to be triggered for relative small spacing between dual dbss the symmetric mode is more dangerous than antisymmetric mode except that the weight ratio coefficient is small enough therefore during the design process it s better to check the maximum stress of both symmetric and antisymmetric mode to ensure the integrity of the buckled pipeline keywords subsea pipelines dual distributed buoyancy sections buckle initiation technique symmetric buckling mode 1 introduction more and more high pressure and high temperature oil and gas fields have been developed to meet the highly demand for energy during the past few decades so the subsea pipelines always operate under high pressure and high temperature conditions leading to excessive axial strain due to the restraint of axial soil resistance axial compressive force accumulates in the pipe wall which may trigger lateral buckles for unburied subsea pipelines the locations of the buckle formation are perhaps the key uncertainty in the lateral buckling design which depend on initial imperfections and the deflections during the post buckling process are uncontrolled so some buckle initiation methods are used in the buckling design to introduce initial imperfections or to reduce local weight of the pipeline to trigger buckles at planned locations so the reliability of the buckle formation will be improved and the maximum stress in the pipe will be controlled dnvgl rp f110 2018 wang et al 2017b in recent years some buckle initiation methods were employed to trigger lateral buckling at pre designed locations such as snake lay vertical upset local weight reduction and zero radius bend sinclair et al 2009 through introducing initial imperfections or reducing lateral soil resistance the reliability of buckle formation at these locations will be improved for local weight reduction dual dbss have been employed to trigger lateral buckles sinclair et al 2009 urthaler et al 2012 the initiation technique of buoyancy section works in two ways first during the process of the installation the pipe segment with dbs will be positively buoyant while the adjacent heavier pipe will embed into the seabed so a vertical imperfection forms besides the outside diameter of the pipe segment with dbs is normally larger than the normal pipe segment which further exaggerates the vertical imperfection a natural out of straightness is produced by the vertical imperfection which is benefit for the buckle formation second the operational submerged weight is reduced leading to smaller lateral soil resistance consequently the critical buckling force is reduced in this study the analytical method to solve the lateral buckling problem triggered by dual dbss is presented assuming the shape of deformation lateral and upheaval buckling of pipelines were investigated analytically through regarding the seabed as rigid croll 1997 hobbs 1984 hong et al 2015b ju and kyriakides 1988 karampour et al 2013a liu et al 2014a taylor and tran 1993 or soft shi et al 2013 wang et al 2011 2018d zeng and duan 2014 relaxing the assumption of buckled shapes localised lateral and upheaval buckling were investigated theoretically by zhu et al 2015 and wang et al wang and van der heijden 2017 2020a wang et al 2018d in addition the experiments were conducted to investigate upheaval buckling behaviour for buried pipelines maltby and calladine 1995a b and buckle interaction between propagation and global buckling karampour and albermani 2014 karampour et al 2013b more recently finite element method was employed to study pipeline buckling with the consideration of imperfections hong et al 2015a li and liu 2019 liang et al 2019 liu et al 2015 liu et al 2014b wang et al 2015a wang et al 2015b wang and van der heijden 2020b zeng et al 2014 zhang and duan 2015 zhang et al 2018 as for the buckle initiation techniques for unburied subsea pipelines some studies have been carried out recently peek and yun 2007 derived the analytical solutions of lateral buckling for subsea pipelines with a discrete buoyancy section two discrete buoyancy sections and one dbs over a specified length the buckled section of the pipeline was assumed to be uplifted within which no lateral soil resistance existed but the submerged weight of the pipe section with dbs was usually a small fraction typically 10 15 of the submerged weight of the normal pipe sinclair et al 2009 the buckled pipe section may not be uplifted so that the lateral soil resistance was partially reduced which was not considered by peek and yun in addition in order to understand the influence of dbss and sleepers on the characteristics of lateral buckling small scale experiments were carried out by silva junior et al 2008 and de oliveira cardoso and solano 2015 then shi and wang 2015 derived the analytical solutions for lateral buckling of subsea pipelines triggered by one discrete buoyancy section such as an air bag which will be removed after the lateral buckle occurred the pipeline was divided into three zones in the horizontal plane one span zone and two contacting zones the lateral soil resistance of the span zone was zero and for the contacting zones the elastic seabed model was adopted which may overestimate the lateral soil resistance for unburied subsea pipelines chatterjee et al 2012 wang et al 2017b wang et al 2017d derived the analytical solutions of controlled and uncontrolled lateral buckling to study the effect of the length of the feed in region comparisons between controlled and uncontrolled lateral buckling showed that post buckling behaviours were affected greatly by the length of feed in region analytical solutions of lateral buckling triggered by a single dbs were derived by wang et al 2017c 2018a and li et al 2016 they found that the minimum critical temperature difference will be reduced and the deflection of the buckled pipeline may be more benign when single dbs was employed analytical solutions were derived by wang et al wang and tang 2020a wang et al 2018b 2018c for symmetric and antisymmetric modes of lateral buckling triggered by single sleeper dual sleepers were employed as the buckle initiators at the pipeline crossings which was studied by bai et al 2009 through finite element method finite element models were also employed by wang et al 2017a to study lateral buckling behaviour of pipelines with imperfection and single sleeper the influence of dual dbss on the initiation of pipeline lateral buckling was verified by the survey conducted by urthaler et al 2012 in the survey seven sites were applied dual dbss which were used to trigger antisymmetric lateral buckling mode i e mode 2 but three of them formed symmetric buckling mode i e mode 1 under the same operational conditions antisymmetric buckling mode triggered by dual dbss was investigated by wang and tang 2020 however there is no study about symmetric buckling mode i e mode 1 triggered by dual dbss and it still remains unclear that which buckling mode symmetric or antisymmetric will be triggered when dual dbss are employed thus we will focus on the response of symmetric buckling mode triggered by dual dbss and the comparison between symmetric and antisymmetric buckling modes in this study analytical models of symmetric buckling mode triggered by dual dbss are proposed the derived analytical solutions are used to study the influence of dual dbss on the buckled configurations and post buckling behaviour the comparisons between symmetric and antisymmetric buckling mode triggered by the same dual dbss are presented to check which mode is prone to occur and which mode is good to the integrity of the buckled pipeline 2 analytical solution in order to derive the analytical solutions some main assumptions have to be made which are summarised first 1 symmetric buckling mode is assumed to be triggered 2 euler bernoulli beam model is used to simulate pipeline 3 lateral and axial soil resistances are assumed to be constant 4 ignore the difference of the outside diameters between pipe segments with and without dbs i e ignore the variation of soil resistances within the transition segment between pipe segments with and without dbs 5 the axial force within the buckled zone is assumed constant when determining the deflection of lateral buckle lateral buckles will occur for unburied subsea pipelines to relieve the axial force induced by high temperature and high pressure denoted by p 0 during the process of lateral buckling a small segment of the pipeline will mobilise laterally within which additional pipe feeds into the buckle resulting in the reduction of axial force see fig 1 due to the constraint of axial soil resistance the axial force increases with the distance from the centre of the pipe as shown in fig 1 at some point the length of thermal expansion is sufficient to satisfy the requirement of additional length introduced by the lateral deflection where no axial displacement happens these end points are called virtual anchor points the region between these end points are called the feed in region denoted by 2 l s as shown in fig 1 in this study dual dbss with a gap between are employed to trigger symmetric lateral buckling mode for symmetric buckling mode triggered by dual dbss the configuration and load distribution is shown in fig 2 w b and w p are the submerged weight for pipe segment with and without dbs respectively let w b k w p k is the weight ratio coefficient f b and f 1 are the lateral soil resistance for pipe segment with and without dbs respectively and f a b and f a 1 are the axial soil resistance for pipe segment with and without dbs respectively l b is the length of dbs l 1 is the half length between dual dbss let l 2 l b l 1 l 3 is the half length of buckled region beam column theory is employed to simulate the pipeline based on fig 1 the axial force distribution p x is 1 p x p f a 1 x 0 x l 1 p f a 1 l 1 f a b x l 1 l 1 x l 2 p f a 1 l 1 f a b l b f a 1 x l 2 l 2 x l s where p is the axial force at the centre of the buckle i e at x 0 the axial soil resistance per unit length is 2 f a b μ a b w b f a 1 μ a p w p where μ a b and μ a p are the axial friction coefficients between pipe and seabed for pipe segment with and without dbs respectively two cases are considered here i e case 1 for l 2 l 3 and case 2 for l 2 l 3 case 2 exists when the temperature difference is very small leading to a small l 3 or when l 1 or l b is large enough to make l 2 l 3 for these two cases the governing equations are different so all the results should be checked to determine which case they belong to the axial force within the buckled zone is assumed constant and equals to p when determining the deflection of lateral buckle an error analysis was conducted to show this assumption is acceptable wang et al 2018a b for the buckled pipeline the governing equations can be written as for case 1 l 2 l 3 3 e i d 4 w 1 d x 4 p d 2 w 1 d x 2 f 1 0 x l 1 e i d 4 w 2 d x 4 p d 2 w 2 d x 2 f b l 1 x l 2 e i d 4 w 3 d x 4 p d 2 w 3 d x 2 f 1 l 2 x l 3 for case 2 l 2 l 3 4 e i d 4 w 4 d x 4 p d 2 w 4 d x 2 f 1 0 x l 1 e i d 4 w 5 d x 4 p d 2 w 5 d x 2 f b l 1 x l 3 where w 1 w 2 w 3 w 4 and w 5 are lateral deflections e is the elastic modulus and i is the moment of inertia of the pipe s cross section the lateral soil resistance per unit length is 5 f b μ l b w b f 1 μ l p w p where μ l b and μ l p are the lateral friction coefficients between pipe and seabed for pipe segment with and without dbs respectively let 6 λ 2 p e i the general solutions of eq 3 and eq 4 are 7 w 1 x a 1 cos λ x a 2 sin λ x a 3 x a 4 f 1 x 2 2 e i λ 2 0 x l 1 w 2 x a 5 cos λ x a 6 sin λ x a 7 x a 8 f b x 2 2 e i λ 2 l 1 x l 2 w 3 x a 9 cos λ x a 10 sin λ x a 11 x a 12 f 1 x 2 2 e i λ 2 l 2 x l 3 8 w 4 x b 1 cos λ x b 2 sin λ x b 3 x b 4 f 1 x 2 2 e i λ 2 0 x l 1 w 5 x b 5 cos λ x b 6 sin λ x b 7 x b 8 f b x 2 2 e i λ 2 l 1 x l 3 where a i i 1 12 and b i i 1 8 are constant coefficients the symmetric buckling mode is triggered due to the symmetric conditions at x 0 the slope and shear force at x 0 are zero and the displacement slope and moment at x l 3 are zero too so the boundary conditions at x 0 and x l 3 for both case 1 and case 2 are 9 d w 1 d x 0 0 d 3 w 1 d x 3 0 0 w 3 l 3 0 d w 3 d x l 3 0 d 2 w 3 d x 2 l 3 0 10 d w 4 d x 0 0 d 3 w 4 d x 3 0 0 w 5 l 3 0 d w 5 d x l 3 0 d 2 w 5 d x 2 l 3 0 moreover the displacement slope moment and shear force are continuous at x l 1 for both case 1 and case 2 so the following matching conditions at x l 1 are required 11 w 1 l 1 w 2 l 1 d w 1 d x l 1 d w 2 d x l 1 d 2 w 1 d x 2 l 1 d 2 w 2 d x 2 l 1 d 3 w 1 d x 3 l 1 d 3 w 2 d x 3 l 1 12 w 4 l 1 w 5 l 1 d w 4 d x l 1 d w 5 d x l 1 d 2 w 4 d x 2 l 1 d 2 w 5 d x 2 l 1 d 3 w 4 d x 3 l 1 d 3 w 5 d x 3 l 1 for case 1 the displacement slope moment and shear force are continuous at x l 2 so the following matching conditions at x l 2 are imposed for case 1 13 w 2 l 2 w 3 l 2 d w 2 d x l 2 d w 3 d x l 2 d 2 w 2 d x 2 l 2 d 2 w 3 d x 2 l 2 d 3 w 2 d x 3 l 2 d 3 w 3 d x 3 l 2 the axial force balance for both case 1 and case 2 is 14 p 0 p f a b l b f a 1 l s l b the relationship between axial force p and temperature difference t 0 will be obtained by the compatibility condition between axial and lateral deflection compatibility for both case 1 and case 2 can be expressed as 15 u 1 u 2 where u 1 is the axial thermal expansion within the feed in region 0 x l s u 2 is the additional length required to form the lateral deflection the axial thermal expansion u 1 is expressed as 16 u 1 0 l s δ p x e a d x where δ p x p 0 p x is the reduction of axial force along the pipeline meanwhile u 2 can be obtained by 17 u 2 1 2 0 l 1 d w 1 d x 2 d x 1 2 l 1 l 2 d w 2 d x 2 d x 1 2 l 2 l 3 d w 3 d x 2 d x or 18 u 2 1 2 0 l 1 d w 4 d x 2 d x 1 2 l 1 l 3 d w 5 d x 2 d x within linear elastic response the compressive force p 0 is expressed as 19 p 0 e a α t 0 where α is the coefficient of linear thermal expansion t 0 is the total temperature difference which is composed of temperature difference and equivalent temperature difference induced by internal pressure dnvgl rp f110 2018 the bending moment m is obtained by 20 m e i d 2 w d x 2 where w stands for either w i i 1 5 thus the corresponding bending stress σ m can be expressed as 21 σ m m d 2 i where d is the external diameter of the pipe the maximum stress σ m is 22 σ m σ p σ m m where the stresses σ p and σ m m induced by p and m m respectively are 23 σ p p a σ m m m m d 2 i 3 results in this section based on symmetric buckling mode i e mode 1 lateral buckling triggered by dual dbss is analysed first the relationship between λ and l 3 is solved then the influences of the dual dbss on the buckled configurations are discussed typical post buckling behaviours of lateral buckling for subsea pipelines with dual dbss are analysed and the method to determine whether the results belong to case 1 or case 2 is presented a more detailed parametric analysis is discussed then finally mode 1 and mode 2 triggered by the same dual dbss are compared the numerical results obtained in this section are based on the parameters shown in table 1 3 1 relationship between λ and l 3 the solutions for the pipeline deflection w i i 1 5 can be expressed by the coefficients a i b i in terms of λ l 3 and all the parameters of the problem see the appendix a transcendental equation still needs to be solved to obtain the relationship between λ and l 3 the relationship between λ l 3 and the temperature difference t 0 can be obtained through using eq 14 and eq 18 as shown in fig 3 b for pipelines without dual dbss i e l b 0 m or k 1 the value of λ l 3 keeps constant for different temperature difference and equals to 4 4934 as shown in fig 3 b but the value of λ l 3 changes with temperature difference and the length of dbs for pipelines with dual dbss 3 2 buckled configuration under the same temperature difference fig 4 illustrates the half deformation and bending stress σ m for different l 1 the other half deformation and the corresponding bending stress are symmetric about x 0 the case for l 1 0 m represents the situation that dual dbss join together to form a single dbs from fig 4 a a buckled lobe exists within a certain pipe length l 3 x l 3 for each case the displacement amplitude always locates at x 0 and the displacement amplitude decreases with increasing l 1 the value of l 1 has little influence on the buckled length along the buckled pipeline two extrema of the bending stress exist for each case as shown in fig 4 b and the value of the extreme bending stress absolute value at the center of the buckled pipeline x 0 is larger than that of the other one so the maximum bending stress can be obtained at x 0 the maximum bending stress absolute value decreases when l 1 increases from 0 m to 20 m however the maximum bending stress absolute value starts to increase when l 1 increases from 20 m to 30 m under the same temperature difference fig 5 illustrates the half deformation and bending stress σ m for different l b from fig 5 a the deflection enlarges with increasing length of the dbs l b the locations of the displacement amplitude and the maximum bending stress absolute value are at x 0 both the displacement amplitude and the buckled length of the pipeline increase with increasing l b as shown in fig 5 a however the maximum bending stress absolute value becomes smaller for larger l b as shown in fig 5 b so the integrity of the pipeline will be improved by increasing the length of the dbs l b under the same temperature difference fig 6 illustrates the half deformation and bending stress σ m for different weight ratio coefficient k from fig 6 a the buckled shape enlarges with decreasing weight ratio coefficient k the displacement amplitude and the buckled length increase with decreasing weight ratio coefficient k because the lateral soil resistance will reduce when the weight ratio coefficient k decreases the buckled pipeline deforms laterally more easily for smaller weight ratio coefficient k from fig 6 b the maximum bending stress absolute value locates at x 0 and decreases with decreasing weight ratio coefficient k we conclude that for smaller k the deflection of the buckled pipeline is more benign so that the integrity of the pipeline is improved 3 3 typical post buckling behaviour analysis typical post buckling behaviour of lateral buckling for subsea pipelines with dual dbss is presented in fig 7 for the case showed in fig 7 l 2 equals to 50 m from fig 7 d for the solid line the half buckled length l 3 is larger than l 2 while for the dashed line the half buckled length l 3 is smaller than l 2 so we conclude that the solid line and the dashed line represent case 1 i e l 2 l 3 and case 2 i e l 2 l 3 respectively from fig 7 a the solution of lateral buckling only exists when the temperature difference is larger than the minimum critical temperature difference t m which is usually regarded as the safe temperature during the post buckling process two branches exist denoted by m b and m c from fig 7 a and d both the displacement amplitude and the half buckled length increase along branch m b and decrease along branch m c with increasing temperature difference which need more pipe to feed into the buckled region see fig 7 e along branch m b leading to a larger length of the feed in region see fig 7 f thus we conclude that branch m b is stable and branch m c is unstable wang and van der heijden 2017 along the stable branch m b the maximum stress σ m increases see fig 7 b while the axial force decreases with increasing temperature difference see fig 7 c 3 4 parametric analysis in this section a more detailed analysis is presented to show the effect of the spacing between dual dbss l 1 the length of the dbs l b and the weight ratio coefficient k on the displacement amplitude w m maximum stress σ m axial force p half buckled length l 3 axial thermal expansion u 1 and the length of the feed in region l s the influence of the spacing between dual dbss on the buckling behaviour is shown in fig 8 from fig 8 d for l 1 l 1 a l 3 is larger than l 1 l b which indicates that the results of the solid line are obtained based on case 1 for l 1 l 1 a l 3 is smaller than l 1 l b which indicates that the results of the dashed line are obtained based on case 2 from fig 8 a the displacement amplitude w m decreases with increasing l 1 the decreasing rate of w m is small for l 1 20 m which becomes larger for 20 m l 1 l 1 a and the decreasing rate of w m reduces with increasing l 1 for case 2 from fig 8 b the maximum stress σ m decreases firstly and then increases with increasing l 1 a local minimum value of σ m is obtained when l 1 increases to the region of case 2 the increasing rate of σ m decreases with increasing l 1 from fig 8 c the axial force p increases with increasing l 1 the increasing rate of p almost keeps constant for case 1 while it reduces with increasing l 1 for case 2 from fig 8 e and f both the axial thermal expansion u 1 and the length of the feed in region l s decrease with increasing l 1 the decreasing rates of u 1 and l s are close to constant for case 1 but the decreasing rates of u 1 and l s reduce with increasing l 1 for case 2 so we conclude that the influence of the spacing between dual dbss l 1 on the lateral buckling behaviour becomes smaller and smaller when l 1 increases to a certain large value to make l 3 l 1 l b so during the design process the value of l 1 should be selected carefully the influence of the length of dbs on buckling behaviour is shown in fig 9 from fig 9 d the solid line indicates the situation that l 3 is larger than l 1 l b which is obtained based on case 1 the dashed line represents the situation that l 3 is smaller than l 1 l b which is obtained based on case 2 from fig 9 a and d both the displacement amplitude w m and the half buckle length l 3 increase with increasing l b so the buckled pipeline needs more axial thermal expansion u 1 and the length of the feed in region l s see fig 9 e and f for larger l b to form a larger buckled shape and the increasing rates of w m l 3 u 1 and l s become smaller with increasing l b for case 1 which almost keep constant for case 2 from fig 9 b the maximum stress σ m decreases with increasing l b for case 1 and the decreasing rate of σ m reduces with increasing l b for case 1 when the value of l b increases up to the region of case 2 the maximum stress σ m starts to increase with increasing l b even though its increasing rate is very small from fig 9 c the axial force p decreases and its decreasing rate becomes smaller with increasing l b so we conclude that the lateral deflection of the buckled pipeline is more benign for larger l b for case 1 for case 2 i e l 1 l b l 3 the axial thermal expansion increases with increasing l b see fig 9 e since the axial soil resistance reduces with increasing l b so the deflection enlarges with increasing l b leading to the increase of the displacement amplitude w m and the maximum stress σ m so the increased dbs beyond the buckled region will deteriorate the integrity of the buckled pipeline during the design process an appropriate length of the dbs must be selected to keep all the dbs within the buckled region the influence of the weight ratio coefficient k on the buckling behaviour is shown in fig 10 the results showed in fig 10 are obtained for l 2 35 m from fig 10 d half buckled length l 3 decreases linearly with increasing weight ratio coefficient k which is larger than l 2 35 m for all the values of k so the results showed in fig 10 belong to case 1 from fig 10 a the displacement amplitude w m increases linearly with decreasing k so that the buckled section of the pipeline needs more axial thermal expansion for smaller k see fig 10 e and larger length of the feed in region l s see fig 10 f however the maximum stress σ m decreases with decreasing k as shown in fig 10 b so we conclude that the deflection of the buckled pipeline is more benign for smaller k from fig 10 c the axial force p decreases linearly with decreasing k so the buckled pipeline will be more stable for smaller k 3 5 comparisons between mode 1 and mode 2 when dual dbss are employed to trigger the pipeline to occur antisymmetric lateral buckling mode i e mode 2 either symmetric mode i e mode 1 or antisymmetric mode i e mode 2 may appear urthaler et al 2012 therefore in this section comparisons between mode 1 and mode 2 triggered by the same dual dbss are presented to show which mode tends to occur and which mode is benefit to the integrity of the buckled pipeline the results for antisymmetric mode i e mode 2 can be obtained through the analytical solutions derived in wang and tang 2020 3 5 1 minimum critical temperature difference the influence of l 1 l b and k on the minimum critical temperature difference t m for both mode 1 and mode 2 is illustrated in fig 11 fig 12 and fig 13 respectively from fig 11 for mode 1 t m increases with increasing l 1 its increasing rate reduces with increasing l 1 for mode 2 t m decreases firstly and then increases with increasing l 1 for l 1 l 1 a t m of mode 1 is smaller than that of mode 2 which means that mode 1 is prone to occur for l 1 l 1 a t m of mode 1 is larger than that of mode 2 which means that mode 2 is more easily to be triggered so we conclude that mode 1 occurs for smaller l 1 while mode 2 happens for larger l 1 in fig 12 one relative small l 1 and the other relative large l 1 are selected to show the influence on t m from fig 12 t m decreases with increasing l b for both l 1 5 m and l 1 20 m for l 1 20 m t m of mode 1 is larger than that of mode 2 for the same l b as shown in fig 12 b so that mode 2 tends to occur for l 1 5 m t m of mode 1 is larger than that of mode 2 for l b l b b and l b l b c as shown in fig 12 a which means that mode 2 is prone to happen however for l b b l b l b c t m of mode 1 is smaller which means mode 1 tends to be triggered from fig 13 t m decreases with decreasing k for both mode 1 and mode 2 for l 1 20 m the decreasing rate of t m of mode 2 is larger than that of mode 1 as shown in fig 13 b and t m of mode 2 is smaller that of mode 1 for the same k for l 1 20 m which means that mode 2 is prone to occur for l 1 5 m as shown in fig 13 a the decreasing rate of t m of mode 1 is larger than that of mode 2 for k k d t m of mode 2 is smaller than that of mode 1 which means that mode 2 is prone to occur however for k k d t m of mode 1 is smaller than that of mode 2 which means that mode 1 is prone to occur so we conclude that mode 1 can only be triggered with smaller l 1 when dual dbss are employed as the buckle initiation technique 3 5 2 influence of dbs on w m and σ m the influence of the spacing between dual dbss l 1 on w m and σ m with different l b and k is illustrated in fig 14 and fig 15 respectively from fig 14 a and fig 15 a w m of mode 1 decreases with increasing l 1 while w m of mode 2 increases firstly and then decreases with increasing l 1 and the influence of l b and k on w m of mode 1 becomes smaller for larger l 1 for each case showed in fig 14 a and fig 15 a w m of mode 1 is much larger than that of mode 2 from fig 14 b and fig 15 b σ m of mode 1 decreases firstly and then increases with increasing l 1 and σ m of mode 2 increases firstly then decreases and then increases again with increasing l 1 a local minimum value of σ m locates at about l 1 15 m for mode 1 and at about l 1 40 m for mode 2 σ m of mode 1 is larger than that of mode 2 almost for all the cases as shown in fig 14 b and fig 15 b except that l 1 is from 5 m to 15 m for k 0 1 and k 0 2 so we conclude that for most cases mode 1 is more dangerous than mode 2 the influence of l b on w m and σ m with different l 1 and k is illustrated in fig 16 and fig 17 respectively from fig 16 a and fig 17 a w m of both mode 1 and mode 2 increases with increasing l b for each case for each case showed in fig 16 a and fig 17 a w m of mode 1 is much larger than that of mode 2 from fig 16 b and fig 17 b σ m of mode 1 decreases in a fast rate firstly and then increases slightly with increasing l b for mode 2 σ m increases firstly and then decreases with increasing l b in fig 16 b σ m of mode 1 is larger than that of mode 2 for all the cases in fig 17 b taking k 0 1 as an example for l b 15 m or l b 65 m σ m of mode 1 is larger than that of mode 2 while for 15 m l b 65 m σ m of mode 1 is smaller than that of mode 2 it seems that only for small k σ m of mode 1 can be smaller than that of mode 2 so a detailed analysis about the influence of k is presented later the influence of k on w m and σ m with different l 1 and l b is illustrated in fig 18 and fig 19 respectively from fig 18 a and fig 19 a w m of both mode 1 and mode 2 increases with decreasing k for each case and w m of mode 1 is much larger than that of mode 2 from fig 18 b and fig 19 b σ m of mode 1 decreases linearly with decreasing k for l 1 5 m in fig 18 b and l b 10 m in fig 19 b σ m of mode 2 increases linearly with decreasing k however for l 1 20 m in fig 18 b and l b 30 m in fig 19 b σ m of mode 2 decreases linearly with decreasing k and it s clear to see that the influence of k on σ m of mode 1 is much larger than that of mode 2 for relative large k σ m of mode 1 is larger than that of mode 2 but σ m of mode 1 may be smaller than that of mode 2 for relative small k therefore during the design process mode 1 can be considered as the intended buckle configuration for relative small k when the value of k is not so small mode 2 should be triggered 3 6 validation to validate the proposed mathematical models analytical solutions obtained through the formulations derived in section 2 with the parameters in table 2 which were used in the reduced scale model test in de oliveira cardoso and solano 2015 in the reduced scale model test three buckles were triggered by three distributed buoyancy sections with equal spacing of 2 l a 65 m l a is the maximum possible axial feed in length p a is the axial compressive force at the virtual anchors between two buckles the pipe section between two adjacent virtual anchor points and of length l 65 m is considered here since the axial feed in displacement is zero at these virtual anchor points thus the maximum axial feed in length l a is 32 5 m when l s is smaller than l a then all the formulae derived in section 2 can be applied when l s is larger than l a the formula for axial force should be modified due to the limit of axial feed in length in that case by axial force balance the following equation can be obtained wang et al 2017d 24 p a p f a 1 l a l b f a b l b and the length of axial expansion within 0 x l a is modified to 25 u 1 0 l a δ p x e a d x where δ p x p 0 p x the comparison between test data and analytical solution is shown in fig 20 in the reduced scale model test in de oliveira cardoso and solano 2015 only one continuous distributed buoyancy section exists within one buckle in order to compare with the test data the case of l 1 0 m is employed for the analytical solution which represents that the distance between dual discrete buoyancy sections is zero and these dual discrete buoyancy sections become a single continuous distributed buoyancy section t c shown in fig 20 is the critical temperature difference for the test results with initial imperfection in the pre buckling state i e t 0 t c the displacement amplitude for the test results is much smaller than that for analytical solution the reason is that the mathematical model proposed in this study is based on the assumption of ideal straight pipeline while initial imperfection is introduced in the reduced scale model test at t 0 t c there is sudden increase in the displacement amplitude for the test results in the post buckling state i e t 0 t c the difference between test data and analytical solution becomes smaller with increasing temperature difference 4 conclusions analytical solutions of symmetric lateral buckling triggered by dual distributed buoyancy sections dual dbss were derived the comparison between analytical solution and test data was presented to validate the proposed mathematical model the influence of the dual dbss on the buckled configurations and the post buckling behaviour was discussed and comparisons between symmetric and antisymmetric buckling mode triggered by the same dual dbss were presented and discussed from our parametric analysis the following conclusions are drawn i from the typical post buckling behaviour analysis both the displacement amplitude and the maximum stress increase while the axial force decreases with increasing temperature difference along the stable branch the method to determine whether the results belong to case 1 or case 2 is presented ii the maximum stress decreases firstly and then increases with increasing spacing between dual dbss so an appropriate value of spacing between dual dbss should be selected the maximum stress decreases in a fast rate for case 1 and increases slightly for case 2 with increasing length of the dbs all the length of the dbs should be within the region of the buckled section since the increased section of the buoyancy section beyond the buckled section is of no effect to reduce the maximum stress in the buckled pipeline the last method to reduce the maximum stress of the buckled pipeline is to decrease the submerged weight of the dbs iii when dual dbss are employed as the buckle initiation technique symmetric buckling mode is prone to be triggered for smaller spacing between dual dbss while antisymmetric buckling mode tends to occur for larger spacing between dual dbss iv the displacement amplitude of symmetric buckling mode is much larger than that of antisymmetric buckling mode under the same conditions the maximum stress of symmetric buckling mode is larger than that of antisymmetric buckling mode except that the weight ratio coefficient is small enough v when dual dbss are utilised as the buckle initiation technique both the symmetric and antisymmetric buckling mode can occur therefore during the design process it s better to check the maximum stress of both symmetric and antisymmetric buckling mode author statement zhenkui wang developed the theory and performed the computations data analysis and interpretation drafting the article yougang tang critical revision of the article declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was funded by the international postdoctoral fellowship program from the china postdoctoral council no 20180049 appendix a eq a 1 a 1 sec λ l 3 f 1 f b cos λ l 1 l 3 cos λ l 2 l 3 f 1 e i λ 4 eq a 2 a 2 0 eq a 3 a 3 0 eq a 4 a 4 λ 2 f 1 l 1 2 2 l 1 l 3 l 2 l 3 2 f b l 1 l 2 l 1 l 2 2 l 3 2 f 1 2 e i λ 4 eq a 5 a 5 f 1 f b tan λ l 3 sin λ l 1 sin λ l 2 f 1 f b cos λ l 2 f 1 sec λ l 3 e i λ 4 eq a 6 a 6 f 1 f b sin λ l 1 e i λ 4 eq a 7 a 7 l 1 f b f 1 e i λ 2 eq a 8 a 8 λ 2 2 l 3 f 1 f b l 1 l 2 l 2 2 f 1 f b f 1 l 3 2 2 f b 2 e i λ 4 eq a 9 a 9 f 1 f b tan λ l 3 sin λ l 1 sin λ l 2 f 1 sec λ l 3 e i λ 4 eq a 10 a 10 f 1 f b sin λ l 1 sin λ l 2 e i λ 4 eq a 11 a 11 f 1 f b l 1 l 2 e i λ 2 eq a 12 a 12 λ 2 l 3 2 f 1 f b l 1 l 2 f 1 l 3 2 f 1 2 e i λ 4 eq a 13 b 1 sec λ l 3 f 1 f b cos λ l 1 l 3 f b e i λ 4 eq a 14 b 2 0 eq a 15 b 3 0 eq a 16 b 4 λ 2 f b l 1 l 3 2 f 1 l 1 l 1 2 l 3 2 f 1 2 e i λ 4 eq a 17 b 5 f b f 1 sin λ l 1 tan λ l 3 f b sec λ l 3 e i λ 4 eq a 18 b 6 f 1 f b sin λ l 1 e i λ 4 eq a 19 b 7 l 1 f b f 1 e i λ 2 eq a 20 b 8 λ 2 l 3 2 f 1 l 1 f b l 3 2 l 1 2 f b 2 e i λ 4 
21510,in order to control lateral buckling buckle initiation techniques such as distributed buoyancy section dbs are employed to trigger lateral buckles at planned locations dual dbss with a gap between are sometimes employed as a buckled initiation method which may trigger either a symmetric or antisymmetric mode in this study analytical models for symmetric mode triggered by dual dbss are proposed which are validated by comparing with test data first the buckled configuration and the post buckling behaviour are analysed then a detailed analysis is carried out to present the effect of dual dbss on the characteristics of the buckling behaviour comparisons between symmetric and antisymmetric buckling mode triggered by the same dual dbss are discussed the results show that when dual dbss are utilised as the buckle initiation technique both the symmetric and antisymmetric mode can be triggered symmetric mode is prone to be triggered for relative small spacing between dual dbss the symmetric mode is more dangerous than antisymmetric mode except that the weight ratio coefficient is small enough therefore during the design process it s better to check the maximum stress of both symmetric and antisymmetric mode to ensure the integrity of the buckled pipeline keywords subsea pipelines dual distributed buoyancy sections buckle initiation technique symmetric buckling mode 1 introduction more and more high pressure and high temperature oil and gas fields have been developed to meet the highly demand for energy during the past few decades so the subsea pipelines always operate under high pressure and high temperature conditions leading to excessive axial strain due to the restraint of axial soil resistance axial compressive force accumulates in the pipe wall which may trigger lateral buckles for unburied subsea pipelines the locations of the buckle formation are perhaps the key uncertainty in the lateral buckling design which depend on initial imperfections and the deflections during the post buckling process are uncontrolled so some buckle initiation methods are used in the buckling design to introduce initial imperfections or to reduce local weight of the pipeline to trigger buckles at planned locations so the reliability of the buckle formation will be improved and the maximum stress in the pipe will be controlled dnvgl rp f110 2018 wang et al 2017b in recent years some buckle initiation methods were employed to trigger lateral buckling at pre designed locations such as snake lay vertical upset local weight reduction and zero radius bend sinclair et al 2009 through introducing initial imperfections or reducing lateral soil resistance the reliability of buckle formation at these locations will be improved for local weight reduction dual dbss have been employed to trigger lateral buckles sinclair et al 2009 urthaler et al 2012 the initiation technique of buoyancy section works in two ways first during the process of the installation the pipe segment with dbs will be positively buoyant while the adjacent heavier pipe will embed into the seabed so a vertical imperfection forms besides the outside diameter of the pipe segment with dbs is normally larger than the normal pipe segment which further exaggerates the vertical imperfection a natural out of straightness is produced by the vertical imperfection which is benefit for the buckle formation second the operational submerged weight is reduced leading to smaller lateral soil resistance consequently the critical buckling force is reduced in this study the analytical method to solve the lateral buckling problem triggered by dual dbss is presented assuming the shape of deformation lateral and upheaval buckling of pipelines were investigated analytically through regarding the seabed as rigid croll 1997 hobbs 1984 hong et al 2015b ju and kyriakides 1988 karampour et al 2013a liu et al 2014a taylor and tran 1993 or soft shi et al 2013 wang et al 2011 2018d zeng and duan 2014 relaxing the assumption of buckled shapes localised lateral and upheaval buckling were investigated theoretically by zhu et al 2015 and wang et al wang and van der heijden 2017 2020a wang et al 2018d in addition the experiments were conducted to investigate upheaval buckling behaviour for buried pipelines maltby and calladine 1995a b and buckle interaction between propagation and global buckling karampour and albermani 2014 karampour et al 2013b more recently finite element method was employed to study pipeline buckling with the consideration of imperfections hong et al 2015a li and liu 2019 liang et al 2019 liu et al 2015 liu et al 2014b wang et al 2015a wang et al 2015b wang and van der heijden 2020b zeng et al 2014 zhang and duan 2015 zhang et al 2018 as for the buckle initiation techniques for unburied subsea pipelines some studies have been carried out recently peek and yun 2007 derived the analytical solutions of lateral buckling for subsea pipelines with a discrete buoyancy section two discrete buoyancy sections and one dbs over a specified length the buckled section of the pipeline was assumed to be uplifted within which no lateral soil resistance existed but the submerged weight of the pipe section with dbs was usually a small fraction typically 10 15 of the submerged weight of the normal pipe sinclair et al 2009 the buckled pipe section may not be uplifted so that the lateral soil resistance was partially reduced which was not considered by peek and yun in addition in order to understand the influence of dbss and sleepers on the characteristics of lateral buckling small scale experiments were carried out by silva junior et al 2008 and de oliveira cardoso and solano 2015 then shi and wang 2015 derived the analytical solutions for lateral buckling of subsea pipelines triggered by one discrete buoyancy section such as an air bag which will be removed after the lateral buckle occurred the pipeline was divided into three zones in the horizontal plane one span zone and two contacting zones the lateral soil resistance of the span zone was zero and for the contacting zones the elastic seabed model was adopted which may overestimate the lateral soil resistance for unburied subsea pipelines chatterjee et al 2012 wang et al 2017b wang et al 2017d derived the analytical solutions of controlled and uncontrolled lateral buckling to study the effect of the length of the feed in region comparisons between controlled and uncontrolled lateral buckling showed that post buckling behaviours were affected greatly by the length of feed in region analytical solutions of lateral buckling triggered by a single dbs were derived by wang et al 2017c 2018a and li et al 2016 they found that the minimum critical temperature difference will be reduced and the deflection of the buckled pipeline may be more benign when single dbs was employed analytical solutions were derived by wang et al wang and tang 2020a wang et al 2018b 2018c for symmetric and antisymmetric modes of lateral buckling triggered by single sleeper dual sleepers were employed as the buckle initiators at the pipeline crossings which was studied by bai et al 2009 through finite element method finite element models were also employed by wang et al 2017a to study lateral buckling behaviour of pipelines with imperfection and single sleeper the influence of dual dbss on the initiation of pipeline lateral buckling was verified by the survey conducted by urthaler et al 2012 in the survey seven sites were applied dual dbss which were used to trigger antisymmetric lateral buckling mode i e mode 2 but three of them formed symmetric buckling mode i e mode 1 under the same operational conditions antisymmetric buckling mode triggered by dual dbss was investigated by wang and tang 2020 however there is no study about symmetric buckling mode i e mode 1 triggered by dual dbss and it still remains unclear that which buckling mode symmetric or antisymmetric will be triggered when dual dbss are employed thus we will focus on the response of symmetric buckling mode triggered by dual dbss and the comparison between symmetric and antisymmetric buckling modes in this study analytical models of symmetric buckling mode triggered by dual dbss are proposed the derived analytical solutions are used to study the influence of dual dbss on the buckled configurations and post buckling behaviour the comparisons between symmetric and antisymmetric buckling mode triggered by the same dual dbss are presented to check which mode is prone to occur and which mode is good to the integrity of the buckled pipeline 2 analytical solution in order to derive the analytical solutions some main assumptions have to be made which are summarised first 1 symmetric buckling mode is assumed to be triggered 2 euler bernoulli beam model is used to simulate pipeline 3 lateral and axial soil resistances are assumed to be constant 4 ignore the difference of the outside diameters between pipe segments with and without dbs i e ignore the variation of soil resistances within the transition segment between pipe segments with and without dbs 5 the axial force within the buckled zone is assumed constant when determining the deflection of lateral buckle lateral buckles will occur for unburied subsea pipelines to relieve the axial force induced by high temperature and high pressure denoted by p 0 during the process of lateral buckling a small segment of the pipeline will mobilise laterally within which additional pipe feeds into the buckle resulting in the reduction of axial force see fig 1 due to the constraint of axial soil resistance the axial force increases with the distance from the centre of the pipe as shown in fig 1 at some point the length of thermal expansion is sufficient to satisfy the requirement of additional length introduced by the lateral deflection where no axial displacement happens these end points are called virtual anchor points the region between these end points are called the feed in region denoted by 2 l s as shown in fig 1 in this study dual dbss with a gap between are employed to trigger symmetric lateral buckling mode for symmetric buckling mode triggered by dual dbss the configuration and load distribution is shown in fig 2 w b and w p are the submerged weight for pipe segment with and without dbs respectively let w b k w p k is the weight ratio coefficient f b and f 1 are the lateral soil resistance for pipe segment with and without dbs respectively and f a b and f a 1 are the axial soil resistance for pipe segment with and without dbs respectively l b is the length of dbs l 1 is the half length between dual dbss let l 2 l b l 1 l 3 is the half length of buckled region beam column theory is employed to simulate the pipeline based on fig 1 the axial force distribution p x is 1 p x p f a 1 x 0 x l 1 p f a 1 l 1 f a b x l 1 l 1 x l 2 p f a 1 l 1 f a b l b f a 1 x l 2 l 2 x l s where p is the axial force at the centre of the buckle i e at x 0 the axial soil resistance per unit length is 2 f a b μ a b w b f a 1 μ a p w p where μ a b and μ a p are the axial friction coefficients between pipe and seabed for pipe segment with and without dbs respectively two cases are considered here i e case 1 for l 2 l 3 and case 2 for l 2 l 3 case 2 exists when the temperature difference is very small leading to a small l 3 or when l 1 or l b is large enough to make l 2 l 3 for these two cases the governing equations are different so all the results should be checked to determine which case they belong to the axial force within the buckled zone is assumed constant and equals to p when determining the deflection of lateral buckle an error analysis was conducted to show this assumption is acceptable wang et al 2018a b for the buckled pipeline the governing equations can be written as for case 1 l 2 l 3 3 e i d 4 w 1 d x 4 p d 2 w 1 d x 2 f 1 0 x l 1 e i d 4 w 2 d x 4 p d 2 w 2 d x 2 f b l 1 x l 2 e i d 4 w 3 d x 4 p d 2 w 3 d x 2 f 1 l 2 x l 3 for case 2 l 2 l 3 4 e i d 4 w 4 d x 4 p d 2 w 4 d x 2 f 1 0 x l 1 e i d 4 w 5 d x 4 p d 2 w 5 d x 2 f b l 1 x l 3 where w 1 w 2 w 3 w 4 and w 5 are lateral deflections e is the elastic modulus and i is the moment of inertia of the pipe s cross section the lateral soil resistance per unit length is 5 f b μ l b w b f 1 μ l p w p where μ l b and μ l p are the lateral friction coefficients between pipe and seabed for pipe segment with and without dbs respectively let 6 λ 2 p e i the general solutions of eq 3 and eq 4 are 7 w 1 x a 1 cos λ x a 2 sin λ x a 3 x a 4 f 1 x 2 2 e i λ 2 0 x l 1 w 2 x a 5 cos λ x a 6 sin λ x a 7 x a 8 f b x 2 2 e i λ 2 l 1 x l 2 w 3 x a 9 cos λ x a 10 sin λ x a 11 x a 12 f 1 x 2 2 e i λ 2 l 2 x l 3 8 w 4 x b 1 cos λ x b 2 sin λ x b 3 x b 4 f 1 x 2 2 e i λ 2 0 x l 1 w 5 x b 5 cos λ x b 6 sin λ x b 7 x b 8 f b x 2 2 e i λ 2 l 1 x l 3 where a i i 1 12 and b i i 1 8 are constant coefficients the symmetric buckling mode is triggered due to the symmetric conditions at x 0 the slope and shear force at x 0 are zero and the displacement slope and moment at x l 3 are zero too so the boundary conditions at x 0 and x l 3 for both case 1 and case 2 are 9 d w 1 d x 0 0 d 3 w 1 d x 3 0 0 w 3 l 3 0 d w 3 d x l 3 0 d 2 w 3 d x 2 l 3 0 10 d w 4 d x 0 0 d 3 w 4 d x 3 0 0 w 5 l 3 0 d w 5 d x l 3 0 d 2 w 5 d x 2 l 3 0 moreover the displacement slope moment and shear force are continuous at x l 1 for both case 1 and case 2 so the following matching conditions at x l 1 are required 11 w 1 l 1 w 2 l 1 d w 1 d x l 1 d w 2 d x l 1 d 2 w 1 d x 2 l 1 d 2 w 2 d x 2 l 1 d 3 w 1 d x 3 l 1 d 3 w 2 d x 3 l 1 12 w 4 l 1 w 5 l 1 d w 4 d x l 1 d w 5 d x l 1 d 2 w 4 d x 2 l 1 d 2 w 5 d x 2 l 1 d 3 w 4 d x 3 l 1 d 3 w 5 d x 3 l 1 for case 1 the displacement slope moment and shear force are continuous at x l 2 so the following matching conditions at x l 2 are imposed for case 1 13 w 2 l 2 w 3 l 2 d w 2 d x l 2 d w 3 d x l 2 d 2 w 2 d x 2 l 2 d 2 w 3 d x 2 l 2 d 3 w 2 d x 3 l 2 d 3 w 3 d x 3 l 2 the axial force balance for both case 1 and case 2 is 14 p 0 p f a b l b f a 1 l s l b the relationship between axial force p and temperature difference t 0 will be obtained by the compatibility condition between axial and lateral deflection compatibility for both case 1 and case 2 can be expressed as 15 u 1 u 2 where u 1 is the axial thermal expansion within the feed in region 0 x l s u 2 is the additional length required to form the lateral deflection the axial thermal expansion u 1 is expressed as 16 u 1 0 l s δ p x e a d x where δ p x p 0 p x is the reduction of axial force along the pipeline meanwhile u 2 can be obtained by 17 u 2 1 2 0 l 1 d w 1 d x 2 d x 1 2 l 1 l 2 d w 2 d x 2 d x 1 2 l 2 l 3 d w 3 d x 2 d x or 18 u 2 1 2 0 l 1 d w 4 d x 2 d x 1 2 l 1 l 3 d w 5 d x 2 d x within linear elastic response the compressive force p 0 is expressed as 19 p 0 e a α t 0 where α is the coefficient of linear thermal expansion t 0 is the total temperature difference which is composed of temperature difference and equivalent temperature difference induced by internal pressure dnvgl rp f110 2018 the bending moment m is obtained by 20 m e i d 2 w d x 2 where w stands for either w i i 1 5 thus the corresponding bending stress σ m can be expressed as 21 σ m m d 2 i where d is the external diameter of the pipe the maximum stress σ m is 22 σ m σ p σ m m where the stresses σ p and σ m m induced by p and m m respectively are 23 σ p p a σ m m m m d 2 i 3 results in this section based on symmetric buckling mode i e mode 1 lateral buckling triggered by dual dbss is analysed first the relationship between λ and l 3 is solved then the influences of the dual dbss on the buckled configurations are discussed typical post buckling behaviours of lateral buckling for subsea pipelines with dual dbss are analysed and the method to determine whether the results belong to case 1 or case 2 is presented a more detailed parametric analysis is discussed then finally mode 1 and mode 2 triggered by the same dual dbss are compared the numerical results obtained in this section are based on the parameters shown in table 1 3 1 relationship between λ and l 3 the solutions for the pipeline deflection w i i 1 5 can be expressed by the coefficients a i b i in terms of λ l 3 and all the parameters of the problem see the appendix a transcendental equation still needs to be solved to obtain the relationship between λ and l 3 the relationship between λ l 3 and the temperature difference t 0 can be obtained through using eq 14 and eq 18 as shown in fig 3 b for pipelines without dual dbss i e l b 0 m or k 1 the value of λ l 3 keeps constant for different temperature difference and equals to 4 4934 as shown in fig 3 b but the value of λ l 3 changes with temperature difference and the length of dbs for pipelines with dual dbss 3 2 buckled configuration under the same temperature difference fig 4 illustrates the half deformation and bending stress σ m for different l 1 the other half deformation and the corresponding bending stress are symmetric about x 0 the case for l 1 0 m represents the situation that dual dbss join together to form a single dbs from fig 4 a a buckled lobe exists within a certain pipe length l 3 x l 3 for each case the displacement amplitude always locates at x 0 and the displacement amplitude decreases with increasing l 1 the value of l 1 has little influence on the buckled length along the buckled pipeline two extrema of the bending stress exist for each case as shown in fig 4 b and the value of the extreme bending stress absolute value at the center of the buckled pipeline x 0 is larger than that of the other one so the maximum bending stress can be obtained at x 0 the maximum bending stress absolute value decreases when l 1 increases from 0 m to 20 m however the maximum bending stress absolute value starts to increase when l 1 increases from 20 m to 30 m under the same temperature difference fig 5 illustrates the half deformation and bending stress σ m for different l b from fig 5 a the deflection enlarges with increasing length of the dbs l b the locations of the displacement amplitude and the maximum bending stress absolute value are at x 0 both the displacement amplitude and the buckled length of the pipeline increase with increasing l b as shown in fig 5 a however the maximum bending stress absolute value becomes smaller for larger l b as shown in fig 5 b so the integrity of the pipeline will be improved by increasing the length of the dbs l b under the same temperature difference fig 6 illustrates the half deformation and bending stress σ m for different weight ratio coefficient k from fig 6 a the buckled shape enlarges with decreasing weight ratio coefficient k the displacement amplitude and the buckled length increase with decreasing weight ratio coefficient k because the lateral soil resistance will reduce when the weight ratio coefficient k decreases the buckled pipeline deforms laterally more easily for smaller weight ratio coefficient k from fig 6 b the maximum bending stress absolute value locates at x 0 and decreases with decreasing weight ratio coefficient k we conclude that for smaller k the deflection of the buckled pipeline is more benign so that the integrity of the pipeline is improved 3 3 typical post buckling behaviour analysis typical post buckling behaviour of lateral buckling for subsea pipelines with dual dbss is presented in fig 7 for the case showed in fig 7 l 2 equals to 50 m from fig 7 d for the solid line the half buckled length l 3 is larger than l 2 while for the dashed line the half buckled length l 3 is smaller than l 2 so we conclude that the solid line and the dashed line represent case 1 i e l 2 l 3 and case 2 i e l 2 l 3 respectively from fig 7 a the solution of lateral buckling only exists when the temperature difference is larger than the minimum critical temperature difference t m which is usually regarded as the safe temperature during the post buckling process two branches exist denoted by m b and m c from fig 7 a and d both the displacement amplitude and the half buckled length increase along branch m b and decrease along branch m c with increasing temperature difference which need more pipe to feed into the buckled region see fig 7 e along branch m b leading to a larger length of the feed in region see fig 7 f thus we conclude that branch m b is stable and branch m c is unstable wang and van der heijden 2017 along the stable branch m b the maximum stress σ m increases see fig 7 b while the axial force decreases with increasing temperature difference see fig 7 c 3 4 parametric analysis in this section a more detailed analysis is presented to show the effect of the spacing between dual dbss l 1 the length of the dbs l b and the weight ratio coefficient k on the displacement amplitude w m maximum stress σ m axial force p half buckled length l 3 axial thermal expansion u 1 and the length of the feed in region l s the influence of the spacing between dual dbss on the buckling behaviour is shown in fig 8 from fig 8 d for l 1 l 1 a l 3 is larger than l 1 l b which indicates that the results of the solid line are obtained based on case 1 for l 1 l 1 a l 3 is smaller than l 1 l b which indicates that the results of the dashed line are obtained based on case 2 from fig 8 a the displacement amplitude w m decreases with increasing l 1 the decreasing rate of w m is small for l 1 20 m which becomes larger for 20 m l 1 l 1 a and the decreasing rate of w m reduces with increasing l 1 for case 2 from fig 8 b the maximum stress σ m decreases firstly and then increases with increasing l 1 a local minimum value of σ m is obtained when l 1 increases to the region of case 2 the increasing rate of σ m decreases with increasing l 1 from fig 8 c the axial force p increases with increasing l 1 the increasing rate of p almost keeps constant for case 1 while it reduces with increasing l 1 for case 2 from fig 8 e and f both the axial thermal expansion u 1 and the length of the feed in region l s decrease with increasing l 1 the decreasing rates of u 1 and l s are close to constant for case 1 but the decreasing rates of u 1 and l s reduce with increasing l 1 for case 2 so we conclude that the influence of the spacing between dual dbss l 1 on the lateral buckling behaviour becomes smaller and smaller when l 1 increases to a certain large value to make l 3 l 1 l b so during the design process the value of l 1 should be selected carefully the influence of the length of dbs on buckling behaviour is shown in fig 9 from fig 9 d the solid line indicates the situation that l 3 is larger than l 1 l b which is obtained based on case 1 the dashed line represents the situation that l 3 is smaller than l 1 l b which is obtained based on case 2 from fig 9 a and d both the displacement amplitude w m and the half buckle length l 3 increase with increasing l b so the buckled pipeline needs more axial thermal expansion u 1 and the length of the feed in region l s see fig 9 e and f for larger l b to form a larger buckled shape and the increasing rates of w m l 3 u 1 and l s become smaller with increasing l b for case 1 which almost keep constant for case 2 from fig 9 b the maximum stress σ m decreases with increasing l b for case 1 and the decreasing rate of σ m reduces with increasing l b for case 1 when the value of l b increases up to the region of case 2 the maximum stress σ m starts to increase with increasing l b even though its increasing rate is very small from fig 9 c the axial force p decreases and its decreasing rate becomes smaller with increasing l b so we conclude that the lateral deflection of the buckled pipeline is more benign for larger l b for case 1 for case 2 i e l 1 l b l 3 the axial thermal expansion increases with increasing l b see fig 9 e since the axial soil resistance reduces with increasing l b so the deflection enlarges with increasing l b leading to the increase of the displacement amplitude w m and the maximum stress σ m so the increased dbs beyond the buckled region will deteriorate the integrity of the buckled pipeline during the design process an appropriate length of the dbs must be selected to keep all the dbs within the buckled region the influence of the weight ratio coefficient k on the buckling behaviour is shown in fig 10 the results showed in fig 10 are obtained for l 2 35 m from fig 10 d half buckled length l 3 decreases linearly with increasing weight ratio coefficient k which is larger than l 2 35 m for all the values of k so the results showed in fig 10 belong to case 1 from fig 10 a the displacement amplitude w m increases linearly with decreasing k so that the buckled section of the pipeline needs more axial thermal expansion for smaller k see fig 10 e and larger length of the feed in region l s see fig 10 f however the maximum stress σ m decreases with decreasing k as shown in fig 10 b so we conclude that the deflection of the buckled pipeline is more benign for smaller k from fig 10 c the axial force p decreases linearly with decreasing k so the buckled pipeline will be more stable for smaller k 3 5 comparisons between mode 1 and mode 2 when dual dbss are employed to trigger the pipeline to occur antisymmetric lateral buckling mode i e mode 2 either symmetric mode i e mode 1 or antisymmetric mode i e mode 2 may appear urthaler et al 2012 therefore in this section comparisons between mode 1 and mode 2 triggered by the same dual dbss are presented to show which mode tends to occur and which mode is benefit to the integrity of the buckled pipeline the results for antisymmetric mode i e mode 2 can be obtained through the analytical solutions derived in wang and tang 2020 3 5 1 minimum critical temperature difference the influence of l 1 l b and k on the minimum critical temperature difference t m for both mode 1 and mode 2 is illustrated in fig 11 fig 12 and fig 13 respectively from fig 11 for mode 1 t m increases with increasing l 1 its increasing rate reduces with increasing l 1 for mode 2 t m decreases firstly and then increases with increasing l 1 for l 1 l 1 a t m of mode 1 is smaller than that of mode 2 which means that mode 1 is prone to occur for l 1 l 1 a t m of mode 1 is larger than that of mode 2 which means that mode 2 is more easily to be triggered so we conclude that mode 1 occurs for smaller l 1 while mode 2 happens for larger l 1 in fig 12 one relative small l 1 and the other relative large l 1 are selected to show the influence on t m from fig 12 t m decreases with increasing l b for both l 1 5 m and l 1 20 m for l 1 20 m t m of mode 1 is larger than that of mode 2 for the same l b as shown in fig 12 b so that mode 2 tends to occur for l 1 5 m t m of mode 1 is larger than that of mode 2 for l b l b b and l b l b c as shown in fig 12 a which means that mode 2 is prone to happen however for l b b l b l b c t m of mode 1 is smaller which means mode 1 tends to be triggered from fig 13 t m decreases with decreasing k for both mode 1 and mode 2 for l 1 20 m the decreasing rate of t m of mode 2 is larger than that of mode 1 as shown in fig 13 b and t m of mode 2 is smaller that of mode 1 for the same k for l 1 20 m which means that mode 2 is prone to occur for l 1 5 m as shown in fig 13 a the decreasing rate of t m of mode 1 is larger than that of mode 2 for k k d t m of mode 2 is smaller than that of mode 1 which means that mode 2 is prone to occur however for k k d t m of mode 1 is smaller than that of mode 2 which means that mode 1 is prone to occur so we conclude that mode 1 can only be triggered with smaller l 1 when dual dbss are employed as the buckle initiation technique 3 5 2 influence of dbs on w m and σ m the influence of the spacing between dual dbss l 1 on w m and σ m with different l b and k is illustrated in fig 14 and fig 15 respectively from fig 14 a and fig 15 a w m of mode 1 decreases with increasing l 1 while w m of mode 2 increases firstly and then decreases with increasing l 1 and the influence of l b and k on w m of mode 1 becomes smaller for larger l 1 for each case showed in fig 14 a and fig 15 a w m of mode 1 is much larger than that of mode 2 from fig 14 b and fig 15 b σ m of mode 1 decreases firstly and then increases with increasing l 1 and σ m of mode 2 increases firstly then decreases and then increases again with increasing l 1 a local minimum value of σ m locates at about l 1 15 m for mode 1 and at about l 1 40 m for mode 2 σ m of mode 1 is larger than that of mode 2 almost for all the cases as shown in fig 14 b and fig 15 b except that l 1 is from 5 m to 15 m for k 0 1 and k 0 2 so we conclude that for most cases mode 1 is more dangerous than mode 2 the influence of l b on w m and σ m with different l 1 and k is illustrated in fig 16 and fig 17 respectively from fig 16 a and fig 17 a w m of both mode 1 and mode 2 increases with increasing l b for each case for each case showed in fig 16 a and fig 17 a w m of mode 1 is much larger than that of mode 2 from fig 16 b and fig 17 b σ m of mode 1 decreases in a fast rate firstly and then increases slightly with increasing l b for mode 2 σ m increases firstly and then decreases with increasing l b in fig 16 b σ m of mode 1 is larger than that of mode 2 for all the cases in fig 17 b taking k 0 1 as an example for l b 15 m or l b 65 m σ m of mode 1 is larger than that of mode 2 while for 15 m l b 65 m σ m of mode 1 is smaller than that of mode 2 it seems that only for small k σ m of mode 1 can be smaller than that of mode 2 so a detailed analysis about the influence of k is presented later the influence of k on w m and σ m with different l 1 and l b is illustrated in fig 18 and fig 19 respectively from fig 18 a and fig 19 a w m of both mode 1 and mode 2 increases with decreasing k for each case and w m of mode 1 is much larger than that of mode 2 from fig 18 b and fig 19 b σ m of mode 1 decreases linearly with decreasing k for l 1 5 m in fig 18 b and l b 10 m in fig 19 b σ m of mode 2 increases linearly with decreasing k however for l 1 20 m in fig 18 b and l b 30 m in fig 19 b σ m of mode 2 decreases linearly with decreasing k and it s clear to see that the influence of k on σ m of mode 1 is much larger than that of mode 2 for relative large k σ m of mode 1 is larger than that of mode 2 but σ m of mode 1 may be smaller than that of mode 2 for relative small k therefore during the design process mode 1 can be considered as the intended buckle configuration for relative small k when the value of k is not so small mode 2 should be triggered 3 6 validation to validate the proposed mathematical models analytical solutions obtained through the formulations derived in section 2 with the parameters in table 2 which were used in the reduced scale model test in de oliveira cardoso and solano 2015 in the reduced scale model test three buckles were triggered by three distributed buoyancy sections with equal spacing of 2 l a 65 m l a is the maximum possible axial feed in length p a is the axial compressive force at the virtual anchors between two buckles the pipe section between two adjacent virtual anchor points and of length l 65 m is considered here since the axial feed in displacement is zero at these virtual anchor points thus the maximum axial feed in length l a is 32 5 m when l s is smaller than l a then all the formulae derived in section 2 can be applied when l s is larger than l a the formula for axial force should be modified due to the limit of axial feed in length in that case by axial force balance the following equation can be obtained wang et al 2017d 24 p a p f a 1 l a l b f a b l b and the length of axial expansion within 0 x l a is modified to 25 u 1 0 l a δ p x e a d x where δ p x p 0 p x the comparison between test data and analytical solution is shown in fig 20 in the reduced scale model test in de oliveira cardoso and solano 2015 only one continuous distributed buoyancy section exists within one buckle in order to compare with the test data the case of l 1 0 m is employed for the analytical solution which represents that the distance between dual discrete buoyancy sections is zero and these dual discrete buoyancy sections become a single continuous distributed buoyancy section t c shown in fig 20 is the critical temperature difference for the test results with initial imperfection in the pre buckling state i e t 0 t c the displacement amplitude for the test results is much smaller than that for analytical solution the reason is that the mathematical model proposed in this study is based on the assumption of ideal straight pipeline while initial imperfection is introduced in the reduced scale model test at t 0 t c there is sudden increase in the displacement amplitude for the test results in the post buckling state i e t 0 t c the difference between test data and analytical solution becomes smaller with increasing temperature difference 4 conclusions analytical solutions of symmetric lateral buckling triggered by dual distributed buoyancy sections dual dbss were derived the comparison between analytical solution and test data was presented to validate the proposed mathematical model the influence of the dual dbss on the buckled configurations and the post buckling behaviour was discussed and comparisons between symmetric and antisymmetric buckling mode triggered by the same dual dbss were presented and discussed from our parametric analysis the following conclusions are drawn i from the typical post buckling behaviour analysis both the displacement amplitude and the maximum stress increase while the axial force decreases with increasing temperature difference along the stable branch the method to determine whether the results belong to case 1 or case 2 is presented ii the maximum stress decreases firstly and then increases with increasing spacing between dual dbss so an appropriate value of spacing between dual dbss should be selected the maximum stress decreases in a fast rate for case 1 and increases slightly for case 2 with increasing length of the dbs all the length of the dbs should be within the region of the buckled section since the increased section of the buoyancy section beyond the buckled section is of no effect to reduce the maximum stress in the buckled pipeline the last method to reduce the maximum stress of the buckled pipeline is to decrease the submerged weight of the dbs iii when dual dbss are employed as the buckle initiation technique symmetric buckling mode is prone to be triggered for smaller spacing between dual dbss while antisymmetric buckling mode tends to occur for larger spacing between dual dbss iv the displacement amplitude of symmetric buckling mode is much larger than that of antisymmetric buckling mode under the same conditions the maximum stress of symmetric buckling mode is larger than that of antisymmetric buckling mode except that the weight ratio coefficient is small enough v when dual dbss are utilised as the buckle initiation technique both the symmetric and antisymmetric buckling mode can occur therefore during the design process it s better to check the maximum stress of both symmetric and antisymmetric buckling mode author statement zhenkui wang developed the theory and performed the computations data analysis and interpretation drafting the article yougang tang critical revision of the article declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was funded by the international postdoctoral fellowship program from the china postdoctoral council no 20180049 appendix a eq a 1 a 1 sec λ l 3 f 1 f b cos λ l 1 l 3 cos λ l 2 l 3 f 1 e i λ 4 eq a 2 a 2 0 eq a 3 a 3 0 eq a 4 a 4 λ 2 f 1 l 1 2 2 l 1 l 3 l 2 l 3 2 f b l 1 l 2 l 1 l 2 2 l 3 2 f 1 2 e i λ 4 eq a 5 a 5 f 1 f b tan λ l 3 sin λ l 1 sin λ l 2 f 1 f b cos λ l 2 f 1 sec λ l 3 e i λ 4 eq a 6 a 6 f 1 f b sin λ l 1 e i λ 4 eq a 7 a 7 l 1 f b f 1 e i λ 2 eq a 8 a 8 λ 2 2 l 3 f 1 f b l 1 l 2 l 2 2 f 1 f b f 1 l 3 2 2 f b 2 e i λ 4 eq a 9 a 9 f 1 f b tan λ l 3 sin λ l 1 sin λ l 2 f 1 sec λ l 3 e i λ 4 eq a 10 a 10 f 1 f b sin λ l 1 sin λ l 2 e i λ 4 eq a 11 a 11 f 1 f b l 1 l 2 e i λ 2 eq a 12 a 12 λ 2 l 3 2 f 1 f b l 1 l 2 f 1 l 3 2 f 1 2 e i λ 4 eq a 13 b 1 sec λ l 3 f 1 f b cos λ l 1 l 3 f b e i λ 4 eq a 14 b 2 0 eq a 15 b 3 0 eq a 16 b 4 λ 2 f b l 1 l 3 2 f 1 l 1 l 1 2 l 3 2 f 1 2 e i λ 4 eq a 17 b 5 f b f 1 sin λ l 1 tan λ l 3 f b sec λ l 3 e i λ 4 eq a 18 b 6 f 1 f b sin λ l 1 e i λ 4 eq a 19 b 7 l 1 f b f 1 e i λ 2 eq a 20 b 8 λ 2 l 3 2 f 1 l 1 f b l 3 2 l 1 2 f b 2 e i λ 4 
21511,a nonparametric identification method based on ν nu support vector regression ν svr is proposed to establish robust models of ship maneuvering motion in an easy to operate way assisted by the kernel trick the nonlinear model learns implicitly in high dimensional feature space without a priori model structure the ν svr controls the sparsity automatically resulting in high efficiency to improve the practicality a parameter tuning scheme combining the hold out validation and the simulation of dynamic processes is designed to avoid overfitting taking the kvlcc2 ship as the study object the experimental data from the simman database are used to evaluate the method the selection and pre processing of training data are discussed the identified model shows good generalization performance in the prediction of multiple maneuvers not involved in the training set verifying the effectiveness of the method keywords nonparametric modeling support vector regression system identification ship dynamics kernel method 1 introduction with the development of autonomous ship technology the modeling technique for ship maneuvering motion has attracted wide attention a reliable mathematical model has a highly practical value for providing accurate motion predictions or designing a control system due to the change in the ship s operating conditions such as payload and water depth the dynamic characteristic of a ship is not set in stone therefore it is desirable to develop a modeling method to establish or update the models in an easy to operate way system identification as a method for modeling provides a possible solution for the problem of ship maneuverability this method builds the dynamic models based on the measured data of free running model tests or full scale trials compared with other modeling methods such as captive model tests or computational fluid dynamics cfd the system identification method has the advantages of high efficiency and low cost it is considered as the only viable method for online modeling in addition the data driven feature makes it available for both ship model and full scale ship to conduct the system identification for ship maneuvering motions a straightforward approach is to assume a parametric model the hydrodynamic forces and moments are expressed as a taylor expansion of the state variables or as a modular model yoon and rhee 2003 sutulo and guedes soares 2014 luo et al 2016 xu et al 2018 in this way the identification problem is converted to a multiple linear regression problem that can be solved by many standard regression techniques least square holzhuter 1989 extended kalman filter abkowitz 1980 ridge regression yoon and rhee 2003 support vector regression luo and zou 2009 to name but a few in order to establish a proper dynamic model a key point is to select an appropriate model structure nevertheless there has been no authoritative or unified method to determine the model structure sutulo and guedes soares 2011 it is a trade off between model capability and complexity which often need to be iteratively adjusted according to the quality of the prediction or the experience of the modeler moreover different types of ships often correspond to different model structures and changes in operating conditions may also cause the original model structure no longer applicable therefore determining the model structure is always a challenging problem in practical application for parametric modeling an alternative approach is nonparametric modeling also known as black box modeling or surrogate modeling the basic idea is to optimize the model structure according to the training data without any physical insight the only prior knowledge is the input and output datasets of the system this property makes the system identification flexible and easy to implement for all its advantages nonparametric modeling technique is something of a double edged sword compared with parametric modeling nonparametric modeling is more sensitive to the training data the noise and outliers can affect the selection of the optimal model structure resulting in overfitting or underfitting thus there are more stringent requirements to the selection of the training data and the setting of the identification algorithms machine learning techniques provide an effective way for nonparametric modeling of dynamic systems rather than postulating the candidate models in a finite dimensional space machine learning techniques conduct the function approximation possibly in an infinite dimensional feature space pillonetto et al 2014 neural network algorithms have been studied for the system identification of ship maneuvering motions such as recursive neural networks moreira and guedes soares 2003a moreira and guedes soares 2003b 2012 hess et al 2006 feed forward neural networks rajesh and bhattacharyya 2008 zhang and zou 2013 and long short term memory lstm based recurrent neural network woo et al 2018 the identified models have shown acceptable prediction accuracy nevertheless neural networks have some inherent defects such as local extrema less solid mathematical foundation and the risk of suffering the curse of dimensionality moreover since minimizing the empirical risk can make the function estimation sensitive to the training data the implementation of neural networks often runs a risk of overfitting schölkopf et al 2002 which degrades the generalization performance recently there has been a considerable interest in the so called kernel based regularization methods for system identification ljung et al 2020 such as kernel ridge regression krr gaussian processes gp and support vector regression svr the basic idea is to map the data into a high dimensional implicit feature space by replacing the features with a kernel function assisted by the kernel trick the computational cost is not affected by the dimension of the feature space so that the curse of dimensionality can be avoided cristianini and shawe taylor 2000 furthermore regularization has the effect of reducing variance thereby improving the model generalization some studies that applied kernel methods have shown good results in the identification of marine hydrodynamics ariza et al 2018 employed multi output gp for the modeling of four degrees of freedom dof ship dynamics the training and validation were carried out by using the simulation data bai et al 2019 applied locally weighted learning to nonparametric modeling of ship maneuvering motions and proposed a modified genetic algorithm to avoid overfitting or underfitting of the model moreno salinas et al 2019 modeled ship maneuvering motion with krr and kernel ridge regression confidence machine krrcm the datasets obtained from the 20 20 zigzag tests were used as training data in moreno et al 2019 krr with a polynomial kernel and symbolic regression were applied with the experimental data taken from the random trajectories these recent studies hint that the kernel method can be effective for the nonparametric modeling of ship maneuvering motions however one disadvantage of krr and gp is the lack of sparsity which brings some problems in implementation when dealing with large datasets cristianini and shawe taylor 2000 in this paper a framework based on svr a well known kernel method is investigated for the nonparametric modeling of ship maneuvering motions the feature of svr is that it can produce sparse representations resulting in extremely high efficiency besides the optimization problems are convex due to the mercer s conditions on the kernels thus have a global optimal solution in the last decade the svr algorithm has been mainly applied in the parametric modeling of ship dynamics with a known model structure the linear kernel was generally used to estimate the hydrodynamic coefficients luo and zou 2009 first applied the least squares support vector regression lssvr to the white box modeling of ship maneuvering motions afterwards different kinds of svr including ε svr zhang and zou 2011 ν svr wang et al 2019 and the optimal truncated ls svr xu and guedes soares 2019 xu et al 2020 were studied to improve the accuracy of parameter estimation the metaheuristics methods were employed to select the parameters in lssvr luo et al 2016 zhu et al 2017 2019 xu and guedes soares 2020 as mentioned above these studies assumed a known model structure in practice however it is still a problem to determine an appropriate model structure moreover svr with a linear kernel is approximately equivalent to the least squares regression with a weight delay factor especially lssvr from this perspective the application of svr in parametric modeling does not take full advantages of kernel methods until recently few studies have focused on the nonparametric modeling of ship maneuvering motions based on svr it has only been investigated under limited conditions and has not yet been systematically evaluated based on the real data from experiments wang et al 2015 applied lssvr for black box modeling of 4 dof ship maneuvering motion but the data were generated by simulation without considering the noise disturbance luo et al 2014 employed lssvr for a catamaran with the dataset from turning circle tests and obtained the control parameters in svr by cross validation however due to the noise disturbances the implicit model can only predict the specific turning circle maneuvers some studies on the modeling of ship roll motion can be found in literature hou et al 2018 sclavounos and ma 2018 however the modeling of ship maneuvering motions is more complicated the high coupling among the multiple dof motions magnifies the inaccuracies in modeling resulting in cumulative deviations and even divergence in order to accurately extract the nonlinear dynamic characteristics from the real data it is desirable to set reasonable parameter selection strategy and data pre processing strategy an in depth research on the identification framework is still needed to ensure the nonparametric models stable and with a good generalization ability this paper presents a novel nonparametric modeling framework based on ν nu svr and conducts a comprehensive evaluation based on the experimental data the ν svr model learns nonlinear mappings in the kernel induced feature space while ensuring the sparsity of the solution through adaptive adjustment a parameter tuning strategy that considers cumulative errors by combining hold out validation and simulation of free running tests is designed to ensure the prediction ability on top of that the important issues of training data selection and pre processing are also discussed to evaluate the applicability of the method the experimental dataset of kvlcc2 from the simman database is taken for training and validation the effect of the proposed parameter tuning method is tested by comparing the results with those of the 10 fold cross validation the identified model is assessed by testing the generalization ability namely predicting multiple trajectories not included in the training data the rest of the paper is organized as follows section 2 presents the problem formulation for nonparametric modeling of ship maneuvering motions section 3 describes the mathematical basis of the ν svr discusses the selection of the kernel function and proposes a parameter tuning method for ship maneuvering modeling in section 4 a case study of kvlcc2 is carried out the ideas of training data selection and pre processing are discussed first then identification modeling and a systematic evaluation are conducted based on real data from model tests finally section 5 summarized with conclusions 2 problem formulation an accurate model of the dynamic system is crucial for planning control and many other applications nguyen tuong and peters 2011 this paper focuses on the modeling of 3 dof ship maneuvering motion i e surge motion sway motion and yaw motion in the modeling process nonlinear mapping is learned from the measured data of free running model tests which represents the relationship between the input and the state variables it can be used to predict the next state given the current state and input a continuous time invariant nonlinear state space model is selected to describe the dynamic system 1 x s t f x s t u t z t h x s t z t 1 where x s t is the state vector referring to the speed items u t is the input vector referring to the propeller thrust and steering angle f is the nonlinear mapping in matrix notation output z t represents the displacement and the heading angle which is formulated by euler s method with time step h the state equation namely the differential equations of the vehicle s speeds is given as 2 u t f 1 u t v t r t δ t v t f 2 u t v t r t δ t r t f 3 u t v t r t δ t where u v r represent the surge speed sway speed and yaw rate respectively δ represents the steering angle these three state quantities and one input quantity are used as regressors which are also the input data for system identification they can all be collected by the on board sensors the accelerations are obtained by differentiating the corresponding speeds with respect to time and used as the output data eq 2 is the regression function for the nonparametric modeling problem the regressors are selected by referring to the structure of abkowitz model abkowitz 1969 consequently the model is expected to be able to accurately predict the ship maneuvering motion around the normal speed which can meet the prediction requirements for most ship maneuvers the ν svr with radial basis function rbf kernel is used in this study to identify the mapping f in a kernel induced feature space with the help of kernel functions the model selection is reduced to the parameter tuning of ν svr because of the high coupling effects of different dofs and the noise disturbance in the real data the main challenge is how to avoid overfitting and ensure the generalization ability of the model 3 identification algorithm 3 1 the ν support vector regression algorithm the ν support vector regression ν svr algorithm can adaptively control the sparseness property based on the data structure schölkopf et al 2000 it is a modified algorithm of the ε svr the parameter ν helps to adjust the number of support vectors adaptively thereby avoiding the manual adjustment of the parameter ε this feature makes the algorithm smarter more reliable and easy to apply in practice in the modeling of ship maneuvering motion the data from free running model tests inevitably contain noise from measurement noise or environmental disturbance the ν svr algorithm is more suitable for this issue since it can ensure stability and generalization ability while taking the modeling efficiency into consideration suppose the nonlinear mapping φ from the space χ of regressors x to a possible infinite dimensional hypothesis space h is described as 3 φ χ h x x 1 x n φ x φ 1 x φ l x the nonlinear regression function f in eq 2 is expressed as the product of the unknown weight vector w and the mapped regressor φ x 4 f x w t φ x b where b is the bias conventionally there are two steps for building a nonparametric model first select a nonlinear mapping to transform the data from the input space to a feature space h and then identify the weights in the feature space the ν svr algorithm merges the two steps with the help of the kernel trick without the need to explicitly compute the mapping the optimization problem is formulated as 5 min w b ε 1 2 w 2 c ν ε 1 l i 1 l ξ i ξ i subject to 6 1 y i w t φ x i b ε ξ i 6 2 w t φ x i b y i ε ξ i 6 3 ξ i 0 ε 0 where ξ i ξ i are the slack variables also known as ε insensitive training error only the data points with residuals outside the threshold will contribute to the regression fitting the subset of these data is called support vectors svs the cost function eq 5 is based on the structural risk minimization principle vapnik 2006 the regularization constant c controls the trade off between the model complexity and the empirical risk which helps to avoid overfitting if c is too large the optimization will only minimize the empirical risk regardless of the model complexity in the cost function the parameter ν controls the width of the ε insensitive zone which adjusts ε and predetermines the relative number of training samples as support vectors to construct the kernel induced feature space the optimization problem eqs 5 and 6 are transformed into a dual representation the primal lagrange formulation is constructed as 7 l w b α β ξ ε η 1 2 w 2 c ν ε c l i 1 l ξ i ξ i β ε i 1 l η i ξ i η i ξ i i 1 l α i ξ i y i w t φ x i b ε i 1 l α i ξ i w t φ x i b y i ε where α i β η i are the lagrange multipliers the corresponding dual is deduced based on the saddle point conditions 8 l w 0 w i 1 l α i α i φ x i l b 0 i 1 l α i α i 0 l ξ i 0 c ν i 1 l α i α i β 0 l ε 0 c l α i η i 0 substituting eq 8 into eq 7 and utilizing a kernel function k x i x j φ x i t φ x j to replace the dot product of φ x the dual representation of the optimization problem is deduced as 9 min α i 1 2 i j 1 l α i α i α j α j k x i x j i 1 l α i α i y i subject to 10 1 i 1 l α i α i 0 10 2 α i 0 c l 10 3 i 1 l α i α i c ν if the kernel fulfills the mercer conditions the optimization problem is convex and hence has a global optimal solution according to eq 8 the weight vector w is a linear combination of the mapped support vectors φ x consequently the regression function eq 4 can be rewritten as follows 11 f x i 1 l α i α i k x i x j b the feature vectors are represented by the kernel function implicitly in this way the inner product can be efficiently computed in a way independent of the dimension of the feature spaces thereby avoiding the curse of dimensionality the nonlinear regression function of ship maneuvering motion corresponds to eq 11 the nonparametric modeling is transformed to the selection of the kernel function and its parameters 3 2 kernel selection there are many choices for the kernel function fulfilling the mercer conditions schölkopf et al 2002 no matter which kernel is chosen the method for selecting the support vectors does not change referring to the model structure based on physical mechanism the nonlinear mapping can correspond to the function of the hydrodynamic forces and moments expressed in taylor expansion where the inertia terms are taken as constants the rbf kernel also called gaussian kernel and the inhomogeneous polynomial kernel are good choices for this case expressed as follows 12 k x i x j exp γ x i x j 2 rbf kernel 13 k x i x j γ x i t x j r d d degree inhomogeneous polynomial kernel where γ is the width parameter and r controls the relative weightings between different degree features and the strength of the constant feature the rbf kernel can transform the data space into an infinite dimensional feature space by using the taylor expansion taking γ 1 as example the rbf kernel is expressed as 14 k x i x j exp γ x i x j 2 exp x i 2 k 0 2 k x i k x j k k exp x j 2 the width parameter γ in the rbf kernel plays an important role in controlling the model complexity and needs to be carefully tuned the polynomial kernel provides control of the complexity through three parameters i e the degree d and the parameters γ r it has an intuitive correspondence with the widely used high order polynomial of the ship kinematics nevertheless choosing a good combination of the three parameters is not an easy task in contrast the rbf kernel has only one parameter which means that it requires less tuning computation in addition the ability to extend the feature space to infinite dimensions makes it more powerful in nonlinear modeling considering the applicability of the method the rbf kernel is selected in this paper to express the nonlinear mapping 3 3 parameter tuning the nonlinear mappings from the regressor space to the output space are closely related to the selection of the parameters the tuning step helps to find the appropriate parameters for modeling and prevents overfitting the ν svr with rbf kernel has three parameters to be determined in advance namely γ c and ν a dynamic simulation based tuning strategy is proposed which mainly focuses on the selection of c and γ that have a significant effect on the model complexity the selection is conducted by a method combining the hold out validation and the simulation of free running tests at first the parameter ν is set manually considering the sample size and the level of noise this is based on the modeler s experience or the prior knowledge on the measurement noise the value of ν is in the range of 0 1 which is a lower bound on the relative number of svs the smaller the ν the fewer the support vectors and the faster the computation will be on the other hand too few support vectors may result in a low precision for approximating the original data therefore the choice of ν should be made by comprehensively considering accuracy and computing efficiency more details can refer to schölkopf et al 2000 fig 1 shows the flowchart of the tuning strategy for parameters c and γ first the search range of c and γ is decided theoretically a reasonable value of c is in the range of output values mattera and haykin 1999 however this selection is quite sensitive to the possible outliers cherkassky and ma 2004 advocated to select the value of c based on the prescription max y 3 σ y y 3 σ y where y and σ y are the mean and the standard deviation of the output values considering the uncertainties in practice this paper sets a search range of c on the basis of the empirical value y 3 σ y the search range is defined as 0 max y 5 σ y y 5 σ y since the scaling of outputs will affect the optimal value of c the variables in the training set are standardized and centralized beforehand to zero mean and unit variance the parameter γ plays an important role for the black box model complexity its value is chosen in the range of 0 1 a too large γ will cause overfitting making the model lack generalization ability and highly sensitive to the noise on the other hand if γ is too small the mapping will behave almost linearly and lose the nonlinear characteristics a hold out strategy combined with the simulation of free running tests is used to evaluate the performance of the parameters a subset of the available data is held out for the tuning purpose which means it is independent of the training set the grid search is carried out to determine parameters c and γ in limited ranges in the hold out dataset k starting points are selected given the initial values of the state variables and the steering angle at subsequent time steps the simulations of free running tests are conducted with the trained model the average root mean square errors rmses of the displacement are applied for judging the accuracy of the model the number of starting points k can be selected with reference to the size of the hold out data and the expected computation time due to the iterative prediction process in the simulation of free running tests there will be a cumulative deviation different from the one step prediction the selection of multiple starting points in the hold out dataset and the selection of displacements as evaluation quantities are intended to amplify the weight of the cumulative deviation so as to better search for the minimum generalization error 4 modeling of ship maneuvering motion with experimental data to evaluate the proposed identification method nonparametric modeling is performed for a kvlcc2 tanker the experimental dataset from simman workshop is used in the following the selection and pre processing of training data are introduced first then a 3 dof maneuvering model is established the parameter tuning results are compared with those by the widely used cross validation strategy 4 1 selection and pre processing of training data nonparametric modeling requires almost no prior information neither the model structure nor the inertia constants the content of training data determines which dynamic characteristics are excited and the information provided allows the identification of a reliable model for a nonlinear dynamic system a high quality excitation signal of training data should cover the range of the input space and relevant frequencies to include more dynamic information the datasets of 10 5 and 30 5 zigzag tests are selected as the training set which are from the model tests carried out by the hamburg ship model basin hsva besides the dataset of 20 5 zigzag test from hsva is selected as the hold out set for tuning parameters in other words around 70 of the data is used for training and 30 of the data is used as a hold out set the hold out set contains different dynamic characteristics from the training set this makes the prediction of the hold out data represent the generalization performance to some extent with this setting the data almost cover the input space of the steering angle as the authors previous paper wang et al 2019 indicated this setting allows more nonlinear dynamics to be excited hence makes the identified model robust and stable if possible it is also recommended to select the training data based on m level pseudo random sequence by experimental design wang et al 2020 the data from model tests have been filtered by a low pass filter to further reduce the fluctuation of the acceleration values the data are preprocessed by the cubic smoothing spline and linear interpolation with a time step of 0 15s as an example fig 2 shows the smoothing results of the 10 5 zigzag test the acceleration trends are much clearer after pre processing which contributes to extracting the dynamic characteristics to avoid that the characteristics of larger range of values dominate the characteristics of smaller range of values the input and output variables are standardized and centralized each characteristic is scaled to zero mean and unit variance expressed as 15 y i y i y σ y where y i is the original variable and y i is the scaled variable y is the mean value of the variable and σ y is the variance of the variable y 4 2 modeling by kernel based ν svr the rbf kernel based ν svr is used for modeling based on the preprocessed data considering the computational efficiency and long term prediction requirements the parameter ν is set as 0 5 which is also a robust compromise solution in practice mattera and haykin 1999 on this basis the value of ν can be adjusted as needed for higher training speed or better accuracy of approximation then the parameters c and γ are selected by the proposed dynamic simulation based tuning method to evaluate the tuning results a comparative study is conducted between the proposed tuning method and the 10 fold cross validation strategy the k fold cross validation is a widely used tuning strategy in machine learning field it randomly divides the available data into k subsets at each stage one subset remains for validation while the other k 1 subsets are used for training the procedure is repeated k times each time a different subset is treated as the validation set eventually the average mean squared error measures the prediction capability of the model the main difference from the proposed method is that the k fold cross validation considers only one step prediction error and does not consider the cumulative bias in the prediction of ship maneuvering motion figs 3 5 illustrate the results of parameter tuning using the two methods it is shown that there is a large difference in the tuning results by the two methods theoretically the value of γ can be used to evaluate overfitting since larger γ corresponds to more complex models the 10 fold cross validation tends to choose the largest γ that is γ 1 this phenomenon implies overfitting which will make the model lack generalization ability and highly sensitive to the noise on the other hand the proposed tuning method suggests the more reasonable solutions with relatively small value of γ although the proposed method requires more computational time due to the simulation of free running tests approximately 1 5 times that of cross validation the comparison of tuning results indicates that the proposed tuning method is more suitable for the modeling of ship maneuvering motion than the widely used cross validation the results of parameter tuning illustrate that the kernel parameter γ has a significant impact on the tuning results by contrast the regularization parameter c is to adjust the generalization performance based on the selected kernel function there may be several groups of c and γ with an acceptable rmse value the model complexity corresponding to the parameter values combined with the modeling knowledge in the field can help the modeler to fine tune the parameters and improve the quality of the model the final decision can be made by comparing the results of motion prediction between the training set and test set if there is not much difference and the fitting is all good the set of parameters is an appropriate choice table 1 lists the final parameter settings for the case studied with the preprocessed training data and the adjusted parameters the nonparametric models for 3 dof maneuvering motions are established by the rbf kernel based ν svr according to eq 2 the modeling was implemented in rstudio which is an integrated development environment for the r programming language it took less than 5s using an intel core i7 6820hq cpu with 3 3 ghz 4 3 validation of the generalization ability the generalization performance of the identified model is mainly evaluated by predicting the maneuvers not involved in the training data the validation set includes 10 10 20 20 15 5 20 10 25 5 35 5 zigzag tests and 35 turning circle test the datasets from model tests conducted by hsva and maritime research institute netherlands marin are used for comparison these data were collected from the free running tests of the kvlcc2 model which was at a starting speed of 1 18 m s in deep and calm water giving the initial ship s speeds prediction of ship maneuvering motion is performed by using the identified model to simulate the free running tests the rudder steering rate is 15 68 s on the model scale corresponding to 2 32 s on the full scale overall the results presented below show that good long term predictions can be achieved for all maneuvers indicating that the identified nonlinear model can well represent the dynamic characteristics of the ship the prediction accuracy of the speeds evaluated by rmse is given in table 2 and table 3 as can be seen the prediction accuracy of these maneuvering motions is balanced there is no situation where the prediction of the training set is significantly more accurate than that of the validation set this result implies that the model is generalized well and there is no significant overfitting fig 6 shows the prediction results of heading angle and speeds for 20 20 10 10 and 15 5 zigzag tests similar prediction results are obtained for other zigzag maneuvers as can be seen high accuracy is achieved in all motion predictions of zigzag maneuvers the cumulative deviation is small indicating that the model of each dof motion has high accuracy as a representative example fig 7 illustrates the prediction of accelerations in 20 20 zigzag test the outputs of the nonlinear regression model fit well and there is no sign of overfitting fig 8 shows the prediction results of 35 turning circle maneuver the long term trajectory of the turning circle fits well but there is a deviation in the predicted speed especially in surge motion from the acceleration fitting results in fig 9 the surge accelerations are close to but not zero during the steady turning motion and this small deviation in acceleration amplifies the bias in speeds and displacements as the prediction time increase this implies that the model does not learn sufficiently about the dynamics of steady state motion one main reason could be the difference between the flow fields in the training data and the validation data from a hydrodynamic point of view the 35 turning circle maneuver is a large drift angle motion resulting in a large lateral hydrodynamic force on the hull when the steady state motion is reached the frictional resistance and pressure resistance have changed considerably which reduces the surge velocity in contrast the 10 5 and 30 5 zigzag tests have a high steering frequency and a relatively small drift angle they have stronger unsteady characteristics than the turning circle maneuvers this result reveals that a high quality excitation signal should not only cover the range of the input space but also the relevant frequencies nevertheless the changing trends of accelerations are correct and the performance of trajectory prediction is acceptable tables 4 and 5 present the comparison results with other modeling methods including captive model tests pmm cmt rans computation and the empirical one with modular model of cross flow drag based on slender body theory the relevant data for comparison are taken from simman 2008 workshop the results indicate that the proposed identification method is sufficiently accurate it should be noted that in this case the training data are extracted from the hsva s model tests while the comparison data for validation contains the results from the marin s model tests in fact bias may exist in the experimental results from different institutions because of the differences in test sites and ship models therefore this might also be one of the reasons for the discrepancies in these predictions it can be found that the selection of the sampling interval is a trade off between the model capability and computational cost a larger sampling interval means fewer data points and lower computational cost but at the same time the cumulative deviation may be larger when predicting the maneuvers with high steering frequency assisted by the kernel trick and the sparsity of ν svr the proposed method of nonparametric modeling has high efficiency in the case studied the sampling interval is set to 0 15 s resulting in a modeling time fewer than 5 s and obtaining a model with great generalization ability when the sampling interval is set to 0 4 s the modeling time will be less than 1 s which can satisfy the requirement of online modeling this fast built model has similar accuracy for the predictions of 20 20 and 10 10 zigzag maneuvers compared with the model in the case studied but for the prediction of 30 5 and 35 5 zigzag maneuvers the fast built model has a larger cumulative deviation therefore the selection of sampling intervals is mainly based on modeling purposes if high precision long term trajectory prediction is desired relatively small sampling intervals should be chosen while for quick and short term predictions large sampling intervals should be chosen to improve the modeling and prediction efficiency in summary the results demonstrate that the rbf kernel based ν svr has a powerful capability for nonlinear modeling and the identified model has a good generalization performance the key issue is to find the right kernel parameters with the proposed parameter tuning scheme the kernel parameter corresponding to the minimum generalization error is found afterwards the nonlinear mapping can be learned appropriately the training data also play an important role for parameter tuning and generalization ability since the prior knowledge of nonparametric modeling is limited the modeling process will face great uncertainty and the risk of overfitting when the identified model is expected to be used for predictions in an extrapolation way such as training with the data of 20 20 zigzag maneuver while predicting 10 10 zigzag maneuver or 35 turning circle maneuver in this situation the difficulty of adjusting parameters also increases when the stability of the model is threatened the applicability of the system identification method is reduced by contrast if the training data cover the input space and relevant steering frequency as much as possible identification is approximately performed as an interpolation processing with respect to the steering angle input in this way the modeling uncertainty and risk of overfitting can be effectively reduced hence improving the practicality through the analysis of experimental data the generalization validation demonstrates that the data pre processing and the parameter tuning strategy are effective a robust model is established in an efficient and practical way 5 conclusions a system identification method based on ν svr is proposed for modeling of ship maneuvering motion taking the kvlcc2 tanker as the study object the modeling method is systematically evaluated based on the real data from model tests from the case study the following advantages and features of the modeling method can be summarized firstly the kernel function makes prior information on the model structure unnecessary avoids the curse of dimensionality and provides powerful nonlinear modeling capability secondly ν svr automatically adjusts the amount of support vectors to ensure sparsity thus achieving high computation efficiency this feature also enhances the applicability as it reduces the difficulty of parameter tuning and makes the method robust to the varying noise level thirdly the principle of structural risk minimization allows a balance between approximation accuracy and model complexity which helps to avoid overfitting finally the proposed dynamic simulation based tuning method gives prominence to the evaluation of generalization error and cumulative deviation thereby ensuring the quality of the model by selecting appropriate parameters by comparing with the widely used 10 fold cross validation the proposed method of parameter tuning is proven to be more suitable for the modeling of ship maneuvering motion the prediction results of multiple maneuvers validate the effectiveness and robustness of the identified model the kernel based ν svr method has good migration and adaptation ability because of its less dependence on prior information fast computation and low cost it can be applied to other types of marine vehicles or other ship dynamics to establish the dynamic models in an easy to implement way this can also provide supports to the model based planning or control system design thus to improve the autonomous ship technique in the future study the effects of factors such as the configuration of training data and the selection of regressors on nonparametric modeling will be studied to further improve the quality of the identified model credit author statement zihao wang conceptualization methodology simulation analysis visualization writing original draft haitong xu methodology simulation analysis writing original draft li xia methodology data processing analysis writing original draft zaojian zou methodology supervision writing review and editing funding acquisition project administration c guedes soares methodology supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work is financially supported by the national natural science foundations of china grant number 51979165 the authors are grateful to the hamburg ship model basin hsva and maritime research institute netherlands marin for providing the experimental data 
21511,a nonparametric identification method based on ν nu support vector regression ν svr is proposed to establish robust models of ship maneuvering motion in an easy to operate way assisted by the kernel trick the nonlinear model learns implicitly in high dimensional feature space without a priori model structure the ν svr controls the sparsity automatically resulting in high efficiency to improve the practicality a parameter tuning scheme combining the hold out validation and the simulation of dynamic processes is designed to avoid overfitting taking the kvlcc2 ship as the study object the experimental data from the simman database are used to evaluate the method the selection and pre processing of training data are discussed the identified model shows good generalization performance in the prediction of multiple maneuvers not involved in the training set verifying the effectiveness of the method keywords nonparametric modeling support vector regression system identification ship dynamics kernel method 1 introduction with the development of autonomous ship technology the modeling technique for ship maneuvering motion has attracted wide attention a reliable mathematical model has a highly practical value for providing accurate motion predictions or designing a control system due to the change in the ship s operating conditions such as payload and water depth the dynamic characteristic of a ship is not set in stone therefore it is desirable to develop a modeling method to establish or update the models in an easy to operate way system identification as a method for modeling provides a possible solution for the problem of ship maneuverability this method builds the dynamic models based on the measured data of free running model tests or full scale trials compared with other modeling methods such as captive model tests or computational fluid dynamics cfd the system identification method has the advantages of high efficiency and low cost it is considered as the only viable method for online modeling in addition the data driven feature makes it available for both ship model and full scale ship to conduct the system identification for ship maneuvering motions a straightforward approach is to assume a parametric model the hydrodynamic forces and moments are expressed as a taylor expansion of the state variables or as a modular model yoon and rhee 2003 sutulo and guedes soares 2014 luo et al 2016 xu et al 2018 in this way the identification problem is converted to a multiple linear regression problem that can be solved by many standard regression techniques least square holzhuter 1989 extended kalman filter abkowitz 1980 ridge regression yoon and rhee 2003 support vector regression luo and zou 2009 to name but a few in order to establish a proper dynamic model a key point is to select an appropriate model structure nevertheless there has been no authoritative or unified method to determine the model structure sutulo and guedes soares 2011 it is a trade off between model capability and complexity which often need to be iteratively adjusted according to the quality of the prediction or the experience of the modeler moreover different types of ships often correspond to different model structures and changes in operating conditions may also cause the original model structure no longer applicable therefore determining the model structure is always a challenging problem in practical application for parametric modeling an alternative approach is nonparametric modeling also known as black box modeling or surrogate modeling the basic idea is to optimize the model structure according to the training data without any physical insight the only prior knowledge is the input and output datasets of the system this property makes the system identification flexible and easy to implement for all its advantages nonparametric modeling technique is something of a double edged sword compared with parametric modeling nonparametric modeling is more sensitive to the training data the noise and outliers can affect the selection of the optimal model structure resulting in overfitting or underfitting thus there are more stringent requirements to the selection of the training data and the setting of the identification algorithms machine learning techniques provide an effective way for nonparametric modeling of dynamic systems rather than postulating the candidate models in a finite dimensional space machine learning techniques conduct the function approximation possibly in an infinite dimensional feature space pillonetto et al 2014 neural network algorithms have been studied for the system identification of ship maneuvering motions such as recursive neural networks moreira and guedes soares 2003a moreira and guedes soares 2003b 2012 hess et al 2006 feed forward neural networks rajesh and bhattacharyya 2008 zhang and zou 2013 and long short term memory lstm based recurrent neural network woo et al 2018 the identified models have shown acceptable prediction accuracy nevertheless neural networks have some inherent defects such as local extrema less solid mathematical foundation and the risk of suffering the curse of dimensionality moreover since minimizing the empirical risk can make the function estimation sensitive to the training data the implementation of neural networks often runs a risk of overfitting schölkopf et al 2002 which degrades the generalization performance recently there has been a considerable interest in the so called kernel based regularization methods for system identification ljung et al 2020 such as kernel ridge regression krr gaussian processes gp and support vector regression svr the basic idea is to map the data into a high dimensional implicit feature space by replacing the features with a kernel function assisted by the kernel trick the computational cost is not affected by the dimension of the feature space so that the curse of dimensionality can be avoided cristianini and shawe taylor 2000 furthermore regularization has the effect of reducing variance thereby improving the model generalization some studies that applied kernel methods have shown good results in the identification of marine hydrodynamics ariza et al 2018 employed multi output gp for the modeling of four degrees of freedom dof ship dynamics the training and validation were carried out by using the simulation data bai et al 2019 applied locally weighted learning to nonparametric modeling of ship maneuvering motions and proposed a modified genetic algorithm to avoid overfitting or underfitting of the model moreno salinas et al 2019 modeled ship maneuvering motion with krr and kernel ridge regression confidence machine krrcm the datasets obtained from the 20 20 zigzag tests were used as training data in moreno et al 2019 krr with a polynomial kernel and symbolic regression were applied with the experimental data taken from the random trajectories these recent studies hint that the kernel method can be effective for the nonparametric modeling of ship maneuvering motions however one disadvantage of krr and gp is the lack of sparsity which brings some problems in implementation when dealing with large datasets cristianini and shawe taylor 2000 in this paper a framework based on svr a well known kernel method is investigated for the nonparametric modeling of ship maneuvering motions the feature of svr is that it can produce sparse representations resulting in extremely high efficiency besides the optimization problems are convex due to the mercer s conditions on the kernels thus have a global optimal solution in the last decade the svr algorithm has been mainly applied in the parametric modeling of ship dynamics with a known model structure the linear kernel was generally used to estimate the hydrodynamic coefficients luo and zou 2009 first applied the least squares support vector regression lssvr to the white box modeling of ship maneuvering motions afterwards different kinds of svr including ε svr zhang and zou 2011 ν svr wang et al 2019 and the optimal truncated ls svr xu and guedes soares 2019 xu et al 2020 were studied to improve the accuracy of parameter estimation the metaheuristics methods were employed to select the parameters in lssvr luo et al 2016 zhu et al 2017 2019 xu and guedes soares 2020 as mentioned above these studies assumed a known model structure in practice however it is still a problem to determine an appropriate model structure moreover svr with a linear kernel is approximately equivalent to the least squares regression with a weight delay factor especially lssvr from this perspective the application of svr in parametric modeling does not take full advantages of kernel methods until recently few studies have focused on the nonparametric modeling of ship maneuvering motions based on svr it has only been investigated under limited conditions and has not yet been systematically evaluated based on the real data from experiments wang et al 2015 applied lssvr for black box modeling of 4 dof ship maneuvering motion but the data were generated by simulation without considering the noise disturbance luo et al 2014 employed lssvr for a catamaran with the dataset from turning circle tests and obtained the control parameters in svr by cross validation however due to the noise disturbances the implicit model can only predict the specific turning circle maneuvers some studies on the modeling of ship roll motion can be found in literature hou et al 2018 sclavounos and ma 2018 however the modeling of ship maneuvering motions is more complicated the high coupling among the multiple dof motions magnifies the inaccuracies in modeling resulting in cumulative deviations and even divergence in order to accurately extract the nonlinear dynamic characteristics from the real data it is desirable to set reasonable parameter selection strategy and data pre processing strategy an in depth research on the identification framework is still needed to ensure the nonparametric models stable and with a good generalization ability this paper presents a novel nonparametric modeling framework based on ν nu svr and conducts a comprehensive evaluation based on the experimental data the ν svr model learns nonlinear mappings in the kernel induced feature space while ensuring the sparsity of the solution through adaptive adjustment a parameter tuning strategy that considers cumulative errors by combining hold out validation and simulation of free running tests is designed to ensure the prediction ability on top of that the important issues of training data selection and pre processing are also discussed to evaluate the applicability of the method the experimental dataset of kvlcc2 from the simman database is taken for training and validation the effect of the proposed parameter tuning method is tested by comparing the results with those of the 10 fold cross validation the identified model is assessed by testing the generalization ability namely predicting multiple trajectories not included in the training data the rest of the paper is organized as follows section 2 presents the problem formulation for nonparametric modeling of ship maneuvering motions section 3 describes the mathematical basis of the ν svr discusses the selection of the kernel function and proposes a parameter tuning method for ship maneuvering modeling in section 4 a case study of kvlcc2 is carried out the ideas of training data selection and pre processing are discussed first then identification modeling and a systematic evaluation are conducted based on real data from model tests finally section 5 summarized with conclusions 2 problem formulation an accurate model of the dynamic system is crucial for planning control and many other applications nguyen tuong and peters 2011 this paper focuses on the modeling of 3 dof ship maneuvering motion i e surge motion sway motion and yaw motion in the modeling process nonlinear mapping is learned from the measured data of free running model tests which represents the relationship between the input and the state variables it can be used to predict the next state given the current state and input a continuous time invariant nonlinear state space model is selected to describe the dynamic system 1 x s t f x s t u t z t h x s t z t 1 where x s t is the state vector referring to the speed items u t is the input vector referring to the propeller thrust and steering angle f is the nonlinear mapping in matrix notation output z t represents the displacement and the heading angle which is formulated by euler s method with time step h the state equation namely the differential equations of the vehicle s speeds is given as 2 u t f 1 u t v t r t δ t v t f 2 u t v t r t δ t r t f 3 u t v t r t δ t where u v r represent the surge speed sway speed and yaw rate respectively δ represents the steering angle these three state quantities and one input quantity are used as regressors which are also the input data for system identification they can all be collected by the on board sensors the accelerations are obtained by differentiating the corresponding speeds with respect to time and used as the output data eq 2 is the regression function for the nonparametric modeling problem the regressors are selected by referring to the structure of abkowitz model abkowitz 1969 consequently the model is expected to be able to accurately predict the ship maneuvering motion around the normal speed which can meet the prediction requirements for most ship maneuvers the ν svr with radial basis function rbf kernel is used in this study to identify the mapping f in a kernel induced feature space with the help of kernel functions the model selection is reduced to the parameter tuning of ν svr because of the high coupling effects of different dofs and the noise disturbance in the real data the main challenge is how to avoid overfitting and ensure the generalization ability of the model 3 identification algorithm 3 1 the ν support vector regression algorithm the ν support vector regression ν svr algorithm can adaptively control the sparseness property based on the data structure schölkopf et al 2000 it is a modified algorithm of the ε svr the parameter ν helps to adjust the number of support vectors adaptively thereby avoiding the manual adjustment of the parameter ε this feature makes the algorithm smarter more reliable and easy to apply in practice in the modeling of ship maneuvering motion the data from free running model tests inevitably contain noise from measurement noise or environmental disturbance the ν svr algorithm is more suitable for this issue since it can ensure stability and generalization ability while taking the modeling efficiency into consideration suppose the nonlinear mapping φ from the space χ of regressors x to a possible infinite dimensional hypothesis space h is described as 3 φ χ h x x 1 x n φ x φ 1 x φ l x the nonlinear regression function f in eq 2 is expressed as the product of the unknown weight vector w and the mapped regressor φ x 4 f x w t φ x b where b is the bias conventionally there are two steps for building a nonparametric model first select a nonlinear mapping to transform the data from the input space to a feature space h and then identify the weights in the feature space the ν svr algorithm merges the two steps with the help of the kernel trick without the need to explicitly compute the mapping the optimization problem is formulated as 5 min w b ε 1 2 w 2 c ν ε 1 l i 1 l ξ i ξ i subject to 6 1 y i w t φ x i b ε ξ i 6 2 w t φ x i b y i ε ξ i 6 3 ξ i 0 ε 0 where ξ i ξ i are the slack variables also known as ε insensitive training error only the data points with residuals outside the threshold will contribute to the regression fitting the subset of these data is called support vectors svs the cost function eq 5 is based on the structural risk minimization principle vapnik 2006 the regularization constant c controls the trade off between the model complexity and the empirical risk which helps to avoid overfitting if c is too large the optimization will only minimize the empirical risk regardless of the model complexity in the cost function the parameter ν controls the width of the ε insensitive zone which adjusts ε and predetermines the relative number of training samples as support vectors to construct the kernel induced feature space the optimization problem eqs 5 and 6 are transformed into a dual representation the primal lagrange formulation is constructed as 7 l w b α β ξ ε η 1 2 w 2 c ν ε c l i 1 l ξ i ξ i β ε i 1 l η i ξ i η i ξ i i 1 l α i ξ i y i w t φ x i b ε i 1 l α i ξ i w t φ x i b y i ε where α i β η i are the lagrange multipliers the corresponding dual is deduced based on the saddle point conditions 8 l w 0 w i 1 l α i α i φ x i l b 0 i 1 l α i α i 0 l ξ i 0 c ν i 1 l α i α i β 0 l ε 0 c l α i η i 0 substituting eq 8 into eq 7 and utilizing a kernel function k x i x j φ x i t φ x j to replace the dot product of φ x the dual representation of the optimization problem is deduced as 9 min α i 1 2 i j 1 l α i α i α j α j k x i x j i 1 l α i α i y i subject to 10 1 i 1 l α i α i 0 10 2 α i 0 c l 10 3 i 1 l α i α i c ν if the kernel fulfills the mercer conditions the optimization problem is convex and hence has a global optimal solution according to eq 8 the weight vector w is a linear combination of the mapped support vectors φ x consequently the regression function eq 4 can be rewritten as follows 11 f x i 1 l α i α i k x i x j b the feature vectors are represented by the kernel function implicitly in this way the inner product can be efficiently computed in a way independent of the dimension of the feature spaces thereby avoiding the curse of dimensionality the nonlinear regression function of ship maneuvering motion corresponds to eq 11 the nonparametric modeling is transformed to the selection of the kernel function and its parameters 3 2 kernel selection there are many choices for the kernel function fulfilling the mercer conditions schölkopf et al 2002 no matter which kernel is chosen the method for selecting the support vectors does not change referring to the model structure based on physical mechanism the nonlinear mapping can correspond to the function of the hydrodynamic forces and moments expressed in taylor expansion where the inertia terms are taken as constants the rbf kernel also called gaussian kernel and the inhomogeneous polynomial kernel are good choices for this case expressed as follows 12 k x i x j exp γ x i x j 2 rbf kernel 13 k x i x j γ x i t x j r d d degree inhomogeneous polynomial kernel where γ is the width parameter and r controls the relative weightings between different degree features and the strength of the constant feature the rbf kernel can transform the data space into an infinite dimensional feature space by using the taylor expansion taking γ 1 as example the rbf kernel is expressed as 14 k x i x j exp γ x i x j 2 exp x i 2 k 0 2 k x i k x j k k exp x j 2 the width parameter γ in the rbf kernel plays an important role in controlling the model complexity and needs to be carefully tuned the polynomial kernel provides control of the complexity through three parameters i e the degree d and the parameters γ r it has an intuitive correspondence with the widely used high order polynomial of the ship kinematics nevertheless choosing a good combination of the three parameters is not an easy task in contrast the rbf kernel has only one parameter which means that it requires less tuning computation in addition the ability to extend the feature space to infinite dimensions makes it more powerful in nonlinear modeling considering the applicability of the method the rbf kernel is selected in this paper to express the nonlinear mapping 3 3 parameter tuning the nonlinear mappings from the regressor space to the output space are closely related to the selection of the parameters the tuning step helps to find the appropriate parameters for modeling and prevents overfitting the ν svr with rbf kernel has three parameters to be determined in advance namely γ c and ν a dynamic simulation based tuning strategy is proposed which mainly focuses on the selection of c and γ that have a significant effect on the model complexity the selection is conducted by a method combining the hold out validation and the simulation of free running tests at first the parameter ν is set manually considering the sample size and the level of noise this is based on the modeler s experience or the prior knowledge on the measurement noise the value of ν is in the range of 0 1 which is a lower bound on the relative number of svs the smaller the ν the fewer the support vectors and the faster the computation will be on the other hand too few support vectors may result in a low precision for approximating the original data therefore the choice of ν should be made by comprehensively considering accuracy and computing efficiency more details can refer to schölkopf et al 2000 fig 1 shows the flowchart of the tuning strategy for parameters c and γ first the search range of c and γ is decided theoretically a reasonable value of c is in the range of output values mattera and haykin 1999 however this selection is quite sensitive to the possible outliers cherkassky and ma 2004 advocated to select the value of c based on the prescription max y 3 σ y y 3 σ y where y and σ y are the mean and the standard deviation of the output values considering the uncertainties in practice this paper sets a search range of c on the basis of the empirical value y 3 σ y the search range is defined as 0 max y 5 σ y y 5 σ y since the scaling of outputs will affect the optimal value of c the variables in the training set are standardized and centralized beforehand to zero mean and unit variance the parameter γ plays an important role for the black box model complexity its value is chosen in the range of 0 1 a too large γ will cause overfitting making the model lack generalization ability and highly sensitive to the noise on the other hand if γ is too small the mapping will behave almost linearly and lose the nonlinear characteristics a hold out strategy combined with the simulation of free running tests is used to evaluate the performance of the parameters a subset of the available data is held out for the tuning purpose which means it is independent of the training set the grid search is carried out to determine parameters c and γ in limited ranges in the hold out dataset k starting points are selected given the initial values of the state variables and the steering angle at subsequent time steps the simulations of free running tests are conducted with the trained model the average root mean square errors rmses of the displacement are applied for judging the accuracy of the model the number of starting points k can be selected with reference to the size of the hold out data and the expected computation time due to the iterative prediction process in the simulation of free running tests there will be a cumulative deviation different from the one step prediction the selection of multiple starting points in the hold out dataset and the selection of displacements as evaluation quantities are intended to amplify the weight of the cumulative deviation so as to better search for the minimum generalization error 4 modeling of ship maneuvering motion with experimental data to evaluate the proposed identification method nonparametric modeling is performed for a kvlcc2 tanker the experimental dataset from simman workshop is used in the following the selection and pre processing of training data are introduced first then a 3 dof maneuvering model is established the parameter tuning results are compared with those by the widely used cross validation strategy 4 1 selection and pre processing of training data nonparametric modeling requires almost no prior information neither the model structure nor the inertia constants the content of training data determines which dynamic characteristics are excited and the information provided allows the identification of a reliable model for a nonlinear dynamic system a high quality excitation signal of training data should cover the range of the input space and relevant frequencies to include more dynamic information the datasets of 10 5 and 30 5 zigzag tests are selected as the training set which are from the model tests carried out by the hamburg ship model basin hsva besides the dataset of 20 5 zigzag test from hsva is selected as the hold out set for tuning parameters in other words around 70 of the data is used for training and 30 of the data is used as a hold out set the hold out set contains different dynamic characteristics from the training set this makes the prediction of the hold out data represent the generalization performance to some extent with this setting the data almost cover the input space of the steering angle as the authors previous paper wang et al 2019 indicated this setting allows more nonlinear dynamics to be excited hence makes the identified model robust and stable if possible it is also recommended to select the training data based on m level pseudo random sequence by experimental design wang et al 2020 the data from model tests have been filtered by a low pass filter to further reduce the fluctuation of the acceleration values the data are preprocessed by the cubic smoothing spline and linear interpolation with a time step of 0 15s as an example fig 2 shows the smoothing results of the 10 5 zigzag test the acceleration trends are much clearer after pre processing which contributes to extracting the dynamic characteristics to avoid that the characteristics of larger range of values dominate the characteristics of smaller range of values the input and output variables are standardized and centralized each characteristic is scaled to zero mean and unit variance expressed as 15 y i y i y σ y where y i is the original variable and y i is the scaled variable y is the mean value of the variable and σ y is the variance of the variable y 4 2 modeling by kernel based ν svr the rbf kernel based ν svr is used for modeling based on the preprocessed data considering the computational efficiency and long term prediction requirements the parameter ν is set as 0 5 which is also a robust compromise solution in practice mattera and haykin 1999 on this basis the value of ν can be adjusted as needed for higher training speed or better accuracy of approximation then the parameters c and γ are selected by the proposed dynamic simulation based tuning method to evaluate the tuning results a comparative study is conducted between the proposed tuning method and the 10 fold cross validation strategy the k fold cross validation is a widely used tuning strategy in machine learning field it randomly divides the available data into k subsets at each stage one subset remains for validation while the other k 1 subsets are used for training the procedure is repeated k times each time a different subset is treated as the validation set eventually the average mean squared error measures the prediction capability of the model the main difference from the proposed method is that the k fold cross validation considers only one step prediction error and does not consider the cumulative bias in the prediction of ship maneuvering motion figs 3 5 illustrate the results of parameter tuning using the two methods it is shown that there is a large difference in the tuning results by the two methods theoretically the value of γ can be used to evaluate overfitting since larger γ corresponds to more complex models the 10 fold cross validation tends to choose the largest γ that is γ 1 this phenomenon implies overfitting which will make the model lack generalization ability and highly sensitive to the noise on the other hand the proposed tuning method suggests the more reasonable solutions with relatively small value of γ although the proposed method requires more computational time due to the simulation of free running tests approximately 1 5 times that of cross validation the comparison of tuning results indicates that the proposed tuning method is more suitable for the modeling of ship maneuvering motion than the widely used cross validation the results of parameter tuning illustrate that the kernel parameter γ has a significant impact on the tuning results by contrast the regularization parameter c is to adjust the generalization performance based on the selected kernel function there may be several groups of c and γ with an acceptable rmse value the model complexity corresponding to the parameter values combined with the modeling knowledge in the field can help the modeler to fine tune the parameters and improve the quality of the model the final decision can be made by comparing the results of motion prediction between the training set and test set if there is not much difference and the fitting is all good the set of parameters is an appropriate choice table 1 lists the final parameter settings for the case studied with the preprocessed training data and the adjusted parameters the nonparametric models for 3 dof maneuvering motions are established by the rbf kernel based ν svr according to eq 2 the modeling was implemented in rstudio which is an integrated development environment for the r programming language it took less than 5s using an intel core i7 6820hq cpu with 3 3 ghz 4 3 validation of the generalization ability the generalization performance of the identified model is mainly evaluated by predicting the maneuvers not involved in the training data the validation set includes 10 10 20 20 15 5 20 10 25 5 35 5 zigzag tests and 35 turning circle test the datasets from model tests conducted by hsva and maritime research institute netherlands marin are used for comparison these data were collected from the free running tests of the kvlcc2 model which was at a starting speed of 1 18 m s in deep and calm water giving the initial ship s speeds prediction of ship maneuvering motion is performed by using the identified model to simulate the free running tests the rudder steering rate is 15 68 s on the model scale corresponding to 2 32 s on the full scale overall the results presented below show that good long term predictions can be achieved for all maneuvers indicating that the identified nonlinear model can well represent the dynamic characteristics of the ship the prediction accuracy of the speeds evaluated by rmse is given in table 2 and table 3 as can be seen the prediction accuracy of these maneuvering motions is balanced there is no situation where the prediction of the training set is significantly more accurate than that of the validation set this result implies that the model is generalized well and there is no significant overfitting fig 6 shows the prediction results of heading angle and speeds for 20 20 10 10 and 15 5 zigzag tests similar prediction results are obtained for other zigzag maneuvers as can be seen high accuracy is achieved in all motion predictions of zigzag maneuvers the cumulative deviation is small indicating that the model of each dof motion has high accuracy as a representative example fig 7 illustrates the prediction of accelerations in 20 20 zigzag test the outputs of the nonlinear regression model fit well and there is no sign of overfitting fig 8 shows the prediction results of 35 turning circle maneuver the long term trajectory of the turning circle fits well but there is a deviation in the predicted speed especially in surge motion from the acceleration fitting results in fig 9 the surge accelerations are close to but not zero during the steady turning motion and this small deviation in acceleration amplifies the bias in speeds and displacements as the prediction time increase this implies that the model does not learn sufficiently about the dynamics of steady state motion one main reason could be the difference between the flow fields in the training data and the validation data from a hydrodynamic point of view the 35 turning circle maneuver is a large drift angle motion resulting in a large lateral hydrodynamic force on the hull when the steady state motion is reached the frictional resistance and pressure resistance have changed considerably which reduces the surge velocity in contrast the 10 5 and 30 5 zigzag tests have a high steering frequency and a relatively small drift angle they have stronger unsteady characteristics than the turning circle maneuvers this result reveals that a high quality excitation signal should not only cover the range of the input space but also the relevant frequencies nevertheless the changing trends of accelerations are correct and the performance of trajectory prediction is acceptable tables 4 and 5 present the comparison results with other modeling methods including captive model tests pmm cmt rans computation and the empirical one with modular model of cross flow drag based on slender body theory the relevant data for comparison are taken from simman 2008 workshop the results indicate that the proposed identification method is sufficiently accurate it should be noted that in this case the training data are extracted from the hsva s model tests while the comparison data for validation contains the results from the marin s model tests in fact bias may exist in the experimental results from different institutions because of the differences in test sites and ship models therefore this might also be one of the reasons for the discrepancies in these predictions it can be found that the selection of the sampling interval is a trade off between the model capability and computational cost a larger sampling interval means fewer data points and lower computational cost but at the same time the cumulative deviation may be larger when predicting the maneuvers with high steering frequency assisted by the kernel trick and the sparsity of ν svr the proposed method of nonparametric modeling has high efficiency in the case studied the sampling interval is set to 0 15 s resulting in a modeling time fewer than 5 s and obtaining a model with great generalization ability when the sampling interval is set to 0 4 s the modeling time will be less than 1 s which can satisfy the requirement of online modeling this fast built model has similar accuracy for the predictions of 20 20 and 10 10 zigzag maneuvers compared with the model in the case studied but for the prediction of 30 5 and 35 5 zigzag maneuvers the fast built model has a larger cumulative deviation therefore the selection of sampling intervals is mainly based on modeling purposes if high precision long term trajectory prediction is desired relatively small sampling intervals should be chosen while for quick and short term predictions large sampling intervals should be chosen to improve the modeling and prediction efficiency in summary the results demonstrate that the rbf kernel based ν svr has a powerful capability for nonlinear modeling and the identified model has a good generalization performance the key issue is to find the right kernel parameters with the proposed parameter tuning scheme the kernel parameter corresponding to the minimum generalization error is found afterwards the nonlinear mapping can be learned appropriately the training data also play an important role for parameter tuning and generalization ability since the prior knowledge of nonparametric modeling is limited the modeling process will face great uncertainty and the risk of overfitting when the identified model is expected to be used for predictions in an extrapolation way such as training with the data of 20 20 zigzag maneuver while predicting 10 10 zigzag maneuver or 35 turning circle maneuver in this situation the difficulty of adjusting parameters also increases when the stability of the model is threatened the applicability of the system identification method is reduced by contrast if the training data cover the input space and relevant steering frequency as much as possible identification is approximately performed as an interpolation processing with respect to the steering angle input in this way the modeling uncertainty and risk of overfitting can be effectively reduced hence improving the practicality through the analysis of experimental data the generalization validation demonstrates that the data pre processing and the parameter tuning strategy are effective a robust model is established in an efficient and practical way 5 conclusions a system identification method based on ν svr is proposed for modeling of ship maneuvering motion taking the kvlcc2 tanker as the study object the modeling method is systematically evaluated based on the real data from model tests from the case study the following advantages and features of the modeling method can be summarized firstly the kernel function makes prior information on the model structure unnecessary avoids the curse of dimensionality and provides powerful nonlinear modeling capability secondly ν svr automatically adjusts the amount of support vectors to ensure sparsity thus achieving high computation efficiency this feature also enhances the applicability as it reduces the difficulty of parameter tuning and makes the method robust to the varying noise level thirdly the principle of structural risk minimization allows a balance between approximation accuracy and model complexity which helps to avoid overfitting finally the proposed dynamic simulation based tuning method gives prominence to the evaluation of generalization error and cumulative deviation thereby ensuring the quality of the model by selecting appropriate parameters by comparing with the widely used 10 fold cross validation the proposed method of parameter tuning is proven to be more suitable for the modeling of ship maneuvering motion the prediction results of multiple maneuvers validate the effectiveness and robustness of the identified model the kernel based ν svr method has good migration and adaptation ability because of its less dependence on prior information fast computation and low cost it can be applied to other types of marine vehicles or other ship dynamics to establish the dynamic models in an easy to implement way this can also provide supports to the model based planning or control system design thus to improve the autonomous ship technique in the future study the effects of factors such as the configuration of training data and the selection of regressors on nonparametric modeling will be studied to further improve the quality of the identified model credit author statement zihao wang conceptualization methodology simulation analysis visualization writing original draft haitong xu methodology simulation analysis writing original draft li xia methodology data processing analysis writing original draft zaojian zou methodology supervision writing review and editing funding acquisition project administration c guedes soares methodology supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work is financially supported by the national natural science foundations of china grant number 51979165 the authors are grateful to the hamburg ship model basin hsva and maritime research institute netherlands marin for providing the experimental data 
21512,the reliability of marine propulsion system is seriously affect by abnormal vibrations of propeller shaft on the lubricated stern bearings an applicable numerical model regarding the lubricant performance of misalignment bearing induced by the transverse vibration of shaft is proposed comparisons with results presented in the literature is conducted to verify the accuracy of present results and demonstrate the applicability of proposed method the hydrodynamic lubrication including fluid pressure film thickness load capacity and its attitude angle misalignment moment and its attitude angle end leakage flow rate and frictional coefficient are numerically calculated by solving the reynolds equation with centered finite difference method the impact factors of misalignment angle eccentricity ratio shaft rotational speed lubricant viscosity and center line eccentricity angle on the lubricant performance are investigated with different model parameters to capture the nature of shaft bearing interaction the misalignment angle induced by rotational speed is experimentally obtained this interaction is simultaneously considered in proposed model to discuss the nonlinear response of the lubricant performance therefore an optimized design for the interaction of marine propeller shaft and oil lubricated stern bearing is realized keywords hydrodynamic lubrication stern journal bearings misalignment angle marine propeller shaft transverse vibration nomenclature p fluid pressure of oil film h film thickness r bearing radius μ lubricant viscosity u circumferential components of velocity v axial components of velocity θ circular angle along circumferential direction y deformation along axial direction ω j shaft rotational speed γ bearing misalignment angle f transverse force l shaft length e elastic modulus i second axial moment of area η kinematic viscosity of flow ρ density of oil film c bearing radial clearance e eccentricity at half length of bearing ε eccentricity ratio ψ 0 deflection angle along bearing l bearing length α center line eccentricity angle f x load vector at x coordinates f y load vector at z coordinates φ f attitude angle of load capacity m x moment vector at x coordinates m z moment vector at z coordinates φ m attitude angle of misalignment moment q end leakage flow rate f friction force μ f frictional coefficient z transverse deformation 1 introduction hydrodynamic lubrication is the pressure produced due to the relative motion of the contact surface forming lubricant film between the contact surfaces to separate the two interfaces completely zakharov 2010 for the shaft bearing system the shaft journal is separated by the supporting force of lubricating film of the hydro lubricated bearing during the rotation of the shaft cabrera et al 2005 wang et al 2013 the primary purpose of a lubricated bearing is to reduce friction wear and contact fatigue on the shaft bearing interaction surfaces thereby improving the durability and efficiency of the shaft vladescu et al 2018 liu et al 2020 a slight misalignment angle between shafts and bearings due to manufacturing errors non central loads or shaft deformation may lead to changes in the distribution of oil film xiang et al 2019a the fluid pressure load carrying capacity and frictional force of the lubricated bearing will vary significantly due to the misalignment mihailidis et al 2010 wang et al 2018 undesirable shaft vibrations murawski 2005 and excessive bearing wear xiang et al 2019b 2020a may induced because of the poor operating quality the increased nonlinearity on shaft bearing interaction can lead to partial fatigue and even overall failures of the marine propulsion system therefore it is important to consider the influence of misalignment angle caused by shaft vibration on the lubricant performance of stern bearing thomsen and klit 2012 therefore with reasonable application of reynolds equation in the theoretical model the lubricant performance of stern bearing was gradually concerned m ionescu 2011 proposed an original analytical solution and a higher simplicity of calculations for the thermo hydrodynamic lubrication to ensures good precision for journal bearings with finite dimensions a kraker et al krakera et al 2007 calculated the effective film height contact pressure stribeck curves at constant load by solving the coupled system of 2d 3d reynolds structure equations k shao et al shao et al 2014 investigated the maximal fluid pressure the minimal film thickness and the frictional loss coefficient for dynamically loaded of journal bearing lubricated with nonlinear fluid as the influence of misalignment is gradually considered j sun et al sun and gui 2004 found obvious changes in highest fluid pressure and lest film thickness when misalignment angle takes place by comparing results of different misalignment degrees h boucherit et al boucherit et al 2008 discussed the effects of the misalignment on static and dynamic performances of misaligned compliant journal bearings b li et al li et al 2019 analyzed the influence rule of the axial movement of misaligned journal on the performance of journal bearing under different misaligned angle rotational speed and eccentricity moreover with the maturity of numerical method and the improvement of computational capability various theories had been proposed to describe the behavior of hydrodynamic lubrication some of them including finite difference method fdm kumar et al 2010 sharma et al 2019a computational fluid dynamic cfd simulation zhang et al 2014 gao et al 2015 li et al 2017 finite element method fem sharma et al 2019b xiang et al 2020b fluid structure interaction fsi technique wodtke et al 2013 generalized integral transform technique gitt approach santos et al 2012 have been applied to solve of the reynolds equation meanwhile relevant laboratory experiments wang et al 2014 verma et al 2014 have also been conducted on the lubrication performance of stern bearing these researches provided possible supporting and feasible technique for detailed explanation of the mechanism of hydrodynamic lubrication and clarified the internal relationship between lubricant performance and misalignment angle of the bearing while the amount and applicability of published literatures focusing on the hydrodynamic lubrication is limited the disadvantage is that the impact factors including misalignment angle rotational speed eccentricity ratio lubricant viscosity and center line eccentricity angle cannot be flexibly considered simultaneously moreover it should be pointed out that there are also interactions among these impact factors for example the load carrying capacity was proved to be closely related to the film distribution goodwin et al 2007 the lubricant viscosity of oil film changed significantly with higher temperature and ighil1 et al 2008 and larger rotational speed hirani and verma 2009 the magnitude of load capacity and frictional force were seriously affected by the misalignment baidya et al 2019 the contact force decreased rapidly with a slight diminution of eccentricity ratio cui et al 2018 while few studies have considered the interaction of these impact factors therefore it is essential to propose a more reliable model and a more suitable method to analyze the hydrodynamic lubrication of stern bearing under the consideration of above mentioned factors in view of this a numerical model in the exploration of lubricant performance of oil lubricated stern bearing is thus proposed the impact factor of model parameters including misalignment angle eccentricity ratio shaft rotational speed lubricant viscosity and center line eccentricity angle are respectively investigated the lubricant performance of fluid pressure film thickness load capacity and its attitude angle misalignment moment and its attitude angle end leakage flow rate and frictional coefficient are numerically obtained moreover the interaction between misalignment angle and rotational speed is analyzed by shaft vibration on the experimental platform this interaction is also taken into account in the numerical model for more accurate calculations of the lubricant performance based on the present work a practicable method for calculating the lubricant performance of stern bearing of marine propeller shaft is thus proposed 2 methodology the schematic in fig 1 shows the misaligned shaft of lubricated stern bearing with oil film keeps these two components separate the left side is the cross sectional diagram and the right side is the axial surface without considering the influence of other forms of friction and wear the initial shaft axis droops due to the self weight it produces permanent reaction force of the oil film on the shaft bearing contact surfaces and the effect of transverse vibration and loading condition causes the misalignment more serious during shaft rotating 2 1 fluid pressure the reynolds equation is widely applied in the research of hydrodynamic lubrication of stern journal bearing the equation of motion under steady state loading condition is given by wen 1991 1 θ h 3 p θ r 2 y h 3 p y 6 μ r u h θ 6 μ r 2 v h y where p is the fluid pressure of the oil film h is the film thickness r is the bearing radius μ is the lubricant viscosity u and v are the components of velocity in circumferential and axial directions of journal bearing which can be given by 2 u r ω j cos γ v r ω j sin γ where ω j is the rotational speed of the shaft and γ is the misalignment angle in the journal bearing the marine propeller shaft can equivalent to a cantilever beam with fixed end the main engine and free end the propeller the journal misalignment will be induced by transverse vibration of the shaft according to the deformation theory of cantilever beam under concentrated force the misalignment angle of the shaft in bearing hole can be given as 3 γ f l 2 3 e i where f is the concentrated force in transverse direction l is the length of the shaft e i is the cross sectional bending stiffness of the shaft and the lubricant viscosity μ of the oil film is defined as 4 μ η ρ where the kinematic viscosity η is the flow resistance under the action of gravity ρ is density of the oil film 2 2 film thickness assuming that the radius of the journal is much larger than the thickness of oil film the film thickness of a misaligned shaft is expressed as 5 h c e cos θ ψ 0 tan γ y l 2 cos θ α ψ 0 where c is the radial clearance of the bearing e is the eccentricity at the half length of bearing with ψ 0 is the deflection angle along the bearing length l is the length of bearing α is the angle between ψ 0 and the center line of journal the radial clearance c is the distance between the journal surface r j and the bearing housing surface r b when both are concentric which can be expressed as 6 c r b r j the eccentricity e is the distance between journal center and bearing center thus an eccentricity ratio regarding radial clearance c and eccentricity e can be given as 7 ε e c where ε is the eccentricity ratio 2 3 load capacity the load carrying capacity can be obtained by an integration of the known fluid pressure p and two components of load capacity in x and z directions can be respectively calculated as 8 f x 0 l 0 2 π p r sin θ d y d θ f z 0 l 0 2 π p r cos θ d y d θ where f x and f z are the components of the load vector in x and z coordinates respectively the total load capacity f with the attitude angle φ f can be given as 9 f f x 2 f z 2 φ f 1 sin f z 90 sin f z sin f x arctan f x f z 2 4 misalignment moment similarly the misaligned moment can be obtained from an integration of the fluid pressure and bearing length the components of the moment vector at x and z coordinates are calculated as 10 m x 0 l 0 2 π p y l 2 r cos θ d y d θ m z 0 l 0 2 π p y l 2 r sin θ d y d θ where m x and m z are the components of the moment vector at x and z coordinates respectively the total misalignment moment m and the direction angle φ m can be obtained as follows 11 m m x 2 m z 2 φ m 1 sin m z 90 sin m z sin m x arctan m x m z 2 5 end leakage flow rate the end leakage flow rate of the lubrication is the sum of flow rate from the front end and the rear end of the journal bearing which can be given as 12 q 0 2 π h 3 12 μ p y y 0 r d θ 0 2 π h 3 12 μ p y y l r d θ where y 0 and y l are the front end and the rear end of the bearing respectively 2 6 frictional coefficient the frictional force f on the contact surface of journal bearing can be computed from 13 f 0 l 0 2 π h 2 p r θ r ω μ h r d θ d y based on the theory of friction the frictional coefficient can be obtained from the ratio of the friction force f to total load capacity f which is expressed as 14 f μ f f where μ f is the frictional eccentricity 3 results and discussion as the impact factors of hydrodynamic lubrication are presented in theoretical basis the solution algorithm is thus introduced in this section due to wide applicability and accurate computability the centered finite difference method is applied to solve the reynolds equation with matlab code the circumferential direction from 0 to 2π and the axial direction from 0 to l are selected to be the solving region considering the asymmetry the boundary condition of the fluid pressure can be defined as 15 p θ 0 p θ l 0 p θ 1 y p θ 1 y θ 0 p θ 2 y p θ 2 y θ 0 where θ 1 and θ 2 are the circular angles of the oil film from the start point to the end point in circumferential direction over a range of 0 to 2π during the solving process the solving region is divided into meshes in circumferential axial directions the criteria of the number of iterations for the bearing pressure is determined as 16 i 2 m j 2 n p i j k p i j k 1 i 2 m j 2 n p i j k ξ where k is the number of iterations the value of ξ is defined as ξ 1 0 e 3 m and n are the number of mesh grids for the circumferential and axial directions which should not differ too much 3 1 validation in order to verify the proposed solving method the numerical results are compared with those presented in the literature the model parameters of the journal bearing given by sun sun and gui 2004 are selected for the calculation of fluid pressure with different misalignment angle specific data of the misalignment angle is defined as 0 0 4 0 10 3 7 0 10 3 and 1 0 10 2 degree respectively another approach presented by hirani hirani and verma 2009 is also selected for the results comparison therefore a comparative comparison for the maximal value of the fluid pressure is obtained detailed data is listed in the table 1 the results show that the deviation of the numerical calculation in this work is much small comparing with those of the two references it indicates that the confidence level of the proposed method is much high considering the difference of iteration algorithm and convergence criteria it will obviously lead to a deviation of the results with the average difference with ref sun and gui 2004 and ref hirani and verma 2009 is about 3 0 and 9 9 respectively it demonstrates the accuracy of the present lubrication analysis is reliable and the deviations should be accepted for the validation of the proposed method in this work it confirms that the application of the proposed method is suitable for the numerical calculation of hydrodynamic lubrication 3 2 numerical calculation along with the theoretical basis of the lubricant performance is given and the proposed solving method is proved to be applicable for the numerical calculation in this section a shaft platform in a free running condition with oil lubricated stern bearing arranged about the middle of each shaft segment is considered for the calculation the model parameters are selected to represent the property of bearing which are summarized in table 2 the calculation process is conducted on the basis of the theoretical model from eqs 1 14 and the solution algorithm from eq 15 to 16 meanwhile the solving region is divided into m 120 nodes and n 60 nodes for the circumferential direction and axial direction with equal interval grid respectively a value of over relaxation factor λ 1 75 is applied for the difference equation of fluid pressure to accelerate the convergence the theoretical basis indicates that the hydrodynamic lubrication not only depends on the bearing structure oil property misalignment angle and also the rotational speed of the shaft which supported by the bearing in order to investigate the influence of misalignment angle shaft rotational speed eccentricity ratio lubricant viscosity and center line eccentricity angle six cases a γ 0 01 deg ω 100 rpm ε 0 2 ν 10 mm2 s α 0 deg b γ 0 02 deg ω 100 rpm ε 0 2 ν 10 mm2 s α 0 deg c γ 0 01 deg ω 200 rpm ε 0 2 ν 10 mm2 s α 0 deg d γ 0 01 deg ω 100 rpm ε 0 5 ν 10 mm2 s α 0 deg e γ 0 01 deg ω 100 rpm ε 0 2 ν 15 mm2 s α 0 deg f γ 0 01 deg ω 100 rpm ε 0 2 ν 10 mm2 s α 90 deg are defined to identify the influence of various impact factor on the lubricant performance on this basis the hydrodynamic lubrication including fluid pressure film thickness load capacity and its attitude angle misalignment moment and its attitude angle end leakage flow rate and frictional coefficient is thus analyzed moreover it should be pointed out that every impact factors is calculated with other parameters remains the initial values the results in fig 2 is the distribution of fluid pressure with different misalignment angle b rotational speed c eccentricity ratio d lubricant viscosity e and center line eccentricity angle f respectively the variation of these results demonstrate the influence of above impact factors on the fluid pressure the results of case a is noticed to be the smallest comparing with other cases that means the distribution with larger misalignment angle rotational speed eccentricity ratio lubricant viscosity is much greater it indicates that the increase of model parameters enlarge the amplitude of fluid pressure of the bearing for the results from cases a to case e the pressure distribution is found to achieve maximum when the length is about l 2 and the circular angle is about 3π 4 while that of case f is the opposite it means that the eccentricity angle only affects the phase position that is the difference with other impact factors as the pressure amplitude of case c is noticed to be twice of that of case a a multiple relationship between maximal pressure and rotational speed can be obtained similar results can be concluded for the lubricant viscosity of the oil film in case e that means the maximal pressure increases as a multiple of the lubricant viscosity and the influence of eccentricity ratio in case d is the most remarkable which shows the maximal pressure is about 10 times than that of case a for the influence of misalignment angle a relationship of 4 times can be found about the maximal pressure between case b and case a as the instability of the oil film have a significant impact on the lubricant performance of the bearing the film thickness during the shaft bearing interaction is thus analyzed the results in fig 3 shows the distribution of film thickness of above six cases the variation of film thickness is noticed to be much slight than that of the fluid pressure comparing with the result in fig 2 the film thickness of all the cases is noticed to increase linearly with the bearing length while it changes in the form of sine function along the circumferential direction the maximal value is thus located at the length is about l or the circular angle is about π 2 while the results in case f shows the highest film thickness locates at the start of the length l 0 or the middle of the circular angle θ π the reason is that the influence of center line eccentricity angle is opposite with other impact factors meanwhile the amplitude of film thickness is independent of the eccentricity angle which remains the same with the results in fig 2 the maximal value in cases b and d are noticed to be larger than case a it indicates that the enlargement of misalignment angle and eccentricity ratio directly increase the film thickness as predicted in eq 5 this keeps similar with the variation of fluid pressure in fig 2 but not a multiple relationship while the maximal value of case c and e nearly remains unchanged which shows that the film thickness change slightly with the effect of rotational speed and lubricant viscosity as the distribution in figs 2 and 3 indicate the influence of abovementioned impact factors on fluid pressure and film thickness without doubt these model parameters can produce significant impact on other lubricant performance of the bearing and the proposed numerical calculation is proved to be an effective technique for appropriate influence investigation therefore the lubricant response including load capacity and its attitude angle misalignment moment and its attitude angle flow rate and frictional coefficient are simultaneously obtained for the convenience of comparison the results within half a circumference θ 0 π at the half length y l 2 of the bearing are selected shown in fig 4 the results in fig 4 a shows the fluid pressure increases with the circular angle ranges from 0 to π the highest point locates at about 3π 4 except for that of the case f at about π 4 as the effect of eccentricity angle is opposite and the amplitude of case d is the largest which indicates the influence of lubricant viscosity is the most significant it is also confirmed that the fluid pressure is more sensitive with the effect of eccentricity ratio as predicted in fig 2 meanwhile case b shows similar pressure with case a it proves the smallest impact of misalignment angle the maximal pressure of case c is found to be about twice of that of case a which indicates a multiple relationship between fluid pressure and rotational speed as showed in fig 2 it can be found in fig 4 b that the film thickness decreases slowly with increasing circular angle at the middle of the bearing length similar with the result in fig 3 the results of cases b and c are found to be much similar with that of case a which also means the weak influence of misalignment angle and rotational speed on the variation of film thickness while the results of case d and case e are much significant which demonstrates the film thickness is much sensitive with eccentricity ratio and lubricant viscosity both the load capacity in fig 4 c and misalignment moment in fig 4 e show a significant increases with the circular angle from 0 to 3π 4 and then decrease slightly and the variation can be observed to be much similar with the fluid pressure in fig 4 a this consistency of these three figures is because of the load capacity and misalignment moment are the integral of fluid pressure and other factors shown in eqs 8 and 10 while the load attitude angle in fig 4 d describes the variation with a periodic sine function form over a range of circular angle it can be observed that the angle changes from 40 to 180 in half a cycle the results in case d suffers largest angle variation and that of case f is the opposite in phase position comparing with the variation of load angle the variation of moment attitude angle in fig 4 f is much smaller with a range of less than one degree while the trend of variation for each impact factors is noticed to be same as fig 4 d fig 4 g shows the end leakage flow rate of all the six cases increases with circular angle from 0 to 3π 8 and then decreases gradually the influence of misalignment angle and rotational speed are more serious than other impact factors as the larger amplitude of cases b and c while the results in case e are noticed to be the same that of case a which proves that the independence of lubricant viscosity with the flow rate case a shows that the flow rate is slight smaller than that of case d and larger than that of case f it means the flow rate increases with the eccentricity ratio and decreases with the eccentricity angle among all the impact factors only the eccentricity angle has an effect of reducing the flow rate the frictional coefficient of above six cases are shown in fig 4 h it can be observed that the frictional coefficient decreases rapidly at the beginning of the circular angle and then trends to be zero very fast while the variation of case f is also the opposite with other cases the results of cases c and e are nearly same as that of case a that means the rotational speed and lubricant viscosity do not affect the frictional coefficient and the misalignment angle of case b shows significant influence on the friction property because of the largest amplitude among all the cases and the amplitude of case d is slight smaller than that of case a which means the frictional coefficient decrease with the eccentricity ratio among these impact factors the lubricant performance of the bearing can be noticed to be the most sensitive to the eccentricity ratio the hydrodynamic lubrication is found to be increased with growing rotational speed and misalignment angle and a linear relationship between the viscosity of the oil film and the lubricant performance can be observed the center line eccentricity angle can be found to affect the phase position instead of the amplitude of the hydrodynamic lubrication 3 3 discussion in general it can be concluded that the hydrodynamic lubrication of stern bearing closely relates to abovementioned impact factors the response including fluid pressure film thickness load capacity misalignment moment flow rate and frictional coefficient are affected by these factor in different degree the numerical calculation demonstrates the influence of single factor on the lubricated performance while it should be pointed out that the misalignment can be produced by the transverse vibration of the shaft and the misalignment angle is various with different rotational speed verma et al 2014 in practice the journal bearing experiences misalignment during operation due to increased loading condition on bearings in this case the misalignment angle is usually considerably higher than supplied which is essential to be taken into account boucherit et al 2008 in order to investigate the interaction of misalignment angle and rotational speed on the lubricated performance an experimental test is thus conducted on the basis of shaft experimental platform fig 5 a shows the platform mounted on the foundation is consist of main engine crankshaft propeller and shaft the shaft contains an intermediate shaft and a tail shaft with the hydraulic couplings connecting these two parts the tail shaft is supported by an oil lubricated stern bearing with hydraulic loading system besides the diameter and length of the shaft is about 0 075 m and 1 95 m respectively in order to minimize the deviation during the test and avoid shaft damage induced by excessive stresses a range of rotational speed of 100 150 200 250 and 300 rpm torsional detection instrument type b k 2523 and rotational speed sensor type b k mm0024 are considered and four cases including free condition middle shaft loading load 1 tail shaft loading load 2 middle tail shaft loading load 3 are defined the loading is applied by the hydraulic loading system fig 5 a which includes torque loading and force loading devices i e exciters the amplitude of the loading is obtained by the stress sensor and signal acquisition through the exciters in the process of experiment the data for transverse vibration is acquired with an acceleration sensor tri axial accelerometer sensor type b k 4535 b 001 located near the oil lubricated stern bearing a multichannel signal analyzer signal acquisition type pxie 4499 including servo amplifiers signal acquisition card and signal output device is used to collect the test data shown in fig 5 b the deformation of transverse vibration of the shaft with different loading conditions and rotational speed is shown in fig 6 huang 2017 it can be found that the transverse deformation increases with increasing rotational speed of the shaft which means the misalignment angle is enlarged with the rotational speed and comparing with the free condition the misalignment angle also increases with the effect of loading condition especially for the case of load 3 according to the relationship between transverse deformation and misalignment angle the misalignment angle can be obtained by 17 γ arctan z l where z is the transverse deformation and l is the length of the shaft detailed results listed in table 3 is the misalignment angle with various rotational speed and load condition the data for free condition is 2 5 10 3 3 4 10 3 4 8 10 3 7 3 10 3 and 9 8 10 3 degree with the rotational speed ranges from 100 to 300 rpm which seems to be linear relationship without considering the experimental deviation for the case of 100 rpm the misalignment angle is 2 5 10 3 3 1 10 3 4 2 10 3 and 3 9 10 3 degree with increasing loading conditions as the misalignment angle varies with rotational speed the interaction of these two impact factor will enlarge the lubricant performance of the bearing in this section the rotational speed and misalignment angle in table 3 are simultaneously considered for the investigation meanwhile the response of load capacity and misalignment moment are noticed to be similar with that of fluid pressure in order to simplify the calculation only the fluid pressure film thickness flow rate and frictional coefficient are analyzed and the maximal values of the half length y l 2 and a range of half cycle θ 0 π are selected for the comparison the results in fig 7 shows the maximal value of fluid pressure film thickness flow rate and frictional coefficient at the middle of bearing length over a range of half cycle the response with both rotational speed and misalignment angle is noticed to be enlarged in nonlinear as the rotational speed increased the pressure fig 7 a with the rotational speed changes from 100 to 300 rpm of free condition is 1 81 105 2 77 105 3 86 105 5 38 105 and 7 49 105 pa respectively similar results can be found for the results of film thickness fig 7 b flow rate fig 7 c and frictional coefficient fig 7 d it indicates a smaller increase for the lower speed and a larger increase for the higher speed not only that the pressure of the four cases is 1 81 105 1 83 105 1 89 105 and 1 87 105 pa with the rotational speed is 100 rpm it changes to 7 49 105 8 85 105 8 71 105 and 9 85 105 pa with 300 rpm that means the variation of pressure film thickness flow rate and frictional coefficient with larger misalignment angle grows faster than that of the lowers it demonstrated that a nonlinear response of the hydrodynamic lubrication can be induced by the interaction of rotational speed and misalignment angle it should be pointed out that the stiffness of friction pairs and the morphology of contact surface will also affect the lubricant performance these factors cause randomness and uncontrollability to the lubricant performance and beyond the consideration of theoretical definition meanwhile the observed results and revealed mechanism by the numerical calculation are not fully provided with universal the theoretical model proposed in this paper is qualitative as a result of introducing parameter assuming and model simplification nevertheless this research can provide a practicable tool for the response evaluation and optimal design of hydrodynamic lubrication of the marine propeller shaft 4 conclusion in this paper a theoretical model focusing on lubricant performance of stern bearing of the marine propeller shaft is proposed the hydrodynamic lubrication is investigated with centered finite difference method by solving the reynolds equation the lubricant performance is numerically calculated and the impact factors are respectively investigated moreover the interaction between rotational speed and misalignment angle is discussed on the basis of shaft vibration experiments and then considered in the model therefore a more suitable method considering abovementioned factors is proposed for marine engineers and designers as its ability of calculating the lubricate performance three further contributions of the present work can be given 1 the lubricant performance is closely related to the misalignment angle eccentricity ratio shaft rotational speed lubricant viscosity and center line eccentricity angle among these impact factors the influence of the eccentricity ratio is the most significant on the amplitude of the response 2 the response of fluid pressure film thickness load capacity and its attitude angle misalignment moment and its attitude angle end leakage flow rate and frictional coefficient increases with abovementioned impact factors except the center line eccentricity angle only affects the phase position 3 the misalignment angle of the bearing is variable with the rotational speed and load capacity of the shaft the interaction of these two impact factor can also enlarge the hydrodynamic lubrication it is therefore vital to not only consider the rotational speed but also to minimize the load condition during actual working process in summary the present work detailedly investigate the influence of abovementioned impact factors on the lubricant performance of stern bearing it is clearly demonstrated that the proposed numerical model and analytical techniques are feasible to be applied in the calculating of hydrodynamic lubrication a possible parameters range for fluid pressure and load capacity are presented to reduce abrasive wear of the bearing in future work the impact factors of temperature and bearing stiffness will be considered to increase service life credit authorship contribution statement qianwen huang conceptualization data curation formal analysis funding acquisition investigation methodology software validation writing original draft xinping yan project administration resources supervision visualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this research is supported by the national natural science foundation of china no 51809201 and the hubei provincial natural science foundation of china no 2018cfb371 
21512,the reliability of marine propulsion system is seriously affect by abnormal vibrations of propeller shaft on the lubricated stern bearings an applicable numerical model regarding the lubricant performance of misalignment bearing induced by the transverse vibration of shaft is proposed comparisons with results presented in the literature is conducted to verify the accuracy of present results and demonstrate the applicability of proposed method the hydrodynamic lubrication including fluid pressure film thickness load capacity and its attitude angle misalignment moment and its attitude angle end leakage flow rate and frictional coefficient are numerically calculated by solving the reynolds equation with centered finite difference method the impact factors of misalignment angle eccentricity ratio shaft rotational speed lubricant viscosity and center line eccentricity angle on the lubricant performance are investigated with different model parameters to capture the nature of shaft bearing interaction the misalignment angle induced by rotational speed is experimentally obtained this interaction is simultaneously considered in proposed model to discuss the nonlinear response of the lubricant performance therefore an optimized design for the interaction of marine propeller shaft and oil lubricated stern bearing is realized keywords hydrodynamic lubrication stern journal bearings misalignment angle marine propeller shaft transverse vibration nomenclature p fluid pressure of oil film h film thickness r bearing radius μ lubricant viscosity u circumferential components of velocity v axial components of velocity θ circular angle along circumferential direction y deformation along axial direction ω j shaft rotational speed γ bearing misalignment angle f transverse force l shaft length e elastic modulus i second axial moment of area η kinematic viscosity of flow ρ density of oil film c bearing radial clearance e eccentricity at half length of bearing ε eccentricity ratio ψ 0 deflection angle along bearing l bearing length α center line eccentricity angle f x load vector at x coordinates f y load vector at z coordinates φ f attitude angle of load capacity m x moment vector at x coordinates m z moment vector at z coordinates φ m attitude angle of misalignment moment q end leakage flow rate f friction force μ f frictional coefficient z transverse deformation 1 introduction hydrodynamic lubrication is the pressure produced due to the relative motion of the contact surface forming lubricant film between the contact surfaces to separate the two interfaces completely zakharov 2010 for the shaft bearing system the shaft journal is separated by the supporting force of lubricating film of the hydro lubricated bearing during the rotation of the shaft cabrera et al 2005 wang et al 2013 the primary purpose of a lubricated bearing is to reduce friction wear and contact fatigue on the shaft bearing interaction surfaces thereby improving the durability and efficiency of the shaft vladescu et al 2018 liu et al 2020 a slight misalignment angle between shafts and bearings due to manufacturing errors non central loads or shaft deformation may lead to changes in the distribution of oil film xiang et al 2019a the fluid pressure load carrying capacity and frictional force of the lubricated bearing will vary significantly due to the misalignment mihailidis et al 2010 wang et al 2018 undesirable shaft vibrations murawski 2005 and excessive bearing wear xiang et al 2019b 2020a may induced because of the poor operating quality the increased nonlinearity on shaft bearing interaction can lead to partial fatigue and even overall failures of the marine propulsion system therefore it is important to consider the influence of misalignment angle caused by shaft vibration on the lubricant performance of stern bearing thomsen and klit 2012 therefore with reasonable application of reynolds equation in the theoretical model the lubricant performance of stern bearing was gradually concerned m ionescu 2011 proposed an original analytical solution and a higher simplicity of calculations for the thermo hydrodynamic lubrication to ensures good precision for journal bearings with finite dimensions a kraker et al krakera et al 2007 calculated the effective film height contact pressure stribeck curves at constant load by solving the coupled system of 2d 3d reynolds structure equations k shao et al shao et al 2014 investigated the maximal fluid pressure the minimal film thickness and the frictional loss coefficient for dynamically loaded of journal bearing lubricated with nonlinear fluid as the influence of misalignment is gradually considered j sun et al sun and gui 2004 found obvious changes in highest fluid pressure and lest film thickness when misalignment angle takes place by comparing results of different misalignment degrees h boucherit et al boucherit et al 2008 discussed the effects of the misalignment on static and dynamic performances of misaligned compliant journal bearings b li et al li et al 2019 analyzed the influence rule of the axial movement of misaligned journal on the performance of journal bearing under different misaligned angle rotational speed and eccentricity moreover with the maturity of numerical method and the improvement of computational capability various theories had been proposed to describe the behavior of hydrodynamic lubrication some of them including finite difference method fdm kumar et al 2010 sharma et al 2019a computational fluid dynamic cfd simulation zhang et al 2014 gao et al 2015 li et al 2017 finite element method fem sharma et al 2019b xiang et al 2020b fluid structure interaction fsi technique wodtke et al 2013 generalized integral transform technique gitt approach santos et al 2012 have been applied to solve of the reynolds equation meanwhile relevant laboratory experiments wang et al 2014 verma et al 2014 have also been conducted on the lubrication performance of stern bearing these researches provided possible supporting and feasible technique for detailed explanation of the mechanism of hydrodynamic lubrication and clarified the internal relationship between lubricant performance and misalignment angle of the bearing while the amount and applicability of published literatures focusing on the hydrodynamic lubrication is limited the disadvantage is that the impact factors including misalignment angle rotational speed eccentricity ratio lubricant viscosity and center line eccentricity angle cannot be flexibly considered simultaneously moreover it should be pointed out that there are also interactions among these impact factors for example the load carrying capacity was proved to be closely related to the film distribution goodwin et al 2007 the lubricant viscosity of oil film changed significantly with higher temperature and ighil1 et al 2008 and larger rotational speed hirani and verma 2009 the magnitude of load capacity and frictional force were seriously affected by the misalignment baidya et al 2019 the contact force decreased rapidly with a slight diminution of eccentricity ratio cui et al 2018 while few studies have considered the interaction of these impact factors therefore it is essential to propose a more reliable model and a more suitable method to analyze the hydrodynamic lubrication of stern bearing under the consideration of above mentioned factors in view of this a numerical model in the exploration of lubricant performance of oil lubricated stern bearing is thus proposed the impact factor of model parameters including misalignment angle eccentricity ratio shaft rotational speed lubricant viscosity and center line eccentricity angle are respectively investigated the lubricant performance of fluid pressure film thickness load capacity and its attitude angle misalignment moment and its attitude angle end leakage flow rate and frictional coefficient are numerically obtained moreover the interaction between misalignment angle and rotational speed is analyzed by shaft vibration on the experimental platform this interaction is also taken into account in the numerical model for more accurate calculations of the lubricant performance based on the present work a practicable method for calculating the lubricant performance of stern bearing of marine propeller shaft is thus proposed 2 methodology the schematic in fig 1 shows the misaligned shaft of lubricated stern bearing with oil film keeps these two components separate the left side is the cross sectional diagram and the right side is the axial surface without considering the influence of other forms of friction and wear the initial shaft axis droops due to the self weight it produces permanent reaction force of the oil film on the shaft bearing contact surfaces and the effect of transverse vibration and loading condition causes the misalignment more serious during shaft rotating 2 1 fluid pressure the reynolds equation is widely applied in the research of hydrodynamic lubrication of stern journal bearing the equation of motion under steady state loading condition is given by wen 1991 1 θ h 3 p θ r 2 y h 3 p y 6 μ r u h θ 6 μ r 2 v h y where p is the fluid pressure of the oil film h is the film thickness r is the bearing radius μ is the lubricant viscosity u and v are the components of velocity in circumferential and axial directions of journal bearing which can be given by 2 u r ω j cos γ v r ω j sin γ where ω j is the rotational speed of the shaft and γ is the misalignment angle in the journal bearing the marine propeller shaft can equivalent to a cantilever beam with fixed end the main engine and free end the propeller the journal misalignment will be induced by transverse vibration of the shaft according to the deformation theory of cantilever beam under concentrated force the misalignment angle of the shaft in bearing hole can be given as 3 γ f l 2 3 e i where f is the concentrated force in transverse direction l is the length of the shaft e i is the cross sectional bending stiffness of the shaft and the lubricant viscosity μ of the oil film is defined as 4 μ η ρ where the kinematic viscosity η is the flow resistance under the action of gravity ρ is density of the oil film 2 2 film thickness assuming that the radius of the journal is much larger than the thickness of oil film the film thickness of a misaligned shaft is expressed as 5 h c e cos θ ψ 0 tan γ y l 2 cos θ α ψ 0 where c is the radial clearance of the bearing e is the eccentricity at the half length of bearing with ψ 0 is the deflection angle along the bearing length l is the length of bearing α is the angle between ψ 0 and the center line of journal the radial clearance c is the distance between the journal surface r j and the bearing housing surface r b when both are concentric which can be expressed as 6 c r b r j the eccentricity e is the distance between journal center and bearing center thus an eccentricity ratio regarding radial clearance c and eccentricity e can be given as 7 ε e c where ε is the eccentricity ratio 2 3 load capacity the load carrying capacity can be obtained by an integration of the known fluid pressure p and two components of load capacity in x and z directions can be respectively calculated as 8 f x 0 l 0 2 π p r sin θ d y d θ f z 0 l 0 2 π p r cos θ d y d θ where f x and f z are the components of the load vector in x and z coordinates respectively the total load capacity f with the attitude angle φ f can be given as 9 f f x 2 f z 2 φ f 1 sin f z 90 sin f z sin f x arctan f x f z 2 4 misalignment moment similarly the misaligned moment can be obtained from an integration of the fluid pressure and bearing length the components of the moment vector at x and z coordinates are calculated as 10 m x 0 l 0 2 π p y l 2 r cos θ d y d θ m z 0 l 0 2 π p y l 2 r sin θ d y d θ where m x and m z are the components of the moment vector at x and z coordinates respectively the total misalignment moment m and the direction angle φ m can be obtained as follows 11 m m x 2 m z 2 φ m 1 sin m z 90 sin m z sin m x arctan m x m z 2 5 end leakage flow rate the end leakage flow rate of the lubrication is the sum of flow rate from the front end and the rear end of the journal bearing which can be given as 12 q 0 2 π h 3 12 μ p y y 0 r d θ 0 2 π h 3 12 μ p y y l r d θ where y 0 and y l are the front end and the rear end of the bearing respectively 2 6 frictional coefficient the frictional force f on the contact surface of journal bearing can be computed from 13 f 0 l 0 2 π h 2 p r θ r ω μ h r d θ d y based on the theory of friction the frictional coefficient can be obtained from the ratio of the friction force f to total load capacity f which is expressed as 14 f μ f f where μ f is the frictional eccentricity 3 results and discussion as the impact factors of hydrodynamic lubrication are presented in theoretical basis the solution algorithm is thus introduced in this section due to wide applicability and accurate computability the centered finite difference method is applied to solve the reynolds equation with matlab code the circumferential direction from 0 to 2π and the axial direction from 0 to l are selected to be the solving region considering the asymmetry the boundary condition of the fluid pressure can be defined as 15 p θ 0 p θ l 0 p θ 1 y p θ 1 y θ 0 p θ 2 y p θ 2 y θ 0 where θ 1 and θ 2 are the circular angles of the oil film from the start point to the end point in circumferential direction over a range of 0 to 2π during the solving process the solving region is divided into meshes in circumferential axial directions the criteria of the number of iterations for the bearing pressure is determined as 16 i 2 m j 2 n p i j k p i j k 1 i 2 m j 2 n p i j k ξ where k is the number of iterations the value of ξ is defined as ξ 1 0 e 3 m and n are the number of mesh grids for the circumferential and axial directions which should not differ too much 3 1 validation in order to verify the proposed solving method the numerical results are compared with those presented in the literature the model parameters of the journal bearing given by sun sun and gui 2004 are selected for the calculation of fluid pressure with different misalignment angle specific data of the misalignment angle is defined as 0 0 4 0 10 3 7 0 10 3 and 1 0 10 2 degree respectively another approach presented by hirani hirani and verma 2009 is also selected for the results comparison therefore a comparative comparison for the maximal value of the fluid pressure is obtained detailed data is listed in the table 1 the results show that the deviation of the numerical calculation in this work is much small comparing with those of the two references it indicates that the confidence level of the proposed method is much high considering the difference of iteration algorithm and convergence criteria it will obviously lead to a deviation of the results with the average difference with ref sun and gui 2004 and ref hirani and verma 2009 is about 3 0 and 9 9 respectively it demonstrates the accuracy of the present lubrication analysis is reliable and the deviations should be accepted for the validation of the proposed method in this work it confirms that the application of the proposed method is suitable for the numerical calculation of hydrodynamic lubrication 3 2 numerical calculation along with the theoretical basis of the lubricant performance is given and the proposed solving method is proved to be applicable for the numerical calculation in this section a shaft platform in a free running condition with oil lubricated stern bearing arranged about the middle of each shaft segment is considered for the calculation the model parameters are selected to represent the property of bearing which are summarized in table 2 the calculation process is conducted on the basis of the theoretical model from eqs 1 14 and the solution algorithm from eq 15 to 16 meanwhile the solving region is divided into m 120 nodes and n 60 nodes for the circumferential direction and axial direction with equal interval grid respectively a value of over relaxation factor λ 1 75 is applied for the difference equation of fluid pressure to accelerate the convergence the theoretical basis indicates that the hydrodynamic lubrication not only depends on the bearing structure oil property misalignment angle and also the rotational speed of the shaft which supported by the bearing in order to investigate the influence of misalignment angle shaft rotational speed eccentricity ratio lubricant viscosity and center line eccentricity angle six cases a γ 0 01 deg ω 100 rpm ε 0 2 ν 10 mm2 s α 0 deg b γ 0 02 deg ω 100 rpm ε 0 2 ν 10 mm2 s α 0 deg c γ 0 01 deg ω 200 rpm ε 0 2 ν 10 mm2 s α 0 deg d γ 0 01 deg ω 100 rpm ε 0 5 ν 10 mm2 s α 0 deg e γ 0 01 deg ω 100 rpm ε 0 2 ν 15 mm2 s α 0 deg f γ 0 01 deg ω 100 rpm ε 0 2 ν 10 mm2 s α 90 deg are defined to identify the influence of various impact factor on the lubricant performance on this basis the hydrodynamic lubrication including fluid pressure film thickness load capacity and its attitude angle misalignment moment and its attitude angle end leakage flow rate and frictional coefficient is thus analyzed moreover it should be pointed out that every impact factors is calculated with other parameters remains the initial values the results in fig 2 is the distribution of fluid pressure with different misalignment angle b rotational speed c eccentricity ratio d lubricant viscosity e and center line eccentricity angle f respectively the variation of these results demonstrate the influence of above impact factors on the fluid pressure the results of case a is noticed to be the smallest comparing with other cases that means the distribution with larger misalignment angle rotational speed eccentricity ratio lubricant viscosity is much greater it indicates that the increase of model parameters enlarge the amplitude of fluid pressure of the bearing for the results from cases a to case e the pressure distribution is found to achieve maximum when the length is about l 2 and the circular angle is about 3π 4 while that of case f is the opposite it means that the eccentricity angle only affects the phase position that is the difference with other impact factors as the pressure amplitude of case c is noticed to be twice of that of case a a multiple relationship between maximal pressure and rotational speed can be obtained similar results can be concluded for the lubricant viscosity of the oil film in case e that means the maximal pressure increases as a multiple of the lubricant viscosity and the influence of eccentricity ratio in case d is the most remarkable which shows the maximal pressure is about 10 times than that of case a for the influence of misalignment angle a relationship of 4 times can be found about the maximal pressure between case b and case a as the instability of the oil film have a significant impact on the lubricant performance of the bearing the film thickness during the shaft bearing interaction is thus analyzed the results in fig 3 shows the distribution of film thickness of above six cases the variation of film thickness is noticed to be much slight than that of the fluid pressure comparing with the result in fig 2 the film thickness of all the cases is noticed to increase linearly with the bearing length while it changes in the form of sine function along the circumferential direction the maximal value is thus located at the length is about l or the circular angle is about π 2 while the results in case f shows the highest film thickness locates at the start of the length l 0 or the middle of the circular angle θ π the reason is that the influence of center line eccentricity angle is opposite with other impact factors meanwhile the amplitude of film thickness is independent of the eccentricity angle which remains the same with the results in fig 2 the maximal value in cases b and d are noticed to be larger than case a it indicates that the enlargement of misalignment angle and eccentricity ratio directly increase the film thickness as predicted in eq 5 this keeps similar with the variation of fluid pressure in fig 2 but not a multiple relationship while the maximal value of case c and e nearly remains unchanged which shows that the film thickness change slightly with the effect of rotational speed and lubricant viscosity as the distribution in figs 2 and 3 indicate the influence of abovementioned impact factors on fluid pressure and film thickness without doubt these model parameters can produce significant impact on other lubricant performance of the bearing and the proposed numerical calculation is proved to be an effective technique for appropriate influence investigation therefore the lubricant response including load capacity and its attitude angle misalignment moment and its attitude angle flow rate and frictional coefficient are simultaneously obtained for the convenience of comparison the results within half a circumference θ 0 π at the half length y l 2 of the bearing are selected shown in fig 4 the results in fig 4 a shows the fluid pressure increases with the circular angle ranges from 0 to π the highest point locates at about 3π 4 except for that of the case f at about π 4 as the effect of eccentricity angle is opposite and the amplitude of case d is the largest which indicates the influence of lubricant viscosity is the most significant it is also confirmed that the fluid pressure is more sensitive with the effect of eccentricity ratio as predicted in fig 2 meanwhile case b shows similar pressure with case a it proves the smallest impact of misalignment angle the maximal pressure of case c is found to be about twice of that of case a which indicates a multiple relationship between fluid pressure and rotational speed as showed in fig 2 it can be found in fig 4 b that the film thickness decreases slowly with increasing circular angle at the middle of the bearing length similar with the result in fig 3 the results of cases b and c are found to be much similar with that of case a which also means the weak influence of misalignment angle and rotational speed on the variation of film thickness while the results of case d and case e are much significant which demonstrates the film thickness is much sensitive with eccentricity ratio and lubricant viscosity both the load capacity in fig 4 c and misalignment moment in fig 4 e show a significant increases with the circular angle from 0 to 3π 4 and then decrease slightly and the variation can be observed to be much similar with the fluid pressure in fig 4 a this consistency of these three figures is because of the load capacity and misalignment moment are the integral of fluid pressure and other factors shown in eqs 8 and 10 while the load attitude angle in fig 4 d describes the variation with a periodic sine function form over a range of circular angle it can be observed that the angle changes from 40 to 180 in half a cycle the results in case d suffers largest angle variation and that of case f is the opposite in phase position comparing with the variation of load angle the variation of moment attitude angle in fig 4 f is much smaller with a range of less than one degree while the trend of variation for each impact factors is noticed to be same as fig 4 d fig 4 g shows the end leakage flow rate of all the six cases increases with circular angle from 0 to 3π 8 and then decreases gradually the influence of misalignment angle and rotational speed are more serious than other impact factors as the larger amplitude of cases b and c while the results in case e are noticed to be the same that of case a which proves that the independence of lubricant viscosity with the flow rate case a shows that the flow rate is slight smaller than that of case d and larger than that of case f it means the flow rate increases with the eccentricity ratio and decreases with the eccentricity angle among all the impact factors only the eccentricity angle has an effect of reducing the flow rate the frictional coefficient of above six cases are shown in fig 4 h it can be observed that the frictional coefficient decreases rapidly at the beginning of the circular angle and then trends to be zero very fast while the variation of case f is also the opposite with other cases the results of cases c and e are nearly same as that of case a that means the rotational speed and lubricant viscosity do not affect the frictional coefficient and the misalignment angle of case b shows significant influence on the friction property because of the largest amplitude among all the cases and the amplitude of case d is slight smaller than that of case a which means the frictional coefficient decrease with the eccentricity ratio among these impact factors the lubricant performance of the bearing can be noticed to be the most sensitive to the eccentricity ratio the hydrodynamic lubrication is found to be increased with growing rotational speed and misalignment angle and a linear relationship between the viscosity of the oil film and the lubricant performance can be observed the center line eccentricity angle can be found to affect the phase position instead of the amplitude of the hydrodynamic lubrication 3 3 discussion in general it can be concluded that the hydrodynamic lubrication of stern bearing closely relates to abovementioned impact factors the response including fluid pressure film thickness load capacity misalignment moment flow rate and frictional coefficient are affected by these factor in different degree the numerical calculation demonstrates the influence of single factor on the lubricated performance while it should be pointed out that the misalignment can be produced by the transverse vibration of the shaft and the misalignment angle is various with different rotational speed verma et al 2014 in practice the journal bearing experiences misalignment during operation due to increased loading condition on bearings in this case the misalignment angle is usually considerably higher than supplied which is essential to be taken into account boucherit et al 2008 in order to investigate the interaction of misalignment angle and rotational speed on the lubricated performance an experimental test is thus conducted on the basis of shaft experimental platform fig 5 a shows the platform mounted on the foundation is consist of main engine crankshaft propeller and shaft the shaft contains an intermediate shaft and a tail shaft with the hydraulic couplings connecting these two parts the tail shaft is supported by an oil lubricated stern bearing with hydraulic loading system besides the diameter and length of the shaft is about 0 075 m and 1 95 m respectively in order to minimize the deviation during the test and avoid shaft damage induced by excessive stresses a range of rotational speed of 100 150 200 250 and 300 rpm torsional detection instrument type b k 2523 and rotational speed sensor type b k mm0024 are considered and four cases including free condition middle shaft loading load 1 tail shaft loading load 2 middle tail shaft loading load 3 are defined the loading is applied by the hydraulic loading system fig 5 a which includes torque loading and force loading devices i e exciters the amplitude of the loading is obtained by the stress sensor and signal acquisition through the exciters in the process of experiment the data for transverse vibration is acquired with an acceleration sensor tri axial accelerometer sensor type b k 4535 b 001 located near the oil lubricated stern bearing a multichannel signal analyzer signal acquisition type pxie 4499 including servo amplifiers signal acquisition card and signal output device is used to collect the test data shown in fig 5 b the deformation of transverse vibration of the shaft with different loading conditions and rotational speed is shown in fig 6 huang 2017 it can be found that the transverse deformation increases with increasing rotational speed of the shaft which means the misalignment angle is enlarged with the rotational speed and comparing with the free condition the misalignment angle also increases with the effect of loading condition especially for the case of load 3 according to the relationship between transverse deformation and misalignment angle the misalignment angle can be obtained by 17 γ arctan z l where z is the transverse deformation and l is the length of the shaft detailed results listed in table 3 is the misalignment angle with various rotational speed and load condition the data for free condition is 2 5 10 3 3 4 10 3 4 8 10 3 7 3 10 3 and 9 8 10 3 degree with the rotational speed ranges from 100 to 300 rpm which seems to be linear relationship without considering the experimental deviation for the case of 100 rpm the misalignment angle is 2 5 10 3 3 1 10 3 4 2 10 3 and 3 9 10 3 degree with increasing loading conditions as the misalignment angle varies with rotational speed the interaction of these two impact factor will enlarge the lubricant performance of the bearing in this section the rotational speed and misalignment angle in table 3 are simultaneously considered for the investigation meanwhile the response of load capacity and misalignment moment are noticed to be similar with that of fluid pressure in order to simplify the calculation only the fluid pressure film thickness flow rate and frictional coefficient are analyzed and the maximal values of the half length y l 2 and a range of half cycle θ 0 π are selected for the comparison the results in fig 7 shows the maximal value of fluid pressure film thickness flow rate and frictional coefficient at the middle of bearing length over a range of half cycle the response with both rotational speed and misalignment angle is noticed to be enlarged in nonlinear as the rotational speed increased the pressure fig 7 a with the rotational speed changes from 100 to 300 rpm of free condition is 1 81 105 2 77 105 3 86 105 5 38 105 and 7 49 105 pa respectively similar results can be found for the results of film thickness fig 7 b flow rate fig 7 c and frictional coefficient fig 7 d it indicates a smaller increase for the lower speed and a larger increase for the higher speed not only that the pressure of the four cases is 1 81 105 1 83 105 1 89 105 and 1 87 105 pa with the rotational speed is 100 rpm it changes to 7 49 105 8 85 105 8 71 105 and 9 85 105 pa with 300 rpm that means the variation of pressure film thickness flow rate and frictional coefficient with larger misalignment angle grows faster than that of the lowers it demonstrated that a nonlinear response of the hydrodynamic lubrication can be induced by the interaction of rotational speed and misalignment angle it should be pointed out that the stiffness of friction pairs and the morphology of contact surface will also affect the lubricant performance these factors cause randomness and uncontrollability to the lubricant performance and beyond the consideration of theoretical definition meanwhile the observed results and revealed mechanism by the numerical calculation are not fully provided with universal the theoretical model proposed in this paper is qualitative as a result of introducing parameter assuming and model simplification nevertheless this research can provide a practicable tool for the response evaluation and optimal design of hydrodynamic lubrication of the marine propeller shaft 4 conclusion in this paper a theoretical model focusing on lubricant performance of stern bearing of the marine propeller shaft is proposed the hydrodynamic lubrication is investigated with centered finite difference method by solving the reynolds equation the lubricant performance is numerically calculated and the impact factors are respectively investigated moreover the interaction between rotational speed and misalignment angle is discussed on the basis of shaft vibration experiments and then considered in the model therefore a more suitable method considering abovementioned factors is proposed for marine engineers and designers as its ability of calculating the lubricate performance three further contributions of the present work can be given 1 the lubricant performance is closely related to the misalignment angle eccentricity ratio shaft rotational speed lubricant viscosity and center line eccentricity angle among these impact factors the influence of the eccentricity ratio is the most significant on the amplitude of the response 2 the response of fluid pressure film thickness load capacity and its attitude angle misalignment moment and its attitude angle end leakage flow rate and frictional coefficient increases with abovementioned impact factors except the center line eccentricity angle only affects the phase position 3 the misalignment angle of the bearing is variable with the rotational speed and load capacity of the shaft the interaction of these two impact factor can also enlarge the hydrodynamic lubrication it is therefore vital to not only consider the rotational speed but also to minimize the load condition during actual working process in summary the present work detailedly investigate the influence of abovementioned impact factors on the lubricant performance of stern bearing it is clearly demonstrated that the proposed numerical model and analytical techniques are feasible to be applied in the calculating of hydrodynamic lubrication a possible parameters range for fluid pressure and load capacity are presented to reduce abrasive wear of the bearing in future work the impact factors of temperature and bearing stiffness will be considered to increase service life credit authorship contribution statement qianwen huang conceptualization data curation formal analysis funding acquisition investigation methodology software validation writing original draft xinping yan project administration resources supervision visualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this research is supported by the national natural science foundation of china no 51809201 and the hubei provincial natural science foundation of china no 2018cfb371 
21513,this paper employs experimental methods to predict speed power rpm relationship along with resistance and propulsion characteristics in regular head waves with varying wave lengths and steepness ratios the objective ship is kvlcc2 the resistance and self propulsion tests in calm water and in waves have been conducted the self propulsion point in waves changes to increase propeller revolution thrust and torque with wave steepness the added propeller revolution thrust torque and delivered power due to waves increase with wave steepness and are not simply proportional to the square of the wave amplitude which are similar tendencies to the added resistance the thrust deduction and wake fraction propeller advance coefficient hull propeller open water relative rotative and propulsive efficiencies due to waves decrease with wave steepness the effects of ship speed and delivered power in waves on the propulsive performances have been looked into the wave conditions are the regular head waves of λ lpp 0 6 and 1 0 with three wave steepness ratios at three ship speeds of 13 5 14 5 and 15 5 knots design speed in the case of λ lpp 0 6 at design speed two more wave steepness ratios have been used keywords speed power rpm power increase speed loss propulsive performances regular head waves model test nomenclature alphabetical symbols b ship breadth caw added resistance coefficient in waves r a w ρ g ζ a 2 b 2 l p p cf frictional resistance coefficient non dimensionlized by ρ s 0 v 2 0 075 l o g 10 r n 2 2 cnaw added propeller revolution coefficient in waves n a w v d p 3 g ζ a 2 b 2 l p p cpdaw added delivered power coefficient in waves p d a w ρ g 1 5 ζ a 2 b 2 l p p cqaw added torque coefficient in waves q a w ρ g ζ a 2 d p b 2 l p p cr residual resistance coefficient in calm water non dimensionlized by ρ s 0 v 2 ct total resistance coefficient in calm water non dimensionlized by ρ s 0 v 2 ctaw added thrust coefficient in waves t a w ρ g ζ a 2 b 2 l p p dp diameter of propeller fd viscous force difference between model and ship scale fn froude number v g l p p g gravitational constant 9 81 m s2 gm metacentric height h wave height j propeller advance coefficient v a n d p k a wave number b form factor c hull roughness k spring constant kg distance from the keel to the center of gravity km gm km distance from the keel to the metacenter kyy moment of inertia lcb longitudinal center of buoyancy forward of midship lcg longitudinal center of gravity forward of midship lpp length between perpendiculars lwl length at waterline n propeller revolution pd delivered power 2 π n q q propeller torque rn reynolds number v l p p ν rpm a propeller revolution b revolution per minute rt total resistance s0 wetted surface area in calm water t thrust deduction fraction 1 r t t t a draft b period c propeller thrust tf towing force r t m s p t m v ship speed va advance speed w wake fraction 1 introduction the power of ocean going ship increases to maintain constant ship speed or the ship speed would involuntarily decrease at constant power the prediction of power increase or speed loss is essential to design the hull form to analyze speed sea trial tests to estimate the weather factor in energy efficiency design index eedi formula mepc 66 21 annex 5 2014 fuel consumption and sea margin and to find the optimal seaway route for eco operation speed losses are usually categorized as voluntary or involuntary faltinsen et al 1980 the former occurs when the ship master actively reduces the ship speed to avoid damage danger or severe discomfort the latter arises because of the added resistance due to wind wave water temperature roughness or fouling rudder angle drift angle etc this involuntary speed loss is included in the sea margin the sea margin has a typical value of between 15 30 of the ship power in calm water man and turbo 2012 much research has been performed to predict the raw by computational or experimental methods the raw is due to the effects of radiation and diffraction and their interaction the first is caused by the radiation waves due to ship motions which is dominant in the range of longer wavelength the second is caused by the diffraction waves at the bow which is dominant in the range of shorter wavelength gerritsma and beukelman 1972 proposed added resistance coefficient in waves caw using quadratic wave amplitude however raw does not show quadratic dependency as the wave steepness ratio h λ increases the quadratic dependency becomes weaker liu and papanikolaou 2011 yasukawa et al 2016 kim et al 2017a b 2019 lee et al 2017 2019 yu et al 2017 the self propulsion tests in waves have been performed to predict propulsive performances by computational http www t2015 nmri go jp lee et al 2019 or experimental nakamura and naito 1975 journee 1976 kayano et al 2013 taskar et al 2016 methods the propeller open water pow characteristic curves in calm water have been used for those in waves since the time averaged values of pow in waves are the same as those in calm water as long as the propeller is sufficiently submerged to avoid aeration effects mccarthy et al 1961 nakamura and naito 1975 at constant ship speed condition in waves resistance propeller revolution thrust and torque increase to balance the over loaded propeller journee 1976 lee et al 2019 thus the propulsion point in waves will change consequently thrust deduction and wake fraction hull efficiency propeller advance coefficient pow relative rotative and propulsive efficiencies change hence delivered power increases more rapidly due not only to the increased added resistance but also to the decrease in the propulsive efficiency kayano et al 2013 taskar et al 2016 lee et al 2019 at constant power condition in waves resistance thrust and torque are scarcely varied and the propeller revolution slightly decreases consequently thrust deduction and wake fraction and hull efficiency remain practically unchanged and the propeller advance coefficient propeller open water relative rotative and propulsive efficiencies and ship speed significantly decrease lee et al 2019 a closer inspection of literature indicates however that a comprehensive experimental account of the power increase and speed loss in waves has scarcely been reported this can be attributed to the complexity of self propulsion tests in waves with a view to providing a benchmark data for indirect prediction of power increase and speed loss in waves a series of resistance pow and self propulsion tests for kvlcc2 both in calm water hereinafter called as calm water tests and in regular head waves hereinafter called as wave tests have been conducted in this paper power increase to maintain constant ship speed and speed and rpm losses at constant power condition due to waves are analyzed the added resistance propeller revolution thrust torque and delivered power in waves have been investigated the propulsive characteristics of thrust deduction and the wake fraction propeller advance coefficient hull pow relative rotative and propulsive efficiencies in waves also have been investigated the effects of ship speed wave steepness and delivered power in waves on the propulsive performances have been looked into test conditions are the regular head waves of λ lpp 0 6 and 1 0 with three wave steepness ratios at 3 model speeds corresponding to ship speeds of 13 5 14 5 and 15 5 knots design speed in the case of λ lpp 0 6 at design speed two more wave steepness ratios are used greek symbols δcf roughness allowance coefficient 105 k s l w l 1 3 0 64 10 3 δpd power increase due to waves to maintain ship speed constant p d w p d c δrpm rpm loss due to waves at constant power n c n w δv speed loss due to waves at constant power v c v w ζ wave elevation ηd propulsive efficiency p e p d η r η o η h ηh hull efficiency 1 t 1 w ηo pow efficiency j 0 2 π k t 0 k q 0 ηr relative rotative efficiency q 0 q λ a wave length b scale ratio l p p s l p p m ν fluid kinematic viscosity ξi translatory and angular displacements in x y and z directions i 1 surge 3 heave 5 pitch ρ fluid density ϕaw added ϕ due to waves ϕ w ϕ c to maintain ship speed constant where ϕ j n pd q r t t w ηd ηh ηo ηr ϕ c percentage ratio of ϕ in waves to ϕ in calm water where ϕ δrpm δpd δv ωe encounter wave frequency displacement volume subscripts m model scale s ship scale superscripts c calm water sp self propulsion w waves 2 objective ship the objective ship is the kriso very large crude oil carrier kvlcc2 which was designed by the korea research institute for ship and ocean engineering kriso to provide data for both the explication of flow physics and cfd validation for the modern 300 k dwt tanker with bulbous bow and stern van et al 1998 no full scale ships exist the principal dimensions of kvlcc2 at the full load draft and propeller kp458 are listed in table 1 the design speed is 15 5 knots corresponding to vm 1 047 m s in which fn 0 142 and rnm 7 11 106 the kyy has not been adjusted in this experiments the body plans and side view of the kvlcc2 are presented in fig 1 3 experimental method model tests have been performed in calm water and in regular head waves in the towing tank of pusan national university which has dimensions of 100 m 8 m x 3 5 m length x width x depth it is also equipped with 24 snake type wave maker which generate 2 dimensional regular and irregular waves up to 50 350 mm wave height and wave length of 0 6 12 0 m the dimension of the snake is 1 24 m 0 33 m x 2 82 m length x breadth x depth the wave absorber of a small fixed grid iron beach type is located at the basin s end the wave absorbers on the side walls have been removed to eliminate disturbing waves during the resistance tests neither rudder nor appendage is fitted to the model ship a pow test in waves has not been carried out load variation method is applied for the self propulsion tests the wave conditions are regular head waves of λ lpp 0 6 and 1 0 with three wave steepness ratios at three model speeds those are h λ 0 008 0 011 and 0 017 for the λ lpp 0 6 and h λ 0 004 0 008 and 0 011 for the λ lpp 1 0 in the case of λ lpp 0 6 at design speed two more h λ 0 024 and 0 032 are used the wave heights of λ 192 0 m λ lpp 0 6 are 1 54 2 11 3 26 4 61 and 6 14 m at ship scale these correspond to the beaufort number bn 4 5 6 7 and 8 respectively if these are taken into account as the significant wave heights in irregular waves the wave heights 4 61 and 6 14 m are supplemented at the design speed to investigate the wave steepness effect even though they are adverse weather conditions 3 1 set up of the model tests the encounter wave elevation resistance or towing force propeller revolution thrust and torque and vertical displacement at forward perpendicular fp and after perpendicular ap have been measured using a wave probe a resistance dynamometer thrust and torque dynamometer and laser displacement meters respectively their specifications are listed in table 2 the same dynamometers are used in calm water tests and wave tests the linearity hysteresis and repeatability of the resistance thrust and torque dynamometers are less than 0 03 0 5 of the wave prove and 0 2 of the laser displacement meters the device for free to surge test and the experimental setup are presented in fig 2 the model is connected to the towing carriage by the resistance dynamometer on the free to pitch gimbal which allows pitch motion a heave rod allows the model to heave the model ship is allowed to be free or fixed in surge motion while it is free to heave and pitch and fixed in sway yaw and roll motions the surge motion can be fixed using a surge lock the model is also connected to the carriage by yaw guides at the fore and aft perpendiculars the yaw guides allow heave and pitch motions but keep the model fixed from sway yaw and roll motions details are well described in yu et al 2017 the towing point is located at lcg 0 kg the kg km gm is distance between km and gm where gm is obtained from an inclining test the model is towed with the device for free to surge test connected beneath the towing carriage by a spring system using the spring system the dynamometer avoids being overloaded due to carriage speed variations the surge motion is free during the resistance tests while suppressed during the self propulsion tests during the resistance tests in waves an external force which is the same as the total resistance in calm water is used to avoid large stretches of the spring where k 127 4 n m it is also needed to restrict the natural period of surge motion tn to avoid an overlap between the surge resonance frequency and wave encounter frequency the tn is measured with a decay test the measured tn 22 3 s is not close to the wave encounter periods used in the test of 1 00 and 1 39 s 3 2 wave maker calibration the waves are calibrated at the beginning of the experiment which ensures that the short waves are stable and extracts low frequency noises in the towing tank wave probes of capacitance type have been used the wave probe is placed 30 m ahead of the wave maker near the side wall of the towing tank the calibration results of the wave maker for the incoming regular waves are listed in table 3 λ i and ζa i are the percentage ratios of measured values to the input 3 3 side wall effect the model advancing speed vm generates radiated and diffracted waves the former is generated by the ship motions and the latter is reflected by the model these waves are reflected by the side walls as shown in fig 3 a 1 u c r i t l m c g 2 b t l m b t g 2 ω e where lm is model length bt tank breadth and cg g ω e wave group velocity the solid line in fig 3 b expresses maximum frequency at which side wall interference occurs in head waves ittc 2011 the values of fn ωe lm g 1 2 are 0 407 0 673 at bt lm 1 45 which are above the maximum frequency of 0 313 thus there exists no side wall effect in the experiments 3 4 data filtering and analysis the measured data are filtered using the moving average filter maf method to remove the higher frequency noise the maf does not utilize an averaged value of all the data but only the designated data 2 i 1 m j 0 m 1 j i where m is the number points in the average the data acquisition sampling rate is 200 hz and m is 16 therefore the cut off frequency is 12 5 hz fig 4 displays an example of the measured and filtered data using a maf for the towing force thrust and torque in waves during self propulsion test at vm 0 912 m s and nm 9 667 rps in the case of λ 5 50 m λ lpp 0 996 and ζa 0 021 m h λ 0 008 the amplitude of the tf is larger than those of the tm and qm since a fixed in surge test is conducted the time history of the filtered data for the encounter wave elevation resistance or towing force sinkage trim thrust and torque are analyzed using fourier series fs each unsteady history t can be expanded into the sum of fourier series 3 t 0 2 n 1 n n cos ω e n t γ n n 1 2 3 where n is the nth harmonic amplitude and γ n is the corresponding phase their values can be obtained by following equations 4 n a n 2 b n 2 5 γ n t a n 1 b n a n i f b n 0 t a n 1 b n a n π i f b n 0 in which 6 a n 2 t 0 t t cos ω e n t d t 7 b n 2 t 0 t t sin ω e n t d t the 0th harmonic amplitude 0 is the averaged value of the time history of t the 1st fs harmonics 1 stands for the linear term of the unsteady histories the nth fs harmonics n n 2 stand for the non linear terms of the unsteady histories the larger the amplitudes are the more non linear the problem is the 0 denotes rtm w or tf sinkage and trim nm w tm w and qm w the 1 denotes heave amplitude ξ3 and pitch amplitude ξ5 4 results the revised ittc 78 method based on the thrust identity is utilized to predict resistance and propulsion performances at ship scale ittc 2008 the pow characteristic curves in calm water are used for those in waves 4 1 calm water tests the form factor 1 k of 1 258 is used which is determined from the resistance tests at low speed region ittc 2002 the cts without bilge keels is ittc 2008 8 c t s 1 k c f s δ c f c a c r c a a s here ca correlation allowance and caas air resistance coefficient are not taken into account the self propulsion tests in calm water are conducted at 5 carriage speeds for each speed the propeller revolutions are varied widely to cover 4 loadings including the self propulsion point at model scale the towing force tf is zero at the self propulsion point at ship scale however the tf should be corrected by the viscous force difference between model and ship scale fd 9 f d 1 2 ρ m s 0 m v m 2 1 k c f m c f s δ c f the cf is obtained from the ittc 1957 model ship correlation line and the δcf is roughness allowance coefficient the nm tm and qm at a self propulsion point are obtained by reading off those of the self propulsion tests at the fd which is displayed as process a in fig 5 resistance and propulsion performances at various ship speeds in calm water are summarized in table 4 4 2 wave tests three carriage speeds of vm 0 91 0 99 and 1 05 m s corresponding to vs 13 5 14 5 and 15 5 knots are used when testing in waves there is no propeller out of water the effects of λ lpp at design speed and h λ for various speeds on the non dimensional values of raw caw heave ξ3 ζa and pitch ξ5 kζa amplitudes are displayed in fig 6 the caw is based on the square of wave amplitude as described in the nomenclature the caw ξ3 ζa and ξ5 kζa for λ lpp at the design speed are similar to those of other works hwang et al 2013 sadat hosseini et al 2013 kim et al 2017a b lee et al 2017 yu et al 2017 the solid line of fig 6 a and dashed line of fig 6 b present results of potential flow solver combined with empirical formula of the modified fujii and takahashi s formula yu et al 2017 the ξ3 ζa and ξ5 kζa are nearly constant that is those are linear with h λ for caw the effect of h λ exists if the raw has quadratic dependence on wave amplitude the caw should be constant for the h λ however the caw does not show the quadratic dependency for constant λ lpp as discussed in other works liu and papanikolaou 2011 yasukawa et al 2016 kim et al 2017a b 2019 lee et al 2017 2019 yu et al 2017 for smaller h λ range h λ 0 01 caw rapidly decreases for higher h λ range h λ 0 015 caw decreases slowly the self propulsion tests in waves are conducted at 3 carriage speeds for each speed the propeller revolutions are varied widely to cover 3 loadings around the self propulsion point the fd in waves is assumed to be the same as that in calm water fdw fdc fd since the wetted surface area of a full slow ship in waves is nearly same as that in calm water the values of the nm tm and qm in waves are obtained by reading off the fd which is displayed as process b in fig 5 the self propulsion point in waves changes to balance the over loaded propeller consequently the nm tm and qm increase fig 7 displays rtm fd versus propeller revolution thrust and torque in waves at the self propulsion point the rtm fd is adopted since the viscous effect between ship and model scale is taken into account the propeller revolution nm w thrust tm w and torque qm w in waves increase as rtm w fd increases to balance over loaded propeller fig 7 a shows that nm w is not a linear function of rtm w fd and decreases as the h λ increases at constant rtm w fd fig 7 b and c show that tm w and qm w are linear functions of rtm w fd thus t in waves tm w is unchanged at constant rtm w fd as shown in eq 10 10 t m w 1 r t m w f d t m w the naw taw qaw and pdaw are the differences between the n t q pd in waves and those in calm water at the same ship speed respectively the effect of h λ on the non dimensional values of naw taw qaw and pdaw at model scale are displayed in fig 8 cnaw ctaw cqaw and cpdaw respectively those definitions are described in the nomenclature which are based on the square of wave amplitude these show similar tendencies with the caw as shown in fig 6 for smaller h λ range h λ 0 01 cnaw ctaw cqaw and cpdaw rapidly decreases for higher h λ range h λ 0 015 cnaw ctaw cqaw and cpdaw decreases slowly fig 9 displays the resistance and propulsion characteristics versus ship speed in calm water and in waves at constant ship speed the rts w increases due to the raws fig 9 a thus the ns w ts w and qs w increase to balance the over loaded propeller as shown in fig 5 at model scale fig 9 b c d then the pds w 2π ns w qs w increases fig 9 e the power increase due to waves can be estimated from fig 9 e the ts w 1 rts w ts w decreases with increasing the rts w although ts w also increases the increasing rate of rts w is greater than that of ts w fig 9 f the ws w also decreases with similar tendency to the ts w fig 9 g thus the ηhs w 1 ts w 1 ws w decreases with decreasing the ws w although the ts w also decreases the rate of decreasing ws w is greater than that of ts w fig 9 h the js w vs 1 ws w ns w dps decreases with increasing ns w although the ws w decreases fig 9 i thus the ηos w decreases with the same tendency as the js w fig 9 j the ηrs w q0s w qs w where the subscript 0 denotes open water decreases with increasing qs w fig 9 k the ηds w consequently decreases due to the reduced ηhs w ηos w and ηrs w fig 9 l thus the delivered power rapidly increases to maintain the constant ship speed due to the increased rts w and the decreased ηds w pd rts vs ηh fig 10 shows the effect of wave steepness on the resistance and propulsion performances in waves at ship scale the caw ctaw cqaw cnaw and cpdaw at ship scale show similar tendencies as those at model scale which are shown in figs 6 and 8 the added propulsive performances due to waves taw waw ηhaw jaw ηoaw ηraw and ηdaw rapidly decrease for smaller h λ range h λ 0 015 and decreases slowly for higher h λ range h λ 0 015 to know these characteristics at constant delivered power it is necessary to investigate the resistance and propulsion characteristics versus delivered power in waves as displayed in fig 11 the ship speed in waves significantly decreases fig 11 a the speed loss due to waves can be estimated from fig 11 a the rts w ns w ts w and qs w increase almost linearly as pds w increases fig 11 b c d e the rts and ts slightly increase fig 11 b d and ns slightly decreases in waves fig 11 c at constant delivered power the rpm loss due to waves can be estimated from fig 11 c the ts w ws w ηhs w and ηrs w decrease almost linearly as pds w increases fig 11 f g h k the js w va n dp significantly decreases due to the speed loss in waves fig 11 i the ηos w shows similar tendency as js w fig 11 j consequently the ηds w significantly decreases which is mainly due to the decreasing ηos w fig 11 l the speed power rpm relationship in calm water and in regular head waves is shown in fig 12 the ship speed and propeller revolution at pd 20 026 kw which are within interpolation region are also displayed power increase at vs 15 5 knots and speed and rpm losses at pd 20 026 kw in the interpolation region are listed in table 5 the grey content denotes extrapolation region where the waves are in adverse weather conditions 5 conclusions the resistance and propulsion characteristics in regular head waves of kvlcc2 have been predicted utilizing experimental method the effects of ship speed and wave steepness ratio are as follows the total resistance propeller revolution thrust torque delivered power propeller advance coefficient and propeller open water efficiency in waves increase as ship speed increases the thrust deduction and wake fraction hull efficiency relative rotative and propulsive efficiencies in waves decrease as ship speed increases at constant ship speed the self propulsion point in waves changes to increase propeller revolution thrust and torque with wave steepness the added propeller revolution thrust torque and delivered power due to waves increase with wave steepness and are not simply proportional to the square of the wave amplitude which are similar tendencies to the added resistance for smaller h λ range h λ 0 01 cnaw ctaw cqaw and cpdaw rapidly decreases for higher h λ range h λ 0 015 cnaw ctaw cqaw and cpdaw decreases slowly the thrust deduction and wake fraction hull efficiency propeller advance coefficient propeller open water relative rotative and propulsive efficiencies decrease with wave steepness the effects of delivered power are as follows the ship speed total resistance propeller revolutions thrust torque propeller advance coefficient and propeller open water efficiency in waves increase as delivered power increases the thrust deduction and wake fraction hull relative rotative and propulsive efficiencies in waves decrease as delivered power increases at constant delivered power the ship speed in waves significantly decreases the propeller revolution in waves slightly decreases the propulsive efficiency in waves significantly decreases which is mainly due to the decreasing propeller open water efficiency credit authorship contribution statement jin hyeok seo data curation resources investigation cheol min lee formal analysis jin won yu methodology visualization jung eun choi conceptualization validation writing original draft inwon lee conceptualization writing review editing funding acquisition supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national research foundation of korea nrf grant funded by the korean government msit through gcrc sop no 2011 0030013 and the ministry of trade industry and energy no 20007847 to which deep gratitude is expressed 
21513,this paper employs experimental methods to predict speed power rpm relationship along with resistance and propulsion characteristics in regular head waves with varying wave lengths and steepness ratios the objective ship is kvlcc2 the resistance and self propulsion tests in calm water and in waves have been conducted the self propulsion point in waves changes to increase propeller revolution thrust and torque with wave steepness the added propeller revolution thrust torque and delivered power due to waves increase with wave steepness and are not simply proportional to the square of the wave amplitude which are similar tendencies to the added resistance the thrust deduction and wake fraction propeller advance coefficient hull propeller open water relative rotative and propulsive efficiencies due to waves decrease with wave steepness the effects of ship speed and delivered power in waves on the propulsive performances have been looked into the wave conditions are the regular head waves of λ lpp 0 6 and 1 0 with three wave steepness ratios at three ship speeds of 13 5 14 5 and 15 5 knots design speed in the case of λ lpp 0 6 at design speed two more wave steepness ratios have been used keywords speed power rpm power increase speed loss propulsive performances regular head waves model test nomenclature alphabetical symbols b ship breadth caw added resistance coefficient in waves r a w ρ g ζ a 2 b 2 l p p cf frictional resistance coefficient non dimensionlized by ρ s 0 v 2 0 075 l o g 10 r n 2 2 cnaw added propeller revolution coefficient in waves n a w v d p 3 g ζ a 2 b 2 l p p cpdaw added delivered power coefficient in waves p d a w ρ g 1 5 ζ a 2 b 2 l p p cqaw added torque coefficient in waves q a w ρ g ζ a 2 d p b 2 l p p cr residual resistance coefficient in calm water non dimensionlized by ρ s 0 v 2 ct total resistance coefficient in calm water non dimensionlized by ρ s 0 v 2 ctaw added thrust coefficient in waves t a w ρ g ζ a 2 b 2 l p p dp diameter of propeller fd viscous force difference between model and ship scale fn froude number v g l p p g gravitational constant 9 81 m s2 gm metacentric height h wave height j propeller advance coefficient v a n d p k a wave number b form factor c hull roughness k spring constant kg distance from the keel to the center of gravity km gm km distance from the keel to the metacenter kyy moment of inertia lcb longitudinal center of buoyancy forward of midship lcg longitudinal center of gravity forward of midship lpp length between perpendiculars lwl length at waterline n propeller revolution pd delivered power 2 π n q q propeller torque rn reynolds number v l p p ν rpm a propeller revolution b revolution per minute rt total resistance s0 wetted surface area in calm water t thrust deduction fraction 1 r t t t a draft b period c propeller thrust tf towing force r t m s p t m v ship speed va advance speed w wake fraction 1 introduction the power of ocean going ship increases to maintain constant ship speed or the ship speed would involuntarily decrease at constant power the prediction of power increase or speed loss is essential to design the hull form to analyze speed sea trial tests to estimate the weather factor in energy efficiency design index eedi formula mepc 66 21 annex 5 2014 fuel consumption and sea margin and to find the optimal seaway route for eco operation speed losses are usually categorized as voluntary or involuntary faltinsen et al 1980 the former occurs when the ship master actively reduces the ship speed to avoid damage danger or severe discomfort the latter arises because of the added resistance due to wind wave water temperature roughness or fouling rudder angle drift angle etc this involuntary speed loss is included in the sea margin the sea margin has a typical value of between 15 30 of the ship power in calm water man and turbo 2012 much research has been performed to predict the raw by computational or experimental methods the raw is due to the effects of radiation and diffraction and their interaction the first is caused by the radiation waves due to ship motions which is dominant in the range of longer wavelength the second is caused by the diffraction waves at the bow which is dominant in the range of shorter wavelength gerritsma and beukelman 1972 proposed added resistance coefficient in waves caw using quadratic wave amplitude however raw does not show quadratic dependency as the wave steepness ratio h λ increases the quadratic dependency becomes weaker liu and papanikolaou 2011 yasukawa et al 2016 kim et al 2017a b 2019 lee et al 2017 2019 yu et al 2017 the self propulsion tests in waves have been performed to predict propulsive performances by computational http www t2015 nmri go jp lee et al 2019 or experimental nakamura and naito 1975 journee 1976 kayano et al 2013 taskar et al 2016 methods the propeller open water pow characteristic curves in calm water have been used for those in waves since the time averaged values of pow in waves are the same as those in calm water as long as the propeller is sufficiently submerged to avoid aeration effects mccarthy et al 1961 nakamura and naito 1975 at constant ship speed condition in waves resistance propeller revolution thrust and torque increase to balance the over loaded propeller journee 1976 lee et al 2019 thus the propulsion point in waves will change consequently thrust deduction and wake fraction hull efficiency propeller advance coefficient pow relative rotative and propulsive efficiencies change hence delivered power increases more rapidly due not only to the increased added resistance but also to the decrease in the propulsive efficiency kayano et al 2013 taskar et al 2016 lee et al 2019 at constant power condition in waves resistance thrust and torque are scarcely varied and the propeller revolution slightly decreases consequently thrust deduction and wake fraction and hull efficiency remain practically unchanged and the propeller advance coefficient propeller open water relative rotative and propulsive efficiencies and ship speed significantly decrease lee et al 2019 a closer inspection of literature indicates however that a comprehensive experimental account of the power increase and speed loss in waves has scarcely been reported this can be attributed to the complexity of self propulsion tests in waves with a view to providing a benchmark data for indirect prediction of power increase and speed loss in waves a series of resistance pow and self propulsion tests for kvlcc2 both in calm water hereinafter called as calm water tests and in regular head waves hereinafter called as wave tests have been conducted in this paper power increase to maintain constant ship speed and speed and rpm losses at constant power condition due to waves are analyzed the added resistance propeller revolution thrust torque and delivered power in waves have been investigated the propulsive characteristics of thrust deduction and the wake fraction propeller advance coefficient hull pow relative rotative and propulsive efficiencies in waves also have been investigated the effects of ship speed wave steepness and delivered power in waves on the propulsive performances have been looked into test conditions are the regular head waves of λ lpp 0 6 and 1 0 with three wave steepness ratios at 3 model speeds corresponding to ship speeds of 13 5 14 5 and 15 5 knots design speed in the case of λ lpp 0 6 at design speed two more wave steepness ratios are used greek symbols δcf roughness allowance coefficient 105 k s l w l 1 3 0 64 10 3 δpd power increase due to waves to maintain ship speed constant p d w p d c δrpm rpm loss due to waves at constant power n c n w δv speed loss due to waves at constant power v c v w ζ wave elevation ηd propulsive efficiency p e p d η r η o η h ηh hull efficiency 1 t 1 w ηo pow efficiency j 0 2 π k t 0 k q 0 ηr relative rotative efficiency q 0 q λ a wave length b scale ratio l p p s l p p m ν fluid kinematic viscosity ξi translatory and angular displacements in x y and z directions i 1 surge 3 heave 5 pitch ρ fluid density ϕaw added ϕ due to waves ϕ w ϕ c to maintain ship speed constant where ϕ j n pd q r t t w ηd ηh ηo ηr ϕ c percentage ratio of ϕ in waves to ϕ in calm water where ϕ δrpm δpd δv ωe encounter wave frequency displacement volume subscripts m model scale s ship scale superscripts c calm water sp self propulsion w waves 2 objective ship the objective ship is the kriso very large crude oil carrier kvlcc2 which was designed by the korea research institute for ship and ocean engineering kriso to provide data for both the explication of flow physics and cfd validation for the modern 300 k dwt tanker with bulbous bow and stern van et al 1998 no full scale ships exist the principal dimensions of kvlcc2 at the full load draft and propeller kp458 are listed in table 1 the design speed is 15 5 knots corresponding to vm 1 047 m s in which fn 0 142 and rnm 7 11 106 the kyy has not been adjusted in this experiments the body plans and side view of the kvlcc2 are presented in fig 1 3 experimental method model tests have been performed in calm water and in regular head waves in the towing tank of pusan national university which has dimensions of 100 m 8 m x 3 5 m length x width x depth it is also equipped with 24 snake type wave maker which generate 2 dimensional regular and irregular waves up to 50 350 mm wave height and wave length of 0 6 12 0 m the dimension of the snake is 1 24 m 0 33 m x 2 82 m length x breadth x depth the wave absorber of a small fixed grid iron beach type is located at the basin s end the wave absorbers on the side walls have been removed to eliminate disturbing waves during the resistance tests neither rudder nor appendage is fitted to the model ship a pow test in waves has not been carried out load variation method is applied for the self propulsion tests the wave conditions are regular head waves of λ lpp 0 6 and 1 0 with three wave steepness ratios at three model speeds those are h λ 0 008 0 011 and 0 017 for the λ lpp 0 6 and h λ 0 004 0 008 and 0 011 for the λ lpp 1 0 in the case of λ lpp 0 6 at design speed two more h λ 0 024 and 0 032 are used the wave heights of λ 192 0 m λ lpp 0 6 are 1 54 2 11 3 26 4 61 and 6 14 m at ship scale these correspond to the beaufort number bn 4 5 6 7 and 8 respectively if these are taken into account as the significant wave heights in irregular waves the wave heights 4 61 and 6 14 m are supplemented at the design speed to investigate the wave steepness effect even though they are adverse weather conditions 3 1 set up of the model tests the encounter wave elevation resistance or towing force propeller revolution thrust and torque and vertical displacement at forward perpendicular fp and after perpendicular ap have been measured using a wave probe a resistance dynamometer thrust and torque dynamometer and laser displacement meters respectively their specifications are listed in table 2 the same dynamometers are used in calm water tests and wave tests the linearity hysteresis and repeatability of the resistance thrust and torque dynamometers are less than 0 03 0 5 of the wave prove and 0 2 of the laser displacement meters the device for free to surge test and the experimental setup are presented in fig 2 the model is connected to the towing carriage by the resistance dynamometer on the free to pitch gimbal which allows pitch motion a heave rod allows the model to heave the model ship is allowed to be free or fixed in surge motion while it is free to heave and pitch and fixed in sway yaw and roll motions the surge motion can be fixed using a surge lock the model is also connected to the carriage by yaw guides at the fore and aft perpendiculars the yaw guides allow heave and pitch motions but keep the model fixed from sway yaw and roll motions details are well described in yu et al 2017 the towing point is located at lcg 0 kg the kg km gm is distance between km and gm where gm is obtained from an inclining test the model is towed with the device for free to surge test connected beneath the towing carriage by a spring system using the spring system the dynamometer avoids being overloaded due to carriage speed variations the surge motion is free during the resistance tests while suppressed during the self propulsion tests during the resistance tests in waves an external force which is the same as the total resistance in calm water is used to avoid large stretches of the spring where k 127 4 n m it is also needed to restrict the natural period of surge motion tn to avoid an overlap between the surge resonance frequency and wave encounter frequency the tn is measured with a decay test the measured tn 22 3 s is not close to the wave encounter periods used in the test of 1 00 and 1 39 s 3 2 wave maker calibration the waves are calibrated at the beginning of the experiment which ensures that the short waves are stable and extracts low frequency noises in the towing tank wave probes of capacitance type have been used the wave probe is placed 30 m ahead of the wave maker near the side wall of the towing tank the calibration results of the wave maker for the incoming regular waves are listed in table 3 λ i and ζa i are the percentage ratios of measured values to the input 3 3 side wall effect the model advancing speed vm generates radiated and diffracted waves the former is generated by the ship motions and the latter is reflected by the model these waves are reflected by the side walls as shown in fig 3 a 1 u c r i t l m c g 2 b t l m b t g 2 ω e where lm is model length bt tank breadth and cg g ω e wave group velocity the solid line in fig 3 b expresses maximum frequency at which side wall interference occurs in head waves ittc 2011 the values of fn ωe lm g 1 2 are 0 407 0 673 at bt lm 1 45 which are above the maximum frequency of 0 313 thus there exists no side wall effect in the experiments 3 4 data filtering and analysis the measured data are filtered using the moving average filter maf method to remove the higher frequency noise the maf does not utilize an averaged value of all the data but only the designated data 2 i 1 m j 0 m 1 j i where m is the number points in the average the data acquisition sampling rate is 200 hz and m is 16 therefore the cut off frequency is 12 5 hz fig 4 displays an example of the measured and filtered data using a maf for the towing force thrust and torque in waves during self propulsion test at vm 0 912 m s and nm 9 667 rps in the case of λ 5 50 m λ lpp 0 996 and ζa 0 021 m h λ 0 008 the amplitude of the tf is larger than those of the tm and qm since a fixed in surge test is conducted the time history of the filtered data for the encounter wave elevation resistance or towing force sinkage trim thrust and torque are analyzed using fourier series fs each unsteady history t can be expanded into the sum of fourier series 3 t 0 2 n 1 n n cos ω e n t γ n n 1 2 3 where n is the nth harmonic amplitude and γ n is the corresponding phase their values can be obtained by following equations 4 n a n 2 b n 2 5 γ n t a n 1 b n a n i f b n 0 t a n 1 b n a n π i f b n 0 in which 6 a n 2 t 0 t t cos ω e n t d t 7 b n 2 t 0 t t sin ω e n t d t the 0th harmonic amplitude 0 is the averaged value of the time history of t the 1st fs harmonics 1 stands for the linear term of the unsteady histories the nth fs harmonics n n 2 stand for the non linear terms of the unsteady histories the larger the amplitudes are the more non linear the problem is the 0 denotes rtm w or tf sinkage and trim nm w tm w and qm w the 1 denotes heave amplitude ξ3 and pitch amplitude ξ5 4 results the revised ittc 78 method based on the thrust identity is utilized to predict resistance and propulsion performances at ship scale ittc 2008 the pow characteristic curves in calm water are used for those in waves 4 1 calm water tests the form factor 1 k of 1 258 is used which is determined from the resistance tests at low speed region ittc 2002 the cts without bilge keels is ittc 2008 8 c t s 1 k c f s δ c f c a c r c a a s here ca correlation allowance and caas air resistance coefficient are not taken into account the self propulsion tests in calm water are conducted at 5 carriage speeds for each speed the propeller revolutions are varied widely to cover 4 loadings including the self propulsion point at model scale the towing force tf is zero at the self propulsion point at ship scale however the tf should be corrected by the viscous force difference between model and ship scale fd 9 f d 1 2 ρ m s 0 m v m 2 1 k c f m c f s δ c f the cf is obtained from the ittc 1957 model ship correlation line and the δcf is roughness allowance coefficient the nm tm and qm at a self propulsion point are obtained by reading off those of the self propulsion tests at the fd which is displayed as process a in fig 5 resistance and propulsion performances at various ship speeds in calm water are summarized in table 4 4 2 wave tests three carriage speeds of vm 0 91 0 99 and 1 05 m s corresponding to vs 13 5 14 5 and 15 5 knots are used when testing in waves there is no propeller out of water the effects of λ lpp at design speed and h λ for various speeds on the non dimensional values of raw caw heave ξ3 ζa and pitch ξ5 kζa amplitudes are displayed in fig 6 the caw is based on the square of wave amplitude as described in the nomenclature the caw ξ3 ζa and ξ5 kζa for λ lpp at the design speed are similar to those of other works hwang et al 2013 sadat hosseini et al 2013 kim et al 2017a b lee et al 2017 yu et al 2017 the solid line of fig 6 a and dashed line of fig 6 b present results of potential flow solver combined with empirical formula of the modified fujii and takahashi s formula yu et al 2017 the ξ3 ζa and ξ5 kζa are nearly constant that is those are linear with h λ for caw the effect of h λ exists if the raw has quadratic dependence on wave amplitude the caw should be constant for the h λ however the caw does not show the quadratic dependency for constant λ lpp as discussed in other works liu and papanikolaou 2011 yasukawa et al 2016 kim et al 2017a b 2019 lee et al 2017 2019 yu et al 2017 for smaller h λ range h λ 0 01 caw rapidly decreases for higher h λ range h λ 0 015 caw decreases slowly the self propulsion tests in waves are conducted at 3 carriage speeds for each speed the propeller revolutions are varied widely to cover 3 loadings around the self propulsion point the fd in waves is assumed to be the same as that in calm water fdw fdc fd since the wetted surface area of a full slow ship in waves is nearly same as that in calm water the values of the nm tm and qm in waves are obtained by reading off the fd which is displayed as process b in fig 5 the self propulsion point in waves changes to balance the over loaded propeller consequently the nm tm and qm increase fig 7 displays rtm fd versus propeller revolution thrust and torque in waves at the self propulsion point the rtm fd is adopted since the viscous effect between ship and model scale is taken into account the propeller revolution nm w thrust tm w and torque qm w in waves increase as rtm w fd increases to balance over loaded propeller fig 7 a shows that nm w is not a linear function of rtm w fd and decreases as the h λ increases at constant rtm w fd fig 7 b and c show that tm w and qm w are linear functions of rtm w fd thus t in waves tm w is unchanged at constant rtm w fd as shown in eq 10 10 t m w 1 r t m w f d t m w the naw taw qaw and pdaw are the differences between the n t q pd in waves and those in calm water at the same ship speed respectively the effect of h λ on the non dimensional values of naw taw qaw and pdaw at model scale are displayed in fig 8 cnaw ctaw cqaw and cpdaw respectively those definitions are described in the nomenclature which are based on the square of wave amplitude these show similar tendencies with the caw as shown in fig 6 for smaller h λ range h λ 0 01 cnaw ctaw cqaw and cpdaw rapidly decreases for higher h λ range h λ 0 015 cnaw ctaw cqaw and cpdaw decreases slowly fig 9 displays the resistance and propulsion characteristics versus ship speed in calm water and in waves at constant ship speed the rts w increases due to the raws fig 9 a thus the ns w ts w and qs w increase to balance the over loaded propeller as shown in fig 5 at model scale fig 9 b c d then the pds w 2π ns w qs w increases fig 9 e the power increase due to waves can be estimated from fig 9 e the ts w 1 rts w ts w decreases with increasing the rts w although ts w also increases the increasing rate of rts w is greater than that of ts w fig 9 f the ws w also decreases with similar tendency to the ts w fig 9 g thus the ηhs w 1 ts w 1 ws w decreases with decreasing the ws w although the ts w also decreases the rate of decreasing ws w is greater than that of ts w fig 9 h the js w vs 1 ws w ns w dps decreases with increasing ns w although the ws w decreases fig 9 i thus the ηos w decreases with the same tendency as the js w fig 9 j the ηrs w q0s w qs w where the subscript 0 denotes open water decreases with increasing qs w fig 9 k the ηds w consequently decreases due to the reduced ηhs w ηos w and ηrs w fig 9 l thus the delivered power rapidly increases to maintain the constant ship speed due to the increased rts w and the decreased ηds w pd rts vs ηh fig 10 shows the effect of wave steepness on the resistance and propulsion performances in waves at ship scale the caw ctaw cqaw cnaw and cpdaw at ship scale show similar tendencies as those at model scale which are shown in figs 6 and 8 the added propulsive performances due to waves taw waw ηhaw jaw ηoaw ηraw and ηdaw rapidly decrease for smaller h λ range h λ 0 015 and decreases slowly for higher h λ range h λ 0 015 to know these characteristics at constant delivered power it is necessary to investigate the resistance and propulsion characteristics versus delivered power in waves as displayed in fig 11 the ship speed in waves significantly decreases fig 11 a the speed loss due to waves can be estimated from fig 11 a the rts w ns w ts w and qs w increase almost linearly as pds w increases fig 11 b c d e the rts and ts slightly increase fig 11 b d and ns slightly decreases in waves fig 11 c at constant delivered power the rpm loss due to waves can be estimated from fig 11 c the ts w ws w ηhs w and ηrs w decrease almost linearly as pds w increases fig 11 f g h k the js w va n dp significantly decreases due to the speed loss in waves fig 11 i the ηos w shows similar tendency as js w fig 11 j consequently the ηds w significantly decreases which is mainly due to the decreasing ηos w fig 11 l the speed power rpm relationship in calm water and in regular head waves is shown in fig 12 the ship speed and propeller revolution at pd 20 026 kw which are within interpolation region are also displayed power increase at vs 15 5 knots and speed and rpm losses at pd 20 026 kw in the interpolation region are listed in table 5 the grey content denotes extrapolation region where the waves are in adverse weather conditions 5 conclusions the resistance and propulsion characteristics in regular head waves of kvlcc2 have been predicted utilizing experimental method the effects of ship speed and wave steepness ratio are as follows the total resistance propeller revolution thrust torque delivered power propeller advance coefficient and propeller open water efficiency in waves increase as ship speed increases the thrust deduction and wake fraction hull efficiency relative rotative and propulsive efficiencies in waves decrease as ship speed increases at constant ship speed the self propulsion point in waves changes to increase propeller revolution thrust and torque with wave steepness the added propeller revolution thrust torque and delivered power due to waves increase with wave steepness and are not simply proportional to the square of the wave amplitude which are similar tendencies to the added resistance for smaller h λ range h λ 0 01 cnaw ctaw cqaw and cpdaw rapidly decreases for higher h λ range h λ 0 015 cnaw ctaw cqaw and cpdaw decreases slowly the thrust deduction and wake fraction hull efficiency propeller advance coefficient propeller open water relative rotative and propulsive efficiencies decrease with wave steepness the effects of delivered power are as follows the ship speed total resistance propeller revolutions thrust torque propeller advance coefficient and propeller open water efficiency in waves increase as delivered power increases the thrust deduction and wake fraction hull relative rotative and propulsive efficiencies in waves decrease as delivered power increases at constant delivered power the ship speed in waves significantly decreases the propeller revolution in waves slightly decreases the propulsive efficiency in waves significantly decreases which is mainly due to the decreasing propeller open water efficiency credit authorship contribution statement jin hyeok seo data curation resources investigation cheol min lee formal analysis jin won yu methodology visualization jung eun choi conceptualization validation writing original draft inwon lee conceptualization writing review editing funding acquisition supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national research foundation of korea nrf grant funded by the korean government msit through gcrc sop no 2011 0030013 and the ministry of trade industry and energy no 20007847 to which deep gratitude is expressed 
21514,this study proposes a novel low cost and independent method to estimate five key performance indicators ships traffic berth utilization and allocation handling efficiency throughput and oil spill risk the results obtained through this method can be used as reference for oil port operation optimization and risk control performance indicators are estimated in real time by using ais data and maritime open data instead of relying on the manually collected and unverifiable official data these performance indicators are found to be directly related to the number of handling events and the corresponding handled quantity in the ports therefore this paper first identifies handling events and records the corresponding berthing time and berth second the handling efficiency and time are estimated to calculate the handling quantity of each tanker third the identified handling events and the corresponding handling quantity are aggregated into port level in chronological order so as to extract the key performance indicators finally data of an oil terminal in the guangzhou are taken as a case to verify the feasibility and reliability of the proposed method graphical abstract image 1 keywords ais data quantitative risk analysis port risk efficiency performance oil port 1 introduction attention on oil port performance has increased as the oil trade has grown significantly in 2017 china s crude oil consumption was 610 million tons and its import volume reached 420 million tons china ports yearbook 2018 for the first time it surpassed the united states to become the world s largest crude oil importer most of imported crude oil needs to be transported through oil ports except for few crude oils transported through pipelines at the same time tankers for transport tend to be increasing and larger this situation requires higher safety and efficiency of the oil port in terms of operation safety the incidents in oil ports are very serious environmental and economic catastrophes which would cause great casualties huge losses of interest and irreparable environmental damage french mccay et al 2004 olita et al 2012 zheng and chen 2018 one example is the november 2013 explosion in qingdao that involved by loading arm rupturing and caused 63 fatalities 156 injured people and a direct economic loss of 750 million yuan the increasing crude oil imports would not only increase the probability of accidents but also exacerbate the consequences of the accidents in terms of operational efficiency the operational capacity of the oil port becomes strained take zhanjiang port of guangdong as an example before 2008 only about 7 vlccs very large crude carrier arrived at the port every month but about 10 vlccs arrived every month in 2010 and some vlccs had to wait for berths in the outer anchorage while some smaller berths were vacant chen 2011 if the port did not optimize operation the consignee should pay a high penalty demurrage fee the port would not be able to create benefit and the shipping company would worry the delay of this voyage will affect the implementation of the next contract therefore it is timely to optimize operation process and control risk of the oil port without the major facilities improvements saharidis et al 2009 robertson et al 2011 feng et al 2015 uğurlu et al 2015 the performance of oil port is crucial to control risk and optimize operation for risk control the objective and real time measurement cannot only dig out potential safety hazards goerlandt and montewka 2015 but also be helpful to traffic surveillance and control so to avoid these catastrophes trbojevic and carr 2000 mokhtari et al 2011 aneziris et al 2014 guo et al 2016 to avoid illegal transport of hazardous materials the government requires ships which carry hazardous materials to submit a declaration before operation including the handling timestamp and quantity traditionally the government has to verify the authenticity of the declaration manually which requires huge human effort and time for operation optimization accurate performance measurement can help ports identify the key features of their operations so as to optimize their operations by facility allocation bierwirth and meisel 2010 venturini et al 2017 and vessel scheduling lin et al 2003 fremont 2007 saharidis et al 2009 the objective measurement can also help the shipping companies to choose more suitable ports petering et al 2009 assadipour et al 2016 most of existing studies on port performance rely on the official statistics collected by port authorities or shipping companies whose results are incapable to identify the authenticity of the official statistic moreover the port authorities and shipping companies have to expend a lot of energy and time to collect these data therefore it is opportune to propose an objective low cost and real time method to measure the oil port performance which is crucial for the improvement of port efficiency and safety this paper proposes a novel objective real time low cost and accessible method to estimate the key oil port performance indicators including ships traffic berth utilization and allocation handling efficiency throughput and oil spill risk the remainder of this paper is structured as follows section 2 reviews the existing literature section 3 introduces the data and method section 4 applies the proposed method to a real world case section 5 discusses the performance of the proposed method and section 6 contains concluding remarks 2 literature review the oil port performance measurement is generally studied in terms of risk as a gathering center for hazardous materials many researchers have analyzed the oil port performance related to risk saengsupavanich 2011 liu et al 2015 some researchers uncover ship traffic and size as the key maritime navigation accidents and risk indicators ketkar and babu 1997 magnus et al 2007 kujala et al 2009 valdor et al 2015 bye and aalberg 2018 for the oil port some handbooks state methods to make quantitative risk analysis book 1999 bevi 2009 these methods are widely used to calculate the oil spill risk of an oil port by inputting the ship traffic berthing time handling time and oil flow rate ronza et al 2006 vílchez et al 2011 oil spill risk can be used to judge whether the risk is acceptable and find the weakness in safety to avoid the risk caused by illegal transport of hazardous materials the government requires ships carrying hazardous materials to submit a declaration before operation including the handling timestamp and quantity existing research on supervision of hazardous materials declaration is still in the initial stage the government has to verify the authenticity of the handling timestamp and quantity manually which requires huge human effort and time liu and liu 2008 gai 2014 it lacks of an objective and low cost method to identify handling event and estimate throughput which is significant for hazardous material surveillance with the increase in crude oil imports more and more researchers focus on the oil port performance in terms of operational efficiency saharidis et al 2009 chin and low 2010 andres et al 2019 existing research on general seaport performance measurement can generally be categorized into the following groups macro performance indicators quantifying aggregate port economic impacts on economic activity and micro performance indicators evaluating port operation efficiency unctad 1999 esmer 2008 reviews production productivity utilization and service measurement as four categories of port performance indicators yap and lee lam 2013 indicate throughput is a key indicator for the development of port rafael et al 2015 use the number of vessel arrivals waiting time and throughput to measure the potential benefits chen et al 2016 select ship traffic throughput facility utilization and operational productivity as the common performance indicators which are crucial for port management and planning uğurlu et al 2015 measure the oil terminal in the terminal s current annual handling capacity and the maximum amount of cargo it can handle ding et al 2017 choose ship traffic throughput capacity utilization berthing time handling efficiency frequency of accidents and spillage as the oil port comprehensive operational indicators based on existing literature the following indicators are the common key performance indicators 1 ship traffic includes the number of handling events and ship visits generally the handling events amount is crucial to measure the port s regional competitiveness and connectivity to other ports kemme 2013 the temporal characteristics of handling events amount can be used to provide reference for port work arrangement ship traffic is also critical to measure the risk of the port the handling events amount has a positive correlation with the handling accident probability the number of ship visits affects the probability of ship collisions since the busier the port the more likely collision events will be book 1999 bevi 2009 2 berth utilization and allocation measures how intensively the berths are being occupied and which tonnages of ships are handled in each tonnage of berth this indicator can be widely used in berth location strategy and auxiliary berth planning guan and yang 2010 since it can reflect not only whether the berth is vacant but also the potential waiting time for ships 3 handling efficiency which is the handling quantity per hour during handling this indicator is a key reference for vessel scheduling by oil port and port selection by shipping companies it directly affects the handling time and charges since the duration of the laydays and canceling date period is an important factor of the charges alizadeh and talley 2011 kemme 2013 ding et al 2017 for oil port this indicator can be used to estimate the spillage when the loading arm and hose failure ronza et al 2006 4 throughput which is the handling volume handled at a terminal or a port during a period of time it cannot only affect the future development of the port but also reflect the regional trade growth song 2002 for oil port the estimated throughput can be used to verify the authenticity of the declaration and find the potential smuggling of hazardous materials 5 oil spill risk defined as the mathematical expectation of spillage during handling which is helpful for emergency facilities setting and judging whether the risk is acceptable therefore this paper chooses ship traffic berth utilization and allocation handling efficiency throughput and oil spill risk as the five key performance indicators traditionally the key performance indicators are collected manually by port authorities or shipping companies which require considerable manhours and sometimes lead to sub optimal or incomplete results for some researches due to the delay and absence of the indicators murty et al 2005 lee lam and yap 2008 uğurlu et al 2015 moreover the public data is generally on macro heterogeneous level and difficult to identify authenticity due to the absence of industry standards and the opaque nature of the industry marlow and casaca 2003 adland et al 2017 making it difficult to conduct comprehensive performance analysis historical data has been used to predict the key performance indicators for example peng and chu 2009 seabrooke et al 2003 which have to rely on the official data with the development of the advanced ship trace data collection methods it becomes possible to improve these issues wu et al 2017 dig out the ship visits in a large area by ais data which is not suitable for small areas such as an oil port longbiao chen et al 2016 measure container port performance by ship gps traces and maritime open data to the best of our knowledge this is the only study to estimate the key performance indicators of port without relying on statistical data however the method is just applicable to the large scale container ports since the handling mode is totally different in other types of port in addition the method does not estimate the oil spill risk which should be regarded as a key indicator in oil port this paper proposes a novel objective real time low cost and more accessible method to estimate the key performance indicators of oil ports including ship traffic the number of handling events and ship visits berth utilization and allocation berthing time and berth handling efficiency throughput and oil spill risk by ais and public maritime data the reliability and applicability of this method are confirmed by a case of an oil terminal in guangzhou in addition the estimated results can be applied on port operation optimization port supervision and risk analysis and decision 3 data and methodology in this method different kinds of data are collated from the following two main data 1 ais data is provided by a professional website shipfinder com 2019 this data includes the ship gps trace location and timestamp ship s length and width and destination of the voyage 2 maritime open data includes some ships dwts and the design code of general layout for sea ports china national standards 2013 design code here the ships dwts are extracted from a professional website marinetraffic com 2019 this method develops a database to integrate and process the data as illustrated in fig 1 the overview of the proposed method is presented as show in fig 1 the method consists of three key steps 1 handling event identification firstly the stationary events with berthing location and time in the handled berthing area are detected by ships gps trace then the handling events are extracted from the whole stationary events by merging and filtering 2 handling quantity estimation firstly svm support vector machine classifiers and regression equation are trained to divide the tankers into several tonnages by considering the tankers lengths and widths since the efficiency is determined by its tonnage to a great extent then a mathematical formulation is modeled to solve the handling efficiency and time and then calculate the handling quantity as the product of the corresponding handling efficiency and time 3 port performance measurement based on the former two phases this method aggregates identified handling events and the corresponding handling quantity onto the port level in chronological order so as to estimate the values of the key performance indicators 3 1 step 1 handling event identification to identify handling events in the specific port this step first screens out the ais data whose locations are in the handled berthing area of the port in order to exclude all other situations except for passing handling events short stay and auxiliary towing an algorithm is designed to detect the whole stationary event by ships gps positions and the corresponding timestamps finally the handling events are extracted from the whole stationary events by merging and filtering 3 1 1 stationary event detection s1 1 there are three challenges to detect the stationary events in a small area 1 ais data generally misses and has noisy occurring during collection transmission and reception as a result the time interval of some ais data become larger and ais data has an error of about 10 m in reporting gps positions and an error of speeds harati mokhtari et al 2007 chen et al 2016 making it difficult to detect stationary events 2 the same ship may be handled several times at the same port for a period of time so this method should not only consider the change of ships gps positions but also the corresponding timestamps and 3 the entry and departure status of some ships may not be observed in a small area due to the ships may entry or leave the area during the time interval of ais to address the above challenges this section designs an algorithm to detect the stationary events the traces data of ship i from ais data in port k during period l is aggregated in chronological order the trajectories of ship i detected in port k during period l can be described by a set 1 tr i k l t r i j k l tr i j k l l a t i j k l lng i j k l t i j k l d i j k l j 1 2 3 n i k l where t r i j k l is the j t h trace of ship i in port k during period l and l a t i j k l l n g i j k l t i j k l and d i j k l replace the corresponding latitude longitude timestamp and destination n i k l is the traces number of ship i in port k during period l the distance between the j t h and j 1 t h trace of ship i in port k during period l can be calculated as 2 d i j k l 6371004 arccos sin radians lat i j k l sin radians lat i j 1 k l cos radians lat i j k l cos radians lat i j 1 k l cos radians lng i j k l lng i j 1 k l set d i k l d i j k l j 1 2 3 n i k l 1 as the set of distance of each adjacent trace of ship i in port k during period l as shown in fig 2 the status of ship i during t i j k l to t i j 1 k l can be judged based on the interval time and distance 1 ship i was regarded as stationary if the interval distance was shorter than the interval distance threshold δ d and the interval time was shorter than the interval time threshold δ t 2 ship i was defaulted to leave port k at t i j k l and arrive at port k again at t i j 1 k l if t i j 1 k l t i j k l δ t 3 ship i was defaulted to move during t i j k l to t i j 1 k l if d i j k l δ d and t i j 1 k l t i j k l δ t therefore t r i j 1 k l should be recorded in the next event this method sets the thresholds of handling event identification algorithm using an easily implemented experimental method zhang et al 2019 to determine the value of δ d and δ t increase δ d from a small initial value and check the identified events amount while keeping δ t as 400 min when the number maintains stable the proper value for δ d is determined in the same way set δ t with the determined δ d according to the above analysis an algorithm is designed to detect the stationary events as shown in fig 2 therefore the berthing time t b i e k l position l a t i e k l l n g i e k l destination d i e k l and end timestamp t i e k l e n d of each stationary event of ship i in port k during period l are derived map each event i d i e k l l a t i e k l l n g i e k l d i e k l t i e k l e n d t b i e k l in port k during period l where i d i e k l is the unique ship identification 3 1 2 handling event extracting s1 2 due to the noise of ais data for some pairs of adjacent stationary events of the same ship the interval time may be less than δ t and their geographic distance may be less than δ d as shown in fig 3 this situation is blamed on ais data noise so merge these stationary events into a new event i d i e k l l a t i e 1 k l l n g i e 1 k l d i e 1 k l t i e 1 k l e n d t b i e k l t b i e 1 k l in other words t r i j k l is ignored as noise the algorithm is verified to become more accurate after removing noise after stationary events merging this study uses the exclusive method to identify handling events from the whole stationary events detected the berthing time of these events can be clearly classified into three categories including 1 dozens of minutes 2 several hours to four days and 3 longer time therefore stationary events with a berthing time of dozen minutes are regarded as short stay the ships almost staying at the port all the time are regarded auxiliary barge so the stationary events of these ships are regarded as auxiliary towing other stationary events which take several hours to four days are regarded as handling events finally this paper gains all of handling events in chronological order with the corresponding id position end timestamp and berthing duration in port k during period l i e 3 h h k l id h k l l a t h k l ln g h k l d h k l t e n d h k l t b h k l here h h k l denotes the h t h handling event in port k during period l set the nearest berth to the location of h h k l as the corresponding handled berth therefore 4 h h k l id h k l b h k l d h k l t e n d h k l t b h k l here b h k l denotes the handled berth of h t h handling event in port k during period l 3 2 step 2 handling quantity estimation this section aims to estimate the handling efficiency and time since the handling quantity can be calculated as the product of the corresponding handling efficiency and handling time directly this step first classifies the tankers into different tonnages to determine the handling efficiency level and then designs a mathematical formulation to estimate the handling efficiency and time of each handling event by minimizing the differences between the estimated handling quantity and the published statistical data 3 2 1 tanker classification by tonnage s2 1 for handling efficiency estimation handling event of the tanker is done using the loading machine including loading arm or hose and the berths are equipped with different types and quantities of loading machines based on the berths tonnages china national standards 2013 therefore this paper trains svm classifiers to classify the tankers into different tonnage levels according to their lengths and widths or dwts some of dwts are unobtainable to be more specific the method divides the tankers into 14 ranges according to tonnages including 1000 t 1500 t 2000 t 1501 t 2500 t 3000 t 2501 t 4500 t 5000 t 4501 t 7500 t 10 000 t 7501 t 12 500 t 20 000 t 12 501 t 27 500 t 30 000 t 27 501 t 45 000 t 50 000 t 45 001 t 65 000 t 80 000 t 65 001 t 85 000 t 10 000 t 85 001 t 105 000 t 120 000 t 105 001 t 135 000 t 150 000 t 135 001 t 185 000 t 250 000 t 185001 t 275 000 t and 300 000 t 275 001 t 375 000 t according to the dcglsp denote these tonnages as tonnage c c 1000 2000 3000 300000 respectively for the ship with tonnage 10 000 t its dwt can be directly retrieved from marinetraffic com 2019 or lloyd s register of shipping cheng et al 2018 for the ship with tonnage 10 000 t existing research estimates ship dwt by linear regression considering ship length and width however this study finds the linear regression only applicable to the ship with tonnage 3000 t through practice therefore as shown in the fig 4 this study first uses the features length and width of the detected ships whose dwt can be gained to train an svm classifier classifier 1 with a manually labeled dataset of tonnage levels and uses the trained model to separate the tankers with tonnage 3000 t from other tankers tong and koller 2001 rabaoui et al 2007 for the ship with tonnage 3000 t this method estimates its dwt by linear regression and classifies it into tonnage 1000 2000 or 3000 based on the estimated dwt for the ship with tonnage 3000 t this method trains another svm classifier classifier 2 to divide the tankers into tonnage 5000 t and tonnage 10 000 t for the ship with tonnage 10 000 t is classified according to its real dwt directly based on the above it is ready to complete the classification for every ship and even every event 3 2 2 mathematical formulation s2 2 to estimate the handling efficiency and time a mathematical formulation is designed by minimizing the differences between the estimated handling quantity and the published statistical data as follows this method assumes the handling events with the same tonnages in the same port have the same efficiency parameters q s k l the statistical throughput in port k during period l t b h k l the berthing time of h h k l t h k l p the processing time for start and end of h h k l t h k l f the joint inspection and public assessment time of h h k l e c m i n e c m a x the range of the handling efficiency with tonnage c c 1000 2000 3000 300000 variables e c k the handling efficiency for handling event with tonnage c in port k c 1000 2000 3000 300000 e c h k l the handling efficiency for handling event h h k l here c h k l is the tonnage of h h k l e c h k l e c k when the tonnage of the handled ship is c c 1000 2000 3000 300000 t h k l w the waiting time after completion of h h k l modeling 5 m i n l h h k l e c h k l t b h k l t h k l p t h k l f t h k l w q s k l 2 q s k l 2 6 e c min e c k e c max c 1000 2000 3000 300000 7 e c k e c 1 k c 1000 2000 3000 300000 8 t h k l w 0 i f c h k l 3000 t k w i f c h k l 3000 t k w 0 1 h 2 h 24 h objective 5 minimizes the sum of the differences between the estimated handling quantity and the published statistical data here t b h k l t h k l p t h k l f t h k l w represents the handling time of h h k l generally the ship would not be handled in the whole berthing time during the berthing there are 3 non handling times including the processing time for the start and end for each ship the joint inspection and public assessment time for the foreign trade ship and the waiting time after completion for a larger ship this method calculates the handling time by subtracting these non handling times thus e c h k l t b h k l t h k l p t h k l f t h k l w is the handling quantity of h h k l constraint 6 keeps the handling efficiencies in their reasonable ranges respectively constraint 7 ensures handling events with larger tonnage correspond to larger handling efficiency in the same oil port constraint 8 assumes the ship with tonnage 3000 t can leave the port after completion directly and the waiting time after completion of other ships to be a uniform value t k w generally large ship cannot leave the port until the water depth is safe set the range of t k w from 0 to 24 h since the tidal cycle is 24 h to facilitate the solution set the waiting time to be an integer the accumulated handling time with different tonnage in port k during period l can be gained denoted by t k l c as long as the value of t k w is determined 9 t k l c c h k l c t b h k l t h k l p t h k l f t h k l w therefore the modeling becomes a quadratic programming qp problem whose constraints are constraints 6 and 7 and objective is 10 m i n l c e c k t k l c q s k l q s k l 2 here c e c k t k l c is the estimated handling quantity in port k during period l the optimal solution and the optimal value of the qp problem can be gained directly by some off the shelf optimization tools such as cplex seijo and sen 2011 set t k w as 1 2 3 24 respectively to gain 24 optimal solutions and the optimal values set the minimum optimal value as the optimal value of the modeling and the corresponding optimal solution is the optimal solution of modeling therefore the estimated values of handling efficiency and time are gained and the quantity of each handling event can be calculated as the product of the corresponding handling efficiency and handling time directly the range of t h k l f is from 2 to 5 h and the range of t h k l p is from 0 75 to 2 h china national standards 2013 the method sets 1 t h k l f as 0 for domestic ship and set t h k l f as 4 h for foreign trade ship this method judges whether the ship is a domestic trade ship according to whether its destination after handling is domestic 2 and t h k l p as 2 h this setting would cause little error since the ranges of t h k l f and t h k l p are much smaller compared the whole berthing time the average berthing time of the case is 21 2 h now determine the range of the handling efficiency e c m i n e c m a x the ranges of handling efficiency are referred to 1 the arrangement parameters of loading machine in tanker berth shown in table 1 2 the flow velocity is in the range from 0 8 to 4 5 m s 1 since the average economic flow velocity of pipelines is in the range from 0 8 to 3 m s 1 and the safe flow velocity is less than 4 5 m s 1 3 and the density of the main goods ρ kg l 1 china national standards 2013 according to the analysis above the range for each handling efficiency is gained as shown in table 2 3 3 step 3 port performance measurement this section aims to measure the performance of different ports quantitatively this step first aggregates handling events and their corresponding handling quantity in chronological order and then deduces a set of key performance indicators of the port as follows 3 3 1 ship traffic s3 1 iincludes the number of handling events denoted by n k l and the total number of ship visits in the port k during period l denoted by v k l ship traffic is crucial to measure the port s regional competitiveness connectivity to other ports and the risk of the port the handling events amount can be extracted from the handling event identification results directly this method identifies ship visit by the method as following t r i j k l and t r i j 1 k l are defaulted to be in the same ship visit if the time interval was less than threshold δ t otherwise ship i was defaulted to leave port k at t i j k l and arrived at port k again at t i j 1 k l therefore the whole ship visits in the proximity of the berth during period l can be identified this method also records the detailed monthly handling events amount with different tonnage to analyze the temporal characteristics and then provide reference for port work arrangement 3 3 2 berth utilization and allocation s3 2 which can be widely used in berth location strategy and auxiliary berth planning berth utilization is the percentage of time that the berths are occupied by ships during a period of time berth allocation presents not only which tonnages of tankers are handled in each tonnage of berth but also the contribution of these tankers to the utilization of each tonnage of berth this method calculates berth utilization on the tonnage basis instead of on the per berth basis by the handling event identification results this method first accumulates the berthing time of all the handling events in the berths with tonnage c as 11 t b c c b h k l c t b h k l c 1000 2000 3000 300000 here c b h k l is the tonnage of the handled berth of h h k l it is worth noting that c b h k l c h k l in which c h k l is the tonnage of the handled ship of h h k l there may be some smaller ships berthing at some larger berths or some larger ships berthing at some smaller berths finally this method calculates the berth utilization with tonnage c denoted by u c as the ratio of the average berth utilization time to the duration of the given period l as 12 u c t b c n b c l 100 c 1000 2000 3000 300000 here n b c is the number of the berths with tonnage c the estimated utilization may be underestimated since a large ship may occupy more than one berth while this method just recorded the nearest one as the handled berth in addition this method sets the berth allocation as the contribution of tankers with tonnage c i to the utilization of berth with tonnage c b 13 u c b c i c b h k l c b c h k l c i t b h k l n b c l 100 c i c b 1000 2000 3000 300000 3 3 3 handling efficiency s3 3 defined as the handling quantity per hour during handling in port k is the variable e c k of the modeling in step 2 2 mathematical formulation in section 3 2 this indicator is a key factor for vessel scheduling port selection and spillage estimation 3 3 4 throughput s3 4 defined as the handling quantity handled in terminal or port k during period l the estimated throughput can be used to verify the authenticity of the declaration and find the potential smuggling of hazardous materials this method calculates the handling quantity as the product of the corresponding handling efficiency and time the throughput of terminal or port k during period l can be gained by accumulating the corresponding handling quantity as 14 q e k l c e c t k l c 3 3 5 oil spill risk s3 5 defined as the mathematical expectation of spillage during handling which is helpful to judge whether the risk is acceptable and find the weakness of the safety this method estimates the probability of an oil spill and spillage in different scenarios during handling by a general quantitative risk analysis method as shown in table 3 the information can be used to find the weakness of the safety management so as to control the risk table 3 shows the considering scenarios of every handling event including loading arm total or partial rupture hose total or partial rupture ship ship collision during discharging collision and grounding during moving to from berth the probability of collision and grounding during moving to from berth is based on hse 1978 since it makes more detail analysis of the probability of hull failure the other parameters are both based on bevi 2009 due to it is more recent every loading arm or hose rupture lead to an oil spill so their probabilities are equal to the probabilities of oil spill the probability of major minor spill under the condition of collision and grounding and is determined by the ship type and can refer to the values in bevi 2009 from the analysis above the probability of each initiating event the probability of the corresponding oil spill and general spillage can be calculated by inputting the ship traffic berthing time handling time handling efficiency and ship type into the model therefore the oil spill risk in port k during period l can be gained as 15 r isk k l s p k l s o k l s where p k l s is the probability of oil spill in scenario s in port k during period l o k l s is the corresponding spillage and p k l s o k l s is the corresponding oil spill risk finally the oil spill risk in each scenario is assessed based on risk matrix jtt1143 2017 as shown in fig 7 e the consequence with spillage 50 t is considered as minor the probability which is less than 0 001 per year is considered as especially low based on the combination of probability and consequence category the risk is classified into be negligible low acceptable middle and unacceptable high according to the analysis above the accuracy of these indicators can be guaranteed as long as this study can identify handling events including its berthing time and location and estimate the corresponding quantity precisely 4 case study g terminal at guangzhou port g terminal gt is the one of the largest oil terminals in guangzhou there are 2 berths with tonnage 1000 t 4 berths with tonnage 2000 t 2 berths with tonnage 3000 t and 1 berth with tonnage 80 000 t in gt as the public waters of nansha huangpu dongguan and other large container terminals guangzhou port seaward waterway has certain limitation in terms of channel depth and width in order to maintain the fair use of the seaward waterway and the normal order of transport all foreign ships and chinese ships with dwt 3000 t denoted by bss are required to submit forecast data 72 h prior to arrival guangzhou port communication dispatch center formulates and publishes the general plan for shipping in and out of the sea channel with actual arrival and departure timestamps of every bs in guangzhou port according to the ship arrival forecast timestamp since april 1 2007 therefore the accuracy of handling event with dwt 3000 t identification is able to be verified in gt in this section the whole year ais data of gt in 2018 whose interval time is 5 min is used to illustrate the feasibility and reliability of the proposed method the number and tonnage of berth and monthly throughput statistical data are provided from gt the handling events with dwt 3000 t record with the ship s id and handling timestamp is provide by guangzhou port communication dispatch center gzport 2019 4 1 handling event identification results this section first sets the thresholds of handling event identification algorithm then the algorithm is verified to be accurate by comparing the actual handling events with identified events solved by the algorithm including their arrival and departure timestamps to determine the value of δ d and δ t increase δ d from a small initial value and check the handling events number while keeping δ t as 400 min in the study area when the number becomes steady the proper value for δ d is determined the relationship between the event amount and δ d is shown in fig 5 a it can be seen that the number of events starts keeping steady from 20 m so set δ d as 20 m in this case in the same way set δ t as 300 min as shown in fig 5 b this case can just verify handling event identification of foreign ships or chinese ships with dwt 3000 t known as bss since the operation of the other ships is not recorded in gt in table 4 n g l in the third row represents the number of handling events recorded in the master plan in gt in l t h month of 2018 then check how many of these handling events can be identified by the proposed method and set this number as n g l recall g l is the ratio of n g l to n g l n g l is the number of handling events identified by ais p r e c i s i o n g l is the ratio of n x 1 to n g l for instance in april there are 27 handling events recorded in the master plan among these 27 handling events this method can just check 26 events from the ais data and the corresponding r e c a l l g l is 96 there are 27 events identified by ais in april which means there is 1 event identified by ais but not recorded in the master plan and the p r e c i s i o n g l is 99 from table 4 it can be found that 96 of handling events recorded can be identified and 99 of handling events identified can be checked out in the master plan in 2018 it means the handling events recorded and the identification results were almost one to one there are few handling events which are either recorded but cannot be identified or identified but not recorded in addition the proposed method can make an accurate identification of handling events with its initial and end timestamp and location the arrival and departure timestamps announced by port authority is very close to those identified from the ais the error of each arrival or departure timestamp is less than 1 h and the average berthing time of the case is 14 h therefore the absolute relative error of berthing time is less than 14 3 moreover most of the identified locations is clearly close to one of the given berth therefore the estimation of ship traffic and berth utilization and allocation is accurate 4 2 handling quantity estimation results in this section the monthly throughput estimation of gt is evaluated the evaluation on a terminal level is performed since handling quantity of each handling event is not available before handling efficiency estimation it is essential to make sure the tonnage of each ship are corroborated the dwts of some ships arriving in gt in 2018 can be checked from marinetraffic com 2019 including 71 ships with tonnage 3000 t 84 ships with tonnage 5000 t and the whole ships with tonnage 10 000 t based on this information train classifier 1 and 2 their precision recall and the contribution rates of the predictors are shown in table 5 then classifiers are applied to classify the other handled ships recorded in ais data in gt in 2018 for the ship with tonnage 3000 t the dwt is estimated using a linear regression with the length and width and gains the linear regression equation as follows 16 dwt 2907 71 15 l e n g t h in eq 16 the r squared is 87 6 the p value of intercept and length are 3 13 10 13 and 2 09 10 24 respectively finally to classify the ships with tonnage 3000 t based on their estimated dwts and ships with tonnage 10 000 t based on their real dwts therefore the classification of all ships is completed now to set ρ as 0 738 kg l 1 since the main goods are refined oil in gt referring to table 2 the range of the handling efficiency can be gained and shown in the second row of table 6 then the 6 months 1st 2nd 4th 9th 10th 11th month whose accumulated handling time of each tonnage varies greatly are used to estimate the handling efficiency and waiting time after completion by the modeling in step 2 2 mathematical formulation section 3 2 and the other data for evaluation therefore the optimal solutions for gt are gained as shown in the last row of table 6 the validity of the estimated handling efficiency and non handling time is checked from table 6 it can be found that 1 the selected t k w for gt was exactly between the mean 5 6 h and median 4 h of its real world waiting time which can be gained from the master plan of guangzhou port gzport 2019 2 a large proportion of the petrochemical oil in guangdong province depends on imports therefore most of handling events of bss were unloading which would generally cause lower handling efficiency china national standards 2013 which was consistent with the efficiency selected in the table 6 exactly estimate the throughput handled in the other months in gt using the optimal solution estimated handling efficiency and waiting time results of gt are shown in the fig 6 it can be found 1 most of the monthly apes absolute percentage error were slight and the ape of the whole year was 0 94 in gt by calculating 2 the estimated throughput of december in gt was significantly larger than the corresponding statistical throughput which may be attributed to the delayed statistic at the end of the year it is worth noting that these statistical data may be delayed which will result in difference between statistical and estimated data especially in a short time period 3 the estimated throughput of february in gt was significantly smaller than the corresponding statistical throughput which may be attributed to the higher handling efficiency before the spring festival which is the biggest festival in china because the estimated handling efficiency was the average value during the given period the throughput would be underestimated when the real handling efficiency is higher than the average value 4 3 port performance measurement results this section presents the key performance indicators in gt 2018 as shown in fig 7 1 ship traffic ship traffic includes the number of handling events and ship visits the whole number of handling events is 1324 and the number of ship visits is 6111 the detailed monthly handling events of different tonnages are useful to analyze the temporal characteristics as shown in fig 7 a it can be found 1 the ships with tonnage 3000 t account for the vast majority of all handled ships 2 the monthly variation of handling events with tonnage 3000 t is slower and the number in the second half of 2018 is significantly higher than that in the first half 3 the monthly number of handling events with tonnage 3000 t fluctuates greatly the amounts of february july and september are significantly smaller and the amounts of april and october are significantly larger 2 berth utilization and allocation the berth utilization of gt is calculated by the eq 12 as shown in fig 7 b it can be found that 1 except for the berth with tonnage 80 000 t in gt the utilization rates of other berths are low continuously 2 the berth with tonnage 3000 t in gt is in short supply there are 2 3 of its monthly utilization are higher than the optimal empirical value 60 radimilović and jovanović 2006 the berth allocation of gt is calculated by the eq 13 as shown in fig 7 c fig 7 c presents not only what tonnage of ship is handled at the berth with each tonnage but also the contribution of these ships to the utilization of the berth with each tonnage for instance the berth utilization with tonnage 1000 t is 24 and about 4 7 of this utilization is contributed by handling events with tonnage 1000 t in gt it can be found some unreasonable situations in the berth allocation on the one hand smaller ship berthed at larger berth which would result in the higher handling efficiency but with waste of resources on the other hand larger ship berthed at smaller berth which would increase the possibility of grounding and sinking such as about 3 7 of the berth with tonnage 2000 t utilization was contributed by the smaller ship and about 1 5 of the berth with tonnage 3000 t utilization was contributed by the larger ship all of this information is a key reference for oil port upgrading and rebuilding 3 handling efficiency the handling efficiency is the variable e c of the modeling c 3000 5000 10000 300000 the handling efficiency in gt by 2018 is extracted from the handling quantity estimation results as shown table 6 normalize the handling efficiency of gt by min max normalization as shown in table 7 it can be found all of the normalized values of handling efficiency for gt are very low 4 throughput fig 7 d shows the estimated monthly throughput with different tonnages it can be found 1 the throughput of gt is mainly contributed by the ships with tonnage 3000 t although the corresponding handling events amount is significantly less than that of ships with tonnage 3000 t 2 the fluctuation of throughput is similar to the handling events amount on the whole reaching the lowest value in february and the higher value in april may and october 5 oil spill risk half of the handling events are assumed to be handled by loading arm and half of the handling events are assumed to be handled by hose since the loading arm accounts for half of the all loading machine in gt the ship type is set as double hull liquid tanker according to the requirements of the ministry of transport single hull chemical ships and single hull oil ships with dwt 600 t are prohibited from entering guangzhou port from january 1 2016 the berthing time and handling time in gt by 2018 are calculated to be 18 492 68 h and 16 201 21 h respectively by accumulated the handling events input the total berthing time 18492 68 h handling time 16 201 21 h number of handling events 1324 total number of ship visits 6111 in 2018 and ship type double hull liquid tanker into the model in section 3 3 therefore the possibility of initiating event and the possibility of an oil spill in different scenarios in gt can be gained set the oil flow rate as the average handling efficiency 265 t h 1 and the density of the goods as 0 738 kg l 1 the spillage in every scenario can be calculated as well as the corresponding oil spill risk in gt as shown in table 8 from table 8 collision and grounding while tanker moving to or from berth is the most frequent accident gt would have 0 33100 such accident per year fortunately not every accident would lead to oil spills there are 0 00199 minor spill and 0 00050 major spill per year in gt result from collision and grounding while tanker moving to or from berth the annual oil spill risk during handling can be calculated to be 0 63367 t by eq 15 finally the oil spill risk in each scenario is assessed based on risk matrix jtt1143 2017 as shown in fig 7 e it can be found the risk caused by loading machine partial rupture is in the acceptable middle risk area and risks in the other scenarios are in the negligible low risk area 5 discussion the method is a novel real time low cost and independent method to estimate oil port risk and efficiency performance indicators the common indicators including ship traffic the number of handling events and ship visits berth utilization and allocation berthing time and berth handling efficiency throughput and oil spill risk were extracted from the handling event identification and handling quantity estimation results the accuracy of these indicators has been guaranteed by the accurate handling events identification and handling quantity estimation results the results are helpful for schedule optimization hazardous material surveillance operation planning berth upgrade emergency facilities setting and digging out the unacceptable risk which is crucial to control risk and optimize operation for the handling event identification chen et al 2016b has designed a method to identify the handling events in container port this paper proposed a novel method based on it but differs in the following five points 1 this method first screened out the ais data whose location was in the handled berthing area instead of the whole terminal in order to exclude all other situations except for handling events short stay and auxiliary towing therefore the handling events can be extracted by only considering the berthing time instead of training a classifier 2 the proposed method introduced the interval time threshold to avoid the adjacent events whose ais data during entering and leaving the berthing area was lost are merged 3 this method merged the adjacent stationary events which were broken up by mistake due to the ais data noise as shown in fig 3 4 this study set the values of the interval time and distance threshold in a more reasonable way see fig 5 instead of setting the threshold as the experience value and 5 the precision 99 and recall 96 of the proposed method see table 4 were both higher than precision 91 and recall 94 of the existing method on a yearly basis the handling events recorded and the identification results were almost one to one as shown in table 4 which is helpful for schedule optimization and traffic surveillance by digging out the potential dishonest and illegal ships for the few ships which were forecasted to arrive at gt for handling but could not be identified there might be two reasons to explain this situation 1 the ship was handled indeed while did not open the ais or the ais data was miss during transmission 2 the ship applied for handling but was not handled in fact which has occupied the using time of the public waters of the sea channel in the master plan and cancelled its arrival without timely notice for guangzhou port communication dispatch center to adjust the scheduling plan would lead to the waste of shipping channel resources therefore the port authority should formulate regulations to prevent such behavior for example the punitive waiting time could be added for the ship at the next application for arrival deduct the ship s credit score and so on according to the regulatory requirements in china all round the clock video monitoring data of all berths in the oil port must be connected to the port regulatory system port authorities can verify whether a ship has arrived at the port by checking the surveillance video of the berth in the day the ship is expected to arrive at the port the few bss which were identified by ais but not recorded in the master plan were the potential illegal arrivals such as there were 2 bss identified to be handled in gt in november 2018 but not recorded as shown in table 4 the port can directly check the illegal arrival ships from the monitoring record of these ships in the identified timestamp instead of the whole record unfortunately this paper could only find the potential illegal arrival bss due to the fact that the arrival record of the ships with dwt 3000 t was not available for the general public according to china s regulatory requirements on hazardous materials terminals each handling event should be declared to the ministry of transports including the ship name arrival and departure timestamps handling quantity and so on therefore the ministry of transports can find all potential illegal handling events by comparing the identification results and the declaration records in addition it verified the proposed method can make an accurate identification of every handling event with its initial and end timestamp which can be used to identify whether the ship arrives or leaves at the safe time this identified method is also applicable to other types of ports it means this method can be used to estimate the ship traffic and berth utilization and allocation in other types of ports the monthly handling events amount and throughput with different tonnage as shown in fig 7 a and d is helpful for operation planning by finding the temporal characteristics generally the tankers with tonnage 3000 t connect with major ports worldwide for import while the tankers with tonnage 3000 t deliver goods to a continent or region in china because most of the oil in china is imported from the distribution of the handling events with tonnage 3000 t it suggested the oil import was relatively stable in addition the demand of oil import in the second half of 2018 was significantly higher than that in the first half the monthly handling events with tonnage 3000 t fluctuated greatly this was mainly due to inactive cargo transportation during greater typhoons in july and september while the relatively greater human activities during the long public holiday in april tomb sweeping day and labor day and october national day for both tonnages of events there was a sharp drop from january to february due to the port suspension of business in the long public holiday of the spring festival therefore some of the busier work such as rehearsing inspection and upgrading can be arranged in the typhoon season before the public holiday the port should reserve energy to meet the busy work the ship companies should try the best to avoid shipping during the spring festival the monthly berth utilization as shown in fig 7 b can be used to find the berth with continuous underutilization and berth with continuous excessive utilization so as to provide reasonable advices for berth location strategy and auxiliary berth planning except the berth with tonnage 80 000 t in gt the utilization rates of other berths were far lower than their optimal empirical values around 60 in every month radimilović and jovanović 2006 moreover the berth with tonnage 3000 t in gt was in short supply there were 2 3 of its monthly utilization were higher than the optimal empirical value therefore gt should tend to upgrade the smaller berths into larger berths in the rebuilding plan if the handling quantity with different tonnages would not be changed how to increase the large berth to answer this question fig 7 c showed more detailed berth allocations it can be found that 1 for all handling events with tonnage 3000 t only part of handling events with tonnage 5000 t were handled at the smaller berth other events with tonnage 3000 t were all handled at the berth with tonnage 80 000 t 2 for the two berths with tonnage 3000 t there were 11 12 of the monthly berth utilizations were lower than 30 and for the four berths with tonnage 2000 t all of the monthly berth utilizations were lower than 25 3 one of the berths with tonnage 3000 t and one of the berths with tonnage 2000 t are geographically adjacent therefore it would be better to merge the adjacent berths one of the berth with tonnage 3000 t and one of the berth with tonnage 2000 t into the berth with tonnage 5000 t to ease pressure of the berth with tonnage 80 000 t without increasing pressure on the other berths with tonnage 2000 t and 3000 t traditionally shipping companies estimate the handling efficiency by considering the facility of ports however it is difficult to gain accurate handling efficiency since the range of this indicator is too large as shown in table 6 table 7 showed the min max normalized values of the handling efficiency in gt are lower which might result from there were fewer loading arms matching with the actual cargo in the berths generally every loading arm can only handle the cargo of the specified type port would design enough loading arms according to the demand of different cargo types however the mismatching gap between actual handled cargos and the loading arms is becoming more and more prominent and this phenomenon should have drawn our attention greatly this paper assumed the handling events with the same tonnages in the same port have the same efficiency therefore the estimated handling efficiency is the average handling efficiency with the same tonnage in fact combined with the non handling time the berthing time can be estimated which is a key reference for vessel scheduling and crucial to choose the suitable oil port for the ship company the estimated throughput can be used to check the reliability of monthly throughput compulsively reported by oil port the relative error obeys a normal distribution by calculating the 95 confidence region of the relative error in the case is 82 75 129 46 it means there would be a possibility of more than 95 that the statistical throughput is lower than the real value if the relative error is larger than 129 46 this is of great significance in preventing some illegal transportation of hazardous materials we acknowledge this method cannot guarantee the accuracy of the estimated handling quantity of every handling event since the actual handling efficiency may be far larger or lower than the average therefore this method can just check the reliability of the declared handling quantity on monthly level this paper estimated the possibilities spillage and risk of offshore oil spill as shown in table 8 the results are helpful to find the main unacceptable risk and set emergency facilities from table 8 it can be found gt could deal with 99 of oil spills if gt was capable of responding to an oil spill of 10 t since 99 of oil spills had a spillage less than 10 t from fig 7 e it can be found only the risk caused by loading machine partial rupture which accounted for more than 90 of the total risk is in the middle risk area and risks in the other scenarios are in the negligible area therefore gt should control the risk caused by machine rupture by strengthening the regular inspection and increasing the emergency response speed from the berth allocation in fig 7 c it can be found in the situation of the larger ship berthing at smaller berth which would increase the possibility of grounding and sinking in the future study oil spill risks with considering this situation should be analyzed 6 conclusions to make accurate quantitative measurements of the oil port risk and efficiency performance this paper proposed a novel real time low cost and independent method to estimate port performance indicators including ship traffic berth utilization and allocation handling efficiency throughput and oil spill risk by ais and maritime open data the proposed method is based on two modules handling event identification and handling quantity estimation to identify the handling event this paper first detected the whole stationary event by considering the interval time and distance between the adjacent ais data whose location were in the handled berths then the handling events with arrival and departure timestamps and location were extracted from the whole stationary events by merging and filtering to estimate the handling quantity this paper first trained svm classifiers and made a linear regression model to divide the tankers into several tonnages to determine the corresponding handling efficiency level then a mathematical formulation was modeled to solve the handling efficiency and time and calculated the handling quantity as the product of the handling efficiency and time finally the key performance indicators were extracted from the handling events identification and handling quantity estimation results an oil terminal in the guangzhou was taken as a case to evaluate the proposed method the results show the proposed method cannot only identify handling events with its initial and end timestamp and location but also can estimate the handling quantity accurately which make sure the accuracy of the estimated key performance indicators these performance indicators are of great significance for shipping companies the estimated handling efficiency can be used as a reference to select more suitable ports for oil port 1 this method is helpful to find the ship applied for handling but is not handled indeed and formulate regulations to prevent such behavior 2 the temporal characteristics of the business revealed by the monthly estimated ship traffic and throughput with different tonnages are useful to the operation plan 3 the matching degree of berth and handling event extracted from the berth utilization and allocation can provide reasonable advice for berth upgrading and rebuilding 4 the possibilities of oil spill and spillage in each scenario during handling can be gained to dig out the unacceptable risk and provide advice for emergency facilities setting for the government this paper can find the potential illegal handling event which is identified by ais but does not submit a declaration or whose statistical throughput is obviously less than the estimated throughput this study can also find in the situation of the larger ship berthing at smaller berth which would increase the oil spill risk in the future study the possibility of grounding and sinking in this situation should be reevaluated by considering the tension of the guard rope or utilizing expert assessments and the corresponding oil spill risk will be reanalyzed in summary the main contributions of this paper include 1 to the best of our knowledge this is the first work on real time oil port performance measurement comparing with the existing methods the proposed method is more low cost and can be used to verify the accuracy of official data 2 the method is verified by a real world case and the results show that the proposed method can give an accurate estimation 3 by these indicators this paper provides some recommendations for hazardous materials surveillance oil port operation optimization risk analysis and control credit authorship contribution statement huiling zhong conceptualization supervision funding acquisition yishu lin methodology writing original draft tsz leung yip conceptualization validation wenxue cai providing data and funding giving suggestions yimiao gu conceptualization supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research is supported by the humanities and social science research foundation of the ministry of education of china grant no 19yja630107 and the youth foundation of the humanities and social sciences research of the ministry of education of china grant no 17yjcgjw002 we acknowledge the two anonymous referees for their valuable comments and suggestions 
21514,this study proposes a novel low cost and independent method to estimate five key performance indicators ships traffic berth utilization and allocation handling efficiency throughput and oil spill risk the results obtained through this method can be used as reference for oil port operation optimization and risk control performance indicators are estimated in real time by using ais data and maritime open data instead of relying on the manually collected and unverifiable official data these performance indicators are found to be directly related to the number of handling events and the corresponding handled quantity in the ports therefore this paper first identifies handling events and records the corresponding berthing time and berth second the handling efficiency and time are estimated to calculate the handling quantity of each tanker third the identified handling events and the corresponding handling quantity are aggregated into port level in chronological order so as to extract the key performance indicators finally data of an oil terminal in the guangzhou are taken as a case to verify the feasibility and reliability of the proposed method graphical abstract image 1 keywords ais data quantitative risk analysis port risk efficiency performance oil port 1 introduction attention on oil port performance has increased as the oil trade has grown significantly in 2017 china s crude oil consumption was 610 million tons and its import volume reached 420 million tons china ports yearbook 2018 for the first time it surpassed the united states to become the world s largest crude oil importer most of imported crude oil needs to be transported through oil ports except for few crude oils transported through pipelines at the same time tankers for transport tend to be increasing and larger this situation requires higher safety and efficiency of the oil port in terms of operation safety the incidents in oil ports are very serious environmental and economic catastrophes which would cause great casualties huge losses of interest and irreparable environmental damage french mccay et al 2004 olita et al 2012 zheng and chen 2018 one example is the november 2013 explosion in qingdao that involved by loading arm rupturing and caused 63 fatalities 156 injured people and a direct economic loss of 750 million yuan the increasing crude oil imports would not only increase the probability of accidents but also exacerbate the consequences of the accidents in terms of operational efficiency the operational capacity of the oil port becomes strained take zhanjiang port of guangdong as an example before 2008 only about 7 vlccs very large crude carrier arrived at the port every month but about 10 vlccs arrived every month in 2010 and some vlccs had to wait for berths in the outer anchorage while some smaller berths were vacant chen 2011 if the port did not optimize operation the consignee should pay a high penalty demurrage fee the port would not be able to create benefit and the shipping company would worry the delay of this voyage will affect the implementation of the next contract therefore it is timely to optimize operation process and control risk of the oil port without the major facilities improvements saharidis et al 2009 robertson et al 2011 feng et al 2015 uğurlu et al 2015 the performance of oil port is crucial to control risk and optimize operation for risk control the objective and real time measurement cannot only dig out potential safety hazards goerlandt and montewka 2015 but also be helpful to traffic surveillance and control so to avoid these catastrophes trbojevic and carr 2000 mokhtari et al 2011 aneziris et al 2014 guo et al 2016 to avoid illegal transport of hazardous materials the government requires ships which carry hazardous materials to submit a declaration before operation including the handling timestamp and quantity traditionally the government has to verify the authenticity of the declaration manually which requires huge human effort and time for operation optimization accurate performance measurement can help ports identify the key features of their operations so as to optimize their operations by facility allocation bierwirth and meisel 2010 venturini et al 2017 and vessel scheduling lin et al 2003 fremont 2007 saharidis et al 2009 the objective measurement can also help the shipping companies to choose more suitable ports petering et al 2009 assadipour et al 2016 most of existing studies on port performance rely on the official statistics collected by port authorities or shipping companies whose results are incapable to identify the authenticity of the official statistic moreover the port authorities and shipping companies have to expend a lot of energy and time to collect these data therefore it is opportune to propose an objective low cost and real time method to measure the oil port performance which is crucial for the improvement of port efficiency and safety this paper proposes a novel objective real time low cost and accessible method to estimate the key oil port performance indicators including ships traffic berth utilization and allocation handling efficiency throughput and oil spill risk the remainder of this paper is structured as follows section 2 reviews the existing literature section 3 introduces the data and method section 4 applies the proposed method to a real world case section 5 discusses the performance of the proposed method and section 6 contains concluding remarks 2 literature review the oil port performance measurement is generally studied in terms of risk as a gathering center for hazardous materials many researchers have analyzed the oil port performance related to risk saengsupavanich 2011 liu et al 2015 some researchers uncover ship traffic and size as the key maritime navigation accidents and risk indicators ketkar and babu 1997 magnus et al 2007 kujala et al 2009 valdor et al 2015 bye and aalberg 2018 for the oil port some handbooks state methods to make quantitative risk analysis book 1999 bevi 2009 these methods are widely used to calculate the oil spill risk of an oil port by inputting the ship traffic berthing time handling time and oil flow rate ronza et al 2006 vílchez et al 2011 oil spill risk can be used to judge whether the risk is acceptable and find the weakness in safety to avoid the risk caused by illegal transport of hazardous materials the government requires ships carrying hazardous materials to submit a declaration before operation including the handling timestamp and quantity existing research on supervision of hazardous materials declaration is still in the initial stage the government has to verify the authenticity of the handling timestamp and quantity manually which requires huge human effort and time liu and liu 2008 gai 2014 it lacks of an objective and low cost method to identify handling event and estimate throughput which is significant for hazardous material surveillance with the increase in crude oil imports more and more researchers focus on the oil port performance in terms of operational efficiency saharidis et al 2009 chin and low 2010 andres et al 2019 existing research on general seaport performance measurement can generally be categorized into the following groups macro performance indicators quantifying aggregate port economic impacts on economic activity and micro performance indicators evaluating port operation efficiency unctad 1999 esmer 2008 reviews production productivity utilization and service measurement as four categories of port performance indicators yap and lee lam 2013 indicate throughput is a key indicator for the development of port rafael et al 2015 use the number of vessel arrivals waiting time and throughput to measure the potential benefits chen et al 2016 select ship traffic throughput facility utilization and operational productivity as the common performance indicators which are crucial for port management and planning uğurlu et al 2015 measure the oil terminal in the terminal s current annual handling capacity and the maximum amount of cargo it can handle ding et al 2017 choose ship traffic throughput capacity utilization berthing time handling efficiency frequency of accidents and spillage as the oil port comprehensive operational indicators based on existing literature the following indicators are the common key performance indicators 1 ship traffic includes the number of handling events and ship visits generally the handling events amount is crucial to measure the port s regional competitiveness and connectivity to other ports kemme 2013 the temporal characteristics of handling events amount can be used to provide reference for port work arrangement ship traffic is also critical to measure the risk of the port the handling events amount has a positive correlation with the handling accident probability the number of ship visits affects the probability of ship collisions since the busier the port the more likely collision events will be book 1999 bevi 2009 2 berth utilization and allocation measures how intensively the berths are being occupied and which tonnages of ships are handled in each tonnage of berth this indicator can be widely used in berth location strategy and auxiliary berth planning guan and yang 2010 since it can reflect not only whether the berth is vacant but also the potential waiting time for ships 3 handling efficiency which is the handling quantity per hour during handling this indicator is a key reference for vessel scheduling by oil port and port selection by shipping companies it directly affects the handling time and charges since the duration of the laydays and canceling date period is an important factor of the charges alizadeh and talley 2011 kemme 2013 ding et al 2017 for oil port this indicator can be used to estimate the spillage when the loading arm and hose failure ronza et al 2006 4 throughput which is the handling volume handled at a terminal or a port during a period of time it cannot only affect the future development of the port but also reflect the regional trade growth song 2002 for oil port the estimated throughput can be used to verify the authenticity of the declaration and find the potential smuggling of hazardous materials 5 oil spill risk defined as the mathematical expectation of spillage during handling which is helpful for emergency facilities setting and judging whether the risk is acceptable therefore this paper chooses ship traffic berth utilization and allocation handling efficiency throughput and oil spill risk as the five key performance indicators traditionally the key performance indicators are collected manually by port authorities or shipping companies which require considerable manhours and sometimes lead to sub optimal or incomplete results for some researches due to the delay and absence of the indicators murty et al 2005 lee lam and yap 2008 uğurlu et al 2015 moreover the public data is generally on macro heterogeneous level and difficult to identify authenticity due to the absence of industry standards and the opaque nature of the industry marlow and casaca 2003 adland et al 2017 making it difficult to conduct comprehensive performance analysis historical data has been used to predict the key performance indicators for example peng and chu 2009 seabrooke et al 2003 which have to rely on the official data with the development of the advanced ship trace data collection methods it becomes possible to improve these issues wu et al 2017 dig out the ship visits in a large area by ais data which is not suitable for small areas such as an oil port longbiao chen et al 2016 measure container port performance by ship gps traces and maritime open data to the best of our knowledge this is the only study to estimate the key performance indicators of port without relying on statistical data however the method is just applicable to the large scale container ports since the handling mode is totally different in other types of port in addition the method does not estimate the oil spill risk which should be regarded as a key indicator in oil port this paper proposes a novel objective real time low cost and more accessible method to estimate the key performance indicators of oil ports including ship traffic the number of handling events and ship visits berth utilization and allocation berthing time and berth handling efficiency throughput and oil spill risk by ais and public maritime data the reliability and applicability of this method are confirmed by a case of an oil terminal in guangzhou in addition the estimated results can be applied on port operation optimization port supervision and risk analysis and decision 3 data and methodology in this method different kinds of data are collated from the following two main data 1 ais data is provided by a professional website shipfinder com 2019 this data includes the ship gps trace location and timestamp ship s length and width and destination of the voyage 2 maritime open data includes some ships dwts and the design code of general layout for sea ports china national standards 2013 design code here the ships dwts are extracted from a professional website marinetraffic com 2019 this method develops a database to integrate and process the data as illustrated in fig 1 the overview of the proposed method is presented as show in fig 1 the method consists of three key steps 1 handling event identification firstly the stationary events with berthing location and time in the handled berthing area are detected by ships gps trace then the handling events are extracted from the whole stationary events by merging and filtering 2 handling quantity estimation firstly svm support vector machine classifiers and regression equation are trained to divide the tankers into several tonnages by considering the tankers lengths and widths since the efficiency is determined by its tonnage to a great extent then a mathematical formulation is modeled to solve the handling efficiency and time and then calculate the handling quantity as the product of the corresponding handling efficiency and time 3 port performance measurement based on the former two phases this method aggregates identified handling events and the corresponding handling quantity onto the port level in chronological order so as to estimate the values of the key performance indicators 3 1 step 1 handling event identification to identify handling events in the specific port this step first screens out the ais data whose locations are in the handled berthing area of the port in order to exclude all other situations except for passing handling events short stay and auxiliary towing an algorithm is designed to detect the whole stationary event by ships gps positions and the corresponding timestamps finally the handling events are extracted from the whole stationary events by merging and filtering 3 1 1 stationary event detection s1 1 there are three challenges to detect the stationary events in a small area 1 ais data generally misses and has noisy occurring during collection transmission and reception as a result the time interval of some ais data become larger and ais data has an error of about 10 m in reporting gps positions and an error of speeds harati mokhtari et al 2007 chen et al 2016 making it difficult to detect stationary events 2 the same ship may be handled several times at the same port for a period of time so this method should not only consider the change of ships gps positions but also the corresponding timestamps and 3 the entry and departure status of some ships may not be observed in a small area due to the ships may entry or leave the area during the time interval of ais to address the above challenges this section designs an algorithm to detect the stationary events the traces data of ship i from ais data in port k during period l is aggregated in chronological order the trajectories of ship i detected in port k during period l can be described by a set 1 tr i k l t r i j k l tr i j k l l a t i j k l lng i j k l t i j k l d i j k l j 1 2 3 n i k l where t r i j k l is the j t h trace of ship i in port k during period l and l a t i j k l l n g i j k l t i j k l and d i j k l replace the corresponding latitude longitude timestamp and destination n i k l is the traces number of ship i in port k during period l the distance between the j t h and j 1 t h trace of ship i in port k during period l can be calculated as 2 d i j k l 6371004 arccos sin radians lat i j k l sin radians lat i j 1 k l cos radians lat i j k l cos radians lat i j 1 k l cos radians lng i j k l lng i j 1 k l set d i k l d i j k l j 1 2 3 n i k l 1 as the set of distance of each adjacent trace of ship i in port k during period l as shown in fig 2 the status of ship i during t i j k l to t i j 1 k l can be judged based on the interval time and distance 1 ship i was regarded as stationary if the interval distance was shorter than the interval distance threshold δ d and the interval time was shorter than the interval time threshold δ t 2 ship i was defaulted to leave port k at t i j k l and arrive at port k again at t i j 1 k l if t i j 1 k l t i j k l δ t 3 ship i was defaulted to move during t i j k l to t i j 1 k l if d i j k l δ d and t i j 1 k l t i j k l δ t therefore t r i j 1 k l should be recorded in the next event this method sets the thresholds of handling event identification algorithm using an easily implemented experimental method zhang et al 2019 to determine the value of δ d and δ t increase δ d from a small initial value and check the identified events amount while keeping δ t as 400 min when the number maintains stable the proper value for δ d is determined in the same way set δ t with the determined δ d according to the above analysis an algorithm is designed to detect the stationary events as shown in fig 2 therefore the berthing time t b i e k l position l a t i e k l l n g i e k l destination d i e k l and end timestamp t i e k l e n d of each stationary event of ship i in port k during period l are derived map each event i d i e k l l a t i e k l l n g i e k l d i e k l t i e k l e n d t b i e k l in port k during period l where i d i e k l is the unique ship identification 3 1 2 handling event extracting s1 2 due to the noise of ais data for some pairs of adjacent stationary events of the same ship the interval time may be less than δ t and their geographic distance may be less than δ d as shown in fig 3 this situation is blamed on ais data noise so merge these stationary events into a new event i d i e k l l a t i e 1 k l l n g i e 1 k l d i e 1 k l t i e 1 k l e n d t b i e k l t b i e 1 k l in other words t r i j k l is ignored as noise the algorithm is verified to become more accurate after removing noise after stationary events merging this study uses the exclusive method to identify handling events from the whole stationary events detected the berthing time of these events can be clearly classified into three categories including 1 dozens of minutes 2 several hours to four days and 3 longer time therefore stationary events with a berthing time of dozen minutes are regarded as short stay the ships almost staying at the port all the time are regarded auxiliary barge so the stationary events of these ships are regarded as auxiliary towing other stationary events which take several hours to four days are regarded as handling events finally this paper gains all of handling events in chronological order with the corresponding id position end timestamp and berthing duration in port k during period l i e 3 h h k l id h k l l a t h k l ln g h k l d h k l t e n d h k l t b h k l here h h k l denotes the h t h handling event in port k during period l set the nearest berth to the location of h h k l as the corresponding handled berth therefore 4 h h k l id h k l b h k l d h k l t e n d h k l t b h k l here b h k l denotes the handled berth of h t h handling event in port k during period l 3 2 step 2 handling quantity estimation this section aims to estimate the handling efficiency and time since the handling quantity can be calculated as the product of the corresponding handling efficiency and handling time directly this step first classifies the tankers into different tonnages to determine the handling efficiency level and then designs a mathematical formulation to estimate the handling efficiency and time of each handling event by minimizing the differences between the estimated handling quantity and the published statistical data 3 2 1 tanker classification by tonnage s2 1 for handling efficiency estimation handling event of the tanker is done using the loading machine including loading arm or hose and the berths are equipped with different types and quantities of loading machines based on the berths tonnages china national standards 2013 therefore this paper trains svm classifiers to classify the tankers into different tonnage levels according to their lengths and widths or dwts some of dwts are unobtainable to be more specific the method divides the tankers into 14 ranges according to tonnages including 1000 t 1500 t 2000 t 1501 t 2500 t 3000 t 2501 t 4500 t 5000 t 4501 t 7500 t 10 000 t 7501 t 12 500 t 20 000 t 12 501 t 27 500 t 30 000 t 27 501 t 45 000 t 50 000 t 45 001 t 65 000 t 80 000 t 65 001 t 85 000 t 10 000 t 85 001 t 105 000 t 120 000 t 105 001 t 135 000 t 150 000 t 135 001 t 185 000 t 250 000 t 185001 t 275 000 t and 300 000 t 275 001 t 375 000 t according to the dcglsp denote these tonnages as tonnage c c 1000 2000 3000 300000 respectively for the ship with tonnage 10 000 t its dwt can be directly retrieved from marinetraffic com 2019 or lloyd s register of shipping cheng et al 2018 for the ship with tonnage 10 000 t existing research estimates ship dwt by linear regression considering ship length and width however this study finds the linear regression only applicable to the ship with tonnage 3000 t through practice therefore as shown in the fig 4 this study first uses the features length and width of the detected ships whose dwt can be gained to train an svm classifier classifier 1 with a manually labeled dataset of tonnage levels and uses the trained model to separate the tankers with tonnage 3000 t from other tankers tong and koller 2001 rabaoui et al 2007 for the ship with tonnage 3000 t this method estimates its dwt by linear regression and classifies it into tonnage 1000 2000 or 3000 based on the estimated dwt for the ship with tonnage 3000 t this method trains another svm classifier classifier 2 to divide the tankers into tonnage 5000 t and tonnage 10 000 t for the ship with tonnage 10 000 t is classified according to its real dwt directly based on the above it is ready to complete the classification for every ship and even every event 3 2 2 mathematical formulation s2 2 to estimate the handling efficiency and time a mathematical formulation is designed by minimizing the differences between the estimated handling quantity and the published statistical data as follows this method assumes the handling events with the same tonnages in the same port have the same efficiency parameters q s k l the statistical throughput in port k during period l t b h k l the berthing time of h h k l t h k l p the processing time for start and end of h h k l t h k l f the joint inspection and public assessment time of h h k l e c m i n e c m a x the range of the handling efficiency with tonnage c c 1000 2000 3000 300000 variables e c k the handling efficiency for handling event with tonnage c in port k c 1000 2000 3000 300000 e c h k l the handling efficiency for handling event h h k l here c h k l is the tonnage of h h k l e c h k l e c k when the tonnage of the handled ship is c c 1000 2000 3000 300000 t h k l w the waiting time after completion of h h k l modeling 5 m i n l h h k l e c h k l t b h k l t h k l p t h k l f t h k l w q s k l 2 q s k l 2 6 e c min e c k e c max c 1000 2000 3000 300000 7 e c k e c 1 k c 1000 2000 3000 300000 8 t h k l w 0 i f c h k l 3000 t k w i f c h k l 3000 t k w 0 1 h 2 h 24 h objective 5 minimizes the sum of the differences between the estimated handling quantity and the published statistical data here t b h k l t h k l p t h k l f t h k l w represents the handling time of h h k l generally the ship would not be handled in the whole berthing time during the berthing there are 3 non handling times including the processing time for the start and end for each ship the joint inspection and public assessment time for the foreign trade ship and the waiting time after completion for a larger ship this method calculates the handling time by subtracting these non handling times thus e c h k l t b h k l t h k l p t h k l f t h k l w is the handling quantity of h h k l constraint 6 keeps the handling efficiencies in their reasonable ranges respectively constraint 7 ensures handling events with larger tonnage correspond to larger handling efficiency in the same oil port constraint 8 assumes the ship with tonnage 3000 t can leave the port after completion directly and the waiting time after completion of other ships to be a uniform value t k w generally large ship cannot leave the port until the water depth is safe set the range of t k w from 0 to 24 h since the tidal cycle is 24 h to facilitate the solution set the waiting time to be an integer the accumulated handling time with different tonnage in port k during period l can be gained denoted by t k l c as long as the value of t k w is determined 9 t k l c c h k l c t b h k l t h k l p t h k l f t h k l w therefore the modeling becomes a quadratic programming qp problem whose constraints are constraints 6 and 7 and objective is 10 m i n l c e c k t k l c q s k l q s k l 2 here c e c k t k l c is the estimated handling quantity in port k during period l the optimal solution and the optimal value of the qp problem can be gained directly by some off the shelf optimization tools such as cplex seijo and sen 2011 set t k w as 1 2 3 24 respectively to gain 24 optimal solutions and the optimal values set the minimum optimal value as the optimal value of the modeling and the corresponding optimal solution is the optimal solution of modeling therefore the estimated values of handling efficiency and time are gained and the quantity of each handling event can be calculated as the product of the corresponding handling efficiency and handling time directly the range of t h k l f is from 2 to 5 h and the range of t h k l p is from 0 75 to 2 h china national standards 2013 the method sets 1 t h k l f as 0 for domestic ship and set t h k l f as 4 h for foreign trade ship this method judges whether the ship is a domestic trade ship according to whether its destination after handling is domestic 2 and t h k l p as 2 h this setting would cause little error since the ranges of t h k l f and t h k l p are much smaller compared the whole berthing time the average berthing time of the case is 21 2 h now determine the range of the handling efficiency e c m i n e c m a x the ranges of handling efficiency are referred to 1 the arrangement parameters of loading machine in tanker berth shown in table 1 2 the flow velocity is in the range from 0 8 to 4 5 m s 1 since the average economic flow velocity of pipelines is in the range from 0 8 to 3 m s 1 and the safe flow velocity is less than 4 5 m s 1 3 and the density of the main goods ρ kg l 1 china national standards 2013 according to the analysis above the range for each handling efficiency is gained as shown in table 2 3 3 step 3 port performance measurement this section aims to measure the performance of different ports quantitatively this step first aggregates handling events and their corresponding handling quantity in chronological order and then deduces a set of key performance indicators of the port as follows 3 3 1 ship traffic s3 1 iincludes the number of handling events denoted by n k l and the total number of ship visits in the port k during period l denoted by v k l ship traffic is crucial to measure the port s regional competitiveness connectivity to other ports and the risk of the port the handling events amount can be extracted from the handling event identification results directly this method identifies ship visit by the method as following t r i j k l and t r i j 1 k l are defaulted to be in the same ship visit if the time interval was less than threshold δ t otherwise ship i was defaulted to leave port k at t i j k l and arrived at port k again at t i j 1 k l therefore the whole ship visits in the proximity of the berth during period l can be identified this method also records the detailed monthly handling events amount with different tonnage to analyze the temporal characteristics and then provide reference for port work arrangement 3 3 2 berth utilization and allocation s3 2 which can be widely used in berth location strategy and auxiliary berth planning berth utilization is the percentage of time that the berths are occupied by ships during a period of time berth allocation presents not only which tonnages of tankers are handled in each tonnage of berth but also the contribution of these tankers to the utilization of each tonnage of berth this method calculates berth utilization on the tonnage basis instead of on the per berth basis by the handling event identification results this method first accumulates the berthing time of all the handling events in the berths with tonnage c as 11 t b c c b h k l c t b h k l c 1000 2000 3000 300000 here c b h k l is the tonnage of the handled berth of h h k l it is worth noting that c b h k l c h k l in which c h k l is the tonnage of the handled ship of h h k l there may be some smaller ships berthing at some larger berths or some larger ships berthing at some smaller berths finally this method calculates the berth utilization with tonnage c denoted by u c as the ratio of the average berth utilization time to the duration of the given period l as 12 u c t b c n b c l 100 c 1000 2000 3000 300000 here n b c is the number of the berths with tonnage c the estimated utilization may be underestimated since a large ship may occupy more than one berth while this method just recorded the nearest one as the handled berth in addition this method sets the berth allocation as the contribution of tankers with tonnage c i to the utilization of berth with tonnage c b 13 u c b c i c b h k l c b c h k l c i t b h k l n b c l 100 c i c b 1000 2000 3000 300000 3 3 3 handling efficiency s3 3 defined as the handling quantity per hour during handling in port k is the variable e c k of the modeling in step 2 2 mathematical formulation in section 3 2 this indicator is a key factor for vessel scheduling port selection and spillage estimation 3 3 4 throughput s3 4 defined as the handling quantity handled in terminal or port k during period l the estimated throughput can be used to verify the authenticity of the declaration and find the potential smuggling of hazardous materials this method calculates the handling quantity as the product of the corresponding handling efficiency and time the throughput of terminal or port k during period l can be gained by accumulating the corresponding handling quantity as 14 q e k l c e c t k l c 3 3 5 oil spill risk s3 5 defined as the mathematical expectation of spillage during handling which is helpful to judge whether the risk is acceptable and find the weakness of the safety this method estimates the probability of an oil spill and spillage in different scenarios during handling by a general quantitative risk analysis method as shown in table 3 the information can be used to find the weakness of the safety management so as to control the risk table 3 shows the considering scenarios of every handling event including loading arm total or partial rupture hose total or partial rupture ship ship collision during discharging collision and grounding during moving to from berth the probability of collision and grounding during moving to from berth is based on hse 1978 since it makes more detail analysis of the probability of hull failure the other parameters are both based on bevi 2009 due to it is more recent every loading arm or hose rupture lead to an oil spill so their probabilities are equal to the probabilities of oil spill the probability of major minor spill under the condition of collision and grounding and is determined by the ship type and can refer to the values in bevi 2009 from the analysis above the probability of each initiating event the probability of the corresponding oil spill and general spillage can be calculated by inputting the ship traffic berthing time handling time handling efficiency and ship type into the model therefore the oil spill risk in port k during period l can be gained as 15 r isk k l s p k l s o k l s where p k l s is the probability of oil spill in scenario s in port k during period l o k l s is the corresponding spillage and p k l s o k l s is the corresponding oil spill risk finally the oil spill risk in each scenario is assessed based on risk matrix jtt1143 2017 as shown in fig 7 e the consequence with spillage 50 t is considered as minor the probability which is less than 0 001 per year is considered as especially low based on the combination of probability and consequence category the risk is classified into be negligible low acceptable middle and unacceptable high according to the analysis above the accuracy of these indicators can be guaranteed as long as this study can identify handling events including its berthing time and location and estimate the corresponding quantity precisely 4 case study g terminal at guangzhou port g terminal gt is the one of the largest oil terminals in guangzhou there are 2 berths with tonnage 1000 t 4 berths with tonnage 2000 t 2 berths with tonnage 3000 t and 1 berth with tonnage 80 000 t in gt as the public waters of nansha huangpu dongguan and other large container terminals guangzhou port seaward waterway has certain limitation in terms of channel depth and width in order to maintain the fair use of the seaward waterway and the normal order of transport all foreign ships and chinese ships with dwt 3000 t denoted by bss are required to submit forecast data 72 h prior to arrival guangzhou port communication dispatch center formulates and publishes the general plan for shipping in and out of the sea channel with actual arrival and departure timestamps of every bs in guangzhou port according to the ship arrival forecast timestamp since april 1 2007 therefore the accuracy of handling event with dwt 3000 t identification is able to be verified in gt in this section the whole year ais data of gt in 2018 whose interval time is 5 min is used to illustrate the feasibility and reliability of the proposed method the number and tonnage of berth and monthly throughput statistical data are provided from gt the handling events with dwt 3000 t record with the ship s id and handling timestamp is provide by guangzhou port communication dispatch center gzport 2019 4 1 handling event identification results this section first sets the thresholds of handling event identification algorithm then the algorithm is verified to be accurate by comparing the actual handling events with identified events solved by the algorithm including their arrival and departure timestamps to determine the value of δ d and δ t increase δ d from a small initial value and check the handling events number while keeping δ t as 400 min in the study area when the number becomes steady the proper value for δ d is determined the relationship between the event amount and δ d is shown in fig 5 a it can be seen that the number of events starts keeping steady from 20 m so set δ d as 20 m in this case in the same way set δ t as 300 min as shown in fig 5 b this case can just verify handling event identification of foreign ships or chinese ships with dwt 3000 t known as bss since the operation of the other ships is not recorded in gt in table 4 n g l in the third row represents the number of handling events recorded in the master plan in gt in l t h month of 2018 then check how many of these handling events can be identified by the proposed method and set this number as n g l recall g l is the ratio of n g l to n g l n g l is the number of handling events identified by ais p r e c i s i o n g l is the ratio of n x 1 to n g l for instance in april there are 27 handling events recorded in the master plan among these 27 handling events this method can just check 26 events from the ais data and the corresponding r e c a l l g l is 96 there are 27 events identified by ais in april which means there is 1 event identified by ais but not recorded in the master plan and the p r e c i s i o n g l is 99 from table 4 it can be found that 96 of handling events recorded can be identified and 99 of handling events identified can be checked out in the master plan in 2018 it means the handling events recorded and the identification results were almost one to one there are few handling events which are either recorded but cannot be identified or identified but not recorded in addition the proposed method can make an accurate identification of handling events with its initial and end timestamp and location the arrival and departure timestamps announced by port authority is very close to those identified from the ais the error of each arrival or departure timestamp is less than 1 h and the average berthing time of the case is 14 h therefore the absolute relative error of berthing time is less than 14 3 moreover most of the identified locations is clearly close to one of the given berth therefore the estimation of ship traffic and berth utilization and allocation is accurate 4 2 handling quantity estimation results in this section the monthly throughput estimation of gt is evaluated the evaluation on a terminal level is performed since handling quantity of each handling event is not available before handling efficiency estimation it is essential to make sure the tonnage of each ship are corroborated the dwts of some ships arriving in gt in 2018 can be checked from marinetraffic com 2019 including 71 ships with tonnage 3000 t 84 ships with tonnage 5000 t and the whole ships with tonnage 10 000 t based on this information train classifier 1 and 2 their precision recall and the contribution rates of the predictors are shown in table 5 then classifiers are applied to classify the other handled ships recorded in ais data in gt in 2018 for the ship with tonnage 3000 t the dwt is estimated using a linear regression with the length and width and gains the linear regression equation as follows 16 dwt 2907 71 15 l e n g t h in eq 16 the r squared is 87 6 the p value of intercept and length are 3 13 10 13 and 2 09 10 24 respectively finally to classify the ships with tonnage 3000 t based on their estimated dwts and ships with tonnage 10 000 t based on their real dwts therefore the classification of all ships is completed now to set ρ as 0 738 kg l 1 since the main goods are refined oil in gt referring to table 2 the range of the handling efficiency can be gained and shown in the second row of table 6 then the 6 months 1st 2nd 4th 9th 10th 11th month whose accumulated handling time of each tonnage varies greatly are used to estimate the handling efficiency and waiting time after completion by the modeling in step 2 2 mathematical formulation section 3 2 and the other data for evaluation therefore the optimal solutions for gt are gained as shown in the last row of table 6 the validity of the estimated handling efficiency and non handling time is checked from table 6 it can be found that 1 the selected t k w for gt was exactly between the mean 5 6 h and median 4 h of its real world waiting time which can be gained from the master plan of guangzhou port gzport 2019 2 a large proportion of the petrochemical oil in guangdong province depends on imports therefore most of handling events of bss were unloading which would generally cause lower handling efficiency china national standards 2013 which was consistent with the efficiency selected in the table 6 exactly estimate the throughput handled in the other months in gt using the optimal solution estimated handling efficiency and waiting time results of gt are shown in the fig 6 it can be found 1 most of the monthly apes absolute percentage error were slight and the ape of the whole year was 0 94 in gt by calculating 2 the estimated throughput of december in gt was significantly larger than the corresponding statistical throughput which may be attributed to the delayed statistic at the end of the year it is worth noting that these statistical data may be delayed which will result in difference between statistical and estimated data especially in a short time period 3 the estimated throughput of february in gt was significantly smaller than the corresponding statistical throughput which may be attributed to the higher handling efficiency before the spring festival which is the biggest festival in china because the estimated handling efficiency was the average value during the given period the throughput would be underestimated when the real handling efficiency is higher than the average value 4 3 port performance measurement results this section presents the key performance indicators in gt 2018 as shown in fig 7 1 ship traffic ship traffic includes the number of handling events and ship visits the whole number of handling events is 1324 and the number of ship visits is 6111 the detailed monthly handling events of different tonnages are useful to analyze the temporal characteristics as shown in fig 7 a it can be found 1 the ships with tonnage 3000 t account for the vast majority of all handled ships 2 the monthly variation of handling events with tonnage 3000 t is slower and the number in the second half of 2018 is significantly higher than that in the first half 3 the monthly number of handling events with tonnage 3000 t fluctuates greatly the amounts of february july and september are significantly smaller and the amounts of april and october are significantly larger 2 berth utilization and allocation the berth utilization of gt is calculated by the eq 12 as shown in fig 7 b it can be found that 1 except for the berth with tonnage 80 000 t in gt the utilization rates of other berths are low continuously 2 the berth with tonnage 3000 t in gt is in short supply there are 2 3 of its monthly utilization are higher than the optimal empirical value 60 radimilović and jovanović 2006 the berth allocation of gt is calculated by the eq 13 as shown in fig 7 c fig 7 c presents not only what tonnage of ship is handled at the berth with each tonnage but also the contribution of these ships to the utilization of the berth with each tonnage for instance the berth utilization with tonnage 1000 t is 24 and about 4 7 of this utilization is contributed by handling events with tonnage 1000 t in gt it can be found some unreasonable situations in the berth allocation on the one hand smaller ship berthed at larger berth which would result in the higher handling efficiency but with waste of resources on the other hand larger ship berthed at smaller berth which would increase the possibility of grounding and sinking such as about 3 7 of the berth with tonnage 2000 t utilization was contributed by the smaller ship and about 1 5 of the berth with tonnage 3000 t utilization was contributed by the larger ship all of this information is a key reference for oil port upgrading and rebuilding 3 handling efficiency the handling efficiency is the variable e c of the modeling c 3000 5000 10000 300000 the handling efficiency in gt by 2018 is extracted from the handling quantity estimation results as shown table 6 normalize the handling efficiency of gt by min max normalization as shown in table 7 it can be found all of the normalized values of handling efficiency for gt are very low 4 throughput fig 7 d shows the estimated monthly throughput with different tonnages it can be found 1 the throughput of gt is mainly contributed by the ships with tonnage 3000 t although the corresponding handling events amount is significantly less than that of ships with tonnage 3000 t 2 the fluctuation of throughput is similar to the handling events amount on the whole reaching the lowest value in february and the higher value in april may and october 5 oil spill risk half of the handling events are assumed to be handled by loading arm and half of the handling events are assumed to be handled by hose since the loading arm accounts for half of the all loading machine in gt the ship type is set as double hull liquid tanker according to the requirements of the ministry of transport single hull chemical ships and single hull oil ships with dwt 600 t are prohibited from entering guangzhou port from january 1 2016 the berthing time and handling time in gt by 2018 are calculated to be 18 492 68 h and 16 201 21 h respectively by accumulated the handling events input the total berthing time 18492 68 h handling time 16 201 21 h number of handling events 1324 total number of ship visits 6111 in 2018 and ship type double hull liquid tanker into the model in section 3 3 therefore the possibility of initiating event and the possibility of an oil spill in different scenarios in gt can be gained set the oil flow rate as the average handling efficiency 265 t h 1 and the density of the goods as 0 738 kg l 1 the spillage in every scenario can be calculated as well as the corresponding oil spill risk in gt as shown in table 8 from table 8 collision and grounding while tanker moving to or from berth is the most frequent accident gt would have 0 33100 such accident per year fortunately not every accident would lead to oil spills there are 0 00199 minor spill and 0 00050 major spill per year in gt result from collision and grounding while tanker moving to or from berth the annual oil spill risk during handling can be calculated to be 0 63367 t by eq 15 finally the oil spill risk in each scenario is assessed based on risk matrix jtt1143 2017 as shown in fig 7 e it can be found the risk caused by loading machine partial rupture is in the acceptable middle risk area and risks in the other scenarios are in the negligible low risk area 5 discussion the method is a novel real time low cost and independent method to estimate oil port risk and efficiency performance indicators the common indicators including ship traffic the number of handling events and ship visits berth utilization and allocation berthing time and berth handling efficiency throughput and oil spill risk were extracted from the handling event identification and handling quantity estimation results the accuracy of these indicators has been guaranteed by the accurate handling events identification and handling quantity estimation results the results are helpful for schedule optimization hazardous material surveillance operation planning berth upgrade emergency facilities setting and digging out the unacceptable risk which is crucial to control risk and optimize operation for the handling event identification chen et al 2016b has designed a method to identify the handling events in container port this paper proposed a novel method based on it but differs in the following five points 1 this method first screened out the ais data whose location was in the handled berthing area instead of the whole terminal in order to exclude all other situations except for handling events short stay and auxiliary towing therefore the handling events can be extracted by only considering the berthing time instead of training a classifier 2 the proposed method introduced the interval time threshold to avoid the adjacent events whose ais data during entering and leaving the berthing area was lost are merged 3 this method merged the adjacent stationary events which were broken up by mistake due to the ais data noise as shown in fig 3 4 this study set the values of the interval time and distance threshold in a more reasonable way see fig 5 instead of setting the threshold as the experience value and 5 the precision 99 and recall 96 of the proposed method see table 4 were both higher than precision 91 and recall 94 of the existing method on a yearly basis the handling events recorded and the identification results were almost one to one as shown in table 4 which is helpful for schedule optimization and traffic surveillance by digging out the potential dishonest and illegal ships for the few ships which were forecasted to arrive at gt for handling but could not be identified there might be two reasons to explain this situation 1 the ship was handled indeed while did not open the ais or the ais data was miss during transmission 2 the ship applied for handling but was not handled in fact which has occupied the using time of the public waters of the sea channel in the master plan and cancelled its arrival without timely notice for guangzhou port communication dispatch center to adjust the scheduling plan would lead to the waste of shipping channel resources therefore the port authority should formulate regulations to prevent such behavior for example the punitive waiting time could be added for the ship at the next application for arrival deduct the ship s credit score and so on according to the regulatory requirements in china all round the clock video monitoring data of all berths in the oil port must be connected to the port regulatory system port authorities can verify whether a ship has arrived at the port by checking the surveillance video of the berth in the day the ship is expected to arrive at the port the few bss which were identified by ais but not recorded in the master plan were the potential illegal arrivals such as there were 2 bss identified to be handled in gt in november 2018 but not recorded as shown in table 4 the port can directly check the illegal arrival ships from the monitoring record of these ships in the identified timestamp instead of the whole record unfortunately this paper could only find the potential illegal arrival bss due to the fact that the arrival record of the ships with dwt 3000 t was not available for the general public according to china s regulatory requirements on hazardous materials terminals each handling event should be declared to the ministry of transports including the ship name arrival and departure timestamps handling quantity and so on therefore the ministry of transports can find all potential illegal handling events by comparing the identification results and the declaration records in addition it verified the proposed method can make an accurate identification of every handling event with its initial and end timestamp which can be used to identify whether the ship arrives or leaves at the safe time this identified method is also applicable to other types of ports it means this method can be used to estimate the ship traffic and berth utilization and allocation in other types of ports the monthly handling events amount and throughput with different tonnage as shown in fig 7 a and d is helpful for operation planning by finding the temporal characteristics generally the tankers with tonnage 3000 t connect with major ports worldwide for import while the tankers with tonnage 3000 t deliver goods to a continent or region in china because most of the oil in china is imported from the distribution of the handling events with tonnage 3000 t it suggested the oil import was relatively stable in addition the demand of oil import in the second half of 2018 was significantly higher than that in the first half the monthly handling events with tonnage 3000 t fluctuated greatly this was mainly due to inactive cargo transportation during greater typhoons in july and september while the relatively greater human activities during the long public holiday in april tomb sweeping day and labor day and october national day for both tonnages of events there was a sharp drop from january to february due to the port suspension of business in the long public holiday of the spring festival therefore some of the busier work such as rehearsing inspection and upgrading can be arranged in the typhoon season before the public holiday the port should reserve energy to meet the busy work the ship companies should try the best to avoid shipping during the spring festival the monthly berth utilization as shown in fig 7 b can be used to find the berth with continuous underutilization and berth with continuous excessive utilization so as to provide reasonable advices for berth location strategy and auxiliary berth planning except the berth with tonnage 80 000 t in gt the utilization rates of other berths were far lower than their optimal empirical values around 60 in every month radimilović and jovanović 2006 moreover the berth with tonnage 3000 t in gt was in short supply there were 2 3 of its monthly utilization were higher than the optimal empirical value therefore gt should tend to upgrade the smaller berths into larger berths in the rebuilding plan if the handling quantity with different tonnages would not be changed how to increase the large berth to answer this question fig 7 c showed more detailed berth allocations it can be found that 1 for all handling events with tonnage 3000 t only part of handling events with tonnage 5000 t were handled at the smaller berth other events with tonnage 3000 t were all handled at the berth with tonnage 80 000 t 2 for the two berths with tonnage 3000 t there were 11 12 of the monthly berth utilizations were lower than 30 and for the four berths with tonnage 2000 t all of the monthly berth utilizations were lower than 25 3 one of the berths with tonnage 3000 t and one of the berths with tonnage 2000 t are geographically adjacent therefore it would be better to merge the adjacent berths one of the berth with tonnage 3000 t and one of the berth with tonnage 2000 t into the berth with tonnage 5000 t to ease pressure of the berth with tonnage 80 000 t without increasing pressure on the other berths with tonnage 2000 t and 3000 t traditionally shipping companies estimate the handling efficiency by considering the facility of ports however it is difficult to gain accurate handling efficiency since the range of this indicator is too large as shown in table 6 table 7 showed the min max normalized values of the handling efficiency in gt are lower which might result from there were fewer loading arms matching with the actual cargo in the berths generally every loading arm can only handle the cargo of the specified type port would design enough loading arms according to the demand of different cargo types however the mismatching gap between actual handled cargos and the loading arms is becoming more and more prominent and this phenomenon should have drawn our attention greatly this paper assumed the handling events with the same tonnages in the same port have the same efficiency therefore the estimated handling efficiency is the average handling efficiency with the same tonnage in fact combined with the non handling time the berthing time can be estimated which is a key reference for vessel scheduling and crucial to choose the suitable oil port for the ship company the estimated throughput can be used to check the reliability of monthly throughput compulsively reported by oil port the relative error obeys a normal distribution by calculating the 95 confidence region of the relative error in the case is 82 75 129 46 it means there would be a possibility of more than 95 that the statistical throughput is lower than the real value if the relative error is larger than 129 46 this is of great significance in preventing some illegal transportation of hazardous materials we acknowledge this method cannot guarantee the accuracy of the estimated handling quantity of every handling event since the actual handling efficiency may be far larger or lower than the average therefore this method can just check the reliability of the declared handling quantity on monthly level this paper estimated the possibilities spillage and risk of offshore oil spill as shown in table 8 the results are helpful to find the main unacceptable risk and set emergency facilities from table 8 it can be found gt could deal with 99 of oil spills if gt was capable of responding to an oil spill of 10 t since 99 of oil spills had a spillage less than 10 t from fig 7 e it can be found only the risk caused by loading machine partial rupture which accounted for more than 90 of the total risk is in the middle risk area and risks in the other scenarios are in the negligible area therefore gt should control the risk caused by machine rupture by strengthening the regular inspection and increasing the emergency response speed from the berth allocation in fig 7 c it can be found in the situation of the larger ship berthing at smaller berth which would increase the possibility of grounding and sinking in the future study oil spill risks with considering this situation should be analyzed 6 conclusions to make accurate quantitative measurements of the oil port risk and efficiency performance this paper proposed a novel real time low cost and independent method to estimate port performance indicators including ship traffic berth utilization and allocation handling efficiency throughput and oil spill risk by ais and maritime open data the proposed method is based on two modules handling event identification and handling quantity estimation to identify the handling event this paper first detected the whole stationary event by considering the interval time and distance between the adjacent ais data whose location were in the handled berths then the handling events with arrival and departure timestamps and location were extracted from the whole stationary events by merging and filtering to estimate the handling quantity this paper first trained svm classifiers and made a linear regression model to divide the tankers into several tonnages to determine the corresponding handling efficiency level then a mathematical formulation was modeled to solve the handling efficiency and time and calculated the handling quantity as the product of the handling efficiency and time finally the key performance indicators were extracted from the handling events identification and handling quantity estimation results an oil terminal in the guangzhou was taken as a case to evaluate the proposed method the results show the proposed method cannot only identify handling events with its initial and end timestamp and location but also can estimate the handling quantity accurately which make sure the accuracy of the estimated key performance indicators these performance indicators are of great significance for shipping companies the estimated handling efficiency can be used as a reference to select more suitable ports for oil port 1 this method is helpful to find the ship applied for handling but is not handled indeed and formulate regulations to prevent such behavior 2 the temporal characteristics of the business revealed by the monthly estimated ship traffic and throughput with different tonnages are useful to the operation plan 3 the matching degree of berth and handling event extracted from the berth utilization and allocation can provide reasonable advice for berth upgrading and rebuilding 4 the possibilities of oil spill and spillage in each scenario during handling can be gained to dig out the unacceptable risk and provide advice for emergency facilities setting for the government this paper can find the potential illegal handling event which is identified by ais but does not submit a declaration or whose statistical throughput is obviously less than the estimated throughput this study can also find in the situation of the larger ship berthing at smaller berth which would increase the oil spill risk in the future study the possibility of grounding and sinking in this situation should be reevaluated by considering the tension of the guard rope or utilizing expert assessments and the corresponding oil spill risk will be reanalyzed in summary the main contributions of this paper include 1 to the best of our knowledge this is the first work on real time oil port performance measurement comparing with the existing methods the proposed method is more low cost and can be used to verify the accuracy of official data 2 the method is verified by a real world case and the results show that the proposed method can give an accurate estimation 3 by these indicators this paper provides some recommendations for hazardous materials surveillance oil port operation optimization risk analysis and control credit authorship contribution statement huiling zhong conceptualization supervision funding acquisition yishu lin methodology writing original draft tsz leung yip conceptualization validation wenxue cai providing data and funding giving suggestions yimiao gu conceptualization supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research is supported by the humanities and social science research foundation of the ministry of education of china grant no 19yja630107 and the youth foundation of the humanities and social sciences research of the ministry of education of china grant no 17yjcgjw002 we acknowledge the two anonymous referees for their valuable comments and suggestions 
