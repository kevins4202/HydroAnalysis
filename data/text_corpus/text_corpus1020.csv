index,text
5100,this study aims to establish the conditional independence structure between regional monthly rainfall and several local meteorological drivers probable predictors to develop a parsimonious prediction model in the framework of bayesian networks bn the chosen study area is the gangetic west bengal gwb region india and the chosen meteorological drivers at the surface and different pressure levels are the 12 probable predictors viz air temperature total precipitable water relative humidity geo potential height zonal wind meridional wind omega and soil moisture each up to a lead time of 6 months making a total of 72 inputs within the bn architecture two heuristic algorithms namely hill climb hc and max min hill climb mmhc were used to establish that a large part 89 for hc and 97 for mmhc of the input information was redundant given the potential predictors that are selected via these algorithms the potential predictors revealed via these algorithms include geo potential height at a pressure of 850 mb total precipitable water and soil moisture each at a lead time of 2 months the selected predictors were further used to develop a prediction model that results in good agreement with the observations additionally two widely used machine learning techniques namely artificial neural networks ann and support vector regression svr were also used to develop standalone models wherein all the 72 probable predictors are used for prediction and also in conjunction with bn i e bn ann and bn svr wherein only the drivers selected via bn are used as predictors the results indicate that the parsimonious models perform better or equally well as the higher dimensional models with refined index of agreement values mdbn 0 824 mdbn ann 0 835 and mdbn svr 0 841 mdann 0 813 mdsvr 0 823 and normalized mean square error values nmsebn 0 242 nmsebn ann 0 226 and nmsebn svr 0 234 nmseann 0 226 nmsesvr 0 238 for validation period averaged values across three folds the model predictions are further used to categorize monthly rainfall into dry intermediate wet in terms of standardized precipitation anomaly index spai all the approaches show consistent performance with the dry cases being captured slightly better than wet cases keywords bayesian networks hill climb max min hill climb machine learning rainfall gangetic west bengal regional prediction 1 introduction rainfall is one of the most critical components in the hydrological cycle and also a very complex atmospheric phenomenon that varies both spatially and temporally rainfall prediction is always an essential aspect of hydrological science and researchers around the globe are working relentlessly in improving the accuracy of the same rainfall is not only important for agriculture and industry but also responsible for providing stable habitat for a large number of species huang et al 2017 so reliable rainfall prediction is essential for sustainable agriculture environment water resource planning and management moreover in the current scenario of climate change the population around the world is expected to be affected more due to an increase in rainfall driven hydrological extremes like floods and droughts pour et al 2020 rainfall is rather difficult to model since it involves other atmospheric phenomena such as temperature pressure wind speed wind direction and local meteorological characteristics of the rainfall area etc wu et al 2015 monthly rainfall values offer a more definite intra year rainfall scenario than seasonal rainfall values its precise estimation will boost decision making efficiency in agricultural and hydrological fields bagirov et al 2017 for modeling rainfall and complex hydrological extremes viz floods and droughts several data driven approaches machine learning are now found to be useful with the advancement of computing power wherein an attempt is made to understand the pattern of the time series and a relationship is formulated between the inputs and outputs without considering the physical nature of the process some of the promising machine learning ml techniques reported in the hydrology literature are artificial neural networks ann support vector regression svr relevance vector machine rvm genetic programming gp random forest rf k nearest neighbour knn deep learning dl extreme learning machine elm etc ml techniques are often categorized as black box and white box models black box models are those whose inner workings are difficult to understand e g ann svr dl rf etc whereas those ml models which are easier to understand and interpret are termed as white box models e g dt gp generalised linear models glm etc kashid and maity 2012 used gp for modeling and prediction of indian summer monsoon as well as the regional summer monsoon rainfall in india nastos et al 2014 used ann for forecasting maximum daily precipitation ortiz garcía et al 2014 used multi layer perceptron mlp elm decision trees knn and svm for daily precipitation prediction partal et al 2015 used three different wavelet coupled neural networks viz feed forward backpropagation ffbp radial basis neural network rbnn and generalization regression neural network grnn for daily rainfall prediction hernández et al 2016 proposed a dl approach on the basis of autoencoders and ann for prediction of rainfall on a daily scale chanda and maity 2016 applied svr for assessing all india rainfall from associated global climate patterns huang et al 2017 proposed a novel knn algorithm for forecasting rainfall whereas yu et al 2017 parallels the effectiveness of rf and svr for real time radar derived rainfall prediction sachindra et al 2018a compared the effectiveness of rvm with ann svm and gp for downscaling reanalysis data to monthly rainfall zeynoddin et al 2018 and ali et al 2018 developed a non linear elm model and a hybrid online sequential elm respectively for forecasting monthly rainfall cramer et al 2017 made an extensive evaluation of seven ml models markov chain gp svr rbnn m5 rules m5 model trees and knn for rainfall prediction diez sierra and del jesus 2020 evaluated the performance of statistical methods linear models and linear regression with machine learning methods svr knn rf ann weather typing k means for long tern term daily rainfall prediction and classification pour et al 2020 developed three ml models namely svr rf and bayesian ann bann for prediction of rainfall and rainfall related extremes while applying data driven approaches the selection of inputs is often ignored assuming that soft computing models have an intrinsic capabilityof handling such issues remesan and mathew 2015 however the selection of appropriate predictors input variables for hydrological modeling is of utmost prominence for resolving the inherent model complexity reducing dimensionality and even optimizing the time and effort one engages in gathering data some of the established techniques for dimensionality reduction in hydrological applications include principal component analysis pca noori et al 2011 venkateswarlu et al 2020 jeet et al 2019 castro et al 2019 moon et al 2019 rahman et al 2017 independent component analysis ica najafi et al 2011 monira et al 2011 correlation analysis yang et al 2018 snieder et al 2020 partial mutual information pmi monira et al 2011 he et al 2015 snieder et al 2020 stepwise multiple linear regression balabin and smirnov 2011 felipe et al 2015 yang et al 2018 wrapper methods taormina et al 2016 rodriguez galiano et al 2018 genetic algorithm ga dariane and azimi 2016 2018 gobeyn et al 2017 genetic programming gp chadalawada et al 2017 hadi and tombul 2018 pca or ica is a feature extraction method where the data is rotated from one coordinate system to another pca or ica does not result in a feature subset moreover it generates principal components that can explain most of the variance in the data the only way pca or ica can be used as a feature selection method if and only if the most important variables are the ones that happen to have the most variation in them in the case of correlation analysis the predictors are selected on the basis of their correlation coefficient with the predictand yang et al 2018 the main drawback of any correlation based feature selection is to select features that have local influence but they may be overshadowed by strong globally predictive features hall 1999 in the case of pmi the feature selection methodology is similar to correlation analysis the only difference is the use of mutual information instead of the correlation coefficient snieder et al 2020 however while applying to large datasets the computation time required is a burden in the case of pmi may et al 2008 another prevalent technique that has been extensively used in feature selection is the stepwise multiple linear regression they select a subset by fitting a regression model that includes different subsets of available observed covariates and finally selecting the subset with the least standard errors however this may result in the inclusion of correlated predictors and result in increased standard errors which causes the predictions to be very sensitive to model changes felipe et al 2015 for most of the wrapper methods the time required in the learning algorithm is more since every possible scenario of feature subset is being performed by the feature selection search engine inza et al 2000 in case of genetic algorithms the optimal selection of crossovers and mutation is still a problem and has to be fixed experimentally inza et al 2000 in recent years bayesian networks bn which is a class of probabilistic graphical models has been effectively used to select the feature subset in multi dimensionality studies the basis for bn is to develop conditional independence between the predictors and the predictand these networks can limit the number of possible dependencies thus making it easy to analyze the network as a result speeding up computation time and also these networks allows the introduction of expert knowledge vitolo et al 2018 the introduction of expert or domain knowledge can be integrated in bn using the blacklisting and whitelisting techniques this technique separates bn from other wrapper based feature selection methods blacklisting refers to forced exclusion of association between any two variables whereas whitelisting refers to forced inclusion of association between any two variables in fact felipe et al 2015 made a comparative study between stepwise multiple linear regression and bn and found out that bn was approximately 10 more accurate than linear regression in finding out the optimal set of predictors in another study pittavino et al 2017 also compared generalized linear model and bn for selecting dependent variables and found out bn has an advantage over linear model due to its capacity to capture the natural complexity of data more effectively the above mentioned advantages of bn makes it an efficient technique for feature selection and has therefore found tremendous application in different fields viz prediction and modelling of total egg production in meat type quails felipe et al 2015 probabilistic prediction for drought forecasting and outlook combined with quantification of the prediction uncertainties shin et al 2016 analysis of malocclusion data scutari et al 2017 predicting dependencies between hazardous pollutants and population health outcomes vitolo et al 2018 assessment of flood prediction for small rivers to establish the entities and connections with the physical process in a local scale and then using those parameters to construct a global flood prediction model wu et al 2018 assessment of climate change impacts sperotto et al 2019 assessment of hydrological drought using bayesian networks that incorporate dynamic model predictions and a drought propagation relationship shin et al 2020 prediction of probable causes of forest fire sevinc et al 2020 ascertain teleconnections of climate indexes in homogenous precipitation regions ávila and ballari 2020 prediction of food frauds soon 2020 identification of effective variables in the forecasting of debris flows occurrence banihabib et al 2020 based on a review of the latest available scientific literature it was observed that the application of bn in the field of hydrology is still emerging with only a few recent studies reported in the field of hydrological extremes shin et al 2016 2020 wu et al 2018 the exploration of the potential of bn is limited in hydrology either as a tool for resolving the complexity of multivariate systems or as a technique to study the independence structure the scope of the present study includes developing a bayesian network bn to establish the conditional independence structure between monthly rainfall and several meteorological drivers probable predictors to develop a bn based parsimonious prediction model the bn prediction model is compared with standalone ann and svr models and even hybrid models bn ann and bn svr the predictions from the five approaches are further used to categorize dry intermediate wet months in terms of a suitable index this paper is presented in the following manner in section 2 detailed information about the study area and the data used are provided in section 3 the development of the bn model along with the other approaches is explained in section 4 the results and discussions including the performance of all the models are presented which is followed by the concluding remarks 2 data and study area india meteorological department imd has divided india into thirty six homogeneous meteorological sub divisions the state of west bengal in eastern india is thereby divided into two meteorological sub divisions the sub himalayan west bengal and gangetic west bengal gwb fig 1 the present study focuses on gangetic west bengal gwb ranging from latitude 20 15 to 26 988 n and longitude 83 2 to 91 25 e which is the southern part of west bengal comprising of about 66 228 km2 the elevation of the location ranges from 0 to 677 m ghosh 2018 the climate is sub tropical and about 70 of the annual rainfall approx 175 cm in the region occurs during the monsoon season jun jul aug sep the mean annual potential evapotranspiration of the study area ranges from 4 to 7 mm day chattopadhyay et al 2009 in this study the meteorological drivers are selected based on the probable predictors listed in the existing scientific literature for rainfall prediction probable predictors refer to the most influential predictors on the predictand of consideration and a more refined subset of the probable predictors is termed as potential predictors sachindra et al 2018a di et al 2015 used total precipitable water air temperature at 850 mb geo potential height at 300 mb 500 mb and 1000 mb u wind at 350 mb and 850 mb v wind at 300 mb and 850 mb as the predictors of monthly rainfall huang et al 2017 used geo potential height at 1000 mb and 500 mb air temperature at 850 mb relative humidity at 850 mb v wind at 700 mb and total precipitable water ortiz garcía et al 2014 in their study used total precipitable water equivalent potential temperature humidity for water vapour present in the atmosphere temperature wind speed wind direction omega synoptic situation and large scale circulation patterns more so a recent study conducted by mondal et al 2020 observed that temperature humidity omega geopotential height u wind cloud cover momentum flux latent heat flux tropopause height and kinetic energy of wind exhibit positive to negative anomalies with excess normal and deficit rainfall over gangetic west bengal thus in the present study the chosen probable predictors at the surface and different pressure levels are air temperature total precipitable water relative humidity geo potential height zonal wind u wind meridional wind v wind omega rate of change of pressure in a parcel over time dp dt it is the vertical velocity when pressure is used as the vertical coordinate and soil moisture each up to a lead time of 6 months making a total of 72 inputs soil moisture is chosen as a probable predictor as it is known to impact rainfall through complex feedback processes huggannavar and indu 2020 these are obtained from the national centers for environmental prediction department of energy atmospheric model intercomparison project ii ncep doe amip ii data aka reanalysis 2 available at https www esrl noaa gov psd and the climate prediction centre cpc apart from reanalysis 2 other available datasets include 20th century reanalysis 20cr datasets available up to 2012 and experimental extension till 2014 and the era reanalysis datasets however most of the previous studies have used the ncep reanalysis datasets as probable predictors for rainfall prediction wang et al 2013 di et al 2015 huang et al 2017 diez sierra and del jesus 2020 it should be also noted that the portrayal of observed data is best done with reanalysis data pour et al 2020 therefore reanalysis datasets were used in this study for the gridded meteorological products from ncep reanalysis 2 and cpc the data from all the grid points falling within the study area 20 grid points for soil moisture and 2 grid points for all other predictors are spatially averaged to convert it into a single time series so that it commensurate with the rainfall time series the monthly rainfall series for gwb is obtained from the homogeneous rainfall data developed by the indian institute of tropical metrology iitm pune the homogeneous rainfall data was developed by considering 306 rain gauge stations over 30 meteorological subdivisions across the country which covers about 90 of the country the monthly weighted region rain gauge station was developed for each of the 30 meteorological subdivisions by allocating each rain gauge station s weight to the district area ftp www tropmet res in pub data rain readme pdf table 1 summarizes the details of the datasets and their abbreviations used in this study the authors would like to thank noaa oar esrl psl boulder colorado usa and indian institute of tropical metrology pune for providing the necessary datasets 3 methodology this study examines the potential of bayesian networks bn which is a class of graphical model as a mechanism for establishing a conditional independence structure between monthly rainfall and the selected probable predictors hence the development of bns is described in the following subsection further standard machine learning ml techniques such as artificial neural networks ann and support vector regression svr are briefly presented as these are also used to predict monthly rainfall as standalone models as well as in conjunction with bn i e bn ann and bn svr respectively wherein only the drivers selected from bn potential predictors are used as predictors subsequently the performances from the aforementioned five approaches are compared through statistical measures which are explained later in the following subsections 3 1 bayesian networks bn bns are probabilistic graphical models that permit a concise description of the probabilistic relations as directed acyclic graphs dag for a specified set of random variables sperotto et al 2019 the basis for graphical modeling is to establish the conditional independence structure between the probable predictors and the predictand a dag is denoted by g v a where v represents the set of vertices or nodes and a represents the set of directed arcs the vertices denote the predictors and predictand and the arcs indicate the association between them bn depends on the bayes theorem of probability for disseminating information among the nodes the network is solved once the posterior probabilities of all the nodes are calculated using the bayes theorem sperotto et al 2019 bayes theorem is given by 1 p x y p y x p x p y where p x and p y are the probabilities of occurrence of event x and y p x y is the probability of occurrence of event x given that y has already occurred and p y x is the probability of occurrence of event y given that x has already occurred bn demonstrates the probabilistic relationships among a set of variables graphically it is based on the concept of graph theory as well as probability theory the networks are easily understandable because of their graphical representation they can be used to extract information about the relationship between predictors and predictand the exact association among the variables can be learned from the conditional probability table cpt each node has an associated cpt that contains the probability of each state of the variable among the other advantages one of the important ones is that bn can be used both as a feature selection technique as well as for the prediction model as a feature selection technique they efficiently represent the dependencies among the random variables that constitute the problem model a bn in accordance with the dag must follow an acyclic nature when an edge is followed from a node it is not possible to return to the same node though the direction of edges implies a statistical dependency it does not necessarily entail a causal relationship between the nodes sevinc et al 2020 a simple example of a bn is shown in fig 2 when two nodes are connected by an edge the node from where the edge is originating is called the parent node and the node where the edge is terminating is called the child node as seen in fig 2 the network has four nodes a b c and d node a is the parent node of b and c and so nodes b and c are children nodes of a further in the network d and c are the parents of b and d respectively in the figure it is seen that a is connected to b and c so it can be concluded from the network that a is conditionally independent of d given b and c or a is conditionally dependant on b and c given d if we consider that node a is the target variable in the dag then the information from the network indicates that not all the variables in the dag are needed to predict a but only b and c is enough for prediction of a given that d is conditionally independent of a the probabilistic relation or dependencies among random variables nodes can be determined by the joint probability distribution p v given by 2 p v 1 v 2 v n i 1 n p v i p a v i where v i are the nodes and p a v i are the parents of the v i felipe et al 2015 sevinc et al 2020 the dag in fig 2 can be represented as 3 p a b c d p a p b a d p c a p d c the task of fitting a bn is called learning and it consists of two steps a structure learning it consists of identifying the graph structure of the bn for which several algorithms reported in the scientific literature they broadly fall under three categories viz score based algorithms constraint based algorithms and hybrid algorithms nagarajan et al 2013 table 2 shows some of the structure learning algorithms b parameter estimation here the parameters of the networks that are built in the previous step are estimated this task is simplified by the use of markov property score based algorithms assign a score to each variable of the network and then tend to maximize the network by the basic implementation of different heuristic search algorithms such as hill climb hc or tabu search and various genetic algorithms scutari 2010 for instance a function is used to score a network or a dag with respect to the training data and then a search method is used to look for the network with the best score the hc method uses the hill climbing algorithm to search the network with the best score it starts with a completely saturated graph g and the score of this graph is denoted as the maximum score now for every possible arc addition deletion or reversal the score changes and is compared to the maximum score if the score increases then that becomes the maximum score and the dag that is returned becomes the updated network constraint based algorithms learn the network by analyzing the markov property of bn these are based on the inductive causation ic algorithm verma and pearl 1991 hybrid learning algorithms combine the score and constraint based algorithms and produce reliable network structures these algorithms result in a smaller and more regular search space nagarajan et al 2013 the mmhc method which is a hybrid algorithm first learns the network using a constraint based algorithm i e mmpc and then it orients the network using the hc search approach the score function used for scoring the networks is the bayesian information criterion bic bic is a penalized score criterion and is given by 4 bic i 1 n l o g p v i v i p a v i d 2 l o g n where d is the number of parameters of the distribution in this study only score based and the hybrid algorithms have been used because the constraint based algorithms do not necessarily return a dag and as a result interfere with the prediction process the score based algorithm used here is the hill climb hc algorithm that has been widely used for bn studies vitolo et al 2018 the hybrid algorithm used here is the max min hill climb mmhc encompassing max min parent child mmpc and hill climb hc tsamardinos et al 2006 in a bn the information of any node can be predicted according to the fitted network the predicted values are computed by plugging in the new values for the parents of the node in the local probability distribution of node extracted from the fitted network the bnlearn package scutari 2010 in rstudio 3 6 2 is used to develop the bns as well as the prediction models in this study 3 2 artificial neural networks ann ann is a widely used ml technique in hydrological analysis anns are inspired by the neurological structure of the human brain agatonovic kustrin and beresford 2000 these ml techniques are regarded as black box techniques similar to human neurology ann consist of neurons which are considered as the central processing unit which performs a certain operation to produce the desired output from a set of desired inputs ann consists of an input layer hidden layer s and an output layer connected to each other through weights weights are parameter that determines how the neurons effect in converting the input to impact the output a function known as activation function is applied to the output layer the activation function helps in modeling the complex non linear phenomenon which cannot be explained by linear functions however a linear function can also be used as an activation function there are various activation functions viz linear sigmoid or logistic hyperbolic tangent rectified linear unit etc a neural network may consist of more than one hidden layer however the most basic structure of an ann consists of only one hidden layer maier and dandy 2000 in their review of ann models suggested that an ann model with one hidden layer can approximate any function a more detailed internal structure and working of ann can be found in garcia and shigidi 2006 rakesh tanty and desmukh 2015 xiang et al 2018 and khan et al 2019 in the present study the neural network consists of three layers with only one hidden layer sigmoid or logistic function is used as the activation function the number of neurons were varied from 1 to 10 for each network and the most optimal network was selected the traditional backpropagation algorithm rumelhart et al 1986 was adopted as the learning algorithm with a learning rate of 0 001 and the sum of squared error was used as the error function the neuralnet package in rstudio 3 6 2 is used in developing the ann models 3 3 support vector regression svr support vector regression svr is a part of support vector machines svm which was developed by cortes and vapnik 1995 as a non linear generalization algorithm the general concept of svr is that it nonlinearly maps the input data into some high dimensional feature space and solves the linear regression problem in the feature space zhang et al 2018 this concept of mapping the input data is achieved by the kernel trick a kernel function or approximate function helps to create a hyperplane which is a separation line that helps in predicting the target values by differentiating between different types of data then the algorithm tries to decide a boundary layer at a distance from the hyperplane such that data points close to the hyperplane also known as support vectors are within that boundary line in svr choosing the appropriate kernel is very important which helps in mapping the non linearity to linearity in a multi dimensional feature space sachindra et al 2018a raghavendra and deka 2014 in their review of svm applications in hydrology mentioned that for a non linear problem mostly polynomial and radial basis function rbf is used however in most of the hydrological studies rbf kernel was found to be the most effective tian et al 2018a 2018b ferreira et al 2019 das et al 2020 in the present study both the polynomial kernel and rbf kernel was used but the rbf kernel showed better performance in the validation period and the results presented in this study pertain to the rbf kernel the performance comparison of svr models using both these kernels are provided in the appendix section table a1 while training an svr model using an rbf kernel it is imperative to optimize the parameters of svr i e cost function c gamma γ and epsilon ε the cost function is responsible for the smoothness of the approximate function i e a higher value of c will result in an over fitted model the parameter ε controls the width of the boundary layers for fitting more data and the parameter γ defines how far the influence of a single training example reaches with low values meaning far and high values indicating close in the present study the radial basis function rbf is used as the kernel and the hyperparameters are tuned using a grid search algorithm in a grid search algorithm the calibration set is divided into k disjoint subsets of roughly equal size for each fold then k 1 subset is used as training and one subset as testing set mean squared error mse is calculated for each set and the set with the lowest mse is selected as the parameters huang et al 2012 this is one of the simplest and effective search algorithms for tuning hyperparameters barring grid search algorithm other algorithms for optimization of hyperparameters include simplex algorithm sachindra et al 2013 particle swarm optimization zhang et al 2019 genetic algorithm lei and su 2019 etc however the grid search algorithm is known to be one of the most widely used methods to optimize the svr hyperparameters raghavendra and deka 2014 the e1071 package in rstudio 3 6 2 is used for developing the svr models all the data are normalized as a part of the data preparation before applying any of the approaches the purpose of normalization is to change the values of numeric columns in the dataset to a standard scale without distorting differences in the ranges of values since the variables used in the present study have different ranges so it was essential to normalize the data series the results rainfall were later back transformed to the regular scale before performance evaluation for calibration training of the models 70 of the total dataset has been used and the rest 30 for validation this splitting ratio of calibration and validation has been used in several studies das et al 2020 banihabib et al 2020 three fold cross validation was performed for the entire dataset so that each part of the dataset would act as test data in one of the folds 3 4 performance statistics for model evaluation the performance of the aforementioned five approaches is compared using statistical measures coefficient of determination r2 normalized mean square error nmse nash sutcliff efficiency nse nash and sutcliffe 1970 refined index of agreement md willmott et al 2012 and percentage of bias pbias r2 explains the correlation and variability between the observed and predicted data and ranges from 0 to 1 with 1 representing the best fit nmse is calculated as the ratio of mean squared error to the variance of observed rainfall zhang and govindaraju 2000 and it can range from 0 to it is not that sensitive to the order of the data sachindra et al 2018a nse explains the model efficiency and ranges from to 1 with 1 being the optimum value md explains about the agreement between the observed and the predicted models and ranges from 1 to 1 with 1 being the ideal scenario pbias measures the degree of biasness in a model i e the tendency of a model to underestimate or overestimate a scenario from an observed one the optimal pbias value is 0 0 with small magnitude values which indicate precise model simulation the performance measures like r2 nmse nse md can provide an overall indication about the performance of the model and pbias can explain about the biasness of the model equation for all the statistical measures are presented below i coefficient of determination r2 5 r 2 i 1 n x o x o x p x p i 1 n x o x o 2 i 1 n x p x p 2 2 ii normalized mean square error nmse 6 nmse 1 n i 1 n x o x p 2 σ o iii nash sutcliff efficiency nse 7 nse 1 i 1 n x p x o 2 i 1 n x o x o 2 iv refined index of agreement md 8 md 1 i 1 n x p x o 2 i 1 n x o x o w h e n i 1 n x p x o 2 i 1 n x o x o or 9 md 2 i 1 n x o x o i 1 n x p x p 1 w h e n i 1 n x p x o 2 i 1 n x o x o v percentage bias pbias 10 pbias i 1 n x p x o i 1 n x o x 100 where x o 1 n i 1 n x o x p 1 n i 1 n x p x o o b s e r v e d v a l u e x p p r e d i c t e d v a l u e σ o s t a n d a r d d e v i a t i o n o f o b s e r v e d v a l u e and n number of data points 3 5 categorization of dry intermediate and wet months in terms of standardized precipitation anomaly index spai the predicted rainfall is further used to categorize months with below and above normal rainfall standardized precipitation anomaly index spai is used as the index for designating the dry intermediate wet months as it is suitable for regions with periodic precipitation patterns standard precipitation index spi was not used in this study owing to its limitation that in spi a small precipitation deficiency could be seen as a large negative spi for locations with small precipitation variability spai was developed with the aim of overcoming this limitation of spi another drought index that has been used extensively for quantifying drought scenario is the standard precipitation evapotranspiration index spei wherein the difference between the precipitation and the potential evapotranspiration pet is considered however spei also lacks the ability to capture seasonality monish and rehana 2020 made a comparative study between spai and spei and showed that spei was unable to capture the seasonality associated with the indian rainfall patterns so owing to these limitations of spi and spei spai was selected in this study as the index a comprehensive methodology of spai can be found in chanda and maity 2015 spai is obtained similarly for the observed rainfall as well and compared with the predictions the overall flowchart of the adopted methodology is presented in fig 3 4 results and discussions 4 1 potential predictor selection using bayesian networks for developing the bn a total of 72 meteorological drivers are considered in the saturated model which includes the preceding months time series 1 6 month of all the aforementioned 12 variables the current time step of the variables is not considered in the predictor set so that the prediction may be achieved with at least one month lead time the entire dataset is divided into three folds table 3 shows the calibration and validation period of all the three folds the developed bn in fig 4 establishes that although each of the meteorological drivers is a probable predictor the information provided by some of them is redundant given the information from others for instance the use of the hc algorithm presents 8 potential predictors out of 72 predictors that establish a dependence structure with the monthly rainfall target in the case of fold 1 fig 4a in the figure the surface variable names are denoted by alphabets while the pressure variables are denoted by alphabets followed by pressure in figures in mb the last digit in the variable name denotes the lead number of months for example hgt850 2 indicates geopotential height at a pressure of 850 mb at 2 months lead time the use of mmhc as the heuristic search algorithm resulted in only 2 potential predictors out of 72 which is a significant decrease from the hc algorithm it only establishes hgt850 2 and tpw 2 as the potential predictors of rainfall fig 4b it is worthy of note that both these variables were present in the network formed by the hc algorithm as well which is justified as mmhc uses the hc as the search algorithm it establishes that about 89 for hc and 97 for mmhc of the probable predictors are redundant given the predictors that are selected retained from these algorithms in the case of fold 2 hc generates a network with 6 potential predictors which is slightly less than the first fold whereas in fold 3 also 8 potential predictors were identified for mmhc the number of predictors identified is 2 and 1 for the second and third fold respectively table 4 summarizes the predictors identified and the information number of arcs average markov blanket size about the bns obtained via the two algorithms from table 4 it can be observed that in case of hc four predictors are same in all the folds sm 2 tpw 2 at 2 hgt850 2 and in case of mmhc the predictors are same in the first two folds hgt850 2 and tpw 2 thus there is a general agreement in the selected potential predictors in different folds still the variation in the predictors and the uncertainty of the model may be due to the evolution of the hydro climatic associations as found in other time varying hydro climatic studies dutta and maity 2018 moreover the uncertainty can be due to the use of reanalysis data pour et al 2020 the complete network resulting from the hc algorithm is not shown in figures for brevity however since the mmhc algorithm resulted in a smaller network than hc so the whole bn for mmhc algorithm across all the folds are presented in the appendix section figs a1 a2 and a3 it is to be noted that for both the networks hc and mmhc the drivers with lead times of up to 2 months were most influential in general the network established by the mmhc algorithm is smaller than that by the hc algorithm for illustration let us take the case of fold 1 where the total number of arcs produced is 385 for hc while it was only 85 for mmhc the average markov blanket size was 24 3 and 2 99 for hc and mmhc respectively thus about 8 times more in hc compared to mmhc in any bn markov blanket of a node simply refers to the parents and child of that node and all the other nodes sharing a child with that node neighbourhood size and branching factor are related to the immediate neighbour of a node and the number of children at each node respectively though mmhc resulted in a smaller network the prediction performance was found to be better for the hc algorithm and hence further results in the next few subsections of the bn prediction models pertain to the hc algorithm 4 2 comparison of prediction performance from bn and other approaches in addition to the bn approach standalone ann and svr models and also in conjunction with bn i e bn ann and bn svr were used for prediction of monthly rainfall the scatter plots of the validation period of all the models across all the folds are presented in figs 5 7 the plots for the calibration period are not presented for brevity but in general the performances in the calibration period are better than the corresponding validation periods as expected in the scatter plots distinct colours are used to mark the dry intermediate and wet months to assess the performance and each observation is also designated as jjas june july august september and non jjas months this is further described later in this section in the case of fold 1 the scatter plots reveal a similar adequate performance for all the models there is very slight difference between the models in terms of the performance metrics as indicated in table 5 for fold 2 and fold 3 in the validation period the parsimonious models showed slightly better performance in comparison to the higher dimension models as evident from the values of the performance metrics for examining the overall performance of all the models a bar chart depicting all the statistical measures except pbias for calibration as well as validation period is presented shown as the mean of all three folds in fig 8 the performance of the parsimonious models as well as higher dimensional models is more or less comparable this ascertains that bn has the potential to reveal the conditional independence structure from among several probable predictors and weed out the redundant information for the prediction of monthly rainfall this helps to reduce the dimensionality and thereby resolve the complexity of the model in fact a closer examination of fig 8 demonstrates that bn ann and bn svr models performed most satisfactorily with r2 of 0 831 and 0 834 and md being 0 835 and 0 841 respectively in the validation period however in the calibration period ann showed better performance compared to other models with r2 of 0 796 md of 0 813 nse of 0 778 and nmse of 0 0226 but in the validation period the performance of ann was less accurate in terms of all the metrics with r2 of 0 913 md of 0 881 nse of 0 91 and nmse of 0 226 bn ann and bn svr performed similarly in the calibration period as well with r2 of 0 864 and 0 867 and md of 0 86 and 0 863 respectively in terms of model biases also ann showed the best performance with pbias of only 0 06 in the calibration phase followed by bn bn ann bn svr and svr svr model showed little overestimation in the calibration phase fig 9 shows the variation of pbias across each fold for all the models however in the validation phase all the models showed positive or negative biases with the performance of bn ann being the best as compared with other models all the other models performed comparably in terms of pbias fig 9 fig 10 shows the observed and predicted time series of all the models for each fold it is observed that higher dimensional models performed slightly better when it comes to capturing the peaks of the series compared to the parsimonious models including bn for instance in fold 3 in june 84 which is in the validation period the observed rainfall is 538 mm and the closest prediction is 497 mm and 417 mm from ann and svr respectively followed by 398 mm from both bn ann and bn svr which is almost 100 mm less than what predicted from ann in case of the calibration period the peaks or outliers in the models are captured closest by the ann model with observed being 655 mm and predicted being 407 mm for fold 1 this may be attributed to certain predictor predictand related hypersensitivities to different values of predictor data sachindra et al 2018b in general intermediate conditions are estimated closest to observations dry conditions are captured better while wet conditions are underestimated this is true for both the monsoon season jjas as well as other seasons non jjas the performance is similar in terms of all the metrics for all the models in the validation phase the nmse md and nse show minimal variability for all the models however the least deviation from the observation was demonstrated by the bn ann model with pbias of 0 6 and the most deviation from the observed rainfall was shown by the ann model with pbias of 6 2 4 3 classification of dry intermediate and wet months the predicted rainfall from the models is further used for classifying each month into dry intermediate and wet as mentioned earlier spai is used as the index for designating such events to calculate spai the precipitation anomalies are fitted to a single probability distribution several distributions such as gaussian student s t generalized t logistic gumbel pearson type iii and skew power exponential type iii sep3 are checked and sep3 distribution is found to be the best fit for all folds the calculated spai fall into three categories namely dry spai 1 intermediate 0 99 s p a i 0 99 and wet spai 0 99 contingency tables are used to assess the performance of the models in classifying the months with below and above intermediate rainfall the model performance is evaluated in terms of the contingency coefficient c pearson 1904 a higher value of c represents a good association between the observed and predicted categories tables 6 to 10 shows the contingency table for the validation periods all folds for bn bn ann bn svr ann and svr models the ratio of c and cmax is also used as a measure of the degree of association the upper bound of c which is cmax has a constant value of 0 817 since there are only three categorical variables in this study more details about the measures may be found in maity et al 2013 the statistics q which follows a chi square distribution with i 1 j 1 degrees of freedom dof where i and j are the number of categories is also presented so in this study the dof is 4 the p value associated with the statistics specifies the rejection or failing of rejection of the null hypothesis which is the association between observed and predicted categories a low p value indicates that the null hypothesis can be rejected from the contingency tables it is apparent that parsimonious models performed comparably along with higher dimensional ann and svr models this is further signified by the scatter plots refer figs 5 7 wherein the observed categories are colour coded as red dry blue intermediate and green wet for both jjas and non jjas months with solid and hollow circles respectively both from the contingency table and the scatter plots it is evident that all the models performed very satisfactorily and comprehensively showed agreement for the intermediate months among the dry and wet cases almost all the models capture the dry events better the wet events are not well captured particularly in fold 1 with a rather significant deviation from the 45 lines fig 5 moreover in fold 3 it is seen that wet scenarios underestimate high values and dry scenarios overestimate in general fig 7 in general it was observed that the wet scenarios are underestimated whereas the dry scenarios are captured better with slight overestimation a similar observation was found in the study of sachindra et al 2018a this may attribute to the fact that large scale climate information does not provide a variance needed to sufficiently justify the observed variation of the hydroclimate variables in the study area sachindra et al 2018a in general the parsimonious models also showed good degrees of association with comparatively higher c cmax values than the higher dimensional models in a nutshell it can be said that the results of the parsimonious models were comparable with the higher dimensional standalone models the performance of the parsimonious models was also comparable when the classification of drought scenarios was carried out this implies that bn was able to accurately select the feature subset for the prediction of monthly rainfall in the study area also it was found that both ann and svr were able to predict the rainfall of the study region with fewer errors sathish et al 2017 used the box jenkins seasonal arima for forecasting monthly rainfall in gwb and reported the r2 value in the validation period to be 0 742 in another study basak 2020 decomposed the seasonal rainfall data of the gwb into eight empirical time series to show the interannual variability of the rainfall series of gwb they used generalized regression based neural network grnn and simple regression to model the non linear part linear part of the time series respectively and found the correlation coefficient for the validation period to be 0 89 r2 0 79 the performance of the proposed methods in the present study were comparable with the results of the previously reported studies various studies have shown better results of ann and svr in rainfall studies compared to other techniques nastos et al 2014 used ann to predict daily precipitation total in greece successfully and the results obtained were very satisfactory in another study partal et al 2015 compared the usefulness of three different neural networks feed forward backpropagation ffbp radial basis based neural networks and the generalized regression neural network and found that ffbp was the most effective which is also used in the present study in predicting precipitation yu et al 2017 compared the effectiveness of svr and rf in radar derived rainfall forecasting and found that svr was more accurate in the estimation of rainfall cramer et al 2017 compared the predictive scenario of seven ml techniques and found that ann svr and gp showed the best agreement compared to other methods many such studies are reported in the literature which explained the usefulness of ann and svr in rainfall forecasting hence in the present study also the proposed bn based models are compared with state of the art ann and svr models 5 concluding remarks this study proposes bayesian network bn a probabilistic graphical model as a possible mechanism for uncovering the conditional independence structure and developing a parsimonious rainfall prediction model in the gangetic west bengal region in india the conclusions from this study are 1 bn is effectively used to specifically select a limited number of predictors potential predictors from a pool of 72 meteorological drivers probable predictors thus reducing the dimensionality of the problem significantly and providing insights about the critical associations with the drivers among the two heuristics algorithms used for this purpose max min hill climb mmhc resulted in a smaller network but the prediction performance is found to be better for hill climb hc algorithm 2 artificial neural networks ann and support vector regression svr techniques are also used to develop standalone rainfall prediction models with all the 72 predictors as inputs and also in conjunction with bn i e bn ann and bn svr the performance of the parsimonious models is equally satisfactory as the higher dimension models 3 the predicted rainfall from the models is further used for the categorization of dry intermediate wet months in terms of standardized precipitation anomaly index spai all the approaches indicate reasonable performance and show the closest agreement with observations for the intermediate cases and capture the dry months slightly better than the wet months the application of bn can be useful in any complex phenomenon where several variables are identified as probable predictors and there is a need for dimensionality reduction to select the potential predictors for example in hydrology for identifying the potential variables local or global that trigger specific types of droughts in a region however it is to be noted that when bn can establish a graphical representation of joint distributions among a set of variables the same can be achieved by using a copula based approach copulas permit the analysis of the nature of dependency between random variables with no marginal distribution knowledge and even multivariate distribution analyses with some marginal distributions gargouri ellouze and eslamian 2014 future scope of the study includes incorporating copula in bn to establish the conditional dependencies and hence developing a copula based bn guo et al 2019 maity et al 2020 for feature selection in rainfall related studies credit authorship contribution statement prabal das formal analysis investigation writing original draft kironmala chanda conceptualization supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is supported by the department of science and technology india through project number ecr 2017 001880 the authors also acknowledge partial financial support from teqip iii minor research project the authors would also like to thank the anonymous reviewers for their constructive comments in improving this paper appendix 
5100,this study aims to establish the conditional independence structure between regional monthly rainfall and several local meteorological drivers probable predictors to develop a parsimonious prediction model in the framework of bayesian networks bn the chosen study area is the gangetic west bengal gwb region india and the chosen meteorological drivers at the surface and different pressure levels are the 12 probable predictors viz air temperature total precipitable water relative humidity geo potential height zonal wind meridional wind omega and soil moisture each up to a lead time of 6 months making a total of 72 inputs within the bn architecture two heuristic algorithms namely hill climb hc and max min hill climb mmhc were used to establish that a large part 89 for hc and 97 for mmhc of the input information was redundant given the potential predictors that are selected via these algorithms the potential predictors revealed via these algorithms include geo potential height at a pressure of 850 mb total precipitable water and soil moisture each at a lead time of 2 months the selected predictors were further used to develop a prediction model that results in good agreement with the observations additionally two widely used machine learning techniques namely artificial neural networks ann and support vector regression svr were also used to develop standalone models wherein all the 72 probable predictors are used for prediction and also in conjunction with bn i e bn ann and bn svr wherein only the drivers selected via bn are used as predictors the results indicate that the parsimonious models perform better or equally well as the higher dimensional models with refined index of agreement values mdbn 0 824 mdbn ann 0 835 and mdbn svr 0 841 mdann 0 813 mdsvr 0 823 and normalized mean square error values nmsebn 0 242 nmsebn ann 0 226 and nmsebn svr 0 234 nmseann 0 226 nmsesvr 0 238 for validation period averaged values across three folds the model predictions are further used to categorize monthly rainfall into dry intermediate wet in terms of standardized precipitation anomaly index spai all the approaches show consistent performance with the dry cases being captured slightly better than wet cases keywords bayesian networks hill climb max min hill climb machine learning rainfall gangetic west bengal regional prediction 1 introduction rainfall is one of the most critical components in the hydrological cycle and also a very complex atmospheric phenomenon that varies both spatially and temporally rainfall prediction is always an essential aspect of hydrological science and researchers around the globe are working relentlessly in improving the accuracy of the same rainfall is not only important for agriculture and industry but also responsible for providing stable habitat for a large number of species huang et al 2017 so reliable rainfall prediction is essential for sustainable agriculture environment water resource planning and management moreover in the current scenario of climate change the population around the world is expected to be affected more due to an increase in rainfall driven hydrological extremes like floods and droughts pour et al 2020 rainfall is rather difficult to model since it involves other atmospheric phenomena such as temperature pressure wind speed wind direction and local meteorological characteristics of the rainfall area etc wu et al 2015 monthly rainfall values offer a more definite intra year rainfall scenario than seasonal rainfall values its precise estimation will boost decision making efficiency in agricultural and hydrological fields bagirov et al 2017 for modeling rainfall and complex hydrological extremes viz floods and droughts several data driven approaches machine learning are now found to be useful with the advancement of computing power wherein an attempt is made to understand the pattern of the time series and a relationship is formulated between the inputs and outputs without considering the physical nature of the process some of the promising machine learning ml techniques reported in the hydrology literature are artificial neural networks ann support vector regression svr relevance vector machine rvm genetic programming gp random forest rf k nearest neighbour knn deep learning dl extreme learning machine elm etc ml techniques are often categorized as black box and white box models black box models are those whose inner workings are difficult to understand e g ann svr dl rf etc whereas those ml models which are easier to understand and interpret are termed as white box models e g dt gp generalised linear models glm etc kashid and maity 2012 used gp for modeling and prediction of indian summer monsoon as well as the regional summer monsoon rainfall in india nastos et al 2014 used ann for forecasting maximum daily precipitation ortiz garcía et al 2014 used multi layer perceptron mlp elm decision trees knn and svm for daily precipitation prediction partal et al 2015 used three different wavelet coupled neural networks viz feed forward backpropagation ffbp radial basis neural network rbnn and generalization regression neural network grnn for daily rainfall prediction hernández et al 2016 proposed a dl approach on the basis of autoencoders and ann for prediction of rainfall on a daily scale chanda and maity 2016 applied svr for assessing all india rainfall from associated global climate patterns huang et al 2017 proposed a novel knn algorithm for forecasting rainfall whereas yu et al 2017 parallels the effectiveness of rf and svr for real time radar derived rainfall prediction sachindra et al 2018a compared the effectiveness of rvm with ann svm and gp for downscaling reanalysis data to monthly rainfall zeynoddin et al 2018 and ali et al 2018 developed a non linear elm model and a hybrid online sequential elm respectively for forecasting monthly rainfall cramer et al 2017 made an extensive evaluation of seven ml models markov chain gp svr rbnn m5 rules m5 model trees and knn for rainfall prediction diez sierra and del jesus 2020 evaluated the performance of statistical methods linear models and linear regression with machine learning methods svr knn rf ann weather typing k means for long tern term daily rainfall prediction and classification pour et al 2020 developed three ml models namely svr rf and bayesian ann bann for prediction of rainfall and rainfall related extremes while applying data driven approaches the selection of inputs is often ignored assuming that soft computing models have an intrinsic capabilityof handling such issues remesan and mathew 2015 however the selection of appropriate predictors input variables for hydrological modeling is of utmost prominence for resolving the inherent model complexity reducing dimensionality and even optimizing the time and effort one engages in gathering data some of the established techniques for dimensionality reduction in hydrological applications include principal component analysis pca noori et al 2011 venkateswarlu et al 2020 jeet et al 2019 castro et al 2019 moon et al 2019 rahman et al 2017 independent component analysis ica najafi et al 2011 monira et al 2011 correlation analysis yang et al 2018 snieder et al 2020 partial mutual information pmi monira et al 2011 he et al 2015 snieder et al 2020 stepwise multiple linear regression balabin and smirnov 2011 felipe et al 2015 yang et al 2018 wrapper methods taormina et al 2016 rodriguez galiano et al 2018 genetic algorithm ga dariane and azimi 2016 2018 gobeyn et al 2017 genetic programming gp chadalawada et al 2017 hadi and tombul 2018 pca or ica is a feature extraction method where the data is rotated from one coordinate system to another pca or ica does not result in a feature subset moreover it generates principal components that can explain most of the variance in the data the only way pca or ica can be used as a feature selection method if and only if the most important variables are the ones that happen to have the most variation in them in the case of correlation analysis the predictors are selected on the basis of their correlation coefficient with the predictand yang et al 2018 the main drawback of any correlation based feature selection is to select features that have local influence but they may be overshadowed by strong globally predictive features hall 1999 in the case of pmi the feature selection methodology is similar to correlation analysis the only difference is the use of mutual information instead of the correlation coefficient snieder et al 2020 however while applying to large datasets the computation time required is a burden in the case of pmi may et al 2008 another prevalent technique that has been extensively used in feature selection is the stepwise multiple linear regression they select a subset by fitting a regression model that includes different subsets of available observed covariates and finally selecting the subset with the least standard errors however this may result in the inclusion of correlated predictors and result in increased standard errors which causes the predictions to be very sensitive to model changes felipe et al 2015 for most of the wrapper methods the time required in the learning algorithm is more since every possible scenario of feature subset is being performed by the feature selection search engine inza et al 2000 in case of genetic algorithms the optimal selection of crossovers and mutation is still a problem and has to be fixed experimentally inza et al 2000 in recent years bayesian networks bn which is a class of probabilistic graphical models has been effectively used to select the feature subset in multi dimensionality studies the basis for bn is to develop conditional independence between the predictors and the predictand these networks can limit the number of possible dependencies thus making it easy to analyze the network as a result speeding up computation time and also these networks allows the introduction of expert knowledge vitolo et al 2018 the introduction of expert or domain knowledge can be integrated in bn using the blacklisting and whitelisting techniques this technique separates bn from other wrapper based feature selection methods blacklisting refers to forced exclusion of association between any two variables whereas whitelisting refers to forced inclusion of association between any two variables in fact felipe et al 2015 made a comparative study between stepwise multiple linear regression and bn and found out that bn was approximately 10 more accurate than linear regression in finding out the optimal set of predictors in another study pittavino et al 2017 also compared generalized linear model and bn for selecting dependent variables and found out bn has an advantage over linear model due to its capacity to capture the natural complexity of data more effectively the above mentioned advantages of bn makes it an efficient technique for feature selection and has therefore found tremendous application in different fields viz prediction and modelling of total egg production in meat type quails felipe et al 2015 probabilistic prediction for drought forecasting and outlook combined with quantification of the prediction uncertainties shin et al 2016 analysis of malocclusion data scutari et al 2017 predicting dependencies between hazardous pollutants and population health outcomes vitolo et al 2018 assessment of flood prediction for small rivers to establish the entities and connections with the physical process in a local scale and then using those parameters to construct a global flood prediction model wu et al 2018 assessment of climate change impacts sperotto et al 2019 assessment of hydrological drought using bayesian networks that incorporate dynamic model predictions and a drought propagation relationship shin et al 2020 prediction of probable causes of forest fire sevinc et al 2020 ascertain teleconnections of climate indexes in homogenous precipitation regions ávila and ballari 2020 prediction of food frauds soon 2020 identification of effective variables in the forecasting of debris flows occurrence banihabib et al 2020 based on a review of the latest available scientific literature it was observed that the application of bn in the field of hydrology is still emerging with only a few recent studies reported in the field of hydrological extremes shin et al 2016 2020 wu et al 2018 the exploration of the potential of bn is limited in hydrology either as a tool for resolving the complexity of multivariate systems or as a technique to study the independence structure the scope of the present study includes developing a bayesian network bn to establish the conditional independence structure between monthly rainfall and several meteorological drivers probable predictors to develop a bn based parsimonious prediction model the bn prediction model is compared with standalone ann and svr models and even hybrid models bn ann and bn svr the predictions from the five approaches are further used to categorize dry intermediate wet months in terms of a suitable index this paper is presented in the following manner in section 2 detailed information about the study area and the data used are provided in section 3 the development of the bn model along with the other approaches is explained in section 4 the results and discussions including the performance of all the models are presented which is followed by the concluding remarks 2 data and study area india meteorological department imd has divided india into thirty six homogeneous meteorological sub divisions the state of west bengal in eastern india is thereby divided into two meteorological sub divisions the sub himalayan west bengal and gangetic west bengal gwb fig 1 the present study focuses on gangetic west bengal gwb ranging from latitude 20 15 to 26 988 n and longitude 83 2 to 91 25 e which is the southern part of west bengal comprising of about 66 228 km2 the elevation of the location ranges from 0 to 677 m ghosh 2018 the climate is sub tropical and about 70 of the annual rainfall approx 175 cm in the region occurs during the monsoon season jun jul aug sep the mean annual potential evapotranspiration of the study area ranges from 4 to 7 mm day chattopadhyay et al 2009 in this study the meteorological drivers are selected based on the probable predictors listed in the existing scientific literature for rainfall prediction probable predictors refer to the most influential predictors on the predictand of consideration and a more refined subset of the probable predictors is termed as potential predictors sachindra et al 2018a di et al 2015 used total precipitable water air temperature at 850 mb geo potential height at 300 mb 500 mb and 1000 mb u wind at 350 mb and 850 mb v wind at 300 mb and 850 mb as the predictors of monthly rainfall huang et al 2017 used geo potential height at 1000 mb and 500 mb air temperature at 850 mb relative humidity at 850 mb v wind at 700 mb and total precipitable water ortiz garcía et al 2014 in their study used total precipitable water equivalent potential temperature humidity for water vapour present in the atmosphere temperature wind speed wind direction omega synoptic situation and large scale circulation patterns more so a recent study conducted by mondal et al 2020 observed that temperature humidity omega geopotential height u wind cloud cover momentum flux latent heat flux tropopause height and kinetic energy of wind exhibit positive to negative anomalies with excess normal and deficit rainfall over gangetic west bengal thus in the present study the chosen probable predictors at the surface and different pressure levels are air temperature total precipitable water relative humidity geo potential height zonal wind u wind meridional wind v wind omega rate of change of pressure in a parcel over time dp dt it is the vertical velocity when pressure is used as the vertical coordinate and soil moisture each up to a lead time of 6 months making a total of 72 inputs soil moisture is chosen as a probable predictor as it is known to impact rainfall through complex feedback processes huggannavar and indu 2020 these are obtained from the national centers for environmental prediction department of energy atmospheric model intercomparison project ii ncep doe amip ii data aka reanalysis 2 available at https www esrl noaa gov psd and the climate prediction centre cpc apart from reanalysis 2 other available datasets include 20th century reanalysis 20cr datasets available up to 2012 and experimental extension till 2014 and the era reanalysis datasets however most of the previous studies have used the ncep reanalysis datasets as probable predictors for rainfall prediction wang et al 2013 di et al 2015 huang et al 2017 diez sierra and del jesus 2020 it should be also noted that the portrayal of observed data is best done with reanalysis data pour et al 2020 therefore reanalysis datasets were used in this study for the gridded meteorological products from ncep reanalysis 2 and cpc the data from all the grid points falling within the study area 20 grid points for soil moisture and 2 grid points for all other predictors are spatially averaged to convert it into a single time series so that it commensurate with the rainfall time series the monthly rainfall series for gwb is obtained from the homogeneous rainfall data developed by the indian institute of tropical metrology iitm pune the homogeneous rainfall data was developed by considering 306 rain gauge stations over 30 meteorological subdivisions across the country which covers about 90 of the country the monthly weighted region rain gauge station was developed for each of the 30 meteorological subdivisions by allocating each rain gauge station s weight to the district area ftp www tropmet res in pub data rain readme pdf table 1 summarizes the details of the datasets and their abbreviations used in this study the authors would like to thank noaa oar esrl psl boulder colorado usa and indian institute of tropical metrology pune for providing the necessary datasets 3 methodology this study examines the potential of bayesian networks bn which is a class of graphical model as a mechanism for establishing a conditional independence structure between monthly rainfall and the selected probable predictors hence the development of bns is described in the following subsection further standard machine learning ml techniques such as artificial neural networks ann and support vector regression svr are briefly presented as these are also used to predict monthly rainfall as standalone models as well as in conjunction with bn i e bn ann and bn svr respectively wherein only the drivers selected from bn potential predictors are used as predictors subsequently the performances from the aforementioned five approaches are compared through statistical measures which are explained later in the following subsections 3 1 bayesian networks bn bns are probabilistic graphical models that permit a concise description of the probabilistic relations as directed acyclic graphs dag for a specified set of random variables sperotto et al 2019 the basis for graphical modeling is to establish the conditional independence structure between the probable predictors and the predictand a dag is denoted by g v a where v represents the set of vertices or nodes and a represents the set of directed arcs the vertices denote the predictors and predictand and the arcs indicate the association between them bn depends on the bayes theorem of probability for disseminating information among the nodes the network is solved once the posterior probabilities of all the nodes are calculated using the bayes theorem sperotto et al 2019 bayes theorem is given by 1 p x y p y x p x p y where p x and p y are the probabilities of occurrence of event x and y p x y is the probability of occurrence of event x given that y has already occurred and p y x is the probability of occurrence of event y given that x has already occurred bn demonstrates the probabilistic relationships among a set of variables graphically it is based on the concept of graph theory as well as probability theory the networks are easily understandable because of their graphical representation they can be used to extract information about the relationship between predictors and predictand the exact association among the variables can be learned from the conditional probability table cpt each node has an associated cpt that contains the probability of each state of the variable among the other advantages one of the important ones is that bn can be used both as a feature selection technique as well as for the prediction model as a feature selection technique they efficiently represent the dependencies among the random variables that constitute the problem model a bn in accordance with the dag must follow an acyclic nature when an edge is followed from a node it is not possible to return to the same node though the direction of edges implies a statistical dependency it does not necessarily entail a causal relationship between the nodes sevinc et al 2020 a simple example of a bn is shown in fig 2 when two nodes are connected by an edge the node from where the edge is originating is called the parent node and the node where the edge is terminating is called the child node as seen in fig 2 the network has four nodes a b c and d node a is the parent node of b and c and so nodes b and c are children nodes of a further in the network d and c are the parents of b and d respectively in the figure it is seen that a is connected to b and c so it can be concluded from the network that a is conditionally independent of d given b and c or a is conditionally dependant on b and c given d if we consider that node a is the target variable in the dag then the information from the network indicates that not all the variables in the dag are needed to predict a but only b and c is enough for prediction of a given that d is conditionally independent of a the probabilistic relation or dependencies among random variables nodes can be determined by the joint probability distribution p v given by 2 p v 1 v 2 v n i 1 n p v i p a v i where v i are the nodes and p a v i are the parents of the v i felipe et al 2015 sevinc et al 2020 the dag in fig 2 can be represented as 3 p a b c d p a p b a d p c a p d c the task of fitting a bn is called learning and it consists of two steps a structure learning it consists of identifying the graph structure of the bn for which several algorithms reported in the scientific literature they broadly fall under three categories viz score based algorithms constraint based algorithms and hybrid algorithms nagarajan et al 2013 table 2 shows some of the structure learning algorithms b parameter estimation here the parameters of the networks that are built in the previous step are estimated this task is simplified by the use of markov property score based algorithms assign a score to each variable of the network and then tend to maximize the network by the basic implementation of different heuristic search algorithms such as hill climb hc or tabu search and various genetic algorithms scutari 2010 for instance a function is used to score a network or a dag with respect to the training data and then a search method is used to look for the network with the best score the hc method uses the hill climbing algorithm to search the network with the best score it starts with a completely saturated graph g and the score of this graph is denoted as the maximum score now for every possible arc addition deletion or reversal the score changes and is compared to the maximum score if the score increases then that becomes the maximum score and the dag that is returned becomes the updated network constraint based algorithms learn the network by analyzing the markov property of bn these are based on the inductive causation ic algorithm verma and pearl 1991 hybrid learning algorithms combine the score and constraint based algorithms and produce reliable network structures these algorithms result in a smaller and more regular search space nagarajan et al 2013 the mmhc method which is a hybrid algorithm first learns the network using a constraint based algorithm i e mmpc and then it orients the network using the hc search approach the score function used for scoring the networks is the bayesian information criterion bic bic is a penalized score criterion and is given by 4 bic i 1 n l o g p v i v i p a v i d 2 l o g n where d is the number of parameters of the distribution in this study only score based and the hybrid algorithms have been used because the constraint based algorithms do not necessarily return a dag and as a result interfere with the prediction process the score based algorithm used here is the hill climb hc algorithm that has been widely used for bn studies vitolo et al 2018 the hybrid algorithm used here is the max min hill climb mmhc encompassing max min parent child mmpc and hill climb hc tsamardinos et al 2006 in a bn the information of any node can be predicted according to the fitted network the predicted values are computed by plugging in the new values for the parents of the node in the local probability distribution of node extracted from the fitted network the bnlearn package scutari 2010 in rstudio 3 6 2 is used to develop the bns as well as the prediction models in this study 3 2 artificial neural networks ann ann is a widely used ml technique in hydrological analysis anns are inspired by the neurological structure of the human brain agatonovic kustrin and beresford 2000 these ml techniques are regarded as black box techniques similar to human neurology ann consist of neurons which are considered as the central processing unit which performs a certain operation to produce the desired output from a set of desired inputs ann consists of an input layer hidden layer s and an output layer connected to each other through weights weights are parameter that determines how the neurons effect in converting the input to impact the output a function known as activation function is applied to the output layer the activation function helps in modeling the complex non linear phenomenon which cannot be explained by linear functions however a linear function can also be used as an activation function there are various activation functions viz linear sigmoid or logistic hyperbolic tangent rectified linear unit etc a neural network may consist of more than one hidden layer however the most basic structure of an ann consists of only one hidden layer maier and dandy 2000 in their review of ann models suggested that an ann model with one hidden layer can approximate any function a more detailed internal structure and working of ann can be found in garcia and shigidi 2006 rakesh tanty and desmukh 2015 xiang et al 2018 and khan et al 2019 in the present study the neural network consists of three layers with only one hidden layer sigmoid or logistic function is used as the activation function the number of neurons were varied from 1 to 10 for each network and the most optimal network was selected the traditional backpropagation algorithm rumelhart et al 1986 was adopted as the learning algorithm with a learning rate of 0 001 and the sum of squared error was used as the error function the neuralnet package in rstudio 3 6 2 is used in developing the ann models 3 3 support vector regression svr support vector regression svr is a part of support vector machines svm which was developed by cortes and vapnik 1995 as a non linear generalization algorithm the general concept of svr is that it nonlinearly maps the input data into some high dimensional feature space and solves the linear regression problem in the feature space zhang et al 2018 this concept of mapping the input data is achieved by the kernel trick a kernel function or approximate function helps to create a hyperplane which is a separation line that helps in predicting the target values by differentiating between different types of data then the algorithm tries to decide a boundary layer at a distance from the hyperplane such that data points close to the hyperplane also known as support vectors are within that boundary line in svr choosing the appropriate kernel is very important which helps in mapping the non linearity to linearity in a multi dimensional feature space sachindra et al 2018a raghavendra and deka 2014 in their review of svm applications in hydrology mentioned that for a non linear problem mostly polynomial and radial basis function rbf is used however in most of the hydrological studies rbf kernel was found to be the most effective tian et al 2018a 2018b ferreira et al 2019 das et al 2020 in the present study both the polynomial kernel and rbf kernel was used but the rbf kernel showed better performance in the validation period and the results presented in this study pertain to the rbf kernel the performance comparison of svr models using both these kernels are provided in the appendix section table a1 while training an svr model using an rbf kernel it is imperative to optimize the parameters of svr i e cost function c gamma γ and epsilon ε the cost function is responsible for the smoothness of the approximate function i e a higher value of c will result in an over fitted model the parameter ε controls the width of the boundary layers for fitting more data and the parameter γ defines how far the influence of a single training example reaches with low values meaning far and high values indicating close in the present study the radial basis function rbf is used as the kernel and the hyperparameters are tuned using a grid search algorithm in a grid search algorithm the calibration set is divided into k disjoint subsets of roughly equal size for each fold then k 1 subset is used as training and one subset as testing set mean squared error mse is calculated for each set and the set with the lowest mse is selected as the parameters huang et al 2012 this is one of the simplest and effective search algorithms for tuning hyperparameters barring grid search algorithm other algorithms for optimization of hyperparameters include simplex algorithm sachindra et al 2013 particle swarm optimization zhang et al 2019 genetic algorithm lei and su 2019 etc however the grid search algorithm is known to be one of the most widely used methods to optimize the svr hyperparameters raghavendra and deka 2014 the e1071 package in rstudio 3 6 2 is used for developing the svr models all the data are normalized as a part of the data preparation before applying any of the approaches the purpose of normalization is to change the values of numeric columns in the dataset to a standard scale without distorting differences in the ranges of values since the variables used in the present study have different ranges so it was essential to normalize the data series the results rainfall were later back transformed to the regular scale before performance evaluation for calibration training of the models 70 of the total dataset has been used and the rest 30 for validation this splitting ratio of calibration and validation has been used in several studies das et al 2020 banihabib et al 2020 three fold cross validation was performed for the entire dataset so that each part of the dataset would act as test data in one of the folds 3 4 performance statistics for model evaluation the performance of the aforementioned five approaches is compared using statistical measures coefficient of determination r2 normalized mean square error nmse nash sutcliff efficiency nse nash and sutcliffe 1970 refined index of agreement md willmott et al 2012 and percentage of bias pbias r2 explains the correlation and variability between the observed and predicted data and ranges from 0 to 1 with 1 representing the best fit nmse is calculated as the ratio of mean squared error to the variance of observed rainfall zhang and govindaraju 2000 and it can range from 0 to it is not that sensitive to the order of the data sachindra et al 2018a nse explains the model efficiency and ranges from to 1 with 1 being the optimum value md explains about the agreement between the observed and the predicted models and ranges from 1 to 1 with 1 being the ideal scenario pbias measures the degree of biasness in a model i e the tendency of a model to underestimate or overestimate a scenario from an observed one the optimal pbias value is 0 0 with small magnitude values which indicate precise model simulation the performance measures like r2 nmse nse md can provide an overall indication about the performance of the model and pbias can explain about the biasness of the model equation for all the statistical measures are presented below i coefficient of determination r2 5 r 2 i 1 n x o x o x p x p i 1 n x o x o 2 i 1 n x p x p 2 2 ii normalized mean square error nmse 6 nmse 1 n i 1 n x o x p 2 σ o iii nash sutcliff efficiency nse 7 nse 1 i 1 n x p x o 2 i 1 n x o x o 2 iv refined index of agreement md 8 md 1 i 1 n x p x o 2 i 1 n x o x o w h e n i 1 n x p x o 2 i 1 n x o x o or 9 md 2 i 1 n x o x o i 1 n x p x p 1 w h e n i 1 n x p x o 2 i 1 n x o x o v percentage bias pbias 10 pbias i 1 n x p x o i 1 n x o x 100 where x o 1 n i 1 n x o x p 1 n i 1 n x p x o o b s e r v e d v a l u e x p p r e d i c t e d v a l u e σ o s t a n d a r d d e v i a t i o n o f o b s e r v e d v a l u e and n number of data points 3 5 categorization of dry intermediate and wet months in terms of standardized precipitation anomaly index spai the predicted rainfall is further used to categorize months with below and above normal rainfall standardized precipitation anomaly index spai is used as the index for designating the dry intermediate wet months as it is suitable for regions with periodic precipitation patterns standard precipitation index spi was not used in this study owing to its limitation that in spi a small precipitation deficiency could be seen as a large negative spi for locations with small precipitation variability spai was developed with the aim of overcoming this limitation of spi another drought index that has been used extensively for quantifying drought scenario is the standard precipitation evapotranspiration index spei wherein the difference between the precipitation and the potential evapotranspiration pet is considered however spei also lacks the ability to capture seasonality monish and rehana 2020 made a comparative study between spai and spei and showed that spei was unable to capture the seasonality associated with the indian rainfall patterns so owing to these limitations of spi and spei spai was selected in this study as the index a comprehensive methodology of spai can be found in chanda and maity 2015 spai is obtained similarly for the observed rainfall as well and compared with the predictions the overall flowchart of the adopted methodology is presented in fig 3 4 results and discussions 4 1 potential predictor selection using bayesian networks for developing the bn a total of 72 meteorological drivers are considered in the saturated model which includes the preceding months time series 1 6 month of all the aforementioned 12 variables the current time step of the variables is not considered in the predictor set so that the prediction may be achieved with at least one month lead time the entire dataset is divided into three folds table 3 shows the calibration and validation period of all the three folds the developed bn in fig 4 establishes that although each of the meteorological drivers is a probable predictor the information provided by some of them is redundant given the information from others for instance the use of the hc algorithm presents 8 potential predictors out of 72 predictors that establish a dependence structure with the monthly rainfall target in the case of fold 1 fig 4a in the figure the surface variable names are denoted by alphabets while the pressure variables are denoted by alphabets followed by pressure in figures in mb the last digit in the variable name denotes the lead number of months for example hgt850 2 indicates geopotential height at a pressure of 850 mb at 2 months lead time the use of mmhc as the heuristic search algorithm resulted in only 2 potential predictors out of 72 which is a significant decrease from the hc algorithm it only establishes hgt850 2 and tpw 2 as the potential predictors of rainfall fig 4b it is worthy of note that both these variables were present in the network formed by the hc algorithm as well which is justified as mmhc uses the hc as the search algorithm it establishes that about 89 for hc and 97 for mmhc of the probable predictors are redundant given the predictors that are selected retained from these algorithms in the case of fold 2 hc generates a network with 6 potential predictors which is slightly less than the first fold whereas in fold 3 also 8 potential predictors were identified for mmhc the number of predictors identified is 2 and 1 for the second and third fold respectively table 4 summarizes the predictors identified and the information number of arcs average markov blanket size about the bns obtained via the two algorithms from table 4 it can be observed that in case of hc four predictors are same in all the folds sm 2 tpw 2 at 2 hgt850 2 and in case of mmhc the predictors are same in the first two folds hgt850 2 and tpw 2 thus there is a general agreement in the selected potential predictors in different folds still the variation in the predictors and the uncertainty of the model may be due to the evolution of the hydro climatic associations as found in other time varying hydro climatic studies dutta and maity 2018 moreover the uncertainty can be due to the use of reanalysis data pour et al 2020 the complete network resulting from the hc algorithm is not shown in figures for brevity however since the mmhc algorithm resulted in a smaller network than hc so the whole bn for mmhc algorithm across all the folds are presented in the appendix section figs a1 a2 and a3 it is to be noted that for both the networks hc and mmhc the drivers with lead times of up to 2 months were most influential in general the network established by the mmhc algorithm is smaller than that by the hc algorithm for illustration let us take the case of fold 1 where the total number of arcs produced is 385 for hc while it was only 85 for mmhc the average markov blanket size was 24 3 and 2 99 for hc and mmhc respectively thus about 8 times more in hc compared to mmhc in any bn markov blanket of a node simply refers to the parents and child of that node and all the other nodes sharing a child with that node neighbourhood size and branching factor are related to the immediate neighbour of a node and the number of children at each node respectively though mmhc resulted in a smaller network the prediction performance was found to be better for the hc algorithm and hence further results in the next few subsections of the bn prediction models pertain to the hc algorithm 4 2 comparison of prediction performance from bn and other approaches in addition to the bn approach standalone ann and svr models and also in conjunction with bn i e bn ann and bn svr were used for prediction of monthly rainfall the scatter plots of the validation period of all the models across all the folds are presented in figs 5 7 the plots for the calibration period are not presented for brevity but in general the performances in the calibration period are better than the corresponding validation periods as expected in the scatter plots distinct colours are used to mark the dry intermediate and wet months to assess the performance and each observation is also designated as jjas june july august september and non jjas months this is further described later in this section in the case of fold 1 the scatter plots reveal a similar adequate performance for all the models there is very slight difference between the models in terms of the performance metrics as indicated in table 5 for fold 2 and fold 3 in the validation period the parsimonious models showed slightly better performance in comparison to the higher dimension models as evident from the values of the performance metrics for examining the overall performance of all the models a bar chart depicting all the statistical measures except pbias for calibration as well as validation period is presented shown as the mean of all three folds in fig 8 the performance of the parsimonious models as well as higher dimensional models is more or less comparable this ascertains that bn has the potential to reveal the conditional independence structure from among several probable predictors and weed out the redundant information for the prediction of monthly rainfall this helps to reduce the dimensionality and thereby resolve the complexity of the model in fact a closer examination of fig 8 demonstrates that bn ann and bn svr models performed most satisfactorily with r2 of 0 831 and 0 834 and md being 0 835 and 0 841 respectively in the validation period however in the calibration period ann showed better performance compared to other models with r2 of 0 796 md of 0 813 nse of 0 778 and nmse of 0 0226 but in the validation period the performance of ann was less accurate in terms of all the metrics with r2 of 0 913 md of 0 881 nse of 0 91 and nmse of 0 226 bn ann and bn svr performed similarly in the calibration period as well with r2 of 0 864 and 0 867 and md of 0 86 and 0 863 respectively in terms of model biases also ann showed the best performance with pbias of only 0 06 in the calibration phase followed by bn bn ann bn svr and svr svr model showed little overestimation in the calibration phase fig 9 shows the variation of pbias across each fold for all the models however in the validation phase all the models showed positive or negative biases with the performance of bn ann being the best as compared with other models all the other models performed comparably in terms of pbias fig 9 fig 10 shows the observed and predicted time series of all the models for each fold it is observed that higher dimensional models performed slightly better when it comes to capturing the peaks of the series compared to the parsimonious models including bn for instance in fold 3 in june 84 which is in the validation period the observed rainfall is 538 mm and the closest prediction is 497 mm and 417 mm from ann and svr respectively followed by 398 mm from both bn ann and bn svr which is almost 100 mm less than what predicted from ann in case of the calibration period the peaks or outliers in the models are captured closest by the ann model with observed being 655 mm and predicted being 407 mm for fold 1 this may be attributed to certain predictor predictand related hypersensitivities to different values of predictor data sachindra et al 2018b in general intermediate conditions are estimated closest to observations dry conditions are captured better while wet conditions are underestimated this is true for both the monsoon season jjas as well as other seasons non jjas the performance is similar in terms of all the metrics for all the models in the validation phase the nmse md and nse show minimal variability for all the models however the least deviation from the observation was demonstrated by the bn ann model with pbias of 0 6 and the most deviation from the observed rainfall was shown by the ann model with pbias of 6 2 4 3 classification of dry intermediate and wet months the predicted rainfall from the models is further used for classifying each month into dry intermediate and wet as mentioned earlier spai is used as the index for designating such events to calculate spai the precipitation anomalies are fitted to a single probability distribution several distributions such as gaussian student s t generalized t logistic gumbel pearson type iii and skew power exponential type iii sep3 are checked and sep3 distribution is found to be the best fit for all folds the calculated spai fall into three categories namely dry spai 1 intermediate 0 99 s p a i 0 99 and wet spai 0 99 contingency tables are used to assess the performance of the models in classifying the months with below and above intermediate rainfall the model performance is evaluated in terms of the contingency coefficient c pearson 1904 a higher value of c represents a good association between the observed and predicted categories tables 6 to 10 shows the contingency table for the validation periods all folds for bn bn ann bn svr ann and svr models the ratio of c and cmax is also used as a measure of the degree of association the upper bound of c which is cmax has a constant value of 0 817 since there are only three categorical variables in this study more details about the measures may be found in maity et al 2013 the statistics q which follows a chi square distribution with i 1 j 1 degrees of freedom dof where i and j are the number of categories is also presented so in this study the dof is 4 the p value associated with the statistics specifies the rejection or failing of rejection of the null hypothesis which is the association between observed and predicted categories a low p value indicates that the null hypothesis can be rejected from the contingency tables it is apparent that parsimonious models performed comparably along with higher dimensional ann and svr models this is further signified by the scatter plots refer figs 5 7 wherein the observed categories are colour coded as red dry blue intermediate and green wet for both jjas and non jjas months with solid and hollow circles respectively both from the contingency table and the scatter plots it is evident that all the models performed very satisfactorily and comprehensively showed agreement for the intermediate months among the dry and wet cases almost all the models capture the dry events better the wet events are not well captured particularly in fold 1 with a rather significant deviation from the 45 lines fig 5 moreover in fold 3 it is seen that wet scenarios underestimate high values and dry scenarios overestimate in general fig 7 in general it was observed that the wet scenarios are underestimated whereas the dry scenarios are captured better with slight overestimation a similar observation was found in the study of sachindra et al 2018a this may attribute to the fact that large scale climate information does not provide a variance needed to sufficiently justify the observed variation of the hydroclimate variables in the study area sachindra et al 2018a in general the parsimonious models also showed good degrees of association with comparatively higher c cmax values than the higher dimensional models in a nutshell it can be said that the results of the parsimonious models were comparable with the higher dimensional standalone models the performance of the parsimonious models was also comparable when the classification of drought scenarios was carried out this implies that bn was able to accurately select the feature subset for the prediction of monthly rainfall in the study area also it was found that both ann and svr were able to predict the rainfall of the study region with fewer errors sathish et al 2017 used the box jenkins seasonal arima for forecasting monthly rainfall in gwb and reported the r2 value in the validation period to be 0 742 in another study basak 2020 decomposed the seasonal rainfall data of the gwb into eight empirical time series to show the interannual variability of the rainfall series of gwb they used generalized regression based neural network grnn and simple regression to model the non linear part linear part of the time series respectively and found the correlation coefficient for the validation period to be 0 89 r2 0 79 the performance of the proposed methods in the present study were comparable with the results of the previously reported studies various studies have shown better results of ann and svr in rainfall studies compared to other techniques nastos et al 2014 used ann to predict daily precipitation total in greece successfully and the results obtained were very satisfactory in another study partal et al 2015 compared the usefulness of three different neural networks feed forward backpropagation ffbp radial basis based neural networks and the generalized regression neural network and found that ffbp was the most effective which is also used in the present study in predicting precipitation yu et al 2017 compared the effectiveness of svr and rf in radar derived rainfall forecasting and found that svr was more accurate in the estimation of rainfall cramer et al 2017 compared the predictive scenario of seven ml techniques and found that ann svr and gp showed the best agreement compared to other methods many such studies are reported in the literature which explained the usefulness of ann and svr in rainfall forecasting hence in the present study also the proposed bn based models are compared with state of the art ann and svr models 5 concluding remarks this study proposes bayesian network bn a probabilistic graphical model as a possible mechanism for uncovering the conditional independence structure and developing a parsimonious rainfall prediction model in the gangetic west bengal region in india the conclusions from this study are 1 bn is effectively used to specifically select a limited number of predictors potential predictors from a pool of 72 meteorological drivers probable predictors thus reducing the dimensionality of the problem significantly and providing insights about the critical associations with the drivers among the two heuristics algorithms used for this purpose max min hill climb mmhc resulted in a smaller network but the prediction performance is found to be better for hill climb hc algorithm 2 artificial neural networks ann and support vector regression svr techniques are also used to develop standalone rainfall prediction models with all the 72 predictors as inputs and also in conjunction with bn i e bn ann and bn svr the performance of the parsimonious models is equally satisfactory as the higher dimension models 3 the predicted rainfall from the models is further used for the categorization of dry intermediate wet months in terms of standardized precipitation anomaly index spai all the approaches indicate reasonable performance and show the closest agreement with observations for the intermediate cases and capture the dry months slightly better than the wet months the application of bn can be useful in any complex phenomenon where several variables are identified as probable predictors and there is a need for dimensionality reduction to select the potential predictors for example in hydrology for identifying the potential variables local or global that trigger specific types of droughts in a region however it is to be noted that when bn can establish a graphical representation of joint distributions among a set of variables the same can be achieved by using a copula based approach copulas permit the analysis of the nature of dependency between random variables with no marginal distribution knowledge and even multivariate distribution analyses with some marginal distributions gargouri ellouze and eslamian 2014 future scope of the study includes incorporating copula in bn to establish the conditional dependencies and hence developing a copula based bn guo et al 2019 maity et al 2020 for feature selection in rainfall related studies credit authorship contribution statement prabal das formal analysis investigation writing original draft kironmala chanda conceptualization supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is supported by the department of science and technology india through project number ecr 2017 001880 the authors also acknowledge partial financial support from teqip iii minor research project the authors would also like to thank the anonymous reviewers for their constructive comments in improving this paper appendix 
5101,we use the budyko framework to examine streamflow changes due to climate variation and human activities in the mauvais coulee basin a 1002 km2 sub basin that contributes streamflow to devils lake a terminal lake that has experienced catastrophic flooding over the past three decades the basin lies within the northern glaciated prairies contains innumerable wetland complexes that follow fill spill hydrological principles has undergone extensive land use change to support dryland farming and has experienced a drought to deluge hydroclimatic transition over the last century we implement the budyko framework to partition the runoff increase to the lake between its climatic or human components initial results attribute 45 of the streamflow increase to climate factors and 55 to human activities implementation of the budyko framework to examine streamflow partitioning however rests upon a series of assumptions that are usually not directly verified we then examine each budyko framework assumption to determine its suitability for our study site and study period none of the required assumptions are fully satisfied our study site and study period encompass two distinct hydroclimatic modes contain no clear single inflection point separating baseline and altered periods experience root zone soil moisture storage changes during the study period and exhibit a non stationary precipitation streamflow relationship during the transitional period between the two hydroclimatic modes streamflow attribution produced by the standard application of the budyko framework is not applicable to our study site or study period we recommend that local scale investigations of streamflow partitioning based upon the budyko framework be more intentional in verifying model assumptions as a standard practice in implementing the method keywords budyko hypothesis streamflow partitioning climate change land use change glaciated prairies hydroclimatic modes 1 introduction inland saline lakes are an important global water resource that provide important livelihood systems throughout the world de martonne 1927 langbein 1961 waiser and robarts 2009 the hydrological states of such terminal lakes lake level lake area and lake volume can exhibit large and rapid changes in response to natural forcings williams 1996 terminal lakes are also sensitive to human alterations in basin hydrology including water diversion water abstraction crop cultivation and deforestation afforestation williams 1996 2001 and increased demand for agricultural production has frequently led to declining lake levels gross 2017 williams 2002 terminal lake flooding also occurs although much less frequently sutphen 1983 sandström 1995 bedford 2005 devils lake a terminal saline lake in the devils lake closed basin 9 868 km2 in eastern north dakota usa fig 1 has experienced catastrophic lake expansion over the past twenty eight years larson 2012 from 1993 to present the lake level ll rose by 9 m lake area la expanded by more than 280 and lake volume lv increased by more than 450 todhunter 2018 more than 1 billion usd has been spent in government payments for direct primary tangible flood losses zheng et al 2014 local stakeholders have expressed concern that the flood damages may be attributable at least in part to human modification of the drainage basin hydrology changes in hydrological system states are caused by a combination of atmospheric change driven by geophysical drivers precipitation radiation temperature wind humidity and landscape change driven by human drivers water storage dam releases human land use change water consumption deforestation afforestation destouni 2015 recent investigations of the hydrology of devils lake concluded that the recent lake rise resulted from a shift in hydroclimatic modes that has been a characteristic feature of the regional hydroclimatology over the past 4000 years todhunter 2016 2018 todhunter and fietzek devries 2016 an investigation of the relative contribution of atmospheric and landscape change to streamflow variations leading to the historical rise in devils lake has not been undertaken investigators use multiple approaches to separate the effects of climate variability and human activity upon river discharge wang 2014 dey and mishra 2017 these include statistical methods tran and o neill 2013 gupta et al 2015 empirically based distributed models li et al 2009 physically based distributed models twine et al 2004 ecohydrological theory tomer and schilling 2009 and implementations based on the climate elasticity approach zheng et al 2009 wang and hejazi 2011 a limited number of studies have applied these approaches to examine lake level variations in both flowing and terminal lakes hu et al 2012 ye et al 2013 guo et al 2015 yuan et al 2016 zhu et al 2019 the budyko hypothesis has become an important tool for understanding long term water energy relationships at the watershed scale the method partitions precipitation into actual evapotranspiration and streamflow over an annual time step based upon the aridity index condon and maxwell 2017 the method has a strong physical basis can be readily adapted to ungauged basins and appears to be robust in its application to a wide range of hydroclimatological settings and basin characteristics condon and maxwell 2017 climate elasticity approaches to implementing the budyko hypothesis for streamflow partitioning have undergone numerous developments over time and been applied to drainage basins over a wide cross section of physical environments table s1 donohue et al 2011 roderick and farquhar 2011 peña arancibia et al 2012 zhang et al 2011 it has not been applied in the northern glaciated plains however where streamflow regimes are controlled by freeze thaw of seasonally frozen ground snow accumulation and redistribution snowmelt production rain on snow and principles of fill spill hydrology that control surface water storage and connectivity of surface depressions woo 2019 van hoy et al 2020 the purpose of this study is to examine streamflow partitioning of the major sub basin contributing surface runoff to devils lake the budyko hypothesis is used to investigate streamflow changes due to atmospheric and landscape changes in the major gauged basin providing streamflow input to devils lake we first present results based upon a standard implementation of the method similar to numerous investigations in the hydrological literature implementation of the budyko framework for streamflow partitioning rests upon a series of assumptions that are well known but normally not verified wang 2014 dey and mishra 2017 we examine each assumption implicit in the application of the budyko framework for partitioning streamflow within a northern glaciated environment that has experienced drought to deluge climatic conditions over the past 28 years winter and rosenberry 1998 mckenna et al 2017 we discuss the results in light of the assumptions required for implementation of the budyko framework for streamflow partitioning and provide recommendations on local scale application of the approach for streamflow partitioning 2 study area 2 1 physiography of the devils lake basin devils lake is a terminal lake formed by glacial thrusting during the last glaciation bluemle 2016 the devils lake basin dlb is a closed basin consisting of a series of sub basins that form a natural chain of lakes fig 1 runoff along the chain of lakes proceeds in an east to west direction and enters into northwest devils lake through big coulee wiche and pusc 1994 the mauvais coulee basin mcb is the major gaged sub basin 1002 km2 within the dlb fig 1 and consists of cultivated cropland and herbaceous cover including wetlands dlb contains topographically closed depressions of variable size and depth left by the continental ice sheet during the last glaciation wiche and pusc 1994 the wetlands follow principles of fill spill hydrology shaw et al 2012 hayashi et al 2016 the devils lake upper basin drains internally to these wetland depressions which frequently do not fill to a high enough level to spill to adjacent lower level pothole depressions surface water drainage between adjacent depressions is often disconnected and the region lacks a well defined surface drainage system the fractional area contributing to the surface stream network varies on a seasonal and inter annual basis van hoy et al 2020 being greatest in spring and during wet spells and least during summer fall and dry spells zhang et al 2009 2 2 basin hydroclimatology the regional paleoclimatological record over the last 4000 years shows large oscillations between dry sub humid and moist sub humid climatic modes fritz et al 2000 laird et al 2003 indicating the absence of a single stable long term climatic regime bluemle 2016 monthly precipitation and monthly potential evapotranspiration occur in phase with summer maximums following abatzoglou and ficklin 2017 rcms 0 182 where rcms is a measure of the symmetry between surface moisture delivery and atmospheric demand and is equal to the cumulative monthly moisture surplus monthly precipitation minus monthly potential evapotranspiration divided by the annual precipitation snowfall only contributes about 14 of annual precipitation legates and bogart 2009 but seasonal runoff is concentrated in the spring due to snowmelt production berghuijs et al 2016 villarini 2016 the devils lake hydrology is representative of an amplifier terminal lake in which long term climatic changes are amplified by positive feedback mechanisms causing the lake level to experience large and rapid rises and falls as the regional climate transitions between sustained wetting and drying phases the most recent hydrological transition occurred in 1993 when devils lake began to transition from a precipitation dominated to a runoff dominated lake water budget todhunter 2018 2 3 historical landscape change the devils lake basin lies within the prairie pothole region an agricultural landscape that has undergone an extensive conversion of native prairie grasslands wetland drainage agricultural drainage and changes to tillage operations over the past 150 years anteau et al 2016 these historical changes in land cover land use and farm management provide the motivation for concern over possible hydrological changes driven by human alteration to the landscape these changes are reviewed in the supplementary material their rates of occurrence and adoption have been spatiotemporally uneven and heterogeneous so that their effect upon the regional hydrology is complex not well understood and difficult to predict ehsanzadeh et al 2016 some studies claim large impacts upon basin streamflow mccauley et al 2015 while others find little support for significant changes in streamflow regimes ehsanzadeh et al 2016 ficklin et al 2018 3 material and methods 3 1 hydrology and climate data for mauvais coulee basin the centroid of the mauvais coulee sub basin was determined using arcgis monthly precipitation pmon mm and monthly mean maximum and mean minimum air temperatures tmx tmn c were obtained from the prism dataset using the centroid coordinates prism climate group 2017 mean monthly air temperature tmon c was obtained as a secondary variable from the primary tmx and tmn time series hydroclimate variables were analyzed for water years running from 1 october 1955 30 september 2015 annual potential evapotranspiration etp mm was estimated based on the hamon equation using the tmon time series and daylength for the mid point of each month lu et al 2005 annual aridity index values ø fraction were computed where ø etp p annual streamflow discharge for the mauvais coulee near cando north dakota station 05056100 was obtained from the u s geological survey usgs national water information system nwis usgs 2017a this station has the longest quality hydrologic record within the devils lake basin streamflow data from nwis was converted to an annual runoff depth q mm based upon the mauvais coulee drainage area and the annual runoff ratio q p then determined the runoff ratio is a dimensionless unit of measure comparing the ratio of the runoff depth to the precipitation depth in a basin 3 2 land cover characteristics for mauvais coulee basin annual agricultural land use data for towner county were obtained to evaluate the timing and rate of agricultural land use change in the mcb north dakota agricultural statistics service 2012 towner county comprises the majority of the mcb and provides a sufficient representation of the basin s historical cropping patterns annual totals for towner county cover the period 1959 2012 and include the annual area km2 planted for the following crop groups small grains all wheat barley oats flax and canola all hay and row crops all sunflowers dry edible beans soybeans grain corn and potatoes fig s1 the spatial distribution of land use land cover within the mcb during the study period was obtained from the cropscape crop data layer cdl a raster geo referenced crop specific land cover data layer created by the u s department of agriculture s usda national agricultural statistics service nass usda nass 2016 the cdl provides annual resolution crop data for the continental u s using satellite imagery with a 30 m spatial resolution and extensive agricultural ground truthing fig s2 the cdl and nd agriculture statistics databases provide spatial and temporal scale resolution of the agricultural cropping patterns within mcb over the past 60 years 3 3 determination of baseline and altered periods use of the budyko framework to partition streamflow requires the identification of an inflection point separating a baseline period bp marked by the absence or minimal impact of human activity upon streamflow and an altered period ap with discernible human impact upon landscape drivers of streamflow the baseline and altered periods can be determined using knowledge of local history of basin land use land cover characteristics peña arancibia et al 2012 gao et al 2016 regional satellite imagery wang et al 2013a and mann kendall test pettitt test and double mass curve analyses table s1 wang et al 2013b most commonly the bp and ap periods are identified using a single direct hydrological variable table s1 such as mean annual runoff depth mm y 1 resulting in a single inflection point in the time series we identify inflection points using multiple hydroclimatic variables by the method of hurst rescaling presented in outcalt et al 1997 and illustrated in todhunter and fietzek devries 2016 and todhunter 2016 first we examine the historical streamflow record q m3 s 1 for the mauvais coulee near cando nd gage 05056100 usgs 2017a we then combine long term lake level data ll m at devils lake near devils lake nd gage 05056500 usgs 2017b with a hypsometry table for the lake usgs 2014 to examine the long term lake volume time series lv km3 other variables examined include annual precipitation p mm from prism and mean annual root zone soil moisture sm mm for the devils lake basin obtained from a climatic water balance model todhunter and fietzek devries 2016 hurst rescaling allows the creation of normalized transformed time series of variables having different metrics record lengths and starting and ending dates that can be shown on a single graphic outcalt et al 1997 3 4 streamflow partitioning based upon the budyko hypothesis budyko 1974 proposed that 90 of the variance in the evaporation ratio eta p could be explained by a non linear relationship between that ratio and the aridity index for large basins when averaged over an annual time step or longer condon and maxwell 2017 the original budyko hypothesis proposed a universal relationship between the evaporation index and the aridity index based only upon climate parameters etp p later implementations of the model partitioned precipitation based upon climate variables and a basin parameter that represented the cumulative effect of all processes controlling the partitioning of p into eta and q not incorporated in etp and p donohue et al 2011 the basin parameter incorporates vegetation and basin effects affecting eta including the seasonal timing of p and eta the snow fraction basin slope basin aspect soil type and depth vegetation type and vegetation rooting depth yang et al 2008 abatzoglou and ficklin 2017 multiple implementations of the budyko framework for streamflow partitioning are found in the hydrological literature with different procedural options available for each step wang 2014 budyko based estimates of the climatic and human components of streamflow change are usually based on empirical estimates of climate elasticity or the proportional change in q divided by the proportional change in p or etp ma et al 2008 wang 2014 we first implement a standard approach following methods similar to the majority of streamflow partitioning studies based upon the budyko hypothesis our initial implementation uses commonly adopted options for partitioning precipitation or procedural options that have become recognized as best practices actual evapotranspiration eta potential evapotranspiration etp precipitation p and streamflow q are evaluated in units of depth mm y 1 over an annual water year time step we assume storage changes are negligible over an annual time step δs 0 0 and solve for annual eta based upon measured annual p and q 1 et a p q yang et al 2008 derived an analytical solution for eta that solves the mean annual water energy balance equation 2 et a p et p p n et p n 1 n this equation involves a single basin parameter n whose value varies with the method used to estimate etp roderick and farquhar 2011 abatzoglou and ficklin 2017 we estimate monthly etp using the hamon equation lu et al 2005 subject to the constraint that monthly etp equals zero for tmon 0 c we select the value of n in equation 2 that most closely brings closure to equation 1 for the period of record the difference in mean annual streamflow δq between the altered and baseline periods is calculated and assumed to consist of a portion attributable to climate factors δqc and human factors δqh 3 δ q δ q c δ q h the streamflow change between the baseline and altered periods attributable to climate forcing is estimated using analytically derived elasticity coefficients and the change in precipitation δp and potential evapotranspiration δetp between the baseline and altered periods 4 δ q c ε p δ p ε etp δ et p we use analytical expressions for the elasticity coefficients of streamflow to precipitation εp and streamflow to potential evapotranspiration εetp presented in roderick and farquhar 2011 the sensitivity of streamflow to precipitation is 5 dq dp ε p 1 et a p et p n p n et p n the sensitivity of streamflow to potential evapotranspiration is 6 dq d et p ε etp et a et p p n p n et p n the budyko framework for partitioning streamflow assumes n is constant over time δn 0 between the baseline and altered periods annual changes in the partitioning of p into eta and q is determined by the interannual variation in ø and any change in streamflow partitioning not explained by climate sensitivity is attributed to human factors the streamflow change attributable to human forcing is the difference between the observed streamflow and that attributable to climate factors 7 δ q h δ q δ q c the percentages of the impact of climate drivers ηc and human activities ηh on streamflow are then estimated 8 η c δ q c δ q 100 9 ηh 100 ηc 4 results and discussion 4 1 baseline and altered periods defined by hydrological variables fig 2 shows normalized transformed time series for two hydrological variables that directly respond to hydroclimatic forcing mean annual streamflow at mauvais coulee q and lake volume at devils lake lv and that are typical of the variables used to identify the baseline and altered periods table s1 hurst rescaling calculates deviations of a variable from its long term mean creates a cumulative time series of those deviations and then standardizes those deviations to allow an intercomparison of long term trends of different variables on a single graph outcalt et al 1997 descending traces indicate periods of long term negative deviations from the mean ascending traces periods of long term positive deviations from the mean horizontal traces periods of minimal deviation from the mean and reversals of positive negative traces indicate inflection points in the accumulation of positive negative deviations we obtained an inflection point in 1993 for both mcb streamflow and devils lake lake volume these two hydrologic variables identify a baseline period bp from 1956 to 1992 and an altered period ap from 1993 to 2015 mean hydroclimatic conditions for mcb during the study period 1956 2015 are shown in table 1 mean annual etp was 617 7 mm while mean annual p was 512 7 mm resulting in a mean annual ø of 1 21 mean annual q was 44 7 mm and mean annual eta was 468 0 mm so mean annual q p was 8 7 and mean annual eta q was 91 3 separate totals for the bp ap and ap bp periods are given in table 1 mean annual air temperature in ap is nearly unchanged from bp δt 0 04 c but ap is considerably wetter δp 83 9 mm and less arid δø 0 20 increased streamflow accounted for 84 9 of δp while a 15 1 increase in eta consumed the remainder of δp 4 2 streamflow partitioning based upon standard approach results of the streamflow partitioning between bp and ap are shown in table 2 and were obtained using a basin parameter fitted to a budyko curve for the period of record the n parameter had a value of 4 2 while the climate elasticity of streamflow to precipitation εp and streamflow to potential evapotranspiration εetp were 0 37 and 0 24 respectively table 1 the runoff variability ratio σq σp is given as an additional measure of runoff sensitivity to precipitation and is the ratio of the standard deviation of annual streamflow to the standard deviation of annual precipitation sankarasubramanian and vogel 2003 the climate elasticity of streamflow to precipitation indicates that a 10 increase in precipitation results in a 3 7 increase in streamflow which is a low to moderate value the σq σp value of 0 57 indicates a comparable sensitivity of runoff to precipitation the climate elasticity of streamflow to potential evapotranspiration shows that a 10 increase in potential evapotranspiration results in 2 4 decrease in streamflow mean annual streamflow increased by 71 2 mm from bp to ap and was supplied primarily by an increase in mean annual precipitation 83 9 mm between the two periods mean annual potential evapotranspiration decreased by 3 4 mm which provided an additional small contribution to δq since εetp has a negative value mean annual evapotranspiration eta increased by 12 7 mm between the two periods to maintain mass continuity under the assumption of no storage change table 1 the change in δq due to climate forcing δqc was estimated to be 32 2 mm for a ηc of 45 2 the contribution of human forcing δqh to δq was estimated to be 39 0 mm for a ηh of 54 8 table 1 4 3 re examination of the assumptions underlying the budyko framework use of the budyko framework requires a number of assumptions that have been reviewed by researchers wang 2014 jiang et al 2015 dey and mishra 2017 although direct verification of these model assumptions prior to application of the framework is uncommon table s1 in this section we review each model assumption examine its applicability to the mcb and comment upon how application of the budyko framework is affected by uncritical acceptance of each assumption 4 3 1 assumption 1 baseline vs altered periods the first assumption is that the hydroclimatic time series can be separated into two periods a baseline period bp in which streamflow variations are attributable only to climate variations and human alteration of drainage basin streamflow and hydrological processes is negligible and an altered period ap in which streamflow variations results from both climatic and human forcings wang 2014 the budyko framework treats the partitioning of precipitation into evapotranspiration and runoff based upon a non linear relationship that defines a functional balance between the atmospheric supply of water p and the atmospheric demand for water etp roderick and farquhar 2011 a single budyko curve defines this non linear relationship on the basis of two climate variables p etp and a single basin parameter n roderick and farquhar 2011 annual precipitation p is the ultimate hydrological driver and it defines the delivery of atmospheric moisture to the surface mean annual root zone soil moisture sm controls the partitioning of surface rainfall and snowmelt into surface runoff and root zone intermediate zone and groundwater storage legates et al 2010 hurst rescaling of the p and sm time series shows a similar pattern of a long term accumulation of negative deviations from the mean annual values from about 1915 through 1980 followed by a rapid accumulation of positive deviations from 1981 to the present fig 2 both p and sm show an inflection point occurring in 1981 indicating the end of one climatic mode in 1980 and the beginning of a second climatic mode in 1981 that continues to the present this inflection point in the primary hydrological drivers is consistent with other investigations using different variables and approaches winter and rosenberry 1998 vecchia 2008 ryberg et al 2014 todhunter 2016 mckenna et al 2017 fig 2 reveals a 12 year hydrologic lag between the end of the meteorological drought the point at which the atmospheric drivers transitioned from a drier to a wetter mode and the end of the hydrological drought the point at which hydrological variables began to show a response to those forcings yang et al 2017 the climate variables that drive climate evaporation streamflow relations show an inflection point in 1981 but basin memory effects delayed the response in the hydrological variables until 1993 the period 1981 1992 represents a transitional period between a shift in the primary hydrological drivers for the basin and the response in basin streamflow and lake volume a transitional period for which the budyko framework is unsuited donohue et al 2011 dey and mishra 2017 the etp time series has inflection points in 1921 and 1981 that separates a period of sharp negative deviations from the long term mean etp from a period of continuously increasing positive deviations from the mean etp fig 2 4 3 2 assumption 2 human activity synced to baseline and post change periods the second assumption is that the effect of human activities upon streamflow begin abruptly at the inflection point dividing bp and ap jiang et al 2015 it frequently cannot be established that the inflection point separates a period with negligible human impacts upon streamflow from one with significant human impacts and is not instead the result of a step change in climate wang 2014 it may be possible to construct a detailed timeline on the magnitude and timing of human influences upon land surface hydrology due to a single human driver such as land use change gao et al 2016 or deforestation peña arancibia et al 2012 multiple human activities commonly affect streamflow however with each human activity having its own timing spatial pattern of occurrence and sign and magnitude of streamflow impact wang et al 2013a the mcb prairie landscape has experienced a diverse set of human activities affecting streamflow ehsanzadeh et al 2016 these human activities include in rough chronological sequence the original conversion of native prairie to an agricultural landscape agricultural drainage wetland drainage changing agricultural land cover patterns tied to market driven agricultural intensification changing agricultural management practices involving crop rotations and the adoption of conservation tillage wetland consolidation and the installation of tile drainage some of these effects are type i human activities that have an immediate effect upon streamflow while others are type ii activities whose effects are more gradual over time wang 2014 dey and mishra 2017 agricultural land use is the lone mcb landscape driver that can be quantified accurately fig s1 it is a type ii activity of modest magnitude whose timing does not coincide with the 1993 inflection point and is unlikely to be responsible for the observed change in q or lv the interaction of climate variation climate change ecosystem processes and human influences and their cumulative effects upon streamflow is a complex field of study jones et al 2012 a more complete understanding of the temporal history and spatial pattern of human activities upon local watershed hydrology and the scope of such activities is needed for streamflow partitioning based upon the budyko framework to provide greater certainty 4 3 3 assumption 3 no basin storage changes a third assumption is that water storage change and deep groundwater loss between bp and ap are negligible wang 2014 our review of streamflow partitioning studies shows this assumption to be normative in the application of the budyko framework table s1 cao et al 2019 used grace satellite data to estimate terrestrial water storage tws for the souris red rainy sub region and found that root zone soil moisture contributed 48 of tws and ground water and intermediate zone water provided 49 of tws the mauvais coulee basin consists of clay rich surficial deposits underlain by cretaceous shale which both possess low rates of permeability and conductivity so annual deep groundwater loss is minimal wiche and pusc 1994 todhunter and fietzek devries 2016 show a significant change in regional soil moisture storage before and after a 1981 inflection point however that might lead to questioning the assumption of no storage change a large δs in the ap period would lead to an overestimation of δqc and an underestimation of δqh and a large δs in the bp period would lead to an underestimation of δqc and an overestimation of δqh wang 2014 recent studies showed that budyko curves shift when water storage effects are directly considered wang 2012 istanbulluoglu et al 2012 condon and maxwell 2017 and methods to modify the budyko hypothesis to incorporate these storage change effects have been proposed du et al 2016 moussa and lhomme 2016 mianabadi et al 2020 we adopted the method of istanbulluoglu et al 2012 to examine the relationship between annual change in ground water storage and mean annual aridity index depth to water table measurements were obtained for two usgs groundwater measurement sites within or very near to mcb usgs 2018 both sites are sand and gravel aquifers of glacial origin within the spiritwood aquifer in towner county nd one station usgs 484209099174101 had deep ground water depths and was located in the headwaters of the mauvais coulee basin the second station usgs 482908099134601 had shallow ground water depths and was located just to the southwest of the mauvais coulee basin mean ground water depths were determined for the point in time closest to the end of the water year on 30 september for water years 1981 2015 n 35 annual change in ground water storage δs mm was calculated based on a specific yield of 0 151 the results in fig 3 show no relationship between δs and ø r 0 050 p 0 73 this is expected given the low hydraulic conductivity of the soils the low hydraulic gradients resulting from the limited basin topography and the presence of frozen soils during the spring snowmelt period the mean depth to ground water for water years 1981 2015 was 10 07 m for the headwater site and 3 02 m for the lower basin site so potential exists for significant change in root zone and intermediate zone water storage cao et al 2019 in order to gain a first order approximation of soil moisture storage effects the mean annual root zone soil moisture storage sm mm for the devils lake basin was examined todhunter and fietzek devries 2016 implemented a simple regional water balance model using an available soil moisture storage of 150 mm mccabe and markstrom 2007 the implementation of the model is described fully in todhunter and fietzek devries 2016 results indicate a statistically significant relationship between mean annual δsm and mean annual ø fig 4 r 0 373 p 0 01 the sm ø relationship shows a significant intra seasonal variation due to growing season evaporative demand fig s4 we hypothesize that change in mean annual intermediate zone soil moisture storage would show a similar relationship with ø because the intermediate zone is deeper than the root zone the volume of water associated with interannual δsm ø variations in the intermediate zone is likely significant but further investigation is needed for confirmation 4 3 4 assumption 4 climate stationarity a final assumption is that of climate stationarity between the bp and ap periods the budyko framework is valid for examining streamflow partitioning between two steady state periods but is not suitable for transitional states donohue et al 2011 todhunter and fietzek devries 2016 identified two separate climate modes in the devils lake basin which is consistent with the long term paleoclimatic record bluemle 2016 and numerous paleolimnological studies using multiple proxy methods fritz et al 2000 laird et al 2003 these climate modes are shown clearly in fig 2 climate mode 1 lasts through 1980 and is a cooler and drier period climate mode 2 lasts from 1981 to the present and is a warmer and wetter period todhunter 2016 climatic stationarity allows the assumption that any departure in the precipitation runoff relationship between the bp and ap periods represents the effects of human activity wang 2014 gupta et al 2015 assuming that all post inflection point streamflow partitioning changes are due to human activities and do not reflect climate change is probably not valid for many watersheds wang 2014 the climate elasticity coefficients that define the budyko curve may vary with climate zheng et al 2009 the basin parameters that define the budyko curve have been shown to be a function of climate variables that can change over space and time yang et al 2007 donohue et al 2011 jiang et al 2015 abatzoglou and ficklin 2017 abera et al 2019 we conduct a double mass curve analysis of cumulative mean annual runoff depth mm at the mauvais coulee gaging station vs cumulative precipitation mm for water years 1956 2015 n 60 thresholds in the p q relationship occur in 1969 and 1992 similar to results found for the entire devils lake basin todhunter 2018 fig 5 identifies three p q phases phase 1 from 1956 to 1968 phase 2 from 1969 to 1991 and phase 3 from 1992 to 2015 these thresholds are equal in number and a close match in timing to a similar double mass curve analysis for devils lake todhunter 2018 demonstrating a consistent regional pattern we calculate separate budyko parameters and related variables for phases 1 and 3 table 3 phase 1 extends from 1956 to 1968 samples only climate mode 1 and has a consistent p q relationship defined by n 10 3 table 3 phase 3 extends from 1992 to 2015 samples only climate mode 2 and has a consistent p q relationship defined by n 3 2 table 3 phase 2 extends from 1969 to 1991 overlaps both climate modes 1 and 2 and has a transitional p q relationship and a basin parameter intermediate in value for phases 1 and 3 the transitional nature of the three phases is further evident in fig 6 all three phases have large interannual variability in aridity index values annual ø values range from 0 94 to 1 76 for phase 1 1 01 to 2 74 for phase 2 and 0 72 to 1 58 for phase 3 fig 6 the mean ø value is 0 16 lower for phase 3 than for phase 1 reflecting the wetter conditions for the latter period annual water yield mm values exhibit large interannual variability for the three phases 0 0 to 27 2 for phase 1 0 0 to 67 6 for phase 2 and 2 2 to 226 4 for phase 3 the dynamic range of water yield increases significantly from phase 1 to phase 3 fig 6 as does the mean annual water yield total table 3 δq 80 4 mm budyko curves were fitted to phases 1 and 3 the two steady state phases that each span a single climate mode fig 2 and a stationary p q relationship fig 5 the two budyko curves are shown in fig 7 with accompanying statistics in table 3 the mean annual air temperature and etp for phase 3 are nearly identical to phase 1 showing that precipitation is the major regional hydrological driver in this basin located along a strong regional hydroclimatic gradient a small but sustained relative increase in annual precipitation of 15 1 72 9 mm yr 1 resulted in a nearly 12 fold increase in mean annual runoff depth table 3 all of the precipitation increase is partitioned into increased runoff depth 80 4 mm y 1 while mean annual eta decreased slightly 7 5 mm y 1 further contributing to an increase in streamflow the abrupt change in the p q relationship at the two thresholds may be attributable to the fill spill hydrology of the northern glaciated plains as well as the role of intermediate processes in controlling precipitation runoff relationships in cold regions wetland complex water storage and surface water connectivity vary over seasonal and interannual time scales and the ratio of effective drainage area to gross drainage area shows significant within basin and regional temporal variability shaw et al 2012 ehsanzadeh et al 2012 2016 as a basin transitions from prolonged dry to wet conditions thresholds in surface water storage and wetland connectivity are reached this can produce step increases in the basin area contributing to a river network runoff volume is also sensitive to the timing and magnitude of intermediate processes such as fall soil moisture content frozen soil infiltration spring snowmelt timing and rain on snow events in complex non linear relationships van hoy et al 2020 these factors can produce changes in the p q relationship that can be mistaken as the result of human activity investigators have questioned the time invariant nature of the budyko parameter abera et al 2019 peña arancibia et al 2012 guo et al 2015 jiang et al 2015 arguing that it is a variable that changes with climate change causing an upward or downward shift in the budyko curve jiang et al 2015 the parameter may be a function of both climate and watershed characteristics climate change affects the evaporation index and the aridity index but also changes the watershed vegetation characteristics which are encapsulated within the n parameter jiang et al 2015 the spatially uniform nature of the n parameter has also been questioned earlier investigators considered it a single parameter that represented the integrated effects of basin climate and vegetation characteristics affecting eta yang et al 2008 yang et al 2008 and abatzoglou and ficklin 2017 demonstrated significant spatial variability in n due to basin climate vegetation soil and topographic conditions the n parameter value of 3 2 for phase 3 is at the high end of reported values in the literature roderick and farquhar 2011 state that n is usually between 1 5 and 2 6 for grasslands but can range between 0 6 3 6 abatzoglou and ficklin 2017 report high n values for the great plains although forests generally have a higher n value than cropland or grasslands other physical factors that increase n are present for the great plains monthly precipitation and potential evapotranspiration are seasonally in phase for the mauvais coulee annual snow water equivalent is a small percentage of annual precipitation depth the topography is very subdued and slope is uniformly low across the basin the available water holding capacity of the top 1 5 m root zone is high relative to annual precipitation all of these factors produce higher values for the n parameter abatzoglou and ficklin 2017 both climate elasticity coefficients indicate moderate sensitivity of streamflow to changes in p or etp table 3 the phase 1 n parameter value of 10 3 is much greater than values previously reported for other environments nearly all precipitation is partitioned into eta with very weak sensitivity of streamflow to either p or etp table 3 aridity index values are approximately 1 0 or greater and individual years are tightly aligned along the eta p 1 0 limit fig 7 when ø values are greater than 1 0 the system is considered to be water limited with annual eta limited by available p the unusually high n value may be a unique feature of the prairie environment but may also be an unrealistic result from uncritically applying the budyko framework to a cold region environment where fill spill hydrology principles occur ehsanzadeh et al 2016 found that effective drainage area ranged between 9 and 100 of conventional total drainage for prairie environments in canada although such numbers are not available for the mauvais coulee they are certain to be present the budyko method assumes that all precipitation is removed as q or lost as eta with storage change assumed to be zero when effective drainage area is substantially less than total drainage area q will be reduced and eta will be overestimated to maintain closure since p is unaffected by drainage area causing the value of n to be artificially inflated for phase 3 individual year ø values are both less than and greater than 1 0 and there is much greater spread of individual points about the budyko curve fig 7 interannual variations in soil moisture storage change could contribute to the wide scatter of points about the phase 3 budyko curve van hoy et al 2020 some years are water limited other years are energy limited with ø 1 0 and eta limited by etp this transition from a very dry climate mode to one considerably more mesic in character is consistent with the transition of the devils lake water budget from a precipitation dominated to a runoff dominated water budget todhunter 2018 the standard approach for estimating the climate change and human activity effect upon the partitioning of precipitation into eta and q based upon the budyko framework estimates n εp and εetp for the full period of record these parameter values and sensitivity coefficients are then used to estimate δqc δqh ηc and ηh for the change between bp and ap applying the standard approach for streamflow partitioning in the mcb for the full period of record causes values from one steady state period with a high evapotranspiration ratio and low sensitivity of runoff to precipitation eta p 0 986 n 10 3 εp 0 09 σq σp 0 10 to be mixed with values from a second steady state period with a lower evapotranspiration ratio and higher sensitivity of runoff to precipitation eta p 0 843 n 3 2 εp 0 51 σq σp 0 66 this creates an artificial regime of intermediate characteristics eta p 0 913 n 4 2 εp 0 37 σq σp 0 57 that is unrepresentative of the basin during the period of record and produces unrealistic values for δqc δqh ηc and ηh if climate mode 2 continues into the future however the application of the budyko framework to examine streamflow changes created by ongoing human activities occurring with the mcb would be suitable and fully consistent with assumptions of the methodology 5 conclusions the budyko framework has emerged as a popular method for estimating the sensitivity of streamflow to climate variations and human activities it has been implemented successfully at spatial scales ranging from regional global networks of hundreds thousands of stations to local scale studies of a single station it is a robust method based upon sound physical principles that avoids extensive site specific optimization of multiple model parameters its use however requires a number of assumptions that have not been verified prior to implementation of the framework we follow a standard approach in the literature for estimating the contribution of climate variations and human activities to precipitation partitioning between baseline and altered periods the appropriateness of the model assumptions were examined individually for the mauvais coulee north dakota substantial departures were found for each model assumption calling into question the accuracy of the values obtained from uncritical implementation of the budyko framework for the mauvais coulee the results for the period of record are best understood as a composite of three distinct periods two steady state climate periods each representing a separate and distinct climate mode with each period having a distinct p q relationship separated by a transitional period sampling two climate modes and possessing a transitional p q relationship for the mauvais coulee the estimates of δqc and δqh based upon the full period of record are best understood as artificial constructs of the budyko framework rather than physically valid estimates of streamflow response to variations in climate and human activity funding this work was supported by the north dakota water resources research institute usgs grant number far0026166 summer funding support was given to ccj to support her research the funding source had no involvement in the study design collection analysis and interpretation of data and in the writing of the report the nd wrri supports in general publication of research based upon their grants but had no input in the decision to submit the paper for publication credit authorship contribution statement p e todhunter conceptualization methodology formal analysis writing original draft writing review editing visualization supervision c c jackson formal analysis investigation writing original draft visualization funding acquisition t h mahmood methodology writing review editing visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements william m schuh hydrologist retired with the north dakota state water commission in bismarck nd provided valuable discussions and inspiration during the early stages of this work greg mccabe research physical scientist with the u s geological survey provided a copy of and guidance concerning the thornthwaite monthly water balance model we gratefully acknowledge the helpful comments by two anonymous reviewers appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 125569 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
5101,we use the budyko framework to examine streamflow changes due to climate variation and human activities in the mauvais coulee basin a 1002 km2 sub basin that contributes streamflow to devils lake a terminal lake that has experienced catastrophic flooding over the past three decades the basin lies within the northern glaciated prairies contains innumerable wetland complexes that follow fill spill hydrological principles has undergone extensive land use change to support dryland farming and has experienced a drought to deluge hydroclimatic transition over the last century we implement the budyko framework to partition the runoff increase to the lake between its climatic or human components initial results attribute 45 of the streamflow increase to climate factors and 55 to human activities implementation of the budyko framework to examine streamflow partitioning however rests upon a series of assumptions that are usually not directly verified we then examine each budyko framework assumption to determine its suitability for our study site and study period none of the required assumptions are fully satisfied our study site and study period encompass two distinct hydroclimatic modes contain no clear single inflection point separating baseline and altered periods experience root zone soil moisture storage changes during the study period and exhibit a non stationary precipitation streamflow relationship during the transitional period between the two hydroclimatic modes streamflow attribution produced by the standard application of the budyko framework is not applicable to our study site or study period we recommend that local scale investigations of streamflow partitioning based upon the budyko framework be more intentional in verifying model assumptions as a standard practice in implementing the method keywords budyko hypothesis streamflow partitioning climate change land use change glaciated prairies hydroclimatic modes 1 introduction inland saline lakes are an important global water resource that provide important livelihood systems throughout the world de martonne 1927 langbein 1961 waiser and robarts 2009 the hydrological states of such terminal lakes lake level lake area and lake volume can exhibit large and rapid changes in response to natural forcings williams 1996 terminal lakes are also sensitive to human alterations in basin hydrology including water diversion water abstraction crop cultivation and deforestation afforestation williams 1996 2001 and increased demand for agricultural production has frequently led to declining lake levels gross 2017 williams 2002 terminal lake flooding also occurs although much less frequently sutphen 1983 sandström 1995 bedford 2005 devils lake a terminal saline lake in the devils lake closed basin 9 868 km2 in eastern north dakota usa fig 1 has experienced catastrophic lake expansion over the past twenty eight years larson 2012 from 1993 to present the lake level ll rose by 9 m lake area la expanded by more than 280 and lake volume lv increased by more than 450 todhunter 2018 more than 1 billion usd has been spent in government payments for direct primary tangible flood losses zheng et al 2014 local stakeholders have expressed concern that the flood damages may be attributable at least in part to human modification of the drainage basin hydrology changes in hydrological system states are caused by a combination of atmospheric change driven by geophysical drivers precipitation radiation temperature wind humidity and landscape change driven by human drivers water storage dam releases human land use change water consumption deforestation afforestation destouni 2015 recent investigations of the hydrology of devils lake concluded that the recent lake rise resulted from a shift in hydroclimatic modes that has been a characteristic feature of the regional hydroclimatology over the past 4000 years todhunter 2016 2018 todhunter and fietzek devries 2016 an investigation of the relative contribution of atmospheric and landscape change to streamflow variations leading to the historical rise in devils lake has not been undertaken investigators use multiple approaches to separate the effects of climate variability and human activity upon river discharge wang 2014 dey and mishra 2017 these include statistical methods tran and o neill 2013 gupta et al 2015 empirically based distributed models li et al 2009 physically based distributed models twine et al 2004 ecohydrological theory tomer and schilling 2009 and implementations based on the climate elasticity approach zheng et al 2009 wang and hejazi 2011 a limited number of studies have applied these approaches to examine lake level variations in both flowing and terminal lakes hu et al 2012 ye et al 2013 guo et al 2015 yuan et al 2016 zhu et al 2019 the budyko hypothesis has become an important tool for understanding long term water energy relationships at the watershed scale the method partitions precipitation into actual evapotranspiration and streamflow over an annual time step based upon the aridity index condon and maxwell 2017 the method has a strong physical basis can be readily adapted to ungauged basins and appears to be robust in its application to a wide range of hydroclimatological settings and basin characteristics condon and maxwell 2017 climate elasticity approaches to implementing the budyko hypothesis for streamflow partitioning have undergone numerous developments over time and been applied to drainage basins over a wide cross section of physical environments table s1 donohue et al 2011 roderick and farquhar 2011 peña arancibia et al 2012 zhang et al 2011 it has not been applied in the northern glaciated plains however where streamflow regimes are controlled by freeze thaw of seasonally frozen ground snow accumulation and redistribution snowmelt production rain on snow and principles of fill spill hydrology that control surface water storage and connectivity of surface depressions woo 2019 van hoy et al 2020 the purpose of this study is to examine streamflow partitioning of the major sub basin contributing surface runoff to devils lake the budyko hypothesis is used to investigate streamflow changes due to atmospheric and landscape changes in the major gauged basin providing streamflow input to devils lake we first present results based upon a standard implementation of the method similar to numerous investigations in the hydrological literature implementation of the budyko framework for streamflow partitioning rests upon a series of assumptions that are well known but normally not verified wang 2014 dey and mishra 2017 we examine each assumption implicit in the application of the budyko framework for partitioning streamflow within a northern glaciated environment that has experienced drought to deluge climatic conditions over the past 28 years winter and rosenberry 1998 mckenna et al 2017 we discuss the results in light of the assumptions required for implementation of the budyko framework for streamflow partitioning and provide recommendations on local scale application of the approach for streamflow partitioning 2 study area 2 1 physiography of the devils lake basin devils lake is a terminal lake formed by glacial thrusting during the last glaciation bluemle 2016 the devils lake basin dlb is a closed basin consisting of a series of sub basins that form a natural chain of lakes fig 1 runoff along the chain of lakes proceeds in an east to west direction and enters into northwest devils lake through big coulee wiche and pusc 1994 the mauvais coulee basin mcb is the major gaged sub basin 1002 km2 within the dlb fig 1 and consists of cultivated cropland and herbaceous cover including wetlands dlb contains topographically closed depressions of variable size and depth left by the continental ice sheet during the last glaciation wiche and pusc 1994 the wetlands follow principles of fill spill hydrology shaw et al 2012 hayashi et al 2016 the devils lake upper basin drains internally to these wetland depressions which frequently do not fill to a high enough level to spill to adjacent lower level pothole depressions surface water drainage between adjacent depressions is often disconnected and the region lacks a well defined surface drainage system the fractional area contributing to the surface stream network varies on a seasonal and inter annual basis van hoy et al 2020 being greatest in spring and during wet spells and least during summer fall and dry spells zhang et al 2009 2 2 basin hydroclimatology the regional paleoclimatological record over the last 4000 years shows large oscillations between dry sub humid and moist sub humid climatic modes fritz et al 2000 laird et al 2003 indicating the absence of a single stable long term climatic regime bluemle 2016 monthly precipitation and monthly potential evapotranspiration occur in phase with summer maximums following abatzoglou and ficklin 2017 rcms 0 182 where rcms is a measure of the symmetry between surface moisture delivery and atmospheric demand and is equal to the cumulative monthly moisture surplus monthly precipitation minus monthly potential evapotranspiration divided by the annual precipitation snowfall only contributes about 14 of annual precipitation legates and bogart 2009 but seasonal runoff is concentrated in the spring due to snowmelt production berghuijs et al 2016 villarini 2016 the devils lake hydrology is representative of an amplifier terminal lake in which long term climatic changes are amplified by positive feedback mechanisms causing the lake level to experience large and rapid rises and falls as the regional climate transitions between sustained wetting and drying phases the most recent hydrological transition occurred in 1993 when devils lake began to transition from a precipitation dominated to a runoff dominated lake water budget todhunter 2018 2 3 historical landscape change the devils lake basin lies within the prairie pothole region an agricultural landscape that has undergone an extensive conversion of native prairie grasslands wetland drainage agricultural drainage and changes to tillage operations over the past 150 years anteau et al 2016 these historical changes in land cover land use and farm management provide the motivation for concern over possible hydrological changes driven by human alteration to the landscape these changes are reviewed in the supplementary material their rates of occurrence and adoption have been spatiotemporally uneven and heterogeneous so that their effect upon the regional hydrology is complex not well understood and difficult to predict ehsanzadeh et al 2016 some studies claim large impacts upon basin streamflow mccauley et al 2015 while others find little support for significant changes in streamflow regimes ehsanzadeh et al 2016 ficklin et al 2018 3 material and methods 3 1 hydrology and climate data for mauvais coulee basin the centroid of the mauvais coulee sub basin was determined using arcgis monthly precipitation pmon mm and monthly mean maximum and mean minimum air temperatures tmx tmn c were obtained from the prism dataset using the centroid coordinates prism climate group 2017 mean monthly air temperature tmon c was obtained as a secondary variable from the primary tmx and tmn time series hydroclimate variables were analyzed for water years running from 1 october 1955 30 september 2015 annual potential evapotranspiration etp mm was estimated based on the hamon equation using the tmon time series and daylength for the mid point of each month lu et al 2005 annual aridity index values ø fraction were computed where ø etp p annual streamflow discharge for the mauvais coulee near cando north dakota station 05056100 was obtained from the u s geological survey usgs national water information system nwis usgs 2017a this station has the longest quality hydrologic record within the devils lake basin streamflow data from nwis was converted to an annual runoff depth q mm based upon the mauvais coulee drainage area and the annual runoff ratio q p then determined the runoff ratio is a dimensionless unit of measure comparing the ratio of the runoff depth to the precipitation depth in a basin 3 2 land cover characteristics for mauvais coulee basin annual agricultural land use data for towner county were obtained to evaluate the timing and rate of agricultural land use change in the mcb north dakota agricultural statistics service 2012 towner county comprises the majority of the mcb and provides a sufficient representation of the basin s historical cropping patterns annual totals for towner county cover the period 1959 2012 and include the annual area km2 planted for the following crop groups small grains all wheat barley oats flax and canola all hay and row crops all sunflowers dry edible beans soybeans grain corn and potatoes fig s1 the spatial distribution of land use land cover within the mcb during the study period was obtained from the cropscape crop data layer cdl a raster geo referenced crop specific land cover data layer created by the u s department of agriculture s usda national agricultural statistics service nass usda nass 2016 the cdl provides annual resolution crop data for the continental u s using satellite imagery with a 30 m spatial resolution and extensive agricultural ground truthing fig s2 the cdl and nd agriculture statistics databases provide spatial and temporal scale resolution of the agricultural cropping patterns within mcb over the past 60 years 3 3 determination of baseline and altered periods use of the budyko framework to partition streamflow requires the identification of an inflection point separating a baseline period bp marked by the absence or minimal impact of human activity upon streamflow and an altered period ap with discernible human impact upon landscape drivers of streamflow the baseline and altered periods can be determined using knowledge of local history of basin land use land cover characteristics peña arancibia et al 2012 gao et al 2016 regional satellite imagery wang et al 2013a and mann kendall test pettitt test and double mass curve analyses table s1 wang et al 2013b most commonly the bp and ap periods are identified using a single direct hydrological variable table s1 such as mean annual runoff depth mm y 1 resulting in a single inflection point in the time series we identify inflection points using multiple hydroclimatic variables by the method of hurst rescaling presented in outcalt et al 1997 and illustrated in todhunter and fietzek devries 2016 and todhunter 2016 first we examine the historical streamflow record q m3 s 1 for the mauvais coulee near cando nd gage 05056100 usgs 2017a we then combine long term lake level data ll m at devils lake near devils lake nd gage 05056500 usgs 2017b with a hypsometry table for the lake usgs 2014 to examine the long term lake volume time series lv km3 other variables examined include annual precipitation p mm from prism and mean annual root zone soil moisture sm mm for the devils lake basin obtained from a climatic water balance model todhunter and fietzek devries 2016 hurst rescaling allows the creation of normalized transformed time series of variables having different metrics record lengths and starting and ending dates that can be shown on a single graphic outcalt et al 1997 3 4 streamflow partitioning based upon the budyko hypothesis budyko 1974 proposed that 90 of the variance in the evaporation ratio eta p could be explained by a non linear relationship between that ratio and the aridity index for large basins when averaged over an annual time step or longer condon and maxwell 2017 the original budyko hypothesis proposed a universal relationship between the evaporation index and the aridity index based only upon climate parameters etp p later implementations of the model partitioned precipitation based upon climate variables and a basin parameter that represented the cumulative effect of all processes controlling the partitioning of p into eta and q not incorporated in etp and p donohue et al 2011 the basin parameter incorporates vegetation and basin effects affecting eta including the seasonal timing of p and eta the snow fraction basin slope basin aspect soil type and depth vegetation type and vegetation rooting depth yang et al 2008 abatzoglou and ficklin 2017 multiple implementations of the budyko framework for streamflow partitioning are found in the hydrological literature with different procedural options available for each step wang 2014 budyko based estimates of the climatic and human components of streamflow change are usually based on empirical estimates of climate elasticity or the proportional change in q divided by the proportional change in p or etp ma et al 2008 wang 2014 we first implement a standard approach following methods similar to the majority of streamflow partitioning studies based upon the budyko hypothesis our initial implementation uses commonly adopted options for partitioning precipitation or procedural options that have become recognized as best practices actual evapotranspiration eta potential evapotranspiration etp precipitation p and streamflow q are evaluated in units of depth mm y 1 over an annual water year time step we assume storage changes are negligible over an annual time step δs 0 0 and solve for annual eta based upon measured annual p and q 1 et a p q yang et al 2008 derived an analytical solution for eta that solves the mean annual water energy balance equation 2 et a p et p p n et p n 1 n this equation involves a single basin parameter n whose value varies with the method used to estimate etp roderick and farquhar 2011 abatzoglou and ficklin 2017 we estimate monthly etp using the hamon equation lu et al 2005 subject to the constraint that monthly etp equals zero for tmon 0 c we select the value of n in equation 2 that most closely brings closure to equation 1 for the period of record the difference in mean annual streamflow δq between the altered and baseline periods is calculated and assumed to consist of a portion attributable to climate factors δqc and human factors δqh 3 δ q δ q c δ q h the streamflow change between the baseline and altered periods attributable to climate forcing is estimated using analytically derived elasticity coefficients and the change in precipitation δp and potential evapotranspiration δetp between the baseline and altered periods 4 δ q c ε p δ p ε etp δ et p we use analytical expressions for the elasticity coefficients of streamflow to precipitation εp and streamflow to potential evapotranspiration εetp presented in roderick and farquhar 2011 the sensitivity of streamflow to precipitation is 5 dq dp ε p 1 et a p et p n p n et p n the sensitivity of streamflow to potential evapotranspiration is 6 dq d et p ε etp et a et p p n p n et p n the budyko framework for partitioning streamflow assumes n is constant over time δn 0 between the baseline and altered periods annual changes in the partitioning of p into eta and q is determined by the interannual variation in ø and any change in streamflow partitioning not explained by climate sensitivity is attributed to human factors the streamflow change attributable to human forcing is the difference between the observed streamflow and that attributable to climate factors 7 δ q h δ q δ q c the percentages of the impact of climate drivers ηc and human activities ηh on streamflow are then estimated 8 η c δ q c δ q 100 9 ηh 100 ηc 4 results and discussion 4 1 baseline and altered periods defined by hydrological variables fig 2 shows normalized transformed time series for two hydrological variables that directly respond to hydroclimatic forcing mean annual streamflow at mauvais coulee q and lake volume at devils lake lv and that are typical of the variables used to identify the baseline and altered periods table s1 hurst rescaling calculates deviations of a variable from its long term mean creates a cumulative time series of those deviations and then standardizes those deviations to allow an intercomparison of long term trends of different variables on a single graph outcalt et al 1997 descending traces indicate periods of long term negative deviations from the mean ascending traces periods of long term positive deviations from the mean horizontal traces periods of minimal deviation from the mean and reversals of positive negative traces indicate inflection points in the accumulation of positive negative deviations we obtained an inflection point in 1993 for both mcb streamflow and devils lake lake volume these two hydrologic variables identify a baseline period bp from 1956 to 1992 and an altered period ap from 1993 to 2015 mean hydroclimatic conditions for mcb during the study period 1956 2015 are shown in table 1 mean annual etp was 617 7 mm while mean annual p was 512 7 mm resulting in a mean annual ø of 1 21 mean annual q was 44 7 mm and mean annual eta was 468 0 mm so mean annual q p was 8 7 and mean annual eta q was 91 3 separate totals for the bp ap and ap bp periods are given in table 1 mean annual air temperature in ap is nearly unchanged from bp δt 0 04 c but ap is considerably wetter δp 83 9 mm and less arid δø 0 20 increased streamflow accounted for 84 9 of δp while a 15 1 increase in eta consumed the remainder of δp 4 2 streamflow partitioning based upon standard approach results of the streamflow partitioning between bp and ap are shown in table 2 and were obtained using a basin parameter fitted to a budyko curve for the period of record the n parameter had a value of 4 2 while the climate elasticity of streamflow to precipitation εp and streamflow to potential evapotranspiration εetp were 0 37 and 0 24 respectively table 1 the runoff variability ratio σq σp is given as an additional measure of runoff sensitivity to precipitation and is the ratio of the standard deviation of annual streamflow to the standard deviation of annual precipitation sankarasubramanian and vogel 2003 the climate elasticity of streamflow to precipitation indicates that a 10 increase in precipitation results in a 3 7 increase in streamflow which is a low to moderate value the σq σp value of 0 57 indicates a comparable sensitivity of runoff to precipitation the climate elasticity of streamflow to potential evapotranspiration shows that a 10 increase in potential evapotranspiration results in 2 4 decrease in streamflow mean annual streamflow increased by 71 2 mm from bp to ap and was supplied primarily by an increase in mean annual precipitation 83 9 mm between the two periods mean annual potential evapotranspiration decreased by 3 4 mm which provided an additional small contribution to δq since εetp has a negative value mean annual evapotranspiration eta increased by 12 7 mm between the two periods to maintain mass continuity under the assumption of no storage change table 1 the change in δq due to climate forcing δqc was estimated to be 32 2 mm for a ηc of 45 2 the contribution of human forcing δqh to δq was estimated to be 39 0 mm for a ηh of 54 8 table 1 4 3 re examination of the assumptions underlying the budyko framework use of the budyko framework requires a number of assumptions that have been reviewed by researchers wang 2014 jiang et al 2015 dey and mishra 2017 although direct verification of these model assumptions prior to application of the framework is uncommon table s1 in this section we review each model assumption examine its applicability to the mcb and comment upon how application of the budyko framework is affected by uncritical acceptance of each assumption 4 3 1 assumption 1 baseline vs altered periods the first assumption is that the hydroclimatic time series can be separated into two periods a baseline period bp in which streamflow variations are attributable only to climate variations and human alteration of drainage basin streamflow and hydrological processes is negligible and an altered period ap in which streamflow variations results from both climatic and human forcings wang 2014 the budyko framework treats the partitioning of precipitation into evapotranspiration and runoff based upon a non linear relationship that defines a functional balance between the atmospheric supply of water p and the atmospheric demand for water etp roderick and farquhar 2011 a single budyko curve defines this non linear relationship on the basis of two climate variables p etp and a single basin parameter n roderick and farquhar 2011 annual precipitation p is the ultimate hydrological driver and it defines the delivery of atmospheric moisture to the surface mean annual root zone soil moisture sm controls the partitioning of surface rainfall and snowmelt into surface runoff and root zone intermediate zone and groundwater storage legates et al 2010 hurst rescaling of the p and sm time series shows a similar pattern of a long term accumulation of negative deviations from the mean annual values from about 1915 through 1980 followed by a rapid accumulation of positive deviations from 1981 to the present fig 2 both p and sm show an inflection point occurring in 1981 indicating the end of one climatic mode in 1980 and the beginning of a second climatic mode in 1981 that continues to the present this inflection point in the primary hydrological drivers is consistent with other investigations using different variables and approaches winter and rosenberry 1998 vecchia 2008 ryberg et al 2014 todhunter 2016 mckenna et al 2017 fig 2 reveals a 12 year hydrologic lag between the end of the meteorological drought the point at which the atmospheric drivers transitioned from a drier to a wetter mode and the end of the hydrological drought the point at which hydrological variables began to show a response to those forcings yang et al 2017 the climate variables that drive climate evaporation streamflow relations show an inflection point in 1981 but basin memory effects delayed the response in the hydrological variables until 1993 the period 1981 1992 represents a transitional period between a shift in the primary hydrological drivers for the basin and the response in basin streamflow and lake volume a transitional period for which the budyko framework is unsuited donohue et al 2011 dey and mishra 2017 the etp time series has inflection points in 1921 and 1981 that separates a period of sharp negative deviations from the long term mean etp from a period of continuously increasing positive deviations from the mean etp fig 2 4 3 2 assumption 2 human activity synced to baseline and post change periods the second assumption is that the effect of human activities upon streamflow begin abruptly at the inflection point dividing bp and ap jiang et al 2015 it frequently cannot be established that the inflection point separates a period with negligible human impacts upon streamflow from one with significant human impacts and is not instead the result of a step change in climate wang 2014 it may be possible to construct a detailed timeline on the magnitude and timing of human influences upon land surface hydrology due to a single human driver such as land use change gao et al 2016 or deforestation peña arancibia et al 2012 multiple human activities commonly affect streamflow however with each human activity having its own timing spatial pattern of occurrence and sign and magnitude of streamflow impact wang et al 2013a the mcb prairie landscape has experienced a diverse set of human activities affecting streamflow ehsanzadeh et al 2016 these human activities include in rough chronological sequence the original conversion of native prairie to an agricultural landscape agricultural drainage wetland drainage changing agricultural land cover patterns tied to market driven agricultural intensification changing agricultural management practices involving crop rotations and the adoption of conservation tillage wetland consolidation and the installation of tile drainage some of these effects are type i human activities that have an immediate effect upon streamflow while others are type ii activities whose effects are more gradual over time wang 2014 dey and mishra 2017 agricultural land use is the lone mcb landscape driver that can be quantified accurately fig s1 it is a type ii activity of modest magnitude whose timing does not coincide with the 1993 inflection point and is unlikely to be responsible for the observed change in q or lv the interaction of climate variation climate change ecosystem processes and human influences and their cumulative effects upon streamflow is a complex field of study jones et al 2012 a more complete understanding of the temporal history and spatial pattern of human activities upon local watershed hydrology and the scope of such activities is needed for streamflow partitioning based upon the budyko framework to provide greater certainty 4 3 3 assumption 3 no basin storage changes a third assumption is that water storage change and deep groundwater loss between bp and ap are negligible wang 2014 our review of streamflow partitioning studies shows this assumption to be normative in the application of the budyko framework table s1 cao et al 2019 used grace satellite data to estimate terrestrial water storage tws for the souris red rainy sub region and found that root zone soil moisture contributed 48 of tws and ground water and intermediate zone water provided 49 of tws the mauvais coulee basin consists of clay rich surficial deposits underlain by cretaceous shale which both possess low rates of permeability and conductivity so annual deep groundwater loss is minimal wiche and pusc 1994 todhunter and fietzek devries 2016 show a significant change in regional soil moisture storage before and after a 1981 inflection point however that might lead to questioning the assumption of no storage change a large δs in the ap period would lead to an overestimation of δqc and an underestimation of δqh and a large δs in the bp period would lead to an underestimation of δqc and an overestimation of δqh wang 2014 recent studies showed that budyko curves shift when water storage effects are directly considered wang 2012 istanbulluoglu et al 2012 condon and maxwell 2017 and methods to modify the budyko hypothesis to incorporate these storage change effects have been proposed du et al 2016 moussa and lhomme 2016 mianabadi et al 2020 we adopted the method of istanbulluoglu et al 2012 to examine the relationship between annual change in ground water storage and mean annual aridity index depth to water table measurements were obtained for two usgs groundwater measurement sites within or very near to mcb usgs 2018 both sites are sand and gravel aquifers of glacial origin within the spiritwood aquifer in towner county nd one station usgs 484209099174101 had deep ground water depths and was located in the headwaters of the mauvais coulee basin the second station usgs 482908099134601 had shallow ground water depths and was located just to the southwest of the mauvais coulee basin mean ground water depths were determined for the point in time closest to the end of the water year on 30 september for water years 1981 2015 n 35 annual change in ground water storage δs mm was calculated based on a specific yield of 0 151 the results in fig 3 show no relationship between δs and ø r 0 050 p 0 73 this is expected given the low hydraulic conductivity of the soils the low hydraulic gradients resulting from the limited basin topography and the presence of frozen soils during the spring snowmelt period the mean depth to ground water for water years 1981 2015 was 10 07 m for the headwater site and 3 02 m for the lower basin site so potential exists for significant change in root zone and intermediate zone water storage cao et al 2019 in order to gain a first order approximation of soil moisture storage effects the mean annual root zone soil moisture storage sm mm for the devils lake basin was examined todhunter and fietzek devries 2016 implemented a simple regional water balance model using an available soil moisture storage of 150 mm mccabe and markstrom 2007 the implementation of the model is described fully in todhunter and fietzek devries 2016 results indicate a statistically significant relationship between mean annual δsm and mean annual ø fig 4 r 0 373 p 0 01 the sm ø relationship shows a significant intra seasonal variation due to growing season evaporative demand fig s4 we hypothesize that change in mean annual intermediate zone soil moisture storage would show a similar relationship with ø because the intermediate zone is deeper than the root zone the volume of water associated with interannual δsm ø variations in the intermediate zone is likely significant but further investigation is needed for confirmation 4 3 4 assumption 4 climate stationarity a final assumption is that of climate stationarity between the bp and ap periods the budyko framework is valid for examining streamflow partitioning between two steady state periods but is not suitable for transitional states donohue et al 2011 todhunter and fietzek devries 2016 identified two separate climate modes in the devils lake basin which is consistent with the long term paleoclimatic record bluemle 2016 and numerous paleolimnological studies using multiple proxy methods fritz et al 2000 laird et al 2003 these climate modes are shown clearly in fig 2 climate mode 1 lasts through 1980 and is a cooler and drier period climate mode 2 lasts from 1981 to the present and is a warmer and wetter period todhunter 2016 climatic stationarity allows the assumption that any departure in the precipitation runoff relationship between the bp and ap periods represents the effects of human activity wang 2014 gupta et al 2015 assuming that all post inflection point streamflow partitioning changes are due to human activities and do not reflect climate change is probably not valid for many watersheds wang 2014 the climate elasticity coefficients that define the budyko curve may vary with climate zheng et al 2009 the basin parameters that define the budyko curve have been shown to be a function of climate variables that can change over space and time yang et al 2007 donohue et al 2011 jiang et al 2015 abatzoglou and ficklin 2017 abera et al 2019 we conduct a double mass curve analysis of cumulative mean annual runoff depth mm at the mauvais coulee gaging station vs cumulative precipitation mm for water years 1956 2015 n 60 thresholds in the p q relationship occur in 1969 and 1992 similar to results found for the entire devils lake basin todhunter 2018 fig 5 identifies three p q phases phase 1 from 1956 to 1968 phase 2 from 1969 to 1991 and phase 3 from 1992 to 2015 these thresholds are equal in number and a close match in timing to a similar double mass curve analysis for devils lake todhunter 2018 demonstrating a consistent regional pattern we calculate separate budyko parameters and related variables for phases 1 and 3 table 3 phase 1 extends from 1956 to 1968 samples only climate mode 1 and has a consistent p q relationship defined by n 10 3 table 3 phase 3 extends from 1992 to 2015 samples only climate mode 2 and has a consistent p q relationship defined by n 3 2 table 3 phase 2 extends from 1969 to 1991 overlaps both climate modes 1 and 2 and has a transitional p q relationship and a basin parameter intermediate in value for phases 1 and 3 the transitional nature of the three phases is further evident in fig 6 all three phases have large interannual variability in aridity index values annual ø values range from 0 94 to 1 76 for phase 1 1 01 to 2 74 for phase 2 and 0 72 to 1 58 for phase 3 fig 6 the mean ø value is 0 16 lower for phase 3 than for phase 1 reflecting the wetter conditions for the latter period annual water yield mm values exhibit large interannual variability for the three phases 0 0 to 27 2 for phase 1 0 0 to 67 6 for phase 2 and 2 2 to 226 4 for phase 3 the dynamic range of water yield increases significantly from phase 1 to phase 3 fig 6 as does the mean annual water yield total table 3 δq 80 4 mm budyko curves were fitted to phases 1 and 3 the two steady state phases that each span a single climate mode fig 2 and a stationary p q relationship fig 5 the two budyko curves are shown in fig 7 with accompanying statistics in table 3 the mean annual air temperature and etp for phase 3 are nearly identical to phase 1 showing that precipitation is the major regional hydrological driver in this basin located along a strong regional hydroclimatic gradient a small but sustained relative increase in annual precipitation of 15 1 72 9 mm yr 1 resulted in a nearly 12 fold increase in mean annual runoff depth table 3 all of the precipitation increase is partitioned into increased runoff depth 80 4 mm y 1 while mean annual eta decreased slightly 7 5 mm y 1 further contributing to an increase in streamflow the abrupt change in the p q relationship at the two thresholds may be attributable to the fill spill hydrology of the northern glaciated plains as well as the role of intermediate processes in controlling precipitation runoff relationships in cold regions wetland complex water storage and surface water connectivity vary over seasonal and interannual time scales and the ratio of effective drainage area to gross drainage area shows significant within basin and regional temporal variability shaw et al 2012 ehsanzadeh et al 2012 2016 as a basin transitions from prolonged dry to wet conditions thresholds in surface water storage and wetland connectivity are reached this can produce step increases in the basin area contributing to a river network runoff volume is also sensitive to the timing and magnitude of intermediate processes such as fall soil moisture content frozen soil infiltration spring snowmelt timing and rain on snow events in complex non linear relationships van hoy et al 2020 these factors can produce changes in the p q relationship that can be mistaken as the result of human activity investigators have questioned the time invariant nature of the budyko parameter abera et al 2019 peña arancibia et al 2012 guo et al 2015 jiang et al 2015 arguing that it is a variable that changes with climate change causing an upward or downward shift in the budyko curve jiang et al 2015 the parameter may be a function of both climate and watershed characteristics climate change affects the evaporation index and the aridity index but also changes the watershed vegetation characteristics which are encapsulated within the n parameter jiang et al 2015 the spatially uniform nature of the n parameter has also been questioned earlier investigators considered it a single parameter that represented the integrated effects of basin climate and vegetation characteristics affecting eta yang et al 2008 yang et al 2008 and abatzoglou and ficklin 2017 demonstrated significant spatial variability in n due to basin climate vegetation soil and topographic conditions the n parameter value of 3 2 for phase 3 is at the high end of reported values in the literature roderick and farquhar 2011 state that n is usually between 1 5 and 2 6 for grasslands but can range between 0 6 3 6 abatzoglou and ficklin 2017 report high n values for the great plains although forests generally have a higher n value than cropland or grasslands other physical factors that increase n are present for the great plains monthly precipitation and potential evapotranspiration are seasonally in phase for the mauvais coulee annual snow water equivalent is a small percentage of annual precipitation depth the topography is very subdued and slope is uniformly low across the basin the available water holding capacity of the top 1 5 m root zone is high relative to annual precipitation all of these factors produce higher values for the n parameter abatzoglou and ficklin 2017 both climate elasticity coefficients indicate moderate sensitivity of streamflow to changes in p or etp table 3 the phase 1 n parameter value of 10 3 is much greater than values previously reported for other environments nearly all precipitation is partitioned into eta with very weak sensitivity of streamflow to either p or etp table 3 aridity index values are approximately 1 0 or greater and individual years are tightly aligned along the eta p 1 0 limit fig 7 when ø values are greater than 1 0 the system is considered to be water limited with annual eta limited by available p the unusually high n value may be a unique feature of the prairie environment but may also be an unrealistic result from uncritically applying the budyko framework to a cold region environment where fill spill hydrology principles occur ehsanzadeh et al 2016 found that effective drainage area ranged between 9 and 100 of conventional total drainage for prairie environments in canada although such numbers are not available for the mauvais coulee they are certain to be present the budyko method assumes that all precipitation is removed as q or lost as eta with storage change assumed to be zero when effective drainage area is substantially less than total drainage area q will be reduced and eta will be overestimated to maintain closure since p is unaffected by drainage area causing the value of n to be artificially inflated for phase 3 individual year ø values are both less than and greater than 1 0 and there is much greater spread of individual points about the budyko curve fig 7 interannual variations in soil moisture storage change could contribute to the wide scatter of points about the phase 3 budyko curve van hoy et al 2020 some years are water limited other years are energy limited with ø 1 0 and eta limited by etp this transition from a very dry climate mode to one considerably more mesic in character is consistent with the transition of the devils lake water budget from a precipitation dominated to a runoff dominated water budget todhunter 2018 the standard approach for estimating the climate change and human activity effect upon the partitioning of precipitation into eta and q based upon the budyko framework estimates n εp and εetp for the full period of record these parameter values and sensitivity coefficients are then used to estimate δqc δqh ηc and ηh for the change between bp and ap applying the standard approach for streamflow partitioning in the mcb for the full period of record causes values from one steady state period with a high evapotranspiration ratio and low sensitivity of runoff to precipitation eta p 0 986 n 10 3 εp 0 09 σq σp 0 10 to be mixed with values from a second steady state period with a lower evapotranspiration ratio and higher sensitivity of runoff to precipitation eta p 0 843 n 3 2 εp 0 51 σq σp 0 66 this creates an artificial regime of intermediate characteristics eta p 0 913 n 4 2 εp 0 37 σq σp 0 57 that is unrepresentative of the basin during the period of record and produces unrealistic values for δqc δqh ηc and ηh if climate mode 2 continues into the future however the application of the budyko framework to examine streamflow changes created by ongoing human activities occurring with the mcb would be suitable and fully consistent with assumptions of the methodology 5 conclusions the budyko framework has emerged as a popular method for estimating the sensitivity of streamflow to climate variations and human activities it has been implemented successfully at spatial scales ranging from regional global networks of hundreds thousands of stations to local scale studies of a single station it is a robust method based upon sound physical principles that avoids extensive site specific optimization of multiple model parameters its use however requires a number of assumptions that have not been verified prior to implementation of the framework we follow a standard approach in the literature for estimating the contribution of climate variations and human activities to precipitation partitioning between baseline and altered periods the appropriateness of the model assumptions were examined individually for the mauvais coulee north dakota substantial departures were found for each model assumption calling into question the accuracy of the values obtained from uncritical implementation of the budyko framework for the mauvais coulee the results for the period of record are best understood as a composite of three distinct periods two steady state climate periods each representing a separate and distinct climate mode with each period having a distinct p q relationship separated by a transitional period sampling two climate modes and possessing a transitional p q relationship for the mauvais coulee the estimates of δqc and δqh based upon the full period of record are best understood as artificial constructs of the budyko framework rather than physically valid estimates of streamflow response to variations in climate and human activity funding this work was supported by the north dakota water resources research institute usgs grant number far0026166 summer funding support was given to ccj to support her research the funding source had no involvement in the study design collection analysis and interpretation of data and in the writing of the report the nd wrri supports in general publication of research based upon their grants but had no input in the decision to submit the paper for publication credit authorship contribution statement p e todhunter conceptualization methodology formal analysis writing original draft writing review editing visualization supervision c c jackson formal analysis investigation writing original draft visualization funding acquisition t h mahmood methodology writing review editing visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements william m schuh hydrologist retired with the north dakota state water commission in bismarck nd provided valuable discussions and inspiration during the early stages of this work greg mccabe research physical scientist with the u s geological survey provided a copy of and guidance concerning the thornthwaite monthly water balance model we gratefully acknowledge the helpful comments by two anonymous reviewers appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 125569 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
5102,reliable assessment of the complex natural exchange processes between connected hydrological reservoirs is crucial for estimating hydrological properties safeguarding ecosystem services and effectively managing water resources although many hydrological or water resource applications require information at a large scale the highly dynamic seasonal variations of the water discharge and sediment exchange processes between local basins and connected large rivers lead to complex and difficult to assess hydrological behaviors in large river lake systems this special issue aims to provide the interested reader with some of the latest achievements experiences gained and challenges addressed related to research in large river lake systems therefore a diverse group of 15 new articles has been gathered bringing together the cutting edge research of more than 60 authors on monitoring modeling and data science methods for large river lake systems 1 introduction reliable assessment of the complex natural exchange processes between connected hydrological reservoirs is crucial for estimating hydrological properties safeguarding ecosystem services and effectively managing water resources considering the growing concern on climate change and its impact on water resources the provision of accurate information on exchange fluxes is essential to forecast the future state of hydrological systems although many hydrological or water resource applications require information at a large scale the highly dynamic seasonal variations of the water discharge and sediment exchange processes between local basins and connected large rivers lead to complex and difficult to assess hydrological behaviors in large river lake systems contemporary hydrology is faced simultaneously with various challenges such as new model approaches for large hydrological systems archfield et al 2015 as well as adequate and flexible monitoring concepts including event driven campaigns and coping with the increasing amount of data from both observation and high resolution modeling sun and scanlon 2019 some of these challenges are tackled in the present special issue firstly despite the significant advances to develop integrated hydrologic and hydrodynamic modeling methods to analyze large river lake systems having complex interactions and influences research subjects like conceptual complexity reduction integration of multi scale processes as well as sufficient computational performance e g high performance computing scalability remain challenges to the scientific community fatichi et al 2016 new research questions are also emerging as large study areas such as the complex large lake river systems of lake poyang and lake dongting in the yangtze river basin are taken into intensive investigation e g hu et al 2020 secondly from the experimentalist s perspective observational data are essential for monitoring and understanding the changing characteristics and principles of basins with complex river lake interactions which are closely related to improving the quality of water pollution simulation and assessment results nevertheless large river lake systems often have few stationary monitoring sites and the ability to design both regular and event driven measurement campaigns may be limited by the available human and financial resources hence investigating large river lake systems requires developing novel monitoring and data processing approaches such as exploiting large scale and continuous observations e g li et al 2020a recent advancements in spatial information gathering e g drone monitoring and intelligent sensing technology e g wireless sensor networks with automatized quality control provide important tools for the dynamic monitoring of ecological environments with complex river lake interactions lastly the rising amount of data drive the development of adapted workflows and platforms for data storing processing sharing analyzing and visualization kolditz et al 2019 although data and model integration has been supported by the development of environmental information methods and systems more novel research should be explored to adequately approach challenges such as big data and open integrated modeling lü et al 2019 chen et al 2020 this special issue aims to provide the interested reader with some of the latest achievements experiences gained and challenges addressed related to research in large river lake systems therefore a diverse group of 15 new articles has been gathered bringing together the cutting edge research of more than 60 authors on monitoring modeling and data science methods for large river lake systems 2 overview of research the contributions have been grouped into four different categories i regional hydrological modeling section 2 1 ii remote sensing and hydrodynamic modeling of surface waters section 2 2 iii visualization and data sharing in hydrology section 2 3 and iv wetland ecohydrology section 2 4 2 1 regional hydrological modeling contributions addressing this category present research on applying hydrological models to better describe processes on the catchment scale a focus of the presented work is to extend the soil and water assessment tool swat model by either implementing new processes for better describing specific biological and chemical processes or by coupling the model with external forcing meshesha et al 2020 extend the swat model by improving the watershed scale module of water quality for dissolved oxygen dissolved organic carbon and fecal coliforms the modified model examines the spatio temporal patterns and their impacts on the aquatic ecosystem and water quality processes in the athabasca river basin alberta canada the improved swat model shows good behavior which can be referenced by similar studies melaku et al 2020 propose a modified swat model to couple snow soil temperature and carbon dioxide emission the practicability and feasibility of the modified model are examined by application on the peatland area in the athabasca river basin canada the results confirm that the modified swat model performs well in representing the dynamics of snow depth soil temperature and co2 emissions lai et al 2020 establish a forest growth model featuring variable density and mixed vegetation types to handle the limitation of the swat model in estimating accumulated biomass the modified model is validated with the application to field data on the meijiang river basin china the modified swat model outperforms its original model in terms of simulated flow and nutrient load estimations worku meshesha et al 2020 augment the modified swat bacteria module by incorporating a ph factor to evaluate the potential effect of ph on e coli concentrations with the results of e coli observations from four sites of the athabasca river basin the modified swat bacteria module could be a powerful tool for the future regional to global scale model of e coli concentrations 2 2 remote sensing and hydrodynamic modeling of surface waters investigating large scale hydrosystems requires advancement of remote sensing data processing and modeling capabilities presented research in this section focuses on developing methods in this field using large chinese water systems such as poyang lake and dongting lake as case studies from a methodological point of view the contributions cover processing time series data from high resolution satellites as well as developing new algorithms and numerical high resolution models to better describe hydrodynamic processes in large river lake systems liang et al 2020 approach the hydrological influences on wetland cover distribution and transition in a large complex lake floodplain system poyang lake china using time series satellite remote sensing observations the results show that hydrological fluctuations have various degrees of impacts on different types of wetland cover transformation liu et al 2020b illustrate the dynamic changes in water quantity in poyang lake based on hj 1a b and landsat data from 1989 to 2018 and analyzed the influencing factors and ecological impacts of water quantity changes the results show that in terms of the water area change trend on the annual scale the mean values of water area and volume demonstrate overall decreasing trends liu et al 2020a investigate the hydrological connectivity with applications in a complex river lake floodplain of the poyang lake floodplain using geostatistical methods in combination with remote sensing data the results find the apparent seasonal shifts of the dominant hydrological factors that affect the spatial temporal changes of the hydrological connectivity li et al 2020b apply a 2d floodplain hydrodynamic model to investigate the coupled effects of floodplain vegetation on the hydrodynamic patterns of poyang lake china the model results indicate the interactions between vegetation and hydrology vary with the floodplain seasonality which provides important knowledge regarding the role of floodplain vegetation changes to decision makers for both poyang lake and other similar flood pulse systems zhao et al 2020 utilize landsat thermal infrared imagery to quantify the long term 2002 2017 impacts of the danjiangkou dam china on the thermal regimes of downstream han river the findings provide new scientific understandings about the long term seasonal thermal regimes of dammed rivers which could be applicable to thermal effect investigations for large dams hu et al 2020 propose a new 1d hydro environmental model for free surface flows and scalar transport in large river lake systems by solving local linear systems based on domain decomposition this model further implements the openmp parallel technique to improve its efficiency achieved increases in model performance will help to run flow and scalar transport schemes for large shallow water systems in the future 2 3 visualization and data sharing in hydrology contributions to this category underpin the need to share and visualize the fast growing amount of data available in hydrology presented research not only provides new ideas to standardize and visualize high dimensional data sets but also focuses on using open source software to ensure transferability of the developed workflows wang et al 2020 propose a new data sharing strategy for geographic modeling and simulation in practice hydrologists are often faced with the problem of data from numerous sources with different formats the data sharing method relies on a structured data description model rather than raw data files by processing multisource hydrological data in a unified way a corresponding data configuration manager for customizing data is implemented using python based sdk including data publishing services a built in data viewer allows for a shareable visualization of multi source data rink et al 2020 present a visualization framework for data exploration analysis and presentation of complex hydrological systems in large catchments the case study for demonstration is the poyang lake basin the virtual geographic environment vge combines a wide range of 2d and 3d observation data sets with simulation results from both an opengeosys groundwater model and a coast2d hydrodynamic model methods of scientific visualization are utilized to illustrate various aspects of multi variate data in intuitive ways moreover interaction techniques for navigation animation and access to linked data sets from external sources such as time series data or websites are important features for building environmental information systems the vge concept is implemented in a generic way and therefore transferable and applicable to other regions of interest 2 4 wetland ecohydrology advancing knowledge of chemical and ecological responses on changing hydrological conditions is central to better predict the impact of water resources development projects and water management systems the authors contributing research to this section investigate nutrient and water organism dynamics in the wetlands of large chinese hydrosystems heavily influenced by human interventions bai et al 2020 investigate the dynamics of phosphorus fractions in surface soils of different flooding wetlands before and after flow sediment regulation in the yellow river estuary based on different types of soil samples for tidal flooding and freshwater restoration and freshwater flooding wetlands from april to october of 2012 the findings provide the fundamental data for phosphorus fractions and help for guiding flow sediment regulations and freshwater restoration xie et al 2020 conduct in situ experiments to investigate the groundwater vertical flow direction and rate in four zones of salt marsh macrophytes in the yellow river estuarine nature reserve the experiments show that the shallow soil water salt interactions affect the habitat of macrophytes which form band shaped macrophyte zones dai et al 2020 propose a study of the water diversion from the yangtze river to lake taihu in china which addresses the challenge of identification and quantification of potential contributions of allochthonous inputs and physicochemical habitat shifts to variations in phytoplankton communities 3 summary modeling and monitoring the complex hydrological behavior in and between large river lakes systems continues to be a highly relevant topic of hydrological research the contributions received for this special issue reflect a set of current themes in the field and demonstrate how hydrology on large scales benefits the relentless growth of computational power and the increasing availability of long high resolution time series of space borne geospatial datasets they further emphasize the demand to develop data processing and visualization workflows capable of analyzing the growing amount of data available for large coupled hydrosystems we hope that this small selection of examples provides a broad and diverse view of the state of the art research ideas and methods for other hydrologists to improve insight into their data and processes link to volume https www sciencedirect com journal journal of hydrology special issue 102v3wckrpk declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the guest editors would like to thank the contributing authors who present a detailed view of the possibilities of modeling and monitoring approaches for large river lake systems both from a hydrology and from a computer science point of view we express our sincere thanks to professor huaming guo both for his encouragement and support for this special issue and for overseeing the review and editorial processes many thanks also to the reviewers for their comments to improve the quality of the articles presented here we thank leslie jakobs for proofreading the manuscript further acknowledgments to particular project funding are referred to in the individual papers of this thematic issue 
5102,reliable assessment of the complex natural exchange processes between connected hydrological reservoirs is crucial for estimating hydrological properties safeguarding ecosystem services and effectively managing water resources although many hydrological or water resource applications require information at a large scale the highly dynamic seasonal variations of the water discharge and sediment exchange processes between local basins and connected large rivers lead to complex and difficult to assess hydrological behaviors in large river lake systems this special issue aims to provide the interested reader with some of the latest achievements experiences gained and challenges addressed related to research in large river lake systems therefore a diverse group of 15 new articles has been gathered bringing together the cutting edge research of more than 60 authors on monitoring modeling and data science methods for large river lake systems 1 introduction reliable assessment of the complex natural exchange processes between connected hydrological reservoirs is crucial for estimating hydrological properties safeguarding ecosystem services and effectively managing water resources considering the growing concern on climate change and its impact on water resources the provision of accurate information on exchange fluxes is essential to forecast the future state of hydrological systems although many hydrological or water resource applications require information at a large scale the highly dynamic seasonal variations of the water discharge and sediment exchange processes between local basins and connected large rivers lead to complex and difficult to assess hydrological behaviors in large river lake systems contemporary hydrology is faced simultaneously with various challenges such as new model approaches for large hydrological systems archfield et al 2015 as well as adequate and flexible monitoring concepts including event driven campaigns and coping with the increasing amount of data from both observation and high resolution modeling sun and scanlon 2019 some of these challenges are tackled in the present special issue firstly despite the significant advances to develop integrated hydrologic and hydrodynamic modeling methods to analyze large river lake systems having complex interactions and influences research subjects like conceptual complexity reduction integration of multi scale processes as well as sufficient computational performance e g high performance computing scalability remain challenges to the scientific community fatichi et al 2016 new research questions are also emerging as large study areas such as the complex large lake river systems of lake poyang and lake dongting in the yangtze river basin are taken into intensive investigation e g hu et al 2020 secondly from the experimentalist s perspective observational data are essential for monitoring and understanding the changing characteristics and principles of basins with complex river lake interactions which are closely related to improving the quality of water pollution simulation and assessment results nevertheless large river lake systems often have few stationary monitoring sites and the ability to design both regular and event driven measurement campaigns may be limited by the available human and financial resources hence investigating large river lake systems requires developing novel monitoring and data processing approaches such as exploiting large scale and continuous observations e g li et al 2020a recent advancements in spatial information gathering e g drone monitoring and intelligent sensing technology e g wireless sensor networks with automatized quality control provide important tools for the dynamic monitoring of ecological environments with complex river lake interactions lastly the rising amount of data drive the development of adapted workflows and platforms for data storing processing sharing analyzing and visualization kolditz et al 2019 although data and model integration has been supported by the development of environmental information methods and systems more novel research should be explored to adequately approach challenges such as big data and open integrated modeling lü et al 2019 chen et al 2020 this special issue aims to provide the interested reader with some of the latest achievements experiences gained and challenges addressed related to research in large river lake systems therefore a diverse group of 15 new articles has been gathered bringing together the cutting edge research of more than 60 authors on monitoring modeling and data science methods for large river lake systems 2 overview of research the contributions have been grouped into four different categories i regional hydrological modeling section 2 1 ii remote sensing and hydrodynamic modeling of surface waters section 2 2 iii visualization and data sharing in hydrology section 2 3 and iv wetland ecohydrology section 2 4 2 1 regional hydrological modeling contributions addressing this category present research on applying hydrological models to better describe processes on the catchment scale a focus of the presented work is to extend the soil and water assessment tool swat model by either implementing new processes for better describing specific biological and chemical processes or by coupling the model with external forcing meshesha et al 2020 extend the swat model by improving the watershed scale module of water quality for dissolved oxygen dissolved organic carbon and fecal coliforms the modified model examines the spatio temporal patterns and their impacts on the aquatic ecosystem and water quality processes in the athabasca river basin alberta canada the improved swat model shows good behavior which can be referenced by similar studies melaku et al 2020 propose a modified swat model to couple snow soil temperature and carbon dioxide emission the practicability and feasibility of the modified model are examined by application on the peatland area in the athabasca river basin canada the results confirm that the modified swat model performs well in representing the dynamics of snow depth soil temperature and co2 emissions lai et al 2020 establish a forest growth model featuring variable density and mixed vegetation types to handle the limitation of the swat model in estimating accumulated biomass the modified model is validated with the application to field data on the meijiang river basin china the modified swat model outperforms its original model in terms of simulated flow and nutrient load estimations worku meshesha et al 2020 augment the modified swat bacteria module by incorporating a ph factor to evaluate the potential effect of ph on e coli concentrations with the results of e coli observations from four sites of the athabasca river basin the modified swat bacteria module could be a powerful tool for the future regional to global scale model of e coli concentrations 2 2 remote sensing and hydrodynamic modeling of surface waters investigating large scale hydrosystems requires advancement of remote sensing data processing and modeling capabilities presented research in this section focuses on developing methods in this field using large chinese water systems such as poyang lake and dongting lake as case studies from a methodological point of view the contributions cover processing time series data from high resolution satellites as well as developing new algorithms and numerical high resolution models to better describe hydrodynamic processes in large river lake systems liang et al 2020 approach the hydrological influences on wetland cover distribution and transition in a large complex lake floodplain system poyang lake china using time series satellite remote sensing observations the results show that hydrological fluctuations have various degrees of impacts on different types of wetland cover transformation liu et al 2020b illustrate the dynamic changes in water quantity in poyang lake based on hj 1a b and landsat data from 1989 to 2018 and analyzed the influencing factors and ecological impacts of water quantity changes the results show that in terms of the water area change trend on the annual scale the mean values of water area and volume demonstrate overall decreasing trends liu et al 2020a investigate the hydrological connectivity with applications in a complex river lake floodplain of the poyang lake floodplain using geostatistical methods in combination with remote sensing data the results find the apparent seasonal shifts of the dominant hydrological factors that affect the spatial temporal changes of the hydrological connectivity li et al 2020b apply a 2d floodplain hydrodynamic model to investigate the coupled effects of floodplain vegetation on the hydrodynamic patterns of poyang lake china the model results indicate the interactions between vegetation and hydrology vary with the floodplain seasonality which provides important knowledge regarding the role of floodplain vegetation changes to decision makers for both poyang lake and other similar flood pulse systems zhao et al 2020 utilize landsat thermal infrared imagery to quantify the long term 2002 2017 impacts of the danjiangkou dam china on the thermal regimes of downstream han river the findings provide new scientific understandings about the long term seasonal thermal regimes of dammed rivers which could be applicable to thermal effect investigations for large dams hu et al 2020 propose a new 1d hydro environmental model for free surface flows and scalar transport in large river lake systems by solving local linear systems based on domain decomposition this model further implements the openmp parallel technique to improve its efficiency achieved increases in model performance will help to run flow and scalar transport schemes for large shallow water systems in the future 2 3 visualization and data sharing in hydrology contributions to this category underpin the need to share and visualize the fast growing amount of data available in hydrology presented research not only provides new ideas to standardize and visualize high dimensional data sets but also focuses on using open source software to ensure transferability of the developed workflows wang et al 2020 propose a new data sharing strategy for geographic modeling and simulation in practice hydrologists are often faced with the problem of data from numerous sources with different formats the data sharing method relies on a structured data description model rather than raw data files by processing multisource hydrological data in a unified way a corresponding data configuration manager for customizing data is implemented using python based sdk including data publishing services a built in data viewer allows for a shareable visualization of multi source data rink et al 2020 present a visualization framework for data exploration analysis and presentation of complex hydrological systems in large catchments the case study for demonstration is the poyang lake basin the virtual geographic environment vge combines a wide range of 2d and 3d observation data sets with simulation results from both an opengeosys groundwater model and a coast2d hydrodynamic model methods of scientific visualization are utilized to illustrate various aspects of multi variate data in intuitive ways moreover interaction techniques for navigation animation and access to linked data sets from external sources such as time series data or websites are important features for building environmental information systems the vge concept is implemented in a generic way and therefore transferable and applicable to other regions of interest 2 4 wetland ecohydrology advancing knowledge of chemical and ecological responses on changing hydrological conditions is central to better predict the impact of water resources development projects and water management systems the authors contributing research to this section investigate nutrient and water organism dynamics in the wetlands of large chinese hydrosystems heavily influenced by human interventions bai et al 2020 investigate the dynamics of phosphorus fractions in surface soils of different flooding wetlands before and after flow sediment regulation in the yellow river estuary based on different types of soil samples for tidal flooding and freshwater restoration and freshwater flooding wetlands from april to october of 2012 the findings provide the fundamental data for phosphorus fractions and help for guiding flow sediment regulations and freshwater restoration xie et al 2020 conduct in situ experiments to investigate the groundwater vertical flow direction and rate in four zones of salt marsh macrophytes in the yellow river estuarine nature reserve the experiments show that the shallow soil water salt interactions affect the habitat of macrophytes which form band shaped macrophyte zones dai et al 2020 propose a study of the water diversion from the yangtze river to lake taihu in china which addresses the challenge of identification and quantification of potential contributions of allochthonous inputs and physicochemical habitat shifts to variations in phytoplankton communities 3 summary modeling and monitoring the complex hydrological behavior in and between large river lakes systems continues to be a highly relevant topic of hydrological research the contributions received for this special issue reflect a set of current themes in the field and demonstrate how hydrology on large scales benefits the relentless growth of computational power and the increasing availability of long high resolution time series of space borne geospatial datasets they further emphasize the demand to develop data processing and visualization workflows capable of analyzing the growing amount of data available for large coupled hydrosystems we hope that this small selection of examples provides a broad and diverse view of the state of the art research ideas and methods for other hydrologists to improve insight into their data and processes link to volume https www sciencedirect com journal journal of hydrology special issue 102v3wckrpk declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the guest editors would like to thank the contributing authors who present a detailed view of the possibilities of modeling and monitoring approaches for large river lake systems both from a hydrology and from a computer science point of view we express our sincere thanks to professor huaming guo both for his encouragement and support for this special issue and for overseeing the review and editorial processes many thanks also to the reviewers for their comments to improve the quality of the articles presented here we thank leslie jakobs for proofreading the manuscript further acknowledgments to particular project funding are referred to in the individual papers of this thematic issue 
5103,iran experiences frequent destructive floods with significant socioeconomic consequences quantifying the accurate impacts of such natural hazards however is a complicated task the present study uses a deep learning convolutional neural networks cnn algorithm which is among the newer and most powerful algorithms in big data sets to develop a flood susceptibility map for iran a total of 2769 records were collected from flood locations across the entire country we divided this data set into two groups using a cross validation technique the first group used as a training data set was constructed from 70 of the data set and was used for model building the second group used as a testing data set was constructed from the remaining 30 of the records and used for validation ten flood conditioning factors slope altitude aspect plan curvature profile curvature rainfall geology land use distance from roads and distance from rivers were identified and used in the modeling process the area under the prediction rate curve was used for model evaluation with results showing that the flood susceptibility map has an acceptable accuracy of 75 the results also indicated that approximately 12 and 3 of the country are highly and very highly susceptible to future flooding events respectively moreover 29 and 49 of iran s cities are located in areas with high and very high susceptibility to future flooding hazards the most effective approaches to flood mitigation are preventing urban expansion and new construction in highly to very highly flood prone areas as well as watershed management plans and constructing flood control structures according to the topographical characteristics of the catchment keywords flood control hazard iran deep learning 1 introduction floods are among the most destructive natural hazards in tropical areas that experience high rainfall in particular during monsoon periods and in dry and semi dry regions as flash floods flooding can cause irreparable and immeasurable damage that may be categorized as tangible or intangible tangible damage which includes destruction to buildings agriculture road and transportation systems infrastructure environmental ecosystems humans and property imposes a major negative emotional burden on the society in question khosravi et al 2016a 2016b termeh et al 2018 tiryaki and karaca 2018 floods affect 75 million people on average annually worldwide around 20 000 casualties per year with economic losses of 95 billion chapi et al 2017 khosravi et al 2018b recently the frequency of flooding has increased by more than 40 hirabayashi et al 2013 because climate change has significantly influenced the intensity pattern and magnitude of flooding chapi et al 2017 hens et al 2018 van thanh et al 2017 asian countries in particular are hotspots with relatively high exposure to flooding and earthquakes in asia more than 90 of human losses resulting from natural disasters are attributable to flooding smith 2003 flooding results from the direct impact of both natural and anthropogenic factors chang and chen 2016 iran has recently experienced disastrous floods that in addition to the impact of climate change can be attributed to poor watershed management e g deforestation overgrazing lack of flood control measures khosravi et al 2016a recent flooding events in iran and their record casualties have affected 25 of the country s 31 provinces resulting in more than 77 human casualties and usd 2 2 billion worth of damage to public and private assets https en wikipedia org wiki 2019 iran floods some real photo of the flooding events in a different part of the country is presented in fig 1 furthermore at the time of this writing a vast region in southern and southeastern iran including sistan baluchistan is facing unprecedented floods although flooding hazards are inevitable and largely beyond human control flood risk management practices can mitigate the impact of flooding through hazard prediction and vulnerability reduction identifying areas prone to flooding can inform threatened communities and decision makers at different levels to avoid catastrophes and therefore is key to flood risk management bui et al 2018 choubin et al 2019 kourgialas and karatzas 2011 sarhadi et al 2012 tehrany et al 2013 tien bui et al 2018 flooding a complex phenomenon resulting from watershed management and hydrological meteorological geomorphological and geological conditions is a sophisticated and non linear process and thus cannot be easily predicted with simple linear models pappenberger et al 2006 numerical models such as the hydrologic engineering center s ceiwr hec river analysis system hec ras offer some advantages such as the calculation of discharge in any cross section flow depth or velocity in particular concerning inundation maps two or three dimensional and are appropriate modeling flood challenges however the large amounts of data that they require for modeling and calibration are unavailable in many developing countries these models are also computationally demanding and time consuming in particular in large areas i e generating a large scale flood map such as for an entire country is difficult in general two or three dimensional flood modeling is unviable for areas larger than 1000 km2 in particular when high resolution is required teng et al 2017 several powerful physically based models hydrographs have been developed to predict flood discharge e g swat hec hms although these models are robust well known and developed according to the relevant catchments rainfall runoff processes they still have several shortcomings for generating flood maps and identifying inundation areas sahoo et al 2009 consequently researchers are keen to identify alternative robust and flexible models to remedy these weaknesses recently the use of geographic information systems gis and remote sensing rs has brought new insights to the field of hydrology and multidimensional phenomena in particular flood modeling to address the weaknesses of the models above gis is a useful geostatistical tool that can handle large amounts of data of different scales and from different sources for flood map generation several researchers have integrated various data driven bivariate and multivariate and multi criteria decision making mcdm algorithms with gis and rs for flood susceptibility mapping fsm including frequency ratio khosravi et al 2016a lee et al 2012 tehrany et al 2013 weights of evidence rahmati et al 2016 evidential belief function tien bui et al 2019 shannon entropy haghizadeh et al 2017 analytic hierarchy process ahp chen et al 2011 das 2019 analytic network process anp dano et al 2019 de brito and evers 2016 the decision making trial and evaluation laboratory dematel azareh et al 2019 technique for order preference by similarity to ideal solution topsis khosravi et al 2019 and logistic regression lr youssef et al 2015 although bivariate statistical models have simple structures and are easy to interpret as a result of this simplicity they are not sufficiently accurate for predicting complex phenomena such as flood occurrences furthermore the mcdm technique as a subjectivity model is weakened by its reliance on expert opinion as an essential input which often introduces bias khosravi et al 2018b 2019 thus machine learning algorithms were developed to address these weaknesses these include artificial neural networks ann falah et al 2019 kia et al 2012 support vector machines svm kavzoglu et al 2014 random forests chapi et al 2017 logistic model trees pham et al 2018 naïve bayes trees khosravi et al 2019 and multivariate adaptive regression splines mars dodangeh et al 2020 each of these algorithms has several drawbacks the use of svm has declined as a result of the numerous parameters in its structure for each of which optimum values must be determined and the need to determine the most effective kernel functions in its structure although the decision tree dt algorithm offers reasonable precision in fsm tehrany et al 2013 it has some problems for defining rules for performance in dt multiple output attributes are not allowed and trees are sensitive to noisy data tien bui et al 2012 another weakness of dt is that this model may produce a large tree structure which makes interpretation difficult and misclassification of data may occur during the machine learning process tehrany et al 2013 ann the most widely used algorithm also suffers from several drawbacks that result in its poor prediction capacity therefore ann was integrated with fuzzy logic and the adaptive neuro fuzzy inference system anfis was developed although the anfis is a powerful model it struggles to accurately determine the weights of membership functions in fuzzy rules some researchers have integrated different optimization algorithms with the anfis model to address this weakness with respect to different aspects of hydrology such as fsm bui et al 2018 2016 khosravi et al 2018a tien bui et al 2018 wang et al 2019 groundwater potential mapping chen et al 2019 khosravi et al 2018a termeh et al 2018 and landslide susceptibility mapping chen et al 2017 but this successive integration of the anfis model with optimization algorithms is complex and has decreased its use deep learning algorithms have recently gained superiority over traditional machine learning models by virtue of their greater flexibility and predictive accuracy in particular for big data and incremental approaches have been used to learn high level components from the data sets used ghorbanzadeh et al 2019 deep learning algorithms outperform all other traditional machine learning algorithms when a data set is particularly large and the problem under investigation has a complex process panahi et al 2020 a convolutional neural network cnn an automatic tool is the most popular deep learning algorithm which is proper for spatial data like present study this algorithm sets the features as input and can be described as a tensor with which local components are inter correlated convolutional layer in cnn algorithm can simultaneously learn the connection between features and this would result to achieve higher performance also cnn use minimal amount of preprocessing in this paper we propose a framework with a robust deep learning algorithm that helps to generate flood susceptibility maps this framework was used to generate maps for iran and draw conclusions regarding the spatial distribution of susceptibility and its potential drivers 1 1 study area iran is a middle eastern country with a population of 82 million and an area of 1 648 195 km2 iran lies between longitude 44 and 63 5 30 e and latitude 25 and 40 n it is bordered by iraq and turkey to the west and by armenia azerbaijan the caspian sea and turkmenistan to the north afghanistan and pakistan border iran to the east with the persian gulf and the oman sea to the south fig 2 almost 50 of iran consists of mountains fertile plains account for 25 and the remaining 25 is desert dehnavi et al 2015 the slope angle ranges from 0 to 76 28 and the altitude ranges from 500 to 5597 m above sea level the country s two main mountains are zagros in the west and alborz in the north iran s climate is unique by virtue of the difference between the warmest and coldest temperatures in winter which can sometimes be more than 50 c iran is located in an arid semi arid region with annual average precipitation close to 200 mm and significant spatial variability from 15 mm year in the central deserts up to 2000 mm year in the north the spatial variability in precipitation and temperature has a significant impact on the vegetation cover in terms of its geomorphological characteristics iran is divided into the different regions of caspian zagros the central plateau and southern coastal plains ghorbani 2013 political boundaries divide it into 31 provinces and 1243 large cities 339 of which have populations 20 000 2 methodology a diagram of the conceptual modeling methodology adopted in the current study is presented in fig 3 2 1 flood inventory mapping the first step in the flood modeling and mapping process is to compile historical flood data and to determine flood conditioning factors as well as the spatial relationships between these factors and flooded locations to understand the dynamics of flooding in the area of interest a total of 2769 historical flood records collected by iran s water resources management company iwrmc were used for modeling these locations were ultimately converted into several points and then precisely located in polygonal format 2 2 preparation and selection of flood conditioning factors in the first stage of modeling ten flood conditioning factors were considered based on the literature khosravi et al 2016b tehrany et al 2015 wang et al 2019 catchment characteristics and data availability these factors were slope altitude aspect plan curvature profile curvature rainfall geology land use distance from roads and distance from rivers bui et al 2018 2016 khosravi et al 2016a 2018b 2016b 2019 tehrany et al 2013 tien bui et al 2018 2019 we implemented a widely used approach the information gain ratio igr technique to distinguish between variables with a significant impact on the accuracy of estimation and noise creating variables with negative effects on the outcome table 2 slope altitude aspect plan curvature and profile curvature were constructed from topographic maps obtained from the national cartographic center of iran ncc with a spatial resolution of 30 30 m distance from rivers and road were computed with data from iranian rivers and roads a shapefile provided by iwrmc and using the multiple ring buffer tool in arcgis 10 2 the geological map of iran was acquired from geological survey mineral explorations of iran gsi the rainfall map used in this study was constructed by iran s meteorological organization imo using long term rainfall data 30 years of mean annual rainfall landuse map was obtained as a shapefile from the iranian agriculturalscientific ministry table 1 all the input maps and their classes are presented in fig a1 in the appendix 2 3 building of the training and testing data sets the final step in fsm by artificial intelligence algorithms involves binary classification with two classes of flood and non flood locations consequently arcgis10 2 was used to identify 2769 non flood locations in places such as areas which are never inundated during flood events one of the most obvious examples is hilly or mountainous areas all non flood locations presented in fig b1 in the appendix flood and non flood locations were assigned values of 1 and 0 respectively and were overlaid with the 10 flood conditioning factors finally the required information i e flood position located in which class of each flood conditioning factor was extracted and converted into an excel file all information extracted with respect to flood and non flood locations was divided into two groups by a cross validation technique at a ratio of 70 30 the most commonly used ratio in spatial modeling of natural hazards tehrany et al 2014 2015 the first portion was used for training the training data set and was constructed from 70 of flood and non flood locations for model building and the second portion the testing data set was used for model validation and was constructed from the remaining 30 of flood and non flood locations chung and fabbri 2003 3 model description 3 1 convolutional neural networks cnn to overcome the challenge of decreased speed in the learning process faced by traditional artificial neural networks ann in analyzing complex networks lu et al 2017 bengio proposed the convolutional neural network cnn which is a neural network that carries out local connections among layers lecun et al 1998 lu et al 2017 cnn has different neuronal layers the first layer extracts features from an input image as well as retains connections between pixels by understanding image features that use small squares of input data this layer is called the convolution layer the convolution layer is a mathematical operation base and requires two inputs an image matrix and a filter or kernel to be run the second layer is the activation layer which usually appears after the convolutional layer if it is non linear however a rectified linear unit relu function is the most effective and typical activation function and is always zeros and ones the third layer or the pooling layer preserves the most critical information while reducing the number of parameters in particular when images are very large spatial pooling has different types such as max average sum and so forth the last layer is the actual component and performs discriminative learning in a deep neural network this fully connected layer is a simple and multilayer perceptron that can learn weights and identify object classes based on the type of data images and goals scientists have proposed different structures for their research including zfnet vggnet googlenet resnet lenet 5 and alexnet fang et al 2019 geoscience researchers have achieved and reported notable results using cnn 2d and thus this structure was used in this study wang et al 2019 moreover because cnn input data must take the form of images and the input data are one dimensional the primary data must be converted into images to initialize fsm a one dimensional input grid cell that consists of different attribute features must be converted into a two dimensional matrix because none of the data are classified and are constant the images created are very large the network used has a convolutional layer with 100 filters at the beginning and in most cases these layers are used for those data that have more correlation with adjacent features inherently these kinds of cases are applied for the data like image however it is not useful for the features used in this article in order for the network to be able to learn the correlation between features simultaneously during the learning process the filter size considered should be 10 1 this enables the filter to consider all features and their correlations to extract the correlation features this layer uses the activation function relu the next layer used is the normalization layer that accelerates the learning process in the following a dropout layer with 50 rate is used this layer transforms 50 of the output from pre layer to 0 values in each learning iteration so that the next layer does not overfit learning inputs and enable the learning of different aspects of the data the next layer is the average pooling layer with filter size 3 1 that reduces its dimension by a half this layer dramatically reduces the weight of the network and highly decreases its computational load during the learning process the following layer is fully connected it has five neurons and its activation function is a relu like convolutional layer finally the last layers are also fully connected with one neuron and one regression layer that produces the final output the cnn structure and its parameters are presented in fig 4 and table 2 there are several different approaches developed to avoid over fitting srivastava et al 2014 the first method is to use a set of data validation 10 of train data to check the method s accuracy after training which not only adjusts network parameters but also helps to avoid over fitting by comparing the network accuracy of data and training data the second approach is applying a dropout layer after each convolutional layer which deletes 50 of its input layers after every iteration in order for the network to learn all aspects of the given dataset as well as to avoid over fitting the other approach is to use a relatively small network which would help the network not to be over fitted tables 3 and 4 show the network s accuracy for training and testing data both with and without using a dropout layer as can be seen when the dropout layer is not used network accuracy over fitting of training data is improved however for testing data the difference between using and not using the dropout layer is quite clear and it is clear that not using the dropout layer decrease the network accuracy of testing data which means this approach is efficient the final approach to avoid over fitting is by applying l2 regularization in this method las function is being added to the second norm of network weight this would reduce network overfitting additionally the second norm coefficient of weights weight decay was considered 0 0001 fig 5 shows the convergence plot of the models 3 2 flood map generation validation and hazard assessment in the present study a newly developed artificial intelligence deep cnn algorithm was used to delineate flood prone areas as a first step the cnn algorithm was trained model learning using a training data set i e the training data set in excel format used for model building next the country of iran was converted into a raster format the model developed was used to predict a flood susceptibility probability index for each pixel in the study area i e in this stage the entire country was used as a test data set for the built model finally these indices were divided into different classes of very low low moderate high and very high susceptibility to flooding different methods may be used for this classification but as our predicted indices were skewed the quantile method was used khosravi et al 2019 the final step was to evaluate the resulting map therefore the testing data set was applied in terms of prediction rate curves so that the area under the curve auc identified the model prediction capability quantitatively khosravi et al 2016a 2016b finally by overlaying the flood susceptibility map on the locations of cities in iran we identified the number of cities in each class and used them for further analyses 4 results and discussion the flooding prediction map was evaluated with the testing data set the results from this phase show a reasonable and good fit determined by an area under the prediction rate curve auc of 0 75 this means that the map s accuracy is around 75 khosravi et al 2019 which is reliable and acceptable in particular given the large size of the study area based on the classification efficiency proposed by hosmer and lemeshow 2000 model performance can be classified into different accuracy classes including 0 5 0 6 0 6 0 7 0 7 0 8 0 8 0 9 and 0 9 1 which correspond to poor average good very good and excellent performance respectively yesilnacar 2005 given its good accuracy this map was used for further analyses the results of the information gain ratio method shown in table 5 indicate that the land use factor has the greatest impact on iran s flood occurrences 0 60 followed by aspect 0 40 altitude 0 37 plan curvature 0 35 distance from rivers 0 33 rainfall 0 30 slope 0 29 distance from roads 0 278 and geology 0 08 this demonstrates that all thematic layers considered significantly influence flooding by identifying the impact of each factor on flood occurrences one can more effectively implement flood control plans and measures visual inspection of the effective flood conditioning factors i e slope curvature rainfall and altitude maps fig a1 and the flood susceptibility map fig 6 clearly reveals that most flood prone areas are located in regions where mountain ranges are in close proximity to flat areas provided these areas have sufficient rainfall this observation is consistent with the nature of the mechanisms that promote flooding it is worth mentioning that although these areas are exposed to high flood hazards they tend to be densely populated because of their fertile soils good weather conditions and surface water supply among other factors land use is the factor that most influences flood occurrences because most of iran s land is covered by bare soil that is completely compacted because of overgrazing and therefore is very effective at generating runoff land use effectiveness especially plant s role in runoff generation is described by hou et al 2020 although flooding is linked to rainfall rainfall is not the main factor predicting flood susceptibility in iran as it is very high in mountainous areas where flooding does not occur our results are in good agreement with those of khosravi et al 2016a analyses of the flood susceptibility map fig 6 indicate that 3 and 12 of the entire country have very high and high susceptibility to future flood occurrences respectively corresponding to total areas of 44 943 and 191 107 km2 these areas are distributed in northern and western iran fig 6 the guilan province has the country s highest percentage of high and very high flood prone areas 19 8 followed by mazandaran 17 6 golestan 10 1 alborz 10 2 and khozestan 9 3 whereas the yazd province has the lowest percentage 0 2 fig 7 by contrast the highest percentage of areas with very low susceptibility to flooding is found in the semnan province 51 4 followed by qom 36 4 and yazd 33 8 this can be explained by the low amount of rainfall in these areas i e deserts with an annual rainfall of less than 200 mm the susceptibility to flooding of a total of 1243 cities was analyzed in this study as shown in fig 8 around 29 and 49 of these cities are located in areas with a high and very high probability of future flood occurrences respectively and only 2 and 6 are located in areas with very low and low hazards respectively fig 8 as fig 9 illustrates the mazandaran province which has the second highest percentage of areas susceptible to flooding has the highest percentage of cities 60 out of 67 cities or 89 6 exposed to high flood hazards followed by golestan 26 out of 31 cities 83 9 charmahal and bakhtiari 24 out of 30 cities 80 lorestan 11 out of 14 cities 78 6 khozestan 47 out of 62 cities 75 8 west azarbayjan 17 out of 24 cities 70 8 hormozgan 17 out of 26 cities 65 4 and kermanshah 18 out of 28 cities 64 3 the kerman province has one of the lowest percentages of cities exposed to high flood hazards 20 8 but it is still not a safe province as 10 out of 48 cities are in serious danger of future flooding overall out of the 1243 cities considered 661 have very high susceptibility to future flooding hazards 331 have high susceptibility 157 have moderate susceptibility and only 68 and 26 have low and very low susceptibility respectively it is startling that most of these cities were initially built in inappropriate locations and have since expanded in the past the most important criterion for settlement location was the proximity to rivers but nowadays because of rapid changes in climate and anthropogenic disturbance as well as poor catchment management proximity to rivers has become one of the greatest threats to human life our findings indicate that iran faces serious future flood hazards and that consequently flood mitigation plans and measures are required immediately these measures can be divided into two main groups structural and nonstructural or a combination of both may be more effective e g structural and biological the most important measures are the generation of flood hazard maps warning systems floodwalls dikes and detention dams the implementation of land use planning strategies afforestation and the planting of appropriate vegetation recent flooding events in iran in 2019 affected 25 of the country s 31 provinces robustly corroborating our findings the severity of damage was so great that several countries including france germany italy india south korea turkey iraq kuwait qatar and pakistan among others sent humanitarian aid to iran although it has been argued that most of this damage resulted from the sudden and severe rainfall https en wikipedia org wiki 2019 iran floods other studies suggest that poor management catchment strategies and deforestation raziei and zand 2019 lack of budget for implementing watershed management plans and poor crisis management are the most important factors in iran s frequent flood occurrences and its damages also yadollahie 2019 declared that integration of aforementioned reasons along with global warming is the main cause of recent flooding heavy rainfall usually occurs during the spring and fall which are more likely to produce high runoff and it is at such times that hydrologists and flood experts should implement plans to control future floods in particular for floods with high return periods flooding may occur in any region thus hydrologists should begin designing and building flood control structures and applying management measures according to higher flood return periods as our results indicate and in agreement with well established theoretical principles on flood production surface water flows from mountain areas tend to concentrate and produce flooding in the flat areas valleys located downstream with lower slope and altitude even simple practical measures can substantially reduce flood hazards and risks to ensure that these measures can be implemented the first step is to identify these flood prone areas the second step is to predict flood depths for different return periods which will allow the delineation of critical areas this combined information will facilitate the implementation of flood measure plans according to the predicted flood depths and topographical characteristics of the relevant area it is important to note that different countries opt for different flood risk management portfolios bubeck et al 2017 a good example of efficient flood control structures is found in one of the villages in golestan province haji abad the residents of this village in anticipation of possible flooding based on warnings from weather organizations built a flood wall around the village using sacks full of local soil which has prevented inundations fig 10 this example shows that flooding can be managed using appropriate measures but control plans are unfortunately not available in all areas prone to flooding another major cause of flooding in iran is the failure to remove alluvial depositional sediments and materials that settle in the beds of rivers in flat areas and cause the accretion of riverbeds inducing flooding for lower discharges hekmatifar et al 2010 a lack of riverbed cleanup and vegetation removal from channels can also increase flooding vegetation cover in the main river channel will increase the flow s roughness and therefore flood depths although the severe 2019 floods in iran corresponded to rainfall events with long return periods and probably could not have been prevented by riverbed soil removal flood control structures and measures could have mitigated the extent of the flooding many cities in iran such as ahvaz and agh ghala fig 11 are located in close proximity to large rivers and therefore even rainfall events with lower return periods produce flooding and entire cities can be quickly inundated as a result of poor watershed management strategies the construction of flood wall control structures and or detention dams and upland catchment management strategies could effectively prevent inundation in those cities a key weakness of flood susceptibility maps is that they lack information regarding flood velocity depth and discharge to implement a comprehensive flood mitigation plan it is important to focus on regions with high and very high susceptibility to future flood occurrences and to identify critical regions from flood inundation maps such as that produced as part of this study decision makers can then follow up with additional studies and field surveys to implement appropriate planning strategies to design effective prevention measures some of the best flood control measures include controlling runoff from upland areas by planting vegetation building check dams and detention dams for return periods of more than 50 years and constructing storage reservoirs in lowland areas and floodwalls in the periphery of urban communities as well as smaller dams and levees as appropriate 5 conclusion flood events are among the most destructive natural hazards and cause irreparable damage worldwide each year because of its topography and climate iran is prone to flooding and has experienced numerous severe flooding events in recent years the first essential step in flood management and the generation of mitigation plans is to delineate flood prone areas clearly in the present study we prepared a flood susceptibility map of iran using a deep cnn algorithm ten flood conditioning factors slope altitude aspect plan curvature profile curvature rainfall geology land use distance from roads and distance from rivers were identified and used in conjunction with data collected from 2769 historical flood locations throughout the country to generate a flood susceptibility map the resulting map was evaluated quantitatively to identify areas with the highest and lowest flood risk and the key factors contributing to this risk our main findings are as follows 1 cnn has good and acceptable accuracy for identifying flood prone areas 2 land use and geology are respectively the most and least effective conditioning factors for flood occurrences in iran 3 around 12 of iran s land is highly susceptible to flooding and 3 is very highly susceptible 4 a total of 29 and 49 of iran s cities are at high and very high risk for future flood hazards respectively 5 of the 1243 cities considered in this study 661 have very high susceptibility to future flooding hazards 331 have high susceptibility 157 have moderate susceptibility and only 68 and 26 have low and very low susceptibility respectively 6 the mazandaran golestan charmahal and bakhtiari lorestan khozestan west azarbayjan hormozgan and kermanshah provinces have the highest percentages of cities exposed to very high future flooding risk 7 although high rainfall is a key factor in flooding poor watershed management as reflected by the effects of land use as the main factor responsible for severe flooding is the leading cause of flooding events in iran findings from the present study will prove useful as a starting point for further research on flood mitigation and can be used by the iran water resources management organization and decision makers to design appropriate watershed management strategies and plans flood control measures in iran are still nascent and should be prioritized to ensure that further flooding events are prevented author contributions kk and mp came up with the idea mp collected data and prepared layers and performed cnn model kk and ag did statistical analysis kk wrote the first drat sdk pms dtb and sl provided critical insights and contributed to the final version of the paper declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by the basic research project of the korea institute of geoscience and mineral resources kigam and project of environmental business big data platform and center construction funded by the ministry of science and ict furthermore the authors would like to thank iran water resources management for providing the datasets appendix 
5103,iran experiences frequent destructive floods with significant socioeconomic consequences quantifying the accurate impacts of such natural hazards however is a complicated task the present study uses a deep learning convolutional neural networks cnn algorithm which is among the newer and most powerful algorithms in big data sets to develop a flood susceptibility map for iran a total of 2769 records were collected from flood locations across the entire country we divided this data set into two groups using a cross validation technique the first group used as a training data set was constructed from 70 of the data set and was used for model building the second group used as a testing data set was constructed from the remaining 30 of the records and used for validation ten flood conditioning factors slope altitude aspect plan curvature profile curvature rainfall geology land use distance from roads and distance from rivers were identified and used in the modeling process the area under the prediction rate curve was used for model evaluation with results showing that the flood susceptibility map has an acceptable accuracy of 75 the results also indicated that approximately 12 and 3 of the country are highly and very highly susceptible to future flooding events respectively moreover 29 and 49 of iran s cities are located in areas with high and very high susceptibility to future flooding hazards the most effective approaches to flood mitigation are preventing urban expansion and new construction in highly to very highly flood prone areas as well as watershed management plans and constructing flood control structures according to the topographical characteristics of the catchment keywords flood control hazard iran deep learning 1 introduction floods are among the most destructive natural hazards in tropical areas that experience high rainfall in particular during monsoon periods and in dry and semi dry regions as flash floods flooding can cause irreparable and immeasurable damage that may be categorized as tangible or intangible tangible damage which includes destruction to buildings agriculture road and transportation systems infrastructure environmental ecosystems humans and property imposes a major negative emotional burden on the society in question khosravi et al 2016a 2016b termeh et al 2018 tiryaki and karaca 2018 floods affect 75 million people on average annually worldwide around 20 000 casualties per year with economic losses of 95 billion chapi et al 2017 khosravi et al 2018b recently the frequency of flooding has increased by more than 40 hirabayashi et al 2013 because climate change has significantly influenced the intensity pattern and magnitude of flooding chapi et al 2017 hens et al 2018 van thanh et al 2017 asian countries in particular are hotspots with relatively high exposure to flooding and earthquakes in asia more than 90 of human losses resulting from natural disasters are attributable to flooding smith 2003 flooding results from the direct impact of both natural and anthropogenic factors chang and chen 2016 iran has recently experienced disastrous floods that in addition to the impact of climate change can be attributed to poor watershed management e g deforestation overgrazing lack of flood control measures khosravi et al 2016a recent flooding events in iran and their record casualties have affected 25 of the country s 31 provinces resulting in more than 77 human casualties and usd 2 2 billion worth of damage to public and private assets https en wikipedia org wiki 2019 iran floods some real photo of the flooding events in a different part of the country is presented in fig 1 furthermore at the time of this writing a vast region in southern and southeastern iran including sistan baluchistan is facing unprecedented floods although flooding hazards are inevitable and largely beyond human control flood risk management practices can mitigate the impact of flooding through hazard prediction and vulnerability reduction identifying areas prone to flooding can inform threatened communities and decision makers at different levels to avoid catastrophes and therefore is key to flood risk management bui et al 2018 choubin et al 2019 kourgialas and karatzas 2011 sarhadi et al 2012 tehrany et al 2013 tien bui et al 2018 flooding a complex phenomenon resulting from watershed management and hydrological meteorological geomorphological and geological conditions is a sophisticated and non linear process and thus cannot be easily predicted with simple linear models pappenberger et al 2006 numerical models such as the hydrologic engineering center s ceiwr hec river analysis system hec ras offer some advantages such as the calculation of discharge in any cross section flow depth or velocity in particular concerning inundation maps two or three dimensional and are appropriate modeling flood challenges however the large amounts of data that they require for modeling and calibration are unavailable in many developing countries these models are also computationally demanding and time consuming in particular in large areas i e generating a large scale flood map such as for an entire country is difficult in general two or three dimensional flood modeling is unviable for areas larger than 1000 km2 in particular when high resolution is required teng et al 2017 several powerful physically based models hydrographs have been developed to predict flood discharge e g swat hec hms although these models are robust well known and developed according to the relevant catchments rainfall runoff processes they still have several shortcomings for generating flood maps and identifying inundation areas sahoo et al 2009 consequently researchers are keen to identify alternative robust and flexible models to remedy these weaknesses recently the use of geographic information systems gis and remote sensing rs has brought new insights to the field of hydrology and multidimensional phenomena in particular flood modeling to address the weaknesses of the models above gis is a useful geostatistical tool that can handle large amounts of data of different scales and from different sources for flood map generation several researchers have integrated various data driven bivariate and multivariate and multi criteria decision making mcdm algorithms with gis and rs for flood susceptibility mapping fsm including frequency ratio khosravi et al 2016a lee et al 2012 tehrany et al 2013 weights of evidence rahmati et al 2016 evidential belief function tien bui et al 2019 shannon entropy haghizadeh et al 2017 analytic hierarchy process ahp chen et al 2011 das 2019 analytic network process anp dano et al 2019 de brito and evers 2016 the decision making trial and evaluation laboratory dematel azareh et al 2019 technique for order preference by similarity to ideal solution topsis khosravi et al 2019 and logistic regression lr youssef et al 2015 although bivariate statistical models have simple structures and are easy to interpret as a result of this simplicity they are not sufficiently accurate for predicting complex phenomena such as flood occurrences furthermore the mcdm technique as a subjectivity model is weakened by its reliance on expert opinion as an essential input which often introduces bias khosravi et al 2018b 2019 thus machine learning algorithms were developed to address these weaknesses these include artificial neural networks ann falah et al 2019 kia et al 2012 support vector machines svm kavzoglu et al 2014 random forests chapi et al 2017 logistic model trees pham et al 2018 naïve bayes trees khosravi et al 2019 and multivariate adaptive regression splines mars dodangeh et al 2020 each of these algorithms has several drawbacks the use of svm has declined as a result of the numerous parameters in its structure for each of which optimum values must be determined and the need to determine the most effective kernel functions in its structure although the decision tree dt algorithm offers reasonable precision in fsm tehrany et al 2013 it has some problems for defining rules for performance in dt multiple output attributes are not allowed and trees are sensitive to noisy data tien bui et al 2012 another weakness of dt is that this model may produce a large tree structure which makes interpretation difficult and misclassification of data may occur during the machine learning process tehrany et al 2013 ann the most widely used algorithm also suffers from several drawbacks that result in its poor prediction capacity therefore ann was integrated with fuzzy logic and the adaptive neuro fuzzy inference system anfis was developed although the anfis is a powerful model it struggles to accurately determine the weights of membership functions in fuzzy rules some researchers have integrated different optimization algorithms with the anfis model to address this weakness with respect to different aspects of hydrology such as fsm bui et al 2018 2016 khosravi et al 2018a tien bui et al 2018 wang et al 2019 groundwater potential mapping chen et al 2019 khosravi et al 2018a termeh et al 2018 and landslide susceptibility mapping chen et al 2017 but this successive integration of the anfis model with optimization algorithms is complex and has decreased its use deep learning algorithms have recently gained superiority over traditional machine learning models by virtue of their greater flexibility and predictive accuracy in particular for big data and incremental approaches have been used to learn high level components from the data sets used ghorbanzadeh et al 2019 deep learning algorithms outperform all other traditional machine learning algorithms when a data set is particularly large and the problem under investigation has a complex process panahi et al 2020 a convolutional neural network cnn an automatic tool is the most popular deep learning algorithm which is proper for spatial data like present study this algorithm sets the features as input and can be described as a tensor with which local components are inter correlated convolutional layer in cnn algorithm can simultaneously learn the connection between features and this would result to achieve higher performance also cnn use minimal amount of preprocessing in this paper we propose a framework with a robust deep learning algorithm that helps to generate flood susceptibility maps this framework was used to generate maps for iran and draw conclusions regarding the spatial distribution of susceptibility and its potential drivers 1 1 study area iran is a middle eastern country with a population of 82 million and an area of 1 648 195 km2 iran lies between longitude 44 and 63 5 30 e and latitude 25 and 40 n it is bordered by iraq and turkey to the west and by armenia azerbaijan the caspian sea and turkmenistan to the north afghanistan and pakistan border iran to the east with the persian gulf and the oman sea to the south fig 2 almost 50 of iran consists of mountains fertile plains account for 25 and the remaining 25 is desert dehnavi et al 2015 the slope angle ranges from 0 to 76 28 and the altitude ranges from 500 to 5597 m above sea level the country s two main mountains are zagros in the west and alborz in the north iran s climate is unique by virtue of the difference between the warmest and coldest temperatures in winter which can sometimes be more than 50 c iran is located in an arid semi arid region with annual average precipitation close to 200 mm and significant spatial variability from 15 mm year in the central deserts up to 2000 mm year in the north the spatial variability in precipitation and temperature has a significant impact on the vegetation cover in terms of its geomorphological characteristics iran is divided into the different regions of caspian zagros the central plateau and southern coastal plains ghorbani 2013 political boundaries divide it into 31 provinces and 1243 large cities 339 of which have populations 20 000 2 methodology a diagram of the conceptual modeling methodology adopted in the current study is presented in fig 3 2 1 flood inventory mapping the first step in the flood modeling and mapping process is to compile historical flood data and to determine flood conditioning factors as well as the spatial relationships between these factors and flooded locations to understand the dynamics of flooding in the area of interest a total of 2769 historical flood records collected by iran s water resources management company iwrmc were used for modeling these locations were ultimately converted into several points and then precisely located in polygonal format 2 2 preparation and selection of flood conditioning factors in the first stage of modeling ten flood conditioning factors were considered based on the literature khosravi et al 2016b tehrany et al 2015 wang et al 2019 catchment characteristics and data availability these factors were slope altitude aspect plan curvature profile curvature rainfall geology land use distance from roads and distance from rivers bui et al 2018 2016 khosravi et al 2016a 2018b 2016b 2019 tehrany et al 2013 tien bui et al 2018 2019 we implemented a widely used approach the information gain ratio igr technique to distinguish between variables with a significant impact on the accuracy of estimation and noise creating variables with negative effects on the outcome table 2 slope altitude aspect plan curvature and profile curvature were constructed from topographic maps obtained from the national cartographic center of iran ncc with a spatial resolution of 30 30 m distance from rivers and road were computed with data from iranian rivers and roads a shapefile provided by iwrmc and using the multiple ring buffer tool in arcgis 10 2 the geological map of iran was acquired from geological survey mineral explorations of iran gsi the rainfall map used in this study was constructed by iran s meteorological organization imo using long term rainfall data 30 years of mean annual rainfall landuse map was obtained as a shapefile from the iranian agriculturalscientific ministry table 1 all the input maps and their classes are presented in fig a1 in the appendix 2 3 building of the training and testing data sets the final step in fsm by artificial intelligence algorithms involves binary classification with two classes of flood and non flood locations consequently arcgis10 2 was used to identify 2769 non flood locations in places such as areas which are never inundated during flood events one of the most obvious examples is hilly or mountainous areas all non flood locations presented in fig b1 in the appendix flood and non flood locations were assigned values of 1 and 0 respectively and were overlaid with the 10 flood conditioning factors finally the required information i e flood position located in which class of each flood conditioning factor was extracted and converted into an excel file all information extracted with respect to flood and non flood locations was divided into two groups by a cross validation technique at a ratio of 70 30 the most commonly used ratio in spatial modeling of natural hazards tehrany et al 2014 2015 the first portion was used for training the training data set and was constructed from 70 of flood and non flood locations for model building and the second portion the testing data set was used for model validation and was constructed from the remaining 30 of flood and non flood locations chung and fabbri 2003 3 model description 3 1 convolutional neural networks cnn to overcome the challenge of decreased speed in the learning process faced by traditional artificial neural networks ann in analyzing complex networks lu et al 2017 bengio proposed the convolutional neural network cnn which is a neural network that carries out local connections among layers lecun et al 1998 lu et al 2017 cnn has different neuronal layers the first layer extracts features from an input image as well as retains connections between pixels by understanding image features that use small squares of input data this layer is called the convolution layer the convolution layer is a mathematical operation base and requires two inputs an image matrix and a filter or kernel to be run the second layer is the activation layer which usually appears after the convolutional layer if it is non linear however a rectified linear unit relu function is the most effective and typical activation function and is always zeros and ones the third layer or the pooling layer preserves the most critical information while reducing the number of parameters in particular when images are very large spatial pooling has different types such as max average sum and so forth the last layer is the actual component and performs discriminative learning in a deep neural network this fully connected layer is a simple and multilayer perceptron that can learn weights and identify object classes based on the type of data images and goals scientists have proposed different structures for their research including zfnet vggnet googlenet resnet lenet 5 and alexnet fang et al 2019 geoscience researchers have achieved and reported notable results using cnn 2d and thus this structure was used in this study wang et al 2019 moreover because cnn input data must take the form of images and the input data are one dimensional the primary data must be converted into images to initialize fsm a one dimensional input grid cell that consists of different attribute features must be converted into a two dimensional matrix because none of the data are classified and are constant the images created are very large the network used has a convolutional layer with 100 filters at the beginning and in most cases these layers are used for those data that have more correlation with adjacent features inherently these kinds of cases are applied for the data like image however it is not useful for the features used in this article in order for the network to be able to learn the correlation between features simultaneously during the learning process the filter size considered should be 10 1 this enables the filter to consider all features and their correlations to extract the correlation features this layer uses the activation function relu the next layer used is the normalization layer that accelerates the learning process in the following a dropout layer with 50 rate is used this layer transforms 50 of the output from pre layer to 0 values in each learning iteration so that the next layer does not overfit learning inputs and enable the learning of different aspects of the data the next layer is the average pooling layer with filter size 3 1 that reduces its dimension by a half this layer dramatically reduces the weight of the network and highly decreases its computational load during the learning process the following layer is fully connected it has five neurons and its activation function is a relu like convolutional layer finally the last layers are also fully connected with one neuron and one regression layer that produces the final output the cnn structure and its parameters are presented in fig 4 and table 2 there are several different approaches developed to avoid over fitting srivastava et al 2014 the first method is to use a set of data validation 10 of train data to check the method s accuracy after training which not only adjusts network parameters but also helps to avoid over fitting by comparing the network accuracy of data and training data the second approach is applying a dropout layer after each convolutional layer which deletes 50 of its input layers after every iteration in order for the network to learn all aspects of the given dataset as well as to avoid over fitting the other approach is to use a relatively small network which would help the network not to be over fitted tables 3 and 4 show the network s accuracy for training and testing data both with and without using a dropout layer as can be seen when the dropout layer is not used network accuracy over fitting of training data is improved however for testing data the difference between using and not using the dropout layer is quite clear and it is clear that not using the dropout layer decrease the network accuracy of testing data which means this approach is efficient the final approach to avoid over fitting is by applying l2 regularization in this method las function is being added to the second norm of network weight this would reduce network overfitting additionally the second norm coefficient of weights weight decay was considered 0 0001 fig 5 shows the convergence plot of the models 3 2 flood map generation validation and hazard assessment in the present study a newly developed artificial intelligence deep cnn algorithm was used to delineate flood prone areas as a first step the cnn algorithm was trained model learning using a training data set i e the training data set in excel format used for model building next the country of iran was converted into a raster format the model developed was used to predict a flood susceptibility probability index for each pixel in the study area i e in this stage the entire country was used as a test data set for the built model finally these indices were divided into different classes of very low low moderate high and very high susceptibility to flooding different methods may be used for this classification but as our predicted indices were skewed the quantile method was used khosravi et al 2019 the final step was to evaluate the resulting map therefore the testing data set was applied in terms of prediction rate curves so that the area under the curve auc identified the model prediction capability quantitatively khosravi et al 2016a 2016b finally by overlaying the flood susceptibility map on the locations of cities in iran we identified the number of cities in each class and used them for further analyses 4 results and discussion the flooding prediction map was evaluated with the testing data set the results from this phase show a reasonable and good fit determined by an area under the prediction rate curve auc of 0 75 this means that the map s accuracy is around 75 khosravi et al 2019 which is reliable and acceptable in particular given the large size of the study area based on the classification efficiency proposed by hosmer and lemeshow 2000 model performance can be classified into different accuracy classes including 0 5 0 6 0 6 0 7 0 7 0 8 0 8 0 9 and 0 9 1 which correspond to poor average good very good and excellent performance respectively yesilnacar 2005 given its good accuracy this map was used for further analyses the results of the information gain ratio method shown in table 5 indicate that the land use factor has the greatest impact on iran s flood occurrences 0 60 followed by aspect 0 40 altitude 0 37 plan curvature 0 35 distance from rivers 0 33 rainfall 0 30 slope 0 29 distance from roads 0 278 and geology 0 08 this demonstrates that all thematic layers considered significantly influence flooding by identifying the impact of each factor on flood occurrences one can more effectively implement flood control plans and measures visual inspection of the effective flood conditioning factors i e slope curvature rainfall and altitude maps fig a1 and the flood susceptibility map fig 6 clearly reveals that most flood prone areas are located in regions where mountain ranges are in close proximity to flat areas provided these areas have sufficient rainfall this observation is consistent with the nature of the mechanisms that promote flooding it is worth mentioning that although these areas are exposed to high flood hazards they tend to be densely populated because of their fertile soils good weather conditions and surface water supply among other factors land use is the factor that most influences flood occurrences because most of iran s land is covered by bare soil that is completely compacted because of overgrazing and therefore is very effective at generating runoff land use effectiveness especially plant s role in runoff generation is described by hou et al 2020 although flooding is linked to rainfall rainfall is not the main factor predicting flood susceptibility in iran as it is very high in mountainous areas where flooding does not occur our results are in good agreement with those of khosravi et al 2016a analyses of the flood susceptibility map fig 6 indicate that 3 and 12 of the entire country have very high and high susceptibility to future flood occurrences respectively corresponding to total areas of 44 943 and 191 107 km2 these areas are distributed in northern and western iran fig 6 the guilan province has the country s highest percentage of high and very high flood prone areas 19 8 followed by mazandaran 17 6 golestan 10 1 alborz 10 2 and khozestan 9 3 whereas the yazd province has the lowest percentage 0 2 fig 7 by contrast the highest percentage of areas with very low susceptibility to flooding is found in the semnan province 51 4 followed by qom 36 4 and yazd 33 8 this can be explained by the low amount of rainfall in these areas i e deserts with an annual rainfall of less than 200 mm the susceptibility to flooding of a total of 1243 cities was analyzed in this study as shown in fig 8 around 29 and 49 of these cities are located in areas with a high and very high probability of future flood occurrences respectively and only 2 and 6 are located in areas with very low and low hazards respectively fig 8 as fig 9 illustrates the mazandaran province which has the second highest percentage of areas susceptible to flooding has the highest percentage of cities 60 out of 67 cities or 89 6 exposed to high flood hazards followed by golestan 26 out of 31 cities 83 9 charmahal and bakhtiari 24 out of 30 cities 80 lorestan 11 out of 14 cities 78 6 khozestan 47 out of 62 cities 75 8 west azarbayjan 17 out of 24 cities 70 8 hormozgan 17 out of 26 cities 65 4 and kermanshah 18 out of 28 cities 64 3 the kerman province has one of the lowest percentages of cities exposed to high flood hazards 20 8 but it is still not a safe province as 10 out of 48 cities are in serious danger of future flooding overall out of the 1243 cities considered 661 have very high susceptibility to future flooding hazards 331 have high susceptibility 157 have moderate susceptibility and only 68 and 26 have low and very low susceptibility respectively it is startling that most of these cities were initially built in inappropriate locations and have since expanded in the past the most important criterion for settlement location was the proximity to rivers but nowadays because of rapid changes in climate and anthropogenic disturbance as well as poor catchment management proximity to rivers has become one of the greatest threats to human life our findings indicate that iran faces serious future flood hazards and that consequently flood mitigation plans and measures are required immediately these measures can be divided into two main groups structural and nonstructural or a combination of both may be more effective e g structural and biological the most important measures are the generation of flood hazard maps warning systems floodwalls dikes and detention dams the implementation of land use planning strategies afforestation and the planting of appropriate vegetation recent flooding events in iran in 2019 affected 25 of the country s 31 provinces robustly corroborating our findings the severity of damage was so great that several countries including france germany italy india south korea turkey iraq kuwait qatar and pakistan among others sent humanitarian aid to iran although it has been argued that most of this damage resulted from the sudden and severe rainfall https en wikipedia org wiki 2019 iran floods other studies suggest that poor management catchment strategies and deforestation raziei and zand 2019 lack of budget for implementing watershed management plans and poor crisis management are the most important factors in iran s frequent flood occurrences and its damages also yadollahie 2019 declared that integration of aforementioned reasons along with global warming is the main cause of recent flooding heavy rainfall usually occurs during the spring and fall which are more likely to produce high runoff and it is at such times that hydrologists and flood experts should implement plans to control future floods in particular for floods with high return periods flooding may occur in any region thus hydrologists should begin designing and building flood control structures and applying management measures according to higher flood return periods as our results indicate and in agreement with well established theoretical principles on flood production surface water flows from mountain areas tend to concentrate and produce flooding in the flat areas valleys located downstream with lower slope and altitude even simple practical measures can substantially reduce flood hazards and risks to ensure that these measures can be implemented the first step is to identify these flood prone areas the second step is to predict flood depths for different return periods which will allow the delineation of critical areas this combined information will facilitate the implementation of flood measure plans according to the predicted flood depths and topographical characteristics of the relevant area it is important to note that different countries opt for different flood risk management portfolios bubeck et al 2017 a good example of efficient flood control structures is found in one of the villages in golestan province haji abad the residents of this village in anticipation of possible flooding based on warnings from weather organizations built a flood wall around the village using sacks full of local soil which has prevented inundations fig 10 this example shows that flooding can be managed using appropriate measures but control plans are unfortunately not available in all areas prone to flooding another major cause of flooding in iran is the failure to remove alluvial depositional sediments and materials that settle in the beds of rivers in flat areas and cause the accretion of riverbeds inducing flooding for lower discharges hekmatifar et al 2010 a lack of riverbed cleanup and vegetation removal from channels can also increase flooding vegetation cover in the main river channel will increase the flow s roughness and therefore flood depths although the severe 2019 floods in iran corresponded to rainfall events with long return periods and probably could not have been prevented by riverbed soil removal flood control structures and measures could have mitigated the extent of the flooding many cities in iran such as ahvaz and agh ghala fig 11 are located in close proximity to large rivers and therefore even rainfall events with lower return periods produce flooding and entire cities can be quickly inundated as a result of poor watershed management strategies the construction of flood wall control structures and or detention dams and upland catchment management strategies could effectively prevent inundation in those cities a key weakness of flood susceptibility maps is that they lack information regarding flood velocity depth and discharge to implement a comprehensive flood mitigation plan it is important to focus on regions with high and very high susceptibility to future flood occurrences and to identify critical regions from flood inundation maps such as that produced as part of this study decision makers can then follow up with additional studies and field surveys to implement appropriate planning strategies to design effective prevention measures some of the best flood control measures include controlling runoff from upland areas by planting vegetation building check dams and detention dams for return periods of more than 50 years and constructing storage reservoirs in lowland areas and floodwalls in the periphery of urban communities as well as smaller dams and levees as appropriate 5 conclusion flood events are among the most destructive natural hazards and cause irreparable damage worldwide each year because of its topography and climate iran is prone to flooding and has experienced numerous severe flooding events in recent years the first essential step in flood management and the generation of mitigation plans is to delineate flood prone areas clearly in the present study we prepared a flood susceptibility map of iran using a deep cnn algorithm ten flood conditioning factors slope altitude aspect plan curvature profile curvature rainfall geology land use distance from roads and distance from rivers were identified and used in conjunction with data collected from 2769 historical flood locations throughout the country to generate a flood susceptibility map the resulting map was evaluated quantitatively to identify areas with the highest and lowest flood risk and the key factors contributing to this risk our main findings are as follows 1 cnn has good and acceptable accuracy for identifying flood prone areas 2 land use and geology are respectively the most and least effective conditioning factors for flood occurrences in iran 3 around 12 of iran s land is highly susceptible to flooding and 3 is very highly susceptible 4 a total of 29 and 49 of iran s cities are at high and very high risk for future flood hazards respectively 5 of the 1243 cities considered in this study 661 have very high susceptibility to future flooding hazards 331 have high susceptibility 157 have moderate susceptibility and only 68 and 26 have low and very low susceptibility respectively 6 the mazandaran golestan charmahal and bakhtiari lorestan khozestan west azarbayjan hormozgan and kermanshah provinces have the highest percentages of cities exposed to very high future flooding risk 7 although high rainfall is a key factor in flooding poor watershed management as reflected by the effects of land use as the main factor responsible for severe flooding is the leading cause of flooding events in iran findings from the present study will prove useful as a starting point for further research on flood mitigation and can be used by the iran water resources management organization and decision makers to design appropriate watershed management strategies and plans flood control measures in iran are still nascent and should be prioritized to ensure that further flooding events are prevented author contributions kk and mp came up with the idea mp collected data and prepared layers and performed cnn model kk and ag did statistical analysis kk wrote the first drat sdk pms dtb and sl provided critical insights and contributed to the final version of the paper declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by the basic research project of the korea institute of geoscience and mineral resources kigam and project of environmental business big data platform and center construction funded by the ministry of science and ict furthermore the authors would like to thank iran water resources management for providing the datasets appendix 
5104,acid mine drainage amd poses significant ecological environmental and geological challenges worldwide especially in more vulnerable karst areas however the impact of amd on percolation features and pore structure of carbonate strata is poorly understood despite its importance for the evolution of carbonate aquifer as well as karst groundwater quality to fill this knowledge gap field investigations core flooding experiments reactive transport modeling and pore structure studies mercury intrusion porosimetry mip and nitrogen physisorption analysis were conducted to understand the geochemical processes and associated pore development in carbonate strata exposed to fe rich amd our field investigation shows that the amd is characterized by low ph values 2 4 3 8 high contents of sulfate 1457 4217 mg l fe 100 830 mg l fe3 fe2 and heavy metals that can potentially leak into carbonate strata the major findings of this study include 1 core flooding experiments reveal that the interaction of carbonate rock with amd causes a rapid elevation of solution ph and simultaneous precipitation of fe3 fe2 as iron oxy hydroxides or oxy hydroxy sulfates within the rock 2 the results of reactive transport modeling suggest that ferrous iron has a longer transport distance than ferric iron in the carbonate core plug and then it precipitates to fill the pore space and 3 despite the precipitation the flooding of amd increases the overall permeability of cores by creating large numbers of pores with throat diameter between 0 001 and 10 μm we also found that the interaction of amd with the carbonate rock might stimulate the formation of preferential flow channel s our results have been incorporated into a conceptual model built to illustrate the geochemical processes and mechanisms involved our research has important applications in amd treatment for coal mining industries and for local governments devising strategies for karst water resource protection and management keywords acid mine drainage carbonate rocks percolation pore structure geochemistry modelling 1 introduction natural groundwater host rock interaction is a slow and long term geochemical process that contributes to both the evolution of pore structure of the host rock and the groundwater quality in karst system pore structure formation is the result of years to thousands of years of carbonate dissolution which can ultimately result in large conduits or caves and the groundwater becomes more mineralized dar et al 2014 under the influence of anthropogenic activities the acidic fluids released including acid mine drainage amd co2 saturated fluids and acidic fracturing fluids can infiltrate into carbonate aquifers and accelerate the water rock interaction jiang et al 2020 resulting in the alteration of the hydraulic connection between adjacent aquifers and the deterioration of groundwater quality numerous studies have confirmed the changes in rock properties including permeability porosity and specific surface area caused by acidic fluids but the nature of the changes observed is very case dependent hao et al 2013 kharaka et al 2010 kwak et al 2018 pan et al 2016 viswanathan et al 2012 noiriel et al 2009 reported that injection of co2 rich water generally increases the reactive surface area and porosity of carbonate rocks and greater pore connectivity results in enhanced dissolution in the case of coarse calcite infiltrated by dilute hcl acidification only triggers dissolution in pores with throat diameters over 22 μm accompanied by little increase in permeability despite the obvious increasing porosity rötting et al 2015 since dissolution is not uniform preferential flow channels can be generated in the rock in a core flooding experiment by fredd and fogler 1998 the permeability of limestone cores increased rapidly as the reactive fluid flowed through due to the formation of preferential flow channels which reduced the resistance to fluid flow the intertwined feedback mechanisms often obscure the relationship between rock properties and fluid features thaysen et al 2017a 2017b kweon and deo 2017 luhmann et al 2014 noiriel et al 2009 poonoosamy et al 2015 soler 2016 for example the changes in rock properties caused by acidification have impacts on the local fluid velocity and flow capacity in return fluid velocity and flow capacity affect the rates of mineral dissolution published works have mainly focused on a simplified water rock interaction system whereby rocks are percolated by acid solution with acid as the only solute such as co2 saturated water or dilute hydrochloric acid smith et al 2017 berrezueta et al 2015 luquot and gouze 2009 luquot et al 2012 steefel et al 2005 xiong et al 2016 yu et al 2012 natural or anthropogenic acidic fluids e g amd containing additional chemical constituents may complicate the water rock interaction even further mineral dissolution caused by acidification expands the pore volume of the host rock while precipitation resulting from the over saturation of chemical constituents fills up the pore space these two processes have opposite impacts on the evolution of pore structure and this is the focus of this study over the last few decades an increase in coal mining activities has produced considerable amounts of amd especially in developing countries where coal mining provides the largest part of the energy supply the co occurrence of coal and karst water resources is common in china the niangziguan karst spring catchment area is a typical example with many springs and large reserves of coal fig 1 gao et al 2010 2016 zhang et al 2016b the occurrence of amd is generally the result of sulfide mineral oxidation in the air exposed coal strata this acid effluent is characterized by high concentrations of sulfate iron fe3 or fe2 and other trace elements the discharge of amd from abandoned coal mines is of increasing concern and a growing number of outflow sites have been found in recent years in the niangziguan area lian and hu 2017 wang et al 1997 wu et al 2014 the situation has become worse since 2013 when certain chemical constituents sulfate total hardness and total dissolved solids of the niangziguan spring showed a striking increase liang et al 2018 zhao et al 2019 the direct leakage of amd from abandoned coal mines has been underestimated as a severe long term environmental problem liang et al 2018 continuously discharged amd via leakage in the exposed carbonate areas or directly recharged into karst aquifers underground significantly modifies the pore structure and size distribution in carbonates and thus affects the flow in karst aquifers additionally interaction of amd with carbonate rock results in a series of geochemical processes which may in turn impact the evolution of karst water quality however the interaction between amd and carbonate rock and its resulting impact on karst aquifer properties are poorly understood coetzee et al 2013 kwak et al 2018 labastida et al 2019 sakala et al 2020 smith et al 2017 to fill this knowledge gap field investigations core flooding experiments reactive transport modeling and pore structures studies were conducted to elucidate the geochemical processes and pore development in carbonate strata receiving fe rich amd specifically the objectives of this study were to 1 evaluate the chemical evolution of the amd solution and the change in rock properties porosity permeability pore throat size distribution psd and tortuosity in a core flooding experiment and 2 describe the different transport patterns between fe3 rich amd and fe2 rich amd in the carbonate cores a better understanding of the amd fluid carbonate rock interactions and consequences can help with the development of local strategies for karst water resources management 2 materials and methods 2 1 field investigations field investigations were carried out four times from june 2017 to october 2019 in a suburb of yangquan city fig 1b the study area is located in the northwest of yangquan city where permo carboniferous strata cover most of the area fig 1d the ordovician carbonate strata crop out to the northeast and east of the catchment area zhang et al 2016b the karst groundwater is recharged in the high mountain areas and flows eastwards to niangziguan springs the coal seams are found primarily in the carboniferous taiyuan formation and permian shanxi formation of which the total thickness is in the range of 13 15 m with a burial depth from 150 to 500 m hu et al 2015 the 8 9 12 and 15 coal seams are actively mined such that underground goafs are spread throughout the whole study area and many of them are filled with water amd as long as the underground goafs are filled by the mine water outflow discharging takes place the amd discharge can infiltrate into the carbonate strata under natural conditions or due to anthropogenic activity the fluid can leak into carbonate aquifers via faults or fractures fig 1c as the over exploitation of karst water has led to a remarkable decline in the water table in addition amd flows along the regions with carbonate strata outcrop it can vertically infiltrate into the karst aquifer fig 1c there are three amd outflow discharge locations symbol 1 and two pits with amd symbol 8 in the study area as shown in fig 1d the amd outflow discharges directly into the local river depending on the natural hydrogeological conditions fig 1e and 1f the amd samples were collected from amd monitoring holes symbol 2 and outflow discharge locations symbol 1 fig 1d a hanna portable ph meter with probes for temperature ph electric conductivity ec dissolved oxygen do and total dissolved solids tds was used for field measurements six karst well water samples symbol 3 fig 1d were also collected to investigate the influence of amd on the groundwater system all amd and karst well water samples were filtered and separated into two bottles one for anion measurements and one with additional hno3 for cation and trace element measurements 2 2 carbonate rock samples the carbonate core was sampled from the ordovician strata in a drilling borehole in the study area symbol 9 fig 1d three cylindrical plugs were taken using a diamond drilling device from the same segment of the core labeled cnzg 0 cnzg iii and cnzg ii plug size 2 5 cm in diameter by 7 64 cm in height all three plugs were dried in an oven at 60 c for 48 h the cnzg 0 plug was used to test for the basic initial physico chemical properties the cnzg iii and cnzg ii plugs were used for the core flooding experiment with amd amdsyn iii the synthetic fe3 rich amd amdsyn ii the synthetic fe2 rich amd the data acquired for the cnzg 0 plug were assumed to be representative of the initial properties of the cnzg iii and cnzg ii plugs used in the experiments all data reported for cnzg iii and cnzg ii are for the plugs after the core flooding experiment core plugs were cut into 1 cm3 cubes for mip analyses thin slices were cut for sem eds analysis the remaining fragments were grounded into granules for xrd analyses sizes of less than 75 μm through 200 mesh sieve and nitrogen physisorption particle size 500 851 μm 20 and 35 mesh 2 3 core flooding experiment the custom designed experimental apparatus for studying water rock interaction via the core flooding experiment is shown in fig 2 a rubber sleeve wrapped core plug cnzg iii or cnzg ii was placed in the aluminum core holder around which a constant confining pressure of 10 mpa was supplied by injection of water with a syringe pump to avoid peripheral flow the amd amdsyn iii or amdsyn ii stored in a nitrogen purged tank was pumped through the core plug at a constant flow rate q of 0 02 ml min for 20 days the ph of in and out flow solutions was measured by ph probes during the experiment the outlet solution 28 8 ml was collected every day and stored in refrigerator at 4 c for further chemical analyses the synthetic amds amdsyn iii and amdsyn ii used in the core flooding experiments were prepared using analytical grade na2so4 cacl2 mgso4 7h2o zncl2 cdcl2 cucl2 mncl2 4h2o fecl3 6h2o and fecl2 4h2o dissolved in deoxygenated milli q water resistivity 18 2 mω cm the ph of the synthetic amds was adjusted to within the range 2 4 3 8 as found for amd in the field investigation with dilute h2so4 and naoh the initial concentrations of each constituent amdsyn iii and amdsyn ii are shown in table 1 2 4 methodology 2 4 1 chemical analyses of aqueous samples the measurement of total alkalinity for each liquid sample was conducted on the day after sampling both in the field and lab based on the gran titration method analysis error 2 ion chromatography ic dionex 120 dionex sunnyvale ca usa was used for testing the anions in which cl and so4 2 were the two main ions in this study the cations including major k na ca and mg and trace fe cu zn cd mn elements were determined by inductively coupled plasma atomic emission spectrometry icp aes iris intrepid xsp thermo elemental madison wi usa the charge balance error was used for evaluating the ion analytical precision within the standard limit of 5 2 4 2 mineralogy from xrd and sem xrd patterns were recorded using an x pert pro dy2198 diffractometer equipped with a cu kα radiation source at working power of 40 kv and 30 ma the diffraction patterns were scanned at a rate of 2 min 0 02 increments over an interval of 5 to 70 two theta to characterize the powdered rock samples the identification of mineralogy and specific locations 2θ of reflections was completed with the aid of high score software the flooding of fe rich amd may result in the formation of fe containing precipitates within the pore space of carbonate cores thus each core after experiment was cut into several thin slices with thickness of 2 mm since the cross sections of the slices were polished chemical analysis only was conducted by a quanta 200 scanning electron microscope with x ray energy dispersive spectroscopy sem eds these slices were carbon coated with quorum sc7620 sputter coater for further observation the equipment was operated at 20 kv and samples were observed at a proper working distance low operating voltage 7 kv was used to ensure better image quality and semi quantitative eds analyses were performed at 15 kv 2 4 3 determination of pore structure 2 4 3 1 mercury intrusion porosimetry mip the psd porosity permeability and tortuosity are critical rock properties and these were determined by mip with a mercury porosimeter autopore iv 9510 micromeritics norcross ga usa gao and hu 2013 labani et al 2013 zhang et al 2016a during the test the samples were evacuated and then invaded by enclosed mercury with a step wise increase in pressure from 0 034 to 413 mpa corresponding to 3 nm 50 μm in pore throat diameters each pressure step was equilibrated for 50 s the diameter of pores at each pressure step was calculated based on the washburn equation washburn 1921 as follows 1 δ p 2 γ cos θ r where p is the pressure difference γ is a constant equivalent to 485 dynes cm reflecting the surface tension of mercury θ is the contact angle considered to be 130 in this study between mercury and carbonate and r is the corresponding pore throat radius the permeability from mip data was obtained based on the method of katz and thompson 1986 2 k 1 89 l max 3 l c ø s l max where k is the permeability m2 l max μm and lc μm are the pore throat diameters correlated to maximum hydraulic conductance and the threshold pressure pt psia respectively φ is porosity and s l max represents the proportion of connected pore space with pore throat diameter over l max 2 4 3 2 nitrogen physisorption pore size is classified into micropores 2 nm mesopores 2 50 nm and macropores 50 nm according to the international union of pure and applied chemistry iupac mip is capable of characterizing the psd in the range of 3 nm to 50 μm while n2 physisorption can describe psd for pores less than 3 nm hinai et al 2014 the n2 physisorption isotherms were conducted using a micromeritics tristar ii 3020 instrument at a working temperature of 77 k the program quantachrome quadrawin was used for data processing from which the bet brunauer emmett and teller specific surface area brunauer et al 1938 and bjh barret joyner and halenda psd within the detection limits groen et al 2003 can be obtained the saturation pressure p0 of n2 was measured at intervals of 120 min and the relative pressures were quantified by p p0 where p is the partial pressure of the system labani et al 2013 fig s1 in supporting information shows the possible types of n2 physisorption isotherms and hysteresis loops based on the iupac classification 3 results and discussion 3 1 hydrogeochemistry of amd in the field numerous coal mines are situated in the catchment area fig 1b the study area has a severe environmental issue caused by the coal mining that has led to widespread development of underground goafs across the mining areas liu 2018 the amd overflows from the goafs and further flows into the local rivers of which the leakage area in the riverbed facilitate the recharge of amd contaminated river water into karst system the field investigation showed that the average discharge flow rate of amd at outlet sites is 5075 m3 d with a range between 3000 and 11000 m3 d the ph of amd ranges from 2 4 to 3 8 and some chemical constituents such as so4 2 1457 4217 mg l total hardness 470 2460 mg l and fe 100 830 mg l far exceed the national standard for drinking water quality in china maximum concentrations so4 2 250 mg l total hardness 450 mg l and fe 0 3 mg l ferric and ferrous ions are common constituents in amd and their oxidation state is determined by oxygen level in general amd is also rich in heavy metals such as zn cd cu and mn exposure of sulfides e g pyrite sphalerite and chalcopyrite to air leads to elevated acidity as sulphuric acid iron and heavy metal contents with the following reactions involved 3 2fes2 7o2 2h2o 2feso4 2h2so4 4 feso4 2h2o fe oh 2 h2so4 5 4fe oh 2 o2 2h2o 4fe oh 3 s 6 zns 2o2 2h2o zn oh 2 s 2h so4 2 7 4cufes2 17o2 18h2o 4cu oh 2 s 4fe oh 3 s 8so4 2 16h the discharge of amd can cause serious degradation in the quality of both surface and groundwater torres et al 2016 lefticariu et al 2016 nieva et al 2016 macías et al 2017 jones and cetin 2017 for instance 31 of 36 karst wells have undrinkable groundwater in the study area especially those near the amd outlet sites the karst well located downstream of the study area has been abandoned by the local residents because of the deterioration in water quality 3 2 properties of the carbonate rock before core flooding experiment xrd results show that the core samples cnzg 0 cnzg iii and cnzg ii are dominated by dolomite with minor content of calcite and quartz fig s2 mip results show a porosity of 2 08 and permeability of 4 13 10 16 m2 table 2 for cnzg 0 representing the properties before core flooding experiment the psd from mip for the core sample cnzg 0 is shown in fig s3 in order to describe the connected pore networks a threshold pressure was defined as the intrusion pressure of mercury capable of passing through the whole sample in fig s3a the inflection point represents the threshold pressure hu et al 2017 there are three inflection points for different pore networks at 0 207 mpa point ① corresponding to a pore throat diameter of 6 14 μm 0 539 mpa point ② corresponding to 2 34 μm and 2 47 mpa point ③ corresponding to 0 512 μm respectively the pore network at the highest threshold pressure point ③ has a pore throat diameter coincidently located within the range 0 1 1 μm in the distribution of pore throat diameters of the core sample fig s3a which accounts for the majority 80 4 of pore volume while the other two lower threshold pressures point ① and ② at 6 14 and 2 34 μm only account for 16 8 of the total pore volume the remaining 2 8 is occupied by pore throats with diameters in the range 10 50 μm no pores with throat diameters less than 0 1 μm are detected 3 3 effluent water geochemistry from the core flooding experiment 3 3 1 dissolution of carbonates and removal of metals the synthetic amd characterized by low ph is highly reactive with carbonate rock and the flooding of amd in the experiment lead to a rapid neutralization of amd which ended with weakly alkaline ph 8 0 fig 3 and mineral dissolution from the core plug elevated concentrations of mg2 and ca2 were observed 73 4 89 9 mg l for mg2 and 238 252 mg l for ca2 in the cnzg iii amdsyn iii experiment while values of 136 175 mg l for mg2 and 490 640 mg l for ca2 were seen in the cnzg ii amdsyn ii experiment compared to the initial value of 60 0 and 200 mg l respectively fig 3a the increases in ca2 mg2 and ph are clearly related to the dissolution of dolomite caxmg 1 x co3 2 x 1 in the core as described by eq 8 the ferric and ferrous ion concentrations decreased rapidly from the initial 130 mg l to less than 0 5 mg l after percolation through the core plugs except for a rebound after 13 days in the cnzg ii amdsyn ii experiment fig 3b as ferrous ferric ion is readily hydrolyzed and precipitated as iron oxy hydroxides or oxy hydroxy sulfates with increasing ph eq 9 11 the nearly complete exhaustion of iron after core flooding was expected in fact an obvious orange yellow coating was observed on the surface of both core plugs after the experiment fig s4 which suggests the presence of fe precipitates trace metals zn cd cu and mn in the effluent samples declined to near detection limits fig 3a and 3b which may be ascribed to hydrochemical processes such as precipitation co precipitation and adsorption onto mineral surfaces al et al 2000 8 2 h c a x m g 1 x c o 3 2 dolomite x c a 2 1 x m g 2 2 h c o 3 9 f e 3 3 o h f e oh 3 10 f e 2 2 o h f e oh 2 11 2 f e oh 2 o 2 2 f e oh 3 s the results of the core flooding experiments are consistent with our field investigation and give a good explanation for the field observations table s1 in the niangziguan karst catchment area the percolation of amd into karst aquifers was demonstrated by sulfur stable isotopes δ34s duan and liang 2006 and geochemical modeling zhang et al 2016b however it appears that the addition of fe rich amd does not cause any elevation in the concentration of iron and heavy metals in karst wells meanwhile a significant sulfate concentration is found table s1 therefore it is reasonable to conclude that neutralization adsorption precipitation or co precipitation are major geochemical factors that rapidly remove iron and other heavy metals from amd as it percolates into karst aquifers cruz hernandez et al 2016 jin et al 2015 li et al 2019 pu et al 2016 3 3 2 the formation of preferential flow channel s a sudden decline in the concentrations of mg2 and ca2 in combination with the increase in fe concentration occurred on the 14th day in the cnzg ii amdsyn ii experiment fig 3b a possible explanation is that with the continuous injection of acidic fluid preferential flow channel s caused by local dissolution in the core plug cnzg ii may have formed rötting et al 2015 as evidenced by the images of newly formed fractures in cnzg ii after the experiment fig s5 once the preferential flow channel s formed the residence time of amdsyn ii in core plug cnzg ii probably decreased and the rock fluid interaction was less efficient resulting in the sudden decline in mg and ca concentrations accompanied by increasing fe in the effluent solution however the preferential flow channel s did not apparently persist perhaps owing to blockage by cumulative precipitation of iron within the core plug resulting in an increase in ca2 and mg2 concentrations and a decline in iron concentration from the 15th day to the end of the experiment the filling of iron oxides is confirmed by the sem images which show that iron precipitates are only observed in the cross section of cnzg ii but not cnzg 0 or cnzg iii fig s4 3 4 the evolution of pore structure from mip analyses the potential change in pore structure of carbonate rock was investigated by mip analyses on the initial plug cnzg 0 and on cnzg iii and cnzg ii after the core flooding experiments table 2 for plug cnzg iii pores with throat diameters ranging from 0 1 to 10 μm account for 88 1 of the total pore volume of which 68 3 fall within 0 1 1 μm fig 4 a interestingly 9 4 of the pore volume has smaller throat diameters 0 01 0 1 μm which were not detectable in the core cnzg 0 moreover the pore volumes at all pore throat diameter intervals in core cnzg iii increased after the experiment table 2 an increase was also observed in total porosity and permeability in this core plug table 2 which confirms the acidic dissolution of carbonate in addition a new inflection point point ② started to appear at an intrusion pressure of 68 9 mpa in fig 4a corresponding to a connected pore network with average pore throat diameter of 0 0177 μm it suggests that the acidification may also stimulate the development of sub μm sized pores the core plug cnzg ii has a similar pore throat diameter distribution to cnzg iii with 89 1 of the pore volume having throat diameters of 0 1 10 μm and 9 5 with throat diameters of 0 01 0 1 μm fig 4b similar to cnzg iii a new inflection point was detected at 55 1 mpa corresponding to a pore diameter of 0 0221 μm fig 4b point ② the pore volume for diameters in the 0 1 1 μm interval increased from 6 15 to 7 33 μl g and the volume in the 1 10 μm interval increased from 1 29 to 2 11 μl g however the pore volume for throat diameters of 10 50 μm decreased from 0 217 to 0 152 μl g indicating partial filling of the pores the tortuosity value from mip test is an indicator of the connectivity of pore networks and it determined by the ratio of le l le is the actual travel distance between two points in the porous media and l the straight line distance hu et al 2018 higher tortuosity values imply more difficult travel through porous media the initial core plug cnzg 0 has a tortuosity value of 4 52 table 2 which indicates that traveling from one point to another 1 cm away needs an actual moving path of 4 52 cm acidification can increase the pore connectivity i e lowering the tortuosity hence both cnzg iii and cnzg ii have smaller tortuosity values of 3 59 and 3 61 respectively table 2 theoretically cnzg ii should have had a lower tortuosity than cnzg iii due to the formation of preferential channel s however the tortuosity values of these two core plugs are similar to each other we hypothesize that ferrous iron is capable of entering the pore structure before being oxidized to iron oxy hydroxides or oxy hydroxy sulfates by trace oxygen even under anoxic conditions and it precipitates in the pore space santomartino and webb 2007 the amdsyn ii has therefore both dissolution and pore filling effects on carbonates in contrast ferric iron can hardly access the pore structure of the core cnzg iii due to its rapid hydrolysis and aggregation to form particle sizes larger than pore throat diameters 3 5 the evolution of nanoscale pore structures from nitrogen physisorption combining the n2 physisorption with mip can provide the overall psd of the carbonate samples nitrogen sorption isotherms of the core samples before and after the core flooding experiment are shown in fig 5 the shapes of the isotherm curves for the three cores belong to type ii according to the iupac isotherm classification fig s1a sing et al 1985 the adsorption isotherms of the core samples after experiment increase rapidly initially and then reach a point of relatively constant increase this point is reached in cnzg ii only after a greater volume of n2 has been adsorbed compared to cnzg iii both of which adsorb more n2 than the plug cnzg 0 which did not undergo flooding this indicates that the acidification by amd created micropores in the core plugs and more were created in cnzg ii than cnzg iii probably due to the lower ph of the amdsyn ii ruthven 1984 the shapes of the hysteresis loops for all the three core plugs are similar to type h2 fig s1b in which pores can simply be considered as ink bottle shapes for cnzg iii and cnzg ii the desorption branch tends to be at a higher cumulative volume level resulting in a larger hysteresis than cnzg 0 fig 5 this expanded hysteresis reflects a stronger ink bottle effect after percolation by amd in line with the increasing mercury retaining ratio from mip results table 2 fig 6 shows that the fractions of pores with throat diameter less than 0 01 μm in cnzg 0 were virtually undetectable in both the bjh model and mip method while for the amd percolated cnzg iii and cnzg ii the psds determined by n2 physisorption peaked at 0 0009 μm in cnzg iii and 0 0005 and 0 0013 μm in cnzg ii in micropore ranges this psd determined by n2 physisorption using the bjh model confirm the development of micropores after amd percolation 3 6 a conceptual model of the interaction between fe rich amd and carbonates 3 6 1 advection modeling of amd percolation through carbonate in order to understand the interaction between carbonates and synthetic amd a 1d advection model was built in phreeqc 2 8 for the cnzg iii amdsyn iii and cnzg ii amdsyn ii experiments the core plug has a total pore volume of 0 78 ml which synthetic amd passes through in 40 min at a flow velocity of 0 02 ml min and hence the length of the core plug model was divided into 40 cells with 60 s reaction time for each cell in the model the kinetics of dolomite dissolution in acidic solution is controlled by the following equation eq 12 chou et al 1989 12 r k 1 h n k 2 h 2 c o 3 n k 3 where n 0 75 k1 2 6 10 7 mol cm2 s k2 1 0 10 8 mol cm2 s and k3 2 2 10 12 mol cm2 s the model yields the simulated chemical results of each cell with time after a total flow through volume of 576 ml equivalent to 743 68 pore volumes or 20 day percolation for the cnzg iii amdsyn iii system ca and mg increase rapidly at the start of the core cell 1 10 fig 7 a on the first day and the elevated concentrations move along the core over time fig 7b d the reaction between amdsyn iii and cnzg iii is rapid in the initial sections of the core as the ca and mg concentration curves have plateaus at cell 10 even after 20 day percolation fig 7d there is a slight decrease in ca at the outlet of the core cnzg iii due to the precipitation of calcite we infer that the newly formed pores caused by acidification of amdsyn iii are mainly focused in the inlet section of the core due to the rapid exhaustion of hydrogen ions however the fe concentration always decreases strikingly to near zero in cell 1 indicating that ferric iron precipitates almost immediately once in contact with dolomite as for the cnzg ii amdsyn ii system the increases in ca and mg are slower than those in cnzg iii amdsyn iii illustrated by the shallower slopes in fig 7e f the ca concentration curve in cnzg ii shows a plateau at cell 26 after 20 day percolation while the mg concentration increases across all the cells of the core indicating a longer pathway for amd carbonate interaction in cnzg ii compared with cnzg iii interestingly the behavior of fe in cnzg ii amdsyn ii is very different from the cnzg iii amdsyn iii system the iron starts to precipitate in cell 3 and the precipitation rate is much slower as iron is completely exhausted only in cell 15 fig 7e the peak of goethite precipitation occurs in cell 4 after 1 day with continued percolation of amdsyn ii the peak moves to cell 8 after 20 day percolation fig 7h which means large amounts of iron enter into the pore structure of core cnzg ii and have a transport distance of 27 cells this indicates that fe2 is more mobile than fe3 in the core flooding experiment and pore filling in cnzg ii is possible 3 6 2 conceptual model for the interaction of amd carbonate strata the results of this study provide a basis for a unifying conceptual model that describes the interaction of amd with carbonate rock the amd carbonate rock interaction triggers mineral dissolution and precipitation processes which often results in an alteration of pore volume the action of amd on carbonate can enlarge the pore spaces and fractures where numerous geochemical processes happen for the amdsyn iii the hydrolysis and precipitation of ferric iron take place at the interface between the fluid at the inlet of the core where the amd enters almost none of the iron can go further into the pore structure of the core as it precipitates and accumulates in the inlet pore spaces fig 8 in such case percolation through the carbonate core plug requires increasing injection pressure because of the blockage of the pore space by iron minerals in contrast ferrous iron spreads across more than half the core within the pore structure this is because the oxidation and precipitation of ferrous iron occurs after the neutralization of amdsyn ii which ensures the transport of fe2 within the connected pore space along the flow direction there is a peak concentration of iron precipitates in the core cnzg ii and it moves along the core over time if the amdsyn ii flooding experiment had continued over a much longer time than 20 days the fe2 might transport through the whole core instead of being oxidized to fe3 and precipitating in the pore structure in this study the ph of amdsyn ii was lower than that of amdsyn iii such that one or more preferential flow channels may have formed after 13 days of flooding fig 8 within the limited duration used here i e 20 days the evidence from cross sections suggests that this channel was eventually filled by iron precipitates as discussed above the amd in the niangziguan karst catchment area contains both ferric and ferrous ion our experiments suggest that the oxidation state of iron has a critical impact on the nature of the interaction between amd and carbonate strata the degree of karstification depends on the primary fractures and porosity the change in carbonate pore structure will in turn affect the local fluid velocity the model built in this study can help with an understanding of the pore structure evolution of carbonate strata as well as the transport fate of iron in the karst system mass transport and multiphase flow problems in karst systems should take into account the interactions between amd and carbonates 4 conclusions the co occurrence of coal mines and karst groundwater is common in china and the over exploitation of coal impacts the natural geologic conditions of the karst system invasion of amd into carbonate strata can change the pore structure of the host rocks and cause deterioration in the groundwater quality through acidification understanding the geochemical processes involved can provide new and valuable information for strategy making regarding the protection of local karst groundwater resources the interaction between amd and carbonates was investigated here by core flooding experiments to understand the changes to water chemistry and rock properties and comparison with field data the inferred processes involved were 1 acidic fluid attacked the carbonate rock triggering dissolution and micro fracturing thus increasing the volume of pores in the 0 001 10 μm pore throat diameter range and 2 ferrous iron gained access to the pore structure before its oxidation by trace oxygen and then precipitation as iron hydroxides on the pore surface in contrast the ferric iron had a much shorter transport distance in the carbonate plug due to its rapid precipitation and potential pore blocking as soon as it came into contact with the rock flooding of fe2 rich amd with lower ph may have caused the formation of preferential flow channel s in the carbonate cores however the channels were not maintained presumably due to the eventual precipitation of iron oxy hydroxides or oxy hydroxy sulfates and resulting pore blocking these geochemical processes are of great importance for heavy metal immobilization and amd treatment for the coal mining industry however the mechanisms involved are not fully established future work should focus on the adsorption behavior of contaminants such as cd cr and as during the reaction between carbonates and amd credit authorship contribution statement xiaobo zhang methodology investigation data curation writing original draft jing guo methodology software qinhong hu conceptualization formal analysis resources supervision funding acquisition xubo gao conceptualization supervision funding acquisition chengcheng li validation methodology meng luo methodology yanxin wang resources conceptualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was financially supported by natural science foundation of china nos 41807206 41672251 and 41877204 the 111 program state administration of foreign experts affairs the ministry of education of china b18049 china postdoctoral science foundation no 2018 m632941 and guangxi key science and technology innovation base on karst dynamics kdl guangxi202001 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 125571 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
5104,acid mine drainage amd poses significant ecological environmental and geological challenges worldwide especially in more vulnerable karst areas however the impact of amd on percolation features and pore structure of carbonate strata is poorly understood despite its importance for the evolution of carbonate aquifer as well as karst groundwater quality to fill this knowledge gap field investigations core flooding experiments reactive transport modeling and pore structure studies mercury intrusion porosimetry mip and nitrogen physisorption analysis were conducted to understand the geochemical processes and associated pore development in carbonate strata exposed to fe rich amd our field investigation shows that the amd is characterized by low ph values 2 4 3 8 high contents of sulfate 1457 4217 mg l fe 100 830 mg l fe3 fe2 and heavy metals that can potentially leak into carbonate strata the major findings of this study include 1 core flooding experiments reveal that the interaction of carbonate rock with amd causes a rapid elevation of solution ph and simultaneous precipitation of fe3 fe2 as iron oxy hydroxides or oxy hydroxy sulfates within the rock 2 the results of reactive transport modeling suggest that ferrous iron has a longer transport distance than ferric iron in the carbonate core plug and then it precipitates to fill the pore space and 3 despite the precipitation the flooding of amd increases the overall permeability of cores by creating large numbers of pores with throat diameter between 0 001 and 10 μm we also found that the interaction of amd with the carbonate rock might stimulate the formation of preferential flow channel s our results have been incorporated into a conceptual model built to illustrate the geochemical processes and mechanisms involved our research has important applications in amd treatment for coal mining industries and for local governments devising strategies for karst water resource protection and management keywords acid mine drainage carbonate rocks percolation pore structure geochemistry modelling 1 introduction natural groundwater host rock interaction is a slow and long term geochemical process that contributes to both the evolution of pore structure of the host rock and the groundwater quality in karst system pore structure formation is the result of years to thousands of years of carbonate dissolution which can ultimately result in large conduits or caves and the groundwater becomes more mineralized dar et al 2014 under the influence of anthropogenic activities the acidic fluids released including acid mine drainage amd co2 saturated fluids and acidic fracturing fluids can infiltrate into carbonate aquifers and accelerate the water rock interaction jiang et al 2020 resulting in the alteration of the hydraulic connection between adjacent aquifers and the deterioration of groundwater quality numerous studies have confirmed the changes in rock properties including permeability porosity and specific surface area caused by acidic fluids but the nature of the changes observed is very case dependent hao et al 2013 kharaka et al 2010 kwak et al 2018 pan et al 2016 viswanathan et al 2012 noiriel et al 2009 reported that injection of co2 rich water generally increases the reactive surface area and porosity of carbonate rocks and greater pore connectivity results in enhanced dissolution in the case of coarse calcite infiltrated by dilute hcl acidification only triggers dissolution in pores with throat diameters over 22 μm accompanied by little increase in permeability despite the obvious increasing porosity rötting et al 2015 since dissolution is not uniform preferential flow channels can be generated in the rock in a core flooding experiment by fredd and fogler 1998 the permeability of limestone cores increased rapidly as the reactive fluid flowed through due to the formation of preferential flow channels which reduced the resistance to fluid flow the intertwined feedback mechanisms often obscure the relationship between rock properties and fluid features thaysen et al 2017a 2017b kweon and deo 2017 luhmann et al 2014 noiriel et al 2009 poonoosamy et al 2015 soler 2016 for example the changes in rock properties caused by acidification have impacts on the local fluid velocity and flow capacity in return fluid velocity and flow capacity affect the rates of mineral dissolution published works have mainly focused on a simplified water rock interaction system whereby rocks are percolated by acid solution with acid as the only solute such as co2 saturated water or dilute hydrochloric acid smith et al 2017 berrezueta et al 2015 luquot and gouze 2009 luquot et al 2012 steefel et al 2005 xiong et al 2016 yu et al 2012 natural or anthropogenic acidic fluids e g amd containing additional chemical constituents may complicate the water rock interaction even further mineral dissolution caused by acidification expands the pore volume of the host rock while precipitation resulting from the over saturation of chemical constituents fills up the pore space these two processes have opposite impacts on the evolution of pore structure and this is the focus of this study over the last few decades an increase in coal mining activities has produced considerable amounts of amd especially in developing countries where coal mining provides the largest part of the energy supply the co occurrence of coal and karst water resources is common in china the niangziguan karst spring catchment area is a typical example with many springs and large reserves of coal fig 1 gao et al 2010 2016 zhang et al 2016b the occurrence of amd is generally the result of sulfide mineral oxidation in the air exposed coal strata this acid effluent is characterized by high concentrations of sulfate iron fe3 or fe2 and other trace elements the discharge of amd from abandoned coal mines is of increasing concern and a growing number of outflow sites have been found in recent years in the niangziguan area lian and hu 2017 wang et al 1997 wu et al 2014 the situation has become worse since 2013 when certain chemical constituents sulfate total hardness and total dissolved solids of the niangziguan spring showed a striking increase liang et al 2018 zhao et al 2019 the direct leakage of amd from abandoned coal mines has been underestimated as a severe long term environmental problem liang et al 2018 continuously discharged amd via leakage in the exposed carbonate areas or directly recharged into karst aquifers underground significantly modifies the pore structure and size distribution in carbonates and thus affects the flow in karst aquifers additionally interaction of amd with carbonate rock results in a series of geochemical processes which may in turn impact the evolution of karst water quality however the interaction between amd and carbonate rock and its resulting impact on karst aquifer properties are poorly understood coetzee et al 2013 kwak et al 2018 labastida et al 2019 sakala et al 2020 smith et al 2017 to fill this knowledge gap field investigations core flooding experiments reactive transport modeling and pore structures studies were conducted to elucidate the geochemical processes and pore development in carbonate strata receiving fe rich amd specifically the objectives of this study were to 1 evaluate the chemical evolution of the amd solution and the change in rock properties porosity permeability pore throat size distribution psd and tortuosity in a core flooding experiment and 2 describe the different transport patterns between fe3 rich amd and fe2 rich amd in the carbonate cores a better understanding of the amd fluid carbonate rock interactions and consequences can help with the development of local strategies for karst water resources management 2 materials and methods 2 1 field investigations field investigations were carried out four times from june 2017 to october 2019 in a suburb of yangquan city fig 1b the study area is located in the northwest of yangquan city where permo carboniferous strata cover most of the area fig 1d the ordovician carbonate strata crop out to the northeast and east of the catchment area zhang et al 2016b the karst groundwater is recharged in the high mountain areas and flows eastwards to niangziguan springs the coal seams are found primarily in the carboniferous taiyuan formation and permian shanxi formation of which the total thickness is in the range of 13 15 m with a burial depth from 150 to 500 m hu et al 2015 the 8 9 12 and 15 coal seams are actively mined such that underground goafs are spread throughout the whole study area and many of them are filled with water amd as long as the underground goafs are filled by the mine water outflow discharging takes place the amd discharge can infiltrate into the carbonate strata under natural conditions or due to anthropogenic activity the fluid can leak into carbonate aquifers via faults or fractures fig 1c as the over exploitation of karst water has led to a remarkable decline in the water table in addition amd flows along the regions with carbonate strata outcrop it can vertically infiltrate into the karst aquifer fig 1c there are three amd outflow discharge locations symbol 1 and two pits with amd symbol 8 in the study area as shown in fig 1d the amd outflow discharges directly into the local river depending on the natural hydrogeological conditions fig 1e and 1f the amd samples were collected from amd monitoring holes symbol 2 and outflow discharge locations symbol 1 fig 1d a hanna portable ph meter with probes for temperature ph electric conductivity ec dissolved oxygen do and total dissolved solids tds was used for field measurements six karst well water samples symbol 3 fig 1d were also collected to investigate the influence of amd on the groundwater system all amd and karst well water samples were filtered and separated into two bottles one for anion measurements and one with additional hno3 for cation and trace element measurements 2 2 carbonate rock samples the carbonate core was sampled from the ordovician strata in a drilling borehole in the study area symbol 9 fig 1d three cylindrical plugs were taken using a diamond drilling device from the same segment of the core labeled cnzg 0 cnzg iii and cnzg ii plug size 2 5 cm in diameter by 7 64 cm in height all three plugs were dried in an oven at 60 c for 48 h the cnzg 0 plug was used to test for the basic initial physico chemical properties the cnzg iii and cnzg ii plugs were used for the core flooding experiment with amd amdsyn iii the synthetic fe3 rich amd amdsyn ii the synthetic fe2 rich amd the data acquired for the cnzg 0 plug were assumed to be representative of the initial properties of the cnzg iii and cnzg ii plugs used in the experiments all data reported for cnzg iii and cnzg ii are for the plugs after the core flooding experiment core plugs were cut into 1 cm3 cubes for mip analyses thin slices were cut for sem eds analysis the remaining fragments were grounded into granules for xrd analyses sizes of less than 75 μm through 200 mesh sieve and nitrogen physisorption particle size 500 851 μm 20 and 35 mesh 2 3 core flooding experiment the custom designed experimental apparatus for studying water rock interaction via the core flooding experiment is shown in fig 2 a rubber sleeve wrapped core plug cnzg iii or cnzg ii was placed in the aluminum core holder around which a constant confining pressure of 10 mpa was supplied by injection of water with a syringe pump to avoid peripheral flow the amd amdsyn iii or amdsyn ii stored in a nitrogen purged tank was pumped through the core plug at a constant flow rate q of 0 02 ml min for 20 days the ph of in and out flow solutions was measured by ph probes during the experiment the outlet solution 28 8 ml was collected every day and stored in refrigerator at 4 c for further chemical analyses the synthetic amds amdsyn iii and amdsyn ii used in the core flooding experiments were prepared using analytical grade na2so4 cacl2 mgso4 7h2o zncl2 cdcl2 cucl2 mncl2 4h2o fecl3 6h2o and fecl2 4h2o dissolved in deoxygenated milli q water resistivity 18 2 mω cm the ph of the synthetic amds was adjusted to within the range 2 4 3 8 as found for amd in the field investigation with dilute h2so4 and naoh the initial concentrations of each constituent amdsyn iii and amdsyn ii are shown in table 1 2 4 methodology 2 4 1 chemical analyses of aqueous samples the measurement of total alkalinity for each liquid sample was conducted on the day after sampling both in the field and lab based on the gran titration method analysis error 2 ion chromatography ic dionex 120 dionex sunnyvale ca usa was used for testing the anions in which cl and so4 2 were the two main ions in this study the cations including major k na ca and mg and trace fe cu zn cd mn elements were determined by inductively coupled plasma atomic emission spectrometry icp aes iris intrepid xsp thermo elemental madison wi usa the charge balance error was used for evaluating the ion analytical precision within the standard limit of 5 2 4 2 mineralogy from xrd and sem xrd patterns were recorded using an x pert pro dy2198 diffractometer equipped with a cu kα radiation source at working power of 40 kv and 30 ma the diffraction patterns were scanned at a rate of 2 min 0 02 increments over an interval of 5 to 70 two theta to characterize the powdered rock samples the identification of mineralogy and specific locations 2θ of reflections was completed with the aid of high score software the flooding of fe rich amd may result in the formation of fe containing precipitates within the pore space of carbonate cores thus each core after experiment was cut into several thin slices with thickness of 2 mm since the cross sections of the slices were polished chemical analysis only was conducted by a quanta 200 scanning electron microscope with x ray energy dispersive spectroscopy sem eds these slices were carbon coated with quorum sc7620 sputter coater for further observation the equipment was operated at 20 kv and samples were observed at a proper working distance low operating voltage 7 kv was used to ensure better image quality and semi quantitative eds analyses were performed at 15 kv 2 4 3 determination of pore structure 2 4 3 1 mercury intrusion porosimetry mip the psd porosity permeability and tortuosity are critical rock properties and these were determined by mip with a mercury porosimeter autopore iv 9510 micromeritics norcross ga usa gao and hu 2013 labani et al 2013 zhang et al 2016a during the test the samples were evacuated and then invaded by enclosed mercury with a step wise increase in pressure from 0 034 to 413 mpa corresponding to 3 nm 50 μm in pore throat diameters each pressure step was equilibrated for 50 s the diameter of pores at each pressure step was calculated based on the washburn equation washburn 1921 as follows 1 δ p 2 γ cos θ r where p is the pressure difference γ is a constant equivalent to 485 dynes cm reflecting the surface tension of mercury θ is the contact angle considered to be 130 in this study between mercury and carbonate and r is the corresponding pore throat radius the permeability from mip data was obtained based on the method of katz and thompson 1986 2 k 1 89 l max 3 l c ø s l max where k is the permeability m2 l max μm and lc μm are the pore throat diameters correlated to maximum hydraulic conductance and the threshold pressure pt psia respectively φ is porosity and s l max represents the proportion of connected pore space with pore throat diameter over l max 2 4 3 2 nitrogen physisorption pore size is classified into micropores 2 nm mesopores 2 50 nm and macropores 50 nm according to the international union of pure and applied chemistry iupac mip is capable of characterizing the psd in the range of 3 nm to 50 μm while n2 physisorption can describe psd for pores less than 3 nm hinai et al 2014 the n2 physisorption isotherms were conducted using a micromeritics tristar ii 3020 instrument at a working temperature of 77 k the program quantachrome quadrawin was used for data processing from which the bet brunauer emmett and teller specific surface area brunauer et al 1938 and bjh barret joyner and halenda psd within the detection limits groen et al 2003 can be obtained the saturation pressure p0 of n2 was measured at intervals of 120 min and the relative pressures were quantified by p p0 where p is the partial pressure of the system labani et al 2013 fig s1 in supporting information shows the possible types of n2 physisorption isotherms and hysteresis loops based on the iupac classification 3 results and discussion 3 1 hydrogeochemistry of amd in the field numerous coal mines are situated in the catchment area fig 1b the study area has a severe environmental issue caused by the coal mining that has led to widespread development of underground goafs across the mining areas liu 2018 the amd overflows from the goafs and further flows into the local rivers of which the leakage area in the riverbed facilitate the recharge of amd contaminated river water into karst system the field investigation showed that the average discharge flow rate of amd at outlet sites is 5075 m3 d with a range between 3000 and 11000 m3 d the ph of amd ranges from 2 4 to 3 8 and some chemical constituents such as so4 2 1457 4217 mg l total hardness 470 2460 mg l and fe 100 830 mg l far exceed the national standard for drinking water quality in china maximum concentrations so4 2 250 mg l total hardness 450 mg l and fe 0 3 mg l ferric and ferrous ions are common constituents in amd and their oxidation state is determined by oxygen level in general amd is also rich in heavy metals such as zn cd cu and mn exposure of sulfides e g pyrite sphalerite and chalcopyrite to air leads to elevated acidity as sulphuric acid iron and heavy metal contents with the following reactions involved 3 2fes2 7o2 2h2o 2feso4 2h2so4 4 feso4 2h2o fe oh 2 h2so4 5 4fe oh 2 o2 2h2o 4fe oh 3 s 6 zns 2o2 2h2o zn oh 2 s 2h so4 2 7 4cufes2 17o2 18h2o 4cu oh 2 s 4fe oh 3 s 8so4 2 16h the discharge of amd can cause serious degradation in the quality of both surface and groundwater torres et al 2016 lefticariu et al 2016 nieva et al 2016 macías et al 2017 jones and cetin 2017 for instance 31 of 36 karst wells have undrinkable groundwater in the study area especially those near the amd outlet sites the karst well located downstream of the study area has been abandoned by the local residents because of the deterioration in water quality 3 2 properties of the carbonate rock before core flooding experiment xrd results show that the core samples cnzg 0 cnzg iii and cnzg ii are dominated by dolomite with minor content of calcite and quartz fig s2 mip results show a porosity of 2 08 and permeability of 4 13 10 16 m2 table 2 for cnzg 0 representing the properties before core flooding experiment the psd from mip for the core sample cnzg 0 is shown in fig s3 in order to describe the connected pore networks a threshold pressure was defined as the intrusion pressure of mercury capable of passing through the whole sample in fig s3a the inflection point represents the threshold pressure hu et al 2017 there are three inflection points for different pore networks at 0 207 mpa point ① corresponding to a pore throat diameter of 6 14 μm 0 539 mpa point ② corresponding to 2 34 μm and 2 47 mpa point ③ corresponding to 0 512 μm respectively the pore network at the highest threshold pressure point ③ has a pore throat diameter coincidently located within the range 0 1 1 μm in the distribution of pore throat diameters of the core sample fig s3a which accounts for the majority 80 4 of pore volume while the other two lower threshold pressures point ① and ② at 6 14 and 2 34 μm only account for 16 8 of the total pore volume the remaining 2 8 is occupied by pore throats with diameters in the range 10 50 μm no pores with throat diameters less than 0 1 μm are detected 3 3 effluent water geochemistry from the core flooding experiment 3 3 1 dissolution of carbonates and removal of metals the synthetic amd characterized by low ph is highly reactive with carbonate rock and the flooding of amd in the experiment lead to a rapid neutralization of amd which ended with weakly alkaline ph 8 0 fig 3 and mineral dissolution from the core plug elevated concentrations of mg2 and ca2 were observed 73 4 89 9 mg l for mg2 and 238 252 mg l for ca2 in the cnzg iii amdsyn iii experiment while values of 136 175 mg l for mg2 and 490 640 mg l for ca2 were seen in the cnzg ii amdsyn ii experiment compared to the initial value of 60 0 and 200 mg l respectively fig 3a the increases in ca2 mg2 and ph are clearly related to the dissolution of dolomite caxmg 1 x co3 2 x 1 in the core as described by eq 8 the ferric and ferrous ion concentrations decreased rapidly from the initial 130 mg l to less than 0 5 mg l after percolation through the core plugs except for a rebound after 13 days in the cnzg ii amdsyn ii experiment fig 3b as ferrous ferric ion is readily hydrolyzed and precipitated as iron oxy hydroxides or oxy hydroxy sulfates with increasing ph eq 9 11 the nearly complete exhaustion of iron after core flooding was expected in fact an obvious orange yellow coating was observed on the surface of both core plugs after the experiment fig s4 which suggests the presence of fe precipitates trace metals zn cd cu and mn in the effluent samples declined to near detection limits fig 3a and 3b which may be ascribed to hydrochemical processes such as precipitation co precipitation and adsorption onto mineral surfaces al et al 2000 8 2 h c a x m g 1 x c o 3 2 dolomite x c a 2 1 x m g 2 2 h c o 3 9 f e 3 3 o h f e oh 3 10 f e 2 2 o h f e oh 2 11 2 f e oh 2 o 2 2 f e oh 3 s the results of the core flooding experiments are consistent with our field investigation and give a good explanation for the field observations table s1 in the niangziguan karst catchment area the percolation of amd into karst aquifers was demonstrated by sulfur stable isotopes δ34s duan and liang 2006 and geochemical modeling zhang et al 2016b however it appears that the addition of fe rich amd does not cause any elevation in the concentration of iron and heavy metals in karst wells meanwhile a significant sulfate concentration is found table s1 therefore it is reasonable to conclude that neutralization adsorption precipitation or co precipitation are major geochemical factors that rapidly remove iron and other heavy metals from amd as it percolates into karst aquifers cruz hernandez et al 2016 jin et al 2015 li et al 2019 pu et al 2016 3 3 2 the formation of preferential flow channel s a sudden decline in the concentrations of mg2 and ca2 in combination with the increase in fe concentration occurred on the 14th day in the cnzg ii amdsyn ii experiment fig 3b a possible explanation is that with the continuous injection of acidic fluid preferential flow channel s caused by local dissolution in the core plug cnzg ii may have formed rötting et al 2015 as evidenced by the images of newly formed fractures in cnzg ii after the experiment fig s5 once the preferential flow channel s formed the residence time of amdsyn ii in core plug cnzg ii probably decreased and the rock fluid interaction was less efficient resulting in the sudden decline in mg and ca concentrations accompanied by increasing fe in the effluent solution however the preferential flow channel s did not apparently persist perhaps owing to blockage by cumulative precipitation of iron within the core plug resulting in an increase in ca2 and mg2 concentrations and a decline in iron concentration from the 15th day to the end of the experiment the filling of iron oxides is confirmed by the sem images which show that iron precipitates are only observed in the cross section of cnzg ii but not cnzg 0 or cnzg iii fig s4 3 4 the evolution of pore structure from mip analyses the potential change in pore structure of carbonate rock was investigated by mip analyses on the initial plug cnzg 0 and on cnzg iii and cnzg ii after the core flooding experiments table 2 for plug cnzg iii pores with throat diameters ranging from 0 1 to 10 μm account for 88 1 of the total pore volume of which 68 3 fall within 0 1 1 μm fig 4 a interestingly 9 4 of the pore volume has smaller throat diameters 0 01 0 1 μm which were not detectable in the core cnzg 0 moreover the pore volumes at all pore throat diameter intervals in core cnzg iii increased after the experiment table 2 an increase was also observed in total porosity and permeability in this core plug table 2 which confirms the acidic dissolution of carbonate in addition a new inflection point point ② started to appear at an intrusion pressure of 68 9 mpa in fig 4a corresponding to a connected pore network with average pore throat diameter of 0 0177 μm it suggests that the acidification may also stimulate the development of sub μm sized pores the core plug cnzg ii has a similar pore throat diameter distribution to cnzg iii with 89 1 of the pore volume having throat diameters of 0 1 10 μm and 9 5 with throat diameters of 0 01 0 1 μm fig 4b similar to cnzg iii a new inflection point was detected at 55 1 mpa corresponding to a pore diameter of 0 0221 μm fig 4b point ② the pore volume for diameters in the 0 1 1 μm interval increased from 6 15 to 7 33 μl g and the volume in the 1 10 μm interval increased from 1 29 to 2 11 μl g however the pore volume for throat diameters of 10 50 μm decreased from 0 217 to 0 152 μl g indicating partial filling of the pores the tortuosity value from mip test is an indicator of the connectivity of pore networks and it determined by the ratio of le l le is the actual travel distance between two points in the porous media and l the straight line distance hu et al 2018 higher tortuosity values imply more difficult travel through porous media the initial core plug cnzg 0 has a tortuosity value of 4 52 table 2 which indicates that traveling from one point to another 1 cm away needs an actual moving path of 4 52 cm acidification can increase the pore connectivity i e lowering the tortuosity hence both cnzg iii and cnzg ii have smaller tortuosity values of 3 59 and 3 61 respectively table 2 theoretically cnzg ii should have had a lower tortuosity than cnzg iii due to the formation of preferential channel s however the tortuosity values of these two core plugs are similar to each other we hypothesize that ferrous iron is capable of entering the pore structure before being oxidized to iron oxy hydroxides or oxy hydroxy sulfates by trace oxygen even under anoxic conditions and it precipitates in the pore space santomartino and webb 2007 the amdsyn ii has therefore both dissolution and pore filling effects on carbonates in contrast ferric iron can hardly access the pore structure of the core cnzg iii due to its rapid hydrolysis and aggregation to form particle sizes larger than pore throat diameters 3 5 the evolution of nanoscale pore structures from nitrogen physisorption combining the n2 physisorption with mip can provide the overall psd of the carbonate samples nitrogen sorption isotherms of the core samples before and after the core flooding experiment are shown in fig 5 the shapes of the isotherm curves for the three cores belong to type ii according to the iupac isotherm classification fig s1a sing et al 1985 the adsorption isotherms of the core samples after experiment increase rapidly initially and then reach a point of relatively constant increase this point is reached in cnzg ii only after a greater volume of n2 has been adsorbed compared to cnzg iii both of which adsorb more n2 than the plug cnzg 0 which did not undergo flooding this indicates that the acidification by amd created micropores in the core plugs and more were created in cnzg ii than cnzg iii probably due to the lower ph of the amdsyn ii ruthven 1984 the shapes of the hysteresis loops for all the three core plugs are similar to type h2 fig s1b in which pores can simply be considered as ink bottle shapes for cnzg iii and cnzg ii the desorption branch tends to be at a higher cumulative volume level resulting in a larger hysteresis than cnzg 0 fig 5 this expanded hysteresis reflects a stronger ink bottle effect after percolation by amd in line with the increasing mercury retaining ratio from mip results table 2 fig 6 shows that the fractions of pores with throat diameter less than 0 01 μm in cnzg 0 were virtually undetectable in both the bjh model and mip method while for the amd percolated cnzg iii and cnzg ii the psds determined by n2 physisorption peaked at 0 0009 μm in cnzg iii and 0 0005 and 0 0013 μm in cnzg ii in micropore ranges this psd determined by n2 physisorption using the bjh model confirm the development of micropores after amd percolation 3 6 a conceptual model of the interaction between fe rich amd and carbonates 3 6 1 advection modeling of amd percolation through carbonate in order to understand the interaction between carbonates and synthetic amd a 1d advection model was built in phreeqc 2 8 for the cnzg iii amdsyn iii and cnzg ii amdsyn ii experiments the core plug has a total pore volume of 0 78 ml which synthetic amd passes through in 40 min at a flow velocity of 0 02 ml min and hence the length of the core plug model was divided into 40 cells with 60 s reaction time for each cell in the model the kinetics of dolomite dissolution in acidic solution is controlled by the following equation eq 12 chou et al 1989 12 r k 1 h n k 2 h 2 c o 3 n k 3 where n 0 75 k1 2 6 10 7 mol cm2 s k2 1 0 10 8 mol cm2 s and k3 2 2 10 12 mol cm2 s the model yields the simulated chemical results of each cell with time after a total flow through volume of 576 ml equivalent to 743 68 pore volumes or 20 day percolation for the cnzg iii amdsyn iii system ca and mg increase rapidly at the start of the core cell 1 10 fig 7 a on the first day and the elevated concentrations move along the core over time fig 7b d the reaction between amdsyn iii and cnzg iii is rapid in the initial sections of the core as the ca and mg concentration curves have plateaus at cell 10 even after 20 day percolation fig 7d there is a slight decrease in ca at the outlet of the core cnzg iii due to the precipitation of calcite we infer that the newly formed pores caused by acidification of amdsyn iii are mainly focused in the inlet section of the core due to the rapid exhaustion of hydrogen ions however the fe concentration always decreases strikingly to near zero in cell 1 indicating that ferric iron precipitates almost immediately once in contact with dolomite as for the cnzg ii amdsyn ii system the increases in ca and mg are slower than those in cnzg iii amdsyn iii illustrated by the shallower slopes in fig 7e f the ca concentration curve in cnzg ii shows a plateau at cell 26 after 20 day percolation while the mg concentration increases across all the cells of the core indicating a longer pathway for amd carbonate interaction in cnzg ii compared with cnzg iii interestingly the behavior of fe in cnzg ii amdsyn ii is very different from the cnzg iii amdsyn iii system the iron starts to precipitate in cell 3 and the precipitation rate is much slower as iron is completely exhausted only in cell 15 fig 7e the peak of goethite precipitation occurs in cell 4 after 1 day with continued percolation of amdsyn ii the peak moves to cell 8 after 20 day percolation fig 7h which means large amounts of iron enter into the pore structure of core cnzg ii and have a transport distance of 27 cells this indicates that fe2 is more mobile than fe3 in the core flooding experiment and pore filling in cnzg ii is possible 3 6 2 conceptual model for the interaction of amd carbonate strata the results of this study provide a basis for a unifying conceptual model that describes the interaction of amd with carbonate rock the amd carbonate rock interaction triggers mineral dissolution and precipitation processes which often results in an alteration of pore volume the action of amd on carbonate can enlarge the pore spaces and fractures where numerous geochemical processes happen for the amdsyn iii the hydrolysis and precipitation of ferric iron take place at the interface between the fluid at the inlet of the core where the amd enters almost none of the iron can go further into the pore structure of the core as it precipitates and accumulates in the inlet pore spaces fig 8 in such case percolation through the carbonate core plug requires increasing injection pressure because of the blockage of the pore space by iron minerals in contrast ferrous iron spreads across more than half the core within the pore structure this is because the oxidation and precipitation of ferrous iron occurs after the neutralization of amdsyn ii which ensures the transport of fe2 within the connected pore space along the flow direction there is a peak concentration of iron precipitates in the core cnzg ii and it moves along the core over time if the amdsyn ii flooding experiment had continued over a much longer time than 20 days the fe2 might transport through the whole core instead of being oxidized to fe3 and precipitating in the pore structure in this study the ph of amdsyn ii was lower than that of amdsyn iii such that one or more preferential flow channels may have formed after 13 days of flooding fig 8 within the limited duration used here i e 20 days the evidence from cross sections suggests that this channel was eventually filled by iron precipitates as discussed above the amd in the niangziguan karst catchment area contains both ferric and ferrous ion our experiments suggest that the oxidation state of iron has a critical impact on the nature of the interaction between amd and carbonate strata the degree of karstification depends on the primary fractures and porosity the change in carbonate pore structure will in turn affect the local fluid velocity the model built in this study can help with an understanding of the pore structure evolution of carbonate strata as well as the transport fate of iron in the karst system mass transport and multiphase flow problems in karst systems should take into account the interactions between amd and carbonates 4 conclusions the co occurrence of coal mines and karst groundwater is common in china and the over exploitation of coal impacts the natural geologic conditions of the karst system invasion of amd into carbonate strata can change the pore structure of the host rocks and cause deterioration in the groundwater quality through acidification understanding the geochemical processes involved can provide new and valuable information for strategy making regarding the protection of local karst groundwater resources the interaction between amd and carbonates was investigated here by core flooding experiments to understand the changes to water chemistry and rock properties and comparison with field data the inferred processes involved were 1 acidic fluid attacked the carbonate rock triggering dissolution and micro fracturing thus increasing the volume of pores in the 0 001 10 μm pore throat diameter range and 2 ferrous iron gained access to the pore structure before its oxidation by trace oxygen and then precipitation as iron hydroxides on the pore surface in contrast the ferric iron had a much shorter transport distance in the carbonate plug due to its rapid precipitation and potential pore blocking as soon as it came into contact with the rock flooding of fe2 rich amd with lower ph may have caused the formation of preferential flow channel s in the carbonate cores however the channels were not maintained presumably due to the eventual precipitation of iron oxy hydroxides or oxy hydroxy sulfates and resulting pore blocking these geochemical processes are of great importance for heavy metal immobilization and amd treatment for the coal mining industry however the mechanisms involved are not fully established future work should focus on the adsorption behavior of contaminants such as cd cr and as during the reaction between carbonates and amd credit authorship contribution statement xiaobo zhang methodology investigation data curation writing original draft jing guo methodology software qinhong hu conceptualization formal analysis resources supervision funding acquisition xubo gao conceptualization supervision funding acquisition chengcheng li validation methodology meng luo methodology yanxin wang resources conceptualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was financially supported by natural science foundation of china nos 41807206 41672251 and 41877204 the 111 program state administration of foreign experts affairs the ministry of education of china b18049 china postdoctoral science foundation no 2018 m632941 and guangxi key science and technology innovation base on karst dynamics kdl guangxi202001 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 125571 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
