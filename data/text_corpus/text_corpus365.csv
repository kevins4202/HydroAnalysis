index,text
1825,the impoundment of cascade mega reservoirs in the upper yangtze river uyr has exerted profound and accumulative impacts on the lower reaches not only a drastic drop in the incoming sediment load but also overturning of the runoff sediment relationship based on a 1990 2021 dataset we examined fundamental changes in the sediment suspension regime in the jingjiang reach approximately 100 km below the three gorges dam tgd the cascade mega reservoir impacts are elucidated by three parameters inflow water discharge and sediment concentration released to the three gorges reservoir tgr and operating water levels in front of the tgd the wash load concentrations in the reach in the post tgr period illustrate strong relationships with the flow capacity index they however were actually determined by the above three parameters the relative importance of the three parameters in determining the wash load concentrations was evaluated by a random forest model after upstream reservoir impoundment starting in 2003 the unsaturation degrees in the reach tended to increase and the thresholds distinguishing wash load and bed material load have risen to 0 125 mm and 0 25 mm at ss jl and zc after tgd impoundment respectively in addition the flow capacity coefficients i e m and k in the starving reach became significantly lower than their equilibrium counterparts the study aims to facilitate effective management of the uyr cascade mega reservoirs and the experience could be drawn on for other large rivers facing hydropower development keywords sediment suspension regime cascade reservoirs nonequilibrium wash load jingjiang reach abbreviations uyr upper yangtze river tgd three gorges dam tgr three gorges reservoir myr middle yangtze river yc yichang xjb xiangjiaba xld xiluodu wdd wudongde bht baihetan ssc suspended sediment concentration rf random forests zc zhicheng ss shashi jl jianli ct cuntan wl wulong clj chenglinji m k mann kendell rfr random forest regression nse nash sutcliffe model efficiency coefficient mae mean absolute error rmse root mean squared error data availability data will be made available on request 1 introduction cascade mega dams can significantly alter natural flow and sediment regimes guo et al 2020 gupta et al 2012 yan et al 2022 drastic reduction in sediment load due to upstream trapping not only causes morphological changes in the lower reaches e g channel degradation width adjustment riverbed armouring and channel bar reshaping brandt 2000 graf 2006 li et al 2019 petts and gurnell 2005 petts and gurnell 2013 williams and wolman 1984 xia et al 2017 but also threatens the riverine eco environment including the water quality nutrient distribution light penetration and fish spawning mccartney 2009 wohl et al 2015 yang et al 2007 the yangtze river stands out as the third longest and one of the most heavily dammed river in the world guo et al 2020 much previous effort has been made to determine the sediment transport pattern in the middle yangtze river myr influenced by upstream damming chen et al 2018 yang et al 2018 the myr is a typical meandering channel extending 960 km from yichang yc to hukou after the impoundment of the well known three gorges reservoir tgr a dramatic reduction 76 in sediment loads was observed at yc the outlet of the upper yangtze river guo et al 2018 following additional operation of the upstream mega reservoirs i e xiangjiaba xjb in 2012 and xiluodu xld in 2013 the sediment flux at yc has decreased progressively by 97 compared to 1950s levels guo et al 2020 yang et al 2018 the decline in sediment load is anticipated to continue due to the cumulative sediment retention effect of two more upstream mega reservoirs i e wudongde wdd and baihetan bht activated in 2020 and 2021 respectively jiang et al 2023 yang et al 2022 in the pre tgr period the myr was generally considered a quasi equilibrium reach trimmed by limited sediment flushing or siltation he et al 2018 after tgr activation the myr became a nonequilibrium reach whose degree of unsaturation of suspended sediment still needs to be defined han et al 2010 proposed a nonequilibrium coefficient c which actually represents the deviation of the vertical profiles of suspended sediment concentration ssc from the classic rouse equation due to the limitation of the rouse equation chen et al 2013 han s coefficient c does not always accurately express the degree of sediment unsaturation in the myr sometimes even contrary to the real situation he et al 2020 lai et al 2017 examined the difference between the reach scale ssc and the sediment carrying capacity after the closure of the three gorges dam tgd and used it to assess the erosion in the myr lai et al 2017 did not consider the accumulative effects of upstream cascade mega reservoirs except the tgr drawing an incorrect conclusion that the myr had reached a new morphological equilibrium since 2008 the majority of previous research has focused on the adaptation length l for the bed load or adaptation coefficient α for the suspended load chien and wan 1999 l characterizes the distance for the bed load to adjust from a nonequilibrium state to an equilibrium state while α represents the ratio between the near bed and depth averaged sscs which can be expressed with an equivalent adaptation length ls for the suspended load chen et al 2010 researchers have reported a wide range of values for l or ls based on flume experiments armanini and di silvio 1988 bell and sutherland 1983 galappatti and vreugdenhil 1986 lee et al 1993 soni 1981 which are generally not suitable for large rivers with cascade mega reservoirs for instance bell and sutherland 1983 reported l was approximately the length of the first sand dune or scour hole phillips and sutherland 1989 and wu et al 2010 took l to be a hundred times d50 for the bed load yang et al 2022 however found that the downstream sediment scouring after the tgr impoundment reached as far as 954 4 km with limited recovery due to coarsening and armouring of the riverbed li et al 2023 showed that bed material composition affects the recovery processes zhang et al 2017 explored the restoration of both coarse d 0 125 mm and fine sediment load d 0 125 mm in the myr in the period of 1987 2014 although the latest data was not available then therefore the spatio temporal patterns of sediment unsaturation and recovery in the lower reach need further investigation upstream cascade dams changed not only the total amount but also the size gradation of suspended sediment in the myr as well as the threshold distinguishing wash load and suspended bed material wash load in a natural river refers to the portion of sediment usually silt and clay material that is carried in suspension and hardly found in the bed einstein et al 1940 it depends on the supply of fine sediments from upslope and upstream and has long been considered unrelated to flow capacity and therefore unpredictable chien and wan 1999 the sources of wash load in the myr mainly come from the upstream watershed while local streambank erosion contributes 18 to the total amount of suspended load in the jingjiang reach based on xia et al 2022 traditional theories hold that bed material load is of major importance to channel morphologic change brenna et al 2020 church 2006 therefore wash load is often excluded from sediment transport calculations lai et al 2017 however wash load has been proven crucial for modern impounded rivers especially as a carrier of nutrients and contaminants in aquatic ecosystems förstner and müller 1974 golterman et al 1983 walling et al 2016 zeng et al 2022 and therefore needs better understanding previous researchers put forward several thresholds to distingush wash load and suspended bed material including 1 fixed size thresholds such as 0 06 mm or 0 063 mm partheniades 1977 woo et al 1986 2 the einstein method which considers 10 of the smallest sediment particles of channel material as wash load while the remaining particles are considered as bed material load einstein 1950 3 the maximum curvature method which takes the maximum curvature point of the bed material grading curve as the division point xiong 1985 constant size demarcation distinguishing wash load and suspended bed material e g 0 06 mm has been widely adopted for river engineering for simplification however the threshold may vary dramatically according to the specific location and time as well as the characteristics of the river channel and bed material chien and wan 1999 for example the threshold may be lower in a sandy reach than in a sand gravel reach due to the smaller size of the particles in the middle and lower yangtze the criterion of 0 05 mm was also used previously for quasi equilibrium conditions i e the pre tgr period liu et al 2020 however for post tgr period li et al 2017 implied that 0 125 mm could be treated as the division size which was explicitly stated by yang et al 2022 the einstein method and the maximum curvature method both rely on the bed material grading curve the former can only provide rough estimates and the latter may not always be reliable since there may not be a distinct inflection point in the bed material grading curve lai et al 2017 and liu et al 2020 used the grain size at the 10 of the gradation of the riverbed sediment and concluded that the division criterion is approximately 0 1 mm for both pre and post tgr periods in the myr which was confirmed by guo and he 2021 using the maximum curvature method previous research by chien and wan 1999 shows that the concentration of bed material load is directly related to flow conditions whereas the concentration of wash load is not indicating that the difference in flow concentration relationship can be used as a criterion to distinguish bed material load and wash load recently many studies have been conducted in the field of sediment science and management with machine learning techniques such as random forests rf gupta et al 2021 mustafa 2019 deep learning essam et al 2022 and support vector regression models kakaei lafdani et al 2013 among others as a popular and user friendly method for regression problems genuer et al 2010 verikas et al 2011 the rf algorithm can handle different types of datasets and is therefore more feasible in addition the rf aggregates a collection of decision trees and has been proven robust against overfitting breiman 2001 liaw and wiener 2002 after comprehensive consideration we adopt rf in this study as the methodology for developing a wash load prediction model this research provides insight into the knowledge gaps regarding the unprecedented change in sediment suspension regimes in the myr due to upstream cascade mega reservoirs based on recent flow and sediment data 1990 2021 this study attempts to answer three questions 1 how did the myr sediment suspension regimes change during various operation periods of upstream cascade mega reservoirs 2 how did the unsaturation degree of the reach change with time and what was the recovery trend 3 what are the main factors impacting the wash load concentration in the reach and how can this concentration be predicted based on those factors the remainder of the research is structured as follows in section 2 the study area data and methods are introduced in section 3 we explore the regime change of the wash load d 0 125 mm and suspended bed material d 0 125 mm discussions and conclusions are presented in sections 4 and 5 respectively our study aims to facilitate the effective management of cascade mega reservoirs in the yangtze river and provide a summary of experience for use with other heavily dammed rivers 2 study area data and methods 2 1 study area this study focuses on the sediment suspension regime in the myr particularly the jingjiang reach from the zhicheng zc to chenglinji clj gauges approximately 347 km as shown in fig 1 c the upper and lower jingjiang reach ujr and ljr are divided by ouchikou and have lengths of 172 km and 175 km respectively the zc gauge is approximately 100 km downstream of the tgd the riverbed from zc to jiangkou consists of gravel sand while the riverbeds from jiangkou to ouchikou and the ljr are composed of sand the upstream stream gauges include cuntan ct and wulong wl which monitor the flow discharge and ssc in the main flow of the yangtze river and the tributary wu river respectively fig 1a all gauges are operated and maintained by the bureau of hydrology changjiang water resources commission the tgr the world s largest power station started to operate after june 2003 and the storage level was raised to 135 m during dry seasons the storage level then increased to 156 m in october 2006 and started to reach the normal level of 175 m in november 2008 ren et al 2021 gezhouba gzb is located 38 km downstream of the tgd and operated in 1988 fig 1c to effectively exploit hydropower resources in the uyr and enhance the flood control function of the tgr the authorities built a series of mega dams on the jinsha river the upper course of the yangtze river these cascade reservoirs include wdd bht xld and xjb fig 1b the xjb and xld reservoirs began to operate in 2012 2013 and their dams are 408 km and 565 km upstream of the ct gauge respectively sun et al 2021 yang et al 2018 bht and wdd as two more giant reservoirs upstream of xld were put into use in 2021 and 2020 respectively yan et al 2022 table 1 provides additional information about these reservoirs including total storage normal pool level first impoundment date and the distance to the tgd 2 2 data daily data obtained from ct and wl gauges include the flow discharge and ssc in the period of 2006 2018 table 2 in this study the discharge and sediment concentration of water inflow into the tgr are denoted as q and s respectively following guo et al 2018 and hu et al 2020 q and s of the tgr inflow can be calculated as follows 1 q q 1 q 2 2 s s 1 q 1 s 2 q 2 q 1 q 2 where subscripts 1 and 2 represent the ct and wl gauges respectively the influence of the dam operation is represented by the operating water levels in front of the tgd h which is also offered by the bureau of hydrology changjiang water resources commission annual data includes runoff sediment load and size distribution of bed material at the zc ss and jl gauges during 2002 2021 table 2 field measurements in the jingjiang reach include the flow discharge concentration and size gradation of suspended sediment corresponding water depths and flow velocities on vertical profiles of the zc ss and jl gauges the duration of the measured data includes 1998 2021 and a few years before the impoundment of the tgd as shown in table 2 most data were recorded in the flood seasons and the observation frequency varies considerably with a maximum of 18 times per year according to peak discharges and their duration in the year there are 7 13 vertical profiles in each gauging section and 5 or 7 observation points on each vertical profile the traditional 5 point method records the flow velocities and sediment concentration at relative water depths of 1 0 h 0 8 h 0 4 h 0 2 h and 0 1 h on each vertical profile h represents the depth of the line ranging from 2 09 m to 25 7 m at the three gauges in the periods of 2006 2007 2010 2013 and 2015 2016 the jingjiang bureau of hydrology extended the 5 point method to the 7 point method by adding two more observation points i e 0 5 m and 0 1 m from the streambed he et al 2018 considering the various operation modes of the tgr and upstream cascade mega reservoirs we divided our study period into 4 periods i e period 1 pre tgd before 2003 period 2 cofferdams and initial impoundment 2003 2008 period 3 trial impoundment 2009 2012 and period 4 cascade reservoir operation 2013 2021 the jingjiang reach can be deemed a quasi equilibrium reach in period 1 he et al 2018 after 2003 a large amount of sediment including flocculated material was aggregated in the reservoir and upstream channel li et al 2019 yang et al 2014 although the control measure i e storing clear water and discharging muddy flow mitigated reservoir siltation to a certain extent li et al 2015 moreover the high level operation of the tgr since november 2008 has significantly altered the ssc released downstream throughout the year jiang et al 2023 during period 4 the operation of two upstream cascade mega reservoirs i e xld and xjb continued to change q and s jiang et al 2023 yan et al 2021 the suspended sediment in the jingjiang reach is divided into nine groups gk k 1 9 according to its size fractions g1 0 002 0 004 mm g2 0 004 0 008 mm g3 0 008 0 016 mm g4 0 016 0 031 mm g5 0 031 0 062 mm g6 0 062 0 125 mm g7 0 125 0 25 mm g8 0 25 0 5 mm and g9 0 5 1 mm the sediment sizes are classified by the bureau of hydrology changjiang water resources commission according to the specification for geodesic survey in hydrology sl 58 2014 based on the previous classification g1 g5 can be identified as the wash load while the remaining groups g6 g9 correspond to suspended bed material in the post tgr period we find that g6 gradually shifts from suspended bed material to wash load which is further explained and validated in section 3 3 2 3 methods 2 3 1 indices of nonequilibrium and flow capacity following han et al 2010 this study introduces an index of the nonequilibrium degree denoted as ξ to describe the degree of deviation from an equilibrium condition 3 ξ s k s k s k where sk and sk are the depth averaged concentration and flow capacity for the k th group of suspended bed material respectively the reach can be considered a quasi equilibrium system if the reach averaged ξ index approaches zero for a long period while 1 ξ 0 and ξ 0 indicate unsaturation and over saturation regimes respectively most previous studies obtained sk using existing flow capacity equations e g zhang s equation tan et al 2018 yuan et al 2012 zhou et al 2019 4 s k k u 3 g h ω m where k and m are coefficients and u3 ghω is the flow capacity index which is derived from the ratio of the froude number u2 gh to the dimensionless setting velocity ω u u is the depth averaged flow velocity l t g is the gravitational acceleration l t2 h is the water depth l and ω is the settling velocity of the suspended sediment group l t and is defined as 5 ω 13 95 υ d 2 1 09 γ s γ γ g d 13 95 υ d where υ is the kinematic viscosity l2 t d is the particle diameter l and γ s and γ are the specific gravities of sediment and water respectively this study adopts u3 ghω as the flow capacity index we however do not use eq 4 to calculate the flow capacity since it is difficult to accurately select the proper k and m for our data range zhou et al 2022 to estimate the post tgr sk in this study the pre tgr sk under similar discharge is used as a proxy since the myr can be considered as a quasi equilibrium reach before tgd operation data of 20 000 m3 s within a 20 fluctuation was selected as it occurs most frequently the parameter u3 ghω is employed to characterize the flow condition and establish correlations with sk specifically sk exhibits a distinct relationship with u3 ghω when the sediment group is classified as bed material load but there is no notable correlation between sk and u3 ghω when the sediment group is categorized as wash load the maximum curvature method is utilized for validation purposes and readers can refer to guo and he 2021 for further details 2 3 2 mann kendall m k test the m k test kendall 1948 mann 1945 is adopted to identify the trend and mutation of the ξ series in the myr from 2003 to 2021 as a nonparametric method the m k test does not require samples to follow a certain distribution hao et al 2009 li and song 2020 therefore this test is highly recommended and has been widely applied in the analysis of hydrological and meteorological data guo et al 2020 zhao et al 2017 the trend is expressed by the standard normal variant z and a significance level of 5 is used more details on this method can be found in li and song 2020 2 3 3 random forest regression rfr to accurately predict the wash load concentration we adopt the rfr algorithm developed by breiman 2001 which is one of the most effective ensemble learning methods by adding an additional randomness layer to the bagging method mustafa 2019 rfr begins by generating ntree the number of trees in the forest bootstrap samples from the original dataset and the data not included in the bootstrap samples are referred to as out of bag oob data then ntree trees are trained separately by choosing the best split from randomly sampled mtry the number of variables randomly chosen at each node of the tree following the suggestion by liaw and wiener 2002 we consider ntree from 50 to 500 at an interval of 10 and choose the one providing the best model results mtry p 3 where p is the number of independent variables 3 in our case ultimately the averaged outcomes of ntree trees can be used to make predictions i e the wash load concentration in the study rfr is implemented using the random forest regressor package of python v 3 8 the original dataset is randomly split into 90 training data and 10 testing data to diminish the likelihood of overfitting and assure model stability and generalizability the training of regression trees is enhanced using a grid search method with ten fold cross validation the variable importance can be calculated as 6 vi x l 1 n tree i 1 n tree e r r o o b 2 e r r o o b 1 where xl refers to variable l erroob1 is the oob data error mean squared error for the ith observation and erroob2 is the oob data error adding noise interference to xl of oob data with reordering thus if xl is more important the vi xl value is higher since xl is permuted while all other variables are left unchanged mohammad et al 2016 2 3 4 model performance evaluation to evaluate the model performance four criteria i e the squared correlation coefficient r2 nash sutcliffe model efficiency coefficient nse mean absolute error mae and root mean squared error rmse are selected as follows 7 r 2 i 1 n o i o p i p i 1 n o i o 2 i 1 n p i p 2 2 8 nse 1 i 1 n o i p i 2 i 1 n o i o 2 9 mae 1 n i 1 n o i p i 10 rmse i 1 n o i p i 2 n where n is the number of analysed data and o i and p i are the ith observed and predicted values respectively o and p are their mean values the r2 range spans from 0 to 1 while nse varies between and 1 in addition r2 1 or nse 1 denotes a perfect match between the observed and modelled data nse 0 6 is typically regarded as satisfactory nse 0 indicates that the modelled results are no better than averaging the observations and nse 0 indicates poor model performance the indices of mae and rmse range from 0 to and lower values indicate better model performance gupta et al 2021 mustafa 2019 3 results 3 1 the flow and sediment condition at zc ss and jl in the four periods fig 2 illustrates the variations of runoff and sediment load in the jingjiang reach from 2002 to 2021 following the tgr impoundment there has been a significant reduction in annual sediment load at the three gauges decreasing from over 2 108 t in 2002 to 0 5 108 t in 2021 the runoff at the three gauges has fluctuated around 4000 108 m3 with a gradual increase over time notably 2006 was a dry year with much lower values of both runoff and sediment load compared to other years table 3 summarizes the average sediment percentages of g1 g9 and ssc measured at the zc ss and jl gauges in various periods in general the suspended sediment tends to coarsen in the jingjiang reach after tgd operation along with a significant decrease in the ssc and sk of g1 g9 at the three gauges during the post tgr periods especially in periods 3 and 4 with high water levels the sediment coarsening process during the four periods is similar at the three gauges from periods 1 to 2 there is a decrease in sediment percentages of g2 g5 at all three gauges ranging from 1 6 to 7 8 while g7 g8 experience an increase ranging from 4 7 to 28 3 during periods 2 to 3 the sediment proportions of g1 decrease by 2 to 7 9 whereas those of g2 g9 mostly increase except for several groups of g5 g8 the sediment percentages of g2 continue to decrease during period 4 at the three gauges indicating that sediment coarsening continues in the jingjiang reach the ssc as well as the sk of all size groups at the zc gauge exhibits a dramatic decline from periods 1 to 4 with decreasing rates 90 for instance the mean sk of g1 at the zc gauge is approximately 0 242 kg m3 in the pre tgr period it decreases to 0 071 kg m3 in period 2 and continues dropping to 0 014 kg m3 and 0 007 kg m3 in periods 3 and 4 respectively sk of the coarse material behaves differently from that of the wash load specifically the sk of g7 and g8 increase by 0 012 kg m3 and 0 029 kg m3 from periods 1 to 2 respectively and the sk of g9 continues to increase during periods 2 to 4 at the ss gauge sk of g1 to g8 generally decreases from periods 1 to 4 especially for sk of g1 g6 from periods 1 to 2 whose declining rates are approximately 74 87 additionally sk of g7 g8 at the ss gauge decreases by 0 15 from periods 1 to 2 which is different from the increase at the zc gauge 4 33 considering the considerable increases of 26 56 in two neighboring periods for sk of g7 g8 at the jl gauge one can conclude that the below dam scouring boosted the local supply of the coarse material from the streambed following the tgd operation this is supported by the sk fluctuation of g9 which is 0 kg m3 at the ss and jl gauges during periods 1 and 2 and increases to 0 001 kg m3 in period 3 the sk decline in all size groups attenuates after period 3 even in a few cases with increasing sk and the reasons might be related to the store clear water and discharge muddy flow operation strategy as well as bank erosion along the reach 3 2 spatial and temporal variations in the sk u3 ghω relations fig 3 shows the sk u3 ghω relationships at the zc and ss gauges with scatter plots during period 1 sk of the suspended bed material g6 g9 at the two gauges grows with increasing u3 ghω while the wash load g1 g5 demonstrates a very weak correlation with u3 ghω with a value range of 0 1 0 3 kg m3 fig 3a e however after the tgd impoundment in 2003 sk of all particle size groups illustrates strong relationships with u3 ghω fig 3b c d f g h for example as u3 ghω varies sk of g2 wash load at the zc and ss gauges remains almost constant 0 1 0 3 kg m3 during period 1 while it has a range of 0 0001 to 0 3 kg m3 from 2003 to 2021 fig 4 illustrates the sk u3 ghω relationships at the jl gauge in a different way it outlines the range of the lgsk lg u3 ghω scatter distribution by the combined density map similar to fig 3 fig 4 shows that the external contour lines of the wash load g1 g5 gradually shift from horizontal to inclined from 1998 to 2021 indicating that the correlations between sk of the wash load and u3 ghω strengthen intensively after tgd activation the distance between bell curve on the side diagrams of fig 4 decreases over time accompanied by a reduction in the overlapping areas between adjacent sediment groups particularly during period 4 this phenomenon may be attributed to the flow regulation of upstream cascade reservoirs which modulate the flood peak discharge while compensating the ecological baseflow during dry periods based on figs 3 and 4 the wash load groups g1 to g5 show no correlation between sk and u3 ghω in the pre tgr period and a remarkable sk u3 ghω correlation in the post tgr period note that this phenomenon does not mean that the wash load has turned into suspended bed material fig 5 shows the sk u3 ghω relationship of group g2 at zc on the scale of flood events sk of g2 remains almost constant as u3 ghω varies during each individual event similar conclusions can be drawn for the groups of g1 and g3 g5 therefore the impoundment of the tgr did not turn those wash loads g1 g5 into suspended bed material however it did change the status of group g6 as discussed in section 3 3 3 3 threshold size of the wash load and suspended bed material to determine the threshold for wash load and suspended bed material fig 6 compares the sk u3 ghω relations for groups g6 and g7 at the zc ss and jl gauges before and after the tgd operation fig 6 shows several representative flood events the concentration of group g6 notably increases with increasing u3 ghω in the pre tgr period while after tgr activation the fitting lines of the points at the zc and ss gauges are almost parallel to the x axis and sk is barely related to u3 ghω at the jl gauge fig 6a c e this confirms that at least the major part of the sediment within group g6 in the jingjiang reach has turned its regime from bed material load to wash load in comparison the relationships between the sk of g7 and u3 ghω at zc ss and jl have weakened in the post tgd period fig 6b d f the sk at zc tends to be a constant on jul 12 2021 while the sk at jl still exhibits strong correlations with u3 ghω on jul 7 2021 the above analyses suggest that the threshold values used to be 0 063 mm have risen to 0 125 mm and 0 25 mm at ss jl and zc after tgd impoundment respectively fig 7 shows the mean threshold calculated using the maximum curvature method for four periods in the jingjiang reach the threshold is found to be approximately 0 08 mm during period 1 which is in line with the division we used 0 063 mm this value increases significantly to 0 16 mm at zc in period 2 while gradually increasing at ss and jl from periods 2 to 3 the thresholds at zc ss and jl increase by 20 17 and 12 respectively the growth rates further diminish in period 4 with the thresholds eventually reaching 0 22 mm 0 15 mm and 0 11 mm at the zc ss and jl gauges respectively given the similar results of figs 6 and 7 the sk u3 ghω method employed in this study to distinguish wash load and bed material load has been validated by the traditional method it can thus be concluded that in the present time thresholds of 0 125 mm and 0 25 mm are applicable at ss jl and zc gauges respectively 3 4 parameters determining the wash load concentration fig 5 indicates that the wash load i e g1 g6 in the jingjiang reach is not determined by the flow capacity index rather its concentrations are event dependent and are deeply influenced by the upstream cascade mega reservoirs those influences can be elucidated by three parameters i e q s and h taking g2 as an example fig 8 shows the relationships between lgsk and lgq lgs and h sk of g2 in the jingjiang reach in 2009 2018 grows noticeably with increasing q and s but decreasing h various h values were adopted by reservoir managers in the wet june to september when h is approximately 145 m and dry november to january when h is approximately 175 m seasons h is between 145 m and 175 m in the rising falling periods february to may october to november note that in fig 8 we use the same day h as sk but for s and q we use values x and y days in advance respectively according to previous flood propagation analyses in the reach cheng et al 2016 dong et al 2014 ren et al 2020 after carefully reviewing the above literature we finally select x 6 y 2 before 2008 after 2009 x 8 y 2 and x 10 y 1 are selected for the flood and non flood seasons respectively rfr is used to estimate the relative importance of s q and h to sk of the wash load in the jingjiang reach during 2013 2018 still taking g2 as an example fig 9 shows the comparisons of the measured and estimated sk g2 from the training and testing datasets in our case there are a total of 108 and 12 samples for the training and testing datasets respectively the points are clustered around the 45 diagonal in both fig 9a r2 0 961 nse 0 943 mae 0 003 rmse 0 008 and fig 9b r2 0 985 nse 0 958 mae 0 007 rmse 0 014 we obtain similar results for other wash load groups i e g1 and g3 g6 which indicates that rfr works well in our case table 4 shows the relative importance of h q and s to sk of g1 g6 in the ss and jl gauges in 2013 2018 and among others fig 10 demonstrates the relative importance of g2 and g6 for all groups s contributes the most 40 48 and q ranks second 30 41 for g1 to g5 the contribution of h is much lower than the other two factors 16 17 the contribution of h is larger for the coarsest wash load group i e g6 which may be related to the regime change of g6 particles 3 5 nonequilibrium degree ξ and its trend analysis eq 3 defines an index of nonequilibrium degree denoted as ξ to describe the degree of deviation from an equilibrium condition based on eq 3 ξ is related to sediment sizes as well as flow discharge adopting 20 000 m3 s within a 20 fluctuation and taking g7 and g8 as examples fig 11 shows the time variation in ξ and its trend z at the zc ss and jl gauges after 2003 moreover the m k mutation test at the zc ss and jl gauges after 2003 is shown in fig s1 in the supplementary materials as shown in fig 11a ξ of g7 is negative corresponding to unsaturation and that of g8 was positive corresponding to over saturation during period 2 then both ξ values decrease the ξ index for g7 is 0 54 in 2003 quickly decreases to 0 96 in 2010 and then slowly drops to 0 99 in 2021 in addition ξ of g8 once in the range of 0 1 0 4 in 2003 2007 begins to rapidly drop after 2008 reaching 0 79 in 2010 and then gradually decreasing to a very low value close to 1 in 2021 with a 95 confidence level the mutation test fig s1 confirms that 2009 and 2010 are the mutation years for g7 and g8 particles respectively marked as green dotted lines and red dashed lines in fig 11 respectively in the 2010s and 2020s ε of the two groups g7 and g8 at the zc gauge maintains very low levels close to 1 the m k trend test confirms the decreasing trends of g7 and g8 with a 95 confidence level fig 11b z of g7 and g8 continues to drop slowly during period 4 as shown in fig 11c ξ of g7 is positive while that of g8 is negative at the ss gauge in period 2 the ξ index for g7 starts to decline dramatically in 2008 and then reaches a low value of 0 79 in 2010 in addition ξ of g8 particles rises once from 0 7 to 0 2 in 2003 to 2005 indicating a temporal recovery followed by a gradual decline over the next 7 years the mutation test fig s1c d confirms that 2010 and 2011 are the mutation years for g7 and g8 particles respectively thereafter ξ of the g7 particles remains steady with a range of 0 8 to 1 while ξ of the g8 particles remains at the level of 0 3 to 0 8 with some fluctuations z during period 4 remains steady suggesting a stronger recovery trend compared with the zc situation although the variation of g8 ξ does not reach the 95 confidence level fig 11d data under a discharge of 20 000 m3 s in 2003 2005 at the jl gauge are lacking fig 11e the ξ index for g7 at jl ranges from 0 68 to 0 78 in 2006 2008 indicating a temporal and delayed compared to the ss gauge recovery and then decreases sharply to 0 49 in 2010 it keeps dropping in the 2010s and the declining trend exceeds the 95 confidence level fig 11e f in addition ξ of g8 at jl drops in period 2 from 0 07 to 0 52 but rises in period 3 from 0 52 to 0 66 which might be related to the increasing bank collapse events during the period xia et al 2022 thereafter it begins to decline in period 4 from 0 66 to 0 72 furthermore ξ of both g7 and g8 declines with some fluctuations in the 2010s the m k mutation test shows that the mutation year of the ξ series of g7 at jl is 2010 which is the same for ss while ξ of g8 displays several mutation points including 2009 fig s1e f the variation of z values of g7 and g8 is similar to that of ξ although the z of g8 does not reach the 95 confidence level fig 11f as shown in fig 11 the mutation years of ξ for g7 and g8 are 2009 and 2010 at the zc gauge respectively which is related to the full operation of the tgd since the end of 2008 ren et al 2021 the mutation years of ξ for g7 and g8 at the ss gauge are 2010 and 2011 respectively this one year lag in two gauges may result from the delayed response of the sediment suspension regime compared to the rapid adjustment of the flow regime for the jl gauge the mutation year of ξ for g7 is also 2010 while it is 2009 for g8 with increasing ξ the reason may be related to the increasing number of bank collapse events during the period xia et al 2022 due to the impoundment of xjb and xld in 2012 2013 ξ of jl drops promptly in 2013 and maintains a downward trend although more data are needed fig 11 indicates a significant drop in ξ of g7 and g8 at all three gauges in 2020 which is related to the operation of wdd and bht 3 6 flow capacity coefficients k and m the flow capacity of the suspended bed material can be estimated by eq 4 i e zhang s formula when addressing nonequilibrium conditions one can still estimate the concentration of bed material load using eq 4 with adjusted parameters k and m xu 2014 the relationship between k m and the nonequilibrium degree however has seldom been discussed in previous studies the equilibrium m and k values of g7 g9 for the jingjiang reach are approximately 1 5 and 0 045 kg m3 respectively zhou et al 2022 their nonequilibrium values can be obtained by linearly fitting the sk u3 ghω relationships of g8 in fig 4 the slopes and y intercepts of those linear regression lines refer to m and lgk respectively fig 12 illustrates the variations in k and m in the post tgd period in the jingjiang reach the m and k values in general are lower than their equilibrium counterparts and the parameters at the zc gauge are lower than those at the ss and jl gauges the spatial and temporal variations in the parameters m and k indicate that they are positively correlated with ξ for the zc gauge m drops in periods 3 and 4 with large fluctuations while k decreases continuously from 0 022 kg m3 in 2003 to 6 3 10 3 kg m3 in 2011 and then maintains a stable low value during period 4 fig 12a b the marked decline in m and k during 2009 2011 may be attributed to the high water level operation of the tgd in the period for the ss gauge the m value is lower than its equilibrium counterpart i e 1 5 during 2003 2018 while it increases significantly in recent years reaching 2 06 in 2021 fig 12c fig 12d shows that k increases from 0 02 kg m3 in 2003 to 0 044 kg m3 in 2008 and then drops to a mean value of 0 018 kg m3 consistent with the variation in ξ in fig 11c the variations in m and k at the jl gauge are similar to the ξ variation in fig 11e including sharp declines during 2006 2009 and 2020 2021 fig 12e f most m and k values at the jl gauge are lower than their equilibrium counterparts except in 2006 4 discussion in figs 3 and 4 sk of the wash load of g1 g5 shows pseudo correlations with the flow capacity u3 ghω since 2003 fig 5 and related work however confirm that the impoundment of the tgr did not turn g1 g5 into suspended bed material rather it did reshuffle the suspension regime of group g6 from capacity control to source control the behaviours of those wash loads in figs 3 and 4 represent the profound influences from human beings which are simplified by three parameters i e s q and h discussed in section 3 4 during the dry seasons the higher h normally 175 m facilitates reservoir sedimentation liu et al 2022 reducing the downstream sk especially in period 4 with cascade reservoirs extremely low s values aggravate the drop of sk in the jingjiang reach which is confirmed by steeper linear fitted lines of e g g1 in fig 4 during the flood season the tgr operation of storing clear water and discharging muddy flow with lower h normally 145 m results in reservoir scouring and consequently higher sk dong et al 2010 the amount of scouring serving as the dominant source for downstream wash load relates to q and s in the flood season as well as reservoir siltation in previous years moreover the slopes of the linear fitted lines in fig 4 indicate the finer wash load e g g1 is more sensitive to anthropogenic influence than the coarser wash load e g g5 previous studies have demonstrated that reduced suspended sediment due to upstream damming may deteriorate the fluvial ecosystem sun et al 2021 particularly the loss of biogenic substances such as phosphorus as they may travel with fine sediment zhou et al 2013 therefore future sustainable management of river systems with cascade reservoirs requires not only flood control but also strategies for wash load recovery and ecological protection including favourable reservoir flushing during floods fruchard and camenen 2012 and other specific operation strategies li et al 2022 5 conclusions based on the dataset from 1990 to 2021 this research examined the sediment suspension regime in the jingjiang reach influenced by upstream cascade mega reservoirs the following conclusions were drawn from the present study 1 through the scatter plots of sk u3 ghω we found that sk of the wash load illustrated strong relationships with u3 ghω after tgd activation similar to the capacity controlling properties of the bed material load however this study has proven that the phenomenon is caused by the operation of upstream reservoirs while the wash load was still source controlled 2 after the tgd operation the threshold distinguishing wash load and suspended bed material used to be 0 063 mm have risen to 0 125 mm and 0 25 mm at ss jl and zc after tgd impoundment respectively 3 three factors i e s q and h exerted substantial effects on the unusual variation in the downstream sk of the wash load their relative contributions could be examined by rfr models which indicated that s ranked as the most important contributor 4 the unsaturation degree in the jingjiang reach increases significantly after 2009 2013 and 2020 which was affected by the successional operation of cascade reservoirs the closer to the tgd the greater the degree of channel starvation was while the unsaturation degree of g7 was always higher than that of g8 during periods 3 and 4 5 the values of m and k in the jingjiang reach were mostly lower than their equilibrium counterparts a higher unsaturation degree corresponded to a lower m and k these findings shed new light on the understanding of the sediment suspension regime in the starving reaches and provide a deeper insight into the spatio temporal recovery of nonequilibrium regime influenced by mega dams the factors influencing wash load concentration in the jingjiang reach can be analyzed by rfr models moreover in future research the operation of wdd and bht in the early 2020s should be taken into account and merit more attention from concerned authorities to improve the management of cascade mega reservoirs the study suffers from a few limitations for instance except for reservoir operation this study did not consider other factors contributing to the variation in sk such as climate change stream bank erosion and water soil conservation dai et al 2016 yang et al 2014 zhou et al 2020 besides the flow and sediment data we used were mostly measured in the flood seasons thus less information was recorded in the dry seasons in addition the observation frequency varied dramatically over the years which may have resulted in unknown uncertainty moreover the increasing threshold for wash load and bed material load are only applicable to the study area from zc to clj and may not be valid in the reservoirs or other reaches of the myr those limitations can be overcome as more data are collected in the future credit authorship contribution statement anan guo conceptualization methodology validation visualization writing original draft writing review editing dong chen supervision formal analysis funding acquisition writing review editing li he supervision funding acquisition yuming peng data curation guanglei duan data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the national key research and development program of china 2022yfc3203903 the national natural science foundation of china nos 51979264 52279077 the data used in this work are available on request the authors would like to express their gratitude to the editors and anonymous reviewers for their excellent suggestions which strengthened this work appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129694 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
1825,the impoundment of cascade mega reservoirs in the upper yangtze river uyr has exerted profound and accumulative impacts on the lower reaches not only a drastic drop in the incoming sediment load but also overturning of the runoff sediment relationship based on a 1990 2021 dataset we examined fundamental changes in the sediment suspension regime in the jingjiang reach approximately 100 km below the three gorges dam tgd the cascade mega reservoir impacts are elucidated by three parameters inflow water discharge and sediment concentration released to the three gorges reservoir tgr and operating water levels in front of the tgd the wash load concentrations in the reach in the post tgr period illustrate strong relationships with the flow capacity index they however were actually determined by the above three parameters the relative importance of the three parameters in determining the wash load concentrations was evaluated by a random forest model after upstream reservoir impoundment starting in 2003 the unsaturation degrees in the reach tended to increase and the thresholds distinguishing wash load and bed material load have risen to 0 125 mm and 0 25 mm at ss jl and zc after tgd impoundment respectively in addition the flow capacity coefficients i e m and k in the starving reach became significantly lower than their equilibrium counterparts the study aims to facilitate effective management of the uyr cascade mega reservoirs and the experience could be drawn on for other large rivers facing hydropower development keywords sediment suspension regime cascade reservoirs nonequilibrium wash load jingjiang reach abbreviations uyr upper yangtze river tgd three gorges dam tgr three gorges reservoir myr middle yangtze river yc yichang xjb xiangjiaba xld xiluodu wdd wudongde bht baihetan ssc suspended sediment concentration rf random forests zc zhicheng ss shashi jl jianli ct cuntan wl wulong clj chenglinji m k mann kendell rfr random forest regression nse nash sutcliffe model efficiency coefficient mae mean absolute error rmse root mean squared error data availability data will be made available on request 1 introduction cascade mega dams can significantly alter natural flow and sediment regimes guo et al 2020 gupta et al 2012 yan et al 2022 drastic reduction in sediment load due to upstream trapping not only causes morphological changes in the lower reaches e g channel degradation width adjustment riverbed armouring and channel bar reshaping brandt 2000 graf 2006 li et al 2019 petts and gurnell 2005 petts and gurnell 2013 williams and wolman 1984 xia et al 2017 but also threatens the riverine eco environment including the water quality nutrient distribution light penetration and fish spawning mccartney 2009 wohl et al 2015 yang et al 2007 the yangtze river stands out as the third longest and one of the most heavily dammed river in the world guo et al 2020 much previous effort has been made to determine the sediment transport pattern in the middle yangtze river myr influenced by upstream damming chen et al 2018 yang et al 2018 the myr is a typical meandering channel extending 960 km from yichang yc to hukou after the impoundment of the well known three gorges reservoir tgr a dramatic reduction 76 in sediment loads was observed at yc the outlet of the upper yangtze river guo et al 2018 following additional operation of the upstream mega reservoirs i e xiangjiaba xjb in 2012 and xiluodu xld in 2013 the sediment flux at yc has decreased progressively by 97 compared to 1950s levels guo et al 2020 yang et al 2018 the decline in sediment load is anticipated to continue due to the cumulative sediment retention effect of two more upstream mega reservoirs i e wudongde wdd and baihetan bht activated in 2020 and 2021 respectively jiang et al 2023 yang et al 2022 in the pre tgr period the myr was generally considered a quasi equilibrium reach trimmed by limited sediment flushing or siltation he et al 2018 after tgr activation the myr became a nonequilibrium reach whose degree of unsaturation of suspended sediment still needs to be defined han et al 2010 proposed a nonequilibrium coefficient c which actually represents the deviation of the vertical profiles of suspended sediment concentration ssc from the classic rouse equation due to the limitation of the rouse equation chen et al 2013 han s coefficient c does not always accurately express the degree of sediment unsaturation in the myr sometimes even contrary to the real situation he et al 2020 lai et al 2017 examined the difference between the reach scale ssc and the sediment carrying capacity after the closure of the three gorges dam tgd and used it to assess the erosion in the myr lai et al 2017 did not consider the accumulative effects of upstream cascade mega reservoirs except the tgr drawing an incorrect conclusion that the myr had reached a new morphological equilibrium since 2008 the majority of previous research has focused on the adaptation length l for the bed load or adaptation coefficient α for the suspended load chien and wan 1999 l characterizes the distance for the bed load to adjust from a nonequilibrium state to an equilibrium state while α represents the ratio between the near bed and depth averaged sscs which can be expressed with an equivalent adaptation length ls for the suspended load chen et al 2010 researchers have reported a wide range of values for l or ls based on flume experiments armanini and di silvio 1988 bell and sutherland 1983 galappatti and vreugdenhil 1986 lee et al 1993 soni 1981 which are generally not suitable for large rivers with cascade mega reservoirs for instance bell and sutherland 1983 reported l was approximately the length of the first sand dune or scour hole phillips and sutherland 1989 and wu et al 2010 took l to be a hundred times d50 for the bed load yang et al 2022 however found that the downstream sediment scouring after the tgr impoundment reached as far as 954 4 km with limited recovery due to coarsening and armouring of the riverbed li et al 2023 showed that bed material composition affects the recovery processes zhang et al 2017 explored the restoration of both coarse d 0 125 mm and fine sediment load d 0 125 mm in the myr in the period of 1987 2014 although the latest data was not available then therefore the spatio temporal patterns of sediment unsaturation and recovery in the lower reach need further investigation upstream cascade dams changed not only the total amount but also the size gradation of suspended sediment in the myr as well as the threshold distinguishing wash load and suspended bed material wash load in a natural river refers to the portion of sediment usually silt and clay material that is carried in suspension and hardly found in the bed einstein et al 1940 it depends on the supply of fine sediments from upslope and upstream and has long been considered unrelated to flow capacity and therefore unpredictable chien and wan 1999 the sources of wash load in the myr mainly come from the upstream watershed while local streambank erosion contributes 18 to the total amount of suspended load in the jingjiang reach based on xia et al 2022 traditional theories hold that bed material load is of major importance to channel morphologic change brenna et al 2020 church 2006 therefore wash load is often excluded from sediment transport calculations lai et al 2017 however wash load has been proven crucial for modern impounded rivers especially as a carrier of nutrients and contaminants in aquatic ecosystems förstner and müller 1974 golterman et al 1983 walling et al 2016 zeng et al 2022 and therefore needs better understanding previous researchers put forward several thresholds to distingush wash load and suspended bed material including 1 fixed size thresholds such as 0 06 mm or 0 063 mm partheniades 1977 woo et al 1986 2 the einstein method which considers 10 of the smallest sediment particles of channel material as wash load while the remaining particles are considered as bed material load einstein 1950 3 the maximum curvature method which takes the maximum curvature point of the bed material grading curve as the division point xiong 1985 constant size demarcation distinguishing wash load and suspended bed material e g 0 06 mm has been widely adopted for river engineering for simplification however the threshold may vary dramatically according to the specific location and time as well as the characteristics of the river channel and bed material chien and wan 1999 for example the threshold may be lower in a sandy reach than in a sand gravel reach due to the smaller size of the particles in the middle and lower yangtze the criterion of 0 05 mm was also used previously for quasi equilibrium conditions i e the pre tgr period liu et al 2020 however for post tgr period li et al 2017 implied that 0 125 mm could be treated as the division size which was explicitly stated by yang et al 2022 the einstein method and the maximum curvature method both rely on the bed material grading curve the former can only provide rough estimates and the latter may not always be reliable since there may not be a distinct inflection point in the bed material grading curve lai et al 2017 and liu et al 2020 used the grain size at the 10 of the gradation of the riverbed sediment and concluded that the division criterion is approximately 0 1 mm for both pre and post tgr periods in the myr which was confirmed by guo and he 2021 using the maximum curvature method previous research by chien and wan 1999 shows that the concentration of bed material load is directly related to flow conditions whereas the concentration of wash load is not indicating that the difference in flow concentration relationship can be used as a criterion to distinguish bed material load and wash load recently many studies have been conducted in the field of sediment science and management with machine learning techniques such as random forests rf gupta et al 2021 mustafa 2019 deep learning essam et al 2022 and support vector regression models kakaei lafdani et al 2013 among others as a popular and user friendly method for regression problems genuer et al 2010 verikas et al 2011 the rf algorithm can handle different types of datasets and is therefore more feasible in addition the rf aggregates a collection of decision trees and has been proven robust against overfitting breiman 2001 liaw and wiener 2002 after comprehensive consideration we adopt rf in this study as the methodology for developing a wash load prediction model this research provides insight into the knowledge gaps regarding the unprecedented change in sediment suspension regimes in the myr due to upstream cascade mega reservoirs based on recent flow and sediment data 1990 2021 this study attempts to answer three questions 1 how did the myr sediment suspension regimes change during various operation periods of upstream cascade mega reservoirs 2 how did the unsaturation degree of the reach change with time and what was the recovery trend 3 what are the main factors impacting the wash load concentration in the reach and how can this concentration be predicted based on those factors the remainder of the research is structured as follows in section 2 the study area data and methods are introduced in section 3 we explore the regime change of the wash load d 0 125 mm and suspended bed material d 0 125 mm discussions and conclusions are presented in sections 4 and 5 respectively our study aims to facilitate the effective management of cascade mega reservoirs in the yangtze river and provide a summary of experience for use with other heavily dammed rivers 2 study area data and methods 2 1 study area this study focuses on the sediment suspension regime in the myr particularly the jingjiang reach from the zhicheng zc to chenglinji clj gauges approximately 347 km as shown in fig 1 c the upper and lower jingjiang reach ujr and ljr are divided by ouchikou and have lengths of 172 km and 175 km respectively the zc gauge is approximately 100 km downstream of the tgd the riverbed from zc to jiangkou consists of gravel sand while the riverbeds from jiangkou to ouchikou and the ljr are composed of sand the upstream stream gauges include cuntan ct and wulong wl which monitor the flow discharge and ssc in the main flow of the yangtze river and the tributary wu river respectively fig 1a all gauges are operated and maintained by the bureau of hydrology changjiang water resources commission the tgr the world s largest power station started to operate after june 2003 and the storage level was raised to 135 m during dry seasons the storage level then increased to 156 m in october 2006 and started to reach the normal level of 175 m in november 2008 ren et al 2021 gezhouba gzb is located 38 km downstream of the tgd and operated in 1988 fig 1c to effectively exploit hydropower resources in the uyr and enhance the flood control function of the tgr the authorities built a series of mega dams on the jinsha river the upper course of the yangtze river these cascade reservoirs include wdd bht xld and xjb fig 1b the xjb and xld reservoirs began to operate in 2012 2013 and their dams are 408 km and 565 km upstream of the ct gauge respectively sun et al 2021 yang et al 2018 bht and wdd as two more giant reservoirs upstream of xld were put into use in 2021 and 2020 respectively yan et al 2022 table 1 provides additional information about these reservoirs including total storage normal pool level first impoundment date and the distance to the tgd 2 2 data daily data obtained from ct and wl gauges include the flow discharge and ssc in the period of 2006 2018 table 2 in this study the discharge and sediment concentration of water inflow into the tgr are denoted as q and s respectively following guo et al 2018 and hu et al 2020 q and s of the tgr inflow can be calculated as follows 1 q q 1 q 2 2 s s 1 q 1 s 2 q 2 q 1 q 2 where subscripts 1 and 2 represent the ct and wl gauges respectively the influence of the dam operation is represented by the operating water levels in front of the tgd h which is also offered by the bureau of hydrology changjiang water resources commission annual data includes runoff sediment load and size distribution of bed material at the zc ss and jl gauges during 2002 2021 table 2 field measurements in the jingjiang reach include the flow discharge concentration and size gradation of suspended sediment corresponding water depths and flow velocities on vertical profiles of the zc ss and jl gauges the duration of the measured data includes 1998 2021 and a few years before the impoundment of the tgd as shown in table 2 most data were recorded in the flood seasons and the observation frequency varies considerably with a maximum of 18 times per year according to peak discharges and their duration in the year there are 7 13 vertical profiles in each gauging section and 5 or 7 observation points on each vertical profile the traditional 5 point method records the flow velocities and sediment concentration at relative water depths of 1 0 h 0 8 h 0 4 h 0 2 h and 0 1 h on each vertical profile h represents the depth of the line ranging from 2 09 m to 25 7 m at the three gauges in the periods of 2006 2007 2010 2013 and 2015 2016 the jingjiang bureau of hydrology extended the 5 point method to the 7 point method by adding two more observation points i e 0 5 m and 0 1 m from the streambed he et al 2018 considering the various operation modes of the tgr and upstream cascade mega reservoirs we divided our study period into 4 periods i e period 1 pre tgd before 2003 period 2 cofferdams and initial impoundment 2003 2008 period 3 trial impoundment 2009 2012 and period 4 cascade reservoir operation 2013 2021 the jingjiang reach can be deemed a quasi equilibrium reach in period 1 he et al 2018 after 2003 a large amount of sediment including flocculated material was aggregated in the reservoir and upstream channel li et al 2019 yang et al 2014 although the control measure i e storing clear water and discharging muddy flow mitigated reservoir siltation to a certain extent li et al 2015 moreover the high level operation of the tgr since november 2008 has significantly altered the ssc released downstream throughout the year jiang et al 2023 during period 4 the operation of two upstream cascade mega reservoirs i e xld and xjb continued to change q and s jiang et al 2023 yan et al 2021 the suspended sediment in the jingjiang reach is divided into nine groups gk k 1 9 according to its size fractions g1 0 002 0 004 mm g2 0 004 0 008 mm g3 0 008 0 016 mm g4 0 016 0 031 mm g5 0 031 0 062 mm g6 0 062 0 125 mm g7 0 125 0 25 mm g8 0 25 0 5 mm and g9 0 5 1 mm the sediment sizes are classified by the bureau of hydrology changjiang water resources commission according to the specification for geodesic survey in hydrology sl 58 2014 based on the previous classification g1 g5 can be identified as the wash load while the remaining groups g6 g9 correspond to suspended bed material in the post tgr period we find that g6 gradually shifts from suspended bed material to wash load which is further explained and validated in section 3 3 2 3 methods 2 3 1 indices of nonequilibrium and flow capacity following han et al 2010 this study introduces an index of the nonequilibrium degree denoted as ξ to describe the degree of deviation from an equilibrium condition 3 ξ s k s k s k where sk and sk are the depth averaged concentration and flow capacity for the k th group of suspended bed material respectively the reach can be considered a quasi equilibrium system if the reach averaged ξ index approaches zero for a long period while 1 ξ 0 and ξ 0 indicate unsaturation and over saturation regimes respectively most previous studies obtained sk using existing flow capacity equations e g zhang s equation tan et al 2018 yuan et al 2012 zhou et al 2019 4 s k k u 3 g h ω m where k and m are coefficients and u3 ghω is the flow capacity index which is derived from the ratio of the froude number u2 gh to the dimensionless setting velocity ω u u is the depth averaged flow velocity l t g is the gravitational acceleration l t2 h is the water depth l and ω is the settling velocity of the suspended sediment group l t and is defined as 5 ω 13 95 υ d 2 1 09 γ s γ γ g d 13 95 υ d where υ is the kinematic viscosity l2 t d is the particle diameter l and γ s and γ are the specific gravities of sediment and water respectively this study adopts u3 ghω as the flow capacity index we however do not use eq 4 to calculate the flow capacity since it is difficult to accurately select the proper k and m for our data range zhou et al 2022 to estimate the post tgr sk in this study the pre tgr sk under similar discharge is used as a proxy since the myr can be considered as a quasi equilibrium reach before tgd operation data of 20 000 m3 s within a 20 fluctuation was selected as it occurs most frequently the parameter u3 ghω is employed to characterize the flow condition and establish correlations with sk specifically sk exhibits a distinct relationship with u3 ghω when the sediment group is classified as bed material load but there is no notable correlation between sk and u3 ghω when the sediment group is categorized as wash load the maximum curvature method is utilized for validation purposes and readers can refer to guo and he 2021 for further details 2 3 2 mann kendall m k test the m k test kendall 1948 mann 1945 is adopted to identify the trend and mutation of the ξ series in the myr from 2003 to 2021 as a nonparametric method the m k test does not require samples to follow a certain distribution hao et al 2009 li and song 2020 therefore this test is highly recommended and has been widely applied in the analysis of hydrological and meteorological data guo et al 2020 zhao et al 2017 the trend is expressed by the standard normal variant z and a significance level of 5 is used more details on this method can be found in li and song 2020 2 3 3 random forest regression rfr to accurately predict the wash load concentration we adopt the rfr algorithm developed by breiman 2001 which is one of the most effective ensemble learning methods by adding an additional randomness layer to the bagging method mustafa 2019 rfr begins by generating ntree the number of trees in the forest bootstrap samples from the original dataset and the data not included in the bootstrap samples are referred to as out of bag oob data then ntree trees are trained separately by choosing the best split from randomly sampled mtry the number of variables randomly chosen at each node of the tree following the suggestion by liaw and wiener 2002 we consider ntree from 50 to 500 at an interval of 10 and choose the one providing the best model results mtry p 3 where p is the number of independent variables 3 in our case ultimately the averaged outcomes of ntree trees can be used to make predictions i e the wash load concentration in the study rfr is implemented using the random forest regressor package of python v 3 8 the original dataset is randomly split into 90 training data and 10 testing data to diminish the likelihood of overfitting and assure model stability and generalizability the training of regression trees is enhanced using a grid search method with ten fold cross validation the variable importance can be calculated as 6 vi x l 1 n tree i 1 n tree e r r o o b 2 e r r o o b 1 where xl refers to variable l erroob1 is the oob data error mean squared error for the ith observation and erroob2 is the oob data error adding noise interference to xl of oob data with reordering thus if xl is more important the vi xl value is higher since xl is permuted while all other variables are left unchanged mohammad et al 2016 2 3 4 model performance evaluation to evaluate the model performance four criteria i e the squared correlation coefficient r2 nash sutcliffe model efficiency coefficient nse mean absolute error mae and root mean squared error rmse are selected as follows 7 r 2 i 1 n o i o p i p i 1 n o i o 2 i 1 n p i p 2 2 8 nse 1 i 1 n o i p i 2 i 1 n o i o 2 9 mae 1 n i 1 n o i p i 10 rmse i 1 n o i p i 2 n where n is the number of analysed data and o i and p i are the ith observed and predicted values respectively o and p are their mean values the r2 range spans from 0 to 1 while nse varies between and 1 in addition r2 1 or nse 1 denotes a perfect match between the observed and modelled data nse 0 6 is typically regarded as satisfactory nse 0 indicates that the modelled results are no better than averaging the observations and nse 0 indicates poor model performance the indices of mae and rmse range from 0 to and lower values indicate better model performance gupta et al 2021 mustafa 2019 3 results 3 1 the flow and sediment condition at zc ss and jl in the four periods fig 2 illustrates the variations of runoff and sediment load in the jingjiang reach from 2002 to 2021 following the tgr impoundment there has been a significant reduction in annual sediment load at the three gauges decreasing from over 2 108 t in 2002 to 0 5 108 t in 2021 the runoff at the three gauges has fluctuated around 4000 108 m3 with a gradual increase over time notably 2006 was a dry year with much lower values of both runoff and sediment load compared to other years table 3 summarizes the average sediment percentages of g1 g9 and ssc measured at the zc ss and jl gauges in various periods in general the suspended sediment tends to coarsen in the jingjiang reach after tgd operation along with a significant decrease in the ssc and sk of g1 g9 at the three gauges during the post tgr periods especially in periods 3 and 4 with high water levels the sediment coarsening process during the four periods is similar at the three gauges from periods 1 to 2 there is a decrease in sediment percentages of g2 g5 at all three gauges ranging from 1 6 to 7 8 while g7 g8 experience an increase ranging from 4 7 to 28 3 during periods 2 to 3 the sediment proportions of g1 decrease by 2 to 7 9 whereas those of g2 g9 mostly increase except for several groups of g5 g8 the sediment percentages of g2 continue to decrease during period 4 at the three gauges indicating that sediment coarsening continues in the jingjiang reach the ssc as well as the sk of all size groups at the zc gauge exhibits a dramatic decline from periods 1 to 4 with decreasing rates 90 for instance the mean sk of g1 at the zc gauge is approximately 0 242 kg m3 in the pre tgr period it decreases to 0 071 kg m3 in period 2 and continues dropping to 0 014 kg m3 and 0 007 kg m3 in periods 3 and 4 respectively sk of the coarse material behaves differently from that of the wash load specifically the sk of g7 and g8 increase by 0 012 kg m3 and 0 029 kg m3 from periods 1 to 2 respectively and the sk of g9 continues to increase during periods 2 to 4 at the ss gauge sk of g1 to g8 generally decreases from periods 1 to 4 especially for sk of g1 g6 from periods 1 to 2 whose declining rates are approximately 74 87 additionally sk of g7 g8 at the ss gauge decreases by 0 15 from periods 1 to 2 which is different from the increase at the zc gauge 4 33 considering the considerable increases of 26 56 in two neighboring periods for sk of g7 g8 at the jl gauge one can conclude that the below dam scouring boosted the local supply of the coarse material from the streambed following the tgd operation this is supported by the sk fluctuation of g9 which is 0 kg m3 at the ss and jl gauges during periods 1 and 2 and increases to 0 001 kg m3 in period 3 the sk decline in all size groups attenuates after period 3 even in a few cases with increasing sk and the reasons might be related to the store clear water and discharge muddy flow operation strategy as well as bank erosion along the reach 3 2 spatial and temporal variations in the sk u3 ghω relations fig 3 shows the sk u3 ghω relationships at the zc and ss gauges with scatter plots during period 1 sk of the suspended bed material g6 g9 at the two gauges grows with increasing u3 ghω while the wash load g1 g5 demonstrates a very weak correlation with u3 ghω with a value range of 0 1 0 3 kg m3 fig 3a e however after the tgd impoundment in 2003 sk of all particle size groups illustrates strong relationships with u3 ghω fig 3b c d f g h for example as u3 ghω varies sk of g2 wash load at the zc and ss gauges remains almost constant 0 1 0 3 kg m3 during period 1 while it has a range of 0 0001 to 0 3 kg m3 from 2003 to 2021 fig 4 illustrates the sk u3 ghω relationships at the jl gauge in a different way it outlines the range of the lgsk lg u3 ghω scatter distribution by the combined density map similar to fig 3 fig 4 shows that the external contour lines of the wash load g1 g5 gradually shift from horizontal to inclined from 1998 to 2021 indicating that the correlations between sk of the wash load and u3 ghω strengthen intensively after tgd activation the distance between bell curve on the side diagrams of fig 4 decreases over time accompanied by a reduction in the overlapping areas between adjacent sediment groups particularly during period 4 this phenomenon may be attributed to the flow regulation of upstream cascade reservoirs which modulate the flood peak discharge while compensating the ecological baseflow during dry periods based on figs 3 and 4 the wash load groups g1 to g5 show no correlation between sk and u3 ghω in the pre tgr period and a remarkable sk u3 ghω correlation in the post tgr period note that this phenomenon does not mean that the wash load has turned into suspended bed material fig 5 shows the sk u3 ghω relationship of group g2 at zc on the scale of flood events sk of g2 remains almost constant as u3 ghω varies during each individual event similar conclusions can be drawn for the groups of g1 and g3 g5 therefore the impoundment of the tgr did not turn those wash loads g1 g5 into suspended bed material however it did change the status of group g6 as discussed in section 3 3 3 3 threshold size of the wash load and suspended bed material to determine the threshold for wash load and suspended bed material fig 6 compares the sk u3 ghω relations for groups g6 and g7 at the zc ss and jl gauges before and after the tgd operation fig 6 shows several representative flood events the concentration of group g6 notably increases with increasing u3 ghω in the pre tgr period while after tgr activation the fitting lines of the points at the zc and ss gauges are almost parallel to the x axis and sk is barely related to u3 ghω at the jl gauge fig 6a c e this confirms that at least the major part of the sediment within group g6 in the jingjiang reach has turned its regime from bed material load to wash load in comparison the relationships between the sk of g7 and u3 ghω at zc ss and jl have weakened in the post tgd period fig 6b d f the sk at zc tends to be a constant on jul 12 2021 while the sk at jl still exhibits strong correlations with u3 ghω on jul 7 2021 the above analyses suggest that the threshold values used to be 0 063 mm have risen to 0 125 mm and 0 25 mm at ss jl and zc after tgd impoundment respectively fig 7 shows the mean threshold calculated using the maximum curvature method for four periods in the jingjiang reach the threshold is found to be approximately 0 08 mm during period 1 which is in line with the division we used 0 063 mm this value increases significantly to 0 16 mm at zc in period 2 while gradually increasing at ss and jl from periods 2 to 3 the thresholds at zc ss and jl increase by 20 17 and 12 respectively the growth rates further diminish in period 4 with the thresholds eventually reaching 0 22 mm 0 15 mm and 0 11 mm at the zc ss and jl gauges respectively given the similar results of figs 6 and 7 the sk u3 ghω method employed in this study to distinguish wash load and bed material load has been validated by the traditional method it can thus be concluded that in the present time thresholds of 0 125 mm and 0 25 mm are applicable at ss jl and zc gauges respectively 3 4 parameters determining the wash load concentration fig 5 indicates that the wash load i e g1 g6 in the jingjiang reach is not determined by the flow capacity index rather its concentrations are event dependent and are deeply influenced by the upstream cascade mega reservoirs those influences can be elucidated by three parameters i e q s and h taking g2 as an example fig 8 shows the relationships between lgsk and lgq lgs and h sk of g2 in the jingjiang reach in 2009 2018 grows noticeably with increasing q and s but decreasing h various h values were adopted by reservoir managers in the wet june to september when h is approximately 145 m and dry november to january when h is approximately 175 m seasons h is between 145 m and 175 m in the rising falling periods february to may october to november note that in fig 8 we use the same day h as sk but for s and q we use values x and y days in advance respectively according to previous flood propagation analyses in the reach cheng et al 2016 dong et al 2014 ren et al 2020 after carefully reviewing the above literature we finally select x 6 y 2 before 2008 after 2009 x 8 y 2 and x 10 y 1 are selected for the flood and non flood seasons respectively rfr is used to estimate the relative importance of s q and h to sk of the wash load in the jingjiang reach during 2013 2018 still taking g2 as an example fig 9 shows the comparisons of the measured and estimated sk g2 from the training and testing datasets in our case there are a total of 108 and 12 samples for the training and testing datasets respectively the points are clustered around the 45 diagonal in both fig 9a r2 0 961 nse 0 943 mae 0 003 rmse 0 008 and fig 9b r2 0 985 nse 0 958 mae 0 007 rmse 0 014 we obtain similar results for other wash load groups i e g1 and g3 g6 which indicates that rfr works well in our case table 4 shows the relative importance of h q and s to sk of g1 g6 in the ss and jl gauges in 2013 2018 and among others fig 10 demonstrates the relative importance of g2 and g6 for all groups s contributes the most 40 48 and q ranks second 30 41 for g1 to g5 the contribution of h is much lower than the other two factors 16 17 the contribution of h is larger for the coarsest wash load group i e g6 which may be related to the regime change of g6 particles 3 5 nonequilibrium degree ξ and its trend analysis eq 3 defines an index of nonequilibrium degree denoted as ξ to describe the degree of deviation from an equilibrium condition based on eq 3 ξ is related to sediment sizes as well as flow discharge adopting 20 000 m3 s within a 20 fluctuation and taking g7 and g8 as examples fig 11 shows the time variation in ξ and its trend z at the zc ss and jl gauges after 2003 moreover the m k mutation test at the zc ss and jl gauges after 2003 is shown in fig s1 in the supplementary materials as shown in fig 11a ξ of g7 is negative corresponding to unsaturation and that of g8 was positive corresponding to over saturation during period 2 then both ξ values decrease the ξ index for g7 is 0 54 in 2003 quickly decreases to 0 96 in 2010 and then slowly drops to 0 99 in 2021 in addition ξ of g8 once in the range of 0 1 0 4 in 2003 2007 begins to rapidly drop after 2008 reaching 0 79 in 2010 and then gradually decreasing to a very low value close to 1 in 2021 with a 95 confidence level the mutation test fig s1 confirms that 2009 and 2010 are the mutation years for g7 and g8 particles respectively marked as green dotted lines and red dashed lines in fig 11 respectively in the 2010s and 2020s ε of the two groups g7 and g8 at the zc gauge maintains very low levels close to 1 the m k trend test confirms the decreasing trends of g7 and g8 with a 95 confidence level fig 11b z of g7 and g8 continues to drop slowly during period 4 as shown in fig 11c ξ of g7 is positive while that of g8 is negative at the ss gauge in period 2 the ξ index for g7 starts to decline dramatically in 2008 and then reaches a low value of 0 79 in 2010 in addition ξ of g8 particles rises once from 0 7 to 0 2 in 2003 to 2005 indicating a temporal recovery followed by a gradual decline over the next 7 years the mutation test fig s1c d confirms that 2010 and 2011 are the mutation years for g7 and g8 particles respectively thereafter ξ of the g7 particles remains steady with a range of 0 8 to 1 while ξ of the g8 particles remains at the level of 0 3 to 0 8 with some fluctuations z during period 4 remains steady suggesting a stronger recovery trend compared with the zc situation although the variation of g8 ξ does not reach the 95 confidence level fig 11d data under a discharge of 20 000 m3 s in 2003 2005 at the jl gauge are lacking fig 11e the ξ index for g7 at jl ranges from 0 68 to 0 78 in 2006 2008 indicating a temporal and delayed compared to the ss gauge recovery and then decreases sharply to 0 49 in 2010 it keeps dropping in the 2010s and the declining trend exceeds the 95 confidence level fig 11e f in addition ξ of g8 at jl drops in period 2 from 0 07 to 0 52 but rises in period 3 from 0 52 to 0 66 which might be related to the increasing bank collapse events during the period xia et al 2022 thereafter it begins to decline in period 4 from 0 66 to 0 72 furthermore ξ of both g7 and g8 declines with some fluctuations in the 2010s the m k mutation test shows that the mutation year of the ξ series of g7 at jl is 2010 which is the same for ss while ξ of g8 displays several mutation points including 2009 fig s1e f the variation of z values of g7 and g8 is similar to that of ξ although the z of g8 does not reach the 95 confidence level fig 11f as shown in fig 11 the mutation years of ξ for g7 and g8 are 2009 and 2010 at the zc gauge respectively which is related to the full operation of the tgd since the end of 2008 ren et al 2021 the mutation years of ξ for g7 and g8 at the ss gauge are 2010 and 2011 respectively this one year lag in two gauges may result from the delayed response of the sediment suspension regime compared to the rapid adjustment of the flow regime for the jl gauge the mutation year of ξ for g7 is also 2010 while it is 2009 for g8 with increasing ξ the reason may be related to the increasing number of bank collapse events during the period xia et al 2022 due to the impoundment of xjb and xld in 2012 2013 ξ of jl drops promptly in 2013 and maintains a downward trend although more data are needed fig 11 indicates a significant drop in ξ of g7 and g8 at all three gauges in 2020 which is related to the operation of wdd and bht 3 6 flow capacity coefficients k and m the flow capacity of the suspended bed material can be estimated by eq 4 i e zhang s formula when addressing nonequilibrium conditions one can still estimate the concentration of bed material load using eq 4 with adjusted parameters k and m xu 2014 the relationship between k m and the nonequilibrium degree however has seldom been discussed in previous studies the equilibrium m and k values of g7 g9 for the jingjiang reach are approximately 1 5 and 0 045 kg m3 respectively zhou et al 2022 their nonequilibrium values can be obtained by linearly fitting the sk u3 ghω relationships of g8 in fig 4 the slopes and y intercepts of those linear regression lines refer to m and lgk respectively fig 12 illustrates the variations in k and m in the post tgd period in the jingjiang reach the m and k values in general are lower than their equilibrium counterparts and the parameters at the zc gauge are lower than those at the ss and jl gauges the spatial and temporal variations in the parameters m and k indicate that they are positively correlated with ξ for the zc gauge m drops in periods 3 and 4 with large fluctuations while k decreases continuously from 0 022 kg m3 in 2003 to 6 3 10 3 kg m3 in 2011 and then maintains a stable low value during period 4 fig 12a b the marked decline in m and k during 2009 2011 may be attributed to the high water level operation of the tgd in the period for the ss gauge the m value is lower than its equilibrium counterpart i e 1 5 during 2003 2018 while it increases significantly in recent years reaching 2 06 in 2021 fig 12c fig 12d shows that k increases from 0 02 kg m3 in 2003 to 0 044 kg m3 in 2008 and then drops to a mean value of 0 018 kg m3 consistent with the variation in ξ in fig 11c the variations in m and k at the jl gauge are similar to the ξ variation in fig 11e including sharp declines during 2006 2009 and 2020 2021 fig 12e f most m and k values at the jl gauge are lower than their equilibrium counterparts except in 2006 4 discussion in figs 3 and 4 sk of the wash load of g1 g5 shows pseudo correlations with the flow capacity u3 ghω since 2003 fig 5 and related work however confirm that the impoundment of the tgr did not turn g1 g5 into suspended bed material rather it did reshuffle the suspension regime of group g6 from capacity control to source control the behaviours of those wash loads in figs 3 and 4 represent the profound influences from human beings which are simplified by three parameters i e s q and h discussed in section 3 4 during the dry seasons the higher h normally 175 m facilitates reservoir sedimentation liu et al 2022 reducing the downstream sk especially in period 4 with cascade reservoirs extremely low s values aggravate the drop of sk in the jingjiang reach which is confirmed by steeper linear fitted lines of e g g1 in fig 4 during the flood season the tgr operation of storing clear water and discharging muddy flow with lower h normally 145 m results in reservoir scouring and consequently higher sk dong et al 2010 the amount of scouring serving as the dominant source for downstream wash load relates to q and s in the flood season as well as reservoir siltation in previous years moreover the slopes of the linear fitted lines in fig 4 indicate the finer wash load e g g1 is more sensitive to anthropogenic influence than the coarser wash load e g g5 previous studies have demonstrated that reduced suspended sediment due to upstream damming may deteriorate the fluvial ecosystem sun et al 2021 particularly the loss of biogenic substances such as phosphorus as they may travel with fine sediment zhou et al 2013 therefore future sustainable management of river systems with cascade reservoirs requires not only flood control but also strategies for wash load recovery and ecological protection including favourable reservoir flushing during floods fruchard and camenen 2012 and other specific operation strategies li et al 2022 5 conclusions based on the dataset from 1990 to 2021 this research examined the sediment suspension regime in the jingjiang reach influenced by upstream cascade mega reservoirs the following conclusions were drawn from the present study 1 through the scatter plots of sk u3 ghω we found that sk of the wash load illustrated strong relationships with u3 ghω after tgd activation similar to the capacity controlling properties of the bed material load however this study has proven that the phenomenon is caused by the operation of upstream reservoirs while the wash load was still source controlled 2 after the tgd operation the threshold distinguishing wash load and suspended bed material used to be 0 063 mm have risen to 0 125 mm and 0 25 mm at ss jl and zc after tgd impoundment respectively 3 three factors i e s q and h exerted substantial effects on the unusual variation in the downstream sk of the wash load their relative contributions could be examined by rfr models which indicated that s ranked as the most important contributor 4 the unsaturation degree in the jingjiang reach increases significantly after 2009 2013 and 2020 which was affected by the successional operation of cascade reservoirs the closer to the tgd the greater the degree of channel starvation was while the unsaturation degree of g7 was always higher than that of g8 during periods 3 and 4 5 the values of m and k in the jingjiang reach were mostly lower than their equilibrium counterparts a higher unsaturation degree corresponded to a lower m and k these findings shed new light on the understanding of the sediment suspension regime in the starving reaches and provide a deeper insight into the spatio temporal recovery of nonequilibrium regime influenced by mega dams the factors influencing wash load concentration in the jingjiang reach can be analyzed by rfr models moreover in future research the operation of wdd and bht in the early 2020s should be taken into account and merit more attention from concerned authorities to improve the management of cascade mega reservoirs the study suffers from a few limitations for instance except for reservoir operation this study did not consider other factors contributing to the variation in sk such as climate change stream bank erosion and water soil conservation dai et al 2016 yang et al 2014 zhou et al 2020 besides the flow and sediment data we used were mostly measured in the flood seasons thus less information was recorded in the dry seasons in addition the observation frequency varied dramatically over the years which may have resulted in unknown uncertainty moreover the increasing threshold for wash load and bed material load are only applicable to the study area from zc to clj and may not be valid in the reservoirs or other reaches of the myr those limitations can be overcome as more data are collected in the future credit authorship contribution statement anan guo conceptualization methodology validation visualization writing original draft writing review editing dong chen supervision formal analysis funding acquisition writing review editing li he supervision funding acquisition yuming peng data curation guanglei duan data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the national key research and development program of china 2022yfc3203903 the national natural science foundation of china nos 51979264 52279077 the data used in this work are available on request the authors would like to express their gratitude to the editors and anonymous reviewers for their excellent suggestions which strengthened this work appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129694 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
1826,algal blooms occasionally occur in oligotrophic lakes or reservoirs however the mechanisms and conditions that trigger bloom formation remain unclear therefore high frequency every 3 days monitoring and high resolution 100 sites surveying of the algal biomass were performed during the summer of 2018 2020 to explore rainfall effects on algal growth and its associated mechanism in xin anjiang reservoir a large deep and oligotrophic reservoir in the subtropical region of china the results showed that in the short term rainfall inhibited algal growth in the river zone while promoted algal growth in the lake zone path analysis pls pm and correlation analysis revealed that rainfall inhibited algal growth in the river zone by increasing discharge and decreasing light availability turbidity and water temperature while promoted algal growth in the lake zone by increasing the nutrient concentrations especially for phosphorus in addition we found that the stronger the rainfall is the wider regions of the reservoir it impacted monthly observations at 100 sites showed substantial increases in both algal biomass mean chla concentration doubled and nutrients concentrations in almost the whole reservoir after rainstorm events in xin anjiang reservoir indicating that rainstorm induced nutrient pulsing loading could trigger algal blooms in oligotrophic reservoirs in the long term extreme weather events are predicted to occur more frequently as the global climate changes in the future and oligotrophic reservoirs are facing a greater risk of algal blooms keywords harmful algal bloom extreme weather event rainstorm discharge oligotrophic reservoir data availability data will be made available on request 1 introduction phytoplankton are important primary producers and play important roles in material circulation and energy flows in aquatic ecosystems le moal et al 2019 however the excessive proliferation of phytoplankton also known as blooms can lead to a series of ecological and social issues such as reducing dissolved oxygen in water bodies killing aquatic plants and fishes and threatening the drinking water supply huisman et al 2018 xu et al 2021 algal blooms are often defined as algal scum aggregates at the water surface qin et al 2021 in recent decades algal blooms have become a global problem in aquatic environments ho et al 2019 hou et al 2022 it has long been recognized that nutrient enrichment especially nitrogen and phosphorus is the key cause of algal blooms schindler 1974 dillon and rigler 1974 xu et al 2010 generally eutrophic lakes are more likely to be observed with blooms because of their high nutrients level qin et al 2007 quinlan et al 2021 however there is increasing evidence that algal blooms also occur in oligotrophic systems reinl et al 2020 sterner et al 2020 su et al 2019 algal blooms are related to several environmental factors such as nutrients zhou et al 2022 zou et al 2020 light liu et al 2021a temperature donis et al 2021 paerl and huisman 2008 and hydrodynamic conditions li et al 2021a yang et al 2018 zhang et al 2016 in oligotrophic lakes changes in meteorological and hydrological conditions are the main factors that influence algal blooms reinl et al 2021 smucker et al 2021 for example global changes including increased temperature altered precipitation reduced acidification and increased dissolved organic matter loads to lakes provided suitable environmental conditions for cyanobacterial blooms in 28 nutrient poor swedish lakes over a 16 year study period freeman et al 2020 furthermore oligotrophic lakes are more sensitive to nutrient pulses due to the severe nutrient limitations in these lakes rigosi et al 2014 precipitation associated with storms can supply nutrients to lakes via short term runoff events from watersheds stockwell et al 2020 long term monitoring of lake superior indicated that the two largest blooms occurred during years of especially extreme rainfall sterner et al 2020 carpenter et al 2022 therefore rainfall events play a key role in the occurrence of algal blooms in oligotrophic lakes rainfall events can alter nutrient light temperature and hydrodynamic conditions in lakes which are the key determinants of algal growth stockwell et al 2020 in addition the response of algae to rainfall is divided into short term and long term responses suggesting that rainfall events have an immediate effect and a delayed effect on algae a study of xinglinwan reservoir in xiamen city indicated that short term rainfall can limit cyanobacterial blooms luo et al 2022 high frequency measurements in a long and narrow dam reservoir in southeast china during a storm period showed that rainfall had a delayed effect on algal blooms chen et al 2018 the results of these studies suggest that the effects of rainfall on algal blooms are complex on the one hand rainfall can limit algae growth by decreasing water temperature water retention time and light availability liao et al 2021 on the other hand rainfall events provide nutrients or living propagules to the blooms from the watershed however these studies focused on channel reservoirs with short water retention times that are easily impacted by rainfall events and how rainfall events affect algal growth and bloom formation in large and deep reservoirs is still unclear xin anjiang reservoir is a large deep and oligotrophic lake and is an important drinking water resource in the yangtze river delta region in recent years algal blooms have also occurred occasionally in the river mouth of the reservoir huang et al 2021 previous studies have shown that rainstorm floods interrupt algal accumulation by disrupting thermal stratification and reducing the available light in the river regions of xin anjiang reservoir zhang et al 2021b however only the river mouth of the reservoir was monitored and the survey time was during the period of thermal stratification in early spring moreover the situation is complicated in such a large reservoir and there is a lack of research on the effects of rainfall events on algae during the summer rainy season therefore we investigated meteorological and hydrological conditions water quality and algal biomass in a high frequency survey at the upstream river site and downstream lake site in the reservoir and the survey results were combined with those of high resolution lake wide surveys the objectives of this paper were 1 to characterize the response of algae to rainfall events in river and lake regions of the reservoir 2 to elucidate the immediate and delayed effects of rainfall events on algal growth in xin anjiang reservoir and 3 to analyze the mechanism by which rainfall events can induce algal blooms and assess the corresponding management implications in large subtropical and oligotrophic reservoirs 2 materials and methods 2 1 study area xin anjiang reservoir 29 22 29 50 n 118 36 119 14 e located in the western part of zhejiang province fig 1 is the third largest reservoir in china and provides drinking water to more than 10 million people xin anjiang reservoir has a surface area of 580 km2 a basin area of 10 442 km2 a water volume of 17 8 109 m3 and an average water depth of 31 m when the water level is 108 m relative to sea level wu et al 2015 xin anjiang reservoir is in a subtropical monsoon climate area the average annual temperature there is approximately 17 3 c and the average annual rainfall totals 1600 mm li et al 2020 zhou et al 2020 in addition most rainfall events occur between april and july and runoff in the flood season accounts for 65 of the total annual runoff wang et al 2012 there are 25 major rivers which have counted inflow discharge that flow into xin anjiang reservoir the xin anjiang river northwest tributary fig 1 is the most important accounting for approximately 70 of the inflow runoff zhai et al 2014 zhou et al 2016a in addition multiyear nutrient levels in xin anjiang reservoir are low wu et al 2015 li et al 2021b the lake wide annual mean values of total nitrogen and total phosphorus during our survey may 2020 to april 2021 were 0 89 mg l and 22 0 μg l respectively and the lake regions in the reservoir were even lower thus rainfall especially rainstorm events will lead to the transport of large amounts of nutrients and suspended particulate matter spm from upstream river basins into the reservoir during the flood season li et al 2022a wang et al 2012 zhou et al 2016b 2 2 sampling and measurement procedures a total of 521 water samples were collected in this study over two sampling campaigns one subset of 121 samples was taken by high frequency once every 3 days observations at the river site and the lake site of the reservoir in the summers june july and august of 2018 and 2019 fig 1 red stars in this campaign water samples were collected at three depths 1 3 and 5 m below the surface and then mixed thoroughly in a bucket another subset of 400 samples was collected by monthly high resolution 100 sites fig 1 circles observations obtained in the summer june july and august of 2020 and some data from may were added since the sampling time was the last week of each month in this campaign water samples were collected at the depth of the subsurface chlorophyll maxima scm liu et al 2020a first a ysi exo2 7 channel sonde yellow springs inc yellow springs oh usa was used to measure the vertical chlorophyll fluorescence chlf and determine the scm depth then water samples were collected at this depth all water samples were collected by using acid cleaned niskin bottles and kept on ice and in the dark while in the field then the samples were filtered through precombusted gf f filters whatman 0 7 μm to measure the concentrations of total dissolved nitrogen tdn total dissolved phosphorus tdp and chlorophyll a chla the tn tp tdn and tdp concentrations were determined according to standard methods carranzo 2012 the chla concentration was measured using spectrophotometry at wavelengths of 665 nm and 750 nm following extraction with hot 90 ethanol zhu et al 2015 secchi depth sd was measured using a 20 cm diameter secchi disk other physical factors such as water temperature wt turbidity turb ph fluorescent dissolved organic matter fdom and dissolved oxygen do were measured by ysi exo2 7 channel sonde yellow springs inc yellow springs oh usa in addition daily meteorological data namely the average air temperature at total daily precipitation precipitation and sunlight hours ssh were collected from 2018 to 2020 at the chun an meteorological station fig 1 red triangle and were obtained from the china meteorological data sharing service system https data cma cn daily discharge in the xin anjiang river is monitored at two hydrological gauging stations tunxi and yuliang and data were obtained from the taihu basin hydrological information service system https 218 1 102 107 8100 indexwater html 2 3 data analysis 2 3 1 definition of algal blooms definition of algae bloom and the associated biomass have always been challenging isles and pomati 2021 some studies refer to blooms as events when dense algal particles are observed either floating on the surface or suspended in the water sterner et al 2020 zhang et al 2021b several visible algal bloom events were observed during our investigation fig s1a b microcystis spp was identified as the dominant species at the river site fig 1 red stars in the summer of 2018 fig s1c in the summer of 2020 we found that the dominant species in the lake regions of the reservoir fig 1 white circles were aphanizomenon spp and anabaena spp fig s1d e in addition we also used chla concentration to indicate the threshold of algal blooms in florida usa chla concentration above 40 μg l in lakes were defined as algal blooms havens 2003 in xin anjiang reservoir huang et al 2021 believed that chla concentrations greater than 10 μg l were considered as phytoplankton blooms however the chla concentration in their study was measured with the exo2 fluorescence probe which is different from the results measured by spectrophotometry liu and georgakakos 2021b therefore we believe that a chla concentration above 20 μg l is more appropriate as the threshold for algal blooms in xin anjiang reservoir based on our previous studies zhu et al 2022 li et al 2018 2 3 2 defining rainfall period and magnitudes in this study we first calculated the precipitation on three days prior to the sampling day precipitation 3 if precipitation 3 greater than 0 the period was classified as a rain period otherwise it was classified as a non rain period according to the intensity of precipitation 3 we defined rainfall magnitudes of 0 1 9 9 mm 10 24 9 mm 25 49 9 mm and more than 50 mm as light rain moderate rain heavy rain and rainstorms respectively liu et al 2020b in addition we selected all rainfall events above moderate rain daily rainfall 10 mm during the survey period and we defined the day of the rainfall event as rain1 the next day as rain2 and so on furthermore we studied the immediate effect of rainfall by using data from rain 1 3 and data from rain 4 6 were used to study the delayed effect of rainfall 2 3 3 partial least squares pls path model to explore how rainfall events affected chla concentrations in different areas river site and lake site of the reservoir we constructed two partial least squares path models pls pm with the r package plspm in r 4 0 5 software r core team 2020 this method is known as the partial least squares approach for structural equation models sem and supports the estimation of complex cause effect relationships with latent variables sanchez 2013 tenenhaus et al 2005 in addition the latent variables are further linked to the observed variables they represent forming the outer model fernandes et al 2018 path coefficients represent the links among latent variables while the links between latent variables and observed variables are quantified through loading the performance of the models was evaluated using the goodness of fit statistic zhang et al 2021a in this study we believe that the effects of rainfall on algae include reduced temperature and light increased discharge and increased nutrient input then we further hypothesize that rainfall events directly influence hydrological and meteorological conditions which further affect physical factors and nutrient concentrations ultimately leading to changes in algal biomass hence six latent variables were used in this study rainfall precipitation meteorological factors at and ssh hydrological factors discharge physical factors wt turb ph nutrients tn tp fdom and algal biomass chla the observed variables were selected based on their loadings for latent variables most of which were more than 0 7 fig s2 2 3 4 other statistical analysis linear regression models were used to estimate the relationship among inflow discharge tp and chla the nonparametric kruskal wallis rank test k w test was selected since the dataset could not pass both the shapiro test and bartlett test to analyze the differences in tp and chla between the rain and non rain periods considering different rainfall magnitudes kriging interpolation was used to analyse the spatial distribution of chla concentration in the reservoir li et al 2022c statistical metrics including mean values standard deviations linear regression results k w test results and kriging interpolation results were obtained using r 4 0 5 software r core team 2020 the results of the significance test were considered significant at p 0 05 in addition the spatial mapping of sampling sites was performed using arcgis 10 2 software 3 results 3 1 comparison of physicochemical factors in rain and non rain periods inflow discharge was rapidly influenced by rainfall in the xin anjiang reservoir fig 2 a and a significant linear relationship was observed between discharge and precipitation r2 0 33 p 0 001 fig s3 the total precipitation varied substantially interannually in the summers june to august of 2018 2019 and 2020 reaching 342 706 and 1064 mm respectively compared with those in the non rain period at wt and ssh decreased significantly during the rain 1 3 period and recovered during the rain 4 6 period while the opposite trend was observed for discharge and turb fig 2b c fig s4 in addition nutrients such as tn tdn tp and tdp concentrations increased during the rain 1 3 period and decreased during the rain 4 6 period however these levels were still higher than those in the non rain period at both the river site and the lake site fig 2d table s1 3 2 comparison of chla concentrations in rain and non rain periods at the river site the chla concentration decreased in rain 1 3 and then increased in rain 4 6 and was higher than that in the non rain period p 0 01 fig 3 a at the lake site the chla concentrations in the rain 1 3 and rain 4 6 periods were higher than those in the non rain periods p 0 05 fig 3a this indicated that the immediate effects of rainfall on chla concentration at the river site and lake site are different but the delayed effects are the same fig 3b shows a comparison of the chla concentrations at different rainfall magnitudes we found that the chla concentration decreased with a mean standard deviation of 17 8 9 7 17 2 7 9 14 1 8 9 6 7 4 5 and 6 5 4 4 μg l with increasing rainfall magnitude at the river site p 0 01 fig 3b unlike that at the river site the chla concentration at the lake site tended to increase with a mean standard deviation of 15 4 4 6 13 2 5 2 16 1 7 6 and 25 4 1 7 μg l when rainfall events were classified below the rainstorm level rainfall 50 mm but a decrease was observed for rainstorms 13 6 5 2 μg l p 0 05 fig 3b 3 3 response of algae to environment factors rainfall events affected algal biomass in different paths at the river site and lake site from the pls pm model results fig 4 at the river site rainfall events can have a positive significant effect on hydrological factors i e discharge which then suppress algal biomass path coefficients 0 67 and 0 39 respectively fig 4a fig s5c in addition rainfall events can also suppress algal biomass in river site by affecting physical factors e g wt turb and ph fig 4a at the lake site rainfall events first increase nutrient through increasing discharge path coefficients 0 52 fig s5b then we found that nutrient had a positive effect on algae biomass path coefficients 0 79 fig 4b similar to the pls pm model a significant positive linear relationship was found between the tp concentration and chla concentration at the lake site during the rainfall period while there was no significant correlation between them at the river site fig s5e f in summary rainfall events can have a negative effect on algal growth at river site in the short term while have positive effect at lake site 3 4 spatial distribution of chla concentrations before and after rainfall the mean standard deviation values of chla in the whole reservoir from may to august 2020 were 9 0 7 2 9 6 6 6 18 8 6 0 and 11 5 5 6 μg l respectively in addition the spatial distribution of chla was different in each month fig 5 according to our definition of algal blooms in xin anjiang reservoir the northwest tributary has the highest risk of algal blooms in may the central lake is more prone to algal blooms in june and august in july chla concentrations were higher than 20 μg l in almost the entire reservoir including in the central lake and downstream lake regions this indicates that the whole reservoir is at risk of algal blooms fig 5 4 discussion in this study we found that rainfall surprisingly has different immediate effects on algae at the river site and the lake site through high frequency surveys and path analysis in addition a high resolution investigation observed a lake wide algal bloom risk after consecutive rainstorm events which to our knowledge is the first time this risk has been reported in xin anjiang reservoir this paper focused on the mechanism of algal blooms in large and oligotrophic reservoirs 4 1 mechanisms of differential response of algae to rainfall in river and lake sites our results showed that rainfall events immediately decreased the chla concentration at the river site fig 3a at the lake site the immediate effect of rainfall was an increase in the chla concentration fig 3a the pls pm model indicated that high discharge high turbidity and low water temperature associated with rainfall events fig 2b c fig s4c had a direct negative effect on the chla concentration at the river site fig 4a previous studies have noted that factors such as low temperatures limited sunlight luo et al 2022 stockwell et al 2020 and high flushing rates havens et al 2019 tang et al 2021 after rainfall events can reduce algal biomass which shared similar conclusion with our study at the river site at the lake site the increase in discharge had no direct effect on the chla concentration there are several possible reasons for this phenomenon first compared with that at the river site the water depth at lake site is greater with an average water depth of 20 m and 45 m respectively fig 1 and the hydrodynamic conditions are weaker leading to more stable thermal satisfaction and mitigating the impact of rainfall events liu et al 2020b second due to the long and narrow channel of xin anjiang reservoir suspended particulate matter transported by runoff from rainfall events especially when rainfall magnitude is low has little effect on turbidity in the open water area of the reservoir because of the high sedimentation effect table s1 finally previous studies reported that heavy rainfall events will increase the vertical turbidity in the riverine zone however in transitional and lacustrine zones rainfall events increase the turbidity of the middle layer approximately 20 30 m but have little effect on the surface layer liu et al 2020b zhang et al 2021b in summary algal growth in the river regions is more sensitive to the hydrodynamic conditions after rainfall events compared with that in the lake regions in xin anjiang reservoir fig s5c d mainly due to the differences in water depth and hydrological characteristics such as the inflow rate and thermal stratification between the two regions at the lake site of the reservoir inflow discharge indirectly increased the chla concentration by increasing tp concentration fig 4b recent studies have demonstrated that algae in deep water lakes are more sensitive to phosphorus limitation than are algae in shallow lakes qin et al 2020 zou et al 2022 xin anjiang reservoir is a deep and oligotrophic lake and algal growth is also affected by phosphorus concentrations in the transitional and lacustrine zones wang 2020 therefore nutrients especially phosphorus transported from upstream and watersheds during rainfall events promoted algal growth in lake regions this is mainly due to hydrodynamic factor e g discharge and physical factors e g turb has limited impacts on algae fig 4b our results also highlight that the chla concentration decreased with increasing rainfall magnitude at the river site fig 3b at the lake site the chla concentration increased with increasing rainfall magnitude for events below the rainstorm level three day cumulative rainfall 50 mm with a decrease observed during rainstorms fig 3b the results suggest that chla concentrations in lake regions are affected when the rainfall magnitude is sufficiently high remote sensing studies have indicated that river plumes carry suspended matter to xin anjiang reservoir after rainfall events and plume areas are positively correlated with previous rainfall amounts zhang et al 2020 compared to that for low intensity rainfall events runoff from rainstorm events is faster carries more suspended matter and affects a wider area shi et al 2020 when rainstorms occur algal growth at the lake site is limited by changes in the flow rate and turbidity fig 3b as at the river site rainfall and the associated changes in meteorological and hydrological conditions e g wt ssh discharge and turb tend to suppress algal blooms in lakes and reservoirs in the short term within 3 days havens et al 2019 luo et al 2022 our results indicated that rainfall could reduce the algal biomass in the river regions of xin anjiang reservoir and the inhibitory effect became more obvious with increasing rainfall magnitude additionally we found that moderate rainfall events increased the algal biomass but rainstorm events also inhibited algal biomass in the lake regions of xin anjiang reservoir it is not difficult to predict that the water regions downstream will be affected when the rainfall magnitude is high or heavy rainfall events occur leading to increased velocity turbidity and nutrient inputs 4 2 delayed effect of rainstorms on algal blooms and the corresponding mechanisms rainfall events often have a delayed effect on algal blooms in reservoirs chen et al 2018 zhang et al 2021b this phenomenon was also found in this study at both river site and lake site fig 3a on the one hand although the nutrients phosphorus in the rain 4 6 periods were lower than those in the rain 1 3 periods but they were still higher than those in non rain periods fig 2d in addition meteorological e g ssh hydrological e g discharge and physical e g wt turb conditions during rain 4 6 periods were more suitable for algal growth compared to those during rain 1 3 periods fig 2b c fig s4 on the other hand a significant linear correlation was observed between tp and chla concentrations at both the river site r2 0 43 p 0 001 fig s5e and the lake site r2 0 26 p 0 05 fig s5f during the non rain period this indicated that algal biomass in both river regions and lake regions are p limited during non rain periods nutrient inputs combined with suitable environmental conditions cause delayed promoting effects of rainfall on algae previous studies li et al 2022c li et al 2018 reported that the chla concentration in the riverine zone was higher than that in the lacustrine zone in the xin anjiang reservoir and algal blooms tended to occur in the riverine zone huang et al 2021 as observed in our survey in may fig 4 however we found a significant increase in algal biomass and a high risk of algal blooms in almost the whole reservoir at the end of july 2020 fig 5 a record breaking continuous rainstorm events occurred in the xin anjiang reservoir area from june 18 to july 10 2020 fig 2a we believe that rainstorm events trigger algal blooms in the lake regions of the reservoir mainly through the following processes first storm runoff greatly increased the external input of nutrients however the nutrient composition especially phosphorus during rainstorm floods mainly involves particulate forms which are more difficult for algae to use directly than dissolved nutrient budai and clement 2007 kelly et al 2019 some studies have indicated that phytoplankton can tap the organic nutrient pool through a number of mechanisms including direct uptake enzymatic hydrolysis mixotrophy and through symbiotic relationships with microbial communities reinl et al 2022 in addition particulate organic matter also plays an important role in nutrient cycling in deep water reservoirs gao et al 2021 these nutrients eventually become important supplies for algae growth through a series of biochemical reactions yu et al 2021 second algae have a delayed response to rainstorm events stockwell et al 2020 as demonstrated by our results algal blooms appeared in the week after continuous rainstorm events fig 5 with suitable environmental conditions e g wt discharge and ssh therefore the greater the rainfall magnitude is the wider areas in the reservoir affected section 4 1 hence lake wide algal blooms may be triggered when the rainfall intensity is sufficiently high coincidentally this phenomenon also occurs in other subtropical lakes and reservoirs in summer continuous monitoring indicated that the synergistic effects of nutrient pulsing elevated water temperatures and increased water column stratification after the passage of cyclones stimulated blooms of the toxic cyanobacteria microcystis spp in lake taihu zhu et al 2014 fuchunjiang reservoir a channel reservoir downstream of xin anjiang reservoir experienced a severe cyanobacterial bloom with an extremely high cell density of 2 3 108 cells l in the summer of 2016 mainly due to extremely dry and hot weather after rainstorm events guo et al 2018 in summary rainstorm events may induce algal blooms in subtropical oligotrophic reservoirs of concern is that the stronger the rainstorm is the larger the region that will be affected and the higher the risk of algal blooms in addition there was no abnormal algal proliferation in august during hot and sunny weather conditions fig 5 this finding suggested that pulsed nutrient input from rainstorm events was the key driver of algal blooms temperature and light are only secondary conditions in the oligotrophic lacustrine zone of the reservoir algae growth is often limited by nutrients especially phosphorus due to the strong sedimentation effect in the lake regions of deep water reservoirs suggesting that rainstorms trigger algal blooms in deep and oligotrophic reservoirs such as xin anjiang reservoir 4 3 implications for management our results indicated that rainstorms were the trigger of abnormal algal proliferation in the lake regions of xin anjiang reservoir previous studies have shown that the frequency of rainstorm events in the xin anjiang reservoir area has increased significantly in the past 60 years liu et al 2020b zhou et al 2020 in the future extreme weather events are predicted to occur more frequently as the global climate changes jeppesen et al 2021 such an increase would result in greater external inputs from rainstorm events leading to a higher probability of algal blooms in oligotrophic reservoirs more attention should be given to the effects of meteorological and hydrological factors such as rainfall events on algal blooms in the xin anjiang reservoir area reasonable land use may reduce the flushing effect of rainstorm events over the large area of the catchment li et al 2022b zhai et al 2014 additionally it is critical to predict algal blooms in oligotrophic reservoirs and a model for predicting bloom risk should be established in situ or online monitoring with fluorescence sensors may help provide early warnings regarding algae blooms induced by storm events carstea et al 2016 catherine et al 2012 besides we should implement some engineering measures in the areas where the model indicates high risk for example ecological floating beds can be placed in reservoir bays to reduce nutrient concentrations tang et al 2022 our results may also provide a reference for the prediction of bloom risk in other subtropical oligotrophic reservoirs 5 conclusion in this study the response of algal biomass to rainfall and the associated mechanisms in oligotrophic reservoirs have been explored based on high resolution and high frequency monitoring the results showed that rainstorm induced nutrient pulsing loading could trigger algal blooms in oligotrophic reservoirs algal blooms are likely to occur more frequently in subtropical oligotrophic reservoirs in response to more frequent extreme weather events this research provides useful information for establishing early warnings and making strategic decisions of algal blooms control for oligotrophic reservoirs credit authorship contribution statement pengcheng shi conceptualization methodology investigation formal analysis writing original draft mengyuan zhu conceptualization methodology writing review editing supervision data curation rifu you investigation writing review editing data curation huiyun li conceptualization methodology writing review editing wei zou conceptualization methodology writing review editing supervision hai xu conceptualization investigation writing review editing man xiao conceptualization methodology writing review editing guangwei zhu conceptualization methodology resources writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was jointly supported by the national natural science foundation of china 41830757 42271080 and the national key research and development project of china 2022yfc3203605 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129711 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
1826,algal blooms occasionally occur in oligotrophic lakes or reservoirs however the mechanisms and conditions that trigger bloom formation remain unclear therefore high frequency every 3 days monitoring and high resolution 100 sites surveying of the algal biomass were performed during the summer of 2018 2020 to explore rainfall effects on algal growth and its associated mechanism in xin anjiang reservoir a large deep and oligotrophic reservoir in the subtropical region of china the results showed that in the short term rainfall inhibited algal growth in the river zone while promoted algal growth in the lake zone path analysis pls pm and correlation analysis revealed that rainfall inhibited algal growth in the river zone by increasing discharge and decreasing light availability turbidity and water temperature while promoted algal growth in the lake zone by increasing the nutrient concentrations especially for phosphorus in addition we found that the stronger the rainfall is the wider regions of the reservoir it impacted monthly observations at 100 sites showed substantial increases in both algal biomass mean chla concentration doubled and nutrients concentrations in almost the whole reservoir after rainstorm events in xin anjiang reservoir indicating that rainstorm induced nutrient pulsing loading could trigger algal blooms in oligotrophic reservoirs in the long term extreme weather events are predicted to occur more frequently as the global climate changes in the future and oligotrophic reservoirs are facing a greater risk of algal blooms keywords harmful algal bloom extreme weather event rainstorm discharge oligotrophic reservoir data availability data will be made available on request 1 introduction phytoplankton are important primary producers and play important roles in material circulation and energy flows in aquatic ecosystems le moal et al 2019 however the excessive proliferation of phytoplankton also known as blooms can lead to a series of ecological and social issues such as reducing dissolved oxygen in water bodies killing aquatic plants and fishes and threatening the drinking water supply huisman et al 2018 xu et al 2021 algal blooms are often defined as algal scum aggregates at the water surface qin et al 2021 in recent decades algal blooms have become a global problem in aquatic environments ho et al 2019 hou et al 2022 it has long been recognized that nutrient enrichment especially nitrogen and phosphorus is the key cause of algal blooms schindler 1974 dillon and rigler 1974 xu et al 2010 generally eutrophic lakes are more likely to be observed with blooms because of their high nutrients level qin et al 2007 quinlan et al 2021 however there is increasing evidence that algal blooms also occur in oligotrophic systems reinl et al 2020 sterner et al 2020 su et al 2019 algal blooms are related to several environmental factors such as nutrients zhou et al 2022 zou et al 2020 light liu et al 2021a temperature donis et al 2021 paerl and huisman 2008 and hydrodynamic conditions li et al 2021a yang et al 2018 zhang et al 2016 in oligotrophic lakes changes in meteorological and hydrological conditions are the main factors that influence algal blooms reinl et al 2021 smucker et al 2021 for example global changes including increased temperature altered precipitation reduced acidification and increased dissolved organic matter loads to lakes provided suitable environmental conditions for cyanobacterial blooms in 28 nutrient poor swedish lakes over a 16 year study period freeman et al 2020 furthermore oligotrophic lakes are more sensitive to nutrient pulses due to the severe nutrient limitations in these lakes rigosi et al 2014 precipitation associated with storms can supply nutrients to lakes via short term runoff events from watersheds stockwell et al 2020 long term monitoring of lake superior indicated that the two largest blooms occurred during years of especially extreme rainfall sterner et al 2020 carpenter et al 2022 therefore rainfall events play a key role in the occurrence of algal blooms in oligotrophic lakes rainfall events can alter nutrient light temperature and hydrodynamic conditions in lakes which are the key determinants of algal growth stockwell et al 2020 in addition the response of algae to rainfall is divided into short term and long term responses suggesting that rainfall events have an immediate effect and a delayed effect on algae a study of xinglinwan reservoir in xiamen city indicated that short term rainfall can limit cyanobacterial blooms luo et al 2022 high frequency measurements in a long and narrow dam reservoir in southeast china during a storm period showed that rainfall had a delayed effect on algal blooms chen et al 2018 the results of these studies suggest that the effects of rainfall on algal blooms are complex on the one hand rainfall can limit algae growth by decreasing water temperature water retention time and light availability liao et al 2021 on the other hand rainfall events provide nutrients or living propagules to the blooms from the watershed however these studies focused on channel reservoirs with short water retention times that are easily impacted by rainfall events and how rainfall events affect algal growth and bloom formation in large and deep reservoirs is still unclear xin anjiang reservoir is a large deep and oligotrophic lake and is an important drinking water resource in the yangtze river delta region in recent years algal blooms have also occurred occasionally in the river mouth of the reservoir huang et al 2021 previous studies have shown that rainstorm floods interrupt algal accumulation by disrupting thermal stratification and reducing the available light in the river regions of xin anjiang reservoir zhang et al 2021b however only the river mouth of the reservoir was monitored and the survey time was during the period of thermal stratification in early spring moreover the situation is complicated in such a large reservoir and there is a lack of research on the effects of rainfall events on algae during the summer rainy season therefore we investigated meteorological and hydrological conditions water quality and algal biomass in a high frequency survey at the upstream river site and downstream lake site in the reservoir and the survey results were combined with those of high resolution lake wide surveys the objectives of this paper were 1 to characterize the response of algae to rainfall events in river and lake regions of the reservoir 2 to elucidate the immediate and delayed effects of rainfall events on algal growth in xin anjiang reservoir and 3 to analyze the mechanism by which rainfall events can induce algal blooms and assess the corresponding management implications in large subtropical and oligotrophic reservoirs 2 materials and methods 2 1 study area xin anjiang reservoir 29 22 29 50 n 118 36 119 14 e located in the western part of zhejiang province fig 1 is the third largest reservoir in china and provides drinking water to more than 10 million people xin anjiang reservoir has a surface area of 580 km2 a basin area of 10 442 km2 a water volume of 17 8 109 m3 and an average water depth of 31 m when the water level is 108 m relative to sea level wu et al 2015 xin anjiang reservoir is in a subtropical monsoon climate area the average annual temperature there is approximately 17 3 c and the average annual rainfall totals 1600 mm li et al 2020 zhou et al 2020 in addition most rainfall events occur between april and july and runoff in the flood season accounts for 65 of the total annual runoff wang et al 2012 there are 25 major rivers which have counted inflow discharge that flow into xin anjiang reservoir the xin anjiang river northwest tributary fig 1 is the most important accounting for approximately 70 of the inflow runoff zhai et al 2014 zhou et al 2016a in addition multiyear nutrient levels in xin anjiang reservoir are low wu et al 2015 li et al 2021b the lake wide annual mean values of total nitrogen and total phosphorus during our survey may 2020 to april 2021 were 0 89 mg l and 22 0 μg l respectively and the lake regions in the reservoir were even lower thus rainfall especially rainstorm events will lead to the transport of large amounts of nutrients and suspended particulate matter spm from upstream river basins into the reservoir during the flood season li et al 2022a wang et al 2012 zhou et al 2016b 2 2 sampling and measurement procedures a total of 521 water samples were collected in this study over two sampling campaigns one subset of 121 samples was taken by high frequency once every 3 days observations at the river site and the lake site of the reservoir in the summers june july and august of 2018 and 2019 fig 1 red stars in this campaign water samples were collected at three depths 1 3 and 5 m below the surface and then mixed thoroughly in a bucket another subset of 400 samples was collected by monthly high resolution 100 sites fig 1 circles observations obtained in the summer june july and august of 2020 and some data from may were added since the sampling time was the last week of each month in this campaign water samples were collected at the depth of the subsurface chlorophyll maxima scm liu et al 2020a first a ysi exo2 7 channel sonde yellow springs inc yellow springs oh usa was used to measure the vertical chlorophyll fluorescence chlf and determine the scm depth then water samples were collected at this depth all water samples were collected by using acid cleaned niskin bottles and kept on ice and in the dark while in the field then the samples were filtered through precombusted gf f filters whatman 0 7 μm to measure the concentrations of total dissolved nitrogen tdn total dissolved phosphorus tdp and chlorophyll a chla the tn tp tdn and tdp concentrations were determined according to standard methods carranzo 2012 the chla concentration was measured using spectrophotometry at wavelengths of 665 nm and 750 nm following extraction with hot 90 ethanol zhu et al 2015 secchi depth sd was measured using a 20 cm diameter secchi disk other physical factors such as water temperature wt turbidity turb ph fluorescent dissolved organic matter fdom and dissolved oxygen do were measured by ysi exo2 7 channel sonde yellow springs inc yellow springs oh usa in addition daily meteorological data namely the average air temperature at total daily precipitation precipitation and sunlight hours ssh were collected from 2018 to 2020 at the chun an meteorological station fig 1 red triangle and were obtained from the china meteorological data sharing service system https data cma cn daily discharge in the xin anjiang river is monitored at two hydrological gauging stations tunxi and yuliang and data were obtained from the taihu basin hydrological information service system https 218 1 102 107 8100 indexwater html 2 3 data analysis 2 3 1 definition of algal blooms definition of algae bloom and the associated biomass have always been challenging isles and pomati 2021 some studies refer to blooms as events when dense algal particles are observed either floating on the surface or suspended in the water sterner et al 2020 zhang et al 2021b several visible algal bloom events were observed during our investigation fig s1a b microcystis spp was identified as the dominant species at the river site fig 1 red stars in the summer of 2018 fig s1c in the summer of 2020 we found that the dominant species in the lake regions of the reservoir fig 1 white circles were aphanizomenon spp and anabaena spp fig s1d e in addition we also used chla concentration to indicate the threshold of algal blooms in florida usa chla concentration above 40 μg l in lakes were defined as algal blooms havens 2003 in xin anjiang reservoir huang et al 2021 believed that chla concentrations greater than 10 μg l were considered as phytoplankton blooms however the chla concentration in their study was measured with the exo2 fluorescence probe which is different from the results measured by spectrophotometry liu and georgakakos 2021b therefore we believe that a chla concentration above 20 μg l is more appropriate as the threshold for algal blooms in xin anjiang reservoir based on our previous studies zhu et al 2022 li et al 2018 2 3 2 defining rainfall period and magnitudes in this study we first calculated the precipitation on three days prior to the sampling day precipitation 3 if precipitation 3 greater than 0 the period was classified as a rain period otherwise it was classified as a non rain period according to the intensity of precipitation 3 we defined rainfall magnitudes of 0 1 9 9 mm 10 24 9 mm 25 49 9 mm and more than 50 mm as light rain moderate rain heavy rain and rainstorms respectively liu et al 2020b in addition we selected all rainfall events above moderate rain daily rainfall 10 mm during the survey period and we defined the day of the rainfall event as rain1 the next day as rain2 and so on furthermore we studied the immediate effect of rainfall by using data from rain 1 3 and data from rain 4 6 were used to study the delayed effect of rainfall 2 3 3 partial least squares pls path model to explore how rainfall events affected chla concentrations in different areas river site and lake site of the reservoir we constructed two partial least squares path models pls pm with the r package plspm in r 4 0 5 software r core team 2020 this method is known as the partial least squares approach for structural equation models sem and supports the estimation of complex cause effect relationships with latent variables sanchez 2013 tenenhaus et al 2005 in addition the latent variables are further linked to the observed variables they represent forming the outer model fernandes et al 2018 path coefficients represent the links among latent variables while the links between latent variables and observed variables are quantified through loading the performance of the models was evaluated using the goodness of fit statistic zhang et al 2021a in this study we believe that the effects of rainfall on algae include reduced temperature and light increased discharge and increased nutrient input then we further hypothesize that rainfall events directly influence hydrological and meteorological conditions which further affect physical factors and nutrient concentrations ultimately leading to changes in algal biomass hence six latent variables were used in this study rainfall precipitation meteorological factors at and ssh hydrological factors discharge physical factors wt turb ph nutrients tn tp fdom and algal biomass chla the observed variables were selected based on their loadings for latent variables most of which were more than 0 7 fig s2 2 3 4 other statistical analysis linear regression models were used to estimate the relationship among inflow discharge tp and chla the nonparametric kruskal wallis rank test k w test was selected since the dataset could not pass both the shapiro test and bartlett test to analyze the differences in tp and chla between the rain and non rain periods considering different rainfall magnitudes kriging interpolation was used to analyse the spatial distribution of chla concentration in the reservoir li et al 2022c statistical metrics including mean values standard deviations linear regression results k w test results and kriging interpolation results were obtained using r 4 0 5 software r core team 2020 the results of the significance test were considered significant at p 0 05 in addition the spatial mapping of sampling sites was performed using arcgis 10 2 software 3 results 3 1 comparison of physicochemical factors in rain and non rain periods inflow discharge was rapidly influenced by rainfall in the xin anjiang reservoir fig 2 a and a significant linear relationship was observed between discharge and precipitation r2 0 33 p 0 001 fig s3 the total precipitation varied substantially interannually in the summers june to august of 2018 2019 and 2020 reaching 342 706 and 1064 mm respectively compared with those in the non rain period at wt and ssh decreased significantly during the rain 1 3 period and recovered during the rain 4 6 period while the opposite trend was observed for discharge and turb fig 2b c fig s4 in addition nutrients such as tn tdn tp and tdp concentrations increased during the rain 1 3 period and decreased during the rain 4 6 period however these levels were still higher than those in the non rain period at both the river site and the lake site fig 2d table s1 3 2 comparison of chla concentrations in rain and non rain periods at the river site the chla concentration decreased in rain 1 3 and then increased in rain 4 6 and was higher than that in the non rain period p 0 01 fig 3 a at the lake site the chla concentrations in the rain 1 3 and rain 4 6 periods were higher than those in the non rain periods p 0 05 fig 3a this indicated that the immediate effects of rainfall on chla concentration at the river site and lake site are different but the delayed effects are the same fig 3b shows a comparison of the chla concentrations at different rainfall magnitudes we found that the chla concentration decreased with a mean standard deviation of 17 8 9 7 17 2 7 9 14 1 8 9 6 7 4 5 and 6 5 4 4 μg l with increasing rainfall magnitude at the river site p 0 01 fig 3b unlike that at the river site the chla concentration at the lake site tended to increase with a mean standard deviation of 15 4 4 6 13 2 5 2 16 1 7 6 and 25 4 1 7 μg l when rainfall events were classified below the rainstorm level rainfall 50 mm but a decrease was observed for rainstorms 13 6 5 2 μg l p 0 05 fig 3b 3 3 response of algae to environment factors rainfall events affected algal biomass in different paths at the river site and lake site from the pls pm model results fig 4 at the river site rainfall events can have a positive significant effect on hydrological factors i e discharge which then suppress algal biomass path coefficients 0 67 and 0 39 respectively fig 4a fig s5c in addition rainfall events can also suppress algal biomass in river site by affecting physical factors e g wt turb and ph fig 4a at the lake site rainfall events first increase nutrient through increasing discharge path coefficients 0 52 fig s5b then we found that nutrient had a positive effect on algae biomass path coefficients 0 79 fig 4b similar to the pls pm model a significant positive linear relationship was found between the tp concentration and chla concentration at the lake site during the rainfall period while there was no significant correlation between them at the river site fig s5e f in summary rainfall events can have a negative effect on algal growth at river site in the short term while have positive effect at lake site 3 4 spatial distribution of chla concentrations before and after rainfall the mean standard deviation values of chla in the whole reservoir from may to august 2020 were 9 0 7 2 9 6 6 6 18 8 6 0 and 11 5 5 6 μg l respectively in addition the spatial distribution of chla was different in each month fig 5 according to our definition of algal blooms in xin anjiang reservoir the northwest tributary has the highest risk of algal blooms in may the central lake is more prone to algal blooms in june and august in july chla concentrations were higher than 20 μg l in almost the entire reservoir including in the central lake and downstream lake regions this indicates that the whole reservoir is at risk of algal blooms fig 5 4 discussion in this study we found that rainfall surprisingly has different immediate effects on algae at the river site and the lake site through high frequency surveys and path analysis in addition a high resolution investigation observed a lake wide algal bloom risk after consecutive rainstorm events which to our knowledge is the first time this risk has been reported in xin anjiang reservoir this paper focused on the mechanism of algal blooms in large and oligotrophic reservoirs 4 1 mechanisms of differential response of algae to rainfall in river and lake sites our results showed that rainfall events immediately decreased the chla concentration at the river site fig 3a at the lake site the immediate effect of rainfall was an increase in the chla concentration fig 3a the pls pm model indicated that high discharge high turbidity and low water temperature associated with rainfall events fig 2b c fig s4c had a direct negative effect on the chla concentration at the river site fig 4a previous studies have noted that factors such as low temperatures limited sunlight luo et al 2022 stockwell et al 2020 and high flushing rates havens et al 2019 tang et al 2021 after rainfall events can reduce algal biomass which shared similar conclusion with our study at the river site at the lake site the increase in discharge had no direct effect on the chla concentration there are several possible reasons for this phenomenon first compared with that at the river site the water depth at lake site is greater with an average water depth of 20 m and 45 m respectively fig 1 and the hydrodynamic conditions are weaker leading to more stable thermal satisfaction and mitigating the impact of rainfall events liu et al 2020b second due to the long and narrow channel of xin anjiang reservoir suspended particulate matter transported by runoff from rainfall events especially when rainfall magnitude is low has little effect on turbidity in the open water area of the reservoir because of the high sedimentation effect table s1 finally previous studies reported that heavy rainfall events will increase the vertical turbidity in the riverine zone however in transitional and lacustrine zones rainfall events increase the turbidity of the middle layer approximately 20 30 m but have little effect on the surface layer liu et al 2020b zhang et al 2021b in summary algal growth in the river regions is more sensitive to the hydrodynamic conditions after rainfall events compared with that in the lake regions in xin anjiang reservoir fig s5c d mainly due to the differences in water depth and hydrological characteristics such as the inflow rate and thermal stratification between the two regions at the lake site of the reservoir inflow discharge indirectly increased the chla concentration by increasing tp concentration fig 4b recent studies have demonstrated that algae in deep water lakes are more sensitive to phosphorus limitation than are algae in shallow lakes qin et al 2020 zou et al 2022 xin anjiang reservoir is a deep and oligotrophic lake and algal growth is also affected by phosphorus concentrations in the transitional and lacustrine zones wang 2020 therefore nutrients especially phosphorus transported from upstream and watersheds during rainfall events promoted algal growth in lake regions this is mainly due to hydrodynamic factor e g discharge and physical factors e g turb has limited impacts on algae fig 4b our results also highlight that the chla concentration decreased with increasing rainfall magnitude at the river site fig 3b at the lake site the chla concentration increased with increasing rainfall magnitude for events below the rainstorm level three day cumulative rainfall 50 mm with a decrease observed during rainstorms fig 3b the results suggest that chla concentrations in lake regions are affected when the rainfall magnitude is sufficiently high remote sensing studies have indicated that river plumes carry suspended matter to xin anjiang reservoir after rainfall events and plume areas are positively correlated with previous rainfall amounts zhang et al 2020 compared to that for low intensity rainfall events runoff from rainstorm events is faster carries more suspended matter and affects a wider area shi et al 2020 when rainstorms occur algal growth at the lake site is limited by changes in the flow rate and turbidity fig 3b as at the river site rainfall and the associated changes in meteorological and hydrological conditions e g wt ssh discharge and turb tend to suppress algal blooms in lakes and reservoirs in the short term within 3 days havens et al 2019 luo et al 2022 our results indicated that rainfall could reduce the algal biomass in the river regions of xin anjiang reservoir and the inhibitory effect became more obvious with increasing rainfall magnitude additionally we found that moderate rainfall events increased the algal biomass but rainstorm events also inhibited algal biomass in the lake regions of xin anjiang reservoir it is not difficult to predict that the water regions downstream will be affected when the rainfall magnitude is high or heavy rainfall events occur leading to increased velocity turbidity and nutrient inputs 4 2 delayed effect of rainstorms on algal blooms and the corresponding mechanisms rainfall events often have a delayed effect on algal blooms in reservoirs chen et al 2018 zhang et al 2021b this phenomenon was also found in this study at both river site and lake site fig 3a on the one hand although the nutrients phosphorus in the rain 4 6 periods were lower than those in the rain 1 3 periods but they were still higher than those in non rain periods fig 2d in addition meteorological e g ssh hydrological e g discharge and physical e g wt turb conditions during rain 4 6 periods were more suitable for algal growth compared to those during rain 1 3 periods fig 2b c fig s4 on the other hand a significant linear correlation was observed between tp and chla concentrations at both the river site r2 0 43 p 0 001 fig s5e and the lake site r2 0 26 p 0 05 fig s5f during the non rain period this indicated that algal biomass in both river regions and lake regions are p limited during non rain periods nutrient inputs combined with suitable environmental conditions cause delayed promoting effects of rainfall on algae previous studies li et al 2022c li et al 2018 reported that the chla concentration in the riverine zone was higher than that in the lacustrine zone in the xin anjiang reservoir and algal blooms tended to occur in the riverine zone huang et al 2021 as observed in our survey in may fig 4 however we found a significant increase in algal biomass and a high risk of algal blooms in almost the whole reservoir at the end of july 2020 fig 5 a record breaking continuous rainstorm events occurred in the xin anjiang reservoir area from june 18 to july 10 2020 fig 2a we believe that rainstorm events trigger algal blooms in the lake regions of the reservoir mainly through the following processes first storm runoff greatly increased the external input of nutrients however the nutrient composition especially phosphorus during rainstorm floods mainly involves particulate forms which are more difficult for algae to use directly than dissolved nutrient budai and clement 2007 kelly et al 2019 some studies have indicated that phytoplankton can tap the organic nutrient pool through a number of mechanisms including direct uptake enzymatic hydrolysis mixotrophy and through symbiotic relationships with microbial communities reinl et al 2022 in addition particulate organic matter also plays an important role in nutrient cycling in deep water reservoirs gao et al 2021 these nutrients eventually become important supplies for algae growth through a series of biochemical reactions yu et al 2021 second algae have a delayed response to rainstorm events stockwell et al 2020 as demonstrated by our results algal blooms appeared in the week after continuous rainstorm events fig 5 with suitable environmental conditions e g wt discharge and ssh therefore the greater the rainfall magnitude is the wider areas in the reservoir affected section 4 1 hence lake wide algal blooms may be triggered when the rainfall intensity is sufficiently high coincidentally this phenomenon also occurs in other subtropical lakes and reservoirs in summer continuous monitoring indicated that the synergistic effects of nutrient pulsing elevated water temperatures and increased water column stratification after the passage of cyclones stimulated blooms of the toxic cyanobacteria microcystis spp in lake taihu zhu et al 2014 fuchunjiang reservoir a channel reservoir downstream of xin anjiang reservoir experienced a severe cyanobacterial bloom with an extremely high cell density of 2 3 108 cells l in the summer of 2016 mainly due to extremely dry and hot weather after rainstorm events guo et al 2018 in summary rainstorm events may induce algal blooms in subtropical oligotrophic reservoirs of concern is that the stronger the rainstorm is the larger the region that will be affected and the higher the risk of algal blooms in addition there was no abnormal algal proliferation in august during hot and sunny weather conditions fig 5 this finding suggested that pulsed nutrient input from rainstorm events was the key driver of algal blooms temperature and light are only secondary conditions in the oligotrophic lacustrine zone of the reservoir algae growth is often limited by nutrients especially phosphorus due to the strong sedimentation effect in the lake regions of deep water reservoirs suggesting that rainstorms trigger algal blooms in deep and oligotrophic reservoirs such as xin anjiang reservoir 4 3 implications for management our results indicated that rainstorms were the trigger of abnormal algal proliferation in the lake regions of xin anjiang reservoir previous studies have shown that the frequency of rainstorm events in the xin anjiang reservoir area has increased significantly in the past 60 years liu et al 2020b zhou et al 2020 in the future extreme weather events are predicted to occur more frequently as the global climate changes jeppesen et al 2021 such an increase would result in greater external inputs from rainstorm events leading to a higher probability of algal blooms in oligotrophic reservoirs more attention should be given to the effects of meteorological and hydrological factors such as rainfall events on algal blooms in the xin anjiang reservoir area reasonable land use may reduce the flushing effect of rainstorm events over the large area of the catchment li et al 2022b zhai et al 2014 additionally it is critical to predict algal blooms in oligotrophic reservoirs and a model for predicting bloom risk should be established in situ or online monitoring with fluorescence sensors may help provide early warnings regarding algae blooms induced by storm events carstea et al 2016 catherine et al 2012 besides we should implement some engineering measures in the areas where the model indicates high risk for example ecological floating beds can be placed in reservoir bays to reduce nutrient concentrations tang et al 2022 our results may also provide a reference for the prediction of bloom risk in other subtropical oligotrophic reservoirs 5 conclusion in this study the response of algal biomass to rainfall and the associated mechanisms in oligotrophic reservoirs have been explored based on high resolution and high frequency monitoring the results showed that rainstorm induced nutrient pulsing loading could trigger algal blooms in oligotrophic reservoirs algal blooms are likely to occur more frequently in subtropical oligotrophic reservoirs in response to more frequent extreme weather events this research provides useful information for establishing early warnings and making strategic decisions of algal blooms control for oligotrophic reservoirs credit authorship contribution statement pengcheng shi conceptualization methodology investigation formal analysis writing original draft mengyuan zhu conceptualization methodology writing review editing supervision data curation rifu you investigation writing review editing data curation huiyun li conceptualization methodology writing review editing wei zou conceptualization methodology writing review editing supervision hai xu conceptualization investigation writing review editing man xiao conceptualization methodology writing review editing guangwei zhu conceptualization methodology resources writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was jointly supported by the national natural science foundation of china 41830757 42271080 and the national key research and development project of china 2022yfc3203605 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129711 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
1827,renewable energy has been rapidly developed and transmitted across provinces to accelerate carbon neutrality in china water has been saved in power receiving regions due to interprovincial renewable energy substitution for water intensive thermal power rst the re utilization of the water saved by rst through various ways is an urgent issue to be addressed to establish the correlation between the saved water and related source reservoir and further utilize the saved water to maximize its incremental benefits a general model framework is proposed to quantify the saved water and reallocate it to cope with emergency events and promote hydropower based reservoir operation the model is applied to an energy water system centered around henan province the incremental benefits and optimal reallocation mode of the saved water have been revealed the results indicate that rst produces an annual water savings of 175 160 million m3 in henan province which contributes to the increase in hydropower generation and emergency water supply ranging from 14 584 gwh to 32 267 gwh and 0 to 1 724 108 m3 respectively under different hydrological scenarios to boost the incremental benefits of water reallocation under rst the source reservoir should concentrate on the emergency water supply in dry years and enhance hydropower generation in wet years conserving the saved water for future use would produce additional 12 771 gwh to 22 324 gwh of hydropower generation in the following year as rst capacity increases from 40 to 320 twh the marginal revenues of hydropower generation and emergency water supply decrease by 75 4 and 40 7 respectively in wet years this indicates that water supply from different sources should be rearranged to maximize total benefits according to the volume of water saved by rst and the marginal revenue characteristics the general framework can be extended to other energy water systems to assess incremental benefits and propose adaptive reservoir operation rules which provides new insights into water management from the perspective of renewable energy substitution keywords renewable energy substitution water saving reallocation emergency water supply incremental benefits data availability data will be made available on request 1 introduction the transition of the energy structure and carbon mitigation strategy have accelerated the rapid development and utilization of renewable energy dominated by wind power and solar photovoltaics in china the data suggest that china s installed capacity of wind and solar power has reached 328 48 gw and 305 99 gw by 2021 respectively accounting for a total of 26 72 of the power generation capacity state statistical bureau 2021 geographically renewable energy is dominantly distributed in northwest china and southwest china while the load centers are generally urban areas with dense population in east china to address the mismatch between resource endowment and load centers abundant renewable energy has been increasingly transmitted across geographical boundaries supported by ultra high voltage transmission lines the large scale transmission and substitution of renewable energy have changed the energy structures in eastern power receiving provinces of china such as henan shandong and hebei where thermal power dominates the power structure due to its low cost established technology and stable output performance however thermal power dependent on coal is water intensive in the lifecycle it is estimated that the water consumption intensity of coal fired power is approximately 1 36 l kwh 4 43 l kwh feng et al 2014 macknick et al 2012 zhang et al 2018 therefore renewable energy substitution for thermal power rst creates indirect benefits of water savings and regional water demand decreases accordingly such an impact of interregional energy transmission and substitution on water resources has been investigated across different geographical boundaries he et al 2019a xi et al 2021 zhang et al 2021 based on the concept of virtual water allan 1993 the majority of studies quantify the virtual water embedded in power transmission by the life cycle assessment method and input output model concluding that interregional energy transmission accelerates virtual water flow and changes water resource distribution among regions in particular increasing virtual water outflow and aggravating water scarcity caused by power export in northwest china have been widely acknowledged gao et al 2019a zhang et al 2017 zhu et al 2020 however from the national perspective the virtual water flow induced by interregional energy transmission exerts positive effects on national water stress mitigation guo et al 2016 jin et al 2021 and realizes nationwide water conservation liao et al 2019 this is because advanced technology and reasonable geographical layout of power plants are adopted in power exporting regions resulting in lower water consumption intensity for power generation zhu et al 2015 the conclusions have provided insight into the sustainable management of regional water resources however research has focused on coal fired power transmission and neglected the positive effects of renewable energy in comparison the water consumption intensities for wind power and solar photovoltaics are only 0 01 m3 mwh pate et al 2007 which is almost negligible therefore considerable co benefits of water conservation can be generated by rst for example johst and rothstein 2014 estimated a 70 reduction in water consumption in power generation due to rst in germany by 2050 li et al 2017 found that renewable energy penetration would contribute 0 60 0 78 gt of national water savings in china from 2015 to 2030 cui et al 2020 systematically revealed that rst would produce significant water saving benefits by imposing restrictions on renewable energy curtailment despite a preliminary exploration regarding water conservation of renewable energy penetration there has been little discussion about reallocation of the saved water through associated water conservancy projects for maximizing incremental benefits from the perspective of water availability in china changes in hydrological conditions and population growth have caused water shortages and imposed increasing vulnerability on the water supply system rossi and cancelliere 2013 much more attention should be given to coping with high frequency emergency water demand to avoid serious economic losses and negative effects on human welfare gao et al 2019b relying on large capacity and high flexibility emergency water demand can be efficiently satisfied by water allocation of reservoirs and water diversion projects for example to prevent the rapid shrinkage of baiyang lake 257 6 million m3 of water was urgently diverted from the lower reaches of the yellow river to replenish it in 2007 in the spring of 2011 multiple upstream reservoirs of the yangtze river supplied emergency water through joint dispatching to ensure crop irrigation of 7 46 million acres and the survival of 3 29 million people in the lower reaches jin et al 2013 in recent decades extensive research has been conducted on reservoir water allocation to address emergency water issues chae et al 2022 choi et al 2020 gao et al 2016 yang et al 2021 the usual approach is to build a water allocation optimization model considering multiple objectives and realize pareto optimality through metaheuristic algorithms lai et al 2022 or obtain satisfactory schemes from multicriteria decision methods gebre et al 2021 for instance xu et al 2016 proposed a two layer dynamic optimization model to optimize emergency water transfer during severe drought which solves the time and space conflict of water resource reallocation vanda et al 2021 established a four objective optimization model reflecting the interests of multiple sectors to obtain an optimal emergency operation strategy under sudden pollution injection into the river wang et al 2021 introduced perceived satisfaction into the decision framework to promote the efficiency and fairness of transboundary emergency water allocation the results showed that water reallocation to meet emergency demand may cause losses in original benefits the losses will be further exacerbated in dry inflow conditions however water savings induced by rst and its reallocation provide an opportunity to address this problem therefore a novel optimization framework based on reservoir operation model is constructed to adaptively reallocate water savings and provide new solutions for ensuring the emergency water supply advanced reservoir operation rules will be derived to enhance the flexibility of the source reservoir and to improve hydropower generation the rest of the paper is organized as follows section 2 describes the approaches to quantify water saved from rst and the optimization model of adaptive reservoir operation as well as the solution method the model is applied to a case study in section 3 and the results are presented in detail in section 4 section 5 discusses the main results finally the conclusions are drawn in section 6 2 methods this study aims to evaluate the impact of rst on water resources in power receiving regions and the response mechanism of corresponding water conservancy projects thereby maximizing the synergetic benefits of alleviating emergency water deficits and promoting hydropower as shown in fig 1 a general model framework is proposed to incorporate the quantification of the water saved by rst into a reservoir operation model to realize optimal water saving reallocation which is solved by nondominated sorting genetic algorithm ii nsga ii based on the optimal solutions marginal revenue characteristics of water reallocation with the increasing renewable substitution will be obtained new insights into improving regional water management will also be proposed 2 1 water consumption reduction in power receiving region and the saved water that can be reallocated by the source reservoir when thermal power is substituted by renewable energy the water consumed for thermal power generation can be saved in power receiving region the saved water can be conserved and reallocated by the source reservoir the reduction in water consumption in power receiving provinces can be estimated by eq 1 1 w k t r ω k t k t where w k t r is the reduction of water consumption in power receiving province k during time t m3 ω k indicates the average water consumption intensity of thermal power generation in power receiving province k m3 mwh t k t represents the imported renewable energy during time t mwh assuming a linear relationship between the saved water that can be reallocated by the source reservoir and w k t r the former can be estimated by eq 2 2 w t s γ k w k t r where w t s is the saved water that can be reallocated by the source reservoir after rst during time t m3 γ k represents the slope coefficient which is set as 1 0 in the model 2 2 optimal reallocation model of water conserved by rst the reservoir benefits will be enhanced when additional water is preserved and further reallocated by the reservoir however original operation rules are usually designed based on historical runoff and invariable water demands which lacks adaptation to promote the incremental benefits of water saving reallocation under rst scenarios this means that the potential value of the saved water is underutilized under original operation mode furthermore the encounter of emergency water demand and extreme climate may aggravate the conflict among multiple objectives under original operation mode therefore it is necessary to adaptively reallocate the saved water to cope with emergency events meanwhile water saving reallocation will also change the water levels and releases of the source reservoir increased discharge of the hydropower station and raised hydraulic head will contribute to incremental hydropower benefits thus this optimization model is established to maximize the incremental benefits of the emergency water supply as well as to promote hydropower generation the optimal reallocation model of the saved water is designed as follows objective 1 to maximize the incremental hydropower generation 3 m a x δ e t 1 t η t q t e n e w h t n e w δ t 3600 e 4 q t e n e w min q t e q t s l q max e where δ e represents the incremental hydropower generation that results from the rise in reservoir water level or increasing discharge kwh t is the number of operation intervals η t refers to the power coefficient of the hydropower station during time t q t e n e w is the updated discharge of the hydropower station under rst scenarios during time t m3 s h t new is the updated hydraulic head with additional water conserved in the reservoir during time t m δ t is the duration of the time step s e represents the total hydropower generation under original reservoir operation mode kwh q t e represents the discharge through the hydropower station under original reservoir operation mode during time t m3 s q t s l represents the increasing release to the lower reaches during time t m3 s which is a portion of the saved water q max e represents the maximum discharge for power generation of the hydropower station m3 s objective 2 to maximize the incremental emergency water supply 5 m a x δ s t 1 t δ s t 6 δ s t min q t s l δ t s t l min q t s o δ t s t o where δ s represents the total reduction volume of emergency water shortage after the reallocation of water saving m3 which is the sum of increasing emergency water supply δ s t at each time t q t s l and q t s o are the increasing release to the lower reaches and outside the basin during time t respectively m3 s s t l and s t o are emergency water shortage in the lower reaches and outside the basin under original reservoir operation mode during time t m3 q t s l and q t s o have the same priority in the model generally q t s o does not flow through the hydropower station and generates no hydropower constraint 1 water budget equation of the water saving reallocation 7 v t s v t 1 s q t s q t s l q t s o δ t 8 q t s w t s δ t where v t s is the total volume of additional water conserved in the reservoir at the end of time t m3 q t s is the average flow of water savings during time t m3 s constraint 2 reservoir water level 9 z min t z t z max t 10 z t f v t v t s where z t represents the reservoir water level at the end of time t m z min t and z max t are the minimum and maximum allowable water levels of the reservoir during time t respectively m f represents the relationship between the reservoir water level and storage capacity v t represents the reservoir storage under original operation mode at the end of time t m3 constraint 3 reservoir outflow 11 q min t l q t l q max t l where q t l is the total reservoir release to the lower reaches during time t m3 s q min t l and q max t l represent the minimum and maximum allowable outflow to the lower reaches of the reservoir during time t respectively m3 s decision variables according to the mathematical representation of this model the two objectives are determined by increasing water release to the lower reaches q t s l t 1 2 t and increasing water diversion outside the basin q t s o t 1 2 t 2 3 model solution in this paper nsga ii is performed by genetic algorithm toolbox named geatpy in python to search for the optimal model solution available at https github com geatpy dev geatpy nsga ii is a high performance evolutionary algorithm used to solve multi objective optimization problems deb et al 2002 and has been widely used in research on water resource allocation alizadeh et al 2017 chakraei et al 2021 and reservoir operation he et al 2020 jin et al 2019 because the benefit of water saving reallocation is an increment relative to the original operation of the source reservoir the performance of the original operation should be firstly quantified as the benchmark generally the reservoir keeps its optimal dispatching mode in response to diverse objectives even if the utilization of water saving induced by rst is not considered thus the optimal original operation i e without reallocation of the saved water of the source reservoir should also be simulated based on the original reservoir operation process the reallocation of the saved water can be optimized to obtain the pareto fronts more specifically all variables e g original release to the lower reaches water diversion outside the basin etc derived from the optimization result of the original reservoir operation will be used as the input parameters of the optimal reallocation model in section 2 2 the coordinates e i s i of each solution on the pareto front can be transformed into n e i n s i through normalization as calculated by eqs 12 and 13 thus the point with coordinates 1 1 represents the ideal solution that maximizes the values of both objectives which is often impossible to achieve due to the competition for resources between the two objectives in this paper the euclidean distance between the real solution and the ideal point d i estimated by eq 14 is supposed to represent the possibility of reaching the ideal compromise of the two objectives the closer to the ideal point the easier it is for the solution to reach the best compromise therefore the solution with minimum d i is selected as the best compromise solution 12 n e i e i e min e max e min 13 n s i s i s min s max s min 14 d i n e i 1 2 n s i 1 2 where n e i and n s i are the normalized values of the two objectives of solution i e i and s i represent the incremental hydropower generation and reduced emergency water shortage of solution i respectively e min and e max represent the minimum and maximum incremental hydropower generation on the pareto front respectively s min and s max represent the minimum and maximum reduced emergency water shortages on the pareto front respectively d i is the euclidean distance between solution i and the ideal point 3 case study 3 1 study area the location map of the study area is shown in fig 2 including the qinghai henan ultra high voltage direct current transmission line qhuhvl the middle route of the south to north water diversion project mrsnwdp and the source danjiangkou djk reservoir of the mrsnwdp qhuhvl is the first ultra high voltage line built in china for the further utilization of renewable energy in qinghai province as well as promoting carbon reduction in thermal power dominated henan province it operated at the end of 2020 with an annual design capacity of 40 billion kwh of clean energy which has produced water saving benefits and reduced the water demand in henan province mrsnwdp is a large scale water conservancy project to mitigate the water shortage in the north china plain mainly transferring water from the source djk reservoir to beijing tianjin hebei and henan water demand reduction in henan province resulted from rst would affect the operation of the mrsnwdp and the source djk reservoir such an energy water system is taken as the case study in this work 3 2 data the monthly transmission capacity of clean energy depends on the output characteristics of wind and solar energy on the power generation side in this paper the output processes are generated by the data of the representative wind and photovoltaic power plants in gonghe county qinghai province according to the installed capacity and annual utilization hours the designed annual power transmission of the qhuhvl is then distributed monthly with coal as the main fuel water consumption in the whole process of thermal power generation includes cooling water consumption of the generator sets and water consumption in the process of coal production the water consumption induced by coal production is estimated to be 0 379 l kwh ou et al 2016 it should be noted that the water consumption for different types of cooling technologies varies significantly within the range of 1 36 l kwh to 4 43 l kwh feng et al 2014 macknick et al 2012 zhang et al 2018 as closed loop cooling systems are widely used in henan province the water consumption intensity in power generation is set to 4 l kwh therefore the water consumption intensity of the thermal power is finally determined to be 4 379 l kwh in henan province the design parameters of the djk reservoir are listed in table 1 the entire operation period is one year with one month as an operation step in the model the daily measured inflow in 1979 2009 collected from the hydrology and water resources bureau of hubei province available at https 113 57 190 228 8001 web report bigmskreport is integrated into monthly data as shown in fig 3 a the data of normal and emergency water demand are shown in table 2 there are generally three types of emergency water supply in the djk reservoir including two types of emergency water supply to the lower reaches i e goal 1 and goal 2 and one type of emergency water supply outside the basin i e goal 3 to the mrsnwdp 3 3 scenario setting to identify the impact of the runoff conditions and initial reservoir water level on the incremental benefits five representative scenarios are considered as follows the reservoir inflow sequences under different typical years are shown in fig 3b e s1 dry year cumulative frequency of 75 with an initial reservoir water level of 170 m s2 extreme dry year cumulative frequency of 95 with an initial reservoir water level of 160 m s3 dry year with an initial reservoir water level of 160 m s4 normal year cumulative frequency of 50 with an initial reservoir water level of 160 m s5 wet year cumulative frequency of 25 with an initial reservoir water level of 160 m 4 results 4 1 the saved water that can be reallocated by the source reservoir under rst table 3 shows the monthly renewable energy substitution capacity in henan province and the water that can be preserved in the source reservoir an annual 175 160 million m3 of water would be saved by rst and further reallocated by the djk reservoir 4 2 incremental benefits of emergency water supply and hydropower generation the original operation of the djk reservoir taking into account the hydropower generation normal water supply and emergency water supply is optimally performed based on existing operation rules the results showed that increasing hydropower generation is accompanied by a severe shortage of emergency water supply with a high initial water level in s1 and abundant inflow in s4 and s5 the guaranteed rate of normal water supply reaches 90 the emergency water shortage ranges from 0 to 0 376 billion m3 and can be completely satisfied at the expense of few hydropower benefits however significant competition exists among the three objectives due to deficient inflow and initial storage under s2 and s3 the emergency water shortage becomes sensitive to hydropower generation and the guaranteed rate of normal water supply decreases considerably especially under s2 the existing irreconcilable contradiction indicated that the reservoir should store in advance and reallocate the water saved by rst to alleviate water conflicts through adaptive regulation the optimization results of original reservoir operation with the largest emergency water shortage are selected as the benchmark according to which the water level processes at the djk reservoir are obtained under different scenarios as illustrated in fig 4 based on this the reallocation of the saved water is optimized and the results are indicated in fig 5 the pareto fronts of the optimal reallocation model consist of 500 feasible solutions that are distributed well in the solution spaces for each scenario showing that the maximum emergency water supply increment of 172 million m3 occurs in s3 and the maximum hydropower generation increment of 32 267 gwh occurs in s1 it is obvious that the saved water can create the benefits of hydropower generation as well as emergency water supply compared with the original operation however trade offs still exist between the two objectives and the intensities of competition are distinct among the five scenarios due to the abrupt turn of the pareto fronts under s2 s3 and s4 the pareto front is fitted formulaically by dividing it into segments ab and bc with the increase in hydropower generation the emergency water shortage is aggravated with a constant of 7 569 m3 kwh under s1 which makes it clear that the degree of competition between the two objectives is invariable similarly the pareto front under s5 is a nearly straight line however with a larger slope of 123 90 m3 kwh for the pareto fronts under s2 s3 and s4 when the hydropower generation increment increases from 15 937 gwh to 26 102 gwh 17 364 gwh to 28 174 gwh and 15 267 gwh to 20 759 gwh respectively the emergency water shortage reduction decreases with constants 7 678 m3 kwh 7 575 m3 kwh and 7 537 m3 kwh respectively almost the same as that under s1 however as the hydropower generation increment exceeds 26 102 gwh 28 174 gwh and 20 759 gwh the emergency water shortage reduction decreases sharply at rates of 50 13 m3 kwh 27 37 m3 kwh and 102 80 m3 kwh under s2 s3 and s4 respectively the sharp drop in the pareto fronts indicates that the emergency water supply becomes extremely sensitive to hydropower generation increments the principal reason is that the increase in hydropower generation in segment ab directly results from the decrease in the emergency water supply for the mrsnwdp however the increment in segment bc is mainly generated by optimizing the discharge sequences of the hydropower station which leads to a more severe emergency water shortage the synergy of the two objectives will be difficult to achieve by choosing feasible solutions in segment bc furthermore compared with the water consumption intensity of hydropower generation in original reservoir operation 6 219 m3 kwh to 6 868 m3 kwh it appears to be more beneficial that the saved water should be inclined to ensure the emergency water supply thus solutions with the smallest emergency water shortage i e es in fig 5 are adopted as an example to elaborate the generation mechanism of incremental benefits reallocation of the saved water promotes each single emergency water supply goal and further enhances the average guaranteed rate as illustrated in fig 6 under original reservoir operation goals 1 and 2 can be fully satisfied in s1 with a high initial water level and in s4 and s5 with sufficient inflow with deficient inflow the guaranteed rate of goal 2 decreases to 17 38 under s3 and all the goals fail to be met under s2 causing an average guaranteed rate of merely 22 20 additionally goal 3 which occurred in december is ignored with a low guaranteed rate ranging from 0 to 2 33 among the different scenarios the results show severe emergency water shortages under original operation the volumes of emergency water shortages over the entire operation period under different scenarios are listed in table 4 in total with optimal reallocation of the saved water under rst the net increments of the emergency water supply under the five scenarios are 1 139 108 m3 1 711 108 m3 1 724 108 m3 0 515 108 m3 and 0 445 108 m3 it is obvious that the benefits of the emergency water supply are relatively large in the first three scenarios and almost all the saved water is used to meet the emergency water demand under s2 and s3 this is because the reservoir can maintain a lower water level throughout the whole operation period under scenarios with dry inflow and low initial water level as illustrated in fig 4 which provides adequate storage capacity for preserving additional water consequently additional water is stored in the djk reservoir with low flood risk to meet future emergency water demand whenever necessary this contributes to an increasing average guaranteed rate of 11 12 and 11 60 under s2 and s3 respectively the results also indicate that with the accumulation of water savings the guaranteed rates of the three goals increase successively however despite a dry inflow under s1 the reservoir almost reaches the warning water level in the summer flood season due to the high initial water level that is a portion of the saved water would be forced to discharge rather than be preserved in the reservoir thus when emergency water demand occurs in december only the remaining 1 139 108 m3 of the saved water can be discharged to meet it and the corresponding average guaranteed rate is increased by merely 10 10 analogously the reservoir water level reaches the limited water level in the flood season under original operation due to abundant inflow in s4 and s5 causing an emergency water supply increment of 0 515 108 m3 and 0 445 108 m3 and an increasing average guaranteed rate of only 4 57 and 3 94 respectively the results reveal that the incremental benefits of emergency water supply resulting from rst are more evident in dry and extremely dry years with low initial water levels in addition the time when emergency demand occurs also affects the magnitude of the benefits the later the emergency demand occurs and the longer the reserved buffer time such as goal 3 under s2 and s3 the more obvious the incremental benefits will probably be produced the net increments of hydropower generation under the five scenarios are 17 164 gwh 15 973 gwh 17 364 gwh 15 267 gwh and 14 584 gwh respectively as shown in table 4 equivalent to 0 276 0 329 of the annual average power generation of the djk reservoir the detailed data of the incremental hydropower generation process are illustrated in fig 7 it is evident that the fluctuation of the water level increment presents the characteristics of a valley value in the flood season and double peaks throughout the operation period and the hydropower generation increment shows a falling trend after an initial increase with a peak value in the flood season the results indicate that the hydropower generation benefits enhanced by water reallocation mainly focus on two aspects generally when there is no emergency water demand the saved water will be stored in the reservoir gradually raising the reservoir water level and increasing the hydraulic head to boost hydropower generation in the five different scenarios the average increments of the reservoir water level are 0 095 m 0 051 m 0 064 m 0 019 m and 0 026 m respectively on the other hand the saved water will be discharged in case of emergency water supply or flood control bringing about hydropower generation benefits in particular discharge generally increases in june the period when the emergency water demand occurs in the lower reaches of the han river which creates considerable profits in hydropower generation as shown by the peak of the curves in fig 7b and 7c it should be noted that almost all the saved water is discharged to generate electricity at the end of the operation period among different scenarios however the reservoir should not only reallocate the saved water in one year but also consider the situation encountered between different typical years for multi year regulation the reservoir should store the water if possible instead of discharging it for power generation at the end of a year the continuous accumulation of the saved water in the reservoir would produce cross year cumulative benefits which is easier to achieve under water deficient s2 and s3 according to the simulation results of the reservoir water level 4 3 operating rules of the source reservoir adapting to rst adapting to rst means that the saved water should be reasonably reallocated to alleviate emergency water shortage and promote hydropower generation with a variety of alternatives on the pareto fronts of the optimal reallocation model decision makers can be provided with appropriate reservoir operation rules to promote synergetic benefits therefore three representative solutions are selected on the pareto front to explain how to boost the emergency water supply and hydropower generation including the hydropower generation dominated solution i e hs the solution with the largest hydropower generation increment as indicated by the red dot in fig 5 the emergency water supply dominated solution i e es the solution with the smallest emergency water shortage as indicated by the blue dot in fig 5 and the best compromise solution i e cs the solution that alleviates the competition between the two objectives which is closest to the ideal dot as indicated by the green dot in fig 5 correspondingly the monthly reallocation of the saved water is illustrated in fig 8 the reallocation scheme of the saved water related to hs is inclined to maximize hydropower generation as shown in fig 8a there is no incremental water allocated to the mrsnwdp in december despite the severe insufficiency of goal 3 in addition goals 1 and 2 also fail to be met during the entire operation period more than 90 of the saved water is discharged to the lower reaches of the han river to generate hydropower benefits taking s2 as an example the emergency water shortage is 1 538 billion m3 under original operation however over half of the saved water is stored in the reservoir while neglecting the emergency water demands until the autumn flood season thereafter the saved water reallocated downstream gradually increases until it reaches its maximum in december the reason is that a higher water level comes with more benefits in hydropower generation under the five scenarios there are 15 10 gwh 11 09 gwh 11 75 gwh 5 59 gwh and 0 36 gwh more with respect to hydropower generation increment than that of es respectively in the case of cs among various scenarios the reservoir reaches the best compromise between the objectives of hydropower generation and emergency water supply the normalized euclidean distances between css and the ideal points under the five scenarios are 0 704 0 563 0 619 0 620 and 0 707 respectively which demonstrates that it has the potential to create more considerable synergetic benefits under s2 the water reallocation results related to cs shown in fig 8b indicate that more saved water is reallocated to emergency water demands which is reflected in the increase in emergency water supply in june under s2 and s3 and in december under all scenarios correspondingly the amount of water discharged downstream for hydropower generation decreases at the end of the operation period the water reallocation scheme corresponding to es presented in fig 8c is distinguished from other solutions remarkably by its significant amount of water reallocated to the mrsnwdp in december in such cases the guaranteed rate of emergency water supply has reached the superior limit based on the water reallocation scheme under different scenarios the operation rules of the source reservoir adapting to rst are proposed the general principle is that the source reservoir should decrease the normal water supply to the mrsnwdp and flexibly increase water storage on the premise of ensuring flood control safety faced with different water demands the optimal scheduling strategy varies in different cases in the event of no emergency water demand it is recommended to adopt the operation scheme corresponding to hs in years with deficient inflow and relatively low initial water storage the source reservoir should increase water storage and operate at a high water level to increase the hydraulic head so that the saved water can continuously create hydropower generation benefits in years with abundant inflow or high initial water levels the reservoir should increase the centralized release for hydropower generation before the summer flood season to avoid water abandonment subsequently the water storage should be increased in advance if the inflow is predicted to be deficient in the next year in the case of large emergency water demands the reservoir should prioritize the emergency water supply therefore it is suggested to comply with the operation schemes related to es or cs under which the saved water can produce both hydropower generation benefits and water supply benefits in years with deficient inflow and relatively low initial water storage the source reservoir should discharge the saved water downstream to satisfy the emergency water demand during the summer flood season after the flood season the reservoir could increase water storage across years with low flood risk in years with abundant inflow or high initial water levels downstream emergency water demands can be normally met the reservoir can store additional water during the flood season while a portion of it should be discharged for power generation before the autumn flood season at the end of the flood season the reservoir should begin to increase storage in response to the emergency water demand of the mrsnwdp 5 discussion 5 1 the causes and implications of differences in results among scenarios the reallocation of the saved water under rst alleviates emergency water shortages and generates hydropower benefits however there are significant differences in the results of optimal water reallocation under different scenarios on the one hand more significant benefits generated in dry years are found on the other hand the shape of the pareto front varies in the five scenarios more specifically there is a turning point at the pareto front under s2 s3 and s4 which indicates a change of the trade offs between the two objectives the discrepancy is mainly caused by different inflow conditions and limitation on water levels during flood season the characteristics i e the time and location of each emergency water shortages are also the causes for the above differences in s2 and s3 under original operation the discharge for power generation during the entire operation period is lower than the rated flow q max e due to dry inflow and the water level does not reach the flood limit level the remaining storage capacity at the end of august is 6 39 billion m3 and 0 55 billion m3 respectively under s2 and s3 therefore almost all the water saved by rst can be utilized for power generation or increasing emergency water supply contributing to more significant benefits due to the synergistic benefits in generating hydropower the saved water will be prioritized for emergency goals 1 and 2 as the optimal solution moves along the blue arrow from point a to point b shown in fig 5b and 5c water reallocation for emergency goal 3 is prioritized to decrease as it cannot generate hydropower the increase in hydropower generation in segment ab directly results from the decrease in the emergency water supply for goal 3 in segment bc water reallocation for emergency goal 1 in january or emergency goal 2 in june will be shifted to generate hydropower from october to december generating hydropower as late as possible produces more additional electricity due to the cumulative effect of the hydraulic head this results in a severe decrease in the synergistic benefits of hydropower generation in january or june therefore the decrease in the same volume of emergency water supply generates less hydropower generation increment compared to segment ab which leads to the difference in slope between the two segments under s1 with high initial water level i e 170 m maximum hydropower generation increment of 32 27 gwh will be generated due to the high hydraulic head however approximately 50 million m3 of the saved water has to be discharged in advance before august due to the flood control level restriction under different solutions this caused lower increment of the emergency water supply maximum 113 93 million m3 compared to s2 and s3 moreover the increase in emergency water supply to goal 3 will lead to a direct decrease in hydropower generation causing a continuous nearly linear relationship of the two objectives as shown in fig 5a in s4 and s5 with sufficient inflow a portion of the saved water would even be abandoned during flood season more saved water before the autumn flood 122 21 million m3 in total is unable to be stored in the reservoir to cope with emergency water demand in december this causes lower incremental benefits compared to the other three scenarios furthermore the formation mechanism of ab segment in pareto front under s4 is the same as that under s2 and s3 however after passing point b the hydropower generation is mainly enhanced by raising the hydraulic head and the saved water will be increasingly abandoned despite achieving more hydropower generation the efficiency of hydropower production per unit water decreases a lot the formation mechanism of the entire pareto front of s5 is the same as that of the bc segment under s4 so the slopes of the two are relatively close 123 90 m3 kwh and 102 80 m3 kwh the above discussion reveals the specific causes of differences in various scenarios which also provides novel insights to summarize low flood risk and high α value in dry conditions α is defined as the proportion of annual water savings to annual reservoir inflow such as 1 26 for s2 contribute to more incremental benefits of water reallocation on the contrary in scenarios of abundant inflow with low α value for example 0 39 for s5 since the original operation can meet most of the water demand the additional benefits of water saving reallocation become less significant the shape of the pareto front essentially reflects difference in the utilization efficiency of the saved water among scenarios the abandoned water generated during the flood season significantly reduces the productiveness of water reallocation reallocating the saved water to cope with specific emergency events such as goal1 and goal2 in this paper can generate synergistic benefits in hydropower generation blindly pursuing the maximum hydropower generation may lead to the loss of the aforementioned synergistic benefits 5 2 impact of rst scale expansion on incremental benefits the rapid development of interregional transmission and substitution of clean energy has imposed considerable effects on water resources the economy chen et al 2019 dai et al 2016 social employment kamidelivand et al 2018 and carbon emissions qi et al 2014 the effect on water resources tend to be profound and our research confirms that renewable energy substitution would change regional water demand and produce incremental water co benefits such mutual benefit has been demonstrated by a study conducted in california he et al 2019b which concludes that renewable energy substitution for hydropower alleviates conflict between multiple water sectors and contributes to groundwater recovery to promote carbon neutrality the transmission scale of renewable energy will be further expanded in the coming decades according to the development plan structured by china s national energy administration the installed capacity of clean energy in the energy structure will reach 62 and 12 long distance ultra high voltage transmission lines with a total capacity of 57 gw will be constructed in succession by 2050 with the power receiving region as the core node the large scale electricity network will be closely coupled with associated water supply projects and the source reservoirs generating greater incremental benefits to explore the change of incremental benefits caused by the scale expansion of rst the designed annual transmission capacity of qhuhvl is regarded as one unit of rst the water related marginal revenues are calculated by simulating the water savings reallocation and the results under the es scheme are illustrated in fig 9 under s2 with deficient inflow the marginal revenues of hydropower generation and emergency water supply present a completely opposite trend notably when the substitution scale exceeds 7 units the marginal revenue of the emergency water supply tends to be unchanged however it is accompanied by a decline in the marginal revenue of hydropower generation furthermore it is important to note that the marginal revenue of emergency water supply and hydropower generation both show a downward trend in s5 showing that the water saved in the djk reservoir cannot steadily create incremental benefits therefore to better promote the co benefits of rst decisions should be made cautiously regarding the operation of related water conservancy projects especially in wet years it is recommended that the water supply from different sources should be rearranged according to the volume of the water saved by rst and the marginal revenue characteristics thereby leading to the largest total benefits 5 3 cumulative benefits induced by accumulative water storage in the source reservoir to clarify the inter year cumulative benefit from the saved water a scenario is proposed on condition that the water saved by rst in the previous year is totally stored therefore 350 320 million m3 of the saved water should be optimally reallocated in the next year the benefits under the scheme dominated by the emergency water supply are illustrated in fig 10 compared with the benefits under scenarios without water retained i e benefit a in fig 10a corresponding to the results of optimal reallocation in section 4 2 the cumulative saved water produces an increment green part of the bar in fig 10a i e benefit b plus benefit c of hydropower generation almost twice that of benefit a as shown in fig 10a this means that hydropower generation per unit water has increased the rise in reservoir water level is the main reason for generating inter year cumulative benefits of hydropower generation as shown in fig 11 the reservoir water level increment is much larger before the flood season than that in fig 7 due to water reserved in the previous year the average increments of reservoir water level in the five different scenarios are 0 232 m 0 087 m 0 196 m 0 113 m and 0 108 m respectively which is 1 71 to 5 92 times that under scenarios without water retained in the previous year it is worth mentioning that the peaks of hydropower increment in fig 11b and 11c are actually caused by increasing release to address downstream emergency demand while the peaks of hydropower increment in fig 11a 11d and 11e result from the concentrated release before the flood season as shown in fig 10b the emergency water supply under s2 and s3 doubled and there is little cumulative benefit there is almost no increase in the emergency water supply in the other three scenarios due to restrictions on reservoir storage during flood seasons more specifically under s1 s4 and s5 the water reserved in the previous year is totally released before the flood season making no contribution to the emergency water supply of the mrsnwdp in december which is consistent with the hydropower increment results the results indicate that the accumulation of the saved water among years is beneficial to the operation of the source reservoir especially in dry conditions therefore it is suggested to reserve the saved water in relatively dry scenarios when there is no emergency demand so as to promote cumulative benefits in wet scenarios the low feasibility of storing the saved water spanning flood seasons indicates that the saved water should be reallocated in a timely manner to generate hydropower more accurate multi year scheduling policies should be proposed combining the inflow forecast information and correlation of multi year hydrological conditions hedging theory will be applied in future work to investigate the multi year reallocation of the saved water considering the encounter between scenarios 6 conclusions to investigate the impact of rst on regional water resources and further improve reservoir operation strategies this paper proposed a general framework for calculating the water saved by rst and optimize its reallocation to increase the emergency water supply and hydropower generation then the adaptive operation rules of the source reservoir were proposed based on the quantification of incremental benefits and subsequently analysis and discussion were conducted on marginal revenue and cumulative benefits the proposed method was applied to an energy water system centered on henan province china the core conclusions of this paper are as follows 1 renewable energy penetration reduces the annual water demand by 175 160 million m3 in henan province by adaptively utilize the water savings the source reservoir can create incremental benefits of hydropower generation and emergency water supply ranging from 14 584 gwh to 32 267 gwh and 0 to 1 724 108 m3 respectively under different scenarios 2 both the natural inflow and the initial water level of the source reservoir affect the incremental benefits as the yearly inflow decreases the reservoir creates superior incremental benefits as the initial water level increases the benefit of hydropower generation increases considerably 3 it is suggested that the saved water should concentrate on the emergency water supply in dry years and enhance hydropower generation before the flood season to decrease abandoned water in wet years in addition conserving the saved water among years for future use would produce cumulative benefits under dry conditions 4 given that there is a stable marginal benefit before the substitution scale reaches 320 twh it is profitable to store and reallocate the saved water by the djk reservoir in dry years however in years with abundant streamflow the water supply from multiple sources should be rearranged to maximize total benefits according to the volume of the water saved by rst and the marginal revenue characteristics from the perspective of renewable energy substitution this study extends the profound relationship between water and energy by coupling a power transmission project and a water diversion project providing new insights into regional water management in the context of the rapid development of renewable energy the relevant results have revealed the response mechanism of water reallocation to rst the conclusions can guide the source reservoir in making better use of the saved water through rational utilization of its storage capacity to ensure water sustainability decision makers should systematically consider the impact of rst on water availability and promote the synergetic benefits of water saving utilization through optimal operation of the water conservancy project credit authorship contribution statement chao ma conceptualization investigation methodology resources data curation writing review editing supervision haixing gou investigation methodology software formal analysis writing original draft visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national natural science foundation of china grant numbers 52279021 52079087 and project team key training fund of tianjin grant number xc202044 we extend our sincere gratitude to the editor and the anonymous reviewers for their professional comments and corrections 
1827,renewable energy has been rapidly developed and transmitted across provinces to accelerate carbon neutrality in china water has been saved in power receiving regions due to interprovincial renewable energy substitution for water intensive thermal power rst the re utilization of the water saved by rst through various ways is an urgent issue to be addressed to establish the correlation between the saved water and related source reservoir and further utilize the saved water to maximize its incremental benefits a general model framework is proposed to quantify the saved water and reallocate it to cope with emergency events and promote hydropower based reservoir operation the model is applied to an energy water system centered around henan province the incremental benefits and optimal reallocation mode of the saved water have been revealed the results indicate that rst produces an annual water savings of 175 160 million m3 in henan province which contributes to the increase in hydropower generation and emergency water supply ranging from 14 584 gwh to 32 267 gwh and 0 to 1 724 108 m3 respectively under different hydrological scenarios to boost the incremental benefits of water reallocation under rst the source reservoir should concentrate on the emergency water supply in dry years and enhance hydropower generation in wet years conserving the saved water for future use would produce additional 12 771 gwh to 22 324 gwh of hydropower generation in the following year as rst capacity increases from 40 to 320 twh the marginal revenues of hydropower generation and emergency water supply decrease by 75 4 and 40 7 respectively in wet years this indicates that water supply from different sources should be rearranged to maximize total benefits according to the volume of water saved by rst and the marginal revenue characteristics the general framework can be extended to other energy water systems to assess incremental benefits and propose adaptive reservoir operation rules which provides new insights into water management from the perspective of renewable energy substitution keywords renewable energy substitution water saving reallocation emergency water supply incremental benefits data availability data will be made available on request 1 introduction the transition of the energy structure and carbon mitigation strategy have accelerated the rapid development and utilization of renewable energy dominated by wind power and solar photovoltaics in china the data suggest that china s installed capacity of wind and solar power has reached 328 48 gw and 305 99 gw by 2021 respectively accounting for a total of 26 72 of the power generation capacity state statistical bureau 2021 geographically renewable energy is dominantly distributed in northwest china and southwest china while the load centers are generally urban areas with dense population in east china to address the mismatch between resource endowment and load centers abundant renewable energy has been increasingly transmitted across geographical boundaries supported by ultra high voltage transmission lines the large scale transmission and substitution of renewable energy have changed the energy structures in eastern power receiving provinces of china such as henan shandong and hebei where thermal power dominates the power structure due to its low cost established technology and stable output performance however thermal power dependent on coal is water intensive in the lifecycle it is estimated that the water consumption intensity of coal fired power is approximately 1 36 l kwh 4 43 l kwh feng et al 2014 macknick et al 2012 zhang et al 2018 therefore renewable energy substitution for thermal power rst creates indirect benefits of water savings and regional water demand decreases accordingly such an impact of interregional energy transmission and substitution on water resources has been investigated across different geographical boundaries he et al 2019a xi et al 2021 zhang et al 2021 based on the concept of virtual water allan 1993 the majority of studies quantify the virtual water embedded in power transmission by the life cycle assessment method and input output model concluding that interregional energy transmission accelerates virtual water flow and changes water resource distribution among regions in particular increasing virtual water outflow and aggravating water scarcity caused by power export in northwest china have been widely acknowledged gao et al 2019a zhang et al 2017 zhu et al 2020 however from the national perspective the virtual water flow induced by interregional energy transmission exerts positive effects on national water stress mitigation guo et al 2016 jin et al 2021 and realizes nationwide water conservation liao et al 2019 this is because advanced technology and reasonable geographical layout of power plants are adopted in power exporting regions resulting in lower water consumption intensity for power generation zhu et al 2015 the conclusions have provided insight into the sustainable management of regional water resources however research has focused on coal fired power transmission and neglected the positive effects of renewable energy in comparison the water consumption intensities for wind power and solar photovoltaics are only 0 01 m3 mwh pate et al 2007 which is almost negligible therefore considerable co benefits of water conservation can be generated by rst for example johst and rothstein 2014 estimated a 70 reduction in water consumption in power generation due to rst in germany by 2050 li et al 2017 found that renewable energy penetration would contribute 0 60 0 78 gt of national water savings in china from 2015 to 2030 cui et al 2020 systematically revealed that rst would produce significant water saving benefits by imposing restrictions on renewable energy curtailment despite a preliminary exploration regarding water conservation of renewable energy penetration there has been little discussion about reallocation of the saved water through associated water conservancy projects for maximizing incremental benefits from the perspective of water availability in china changes in hydrological conditions and population growth have caused water shortages and imposed increasing vulnerability on the water supply system rossi and cancelliere 2013 much more attention should be given to coping with high frequency emergency water demand to avoid serious economic losses and negative effects on human welfare gao et al 2019b relying on large capacity and high flexibility emergency water demand can be efficiently satisfied by water allocation of reservoirs and water diversion projects for example to prevent the rapid shrinkage of baiyang lake 257 6 million m3 of water was urgently diverted from the lower reaches of the yellow river to replenish it in 2007 in the spring of 2011 multiple upstream reservoirs of the yangtze river supplied emergency water through joint dispatching to ensure crop irrigation of 7 46 million acres and the survival of 3 29 million people in the lower reaches jin et al 2013 in recent decades extensive research has been conducted on reservoir water allocation to address emergency water issues chae et al 2022 choi et al 2020 gao et al 2016 yang et al 2021 the usual approach is to build a water allocation optimization model considering multiple objectives and realize pareto optimality through metaheuristic algorithms lai et al 2022 or obtain satisfactory schemes from multicriteria decision methods gebre et al 2021 for instance xu et al 2016 proposed a two layer dynamic optimization model to optimize emergency water transfer during severe drought which solves the time and space conflict of water resource reallocation vanda et al 2021 established a four objective optimization model reflecting the interests of multiple sectors to obtain an optimal emergency operation strategy under sudden pollution injection into the river wang et al 2021 introduced perceived satisfaction into the decision framework to promote the efficiency and fairness of transboundary emergency water allocation the results showed that water reallocation to meet emergency demand may cause losses in original benefits the losses will be further exacerbated in dry inflow conditions however water savings induced by rst and its reallocation provide an opportunity to address this problem therefore a novel optimization framework based on reservoir operation model is constructed to adaptively reallocate water savings and provide new solutions for ensuring the emergency water supply advanced reservoir operation rules will be derived to enhance the flexibility of the source reservoir and to improve hydropower generation the rest of the paper is organized as follows section 2 describes the approaches to quantify water saved from rst and the optimization model of adaptive reservoir operation as well as the solution method the model is applied to a case study in section 3 and the results are presented in detail in section 4 section 5 discusses the main results finally the conclusions are drawn in section 6 2 methods this study aims to evaluate the impact of rst on water resources in power receiving regions and the response mechanism of corresponding water conservancy projects thereby maximizing the synergetic benefits of alleviating emergency water deficits and promoting hydropower as shown in fig 1 a general model framework is proposed to incorporate the quantification of the water saved by rst into a reservoir operation model to realize optimal water saving reallocation which is solved by nondominated sorting genetic algorithm ii nsga ii based on the optimal solutions marginal revenue characteristics of water reallocation with the increasing renewable substitution will be obtained new insights into improving regional water management will also be proposed 2 1 water consumption reduction in power receiving region and the saved water that can be reallocated by the source reservoir when thermal power is substituted by renewable energy the water consumed for thermal power generation can be saved in power receiving region the saved water can be conserved and reallocated by the source reservoir the reduction in water consumption in power receiving provinces can be estimated by eq 1 1 w k t r ω k t k t where w k t r is the reduction of water consumption in power receiving province k during time t m3 ω k indicates the average water consumption intensity of thermal power generation in power receiving province k m3 mwh t k t represents the imported renewable energy during time t mwh assuming a linear relationship between the saved water that can be reallocated by the source reservoir and w k t r the former can be estimated by eq 2 2 w t s γ k w k t r where w t s is the saved water that can be reallocated by the source reservoir after rst during time t m3 γ k represents the slope coefficient which is set as 1 0 in the model 2 2 optimal reallocation model of water conserved by rst the reservoir benefits will be enhanced when additional water is preserved and further reallocated by the reservoir however original operation rules are usually designed based on historical runoff and invariable water demands which lacks adaptation to promote the incremental benefits of water saving reallocation under rst scenarios this means that the potential value of the saved water is underutilized under original operation mode furthermore the encounter of emergency water demand and extreme climate may aggravate the conflict among multiple objectives under original operation mode therefore it is necessary to adaptively reallocate the saved water to cope with emergency events meanwhile water saving reallocation will also change the water levels and releases of the source reservoir increased discharge of the hydropower station and raised hydraulic head will contribute to incremental hydropower benefits thus this optimization model is established to maximize the incremental benefits of the emergency water supply as well as to promote hydropower generation the optimal reallocation model of the saved water is designed as follows objective 1 to maximize the incremental hydropower generation 3 m a x δ e t 1 t η t q t e n e w h t n e w δ t 3600 e 4 q t e n e w min q t e q t s l q max e where δ e represents the incremental hydropower generation that results from the rise in reservoir water level or increasing discharge kwh t is the number of operation intervals η t refers to the power coefficient of the hydropower station during time t q t e n e w is the updated discharge of the hydropower station under rst scenarios during time t m3 s h t new is the updated hydraulic head with additional water conserved in the reservoir during time t m δ t is the duration of the time step s e represents the total hydropower generation under original reservoir operation mode kwh q t e represents the discharge through the hydropower station under original reservoir operation mode during time t m3 s q t s l represents the increasing release to the lower reaches during time t m3 s which is a portion of the saved water q max e represents the maximum discharge for power generation of the hydropower station m3 s objective 2 to maximize the incremental emergency water supply 5 m a x δ s t 1 t δ s t 6 δ s t min q t s l δ t s t l min q t s o δ t s t o where δ s represents the total reduction volume of emergency water shortage after the reallocation of water saving m3 which is the sum of increasing emergency water supply δ s t at each time t q t s l and q t s o are the increasing release to the lower reaches and outside the basin during time t respectively m3 s s t l and s t o are emergency water shortage in the lower reaches and outside the basin under original reservoir operation mode during time t m3 q t s l and q t s o have the same priority in the model generally q t s o does not flow through the hydropower station and generates no hydropower constraint 1 water budget equation of the water saving reallocation 7 v t s v t 1 s q t s q t s l q t s o δ t 8 q t s w t s δ t where v t s is the total volume of additional water conserved in the reservoir at the end of time t m3 q t s is the average flow of water savings during time t m3 s constraint 2 reservoir water level 9 z min t z t z max t 10 z t f v t v t s where z t represents the reservoir water level at the end of time t m z min t and z max t are the minimum and maximum allowable water levels of the reservoir during time t respectively m f represents the relationship between the reservoir water level and storage capacity v t represents the reservoir storage under original operation mode at the end of time t m3 constraint 3 reservoir outflow 11 q min t l q t l q max t l where q t l is the total reservoir release to the lower reaches during time t m3 s q min t l and q max t l represent the minimum and maximum allowable outflow to the lower reaches of the reservoir during time t respectively m3 s decision variables according to the mathematical representation of this model the two objectives are determined by increasing water release to the lower reaches q t s l t 1 2 t and increasing water diversion outside the basin q t s o t 1 2 t 2 3 model solution in this paper nsga ii is performed by genetic algorithm toolbox named geatpy in python to search for the optimal model solution available at https github com geatpy dev geatpy nsga ii is a high performance evolutionary algorithm used to solve multi objective optimization problems deb et al 2002 and has been widely used in research on water resource allocation alizadeh et al 2017 chakraei et al 2021 and reservoir operation he et al 2020 jin et al 2019 because the benefit of water saving reallocation is an increment relative to the original operation of the source reservoir the performance of the original operation should be firstly quantified as the benchmark generally the reservoir keeps its optimal dispatching mode in response to diverse objectives even if the utilization of water saving induced by rst is not considered thus the optimal original operation i e without reallocation of the saved water of the source reservoir should also be simulated based on the original reservoir operation process the reallocation of the saved water can be optimized to obtain the pareto fronts more specifically all variables e g original release to the lower reaches water diversion outside the basin etc derived from the optimization result of the original reservoir operation will be used as the input parameters of the optimal reallocation model in section 2 2 the coordinates e i s i of each solution on the pareto front can be transformed into n e i n s i through normalization as calculated by eqs 12 and 13 thus the point with coordinates 1 1 represents the ideal solution that maximizes the values of both objectives which is often impossible to achieve due to the competition for resources between the two objectives in this paper the euclidean distance between the real solution and the ideal point d i estimated by eq 14 is supposed to represent the possibility of reaching the ideal compromise of the two objectives the closer to the ideal point the easier it is for the solution to reach the best compromise therefore the solution with minimum d i is selected as the best compromise solution 12 n e i e i e min e max e min 13 n s i s i s min s max s min 14 d i n e i 1 2 n s i 1 2 where n e i and n s i are the normalized values of the two objectives of solution i e i and s i represent the incremental hydropower generation and reduced emergency water shortage of solution i respectively e min and e max represent the minimum and maximum incremental hydropower generation on the pareto front respectively s min and s max represent the minimum and maximum reduced emergency water shortages on the pareto front respectively d i is the euclidean distance between solution i and the ideal point 3 case study 3 1 study area the location map of the study area is shown in fig 2 including the qinghai henan ultra high voltage direct current transmission line qhuhvl the middle route of the south to north water diversion project mrsnwdp and the source danjiangkou djk reservoir of the mrsnwdp qhuhvl is the first ultra high voltage line built in china for the further utilization of renewable energy in qinghai province as well as promoting carbon reduction in thermal power dominated henan province it operated at the end of 2020 with an annual design capacity of 40 billion kwh of clean energy which has produced water saving benefits and reduced the water demand in henan province mrsnwdp is a large scale water conservancy project to mitigate the water shortage in the north china plain mainly transferring water from the source djk reservoir to beijing tianjin hebei and henan water demand reduction in henan province resulted from rst would affect the operation of the mrsnwdp and the source djk reservoir such an energy water system is taken as the case study in this work 3 2 data the monthly transmission capacity of clean energy depends on the output characteristics of wind and solar energy on the power generation side in this paper the output processes are generated by the data of the representative wind and photovoltaic power plants in gonghe county qinghai province according to the installed capacity and annual utilization hours the designed annual power transmission of the qhuhvl is then distributed monthly with coal as the main fuel water consumption in the whole process of thermal power generation includes cooling water consumption of the generator sets and water consumption in the process of coal production the water consumption induced by coal production is estimated to be 0 379 l kwh ou et al 2016 it should be noted that the water consumption for different types of cooling technologies varies significantly within the range of 1 36 l kwh to 4 43 l kwh feng et al 2014 macknick et al 2012 zhang et al 2018 as closed loop cooling systems are widely used in henan province the water consumption intensity in power generation is set to 4 l kwh therefore the water consumption intensity of the thermal power is finally determined to be 4 379 l kwh in henan province the design parameters of the djk reservoir are listed in table 1 the entire operation period is one year with one month as an operation step in the model the daily measured inflow in 1979 2009 collected from the hydrology and water resources bureau of hubei province available at https 113 57 190 228 8001 web report bigmskreport is integrated into monthly data as shown in fig 3 a the data of normal and emergency water demand are shown in table 2 there are generally three types of emergency water supply in the djk reservoir including two types of emergency water supply to the lower reaches i e goal 1 and goal 2 and one type of emergency water supply outside the basin i e goal 3 to the mrsnwdp 3 3 scenario setting to identify the impact of the runoff conditions and initial reservoir water level on the incremental benefits five representative scenarios are considered as follows the reservoir inflow sequences under different typical years are shown in fig 3b e s1 dry year cumulative frequency of 75 with an initial reservoir water level of 170 m s2 extreme dry year cumulative frequency of 95 with an initial reservoir water level of 160 m s3 dry year with an initial reservoir water level of 160 m s4 normal year cumulative frequency of 50 with an initial reservoir water level of 160 m s5 wet year cumulative frequency of 25 with an initial reservoir water level of 160 m 4 results 4 1 the saved water that can be reallocated by the source reservoir under rst table 3 shows the monthly renewable energy substitution capacity in henan province and the water that can be preserved in the source reservoir an annual 175 160 million m3 of water would be saved by rst and further reallocated by the djk reservoir 4 2 incremental benefits of emergency water supply and hydropower generation the original operation of the djk reservoir taking into account the hydropower generation normal water supply and emergency water supply is optimally performed based on existing operation rules the results showed that increasing hydropower generation is accompanied by a severe shortage of emergency water supply with a high initial water level in s1 and abundant inflow in s4 and s5 the guaranteed rate of normal water supply reaches 90 the emergency water shortage ranges from 0 to 0 376 billion m3 and can be completely satisfied at the expense of few hydropower benefits however significant competition exists among the three objectives due to deficient inflow and initial storage under s2 and s3 the emergency water shortage becomes sensitive to hydropower generation and the guaranteed rate of normal water supply decreases considerably especially under s2 the existing irreconcilable contradiction indicated that the reservoir should store in advance and reallocate the water saved by rst to alleviate water conflicts through adaptive regulation the optimization results of original reservoir operation with the largest emergency water shortage are selected as the benchmark according to which the water level processes at the djk reservoir are obtained under different scenarios as illustrated in fig 4 based on this the reallocation of the saved water is optimized and the results are indicated in fig 5 the pareto fronts of the optimal reallocation model consist of 500 feasible solutions that are distributed well in the solution spaces for each scenario showing that the maximum emergency water supply increment of 172 million m3 occurs in s3 and the maximum hydropower generation increment of 32 267 gwh occurs in s1 it is obvious that the saved water can create the benefits of hydropower generation as well as emergency water supply compared with the original operation however trade offs still exist between the two objectives and the intensities of competition are distinct among the five scenarios due to the abrupt turn of the pareto fronts under s2 s3 and s4 the pareto front is fitted formulaically by dividing it into segments ab and bc with the increase in hydropower generation the emergency water shortage is aggravated with a constant of 7 569 m3 kwh under s1 which makes it clear that the degree of competition between the two objectives is invariable similarly the pareto front under s5 is a nearly straight line however with a larger slope of 123 90 m3 kwh for the pareto fronts under s2 s3 and s4 when the hydropower generation increment increases from 15 937 gwh to 26 102 gwh 17 364 gwh to 28 174 gwh and 15 267 gwh to 20 759 gwh respectively the emergency water shortage reduction decreases with constants 7 678 m3 kwh 7 575 m3 kwh and 7 537 m3 kwh respectively almost the same as that under s1 however as the hydropower generation increment exceeds 26 102 gwh 28 174 gwh and 20 759 gwh the emergency water shortage reduction decreases sharply at rates of 50 13 m3 kwh 27 37 m3 kwh and 102 80 m3 kwh under s2 s3 and s4 respectively the sharp drop in the pareto fronts indicates that the emergency water supply becomes extremely sensitive to hydropower generation increments the principal reason is that the increase in hydropower generation in segment ab directly results from the decrease in the emergency water supply for the mrsnwdp however the increment in segment bc is mainly generated by optimizing the discharge sequences of the hydropower station which leads to a more severe emergency water shortage the synergy of the two objectives will be difficult to achieve by choosing feasible solutions in segment bc furthermore compared with the water consumption intensity of hydropower generation in original reservoir operation 6 219 m3 kwh to 6 868 m3 kwh it appears to be more beneficial that the saved water should be inclined to ensure the emergency water supply thus solutions with the smallest emergency water shortage i e es in fig 5 are adopted as an example to elaborate the generation mechanism of incremental benefits reallocation of the saved water promotes each single emergency water supply goal and further enhances the average guaranteed rate as illustrated in fig 6 under original reservoir operation goals 1 and 2 can be fully satisfied in s1 with a high initial water level and in s4 and s5 with sufficient inflow with deficient inflow the guaranteed rate of goal 2 decreases to 17 38 under s3 and all the goals fail to be met under s2 causing an average guaranteed rate of merely 22 20 additionally goal 3 which occurred in december is ignored with a low guaranteed rate ranging from 0 to 2 33 among the different scenarios the results show severe emergency water shortages under original operation the volumes of emergency water shortages over the entire operation period under different scenarios are listed in table 4 in total with optimal reallocation of the saved water under rst the net increments of the emergency water supply under the five scenarios are 1 139 108 m3 1 711 108 m3 1 724 108 m3 0 515 108 m3 and 0 445 108 m3 it is obvious that the benefits of the emergency water supply are relatively large in the first three scenarios and almost all the saved water is used to meet the emergency water demand under s2 and s3 this is because the reservoir can maintain a lower water level throughout the whole operation period under scenarios with dry inflow and low initial water level as illustrated in fig 4 which provides adequate storage capacity for preserving additional water consequently additional water is stored in the djk reservoir with low flood risk to meet future emergency water demand whenever necessary this contributes to an increasing average guaranteed rate of 11 12 and 11 60 under s2 and s3 respectively the results also indicate that with the accumulation of water savings the guaranteed rates of the three goals increase successively however despite a dry inflow under s1 the reservoir almost reaches the warning water level in the summer flood season due to the high initial water level that is a portion of the saved water would be forced to discharge rather than be preserved in the reservoir thus when emergency water demand occurs in december only the remaining 1 139 108 m3 of the saved water can be discharged to meet it and the corresponding average guaranteed rate is increased by merely 10 10 analogously the reservoir water level reaches the limited water level in the flood season under original operation due to abundant inflow in s4 and s5 causing an emergency water supply increment of 0 515 108 m3 and 0 445 108 m3 and an increasing average guaranteed rate of only 4 57 and 3 94 respectively the results reveal that the incremental benefits of emergency water supply resulting from rst are more evident in dry and extremely dry years with low initial water levels in addition the time when emergency demand occurs also affects the magnitude of the benefits the later the emergency demand occurs and the longer the reserved buffer time such as goal 3 under s2 and s3 the more obvious the incremental benefits will probably be produced the net increments of hydropower generation under the five scenarios are 17 164 gwh 15 973 gwh 17 364 gwh 15 267 gwh and 14 584 gwh respectively as shown in table 4 equivalent to 0 276 0 329 of the annual average power generation of the djk reservoir the detailed data of the incremental hydropower generation process are illustrated in fig 7 it is evident that the fluctuation of the water level increment presents the characteristics of a valley value in the flood season and double peaks throughout the operation period and the hydropower generation increment shows a falling trend after an initial increase with a peak value in the flood season the results indicate that the hydropower generation benefits enhanced by water reallocation mainly focus on two aspects generally when there is no emergency water demand the saved water will be stored in the reservoir gradually raising the reservoir water level and increasing the hydraulic head to boost hydropower generation in the five different scenarios the average increments of the reservoir water level are 0 095 m 0 051 m 0 064 m 0 019 m and 0 026 m respectively on the other hand the saved water will be discharged in case of emergency water supply or flood control bringing about hydropower generation benefits in particular discharge generally increases in june the period when the emergency water demand occurs in the lower reaches of the han river which creates considerable profits in hydropower generation as shown by the peak of the curves in fig 7b and 7c it should be noted that almost all the saved water is discharged to generate electricity at the end of the operation period among different scenarios however the reservoir should not only reallocate the saved water in one year but also consider the situation encountered between different typical years for multi year regulation the reservoir should store the water if possible instead of discharging it for power generation at the end of a year the continuous accumulation of the saved water in the reservoir would produce cross year cumulative benefits which is easier to achieve under water deficient s2 and s3 according to the simulation results of the reservoir water level 4 3 operating rules of the source reservoir adapting to rst adapting to rst means that the saved water should be reasonably reallocated to alleviate emergency water shortage and promote hydropower generation with a variety of alternatives on the pareto fronts of the optimal reallocation model decision makers can be provided with appropriate reservoir operation rules to promote synergetic benefits therefore three representative solutions are selected on the pareto front to explain how to boost the emergency water supply and hydropower generation including the hydropower generation dominated solution i e hs the solution with the largest hydropower generation increment as indicated by the red dot in fig 5 the emergency water supply dominated solution i e es the solution with the smallest emergency water shortage as indicated by the blue dot in fig 5 and the best compromise solution i e cs the solution that alleviates the competition between the two objectives which is closest to the ideal dot as indicated by the green dot in fig 5 correspondingly the monthly reallocation of the saved water is illustrated in fig 8 the reallocation scheme of the saved water related to hs is inclined to maximize hydropower generation as shown in fig 8a there is no incremental water allocated to the mrsnwdp in december despite the severe insufficiency of goal 3 in addition goals 1 and 2 also fail to be met during the entire operation period more than 90 of the saved water is discharged to the lower reaches of the han river to generate hydropower benefits taking s2 as an example the emergency water shortage is 1 538 billion m3 under original operation however over half of the saved water is stored in the reservoir while neglecting the emergency water demands until the autumn flood season thereafter the saved water reallocated downstream gradually increases until it reaches its maximum in december the reason is that a higher water level comes with more benefits in hydropower generation under the five scenarios there are 15 10 gwh 11 09 gwh 11 75 gwh 5 59 gwh and 0 36 gwh more with respect to hydropower generation increment than that of es respectively in the case of cs among various scenarios the reservoir reaches the best compromise between the objectives of hydropower generation and emergency water supply the normalized euclidean distances between css and the ideal points under the five scenarios are 0 704 0 563 0 619 0 620 and 0 707 respectively which demonstrates that it has the potential to create more considerable synergetic benefits under s2 the water reallocation results related to cs shown in fig 8b indicate that more saved water is reallocated to emergency water demands which is reflected in the increase in emergency water supply in june under s2 and s3 and in december under all scenarios correspondingly the amount of water discharged downstream for hydropower generation decreases at the end of the operation period the water reallocation scheme corresponding to es presented in fig 8c is distinguished from other solutions remarkably by its significant amount of water reallocated to the mrsnwdp in december in such cases the guaranteed rate of emergency water supply has reached the superior limit based on the water reallocation scheme under different scenarios the operation rules of the source reservoir adapting to rst are proposed the general principle is that the source reservoir should decrease the normal water supply to the mrsnwdp and flexibly increase water storage on the premise of ensuring flood control safety faced with different water demands the optimal scheduling strategy varies in different cases in the event of no emergency water demand it is recommended to adopt the operation scheme corresponding to hs in years with deficient inflow and relatively low initial water storage the source reservoir should increase water storage and operate at a high water level to increase the hydraulic head so that the saved water can continuously create hydropower generation benefits in years with abundant inflow or high initial water levels the reservoir should increase the centralized release for hydropower generation before the summer flood season to avoid water abandonment subsequently the water storage should be increased in advance if the inflow is predicted to be deficient in the next year in the case of large emergency water demands the reservoir should prioritize the emergency water supply therefore it is suggested to comply with the operation schemes related to es or cs under which the saved water can produce both hydropower generation benefits and water supply benefits in years with deficient inflow and relatively low initial water storage the source reservoir should discharge the saved water downstream to satisfy the emergency water demand during the summer flood season after the flood season the reservoir could increase water storage across years with low flood risk in years with abundant inflow or high initial water levels downstream emergency water demands can be normally met the reservoir can store additional water during the flood season while a portion of it should be discharged for power generation before the autumn flood season at the end of the flood season the reservoir should begin to increase storage in response to the emergency water demand of the mrsnwdp 5 discussion 5 1 the causes and implications of differences in results among scenarios the reallocation of the saved water under rst alleviates emergency water shortages and generates hydropower benefits however there are significant differences in the results of optimal water reallocation under different scenarios on the one hand more significant benefits generated in dry years are found on the other hand the shape of the pareto front varies in the five scenarios more specifically there is a turning point at the pareto front under s2 s3 and s4 which indicates a change of the trade offs between the two objectives the discrepancy is mainly caused by different inflow conditions and limitation on water levels during flood season the characteristics i e the time and location of each emergency water shortages are also the causes for the above differences in s2 and s3 under original operation the discharge for power generation during the entire operation period is lower than the rated flow q max e due to dry inflow and the water level does not reach the flood limit level the remaining storage capacity at the end of august is 6 39 billion m3 and 0 55 billion m3 respectively under s2 and s3 therefore almost all the water saved by rst can be utilized for power generation or increasing emergency water supply contributing to more significant benefits due to the synergistic benefits in generating hydropower the saved water will be prioritized for emergency goals 1 and 2 as the optimal solution moves along the blue arrow from point a to point b shown in fig 5b and 5c water reallocation for emergency goal 3 is prioritized to decrease as it cannot generate hydropower the increase in hydropower generation in segment ab directly results from the decrease in the emergency water supply for goal 3 in segment bc water reallocation for emergency goal 1 in january or emergency goal 2 in june will be shifted to generate hydropower from october to december generating hydropower as late as possible produces more additional electricity due to the cumulative effect of the hydraulic head this results in a severe decrease in the synergistic benefits of hydropower generation in january or june therefore the decrease in the same volume of emergency water supply generates less hydropower generation increment compared to segment ab which leads to the difference in slope between the two segments under s1 with high initial water level i e 170 m maximum hydropower generation increment of 32 27 gwh will be generated due to the high hydraulic head however approximately 50 million m3 of the saved water has to be discharged in advance before august due to the flood control level restriction under different solutions this caused lower increment of the emergency water supply maximum 113 93 million m3 compared to s2 and s3 moreover the increase in emergency water supply to goal 3 will lead to a direct decrease in hydropower generation causing a continuous nearly linear relationship of the two objectives as shown in fig 5a in s4 and s5 with sufficient inflow a portion of the saved water would even be abandoned during flood season more saved water before the autumn flood 122 21 million m3 in total is unable to be stored in the reservoir to cope with emergency water demand in december this causes lower incremental benefits compared to the other three scenarios furthermore the formation mechanism of ab segment in pareto front under s4 is the same as that under s2 and s3 however after passing point b the hydropower generation is mainly enhanced by raising the hydraulic head and the saved water will be increasingly abandoned despite achieving more hydropower generation the efficiency of hydropower production per unit water decreases a lot the formation mechanism of the entire pareto front of s5 is the same as that of the bc segment under s4 so the slopes of the two are relatively close 123 90 m3 kwh and 102 80 m3 kwh the above discussion reveals the specific causes of differences in various scenarios which also provides novel insights to summarize low flood risk and high α value in dry conditions α is defined as the proportion of annual water savings to annual reservoir inflow such as 1 26 for s2 contribute to more incremental benefits of water reallocation on the contrary in scenarios of abundant inflow with low α value for example 0 39 for s5 since the original operation can meet most of the water demand the additional benefits of water saving reallocation become less significant the shape of the pareto front essentially reflects difference in the utilization efficiency of the saved water among scenarios the abandoned water generated during the flood season significantly reduces the productiveness of water reallocation reallocating the saved water to cope with specific emergency events such as goal1 and goal2 in this paper can generate synergistic benefits in hydropower generation blindly pursuing the maximum hydropower generation may lead to the loss of the aforementioned synergistic benefits 5 2 impact of rst scale expansion on incremental benefits the rapid development of interregional transmission and substitution of clean energy has imposed considerable effects on water resources the economy chen et al 2019 dai et al 2016 social employment kamidelivand et al 2018 and carbon emissions qi et al 2014 the effect on water resources tend to be profound and our research confirms that renewable energy substitution would change regional water demand and produce incremental water co benefits such mutual benefit has been demonstrated by a study conducted in california he et al 2019b which concludes that renewable energy substitution for hydropower alleviates conflict between multiple water sectors and contributes to groundwater recovery to promote carbon neutrality the transmission scale of renewable energy will be further expanded in the coming decades according to the development plan structured by china s national energy administration the installed capacity of clean energy in the energy structure will reach 62 and 12 long distance ultra high voltage transmission lines with a total capacity of 57 gw will be constructed in succession by 2050 with the power receiving region as the core node the large scale electricity network will be closely coupled with associated water supply projects and the source reservoirs generating greater incremental benefits to explore the change of incremental benefits caused by the scale expansion of rst the designed annual transmission capacity of qhuhvl is regarded as one unit of rst the water related marginal revenues are calculated by simulating the water savings reallocation and the results under the es scheme are illustrated in fig 9 under s2 with deficient inflow the marginal revenues of hydropower generation and emergency water supply present a completely opposite trend notably when the substitution scale exceeds 7 units the marginal revenue of the emergency water supply tends to be unchanged however it is accompanied by a decline in the marginal revenue of hydropower generation furthermore it is important to note that the marginal revenue of emergency water supply and hydropower generation both show a downward trend in s5 showing that the water saved in the djk reservoir cannot steadily create incremental benefits therefore to better promote the co benefits of rst decisions should be made cautiously regarding the operation of related water conservancy projects especially in wet years it is recommended that the water supply from different sources should be rearranged according to the volume of the water saved by rst and the marginal revenue characteristics thereby leading to the largest total benefits 5 3 cumulative benefits induced by accumulative water storage in the source reservoir to clarify the inter year cumulative benefit from the saved water a scenario is proposed on condition that the water saved by rst in the previous year is totally stored therefore 350 320 million m3 of the saved water should be optimally reallocated in the next year the benefits under the scheme dominated by the emergency water supply are illustrated in fig 10 compared with the benefits under scenarios without water retained i e benefit a in fig 10a corresponding to the results of optimal reallocation in section 4 2 the cumulative saved water produces an increment green part of the bar in fig 10a i e benefit b plus benefit c of hydropower generation almost twice that of benefit a as shown in fig 10a this means that hydropower generation per unit water has increased the rise in reservoir water level is the main reason for generating inter year cumulative benefits of hydropower generation as shown in fig 11 the reservoir water level increment is much larger before the flood season than that in fig 7 due to water reserved in the previous year the average increments of reservoir water level in the five different scenarios are 0 232 m 0 087 m 0 196 m 0 113 m and 0 108 m respectively which is 1 71 to 5 92 times that under scenarios without water retained in the previous year it is worth mentioning that the peaks of hydropower increment in fig 11b and 11c are actually caused by increasing release to address downstream emergency demand while the peaks of hydropower increment in fig 11a 11d and 11e result from the concentrated release before the flood season as shown in fig 10b the emergency water supply under s2 and s3 doubled and there is little cumulative benefit there is almost no increase in the emergency water supply in the other three scenarios due to restrictions on reservoir storage during flood seasons more specifically under s1 s4 and s5 the water reserved in the previous year is totally released before the flood season making no contribution to the emergency water supply of the mrsnwdp in december which is consistent with the hydropower increment results the results indicate that the accumulation of the saved water among years is beneficial to the operation of the source reservoir especially in dry conditions therefore it is suggested to reserve the saved water in relatively dry scenarios when there is no emergency demand so as to promote cumulative benefits in wet scenarios the low feasibility of storing the saved water spanning flood seasons indicates that the saved water should be reallocated in a timely manner to generate hydropower more accurate multi year scheduling policies should be proposed combining the inflow forecast information and correlation of multi year hydrological conditions hedging theory will be applied in future work to investigate the multi year reallocation of the saved water considering the encounter between scenarios 6 conclusions to investigate the impact of rst on regional water resources and further improve reservoir operation strategies this paper proposed a general framework for calculating the water saved by rst and optimize its reallocation to increase the emergency water supply and hydropower generation then the adaptive operation rules of the source reservoir were proposed based on the quantification of incremental benefits and subsequently analysis and discussion were conducted on marginal revenue and cumulative benefits the proposed method was applied to an energy water system centered on henan province china the core conclusions of this paper are as follows 1 renewable energy penetration reduces the annual water demand by 175 160 million m3 in henan province by adaptively utilize the water savings the source reservoir can create incremental benefits of hydropower generation and emergency water supply ranging from 14 584 gwh to 32 267 gwh and 0 to 1 724 108 m3 respectively under different scenarios 2 both the natural inflow and the initial water level of the source reservoir affect the incremental benefits as the yearly inflow decreases the reservoir creates superior incremental benefits as the initial water level increases the benefit of hydropower generation increases considerably 3 it is suggested that the saved water should concentrate on the emergency water supply in dry years and enhance hydropower generation before the flood season to decrease abandoned water in wet years in addition conserving the saved water among years for future use would produce cumulative benefits under dry conditions 4 given that there is a stable marginal benefit before the substitution scale reaches 320 twh it is profitable to store and reallocate the saved water by the djk reservoir in dry years however in years with abundant streamflow the water supply from multiple sources should be rearranged to maximize total benefits according to the volume of the water saved by rst and the marginal revenue characteristics from the perspective of renewable energy substitution this study extends the profound relationship between water and energy by coupling a power transmission project and a water diversion project providing new insights into regional water management in the context of the rapid development of renewable energy the relevant results have revealed the response mechanism of water reallocation to rst the conclusions can guide the source reservoir in making better use of the saved water through rational utilization of its storage capacity to ensure water sustainability decision makers should systematically consider the impact of rst on water availability and promote the synergetic benefits of water saving utilization through optimal operation of the water conservancy project credit authorship contribution statement chao ma conceptualization investigation methodology resources data curation writing review editing supervision haixing gou investigation methodology software formal analysis writing original draft visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national natural science foundation of china grant numbers 52279021 52079087 and project team key training fund of tianjin grant number xc202044 we extend our sincere gratitude to the editor and the anonymous reviewers for their professional comments and corrections 
1828,reliable flood forecasting serves as one of the fundamental tasks in flood management however the forecast performance of modern data driven models depends heavily on the quantity and quality of training data the lack of field data of flood events highly underpins the development of machine learning ml flood forecasting techniques with consideration of the rareness of flood events and the high dimensionality of flood time series two latest variants of generative adversarial networks gans time series generative adversarial network timegan and real world time series generative adversarial network rtsgan were applied to generate synthetic flood timeseries in the example analysis of the xijiang river basin in southern china results show that time series gans can accurately and efficiently mimic the spatiotemporal correlations between flood series from multiple sites and rtsgan outperforms timegan especially when the lengths of time series are long additionally gradient boosting regression tree gbrt long short term memory lstm and quantile regression method integrated lstm networks qrlstm flood forecasting models were trained with real sequences and an extra amount of synthetic sequences it shows that the expansion of training datasets in this way is promising in reducing prediction errors of classical machine learning models in the 3 day ahead flood forecast the introduction of synthetic training datasets has little positive effect on both gbrt and lstm in 24 hour ahead flood forecast as the lead period increases gbrt rtsgan outperforms gbrt evidenced by a 6 7 increase in nash sutcliffe efficiency nse metric a 56 5 reduction in average absolute relative error aare metric and a 33 1 reduction in root mean square error rmse metric for interval forecast the use of synthetic training datasets helps qrlstm obtain lower prediction interval normalized averaged width pinaw however at the cost of prediction interval coverage probability picp keywords time series generative adversarial networks gbrt lstm flood forecasting data availability data will be made available on request 1 introduction to date there are still numerous people and assets being shrouded in the gloom of floods adikari and yoshitani 2009 every year an average of 300 billion dollars of damage and the resulting societal impact have rushed researchers worldwide taking aim at flooding problems seriously hallegatte et al 2017 existing flood subjects e g flood susceptibility mapping flood forecasting reservoir flood regulation and post disaster assessment have covered almost all aspects before during and after floods admittedly one of the most important and conducive strategies is practical and effective flood warnings boulange et al 2021 extending the foreseeability of floods enables timely management of hydro junctions and quick evacuation of people from flood zones thereby minimizing the socioeconomic losses zhang et al 2022 although considerable efforts have been made the reliability of available flood forecasting methods remains below expectations or requirements of real world implementation muste et al 2022 one of the great challenges encountered in the development of flood forecast technology lies in the scarcity of field data generally flood forecasting models now in use can be divided into two categories physically based models and data driven intelligent models hydrological models zhao 1992 paquet et al 2013 kabir et al 2014 pierini et al 2015 mourato et al 2021 e g physically based and conceptual models require both hydrological and geomorphological data for simulation and calibration the parameter tuning process is to translate basin specific hydrologic characteristics into a batch of physical parameters which is feasible for frequently occurring conditions whereas the parameterization of extreme low probability events like floods is usually hindered by extremely limited observation data brown et al 2021 moreover large volumes of physical parameters may produce accumulated uncertainties that can exceed those generated by the modeling itself yen and tang 1977 data driven intelligent models attach more importance to data mining and data analysis rather than physical significance the prevailing ml models yield desirable predictions mainly based on variable target mapping relations learnt from historical data classical ml algorithms have been applied in flood forecasting including the logistic regression lr support vector machine svm li et al 2016 and random forest rf schoppa et al 2020 to uncover more features modern recurrent neural networks rnn ding et al 2019 convolutional neural networks cnn zhai et al 2019 transformers castangia et al 2023 and some hybrid methods hu et al 2019 liu et al 2020 also attract growing interest even if the data driven intelligent models are more accurate their precision depends heavily on the quality and quantity of training data without theoretical support the garbage in garbage out phenomenon is more pronounced many of the modern data driven models require even more input data to avoid overfitting and underfitting problems furthermore the ml based model which is usually a black box to external users also renders traditional logic based verification and validation techniques meaningless schieferdecker et al 2019 therefore the key to enhancing flood forecasting accuracy is to remove the limitations of the flooding database it is not easy since flood time series are complex and high dimensional traditional flood generation methods e g monte carlo giles 2008 2015 giles et al 2015 clare et al 2022 and latin hypercube sampling hossain et al 2006 method cannot generate multivariate flood time series that preserve the spatial temporal correlation between multiple reaches and different sites although the two dimension or vine copula function chen et al 2019 chowdhary et al 2011 sraj et al 2015 does make some progress in capturing the correlation between variables its efficiency decreases exponentially with increasing dimensionality these exiting generating techniques are far from reflecting complex autocorrelations and cross correlations of the real world flood time series let alone working for flood forecasting models generative adversarial networks offer us a great choice which was first developed by goodfellow et al 2014 to generate synthetic data based on the original feature distributions numbers of gan variants have been designed since its invention among them ma et al 2022 found that deep convolutional generative adversarial network coupled with wasserstein generative adversarial network dc wgan can well generate runoff series of multiple reservoirs that maintain temporal and spatial correlation than traditional stochastic generation methods recently time series gans have drawn accelerating attention for their better capacity of dealing with high dimensional sequences the generated scenarios can be directly applied in the downstream classification and prediction tasks the benefits of time series gans in enhancing prediction accuracy have been exploited in many fields li et al 2022 yilmaz and korn 2022 zhang et al 2022 however little work has been done in the flood timeseries generation and the utilization of generated timeseries in accuracy improvement of flood forecasting models therefore the focal point of this paper is to examine the applicability of time series gans in generating flood timeseries from the aspects of generation performance and latter forecasting utilization the proposed framework was applied to the xijiang river in southern china firstly we aimed at generating the flood timeseries that preserve original spatial temporal correlations between multiple hydrological stations the generation performance of timegan and rtsgan was examined in the second part the flood forecasting models were trained with real data and an extra amount of synthetic data the effects of synthetic data on the forecast performance of gbrt lstm and qrlstm models were investigated in both hourly and daily timescales in addition the shapley additive explanations shap was introduced to provide insights into how flood forecasting models were affected and improved by synthetic data 2 case study and materials 2 1 study area as the mainstream of the pearl river xijiang river plays an important social economic role in south china as shown in fig 1 located within 102 14 e 114 50 e and 21 31 n 26 49 n xijiang river basin is characteristic by a subtropical monsoon climate niu et al 2015 wet seasons april to september have the most share of the precipitation and streamflow occupying approximately 65 of the annual mean precipitation and 75 of the annual mean streamflow respectively liu and han 2020 yu et al 2016 in recent years xijiang river basin suffers from rapid urbanization population expansion and great climate changes faced with upcoming floods of greater frequency and intensity accurate flood forecasting is of significance in this basin to reduce flood loss 2 2 observation data xijiang river basin has a complex river network and thus complete historical flood series of this basin are extremely rare and hard to collect event based flood forecasting models are intended to reproduce basin specific flood responses nathan and ling 2016 for their easy implementation event based models are still preferred in real time applications in this study the observed streamflow series associated with 23 flood events occurring from 2007 to 2016 in xijiang river basin were collected from 7 hydrological stations i e liuzhou lz qianjiang qj wuxuan wx guigang gg dahuangjiangkou dh jingnan jn and wuzhou wz for the daily scale forecast a total of 872 daily runoff data were allocated into two datasets for model training 540 from 17 events and testing 332 from 10 events for the hourly scale forecast the streamflow series from wz wx and dh stations were sampled every 3 h a total of 3176 hourly runoff data were allocated into two datasets for model training 1920 from 11 events and testing 1256 from 5 events the training dataset was used to generate synthetic series and adjust the forecast models hyperparameters and the testing dataset was used to evaluate the forecast models performance to further verify the generation capacity of time series gans the flood series of testing datasets were not involved in sequence generation 3 methodology 3 1 flood generating model this section is to introduce timegan and rtsgan in brief for more information on the principles and codes of timegan and rtsgan the interested readers are referred to yoon et al 2019 and pei et al 2021 before the data generation the flood time series should be pre processed through normalization and segmentation into a three dimensional 3d data set the data segment process is to take a window size w and slide it along the flood sequence in chronological order if the number of features is n we will obtain a certain two dimensional 2d matrix n w at each sliding step if the length of i flood event is l i and the sliding step m isset to 1 the i flood event will generate a 3d dataset after sliding l i w 1 steps l i w 1 n w the number of flood events is k then the total size of the newly generated 3d data will be 1 k l i w 1 n w as shown in fig 2 3 1 1 timegan timegan is constructed by two key components the autoencoding components and the adversarial components as shown in fig 2 the former consists of embedding function and recovery function and the latter consists of the sequence generator and the sequence discriminator the embedding and recovery networks enable a reversible mapping between original feature space and low dimensional latent space where the adversarial network can capture static and temporal features in original data more efficiently the adversarial components are to achieve a balance between the generator and the discriminator the generator is expected to produce synthetic sequences as real as possible to deceive the discriminator in turn the discriminator is encouraged to provide correct classification between real and generated sequences to optimize the realization of generated data the joint training of the autoencoding components and the adversarial components is realized by the balance of three loss functions here the vectors of static and temporal features are denoted as s and x respectively also let s s and x x be random vectors instantiated with specific values denoted as s and x the length t of each sequence is also considered as a random variable then tuples s x 1 t are considered to have a joint distribution p e represents the expected value or the expectancy 1 the reconstruction loss l r disciplines the accurate reconstruction s x 1 t of static s and temporal x 1 t features of original data in embedding and recovery functions 1 l r e s x 1 t p s s 2 t x t x t 2 2 the unsupervised loss l u is expected to allow maximizing for the discriminator or minimizing for the generator the likelihood of providing correct classifications for y s y 1 t 2 l u e s x 1 t p l o g y s t l o g y t e s x 1 t p log 1 y s t l o g 1 y t where y s and y t are the classifications of static and temporal codes of real sequences y s and y t are the classifications of static and temporal codes of generated sequences p is the learned distribution of s and x 1 t 4 the supervised loss l s is to force the generator to learn the dynamics between time steps in real data 3 l s e s x 1 t p t h t g χ h s h t 1 z t 2 where g χ is the generator networks for static and temporal features constructed by a recurrent network h t and g χ h s h t 1 z t represent the latent representations of temporal features in real and generated data respectively 3 1 2 rtsgan rtsgan consists of two key components encoder decoder module and generation module as shown in fig 3 unlike timegan which generates a sequence from a sequence of random vectors the encoder module in rtsgan embeds whole time series instance into a latent space whose dimension is fixed and invariant of sequence length then the decoder network reconstructs the whole time series from the latent representation r which maintains various relations inside time series in the generation module rtsgan adopts an improved version of wasserstein gan wgan framework gulrajani et al 2017 for generative modeling of the latent space so that the generator can output synthetic latent representations in the above latent space the generator in wgan is to minimize the 1 wasserstein distance between real data distribution p r and synthetic data distribution p g the objective function of the wgan is as follows 4 l e r p r d r e r p g d r the generation process can be considered as a min max game between the generator and the discriminator d denotes the discriminator e r p r d r represents the expectancy when the real sample is used as input of the discriminator e r p g d r represents the expectancy when the generated sample is used as the input of the discriminator 3 2 flood forecasting model this section is to introduce window based gbrt and lstm in brief furthermore qrlstm was used for single day ahead interval forecasting it should be noted that the data normalization and splitting of the training and testing instances were the same in the window based gbrt lstm and qrlstm models 3 2 1 window based gbrt gbrt is an ensemble tree based machine learning model proposed by friedman 2001 consisting of a number of weak learners in the recent study of elsayed et al 2021 a feature engineered window based gbrt has proved to be powerful and competitive with deep learning models in multistep time series forecasting tasks unlike conventional gbrt models which are fitted on the majority of the time series as a complete and consecutive sequence of data points to predict the subsequent and remaining testing part of the time series the novel gbrt reconfigures the time series into one dimensional training instances with sliding windows and flatten windows besides to compensate for the drawback of independent multi output forecasting the multi output forecasting task is transformed into several single target problems this model extends the number of regressors to the size of the forecast horizon and only a single loss function is introduced for each forecast step then the final training loss is calculated with the sum of these regressors which enables the model to grasp the underlying the coupling relations within the forecast horizon details of the internal structure of the window based gbrt the interested readers are referred to elsayed et al 2021 3 2 2 lstm lstm is an important extension of recurrent neural networks rnn first proposed by hochreiter and schmidhuber 1997 lstm can better learn and memorize long term dependencies and correlations between time series at each time step based on the gate mechanism as shown in fig 4 each lstm cell consists of three layers the input layer the recurrent layer and the output layer the output layer is connected to the three gates of the cell namely the input gate i t the output gate o t and the forget gate f t the input sequence x t at time t and the hidden state h t 1 of the recurrent layer at the last time step are used as the next input variable of the three gates thereby the gate mechanism in each lstm cell enables the model to selectively add or delete information from the previous states 3 2 3 qrlstm the quantile regression method integrated lstm networks can be used to estimate the conditional quantile of the dependent variable from the independent variable zhang et al 2019 huang and wei 2020 the mathematical formula of linear qr is as follows 5 q yt τ x t 1 f x t 1 α τ x t 1 α τ t 1 2 n where q y t τ x t 1 is the τ th condition quantile of the dependent variable y t and τ 0 1 α τ α 0 τ α 1 τ α m τ are model parameters of the lstm network the estimated value α τ of α τ can be obtained by minimizing the loss function l 6 l t 1 n ρ τ j y t f x t 1 α τ 7 ρ τ j x τ j x y t f x t 1 α τ 1 τ j x y t f x t 1 α τ correspondingly the τ th condition quantile of the dependent variable y t can be obtained by q y t τ x t 1 f x t 1 α τ 3 3 shap shap was proposed by lundberg and lee 2017 whose core idea was borrowed from game theory that was used to calculate the relative contributions of different players in a coalition shap aims to transform the black box artificial intelligence models into interpretable white boxes an inner understanding can be obtained about how the output results generated by the parameters hidden inside the ml models shap analysis was employed in this study to investigated the influence of synthetic data generated by time series gans on the mechanism of forecasting models the obtained shap results would be very useful for future data collection and experiment design 3 4 metrics 3 4 1 evaluation metrics for generation performance to quantitatively evaluate the generation performance of time series gans discriminative score and predictive score were adopted discriminative score measures the similarity between the generated synthetic and the real sequences via a 2 layer lstm classification model the discriminative score is 0 5 classification accuracy where the accuracy is evaluated on a held out test set predictive score assesses the temporal learning capabilities of gan based on the mean absolute error mae of a 2 layer lstm predictor esteban et al 2017 the lower the discriminative and predictive scores are the closer the synthetic datasets are to the real datasets in addition to check and visualize how well the spatial and temporal correlations maintain in generated flood time series heatmaps of the correlation coefficient cc τ considering time lag τ between different hydrological stations were further plotted the calculation formula is as follows 8 cc τ i 1 n τ x i x y i τ y i 1 n τ x i x 2 i 1 n τ y i τ y 2 where x and y are the mean values of variables x and y and n is the total number of periods of the time series for qualitative evaluation two unsupervised feature extraction algorithms i e t sne t distributed stochastic neighbor embedding van der maaten and hinton 2008 and pca principal component analysis bryant et al 1995 were adopted they can project the highly dimensional dataset into a low dimension space so as to give us a 2d visualization of the closeness between synthetic and real sequences 3 4 2 evaluation metrics for forecasting performance qualitative evaluation indices were employed to evaluate the performance of flood forecasting models including pearson correlation coefficient cc root mean square error rmse relative bias bias cc describes the linear correlation between forecast and observed values rmse describes the overall error magnitude between forecast and observed values which tends to give more weight to larger errors bias describes the systematic bias of forecast values to evaluate the capacity of reproducing hydrograph patterns average absolute relative error aare and nash sutcliffe efficiency nse were calculated aare measures the absolute relative error between the observed and forecast flood peaks nse is a widely used hydrological evaluation index ranging from negative infinity to 1 for evaluation of the prediction interval pi gonzález sopeña et al 2020 prediction interval coverage probability picp indicates the probability that the actual value falls within the forecasting interval a lower pinaw indicates better performance when picp is guaranteed a narrow pinaw and a high picp are expected for a high quality interval prediction to better balance the coverage and the range width the combined evaluation cwc was proposed khosravi et al 2010 the lower the cwc value is the better quality the pi has formulas of these indices are listed in the table 1 n is the total number of samples f i and o i are the i th values of the forecast value and the observed data respectively f and o are the mean values of f i and o i respectively n is the total number of flood events f i p and o i p denote the predicted and the observed flood peak of the i th flood event respectively ε i is variable if f i falls within the prediction interval then ε i 1 otherwise ε i 0 r is the range of variation of predicted values and u i and l i represent the upper and lower limits μ is the nominal confidence level where μ 0 9 if picp μ then γ 0 otherwise γ 1 the penalty value η is set equal to 15 to magnify the small difference between the picp and μ 4 experiments and results 4 1 generation performance in this study a window size of 16 time steps 48 h and a window size of 9 time steps 9 days were adopted for hourly and daily flood timeseries generation respectively following the aforementioned setting 1755 3 16 hourly sequences and 404 7 9 daily flood sequences were extracted from original datasets in total gated recurrent unit gru can preserve sequential dependencies inside timeseries through update and reset gates overcoming the common memory problem of vanilla rnn cells in the experiments the rnn based architectures in autoencoder modules of timegan and rtsgan used gru cells for daily models both timegan and rtsgan used a 3 layer gru network with a hidden dimension 4 times the size of input features 4 7 the generators were trained for 13 000 iterations with a batch size of 128 for hourly models both timegan and rtsgan used a 3 layer gru network with a hidden dimension of 24 the total number of training iterations was 20 000 and the batch size was 128 the other hyperparameters were set to their typical values as indicated by yoon et al 2019 and pei et al 2021 the number of generated sequences was set equal to that of the input the experiment for both models was repeated 20 times and all experiment results were used in the latter prediction task the experiments with the best discriminative scores were reported in table 2 to minimize feature dimensionality pca and t sne analyses were performed on normalized feature matrixes and the first two principal components were selected yoon et al 2019 as shown in fig 5 it is apparent from 2d t sne and pca visualization that the distribution of the synthetic sequences generated by rtsgan is significantly closer to the original distribution than that of timegan further the synthetic sequences generated by rtsgan are more diverse which is also indicated by lower discriminative scores in table 2 as the time delay is critical in flood forecasting the heatmaps of correlation coefficients between seven flood time series considering time lag τ were plotted in fig 6 remarkably rtsgan can learn the spatial temporal correlation of the seven flood time series whether strong moderate or weak better than timegan in the daily timescale the temporal correlation coefficients of original wz flood series over four intervals are 0 92 0 76 0 58 and 0 52 respectively accordingly of the generated samples from timegan the temporal correlation coefficients of wz flood series over four intervals are 0 94 0 83 0 70 and 0 46 respectively for rtsgan the temporal correlation coefficients are 0 93 0 76 0 57 and 0 56 nearly in line with those of the original datasets in the hourly timescale it is obvious that the flood time series of wz wx and dh stations are highly correlated over 8 intervals generally timegan can learn the temporal correlation between two or three adjacent periods but it tends to overestimate the temporal correlation as the interval enlarges as for rtsgan with the fixed dimensional latent space which is invariant of sequence length and the improved wgan framework its generated data can achieve better performance in capturing spatiotemporal correlations especially when the lengths of time series are long also the training time of rtsgan is shorter than that of timegan for long sequences 4 2 multistep forecast performance the wuzhou section on the mainstream of xijiang river plays an important role in flood regulation for guangdong province statistically the streamflow from xunjiang river dh station accounts for nearly 80 of the flood volume of wz station and the streamflow from guijiang river gg station accounts for nearly 5 15 hou et al 2021 therefore we aimed at predicting the downstream streamflow at wz hydrological station relying on antecedent discharge measurements of these highly correlated stations considering the temporal characteristics of floods in xijiang river and the requirements of flood early warning systems a 3 day ahead 3 time step and a 24 hour ahead 8 time steps flood forecast models were trained respectively the observed streamflow of the last 1 day 1 time step and 12 h 4 time steps was adopted as the inputs of the daily and hourly timescale models respectively the flood forecasting models were trained with input instances extracting from real data and an extra amount of synthetic data boxplots of the evaluation indices at each lead time step are shown in fig 7 and fig 8 g t g r l t and l r denote gbrt timegan gbrt rtsgan lstm timegan and lstm rtsgan respectively noted that each synthetic dataset derived from the 20 rounds of generation experiment was evaluated and therefore each box whisker contained 20 values table 3 and table 4 summarize the evaluation indices mean values over 20 rounds of the daily and hourly timescale flood forecasting models during testing stages respectively combining tables 3 and tables 4 it is clear that the lstm model achieves the highest prediction accuracy and the advantages of the lstm model are more obvious as the forecast horizon increases one reason is that lstm cells can learn and memorize long term sequential dependencies with gate mechanisms as the forecast horizon increases a deviation appears between the generated data and the actual data which affects the forecasting accuracy of lstm although window based gbrt can learn the dependencies within forecast windows it cannot achieve long term memory like lstm it shows that the use of synthetic datasets generated by rtsgan can substantially improve the performance of window based gbrt model especially at longer forecast horizons this is a significant improvement necessary for promoting the timeseries gans in multistep ml flood forecasting with reference to fig 7 in daily timescale the mean cc metrics at three timesteps of gbrt rtsgan are 0 965 0 886 and 0 753 respectively and those of gbrt are 0 964 0 883 and 0 748 respectively with synthetic inputs the overestimation of streamflow is more obvious leading to larger aares rmse and nse metrics of gbrt rtsgan are consistently worse in the first two lead times and limited improvement can be observed in the third step the introduction of synthetic training datasets has no improvement on lstm further it can be concluded that the generation ability of timegan is not strong enough and thus its synthetic training sets even result in much larger error ranges over the whole 24 hour forecast horizon gbrt rtsgan outperforms gbrt by 2 08 and 6 74 in the cc and nse metrics respectively for timegan are 0 and 1 12 respectively the rmses of gbrt drop from 2354 93 m3 s to 2255 08 m3 s and 1574 86 m3 s with the assistance of timegan and rtsgan the benefit of rtsgan is particularly recognizable at the peak flow the aares of gbrt are reduced by 7 97 and 56 52 in timegan and rtsgan respectively providing clearer evidence that the applicability of time series gans in multistep flood forecasting as shown in fig 8 at step t 1 it can be observed that all evaluation metrics except for cc of lstm timegan and lstm rtsgan are improved as compared with lstm the mean nse metrics of lstm timegan and lstm rtsgan reach as high as 0 985 and 0 990 respectively the mean rmse metrics are as low as 865 2 m3 s and 711 2 m3 s respectively and the mean bias metrics are as small as 1 42 and 0 28 respectively the effectiveness of synthetic datasets on lstm decreases dramatically as the lead period increases it is apparent that the rtsgan generally improves both reliability and accuracy of hourly gbrt at all lead periods in comparison to gbrt gbrt rtsgan reduces rmse at the step t 1 t 3 t 5 and t 7 by 32 14 36 17 35 62 and 29 78 respectively furthermore the improvement in forecasts by using synthetic datasets in nse metrics is increasingly significant at longer horizons rtsgan enhances the nse metrics at each lead time step by 1 01 4 25 11 32 and 17 08 respectively as for timegan its improvement effect on gbrt is limited and unstable it is also implied by the shorter boxes that the results 20 rounds of the rtsgan based models are much more consistent than those of the timegan based models indicating that rtsgan outperforms timegan in terms of model stability reliability and accuracy to further understand how the gbrt model is improved by synthetic datasets shap was utilized to translate the hidden laws inside the black box selecting the best performing one of hourly gbrt timegan and gbrt rtsgan the results at step t 1 t 3 t 5 and t 7 were deeply analyzed fig 9 displays the shap summary plots of hourly gbrt gbrt timegan and gbrt rtsgan models which reflects the overall effect of each feature on the target variable at different lead time steps each dot represents a predicted sample whose color varies from blue to red to tell its negative or positive contribution to the output the first 6 out of 12 features are ranked in descending order of importance the larger the absolute shap value a factor has the greater effect it has it can be readily observed that the wz t 1 is the most detrimental factor fig 10 displays the shap dependence plots of wz t 1 of hourly gbrt gbrt timegan and gbrt rtsgan models x axis represents a normalized input value of wz t 1 and y axis represents the corresponding shap value to the output according to the shap dependence plots of wz t 1 in fig 10 the influence of wz t 1 seems to increase linearly and monotonously with the increasing value at all lead periods based on the visualization results it is discovered that gbrt and gbrt rtsgan models use almost the same influential factors to predict each forecast step and the patterns of shape values show trend consistency as for the gbrt timegan starting from step t 5 the shape values pattern of gbrt and gbrt timegan differ largely possible reason is that synthetic datasets generated by timegan cannot mimic the complete spatial temporal relationships inside longer sequences making use of shap an inner insight into models can be seen and a deeper understanding of the working mechanism of synthetic datasets can be obtained the introduction of well constructed synthetic datasets would not change the original prediction law greatly more importantly some adjustment supplement or extension can be done with those generated informative datasets following the previous similar trend with more training inputs machine learning models are not easy to overfit and insensitive to outliers in the data further as the synthetic datasets generated by rtsgan are closer to the original distribution but much more diverse the blank of the ml forecasting model can be filled more densely and reasonably 4 3 interval forecast performance further the qrlstm method was used for single day ahead flood interval forecasting in this section to train the qrlstm model the observed streamflow for the last 1 d 1 time step was adopted as input table 5 reports the evaluation indices mean values over 20 rounds of interval forecasting models during ten flood events in test datasets as table 5 indicates the introduction of synthetic training datasets helps the qrlstm model obtain lower pinaw however at the cost of picp and only a minority of cases can reduce the interval width while holding the interval coverage to examine the effects of the number of synthetic samples on pi we trained the qrlstm model with real sequences and 25 50 75 and 100 of 404 7 9 generated sequences respectively the boxplot of pinaw picp and cwc metrics of each model is shown in fig 11 rtsgan picp95 denotes the picp metric of rtsgan based qrlstm with a confidence level of 95 it can be observed in fig 11 that pinaw and picp decrease as the quantity of synthetic datasets increases and the general performance of models degrades in terms of cwc μ 0 9 η 15 the reinforcement effect of generated training datasets suggests more concentrated prediction interval the effect of rtsgan on pinaw is more tremendous since the distribution of its generated datasets is more similar to that of the real it suggests that through regulation of the number of fake samples the pi can be flexible and easy adjustable besides although synthetic training sets do not perform well in qrlstm the narrower prediction interval at the flood peak is desirable as shown in fig 12 5 conclusions indeed the potential of machine learning to assist flood forecasting is tremendous but even in the era of information explosion the rareness of extreme flood events and the insufficient issue in field data remain limiting the full energization of modern ml flood forecasting techniques there are two main motivations behind the choice of time series gans one is to provide real like scenarios for flood research such as flood forecasting optimal operation of cascade reservoirs compound disasters and so on the generated sequences by time series gans preserve the original temporal characteristics and thus can be directly utilized in latter tasks additionally most of conventional stochastic approaches require expertise to preprocess the input variables or calculate specific values like flood volume in contrast time series gans directly use the historical sequences as input which greatly facilitates real world applications and removes the barrier for ordinary learners as described above time series gan can generate valuable flood scenarios that maintain complex spatial temporal correlations further the introduction of synthetic datasets is promising for training classical ml forecasting models especially at longer forecast horizons however the improvement in lstm is limited indicating that the effectiveness of time series gans on advanced deep learning models like transformers may need further investigation therefore there is still much work to be done in the future to fully exploit the benefits of gans in practical applications one of the directions is to establish a direct connection between the loss function of time series gans and the downstream forecast performance to provide long horizon forecasts weather information should be considered as an important input variable of flood forecasting models besides sensitivity analyses should be done concerning those user defined parameters such as the window size of sample extraction the hyperparameters of ml forecasting models as well as the ratio between the amount of real and fake samples at the same time the various utilities of generated flood scenarios for flood risk management are to be further explored credit authorship contribution statement peiyao weng methodology software formal analysis data curation writing original draft yu tian conceptualization resources writing review editing funding acquisition project administration yingfei liu validation investigation visualization ying zheng validation supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research is financially supported by national key r d program of china 2021yfc3001000 furthermore sincere thanks to editors and anonymous reviewers for putting forward guiding measures to improve the quality of this paper 
1828,reliable flood forecasting serves as one of the fundamental tasks in flood management however the forecast performance of modern data driven models depends heavily on the quantity and quality of training data the lack of field data of flood events highly underpins the development of machine learning ml flood forecasting techniques with consideration of the rareness of flood events and the high dimensionality of flood time series two latest variants of generative adversarial networks gans time series generative adversarial network timegan and real world time series generative adversarial network rtsgan were applied to generate synthetic flood timeseries in the example analysis of the xijiang river basin in southern china results show that time series gans can accurately and efficiently mimic the spatiotemporal correlations between flood series from multiple sites and rtsgan outperforms timegan especially when the lengths of time series are long additionally gradient boosting regression tree gbrt long short term memory lstm and quantile regression method integrated lstm networks qrlstm flood forecasting models were trained with real sequences and an extra amount of synthetic sequences it shows that the expansion of training datasets in this way is promising in reducing prediction errors of classical machine learning models in the 3 day ahead flood forecast the introduction of synthetic training datasets has little positive effect on both gbrt and lstm in 24 hour ahead flood forecast as the lead period increases gbrt rtsgan outperforms gbrt evidenced by a 6 7 increase in nash sutcliffe efficiency nse metric a 56 5 reduction in average absolute relative error aare metric and a 33 1 reduction in root mean square error rmse metric for interval forecast the use of synthetic training datasets helps qrlstm obtain lower prediction interval normalized averaged width pinaw however at the cost of prediction interval coverage probability picp keywords time series generative adversarial networks gbrt lstm flood forecasting data availability data will be made available on request 1 introduction to date there are still numerous people and assets being shrouded in the gloom of floods adikari and yoshitani 2009 every year an average of 300 billion dollars of damage and the resulting societal impact have rushed researchers worldwide taking aim at flooding problems seriously hallegatte et al 2017 existing flood subjects e g flood susceptibility mapping flood forecasting reservoir flood regulation and post disaster assessment have covered almost all aspects before during and after floods admittedly one of the most important and conducive strategies is practical and effective flood warnings boulange et al 2021 extending the foreseeability of floods enables timely management of hydro junctions and quick evacuation of people from flood zones thereby minimizing the socioeconomic losses zhang et al 2022 although considerable efforts have been made the reliability of available flood forecasting methods remains below expectations or requirements of real world implementation muste et al 2022 one of the great challenges encountered in the development of flood forecast technology lies in the scarcity of field data generally flood forecasting models now in use can be divided into two categories physically based models and data driven intelligent models hydrological models zhao 1992 paquet et al 2013 kabir et al 2014 pierini et al 2015 mourato et al 2021 e g physically based and conceptual models require both hydrological and geomorphological data for simulation and calibration the parameter tuning process is to translate basin specific hydrologic characteristics into a batch of physical parameters which is feasible for frequently occurring conditions whereas the parameterization of extreme low probability events like floods is usually hindered by extremely limited observation data brown et al 2021 moreover large volumes of physical parameters may produce accumulated uncertainties that can exceed those generated by the modeling itself yen and tang 1977 data driven intelligent models attach more importance to data mining and data analysis rather than physical significance the prevailing ml models yield desirable predictions mainly based on variable target mapping relations learnt from historical data classical ml algorithms have been applied in flood forecasting including the logistic regression lr support vector machine svm li et al 2016 and random forest rf schoppa et al 2020 to uncover more features modern recurrent neural networks rnn ding et al 2019 convolutional neural networks cnn zhai et al 2019 transformers castangia et al 2023 and some hybrid methods hu et al 2019 liu et al 2020 also attract growing interest even if the data driven intelligent models are more accurate their precision depends heavily on the quality and quantity of training data without theoretical support the garbage in garbage out phenomenon is more pronounced many of the modern data driven models require even more input data to avoid overfitting and underfitting problems furthermore the ml based model which is usually a black box to external users also renders traditional logic based verification and validation techniques meaningless schieferdecker et al 2019 therefore the key to enhancing flood forecasting accuracy is to remove the limitations of the flooding database it is not easy since flood time series are complex and high dimensional traditional flood generation methods e g monte carlo giles 2008 2015 giles et al 2015 clare et al 2022 and latin hypercube sampling hossain et al 2006 method cannot generate multivariate flood time series that preserve the spatial temporal correlation between multiple reaches and different sites although the two dimension or vine copula function chen et al 2019 chowdhary et al 2011 sraj et al 2015 does make some progress in capturing the correlation between variables its efficiency decreases exponentially with increasing dimensionality these exiting generating techniques are far from reflecting complex autocorrelations and cross correlations of the real world flood time series let alone working for flood forecasting models generative adversarial networks offer us a great choice which was first developed by goodfellow et al 2014 to generate synthetic data based on the original feature distributions numbers of gan variants have been designed since its invention among them ma et al 2022 found that deep convolutional generative adversarial network coupled with wasserstein generative adversarial network dc wgan can well generate runoff series of multiple reservoirs that maintain temporal and spatial correlation than traditional stochastic generation methods recently time series gans have drawn accelerating attention for their better capacity of dealing with high dimensional sequences the generated scenarios can be directly applied in the downstream classification and prediction tasks the benefits of time series gans in enhancing prediction accuracy have been exploited in many fields li et al 2022 yilmaz and korn 2022 zhang et al 2022 however little work has been done in the flood timeseries generation and the utilization of generated timeseries in accuracy improvement of flood forecasting models therefore the focal point of this paper is to examine the applicability of time series gans in generating flood timeseries from the aspects of generation performance and latter forecasting utilization the proposed framework was applied to the xijiang river in southern china firstly we aimed at generating the flood timeseries that preserve original spatial temporal correlations between multiple hydrological stations the generation performance of timegan and rtsgan was examined in the second part the flood forecasting models were trained with real data and an extra amount of synthetic data the effects of synthetic data on the forecast performance of gbrt lstm and qrlstm models were investigated in both hourly and daily timescales in addition the shapley additive explanations shap was introduced to provide insights into how flood forecasting models were affected and improved by synthetic data 2 case study and materials 2 1 study area as the mainstream of the pearl river xijiang river plays an important social economic role in south china as shown in fig 1 located within 102 14 e 114 50 e and 21 31 n 26 49 n xijiang river basin is characteristic by a subtropical monsoon climate niu et al 2015 wet seasons april to september have the most share of the precipitation and streamflow occupying approximately 65 of the annual mean precipitation and 75 of the annual mean streamflow respectively liu and han 2020 yu et al 2016 in recent years xijiang river basin suffers from rapid urbanization population expansion and great climate changes faced with upcoming floods of greater frequency and intensity accurate flood forecasting is of significance in this basin to reduce flood loss 2 2 observation data xijiang river basin has a complex river network and thus complete historical flood series of this basin are extremely rare and hard to collect event based flood forecasting models are intended to reproduce basin specific flood responses nathan and ling 2016 for their easy implementation event based models are still preferred in real time applications in this study the observed streamflow series associated with 23 flood events occurring from 2007 to 2016 in xijiang river basin were collected from 7 hydrological stations i e liuzhou lz qianjiang qj wuxuan wx guigang gg dahuangjiangkou dh jingnan jn and wuzhou wz for the daily scale forecast a total of 872 daily runoff data were allocated into two datasets for model training 540 from 17 events and testing 332 from 10 events for the hourly scale forecast the streamflow series from wz wx and dh stations were sampled every 3 h a total of 3176 hourly runoff data were allocated into two datasets for model training 1920 from 11 events and testing 1256 from 5 events the training dataset was used to generate synthetic series and adjust the forecast models hyperparameters and the testing dataset was used to evaluate the forecast models performance to further verify the generation capacity of time series gans the flood series of testing datasets were not involved in sequence generation 3 methodology 3 1 flood generating model this section is to introduce timegan and rtsgan in brief for more information on the principles and codes of timegan and rtsgan the interested readers are referred to yoon et al 2019 and pei et al 2021 before the data generation the flood time series should be pre processed through normalization and segmentation into a three dimensional 3d data set the data segment process is to take a window size w and slide it along the flood sequence in chronological order if the number of features is n we will obtain a certain two dimensional 2d matrix n w at each sliding step if the length of i flood event is l i and the sliding step m isset to 1 the i flood event will generate a 3d dataset after sliding l i w 1 steps l i w 1 n w the number of flood events is k then the total size of the newly generated 3d data will be 1 k l i w 1 n w as shown in fig 2 3 1 1 timegan timegan is constructed by two key components the autoencoding components and the adversarial components as shown in fig 2 the former consists of embedding function and recovery function and the latter consists of the sequence generator and the sequence discriminator the embedding and recovery networks enable a reversible mapping between original feature space and low dimensional latent space where the adversarial network can capture static and temporal features in original data more efficiently the adversarial components are to achieve a balance between the generator and the discriminator the generator is expected to produce synthetic sequences as real as possible to deceive the discriminator in turn the discriminator is encouraged to provide correct classification between real and generated sequences to optimize the realization of generated data the joint training of the autoencoding components and the adversarial components is realized by the balance of three loss functions here the vectors of static and temporal features are denoted as s and x respectively also let s s and x x be random vectors instantiated with specific values denoted as s and x the length t of each sequence is also considered as a random variable then tuples s x 1 t are considered to have a joint distribution p e represents the expected value or the expectancy 1 the reconstruction loss l r disciplines the accurate reconstruction s x 1 t of static s and temporal x 1 t features of original data in embedding and recovery functions 1 l r e s x 1 t p s s 2 t x t x t 2 2 the unsupervised loss l u is expected to allow maximizing for the discriminator or minimizing for the generator the likelihood of providing correct classifications for y s y 1 t 2 l u e s x 1 t p l o g y s t l o g y t e s x 1 t p log 1 y s t l o g 1 y t where y s and y t are the classifications of static and temporal codes of real sequences y s and y t are the classifications of static and temporal codes of generated sequences p is the learned distribution of s and x 1 t 4 the supervised loss l s is to force the generator to learn the dynamics between time steps in real data 3 l s e s x 1 t p t h t g χ h s h t 1 z t 2 where g χ is the generator networks for static and temporal features constructed by a recurrent network h t and g χ h s h t 1 z t represent the latent representations of temporal features in real and generated data respectively 3 1 2 rtsgan rtsgan consists of two key components encoder decoder module and generation module as shown in fig 3 unlike timegan which generates a sequence from a sequence of random vectors the encoder module in rtsgan embeds whole time series instance into a latent space whose dimension is fixed and invariant of sequence length then the decoder network reconstructs the whole time series from the latent representation r which maintains various relations inside time series in the generation module rtsgan adopts an improved version of wasserstein gan wgan framework gulrajani et al 2017 for generative modeling of the latent space so that the generator can output synthetic latent representations in the above latent space the generator in wgan is to minimize the 1 wasserstein distance between real data distribution p r and synthetic data distribution p g the objective function of the wgan is as follows 4 l e r p r d r e r p g d r the generation process can be considered as a min max game between the generator and the discriminator d denotes the discriminator e r p r d r represents the expectancy when the real sample is used as input of the discriminator e r p g d r represents the expectancy when the generated sample is used as the input of the discriminator 3 2 flood forecasting model this section is to introduce window based gbrt and lstm in brief furthermore qrlstm was used for single day ahead interval forecasting it should be noted that the data normalization and splitting of the training and testing instances were the same in the window based gbrt lstm and qrlstm models 3 2 1 window based gbrt gbrt is an ensemble tree based machine learning model proposed by friedman 2001 consisting of a number of weak learners in the recent study of elsayed et al 2021 a feature engineered window based gbrt has proved to be powerful and competitive with deep learning models in multistep time series forecasting tasks unlike conventional gbrt models which are fitted on the majority of the time series as a complete and consecutive sequence of data points to predict the subsequent and remaining testing part of the time series the novel gbrt reconfigures the time series into one dimensional training instances with sliding windows and flatten windows besides to compensate for the drawback of independent multi output forecasting the multi output forecasting task is transformed into several single target problems this model extends the number of regressors to the size of the forecast horizon and only a single loss function is introduced for each forecast step then the final training loss is calculated with the sum of these regressors which enables the model to grasp the underlying the coupling relations within the forecast horizon details of the internal structure of the window based gbrt the interested readers are referred to elsayed et al 2021 3 2 2 lstm lstm is an important extension of recurrent neural networks rnn first proposed by hochreiter and schmidhuber 1997 lstm can better learn and memorize long term dependencies and correlations between time series at each time step based on the gate mechanism as shown in fig 4 each lstm cell consists of three layers the input layer the recurrent layer and the output layer the output layer is connected to the three gates of the cell namely the input gate i t the output gate o t and the forget gate f t the input sequence x t at time t and the hidden state h t 1 of the recurrent layer at the last time step are used as the next input variable of the three gates thereby the gate mechanism in each lstm cell enables the model to selectively add or delete information from the previous states 3 2 3 qrlstm the quantile regression method integrated lstm networks can be used to estimate the conditional quantile of the dependent variable from the independent variable zhang et al 2019 huang and wei 2020 the mathematical formula of linear qr is as follows 5 q yt τ x t 1 f x t 1 α τ x t 1 α τ t 1 2 n where q y t τ x t 1 is the τ th condition quantile of the dependent variable y t and τ 0 1 α τ α 0 τ α 1 τ α m τ are model parameters of the lstm network the estimated value α τ of α τ can be obtained by minimizing the loss function l 6 l t 1 n ρ τ j y t f x t 1 α τ 7 ρ τ j x τ j x y t f x t 1 α τ 1 τ j x y t f x t 1 α τ correspondingly the τ th condition quantile of the dependent variable y t can be obtained by q y t τ x t 1 f x t 1 α τ 3 3 shap shap was proposed by lundberg and lee 2017 whose core idea was borrowed from game theory that was used to calculate the relative contributions of different players in a coalition shap aims to transform the black box artificial intelligence models into interpretable white boxes an inner understanding can be obtained about how the output results generated by the parameters hidden inside the ml models shap analysis was employed in this study to investigated the influence of synthetic data generated by time series gans on the mechanism of forecasting models the obtained shap results would be very useful for future data collection and experiment design 3 4 metrics 3 4 1 evaluation metrics for generation performance to quantitatively evaluate the generation performance of time series gans discriminative score and predictive score were adopted discriminative score measures the similarity between the generated synthetic and the real sequences via a 2 layer lstm classification model the discriminative score is 0 5 classification accuracy where the accuracy is evaluated on a held out test set predictive score assesses the temporal learning capabilities of gan based on the mean absolute error mae of a 2 layer lstm predictor esteban et al 2017 the lower the discriminative and predictive scores are the closer the synthetic datasets are to the real datasets in addition to check and visualize how well the spatial and temporal correlations maintain in generated flood time series heatmaps of the correlation coefficient cc τ considering time lag τ between different hydrological stations were further plotted the calculation formula is as follows 8 cc τ i 1 n τ x i x y i τ y i 1 n τ x i x 2 i 1 n τ y i τ y 2 where x and y are the mean values of variables x and y and n is the total number of periods of the time series for qualitative evaluation two unsupervised feature extraction algorithms i e t sne t distributed stochastic neighbor embedding van der maaten and hinton 2008 and pca principal component analysis bryant et al 1995 were adopted they can project the highly dimensional dataset into a low dimension space so as to give us a 2d visualization of the closeness between synthetic and real sequences 3 4 2 evaluation metrics for forecasting performance qualitative evaluation indices were employed to evaluate the performance of flood forecasting models including pearson correlation coefficient cc root mean square error rmse relative bias bias cc describes the linear correlation between forecast and observed values rmse describes the overall error magnitude between forecast and observed values which tends to give more weight to larger errors bias describes the systematic bias of forecast values to evaluate the capacity of reproducing hydrograph patterns average absolute relative error aare and nash sutcliffe efficiency nse were calculated aare measures the absolute relative error between the observed and forecast flood peaks nse is a widely used hydrological evaluation index ranging from negative infinity to 1 for evaluation of the prediction interval pi gonzález sopeña et al 2020 prediction interval coverage probability picp indicates the probability that the actual value falls within the forecasting interval a lower pinaw indicates better performance when picp is guaranteed a narrow pinaw and a high picp are expected for a high quality interval prediction to better balance the coverage and the range width the combined evaluation cwc was proposed khosravi et al 2010 the lower the cwc value is the better quality the pi has formulas of these indices are listed in the table 1 n is the total number of samples f i and o i are the i th values of the forecast value and the observed data respectively f and o are the mean values of f i and o i respectively n is the total number of flood events f i p and o i p denote the predicted and the observed flood peak of the i th flood event respectively ε i is variable if f i falls within the prediction interval then ε i 1 otherwise ε i 0 r is the range of variation of predicted values and u i and l i represent the upper and lower limits μ is the nominal confidence level where μ 0 9 if picp μ then γ 0 otherwise γ 1 the penalty value η is set equal to 15 to magnify the small difference between the picp and μ 4 experiments and results 4 1 generation performance in this study a window size of 16 time steps 48 h and a window size of 9 time steps 9 days were adopted for hourly and daily flood timeseries generation respectively following the aforementioned setting 1755 3 16 hourly sequences and 404 7 9 daily flood sequences were extracted from original datasets in total gated recurrent unit gru can preserve sequential dependencies inside timeseries through update and reset gates overcoming the common memory problem of vanilla rnn cells in the experiments the rnn based architectures in autoencoder modules of timegan and rtsgan used gru cells for daily models both timegan and rtsgan used a 3 layer gru network with a hidden dimension 4 times the size of input features 4 7 the generators were trained for 13 000 iterations with a batch size of 128 for hourly models both timegan and rtsgan used a 3 layer gru network with a hidden dimension of 24 the total number of training iterations was 20 000 and the batch size was 128 the other hyperparameters were set to their typical values as indicated by yoon et al 2019 and pei et al 2021 the number of generated sequences was set equal to that of the input the experiment for both models was repeated 20 times and all experiment results were used in the latter prediction task the experiments with the best discriminative scores were reported in table 2 to minimize feature dimensionality pca and t sne analyses were performed on normalized feature matrixes and the first two principal components were selected yoon et al 2019 as shown in fig 5 it is apparent from 2d t sne and pca visualization that the distribution of the synthetic sequences generated by rtsgan is significantly closer to the original distribution than that of timegan further the synthetic sequences generated by rtsgan are more diverse which is also indicated by lower discriminative scores in table 2 as the time delay is critical in flood forecasting the heatmaps of correlation coefficients between seven flood time series considering time lag τ were plotted in fig 6 remarkably rtsgan can learn the spatial temporal correlation of the seven flood time series whether strong moderate or weak better than timegan in the daily timescale the temporal correlation coefficients of original wz flood series over four intervals are 0 92 0 76 0 58 and 0 52 respectively accordingly of the generated samples from timegan the temporal correlation coefficients of wz flood series over four intervals are 0 94 0 83 0 70 and 0 46 respectively for rtsgan the temporal correlation coefficients are 0 93 0 76 0 57 and 0 56 nearly in line with those of the original datasets in the hourly timescale it is obvious that the flood time series of wz wx and dh stations are highly correlated over 8 intervals generally timegan can learn the temporal correlation between two or three adjacent periods but it tends to overestimate the temporal correlation as the interval enlarges as for rtsgan with the fixed dimensional latent space which is invariant of sequence length and the improved wgan framework its generated data can achieve better performance in capturing spatiotemporal correlations especially when the lengths of time series are long also the training time of rtsgan is shorter than that of timegan for long sequences 4 2 multistep forecast performance the wuzhou section on the mainstream of xijiang river plays an important role in flood regulation for guangdong province statistically the streamflow from xunjiang river dh station accounts for nearly 80 of the flood volume of wz station and the streamflow from guijiang river gg station accounts for nearly 5 15 hou et al 2021 therefore we aimed at predicting the downstream streamflow at wz hydrological station relying on antecedent discharge measurements of these highly correlated stations considering the temporal characteristics of floods in xijiang river and the requirements of flood early warning systems a 3 day ahead 3 time step and a 24 hour ahead 8 time steps flood forecast models were trained respectively the observed streamflow of the last 1 day 1 time step and 12 h 4 time steps was adopted as the inputs of the daily and hourly timescale models respectively the flood forecasting models were trained with input instances extracting from real data and an extra amount of synthetic data boxplots of the evaluation indices at each lead time step are shown in fig 7 and fig 8 g t g r l t and l r denote gbrt timegan gbrt rtsgan lstm timegan and lstm rtsgan respectively noted that each synthetic dataset derived from the 20 rounds of generation experiment was evaluated and therefore each box whisker contained 20 values table 3 and table 4 summarize the evaluation indices mean values over 20 rounds of the daily and hourly timescale flood forecasting models during testing stages respectively combining tables 3 and tables 4 it is clear that the lstm model achieves the highest prediction accuracy and the advantages of the lstm model are more obvious as the forecast horizon increases one reason is that lstm cells can learn and memorize long term sequential dependencies with gate mechanisms as the forecast horizon increases a deviation appears between the generated data and the actual data which affects the forecasting accuracy of lstm although window based gbrt can learn the dependencies within forecast windows it cannot achieve long term memory like lstm it shows that the use of synthetic datasets generated by rtsgan can substantially improve the performance of window based gbrt model especially at longer forecast horizons this is a significant improvement necessary for promoting the timeseries gans in multistep ml flood forecasting with reference to fig 7 in daily timescale the mean cc metrics at three timesteps of gbrt rtsgan are 0 965 0 886 and 0 753 respectively and those of gbrt are 0 964 0 883 and 0 748 respectively with synthetic inputs the overestimation of streamflow is more obvious leading to larger aares rmse and nse metrics of gbrt rtsgan are consistently worse in the first two lead times and limited improvement can be observed in the third step the introduction of synthetic training datasets has no improvement on lstm further it can be concluded that the generation ability of timegan is not strong enough and thus its synthetic training sets even result in much larger error ranges over the whole 24 hour forecast horizon gbrt rtsgan outperforms gbrt by 2 08 and 6 74 in the cc and nse metrics respectively for timegan are 0 and 1 12 respectively the rmses of gbrt drop from 2354 93 m3 s to 2255 08 m3 s and 1574 86 m3 s with the assistance of timegan and rtsgan the benefit of rtsgan is particularly recognizable at the peak flow the aares of gbrt are reduced by 7 97 and 56 52 in timegan and rtsgan respectively providing clearer evidence that the applicability of time series gans in multistep flood forecasting as shown in fig 8 at step t 1 it can be observed that all evaluation metrics except for cc of lstm timegan and lstm rtsgan are improved as compared with lstm the mean nse metrics of lstm timegan and lstm rtsgan reach as high as 0 985 and 0 990 respectively the mean rmse metrics are as low as 865 2 m3 s and 711 2 m3 s respectively and the mean bias metrics are as small as 1 42 and 0 28 respectively the effectiveness of synthetic datasets on lstm decreases dramatically as the lead period increases it is apparent that the rtsgan generally improves both reliability and accuracy of hourly gbrt at all lead periods in comparison to gbrt gbrt rtsgan reduces rmse at the step t 1 t 3 t 5 and t 7 by 32 14 36 17 35 62 and 29 78 respectively furthermore the improvement in forecasts by using synthetic datasets in nse metrics is increasingly significant at longer horizons rtsgan enhances the nse metrics at each lead time step by 1 01 4 25 11 32 and 17 08 respectively as for timegan its improvement effect on gbrt is limited and unstable it is also implied by the shorter boxes that the results 20 rounds of the rtsgan based models are much more consistent than those of the timegan based models indicating that rtsgan outperforms timegan in terms of model stability reliability and accuracy to further understand how the gbrt model is improved by synthetic datasets shap was utilized to translate the hidden laws inside the black box selecting the best performing one of hourly gbrt timegan and gbrt rtsgan the results at step t 1 t 3 t 5 and t 7 were deeply analyzed fig 9 displays the shap summary plots of hourly gbrt gbrt timegan and gbrt rtsgan models which reflects the overall effect of each feature on the target variable at different lead time steps each dot represents a predicted sample whose color varies from blue to red to tell its negative or positive contribution to the output the first 6 out of 12 features are ranked in descending order of importance the larger the absolute shap value a factor has the greater effect it has it can be readily observed that the wz t 1 is the most detrimental factor fig 10 displays the shap dependence plots of wz t 1 of hourly gbrt gbrt timegan and gbrt rtsgan models x axis represents a normalized input value of wz t 1 and y axis represents the corresponding shap value to the output according to the shap dependence plots of wz t 1 in fig 10 the influence of wz t 1 seems to increase linearly and monotonously with the increasing value at all lead periods based on the visualization results it is discovered that gbrt and gbrt rtsgan models use almost the same influential factors to predict each forecast step and the patterns of shape values show trend consistency as for the gbrt timegan starting from step t 5 the shape values pattern of gbrt and gbrt timegan differ largely possible reason is that synthetic datasets generated by timegan cannot mimic the complete spatial temporal relationships inside longer sequences making use of shap an inner insight into models can be seen and a deeper understanding of the working mechanism of synthetic datasets can be obtained the introduction of well constructed synthetic datasets would not change the original prediction law greatly more importantly some adjustment supplement or extension can be done with those generated informative datasets following the previous similar trend with more training inputs machine learning models are not easy to overfit and insensitive to outliers in the data further as the synthetic datasets generated by rtsgan are closer to the original distribution but much more diverse the blank of the ml forecasting model can be filled more densely and reasonably 4 3 interval forecast performance further the qrlstm method was used for single day ahead flood interval forecasting in this section to train the qrlstm model the observed streamflow for the last 1 d 1 time step was adopted as input table 5 reports the evaluation indices mean values over 20 rounds of interval forecasting models during ten flood events in test datasets as table 5 indicates the introduction of synthetic training datasets helps the qrlstm model obtain lower pinaw however at the cost of picp and only a minority of cases can reduce the interval width while holding the interval coverage to examine the effects of the number of synthetic samples on pi we trained the qrlstm model with real sequences and 25 50 75 and 100 of 404 7 9 generated sequences respectively the boxplot of pinaw picp and cwc metrics of each model is shown in fig 11 rtsgan picp95 denotes the picp metric of rtsgan based qrlstm with a confidence level of 95 it can be observed in fig 11 that pinaw and picp decrease as the quantity of synthetic datasets increases and the general performance of models degrades in terms of cwc μ 0 9 η 15 the reinforcement effect of generated training datasets suggests more concentrated prediction interval the effect of rtsgan on pinaw is more tremendous since the distribution of its generated datasets is more similar to that of the real it suggests that through regulation of the number of fake samples the pi can be flexible and easy adjustable besides although synthetic training sets do not perform well in qrlstm the narrower prediction interval at the flood peak is desirable as shown in fig 12 5 conclusions indeed the potential of machine learning to assist flood forecasting is tremendous but even in the era of information explosion the rareness of extreme flood events and the insufficient issue in field data remain limiting the full energization of modern ml flood forecasting techniques there are two main motivations behind the choice of time series gans one is to provide real like scenarios for flood research such as flood forecasting optimal operation of cascade reservoirs compound disasters and so on the generated sequences by time series gans preserve the original temporal characteristics and thus can be directly utilized in latter tasks additionally most of conventional stochastic approaches require expertise to preprocess the input variables or calculate specific values like flood volume in contrast time series gans directly use the historical sequences as input which greatly facilitates real world applications and removes the barrier for ordinary learners as described above time series gan can generate valuable flood scenarios that maintain complex spatial temporal correlations further the introduction of synthetic datasets is promising for training classical ml forecasting models especially at longer forecast horizons however the improvement in lstm is limited indicating that the effectiveness of time series gans on advanced deep learning models like transformers may need further investigation therefore there is still much work to be done in the future to fully exploit the benefits of gans in practical applications one of the directions is to establish a direct connection between the loss function of time series gans and the downstream forecast performance to provide long horizon forecasts weather information should be considered as an important input variable of flood forecasting models besides sensitivity analyses should be done concerning those user defined parameters such as the window size of sample extraction the hyperparameters of ml forecasting models as well as the ratio between the amount of real and fake samples at the same time the various utilities of generated flood scenarios for flood risk management are to be further explored credit authorship contribution statement peiyao weng methodology software formal analysis data curation writing original draft yu tian conceptualization resources writing review editing funding acquisition project administration yingfei liu validation investigation visualization ying zheng validation supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research is financially supported by national key r d program of china 2021yfc3001000 furthermore sincere thanks to editors and anonymous reviewers for putting forward guiding measures to improve the quality of this paper 
1829,accurate reliable and stable streamflow forecasts are essential for risk assessment and decision making in water resources management owing to the limited value of deterministic forecasting probabilistic forecasting incorporating probability and confidence intervals is achieved by optimizing the predictors and forecast equation while identifying forecast error features the combination of deterministic forecasts and error identification can facilitate water resources management this study improved the traditional forecast model s inputs selection structure designation and error parameters calibration to propose a long term probabilistic streamflow forecast model with hierarchical optimization of the predictors forecast equation and errors characteristics the model develops information entropy theory to screen the driving predictor set the long short term memory lstm model to conduct deterministic forecasts and the generalized autoregressive conditional heteroskedasticity garch model to identify time varying errors the proposed model used in some case studies to forecast the monthly streamflow of two lakes hongze and luoma lakes in china was evaluated using the multidimensional index method considering accuracy reliability stability performance the results revealed the following 1 predictor screening based on information entropy investigates the statistical characteristics of predictors thereby improving the reliability of streamflow forecasts 2 the lstm model exploits the response between the driving predictors and streamflow whereas garch model identifies the time varying features of forecast errors effectively which reduces the probability of forecast failure and increases the accuracy and stability of probabilistic forecasts 3 under current meteorological observation conditions and forecasting capability the proposed forecasts can extend the maximum forecast lead time from 1 month to 3 months 4 the proposed model improves the accuracy root mean square error 6 7 34 8 reliability brier score 15 3 27 9 and stability mistaken distance 36 4 52 6 in comparison with the benchmark of the two case studies indicating that inputs structure parameters hierarchical optimization provides effective forecast information for water resources management keywords long term streamflow forecast inputs structure parameters hierarchical optimization information entropy theory lstm model garch model data availability data will be made available on request 1 introduction a long term streamflow forecast which often refers to a streamflow forecast with a lead time exceeding 1 month can offer practical information for water resource planning and management yeh 1985 existing methods make it difficult to effectively simulate the streamflow process under the influence of complex runoff formulation and deterministic streamflow forecasts cannot provide accurate and reliable information xu et al 2019 because reservoir regulation has a certain buffering effect on forecast error a probabilistic streamflow forecast with quantitative probability and confidence intervals is proposed by integrating a deterministic forecast and errors with stochastic feature identification to facilitate reservoir regulation hashimoto et al 1982 krzysztofowicz 1999 often three basic metrics are used for the evaluation of a streamflow forecast accuracy reliability and stability duan et al 2007 accuracy represents quantification of the error of deterministic forecasts reliability defines the possibility of probabilistic forecasts covering the observed value and stability evaluates the deviation when the forecast cannot cover the observed value under extreme conditions provision of a valuable streamflow forecast requires an accurate reliable and stable method ajami et al 2008 these indexes are typically affected by the predictors forecast equation and forecast errors the predictors and forecast equation represent the physical process of runoff generation fatichi et al 2016 the former extract the major hydrological elements that affect natural streamflow via runoff generation or sequence decomposition whereas the latter describes the relationship between these elements and streamflow through mathematical expression the forecast error which is generally a representation of the magnitude of deviation between the forecast and observed values is a comprehensive term of the uncertainty in a streamflow forecast also it is an important metric for evaluating the forecast quality of a forecast model benke et al 2008 sivakumar 2000 the selection of different predictors and equations which affects the deterministic forecast model and determines the statistical distribution of the errors can impact the quality of probabilistic forecast performance therefore probabilistic streamflow forecast can be enhanced by selecting appropriate predictors modifying the model structure and optimizing the error parameters shukla and lettenmaier 2011 selection of appropriate predictors is fundamental to ensuring forecast stability and enhancing model generalization liu and gupta 2007 selection of predictors in previous research used correlation coefficients and principal component analysis fathian et al 2016 markonis et al 2018 however such methods can investigate only the linear correlation between predictors which is unsuitable for capturing the complex nonlinear features of hydrological factors in long term streamflow forecasts xie et al 2022 additionally interactive effects between these factors make it difficult to identify combinational driving predictors ignoring such interactions could lead to redundancy which would magnify the uncertainties affected by random perturbations in model inputs darbandsari and coulibaly 2020 copula entropy ce in information theory which links the copula function with information entropy is similar to formulate the joint distribution of multivariate random variables that combines the marginal distribution and the conditional probability distribution chen et al 2013 it is suitable for assessing the effect of interaction of numerous predictors and their combined effect on streamflow determination of both the forecast structure and the forecast equation is beneficial to the improvement of forecast accuracy and reliability data driven models can extract data features from historical streamflow series and establish the mapping function from appropriate predictors to streamflow which remains the principal method for long term streamflow forecasting gu et al 2021 zhao et al 2021 generally models can be divided into the following five categories according to the passage of time 1 models based on mathematical and statistical methods e g regression analysis carlson et al 1970 time series bender and simonovic 1994 and wavelet analysis lafrenière and sharp 2003 2 models based on signal decomposition e g empirical mode decomposition huang et al 1998 complete ensemble empirical mode decomposition yeh et al 2011 and variational mode decomposition wang et al 2021 3 models based on machine learning e g support vector machines asefa et al 2006 artificial neural networks hu et al 2005 and chaos theory dhanya and nagesh kumar 2011 4 models based on deep learning e g recursive neural networks kratzert et al 2018 recurrent neural networks wang et al 2021 and generative adversarial networks ma et al 2022 and 5 integrated models based on optimization algorithms coupled with multiple models niu et al 2021 zhang et al 2020 in recent years with the rapid developments in high performance computing and growth in artificial intelligence approaches the application of deep learning models has made remarkable progress in contrast to conventional machine learning and other techniques this approach stresses the longitudinal depth of the network and might comprehend complex stochastic features from sufficient input by creating several nonlinear processing units lecun et al 2015 such methods can refine the system state with minimal model parameters while maintaining precise fitting wang et al 2020 xiang et al 2020 identification of the stochastic characteristics of forecast errors enhances the reliability and stability of probabilistic forecasts numerous related studies have demonstrated that forecast errors do not satisfy the assumption of independence and temporal stationarity but instead have time varying characteristics influenced by the deviation perturbation and transmission of hydrometeorological processes in real time forecasting liang et al 2021 xu 2021 for example climatological and hydrological variables influence the process of runoff generation and conservation resulting in spatio temporal correlation and a fat tailed distribution of streamflow forecast uncertainties mo et al 2021 xu et al 2022 as time proceeds multistep extending forecasts tend to amplify such uncertainties thereby reducing the value of the forecast the generalized autoregressive conditional heteroskedasticity garch model is a stochastic model used in finance to describe the volatility of the ratio of earnings engle and bollerslev 1986 it is suitable for simulating time series with aggregated volatility such as the systematically large errors of a streamflow forecast in consecutive periods attributable to failure in the forecast of precipitation it can also be used to simulate nonstationary series with time varying parameters and asymmetric volatility and thus it has excellent application potential in the fields of hydrology and water resources management modarres and ouarda 2013 nazeri tahroudi et al 2022 the structure of a streamflow forecast model can be optimized according to the hydrometeorological characteristics of the study area including input preprocessing predictor selection structure adjustment forecast equation modification and output postprocessing forecast error analysis which together constitute hierarchical optimization however previous related studies typically concentrated on improving just one part of the model rather than considering overall optimization this paper proposes a long term probabilistic streamflow forecast model with inputs structure parameters hierarchical optimization the driving predictors are screened based on physical cause analysis and information entropy while the long short term memory lstm model is used to produce deterministic streamflow forecasting the garch model is used to identify the parameters of forecast errors to obtain probabilistic streamflow forecasting application of the proposed model to some case studies of the hongze lake basin and luoma lake china realized improved accuracy dependability and stability of streamflow forecasts distinct from previous related work the proposed model 1 identified driving predictors for streamflow forecasts using information entropy and copula entropy was introduced for capturing the interaction between these predictors thereby improving the reliability of forecasts 2 refined structure of streamflow forecasts via a deep learning model to characterize the mechanism of runoff generation and conservation on a long term timescale which enhanced forecast accuracy 3 addressed forecast errors with clustering volatility and temporal dependency by the garch model which described the stochastic characteristics of forecast errors precisely maintaining certain stability of probabilistic streamflow forecasts 4 optimized the designation of streamflow forecast model in inputs predictors structure forecast equation and outputs forecast errors factors thus improving forecast performance and extending the lead time 2 methodology the long term streamflow forecast model can be expressed as follows 1 y t f x t e t f x t 1 x t τ e t where yt is the streamflow for the current time t x t is the set of predictors wherein xt τ represent the predictors with interval τ periods from the current time f represents the forecast equation and et represents the forecast errors the scenario of a probabilistic streamflow forecast can be proposed if the predictors forecast equation and errors with a particular statistical distribution are provided when the predictors are not absolutely observed values they can be replaced by forecasted values for recursive forecasting to extend the forecast lead time a structural flow chart of the model framework is illustrated in fig 1 sections 2 1 2 3 introduce the three layers of the proposed model namely predictor selection equation modification and error characterization respectively and section 2 4 develops the three indicators to evaluate the accuracy reliability and stability of this model 2 1 predictor screening method based on information entropy theory on the basis of the regional characteristics of runoff generation and conservation influencing hydrological and meteorological elements are selected as predictors and a physical or mathematical model is constructed to describe the complex nonlinear relationships between these predictors independent variables and the streamflow dependent variable the first step is to identify the driving predictors to minimize the subset of predictors with the most critical impact on streamflow this can be accomplished from the following three perspectives collecting the initial predictors choosing the contribution indicators and selecting the driving predictors 2 1 1 construction of the initial predictor set existing studies indicated that hydrometeorological elements such as precipitation evaporation temperature atmospheric pressure and sea surface temperature are the main factors that influence the process of streamflow dong et al 2018 ionita et al 2008 oubeidillah et al 2012 wu et al 2020 while regional subsurface characteristics might affect the formulation of runoff therefore the predictors presented in table 1 are selected to construct the initial predictor set x u 2 1 2 evaluation of predictors contributions the significance and contribution of the initial predictors need to be analyzed to select the driving predictors streamflow can be viewed as a stochastic series perturbed by numerous hydrological factors with uncertainties often it is a challenge to characterize explicitly the interaction between these predictors leading to uncertainty in streamflow forecasts when the value or range of a predictor is determined the probability of a streamflow value within a particular interval increases accordingly resulting in a more focused distribution of forecasted values and reduction in uncertainty consequently information entropy is used here to characterize the interaction between the independent and dependent variables information entropy is used to quantify the uncertainty of random variables in the field of information science 2 h q i 1 n p q i log p q i where q q 1 q 2 q n is a discrete random variable with probability distribution p p q 1 p q 2 p q n i 1 n p q i 1 as the uncertainty of the random variable increases its information entropy increases additionally for a binary random variable z 1 z 2 the joint entropy can be defined as follows 3 h z 1 z 2 z 1 z 1 z 2 z 2 p z 1 z 2 log p z 1 z 2 where p z 1 z 2 is the joint probability density function conditional entropy considers the prior distribution of known variables and estimates the posterior distribution of unknown variables as shown in fig 2 which is defined as follows 4 h z 1 z 2 z 1 z 1 z 2 z 2 p z 1 z 2 log p z 1 z 2 h z 1 z 2 h z 2 where p z 1 z 2 is the conditional probability distribution of variable z 1 if variable z 2 is known measuring the interactive contribution of multiple predictors to a streamflow forecast based on a single factor index is however not easy dong et al 2004 ce is a nonlinear correlation metric that evaluates multivariate and high order correlations which can be used to estimate the contribution of a predictor set to streamflow chen et al 2013 ma and sun 2011 given an n dimensional random variable z 1 z 2 z n with a marginal distribution u i f i z i i 1 2 n where f represents the cumulative probability density function ce can be defined as follows 5 c e z 1 z 2 z n 0 1 0 1 c u 1 u n log c u 1 u n d u 1 d u n where c is the copula function ce is a popularization of information entropy to the high order and continuous random variables with the joint distribution p replaced by c it can increase flexibility in characterizing multivariate interaction and it is suitable for describing the contributions of predictors in a complex situation involving high dimensional variables 2 1 3 screening of predictors and generation of driving predictor set incorporating as many high quality predictors as possible is critical for enhancing the practical value of a streamflow forecast too few predictors might reduce accuracy while too many might lead to model generalization and enlarged forecast uncertainty moreover when the forecast lead time exceeds the effective lead time of the predictors the forecast values of the predictors sometimes need to be substituted for the observed values in recursive forecasting thus the reliability of the predictors is also a critical index for predictor screening here predictors with physical causes are evaluated to eliminate those with low accuracy and reliability then the contribution of each of the remaining predictors is ranked based on ce and some of the top ranked predictors are selected as potential driving predictors the conditional entropy is then developed to assess the effects of interaction between various combinations finally the driving predictor set x is recognized as the subset of predictors with the maximum contribution and information consumption 2 2 construction of streamflow forecast equation based on lstm network streamflow formation is controlled by coupled impacts of numerous hydrometeorological elements and it can be generalized as a black box model with a multiple input single output structure which is strikingly similar to that of a neural network additionally atmospheric circulation factors play a teleconnection role and exhibit long lasting influence on a long term streamflow forecast whereas hydrological elements have negligible impact therefore those factors might be characterized in the lstm network by the long term memory and short term memory respectively kratzert et al 2018 in comparison with hydrological forecast models based on physical mechanisms and machine learning the lstm model demonstrates more robust forecasting and performs well when proposing a forecast for a complicated system with a temporal lag here the deterministic streamflow forecast is developed using the lstm model in two steps 2 2 1 model structure and parameter determination a common lstm network consists of a cell state an input layer several implicit layers and an output layer the cell state stores both the short term memory i e inputs from the current time and the long term memory i e inputs before multiple periods each implicit layer consists of three gates a forget gate an input gate and an output gate and these gates regulate the flow of information into and out of the cell state gers et al 2000 when applied to a hydrological streamflow forecast the model structure can be expressed into a three layered structure as shown in fig 3 a prior processing module such as predictor screening discussed in section 2 1 can be linked to the input layer additionally a post processing module can be connected to the input layer to facilitate real time correction and uncertainty analysis the forget gate is used to receive the long term memory before multiple periods and remove unnecessary information stored in the cell state ct under control of the forget factor kt 6 k t σ w k x t b k where w k is the weight matrix of the forget gate and bk is its bias term the sigmoid function σ transforms each sequence value into a number between 0 and 1 with bigger values indicating less forgetting 0 represents complete forgetting while 1 represents fully remembered if the current information is sufficient to sustain the forecast the long term memory is unnecessary the input gate is used to receive and retain the input for the current time in the cell state under control of the input factor it and the update factor gt 7 i t σ w i x t b i 8 g t tanh w g x t b g where w i and w g are the input weight matrix and update weight matrix of the input gate respectively and bi and bg are their corresponding bias terms the activation function tanh transforms each sequence value into a number between 1 and 1 this gate can be regarded as input preprocessing that avoids perturbation in the streamflow forecast while supplementing the information screened out to ensure the integrity of the lstm network therefore the cell state ct can be updated as follows 9 c t k t c t 1 i t g t the output gate is used to transform the cell state ct to the output of the implicit layer 10 o t σ w o x t b o where w o is the weight matrix of the output gate and bo is its bias term finally the predicted value of streamflow based on lstm can be expressed as follows 11 f x t o t tanh c t 2 2 2 parameter calibration and network training the lstm parameters can be categorized into two groups 1 structural parameters or hyperparameters that include the dimensions of the three layers the number of lstm units in each implicit layer the learning rate and the activation functions and 2 training parameters that include the weight matrix w and its bias term b of each gate for the hyperparameters optimization from a large number of the optional parameters is a nonconvex optimization issue for which a grid based random or bayesian search can be employed to improve the calibration speed usually in the case of a small number of optional parameters an exhaustive method can be used for calibration conversely training parameters can be calibrated using a combination of back and forward propagation the initial parameter set and forecast error can be generated by substituting the initial weights of each gate into eqs 6 to 11 and the errors redistributed based on the gradient information of each gate to update the weights then the updated parameters are generated according to the new weights the above steps are repeated until the error converges to zero or a smaller value at which point the current parameters can be considered optimal 2 3 identification and simulation of time varying streamflow forecast errors based on the garch model the sequence of streamflow forecast error is a nonstationary stochastic series with volatility and periodicity which is affected by various hydrological elements and water income conditions owing to the regulation and storage of reservoirs and river basins the error for previous periods affects that for the current time thus it constitutes a time varying and conditional heteroskedasticity feature lux and marchesi 1998 therefore the garch model is presented to simulate the forecast error with such time varying features pandey et al 2018 besides a recursive forecast is acquired to extend the forecast lead time while some forecasted information streamflow could be used as given information for an extended forecast in later time periods for mitigating the cumulative influence of forecast errors with increased lead time the garch model provides detailed characterization of forecast errors with temporal correlations for refining probabilistic forecasts through error correction 2 3 1 structure of the garch model for streamflow forecast error simulation the garch model was first applied in the field of finance to describe the relationship between stock earnings over certain periods this model can further simulate the variance of a stochastic series which helps in the simulation of a nonstationary time series with volatile aggregation parameters especially that of streamflow forecast errors the fundamental equation of the garch model includes conditional expectation and conditional variance kim and won 2018 where the conditional expectation is given by the lstm model described in section 2 2 and the conditional variance is calculated as follows 12 ε t γ i 1 r α i ε t i j 1 s β j e t j 2 where ε t v a r e t e t 1 e t 2 represents conditional variance of the current forecast error et γ is a constant term αi and βj represent the coefficients of εt i and et j respectively while r and s are the orders of the conditional variance and the error term respectively the model is denoted by e t 2 garch r s which indicates that the current forecast error is affected not only by the forecast error before multiple periods but also by their stochastic disturbance denoted as time varying features 2 3 2 parameter calibration and stochastic simulation of streamflow forecast error scenarios similar to the arma model which is typically developed to simulate a stationary time series the order selection of the garch model can be determined by the truncation characteristics of the autodependence coefficient ac and the partial ac pac the maximum likelihood estimation method is used to calibrate the model parameters such that it can pass the white noise and goodness of fit tests the scenarios of streamflow forecast error e t l e t 1 e t 2 e t l can be derived using a monte carlo mc stochastic simulation coupled with the distribution function according to eq 12 where l is the number of scenarios as expressed in the following 13 y t l f x t e t l y t 1 y t 2 y t l the specific steps are as follows 1 calculate the forecast error et in different months according to eq 1 2 assuming that sequences e t l and e t 1 l follow a normal distribution the conditional variance at time t εt can be calculated furthermore the conditional variance in the subsequent period εt 1 can be obtained using eq 12 3 sequence e t 1 l can be derived via mc simulation method by generating l random numbers e t 1 e t 2 e t l that follow a normal distribution with a mean value equivalent to f x t and a variance of εt 1 4 if sequences e t l or e t 1 l do not exhibit normal distribution it is necessary to apply a transformation 14 e t l ε t δ t l where δ t l δ t 1 δ t 2 δ t l represents the transformation sequence with a mean value of 0 and a variance of 1 the probability distribution of δ t l may be considered as a specific statistical distribution such as the student t or gev distributions that is in line with e t l it has been established that sequence e t l can be classified as any distribution within the garch model 5 generating l random numbers δ t 1 δ t 2 δ t l that follow a specific distribution by mc simulation method and sequence e t 1 l can be derived according to the eq 14 2 4 evaluation metrics of long term streamflow forecast the multidimensional evaluation metrics for the long term streamflow forecast that include accuracy reliability and stability are established to assess the performance of both deterministic and probabilistic streamflow forecasts accuracy is typically measured by the root mean square error rmse which reflects the average deviation between the forecasted and observed values the mathematical expression for the rmse is as follows 15 rmse 1 t t 1 t y t f x t 2 1 t t 1 t e t 2 where t represents the length of the forecast period here the rmse is used to assess the accuracy of the lstm based deterministic streamflow forecast as the rmse decreases the accuracy increases reliability can be represented as the probability that the confidence interval of a probabilistic forecast contains the observed value at a specified confidence level the brier score bs measuring the difference between the expected and actual probability distribution of a forecast event is used to evaluate the reliability of a probabilistic forecast the mathematical expression for the bs is as follows 16 bs 1 t t 1 t pr e t o b s t 2 where pret and obst represent the probability that is forecast and actual outcome of the event 0 if it does not happen and 1 if it does happen at time t respectively this formulation is mostly used for binary prediction such as the presence or absence of precipitation in this study for the quantitative probabilistic forecasts the variable pret can be regarded as the probability that quantitative probabilistic forecasts that fall within the permissible range shown in fig 4 the red range with the center value of actual streamflow while the variable obst represents the probability that observed value falling in the permissible range which actually happened in a reforecast assessment thus obst is set as 1 here therefore the bs can be further expressed as 17 bs 1 t t 1 t c o u n t l y t l y t lower y t upper l 1 2 1 t t 1 t h t 1 2 i 1 n x i where y t upper and y t lower are the limits of the permissible error of the streamflow forecast generally taken as 30 of the relative error and ht represents the hit rate at time t the smaller the bs the higher the reliability according to the definition the most reliable probabilistic forecast generates all scenarios that fall into the permissible range such that ht is one and bs is zero a valuable and reasonable forecast should perform well in risk resistance and have strong stability huang et al 2022 if the confidence interval of a probabilistic forecast does not cover the observed value the closer the interval is to the observed value the more potentially valid information it gives and the more risk resistant it is mistaken distance md assesses the distance of actual streamflow to its closest range bound of a probabilistic forecast given that the probabilistic forecast fails to cover the actual streamflow and it can be used to define the stability of a probabilistic streamflow forecast the mathematical expression for md is as follows 18 md 1 t t 1 t d t 2 d t 0 y t y t 1 α 2 y t 1 α 2 y t 1 α 2 y t y t y t 1 α 2 y t y t 1 α 2 y t y t 1 α 2 where dt is the deviation under the forecast failure condition while y t 1 α 2 and y t 1 α 2 are the limits of the interval of the probabilistic forecast at the confidence level α as the md decreases the stability increases the metrics of rmse bs and md are chosen to evaluate the accuracy reliability and stability respectively with the objective of covering the observed streamflow with a narrow interval and reducing the deviation when the interval cannot cover the observed streamflow thus the multidimensional evaluation of a long term streamflow forecast is conducted 3 case study hongze lake and luoma lake china are selected as the study area for this research fig 5 hongze lake located in the downstream reaches of the huai river has a drainage area of 2596 km2 and it is the fourth largest freshwater lake in china and the largest storage lake in the huai river basin hongze lake lies in the transition zone between subtropical and warm temperate climatic regions and it has four distinct seasons and notable monsoons the annual distributions of rainfall and streamflow are highly unhomogenized i e 65 5 of rainfall occurs during the flood season may september with the concentration increasing from the south to the north and 50 1 of the streamflow generates in summer which is disadvantageous to water resources utilization luoma lake which is in the downstream reaches of the yi shu si river basin has a drainage area of 375 km2 and water storage capacity of 270 million m3 which is much smaller than hongze lake luoma lake is situated in the region of monsoon climate of medium latitudes with an annual precipitation of 764 mm in average which is comparatively lesser than that of hongze lake 925 5 mm moreover the mechanism of runoff generation is saturation excess in hongze lake while that of luoma lake is infiltration excess the flood season starts from june and lasts to october and the non flood season extends from november to may of the following year the hydrological predictors are provided by the river basin administration of hongze lake and luoma lake with various hydrological stations whereas the meteorological and subsurface predictors are obtained from the climate forecast system reanalysis data of the national center for atmospheric research and 130 indexes of atmospheric circulation factors published by the china meteorological administration the calibration period spans from year 1961 to 1999 whereas the validation period is limited to the years between 2000 and 2009 three hydrological years a dry year in 2002 a normal year in 2008 and a wet year in 2003 were selected for systematic evaluation of the streamflow forecast 3 1 driving predictor screening and predictor set construction according to the hydroclimatic characteristics of two study areas the main meteorological factors affecting streamflow are sea surface temperature sst atmosphere pressure and wind speed kopparla et al 2013 trenberth and shea 2005 these factors are associated with the southeast monsoon and the western pacific subtropical high which directly influence vapor transport and indexes that include the northern hemisphere subtropical high area intensity index nhsha nhshi pacific subtropical high area intensity index psha pshi northern hemisphere polar vortex area intensity index nhpva nhpvi asian meridional circulation index amc and east asian trough intensity index eati additionally sunspots el niño and la niña also have periodic effects on the regional hydrological cycle together with precipitation evaporation streamflow and subsurface factors such as soil moisture these factors form the initial predictor set previous studies have utilized correlation coefficients to determine the importance of individual predictors however this method may not adequately capture the intricate and implicit interactions of nonlinear dependencies to contrast ce not only identifies the interactive effects of predictors but also quantifies the contributions of each predictor within the effective forecasting period according to tables 2 to 3 the asterisked superscripts indicate the failure of significance test selection with ce retains predictors with significant linear relationships the bold texts and figures in the tables while copula entropy can fully explore the interaction effects between these factors screening the key driving factors for streamflow forecasts cross entropy describes the redundancy between predictors while conditional entropy provides the information value of a combination of critical predictors as shown in tables 4 and 5 the driving predictor sets for two lakes streamflow forecasts are obtained by maximizing the conditional entropy and minimizing the cross entropy besides the input of natural water during the non flood season especially the pre flood season is primarily influenced by the recession of previous streamflow and groundwater recharge which are less influenced by meteorological factors the most influential predictors are hydrological factors such as streamflow and soil moisture in contrast the input of natural water during the flood season is driven by the precipitation evaporation term denoted as pe which represents precipitation minus evaporation and meteorological phenomena with remote correlation features 3 2 deterministic streamflow forecasting based on lstm the lstm model is used to forecast the monthly streamflow of two lakes because the input layer dimension does not exceed 4 while the output layer dimension is only 1 the number of implied layers is set to 1 and the learning rate is set to 0 001 before modeling the streamflow series are deseasonalized to remove nonstationary and periodic terms the performance during the calibration period figs 6 to 7 demonstrate that lstm based model exhibits a significantly higher degree of accuracy especially during the flood season from may to september when compared to other machine learning models e g random forest model rf this observation suggests that lstm can provide superior streamflow forecasts in two lakes than the benchmark model the lstm based deterministic forecasts during the validation period are shown in fig 8 relative errors during the non flood season are kept within 20 indicating an accurate and reliable forecast in contrast the forecast during the flood season yield higher errors particularly in july and august this is because precipitation influences streamflow most in the flood season and the effective lead time of the quantitative precipitation forecast is less than 2 months compared to the lstm model rf model exhibits a noticeable decrease in accuracy with an average relative error increase of 50 9 during the flood season and rf model fails to forecasting streamflow trends during the non flood season besides it can be observed that the precision of the streamflow forecasts for hongze lake is superior to that of luoma lake 3 3 streamflow forecast error analysis and probabilistic forecasting providing an accurate and reliable streamflow forecast with a deterministic forecast scheme is difficult when the forecast lead time is beyond the effective lead time whereas a probabilistic forecast combined with error analysis which can provide richer information regarding the confidence interval has proven to be an effective method in this study two garch 1 1 models with various parameters are employed to characterize forecast errors in two lakes throughout the calibration period while the moving average ma method is introduced as a comparison specific procedures of errors analysis in two lakes streamflow forecasts by garch model with calibration can be found in the supplementary materials the fitness of error sequences during the calibration period fig 9 indicates that the ma method is insufficient in accurately characterizing errors that exhibit clustering volatility and temporal dependency the garch model in contrast has been observed to effectively preserve these characteristics leading to a precise fit and exhibiting significant potential in forecasting performance during the validation period during the validation period a probabilistic forecast is generalized by combining deterministic forecast by lstm and scenario of simulated errors by garch denoted as lstm garch model similarly a lstm ma model is also introduced the difference between the proposed lstm garch model blue range in figs 10 and 11 and lstm ma model gray range in figs 10 and 11 are attributed to the value of precise characterization of forecast errors the 90 confidence interval of the probabilistic streamflow forecast mostly covers the observed streamflow points indicating that the probabilistic forecast provides valuable information in estimating streamflow s confidential range when the forecast lead time is 1 month the proposed model can reduce the width of the confidence interval 46 3 in hongze lake and 39 9 in luoma lake without notably affecting the hit rate 8 3 in hongze lake and 5 0 in luoma lake with extension of the lead time the gap reduces indicating gradual decline in the reliability of the probabilistic forecast when the forecast lead time exceeds 4 months the gap is rather small as shown in figs 10 d and 11 d illustrating that the statistical characteristics of the forecast errors are less representative under such circumstances therefore the lstm garch model can improve the forecasting capability by extending the effective lead time to 3 months 3 4 long term streamflow forecast evaluation considering accuracy reliability stability performance evaluation of streamflow forecast accuracy is based on the deterministic forecasts conducted in section 3 2 whereas the reliability and stability are based on the probabilistic forecasts proposed in section 3 3 to investigate the contributions of each module in the hierarchical optimization eight forecasting schemes with a 1 month forecast lead time are proposed in table 6 in comparison with scheme s ⅰ scheme s ⅱ express an apparent loss in accuracy fig 12 indicated by larger deviation rmse increases by 16 9 in hongze lake while 27 3 in luoma lake indicating the significance of methodology factors in long term streamflow forecasts for scheme s iii the annual forecasting value is broadly similar in different hydrological years demonstrating that redundant information with high uncertainty reduces reliability and diminishes the value of the streamflow forecast for the probabilistic streamflow forecasts figs 13 and 14 bandwidth represents the forecast uncertainty while deviation contributes to the safety of forecasting in a flood event when the better optimized predictors and equation are determined scheme ⅰ the forecast uncertainty decreases markedly 39 4 in hongze lake and 40 8 in luoma lake with reduction in the probability of forecast failure 5 1 and 7 5 in hit rate respectively resulting in satisfactory streamflow forecasts furthermore transversal comparison of these schemes demonstrates that lack in predictor or forecast equation optimization makes it impossible to provide representative error samples for the garch model thereby reducing the value of identification of forecast errors moreover scheme iii which employs no hierarchical optimization performs worst among these schemes it takes the highest hit rate above 95 in two lakes by a rather large forecast interval two times larger than scheme ⅰ but still fails in forecasting the high flow event figs 15 and 16 shows the evaluation proposed in section 2 4 for estimating various forecast schemes all the evaluations exhibit a poor characteristic during the flood season and strong performance during the non flood season indicating the difficulty in streamflow forecasting during the flood season the forecasts that incorporate predictor screening or equation optimization outperform those that do not in terms of accuracy and reliability rmse is lower down by 6 7 34 8 and bs is lower down by 15 3 27 9 in two lakes while equation optimization contributes more to accuracy and predictor screening contributes more to reliability they can provide reliable error information for the streamflow forecast to improve accuracy additionally detailed statistical error analysis using the garch model can effectively grasp the time varying features which assists in properly simulating the scenario of forecast errors to strengthen the stability of the probabilistic forecast in comparison with that of the traditional method 36 4 51 6 reduction in md in two lakes in conclusion the proposed streamflow forecast model is characterized by high accuracy reliability and stability which could provide effective and comprehensive supporting information for water resources management 4 conclusions an accurate reliable and stable streamflow forecast is the basis and core of water resources planning and management and it could provide effective decision making information for water resources utilization this study used input structure parameter hierarchical optimization to upgrade the predictors forecast equation and errors respectively first the contribution of the predictors is evaluated based on information entropy theory which directs the screening of the driving predictor set the lstm model is then used to construct a long term deterministic streamflow forecast and the errors at different forecast lead times are obtained finally the garch model is used to statistically assess the time varying errors and produce a long term probabilistic streamflow forecast considering forecast uncertainty the proposed model is used to forecast the monthly streamflow of two lakes hongze and luoma lake in china which was evaluated using multidimensional indexes considering accuracy reliability stability performance and the main conclusions derived are summarized below 1 predictor screening based on information entropy can finely explore the statistical characteristics of predictors and streamflow in which ce can quantitatively assess the contribution of a single factor and conditional entropy can describe the combined utility of multiple factors thereby providing valuable information for streamflow forecasting 2 the lstm model can exploit the nonlinear response between the driving predictors and streamflow thereby improving the accuracy and reliability of a streamflow forecast besides forecast errors might have time varying characteristics with clustering volatility and temporal dependency in a recursive forecast and the garch model identifies these features which improves the simulation of forecast errors reduces the probability of forecast failure and enhances the stability of a streamflow forecast 3 under the current meteorological observation conditions and forecasting capability the maximum effective lead time of the lstm based deterministic streamflow forecast is 1 month while the effective lead time of the lstm garch based probabilistic streamflow forecast can be extended to 3 months 4 in comparison with the benchmark forecast model the proposed model can substantially improve the accuracy rmse 6 7 34 8 reliability bs 15 3 27 9 and stability md 36 4 52 6 in both two lakes indicating that inputs structure parameters hierarchical optimization based on information refinement and screening can provide effective and profitable decision making information for water resources management credit authorship contribution statement ran mo methodology software funding acquisition bin xu supervision methodology funding acquisition ping an zhong conceptualization yuanheng dong formal analysis data curation han wang investigation hao yue investigation jian zhu methodology huili wang validation guoqing wang conceptualization jianyun zhang conceptualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study is supported by the national key technologies r d program of china grant no 2021yfc3000104 the national natural science foundation of china grant nos 52121006 41961124007 postgraduate research practice innovation program of jiangsu province grant no kycx23 0710 data will be made available on contacting the first author appendix specific procedures of errors analysis in two lakes streamflow forecasts by garch model with calibration the stationary and temporal correlation of forecast errors namely the arch effect is first examined the ljung box q test is used to test whether any of a group of autocorrelations of the forecast error series are different from 0 we can construct the statistic q as follows a1 q n n 2 i 1 m ρ i n i where n is the sample size ρ i is the autocorrelation at lag i and m represents the number of lags being tested under the hypothesis that the error series are independently distributed the statistic q follows a chi square distribution χ h 2 the ljung box q test illustrates that when the confidence level is 90 the p value are all below 0 001 which is smaller than the critical value of rejection of 0 05 indicating that the error series can be considered suitable for the garch model according to the ac and pac in fig a1 two garch 1 1 model with various parameters are constructed as follows a2 ε t 0 374 0 295 ε t 1 0 300 e t 1 2 a3 ε t 0 016 0 602 ε t 1 0 196 e t 1 2 the scenarios of forecast errors of two lakes are produced according to the steps in section 2 3 which exhibits the same stochastic characteristics as the sample series indicating the validity of the garch model fig a2 on the contrary a conventional model using the moving average ma method exclusively is presented to simulate the forecast errors which ignores their clustering volatility and temporal dependency both methods can obtain statistical distributions of sample errors appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129736 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
1829,accurate reliable and stable streamflow forecasts are essential for risk assessment and decision making in water resources management owing to the limited value of deterministic forecasting probabilistic forecasting incorporating probability and confidence intervals is achieved by optimizing the predictors and forecast equation while identifying forecast error features the combination of deterministic forecasts and error identification can facilitate water resources management this study improved the traditional forecast model s inputs selection structure designation and error parameters calibration to propose a long term probabilistic streamflow forecast model with hierarchical optimization of the predictors forecast equation and errors characteristics the model develops information entropy theory to screen the driving predictor set the long short term memory lstm model to conduct deterministic forecasts and the generalized autoregressive conditional heteroskedasticity garch model to identify time varying errors the proposed model used in some case studies to forecast the monthly streamflow of two lakes hongze and luoma lakes in china was evaluated using the multidimensional index method considering accuracy reliability stability performance the results revealed the following 1 predictor screening based on information entropy investigates the statistical characteristics of predictors thereby improving the reliability of streamflow forecasts 2 the lstm model exploits the response between the driving predictors and streamflow whereas garch model identifies the time varying features of forecast errors effectively which reduces the probability of forecast failure and increases the accuracy and stability of probabilistic forecasts 3 under current meteorological observation conditions and forecasting capability the proposed forecasts can extend the maximum forecast lead time from 1 month to 3 months 4 the proposed model improves the accuracy root mean square error 6 7 34 8 reliability brier score 15 3 27 9 and stability mistaken distance 36 4 52 6 in comparison with the benchmark of the two case studies indicating that inputs structure parameters hierarchical optimization provides effective forecast information for water resources management keywords long term streamflow forecast inputs structure parameters hierarchical optimization information entropy theory lstm model garch model data availability data will be made available on request 1 introduction a long term streamflow forecast which often refers to a streamflow forecast with a lead time exceeding 1 month can offer practical information for water resource planning and management yeh 1985 existing methods make it difficult to effectively simulate the streamflow process under the influence of complex runoff formulation and deterministic streamflow forecasts cannot provide accurate and reliable information xu et al 2019 because reservoir regulation has a certain buffering effect on forecast error a probabilistic streamflow forecast with quantitative probability and confidence intervals is proposed by integrating a deterministic forecast and errors with stochastic feature identification to facilitate reservoir regulation hashimoto et al 1982 krzysztofowicz 1999 often three basic metrics are used for the evaluation of a streamflow forecast accuracy reliability and stability duan et al 2007 accuracy represents quantification of the error of deterministic forecasts reliability defines the possibility of probabilistic forecasts covering the observed value and stability evaluates the deviation when the forecast cannot cover the observed value under extreme conditions provision of a valuable streamflow forecast requires an accurate reliable and stable method ajami et al 2008 these indexes are typically affected by the predictors forecast equation and forecast errors the predictors and forecast equation represent the physical process of runoff generation fatichi et al 2016 the former extract the major hydrological elements that affect natural streamflow via runoff generation or sequence decomposition whereas the latter describes the relationship between these elements and streamflow through mathematical expression the forecast error which is generally a representation of the magnitude of deviation between the forecast and observed values is a comprehensive term of the uncertainty in a streamflow forecast also it is an important metric for evaluating the forecast quality of a forecast model benke et al 2008 sivakumar 2000 the selection of different predictors and equations which affects the deterministic forecast model and determines the statistical distribution of the errors can impact the quality of probabilistic forecast performance therefore probabilistic streamflow forecast can be enhanced by selecting appropriate predictors modifying the model structure and optimizing the error parameters shukla and lettenmaier 2011 selection of appropriate predictors is fundamental to ensuring forecast stability and enhancing model generalization liu and gupta 2007 selection of predictors in previous research used correlation coefficients and principal component analysis fathian et al 2016 markonis et al 2018 however such methods can investigate only the linear correlation between predictors which is unsuitable for capturing the complex nonlinear features of hydrological factors in long term streamflow forecasts xie et al 2022 additionally interactive effects between these factors make it difficult to identify combinational driving predictors ignoring such interactions could lead to redundancy which would magnify the uncertainties affected by random perturbations in model inputs darbandsari and coulibaly 2020 copula entropy ce in information theory which links the copula function with information entropy is similar to formulate the joint distribution of multivariate random variables that combines the marginal distribution and the conditional probability distribution chen et al 2013 it is suitable for assessing the effect of interaction of numerous predictors and their combined effect on streamflow determination of both the forecast structure and the forecast equation is beneficial to the improvement of forecast accuracy and reliability data driven models can extract data features from historical streamflow series and establish the mapping function from appropriate predictors to streamflow which remains the principal method for long term streamflow forecasting gu et al 2021 zhao et al 2021 generally models can be divided into the following five categories according to the passage of time 1 models based on mathematical and statistical methods e g regression analysis carlson et al 1970 time series bender and simonovic 1994 and wavelet analysis lafrenière and sharp 2003 2 models based on signal decomposition e g empirical mode decomposition huang et al 1998 complete ensemble empirical mode decomposition yeh et al 2011 and variational mode decomposition wang et al 2021 3 models based on machine learning e g support vector machines asefa et al 2006 artificial neural networks hu et al 2005 and chaos theory dhanya and nagesh kumar 2011 4 models based on deep learning e g recursive neural networks kratzert et al 2018 recurrent neural networks wang et al 2021 and generative adversarial networks ma et al 2022 and 5 integrated models based on optimization algorithms coupled with multiple models niu et al 2021 zhang et al 2020 in recent years with the rapid developments in high performance computing and growth in artificial intelligence approaches the application of deep learning models has made remarkable progress in contrast to conventional machine learning and other techniques this approach stresses the longitudinal depth of the network and might comprehend complex stochastic features from sufficient input by creating several nonlinear processing units lecun et al 2015 such methods can refine the system state with minimal model parameters while maintaining precise fitting wang et al 2020 xiang et al 2020 identification of the stochastic characteristics of forecast errors enhances the reliability and stability of probabilistic forecasts numerous related studies have demonstrated that forecast errors do not satisfy the assumption of independence and temporal stationarity but instead have time varying characteristics influenced by the deviation perturbation and transmission of hydrometeorological processes in real time forecasting liang et al 2021 xu 2021 for example climatological and hydrological variables influence the process of runoff generation and conservation resulting in spatio temporal correlation and a fat tailed distribution of streamflow forecast uncertainties mo et al 2021 xu et al 2022 as time proceeds multistep extending forecasts tend to amplify such uncertainties thereby reducing the value of the forecast the generalized autoregressive conditional heteroskedasticity garch model is a stochastic model used in finance to describe the volatility of the ratio of earnings engle and bollerslev 1986 it is suitable for simulating time series with aggregated volatility such as the systematically large errors of a streamflow forecast in consecutive periods attributable to failure in the forecast of precipitation it can also be used to simulate nonstationary series with time varying parameters and asymmetric volatility and thus it has excellent application potential in the fields of hydrology and water resources management modarres and ouarda 2013 nazeri tahroudi et al 2022 the structure of a streamflow forecast model can be optimized according to the hydrometeorological characteristics of the study area including input preprocessing predictor selection structure adjustment forecast equation modification and output postprocessing forecast error analysis which together constitute hierarchical optimization however previous related studies typically concentrated on improving just one part of the model rather than considering overall optimization this paper proposes a long term probabilistic streamflow forecast model with inputs structure parameters hierarchical optimization the driving predictors are screened based on physical cause analysis and information entropy while the long short term memory lstm model is used to produce deterministic streamflow forecasting the garch model is used to identify the parameters of forecast errors to obtain probabilistic streamflow forecasting application of the proposed model to some case studies of the hongze lake basin and luoma lake china realized improved accuracy dependability and stability of streamflow forecasts distinct from previous related work the proposed model 1 identified driving predictors for streamflow forecasts using information entropy and copula entropy was introduced for capturing the interaction between these predictors thereby improving the reliability of forecasts 2 refined structure of streamflow forecasts via a deep learning model to characterize the mechanism of runoff generation and conservation on a long term timescale which enhanced forecast accuracy 3 addressed forecast errors with clustering volatility and temporal dependency by the garch model which described the stochastic characteristics of forecast errors precisely maintaining certain stability of probabilistic streamflow forecasts 4 optimized the designation of streamflow forecast model in inputs predictors structure forecast equation and outputs forecast errors factors thus improving forecast performance and extending the lead time 2 methodology the long term streamflow forecast model can be expressed as follows 1 y t f x t e t f x t 1 x t τ e t where yt is the streamflow for the current time t x t is the set of predictors wherein xt τ represent the predictors with interval τ periods from the current time f represents the forecast equation and et represents the forecast errors the scenario of a probabilistic streamflow forecast can be proposed if the predictors forecast equation and errors with a particular statistical distribution are provided when the predictors are not absolutely observed values they can be replaced by forecasted values for recursive forecasting to extend the forecast lead time a structural flow chart of the model framework is illustrated in fig 1 sections 2 1 2 3 introduce the three layers of the proposed model namely predictor selection equation modification and error characterization respectively and section 2 4 develops the three indicators to evaluate the accuracy reliability and stability of this model 2 1 predictor screening method based on information entropy theory on the basis of the regional characteristics of runoff generation and conservation influencing hydrological and meteorological elements are selected as predictors and a physical or mathematical model is constructed to describe the complex nonlinear relationships between these predictors independent variables and the streamflow dependent variable the first step is to identify the driving predictors to minimize the subset of predictors with the most critical impact on streamflow this can be accomplished from the following three perspectives collecting the initial predictors choosing the contribution indicators and selecting the driving predictors 2 1 1 construction of the initial predictor set existing studies indicated that hydrometeorological elements such as precipitation evaporation temperature atmospheric pressure and sea surface temperature are the main factors that influence the process of streamflow dong et al 2018 ionita et al 2008 oubeidillah et al 2012 wu et al 2020 while regional subsurface characteristics might affect the formulation of runoff therefore the predictors presented in table 1 are selected to construct the initial predictor set x u 2 1 2 evaluation of predictors contributions the significance and contribution of the initial predictors need to be analyzed to select the driving predictors streamflow can be viewed as a stochastic series perturbed by numerous hydrological factors with uncertainties often it is a challenge to characterize explicitly the interaction between these predictors leading to uncertainty in streamflow forecasts when the value or range of a predictor is determined the probability of a streamflow value within a particular interval increases accordingly resulting in a more focused distribution of forecasted values and reduction in uncertainty consequently information entropy is used here to characterize the interaction between the independent and dependent variables information entropy is used to quantify the uncertainty of random variables in the field of information science 2 h q i 1 n p q i log p q i where q q 1 q 2 q n is a discrete random variable with probability distribution p p q 1 p q 2 p q n i 1 n p q i 1 as the uncertainty of the random variable increases its information entropy increases additionally for a binary random variable z 1 z 2 the joint entropy can be defined as follows 3 h z 1 z 2 z 1 z 1 z 2 z 2 p z 1 z 2 log p z 1 z 2 where p z 1 z 2 is the joint probability density function conditional entropy considers the prior distribution of known variables and estimates the posterior distribution of unknown variables as shown in fig 2 which is defined as follows 4 h z 1 z 2 z 1 z 1 z 2 z 2 p z 1 z 2 log p z 1 z 2 h z 1 z 2 h z 2 where p z 1 z 2 is the conditional probability distribution of variable z 1 if variable z 2 is known measuring the interactive contribution of multiple predictors to a streamflow forecast based on a single factor index is however not easy dong et al 2004 ce is a nonlinear correlation metric that evaluates multivariate and high order correlations which can be used to estimate the contribution of a predictor set to streamflow chen et al 2013 ma and sun 2011 given an n dimensional random variable z 1 z 2 z n with a marginal distribution u i f i z i i 1 2 n where f represents the cumulative probability density function ce can be defined as follows 5 c e z 1 z 2 z n 0 1 0 1 c u 1 u n log c u 1 u n d u 1 d u n where c is the copula function ce is a popularization of information entropy to the high order and continuous random variables with the joint distribution p replaced by c it can increase flexibility in characterizing multivariate interaction and it is suitable for describing the contributions of predictors in a complex situation involving high dimensional variables 2 1 3 screening of predictors and generation of driving predictor set incorporating as many high quality predictors as possible is critical for enhancing the practical value of a streamflow forecast too few predictors might reduce accuracy while too many might lead to model generalization and enlarged forecast uncertainty moreover when the forecast lead time exceeds the effective lead time of the predictors the forecast values of the predictors sometimes need to be substituted for the observed values in recursive forecasting thus the reliability of the predictors is also a critical index for predictor screening here predictors with physical causes are evaluated to eliminate those with low accuracy and reliability then the contribution of each of the remaining predictors is ranked based on ce and some of the top ranked predictors are selected as potential driving predictors the conditional entropy is then developed to assess the effects of interaction between various combinations finally the driving predictor set x is recognized as the subset of predictors with the maximum contribution and information consumption 2 2 construction of streamflow forecast equation based on lstm network streamflow formation is controlled by coupled impacts of numerous hydrometeorological elements and it can be generalized as a black box model with a multiple input single output structure which is strikingly similar to that of a neural network additionally atmospheric circulation factors play a teleconnection role and exhibit long lasting influence on a long term streamflow forecast whereas hydrological elements have negligible impact therefore those factors might be characterized in the lstm network by the long term memory and short term memory respectively kratzert et al 2018 in comparison with hydrological forecast models based on physical mechanisms and machine learning the lstm model demonstrates more robust forecasting and performs well when proposing a forecast for a complicated system with a temporal lag here the deterministic streamflow forecast is developed using the lstm model in two steps 2 2 1 model structure and parameter determination a common lstm network consists of a cell state an input layer several implicit layers and an output layer the cell state stores both the short term memory i e inputs from the current time and the long term memory i e inputs before multiple periods each implicit layer consists of three gates a forget gate an input gate and an output gate and these gates regulate the flow of information into and out of the cell state gers et al 2000 when applied to a hydrological streamflow forecast the model structure can be expressed into a three layered structure as shown in fig 3 a prior processing module such as predictor screening discussed in section 2 1 can be linked to the input layer additionally a post processing module can be connected to the input layer to facilitate real time correction and uncertainty analysis the forget gate is used to receive the long term memory before multiple periods and remove unnecessary information stored in the cell state ct under control of the forget factor kt 6 k t σ w k x t b k where w k is the weight matrix of the forget gate and bk is its bias term the sigmoid function σ transforms each sequence value into a number between 0 and 1 with bigger values indicating less forgetting 0 represents complete forgetting while 1 represents fully remembered if the current information is sufficient to sustain the forecast the long term memory is unnecessary the input gate is used to receive and retain the input for the current time in the cell state under control of the input factor it and the update factor gt 7 i t σ w i x t b i 8 g t tanh w g x t b g where w i and w g are the input weight matrix and update weight matrix of the input gate respectively and bi and bg are their corresponding bias terms the activation function tanh transforms each sequence value into a number between 1 and 1 this gate can be regarded as input preprocessing that avoids perturbation in the streamflow forecast while supplementing the information screened out to ensure the integrity of the lstm network therefore the cell state ct can be updated as follows 9 c t k t c t 1 i t g t the output gate is used to transform the cell state ct to the output of the implicit layer 10 o t σ w o x t b o where w o is the weight matrix of the output gate and bo is its bias term finally the predicted value of streamflow based on lstm can be expressed as follows 11 f x t o t tanh c t 2 2 2 parameter calibration and network training the lstm parameters can be categorized into two groups 1 structural parameters or hyperparameters that include the dimensions of the three layers the number of lstm units in each implicit layer the learning rate and the activation functions and 2 training parameters that include the weight matrix w and its bias term b of each gate for the hyperparameters optimization from a large number of the optional parameters is a nonconvex optimization issue for which a grid based random or bayesian search can be employed to improve the calibration speed usually in the case of a small number of optional parameters an exhaustive method can be used for calibration conversely training parameters can be calibrated using a combination of back and forward propagation the initial parameter set and forecast error can be generated by substituting the initial weights of each gate into eqs 6 to 11 and the errors redistributed based on the gradient information of each gate to update the weights then the updated parameters are generated according to the new weights the above steps are repeated until the error converges to zero or a smaller value at which point the current parameters can be considered optimal 2 3 identification and simulation of time varying streamflow forecast errors based on the garch model the sequence of streamflow forecast error is a nonstationary stochastic series with volatility and periodicity which is affected by various hydrological elements and water income conditions owing to the regulation and storage of reservoirs and river basins the error for previous periods affects that for the current time thus it constitutes a time varying and conditional heteroskedasticity feature lux and marchesi 1998 therefore the garch model is presented to simulate the forecast error with such time varying features pandey et al 2018 besides a recursive forecast is acquired to extend the forecast lead time while some forecasted information streamflow could be used as given information for an extended forecast in later time periods for mitigating the cumulative influence of forecast errors with increased lead time the garch model provides detailed characterization of forecast errors with temporal correlations for refining probabilistic forecasts through error correction 2 3 1 structure of the garch model for streamflow forecast error simulation the garch model was first applied in the field of finance to describe the relationship between stock earnings over certain periods this model can further simulate the variance of a stochastic series which helps in the simulation of a nonstationary time series with volatile aggregation parameters especially that of streamflow forecast errors the fundamental equation of the garch model includes conditional expectation and conditional variance kim and won 2018 where the conditional expectation is given by the lstm model described in section 2 2 and the conditional variance is calculated as follows 12 ε t γ i 1 r α i ε t i j 1 s β j e t j 2 where ε t v a r e t e t 1 e t 2 represents conditional variance of the current forecast error et γ is a constant term αi and βj represent the coefficients of εt i and et j respectively while r and s are the orders of the conditional variance and the error term respectively the model is denoted by e t 2 garch r s which indicates that the current forecast error is affected not only by the forecast error before multiple periods but also by their stochastic disturbance denoted as time varying features 2 3 2 parameter calibration and stochastic simulation of streamflow forecast error scenarios similar to the arma model which is typically developed to simulate a stationary time series the order selection of the garch model can be determined by the truncation characteristics of the autodependence coefficient ac and the partial ac pac the maximum likelihood estimation method is used to calibrate the model parameters such that it can pass the white noise and goodness of fit tests the scenarios of streamflow forecast error e t l e t 1 e t 2 e t l can be derived using a monte carlo mc stochastic simulation coupled with the distribution function according to eq 12 where l is the number of scenarios as expressed in the following 13 y t l f x t e t l y t 1 y t 2 y t l the specific steps are as follows 1 calculate the forecast error et in different months according to eq 1 2 assuming that sequences e t l and e t 1 l follow a normal distribution the conditional variance at time t εt can be calculated furthermore the conditional variance in the subsequent period εt 1 can be obtained using eq 12 3 sequence e t 1 l can be derived via mc simulation method by generating l random numbers e t 1 e t 2 e t l that follow a normal distribution with a mean value equivalent to f x t and a variance of εt 1 4 if sequences e t l or e t 1 l do not exhibit normal distribution it is necessary to apply a transformation 14 e t l ε t δ t l where δ t l δ t 1 δ t 2 δ t l represents the transformation sequence with a mean value of 0 and a variance of 1 the probability distribution of δ t l may be considered as a specific statistical distribution such as the student t or gev distributions that is in line with e t l it has been established that sequence e t l can be classified as any distribution within the garch model 5 generating l random numbers δ t 1 δ t 2 δ t l that follow a specific distribution by mc simulation method and sequence e t 1 l can be derived according to the eq 14 2 4 evaluation metrics of long term streamflow forecast the multidimensional evaluation metrics for the long term streamflow forecast that include accuracy reliability and stability are established to assess the performance of both deterministic and probabilistic streamflow forecasts accuracy is typically measured by the root mean square error rmse which reflects the average deviation between the forecasted and observed values the mathematical expression for the rmse is as follows 15 rmse 1 t t 1 t y t f x t 2 1 t t 1 t e t 2 where t represents the length of the forecast period here the rmse is used to assess the accuracy of the lstm based deterministic streamflow forecast as the rmse decreases the accuracy increases reliability can be represented as the probability that the confidence interval of a probabilistic forecast contains the observed value at a specified confidence level the brier score bs measuring the difference between the expected and actual probability distribution of a forecast event is used to evaluate the reliability of a probabilistic forecast the mathematical expression for the bs is as follows 16 bs 1 t t 1 t pr e t o b s t 2 where pret and obst represent the probability that is forecast and actual outcome of the event 0 if it does not happen and 1 if it does happen at time t respectively this formulation is mostly used for binary prediction such as the presence or absence of precipitation in this study for the quantitative probabilistic forecasts the variable pret can be regarded as the probability that quantitative probabilistic forecasts that fall within the permissible range shown in fig 4 the red range with the center value of actual streamflow while the variable obst represents the probability that observed value falling in the permissible range which actually happened in a reforecast assessment thus obst is set as 1 here therefore the bs can be further expressed as 17 bs 1 t t 1 t c o u n t l y t l y t lower y t upper l 1 2 1 t t 1 t h t 1 2 i 1 n x i where y t upper and y t lower are the limits of the permissible error of the streamflow forecast generally taken as 30 of the relative error and ht represents the hit rate at time t the smaller the bs the higher the reliability according to the definition the most reliable probabilistic forecast generates all scenarios that fall into the permissible range such that ht is one and bs is zero a valuable and reasonable forecast should perform well in risk resistance and have strong stability huang et al 2022 if the confidence interval of a probabilistic forecast does not cover the observed value the closer the interval is to the observed value the more potentially valid information it gives and the more risk resistant it is mistaken distance md assesses the distance of actual streamflow to its closest range bound of a probabilistic forecast given that the probabilistic forecast fails to cover the actual streamflow and it can be used to define the stability of a probabilistic streamflow forecast the mathematical expression for md is as follows 18 md 1 t t 1 t d t 2 d t 0 y t y t 1 α 2 y t 1 α 2 y t 1 α 2 y t y t y t 1 α 2 y t y t 1 α 2 y t y t 1 α 2 where dt is the deviation under the forecast failure condition while y t 1 α 2 and y t 1 α 2 are the limits of the interval of the probabilistic forecast at the confidence level α as the md decreases the stability increases the metrics of rmse bs and md are chosen to evaluate the accuracy reliability and stability respectively with the objective of covering the observed streamflow with a narrow interval and reducing the deviation when the interval cannot cover the observed streamflow thus the multidimensional evaluation of a long term streamflow forecast is conducted 3 case study hongze lake and luoma lake china are selected as the study area for this research fig 5 hongze lake located in the downstream reaches of the huai river has a drainage area of 2596 km2 and it is the fourth largest freshwater lake in china and the largest storage lake in the huai river basin hongze lake lies in the transition zone between subtropical and warm temperate climatic regions and it has four distinct seasons and notable monsoons the annual distributions of rainfall and streamflow are highly unhomogenized i e 65 5 of rainfall occurs during the flood season may september with the concentration increasing from the south to the north and 50 1 of the streamflow generates in summer which is disadvantageous to water resources utilization luoma lake which is in the downstream reaches of the yi shu si river basin has a drainage area of 375 km2 and water storage capacity of 270 million m3 which is much smaller than hongze lake luoma lake is situated in the region of monsoon climate of medium latitudes with an annual precipitation of 764 mm in average which is comparatively lesser than that of hongze lake 925 5 mm moreover the mechanism of runoff generation is saturation excess in hongze lake while that of luoma lake is infiltration excess the flood season starts from june and lasts to october and the non flood season extends from november to may of the following year the hydrological predictors are provided by the river basin administration of hongze lake and luoma lake with various hydrological stations whereas the meteorological and subsurface predictors are obtained from the climate forecast system reanalysis data of the national center for atmospheric research and 130 indexes of atmospheric circulation factors published by the china meteorological administration the calibration period spans from year 1961 to 1999 whereas the validation period is limited to the years between 2000 and 2009 three hydrological years a dry year in 2002 a normal year in 2008 and a wet year in 2003 were selected for systematic evaluation of the streamflow forecast 3 1 driving predictor screening and predictor set construction according to the hydroclimatic characteristics of two study areas the main meteorological factors affecting streamflow are sea surface temperature sst atmosphere pressure and wind speed kopparla et al 2013 trenberth and shea 2005 these factors are associated with the southeast monsoon and the western pacific subtropical high which directly influence vapor transport and indexes that include the northern hemisphere subtropical high area intensity index nhsha nhshi pacific subtropical high area intensity index psha pshi northern hemisphere polar vortex area intensity index nhpva nhpvi asian meridional circulation index amc and east asian trough intensity index eati additionally sunspots el niño and la niña also have periodic effects on the regional hydrological cycle together with precipitation evaporation streamflow and subsurface factors such as soil moisture these factors form the initial predictor set previous studies have utilized correlation coefficients to determine the importance of individual predictors however this method may not adequately capture the intricate and implicit interactions of nonlinear dependencies to contrast ce not only identifies the interactive effects of predictors but also quantifies the contributions of each predictor within the effective forecasting period according to tables 2 to 3 the asterisked superscripts indicate the failure of significance test selection with ce retains predictors with significant linear relationships the bold texts and figures in the tables while copula entropy can fully explore the interaction effects between these factors screening the key driving factors for streamflow forecasts cross entropy describes the redundancy between predictors while conditional entropy provides the information value of a combination of critical predictors as shown in tables 4 and 5 the driving predictor sets for two lakes streamflow forecasts are obtained by maximizing the conditional entropy and minimizing the cross entropy besides the input of natural water during the non flood season especially the pre flood season is primarily influenced by the recession of previous streamflow and groundwater recharge which are less influenced by meteorological factors the most influential predictors are hydrological factors such as streamflow and soil moisture in contrast the input of natural water during the flood season is driven by the precipitation evaporation term denoted as pe which represents precipitation minus evaporation and meteorological phenomena with remote correlation features 3 2 deterministic streamflow forecasting based on lstm the lstm model is used to forecast the monthly streamflow of two lakes because the input layer dimension does not exceed 4 while the output layer dimension is only 1 the number of implied layers is set to 1 and the learning rate is set to 0 001 before modeling the streamflow series are deseasonalized to remove nonstationary and periodic terms the performance during the calibration period figs 6 to 7 demonstrate that lstm based model exhibits a significantly higher degree of accuracy especially during the flood season from may to september when compared to other machine learning models e g random forest model rf this observation suggests that lstm can provide superior streamflow forecasts in two lakes than the benchmark model the lstm based deterministic forecasts during the validation period are shown in fig 8 relative errors during the non flood season are kept within 20 indicating an accurate and reliable forecast in contrast the forecast during the flood season yield higher errors particularly in july and august this is because precipitation influences streamflow most in the flood season and the effective lead time of the quantitative precipitation forecast is less than 2 months compared to the lstm model rf model exhibits a noticeable decrease in accuracy with an average relative error increase of 50 9 during the flood season and rf model fails to forecasting streamflow trends during the non flood season besides it can be observed that the precision of the streamflow forecasts for hongze lake is superior to that of luoma lake 3 3 streamflow forecast error analysis and probabilistic forecasting providing an accurate and reliable streamflow forecast with a deterministic forecast scheme is difficult when the forecast lead time is beyond the effective lead time whereas a probabilistic forecast combined with error analysis which can provide richer information regarding the confidence interval has proven to be an effective method in this study two garch 1 1 models with various parameters are employed to characterize forecast errors in two lakes throughout the calibration period while the moving average ma method is introduced as a comparison specific procedures of errors analysis in two lakes streamflow forecasts by garch model with calibration can be found in the supplementary materials the fitness of error sequences during the calibration period fig 9 indicates that the ma method is insufficient in accurately characterizing errors that exhibit clustering volatility and temporal dependency the garch model in contrast has been observed to effectively preserve these characteristics leading to a precise fit and exhibiting significant potential in forecasting performance during the validation period during the validation period a probabilistic forecast is generalized by combining deterministic forecast by lstm and scenario of simulated errors by garch denoted as lstm garch model similarly a lstm ma model is also introduced the difference between the proposed lstm garch model blue range in figs 10 and 11 and lstm ma model gray range in figs 10 and 11 are attributed to the value of precise characterization of forecast errors the 90 confidence interval of the probabilistic streamflow forecast mostly covers the observed streamflow points indicating that the probabilistic forecast provides valuable information in estimating streamflow s confidential range when the forecast lead time is 1 month the proposed model can reduce the width of the confidence interval 46 3 in hongze lake and 39 9 in luoma lake without notably affecting the hit rate 8 3 in hongze lake and 5 0 in luoma lake with extension of the lead time the gap reduces indicating gradual decline in the reliability of the probabilistic forecast when the forecast lead time exceeds 4 months the gap is rather small as shown in figs 10 d and 11 d illustrating that the statistical characteristics of the forecast errors are less representative under such circumstances therefore the lstm garch model can improve the forecasting capability by extending the effective lead time to 3 months 3 4 long term streamflow forecast evaluation considering accuracy reliability stability performance evaluation of streamflow forecast accuracy is based on the deterministic forecasts conducted in section 3 2 whereas the reliability and stability are based on the probabilistic forecasts proposed in section 3 3 to investigate the contributions of each module in the hierarchical optimization eight forecasting schemes with a 1 month forecast lead time are proposed in table 6 in comparison with scheme s ⅰ scheme s ⅱ express an apparent loss in accuracy fig 12 indicated by larger deviation rmse increases by 16 9 in hongze lake while 27 3 in luoma lake indicating the significance of methodology factors in long term streamflow forecasts for scheme s iii the annual forecasting value is broadly similar in different hydrological years demonstrating that redundant information with high uncertainty reduces reliability and diminishes the value of the streamflow forecast for the probabilistic streamflow forecasts figs 13 and 14 bandwidth represents the forecast uncertainty while deviation contributes to the safety of forecasting in a flood event when the better optimized predictors and equation are determined scheme ⅰ the forecast uncertainty decreases markedly 39 4 in hongze lake and 40 8 in luoma lake with reduction in the probability of forecast failure 5 1 and 7 5 in hit rate respectively resulting in satisfactory streamflow forecasts furthermore transversal comparison of these schemes demonstrates that lack in predictor or forecast equation optimization makes it impossible to provide representative error samples for the garch model thereby reducing the value of identification of forecast errors moreover scheme iii which employs no hierarchical optimization performs worst among these schemes it takes the highest hit rate above 95 in two lakes by a rather large forecast interval two times larger than scheme ⅰ but still fails in forecasting the high flow event figs 15 and 16 shows the evaluation proposed in section 2 4 for estimating various forecast schemes all the evaluations exhibit a poor characteristic during the flood season and strong performance during the non flood season indicating the difficulty in streamflow forecasting during the flood season the forecasts that incorporate predictor screening or equation optimization outperform those that do not in terms of accuracy and reliability rmse is lower down by 6 7 34 8 and bs is lower down by 15 3 27 9 in two lakes while equation optimization contributes more to accuracy and predictor screening contributes more to reliability they can provide reliable error information for the streamflow forecast to improve accuracy additionally detailed statistical error analysis using the garch model can effectively grasp the time varying features which assists in properly simulating the scenario of forecast errors to strengthen the stability of the probabilistic forecast in comparison with that of the traditional method 36 4 51 6 reduction in md in two lakes in conclusion the proposed streamflow forecast model is characterized by high accuracy reliability and stability which could provide effective and comprehensive supporting information for water resources management 4 conclusions an accurate reliable and stable streamflow forecast is the basis and core of water resources planning and management and it could provide effective decision making information for water resources utilization this study used input structure parameter hierarchical optimization to upgrade the predictors forecast equation and errors respectively first the contribution of the predictors is evaluated based on information entropy theory which directs the screening of the driving predictor set the lstm model is then used to construct a long term deterministic streamflow forecast and the errors at different forecast lead times are obtained finally the garch model is used to statistically assess the time varying errors and produce a long term probabilistic streamflow forecast considering forecast uncertainty the proposed model is used to forecast the monthly streamflow of two lakes hongze and luoma lake in china which was evaluated using multidimensional indexes considering accuracy reliability stability performance and the main conclusions derived are summarized below 1 predictor screening based on information entropy can finely explore the statistical characteristics of predictors and streamflow in which ce can quantitatively assess the contribution of a single factor and conditional entropy can describe the combined utility of multiple factors thereby providing valuable information for streamflow forecasting 2 the lstm model can exploit the nonlinear response between the driving predictors and streamflow thereby improving the accuracy and reliability of a streamflow forecast besides forecast errors might have time varying characteristics with clustering volatility and temporal dependency in a recursive forecast and the garch model identifies these features which improves the simulation of forecast errors reduces the probability of forecast failure and enhances the stability of a streamflow forecast 3 under the current meteorological observation conditions and forecasting capability the maximum effective lead time of the lstm based deterministic streamflow forecast is 1 month while the effective lead time of the lstm garch based probabilistic streamflow forecast can be extended to 3 months 4 in comparison with the benchmark forecast model the proposed model can substantially improve the accuracy rmse 6 7 34 8 reliability bs 15 3 27 9 and stability md 36 4 52 6 in both two lakes indicating that inputs structure parameters hierarchical optimization based on information refinement and screening can provide effective and profitable decision making information for water resources management credit authorship contribution statement ran mo methodology software funding acquisition bin xu supervision methodology funding acquisition ping an zhong conceptualization yuanheng dong formal analysis data curation han wang investigation hao yue investigation jian zhu methodology huili wang validation guoqing wang conceptualization jianyun zhang conceptualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study is supported by the national key technologies r d program of china grant no 2021yfc3000104 the national natural science foundation of china grant nos 52121006 41961124007 postgraduate research practice innovation program of jiangsu province grant no kycx23 0710 data will be made available on contacting the first author appendix specific procedures of errors analysis in two lakes streamflow forecasts by garch model with calibration the stationary and temporal correlation of forecast errors namely the arch effect is first examined the ljung box q test is used to test whether any of a group of autocorrelations of the forecast error series are different from 0 we can construct the statistic q as follows a1 q n n 2 i 1 m ρ i n i where n is the sample size ρ i is the autocorrelation at lag i and m represents the number of lags being tested under the hypothesis that the error series are independently distributed the statistic q follows a chi square distribution χ h 2 the ljung box q test illustrates that when the confidence level is 90 the p value are all below 0 001 which is smaller than the critical value of rejection of 0 05 indicating that the error series can be considered suitable for the garch model according to the ac and pac in fig a1 two garch 1 1 model with various parameters are constructed as follows a2 ε t 0 374 0 295 ε t 1 0 300 e t 1 2 a3 ε t 0 016 0 602 ε t 1 0 196 e t 1 2 the scenarios of forecast errors of two lakes are produced according to the steps in section 2 3 which exhibits the same stochastic characteristics as the sample series indicating the validity of the garch model fig a2 on the contrary a conventional model using the moving average ma method exclusively is presented to simulate the forecast errors which ignores their clustering volatility and temporal dependency both methods can obtain statistical distributions of sample errors appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129736 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
