index,text
20425,in the present paper the penalty immersed boundary method is improved to resolve the transient fluid solid interaction problems the eulerian finite element method is chosen as the fluid solver and the conservation of the total energy is solved to ensure the correct results for discontinuous problems the penalty immersed boundary method is adopted to couple the fluid and the submerged solid body which is improved by considering both the normal and tangential relative velocities of the solid surface with an upwind scheme when updating the penetrated depth with the present model the simulated results of a 1 dimensional moving piston problem in the ideal gas are compared with the exact solution and the results from the abaqus to validate the capability of the present method in dealing with shocks then several 3 dimensional problems are simulated and analyzed including a bubble sphere interaction problem and three high speed water entry problems the results are compared with experiments and show good agreements keywords fluid solid interaction penalty immersed boundary method eulerian finite element method 1 introduction the present study concerns the coupling between a fluid and an immersed rigid body which has significant applications such as the water entry problems aristoff et al 2010 truscott et al 2014 hydro force on wing section alam and muhammad 2020 bao and tao 2014 structural damage subjected to underwater explosion liu et al 2018a zhang and liu 2015 klaseboer et al 2005 and so on the fluid is described with an eulerian mesh that allows large deformation while maintaining the simulation s stability and accuracy by contrast it is convenient to formulate the motion of the rigid body with the lagrangian mesh the difficulties lay in coupling the two sets of geometrically irrelevant meshes to develop a mutually influenced system one approach for this problem is the immersed boundary method ibm peskin 1972 2002 kim and peskin 2007 aldlemy et al 2020 the original version of the ibm peskin 1972 was used to simulate the cardiac mechanics and the associated blood flow described by the incompressible naiver stokes equation the immersed deformable boundary is assumed to be massless and interacts with the surrounding fluid a source term is added to the momentum equation with a smoothed dirac delta function to include the immersed boundary s effect to consider the mass of the boundary kim and peskin 2007 improved the ibm by introducing an imaginary massless boundary that moves with the fluid flow and is connected with the real boundary with stiff springs the traditional ibm is used to distribute the springs force acting on the imaginary boundary into the surrounding fluid in this way the real boundary motions with mass and the fluid flow are coupled together indirectly through the imaginary boundary and this approach is referred to as the penalty ibm the penalty ibm is then widely used in the fluid flexible body interaction and is further developed to deal with more problems huang et al 2011 kim et al 2018 xie et al 2019 when the structure dynamics is solved with the explicit finite element method it is convenient to discretize the euler equation of the fluid with the same approach to form a uniform framework however instabilities would arise from the convective terms if the finite element method is directly applied to the fluid flow zienkiewicz et al 2015 thus noh 1963 suggested separating the convective terms from the euler equation with the operator split technique and solve them with the finite volume method the detailed theory of this approach can be found in benson 1992a tian et al 2018 tang et al 2020 tian et al 2021 this approach is widely used in commercial software based on the finite element method such as the ls dyna msc dytran and abaqus as for the coupling algorithm between the eulerian mesh for the fluid and the lagrangian mesh for the structure the penalty ibm is widely used benson and okazawa 2004 gong 2019 hallquist 2006 aquelet et al 2006 while the reactive force is distributed into the fluid with the weights defined by the shape functions at the structure node instead of the smoothed dirac delta function in the present paper the penalty ibm is analyzed and improved to deal with the fluid solid interaction fsi problem with the eulerian finite element method as the fluid solver the rest of this paper is organized as follows firstly the basic equations and the numerical technique are presented for the fluid solver based on the eulerian finite element method secondly the traditional ibm is briefly reviewed and some improvements are made to formulate a new penalty ibm thirdly some fsi cases are simulated and analyzed to validate the present model at last some conclusions are drawn 2 theoretical and numerical models 2 1 eulerian finite element solver for the fluids 2 1 1 basic equations with total energy conservation in most transient hydro impact problems the inertia force dominates the interaction thus it is reasonable to ignore thermal conduction viscosity and surface tension effects the multi medium interface is modeled with the volume of fluid method for its advantages in easy implementation and conservativeness hirt and nichols 1981 benson 1992a noh and woodward 1976 wang and shu 2010 liu et al 2021 the multi medium fluid flow can be modeled with the following equation system greenough et al 1995 so et al 2012 1 α i t α i u α i κ κ i u α i ρ i t α i ρ i u 0 ρ u t ρ u u p ρ g f α i ρ i e i t α i ρ i e i u p α i κ κ i u 0 herein the subscript i indicates the number of the fluid α i is the volume fraction of the fluid i ρ is the fluid density u u 1 u 2 u 3 is the vector of velocity e represents the specific internal energy per unit mass κ is the bulk module of fluid f is the external force due to the coupling with the solid body and g is the gravity acceleration the bar over a variable represents that it is an average quantity of the mixture fluid the coefficient of κ κ i is included to take the fluid stiffness difference into account so et al 2012 the ordinary mixture formula is adopted to compute the average density ρ 2 ρ α 1 ρ 1 α 2 ρ 2 according to greenough et al 1995 we assume that the pressures of the two fluid components in the mixture equal to each other at the same position thus the average bulk module of the mixture is taken as 3 κ κ 1 κ 2 α 1 κ 2 α 2 κ 1 the system of eq 1 is then closed by the equation of state eos of each fluid in the present paper the tammann eos ivings et al 1998 is chosen to model the gas and water which reads 4 p ρ e γ 1 γ p w herein γ and p w are the material constants if p w is taken as zero it degrades to the ideal gas equation 5 p ρ e γ 1 2 1 2 eulerian finite element method with operator split technique the eulerian finite element method benson 1992b a tian et al 2021 he et al 2020 is adopted to solve the above system of eq 1 which employs the operator split to avoid the instability caused by the discretization of the convective terms using the galerkin method the main idea is to separate the convective terms and the source terms to be solved in two subsequent steps for one time increment in the first step the explicit finite element method is adopted to discretize the source terms when the mesh advances with the fluid material in the second step the mesh is moved back to the original position and the convective term is considered with the muscl and his schemes for the element centered and node centered variables this approach has been widely used in the commercial hydro codes like ls dyna msc dytran and abaqus for its robustness besides it is easy to be coupled with the structural dynamics code based on the finite element method wu and gu 2012 because they are in the same numerical framework the volume of fluid method is adopted with the interface constructed by the plic algorithm noh and woodward 1976 benson 1992a to update the fluid fraction function the overall procedure of the eulerian finite element method has been extensively discussed in the previous papers benson 1992b a liu et al 2018a 2019 and will not be repeated in the present work 2 1 3 correction for the conservation of total energy in the present numerical framework the velocity is stored on the cell nodes while the density and energy are on the cell center thus the calculation of total energy is not straightforward the ordinary eulerian finite method benson 1992b liu et al 2018a 2019 solves the conservation equation of the internal energy instead of the total energy as shown in eq 1 in smooth problems this is equivalent to the conservation of total energy however when there are discontinuities with large density ratio it may lead to incorrect results toro 2009 to overcome this problem and maintain the flexibility of the eulerian finite element method we transport the total energy in the lagrangian phase in this paper with the following steps i for cell i calculate the total energy before transportation with 6 e v i ρ e i 1 2 ρ u 2 d v v i ρ e 1 2 u j 2 i ρ ϕ j 2 d v where ϕ j is the tri linear basis function of node j in 3 dimensional problems v i is the volume of cell i and u j represent the nodal velocity of node j the integration is calculated with the gauss quadrature ii transport the total energy e material mass with the muscl iii transport the nodal momentum with the his scheme and recover the nodal velocity with the updated nodal mass iv recover the cell centered internal energy with eq 6 v calculate the new pressure with the updated internal energy and the corresponding eos 2 2 brief review of the penalty ibm for fsi the penalty ibm benson and okazawa 2004 hallquist 2006 gong 2019 is used to achieve the coupling between the eulerian fluid mesh and the lagrangian solid mesh it allows the lagrangian solid mesh to move in the eulerian fluid mesh the mutual coupling forces are applied to the fluid and solid node such that the total momentum conserves during the interaction the basic idea of the penalty ibm is shown in fig 1 in which the solid red line represents the solid boundary and the red circle denotes one of its nodes an imaginary boundary is introduced to implement the coupling between the solid and the fluid nodes as shown by the red dashed curve the imaginary boundary evolves with the material velocity of the fluid and a pair of interaction forces are applied to the real and imaginary boundaries to pull them together to achieve this purpose a stiff spring and a viscous dashpot are placed between the two boundaries such that the interaction force applied on the real boundary node i is given by 7 f c i k c d p i c c d p i n where 8 d p 0 t v u n d t is the signed penetration depth representing the distance between the two boundary n is the unit normal vector of node i pointing into the fluid and v and u are the velocity vectors of the real and imaginary boundaries respectively k c and c c are the dynamic coefficients since the relationship between d p and d p the two terms on the right hand side of eq 7 control the low frequency and high frequency relative motions of the coupling boundaries then the reactive force of f c i acting on the imaginary boundary is distributed to the nodes of the fluid element 9 f j i ϕ j i f c i to maintain the momentum conservation of the whole system the first part of the contact force on the right hand side of eq 7 acts as a spring between the solid and fluid nodes if the spring is too soft significant penetration may occur thus the impenetrable condition can be approximated by increasing the spring stiffness however an excessive stiffness will lead to the instability of the simulation with a certain time increment thus it is vital to choose a proper stiffness following the previous works in the penalty ibm aquelet et al 2006 gong 2019 the stiffness is taken as the approximation of the fluid cell stiffness 10 k c f c max κ a 2 v m δ t where f c is a constant scale factor and recommended as 0 1 by hallquist 2006 and m m j ϕ j x i is the interpolated nodal mass at the location of the structural node i with m j representing the lumped nodal mass of node j then c c is taken as the critical damping coefficient of the system 11 c c 2 k c m to dissipate the high frequency oscillations introduced by the extra coupling stiffness 2 3 modified penalty ibm there are two problems in the conventional penalty ibm shown in the previous section firstly during updating the penetration depth the contribution of the fluid transportation in the tangential direction is ignored in the ordinary penalty ibm without any justification benson and okazawa 2004 gong 2019 hallquist 2006 aquelet et al 2006 when the tangential velocity component is relatively large significant penetration at the coupling boundary can occur thus the penetrated mass is updated with the following equation which includes the tangential transportation in this paper 12 d p v u d p 0 where d p is the prolonged gradient of d p the ordinary gradient operator is not meaningful in this problem because the penetration depth is only defined on the solid surface thus we define the normal derivative of d p based on eq 8 such that d p n 1 it is readily to know that eq 12 consists with eq 8 when the tangential velocity is zero as shown in fig 2 for a specific triangle cell on the solid surface it is calculated by solving the following linear system 13 n t r b r a t r c r a t d p 1 d p b d p a d p c d p a it should be noted that each node on the solid surface is shared by several surface cells and it is important to determine which cell should be used a natural thought is to use the average d p over all its surrounding cells however the scheme is unstable and enormous oscillations would be obtained in the results because eq 12 is a typical convection equation thus an upwind scheme is implemented to introduce sufficient numerical dissipation in solving eq 12 considering d p of the node a is being updated the first step is to find the upwind cell based on the relative velocity at node a denote the cell center of the surrounding cells by r c green circles in fig 2 the cell with the maximum value of v u r c r a r c r a is chosen as the upwind cell secondly the coupling force is distributed into the fluid with eq 9 in the traditional ibm which ignores the nodal mass difference when the mass of a node is much smaller than the others the coupling force may generate great nodal acceleration and lead to instability thus in the present method the reactive force acting on the fluid node j of the current fluid cell is calculated with 14 f j i ϕ j i m j k ϕ k i m k f c i where the summation is performed over all the nodes belonging to the fluid cell containing the solid node i compared with eq 9 the distribution weights include the influence of the nodal mass which can ensure similar added accelerations for the nodes with varying masses this modification is essential to maintain the stability when the solid node is coupling with a mixture cell of two fluids with great density ratio 2 4 overall procedure of the numerical implementation since the solid body is rigid only the 6 degrees of freedom are required to be solved in this paper the impulse based method of rigid body dynamics mirtich 1996 is adopted to resolve the solid body motion for the solid body whose rotating center locates at the barycenter the newton euler equation reads 15 m 0 v g f i ω ω i ω r τ where m 0 is the isentropic mass of the solid body v is the translation velocity in the global coordinate system and ω ω 1 ω 2 ω 3 t is the angular velocity with respect to the body fixed coordinate axes e 1 e 2 and e 3 i is the inertia tensor and f and τ are the external force and moment caused by the fluid solid interaction respectively r e 1 e 2 e 3 is the rotating matrix the translating motion described in eq 15 is solved straightforward in the global coordinate system while the rotation is solved in the body fixed coordinate system the rotation matrix is explicitly updated based on the relationship of 16 r r 0 ω 3 ω 2 ω 3 0 ω 1 ω 2 ω 1 0 following the treatment in hallquist 2006 the rotating matrix is advanced for half a time increment before eq 15 is integrated and thereafter it is advanced for the other half of the time increment then both the fluid and the rigid body can be updated explicitly the overall procedure of the coupled numerical model is shown in fig 3 besides the adaptive mesh refinement technique macneice et al 2000 olson 2006 is used to reduce the degrees of freedom and the message passing interface is adopted to parallelize the simulation 3 results and discussion 3 1 moving piston in ideal gas firstly a 1 dimensional gas compressed by a moving piston is considered to test the present model if the piston moves with a constant velocity u in a gas at rest a rightward shock wave will form the exact solution of the shock speed is given by tsangaris and pappou 2000 17 u s γ 1 4 u γ 1 4 u 2 c 0 2 where c 0 is the sound speed of the undisturbed gas in this paper the initial conditions of the gas is taken as 18 γ ρ u p 1 4 1 0 1 thus the local sound speed can be calculated as c 0 p ρ γ according to the rankine hugoniot condition of the moving shock the post shock density and pressure behind the shock can be calculated with 19 ρ s u s u s u ρ and 20 p s u s u u 2 ρ s p the computational domain is taken as 0 1 and is discretized into 100 uniform cells in the simulation the piston is initially located at x 0 and moves rightward with a constant velocity of u 0 5 the non gradient boundary condition is applied to both boundaries of the computational domain the pressure distribution on the x t plane simulated with the present method is given in fig 4 a with the red dashed line representing the characteristic of the rightward shock obtained with eq 17 it shows that the rightward shock wave is well simulated in fig 4 b the pressure distribution at t 0 5 is compared with that obtained with abaqus and the exact solution is also plotted for comparison the pressure amplitude calculated by abaqus is significantly smaller than the exact solution while the results from the present model agree well with it besides the shock wave speed is slightly slower than the exact solution it is essential to solve the conserving form of the euler equation when there is strong shock in the fluid domain otherwise the solver may get incorrect results thus the difference between the results from the present method and abaqus should be attributed to the form of energy equation in the present method the total energy conservation is ensured by eq 6 on the contrary only the internal energy is updated in abaqus ignoring the conservation of the total energy 3 2 bubble sphere interaction firstly we consider the interaction of an underwater discharge bubble and a nearby submerged solid sphere the interaction of a violent bubble and the nearby structure has been intensely investigated for its numerous applications klaseboer et al 2005 li et al 2019 liu et al 2018b wang et al 2018 zevnik and dular 2020 tian et al 2020 the experimental data is extracted from li et al 2019 that implemented the experiment to validate the fsi model based on the boundary element method the maximum radius of the bubble is 15 6 mm and was generated at 200 mm beneath the free surface a solid vertical wall is placed 21 mm away from the bubble center the solid sphere is sized by a radius of 8 mm and weights 2 58 g in the simulation the origin of the coordinate system is placed at the initial bubble center and the solid sphere is initially located at 20 5 mm 0 12 5 mm the only boundary that should be considered is the solid vertical wall facing at the x direction and placed beside the bubble with a distance of 21 mm in the simulation the computational domain is taken as a block sized by 10 r m 10 r m 10 r m and the cell size is set to 0 02 r m the initial conditions are following li et al 2019 and the non reflecting boundary condition liu et al 2018a is applied on the truncated boundary of the computational domain the problem is non dimensionalized with the length scale of r m the pressure scale of p and the time scale of t r e f r m ρ p with p representing the static pressure at the bubble center the internal gas is modeled with the ideal gas eos with γ 1 4 and the surrounding water is modeled with the tammann equation with γ 7 15 and p w 310 9 mpa liu et al 2019 the simulation was run on a desktop cpu intel i7 9700 ram 32 gb and took 7 h the dimensionless results are compared together in fig 5 in which the red curves represent the bubble and solid sphere profiles extracted from the experimental results li et al 2019 and the blue dashed circle shows the initial location of the solid sphere we can see that the sphere is pushed away by the bubble during its expansion and attracted when the bubble collapse generally the violent bubble moving in the gravity field will develop an upward jet due to the gradient of the hydrostatic pressure however the dimensionless gravity is only 1 5 1 0 3 as a result the gravity effects are negligible and the motion of the bubble is mainly dominated by the solid wall that induces the development of the leftward liquid jet because of the existence of the sphere the bubble is not axisymmetric it also attracts the bubble during the collapse such that a bulge emerges at the up right corner of the bubble besides a tilted jet forms and penetrates the bubble to form a toroidal one these results are not given in li et al 2019 because it is non trivial to consider the transition from a single connected problem to a double connected one in the bem overall the two sets of results agree well 3 3 water entry of a solid sphere 3 3 1 vertical water entry compared with experiments now we consider a solid sphere entering the water from the air vertically as discussed in truscott et al 2014 this canonical problem is affected by the wettability of the solid material if the surface tension effects dominate it to avoid the influence of the surface tension we focus on the high weber number problem the case is taken from aristoff et al 2010 that carried out a water entry experiment of a steel sphere the radius of the sphere is r s 1 27 cm and the impact speed is u 0 0 0 217 cm s the froude number is f r ρ u 0 r s g 2 81 the density of the sphere is ρ s 7 86 g cm 3 denoting σ 0 076 n m as the surface tension between the water and air the weber number w b ρ u 0 2 r s σ is about 787 that is high enough to neglect the surface tension effects in the simulation this problem is non dimensionalized by the length scale of the sphere radius r s the density scale of the water density and the pressure scale of the atmosphere because of the symmetry of the problem only one fourth of the spatial domain is solved with the computational domain taken as a block bounded by 0 15 r s 0 15 r s 50 r s 10 r s and the cell size is set to 0 058 r s the impenetrable boundary condition is applied to all the boundaries of the computational domain the solid sphere is initially released at 0 0 2 r s with the downward velocity of u 0 and the time when the sphere center passes the free surface is marked as t 0 the simulation takes 31 h with 24 cores on the computer provided by cstc china science technology cloud in fig 6 the simulated results are presented with the experimental cavity profiles represented by the red solid curves the figure shows the evolution of the splash curtain above and the cavity below the free surface all the known phenomena of the cavity are well simulated including the cavity expansion collapse pitch off and the jet development of the two separated cavities however the closure of the splash curtain above the free surface is not observed in the numerical results the reason is that the fluid mesh is too coarse to form a stable thin curtain such that it breaks too early into small drops 3 3 2 water entry with varying impact angles in this subsection another two water entry cases are tested with different impact angles the impact angle denotes the angle between the directions of the gravity and the sphere velocity when passing the free surface in these two cases all the conditions are the same with the previous section 3 3 1 except that the initial speed of the solid sphere is u 0 217 cm s and the solid sphere impacts the free surface with the angles of 3 0 and 6 0 between the released velocity and the gravity respectively in the simulation the half of the spatial domain for y 0 is simulated and the other half is recovered by symmetry the sphere is released at 0 0 2 r s for both the two cases and their results are shown in figs 7 and 8 we can see that the cavities evolve almost axisymmetrically along the sphere s trajectories for the case with the impact angle of 30 the pitch off time is the same as the vertical water entry case only the jet tilted away from the trajectory of the sphere a little during the collapse of the two separated cavities as shown in fig 7 e as for the water entry with an impact angle of 6 0 the asymmetry develops much earlier as shown in fig 8 e an upward strip jet emerges at the lower surface of the cavity the zoom in view of the part of the cavity bounded by the red dashed rectangle is shown in fig 8 g we can see that strip jet impacts on the upper side of the cavity and penetrates it this can be attributed to the hydrostatic pressure gradient caused by the gravity similar phenomena are commonly observed in the researches of bubble dynamics in the gravity field cui et al 2016 zhang and liu 2015 klaseboer et al 2005 wang et al 2003 wang 2013 to investigate the effects of the impact angle on the trajectory of the sphere we plot the simulated trajectories from the three cases together in fig 9 markers are placed on the three trajectories with the time interval of 5 ms from t 0 the pitch off point is denoted as the red circle for each case we can see that the trajectory of the sphere with a greater impact angle bends downwards more due to the gravity the collapse and the pitch off of the cavity caused by the hydrostatic pressure gradient at the same time the sphere with a greater impact angle reaches a smaller depth beneath the free surface where the hydrostatic pressure is also smaller thus the collapse and the pitch off are both delayed 4 concluding remarks in this paper the penalty ibm within the framework of the eulerian finite element method is improved to resolve the fluid solid interaction problems in the present approach the conservativeness of total energy is ensured by a correction procedure in the eulerian step such that correct results are obtained when there is a strong shock the penetrated depth is updated considering both the relative normal velocity and its tangential convection on the solid surface by simulating and analyzing several fluid solid interaction cases the present penalty ibm is validated it should be noted that the present approach is also applicable to the interaction of the fluid and a submerged resilient structure with a proper structural dynamics solver based on the present model a 1 dimensional test case of a moving piston in an ideal gas is simulated and compared with the analytical solution the shock propagation is correctly computed which is attributed to the energy correction procedure on the contrary the commercial software abaqus fails to obtain the correct fluid state behind the shock for 3 dimensional problems we simulate a bubble sphere interaction and three high speed water entry problems using our numerical model all the known features are captured in the simulation the results are also compared with experimental ones and exhibit good agreement credit authorship contribution statement zhao li tian writing original draft formal analysis a man zhang conceptualization methodology yun long liu funding acquisition writing review editing shi ping wang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to acknowledge the support of the national natural science foundation of china grant nos 51879050 and 52088102 the china postdoctoral science foundation grant nos 2016m600244 and 2018t110271 and the heilongjiang postdoctoral fund china grant nos lbh z20131 lbh tz07 
20425,in the present paper the penalty immersed boundary method is improved to resolve the transient fluid solid interaction problems the eulerian finite element method is chosen as the fluid solver and the conservation of the total energy is solved to ensure the correct results for discontinuous problems the penalty immersed boundary method is adopted to couple the fluid and the submerged solid body which is improved by considering both the normal and tangential relative velocities of the solid surface with an upwind scheme when updating the penetrated depth with the present model the simulated results of a 1 dimensional moving piston problem in the ideal gas are compared with the exact solution and the results from the abaqus to validate the capability of the present method in dealing with shocks then several 3 dimensional problems are simulated and analyzed including a bubble sphere interaction problem and three high speed water entry problems the results are compared with experiments and show good agreements keywords fluid solid interaction penalty immersed boundary method eulerian finite element method 1 introduction the present study concerns the coupling between a fluid and an immersed rigid body which has significant applications such as the water entry problems aristoff et al 2010 truscott et al 2014 hydro force on wing section alam and muhammad 2020 bao and tao 2014 structural damage subjected to underwater explosion liu et al 2018a zhang and liu 2015 klaseboer et al 2005 and so on the fluid is described with an eulerian mesh that allows large deformation while maintaining the simulation s stability and accuracy by contrast it is convenient to formulate the motion of the rigid body with the lagrangian mesh the difficulties lay in coupling the two sets of geometrically irrelevant meshes to develop a mutually influenced system one approach for this problem is the immersed boundary method ibm peskin 1972 2002 kim and peskin 2007 aldlemy et al 2020 the original version of the ibm peskin 1972 was used to simulate the cardiac mechanics and the associated blood flow described by the incompressible naiver stokes equation the immersed deformable boundary is assumed to be massless and interacts with the surrounding fluid a source term is added to the momentum equation with a smoothed dirac delta function to include the immersed boundary s effect to consider the mass of the boundary kim and peskin 2007 improved the ibm by introducing an imaginary massless boundary that moves with the fluid flow and is connected with the real boundary with stiff springs the traditional ibm is used to distribute the springs force acting on the imaginary boundary into the surrounding fluid in this way the real boundary motions with mass and the fluid flow are coupled together indirectly through the imaginary boundary and this approach is referred to as the penalty ibm the penalty ibm is then widely used in the fluid flexible body interaction and is further developed to deal with more problems huang et al 2011 kim et al 2018 xie et al 2019 when the structure dynamics is solved with the explicit finite element method it is convenient to discretize the euler equation of the fluid with the same approach to form a uniform framework however instabilities would arise from the convective terms if the finite element method is directly applied to the fluid flow zienkiewicz et al 2015 thus noh 1963 suggested separating the convective terms from the euler equation with the operator split technique and solve them with the finite volume method the detailed theory of this approach can be found in benson 1992a tian et al 2018 tang et al 2020 tian et al 2021 this approach is widely used in commercial software based on the finite element method such as the ls dyna msc dytran and abaqus as for the coupling algorithm between the eulerian mesh for the fluid and the lagrangian mesh for the structure the penalty ibm is widely used benson and okazawa 2004 gong 2019 hallquist 2006 aquelet et al 2006 while the reactive force is distributed into the fluid with the weights defined by the shape functions at the structure node instead of the smoothed dirac delta function in the present paper the penalty ibm is analyzed and improved to deal with the fluid solid interaction fsi problem with the eulerian finite element method as the fluid solver the rest of this paper is organized as follows firstly the basic equations and the numerical technique are presented for the fluid solver based on the eulerian finite element method secondly the traditional ibm is briefly reviewed and some improvements are made to formulate a new penalty ibm thirdly some fsi cases are simulated and analyzed to validate the present model at last some conclusions are drawn 2 theoretical and numerical models 2 1 eulerian finite element solver for the fluids 2 1 1 basic equations with total energy conservation in most transient hydro impact problems the inertia force dominates the interaction thus it is reasonable to ignore thermal conduction viscosity and surface tension effects the multi medium interface is modeled with the volume of fluid method for its advantages in easy implementation and conservativeness hirt and nichols 1981 benson 1992a noh and woodward 1976 wang and shu 2010 liu et al 2021 the multi medium fluid flow can be modeled with the following equation system greenough et al 1995 so et al 2012 1 α i t α i u α i κ κ i u α i ρ i t α i ρ i u 0 ρ u t ρ u u p ρ g f α i ρ i e i t α i ρ i e i u p α i κ κ i u 0 herein the subscript i indicates the number of the fluid α i is the volume fraction of the fluid i ρ is the fluid density u u 1 u 2 u 3 is the vector of velocity e represents the specific internal energy per unit mass κ is the bulk module of fluid f is the external force due to the coupling with the solid body and g is the gravity acceleration the bar over a variable represents that it is an average quantity of the mixture fluid the coefficient of κ κ i is included to take the fluid stiffness difference into account so et al 2012 the ordinary mixture formula is adopted to compute the average density ρ 2 ρ α 1 ρ 1 α 2 ρ 2 according to greenough et al 1995 we assume that the pressures of the two fluid components in the mixture equal to each other at the same position thus the average bulk module of the mixture is taken as 3 κ κ 1 κ 2 α 1 κ 2 α 2 κ 1 the system of eq 1 is then closed by the equation of state eos of each fluid in the present paper the tammann eos ivings et al 1998 is chosen to model the gas and water which reads 4 p ρ e γ 1 γ p w herein γ and p w are the material constants if p w is taken as zero it degrades to the ideal gas equation 5 p ρ e γ 1 2 1 2 eulerian finite element method with operator split technique the eulerian finite element method benson 1992b a tian et al 2021 he et al 2020 is adopted to solve the above system of eq 1 which employs the operator split to avoid the instability caused by the discretization of the convective terms using the galerkin method the main idea is to separate the convective terms and the source terms to be solved in two subsequent steps for one time increment in the first step the explicit finite element method is adopted to discretize the source terms when the mesh advances with the fluid material in the second step the mesh is moved back to the original position and the convective term is considered with the muscl and his schemes for the element centered and node centered variables this approach has been widely used in the commercial hydro codes like ls dyna msc dytran and abaqus for its robustness besides it is easy to be coupled with the structural dynamics code based on the finite element method wu and gu 2012 because they are in the same numerical framework the volume of fluid method is adopted with the interface constructed by the plic algorithm noh and woodward 1976 benson 1992a to update the fluid fraction function the overall procedure of the eulerian finite element method has been extensively discussed in the previous papers benson 1992b a liu et al 2018a 2019 and will not be repeated in the present work 2 1 3 correction for the conservation of total energy in the present numerical framework the velocity is stored on the cell nodes while the density and energy are on the cell center thus the calculation of total energy is not straightforward the ordinary eulerian finite method benson 1992b liu et al 2018a 2019 solves the conservation equation of the internal energy instead of the total energy as shown in eq 1 in smooth problems this is equivalent to the conservation of total energy however when there are discontinuities with large density ratio it may lead to incorrect results toro 2009 to overcome this problem and maintain the flexibility of the eulerian finite element method we transport the total energy in the lagrangian phase in this paper with the following steps i for cell i calculate the total energy before transportation with 6 e v i ρ e i 1 2 ρ u 2 d v v i ρ e 1 2 u j 2 i ρ ϕ j 2 d v where ϕ j is the tri linear basis function of node j in 3 dimensional problems v i is the volume of cell i and u j represent the nodal velocity of node j the integration is calculated with the gauss quadrature ii transport the total energy e material mass with the muscl iii transport the nodal momentum with the his scheme and recover the nodal velocity with the updated nodal mass iv recover the cell centered internal energy with eq 6 v calculate the new pressure with the updated internal energy and the corresponding eos 2 2 brief review of the penalty ibm for fsi the penalty ibm benson and okazawa 2004 hallquist 2006 gong 2019 is used to achieve the coupling between the eulerian fluid mesh and the lagrangian solid mesh it allows the lagrangian solid mesh to move in the eulerian fluid mesh the mutual coupling forces are applied to the fluid and solid node such that the total momentum conserves during the interaction the basic idea of the penalty ibm is shown in fig 1 in which the solid red line represents the solid boundary and the red circle denotes one of its nodes an imaginary boundary is introduced to implement the coupling between the solid and the fluid nodes as shown by the red dashed curve the imaginary boundary evolves with the material velocity of the fluid and a pair of interaction forces are applied to the real and imaginary boundaries to pull them together to achieve this purpose a stiff spring and a viscous dashpot are placed between the two boundaries such that the interaction force applied on the real boundary node i is given by 7 f c i k c d p i c c d p i n where 8 d p 0 t v u n d t is the signed penetration depth representing the distance between the two boundary n is the unit normal vector of node i pointing into the fluid and v and u are the velocity vectors of the real and imaginary boundaries respectively k c and c c are the dynamic coefficients since the relationship between d p and d p the two terms on the right hand side of eq 7 control the low frequency and high frequency relative motions of the coupling boundaries then the reactive force of f c i acting on the imaginary boundary is distributed to the nodes of the fluid element 9 f j i ϕ j i f c i to maintain the momentum conservation of the whole system the first part of the contact force on the right hand side of eq 7 acts as a spring between the solid and fluid nodes if the spring is too soft significant penetration may occur thus the impenetrable condition can be approximated by increasing the spring stiffness however an excessive stiffness will lead to the instability of the simulation with a certain time increment thus it is vital to choose a proper stiffness following the previous works in the penalty ibm aquelet et al 2006 gong 2019 the stiffness is taken as the approximation of the fluid cell stiffness 10 k c f c max κ a 2 v m δ t where f c is a constant scale factor and recommended as 0 1 by hallquist 2006 and m m j ϕ j x i is the interpolated nodal mass at the location of the structural node i with m j representing the lumped nodal mass of node j then c c is taken as the critical damping coefficient of the system 11 c c 2 k c m to dissipate the high frequency oscillations introduced by the extra coupling stiffness 2 3 modified penalty ibm there are two problems in the conventional penalty ibm shown in the previous section firstly during updating the penetration depth the contribution of the fluid transportation in the tangential direction is ignored in the ordinary penalty ibm without any justification benson and okazawa 2004 gong 2019 hallquist 2006 aquelet et al 2006 when the tangential velocity component is relatively large significant penetration at the coupling boundary can occur thus the penetrated mass is updated with the following equation which includes the tangential transportation in this paper 12 d p v u d p 0 where d p is the prolonged gradient of d p the ordinary gradient operator is not meaningful in this problem because the penetration depth is only defined on the solid surface thus we define the normal derivative of d p based on eq 8 such that d p n 1 it is readily to know that eq 12 consists with eq 8 when the tangential velocity is zero as shown in fig 2 for a specific triangle cell on the solid surface it is calculated by solving the following linear system 13 n t r b r a t r c r a t d p 1 d p b d p a d p c d p a it should be noted that each node on the solid surface is shared by several surface cells and it is important to determine which cell should be used a natural thought is to use the average d p over all its surrounding cells however the scheme is unstable and enormous oscillations would be obtained in the results because eq 12 is a typical convection equation thus an upwind scheme is implemented to introduce sufficient numerical dissipation in solving eq 12 considering d p of the node a is being updated the first step is to find the upwind cell based on the relative velocity at node a denote the cell center of the surrounding cells by r c green circles in fig 2 the cell with the maximum value of v u r c r a r c r a is chosen as the upwind cell secondly the coupling force is distributed into the fluid with eq 9 in the traditional ibm which ignores the nodal mass difference when the mass of a node is much smaller than the others the coupling force may generate great nodal acceleration and lead to instability thus in the present method the reactive force acting on the fluid node j of the current fluid cell is calculated with 14 f j i ϕ j i m j k ϕ k i m k f c i where the summation is performed over all the nodes belonging to the fluid cell containing the solid node i compared with eq 9 the distribution weights include the influence of the nodal mass which can ensure similar added accelerations for the nodes with varying masses this modification is essential to maintain the stability when the solid node is coupling with a mixture cell of two fluids with great density ratio 2 4 overall procedure of the numerical implementation since the solid body is rigid only the 6 degrees of freedom are required to be solved in this paper the impulse based method of rigid body dynamics mirtich 1996 is adopted to resolve the solid body motion for the solid body whose rotating center locates at the barycenter the newton euler equation reads 15 m 0 v g f i ω ω i ω r τ where m 0 is the isentropic mass of the solid body v is the translation velocity in the global coordinate system and ω ω 1 ω 2 ω 3 t is the angular velocity with respect to the body fixed coordinate axes e 1 e 2 and e 3 i is the inertia tensor and f and τ are the external force and moment caused by the fluid solid interaction respectively r e 1 e 2 e 3 is the rotating matrix the translating motion described in eq 15 is solved straightforward in the global coordinate system while the rotation is solved in the body fixed coordinate system the rotation matrix is explicitly updated based on the relationship of 16 r r 0 ω 3 ω 2 ω 3 0 ω 1 ω 2 ω 1 0 following the treatment in hallquist 2006 the rotating matrix is advanced for half a time increment before eq 15 is integrated and thereafter it is advanced for the other half of the time increment then both the fluid and the rigid body can be updated explicitly the overall procedure of the coupled numerical model is shown in fig 3 besides the adaptive mesh refinement technique macneice et al 2000 olson 2006 is used to reduce the degrees of freedom and the message passing interface is adopted to parallelize the simulation 3 results and discussion 3 1 moving piston in ideal gas firstly a 1 dimensional gas compressed by a moving piston is considered to test the present model if the piston moves with a constant velocity u in a gas at rest a rightward shock wave will form the exact solution of the shock speed is given by tsangaris and pappou 2000 17 u s γ 1 4 u γ 1 4 u 2 c 0 2 where c 0 is the sound speed of the undisturbed gas in this paper the initial conditions of the gas is taken as 18 γ ρ u p 1 4 1 0 1 thus the local sound speed can be calculated as c 0 p ρ γ according to the rankine hugoniot condition of the moving shock the post shock density and pressure behind the shock can be calculated with 19 ρ s u s u s u ρ and 20 p s u s u u 2 ρ s p the computational domain is taken as 0 1 and is discretized into 100 uniform cells in the simulation the piston is initially located at x 0 and moves rightward with a constant velocity of u 0 5 the non gradient boundary condition is applied to both boundaries of the computational domain the pressure distribution on the x t plane simulated with the present method is given in fig 4 a with the red dashed line representing the characteristic of the rightward shock obtained with eq 17 it shows that the rightward shock wave is well simulated in fig 4 b the pressure distribution at t 0 5 is compared with that obtained with abaqus and the exact solution is also plotted for comparison the pressure amplitude calculated by abaqus is significantly smaller than the exact solution while the results from the present model agree well with it besides the shock wave speed is slightly slower than the exact solution it is essential to solve the conserving form of the euler equation when there is strong shock in the fluid domain otherwise the solver may get incorrect results thus the difference between the results from the present method and abaqus should be attributed to the form of energy equation in the present method the total energy conservation is ensured by eq 6 on the contrary only the internal energy is updated in abaqus ignoring the conservation of the total energy 3 2 bubble sphere interaction firstly we consider the interaction of an underwater discharge bubble and a nearby submerged solid sphere the interaction of a violent bubble and the nearby structure has been intensely investigated for its numerous applications klaseboer et al 2005 li et al 2019 liu et al 2018b wang et al 2018 zevnik and dular 2020 tian et al 2020 the experimental data is extracted from li et al 2019 that implemented the experiment to validate the fsi model based on the boundary element method the maximum radius of the bubble is 15 6 mm and was generated at 200 mm beneath the free surface a solid vertical wall is placed 21 mm away from the bubble center the solid sphere is sized by a radius of 8 mm and weights 2 58 g in the simulation the origin of the coordinate system is placed at the initial bubble center and the solid sphere is initially located at 20 5 mm 0 12 5 mm the only boundary that should be considered is the solid vertical wall facing at the x direction and placed beside the bubble with a distance of 21 mm in the simulation the computational domain is taken as a block sized by 10 r m 10 r m 10 r m and the cell size is set to 0 02 r m the initial conditions are following li et al 2019 and the non reflecting boundary condition liu et al 2018a is applied on the truncated boundary of the computational domain the problem is non dimensionalized with the length scale of r m the pressure scale of p and the time scale of t r e f r m ρ p with p representing the static pressure at the bubble center the internal gas is modeled with the ideal gas eos with γ 1 4 and the surrounding water is modeled with the tammann equation with γ 7 15 and p w 310 9 mpa liu et al 2019 the simulation was run on a desktop cpu intel i7 9700 ram 32 gb and took 7 h the dimensionless results are compared together in fig 5 in which the red curves represent the bubble and solid sphere profiles extracted from the experimental results li et al 2019 and the blue dashed circle shows the initial location of the solid sphere we can see that the sphere is pushed away by the bubble during its expansion and attracted when the bubble collapse generally the violent bubble moving in the gravity field will develop an upward jet due to the gradient of the hydrostatic pressure however the dimensionless gravity is only 1 5 1 0 3 as a result the gravity effects are negligible and the motion of the bubble is mainly dominated by the solid wall that induces the development of the leftward liquid jet because of the existence of the sphere the bubble is not axisymmetric it also attracts the bubble during the collapse such that a bulge emerges at the up right corner of the bubble besides a tilted jet forms and penetrates the bubble to form a toroidal one these results are not given in li et al 2019 because it is non trivial to consider the transition from a single connected problem to a double connected one in the bem overall the two sets of results agree well 3 3 water entry of a solid sphere 3 3 1 vertical water entry compared with experiments now we consider a solid sphere entering the water from the air vertically as discussed in truscott et al 2014 this canonical problem is affected by the wettability of the solid material if the surface tension effects dominate it to avoid the influence of the surface tension we focus on the high weber number problem the case is taken from aristoff et al 2010 that carried out a water entry experiment of a steel sphere the radius of the sphere is r s 1 27 cm and the impact speed is u 0 0 0 217 cm s the froude number is f r ρ u 0 r s g 2 81 the density of the sphere is ρ s 7 86 g cm 3 denoting σ 0 076 n m as the surface tension between the water and air the weber number w b ρ u 0 2 r s σ is about 787 that is high enough to neglect the surface tension effects in the simulation this problem is non dimensionalized by the length scale of the sphere radius r s the density scale of the water density and the pressure scale of the atmosphere because of the symmetry of the problem only one fourth of the spatial domain is solved with the computational domain taken as a block bounded by 0 15 r s 0 15 r s 50 r s 10 r s and the cell size is set to 0 058 r s the impenetrable boundary condition is applied to all the boundaries of the computational domain the solid sphere is initially released at 0 0 2 r s with the downward velocity of u 0 and the time when the sphere center passes the free surface is marked as t 0 the simulation takes 31 h with 24 cores on the computer provided by cstc china science technology cloud in fig 6 the simulated results are presented with the experimental cavity profiles represented by the red solid curves the figure shows the evolution of the splash curtain above and the cavity below the free surface all the known phenomena of the cavity are well simulated including the cavity expansion collapse pitch off and the jet development of the two separated cavities however the closure of the splash curtain above the free surface is not observed in the numerical results the reason is that the fluid mesh is too coarse to form a stable thin curtain such that it breaks too early into small drops 3 3 2 water entry with varying impact angles in this subsection another two water entry cases are tested with different impact angles the impact angle denotes the angle between the directions of the gravity and the sphere velocity when passing the free surface in these two cases all the conditions are the same with the previous section 3 3 1 except that the initial speed of the solid sphere is u 0 217 cm s and the solid sphere impacts the free surface with the angles of 3 0 and 6 0 between the released velocity and the gravity respectively in the simulation the half of the spatial domain for y 0 is simulated and the other half is recovered by symmetry the sphere is released at 0 0 2 r s for both the two cases and their results are shown in figs 7 and 8 we can see that the cavities evolve almost axisymmetrically along the sphere s trajectories for the case with the impact angle of 30 the pitch off time is the same as the vertical water entry case only the jet tilted away from the trajectory of the sphere a little during the collapse of the two separated cavities as shown in fig 7 e as for the water entry with an impact angle of 6 0 the asymmetry develops much earlier as shown in fig 8 e an upward strip jet emerges at the lower surface of the cavity the zoom in view of the part of the cavity bounded by the red dashed rectangle is shown in fig 8 g we can see that strip jet impacts on the upper side of the cavity and penetrates it this can be attributed to the hydrostatic pressure gradient caused by the gravity similar phenomena are commonly observed in the researches of bubble dynamics in the gravity field cui et al 2016 zhang and liu 2015 klaseboer et al 2005 wang et al 2003 wang 2013 to investigate the effects of the impact angle on the trajectory of the sphere we plot the simulated trajectories from the three cases together in fig 9 markers are placed on the three trajectories with the time interval of 5 ms from t 0 the pitch off point is denoted as the red circle for each case we can see that the trajectory of the sphere with a greater impact angle bends downwards more due to the gravity the collapse and the pitch off of the cavity caused by the hydrostatic pressure gradient at the same time the sphere with a greater impact angle reaches a smaller depth beneath the free surface where the hydrostatic pressure is also smaller thus the collapse and the pitch off are both delayed 4 concluding remarks in this paper the penalty ibm within the framework of the eulerian finite element method is improved to resolve the fluid solid interaction problems in the present approach the conservativeness of total energy is ensured by a correction procedure in the eulerian step such that correct results are obtained when there is a strong shock the penetrated depth is updated considering both the relative normal velocity and its tangential convection on the solid surface by simulating and analyzing several fluid solid interaction cases the present penalty ibm is validated it should be noted that the present approach is also applicable to the interaction of the fluid and a submerged resilient structure with a proper structural dynamics solver based on the present model a 1 dimensional test case of a moving piston in an ideal gas is simulated and compared with the analytical solution the shock propagation is correctly computed which is attributed to the energy correction procedure on the contrary the commercial software abaqus fails to obtain the correct fluid state behind the shock for 3 dimensional problems we simulate a bubble sphere interaction and three high speed water entry problems using our numerical model all the known features are captured in the simulation the results are also compared with experimental ones and exhibit good agreement credit authorship contribution statement zhao li tian writing original draft formal analysis a man zhang conceptualization methodology yun long liu funding acquisition writing review editing shi ping wang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to acknowledge the support of the national natural science foundation of china grant nos 51879050 and 52088102 the china postdoctoral science foundation grant nos 2016m600244 and 2018t110271 and the heilongjiang postdoctoral fund china grant nos lbh z20131 lbh tz07 
20426,in this paper we present an efficient accurate and fully lagrangian numerical solver for modeling wave interaction with oscillating wave surge converter owsc the key idea is to couple sphinxsys an open source multi physics library in unified smoothed particle hydrodynamic sph framework with simbody which presents an object oriented application programming interface for multi body dynamics more precisely the wave dynamics and its interaction with owsc is resolved by a riemann based weakly compressible sph method in sphinxsys and the solid body kinematics is computed by simbody library numerical experiments demonstrate that the proposed solver can accurately predict the wave elevations flap rotation and wave loading on the flap in comparison with laboratory experiment and numerical investigation in particularly the new solver shows optimized computational performance through cpu cost analysis and comparison with commercial software package ansys fluent and other sph based solvers in literature furthermore a linear damper is applied for imitating the power take off system to study its effects on the hydrodynamics properties of owsc and efficiency of energy harvesting in addition the present solver is used to model extreme wave condition using the focused wave approach to investigate the extreme loads and motions of owsc under such extreme wave conditions it is also worth noting that though the model validation used herein is a bottom hinged oscillating wave energy converter wec the obtained numerical results show promising potential of the proposed solver to future applications in the design of high performance wecs keywords wave energy converter wec smoothed particle hydrodynamics sph simbody wave structure interaction oscillating wave surge converter owsc 1 introduction in the past decades renewable ocean wave energy has received tremendous worldwide attention thanks to its abundant and dense energy form and in particular low environmental impact nature consequently various types of wave energy converters wecs have been developed to harvest electrical power from ocean waves day et al 2015 windt et al 2018 2020 in general the working principle of the majority falls into four categories namely over topping devices oscillating water column devices oscillating bodies and the others and more details are referred to a comprehensive review antonio 2010 as one of the most promising wecs the oscillating wave surge converter owsc an example of which is shown in fig 1 has demonstrated its energy absorption capability and hydrodynamic performance whittaker et al 2007 renzi and dias 2013 dias et al 2017 the owsc consists of a surface piercing flap hinged near the seabed and oscillating back and forth under the interaction with the conforming incident waves the flap s oscillating motion can be converted into electrical energy by pumping high pressure water ashore to drive a hydro electric turbine whittaker et al 2007 wei et al 2015 as experimental study of owsc has the drawbacks of time consuming and economic expensive numerical study is of great importance for understanding the hydrodynamics property assessing the power production and optimizing control strategy renzi and dias 2013 penalba et al 2017 concerning the numerical study of owsc a set of mathematical models have been developed in literature penalba et al 2017 dias et al 2017 folley et al 2007 developed a linearized frequency domain model for small seabed mounted bottom hinged wecs and they applied a commercial package based on boundary element method bem e g wamit for predicting the wave force radiation damping and added mass renzi and dias 2012 2013 proposed a semi analytical model based on potential flow for three dimensional modeling of owsc in channel renzi and dias 2012 and open ocean renzi and dias 2013 these models are simple and computationally efficient and able to correctly predict the hydrodynamics properties of owsc however they are unable to capture non linear effects due to the notable assumptions of the potential flow theory the non linear effects such as over topping and slamming are of great importance for correctly predicting the flap motion as strong wave loads and large amplitude oscillations are expected during its operation therefore navier stokes ns cfd mesh based solvers have been widely applied in modeling of wave interaction with owsc wei et al 2015 2016 used the commercial package ansys fluent to study the viscous wei et al 2015 and slamming wei et al 2016 dias and ghidaglia 2018 effects on owsc schmitt and elsaesser 2015 applied the openfoam toolbox to assess the applicability of reynolds averaged ns rans solver for the simulation of owsc mesh based methods have demonstrated their accuracy in capturing the nonlinear effects however they are generally computational expensive as the complex mesh moving occurs during the flap s large oscillating motion an alternative approach meshless methods such as smoothed particle hydrodynamics sph have gained popularity in the simulation of nonlinear wave dynamics and wave structure interactions wsi in the past decade ye et al 2019 luo et al 2019 luo and koh 2017 khayyer et al 2018 as a fully lagrangian meshless method sph method was originally proposed by lucy 1977 and gingold and monaghan 1977 for astrophysical applications since its inception sph method has been successfully exploited in a broad variety of applications ranging from solid mechanics libersky and petschek 1991 monaghan 2000 to fluid dynamics monaghan 1994 hu and adams 2006 and fluid structure interactions fsi antoci et al 2007 zhang et al 2021a ye et al 2019 gotoh and khayyer 2018 khayyer et al 2009 thanks to its lagrangian feature sph method is particularly well suited for modeling problems involving significantly varying topology and free material surfaces zhang et al 2017a 2019 recently sph method has been extended to simulate wave interaction with wecs dias et al 2017 rafiee et al 2013 and henry et al 2013 developed an in house ucd sph code based on openmp parallelization for modeling wave interaction with owsc where the flap is considered as a rigid body and its kinematics is resolved directly in the sph framework crespo et al 2018 conducted an sph simulation for wave interaction with oscillating water column converter instead of directly computing newton euler equation to capture the kinematics of rigid body in sph framework brito et al 2016 presented a numerical approach by coupling dualsphysics with chrono project to study the wave interaction with owsc in their work the mesh free dualsphysics implementation is considered for fluid descriptions and chrono for mechanical systems following brito et al 2016 wei et al 2019 presented a similar approach by coupling chrono with gpusph code despite of these developments sph method still suffers excessive computational efforts for three dimensional large scale modeling of owsc dias et al 2017 reported that approximated 70 h cpu time is taken for 13 s physical simulation time with 3 2 million particles on 72 processors of intel r xeon r cpu e5 2620 by using ucd sph code wei et al 2019 shown that the computational efforts can be reduced to 2 h for 2 s physical simulation time with 7 million particles with acceleration of graphics processing unit gpu on four nvidia tesla k80 gpus more recently brito et al 2020 reported 105 h computational time for 50 s physical simulation time with 11 4 million particles with nvidia gtx 2080 alongside an intel xeon e5 cpu by using dualsphysics with the advances in hardware large scale sph modeling of wecs is becoming more and more possible however sph based solver implemented on conventional central processing units cpus is still in its infancy in this paper we present an efficient robust and fully lagrangian numerical solver implemented on cpus for modeling wave interaction with owsc the new solver is based on coupling two open source libraries sphinxsys which is a multi physics library based on sph method and simbody which provides a high performance multi body physics object oriented c application programming interface api sphinxsys zhang et al 2020b 2021b has shown its robustness accuracy and versatility in modeling fluid dynamics zhang et al 2020a solid mechanics and fluid structure interaction zhang et al 2021a zhu et al 2021 and multi physics problems in cardiac function zhang et al 2021 by coupling sphinxsys with simbody the proposed solver provides an integrative interface for modeling fluid interaction with arbitrarily defined rigid flexible and the combined structures the new solver is validated by modeling of regular wave interaction with owsc and comparing the results with experimental data wei et al 2015 and those in literature wei et al 2015 dias et al 2017 brito et al 2016 more importantly the present solver shows great computational performance compared with the commercial software package ansys fluent wei et al 2015 ucd sph code dias et al 2017 and other open source sph library brito et al 2020 having the validation a linear damper is applied to imitate the power take off system pto to study its effects on the hydrodynamics properties of owsc and efficiency in energy harvesting then the extreme loads and motions of owsc under extreme wave conditions are also investigated by modeling extreme wave condition using the focused wave approach the remainder of this paper is organized as follows section 2 presents riemann based sph method applied in sphinxsys for modeling fluid dynamics the principle characteristic for simbody and the detailed coupling procedure numerical validations and applications for modeling wave interaction with owsc are presented and discussed in section 3 concluding remarks are given in section 4 and all the codes and data sets accompanying this work are available in repository of sphinxsys zhang et al 2020b 2021b at github and https www sphinxsys org 2 methods in this section we first briefly summarize the numerical principle characteristics of sphinxsys whose detailed algorithms and rigorous validations are referred to refs zhang et al 2020a b zhang et al 2021 zhang et al 2021a and zhang et al 2021b then the main characteristics of simbody library is introduced and the coupling procedure is presented in detail 2 1 governing equations the mass and momentum conservation equations for incompressible fluid can be written in the lagrangian frame as 1 d ρ d t ρ v ρ d v d t p μ 2 v ρ g where ρ is the density v the velocity p the pressure μ the dynamic viscosity g the acceleration due to gravity and d d t t v represents the material derivative in weakly compressible sph wcsph method the weakly compressible assumption monaghan 1994 morris et al 1997 is introduced for modeling incompressible flow where an artificial isothermal equation of state eos 2 p c 2 ρ ρ 0 is used to close the system of eq 1 with the weakly compressible assumption the density varies around 1 morris et al 1997 if an artificial sound speed of c 10 u m a x is employed with u m a x being the maximum anticipated flow speed 2 2 riemann based wcsph method the sphinxsys applies the riemann based wcsph method for fluid dynamics where the continuity and momentum equations are discretized as zhang et al 2017b 2020a 3 d ρ i d t 2 ρ i j m j ρ j u v i e i j w i j r i j d v i d t m i j 2 p ρ i ρ j i w i j m i j 2 μ ρ i ρ j v i j r i j w i j r i j here m is the mass of particle i v i j v i v j the relative velocity i w i j represents the gradient of the kernel function w v i j h where r i j r i r j and h is the smoothing length with respect to particle i and e i j r i j r i j also u and p are the solutions of inter particle one dimensional riemann problem constructed along the unit vector pointing from particle i to j following the piece wise constant reconstruction the initial states of the riemann problem are identical to those of particles i and j i e 4 ρ l u l p l c l ρ i v i e i j p i c i ρ r u r p r c r ρ j v j e i j p j c j for solving the one dimensional riemann problem the sphinxsys applies the low dissipation riemann solver proposed by zhang et al 2017b where 5 u ρ l c l u l ρ r c r u r p l p r ρ l c l ρ r c r p ρ l c l p r ρ r c r p l ρ l c l ρ r c r β u l u r ρ l c l ρ r c r with β min 3 max u l u r 0 c 1 denotes the low dissipation limiter zhang et al 2017b and c ρ l c l ρ r c r ρ l ρ r for computational efficiency the dual criteria time stepping method is applied for the time integration of the fluid dynamics following ref zhang et al 2020a two time step criteria are defined as the advection criterion δ t a d 6 δ t a d c f l a d min h v m a x h 2 ν and the acoustic criterion δ t a c 7 δ t a c c f l a c h c v m a x here c f l a d 0 25 c f l a c 0 6 v m a x the maximum particle advection velocity in the flow and ν the kinematic viscosity accordingly the advection criterion controls the updating frequency of particle configuration and the acoustic criterion determines the frequency of the pressure relaxation process more details and validations are referred to ref zhang et al 2020a also at the beginning of each advection time step the density is reinitialized by 8 ρ i max ρ ρ 0 w i j w i j 0 where ρ denotes the density before re initialization and superscript 0 represents the initial reference value 2 3 simbody library as an open source library licensed under apache license 2 0 simbody https simtk org projects simbody is distributed in binary form for multiple platforms and presents an object oriented api to the application programmers who are of interest to handle the modeling and computational aspects of multi body dynamics the simbody can be applied for incorporating robust high performance and minimal coordinate o n multi body dynamics into a variety range of domain specific end user applications for example it is used by biomechanists in opensim by roboticists in gazebo and by biomolecular researcher in macromoleculebuilder mmb in the top level architecture simbody consists of three primary objects i e system state and study as shown in fig 2 the system object encapsulates of bodies joints and forces of a model and defines its parameterization a complete set of values for each of the system s parameters is called a state and the response of a system is determined by the state values a system s compatible state object has the entries for the values of each state for example time position and velocity a study object couples a system and one or more states and represents a computational experiment intended to reveal something about the system for example a simple evaluation study merely asks the system to evaluate specific quantities such as the position using the values taken from a particular state 2 4 sphinxsys and simbody coupling as mentioned in the previous section 2 3 an object oriented c api is provided by simbody and this feature makes its coupling with sphinxsys straightforward in the present framework the hydrodynamic force exerted on the rigid body is computed by sphinxsys and passed to simbody to predict the combined translational and rotational motion by solving the newton euler equation all the kinematic states e g station location velocity and acceleration are stored in simbody and passed back to sphinxsys for updating the position velocity and normal of an ensemble of particles belonging to the corresponding rigid body in sphinxsys all media are modeled as sph bodies and each body is composed of an ensemble of sph particles as shown in fig 3 which represents a typical example of modeling flow induced vibration of a flexible beam attached to a rigid cylinder in this framework whole or parts of solid particles can be constrained to characterize the rigid body dynamics for example the cylinder part can be fixed or moving accordingly by solving newton euler equation and the beam part is constrained to the cylinder meanwhile deformed under the interaction with the surrounding flow for modeling of fluid structure interactions the total force exerted on the structure by the surrounding fluid is evaluated through 9 f a n f a where n is the total particle number for the solid structure and f a is calculated through 10 f a 2 i v i v a p i ρ a d p a d ρ i ρ i ρ a d a w a i 2 i ν v i v a v i v a d r a i w a i r a i where the subscript letter a and i represent particle belong to solid and fluid body respectively in eq 10 the first and second terms in the right hand side rhs denote the pressure and viscous force respectively the imaginary pressure p a d and velocity v a d are defined by 11 p a d p i ρ i max 0 g d v a d t n r a i n v a d 2 v i v a where n denotes the normal pointing from solid to fluid then the total torque acting about the center of mass of the solid body can be expressed as 12 τ a n r a r c o m f a where r c o m is the center of mass at the end of each fluid time step the total force and torque are obtained and passed to simbody for solving the newton euler equation 13 f τ m i 0 0 i d v d t d ω d t 0 k d ω where m is the mass of flap i the identity matrix i the moment of inertia about the center of mass ω the angular velocity and k d the damping coefficient note that eq 13 introduces a linear damper for modeling the pto damping of owsc the detailed coupling procedure is given in the following at the beginning of the advection step the fluid density is reinitialized by eq 8 and the viscous force exerted on the solid body is also computed then the pressure relaxation process is repeated several times zhang et al 2020a by using the position based verlet scheme proposed in ref zhang et al 2021a at first the integration of the fluid is conducted as 14 ρ i n 1 2 ρ i n 1 2 δ t a c d ρ i d t r i n 1 2 r i n 1 2 δ t a c v i n by updating the density and position fields into the mid point then particle velocity is updated to the new time step 15 v i n 1 v i n δ t a c d v i d t finally the position and density of fluid particles are updated to the new time step by 16 r i n 1 r i n 1 2 1 2 δ t a c v i n 1 ρ i n 1 ρ i n 1 2 1 2 δ t a c d ρ i d t at this point the total pressure force exerted on the solid body is also computed now the total force and torque are obtained and passed to simbody to solve the newton euler equation and update the state with a runge kutta merson integrator having the new state the position velocity and normal of the whole or part of solid particles are updated an overview of the present coupling procedure is shown in fig 4 it is worth noting that directly computing newton euler equation to capture the kinematics of rigid body in the sph framework is also feasible and has been implemented in the work of rafiee et al 2013 henry et al 2013 and dias et al 2017 however coupling sphinxsys with simbody as presented in this work allows us to explore more challenging scenarios e g passive and active flexible fish like body swimming wave interaction with elastic structures and flow driven multi body collisions which will be explored in the future work 2 5 wave making and elimination in riemann base wcsph the solid wall boundary can be treated as dummy particle whose interaction with fluid is determined by solving one sided riemann problem along the wall normal direction zhang et al 2017b subsequently the regular wave can be generated by imposing a piston type wave maker which consists of an ensemble of dummy particles whose displacement is determined by the linear wavemaker theory 17 r a s sin f t ϕ where s is the wave stroke f the wave frequency and ϕ the initial phase here the wave stroke s is determined by 18 s h sinh 2 k h 0 2 k h 0 sinh 2 k h 0 tanh k h 0 where h is the wave height h 0 the water depth and k the wave number for wave elimination a damping zone is implemented as passive wave elimination system where the velocity of the fluid particles reduces at each time step according to their locations in the zone with quadratic decay subsequently the velocity is modified by 19 v v 0 1 0 δ t α r r 0 r 1 r 0 where v 0 denotes the initial velocity of the fluid particle at the entry of the damping zone v the velocity after damping δ t the time step r 0 and r 1 are the initial and final positions of the damping zone respectively also the reduction coefficient α controls the modifications on the velocity at each time step and herein we adopt α 5 0 3 modeling of wave interaction with owsc in this section we present the modeling of wave interaction with owsc with the proposed numerical solver we first conduct the validation by comparing the numerical results with experimental data wei et al 2015 and those in literature wei et al 2015 dias et al 2017 brito et al 2016 by using mesh based or meshless methods then we analyze the computational efficiency by comparing the normalized cpu time with that of ansys fluent ansys 2012 ucd sph code dias et al 2017 and dualsphysics brito et al 2020 subsequently the new solver is applied for studying the effects and energy harvesting efficiency of pto system and extended to investigate the extreme loads on owsc under extreme wave condition 3 1 numerical setup the present numerical setup is identical to the experiment conducted at the marine research group s hydraulics laboratory at queen s university belfast wei et al 2015 following ref wei et al 2015 the numerical wave tank nwt is 18 4 m long 4 58 m wide and 1 0 m high as shown in fig 5 the owsc shape is simplified as a 1 04 0 48 0 12 m box type flap which is located 7 92 m far from the wave maker in x axis and in the center of the nwt in z axis and hinged to a 0 16 m high base the mass of the flap is 33 kg and the inertia of the flap is 1 84 kg m 2 in order to investigate the time variation of the pressure loads an array of 6 pressure sensors located one side of the front face of the flap toward the wave maker is used the positions of the sensors are given in table 1 and sensors ps 03 and ps 11 pierce the initial water free surface note that there are 13 pressure sensors in the experiment wei et al 2015 and herein we choose 6 of them for comparison following the work of wei et al 2015 similarly three wave probes there are 14 wave probes in the experiment were placed in the nwt to elevate the free surface and their locations are given in table 2 for clarity the pressure sensors and wave probes are termed identical to those of the experiment note that the wave propagates along the x axis the y axis is along the vertical direction height of the nwt the flap rotates along the z axis width of the nwt and the rotation angle is positive when the flap pitches landward also the present model is 1 25 scale and all the results presented in this paper have been converted to full scale as in ref wei et al 2015 to discretize the system the initial particle space is set as d p 0 03 m resulting in a number of 1 542 million fluid particles and 0 628 million solid particles including tank wave maker and flap the 5 t h order wendland kernel wendland 1995 with a smoothing length of h 1 3 d p and a cut off radius of 2 6 d p is employed in all the following simulations 3 2 model validation in this section we consider the regular wave interaction with owsc in condition of wave height h 5 0 m and wave period t 10 s in full scale for rigorous and comprehensive validation comparisons of the main principle aspects of wave flap interaction i e wave elevation wave loads on the flap and the flap s rotation will be conducted same as ref wei et al 2015 3 2 1 wave propagation and its interaction with owsc fig 6 presents several snapshots showing the free surface colored by normalized pressure 6a and velocity magnitude 6b and the flap s rotation predicted by the present solver it can be observed that smooth pressure and velocity fields are produced even when complex interactions between the wave and the flap are involved it is also worth noting that wave refection and breaking can be seen in the region near the flap during the interaction these phenomena can be clearly observed in the time history of the wave elevation presented in the following fig 7 shows the comparison of the present numerical prediction and the laboratory observation and numerical investigation wei et al 2015 for the time histories of the water elevation at probes wp 04 wp 05 and wp 12 for wp 04 which is in the seaward of the flap and 3 93 m far away from it a good agreement with the experimental and numerical data is noted for wp 05 and wp 12 which measure the wave elevation right before and after wave passing the flap noticeable discrepancies are exhibited due to the wave reflection and breaking compared with the numerical results obtained with ansys fluent in ref wei et al 2015 the wave breaking phenomena are more visible due to the lagrangian nature of sph method 3 2 2 wave induced rotation of the flap fig 8 shows the comparison of the time history of the flap rotation between the present numerical result and the experimental data and also numerical data in literature using mesh based solver wei et al 2015 or sph based solver dias et al 2017 rafiee et al 2013 henry et al 2013 brito et al 2016 and the corresponding numerical predicted total force on the flap the comparison in fig 8a shows that the present solver accurately predicted the large amplitude rotation of the flap implying a robust and stable feature of the coupling between sphinxsys and simbody for wsi applications compared with results using other sph based solver i e ucd sph rafiee et al 2013 henry et al 2013 dias et al 2017 and dualsphysics brito et al 2016 the present solver shows improved accuracy in predicting the flap rotation as noted by wei et al 2015 the flap s large amplitude rotation is hard to handle by mesh based methods which require complex mesh technique for moving interface however the present solver shows its promising capability of dealing with these difficulties thanks to its very meshless nature fig 8b shows the time history of total force on flap in x and y axis as expected the force component in x axis as the main force driving flap rotation shows very similar varying pattern with the rotation profile on other hand the y axis component representing the hydrostatic pressure shows fluctuation due the wave refection and breaking as observed in fig 7 3 2 3 wave loads on the flap to optimize the structure design of owsc it is also of significant importance to accurately predict the wave loads on its main operating device i e the flap in this study fig 9 shows the time histories of the pressure signals recorded on selected sensors given in table 1 and their comparison with the experimental and numerical data wei et al 2015 note that the selected sensors are distributed at the top ps 03 and ps 11 middle ps 01 and ps 09 and bottom ps 05 and ps 13 of the flap following wei et al 2015 the initial hydrostatic pressure is subtracted from the recorded pressure signals inducing a negative drops in some profiles compared with the experimental and numerical data the main plateaus of all the pressure profiles are reasonably well captured by the present solver even if slight discrepancies are noted for sensors ps 01 ps 03 and ps 11 large pressure peaks and drops are noted since the present sph model is based on weakly compressible assumption and air cushion effects are not captured in single fluid simulation similar to the results reported in ref wei et al 2015 the pressure drops for sensors ps 05 and ps 13 are underestimated in present results and these discrepancies are related to the wave breaking which results a higher crest elevation compared with experiment as shown in fig 6 also note that these discrepancies are also likely to be associated with the stochastic nature of the impact pressures and the lack of exact repeatability of the experiments compared with the numerical results obtained with ansys fluent reported in ref wei et al 2015 the present pressure peaks show large magnitudes and fluctuations due to its lagrangian nature and weakly compressible assumption it is worth noting that these large peak magnitudes are not observed in the results obtained by ucd sph code dias et al 2017 henry et al 2013 rafiee et al 2013 and this may due to the fact that ucd sph applied hllc harten lax and van leer contact riemann solver for riemann based wcsph rafiee et al 2012 which induces excessive dissipation zhang et al 2017b also it is interesting to conduct sph simulation with consideration of air cushion to investigate its effects on pressure peak and it will be the main objective of our future work 3 3 computational efficiency to rigorously assess the computational performance we analyze the total cpu time of the present simulation and those or approximated ones reported in literature with different computational models including commercial software package ansys fluent wei et al 2015 in house ucd sph code rafiee et al 2013 dias et al 2017 dualsphysics crespo et al 2015 brito et al 2020 and gpusph wei et al 2019 for comparison the total cpu time is normalized by total physical time and total cell or particles numbers the ucd sph code was developed by rafiee et al 2013 dias et al 2017 and parallelized based on openmp as for dualsphysics which is implemented with gpu acceleration the total cpu time can be approximated by considering the corresponding speedup reported in ref crespo et al 2015 for comparison the total cpu time normalized by total physical time and total number of cells or particles is defined as cpu time t t n n cpu s where t represents the computing time in the unit of hour t the physical time for simulation in the unit of second n the total particle or element number in the unit of million n cpu the number of cores and s the speedup for gpu acceleration reported in literature in present work the computations are carried out on an intel xeon cpu e5 2620 v3 2 40 ghz desktop computer with 64 gb ram and scientific linux system 7 8 the ansys fluent and ucd sph code are performed on the stokes cluster of the irish centre for high end computing ichec and the stokes is an sgi altix ice 8200ex cluster with 320 compute nodes each node has two intel westmere xeon e5650 hexa core processors and 24 gb of ram and the nodes are interconnected via two planes of connectx infiniband ddr table 3 reports the computation time and the normalized cpu time with the corresponding physical time cell or particle number and system information for different models although the cpu versions are different there is no doubt that the present solver shows impressive computational performance for three dimensional large scale simulations also this performance can be further improved by implementing gpu acceleration which is our ongoing work and will be released soon note that as an open source library the code and data sets accompanying this validation is available on the repository of sphinxsys in github and https www sphinxsys org zhang et al 2021b 3 4 power take off effects and its energy capture factor the simbody provides a linear damper which acts along or around any mobility coordinate to apply a generalized force there which can be applied to imitate the mechanical damping of the pto operations in present owsc model this process can be defined by eq 13 where a damping force proportional to angular velocity is introduced note that the damping coefficient k d represents the extent of kinematic constraint on the flap having the pto the efficiency of wave energy harvesting of owsc can be quantitatively described by the capture factor cf which represents the ratio of the power extracted by owsc to the incident wave power defined as 20 c f p w e 0 where p w denotes the time averaged power extracted by pto system and e 0 the time averaged energy flux of incident wave following the work of senol and raessi 2019 the extracted power p w can be computed as 21 p w 1 2 ω 2 k d θ 2 where ω is the angular frequency of the incident wave k d the damping coefficient and θ the rotation amplitude in the pitch component of the flap also the mean energy flux e 0 is calculated as 22 e 0 ρ 0 g ω h 2 16 k 1 2 k h 0 sinh 2 k h 0 b where b represents the width of the flap fig 10 shows the time histories of the flap rotation by applying the linear damper with different damping coefficients based on the validated model i e wave height h 5 0 m and wave period t 10 0 s as expected the rotation amplitude is further reduced as the damping coefficient increase it is worth noting that the reduction of the flap rotation does not fit a linear relationship e g the rotation reduction ratio from k d 0 to k d 20 is not equal to that from k d 20 to k d 40 indicating that the pto operation may represents a nonlinear process fig 11 shows the time histories of the pressure recorded by the pressure sensors given in table 1 for damping coefficients k d 20 k d 40 and k d 80 one notable phenomenon is that the pressure peaks are reduced or eliminated for pressure sensors ps 01 ps 03 and ps 11 due to the reduced rotation of the flap this may imply that the strength of the slamming event which leads to the pressure peak wei et al 2015 is significantly reduced or even eliminated when damping operation is conducted also the pressure drops for sensors ps 05 ps 09 and ps 13 show better agreement with experimental data compared with the results where no damping is imposed this indicates that wave reflection and breaking are also reduced during damping operations fig 12 gives the variation of the cf in terms of damping coefficients k d it can be observed that the cf is enhanced as the damping coefficient increase and reaches the maximum about 0 4 when k d 40 and then shrinks as the damping coefficient further increases implying that its optimized value of the cf may be achieved for moderate damping coefficient note that the present investigation of the cf is conducted with a linear pto system under regular wave condition and further rigorous investigation should consider a nonlinear pto system under irregular wave condition which is out of the main scope of the present paper and will be conducted in the future work 3 5 extreme loads prediction of extreme loads on the device of wecs is of significant importance for the structure design however experimental study of the extreme loads is challenging due to its time and economic expensive nature for long time performance of wave tank test in this work we apply the present solver to estimate extreme loads on owsc by considering extreme wave condition based on focused wave approach note that the extreme wave herein represents the focused wave in a group of localized waves and the extreme loads reports the wave loading due to the wave focusing the intent of this study is to exploit the applicability of the focused wave approach in estimating the corresponding induced extreme loads on the owsc device in general any wave elevation can be considered as the combination of a certain number of small amplitude waves therefore the surface elevation at any point in spatio temporal spaces can be written as 23 η x t i 0 n a i cos k i x ω i t ϕ i where a i is the wave amplitude k i the wave number ω the angular frequency and ϕ i the phase for i th wave component in the focused wave approach the phase of each wave component is defined as 24 ϕ i k i x f ω i t f where x f and t f denote the focal position and time respectively the amplitude of each wave component takes the form of 25 a i a f s ω i δ ω i s ω i δ ω where a f is the target amplitude of the focused wave and s ω i the spectral density in this work we apply the pierson moskowitz spectra rafiee and fiévez 2015 for modeling the wave spectra and it is given by 26 s ω i 5 16 h s 2 ω p 4 ω i 5 exp 5 4 ω i ω p 4 where h s 6 0 m and ω p 2 π are the significant wave height and peak spectra wave angular frequency respectively for piston type wave maker the time history of the stroke is given by ning et al 2009 27 s 0 t i 0 n a i t r i sin k i x ω i t ϕ i here the transfer function t r represents the relationship between the wave height and is given as gao et al 2016 28 t r i 2 cosh 2 k i h 0 1 sinh 2 k i h 0 2 k i h 0 fig 13 shows the time history of the wave elevation at the focused location x f 7 6 m and the corresponding flap rotation as shown in fig 13a a sharp wave crest is found at the focused time t f 50 s and the amplitude of the surface elevation decreases as the energy content of the wave decrease also wave breaking is noted due to the interaction with the flap fig 13b gives the time history of the flap rotation under the interaction with the focused wave as expected the sharp wave crest induces a large amplitude rotation of the flap and the amplitude decreases as the wave crest past by fig 14 shows the time histories of the pressure signals recorded on selected sensors given in table 1 in extreme wave condition for pressure sensors ps 01 ps 03 and ps 11 which are located close to the surface a very large pressure peak is observed when the wave crest is impacting on the flap indicating that a freak wave may induce extreme loads on the flap 4 concluding remarks an efficient robust and accurate numerical solver is proposed by coupling open source multi physics sph based library sphinxsys with multi body physics library simbody for modeling wave interaction with an bottom hinged owsc the proposed numerical solver is validated by comparing the predicted wave elevation flap rotation and wave loading on the flap with experimental data and those obtained in literature with different numerical models the comparisons show that the present solver properly predicts the hydrodynamics properties of owsc more importantly optimized computational performance is achieved in the present solver then the validated solver is applied to study the pto effects and efficiency and investigate the extreme loads on the flap under extreme wave conditions these numerical results demonstrate its promising potential to future practical applications in the design of high performance wecs in future work gpu implementation will be conducted to further improve the computational efficiency and the slamming effects wei et al 2016 dias and ghidaglia 2018 on owsc will also be studied also investigation of harvesting energy efficiency with nonlinear pto system under irregular wave condition will be conducted credit authorship contribution statement chi zhang investigation methodology visualization validation formal analysis writing original draft writing review editing yanji wei investigation writing review editing frederic dias investigation writing review editing xiangyu hu investigation supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments c zhang and x y hu would like to express their gratitude to deutsche forschungsgemeinschaft dfg germany for their sponsorship of this research under grant numbers dfg hu1527 10 1 and hu1527 12 1 the work of f dias has been funded by science foundation ireland sfi under marine renewable energy ireland marei the sfi center for marine renewable energy ireland grant 12 rc 2302 
20426,in this paper we present an efficient accurate and fully lagrangian numerical solver for modeling wave interaction with oscillating wave surge converter owsc the key idea is to couple sphinxsys an open source multi physics library in unified smoothed particle hydrodynamic sph framework with simbody which presents an object oriented application programming interface for multi body dynamics more precisely the wave dynamics and its interaction with owsc is resolved by a riemann based weakly compressible sph method in sphinxsys and the solid body kinematics is computed by simbody library numerical experiments demonstrate that the proposed solver can accurately predict the wave elevations flap rotation and wave loading on the flap in comparison with laboratory experiment and numerical investigation in particularly the new solver shows optimized computational performance through cpu cost analysis and comparison with commercial software package ansys fluent and other sph based solvers in literature furthermore a linear damper is applied for imitating the power take off system to study its effects on the hydrodynamics properties of owsc and efficiency of energy harvesting in addition the present solver is used to model extreme wave condition using the focused wave approach to investigate the extreme loads and motions of owsc under such extreme wave conditions it is also worth noting that though the model validation used herein is a bottom hinged oscillating wave energy converter wec the obtained numerical results show promising potential of the proposed solver to future applications in the design of high performance wecs keywords wave energy converter wec smoothed particle hydrodynamics sph simbody wave structure interaction oscillating wave surge converter owsc 1 introduction in the past decades renewable ocean wave energy has received tremendous worldwide attention thanks to its abundant and dense energy form and in particular low environmental impact nature consequently various types of wave energy converters wecs have been developed to harvest electrical power from ocean waves day et al 2015 windt et al 2018 2020 in general the working principle of the majority falls into four categories namely over topping devices oscillating water column devices oscillating bodies and the others and more details are referred to a comprehensive review antonio 2010 as one of the most promising wecs the oscillating wave surge converter owsc an example of which is shown in fig 1 has demonstrated its energy absorption capability and hydrodynamic performance whittaker et al 2007 renzi and dias 2013 dias et al 2017 the owsc consists of a surface piercing flap hinged near the seabed and oscillating back and forth under the interaction with the conforming incident waves the flap s oscillating motion can be converted into electrical energy by pumping high pressure water ashore to drive a hydro electric turbine whittaker et al 2007 wei et al 2015 as experimental study of owsc has the drawbacks of time consuming and economic expensive numerical study is of great importance for understanding the hydrodynamics property assessing the power production and optimizing control strategy renzi and dias 2013 penalba et al 2017 concerning the numerical study of owsc a set of mathematical models have been developed in literature penalba et al 2017 dias et al 2017 folley et al 2007 developed a linearized frequency domain model for small seabed mounted bottom hinged wecs and they applied a commercial package based on boundary element method bem e g wamit for predicting the wave force radiation damping and added mass renzi and dias 2012 2013 proposed a semi analytical model based on potential flow for three dimensional modeling of owsc in channel renzi and dias 2012 and open ocean renzi and dias 2013 these models are simple and computationally efficient and able to correctly predict the hydrodynamics properties of owsc however they are unable to capture non linear effects due to the notable assumptions of the potential flow theory the non linear effects such as over topping and slamming are of great importance for correctly predicting the flap motion as strong wave loads and large amplitude oscillations are expected during its operation therefore navier stokes ns cfd mesh based solvers have been widely applied in modeling of wave interaction with owsc wei et al 2015 2016 used the commercial package ansys fluent to study the viscous wei et al 2015 and slamming wei et al 2016 dias and ghidaglia 2018 effects on owsc schmitt and elsaesser 2015 applied the openfoam toolbox to assess the applicability of reynolds averaged ns rans solver for the simulation of owsc mesh based methods have demonstrated their accuracy in capturing the nonlinear effects however they are generally computational expensive as the complex mesh moving occurs during the flap s large oscillating motion an alternative approach meshless methods such as smoothed particle hydrodynamics sph have gained popularity in the simulation of nonlinear wave dynamics and wave structure interactions wsi in the past decade ye et al 2019 luo et al 2019 luo and koh 2017 khayyer et al 2018 as a fully lagrangian meshless method sph method was originally proposed by lucy 1977 and gingold and monaghan 1977 for astrophysical applications since its inception sph method has been successfully exploited in a broad variety of applications ranging from solid mechanics libersky and petschek 1991 monaghan 2000 to fluid dynamics monaghan 1994 hu and adams 2006 and fluid structure interactions fsi antoci et al 2007 zhang et al 2021a ye et al 2019 gotoh and khayyer 2018 khayyer et al 2009 thanks to its lagrangian feature sph method is particularly well suited for modeling problems involving significantly varying topology and free material surfaces zhang et al 2017a 2019 recently sph method has been extended to simulate wave interaction with wecs dias et al 2017 rafiee et al 2013 and henry et al 2013 developed an in house ucd sph code based on openmp parallelization for modeling wave interaction with owsc where the flap is considered as a rigid body and its kinematics is resolved directly in the sph framework crespo et al 2018 conducted an sph simulation for wave interaction with oscillating water column converter instead of directly computing newton euler equation to capture the kinematics of rigid body in sph framework brito et al 2016 presented a numerical approach by coupling dualsphysics with chrono project to study the wave interaction with owsc in their work the mesh free dualsphysics implementation is considered for fluid descriptions and chrono for mechanical systems following brito et al 2016 wei et al 2019 presented a similar approach by coupling chrono with gpusph code despite of these developments sph method still suffers excessive computational efforts for three dimensional large scale modeling of owsc dias et al 2017 reported that approximated 70 h cpu time is taken for 13 s physical simulation time with 3 2 million particles on 72 processors of intel r xeon r cpu e5 2620 by using ucd sph code wei et al 2019 shown that the computational efforts can be reduced to 2 h for 2 s physical simulation time with 7 million particles with acceleration of graphics processing unit gpu on four nvidia tesla k80 gpus more recently brito et al 2020 reported 105 h computational time for 50 s physical simulation time with 11 4 million particles with nvidia gtx 2080 alongside an intel xeon e5 cpu by using dualsphysics with the advances in hardware large scale sph modeling of wecs is becoming more and more possible however sph based solver implemented on conventional central processing units cpus is still in its infancy in this paper we present an efficient robust and fully lagrangian numerical solver implemented on cpus for modeling wave interaction with owsc the new solver is based on coupling two open source libraries sphinxsys which is a multi physics library based on sph method and simbody which provides a high performance multi body physics object oriented c application programming interface api sphinxsys zhang et al 2020b 2021b has shown its robustness accuracy and versatility in modeling fluid dynamics zhang et al 2020a solid mechanics and fluid structure interaction zhang et al 2021a zhu et al 2021 and multi physics problems in cardiac function zhang et al 2021 by coupling sphinxsys with simbody the proposed solver provides an integrative interface for modeling fluid interaction with arbitrarily defined rigid flexible and the combined structures the new solver is validated by modeling of regular wave interaction with owsc and comparing the results with experimental data wei et al 2015 and those in literature wei et al 2015 dias et al 2017 brito et al 2016 more importantly the present solver shows great computational performance compared with the commercial software package ansys fluent wei et al 2015 ucd sph code dias et al 2017 and other open source sph library brito et al 2020 having the validation a linear damper is applied to imitate the power take off system pto to study its effects on the hydrodynamics properties of owsc and efficiency in energy harvesting then the extreme loads and motions of owsc under extreme wave conditions are also investigated by modeling extreme wave condition using the focused wave approach the remainder of this paper is organized as follows section 2 presents riemann based sph method applied in sphinxsys for modeling fluid dynamics the principle characteristic for simbody and the detailed coupling procedure numerical validations and applications for modeling wave interaction with owsc are presented and discussed in section 3 concluding remarks are given in section 4 and all the codes and data sets accompanying this work are available in repository of sphinxsys zhang et al 2020b 2021b at github and https www sphinxsys org 2 methods in this section we first briefly summarize the numerical principle characteristics of sphinxsys whose detailed algorithms and rigorous validations are referred to refs zhang et al 2020a b zhang et al 2021 zhang et al 2021a and zhang et al 2021b then the main characteristics of simbody library is introduced and the coupling procedure is presented in detail 2 1 governing equations the mass and momentum conservation equations for incompressible fluid can be written in the lagrangian frame as 1 d ρ d t ρ v ρ d v d t p μ 2 v ρ g where ρ is the density v the velocity p the pressure μ the dynamic viscosity g the acceleration due to gravity and d d t t v represents the material derivative in weakly compressible sph wcsph method the weakly compressible assumption monaghan 1994 morris et al 1997 is introduced for modeling incompressible flow where an artificial isothermal equation of state eos 2 p c 2 ρ ρ 0 is used to close the system of eq 1 with the weakly compressible assumption the density varies around 1 morris et al 1997 if an artificial sound speed of c 10 u m a x is employed with u m a x being the maximum anticipated flow speed 2 2 riemann based wcsph method the sphinxsys applies the riemann based wcsph method for fluid dynamics where the continuity and momentum equations are discretized as zhang et al 2017b 2020a 3 d ρ i d t 2 ρ i j m j ρ j u v i e i j w i j r i j d v i d t m i j 2 p ρ i ρ j i w i j m i j 2 μ ρ i ρ j v i j r i j w i j r i j here m is the mass of particle i v i j v i v j the relative velocity i w i j represents the gradient of the kernel function w v i j h where r i j r i r j and h is the smoothing length with respect to particle i and e i j r i j r i j also u and p are the solutions of inter particle one dimensional riemann problem constructed along the unit vector pointing from particle i to j following the piece wise constant reconstruction the initial states of the riemann problem are identical to those of particles i and j i e 4 ρ l u l p l c l ρ i v i e i j p i c i ρ r u r p r c r ρ j v j e i j p j c j for solving the one dimensional riemann problem the sphinxsys applies the low dissipation riemann solver proposed by zhang et al 2017b where 5 u ρ l c l u l ρ r c r u r p l p r ρ l c l ρ r c r p ρ l c l p r ρ r c r p l ρ l c l ρ r c r β u l u r ρ l c l ρ r c r with β min 3 max u l u r 0 c 1 denotes the low dissipation limiter zhang et al 2017b and c ρ l c l ρ r c r ρ l ρ r for computational efficiency the dual criteria time stepping method is applied for the time integration of the fluid dynamics following ref zhang et al 2020a two time step criteria are defined as the advection criterion δ t a d 6 δ t a d c f l a d min h v m a x h 2 ν and the acoustic criterion δ t a c 7 δ t a c c f l a c h c v m a x here c f l a d 0 25 c f l a c 0 6 v m a x the maximum particle advection velocity in the flow and ν the kinematic viscosity accordingly the advection criterion controls the updating frequency of particle configuration and the acoustic criterion determines the frequency of the pressure relaxation process more details and validations are referred to ref zhang et al 2020a also at the beginning of each advection time step the density is reinitialized by 8 ρ i max ρ ρ 0 w i j w i j 0 where ρ denotes the density before re initialization and superscript 0 represents the initial reference value 2 3 simbody library as an open source library licensed under apache license 2 0 simbody https simtk org projects simbody is distributed in binary form for multiple platforms and presents an object oriented api to the application programmers who are of interest to handle the modeling and computational aspects of multi body dynamics the simbody can be applied for incorporating robust high performance and minimal coordinate o n multi body dynamics into a variety range of domain specific end user applications for example it is used by biomechanists in opensim by roboticists in gazebo and by biomolecular researcher in macromoleculebuilder mmb in the top level architecture simbody consists of three primary objects i e system state and study as shown in fig 2 the system object encapsulates of bodies joints and forces of a model and defines its parameterization a complete set of values for each of the system s parameters is called a state and the response of a system is determined by the state values a system s compatible state object has the entries for the values of each state for example time position and velocity a study object couples a system and one or more states and represents a computational experiment intended to reveal something about the system for example a simple evaluation study merely asks the system to evaluate specific quantities such as the position using the values taken from a particular state 2 4 sphinxsys and simbody coupling as mentioned in the previous section 2 3 an object oriented c api is provided by simbody and this feature makes its coupling with sphinxsys straightforward in the present framework the hydrodynamic force exerted on the rigid body is computed by sphinxsys and passed to simbody to predict the combined translational and rotational motion by solving the newton euler equation all the kinematic states e g station location velocity and acceleration are stored in simbody and passed back to sphinxsys for updating the position velocity and normal of an ensemble of particles belonging to the corresponding rigid body in sphinxsys all media are modeled as sph bodies and each body is composed of an ensemble of sph particles as shown in fig 3 which represents a typical example of modeling flow induced vibration of a flexible beam attached to a rigid cylinder in this framework whole or parts of solid particles can be constrained to characterize the rigid body dynamics for example the cylinder part can be fixed or moving accordingly by solving newton euler equation and the beam part is constrained to the cylinder meanwhile deformed under the interaction with the surrounding flow for modeling of fluid structure interactions the total force exerted on the structure by the surrounding fluid is evaluated through 9 f a n f a where n is the total particle number for the solid structure and f a is calculated through 10 f a 2 i v i v a p i ρ a d p a d ρ i ρ i ρ a d a w a i 2 i ν v i v a v i v a d r a i w a i r a i where the subscript letter a and i represent particle belong to solid and fluid body respectively in eq 10 the first and second terms in the right hand side rhs denote the pressure and viscous force respectively the imaginary pressure p a d and velocity v a d are defined by 11 p a d p i ρ i max 0 g d v a d t n r a i n v a d 2 v i v a where n denotes the normal pointing from solid to fluid then the total torque acting about the center of mass of the solid body can be expressed as 12 τ a n r a r c o m f a where r c o m is the center of mass at the end of each fluid time step the total force and torque are obtained and passed to simbody for solving the newton euler equation 13 f τ m i 0 0 i d v d t d ω d t 0 k d ω where m is the mass of flap i the identity matrix i the moment of inertia about the center of mass ω the angular velocity and k d the damping coefficient note that eq 13 introduces a linear damper for modeling the pto damping of owsc the detailed coupling procedure is given in the following at the beginning of the advection step the fluid density is reinitialized by eq 8 and the viscous force exerted on the solid body is also computed then the pressure relaxation process is repeated several times zhang et al 2020a by using the position based verlet scheme proposed in ref zhang et al 2021a at first the integration of the fluid is conducted as 14 ρ i n 1 2 ρ i n 1 2 δ t a c d ρ i d t r i n 1 2 r i n 1 2 δ t a c v i n by updating the density and position fields into the mid point then particle velocity is updated to the new time step 15 v i n 1 v i n δ t a c d v i d t finally the position and density of fluid particles are updated to the new time step by 16 r i n 1 r i n 1 2 1 2 δ t a c v i n 1 ρ i n 1 ρ i n 1 2 1 2 δ t a c d ρ i d t at this point the total pressure force exerted on the solid body is also computed now the total force and torque are obtained and passed to simbody to solve the newton euler equation and update the state with a runge kutta merson integrator having the new state the position velocity and normal of the whole or part of solid particles are updated an overview of the present coupling procedure is shown in fig 4 it is worth noting that directly computing newton euler equation to capture the kinematics of rigid body in the sph framework is also feasible and has been implemented in the work of rafiee et al 2013 henry et al 2013 and dias et al 2017 however coupling sphinxsys with simbody as presented in this work allows us to explore more challenging scenarios e g passive and active flexible fish like body swimming wave interaction with elastic structures and flow driven multi body collisions which will be explored in the future work 2 5 wave making and elimination in riemann base wcsph the solid wall boundary can be treated as dummy particle whose interaction with fluid is determined by solving one sided riemann problem along the wall normal direction zhang et al 2017b subsequently the regular wave can be generated by imposing a piston type wave maker which consists of an ensemble of dummy particles whose displacement is determined by the linear wavemaker theory 17 r a s sin f t ϕ where s is the wave stroke f the wave frequency and ϕ the initial phase here the wave stroke s is determined by 18 s h sinh 2 k h 0 2 k h 0 sinh 2 k h 0 tanh k h 0 where h is the wave height h 0 the water depth and k the wave number for wave elimination a damping zone is implemented as passive wave elimination system where the velocity of the fluid particles reduces at each time step according to their locations in the zone with quadratic decay subsequently the velocity is modified by 19 v v 0 1 0 δ t α r r 0 r 1 r 0 where v 0 denotes the initial velocity of the fluid particle at the entry of the damping zone v the velocity after damping δ t the time step r 0 and r 1 are the initial and final positions of the damping zone respectively also the reduction coefficient α controls the modifications on the velocity at each time step and herein we adopt α 5 0 3 modeling of wave interaction with owsc in this section we present the modeling of wave interaction with owsc with the proposed numerical solver we first conduct the validation by comparing the numerical results with experimental data wei et al 2015 and those in literature wei et al 2015 dias et al 2017 brito et al 2016 by using mesh based or meshless methods then we analyze the computational efficiency by comparing the normalized cpu time with that of ansys fluent ansys 2012 ucd sph code dias et al 2017 and dualsphysics brito et al 2020 subsequently the new solver is applied for studying the effects and energy harvesting efficiency of pto system and extended to investigate the extreme loads on owsc under extreme wave condition 3 1 numerical setup the present numerical setup is identical to the experiment conducted at the marine research group s hydraulics laboratory at queen s university belfast wei et al 2015 following ref wei et al 2015 the numerical wave tank nwt is 18 4 m long 4 58 m wide and 1 0 m high as shown in fig 5 the owsc shape is simplified as a 1 04 0 48 0 12 m box type flap which is located 7 92 m far from the wave maker in x axis and in the center of the nwt in z axis and hinged to a 0 16 m high base the mass of the flap is 33 kg and the inertia of the flap is 1 84 kg m 2 in order to investigate the time variation of the pressure loads an array of 6 pressure sensors located one side of the front face of the flap toward the wave maker is used the positions of the sensors are given in table 1 and sensors ps 03 and ps 11 pierce the initial water free surface note that there are 13 pressure sensors in the experiment wei et al 2015 and herein we choose 6 of them for comparison following the work of wei et al 2015 similarly three wave probes there are 14 wave probes in the experiment were placed in the nwt to elevate the free surface and their locations are given in table 2 for clarity the pressure sensors and wave probes are termed identical to those of the experiment note that the wave propagates along the x axis the y axis is along the vertical direction height of the nwt the flap rotates along the z axis width of the nwt and the rotation angle is positive when the flap pitches landward also the present model is 1 25 scale and all the results presented in this paper have been converted to full scale as in ref wei et al 2015 to discretize the system the initial particle space is set as d p 0 03 m resulting in a number of 1 542 million fluid particles and 0 628 million solid particles including tank wave maker and flap the 5 t h order wendland kernel wendland 1995 with a smoothing length of h 1 3 d p and a cut off radius of 2 6 d p is employed in all the following simulations 3 2 model validation in this section we consider the regular wave interaction with owsc in condition of wave height h 5 0 m and wave period t 10 s in full scale for rigorous and comprehensive validation comparisons of the main principle aspects of wave flap interaction i e wave elevation wave loads on the flap and the flap s rotation will be conducted same as ref wei et al 2015 3 2 1 wave propagation and its interaction with owsc fig 6 presents several snapshots showing the free surface colored by normalized pressure 6a and velocity magnitude 6b and the flap s rotation predicted by the present solver it can be observed that smooth pressure and velocity fields are produced even when complex interactions between the wave and the flap are involved it is also worth noting that wave refection and breaking can be seen in the region near the flap during the interaction these phenomena can be clearly observed in the time history of the wave elevation presented in the following fig 7 shows the comparison of the present numerical prediction and the laboratory observation and numerical investigation wei et al 2015 for the time histories of the water elevation at probes wp 04 wp 05 and wp 12 for wp 04 which is in the seaward of the flap and 3 93 m far away from it a good agreement with the experimental and numerical data is noted for wp 05 and wp 12 which measure the wave elevation right before and after wave passing the flap noticeable discrepancies are exhibited due to the wave reflection and breaking compared with the numerical results obtained with ansys fluent in ref wei et al 2015 the wave breaking phenomena are more visible due to the lagrangian nature of sph method 3 2 2 wave induced rotation of the flap fig 8 shows the comparison of the time history of the flap rotation between the present numerical result and the experimental data and also numerical data in literature using mesh based solver wei et al 2015 or sph based solver dias et al 2017 rafiee et al 2013 henry et al 2013 brito et al 2016 and the corresponding numerical predicted total force on the flap the comparison in fig 8a shows that the present solver accurately predicted the large amplitude rotation of the flap implying a robust and stable feature of the coupling between sphinxsys and simbody for wsi applications compared with results using other sph based solver i e ucd sph rafiee et al 2013 henry et al 2013 dias et al 2017 and dualsphysics brito et al 2016 the present solver shows improved accuracy in predicting the flap rotation as noted by wei et al 2015 the flap s large amplitude rotation is hard to handle by mesh based methods which require complex mesh technique for moving interface however the present solver shows its promising capability of dealing with these difficulties thanks to its very meshless nature fig 8b shows the time history of total force on flap in x and y axis as expected the force component in x axis as the main force driving flap rotation shows very similar varying pattern with the rotation profile on other hand the y axis component representing the hydrostatic pressure shows fluctuation due the wave refection and breaking as observed in fig 7 3 2 3 wave loads on the flap to optimize the structure design of owsc it is also of significant importance to accurately predict the wave loads on its main operating device i e the flap in this study fig 9 shows the time histories of the pressure signals recorded on selected sensors given in table 1 and their comparison with the experimental and numerical data wei et al 2015 note that the selected sensors are distributed at the top ps 03 and ps 11 middle ps 01 and ps 09 and bottom ps 05 and ps 13 of the flap following wei et al 2015 the initial hydrostatic pressure is subtracted from the recorded pressure signals inducing a negative drops in some profiles compared with the experimental and numerical data the main plateaus of all the pressure profiles are reasonably well captured by the present solver even if slight discrepancies are noted for sensors ps 01 ps 03 and ps 11 large pressure peaks and drops are noted since the present sph model is based on weakly compressible assumption and air cushion effects are not captured in single fluid simulation similar to the results reported in ref wei et al 2015 the pressure drops for sensors ps 05 and ps 13 are underestimated in present results and these discrepancies are related to the wave breaking which results a higher crest elevation compared with experiment as shown in fig 6 also note that these discrepancies are also likely to be associated with the stochastic nature of the impact pressures and the lack of exact repeatability of the experiments compared with the numerical results obtained with ansys fluent reported in ref wei et al 2015 the present pressure peaks show large magnitudes and fluctuations due to its lagrangian nature and weakly compressible assumption it is worth noting that these large peak magnitudes are not observed in the results obtained by ucd sph code dias et al 2017 henry et al 2013 rafiee et al 2013 and this may due to the fact that ucd sph applied hllc harten lax and van leer contact riemann solver for riemann based wcsph rafiee et al 2012 which induces excessive dissipation zhang et al 2017b also it is interesting to conduct sph simulation with consideration of air cushion to investigate its effects on pressure peak and it will be the main objective of our future work 3 3 computational efficiency to rigorously assess the computational performance we analyze the total cpu time of the present simulation and those or approximated ones reported in literature with different computational models including commercial software package ansys fluent wei et al 2015 in house ucd sph code rafiee et al 2013 dias et al 2017 dualsphysics crespo et al 2015 brito et al 2020 and gpusph wei et al 2019 for comparison the total cpu time is normalized by total physical time and total cell or particles numbers the ucd sph code was developed by rafiee et al 2013 dias et al 2017 and parallelized based on openmp as for dualsphysics which is implemented with gpu acceleration the total cpu time can be approximated by considering the corresponding speedup reported in ref crespo et al 2015 for comparison the total cpu time normalized by total physical time and total number of cells or particles is defined as cpu time t t n n cpu s where t represents the computing time in the unit of hour t the physical time for simulation in the unit of second n the total particle or element number in the unit of million n cpu the number of cores and s the speedup for gpu acceleration reported in literature in present work the computations are carried out on an intel xeon cpu e5 2620 v3 2 40 ghz desktop computer with 64 gb ram and scientific linux system 7 8 the ansys fluent and ucd sph code are performed on the stokes cluster of the irish centre for high end computing ichec and the stokes is an sgi altix ice 8200ex cluster with 320 compute nodes each node has two intel westmere xeon e5650 hexa core processors and 24 gb of ram and the nodes are interconnected via two planes of connectx infiniband ddr table 3 reports the computation time and the normalized cpu time with the corresponding physical time cell or particle number and system information for different models although the cpu versions are different there is no doubt that the present solver shows impressive computational performance for three dimensional large scale simulations also this performance can be further improved by implementing gpu acceleration which is our ongoing work and will be released soon note that as an open source library the code and data sets accompanying this validation is available on the repository of sphinxsys in github and https www sphinxsys org zhang et al 2021b 3 4 power take off effects and its energy capture factor the simbody provides a linear damper which acts along or around any mobility coordinate to apply a generalized force there which can be applied to imitate the mechanical damping of the pto operations in present owsc model this process can be defined by eq 13 where a damping force proportional to angular velocity is introduced note that the damping coefficient k d represents the extent of kinematic constraint on the flap having the pto the efficiency of wave energy harvesting of owsc can be quantitatively described by the capture factor cf which represents the ratio of the power extracted by owsc to the incident wave power defined as 20 c f p w e 0 where p w denotes the time averaged power extracted by pto system and e 0 the time averaged energy flux of incident wave following the work of senol and raessi 2019 the extracted power p w can be computed as 21 p w 1 2 ω 2 k d θ 2 where ω is the angular frequency of the incident wave k d the damping coefficient and θ the rotation amplitude in the pitch component of the flap also the mean energy flux e 0 is calculated as 22 e 0 ρ 0 g ω h 2 16 k 1 2 k h 0 sinh 2 k h 0 b where b represents the width of the flap fig 10 shows the time histories of the flap rotation by applying the linear damper with different damping coefficients based on the validated model i e wave height h 5 0 m and wave period t 10 0 s as expected the rotation amplitude is further reduced as the damping coefficient increase it is worth noting that the reduction of the flap rotation does not fit a linear relationship e g the rotation reduction ratio from k d 0 to k d 20 is not equal to that from k d 20 to k d 40 indicating that the pto operation may represents a nonlinear process fig 11 shows the time histories of the pressure recorded by the pressure sensors given in table 1 for damping coefficients k d 20 k d 40 and k d 80 one notable phenomenon is that the pressure peaks are reduced or eliminated for pressure sensors ps 01 ps 03 and ps 11 due to the reduced rotation of the flap this may imply that the strength of the slamming event which leads to the pressure peak wei et al 2015 is significantly reduced or even eliminated when damping operation is conducted also the pressure drops for sensors ps 05 ps 09 and ps 13 show better agreement with experimental data compared with the results where no damping is imposed this indicates that wave reflection and breaking are also reduced during damping operations fig 12 gives the variation of the cf in terms of damping coefficients k d it can be observed that the cf is enhanced as the damping coefficient increase and reaches the maximum about 0 4 when k d 40 and then shrinks as the damping coefficient further increases implying that its optimized value of the cf may be achieved for moderate damping coefficient note that the present investigation of the cf is conducted with a linear pto system under regular wave condition and further rigorous investigation should consider a nonlinear pto system under irregular wave condition which is out of the main scope of the present paper and will be conducted in the future work 3 5 extreme loads prediction of extreme loads on the device of wecs is of significant importance for the structure design however experimental study of the extreme loads is challenging due to its time and economic expensive nature for long time performance of wave tank test in this work we apply the present solver to estimate extreme loads on owsc by considering extreme wave condition based on focused wave approach note that the extreme wave herein represents the focused wave in a group of localized waves and the extreme loads reports the wave loading due to the wave focusing the intent of this study is to exploit the applicability of the focused wave approach in estimating the corresponding induced extreme loads on the owsc device in general any wave elevation can be considered as the combination of a certain number of small amplitude waves therefore the surface elevation at any point in spatio temporal spaces can be written as 23 η x t i 0 n a i cos k i x ω i t ϕ i where a i is the wave amplitude k i the wave number ω the angular frequency and ϕ i the phase for i th wave component in the focused wave approach the phase of each wave component is defined as 24 ϕ i k i x f ω i t f where x f and t f denote the focal position and time respectively the amplitude of each wave component takes the form of 25 a i a f s ω i δ ω i s ω i δ ω where a f is the target amplitude of the focused wave and s ω i the spectral density in this work we apply the pierson moskowitz spectra rafiee and fiévez 2015 for modeling the wave spectra and it is given by 26 s ω i 5 16 h s 2 ω p 4 ω i 5 exp 5 4 ω i ω p 4 where h s 6 0 m and ω p 2 π are the significant wave height and peak spectra wave angular frequency respectively for piston type wave maker the time history of the stroke is given by ning et al 2009 27 s 0 t i 0 n a i t r i sin k i x ω i t ϕ i here the transfer function t r represents the relationship between the wave height and is given as gao et al 2016 28 t r i 2 cosh 2 k i h 0 1 sinh 2 k i h 0 2 k i h 0 fig 13 shows the time history of the wave elevation at the focused location x f 7 6 m and the corresponding flap rotation as shown in fig 13a a sharp wave crest is found at the focused time t f 50 s and the amplitude of the surface elevation decreases as the energy content of the wave decrease also wave breaking is noted due to the interaction with the flap fig 13b gives the time history of the flap rotation under the interaction with the focused wave as expected the sharp wave crest induces a large amplitude rotation of the flap and the amplitude decreases as the wave crest past by fig 14 shows the time histories of the pressure signals recorded on selected sensors given in table 1 in extreme wave condition for pressure sensors ps 01 ps 03 and ps 11 which are located close to the surface a very large pressure peak is observed when the wave crest is impacting on the flap indicating that a freak wave may induce extreme loads on the flap 4 concluding remarks an efficient robust and accurate numerical solver is proposed by coupling open source multi physics sph based library sphinxsys with multi body physics library simbody for modeling wave interaction with an bottom hinged owsc the proposed numerical solver is validated by comparing the predicted wave elevation flap rotation and wave loading on the flap with experimental data and those obtained in literature with different numerical models the comparisons show that the present solver properly predicts the hydrodynamics properties of owsc more importantly optimized computational performance is achieved in the present solver then the validated solver is applied to study the pto effects and efficiency and investigate the extreme loads on the flap under extreme wave conditions these numerical results demonstrate its promising potential to future practical applications in the design of high performance wecs in future work gpu implementation will be conducted to further improve the computational efficiency and the slamming effects wei et al 2016 dias and ghidaglia 2018 on owsc will also be studied also investigation of harvesting energy efficiency with nonlinear pto system under irregular wave condition will be conducted credit authorship contribution statement chi zhang investigation methodology visualization validation formal analysis writing original draft writing review editing yanji wei investigation writing review editing frederic dias investigation writing review editing xiangyu hu investigation supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments c zhang and x y hu would like to express their gratitude to deutsche forschungsgemeinschaft dfg germany for their sponsorship of this research under grant numbers dfg hu1527 10 1 and hu1527 12 1 the work of f dias has been funded by science foundation ireland sfi under marine renewable energy ireland marei the sfi center for marine renewable energy ireland grant 12 rc 2302 
20427,deep water spectral wave steepness offshore mainland portugal diogo mendes conceptualization methodology software formal analysis writing original draft a c tiago c a oliveira methodology software formal analysis writing review editing b a geosciences department centre of environmental and marine studies cesam university of aveiro portugal geosciences department centre of environmental and marine studies cesam university of aveiro portugal geosciences department centre of environmental and marine studies cesam university of aveiro portugal b physics department centre of environmental and marine studies cesam university of aveiro portugal physics department centre of environmental and marine studies cesam university of aveiro portugal physics department centre of environmental and marine studies cesam university of aveiro portugal c now at haedes casais do arrocho 2025 452 azóia de cima santarém portugal now at haedes casais do arrocho 2025 452 azóia de cima santarém portugal now at haedes casais do arrocho 2025 452 azóia de cima santarém portugal corresponding author departamento de geociências universidade de aveiro campus universitário de santiago 3810 193 aveiro portugal departamento de geociências universidade de aveiro campus universitário de santiago aveiro 3810 193 portugal deep water spectral wave steepness s m is used in several ocean engineering activities to characterise sea states however difficulties in maintaining wave buoys offshore the continental shelf results in a lack of deep water s m variability studies based on long term field observations in high energetic environments in this work we analysed s m variability between 1200 and 1900 m water depth offshore mainland portugal north atlantic ocean based on field measurements recorded between 2009 and 2020 at three different locations results show similar s m variability at the three sites with mean minimum and maximum values of 0 031 0 004 and 0 072 respectively a decrease in the monthly average s m to 0 027 is observed for all locations during september and october values of s m displayed a decreasing tendency with a rotation of the mean wave direction towards the north under storm conditions s m ranged between 0 020 and 0 060 and no correlation was found between s m and other wave parameters such as significant wave height mean wave period or mean wave direction for the most severe storms values of s m were in general larger than 0 030 which points out that storm waves display larger s m keywords wind waves storms emodnet north atlantic ocean wave buoys nazaré 1 introduction wave steepness defined as the ratio between the wave height h and wavelength l for a monochromatic wave constitutes an essential parameter for the design of offshore and coastal structures moreover guedes soares et al 2001 found that areas with many ship accidents in the north atlantic were associated with high mean wave steepness values toffoli et al 2005 analysed a global ship accident database between january 1995 to april 1999 together with sea state related parameters these authors found that more than 50 of the incidents occurred for wave steepness values larger than 0 035 the relevance of wave steepness for ocean engineering has prompted some studies in the literature to investigate wave steepness based on theoretical statistical distributions adjusted to measured data myrhaug and kjeldsen 1984 to address the statistical properties of wave steepness myrhaug 2018 or to understand wave steepness patterns during storm conditions myrhaug and kjeldsen 1986 stansell et al 2003 guedes soares et al 2004 though the practical relevance of wave steepness is extensive more studies are needed to fully understand its characteristics therefore this study uses data collected by wave buoys deployed in deep waters along mainland portugal to improve the current knowledge the behaviour of several physical processes depends on wave steepness in deep waters wave breaking is related to wave steepness perlin et al 2013 here wind wave energy losses occur due to excessive wave steepness a process commonly known as whitecapping holthuijsen 2007 in shallow waters the depth at which wind waves start to lose energy by depth induced breaking is a function of offshore wave steepness relative depth and bottom slope goda 2010 the hydraulic behaviour of offshore and coastal structures also depends on the wave steepness e g van der meer 1999 consequently several formulations for offshore and coastal structures design depend directly on the offshore wave steepness or indirectly through the surf similarity parameter also known as the iribarren number for beach morphology studies dean 1973 proposed an equation that relates offshore wave steepness and the dimensionless fall velocity to discriminate between a storm and a normal beach profile kraus and larson 1988 confirmed that offshore wave steepness is an essential descriptor of whether beach erosion or accretion is expected moreover rocha et al 2017 noted that wave velocity nonlinearities parameterisations between the shoaling and surf zones are best predicted when offshore wave steepness and offshore spectral bandwidth are taken into account rather than using local wave parameters only such as the wave height wave period and water depth good knowledge of offshore wind waves and their steepness is also crucial for seismic noise and underwater acoustic studies wind waves are a source of primary and secondary microseismic noise in the ocean ardhuin et al 2012 for instance custódio et al 2014 showed that the amplitude of microseismic noise in mainland portugal is related to wind waves height and period offshore of portugal simultaneously sea surface roughness terminology commonly used by the underwater acoustic community to refer to the state of the sea surface related to wind waves influences underwater sound propagation causing sound scattering kuo 1988 sound scattering at the ocean sea surface depends on sound properties e g frequency and grazing angle tends to be higher under higher wind wave heights kuo 1988 and is influenced by wave steepness fortuin 1970 rodríguez et al 2010 additionally bubbles induced by wave breaking is another mechanism of sound scattering e g dahl 2003 ocean surface scattering caused by wind waves can then influence several ocean engineering activities based on underwater acoustic communications siderius and porter 2008 collectively the studies mentioned above overview some of the physical processes of interest for the ocean engineering community where wave steepness plays an important role this fact asks for a fair characterisation of this wave parameter on various time scales particularly for high energy waves in deep waters however due to the difficulties of installing and maintaining wave buoys in deep waters there is a lack of wave steepness variability studies based on long term field observation in high energy environments this lack of studies is also valid for portugal s mainland although several studies focused on understanding the wave climate along the portuguese continental coast e g sebastião et al 2000 costa et al 2001 rusu et al 2008 laface et al 2015 oliveira et al 2020 2018 they are either based on numerical wave hindcast modelling or wave buoy data recorded at around 100 m water depth and do not focus on wave steepness variability thus contrary to the wave climate characterisation along mainland portugal wave steepness characterisation has met little attention in the available literature despite its thoughtful importance to the ocean and coastal fields this work analyses deep water wave steepness variability between 1200 and 1900 m water depth offshore mainland portugal based on field measurements recorded between 2009 and 2020 at three different locations this data is freely available based on the european union effort of providing access to the observations made by individual organisations in all member states mainly through the european marine observation and data network emodnet www emodnet eu the present study constitutes the first long term analysis of data registered by deep water wave buoys in mainland portugal to the authors best knowledge and its objectives are two fold first it aims to investigate the seasonal deep water spectral wave steepness variability offshore mainland portugal second it seeks to understand wave steepness variability under storm conditions after this introductory section the study area and the methodology used are described in section 2 section 3 presents the results obtained in this study regarding the characterisation of wave steepness on a seasonal and storm time scale a discussion of the results obtained in this study is provided in section 4 section 5 summarises the main findings 2 study area and methodology 2 1 brief description of climate and wave characteristics in mainland portugal mainland portugal is located in the eastern north atlantic ocean and the width of its continental shelf ranges between 3 and 60 km the wider regions of the continental shelf coincide with approximately 60 km north and 50 km south of nazaré canyon which narrows the continental shelf locally to about 3 km see fig 1 thus while the continental shelf width ranges mostly between 30 and 60 km on the northwestern coast it ranges from 28 km close to cape são vincente down to 8 km on the south coast wind waves on the west coast of mainland portugal have their origins mainly in the north atlantic ocean three main wave systems reach the west coast im 2004 the first is characterised by northwest swell generated in the north atlantic ocean and superposes sea conditions caused by north northwest local winds these conditions are the most common 80 of the year following im 2004 the second is characterised by swell generated in the north atlantic ocean that arrive from southwest and may interfere with swell from northwest these wave conditions can last for about one day during the arrival of a cold front or they can take several days when a low pressure system is located southwest of mainland portugal the third is characterised by very energetic wave systems from west and typically occur once per year and can persist for eight days im 2004 the south coast of mainland portugal is exposed to swell and sea and presents three typical conditions im 2004 first swell arriving from southwest which can induce the most severe coastal storms oliveira et al 2018 these conditions are similar to those that occur on the west coast second swell arriving from southeast generated between the strait of gibraltar and the gulf of cadiz known as levante storms third sea wave conditions that are locally generated due to daily temperature differences at the sea land interface occurring about 70 of the time following costa et al 2001 wave characteristics at around 100 m depth can be briefly described by a monthly averaged significant wave height of 2 8 m 1 2 m during northern hemisphere winter summer for the northwestern coast these values are milder along the southern coast and range from 1 5 m in winter to 0 6 m in summer the monthly averaged values of peak wave periods are between 9 and 13 s 6 10 s along the northwestern southern sectors the most frequent incident wave direction is from northwest along the northwestern coastline and it varies along the south coast between w and se directions 2 2 observations time records of wave parameters from three wave buoys located along mainland portugal fig 1 were used in this study these records were collected by multi parametric seawatch wavescan buoys developed by fugro oceanor the portuguese hydrographic institute ih www hidrografico pt secures the deployment and maintenance of the wave buoys wave parameters are calculated using the spectral method a 25 min long record of sea surface elevation with a sampling frequency of 1 hz is processed internally by the wave buoy this procedure is repeated every hour and wave parameters are subsequently sent to the ih office where data is checked and stored each hourly set of wave parameters is here used to define a sea state the location of each buoy is as follows see table 1 buoy 6200191 hereafter leixões is located offshore of leixões harbour buoy 6200192 hereafter nazaré is located offshore of nazaré this site is world famous by surfers due to the nazaré large waves that occur mainly in winter davidson 2013 both leixões and nazaré buoys are located offshore the west coast of mainland portugal buoy 6200200 hereafter faro is located offshore of faro on the south coast of mainland portugal at the three sites time records characterise offshore wave conditions in deep waters i e h l 0 5 where l is the wavelength and h the water depth as an example the condition h l 0 5 is met even for a wave period of 25 s l 975 m using linear wave theory because the wave buoys are moored at h 1000 m table 1 available to us through the emodnet platform are hourly time records of wave parameters namely the significant wave height h m0 the mean wave period t m02 and the mean wave direction mdir only records with quality control settings i e qc flag with values equal to 1 optimal value were used the available time records display some missing data possibly due to the very rough wave conditions during major storms ship collisions or buoy maintenance periods see fig 2 table 2 shows the overall percentage of unregistered data for each buoy here 0 corresponds to hourly data fully available the average percentage of unregistered data was 34 43 and 28 for leixões nazaré and faro buoys respectively these values contrast with the values lower than 20 obtained for coastal wave buoys oliveira et al 2018 highlighting the challenges associated with maintaining a deep water wave buoy network the number of observations and data coverage is also shown in table 3 as a function of each month 2 3 data analysis 2 3 1 wave steepness definition the iahr working group the iahr working group on wave generation and analysis 1989 provided a list of sea state parameters where the wave steepness is obtained by zero crossing analysis s z since wave parameters available to us were obtained using the spectral method we adopted the spectral wave steepness s m 1 s m 2 π h m 0 g t m 02 2 where the subscript m indicates wave parameters obtained with the spectral method several authors have used s m for ocean engineering related studies e g bitner gregersen and guedes soares 2007 myrhaug 2018 2 3 2 wave storm definition a storm definition metric is necessary to investigate wave steepness variability under storm events in this work we defined a wave storm following ih see oliveira et al 2018 except for faro where we used a higher wave height threshold ih classifies a storm event whenever h m0 is larger than 4 5 m on the west coast leixões and nazaré and 2 5 m on the south coast faro these values are approximately two times the annual average h m0 except for faro see section 3 2 1 at faro we set the threshold to h m0 3 0 m the minimum storm duration is considered to be 6 h the independence storm criterion corresponding to the minimum time between two consecutive and independent storms is deemed to be 12 h the definition of a wave storm event still constitutes a topic of ongoing research martzikos et al 2021 a recent overview by harley 2017 suggested that while some authors argue that a storm definition metric must be obtained based on a statistically sound methodology others pragmatically used 95 exceedance values obtained from long wave records we noted that other studies focus on offshore mainland portugal also used other metrics such as the average value of h m0 plus two times the standard deviation of h m0 almeida et al 2011 or the average value of h m0 multiplied by a constant that can range from 1 5 to 3 laface et al 2015 according to the storm definition used in this study a time series of wave storm conditions is depicted in fig 3 2 4 wave storm classification the classification of storm events in this study was based on mendoza et al 2011 these authors used the storm energy content of each event i e i 2 e i t 1 t 2 h m 0 2 d t h m 0 h t r e s h o l d where t 1 is the initial time of the storm t 2 is the final time of the storm and h treshold differs between buoys this classification is adapted from the method proposed by dolan and davis 1992 however mendoza et al 2011 used the time variation of h m0 between t 1 and t 2 instead of the maximum value of h m0 indeed using a single wave height value can bias the total storm energy estimation mendoza et al 2011 marzeddu et al 2020 storms events were categorised at each buoy from less 0 to more energetic 5 using a simple classification index ci for each storm event i 3 c i i 5 e i max e where max e represents the largest energy content of a storm at a specific buoy note that other methods to categorise storms are available in the literature for example mendoza et al 2011 used a cluster analysis through the average linking method since the focus of the present study is not on storm classification and categorisation to obtain a storm intensity scale the simple normalisation equation 3 was considered adequate for the present purposes 3 results 3 1 seasonal time scale the monthly basis seasonal variation of the wave parameters for each location is depicted in fig 4 table 4 includes the mean standard deviation minimum and maximum values of each wave parameter for each wave buoy the mean value and the standard deviation of each wave parameter for each buoy but on a monthly basis can be found in appendix a in general the monthly average values of h m0 and t m02 increase decrease during winter summer the increase of h m0 is associated with the wind field magnitude intensification during winter in the north atlantic ocean basin see fig 2 of young et al 2020 besides the increase of t m02 during winter months is associated with long period waves that travel from west to east in the north atlantic ocean basin young 1999 the values of t m02 at faro are lower than those at leixões or nazaré since the faro wave buoy is located on the south coast fig 1 it is less exposed to long period waves in general differences of h m0 and t m02 between leixões and nazaré are small fig 4 the monthly average values of mdir are rotated towards west and southwest for faro compared to leixões and nazaré moreover the standard deviation of mdir is more significant for faro fig 4 this behaviour is consistent with the shelter provided by cape são vicente fig 1 and also because some wave systems measured at faro known as levante storms have their origin between the strait of gibraltar and the gulf of cadiz oliveira et al 2018 differences in mdir are also not appreciable between leixões and nazaré the results suggest a subtle rotation towards north during the summer months at both buoys from june to september in fig 4 this is associated with the typical summer weather pattern where the azores anticyclone is shifted towards north and north south winds prevail across the portuguese western coast a good description of this weather pattern can be found in semedo 2005 the average value of s m oscillates around 0 031 and is very similar for all the analysed locations fig 4 a decrease of s m to 0 027 occurs during september and october months at all buoy locations this suggests modifications on h m0 and t m02 looking at fig 4 both h m0 and t m02 increase in september and october compared to the summer months june july and august however the rise of t m02 is more pronounced than those of h m0 this relative growth of h m0 and t m02 explains why s m shows a decrease to 0 027 during september and october the increase of t m02 could be in part associated with wind waves generated by some remnants of tropical storms oliveira et al 2020 found these systems are more common during october and related to long travelling wave systems characterised by high wave periods and mild wave height conditions this supports our suggestion for the decrease of s m due to the increase of t m02 during september and october regarding faro a sudden increase of s m 25 occurs between february and march this increase is associated with a significant drop of t m02 when compared to h m0 fig 4 we attribute this variation of s m to levante wave events that become more pronounced during this transition period oliveira et al 2018 noted a sudden increase in the number of levante storms during march these events present a smaller t m02 than those occurring from the north atlantic ocean due to the reduced fetch length to look in more detail to the seasonal variation of s m the frequency distribution fig 5 a b and c and the empirical cumulative distribution function ecdf fig 5d were calculated for each location small but significant differences can be detected at each location as follows while lower s m values are associated with faro s m 0 020 higher s m values are associated with leixões s m 0 045 these results suggest that high steepness sea states are more likely to occur in leixões than in faro overall the three sites frequency distributions present a maximum for s m between 0 020 and 0 030 and a relative maximum for s m around 0 040 the percentage of occurrence of the monthly variation of s m clustered in ecdf classes for each location is shown in fig 6 for each location time records were clustered in different values of ecdf which is associated with values of s m for example wave conditions with ecdf 0 10 are typically associated with s m smaller than approximately 0 015 fig 5d then the percentage of occurrence was calculated for each month therefore the value of 20 for faro buoy that occur in february associated with ecdf 0 10 fig 6a means that 20 of the wave records with an s m value associated to ecdf 0 10 occurred in february regarding leixões approximately 25 of sea states with s m smaller than about 0 015 occurred in september and october approximately 40 of sea states with s m larger than approximately 0 045 took place between march and july values of s m between 0 015 and 0 045 show a consistent pattern across the year but are less likely to occur in september and october in general the seasonal variability of s m at nazaré is very similar to that at leixões fig 6 regarding faro about 50 of sea states with s m smaller than 0 015 occurred in december january and february fig 6a the higher steepness sea states s m 0 045 account for 20 in march at the faro location fig 6c the frequency of s m as a function of h m0 and mdir are displayed in fig 7 the results suggest that while for 1 5 m h m0 4 m values of s m range between 0 010 and 0 055 for h m0 4 m s m become more confined to 0 040 these results are observed both in leixões and in nazaré buoy in contrast s m values scatter between 0 010 and 0 055 for 0 5 m h m0 2 5 m at faro buoy regarding the mdir the results clearly show an increase of s m for mdir 320 n both in leixões and nazaré therefore high steepness sea states are more likely to occur when the wave direction predominantly rotates towards the north in the northwestern portuguese coast typically during the north hemisphere summer months figs 4 and 6 at faro there is no visible relationship between s m and mdir for the sea states with mdir 180 n the sea states with mdir 180 n tend to increase with larger values of mdir at faro buoy similar to the other buoys along the western coast 3 2 storm time scale 3 2 1 storm events characterisation and classification regarding the storm time scale and its definition table 5 shows a comparison between the wave height threshold h treshold used in this study against three other commonly employed metrics to define the wave height threshold namely the 95th percentile of the empirical cumulative distribution function of registered h m0 95th percentile of h m0 the average denoted by plus two times the standard deviation denoted by σ of the registered h m0 i e h m0 2σ hm0 and the average h m0 multiplied by a factor of 2 i e 2 h m0 although some differences can be noticed among locations the maximum relative difference is 7 at leixões these results show that besides the differences that can arise from different criteria used to define the storm event threshold the h treshold value used in this study is close to other commonly used metrics based on the storm definition presented above the following storm events have been registered by the wave buoys at leixões nazaré and faro the number of registered storms was 116 103 and 38 these registered storms correspond to a total of 2858 2547 and 1221 sea states respectively the smaller number of storm events at faro is due to the shorter time record when compared to those at leixões and nazaré the average number of storm events per year at leixões nazaré and faro was 10 5 8 6 and 7 6 respectively even though data coverage is different across years tables 2 and 3 note that the latter values may differ if a different storm event definition threshold and duration is used the storm events share similar characteristics at leixões and nazaré table 6 the average of the maximum h m0 per storm was 6 49 1 35 m 6 50 1 30 m at leixões nazaré in this regard storm events at faro were milder with 4 52 1 03 m the maximum value of h m0 considering all storm events was registered in nazaré on the 19th january of 2013 storm gong at 11 00 utc 00 00 which was 12 72 m see fig 3 the latter value is higher than the maximum value of h s registered at coastal wave buoys of 9 20 m at 90 m water depth between 1987 and 2015 oliveira et al 2018 the average maximum of s m during storm waves was between 0 046 and 0 050 for the three buoy locations with a maximum standard deviation of 0 011 table 6 this indicates that s m values were larger during storms than on the seasonal scale fig 4 each storm event s duration was on average approximately 24 h in leixões and nazaré and about 33 h in faro table 6 the standard deviation value associated with the storm duration is roughly equal to the mean value at faro this indicates that storm events at faro are considerably different from those at leixões or nazaré at deep water wave buoys at coastal buoys similar results were also obtained oliveira et al 2018 in the following we analysed the storm events associated with the three largest ci values for each wave buoy location table 7 shows a synthesis of these events classified using equation 3 first storm events can have a different impact along mainland portugal for example the largest storm event at faro ci 5 occurred between 28th february and 6th march 2018 storm emma during that period the three buoys were collecting data and a ci 0 4 storm was classified at leixões however only a ci 0 04 storm was detected at nazaré the second largest storm event at leixões between 2nd and 5th february 2017 was classified as ci 3 3 at nazaré storm events have a variable relative impact across mainland portugal although nazaré and leixões buoys location shared similar characteristics there are some storm events that do not follow these main patterns the third largest storm event that occurred at faro between 9th and 12th march 2018 storm felix was classified at ci 3 7 at nazaré but only as ci 1 at leixões 3 2 2 wave steepness associated with storm events fig 8 shows the time series of the wave parameters during the storm with higher ci at each location the horizontal axis is centred at t 0 corresponding to the maximum value of h m0 which is considered the storm peak thick lines represent the storm event following the storm definition presented in section 2 2 2 the thin lines represent plus and minus 72 h before the beginning and after the storm in general the increase of h m0 towards the storm peak is accompanied by the rise of t m02 under these three storms s m varied between about 0 030 and 0 060 a relation between the value of s m and the storm peak was not observed unlike h m0 where there are an apparent increase and decrease phase around the storm peak a clear pattern cannot be observed for s m nevertheless it should be noted that for the three storms maximum s m higher than 0 050 were observed just before the storm peak fig 9 depicts the scatter plot between mdir and s m for each location as a function of ci no relationship was found between the ci s m and mdir however the storm events with more energy ci 1 are associated with a value of s m between 0 020 and 0 060 fig 9 these values are typically above the mean values of s m across the year fig 4 this suggests a link between higher steepness waves during storm events 4 discussion our results suggest that a value of s m 0 031 is representative of the year averaged s m offshore mainland portugal fig 4 this value is independent of the geographic position of the deep water wave buoy fig 1 the regional spatial behaviour displayed by s m in our results is similar to what myrhaug 2018 found for the norwegian continental shelf this author based on h s and t p given by a joint probability distribution function for three locations mathisen and bitner gregersen 1990 applied a spectrum wave steepness statistical distribution the values of s m varied between 0 0450 and 0 0464 see table 2 of myrhaug 2018 which indicates a very small regional spatial variability of s m despite the small spatial variability of s m our values of s m 0 031 are smaller than those of myrhaug 2018 s m 0 045 the smaller values of s m observed for offshore mainland portugal than for the norwegian continental shelf seems to be consistent with the global distribution of wave steepness derived from envisat data in 2011 presented by badulin et al 2018 myrhaug 2018 has shown that the expected value of s m increases with the peak enhancement factor γ associated with a jonswap spectrum the expected value of s m is equal to 0 031 0 046 for γ 1 5 myrhaug 2018 therefore we attribute our smaller values of s m 0 031 to wave systems swells generated far from our wave buoys moreover our results are close to the expected value of s m 0 035 for a phillips spectrum myrhaug 2018 despite the representativeness of s m 0 031 for mainland portugal some seasonal changes can occur such as the decrease of s m to 0 027 in september and october months and the increase of s m to 0 034 at faro buoy in march fig 4 we speculate these changes are associated with changes in the atmospheric circulation patterns in the north atlantic e g lucas et al 2021 more specifically these changes could be in part related with wind waves generated by remnants of post tropical storms in september and october oliveira et al 2020 and with levante storms in march for faro buoy oliveira et al 2018 looking at fig 4 an increase of t m02 for the september and october months is clearly observed when compared to august also this increase in t m02 is more pronounced than the increase of h m0 for the same months again this supports our above speculation that this seasonal change in s m is associated with the typical hurricane season on the east coast of us we believe differences in the seasonal trends of s m have not been detected before because the vast majority of the studies were conducted for storm conditions myrhaug and kjeldsen 1986 stansell et al 2003 guedes soares et al 2004 moreover myrhaug 2018 used the joint pdf provided in mathisen and bitner gregersen 1990 and consequently this author was enabled to show the seasonal s m variability during storm conditions the values of s m ranged between 0 020 and 0 060 with the largest storms associated with values of s m 0 030 fig 9 and table 6 these values compare with those presented by myrhaug and kjeldsen 1986 for the norwegian continental shelf 0 050 s m 0 130 see their fig 3 and with those presented by stansell et al 2003 in the north sea 0 045 s m 0 070 differences between our results and myrhaug and kjeldsen 1986 results can be attributed in part to the different definition used to characterise storms their characterisation also included an individual wave with a wave steepness larger than 0 100 over each sea state besides the wave height threshold of 5 m unfortunately the complete time series of sea surface elevation required to characterise individual wave steepness was not available to us regarding the results presented by stansell 2004 their values of s m were larger than ours similar to the discussion presented above on the average value of s m we attribute our smaller values to swell generated in the north atlantic more specifically many wave storms that cross southwestern europe are generated along the labrador sea these wave storms are likely to have larger wave periods than those generated in the north sea the differences in s m variability between our study and stansell 2004 further highlight the need to characterise s m in other regions across the globe such as the north pacific where large wave periods can be expected young 1999 moreover it should be mentioned that unfortunately all the wave buoys analysed in this study were not in operation during winter 2013 14 which was one of the most severe in europe in the last decades masselink et al 2016 our results point to a deeper investigation of the consequences of s m variations during storms and some months across the year fig 4 we showed that s m values are generally larger during storms than average s m 0 031 and that s m values decreased to 0 027 in september and october months and increased to 0 034 in march on the southern coast faro buoy in particular it might be of interest to understand the consequences of these changes for the design of marine structures shipping and beach morphodynamics the analyses performed in this work did not distinguish between single or double peaked spectra because the wave spectra obtained from the deep water wave buoys were not available to us however wave steepness values cannot always be considered as pure one wave system values guedes soares and nolasco 1992 used field observations of 2423 wave spectra from figueira da foz about 80 km north of nazaré coastal buoy at a water depth of 100 m to characterise the occurrence of double peaked spectra they found double peaked spectra to occur between 23 and 26 guedes soares 1991 found that double peaked spectra in the north atlantic ocean are 22 therefore future work should consider recording and analysing wave spectra and investigating the influence of double peaked spectra on s m offshore mainland portugal 5 conclusions this paper aimed firstly to investigate the seasonal s m variability offshore mainland portugal and secondly to understand s m variability under storm conditions data recorded between 2009 and 2020 at three different wave boys located between 1200 and 1900 m water depths offshore mainland portugal were analysed on a seasonal time scale the average value of s m was equal to 0 031 and independent of the location west or south coast seasonal fluctuations of s m occurred between september and october months at the three sites dropping to 0 027 in march at faro a growth of s m to 0 034 was observed on a storm time scale values of s m were highly variable between 0 020 and 0 060 no relation was found between s m mdir and a storm classification index for the analysed storm events in general the most severe storm events were associated with values of s m larger than the yearly averaged s m 0 031 during the storm with higher ci at each of the three sites a maximum s m higher than 0 055 was observed before the storm peak our results highlight the need to characterise s m seasonal variability in other regions of the ocean this type of studies would be of interest due to the importance of s m for the design of marine structures shipping and beach morphodynamics credit authorship contribution statement diogo mendes conceptualization methodology software formal analysis writing original draft tiago c a oliveira methodology software formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors acknowledge ih colleagues for their great effort and dedication to keeping the deep water buoy network along mainland portugal working the second author thanks fct mctes for the financial support to cesam uidp 50017 2020 uidb 50017 2020 through national funds the authors thank two anonymous reviewers for providing us with comments and suggestions that have resulted in an improved paper appendix a mean and standard deviation values of significant wave height h m0 mean wave period t m02 mean wave direction mdir and spectral wave steepness s m on a monthly basis for each wave buoy table a1 mean standard deviation of wave parameters for each month on leixões wave buoy table a1 leixões h m0 m t m02 s mdir s m jan 3 02 1 35 7 7 1 7 287 61 0 033 0 011 feb 3 45 1 49 8 5 1 7 303 25 0 031 0 011 mar 3 05 1 19 7 8 1 4 302 37 0 033 0 012 apr 2 52 1 13 7 2 1 5 301 40 0 032 0 012 may 2 07 0 79 6 4 1 2 307 35 0 033 0 012 jun 1 71 0 72 6 0 1 1 311 36 0 032 0 012 jul 1 62 0 65 5 7 1 0 320 23 0 033 0 013 aug 1 63 0 62 5 8 1 0 315 38 0 031 0 011 sep 1 88 0 76 6 8 1 4 308 34 0 028 0 012 oct 2 29 1 05 7 3 1 5 295 45 0 028 0 011 nov 3 07 1 34 7 6 1 6 301 49 0 034 0 011 dez 3 09 1 44 7 9 1 7 281 60 0 032 0 012 table a2 same as table a1 but for nazaré table a2 nazaré h m0 m t m02 s mdir s m jan 3 00 1 39 7 9 1 7 303 51 0 032 0 011 feb 3 02 1 35 7 9 1 7 308 46 0 032 0 012 mar 2 70 1 22 7 7 1 5 306 38 0 031 0 011 apr 2 41 1 14 7 0 1 4 302 48 0 032 0 011 may 1 85 0 68 6 3 1 1 306 34 0 031 0 010 jun 1 63 0 68 5 9 1 0 313 38 0 031 0 011 jul 1 71 0 65 5 8 0 9 326 33 0 034 0 010 aug 1 60 0 62 5 8 0 9 327 22 0 031 0 010 sep 1 90 0 73 6 9 1 3 316 26 0 027 0 011 oct 2 22 1 06 7 5 1 6 304 33 0 026 0 011 nov 2 99 1 32 7 6 1 6 311 37 0 033 0 011 dez 2 84 1 21 7 8 1 7 293 53 0 030 0 011 table a3 same as table a1 but for faro table a3 faro h m0 m t m02 s mdir s m jan 1 73 0 75 6 5 1 5 258 77 0 028 0 013 feb 1 97 0 79 7 2 1 8 254 79 0 027 0 013 mar 2 17 1 02 6 4 1 2 250 79 0 035 0 013 apr 1 92 0 84 6 4 1 3 259 64 0 031 0 011 may 1 46 0 57 5 5 0 9 243 84 0 031 0 010 jun 1 24 0 43 4 9 0 8 275 61 0 034 0 010 jul 1 16 0 41 4 9 0 6 259 74 0 032 0 009 aug 1 21 0 44 4 8 0 6 237 90 0 034 0 009 sep 1 18 0 47 5 3 1 1 261 82 0 028 0 010 oct 1 54 0 70 6 1 1 3 240 82 0 028 0 012 nov 1 71 0 76 6 2 1 6 260 75 0 030 0 011 dez 1 90 0 97 6 7 1 8 245 85 0 029 0 013 
20427,deep water spectral wave steepness offshore mainland portugal diogo mendes conceptualization methodology software formal analysis writing original draft a c tiago c a oliveira methodology software formal analysis writing review editing b a geosciences department centre of environmental and marine studies cesam university of aveiro portugal geosciences department centre of environmental and marine studies cesam university of aveiro portugal geosciences department centre of environmental and marine studies cesam university of aveiro portugal b physics department centre of environmental and marine studies cesam university of aveiro portugal physics department centre of environmental and marine studies cesam university of aveiro portugal physics department centre of environmental and marine studies cesam university of aveiro portugal c now at haedes casais do arrocho 2025 452 azóia de cima santarém portugal now at haedes casais do arrocho 2025 452 azóia de cima santarém portugal now at haedes casais do arrocho 2025 452 azóia de cima santarém portugal corresponding author departamento de geociências universidade de aveiro campus universitário de santiago 3810 193 aveiro portugal departamento de geociências universidade de aveiro campus universitário de santiago aveiro 3810 193 portugal deep water spectral wave steepness s m is used in several ocean engineering activities to characterise sea states however difficulties in maintaining wave buoys offshore the continental shelf results in a lack of deep water s m variability studies based on long term field observations in high energetic environments in this work we analysed s m variability between 1200 and 1900 m water depth offshore mainland portugal north atlantic ocean based on field measurements recorded between 2009 and 2020 at three different locations results show similar s m variability at the three sites with mean minimum and maximum values of 0 031 0 004 and 0 072 respectively a decrease in the monthly average s m to 0 027 is observed for all locations during september and october values of s m displayed a decreasing tendency with a rotation of the mean wave direction towards the north under storm conditions s m ranged between 0 020 and 0 060 and no correlation was found between s m and other wave parameters such as significant wave height mean wave period or mean wave direction for the most severe storms values of s m were in general larger than 0 030 which points out that storm waves display larger s m keywords wind waves storms emodnet north atlantic ocean wave buoys nazaré 1 introduction wave steepness defined as the ratio between the wave height h and wavelength l for a monochromatic wave constitutes an essential parameter for the design of offshore and coastal structures moreover guedes soares et al 2001 found that areas with many ship accidents in the north atlantic were associated with high mean wave steepness values toffoli et al 2005 analysed a global ship accident database between january 1995 to april 1999 together with sea state related parameters these authors found that more than 50 of the incidents occurred for wave steepness values larger than 0 035 the relevance of wave steepness for ocean engineering has prompted some studies in the literature to investigate wave steepness based on theoretical statistical distributions adjusted to measured data myrhaug and kjeldsen 1984 to address the statistical properties of wave steepness myrhaug 2018 or to understand wave steepness patterns during storm conditions myrhaug and kjeldsen 1986 stansell et al 2003 guedes soares et al 2004 though the practical relevance of wave steepness is extensive more studies are needed to fully understand its characteristics therefore this study uses data collected by wave buoys deployed in deep waters along mainland portugal to improve the current knowledge the behaviour of several physical processes depends on wave steepness in deep waters wave breaking is related to wave steepness perlin et al 2013 here wind wave energy losses occur due to excessive wave steepness a process commonly known as whitecapping holthuijsen 2007 in shallow waters the depth at which wind waves start to lose energy by depth induced breaking is a function of offshore wave steepness relative depth and bottom slope goda 2010 the hydraulic behaviour of offshore and coastal structures also depends on the wave steepness e g van der meer 1999 consequently several formulations for offshore and coastal structures design depend directly on the offshore wave steepness or indirectly through the surf similarity parameter also known as the iribarren number for beach morphology studies dean 1973 proposed an equation that relates offshore wave steepness and the dimensionless fall velocity to discriminate between a storm and a normal beach profile kraus and larson 1988 confirmed that offshore wave steepness is an essential descriptor of whether beach erosion or accretion is expected moreover rocha et al 2017 noted that wave velocity nonlinearities parameterisations between the shoaling and surf zones are best predicted when offshore wave steepness and offshore spectral bandwidth are taken into account rather than using local wave parameters only such as the wave height wave period and water depth good knowledge of offshore wind waves and their steepness is also crucial for seismic noise and underwater acoustic studies wind waves are a source of primary and secondary microseismic noise in the ocean ardhuin et al 2012 for instance custódio et al 2014 showed that the amplitude of microseismic noise in mainland portugal is related to wind waves height and period offshore of portugal simultaneously sea surface roughness terminology commonly used by the underwater acoustic community to refer to the state of the sea surface related to wind waves influences underwater sound propagation causing sound scattering kuo 1988 sound scattering at the ocean sea surface depends on sound properties e g frequency and grazing angle tends to be higher under higher wind wave heights kuo 1988 and is influenced by wave steepness fortuin 1970 rodríguez et al 2010 additionally bubbles induced by wave breaking is another mechanism of sound scattering e g dahl 2003 ocean surface scattering caused by wind waves can then influence several ocean engineering activities based on underwater acoustic communications siderius and porter 2008 collectively the studies mentioned above overview some of the physical processes of interest for the ocean engineering community where wave steepness plays an important role this fact asks for a fair characterisation of this wave parameter on various time scales particularly for high energy waves in deep waters however due to the difficulties of installing and maintaining wave buoys in deep waters there is a lack of wave steepness variability studies based on long term field observation in high energy environments this lack of studies is also valid for portugal s mainland although several studies focused on understanding the wave climate along the portuguese continental coast e g sebastião et al 2000 costa et al 2001 rusu et al 2008 laface et al 2015 oliveira et al 2020 2018 they are either based on numerical wave hindcast modelling or wave buoy data recorded at around 100 m water depth and do not focus on wave steepness variability thus contrary to the wave climate characterisation along mainland portugal wave steepness characterisation has met little attention in the available literature despite its thoughtful importance to the ocean and coastal fields this work analyses deep water wave steepness variability between 1200 and 1900 m water depth offshore mainland portugal based on field measurements recorded between 2009 and 2020 at three different locations this data is freely available based on the european union effort of providing access to the observations made by individual organisations in all member states mainly through the european marine observation and data network emodnet www emodnet eu the present study constitutes the first long term analysis of data registered by deep water wave buoys in mainland portugal to the authors best knowledge and its objectives are two fold first it aims to investigate the seasonal deep water spectral wave steepness variability offshore mainland portugal second it seeks to understand wave steepness variability under storm conditions after this introductory section the study area and the methodology used are described in section 2 section 3 presents the results obtained in this study regarding the characterisation of wave steepness on a seasonal and storm time scale a discussion of the results obtained in this study is provided in section 4 section 5 summarises the main findings 2 study area and methodology 2 1 brief description of climate and wave characteristics in mainland portugal mainland portugal is located in the eastern north atlantic ocean and the width of its continental shelf ranges between 3 and 60 km the wider regions of the continental shelf coincide with approximately 60 km north and 50 km south of nazaré canyon which narrows the continental shelf locally to about 3 km see fig 1 thus while the continental shelf width ranges mostly between 30 and 60 km on the northwestern coast it ranges from 28 km close to cape são vincente down to 8 km on the south coast wind waves on the west coast of mainland portugal have their origins mainly in the north atlantic ocean three main wave systems reach the west coast im 2004 the first is characterised by northwest swell generated in the north atlantic ocean and superposes sea conditions caused by north northwest local winds these conditions are the most common 80 of the year following im 2004 the second is characterised by swell generated in the north atlantic ocean that arrive from southwest and may interfere with swell from northwest these wave conditions can last for about one day during the arrival of a cold front or they can take several days when a low pressure system is located southwest of mainland portugal the third is characterised by very energetic wave systems from west and typically occur once per year and can persist for eight days im 2004 the south coast of mainland portugal is exposed to swell and sea and presents three typical conditions im 2004 first swell arriving from southwest which can induce the most severe coastal storms oliveira et al 2018 these conditions are similar to those that occur on the west coast second swell arriving from southeast generated between the strait of gibraltar and the gulf of cadiz known as levante storms third sea wave conditions that are locally generated due to daily temperature differences at the sea land interface occurring about 70 of the time following costa et al 2001 wave characteristics at around 100 m depth can be briefly described by a monthly averaged significant wave height of 2 8 m 1 2 m during northern hemisphere winter summer for the northwestern coast these values are milder along the southern coast and range from 1 5 m in winter to 0 6 m in summer the monthly averaged values of peak wave periods are between 9 and 13 s 6 10 s along the northwestern southern sectors the most frequent incident wave direction is from northwest along the northwestern coastline and it varies along the south coast between w and se directions 2 2 observations time records of wave parameters from three wave buoys located along mainland portugal fig 1 were used in this study these records were collected by multi parametric seawatch wavescan buoys developed by fugro oceanor the portuguese hydrographic institute ih www hidrografico pt secures the deployment and maintenance of the wave buoys wave parameters are calculated using the spectral method a 25 min long record of sea surface elevation with a sampling frequency of 1 hz is processed internally by the wave buoy this procedure is repeated every hour and wave parameters are subsequently sent to the ih office where data is checked and stored each hourly set of wave parameters is here used to define a sea state the location of each buoy is as follows see table 1 buoy 6200191 hereafter leixões is located offshore of leixões harbour buoy 6200192 hereafter nazaré is located offshore of nazaré this site is world famous by surfers due to the nazaré large waves that occur mainly in winter davidson 2013 both leixões and nazaré buoys are located offshore the west coast of mainland portugal buoy 6200200 hereafter faro is located offshore of faro on the south coast of mainland portugal at the three sites time records characterise offshore wave conditions in deep waters i e h l 0 5 where l is the wavelength and h the water depth as an example the condition h l 0 5 is met even for a wave period of 25 s l 975 m using linear wave theory because the wave buoys are moored at h 1000 m table 1 available to us through the emodnet platform are hourly time records of wave parameters namely the significant wave height h m0 the mean wave period t m02 and the mean wave direction mdir only records with quality control settings i e qc flag with values equal to 1 optimal value were used the available time records display some missing data possibly due to the very rough wave conditions during major storms ship collisions or buoy maintenance periods see fig 2 table 2 shows the overall percentage of unregistered data for each buoy here 0 corresponds to hourly data fully available the average percentage of unregistered data was 34 43 and 28 for leixões nazaré and faro buoys respectively these values contrast with the values lower than 20 obtained for coastal wave buoys oliveira et al 2018 highlighting the challenges associated with maintaining a deep water wave buoy network the number of observations and data coverage is also shown in table 3 as a function of each month 2 3 data analysis 2 3 1 wave steepness definition the iahr working group the iahr working group on wave generation and analysis 1989 provided a list of sea state parameters where the wave steepness is obtained by zero crossing analysis s z since wave parameters available to us were obtained using the spectral method we adopted the spectral wave steepness s m 1 s m 2 π h m 0 g t m 02 2 where the subscript m indicates wave parameters obtained with the spectral method several authors have used s m for ocean engineering related studies e g bitner gregersen and guedes soares 2007 myrhaug 2018 2 3 2 wave storm definition a storm definition metric is necessary to investigate wave steepness variability under storm events in this work we defined a wave storm following ih see oliveira et al 2018 except for faro where we used a higher wave height threshold ih classifies a storm event whenever h m0 is larger than 4 5 m on the west coast leixões and nazaré and 2 5 m on the south coast faro these values are approximately two times the annual average h m0 except for faro see section 3 2 1 at faro we set the threshold to h m0 3 0 m the minimum storm duration is considered to be 6 h the independence storm criterion corresponding to the minimum time between two consecutive and independent storms is deemed to be 12 h the definition of a wave storm event still constitutes a topic of ongoing research martzikos et al 2021 a recent overview by harley 2017 suggested that while some authors argue that a storm definition metric must be obtained based on a statistically sound methodology others pragmatically used 95 exceedance values obtained from long wave records we noted that other studies focus on offshore mainland portugal also used other metrics such as the average value of h m0 plus two times the standard deviation of h m0 almeida et al 2011 or the average value of h m0 multiplied by a constant that can range from 1 5 to 3 laface et al 2015 according to the storm definition used in this study a time series of wave storm conditions is depicted in fig 3 2 4 wave storm classification the classification of storm events in this study was based on mendoza et al 2011 these authors used the storm energy content of each event i e i 2 e i t 1 t 2 h m 0 2 d t h m 0 h t r e s h o l d where t 1 is the initial time of the storm t 2 is the final time of the storm and h treshold differs between buoys this classification is adapted from the method proposed by dolan and davis 1992 however mendoza et al 2011 used the time variation of h m0 between t 1 and t 2 instead of the maximum value of h m0 indeed using a single wave height value can bias the total storm energy estimation mendoza et al 2011 marzeddu et al 2020 storms events were categorised at each buoy from less 0 to more energetic 5 using a simple classification index ci for each storm event i 3 c i i 5 e i max e where max e represents the largest energy content of a storm at a specific buoy note that other methods to categorise storms are available in the literature for example mendoza et al 2011 used a cluster analysis through the average linking method since the focus of the present study is not on storm classification and categorisation to obtain a storm intensity scale the simple normalisation equation 3 was considered adequate for the present purposes 3 results 3 1 seasonal time scale the monthly basis seasonal variation of the wave parameters for each location is depicted in fig 4 table 4 includes the mean standard deviation minimum and maximum values of each wave parameter for each wave buoy the mean value and the standard deviation of each wave parameter for each buoy but on a monthly basis can be found in appendix a in general the monthly average values of h m0 and t m02 increase decrease during winter summer the increase of h m0 is associated with the wind field magnitude intensification during winter in the north atlantic ocean basin see fig 2 of young et al 2020 besides the increase of t m02 during winter months is associated with long period waves that travel from west to east in the north atlantic ocean basin young 1999 the values of t m02 at faro are lower than those at leixões or nazaré since the faro wave buoy is located on the south coast fig 1 it is less exposed to long period waves in general differences of h m0 and t m02 between leixões and nazaré are small fig 4 the monthly average values of mdir are rotated towards west and southwest for faro compared to leixões and nazaré moreover the standard deviation of mdir is more significant for faro fig 4 this behaviour is consistent with the shelter provided by cape são vicente fig 1 and also because some wave systems measured at faro known as levante storms have their origin between the strait of gibraltar and the gulf of cadiz oliveira et al 2018 differences in mdir are also not appreciable between leixões and nazaré the results suggest a subtle rotation towards north during the summer months at both buoys from june to september in fig 4 this is associated with the typical summer weather pattern where the azores anticyclone is shifted towards north and north south winds prevail across the portuguese western coast a good description of this weather pattern can be found in semedo 2005 the average value of s m oscillates around 0 031 and is very similar for all the analysed locations fig 4 a decrease of s m to 0 027 occurs during september and october months at all buoy locations this suggests modifications on h m0 and t m02 looking at fig 4 both h m0 and t m02 increase in september and october compared to the summer months june july and august however the rise of t m02 is more pronounced than those of h m0 this relative growth of h m0 and t m02 explains why s m shows a decrease to 0 027 during september and october the increase of t m02 could be in part associated with wind waves generated by some remnants of tropical storms oliveira et al 2020 found these systems are more common during october and related to long travelling wave systems characterised by high wave periods and mild wave height conditions this supports our suggestion for the decrease of s m due to the increase of t m02 during september and october regarding faro a sudden increase of s m 25 occurs between february and march this increase is associated with a significant drop of t m02 when compared to h m0 fig 4 we attribute this variation of s m to levante wave events that become more pronounced during this transition period oliveira et al 2018 noted a sudden increase in the number of levante storms during march these events present a smaller t m02 than those occurring from the north atlantic ocean due to the reduced fetch length to look in more detail to the seasonal variation of s m the frequency distribution fig 5 a b and c and the empirical cumulative distribution function ecdf fig 5d were calculated for each location small but significant differences can be detected at each location as follows while lower s m values are associated with faro s m 0 020 higher s m values are associated with leixões s m 0 045 these results suggest that high steepness sea states are more likely to occur in leixões than in faro overall the three sites frequency distributions present a maximum for s m between 0 020 and 0 030 and a relative maximum for s m around 0 040 the percentage of occurrence of the monthly variation of s m clustered in ecdf classes for each location is shown in fig 6 for each location time records were clustered in different values of ecdf which is associated with values of s m for example wave conditions with ecdf 0 10 are typically associated with s m smaller than approximately 0 015 fig 5d then the percentage of occurrence was calculated for each month therefore the value of 20 for faro buoy that occur in february associated with ecdf 0 10 fig 6a means that 20 of the wave records with an s m value associated to ecdf 0 10 occurred in february regarding leixões approximately 25 of sea states with s m smaller than about 0 015 occurred in september and october approximately 40 of sea states with s m larger than approximately 0 045 took place between march and july values of s m between 0 015 and 0 045 show a consistent pattern across the year but are less likely to occur in september and october in general the seasonal variability of s m at nazaré is very similar to that at leixões fig 6 regarding faro about 50 of sea states with s m smaller than 0 015 occurred in december january and february fig 6a the higher steepness sea states s m 0 045 account for 20 in march at the faro location fig 6c the frequency of s m as a function of h m0 and mdir are displayed in fig 7 the results suggest that while for 1 5 m h m0 4 m values of s m range between 0 010 and 0 055 for h m0 4 m s m become more confined to 0 040 these results are observed both in leixões and in nazaré buoy in contrast s m values scatter between 0 010 and 0 055 for 0 5 m h m0 2 5 m at faro buoy regarding the mdir the results clearly show an increase of s m for mdir 320 n both in leixões and nazaré therefore high steepness sea states are more likely to occur when the wave direction predominantly rotates towards the north in the northwestern portuguese coast typically during the north hemisphere summer months figs 4 and 6 at faro there is no visible relationship between s m and mdir for the sea states with mdir 180 n the sea states with mdir 180 n tend to increase with larger values of mdir at faro buoy similar to the other buoys along the western coast 3 2 storm time scale 3 2 1 storm events characterisation and classification regarding the storm time scale and its definition table 5 shows a comparison between the wave height threshold h treshold used in this study against three other commonly employed metrics to define the wave height threshold namely the 95th percentile of the empirical cumulative distribution function of registered h m0 95th percentile of h m0 the average denoted by plus two times the standard deviation denoted by σ of the registered h m0 i e h m0 2σ hm0 and the average h m0 multiplied by a factor of 2 i e 2 h m0 although some differences can be noticed among locations the maximum relative difference is 7 at leixões these results show that besides the differences that can arise from different criteria used to define the storm event threshold the h treshold value used in this study is close to other commonly used metrics based on the storm definition presented above the following storm events have been registered by the wave buoys at leixões nazaré and faro the number of registered storms was 116 103 and 38 these registered storms correspond to a total of 2858 2547 and 1221 sea states respectively the smaller number of storm events at faro is due to the shorter time record when compared to those at leixões and nazaré the average number of storm events per year at leixões nazaré and faro was 10 5 8 6 and 7 6 respectively even though data coverage is different across years tables 2 and 3 note that the latter values may differ if a different storm event definition threshold and duration is used the storm events share similar characteristics at leixões and nazaré table 6 the average of the maximum h m0 per storm was 6 49 1 35 m 6 50 1 30 m at leixões nazaré in this regard storm events at faro were milder with 4 52 1 03 m the maximum value of h m0 considering all storm events was registered in nazaré on the 19th january of 2013 storm gong at 11 00 utc 00 00 which was 12 72 m see fig 3 the latter value is higher than the maximum value of h s registered at coastal wave buoys of 9 20 m at 90 m water depth between 1987 and 2015 oliveira et al 2018 the average maximum of s m during storm waves was between 0 046 and 0 050 for the three buoy locations with a maximum standard deviation of 0 011 table 6 this indicates that s m values were larger during storms than on the seasonal scale fig 4 each storm event s duration was on average approximately 24 h in leixões and nazaré and about 33 h in faro table 6 the standard deviation value associated with the storm duration is roughly equal to the mean value at faro this indicates that storm events at faro are considerably different from those at leixões or nazaré at deep water wave buoys at coastal buoys similar results were also obtained oliveira et al 2018 in the following we analysed the storm events associated with the three largest ci values for each wave buoy location table 7 shows a synthesis of these events classified using equation 3 first storm events can have a different impact along mainland portugal for example the largest storm event at faro ci 5 occurred between 28th february and 6th march 2018 storm emma during that period the three buoys were collecting data and a ci 0 4 storm was classified at leixões however only a ci 0 04 storm was detected at nazaré the second largest storm event at leixões between 2nd and 5th february 2017 was classified as ci 3 3 at nazaré storm events have a variable relative impact across mainland portugal although nazaré and leixões buoys location shared similar characteristics there are some storm events that do not follow these main patterns the third largest storm event that occurred at faro between 9th and 12th march 2018 storm felix was classified at ci 3 7 at nazaré but only as ci 1 at leixões 3 2 2 wave steepness associated with storm events fig 8 shows the time series of the wave parameters during the storm with higher ci at each location the horizontal axis is centred at t 0 corresponding to the maximum value of h m0 which is considered the storm peak thick lines represent the storm event following the storm definition presented in section 2 2 2 the thin lines represent plus and minus 72 h before the beginning and after the storm in general the increase of h m0 towards the storm peak is accompanied by the rise of t m02 under these three storms s m varied between about 0 030 and 0 060 a relation between the value of s m and the storm peak was not observed unlike h m0 where there are an apparent increase and decrease phase around the storm peak a clear pattern cannot be observed for s m nevertheless it should be noted that for the three storms maximum s m higher than 0 050 were observed just before the storm peak fig 9 depicts the scatter plot between mdir and s m for each location as a function of ci no relationship was found between the ci s m and mdir however the storm events with more energy ci 1 are associated with a value of s m between 0 020 and 0 060 fig 9 these values are typically above the mean values of s m across the year fig 4 this suggests a link between higher steepness waves during storm events 4 discussion our results suggest that a value of s m 0 031 is representative of the year averaged s m offshore mainland portugal fig 4 this value is independent of the geographic position of the deep water wave buoy fig 1 the regional spatial behaviour displayed by s m in our results is similar to what myrhaug 2018 found for the norwegian continental shelf this author based on h s and t p given by a joint probability distribution function for three locations mathisen and bitner gregersen 1990 applied a spectrum wave steepness statistical distribution the values of s m varied between 0 0450 and 0 0464 see table 2 of myrhaug 2018 which indicates a very small regional spatial variability of s m despite the small spatial variability of s m our values of s m 0 031 are smaller than those of myrhaug 2018 s m 0 045 the smaller values of s m observed for offshore mainland portugal than for the norwegian continental shelf seems to be consistent with the global distribution of wave steepness derived from envisat data in 2011 presented by badulin et al 2018 myrhaug 2018 has shown that the expected value of s m increases with the peak enhancement factor γ associated with a jonswap spectrum the expected value of s m is equal to 0 031 0 046 for γ 1 5 myrhaug 2018 therefore we attribute our smaller values of s m 0 031 to wave systems swells generated far from our wave buoys moreover our results are close to the expected value of s m 0 035 for a phillips spectrum myrhaug 2018 despite the representativeness of s m 0 031 for mainland portugal some seasonal changes can occur such as the decrease of s m to 0 027 in september and october months and the increase of s m to 0 034 at faro buoy in march fig 4 we speculate these changes are associated with changes in the atmospheric circulation patterns in the north atlantic e g lucas et al 2021 more specifically these changes could be in part related with wind waves generated by remnants of post tropical storms in september and october oliveira et al 2020 and with levante storms in march for faro buoy oliveira et al 2018 looking at fig 4 an increase of t m02 for the september and october months is clearly observed when compared to august also this increase in t m02 is more pronounced than the increase of h m0 for the same months again this supports our above speculation that this seasonal change in s m is associated with the typical hurricane season on the east coast of us we believe differences in the seasonal trends of s m have not been detected before because the vast majority of the studies were conducted for storm conditions myrhaug and kjeldsen 1986 stansell et al 2003 guedes soares et al 2004 moreover myrhaug 2018 used the joint pdf provided in mathisen and bitner gregersen 1990 and consequently this author was enabled to show the seasonal s m variability during storm conditions the values of s m ranged between 0 020 and 0 060 with the largest storms associated with values of s m 0 030 fig 9 and table 6 these values compare with those presented by myrhaug and kjeldsen 1986 for the norwegian continental shelf 0 050 s m 0 130 see their fig 3 and with those presented by stansell et al 2003 in the north sea 0 045 s m 0 070 differences between our results and myrhaug and kjeldsen 1986 results can be attributed in part to the different definition used to characterise storms their characterisation also included an individual wave with a wave steepness larger than 0 100 over each sea state besides the wave height threshold of 5 m unfortunately the complete time series of sea surface elevation required to characterise individual wave steepness was not available to us regarding the results presented by stansell 2004 their values of s m were larger than ours similar to the discussion presented above on the average value of s m we attribute our smaller values to swell generated in the north atlantic more specifically many wave storms that cross southwestern europe are generated along the labrador sea these wave storms are likely to have larger wave periods than those generated in the north sea the differences in s m variability between our study and stansell 2004 further highlight the need to characterise s m in other regions across the globe such as the north pacific where large wave periods can be expected young 1999 moreover it should be mentioned that unfortunately all the wave buoys analysed in this study were not in operation during winter 2013 14 which was one of the most severe in europe in the last decades masselink et al 2016 our results point to a deeper investigation of the consequences of s m variations during storms and some months across the year fig 4 we showed that s m values are generally larger during storms than average s m 0 031 and that s m values decreased to 0 027 in september and october months and increased to 0 034 in march on the southern coast faro buoy in particular it might be of interest to understand the consequences of these changes for the design of marine structures shipping and beach morphodynamics the analyses performed in this work did not distinguish between single or double peaked spectra because the wave spectra obtained from the deep water wave buoys were not available to us however wave steepness values cannot always be considered as pure one wave system values guedes soares and nolasco 1992 used field observations of 2423 wave spectra from figueira da foz about 80 km north of nazaré coastal buoy at a water depth of 100 m to characterise the occurrence of double peaked spectra they found double peaked spectra to occur between 23 and 26 guedes soares 1991 found that double peaked spectra in the north atlantic ocean are 22 therefore future work should consider recording and analysing wave spectra and investigating the influence of double peaked spectra on s m offshore mainland portugal 5 conclusions this paper aimed firstly to investigate the seasonal s m variability offshore mainland portugal and secondly to understand s m variability under storm conditions data recorded between 2009 and 2020 at three different wave boys located between 1200 and 1900 m water depths offshore mainland portugal were analysed on a seasonal time scale the average value of s m was equal to 0 031 and independent of the location west or south coast seasonal fluctuations of s m occurred between september and october months at the three sites dropping to 0 027 in march at faro a growth of s m to 0 034 was observed on a storm time scale values of s m were highly variable between 0 020 and 0 060 no relation was found between s m mdir and a storm classification index for the analysed storm events in general the most severe storm events were associated with values of s m larger than the yearly averaged s m 0 031 during the storm with higher ci at each of the three sites a maximum s m higher than 0 055 was observed before the storm peak our results highlight the need to characterise s m seasonal variability in other regions of the ocean this type of studies would be of interest due to the importance of s m for the design of marine structures shipping and beach morphodynamics credit authorship contribution statement diogo mendes conceptualization methodology software formal analysis writing original draft tiago c a oliveira methodology software formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors acknowledge ih colleagues for their great effort and dedication to keeping the deep water buoy network along mainland portugal working the second author thanks fct mctes for the financial support to cesam uidp 50017 2020 uidb 50017 2020 through national funds the authors thank two anonymous reviewers for providing us with comments and suggestions that have resulted in an improved paper appendix a mean and standard deviation values of significant wave height h m0 mean wave period t m02 mean wave direction mdir and spectral wave steepness s m on a monthly basis for each wave buoy table a1 mean standard deviation of wave parameters for each month on leixões wave buoy table a1 leixões h m0 m t m02 s mdir s m jan 3 02 1 35 7 7 1 7 287 61 0 033 0 011 feb 3 45 1 49 8 5 1 7 303 25 0 031 0 011 mar 3 05 1 19 7 8 1 4 302 37 0 033 0 012 apr 2 52 1 13 7 2 1 5 301 40 0 032 0 012 may 2 07 0 79 6 4 1 2 307 35 0 033 0 012 jun 1 71 0 72 6 0 1 1 311 36 0 032 0 012 jul 1 62 0 65 5 7 1 0 320 23 0 033 0 013 aug 1 63 0 62 5 8 1 0 315 38 0 031 0 011 sep 1 88 0 76 6 8 1 4 308 34 0 028 0 012 oct 2 29 1 05 7 3 1 5 295 45 0 028 0 011 nov 3 07 1 34 7 6 1 6 301 49 0 034 0 011 dez 3 09 1 44 7 9 1 7 281 60 0 032 0 012 table a2 same as table a1 but for nazaré table a2 nazaré h m0 m t m02 s mdir s m jan 3 00 1 39 7 9 1 7 303 51 0 032 0 011 feb 3 02 1 35 7 9 1 7 308 46 0 032 0 012 mar 2 70 1 22 7 7 1 5 306 38 0 031 0 011 apr 2 41 1 14 7 0 1 4 302 48 0 032 0 011 may 1 85 0 68 6 3 1 1 306 34 0 031 0 010 jun 1 63 0 68 5 9 1 0 313 38 0 031 0 011 jul 1 71 0 65 5 8 0 9 326 33 0 034 0 010 aug 1 60 0 62 5 8 0 9 327 22 0 031 0 010 sep 1 90 0 73 6 9 1 3 316 26 0 027 0 011 oct 2 22 1 06 7 5 1 6 304 33 0 026 0 011 nov 2 99 1 32 7 6 1 6 311 37 0 033 0 011 dez 2 84 1 21 7 8 1 7 293 53 0 030 0 011 table a3 same as table a1 but for faro table a3 faro h m0 m t m02 s mdir s m jan 1 73 0 75 6 5 1 5 258 77 0 028 0 013 feb 1 97 0 79 7 2 1 8 254 79 0 027 0 013 mar 2 17 1 02 6 4 1 2 250 79 0 035 0 013 apr 1 92 0 84 6 4 1 3 259 64 0 031 0 011 may 1 46 0 57 5 5 0 9 243 84 0 031 0 010 jun 1 24 0 43 4 9 0 8 275 61 0 034 0 010 jul 1 16 0 41 4 9 0 6 259 74 0 032 0 009 aug 1 21 0 44 4 8 0 6 237 90 0 034 0 009 sep 1 18 0 47 5 3 1 1 261 82 0 028 0 010 oct 1 54 0 70 6 1 1 3 240 82 0 028 0 012 nov 1 71 0 76 6 2 1 6 260 75 0 030 0 011 dez 1 90 0 97 6 7 1 8 245 85 0 029 0 013 
20428,oscillating water column owc wave energy converters employ air turbines coupled with an electrical generator to convert the wave energy into electrical energy in the present study a ring type axial flow impulse turbine of diameter 196 mm was manufactured to carry out the experiments in an unsteady flow test rig the tests were done for the stroke lengths sl of 0 2m 0 3m and 0 4m and the periods tp varied from 6 to 12 s a rheostat was connected to the generator and the turbine pressure drop and power output variations were recorded for different generator loading conditions the flow rates for the exhalation phase were measured and time series analysis of the pressure drop and rotor speed was done a suitable resistive load was found out for obtaining the highest power output a relationship between average power and average pressure drop was established furthermore a relationship was established between the turbine pressure coefficient and the turbine power coefficient lastly a study on damping characteristics of the turbine was also done to study the effect of damping on the turbine s overall performance keywords wave energy converter impulse turbine experimental analysis oscillating flow test nomenclature a duct area b frictional coefficient c a input flow velocity m s d turbine tip diameter mm e emf electromagnetic force v i current a j m rotor moment of inertia k e back emf constant n rotor speed rpm p instantaneous generator power w p average electrical power w q flow rate m3 s r l resistive loading t time s t non dimensionalized time t em electromagnetic torque nm t l load torque nm u rotor tip velocity m s v voltage v v generator voltage v x individual value y mean value δp pressure drop kpa δp average pressure drop kpa ρ fluid density kg m3 σ standard deviation φ flow coefficient ψ td turbine damping coefficient ψ tp turbine pressure coefficient ψ tw turbine power coefficient ω angular velocity 1 s cad computer aided design cfd computational fluid dynamics cnc computerized numerical control daq data acquisition dc direct current dgv downstream guide vane gv guide vane owc oscillating water column pa polyamide pmdc permanent magnet direct current generator rpm rotations per minute sl stroke length sls selective laser sintering tp period ugv upstream guide vane vfd variable frequency drive vof volume of fluid wefel wave energy and fluids engineering laboratory 1 introduction oscillating water column owc based wave energy converters wecs are one of the several methods in which the ocean wave energy is extracted as shown in fig 1 it consists of a hollow column through which air is forced in and out due to the wave undulations therefore providing a bi directional flow an air turbine is employed to extract this pneumatic energy the owcs can be of different types such as the fixed structure owcs breakwater integrated owcs and floating structure owcs falcão and henriques 2016 usually a self rectifying turbine is employed for energy extraction this type of turbine is capable of rotating in a single direction irrespective of the flow direction one such turbine is called an axial flow impulse turbine which houses a single row of the crescent shaped blade and two rows of gvs gvs the impulse turbines show good starting characteristics have a wide performance range and have minimum noise issues thus it is used widely in the owcs setoguchi et al 2001 early sea trials of the impulse turbine fitted in an owc in vizhinjam india showed promising results in overall performance and power production santhakumar et al 1998 several experimental works on impulse turbines were reported the self starting characteristics and its unsteady behavior were studied with constant flow rates and found that the turbine starts smoothly and can work at low wave energy densities falcão et al 2018 tests for different rotor inlet outlet angles and different air chamber lengths were studied experimental results show the guide vane gv setting angle of 30 gives optimal turbine performance murakami et al 2016 another aspect of wave power extraction is converting the mechanical energy harvested from the turbine to electrical energy this is done by coupling the turbine with a generator the rotor s speed control can avoid the turbine stalling which is a phenomenon where the flow gets detached from the rotor surface the control system can also be designed for maximum energy extraction for the particular wave conditions and chamber efficiency it can also be used to ensure continuous power supply even in varying flow conditions alberdi et al 2012 ormaza et al 2009 kelly et al 2016 a proposed controller design was used to maximize the turbine s instant efficiency and control the turbine rotor speed song and park 2016 a turbine working under optimum damping conditions maximizes the conversion of wave energy to pneumatic energy a simplified study of the damping effect was done by replacing the turbine with orifice plates and the volume of fluid vof model was used to study the damping effects caused a 30 reduction in the peak pneumatic energy output liu et al 2016 the owc chamber s behavior was studied for different wave conditions and chamber geometries a methodology was proposed for matching the impulse turbine with the chamber for optimum chamber damping condition ensuring maximum energy transfer experimental analysis of an impulse turbine showed that the damping effect of the chamber and turbine is reciprocal pereiras et al 2015 george et al 2018 a flow leakage occurs from the pressure side to the suction side of the blade because the tip clearance adversely affects the turbine performance badhurshah et al 2014 to minimize the leakage a concept of endplate was introduced endplates enhanced efficiency by 3 5 while the change in endplate thickness did not change the turbine performance hyun et al 2005 the experiments with an endplate and a simple turbine further confirm that the performance of the endplate type turbine is superior setoguchi et al 2008 numerical simulations on the turbine with a simple rotor endplate type and ring type fig 2 showed that the performance of the turbine with a ring type rotor performs better than the end plate type rotors and there was an efficiency increment of 4 cui et al 2017 table 1 shows the major experimental works done on the bi directional impulse turbine for any turbomachine it becomes necessary to analyze it both numerically and experimentally while detailed flow physics can be studied numerically an experimental analysis is more realistic in nature since the performance of ring type impulse turbine has not been experimentally explored it becomes necessary to carry out its detailed analysis before it can be deployed in the sea for actual use since the flow inside an owc is oscillatory and unsteady in nature an experimental setup that can produce a similar flow can give useful insights into the turbine performance also for producing electricity by extracting wave power it becomes necessary to study the relationship between turbine performance and generator loading in the present work an axial flow impulse turbine with a ring type rotor was manufactured and tested in the oscillatory flow test rig setup at iit madras the tests were carried to study the performance characteristics in unsteady flows and analyzed for different resistive loads the relation between turbine induced damping and turbine pressure coefficient is also shown a detailed analysis of the turbine performance is presented in this article 2 turbine manufacturing and generator selection for an impulse turbine the main factor affecting its performance is the number of guide vanes and rotor blades das et al 2017 the current design was taken from a previously optimized turbine and the ring was introduced to the rotor following the literature the turbine tip diameter was 196 mm and the hub to tip ratio h t was maintained at 0 7 badhurshah and samad 2015 setoguchi et al 2004 the manufactured impulse turbine assembly has the following parts i 196 mm diameter rotor ii upstream gv iii downstream gv iv casing v flange vi generator mounting flange vii internal duct viii upstream nose ix downstream nose the design specifications and parameters of the turbine are shown in fig 3 and table 2 the rotor and the nose cone were manufactured using the selective laser sintering sls technique the sls technique uses a high power laser to selectively scan over thin layers of powdered polymer and sinter the powdered particles together in the shape of the give cross section the material used for the rotor was polyamide pa2200 for its high strength and stiffness detail resolution and various finishing possibilities the gvs were made with stainless steel using 1 6 mm thick sheets which were bent using a bending die to obtain the desired profile shape the gv hub was machined in a cnc machine and a 5 mm depth cut was made according to the profile for inserting gv into the groove the manufactured guide vane and rotor are shown in fig 4 the gvs are 24 and the rotor blades are 38 in number the turbine shaft was made of aluminum alloy and coupled with the generator shaft via a coupler the duct was made of mild steel and was supported by the aluminum flange to convert mechanical energy into electrical energy a permanent magnet direct current pmdc generator was used the casing containing complete turbine generator assembly is shown in fig 5 fig 6 shows the transparent view of the assembly the pmdc generators are apt for low power applications permanent magnets are used instead of field windings thus it does not require external excitation it is smaller compact in design and cheaper as well the rotor part consists of a direct current dc armature with brushes and commutator segments the electromagnetic force e emf developed in the generator is given as 1 e emf k e ω where k e is called back emf constant and ω is the angular velocity the torque developed is given as 2 t e m ω b j m d ω d t t l where b is the frictional coefficient j m is the rotor moment of inertia and t l is the load torque rearranging equation 2 we get the angular acceleration relation as 3 d ω d t l j m t e m t l ω b the mechanical losses are frictional and windage losses while the electrical losses are copper and iron losses the generator specifications are shown in table 3 3 the test rig the experimental test rig was developed at wave energy and fluids engineering laboratory iit madras it mainly contains a motor a slider crank mechanism a piston cylinder duct and related electronic systems fig 7 the 15 kw motor with a voltage rating of 440v and a current rating of 26a runs the slider crank mechanism this motor speed was controlled by a variable frequency drive vfd and further the slider speed was reduced by an automobile gearbox the mechanism changes the rotary motion of the motor to the reciprocating motion of a piston as the piston moves fig 8 the air contained in the cylinder passes through the duct the duct fig 9 contains the turbine generator system a data acquisition system measured the parameters are air flow rate pressure drop across the turbine rotor speed and output electrical power to measure airflow rates a unidirectional averaging type pitot tube was placed in the inlet flow passage 500 mm away from the turbine inlet the tube has two ports a pitot port and a static port the pitot port measures the stagnation pressure and the static port measures the static pressure a flow meter is connected to the pitot tube which gives the airflow rate as output after collecting the above information the pressure drop across the turbine was obtained from two pressure tapings placed at 15 mm before and after the turbine respectively this pressure drop was measured by a differential pressure transducer fig 10 attached to the tapings the differential pressure transducer contains a sensitive diaphragm that deflects with the pressure difference this deflection results in a change in capacitance in the circuit and is detected and measured electronically giving the pressure difference value a non contact type speed sensor measures turbine rotor speed the instrumentation details are mentioned in table 4 a data acquisition system or simply daq c rio ni 9203 provided by national instruments which had an 8 channel 16 bit module recorded the data this daq was connected to a computer and labview software fig 11 recorded and displayed the data the connections of the instrument and the daq system is shown in fig 12 4 experimental procedure by setting the electrical frequency in the vfd fig 13 the motor speed was controlled and the piston tp of 6s 8s 10s and 12s was obtained by altering the crank length the piston stroke length sl was changed to 0 2m 0 3m and 0 4m for each case the tests were run for 2 min a rheostat applied variable loads from 60 ω to 180 ω to the generator and tests were conducted the data was recorded by the daq system fig 14 steps followed for the experiment the turbine is connected to the test rig the piston cylinder arrangement is run at a low frequency of the vfd the integrity of the system is checked at low flow rates for any possible misalignment gradually the flow rate increment is done and the system is checked again after rectifying any possible manufacturing or installation faults the generator is coupled with the turbine the test setup is run for the desired sl and tp the instrument readings are recorded on a computer after the experimental system is stable the experiment is run again for the same cases and checked for repeatability the following equations were used for the performance estimation of the system input flow velocity 4 c a q a rotor tip velocity 5 u d 2 ω the parameters pressure drop δp flow rate q angular speed ω turbine tip diameter d fluid density ρ and instantaneous generator power p gave the non dimensional coefficients pereiras et al 2015 as given below flow coefficient 6 φ c a u the pressure head varies cyclically with the changing flow rate in the owc hence the turbine pressure coefficient is 7 ψ t p ω d ρ δ p the power coefficient quantifies the power with changing pressure drop across the turbine instantaneous pressure drop and power reflect the turbine performance in the unsteady flow the turbine power coefficient is given as 8 ψ t w p ρ d 2 δ p 3 2 the damping exerted by the turbine to the owc affects its performance as it governs the conversion efficiency of wave energy to pneumatic power this is represented by the ratio of flow rate to the pressure drop across the turbine to study the damping characteristics of the turbine a non dimensional coefficient know as turbine damping coefficient is used 9 ψ t d q ρ d 2 δ p 5 result and discussion once the experimental setup is ready the system was run for a few minutes at a low flow rate condition gradually stroke length and frequency were increased the data were recorded after testing the system integrity fig 15 shows time series variation of the volume flow rate of air the graph is presented for the case of sl 0 4m tp 6sec a periodic variation of the flow rate can be seen with the maximum flow rate value reaching up to 0 2 m3 s as the flow meter is unidirectional it can only measure the flow rate of the incoming flow during the exhalation part of the cycle during inhalation the airflow direction reverses which is not captured in the flow meter fig 16 shows the time series variation of the rotor speed and pressure drop the data was taken for 2 min as the series shows periodicity so the ensemble averaging technique was used to produce a single wave for each case of sl and tp in this technique the total time series is divided into a set of individual time series the number of peaks in the total data set determines the total number of segments then the segments are clumped together to produce a single wave fig 17 shows the time series of the averaged values of rotor speed and pressure drop the variations are pseudo sinusoidal in nature as can be seen from the graph obtained for sl 0 2 0 3 and 0 4 m tp 6 12 s and the resistive load rl 180ω the highest rotor speed is 1900 rpm for sl 0 4 m and tp 6 s with the decrease in sl and increase in tp the curve starts getting flatter the pressure drop as well as the rotor speed decreases the highest pressure drop reached was 2 9 kpa for sl 0 4 m and tp 6 s to find a suitable external load the resistance loading r l in the rheostat was varied in the range 60 r l 180 ω as seen in fig 18 the voltage increases with an increase in r l and reaches a maximum value of 190 v for the r l 180 ω opposed to this the current i decreases with the increase in r l and reaches a maximum of 1 44 a for 60 ω the generator output power is given by 10 p vi fig 19 shows the power output p for each r l the highest power obtained is 203 w for r l 180 ω also the gap between various peak power outputs decreases with the increase in r l the generator load also affects the turbine characteristics fig 20 the rotor speed n keeps increasing with the increase in r l interestingly δp remains almost constant irrespective of rl the standard deviation for δp was calculated by the formula 11 σ σ x y 2 n where x and y are the individual value and the mean respectively the standard deviation for each point is represented in fig 21 the overall standard deviation is 0 08 kpa for further study r l was kept constant at 180 ω and the turbine characteristics were found out fig 22 shows the changes in the flow coefficient with non dimensionalized time obtained by dividing the time with the maximum tp for different tp and sl due to this limitation in the experimental setup only the flow velocity values in the exhalation part was captured thus the graphs represent the flow coefficient in the half cycle only the flow coefficient is the ratio of incoming axial velocity to the rotor linear speed each graph shows two peaks one at the start and the other towards the end of the t axis the first peak was obtained as the flow already has an axial velocity but the turbine rotor is at rest and takes time to set in motion due to inertia the higher t peak is due to the residual flow still existing while the rotor is already slowed down the relationship between the average pressure drop and the average power obtained for different tps and sls is shown in fig 23 the highest average power obtained is 118w for the case of sl 0 4m at ct 6 s the average power keeps decreasing for lower sls and higher tps because of the incoming airflow rate decrement for sl 0 4m the lowest average power extracted is 10w for 12 s tp for 6 s tp the lowest average power comes to 9w for 0 2m sl the data obtained through the experiments are non dimensionalized using the coefficients given in equations 7 9 the parameters affecting the power coefficient ψ tw are p and δp the diameter d is constant and since the flow is in an incompressible flow regime ρ is considered constant similarly the turbine pressure coefficient ψ tp is a function of ω and δp the power coefficient ψ tw increases with the increase in ψ tp fig 24 and reaches a peak ψ tw 0 06 the graphs also show a linear relationship between ψ tw and ψ tp for sl 0 4 m and higher tps 10 s and 12 s ψ tw drops significantly the same can be observed for sl 0 2 m and tp 6 s this is due to pressure drop reduced output power the power take off pto mechanism turbine for our case influences the owc in terms of energy transfer from the waves to the owc this effect is a function of q δ p and is termed as turbine induced damping fig 25 shows the instantaneous variation of the damping ψ td for change in ψ tp for different sls and tps the highest ψ td 0 2 is achieved for sl 0 2 m and tp 6 s also the acceleration half of the cycle shows higher damping values it is seen that a higher ψ tp produced a higher ψ tw therefore the optimum damping corresponds to the ψ td obtained for higher ψ tp 6 conclusion experiments were done on a wave energy harvesting impulse turbine with a ring type rotor to study its performance characteristics in unsteady conditions the system was coupled with a generator to study the effects of generator loading on the system as well as to obtain the data of electrical power output the conclusions are the peak rotor speeds varied from 150 rpm for stroke length sl 0 2 m time period tp 6 s to a maximum of 1900 rpm for sl 04 m and tp 6 s for a higher pressure drop across the turbine a higher rotor speed is achieved the peak pressure drop across the turbine is 2 9 kpa for a constant sl and tp the rotor speed was proportional to a resistive load r l the peak rotor speed was achieved for r l 180 ω and lowest for r l 60 ω however for these changes in r l the pressure drop did not vary much within a standard deviation of 0 08 kpa with an increase in r l the current decreases but the voltage significantly increases overall the power produced was the highest for the high r l the peak power was 203w and the average power was 118w the flow coefficients highlight the turbine s dynamic characteristics as it shows the relation between the input flow velocity and the rotor speed the power coefficient ψ tw is directly proportional to the pressure coefficient ψ tp it is seen that higher damping dominates for the acceleration half of the cycle also the optimum damping corresponds to the peak ψ tp this damping value is desired to ensure maximum conversion of the wave energy to the pneumatic energy of the owc system credit authorship contribution statement rishav raj conceptualization methodology visualization writing original draft preparation r anandanarayanan manufacturing data acquisition suchithra ravikumar data acquisition writing review editing prasad dudhgaonkar supervision editing abdus samad supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors gratefully recognize the funding by the national institute of ocean technology project no oec 1516 128 niot abdu ministry of earth sciences government of india to conduct the research 
20428,oscillating water column owc wave energy converters employ air turbines coupled with an electrical generator to convert the wave energy into electrical energy in the present study a ring type axial flow impulse turbine of diameter 196 mm was manufactured to carry out the experiments in an unsteady flow test rig the tests were done for the stroke lengths sl of 0 2m 0 3m and 0 4m and the periods tp varied from 6 to 12 s a rheostat was connected to the generator and the turbine pressure drop and power output variations were recorded for different generator loading conditions the flow rates for the exhalation phase were measured and time series analysis of the pressure drop and rotor speed was done a suitable resistive load was found out for obtaining the highest power output a relationship between average power and average pressure drop was established furthermore a relationship was established between the turbine pressure coefficient and the turbine power coefficient lastly a study on damping characteristics of the turbine was also done to study the effect of damping on the turbine s overall performance keywords wave energy converter impulse turbine experimental analysis oscillating flow test nomenclature a duct area b frictional coefficient c a input flow velocity m s d turbine tip diameter mm e emf electromagnetic force v i current a j m rotor moment of inertia k e back emf constant n rotor speed rpm p instantaneous generator power w p average electrical power w q flow rate m3 s r l resistive loading t time s t non dimensionalized time t em electromagnetic torque nm t l load torque nm u rotor tip velocity m s v voltage v v generator voltage v x individual value y mean value δp pressure drop kpa δp average pressure drop kpa ρ fluid density kg m3 σ standard deviation φ flow coefficient ψ td turbine damping coefficient ψ tp turbine pressure coefficient ψ tw turbine power coefficient ω angular velocity 1 s cad computer aided design cfd computational fluid dynamics cnc computerized numerical control daq data acquisition dc direct current dgv downstream guide vane gv guide vane owc oscillating water column pa polyamide pmdc permanent magnet direct current generator rpm rotations per minute sl stroke length sls selective laser sintering tp period ugv upstream guide vane vfd variable frequency drive vof volume of fluid wefel wave energy and fluids engineering laboratory 1 introduction oscillating water column owc based wave energy converters wecs are one of the several methods in which the ocean wave energy is extracted as shown in fig 1 it consists of a hollow column through which air is forced in and out due to the wave undulations therefore providing a bi directional flow an air turbine is employed to extract this pneumatic energy the owcs can be of different types such as the fixed structure owcs breakwater integrated owcs and floating structure owcs falcão and henriques 2016 usually a self rectifying turbine is employed for energy extraction this type of turbine is capable of rotating in a single direction irrespective of the flow direction one such turbine is called an axial flow impulse turbine which houses a single row of the crescent shaped blade and two rows of gvs gvs the impulse turbines show good starting characteristics have a wide performance range and have minimum noise issues thus it is used widely in the owcs setoguchi et al 2001 early sea trials of the impulse turbine fitted in an owc in vizhinjam india showed promising results in overall performance and power production santhakumar et al 1998 several experimental works on impulse turbines were reported the self starting characteristics and its unsteady behavior were studied with constant flow rates and found that the turbine starts smoothly and can work at low wave energy densities falcão et al 2018 tests for different rotor inlet outlet angles and different air chamber lengths were studied experimental results show the guide vane gv setting angle of 30 gives optimal turbine performance murakami et al 2016 another aspect of wave power extraction is converting the mechanical energy harvested from the turbine to electrical energy this is done by coupling the turbine with a generator the rotor s speed control can avoid the turbine stalling which is a phenomenon where the flow gets detached from the rotor surface the control system can also be designed for maximum energy extraction for the particular wave conditions and chamber efficiency it can also be used to ensure continuous power supply even in varying flow conditions alberdi et al 2012 ormaza et al 2009 kelly et al 2016 a proposed controller design was used to maximize the turbine s instant efficiency and control the turbine rotor speed song and park 2016 a turbine working under optimum damping conditions maximizes the conversion of wave energy to pneumatic energy a simplified study of the damping effect was done by replacing the turbine with orifice plates and the volume of fluid vof model was used to study the damping effects caused a 30 reduction in the peak pneumatic energy output liu et al 2016 the owc chamber s behavior was studied for different wave conditions and chamber geometries a methodology was proposed for matching the impulse turbine with the chamber for optimum chamber damping condition ensuring maximum energy transfer experimental analysis of an impulse turbine showed that the damping effect of the chamber and turbine is reciprocal pereiras et al 2015 george et al 2018 a flow leakage occurs from the pressure side to the suction side of the blade because the tip clearance adversely affects the turbine performance badhurshah et al 2014 to minimize the leakage a concept of endplate was introduced endplates enhanced efficiency by 3 5 while the change in endplate thickness did not change the turbine performance hyun et al 2005 the experiments with an endplate and a simple turbine further confirm that the performance of the endplate type turbine is superior setoguchi et al 2008 numerical simulations on the turbine with a simple rotor endplate type and ring type fig 2 showed that the performance of the turbine with a ring type rotor performs better than the end plate type rotors and there was an efficiency increment of 4 cui et al 2017 table 1 shows the major experimental works done on the bi directional impulse turbine for any turbomachine it becomes necessary to analyze it both numerically and experimentally while detailed flow physics can be studied numerically an experimental analysis is more realistic in nature since the performance of ring type impulse turbine has not been experimentally explored it becomes necessary to carry out its detailed analysis before it can be deployed in the sea for actual use since the flow inside an owc is oscillatory and unsteady in nature an experimental setup that can produce a similar flow can give useful insights into the turbine performance also for producing electricity by extracting wave power it becomes necessary to study the relationship between turbine performance and generator loading in the present work an axial flow impulse turbine with a ring type rotor was manufactured and tested in the oscillatory flow test rig setup at iit madras the tests were carried to study the performance characteristics in unsteady flows and analyzed for different resistive loads the relation between turbine induced damping and turbine pressure coefficient is also shown a detailed analysis of the turbine performance is presented in this article 2 turbine manufacturing and generator selection for an impulse turbine the main factor affecting its performance is the number of guide vanes and rotor blades das et al 2017 the current design was taken from a previously optimized turbine and the ring was introduced to the rotor following the literature the turbine tip diameter was 196 mm and the hub to tip ratio h t was maintained at 0 7 badhurshah and samad 2015 setoguchi et al 2004 the manufactured impulse turbine assembly has the following parts i 196 mm diameter rotor ii upstream gv iii downstream gv iv casing v flange vi generator mounting flange vii internal duct viii upstream nose ix downstream nose the design specifications and parameters of the turbine are shown in fig 3 and table 2 the rotor and the nose cone were manufactured using the selective laser sintering sls technique the sls technique uses a high power laser to selectively scan over thin layers of powdered polymer and sinter the powdered particles together in the shape of the give cross section the material used for the rotor was polyamide pa2200 for its high strength and stiffness detail resolution and various finishing possibilities the gvs were made with stainless steel using 1 6 mm thick sheets which were bent using a bending die to obtain the desired profile shape the gv hub was machined in a cnc machine and a 5 mm depth cut was made according to the profile for inserting gv into the groove the manufactured guide vane and rotor are shown in fig 4 the gvs are 24 and the rotor blades are 38 in number the turbine shaft was made of aluminum alloy and coupled with the generator shaft via a coupler the duct was made of mild steel and was supported by the aluminum flange to convert mechanical energy into electrical energy a permanent magnet direct current pmdc generator was used the casing containing complete turbine generator assembly is shown in fig 5 fig 6 shows the transparent view of the assembly the pmdc generators are apt for low power applications permanent magnets are used instead of field windings thus it does not require external excitation it is smaller compact in design and cheaper as well the rotor part consists of a direct current dc armature with brushes and commutator segments the electromagnetic force e emf developed in the generator is given as 1 e emf k e ω where k e is called back emf constant and ω is the angular velocity the torque developed is given as 2 t e m ω b j m d ω d t t l where b is the frictional coefficient j m is the rotor moment of inertia and t l is the load torque rearranging equation 2 we get the angular acceleration relation as 3 d ω d t l j m t e m t l ω b the mechanical losses are frictional and windage losses while the electrical losses are copper and iron losses the generator specifications are shown in table 3 3 the test rig the experimental test rig was developed at wave energy and fluids engineering laboratory iit madras it mainly contains a motor a slider crank mechanism a piston cylinder duct and related electronic systems fig 7 the 15 kw motor with a voltage rating of 440v and a current rating of 26a runs the slider crank mechanism this motor speed was controlled by a variable frequency drive vfd and further the slider speed was reduced by an automobile gearbox the mechanism changes the rotary motion of the motor to the reciprocating motion of a piston as the piston moves fig 8 the air contained in the cylinder passes through the duct the duct fig 9 contains the turbine generator system a data acquisition system measured the parameters are air flow rate pressure drop across the turbine rotor speed and output electrical power to measure airflow rates a unidirectional averaging type pitot tube was placed in the inlet flow passage 500 mm away from the turbine inlet the tube has two ports a pitot port and a static port the pitot port measures the stagnation pressure and the static port measures the static pressure a flow meter is connected to the pitot tube which gives the airflow rate as output after collecting the above information the pressure drop across the turbine was obtained from two pressure tapings placed at 15 mm before and after the turbine respectively this pressure drop was measured by a differential pressure transducer fig 10 attached to the tapings the differential pressure transducer contains a sensitive diaphragm that deflects with the pressure difference this deflection results in a change in capacitance in the circuit and is detected and measured electronically giving the pressure difference value a non contact type speed sensor measures turbine rotor speed the instrumentation details are mentioned in table 4 a data acquisition system or simply daq c rio ni 9203 provided by national instruments which had an 8 channel 16 bit module recorded the data this daq was connected to a computer and labview software fig 11 recorded and displayed the data the connections of the instrument and the daq system is shown in fig 12 4 experimental procedure by setting the electrical frequency in the vfd fig 13 the motor speed was controlled and the piston tp of 6s 8s 10s and 12s was obtained by altering the crank length the piston stroke length sl was changed to 0 2m 0 3m and 0 4m for each case the tests were run for 2 min a rheostat applied variable loads from 60 ω to 180 ω to the generator and tests were conducted the data was recorded by the daq system fig 14 steps followed for the experiment the turbine is connected to the test rig the piston cylinder arrangement is run at a low frequency of the vfd the integrity of the system is checked at low flow rates for any possible misalignment gradually the flow rate increment is done and the system is checked again after rectifying any possible manufacturing or installation faults the generator is coupled with the turbine the test setup is run for the desired sl and tp the instrument readings are recorded on a computer after the experimental system is stable the experiment is run again for the same cases and checked for repeatability the following equations were used for the performance estimation of the system input flow velocity 4 c a q a rotor tip velocity 5 u d 2 ω the parameters pressure drop δp flow rate q angular speed ω turbine tip diameter d fluid density ρ and instantaneous generator power p gave the non dimensional coefficients pereiras et al 2015 as given below flow coefficient 6 φ c a u the pressure head varies cyclically with the changing flow rate in the owc hence the turbine pressure coefficient is 7 ψ t p ω d ρ δ p the power coefficient quantifies the power with changing pressure drop across the turbine instantaneous pressure drop and power reflect the turbine performance in the unsteady flow the turbine power coefficient is given as 8 ψ t w p ρ d 2 δ p 3 2 the damping exerted by the turbine to the owc affects its performance as it governs the conversion efficiency of wave energy to pneumatic power this is represented by the ratio of flow rate to the pressure drop across the turbine to study the damping characteristics of the turbine a non dimensional coefficient know as turbine damping coefficient is used 9 ψ t d q ρ d 2 δ p 5 result and discussion once the experimental setup is ready the system was run for a few minutes at a low flow rate condition gradually stroke length and frequency were increased the data were recorded after testing the system integrity fig 15 shows time series variation of the volume flow rate of air the graph is presented for the case of sl 0 4m tp 6sec a periodic variation of the flow rate can be seen with the maximum flow rate value reaching up to 0 2 m3 s as the flow meter is unidirectional it can only measure the flow rate of the incoming flow during the exhalation part of the cycle during inhalation the airflow direction reverses which is not captured in the flow meter fig 16 shows the time series variation of the rotor speed and pressure drop the data was taken for 2 min as the series shows periodicity so the ensemble averaging technique was used to produce a single wave for each case of sl and tp in this technique the total time series is divided into a set of individual time series the number of peaks in the total data set determines the total number of segments then the segments are clumped together to produce a single wave fig 17 shows the time series of the averaged values of rotor speed and pressure drop the variations are pseudo sinusoidal in nature as can be seen from the graph obtained for sl 0 2 0 3 and 0 4 m tp 6 12 s and the resistive load rl 180ω the highest rotor speed is 1900 rpm for sl 0 4 m and tp 6 s with the decrease in sl and increase in tp the curve starts getting flatter the pressure drop as well as the rotor speed decreases the highest pressure drop reached was 2 9 kpa for sl 0 4 m and tp 6 s to find a suitable external load the resistance loading r l in the rheostat was varied in the range 60 r l 180 ω as seen in fig 18 the voltage increases with an increase in r l and reaches a maximum value of 190 v for the r l 180 ω opposed to this the current i decreases with the increase in r l and reaches a maximum of 1 44 a for 60 ω the generator output power is given by 10 p vi fig 19 shows the power output p for each r l the highest power obtained is 203 w for r l 180 ω also the gap between various peak power outputs decreases with the increase in r l the generator load also affects the turbine characteristics fig 20 the rotor speed n keeps increasing with the increase in r l interestingly δp remains almost constant irrespective of rl the standard deviation for δp was calculated by the formula 11 σ σ x y 2 n where x and y are the individual value and the mean respectively the standard deviation for each point is represented in fig 21 the overall standard deviation is 0 08 kpa for further study r l was kept constant at 180 ω and the turbine characteristics were found out fig 22 shows the changes in the flow coefficient with non dimensionalized time obtained by dividing the time with the maximum tp for different tp and sl due to this limitation in the experimental setup only the flow velocity values in the exhalation part was captured thus the graphs represent the flow coefficient in the half cycle only the flow coefficient is the ratio of incoming axial velocity to the rotor linear speed each graph shows two peaks one at the start and the other towards the end of the t axis the first peak was obtained as the flow already has an axial velocity but the turbine rotor is at rest and takes time to set in motion due to inertia the higher t peak is due to the residual flow still existing while the rotor is already slowed down the relationship between the average pressure drop and the average power obtained for different tps and sls is shown in fig 23 the highest average power obtained is 118w for the case of sl 0 4m at ct 6 s the average power keeps decreasing for lower sls and higher tps because of the incoming airflow rate decrement for sl 0 4m the lowest average power extracted is 10w for 12 s tp for 6 s tp the lowest average power comes to 9w for 0 2m sl the data obtained through the experiments are non dimensionalized using the coefficients given in equations 7 9 the parameters affecting the power coefficient ψ tw are p and δp the diameter d is constant and since the flow is in an incompressible flow regime ρ is considered constant similarly the turbine pressure coefficient ψ tp is a function of ω and δp the power coefficient ψ tw increases with the increase in ψ tp fig 24 and reaches a peak ψ tw 0 06 the graphs also show a linear relationship between ψ tw and ψ tp for sl 0 4 m and higher tps 10 s and 12 s ψ tw drops significantly the same can be observed for sl 0 2 m and tp 6 s this is due to pressure drop reduced output power the power take off pto mechanism turbine for our case influences the owc in terms of energy transfer from the waves to the owc this effect is a function of q δ p and is termed as turbine induced damping fig 25 shows the instantaneous variation of the damping ψ td for change in ψ tp for different sls and tps the highest ψ td 0 2 is achieved for sl 0 2 m and tp 6 s also the acceleration half of the cycle shows higher damping values it is seen that a higher ψ tp produced a higher ψ tw therefore the optimum damping corresponds to the ψ td obtained for higher ψ tp 6 conclusion experiments were done on a wave energy harvesting impulse turbine with a ring type rotor to study its performance characteristics in unsteady conditions the system was coupled with a generator to study the effects of generator loading on the system as well as to obtain the data of electrical power output the conclusions are the peak rotor speeds varied from 150 rpm for stroke length sl 0 2 m time period tp 6 s to a maximum of 1900 rpm for sl 04 m and tp 6 s for a higher pressure drop across the turbine a higher rotor speed is achieved the peak pressure drop across the turbine is 2 9 kpa for a constant sl and tp the rotor speed was proportional to a resistive load r l the peak rotor speed was achieved for r l 180 ω and lowest for r l 60 ω however for these changes in r l the pressure drop did not vary much within a standard deviation of 0 08 kpa with an increase in r l the current decreases but the voltage significantly increases overall the power produced was the highest for the high r l the peak power was 203w and the average power was 118w the flow coefficients highlight the turbine s dynamic characteristics as it shows the relation between the input flow velocity and the rotor speed the power coefficient ψ tw is directly proportional to the pressure coefficient ψ tp it is seen that higher damping dominates for the acceleration half of the cycle also the optimum damping corresponds to the peak ψ tp this damping value is desired to ensure maximum conversion of the wave energy to the pneumatic energy of the owc system credit authorship contribution statement rishav raj conceptualization methodology visualization writing original draft preparation r anandanarayanan manufacturing data acquisition suchithra ravikumar data acquisition writing review editing prasad dudhgaonkar supervision editing abdus samad supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors gratefully recognize the funding by the national institute of ocean technology project no oec 1516 128 niot abdu ministry of earth sciences government of india to conduct the research 
20429,recently the wide application of unmanned surface vehicles usvs in various fields has deemed path planning of usvs in complex environments particularly in intelligent ports and busy navigation areas as a research interest based on the a algorithm this study proposes an a with velocity variation and global optimisation a vvgo algorithm that realises velocity variation i e acceleration deceleration stopping to avoid obstacles during path planning by including temporal dimension in the map modelling process this addresses the limitations of existing global path planning methods regarding the independence of path planning from the usv control stage in addition the operational objective function of usvs is structured in the algorithm such that the weight of the path length time and energy consumption can be varied in the objective function for the algorithm to generate paths with different focuses for various task requirements based on the real time navigation of vessels in the nearby shared region the developed algorithm predicts the paths of other vessels in the navigation area and realises global path optimisation for long voyages using the ais information service platform of the china maritime safety administration moreover the algorithm includes an artificial potential field in the map modelling to ensure the determination of smooth and safe paths the simulation results confirm that the application of this method can realise global optimisation based on the motion of dynamic obstacles and mission requirements furthermore problems regarding existing dynamic path planning detours for avoiding dynamic obstacles in a narrow water channel can be resolved along with the simultaneous fulfilment of various operational objectives such as navigation based on quickness or the shortest distance or economic measures the method proposed here demonstrates a wide application prospect in the field of usvs keywords global path planning unmanned surface vehicle velocity variation optimisation feature path 1 introduction unmanned surface vehicles usvs are widely used in search patrol resource exploration and other activities owing to their small size and low cost in addition the advancements in artificial intelligence and rising labour costs have increased the interests in unmanned vessels particularly in intelligent ports such as the zhoushan port in china where the effective path planning has been a critical issue wang et al 2017 wang et al 2019a moreover path planning and path tracking ensure the appropriate operation of usvs currently the ability to create an effective path compatible with mission requirements under complex environmental conditions is of great significance to the rapid development of usvs in general path planning constitutes a significant component of the research on autonomous robots intelligent vehicles usvs and autonomous underwater vehicles auvs singh et al 2018 the existing path planning methods can be broadly categorised into static path planning and dynamic path planning in static path planning dynamic obstacle information in the navigation domain is not considered these methods are often used in global path planning gpp where the planning objective has often the shortest path length although the impact of the external environment such as wind waves and currents are considered in many existing gpp methods the velocity variation of usv itself and the mission requirements are not considered in global planning yet thus usvs often avoid dynamic obstacles frequently in busy navigation areas which complicates the tasks of path tracking and local path planning and may cause deviation from the original global route after several such avoidances in succession resulting in the overall failure of gpp moreover the existing dynamic path planning methods are predominantly based on usv sensors such as radar and other equipment that can obtain the information of nearby dynamic obstacles however the detection range is significantly affected by the sensor performance particularly in curved or narrow channels or in sheltered water areas thus this limited detection range makes global optimisation in long voyages impossible on february 4 2015 the automatic identification system ais information service platform of the maritime safety administration of the ministry of transport was implemented in an online application which marked the official public disclosure of the real time dynamic authoritative data of china s coastal and inland river ships in particular the public could obtain the real time ais data of ships free of charge including speed heading position and identity information which were transmitted every 3 10 s rong et al 2019 thus this sharing of dynamic environment information enables the optimal path planning for the entire voyage of the usvs a algorithm is a static heuristic algorithm often used in gpp in grid maps it is an effective direct search method for determining the shortest path furthermore the simple structure of valuation function in a algorithm makes extensions of a algorithm highly diverse which enables addition of various factors in path planning and facilitate the realisation of multi objective optimisation therefore in this study we propose an improved algorithm based on the a algorithm namely the a algorithm with velocity variation and global optimisation a vvgo to resolve the limitations of existing path planning methods the improvements and contributions of the proposed algorithm are as follows 1 the temporal dimension was introduced in the traditional binary map for realising the velocity variation acceleration deceleration stopping in path planning the velocity variation of usvs in path planning makes usvs able to pass through some water access temporarily blocked by dynamic obstacles which may be misjudged as unpassable according to traditional path planning method 2 with velocity variation in path planning more global optimal objectives can be considered this study established an optimisation objective function and optimal objectives include path length time cost and energy consumption under different mission requirements a path satisfying adaptive focus can be realised by adjusting the weight ratio of the path length time cost and energy consumption 3 the a vvgo algorithm could predict and model the trajectory based on the ais information of dynamic obstacles in the nearby navigation domain thus the extra consumption of local planning and obstacles avoidance can be considered and global path selection can be optimised in long voyages this can provide a new entry angle for the improvement of path planning methods simultaneously static and dynamic obstacles were treated with map expansion and an artificial potential field apf to ensure the safety and validity of the path planning the remainder of this paper is organised as follows section 2 summarises the path planning algorithms in the existing literature section 3 introduces the proposed path planning method for usvs including a modelling map with the temporal dimension planning method with velocity variation and multi objective optimisation function the simulations of the proposed method are presented in section 4 while the conclusions are presented in section 5 2 literature review numerous ground breaking studies have been conducted to address the challenges faced during path planning in complex environments these studies can be classified into various categories based on different perspectives and they all have both advantages and disadvantages zafar and mohanta 2018 in particular path planning can be categorised into two types i static path planning and ii dynamic path planning zafar and mohanta 2018 2 1 static path planning a static or global path planning method is suitable when complete information regarding the environment is known and the environmental conditions remain stable over time static path planning methods such as dijkstra a and the apf method are used in global path planning a grid map based path planning algorithm was introduced by dijkstra 1959 thereafter hart et al 1968 introduced the a algorithm based on dijkstra s algorithms for solving exponentially increasing temporally complex problems chen et al 2020a a algorithm with its extensions is usually used to address gpp problems ammar et al 2016 phanthong et al 2014 and the convenient and flexible application of the a algorithm facilitated the development of diverse improved algorithms for path planning of usvs to reduce calculation time and redundancy of a method yan et al 2011 avoided unnecessary adjacent nodes of unnecessary back or forth motion daniel et al 2010 proposed a theta method based on a method to smooth the path generated by a method singh et al 2018 proposed a revised a algorithm termed constrained a algorithm which could generate a safer planned path in the maritime environment considering the influences of tailwind and headwind currents in addition xie et al 2019 proposed a multi direction a algorithm based on apf for generating safer and shorter navigation trajectories within a wind farm water area although the planned path obtained from the apf method is generally smooth and safe the vehicle may get trapped in a local minimum when an obstacle is close to the destination thus the fast marching fm method was used to construct an apf that could aid the vehicle jump out of the local minimum liu and bucknall 2015 apf method is effective both in optimising global xie et al 2019 and local path planning wang et al 2021 shin and kim 2021 in this study we utilised the apf as an auxiliary method to improve the path smoothness global path planning gpp is typically synthesised with local path planning as a hybrid method zelek and levine 2000 proposed a local global concurrent path planning method that was committed toward alleviating the heavy and continually recomputed tasks in sensor based discovery dynamic path planning in this method the global planner provides search information to the local planner so that the local planner can make specific changes for accommodating the new information from local scenarios and accord with the global goal as well furthermore to increase the efficiency of the path planner under complex marine environment with reefs wang et al 2019b proposed a multilayer path planning mmp scheme and addressed global path planning collision avoidance and routine correction within a uniformly integrated framework moreover wang and xu 2020 cohered global and local path planning method and proposed the dynamics constrained global local dgl hybrid path planning scheme which can take complex dynamics constraints and local collision avoidance of usv into consideration and governs a shortest global path to make path planning effective in formation fleets of multiple usvs sang et al 2021 proposed a hybrid method named multiple sub target artificial potential field mtapf algorithm based on global planner a algorithm and local planner apf method this hybrid approach is usually combined with several searching algorithm such as fuzzy artificial potential field fapf genetic algorithm ga etc wang et al 2020 and for example a hybrid global path planning approach of fast marching square can consider the velocity constraint and measures the collision risk chen et al 2020b in general hybrid approaches yield various advantages furthermore global path optimisation is important in real time application of usvs guo et al 2020 maximised the profit i e path distance smoothness stranding risk economic cost and safety per unit time based on a traveling salesman problem algorithm to establish the shortest global path with multiple task points for significant global path optimisation however once the path generated by the global path planner traverses through an area with many dynamic obstacles the usvs must avoid collisions and continuously perform re planning 2 2 dynamic path planning in contrast dynamic path planning is suitable for dynamic environments and when environment information is partially known or previously unknown the dynamic regulation of the generated paths is an ongoing process that is part of the overall process as the usv moves and acquires new environment information from its sensors in recent years both heuristic and classical path planning algorithms have generated promising achievements graph based searching algorithms such as lpa d and d lite have been applied in dynamic environments with significant achievements koenig et al 2004 koenig and likhachev 2005 saranya et al 2016 with regard to grid methods the performance of environment modelling demonstrates a significant impact on path planning xie et al 2019 moreover the grid method can efficiently generate a safe path by maintaining an adequate distance from obstacles furthermore the fast marching method fmm is also a strong tool for optimisation of path planning under complex environments jin and er 2020 zhou et al 2018 proposed an approach to solve the path planning problem when reaching the target and avoiding other hunters efficiently using a modified fmm song et al 2017 proposed a multi layered fm mfm method considering environmental factors in practical navigation analogously liu and bucknall 2017 introduced a propagation scale limit to fmm for restricting the propagation process and increase reliability of the trajectories in constrained environment for multi task execution in wang et al 2018 an additional minimisation step was introduced in the fmm based path planning scheme to solve multi objective variational optimisation problem however the generated paths by this method are not guaranteed to be the optimal solution unlike classical accurate algorithms heuristic methods seek a solution by searching sub optimal results for possible solutions fiskin et al 2020 in addition genetic methods ga and bioinspired algorithms such as particle swarm optimisation pso the artificial fish swarm algorithm afsa and the colony algorithm ac are reliable when accurate algorithms lose effectiveness guo et al 2020 methods based on evolutionary and fuzzy logic algorithms exist as well wu 2019 proposed a pso based coordinated path planning for unmanned aerial aquatic vehicles and auv in an underwater target strike mission fatin et al 2020 used a hybrid pso and bat algorithm to realise the multi objective path planning optimisation of autonomous robots in song et al 2021 an adaptive fractional order velocity is introduced to the pso algorithm which could enhance its capability of jumping out of the local minima and exploring the searching space more thoroughly chen et al 2018 proposed a fuzzy controller optimised using a genetic algorithm to ensure appropriate navigation of the vehicle along the expected path in a study by niu et al 2020 the ga method was integrated with voronoi roadmap to generate energy efficient paths of usvs in complex geographic map with sea current analogously lars and kimb 2021 used evolutionary algorithms to calculate robot paths and significantly reduce the commissioning time in particular particle swarm optimisation shows an excellent performance in complex programming situations moreover sampling based methods include the rapid exploration random tree rrt method and the probabilistic roadmap method prm the rrt method and its extensions for path planning in dynamic environments have been extensively studied tahir et al 2018 however the drawbacks of the traditional rrt method such as disorderly randomness lack of smoothness and trapping by obstacles are obvious and nonnegligible thus rrt reselects the parent node and redefines the connection chao et al 2018 to ensure that it exhibits asymptotic optimality and its extensions generate feasible and smooth paths for the vehicle with kinodynamic constraints adiyatov and varol 2017 in addition numerous improvements in path planning have been achieved based on the rrt algorithms such as quick rrt jeonga et al 2019 potential functions and quick rrt pq rrt li et al 2020 and the rrt cache method yuan et al 2020 however the rrt method cannot provide global optimal solution jin and er 2020 recently the artificial neural network ann method has gained popularity which establishes a relationship between the input and output after adequate training of the model deep reinforcement learning methods are typically used for real time path planning or local path planning in addition the ann method can output control information such as acceleration deceleration and steering angle after adequate rounds of model training woo et al 2019 proposed a deep reinforcement learning based controller for tracking the path of usvs and chen et al 2019 proposed a path planning algorithm based on deep reinforcement learning although the ann method has an excellent performance it requires extensive training in advance in summary many previous studies have been conducted to solve the path planning problem for various types of requirements in dynamic environments however no dynamic path planning method considering the acceleration deceleration stopping actions of usvs before track following stage exists furthermore separating the control stage from the path planning stage may cause inefficiency and certain problems in real world applications particularly when dynamic obstacles block the channel or water alleyway within the path 2 3 automatic identification system ais numerous advanced studies based on ais data have previously been conducted for instance historical ais data used in applications such as a path generation system xu et al 2019 probabilistic trajectory prediction model song et al 2017 and trajectory reconstruction approach zhang et al 2018 have yielded excellent performance however few studies focused on using real time ais data for path planning therefore we used real time ais data for tracking the navigation states of neighbouring vessels and compensated for the distance limitations of the sensors real time ais data contains noise because their quality is dependent on the ais messaging system and navigational state of an individual vessel lapinski and isenor 2011 however local inaccuracy information is less influential with the reservation of a safety interval distance for gpp in large domains and long voyages although a combination of various approaches is accepted as an effective method for optimising the planned path the path planning stage and the controlling stage are still separated moreover the inclusion of certain actions pertaining to the controlling stage such as acceleration deceleration stopping in the path planning procedure remains a novel attempt to date thus the a vvgo method proposed in this study utilises ais data as global dynamic obstacle information and integrates velocity variation into path planning to accomplish multi objective optimisation 3 methods 3 1 modelling of static environment the static environment constitutes the primary region in path planning including the start point s s p target point s t p and static obstacles in this study the basic search map was a two dimensional grid map wherein the grids with obstacles were marked as 1 and the grid corresponding to free space was marked as 0 the obstacles were considered under an expansion operation to ensure that the path maintained a sufficient safety distance from the obstacles initially the grids with obstacles were marked as 1 fig 1 a in addition the grids partially occupied with obstacles were also marked as 1 fig 1 b furthermore all the grids with distances less than r 1 minimum safe distance from the obstacles were marked as 1 fig 1 c thereafter the expansion process ceased the smoothness of the path in the grid map was ensured by adopting the apf method for grids with distances less than r2 the second safest distance from the obstacles in the traditional apf model liu et al 2014 the repulsion field of the obstacles is expressed as follows 1 u x y 1 2 k 1 d 1 r 2 2 d r 2 0 d r 2 where x y are the current coordinates of the usv x 0 y 0 are the coordinates of the obstacles and d x x 0 2 y y 0 2 represents the distance between them k is a parameter affects the value of the repulsion in general as the distance between the grid and the obstacle decreases the risk of collision increases indicating a higher value of u x y however grids with a distance greater than r 2 from the obstacles do not entail an additional cost in addition the safety of usvs can be further ensured in this method by setting a default safety distance for the usv itself as depicted in fig 2 the usv can be simplified into a particle and a safety distance d s the safe length of usv can be set around the particle 3 2 modelling of dynamic environment for preparing for subsequent realisation of velocity variation a temporal dimension is added in the searching map during the dynamic environment modelling process so the motion of usvs and dynamic obstacles can be consideration together as depicted in fig 3 the x o y plane denotes the first grid map of the usv at the time of departure and the geometric normal z axis in the original binary grid map is expressed as the time axis each plane perpendicular to the time axis yellow layers in fig 3 represents a searching grid map at the corresponding time the process of modelling dynamic environment is as follows 1 the total time cost between initiation t 0 to arrival is assumed as t during which navigation information of dynamic obstacles such as current position s x t 0 s y t 0 speed v t and sailing direction α t are obtained based on real time ais data platform 2 the trajectory and motion of the dynamic obstacle are predicted at every interval of δt from t 0 the dynamic obstacle is moved straight at a constant speed to a corresponding position based on the known navigation information expressed as follows 2 s x t i s x t i 1 v t i 1 δ t cos α t i 1 s y t i s y t i 1 v t i 1 δ t sin α t i 1 t i t i 1 δ t 3 conclusively the dynamic modelling process ends once the dynamic obstacles exceed the navigation domain or the usv reaches the target point the position of the dynamic obstacle at any time t n can be expressed as follows 3 s x t n s x t 0 i 1 n v t i 1 δ t cos α t i 1 s y t n s y t 0 i 1 n v t i 1 δ t sin α t i 1 moreover the value of δ t can be altered based on the calculation resource and complexity of the environment although a smaller δ t results in a smoother and more precise path it requires a greater calculation time cost while a larger δ t produces contrasting results thus a three dimensional trajectory which describes both temporal and spatial information of the dynamic obstacle can be traced by connecting all the positions of the same dynamic obstacle on every plane 3 3 energy cost function of usv usvs differ in manoeuvrability and operational performance including acceleration deceleration steering performance and voyage ranges according to their types thus the operational performance should be assessed in advance to account for the energy cost of the usvs in the path planning stage therefore an evaluation function was established for assessing the operational performance of usvs as a unified quantification to determine the energy cost at high speed basic speed the specific range of high speed and basic speed differ among usvs and idling speed stopping at current position in the path planning stage as illustrated in fig 4 the evaluation function returned three values 1 e c b s energy cost for navigation at basic speed 2 e c h s energy cost for navigation at high speed 3 e c i energy cost at idling speed these three cost indices were determined from the operational performances of the usvs and were almost the same under different usage conditions however these indices for an individual usv can be measured experimentally and used as constant parameters in the algorithm 3 4 improvement of a algorithm 3 4 1 improvement of f n function the traditional a algorithm generates the shortest path by selecting each node that yields the minimum value of the f value f n g n h n in the iteration process the parameter n represents the node in grid map which is valid below in this study the e value e n g n h n replaces the f value as the objective function in the a vvgo algorithm in particular the e value represents the path length voyage time consumption and voyage energy consumption which are denoted by three functions l n t n and e c n respectively in addition g n and h n are subfunctions representing the linear superposition of l n t n and e c n where h n is the heuristic valuation function from the current node n to the target point expressed as follows 4 h n α l l n α t t n α e c e c n in the above equation l n x n s t p x 2 y n s t p y 2 represents the euclidean distance used to estimate the distance between the current node x n y n and the target point s t p x s t p y t n l n v b s denotes the time cost required for traveling from the current node to target location on a straight line at a constant basic speed which is used to estimate the time consumption for the remaining voyage to reach s t p similarly e c n l n v b s e c b s denotes the estimated energy cost for traveling from the current node to target point under the same conditions the three parameters α l α t and α e c in equation 4 represent the weight ratio of the path length time cost and energy consumption in heuristic function h n respectively in addition α l α t α e c 1 thus the proportion of these three parameters can be adjusted according to various task requirements for generating paths with a specific focus on path length time cost or energy cost the weight of the path length in the objective function is increased by increasing the value of α l thus ensuring a smaller total path length in the complete iteration process similarly the weight of the voyage time in the objective function is increased by increasing the value of α t such the high speed portion of the voyage in the entire path increases and the total voyage time decreases furthermore the weight of the energy consumption in the objective function increases with the increasing value of α e c thereby decreasing the total energy consumption of the entire path function g n determines the cost of traveling from the start point to the current node and comprises three functions l n t n and e c n which are similar to function h n and can be expressed as 5 g n α l l n α t t n α e c e c n where the values of α l α t and α e c in g n are identical to those in h n l n represents the path length from the start point to the current node t n represents the cumulative time consumption from the start point to the current node e c n represents the cumulative energy consumption from the start point to the current node the function e c n in equation 5 can be expressed as 6 e c n δ b s e c b s δ h s e c h s δ i e c i where δ b s δ h s and δ i represent the number of cumulative navigation actions at basic speed high speed and idling speed respectively from the start point to the current node with the minimum value of g n therefore the function e c n represents the cost of all the actions up to the current node thus a node with the smallest value of e value is selected as the path to the next node until the target is reached in each round of the iteration process 3 4 2 velocity variation in paths following the two above mentioned steps 3 1 and 3 2 a complete search grid map containing static obstacles and dynamic obstacles movement information was built based on this map three search directions with different interval lengths were set to realise the navigation at different speeds in the path therefore the high speed directions d hs representing the high speed state and the idling direction d i representing the idle state are required to be included with respect to the original basic directions d bs thus the navigation at high speed and idling period at the current position of the usvs can be represented in the path in the original a algorithm four or eight directions pertaining to the adjacent nodes of the current node were searched for instance assuming that the coordinates of the current node are 0 0 the set of search directions can be expressed as 7 d bs 0 1 0 1 1 0 1 0 1 1 1 1 1 1 1 1 the travelled distance of the usv calculated in unit time at a basic sailing speed s b s was set as the unit length of each grid in the plane map i e s b s 1 the advance distance per unit time at high speed state was set as s h s where s h s m s b s and m is a positive integer ensuring that the usv is still at the centre of a grid on the search map the high speed directions can be expressed as 8 d hs 0 s h s 0 s h s s h s 0 s h s 0 s h s s h s s h s s h s s h s s h s s h s s h s similarly the idling direction can be expressed as 9 d i 0 0 thus the new total search direction d t is 10 d t d bs d hs d i furthermore the pseudocode of this algorithm is presented in table 1 and the flowchart of the a vvgo algorithm is illustrated in fig 5 4 simulation and analysis 4 1 global path optimisation for long and narrow waterways to confirm the global optimisation ability of the proposed algorithm we constructed a map with a curved and narrow channel as depicted in fig 6 in this map the blue start point and the red end point are at the opposite ends of the narrow waterway the usv is marked in green and the bright green circle around the usv indicates the detectable range under its own radar or sensors as the usv enters the narrow channel a formation of five vessels in the middle of the channel sails gradually in a queue slowly however the radar cannot detect the environmental conditions in the latter section of the channel owing to the obstruction on both sides of the channel in a static environment the usv determines two route options to the target point 1 path a passing through the channel and 2 path b passing counter clockwise on the outside of the island path a is the best route choice based on the known static environment when no other obstacle is detected in the middle of the channel in practice most narrow waterways are categorised into two sailing directions to ensure that the usv cannot use the opposite side for overtaking the formation of slow vessels moreover the channel is too narrow for two ships to safely navigate side by side if the formation in the narrow channel constitutes high tonnage slow moving cargo ships that allow only limited space for small low displacement and manoeuvrable usvs the usv must decrease its speed along the back of the queue to navigate past the slow moving formation ahead however the maneuvrability advantage of usvs cannot be fully utilised and may even cause mission delay the simulation experimental setup of the discussed situation is presented herein a the plane map has a 100 100 square grid and the grid side length corresponds to an actual distance of approximately 72 6 m b the speed of the usv is 0 40 knots c the average speed of the cargo ship formation is 12 knots the simulation results are depicted in fig 7 where fig 7 a illustrates the search map in the computer post expansion and addition of apf and fig 7 b represents the path planning simulation of a usv based on its own sensors wherein the usv is forced to slow down when it reaches the middle of a narrow channel in addition the path planning simulation of a usv based on ais data is depicted in fig 7 c where the usv decides to steer outside of the narrow channel the average speed path length travel time and energy consumption of the two paths are presented in table 2 the experimental results revealed that when sailing in path a the usv travels at a high speed of about 300 s before encountering the dynamic obstacles when the radar detects the dynamic obstacles the usv is forced to sail behind the formation at a speed lower than that of the formation in contrast when sailing in path b the usv avoids the channel with the slow formation and its average speed in path b is 32 46 higher than that in path a whereas the time cost is 19 82 lower the approximately 10 longer length of path b than path a is compensated by the advantage in its time cost thus dynamic obstacle information on a long voyage can be obtained from ais data with which the usv can avoid busy channels and optimise global path selection for the entire voyage path planning with a different focus is described in the following section 4 2 path planning with a different focus the multi objective optimisation function proposed in this study was verified by considering the zhoushan port china as an example zhoushan port is an important port on the southern flank of the yangtze river economic belt and is one of the busiest ports in china in addition the port has a complete shore based ais that can receive ais information of the ships in the covered area and acquire the real time motion information of the ships as depicted in fig 8 a 4 3 precondition of experiment as depicted in fig 8 b paths a and b start from the yellow point and end at the red target point where a narrow water area is portrayed as a red circle in path a according to the methods presented in sections 3 1 and 3 2 the plane searching map with a 100 100 grid was constructed based on the panoramic map of the zhoushan port the plane searching map in the computer is depicted in fig 9 where the white area in fig 9 a denotes the free space and the black area represents static obstacles such as land and islands moreover fig 9 b depicts the results post the map expansion and fig 9 c illustrates the effect of the introduction of the apf furthermore in the simulation experiment a dynamic obstacle was set in the narrow water area which has been marked in the map to verify the path planning outcome under various weights as depicted in fig 10 a the dynamic obstacle travels at a constant speed in a straight path as the usv sails along path a and is about to pass through the narrow water area as planned the dynamic obstacle will obstruct the usv in the narrow water area as depicted in fig 10 b thus the usv cannot pass through the narrow waters at this instant owing to safety reasons the experimental setup representing this situation for computer simulation is presented herein a the plane map has 100 100 square grids and the grid side length corresponds to the actual distance of approximately 182 m b the highest speed of the usv is 40 knots and the basic speed is 15 knots c the speed of the dynamic obstacle is 6 65 knots d the energy consumption of the usv per unit distance at basic high and idling speed are e c b s 1 e c h s 1 45 and e c i 0 1 respectively a dynamic algorithm such as the d lite algorithm was used for planning the blue line i e the generated planned path bypasses the middle island because of the obstruction to reach the end point and this path is not optimal from the perspective of sailing distance as depicted in fig 11 the weight setting in the dynamic d lite algorithm and the three types of weight combinations for a vvgo are listed in table 3 as three solutions with a different focus 4 3 1 low energy consumption solution the low energy consumption solution simulates a task situation that is not urgent a higher weight was set for the energy consumption whereas a lower weight was set for the time cost the weight combination set in this case was α l 0 27 α t 0 03 α e c 0 7 the positions of the usv and dynamic obstacles during the voyage and the trajectory are depicted in fig 12 the simulation results show that the path length generated under a vvgo is shorter than that generated by the d lite algorithm without speed variation the improved algorithm enables the usv to wait for the dynamic obstacle to pass through the narrow channel and thereafter sail to the open water thus the usv can conveniently pass through the narrow channel and reach the target point with a lower energy consumption as this weight combination results in a higher cost at high speed navigation high speed action does not occur in this case in the entire path the usv only travelled at the basic speed or idled at the current position the final objective function value was at the minimum the following section details an instance of a usv avoiding obstacles and passing through a narrow channel through acceleration 4 3 2 low time consumption solution this solution simulates an urgent task situation there is a higher weight on the time cost and a lower weight on the energy consumption the weight combination set in the case is α l 0 49 α t 0 15 α e c 0 36 the positions of the usv and dynamic obstacles during the voyage and the trajectory are depicted in fig 13 the simulation results show that the usv encounters the dynamic obstacle at 712 9 s and avoids it from the right hand side before the narrow water area is blocked through a series of high speed actions in advance after avoiding the dynamic obstacles the usv sails at a basic speed to reach the target point with a total time cost of 2111 3 s in this case the weight of energy consumption is relatively small whereas that of time is relatively large therefore there are several instances of high speed actions in this path and the combination of high speed navigation and basic speed navigation yields the minimum value of the objective function under this parameter setting furthermore the calculation cost of high speed navigation can be reduced to that or even lower than that of sailing at the basic speed at a greater degree of emergency with higher weights on time cost more precisely the usv sails at high speed to reach the target point because the energy consumption is relatively reduced in comparison with the time cost 4 4 comprehensive benefit solution in case of a moderate degree of mission urgency or a relatively common case the optimal path should exhibit the lowest total time and energy consumptions and shortest path length the combination set of the weights in this case is α l 0 45 α t 0 05 and α e c 0 5 the positions of the usv and dynamic obstacles in the voyage and the trajectory are depicted in fig 14 the simulation results reveal that the usv can reach its target point by avoiding the dynamic obstacle through narrow waters in this path there are two periods of its stopping and idling at t 1334 8 s the dynamic obstacle passes through the narrowest water region after which a wide water area prevails in the channel the usv maintains adequate safe distance from both the dynamic and static obstacles with adequate circumnavigation space to avoid dynamic obstacles during t 1460 7 s and t 1662 2 s the usv avoids the dynamic obstacle on the right hand side at high speed achieving obstacle avoidance if the usv continues to wait at this instant t 705 2 s it would have had to wait until the dynamic obstacle completely navigates out of the narrow water region thus exceeding its time limit in addition the usv would not have been able to circumvent the dynamic obstacles at an adequately safe distance while traveling at the basic speed therefore the simulation results reveal the optimal path strategy under current weight settings the combination of stopping basic speed sailing and high speed sailing is the optimal strategy with minimum consumption of both time and energy thus reasonable parametric settings can be obtained to plan a path with all the three aspects optimised the results of the dynamic algorithm d lite and a vvgo with three parameters including the time consumption for basic and high speed navigation and stopping idling path length total time consumption and energy consumption are presented in table 4 5 conclusions we proposed an a vvgo algorithm for optimising the global navigation path of usvs based on the a algorithm in addition a temporal dimension was included along with velocity variation to consider the basic high and idle speed actions of usvs in the path planning stage to avoid dynamic obstacles thus planning paths with different emphases could be realised with the developed efficiency function furthermore global optimal path planning was realised based on the ais platform the simulation results revealed that real time ais data could predict and determine the trajectory of the dynamic obstacles present in the navigation domain for avoiding the congested narrow water area and optimise the overall path planning selection for the usv thereafter the generated path could focus on various factors i e energy efficiency quickness or economy and satisfy the different requirements of various practical tasks by varying the weight of length time and energy consumption in the algorithm the a vvgo algorithm demonstrated an application prospect in the autonomous navigation of usvs in busy navigation channels future studies can develop a collision probability model and the dynamic obstacles with low collision probability can be removed during the map modelling to accelerate the path search speed credit authorship contribution statement kai yu methodology validation writing original draft xiao feng liang conceptualization ming zhi li methodology writing review editing zhe chen supervision yan long yao software xin li data curation zi xiang zhao software yue teng supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by the cultivation of scientific research ability of young talents of shanghai jiao tong university grant no 19x100040072 and the key laboratory of marine intelligent equipment and system of ministry of education grant no mies 2020 07 
20429,recently the wide application of unmanned surface vehicles usvs in various fields has deemed path planning of usvs in complex environments particularly in intelligent ports and busy navigation areas as a research interest based on the a algorithm this study proposes an a with velocity variation and global optimisation a vvgo algorithm that realises velocity variation i e acceleration deceleration stopping to avoid obstacles during path planning by including temporal dimension in the map modelling process this addresses the limitations of existing global path planning methods regarding the independence of path planning from the usv control stage in addition the operational objective function of usvs is structured in the algorithm such that the weight of the path length time and energy consumption can be varied in the objective function for the algorithm to generate paths with different focuses for various task requirements based on the real time navigation of vessels in the nearby shared region the developed algorithm predicts the paths of other vessels in the navigation area and realises global path optimisation for long voyages using the ais information service platform of the china maritime safety administration moreover the algorithm includes an artificial potential field in the map modelling to ensure the determination of smooth and safe paths the simulation results confirm that the application of this method can realise global optimisation based on the motion of dynamic obstacles and mission requirements furthermore problems regarding existing dynamic path planning detours for avoiding dynamic obstacles in a narrow water channel can be resolved along with the simultaneous fulfilment of various operational objectives such as navigation based on quickness or the shortest distance or economic measures the method proposed here demonstrates a wide application prospect in the field of usvs keywords global path planning unmanned surface vehicle velocity variation optimisation feature path 1 introduction unmanned surface vehicles usvs are widely used in search patrol resource exploration and other activities owing to their small size and low cost in addition the advancements in artificial intelligence and rising labour costs have increased the interests in unmanned vessels particularly in intelligent ports such as the zhoushan port in china where the effective path planning has been a critical issue wang et al 2017 wang et al 2019a moreover path planning and path tracking ensure the appropriate operation of usvs currently the ability to create an effective path compatible with mission requirements under complex environmental conditions is of great significance to the rapid development of usvs in general path planning constitutes a significant component of the research on autonomous robots intelligent vehicles usvs and autonomous underwater vehicles auvs singh et al 2018 the existing path planning methods can be broadly categorised into static path planning and dynamic path planning in static path planning dynamic obstacle information in the navigation domain is not considered these methods are often used in global path planning gpp where the planning objective has often the shortest path length although the impact of the external environment such as wind waves and currents are considered in many existing gpp methods the velocity variation of usv itself and the mission requirements are not considered in global planning yet thus usvs often avoid dynamic obstacles frequently in busy navigation areas which complicates the tasks of path tracking and local path planning and may cause deviation from the original global route after several such avoidances in succession resulting in the overall failure of gpp moreover the existing dynamic path planning methods are predominantly based on usv sensors such as radar and other equipment that can obtain the information of nearby dynamic obstacles however the detection range is significantly affected by the sensor performance particularly in curved or narrow channels or in sheltered water areas thus this limited detection range makes global optimisation in long voyages impossible on february 4 2015 the automatic identification system ais information service platform of the maritime safety administration of the ministry of transport was implemented in an online application which marked the official public disclosure of the real time dynamic authoritative data of china s coastal and inland river ships in particular the public could obtain the real time ais data of ships free of charge including speed heading position and identity information which were transmitted every 3 10 s rong et al 2019 thus this sharing of dynamic environment information enables the optimal path planning for the entire voyage of the usvs a algorithm is a static heuristic algorithm often used in gpp in grid maps it is an effective direct search method for determining the shortest path furthermore the simple structure of valuation function in a algorithm makes extensions of a algorithm highly diverse which enables addition of various factors in path planning and facilitate the realisation of multi objective optimisation therefore in this study we propose an improved algorithm based on the a algorithm namely the a algorithm with velocity variation and global optimisation a vvgo to resolve the limitations of existing path planning methods the improvements and contributions of the proposed algorithm are as follows 1 the temporal dimension was introduced in the traditional binary map for realising the velocity variation acceleration deceleration stopping in path planning the velocity variation of usvs in path planning makes usvs able to pass through some water access temporarily blocked by dynamic obstacles which may be misjudged as unpassable according to traditional path planning method 2 with velocity variation in path planning more global optimal objectives can be considered this study established an optimisation objective function and optimal objectives include path length time cost and energy consumption under different mission requirements a path satisfying adaptive focus can be realised by adjusting the weight ratio of the path length time cost and energy consumption 3 the a vvgo algorithm could predict and model the trajectory based on the ais information of dynamic obstacles in the nearby navigation domain thus the extra consumption of local planning and obstacles avoidance can be considered and global path selection can be optimised in long voyages this can provide a new entry angle for the improvement of path planning methods simultaneously static and dynamic obstacles were treated with map expansion and an artificial potential field apf to ensure the safety and validity of the path planning the remainder of this paper is organised as follows section 2 summarises the path planning algorithms in the existing literature section 3 introduces the proposed path planning method for usvs including a modelling map with the temporal dimension planning method with velocity variation and multi objective optimisation function the simulations of the proposed method are presented in section 4 while the conclusions are presented in section 5 2 literature review numerous ground breaking studies have been conducted to address the challenges faced during path planning in complex environments these studies can be classified into various categories based on different perspectives and they all have both advantages and disadvantages zafar and mohanta 2018 in particular path planning can be categorised into two types i static path planning and ii dynamic path planning zafar and mohanta 2018 2 1 static path planning a static or global path planning method is suitable when complete information regarding the environment is known and the environmental conditions remain stable over time static path planning methods such as dijkstra a and the apf method are used in global path planning a grid map based path planning algorithm was introduced by dijkstra 1959 thereafter hart et al 1968 introduced the a algorithm based on dijkstra s algorithms for solving exponentially increasing temporally complex problems chen et al 2020a a algorithm with its extensions is usually used to address gpp problems ammar et al 2016 phanthong et al 2014 and the convenient and flexible application of the a algorithm facilitated the development of diverse improved algorithms for path planning of usvs to reduce calculation time and redundancy of a method yan et al 2011 avoided unnecessary adjacent nodes of unnecessary back or forth motion daniel et al 2010 proposed a theta method based on a method to smooth the path generated by a method singh et al 2018 proposed a revised a algorithm termed constrained a algorithm which could generate a safer planned path in the maritime environment considering the influences of tailwind and headwind currents in addition xie et al 2019 proposed a multi direction a algorithm based on apf for generating safer and shorter navigation trajectories within a wind farm water area although the planned path obtained from the apf method is generally smooth and safe the vehicle may get trapped in a local minimum when an obstacle is close to the destination thus the fast marching fm method was used to construct an apf that could aid the vehicle jump out of the local minimum liu and bucknall 2015 apf method is effective both in optimising global xie et al 2019 and local path planning wang et al 2021 shin and kim 2021 in this study we utilised the apf as an auxiliary method to improve the path smoothness global path planning gpp is typically synthesised with local path planning as a hybrid method zelek and levine 2000 proposed a local global concurrent path planning method that was committed toward alleviating the heavy and continually recomputed tasks in sensor based discovery dynamic path planning in this method the global planner provides search information to the local planner so that the local planner can make specific changes for accommodating the new information from local scenarios and accord with the global goal as well furthermore to increase the efficiency of the path planner under complex marine environment with reefs wang et al 2019b proposed a multilayer path planning mmp scheme and addressed global path planning collision avoidance and routine correction within a uniformly integrated framework moreover wang and xu 2020 cohered global and local path planning method and proposed the dynamics constrained global local dgl hybrid path planning scheme which can take complex dynamics constraints and local collision avoidance of usv into consideration and governs a shortest global path to make path planning effective in formation fleets of multiple usvs sang et al 2021 proposed a hybrid method named multiple sub target artificial potential field mtapf algorithm based on global planner a algorithm and local planner apf method this hybrid approach is usually combined with several searching algorithm such as fuzzy artificial potential field fapf genetic algorithm ga etc wang et al 2020 and for example a hybrid global path planning approach of fast marching square can consider the velocity constraint and measures the collision risk chen et al 2020b in general hybrid approaches yield various advantages furthermore global path optimisation is important in real time application of usvs guo et al 2020 maximised the profit i e path distance smoothness stranding risk economic cost and safety per unit time based on a traveling salesman problem algorithm to establish the shortest global path with multiple task points for significant global path optimisation however once the path generated by the global path planner traverses through an area with many dynamic obstacles the usvs must avoid collisions and continuously perform re planning 2 2 dynamic path planning in contrast dynamic path planning is suitable for dynamic environments and when environment information is partially known or previously unknown the dynamic regulation of the generated paths is an ongoing process that is part of the overall process as the usv moves and acquires new environment information from its sensors in recent years both heuristic and classical path planning algorithms have generated promising achievements graph based searching algorithms such as lpa d and d lite have been applied in dynamic environments with significant achievements koenig et al 2004 koenig and likhachev 2005 saranya et al 2016 with regard to grid methods the performance of environment modelling demonstrates a significant impact on path planning xie et al 2019 moreover the grid method can efficiently generate a safe path by maintaining an adequate distance from obstacles furthermore the fast marching method fmm is also a strong tool for optimisation of path planning under complex environments jin and er 2020 zhou et al 2018 proposed an approach to solve the path planning problem when reaching the target and avoiding other hunters efficiently using a modified fmm song et al 2017 proposed a multi layered fm mfm method considering environmental factors in practical navigation analogously liu and bucknall 2017 introduced a propagation scale limit to fmm for restricting the propagation process and increase reliability of the trajectories in constrained environment for multi task execution in wang et al 2018 an additional minimisation step was introduced in the fmm based path planning scheme to solve multi objective variational optimisation problem however the generated paths by this method are not guaranteed to be the optimal solution unlike classical accurate algorithms heuristic methods seek a solution by searching sub optimal results for possible solutions fiskin et al 2020 in addition genetic methods ga and bioinspired algorithms such as particle swarm optimisation pso the artificial fish swarm algorithm afsa and the colony algorithm ac are reliable when accurate algorithms lose effectiveness guo et al 2020 methods based on evolutionary and fuzzy logic algorithms exist as well wu 2019 proposed a pso based coordinated path planning for unmanned aerial aquatic vehicles and auv in an underwater target strike mission fatin et al 2020 used a hybrid pso and bat algorithm to realise the multi objective path planning optimisation of autonomous robots in song et al 2021 an adaptive fractional order velocity is introduced to the pso algorithm which could enhance its capability of jumping out of the local minima and exploring the searching space more thoroughly chen et al 2018 proposed a fuzzy controller optimised using a genetic algorithm to ensure appropriate navigation of the vehicle along the expected path in a study by niu et al 2020 the ga method was integrated with voronoi roadmap to generate energy efficient paths of usvs in complex geographic map with sea current analogously lars and kimb 2021 used evolutionary algorithms to calculate robot paths and significantly reduce the commissioning time in particular particle swarm optimisation shows an excellent performance in complex programming situations moreover sampling based methods include the rapid exploration random tree rrt method and the probabilistic roadmap method prm the rrt method and its extensions for path planning in dynamic environments have been extensively studied tahir et al 2018 however the drawbacks of the traditional rrt method such as disorderly randomness lack of smoothness and trapping by obstacles are obvious and nonnegligible thus rrt reselects the parent node and redefines the connection chao et al 2018 to ensure that it exhibits asymptotic optimality and its extensions generate feasible and smooth paths for the vehicle with kinodynamic constraints adiyatov and varol 2017 in addition numerous improvements in path planning have been achieved based on the rrt algorithms such as quick rrt jeonga et al 2019 potential functions and quick rrt pq rrt li et al 2020 and the rrt cache method yuan et al 2020 however the rrt method cannot provide global optimal solution jin and er 2020 recently the artificial neural network ann method has gained popularity which establishes a relationship between the input and output after adequate training of the model deep reinforcement learning methods are typically used for real time path planning or local path planning in addition the ann method can output control information such as acceleration deceleration and steering angle after adequate rounds of model training woo et al 2019 proposed a deep reinforcement learning based controller for tracking the path of usvs and chen et al 2019 proposed a path planning algorithm based on deep reinforcement learning although the ann method has an excellent performance it requires extensive training in advance in summary many previous studies have been conducted to solve the path planning problem for various types of requirements in dynamic environments however no dynamic path planning method considering the acceleration deceleration stopping actions of usvs before track following stage exists furthermore separating the control stage from the path planning stage may cause inefficiency and certain problems in real world applications particularly when dynamic obstacles block the channel or water alleyway within the path 2 3 automatic identification system ais numerous advanced studies based on ais data have previously been conducted for instance historical ais data used in applications such as a path generation system xu et al 2019 probabilistic trajectory prediction model song et al 2017 and trajectory reconstruction approach zhang et al 2018 have yielded excellent performance however few studies focused on using real time ais data for path planning therefore we used real time ais data for tracking the navigation states of neighbouring vessels and compensated for the distance limitations of the sensors real time ais data contains noise because their quality is dependent on the ais messaging system and navigational state of an individual vessel lapinski and isenor 2011 however local inaccuracy information is less influential with the reservation of a safety interval distance for gpp in large domains and long voyages although a combination of various approaches is accepted as an effective method for optimising the planned path the path planning stage and the controlling stage are still separated moreover the inclusion of certain actions pertaining to the controlling stage such as acceleration deceleration stopping in the path planning procedure remains a novel attempt to date thus the a vvgo method proposed in this study utilises ais data as global dynamic obstacle information and integrates velocity variation into path planning to accomplish multi objective optimisation 3 methods 3 1 modelling of static environment the static environment constitutes the primary region in path planning including the start point s s p target point s t p and static obstacles in this study the basic search map was a two dimensional grid map wherein the grids with obstacles were marked as 1 and the grid corresponding to free space was marked as 0 the obstacles were considered under an expansion operation to ensure that the path maintained a sufficient safety distance from the obstacles initially the grids with obstacles were marked as 1 fig 1 a in addition the grids partially occupied with obstacles were also marked as 1 fig 1 b furthermore all the grids with distances less than r 1 minimum safe distance from the obstacles were marked as 1 fig 1 c thereafter the expansion process ceased the smoothness of the path in the grid map was ensured by adopting the apf method for grids with distances less than r2 the second safest distance from the obstacles in the traditional apf model liu et al 2014 the repulsion field of the obstacles is expressed as follows 1 u x y 1 2 k 1 d 1 r 2 2 d r 2 0 d r 2 where x y are the current coordinates of the usv x 0 y 0 are the coordinates of the obstacles and d x x 0 2 y y 0 2 represents the distance between them k is a parameter affects the value of the repulsion in general as the distance between the grid and the obstacle decreases the risk of collision increases indicating a higher value of u x y however grids with a distance greater than r 2 from the obstacles do not entail an additional cost in addition the safety of usvs can be further ensured in this method by setting a default safety distance for the usv itself as depicted in fig 2 the usv can be simplified into a particle and a safety distance d s the safe length of usv can be set around the particle 3 2 modelling of dynamic environment for preparing for subsequent realisation of velocity variation a temporal dimension is added in the searching map during the dynamic environment modelling process so the motion of usvs and dynamic obstacles can be consideration together as depicted in fig 3 the x o y plane denotes the first grid map of the usv at the time of departure and the geometric normal z axis in the original binary grid map is expressed as the time axis each plane perpendicular to the time axis yellow layers in fig 3 represents a searching grid map at the corresponding time the process of modelling dynamic environment is as follows 1 the total time cost between initiation t 0 to arrival is assumed as t during which navigation information of dynamic obstacles such as current position s x t 0 s y t 0 speed v t and sailing direction α t are obtained based on real time ais data platform 2 the trajectory and motion of the dynamic obstacle are predicted at every interval of δt from t 0 the dynamic obstacle is moved straight at a constant speed to a corresponding position based on the known navigation information expressed as follows 2 s x t i s x t i 1 v t i 1 δ t cos α t i 1 s y t i s y t i 1 v t i 1 δ t sin α t i 1 t i t i 1 δ t 3 conclusively the dynamic modelling process ends once the dynamic obstacles exceed the navigation domain or the usv reaches the target point the position of the dynamic obstacle at any time t n can be expressed as follows 3 s x t n s x t 0 i 1 n v t i 1 δ t cos α t i 1 s y t n s y t 0 i 1 n v t i 1 δ t sin α t i 1 moreover the value of δ t can be altered based on the calculation resource and complexity of the environment although a smaller δ t results in a smoother and more precise path it requires a greater calculation time cost while a larger δ t produces contrasting results thus a three dimensional trajectory which describes both temporal and spatial information of the dynamic obstacle can be traced by connecting all the positions of the same dynamic obstacle on every plane 3 3 energy cost function of usv usvs differ in manoeuvrability and operational performance including acceleration deceleration steering performance and voyage ranges according to their types thus the operational performance should be assessed in advance to account for the energy cost of the usvs in the path planning stage therefore an evaluation function was established for assessing the operational performance of usvs as a unified quantification to determine the energy cost at high speed basic speed the specific range of high speed and basic speed differ among usvs and idling speed stopping at current position in the path planning stage as illustrated in fig 4 the evaluation function returned three values 1 e c b s energy cost for navigation at basic speed 2 e c h s energy cost for navigation at high speed 3 e c i energy cost at idling speed these three cost indices were determined from the operational performances of the usvs and were almost the same under different usage conditions however these indices for an individual usv can be measured experimentally and used as constant parameters in the algorithm 3 4 improvement of a algorithm 3 4 1 improvement of f n function the traditional a algorithm generates the shortest path by selecting each node that yields the minimum value of the f value f n g n h n in the iteration process the parameter n represents the node in grid map which is valid below in this study the e value e n g n h n replaces the f value as the objective function in the a vvgo algorithm in particular the e value represents the path length voyage time consumption and voyage energy consumption which are denoted by three functions l n t n and e c n respectively in addition g n and h n are subfunctions representing the linear superposition of l n t n and e c n where h n is the heuristic valuation function from the current node n to the target point expressed as follows 4 h n α l l n α t t n α e c e c n in the above equation l n x n s t p x 2 y n s t p y 2 represents the euclidean distance used to estimate the distance between the current node x n y n and the target point s t p x s t p y t n l n v b s denotes the time cost required for traveling from the current node to target location on a straight line at a constant basic speed which is used to estimate the time consumption for the remaining voyage to reach s t p similarly e c n l n v b s e c b s denotes the estimated energy cost for traveling from the current node to target point under the same conditions the three parameters α l α t and α e c in equation 4 represent the weight ratio of the path length time cost and energy consumption in heuristic function h n respectively in addition α l α t α e c 1 thus the proportion of these three parameters can be adjusted according to various task requirements for generating paths with a specific focus on path length time cost or energy cost the weight of the path length in the objective function is increased by increasing the value of α l thus ensuring a smaller total path length in the complete iteration process similarly the weight of the voyage time in the objective function is increased by increasing the value of α t such the high speed portion of the voyage in the entire path increases and the total voyage time decreases furthermore the weight of the energy consumption in the objective function increases with the increasing value of α e c thereby decreasing the total energy consumption of the entire path function g n determines the cost of traveling from the start point to the current node and comprises three functions l n t n and e c n which are similar to function h n and can be expressed as 5 g n α l l n α t t n α e c e c n where the values of α l α t and α e c in g n are identical to those in h n l n represents the path length from the start point to the current node t n represents the cumulative time consumption from the start point to the current node e c n represents the cumulative energy consumption from the start point to the current node the function e c n in equation 5 can be expressed as 6 e c n δ b s e c b s δ h s e c h s δ i e c i where δ b s δ h s and δ i represent the number of cumulative navigation actions at basic speed high speed and idling speed respectively from the start point to the current node with the minimum value of g n therefore the function e c n represents the cost of all the actions up to the current node thus a node with the smallest value of e value is selected as the path to the next node until the target is reached in each round of the iteration process 3 4 2 velocity variation in paths following the two above mentioned steps 3 1 and 3 2 a complete search grid map containing static obstacles and dynamic obstacles movement information was built based on this map three search directions with different interval lengths were set to realise the navigation at different speeds in the path therefore the high speed directions d hs representing the high speed state and the idling direction d i representing the idle state are required to be included with respect to the original basic directions d bs thus the navigation at high speed and idling period at the current position of the usvs can be represented in the path in the original a algorithm four or eight directions pertaining to the adjacent nodes of the current node were searched for instance assuming that the coordinates of the current node are 0 0 the set of search directions can be expressed as 7 d bs 0 1 0 1 1 0 1 0 1 1 1 1 1 1 1 1 the travelled distance of the usv calculated in unit time at a basic sailing speed s b s was set as the unit length of each grid in the plane map i e s b s 1 the advance distance per unit time at high speed state was set as s h s where s h s m s b s and m is a positive integer ensuring that the usv is still at the centre of a grid on the search map the high speed directions can be expressed as 8 d hs 0 s h s 0 s h s s h s 0 s h s 0 s h s s h s s h s s h s s h s s h s s h s s h s similarly the idling direction can be expressed as 9 d i 0 0 thus the new total search direction d t is 10 d t d bs d hs d i furthermore the pseudocode of this algorithm is presented in table 1 and the flowchart of the a vvgo algorithm is illustrated in fig 5 4 simulation and analysis 4 1 global path optimisation for long and narrow waterways to confirm the global optimisation ability of the proposed algorithm we constructed a map with a curved and narrow channel as depicted in fig 6 in this map the blue start point and the red end point are at the opposite ends of the narrow waterway the usv is marked in green and the bright green circle around the usv indicates the detectable range under its own radar or sensors as the usv enters the narrow channel a formation of five vessels in the middle of the channel sails gradually in a queue slowly however the radar cannot detect the environmental conditions in the latter section of the channel owing to the obstruction on both sides of the channel in a static environment the usv determines two route options to the target point 1 path a passing through the channel and 2 path b passing counter clockwise on the outside of the island path a is the best route choice based on the known static environment when no other obstacle is detected in the middle of the channel in practice most narrow waterways are categorised into two sailing directions to ensure that the usv cannot use the opposite side for overtaking the formation of slow vessels moreover the channel is too narrow for two ships to safely navigate side by side if the formation in the narrow channel constitutes high tonnage slow moving cargo ships that allow only limited space for small low displacement and manoeuvrable usvs the usv must decrease its speed along the back of the queue to navigate past the slow moving formation ahead however the maneuvrability advantage of usvs cannot be fully utilised and may even cause mission delay the simulation experimental setup of the discussed situation is presented herein a the plane map has a 100 100 square grid and the grid side length corresponds to an actual distance of approximately 72 6 m b the speed of the usv is 0 40 knots c the average speed of the cargo ship formation is 12 knots the simulation results are depicted in fig 7 where fig 7 a illustrates the search map in the computer post expansion and addition of apf and fig 7 b represents the path planning simulation of a usv based on its own sensors wherein the usv is forced to slow down when it reaches the middle of a narrow channel in addition the path planning simulation of a usv based on ais data is depicted in fig 7 c where the usv decides to steer outside of the narrow channel the average speed path length travel time and energy consumption of the two paths are presented in table 2 the experimental results revealed that when sailing in path a the usv travels at a high speed of about 300 s before encountering the dynamic obstacles when the radar detects the dynamic obstacles the usv is forced to sail behind the formation at a speed lower than that of the formation in contrast when sailing in path b the usv avoids the channel with the slow formation and its average speed in path b is 32 46 higher than that in path a whereas the time cost is 19 82 lower the approximately 10 longer length of path b than path a is compensated by the advantage in its time cost thus dynamic obstacle information on a long voyage can be obtained from ais data with which the usv can avoid busy channels and optimise global path selection for the entire voyage path planning with a different focus is described in the following section 4 2 path planning with a different focus the multi objective optimisation function proposed in this study was verified by considering the zhoushan port china as an example zhoushan port is an important port on the southern flank of the yangtze river economic belt and is one of the busiest ports in china in addition the port has a complete shore based ais that can receive ais information of the ships in the covered area and acquire the real time motion information of the ships as depicted in fig 8 a 4 3 precondition of experiment as depicted in fig 8 b paths a and b start from the yellow point and end at the red target point where a narrow water area is portrayed as a red circle in path a according to the methods presented in sections 3 1 and 3 2 the plane searching map with a 100 100 grid was constructed based on the panoramic map of the zhoushan port the plane searching map in the computer is depicted in fig 9 where the white area in fig 9 a denotes the free space and the black area represents static obstacles such as land and islands moreover fig 9 b depicts the results post the map expansion and fig 9 c illustrates the effect of the introduction of the apf furthermore in the simulation experiment a dynamic obstacle was set in the narrow water area which has been marked in the map to verify the path planning outcome under various weights as depicted in fig 10 a the dynamic obstacle travels at a constant speed in a straight path as the usv sails along path a and is about to pass through the narrow water area as planned the dynamic obstacle will obstruct the usv in the narrow water area as depicted in fig 10 b thus the usv cannot pass through the narrow waters at this instant owing to safety reasons the experimental setup representing this situation for computer simulation is presented herein a the plane map has 100 100 square grids and the grid side length corresponds to the actual distance of approximately 182 m b the highest speed of the usv is 40 knots and the basic speed is 15 knots c the speed of the dynamic obstacle is 6 65 knots d the energy consumption of the usv per unit distance at basic high and idling speed are e c b s 1 e c h s 1 45 and e c i 0 1 respectively a dynamic algorithm such as the d lite algorithm was used for planning the blue line i e the generated planned path bypasses the middle island because of the obstruction to reach the end point and this path is not optimal from the perspective of sailing distance as depicted in fig 11 the weight setting in the dynamic d lite algorithm and the three types of weight combinations for a vvgo are listed in table 3 as three solutions with a different focus 4 3 1 low energy consumption solution the low energy consumption solution simulates a task situation that is not urgent a higher weight was set for the energy consumption whereas a lower weight was set for the time cost the weight combination set in this case was α l 0 27 α t 0 03 α e c 0 7 the positions of the usv and dynamic obstacles during the voyage and the trajectory are depicted in fig 12 the simulation results show that the path length generated under a vvgo is shorter than that generated by the d lite algorithm without speed variation the improved algorithm enables the usv to wait for the dynamic obstacle to pass through the narrow channel and thereafter sail to the open water thus the usv can conveniently pass through the narrow channel and reach the target point with a lower energy consumption as this weight combination results in a higher cost at high speed navigation high speed action does not occur in this case in the entire path the usv only travelled at the basic speed or idled at the current position the final objective function value was at the minimum the following section details an instance of a usv avoiding obstacles and passing through a narrow channel through acceleration 4 3 2 low time consumption solution this solution simulates an urgent task situation there is a higher weight on the time cost and a lower weight on the energy consumption the weight combination set in the case is α l 0 49 α t 0 15 α e c 0 36 the positions of the usv and dynamic obstacles during the voyage and the trajectory are depicted in fig 13 the simulation results show that the usv encounters the dynamic obstacle at 712 9 s and avoids it from the right hand side before the narrow water area is blocked through a series of high speed actions in advance after avoiding the dynamic obstacles the usv sails at a basic speed to reach the target point with a total time cost of 2111 3 s in this case the weight of energy consumption is relatively small whereas that of time is relatively large therefore there are several instances of high speed actions in this path and the combination of high speed navigation and basic speed navigation yields the minimum value of the objective function under this parameter setting furthermore the calculation cost of high speed navigation can be reduced to that or even lower than that of sailing at the basic speed at a greater degree of emergency with higher weights on time cost more precisely the usv sails at high speed to reach the target point because the energy consumption is relatively reduced in comparison with the time cost 4 4 comprehensive benefit solution in case of a moderate degree of mission urgency or a relatively common case the optimal path should exhibit the lowest total time and energy consumptions and shortest path length the combination set of the weights in this case is α l 0 45 α t 0 05 and α e c 0 5 the positions of the usv and dynamic obstacles in the voyage and the trajectory are depicted in fig 14 the simulation results reveal that the usv can reach its target point by avoiding the dynamic obstacle through narrow waters in this path there are two periods of its stopping and idling at t 1334 8 s the dynamic obstacle passes through the narrowest water region after which a wide water area prevails in the channel the usv maintains adequate safe distance from both the dynamic and static obstacles with adequate circumnavigation space to avoid dynamic obstacles during t 1460 7 s and t 1662 2 s the usv avoids the dynamic obstacle on the right hand side at high speed achieving obstacle avoidance if the usv continues to wait at this instant t 705 2 s it would have had to wait until the dynamic obstacle completely navigates out of the narrow water region thus exceeding its time limit in addition the usv would not have been able to circumvent the dynamic obstacles at an adequately safe distance while traveling at the basic speed therefore the simulation results reveal the optimal path strategy under current weight settings the combination of stopping basic speed sailing and high speed sailing is the optimal strategy with minimum consumption of both time and energy thus reasonable parametric settings can be obtained to plan a path with all the three aspects optimised the results of the dynamic algorithm d lite and a vvgo with three parameters including the time consumption for basic and high speed navigation and stopping idling path length total time consumption and energy consumption are presented in table 4 5 conclusions we proposed an a vvgo algorithm for optimising the global navigation path of usvs based on the a algorithm in addition a temporal dimension was included along with velocity variation to consider the basic high and idle speed actions of usvs in the path planning stage to avoid dynamic obstacles thus planning paths with different emphases could be realised with the developed efficiency function furthermore global optimal path planning was realised based on the ais platform the simulation results revealed that real time ais data could predict and determine the trajectory of the dynamic obstacles present in the navigation domain for avoiding the congested narrow water area and optimise the overall path planning selection for the usv thereafter the generated path could focus on various factors i e energy efficiency quickness or economy and satisfy the different requirements of various practical tasks by varying the weight of length time and energy consumption in the algorithm the a vvgo algorithm demonstrated an application prospect in the autonomous navigation of usvs in busy navigation channels future studies can develop a collision probability model and the dynamic obstacles with low collision probability can be removed during the map modelling to accelerate the path search speed credit authorship contribution statement kai yu methodology validation writing original draft xiao feng liang conceptualization ming zhi li methodology writing review editing zhe chen supervision yan long yao software xin li data curation zi xiang zhao software yue teng supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by the cultivation of scientific research ability of young talents of shanghai jiao tong university grant no 19x100040072 and the key laboratory of marine intelligent equipment and system of ministry of education grant no mies 2020 07 
