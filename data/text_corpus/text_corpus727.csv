index,text
3635,crop evapotranspiration etc plays a fundamental role in agronomic and water resource management accurate forecasting of etc is a major challenge for agricultural researchers and experts based on the measured etc of the eddy covariance system and weather forecast data 1 15 d short and medium term in north china the real time short 1 7 d and medium 8 15 d term etc forecast models were developed by coupling with the dynamic crop coefficient and modifying the historical threshold the results demonstrated that compared with the single crop coefficient model recommended by the food and agricultural organization fao 56 m1 the m2 model a modification of the m1 model developed using the dynamic crop coefficient accurately forecasted the winter wheat and summer maize etc with an increased accuracy of 11 moreover the etc forecasting accuracy using the m2 model for short and medium term was over 77 of which the short term accuracy was higher greater than84 the etc forecasting accuracy increased with the decrease in the forecast period at different growth stages further the short and medium term accuracies of m3 model a modification of the m2 model developed by incorporating the historical threshold were over 81 of which the accuracy of the 1 d forecast period was approximately 95 which was 6 higher than that of the m2 model the root mean square error and the mean absolute error were reduced by 0 1 mm d 1 and 0 11 mm d 1 respectively thus these results indicated that the m3 model which was developed by integrating the dynamic crop coefficient and the historical empirical threshold can predict short and medium term etc more accurately keywords crop evapotranspiration forecasting dynamic crop coefficient historical threshold 1 introduction crop evapotranspiration etc a component of the terrestrial hydrological cycle plays a crucial role in linking energy and water balances pereira and pruitt 2004 gao et al 2016 qiu et al 2019 wang et al 2015 wang et al 2017 accurate etc forecasting is important for assessing agricultural water demand driving hydrological and crop simulation models and decision making for promoting efficient agricultural water management medina et al 2018 rana and katerji 2000 berengena and gavilán 2005 forecasting the irrigation requirements of a well watered agricultural crop represented as etc initially involves forecasting of reference evapotranspiration et0 from a standard surface and subsequently applying an appropriate empirical crop coefficient kc allen et al 1998 medina et al 2018 alexandris and kerkides 2003 paredes et al 2017 phogat et al 2016 taylor et al 2015 marin et al 2019 therefore the etc forecast strongly relies on the accurate forecasting of et0 and kc liu et al 2020 depending on the input data and the applied methods used et0 can be forecasted through the direct and indirect methods the direct methods include the commonly used procedures such as time series model mariño et al 1993 xu et al 2012 zhang et al 2015 and artificial computation kashyap and panda 2001 chi et al 2011 to forecast et0 based on the historical and future weather data the time series model a statistical analysis method requires extensive data of several years and it can directly use the past trends of changes to predict future changes cheng et al 2008 in contrast the artificial computation can appropriately simulate and address systems with multiple influencing factors and complex relationships gorka et al 2008 zhao et al 2009 because a single data type is used for the time series model for example only historical data for evapotranspiration the forecast accuracy of this model can be uncertain moreover artificial computation uses a dynamic data training system which requires a large amount of data in the early stage and is thus not suitable for short term forecasts as for indirect methods future weather variables are forecasted and used in empirical or analytical models with the improvement in weather forecast accuracy public weather forecast data serve as an important data source increasingly applied to estimate et0 common estimation methods for et0 include the penman monteith pm allen et al 1998 mccloud mc and hargreaves samani h s models the pm model which was first presented by allen et al 1998 has been accepted universally for estimations of hourly and daily et0 the mc model was originally used to estimate the et0 of lawns by mccloud 1995 who considered the et0 as an exponential function of temperature maximum and minimum temperatures the h s model was proposed by hargreaves and allen 2003 using the data of arid areas in northwest united states wherein the model required only the maximum temperature and the minimum temperature to calculate et0 however different estimation formulas and input data reliabilities existing in real world conditions may create potential uncertainties in the forecasting of future et0 changes wang et al 2015 although the pm model shows high accuracy it requires extensive meteorological data allen et al 1998 the mc model can determine et0 only when the weather forecast accuracy is over 90 trajkovic 2005 the h s model has been widely used because of its low complexity few input factors only maximum and minimum temperatures and high forecast accuracy liu et al 2015 martı nez cob and tejero juste 2004 modified the h s model to include the influence of wind speed in the ebro river valley consequently the model forecast accuracy was improved r2 0 9 furthermore patel et al 2014 improved the h s model for its application in different regions of india subsequently the average absolute error between the improved model and the pm model was reduced from 1 03 to 2 91 mm d 1 to 0 32 1 03 mm d 1 in addition bautista et al 2009 revised the constant term 0 0023 in the h s model for the yucatan region of mexico and the weihe river basin in china consequently the r 2 values of the fitted equation for the revised model and the pm model were 0 90 and 0 94 respectively crop and external conditions constantly change the kc value but the overall change remains stable during the entire crop growth period alberto et al 2014 the kc value is not only associated with specific crop types but is also affected by regional and temporal differences in the same crop overall the crop type soil water content fertilization and field management practices influence etc marin et al 2019 jiang et al 2014 anda et al 2014 the kc value used for forecasting etc is recommended by the fao 56 which isa constant or is calculated using linear interpolation although the value recommended by fao 56 can be adjusted according to local environmental and climatic conditions kc can calculate land surface etc including vegetation transpiration and soil evaporation and is suitable for calculations with long durations allen et al 1998 thus it cannot reflect the daily dynamic changes in crop patterns the forecasted value and measured value differ marginally during the short and medium term etc forecast peng et al 2007 shahrokhnia and sepaskhah 2012 used the single crop coefficient method to forecast corn etc with r 2 and consistency index values of 0 52 and 0 48 respectively therefore considering the effect of crop growth stage on the dynamic change in kc is necessary further the historical threshold which can avoid extreme deviation and low stability of forecasts should be used for forecasting however despite its significance the historical threshold is not used extensively in forecast models yoder et al 2005 tong et al 2016 therefore this study aimed to determine the real time methods for short and medium term etc forecasting using dynamic crop coefficient and historical threshold the specific objectives of this study were 1 to develop the dynamic crop coefficient based on a new calculation method using daily kc values and 2 to further develop real time prediction models through historical threshold modifications in different prediction periods that can provide a scientific basis for water resource management 2 materials and methods 2 1 site description this study was conducted at the experimental station of the national center of efficient irrigation engineering and technology research beijing 39 39 n 116 15 e 40 1 m a s l it is located on the floodplain of the yongding river in the northern part of the north china plain fig 1 the region experiences warm and sub humid continental monsoon climate with an annual mean temperature of 11 6 c and an annual mean precipitation of 556 mm of which over 70 occurs during july september han et al 2021 wang et al 2019 winter wheat and summer maize are the principal crops in this region the growth period of the winter wheat is approximately 260 d october 1 june 30 and the crop requires supplementary irrigation to meet its water requirements approximately 300 mm during the entire growth period the growth period of summer maize is approximately 90 d july 1 september 30 and the crop does not require external irrigation during the growth period the crops in this study site experience no stress during their growing stages the particle size distribution texture bulk density and field capacity are presented in table 1 wang et al 2014 2 2 data sources 2 2 1 meteorological data historical meteorological data including atmospheric pressure pa wind speed u maximum air temperature tmax minimum air temperature tmin average relative humidity rh sunshine hours n and precipitation p from 2018 to 2019 were collected from the china meteorological science sharing service network http cdc cma gov cn further daily weather forecast data including tmax tmin u and weather type from 2018 to 2019 were obtained from the weather network http www tianqi com 2 2 2 measured evapotranspiration etc was measured using the eddy covariance system ec and was calculated using eq 1 1 e t c w q where w is the pulse momentum of vertical wind speed m s 1 and q is the fluctuation in water vapor density g m 3 the ec system campbell scientific inc logan ut usa comprises a three dimensional ultrasonic anemometer hmp45c air temperature humidity sensor and cr5000 data logger the average value of all meteorological variables for a 30 min interval was recorded and the daily average etc value was subsequently calculated using the acquired data for a 24 h period during ec data processing skewed data for example 1 data for precipitation periods including 1 h before and after the rainfall event 2 data exceeding physically unreasonable extremes and 3 data resulting from sensor failure or malfunction were eliminated griffis et al 2010 2 3 methods 2 3 1 etc forecasting model based on single crop coefficient recommended by fao 56 m1 model the m1 model was calculated using eq 2 2 e t c k c f a o 56 e t 0 h s where e t c is the evapotranspiration forecast based on m1 k c f a o 56 is the crop coefficient recommended by fao 56 and e t 0 h s is the forecasted et0 using the h s model hargreaves et al 2004 gavilán et al 2006 1 kc fao 56 based on the standard conditions recommended for fao 56 sufficient water supply good growth and good crop management practices the crop coefficients for winter wheat growth stages were kcini tab 0 7 initial stage kcmid tab 1 15 middle stage and kcend tab 0 25 late stage whereas those for summer maize were kcini tab 0 45 initial stage kcmid tab 1 2 middle stage and kcend tab 0 5 late stage respectively fao 56 manual linear interpolation was used to calculate kc between the initial and middle stages and between the middle and late stages if the average daily minimum rh rhmin was over 45 and the average u2 was over 2 m s 1 the kcmid tab and kcend tab values for winter wheat and summer maize can be adjusted according to the local climatic conditions and plant height as shown in eq 3 odhiambo and irmak 2012 allen et al 1998 3 k c f a o 56 k c t a b 0 04 u 2 2 0 004 r h min 45 h 3 0 3 where h is the average plant height of the crop at the middle or late stages 2 e t 0 h s the e t 0 h s model was calculated using eq 4 4 e t 0 h s 0 408 k t max t min n t mean t off r a where e t 0 h s is the forecasted et0 mm d 1 based on the h s model k is the conversion coefficient with a recommended value of 0 0023 n is the index coefficient with a recommended value of 0 5 toff is the temperature offset with a recommended value of 17 8 c and ra is the extraterrestrial radiation mj m 2 d 1 luo et al 2014 considering the daily tmax tmin and extraterrestrial radiation of the atmosphere as independent variables the daily et0 was calculated as the dependent variable using the pm equation and the original parameters of the h s model k 0 0023 n 0 5 and toff 17 8 c were calculated as initial values after which a nonlinear regression analysis of the h s model was conducted trajkovic 2005 the optimal parameters for the model k 0 001138 n 0 4925 and toff 23 33 c were calculated using the program solution of microsoft excel and through pattern search the mean absolute error mae and root mean square error rmse of the optimized h s model during the validation period 2014 2017 were closer to zero than those of the pm model therefore the modified h s model was applied to forecast et0 luo et al 2016 ravazzani et al 2012 2 3 2 etc forecasting model based on a modification of the m1 model considering dynamic crop coefficient m2 model the m2 model was calculated using eq 5 5 e t c k c var e t 0 h s where e t c is the forecasted etc considering the dynamic changes in the crop coefficient e t 0 h s is the forecasted et0 using the h s model eq 4 and k c var is the dynamic crop coefficient to calculate et0 on base date the pm allen et al 1998 allen et al 2005a b asce model was applied according to eq 6 the ec system was used to determine etc on the base date whereas the single crop coefficient method was used to calculate kc on the base date 6 e t 0 p m 0 408 δ r n g γ 900 t mean 273 u 2 e s e a δ γ 1 0 34 u 2 where e t 0 p m is the et0 mm d 1 δ is the slope of the saturated vapor pressure curve r n is the surface net radiation g is the soil heat flux mj m 2 d 1 γ is the dry and wet constant t mean is the daily average temperature and e s and e a are the saturated and actual vapor pressure kpa respectively the kc on the base date was calculated using eq 7 10 7 k c 0 e t c e c 0 e t 0 p m 0 8 k c 1 e t c e c 1 e t 0 p m 1 9 k c 2 e t c e c 2 e t 0 p m 2 10 k c i e t c e c i e t 0 p m i where after substituting the obtained values of kc0 kc1 kc2 kci in eq 7 10 we obtained e t c for different forecast periods 1 15 d table 2 2 3 3 etc forecasting model based on a modification of the m2 model considering the historical threshold m3 model the m3 model was calculated using eq 11 11 e t c e t c e t c min 2 e t c e t c e t c max 2 e t c e t c min e t c min e t c e t c max e t c max e t c where e t c min and e t c max are the minimum and maximum values measured using ec from 2013 to 2017 respectively 2 4 evaluation index the error mae rmse r2 index of agreement dia and accuracy acc were used to evaluate the forecast accuracy of models the calculation formulas of these parameters are given in eq 12 15 bennett et al 2015 zhang et al 2016 12 error x i y i y i 13 mae i 1 n x i y i n 14 rmse i 1 n x i y i 2 n 15 d ia 1 i 1 n y i x i 2 i 1 n x i y y i y 2 where x i is the predicted value of etc y i is the etc measured by ec x and y are the means of the forecast and measured values respectively and n is the sample number of the forecast value the dia value ranges from 0 to 1 0 with 1 0 representing a perfect fit of the data acc refers to the percentage of days in which the etc forecast error is within 1 5 mm d 1 of the total days liu et al 2015 3 results and discussion 3 1 etc forecast with considering the dynamic change in kc application of the m2 model the dynamic crop coefficient in the 1 d forecast period k c var 1 was consistent with the k c f a o 56 recommended by fao 56 during the winter wheat and summer maize growth periods fig 2 the kc initially increased and later decreased as the growth stage progressed with a maximum value observed in the middle growth stage from the heading to the filling stage which coincided with the peak of crop water demand the significant seasonal changes in etc of winter wheat and summer maize crops for the given forecast period 1 d during 2018 2019 are shown in figs 3 and 4 minimum etc was observed at the early growth stage during which most cultivated land was bare and etc was predominantly derived from soil evaporation maximum etc was observed at the middle growth stage whereas the etc decreased at the mature stage jiang et al 2016 the forecasted values obtained by the m1 and m2 models were consistent with the measured values a good agreement between the forecasted values of the m1 and m2 models and the measured values was observed at low etc values less than or equal to 4 mm d 1 whereas less agreement with large differences between the m1 and m2 forecasted values and the measured values was observed as the etc value decreased fig 4 and table 3 the rmse values of etc and etc were 1 30 mm d 1 and 1 02 mm d 1 respectively whereas the mae values were 0 67 mm d 1 and 0 61 mm d 1 respectively the acc values of m1 and m2 models were 81 and 90 respectively however at high etc values more than 4 mm d 1 a poor fit was observed between the forecasted values of the m1 and m2 models and the measured values and the rmse values of etc and etc were 1 83 mm d 1 and 1 32 mm d 1 respectively whereas the mae values were 1 68 mm d 1 and 1 22 mm d 1 respectively additionally the accuracies of m1 and m2 were 68 and 80 respectively based on the overall change in the sample table 3 fig 4 we estimated the regression line slopes for the m1 and m2 models as 0 87 and 0 85 respectively whereas the r2 values were 0 59 and 0 72 respectively further the acc value of the m2 model 89 was higher than the m1 model 78 regarding short and medium term etc forecasting the m2 model was more accurate than the m1 model during the entire crop rotation period of both winter wheat and summer maize kc ranged from 0 3 to 1 5 during the reproductive growth stage the leaf area index increased gradually surface coverage changed from sparse to dense and etc changed from soil evaporation to transpiration during this stage the spatiotemporal distribution of etc was more complex which further reduced the model forecast accuracy however the dynamic changes in etc can reflect the response of the etc to the dynamic changes in crop growth stage improving the forecast accuracy 3 2 etc forecast for different forecast periods based on the m1 and m2 models using the daily 1 15 d weather forecast data from march 1 to september 30 winter wheat and summer maize in 2018 and 2019 respectively the m1 and m2 models were used to forecast etc for different periods 1 3 6 9 and 14 d the resultant etc forecast values of the selected study periods were consistent with the measured values fig 5 the dia between the forecasted values and measured values decreased with the increase in the forecast period further a good and a poor agreement were observed for the 1 d and the 14 d forecast periods the acc of the m1 model during different prediction periods decreased with the increase in the prediction period whereas the rmse and mae ranged from 1 74 to 1 87 mm d 1 and 1 24 to 1 35 mm d 1 respectively additionally the acc of 1 14 d period ranged from 66 to 78 further the etc forecasting accuracy of the m2 model during the different forecast periods was higher than that of the m1 model table 4 the rmse and mae ranged from 1 54 to 1 61 mm d 1 and 0 85 to 1 14 mm d 1 respectively and the deviations of the mean value were 1 3 4 6 and 7 for the 1 3 6 9 and 14 d forecast periods respectively the acc for 1 6 d were over 84 whereas those for 9d and 14d were 79 and 77 respectively therefore the applicability of the models was superior for the 1 7d forecast period because the m2 model considered the dynamic growth of crops the accuracy of the forecasted etc was higher than that of the fao 56 recommended crop coefficient model in addition the improvement in the model accuracy varied during different crop growth stages moreover the maximum and minimum temperature of different crops in different seasons can differ substantially therefore the accuracy of the m2 model at different growth stages of winter wheat and summer maize was evaluated further table 5 during the early growth stage of winter wheat kc ranged from 0 11 to 0 83 and the measured etc was approximately 0 91 mm d 1 table 5 for the 1d forecast period the error and rmse were 4 and 0 42 mm d 1 respectively and the acc value was 93 which was higher than the accuracy during the entire growth period fig 6 a consideration of the slight variation in kc from the seedling to tillering stages did not have considerable influence on the acc of etc during the middle growth stage of winter wheat kc ranged from 0 46 to 1 29 and the measured etc was approximately 3 78 mm d 1 the error and rmse were 22 and 1 60 mm d 1 respectively and the acc was 75 which was lower than that of the early growth stage moreover during the late growth stage of winter wheat kc ranged from 0 78 to1 43 measured etc was approximately 2 21 mm d 1 error and rmse were 3 and 1 25 mm d 1 respectively and the acc was 79 the results indicated that at different growth stages of winter wheat the acc decreased with the increasing range gap of kc progression of the crop growth stage and the increase in the forecast period fig 6a in contrast the rmse and error increased as the crop growth stage progressed and the forecast periods were extended during the early growth period of summer maize fig 6 b kc ranged from 0 23 to 0 95 and the measured etc was approximately 2 60 mm d 1 the error and rmse were 6 and 1 16 mm d 1 respectively for the 1d forecast period and the acc was 77 which was lower than the accuracy for the observed during the entire growth period during the middle growth stage of summer maize kc ranged from 0 57 to 1 51 the measured etc was approximately 3 87 mm d 1 the error and rmse were 15 and 1 21 mm d 1 respectively and the acc was 75 moreover during the late growth stage of summer maize kc ranged from 0 51 to 1 41 the measured etc was approximately 2 81 mm d 1 the error and rmse were 24 and 1 18 mm d 1 respectively and the acc was 85 there was an inherent uncertainty in the model forecasts for the middle growth stage of summer maize because of precipitation this model showed good applicability for the late growth stages of summer maize 3 3 modification of the m3 model by incorporating the history threshold the measured values for 2013 2017 were used to modify the m2 model to forecast etc for 2018 2019 the applicability of the model was evaluated by comparing the forecasted values of the m2 model and the measured values the evaluation indicators are shown in fig 7 and table 6 as shown in fig 7 absolute error ae before and after threshold correction varied during different forecast periods further in the etc dataset n 428 the values of 80 87 95 101 and 107 datasets exceeded the historical threshold during different forecast periods probably due to extreme weather the prediction of the dynamic changes of etc was more accurate by the m3 model than the etc values measured by ec compared with the m2 model the mean forecast error of the m3 model was reduced by 0 23 11 during different prediction periods and the rmse and mae were reduced from 0 01 to 0 07 mm d 1 and 0 08 to 0 12 mm d 1 respectively however the accuracy during different prediction periods was improved by 2 6 further prediction accuracy values were higher than 80 and 86 within the 15 d and 7 d forecast periods whereas the highest prediction accuracy 95 was presented in the 1 d forecast period the m3 model which was acquired by modifying the m2 model through empirical data obtained from crop growth history reduced the forecasted etc error under extreme climate and thus improved the forecast accuracy and model applicability 4 discussion etc is computed or modeled using weather data and algorithms that describe the aerodynamic characteristics of the vegetation and surface energy driven etc pereira et al 2021 we forecasted kc and et0 based on the fao 56 method using the kc et0 approach where etc is the product of kc and et0 allen et al 1998 fao 56 described the temporal variation of kc using a segmented crop coefficient curve and can be applied to both single time averaged kc and the basal kcb however the kc derived from fao 56 only reflected the crop variety and not the regional changes in the crop therefore fao 56 recommends different kc values for different crops based on various field experiments conducted worldwide the recommended values can facilitate irrigation and crop management hunsaker et al 2005 tian et al 2016 as kc varies with the crop type climate irrigation method and other management factors using the same kc values in different places and for different irrigation methods may induce significant uncertainties kang et al 2003 suleiman et al 2007 accordingly the fao 56 recommended kc may not be applicable to all regions therefore kc should be estimated according to local standards that can guide specific regional irrigation practices allen et al 2005a b allen et al 2011 ding et al 2015 yang et al 2016 therefore the dynamic crop coefficient method proposed in this study has significant applications for the accurate prediction of evapotranspiration the dynamic crop coefficient method we developed was based on a new calculation method of daily kc which was used to develop the m2 model for more accurate prediction of etc and for large scale application in different areas wang et al 2015 considered daily regional crop coefficient as an optimization factor for etc prediction model seidel et al 2019 developed a simulation based approach to estimate site specific dynamically continuous kc curves by considering the influence of climate variability soil and sowing date zhao et al 2021 dynamically modified the crop coefficient under film mulching during the overall maize growing season therefore compared with the kc value recommended by fao 56 a modified dynamic crop coefficient has larger practical significance and scientific reliability we observed local historical etc data from the ec system which provided the evidence for modifying the predicted etc value which was beyond the historical threshold range and obtained from the m2 model the historical data generally provides an important reference for understanding the present and future performance of models liu et al 2021 investigated historical water consumption minimum and maximum daily temperatures humidity visibility air pressure wind speed precipitation moisture solar radiation and other meteorological conditions to forecast future indicators bedi and toshniwal 2019 developed ai based methods using historical data to predict future water demands hanifi et al 2020 determined time series models and used previous historical data as training data for forecasting moreover solyali 2020 used machine learning to model complicated nonlinear connections through a learning process containing historical data patterns sabzipour et al 2021 evaluated the potential of using historical meteorological data subsets for ensemble stream flow prediction esp forecasting koutsoyiannis et al 2008 used an analog method in a trial and error procedure to determine the optimum length of the backward looking predictor period and the number of historical traces used in the ensemble similarly svensson 2016 proposed river flow forecasting methods using hydrological persistence and historical analogs and found that the analog method performed better for longer lead times the analog method that used historical data was a potential benchmarking method for further studies svensson 2016 in our study by including the historical threshold of etc m3 the dynamic crop coefficient model m2 was modified resulting in an increase in the prediction accuracy by 3 6 however modeling of historical threshold modifications is still underdeveloped for etc prediction as the existing methods are more useful for managing short and medium term forecasts thus improvement of the historical threshold modification method under extreme weather should be studied further in this study we focused on the short and medium term forecasting of etc notably the long term etc forecasting is required to assess temporal variability and long term trends regarding climate feedback mechanisms feng et al 2017 and reduce the negative effects of excess irrigation water on crop production pôças et al 2015 for example elbeltagi et al 2020 modeled long term dynamics of crop evapotranspiration using deep learning in a semi arid environment for long term etc forecasting but failed to achieve high prediction accuracy due to the low accuracy of long term forecasting in this study we studied only short and medium term forecasts the acc values of the m3 model under the prediction periods of 1 3 6 9 and 14 d were 95 91 86 83 and 81 respectively in addition the short and medium term etc forecasting in this study is limited to point scale which can be extended to regional scales using remote sensing data this aspect can be achieved in future work 5 conclusions this study successfully developed real time methods for short and medium term etc forecasting using dynamic crop coefficient and relevant historical thresholds the following three primary conclusions were derived 1 kc is a crucial factor that influences the accurate forecasting of etc the dynamic kc model can accurately forecast etc over the entire growth period of winter wheat and summer maize compared with the fao 56 recommended crop coefficient model accuracy was increased by 12 rmse and mae were decreased from 1 74 mm d 1 and 1 24 mm d 1 to 1 54 mm d 1 and 0 85 mm d 1 respectively in addition the model accurately reflected the local responses of winter wheat and summer maize to the crop coefficient 2 the prediction accuracy of the m2 model during different prediction periods was higher than the m1 model the error between forecasted and measured etc values for winter wheat and summer maize during different forecast periods for the m2 model was smaller than m1 model and the accuracy for 1 7d forecast periods was over 84 however during different crop growth stages the accuracy decreased as the forecast period extended and crop coefficient increased 3 by including the historical threshold of crop growth the forecast accuracy of the m2 model evidently improved in the m3 model the rmse and mae decreased from 1 54 mm d 1 and 0 85 mm d 1 to 1 47 mm d 1 and 0 74 mm d 1 in 1d forecast period respectively whereas dla and acc increased from 0 83 and 89 to 0 89 and 95 respectively thus short and medium term forecasting of etc in crop production can be successfully achieved using the modified m3 model credit authorship contribution statement xin han conceptualization methodology formal analysis qingyun zhou methodology formal analysis funding acquisition baozhong zhang conceptualization writing review editing funding acquisition zheng che methodology formal analysis writing review editing zheng wei methodology writing review editing rangjian qiu methodology writing review editing he chen methodology writing review editing yinong li writing review editing taisheng du writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we gratefully acknowledge the financial support from the national natural science foundation of china no 51822907 52130906 51979287 and 51609170 the fund of china institute of water resources and hydropower research no id0145b022021 and id0145b052021 and the fund of state key laboratory of simulation and regulation of water cycle in river basin china institute of water resources and hydropower research no skl2020ts08 
3635,crop evapotranspiration etc plays a fundamental role in agronomic and water resource management accurate forecasting of etc is a major challenge for agricultural researchers and experts based on the measured etc of the eddy covariance system and weather forecast data 1 15 d short and medium term in north china the real time short 1 7 d and medium 8 15 d term etc forecast models were developed by coupling with the dynamic crop coefficient and modifying the historical threshold the results demonstrated that compared with the single crop coefficient model recommended by the food and agricultural organization fao 56 m1 the m2 model a modification of the m1 model developed using the dynamic crop coefficient accurately forecasted the winter wheat and summer maize etc with an increased accuracy of 11 moreover the etc forecasting accuracy using the m2 model for short and medium term was over 77 of which the short term accuracy was higher greater than84 the etc forecasting accuracy increased with the decrease in the forecast period at different growth stages further the short and medium term accuracies of m3 model a modification of the m2 model developed by incorporating the historical threshold were over 81 of which the accuracy of the 1 d forecast period was approximately 95 which was 6 higher than that of the m2 model the root mean square error and the mean absolute error were reduced by 0 1 mm d 1 and 0 11 mm d 1 respectively thus these results indicated that the m3 model which was developed by integrating the dynamic crop coefficient and the historical empirical threshold can predict short and medium term etc more accurately keywords crop evapotranspiration forecasting dynamic crop coefficient historical threshold 1 introduction crop evapotranspiration etc a component of the terrestrial hydrological cycle plays a crucial role in linking energy and water balances pereira and pruitt 2004 gao et al 2016 qiu et al 2019 wang et al 2015 wang et al 2017 accurate etc forecasting is important for assessing agricultural water demand driving hydrological and crop simulation models and decision making for promoting efficient agricultural water management medina et al 2018 rana and katerji 2000 berengena and gavilán 2005 forecasting the irrigation requirements of a well watered agricultural crop represented as etc initially involves forecasting of reference evapotranspiration et0 from a standard surface and subsequently applying an appropriate empirical crop coefficient kc allen et al 1998 medina et al 2018 alexandris and kerkides 2003 paredes et al 2017 phogat et al 2016 taylor et al 2015 marin et al 2019 therefore the etc forecast strongly relies on the accurate forecasting of et0 and kc liu et al 2020 depending on the input data and the applied methods used et0 can be forecasted through the direct and indirect methods the direct methods include the commonly used procedures such as time series model mariño et al 1993 xu et al 2012 zhang et al 2015 and artificial computation kashyap and panda 2001 chi et al 2011 to forecast et0 based on the historical and future weather data the time series model a statistical analysis method requires extensive data of several years and it can directly use the past trends of changes to predict future changes cheng et al 2008 in contrast the artificial computation can appropriately simulate and address systems with multiple influencing factors and complex relationships gorka et al 2008 zhao et al 2009 because a single data type is used for the time series model for example only historical data for evapotranspiration the forecast accuracy of this model can be uncertain moreover artificial computation uses a dynamic data training system which requires a large amount of data in the early stage and is thus not suitable for short term forecasts as for indirect methods future weather variables are forecasted and used in empirical or analytical models with the improvement in weather forecast accuracy public weather forecast data serve as an important data source increasingly applied to estimate et0 common estimation methods for et0 include the penman monteith pm allen et al 1998 mccloud mc and hargreaves samani h s models the pm model which was first presented by allen et al 1998 has been accepted universally for estimations of hourly and daily et0 the mc model was originally used to estimate the et0 of lawns by mccloud 1995 who considered the et0 as an exponential function of temperature maximum and minimum temperatures the h s model was proposed by hargreaves and allen 2003 using the data of arid areas in northwest united states wherein the model required only the maximum temperature and the minimum temperature to calculate et0 however different estimation formulas and input data reliabilities existing in real world conditions may create potential uncertainties in the forecasting of future et0 changes wang et al 2015 although the pm model shows high accuracy it requires extensive meteorological data allen et al 1998 the mc model can determine et0 only when the weather forecast accuracy is over 90 trajkovic 2005 the h s model has been widely used because of its low complexity few input factors only maximum and minimum temperatures and high forecast accuracy liu et al 2015 martı nez cob and tejero juste 2004 modified the h s model to include the influence of wind speed in the ebro river valley consequently the model forecast accuracy was improved r2 0 9 furthermore patel et al 2014 improved the h s model for its application in different regions of india subsequently the average absolute error between the improved model and the pm model was reduced from 1 03 to 2 91 mm d 1 to 0 32 1 03 mm d 1 in addition bautista et al 2009 revised the constant term 0 0023 in the h s model for the yucatan region of mexico and the weihe river basin in china consequently the r 2 values of the fitted equation for the revised model and the pm model were 0 90 and 0 94 respectively crop and external conditions constantly change the kc value but the overall change remains stable during the entire crop growth period alberto et al 2014 the kc value is not only associated with specific crop types but is also affected by regional and temporal differences in the same crop overall the crop type soil water content fertilization and field management practices influence etc marin et al 2019 jiang et al 2014 anda et al 2014 the kc value used for forecasting etc is recommended by the fao 56 which isa constant or is calculated using linear interpolation although the value recommended by fao 56 can be adjusted according to local environmental and climatic conditions kc can calculate land surface etc including vegetation transpiration and soil evaporation and is suitable for calculations with long durations allen et al 1998 thus it cannot reflect the daily dynamic changes in crop patterns the forecasted value and measured value differ marginally during the short and medium term etc forecast peng et al 2007 shahrokhnia and sepaskhah 2012 used the single crop coefficient method to forecast corn etc with r 2 and consistency index values of 0 52 and 0 48 respectively therefore considering the effect of crop growth stage on the dynamic change in kc is necessary further the historical threshold which can avoid extreme deviation and low stability of forecasts should be used for forecasting however despite its significance the historical threshold is not used extensively in forecast models yoder et al 2005 tong et al 2016 therefore this study aimed to determine the real time methods for short and medium term etc forecasting using dynamic crop coefficient and historical threshold the specific objectives of this study were 1 to develop the dynamic crop coefficient based on a new calculation method using daily kc values and 2 to further develop real time prediction models through historical threshold modifications in different prediction periods that can provide a scientific basis for water resource management 2 materials and methods 2 1 site description this study was conducted at the experimental station of the national center of efficient irrigation engineering and technology research beijing 39 39 n 116 15 e 40 1 m a s l it is located on the floodplain of the yongding river in the northern part of the north china plain fig 1 the region experiences warm and sub humid continental monsoon climate with an annual mean temperature of 11 6 c and an annual mean precipitation of 556 mm of which over 70 occurs during july september han et al 2021 wang et al 2019 winter wheat and summer maize are the principal crops in this region the growth period of the winter wheat is approximately 260 d october 1 june 30 and the crop requires supplementary irrigation to meet its water requirements approximately 300 mm during the entire growth period the growth period of summer maize is approximately 90 d july 1 september 30 and the crop does not require external irrigation during the growth period the crops in this study site experience no stress during their growing stages the particle size distribution texture bulk density and field capacity are presented in table 1 wang et al 2014 2 2 data sources 2 2 1 meteorological data historical meteorological data including atmospheric pressure pa wind speed u maximum air temperature tmax minimum air temperature tmin average relative humidity rh sunshine hours n and precipitation p from 2018 to 2019 were collected from the china meteorological science sharing service network http cdc cma gov cn further daily weather forecast data including tmax tmin u and weather type from 2018 to 2019 were obtained from the weather network http www tianqi com 2 2 2 measured evapotranspiration etc was measured using the eddy covariance system ec and was calculated using eq 1 1 e t c w q where w is the pulse momentum of vertical wind speed m s 1 and q is the fluctuation in water vapor density g m 3 the ec system campbell scientific inc logan ut usa comprises a three dimensional ultrasonic anemometer hmp45c air temperature humidity sensor and cr5000 data logger the average value of all meteorological variables for a 30 min interval was recorded and the daily average etc value was subsequently calculated using the acquired data for a 24 h period during ec data processing skewed data for example 1 data for precipitation periods including 1 h before and after the rainfall event 2 data exceeding physically unreasonable extremes and 3 data resulting from sensor failure or malfunction were eliminated griffis et al 2010 2 3 methods 2 3 1 etc forecasting model based on single crop coefficient recommended by fao 56 m1 model the m1 model was calculated using eq 2 2 e t c k c f a o 56 e t 0 h s where e t c is the evapotranspiration forecast based on m1 k c f a o 56 is the crop coefficient recommended by fao 56 and e t 0 h s is the forecasted et0 using the h s model hargreaves et al 2004 gavilán et al 2006 1 kc fao 56 based on the standard conditions recommended for fao 56 sufficient water supply good growth and good crop management practices the crop coefficients for winter wheat growth stages were kcini tab 0 7 initial stage kcmid tab 1 15 middle stage and kcend tab 0 25 late stage whereas those for summer maize were kcini tab 0 45 initial stage kcmid tab 1 2 middle stage and kcend tab 0 5 late stage respectively fao 56 manual linear interpolation was used to calculate kc between the initial and middle stages and between the middle and late stages if the average daily minimum rh rhmin was over 45 and the average u2 was over 2 m s 1 the kcmid tab and kcend tab values for winter wheat and summer maize can be adjusted according to the local climatic conditions and plant height as shown in eq 3 odhiambo and irmak 2012 allen et al 1998 3 k c f a o 56 k c t a b 0 04 u 2 2 0 004 r h min 45 h 3 0 3 where h is the average plant height of the crop at the middle or late stages 2 e t 0 h s the e t 0 h s model was calculated using eq 4 4 e t 0 h s 0 408 k t max t min n t mean t off r a where e t 0 h s is the forecasted et0 mm d 1 based on the h s model k is the conversion coefficient with a recommended value of 0 0023 n is the index coefficient with a recommended value of 0 5 toff is the temperature offset with a recommended value of 17 8 c and ra is the extraterrestrial radiation mj m 2 d 1 luo et al 2014 considering the daily tmax tmin and extraterrestrial radiation of the atmosphere as independent variables the daily et0 was calculated as the dependent variable using the pm equation and the original parameters of the h s model k 0 0023 n 0 5 and toff 17 8 c were calculated as initial values after which a nonlinear regression analysis of the h s model was conducted trajkovic 2005 the optimal parameters for the model k 0 001138 n 0 4925 and toff 23 33 c were calculated using the program solution of microsoft excel and through pattern search the mean absolute error mae and root mean square error rmse of the optimized h s model during the validation period 2014 2017 were closer to zero than those of the pm model therefore the modified h s model was applied to forecast et0 luo et al 2016 ravazzani et al 2012 2 3 2 etc forecasting model based on a modification of the m1 model considering dynamic crop coefficient m2 model the m2 model was calculated using eq 5 5 e t c k c var e t 0 h s where e t c is the forecasted etc considering the dynamic changes in the crop coefficient e t 0 h s is the forecasted et0 using the h s model eq 4 and k c var is the dynamic crop coefficient to calculate et0 on base date the pm allen et al 1998 allen et al 2005a b asce model was applied according to eq 6 the ec system was used to determine etc on the base date whereas the single crop coefficient method was used to calculate kc on the base date 6 e t 0 p m 0 408 δ r n g γ 900 t mean 273 u 2 e s e a δ γ 1 0 34 u 2 where e t 0 p m is the et0 mm d 1 δ is the slope of the saturated vapor pressure curve r n is the surface net radiation g is the soil heat flux mj m 2 d 1 γ is the dry and wet constant t mean is the daily average temperature and e s and e a are the saturated and actual vapor pressure kpa respectively the kc on the base date was calculated using eq 7 10 7 k c 0 e t c e c 0 e t 0 p m 0 8 k c 1 e t c e c 1 e t 0 p m 1 9 k c 2 e t c e c 2 e t 0 p m 2 10 k c i e t c e c i e t 0 p m i where after substituting the obtained values of kc0 kc1 kc2 kci in eq 7 10 we obtained e t c for different forecast periods 1 15 d table 2 2 3 3 etc forecasting model based on a modification of the m2 model considering the historical threshold m3 model the m3 model was calculated using eq 11 11 e t c e t c e t c min 2 e t c e t c e t c max 2 e t c e t c min e t c min e t c e t c max e t c max e t c where e t c min and e t c max are the minimum and maximum values measured using ec from 2013 to 2017 respectively 2 4 evaluation index the error mae rmse r2 index of agreement dia and accuracy acc were used to evaluate the forecast accuracy of models the calculation formulas of these parameters are given in eq 12 15 bennett et al 2015 zhang et al 2016 12 error x i y i y i 13 mae i 1 n x i y i n 14 rmse i 1 n x i y i 2 n 15 d ia 1 i 1 n y i x i 2 i 1 n x i y y i y 2 where x i is the predicted value of etc y i is the etc measured by ec x and y are the means of the forecast and measured values respectively and n is the sample number of the forecast value the dia value ranges from 0 to 1 0 with 1 0 representing a perfect fit of the data acc refers to the percentage of days in which the etc forecast error is within 1 5 mm d 1 of the total days liu et al 2015 3 results and discussion 3 1 etc forecast with considering the dynamic change in kc application of the m2 model the dynamic crop coefficient in the 1 d forecast period k c var 1 was consistent with the k c f a o 56 recommended by fao 56 during the winter wheat and summer maize growth periods fig 2 the kc initially increased and later decreased as the growth stage progressed with a maximum value observed in the middle growth stage from the heading to the filling stage which coincided with the peak of crop water demand the significant seasonal changes in etc of winter wheat and summer maize crops for the given forecast period 1 d during 2018 2019 are shown in figs 3 and 4 minimum etc was observed at the early growth stage during which most cultivated land was bare and etc was predominantly derived from soil evaporation maximum etc was observed at the middle growth stage whereas the etc decreased at the mature stage jiang et al 2016 the forecasted values obtained by the m1 and m2 models were consistent with the measured values a good agreement between the forecasted values of the m1 and m2 models and the measured values was observed at low etc values less than or equal to 4 mm d 1 whereas less agreement with large differences between the m1 and m2 forecasted values and the measured values was observed as the etc value decreased fig 4 and table 3 the rmse values of etc and etc were 1 30 mm d 1 and 1 02 mm d 1 respectively whereas the mae values were 0 67 mm d 1 and 0 61 mm d 1 respectively the acc values of m1 and m2 models were 81 and 90 respectively however at high etc values more than 4 mm d 1 a poor fit was observed between the forecasted values of the m1 and m2 models and the measured values and the rmse values of etc and etc were 1 83 mm d 1 and 1 32 mm d 1 respectively whereas the mae values were 1 68 mm d 1 and 1 22 mm d 1 respectively additionally the accuracies of m1 and m2 were 68 and 80 respectively based on the overall change in the sample table 3 fig 4 we estimated the regression line slopes for the m1 and m2 models as 0 87 and 0 85 respectively whereas the r2 values were 0 59 and 0 72 respectively further the acc value of the m2 model 89 was higher than the m1 model 78 regarding short and medium term etc forecasting the m2 model was more accurate than the m1 model during the entire crop rotation period of both winter wheat and summer maize kc ranged from 0 3 to 1 5 during the reproductive growth stage the leaf area index increased gradually surface coverage changed from sparse to dense and etc changed from soil evaporation to transpiration during this stage the spatiotemporal distribution of etc was more complex which further reduced the model forecast accuracy however the dynamic changes in etc can reflect the response of the etc to the dynamic changes in crop growth stage improving the forecast accuracy 3 2 etc forecast for different forecast periods based on the m1 and m2 models using the daily 1 15 d weather forecast data from march 1 to september 30 winter wheat and summer maize in 2018 and 2019 respectively the m1 and m2 models were used to forecast etc for different periods 1 3 6 9 and 14 d the resultant etc forecast values of the selected study periods were consistent with the measured values fig 5 the dia between the forecasted values and measured values decreased with the increase in the forecast period further a good and a poor agreement were observed for the 1 d and the 14 d forecast periods the acc of the m1 model during different prediction periods decreased with the increase in the prediction period whereas the rmse and mae ranged from 1 74 to 1 87 mm d 1 and 1 24 to 1 35 mm d 1 respectively additionally the acc of 1 14 d period ranged from 66 to 78 further the etc forecasting accuracy of the m2 model during the different forecast periods was higher than that of the m1 model table 4 the rmse and mae ranged from 1 54 to 1 61 mm d 1 and 0 85 to 1 14 mm d 1 respectively and the deviations of the mean value were 1 3 4 6 and 7 for the 1 3 6 9 and 14 d forecast periods respectively the acc for 1 6 d were over 84 whereas those for 9d and 14d were 79 and 77 respectively therefore the applicability of the models was superior for the 1 7d forecast period because the m2 model considered the dynamic growth of crops the accuracy of the forecasted etc was higher than that of the fao 56 recommended crop coefficient model in addition the improvement in the model accuracy varied during different crop growth stages moreover the maximum and minimum temperature of different crops in different seasons can differ substantially therefore the accuracy of the m2 model at different growth stages of winter wheat and summer maize was evaluated further table 5 during the early growth stage of winter wheat kc ranged from 0 11 to 0 83 and the measured etc was approximately 0 91 mm d 1 table 5 for the 1d forecast period the error and rmse were 4 and 0 42 mm d 1 respectively and the acc value was 93 which was higher than the accuracy during the entire growth period fig 6 a consideration of the slight variation in kc from the seedling to tillering stages did not have considerable influence on the acc of etc during the middle growth stage of winter wheat kc ranged from 0 46 to 1 29 and the measured etc was approximately 3 78 mm d 1 the error and rmse were 22 and 1 60 mm d 1 respectively and the acc was 75 which was lower than that of the early growth stage moreover during the late growth stage of winter wheat kc ranged from 0 78 to1 43 measured etc was approximately 2 21 mm d 1 error and rmse were 3 and 1 25 mm d 1 respectively and the acc was 79 the results indicated that at different growth stages of winter wheat the acc decreased with the increasing range gap of kc progression of the crop growth stage and the increase in the forecast period fig 6a in contrast the rmse and error increased as the crop growth stage progressed and the forecast periods were extended during the early growth period of summer maize fig 6 b kc ranged from 0 23 to 0 95 and the measured etc was approximately 2 60 mm d 1 the error and rmse were 6 and 1 16 mm d 1 respectively for the 1d forecast period and the acc was 77 which was lower than the accuracy for the observed during the entire growth period during the middle growth stage of summer maize kc ranged from 0 57 to 1 51 the measured etc was approximately 3 87 mm d 1 the error and rmse were 15 and 1 21 mm d 1 respectively and the acc was 75 moreover during the late growth stage of summer maize kc ranged from 0 51 to 1 41 the measured etc was approximately 2 81 mm d 1 the error and rmse were 24 and 1 18 mm d 1 respectively and the acc was 85 there was an inherent uncertainty in the model forecasts for the middle growth stage of summer maize because of precipitation this model showed good applicability for the late growth stages of summer maize 3 3 modification of the m3 model by incorporating the history threshold the measured values for 2013 2017 were used to modify the m2 model to forecast etc for 2018 2019 the applicability of the model was evaluated by comparing the forecasted values of the m2 model and the measured values the evaluation indicators are shown in fig 7 and table 6 as shown in fig 7 absolute error ae before and after threshold correction varied during different forecast periods further in the etc dataset n 428 the values of 80 87 95 101 and 107 datasets exceeded the historical threshold during different forecast periods probably due to extreme weather the prediction of the dynamic changes of etc was more accurate by the m3 model than the etc values measured by ec compared with the m2 model the mean forecast error of the m3 model was reduced by 0 23 11 during different prediction periods and the rmse and mae were reduced from 0 01 to 0 07 mm d 1 and 0 08 to 0 12 mm d 1 respectively however the accuracy during different prediction periods was improved by 2 6 further prediction accuracy values were higher than 80 and 86 within the 15 d and 7 d forecast periods whereas the highest prediction accuracy 95 was presented in the 1 d forecast period the m3 model which was acquired by modifying the m2 model through empirical data obtained from crop growth history reduced the forecasted etc error under extreme climate and thus improved the forecast accuracy and model applicability 4 discussion etc is computed or modeled using weather data and algorithms that describe the aerodynamic characteristics of the vegetation and surface energy driven etc pereira et al 2021 we forecasted kc and et0 based on the fao 56 method using the kc et0 approach where etc is the product of kc and et0 allen et al 1998 fao 56 described the temporal variation of kc using a segmented crop coefficient curve and can be applied to both single time averaged kc and the basal kcb however the kc derived from fao 56 only reflected the crop variety and not the regional changes in the crop therefore fao 56 recommends different kc values for different crops based on various field experiments conducted worldwide the recommended values can facilitate irrigation and crop management hunsaker et al 2005 tian et al 2016 as kc varies with the crop type climate irrigation method and other management factors using the same kc values in different places and for different irrigation methods may induce significant uncertainties kang et al 2003 suleiman et al 2007 accordingly the fao 56 recommended kc may not be applicable to all regions therefore kc should be estimated according to local standards that can guide specific regional irrigation practices allen et al 2005a b allen et al 2011 ding et al 2015 yang et al 2016 therefore the dynamic crop coefficient method proposed in this study has significant applications for the accurate prediction of evapotranspiration the dynamic crop coefficient method we developed was based on a new calculation method of daily kc which was used to develop the m2 model for more accurate prediction of etc and for large scale application in different areas wang et al 2015 considered daily regional crop coefficient as an optimization factor for etc prediction model seidel et al 2019 developed a simulation based approach to estimate site specific dynamically continuous kc curves by considering the influence of climate variability soil and sowing date zhao et al 2021 dynamically modified the crop coefficient under film mulching during the overall maize growing season therefore compared with the kc value recommended by fao 56 a modified dynamic crop coefficient has larger practical significance and scientific reliability we observed local historical etc data from the ec system which provided the evidence for modifying the predicted etc value which was beyond the historical threshold range and obtained from the m2 model the historical data generally provides an important reference for understanding the present and future performance of models liu et al 2021 investigated historical water consumption minimum and maximum daily temperatures humidity visibility air pressure wind speed precipitation moisture solar radiation and other meteorological conditions to forecast future indicators bedi and toshniwal 2019 developed ai based methods using historical data to predict future water demands hanifi et al 2020 determined time series models and used previous historical data as training data for forecasting moreover solyali 2020 used machine learning to model complicated nonlinear connections through a learning process containing historical data patterns sabzipour et al 2021 evaluated the potential of using historical meteorological data subsets for ensemble stream flow prediction esp forecasting koutsoyiannis et al 2008 used an analog method in a trial and error procedure to determine the optimum length of the backward looking predictor period and the number of historical traces used in the ensemble similarly svensson 2016 proposed river flow forecasting methods using hydrological persistence and historical analogs and found that the analog method performed better for longer lead times the analog method that used historical data was a potential benchmarking method for further studies svensson 2016 in our study by including the historical threshold of etc m3 the dynamic crop coefficient model m2 was modified resulting in an increase in the prediction accuracy by 3 6 however modeling of historical threshold modifications is still underdeveloped for etc prediction as the existing methods are more useful for managing short and medium term forecasts thus improvement of the historical threshold modification method under extreme weather should be studied further in this study we focused on the short and medium term forecasting of etc notably the long term etc forecasting is required to assess temporal variability and long term trends regarding climate feedback mechanisms feng et al 2017 and reduce the negative effects of excess irrigation water on crop production pôças et al 2015 for example elbeltagi et al 2020 modeled long term dynamics of crop evapotranspiration using deep learning in a semi arid environment for long term etc forecasting but failed to achieve high prediction accuracy due to the low accuracy of long term forecasting in this study we studied only short and medium term forecasts the acc values of the m3 model under the prediction periods of 1 3 6 9 and 14 d were 95 91 86 83 and 81 respectively in addition the short and medium term etc forecasting in this study is limited to point scale which can be extended to regional scales using remote sensing data this aspect can be achieved in future work 5 conclusions this study successfully developed real time methods for short and medium term etc forecasting using dynamic crop coefficient and relevant historical thresholds the following three primary conclusions were derived 1 kc is a crucial factor that influences the accurate forecasting of etc the dynamic kc model can accurately forecast etc over the entire growth period of winter wheat and summer maize compared with the fao 56 recommended crop coefficient model accuracy was increased by 12 rmse and mae were decreased from 1 74 mm d 1 and 1 24 mm d 1 to 1 54 mm d 1 and 0 85 mm d 1 respectively in addition the model accurately reflected the local responses of winter wheat and summer maize to the crop coefficient 2 the prediction accuracy of the m2 model during different prediction periods was higher than the m1 model the error between forecasted and measured etc values for winter wheat and summer maize during different forecast periods for the m2 model was smaller than m1 model and the accuracy for 1 7d forecast periods was over 84 however during different crop growth stages the accuracy decreased as the forecast period extended and crop coefficient increased 3 by including the historical threshold of crop growth the forecast accuracy of the m2 model evidently improved in the m3 model the rmse and mae decreased from 1 54 mm d 1 and 0 85 mm d 1 to 1 47 mm d 1 and 0 74 mm d 1 in 1d forecast period respectively whereas dla and acc increased from 0 83 and 89 to 0 89 and 95 respectively thus short and medium term forecasting of etc in crop production can be successfully achieved using the modified m3 model credit authorship contribution statement xin han conceptualization methodology formal analysis qingyun zhou methodology formal analysis funding acquisition baozhong zhang conceptualization writing review editing funding acquisition zheng che methodology formal analysis writing review editing zheng wei methodology writing review editing rangjian qiu methodology writing review editing he chen methodology writing review editing yinong li writing review editing taisheng du writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we gratefully acknowledge the financial support from the national natural science foundation of china no 51822907 52130906 51979287 and 51609170 the fund of china institute of water resources and hydropower research no id0145b022021 and id0145b052021 and the fund of state key laboratory of simulation and regulation of water cycle in river basin china institute of water resources and hydropower research no skl2020ts08 
3636,this study is the first attempt to assess the accuracy of water levels measured by the sentinel 3a altimetry at virtual stations vs located along polish rivers the studied rivers vistula odra warta bug narew san drain predominantly lowlands and based on width can be classified as small and medium rivers 40 610 m in width the accuracy assessment is based on a comparison between water level anomalies from 34 vs and water level data from the nearest adjacent gauges acquired from april 2016 to august 2019 the time lags between water level time series vs vs gauge are estimated so that pairs of hydrographs agree in phase which enables the comparison it is found that the root mean square error ranges from 0 12 to 0 44 m with mean of 0 22 m the nash sutcliffe efficiency nse varies between 0 40 and 0 98 with mean of 0 84 for 67 pairs of time series out of 68 considered it is also argued that river width does not reveal any impact on the performance of the altimetric measurements over the study area likewise land cover has not been identified as an environmental factor to constrain the data accuracy however it is found that complex river channel morphology and unfavourable geographical setting occur more frequently at vs with lower nse 0 8 the study confirms the usability of the sentinel 3a altimetry along small and medium rivers identifies factors to constrain the accuracy and most importantly provides yet another regional scale investigation into quality of satellite radar measurements over inland waters keywords radar altimetry rivers sentinel 3a hydroweb poland 1 introduction freshwater supply is a global problem of growing importance increased water demand is not entirely driven by climate change arnell and gosling 2013 its main drivers are demographics and economic growth related to the rise of per capita consumption world water assessment programme 2009 the spatial and temporal distribution of water resources is not uniform which results in permanent and intermittent water deficit in numerous areas freshwater supply directly impacts human societies by constituting crucial resources of drinking water agricultural irrigation as well as water used by the industry therefore monitoring of continental waters is critical for water resource management and flood management coe and birkett 2004 in ancient times people explored the knowledge of rivers by observing the cyclic nature of hydrologic phenomena along with the development of measurement techniques water level monitoring became more precise and regular currently most developed countries maintain advanced hydrological services paradoxically the availability of measurements is decreasing over the recent decades vorosmarty et al 2001 calmant and seyler 2006 the main factors constraining the terrestrial water monitoring are the costs of installation and maintenance of gauging stations hannah et al 2011 the constrained access to remote areas and political issues pan and nichols 2013 hence there is a dire need for an alternative technique for measuring water levels at poorly gauged or ungauged rivers a unique opportunity to bridge this gap is provided by satellite radar altimetry originally designed to carry out absolute radar measurements of water level in open oceans benveniste 2011 altimetry is a technique for measuring height the main principle of which is the measurement of time taken by a radar pulse for the two way travel from the satellite to the surface chelton et al 2001 one of the first missions demonstrating the scientific utility of this technique were seasat geosat and ers1 launched in 1978 1985 and 1991 respectively however data acquired by those satellites were not sufficiently accurate for addressing many problems of ocean circulation fu et al 1994 the breakthrough in radar altimetry occurred in 1992 with the launch of the topex poseidon satellite its improved measurement quality resulted from the precise determination of the orbit tapley et al 1994 the topex poseidon successors jason 1 jason 2 and jason 3 offered a further improvement in data accuracy lafon 2005 vaze et al 2010 through the development of the altimetric technology it became possible to monitor inland waters including lakes wetlands and rivers e g cazenave et al 1997 crétaux and birkett 2006 silva et al 2010 crétaux et al 2011 the first attempts to determine water levels of rivers on a basis of altimetric measurements were constrained by the minimum channel width of 1 km birkett 1998 however over the past two decades several technological improvements enabled water level measurements over small water bodies with width below 200 m e g sulistioadi et al 2015 schneider et al 2018 first the development of the synthetic aperture radar sar mode enabled a better spatial resolution of the signal in the along track direction as well as the noise reduction quartly et al 2020 moreover new altimeters benefit from operating in the open loop mode which allows tracking the signal directly inside the reception window thanks to the onboard elevation data taburet et al 2020 finally numerous retracking algorithms e g the threshold retracker ocog ice 1 were developed to retrack different types of waveforms huang et al 2019 silva et al 2010 argued that the river width is not a factor limiting the quality of water level time series according to maillard et al 2015 there are currently three environmental factors that may affect the measurement 1 land cover along the satellite track in the vicinity of the river 2 river channel morphology width direction and shape as well as 3 land topography near the channel apart from the technological and environmental factors the applicability of altimetric data in inland water hydrology is limited by low spatial density of ground tracks and temporal satellite repeat cycle resolutions considering the currently operational satellites jason 3 has a 10 day sentinel 3a and sentinel 3b a 27 day and cryosat a 369 day repeat cycle with spacing between ground tracks at the equator of 315 104 and 7 5 km respectively a solution to the problem of the compromise between spatial and temporal resolution is the multi mission altimetry tourian et al 2016 used water levels derived from topex poseidon envisat saral altika cryosat 2 and jason 2 altimetric missions at 40 virtual stations intersections of a satellite ground track with a water body hereinafter abbreviated as vs located along the po river the correlation of these data with in situ measurements ranged from 0 5 to 0 8 another example of the multi mission altimetry of inland waters is presented by biancamaria et al 2017 who determined twelve vs at the garonne river retrieving water levels from the envisat saral altika and jason 2 satellites those authors investigated the satellite altimetry performance over a medium river within a steep sided valley new perspectives for measuring water surface elevation at ungauged sites have been opened with the launch of sentinel 3a on 16th february 2016 with an along track resolution of 250 m sentinel 3a possesses a great potential in monitoring water levels of inland water bodies bogning et al 2018 and normandin et al 2018 used water levels retrieved from a few altimeters including sentinel 3a to assess their performance in the ogooué river and the inner niger delta le gac et al 2021 investigated the benefits of the open loop tracking command oltc which for the sentinel 3a showed the satisfying performance and promising quality for future measurement opportunities the analysis of sentinel 3a data over mountain rivers using a number of retrackers has been conducted by huang et al 2019 and jiang et al 2020 it is thus apparent that sentinel 3a operating with a sar mode altimeter at a global scale and with the open loop tracking mode reveals a great potential for observing inland water bodies even in complex terrain although radar altimetry has been shown to be useful for measuring water levels of small and medium rivers its performance has not been subject of a comprehensive scrutiny over the vistula and odra river basins a preliminary study has been conducted by halicki 2020 who investigated the correlation between water levels based on the sentinel 3a altimetry and measurements from adjacent gauges located along polish rivers altimetry data derived from the hydroweb database online database providing continuous time series for the altimetry based levels of large lakes reservoirs and rivers for main polish rivers showed a mean correlation coefficient of 0 93 however halicki 2020 has not investigated the accuracy of altimetric radar measurement at vs located along polish rivers in general focusing on the use of altimetry in poland apart from the studies on capturing variation of the southern baltic sea e g dinardo et al 2018 pająk and kowalczyk 2019 there has not been any comprehensive investigation of the environmental factors which might affect the altimetric measurements at vs located in the vistula and odra river basins this research aims to examine the accuracy of water levels of the selected polish rivers based on altimetric data from the sentinel 3a satellite study the influence of several factors river width river channel morphology geographical setting of the vs and the land cover in its vicinity on the altimetric measurements 2 material and methods 2 1 study area the study area i e the basins of the vistula and odra rivers covers 90 of the territory of poland most of this area is characterized by low elevation slightly sloping towards the north east the only mountainous regions sudetes and carpathians are located in the southern part of the country according to the köppen climate classification the study area is characterized by the cfb temperate oceanic climate in the west and dfb warm summer humid continental climate in the east kottek et al 2006 water levels recorded along the following six biggest polish rivers are considered vistula odra warta bug narew and san fig 1 according to the classification of rivers based on width meybeck et al 1996 the studied water bodies are classified as small width 40 200 m and medium width 200 800 m rivers with length varying from 458 to 1022 km table 1 following the criteria of dynowska 1997 wrzesiński 2017 has identified five flow regimes of polish rivers four of which describe the flow of rivers considered in this study the identification of flow regimes adopted after dynowska 1997 has been based on the percentage of the average outflow in a spring or summer month in relation to the average annual outflow the flow characteristics of the san river and the southern sections of the vistula and odra rivers located in the mountains southern poland are described as the nival pluvial type both the narew and bug rivers have the nival flow regime explicitly formed the nival regime middly formed describes the flow characteristics of most of the odra vistula and warta rivers sections in central part of poland the flow characteristics of the vistula and warta rivers reveal the nival flow regime feebly formed water level maximum values occur in spring which corresponds to snow thawing period low water levels occur usually at the turn of summer and autumn 2 2 datasets 2 2 1 altimetric data altimetry is a technique of measuring height to obtain water levels from satellite radar altimetry two values are indispensable 1 the distance between the satellite and the water surface the altimeter range r measured on a basis of the round trip time of an electromagnetic wave emitted by the radar altimeter and 2 the satellite altitude h alt with reference to an ellipsoid obtained due to the precisely determined orbit to improve the measurement accuracy geophysical e g solid earth tide and polar tide and atmospheric e g ionospheric dry tropospheric and wet tropospheric corrections need to be performed the height of the reflected surface is calculated as follows 1 h waterlevel h alt r corr atmospheric corr geophysical where h waterlevel is the calculated water level h alt is the sentinel 3a altitude r is the altimeter range and corr atmospheric corr geophysical are the atmospheric and geophysical corrections sentinel 3a is an earth observation satellite launched on 16th february 2016 developed by the european space agency as a part of the copernicus programme fletcher 2012 the satellite was inserted into a sun synchronous orbit with the height of 814 5 km and the 27 day repeat cycle the orbit offers 385 ground tracks with spacing of 104 km at the equator one of the sentinel 3a onboard instruments is the synthetic aperture radar altimeter sral operating in two radar modes the low resolution mode lrm and the synthetic aperture radar sar mode the instrument uses both the ku band and the c band frequencies the two tracking modes provided in the sral design are the closed loop and the open loop mode over the entire study area the altimeter operates in the open loop mode there are several methods for obtaining altimetry based water levels using various retracking algorithms water level data over large lakes and rivers are also provided through several online data hubs e g the database for hydrological time series of inland waters dahiti https dahiti dgfi tum de en hydroweb http hydroweb theia land fr or thematic exploitation platform tep for hydrology https hydrology tep eu however at the moment of the analysis the tep for hydrology database did not contain water levels from polish rivers the dahiti database provided only measurements at two vs located in poland in this study we use the altimetric data from hydroweb altimetry based water levels of polish rivers are also available on the copernicus global land service but these measurements are calculated in a similiar approach as in hydroweb differences between water levels available in these databases do not exceed 0 5 cm for the studied vs hydroweb provides time series specified by the laboratoire d etudes en géophysique et océanographie spatiales legos and computed by collecte localisation satellites cls on behalf of centre national d etudes spatiales cnes and copernicus global land water levels of the studied rivers are computed using the offset centre of gravity ocog retracker the hydroweb altimetry data is referenced to egm 2008 geoid and corrected for solid earth tide pole tide ionospheric delay wet and dry tropospheric delay rosmorduc and vayre 2020 at the time of the analysis there had been 34 vs of the sentinel 3a satellite over the study area located along six rivers vistula 8 odra 10 warta 6 bug 5 narew 3 and san 2 fig 1 2 2 2 in situ data water levels from 40 gauges operationally measured by the institute of meteorology and water management national research institute instytut meteorologii i gospodarki wodnej państwowy instytut badawczy imgw pib are acquired in order to evaluate the quality of the altimetric data for each vs one upstream and one downstream adjacent gauge is selected fig 1 the water levels referenced to the kronsztadt 86 vertical datum are provided in csv sheet format with a time step of 10 min in case of data gaps shorter than 5 days water levels are linearly interpolated by calculating the missing values on a basis of the gap size number of 10 min steps and the vertical difference between the water levels before and after the gap for example considering a data gap of two hours 12 steps and the water levels of 150 cm and 153 cm before and after the gap we add 0 25 cm to the interpolated and adjacent measurements the reason why we chose the 5 day interpolation period was that we needed continuous 10 day time series of in situ measurements in order to calculate the time lag at each time of the satellite pass see methods due to the fact that no gaps greater than 2 days occurred at the times of the satellite passes table 2 such a considerable interpolation period did not have a meaningful impact on the comparison presented in this paper the number of cases with missing in situ data from the times of the altimetric measurement is of 57 for the interpolated datasets considering the total number of such juxtapositions 3112 which is a result of 1552 sentinel 3a measurements compared to two adjacent gauges the percentage of missing in situ data is of 1 83 the time span of gauge data ranges from april 2016 to august 2019 which corresponds to the time frame of the selected altimetric data 2 3 methods 2 3 1 comparing altimetry data with in situ measurements the process of comparing water level measurement vs vs in situ data is adopted after halicki 2020 first two adjacent gauges are assigned to each virtual station the mean distance between a vs and an in situ station is 20 12 km which indicates that the stations are sufficiently close to allow for a reliable comparison of their water levels however since the distances vary from 0 49 to 72 74 km it is essential when comparing the water levels to take into account the time shift occurring between the analysed stations the unification of times is based on a two gauge relationship first for every altimetry based water level measured at a vs the upstream and downstream gauges data sets are extracted using the 10 day moving window 5 days backward and 5 days forward from the measurement time second the cross correlation between water level time series at downstream and upstream gauges is calculated in order to estimate such a time lag for which the data sets are maximally correlated the occurrence of time lags is visualized in fig 2 which is an example of a 10 day time series recorded at two adjacent gauges before and after shifting it is apparent from the graph that water levels at these gauges are maximally correlated after the correction of the time lag of 13 5 h after computing the time lag between the time series at the adjacent gauges the time lag of water to travel between each vs and its nearest in situ stations is linearly computed using the ratio between the first distance from vs to gauge and the second distance from upstream to downstream gauge in cases of data gaps longer than 5 days the time lag is not calculated and set to 0 furthermore in situations of small water level variation when the hydrographs do not contain evident spikes of water levels recorded at both gauges the obtained time lag is set to 0 for each altimetric measurement water levels from both adjacent gauges are assigned using the estimated time lag each moment of measurement is shifted forward for downstream gauges and backward for upstream gauges in order to eliminate the time difference between the compared data sets for example let us consider an altimetric measurement taken at 08 00 am with the estimated time lags between the vs and the neighbouring gauges upstream and downstream of 5 h 10 min and 3 h 20 min respectively in such a situation we compare the obtained water level at the virtual site with the upstream gauge measurement taken at 02 50 am and the downstream gauge measurement taken at 11 20 am considering the temporal resolution of the imgw pib in situ time series 10 min altimetry based water levels every 27 days are compared with measurements taken within a short time frame before after the radar reading data processing is performed using the python programming language and its several libraries rpy2 pandas numpy datetime 2 3 2 statistical measures due to different vertical datums egm 2008 geoid for sentinel 3a data and kronsztadt 86 for in situ heights water levels are not compared directly we adopt the approach described in detail by sulistioadi et al 2015 who suggested to utilize water level anomalies instead of using absolute water level variation the anomaly calculation is based on subtracting the mean water level from the observed water level herein the sentinel 3a water level anomaly time series for a given vs is computed as a difference between the observed sentinel 3a heights measured at this vs and the corresponding mean value april 2016 august 2019 similarly in situ water level anomaly time series for a given hydrologic gauge is calculated as a difference between water levels measured at this site and their mean value april 2016 august 2019 the root mean square error rmse is calculated to measure how the satellite based water level anomalies depart from in situ anomalies it is described as 2 rmse i 1 n x i y i 2 n where x i is the sentinel 3a water level anomaly y i is in situ water level anomaly and n is the sample size to compare anomalies the nash sutcliffe efficiency nse is also used nash and sutcliffe 1970 it belongs to a few standard measures for assessing the performance of hydrologic models krause et al 2005 the nse statistics is defined by the following formula 3 nse 1 i 1 n x i y i 2 i 1 n y i y 2 where x i is the sentinel 3a water anomaly y i is in situ water level anomaly n is the sample size and y is the mean of the in situ water level anomalies the nse statistics summarizes the agreement between the observations and estimates however it does not express errors themselves but it is a measure of estimation skills therefore it enables the comparison of the performance of a given method for dissimilar rivers the nse values range between and 1 in the context of our scrutiny if the altimetry and in situ water levels agree in amplitude phase and mean nse is approximately equal to 1 if nse is about 0 it means that the satellite based estimation of water levels has skills similar to averaging in situ data negative nse values indicate that averaging data is even better approach for measuring water level than the reconstruction of heights based on sentinel 3a 2 3 3 environmental factors the obtained results are confronted with environmental factors affecting the altimetry measurements e g maillard et al 2015 as shown in fig 1 all vs are located within flat terrain with altitudes of vs ranging from 8 to 190 m a s l which is why the topographic factor is not taken into consideration the determination of land cover along the satellite ground track in the vicinity of a river is conducted using the corine land cover 2018 data and resulted in the concise information on land structure within the 1 km buffer around each vs in addition using the google earth imagery the river channel morphology and the geographical setting of each vs are studied in terms of 1 the occurrence of sandbars 2 the alignment of river channel in respect to the satellite ground tracks 3 the occurrence of multiple river crossing with the satellite ground track this enables the distinction between vs where the aforementioned circumstances occur and vs where they are not present to verify the correlation between river width and the obtained rmse nse for a given vs we calculate the pearson correlation coefficient the statistics is studied both for all of the virtual sites and separately for the vs located on small width 40 200 m and medium width 200 800 m rivers due to the small sample problem only 10 cases at medium rivers and 24 cases at small rivers instead of applying the asymptotic correlation its bootstrap version is calculated with b number of re sampling of 1 million efron 1992 3 results 3 1 the accuracy of the sentinel 3a altimetry based water levels table 3 shows the obtained rmse and nse values which are presented for each pair vs vs gauge both for upstream and downstream adjacent imgw pib station the rmse values range from 0 12 to 0 44 m with mean of 0 22 m in addition the nse values confirm a considerable quality of sentinel 3a data i e in 67 out of 68 cases nse ranges from 0 40 to 0 98 with mean of 0 84 only water level estimates obtained from the wis wis s3a 0300 01 virtual site compared to the adjacent kraków bielany gauge heights reveal a negative nse coefficient 3 29 however two barrages are located on the vistula river between these stations fig 3 which might be the reason of the negative value of nse moreover the comparison between water levels from this vs and the downstream adjacent gauge sierosławice shows a much better estimation rmse of 0 22 m and nse of 0 84 also table 3 juxtaposes river width ranging from 40 to 610 m measured on the basis of google earth imagery as well as the distance between the vs and the adjacent gauges most of the virtual sites 24 of 34 are located along narrow river channels below 200 m and nine of them are located on rivers narrower than 100 m the mean distance between vs and a neighbouring gauge is 20 12 km ranging from 0 49 to 72 74 km more than half of the pairs 37 of 68 are located less than 20 km apart a comparison between water level anomalies from the selected virtual sites and their adjacent upstream gauges is shown in fig 4 for the sake of brevity four vs were chosen which represent sites on a narrow fig 4a b and a medium fig 4c d river channel characterized by high fig 4b c and moderate fig 4a d accuracy each figure shows a good agreement between water level anomalies the time series of the ode war s3a 0386 00 and wis wis s3a 0255 00 virtual sites are characterized by low rmse 14 10 and 14 92 cm respectively and high nse both 0 97 the altimetry based water levels agree well with in situ heights both during low and high water stages and in addition both for narrow and medium river widths fig 4b c considerably lower agreement can also be found both for the narrow channel 40 m and medium channels fig 4a d despite the moderate rmse values 25 49 and 36 71 cm respectively nse showed a slightly worse agreement between altimetry and in situ data 0 64 and 0 40 respectively one of the reasons for the poor performance might be the high reflectivity of sandbars which occur on both sites fig 5 due to data gap in the międzychód gauge time series the height from ode war s3a 0386 00 measured in august 2018 has not been taken into consideration fig 4b altimetry based water level anomalies also correspond well with daily averages of water stages measured at upstream gauges fig 6 for the analysis the same set of vs was chosen as in fig 4 in most cases the sentinel 3a data fit in situ time series however there are a few periods where the altimeter has not provided data from october 2017 to may 2018 most of water level data from the ode war s3a 0728 00 virtual site differs from in situ measurements by several dozens of centimeters up to 65 cm fig 6a furthermore stages from the wis wis s3a 0300 00 virtual site from november 2018 to may 2019 also differ considerably from the reference data fig 6d in contrast the altimetry measurements presented in fig 6b c show high agreement with in situ time series without discrepancies all graphs showing water level anomalies for each of the vs compared to the water level anomalies and their daily average both from the upstream and downstream neighbouring gauges are presented in the supplementary material fig a1 a2 a3 a4 3 2 factors controlling accuracy of water level estimation at vs 3 2 1 dissimilarities between water levels from vs and neigbouring gauges altimetry based water levels estimated at vs may depart from in situ data due to several factors first the gauging stations should be located in the vicinity of vs kittel et al 2021 argued that for a suitable and direct comparison gauges should be located closer than 20 km from vs on the contrary bogning et al 2018 analysed measurements from vs located more than 100 km apart from a gauge on the ogooué river however only one in situ station was available along this river second the comparison might be affected by tributaries between the two stations for example biancamaria et al 2017 and kittel et al 2021 excluded all pairs between which there was a major tributary third the presence of hydraulic structures e g weirs dams between vs and gauge can also aggravate the agreement biancamaria et al 2017 argued that several weirs located on the garonne river between a vs and the adjacent gauge can explain the significant rmse of the alltimetry based water levels in this study we did not exclude any pair of stations vs gauge due to the above mentioned factors fig 3 shows the spatial distribution of the calculated nse values presented with 1 tributaries with length 100 km flowing into the river sections between the compared stations 2 hydraulic structures barrages and locks located between the compared stations and 3 adjacent gauges the distance from vs to the neighbouring gauge does not seem to have an impact on the obtained results bearing in mind that the stations are up to 72 74 km apart for example despite sufficient proximity water levels from the virtual site located 1 74 km downstream of the radomyśl gauge san river show one of the lowest nse value 0 66 one of the reasons might be the occurrence of sandbars moreover the nse of water levels from this vs is low either when comparing with upstream or downstream gauge data in contrast water levels from the virtual site located 26 34 km upstream of the chełmno gauge vistula river are characterized by high nse value 0 97 the occurrence of tributaries in most cases does not result in a considerably lower water level agreement for example water levels from the virtual site upstream of the santok gauge warta river show high nse 0 94 despite the major tributary noteć river flowing into the river between the compared stations in contrast the measurements from the virtual site located dowstream the słubice gauge odra river show a much worse agreement with the dowstream adjacent gauge kostrzyn nad odrą heights than with water levels recorded at the neighbouring upstream słubice gauge this might be due to the confluence of warta river to the odra river which is located between the vs and the kostrzyn nad odrą gauge only one virtual site is located in the proximity of hydraulic structures vs adjacent to the kraków bielany gauge on the vistula river and it shows a considerably lower agreement of water levels however it should be noted that the occurrence of hydraulic structures does not influence the performance of the altimetric measurement it only makes the comparison of vs heights with gauge data less legitimate since there might be discrepancies between those hydrograms due to water level regulations this inference is supported by the correlation coefficient between hydrograms at neighbouring gauges the correlation between water levels at kraków bielany and sierosławice is of 0 85 and is significantly lower than the mean correlation between hydrograms corresponding all the investigated gauge pairs 0 973 3 2 2 factors controlling altimetric measurements the use of radar altimetry over rivers is constrained by a set of limiting factors see introduction the correlation between river width and the obtained results does not show any significant relationship neither taking into account all vs nor considering separately vs located on small and medium river sections table 4 if such a relationship existed the correlation 1 between river width and rmse would have a strong negative value and 2 between river width and nse would reveal a strong positive value the highest absolute correlation between river width and rmse or nse 0 282 and 0 307 respectively is found for small rivers and for the association between virtual sites and the corresponding downstream gauges the correlation for rmse is positive and for nse is negative which suggests an inverse relationship the strength of which is weak or the relation is even not existent the results suggest no significant influence of river width on the accuracy of the altimetic data considering the river width ranging from 40 to 610 m the influence of environmental factors on the altimetric measurement has been widely described by maillard et al 2015 the land cover structure in the 1 km buffer of each vs sorted in descending order by the nse value of altimetry based time series compared to the upstream gauge measurements shows no clear relationship with the sentinel 3a data quality fig 5 most of the areas are dominated by the agricultural land type which due to low surface roughness are unfavourable for the altimetric measurement the land cover structure is similar in most of the vs buffers either with high or low nse values in terms of the river channel morphology 1 in the vicinity of 16 of 34 virtual sites sandbanks were recognized 2 the river channel parallel to the satellite ground track occurred at 6 virtual sites 3 multiple river crossing by the satellite ground track occurred at 9 vs in order to quantify the comparison we presented the summarized land cover structure for vs with higher 0 8 and lower 0 8 nse value table 5 the nse value of 0 8 has been indicated as the threshold for an efficient prognosis donigian et al 1983 as cited by moriasi et al 2007 and gupta et al 1999 each of the land cover type occupies similar portion of terrain in the two nse based classes this indicates low or even no influence of land cover on the altimetric measurement however among virtual sites with nse 0 8 the percentage of sites with the occurrence of complex river channel morphology and unfavourable geographical setting of the vs is significantly lower 56 52 than among vs with nse 0 8 81 82 it suggests that among the studied factors which may potentially control altimetric measurements over inland waters unfavourable geographical setting and river morphology mainly the presence of sand bars protruding water surface or being only slightly submerged is the only element that leads to the deterioration of altimetry skills in general it is apparent from fig 3 that the spatial distribution of nse corresponds to the degree of river regulation the highest quality of altimetric measurements is recorded for the lower warta river which was intensively regulated at the turn of 18th and 19th century kaniecki 2014 slightly worse but still skillful water level estimation is measured by sentinel 3a along the middle and lower odra river which was also meaningfully influenced by human interventions both in its middle ciszewski 2003 and lower reach kreft and parzonka 2007 due to these regulations conducted to enable inland navigation less sandbars and river islands occur within the river channels which is favourable to altimetry measurements in contrast the lowest quality of altimetric measurements is found for virtual sites located along the vistula river which is known as a natural river żelazo 2006 4 discussion altimetry based water levels of six polish rivers collected every 27 days at 34 sentinel 3a virtual sites processed by hydroweb constitute a considerable source of hydrological information the altimeter provides accurate measurements even on small river sections with width below 50 m during the nearly 3 5 years time frame data gaps occurred only in 48 of 1556 measurement epochs which corresponds to only 3 08 of readings the accuracy of the sentinel 3a water levels is considerable the obtained rmse values 0 12 0 44 m agree well with the results of other studies assessing the accuracy of sentinel 3a data in different regions table 6 however the above comparison should be made knowing the distance between vs and in situ stations jiang et al 2020 zaidi et al 2020 and kittel et al 2021 compared water levels from vs with gauges located in close proximity below 3 4 and 20 km apart respectively due to small number of gauges bogning et al 2018 and normandin et al 2018 compared water levels from sites located even over 100 km apart in this study we did not discard any vs due to the distance from the closest gauge which ranged from 0 49 to 72 74 km table 6 many authors found that topography and land cover may impact the accuracy of altimetric measurements over inland waters for instance jiang et al 2020 studied vs located along chinese rivers some of which in mountainous areas according to these authors the abruptly changing topography might aggravate the altimeter performance and cause high errors table 6 normandin et al 2018 studied the inner niger delta they argued that high errors table 6 might occur due to several river streams or floodplain lakes in the vicinity of vs which can result in the complexity of waveforms hampering the determination of range by the retracker on contrary one of the vs investigated by kittel et al 2021 despite its location on a floodplain is characterized by very low rmse 0 14 m herein we investigated vs located on flat terrain and therefore the role of topography could not be addressed indeed it is apparent from table 3 that rmse values are low 0 12 0 44 m with mean of 0 22 m with relatively low dispersion standard deviation of rmse 0 07 m similarly land cover types in the vicinity of most vs are similar and therefore it is not an important factor affecting the data quality fig 5 which stands in contrast with land cover related findings of maillard et al 2015 majority of the studies listed in table 6 assessed the accuracy of altimetry based water levels retrieved manually using various services e g the esa gpod grid processing on demand https gpod eo esa int this allowed to calculate water levels using a variety of approaches for example by applying various retrackers setting different water masks or outliers removal criteria one of a few studies on the quality of altimetric measurements over inland water based on data acquired from online hubs was conducted by schwatke et al 2015 who presented a new method for estimating water level time series over inland water bodies which forms bases for dahiti the authors analysed the accuracy of altimetric measurements carried out at 20 vs of the envisat ers 2 jason 1 jason 2 topex poseidon and saral altika satellites located in the amazon basin derived from three online data hubs dahiti hydroweb and river lake the obtained rmse was of 0 08 1 14 m 0 24 3 36 m and 0 15 3 19 m respectively for these data hubs our scrutiny is yet another example of studies on river altimetry based on data acquired from data hubs similarly to the paper by schwatke et al 2015 we processed data extracted from hydroweb however widths of the studied rivers vary considerably in our study rmse values are smaller than those presented by schwatke et al 2015 for much wider rivers although this result is promising it needs to be interpreted with caution since considerable errors on some of vs published by schwatke et al 2015 might be driven by large absolute water level variations more than 10 m the variability definitely exceeds the absolute water level variations of polish rivers another study of the altimetry based water levels from the dahiti data hub has recently been presented by scherer et al 2020 who proposed a new approach for estimating discharge using satellite altimetry and remote sensing images the authors utilized water levels of the lower mississippi river from 20 vs of various satellites among which there was 1 vs of the sentinel 3a the obtained rmse of the sentinel 3a measurements was of 0 14 m table 6 which proves the considerable quality of the dahiti data hub it should be noted however that the mississippi river is one of the world s biggest rivers incomparably larger than polish rivers we also found that there is no correlation between river width for widths 200 m and statistics for assessing the skills of water level estimation table 4 our result agrees well with findings published by silva et al 2010 and jiang et al 2020 who argued that river width is not a factor which strongly affects the quality of altimetry based water levels in this context it is worth referring to the paper by huang et al 2018 who used a different technology the jason 2 3 and envisat retracted altimetric data for monitoring brahmaputra river water levels these authors arrived at the conclusion that their retracting algorithm is suitable for rivers with widths of 300 m though they considered channel sections of 200 1000 m wide interestingly the presence of tributaries between the compared stations does not seem to aggravate the agreement between vs and in situ data fig 3 however major tributaries are perceived by other authors as objects which may impede the comparison between adjacent stations biancamaria et al 2017 kittel et al 2021 low agreement between water levels from the kraków bielany gauge and the adjacent vs could have been caused by the presence of hydraulic structures on this river section this is in agreement with the work of biancamaria et al 2017 who argue that the presence of weirs may explain a portion of water level estimation error at virtual sites again it is to be mentioned that hydraulic structures might aggravate the comparison between hydrograms but not the altimetric measurement itself the spatial distribution of nse performance of altimetry over the studied rivers is associated with the degree of river regulation fig 3 with good and considerable skills along the regulated rivers odra and warta and the mediocre performance for the natural river vistula also skills of water level reconstruction along regulated channels may be associated with river channel morphology which in our case studies is complex along the vistula river presence of extended accumulation landforms such as sandbars and less diverse along the other two rivers rare occurrence of large scale bedforms complex river channel morphology and unfavourable geographical setting of the vs occurred more often at vs characterized by lower nse 0 8 table 5 this corresponds with the findings of maillard et al 2015 who stated that the occurrence of sandbars but also river channel parallel to satellite ground track or its multiple crossing strongly influences the altimeter measurement 5 conclusions over past decades satellite radar altimetry has provided steadily improving water level measurements over inland water bodies further progress was brought by the launch of sentinel 3a and 3b satellites which are the first missions operating globally in the open loop mode and carrying the sar radar altimeter sral in this paper we studied water levels at 34 virtual stations of the sentinel 3a satellite located within the vistula and odra basins in poland altimetric data have been acquired from the hydroweb database and cover the period from april 2016 to august 2019 the vs are located along narrow width 40 200 m and medium width 200 610 m river sections of the six biggest polish rivers vistula odra warta bug narew and san we compared water level anomalies between vs time series and measurements from two adjacent gauges one upstream and one downstream each virtual site accounting for time lags between those data sets the main conclusions are the following rmse of altimetry based water level measurements along small and medium rivers in poland ranges from 0 12 to 0 44 m with mean of 0 22 m nse of altimetry based water level reconstructions at 34 virtual sites located along small and medium polish rivers varies between 0 4 and 0 98 with mean of 0 84 for 67 out of 68 pairs of time series there is no evidence for meaningful correlation between accuracy rmse or skills nse of water level measurements carried out by sentinel 3a and river width there are no signatures of dependency between accuracy rmse or skills nse of altimetry based water level reconstructions and land cover the only environmental factors affecting the quality of altimeter measurements are the complex river channel morphology presence of inter channel sand bars etc and the unfavourable geographical setting of the vs which occurred more often at virtual sites characterized by lower nse 0 8 considering the recent launch of sentinel 3b as well as the planned launch of sentinel 3c 3d and the surface water and ocean topography swot mission it is very likely that satellite radar altimetry will continue to provide accurate inland water level measurements bridging the gap in the globally decreasing number of gauges moreover the recently updated hydroweb database contains an increased number of vs over polish rivers the database contains 74 and 54 vs for the sentinel 3a and 3b satellites respectively this facilitates the access to numerous high quality altimetry data encouraging their further exploration and use inter alia to forecast water levels and increase the knowledge about various hydrological processes 6 description of authors responsibilities m h conceived the study wrote the manuscript produced figures carried out hydrological and statistical analysis developed software formulated conclusions t n developed key function in the software contributed to the manuscript participated in the inference credit authorship contribution statement michał halicki conceptualization methodology software formal analysis investigation resources data curation writing original draft writing review editing visualization funding acquisition tomasz niedzielski conceptualization software investigation resources supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research performed in this paper has been carried out in frame of the doctoral school of the university of wrocław based on altimetric data retrieved from hydroweb as well as hydrologic data previously provided in 2019 by institute for meteorology and water management state research institute imgw pib the research work towards the revision of the manuscript i e the comparison of water levels measured by sentinel 3a retrieved from different altimetric data hubs as well as the analysis of river regulation in poland has been conducted in frame of the research project no 2020 38 e st10 00295 within the sonata bis programme of the national science centre poland the publication is partially financed by the program excellence initiative research university we acknowledge the authors of hydroweb for providing processed altimetry data we are also grateful to prof mariusz szymanowski for discussions on methodology appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j jhydrol 2021 127355 supplementary data the following are the supplementary data to this article supplementary data 1 
3636,this study is the first attempt to assess the accuracy of water levels measured by the sentinel 3a altimetry at virtual stations vs located along polish rivers the studied rivers vistula odra warta bug narew san drain predominantly lowlands and based on width can be classified as small and medium rivers 40 610 m in width the accuracy assessment is based on a comparison between water level anomalies from 34 vs and water level data from the nearest adjacent gauges acquired from april 2016 to august 2019 the time lags between water level time series vs vs gauge are estimated so that pairs of hydrographs agree in phase which enables the comparison it is found that the root mean square error ranges from 0 12 to 0 44 m with mean of 0 22 m the nash sutcliffe efficiency nse varies between 0 40 and 0 98 with mean of 0 84 for 67 pairs of time series out of 68 considered it is also argued that river width does not reveal any impact on the performance of the altimetric measurements over the study area likewise land cover has not been identified as an environmental factor to constrain the data accuracy however it is found that complex river channel morphology and unfavourable geographical setting occur more frequently at vs with lower nse 0 8 the study confirms the usability of the sentinel 3a altimetry along small and medium rivers identifies factors to constrain the accuracy and most importantly provides yet another regional scale investigation into quality of satellite radar measurements over inland waters keywords radar altimetry rivers sentinel 3a hydroweb poland 1 introduction freshwater supply is a global problem of growing importance increased water demand is not entirely driven by climate change arnell and gosling 2013 its main drivers are demographics and economic growth related to the rise of per capita consumption world water assessment programme 2009 the spatial and temporal distribution of water resources is not uniform which results in permanent and intermittent water deficit in numerous areas freshwater supply directly impacts human societies by constituting crucial resources of drinking water agricultural irrigation as well as water used by the industry therefore monitoring of continental waters is critical for water resource management and flood management coe and birkett 2004 in ancient times people explored the knowledge of rivers by observing the cyclic nature of hydrologic phenomena along with the development of measurement techniques water level monitoring became more precise and regular currently most developed countries maintain advanced hydrological services paradoxically the availability of measurements is decreasing over the recent decades vorosmarty et al 2001 calmant and seyler 2006 the main factors constraining the terrestrial water monitoring are the costs of installation and maintenance of gauging stations hannah et al 2011 the constrained access to remote areas and political issues pan and nichols 2013 hence there is a dire need for an alternative technique for measuring water levels at poorly gauged or ungauged rivers a unique opportunity to bridge this gap is provided by satellite radar altimetry originally designed to carry out absolute radar measurements of water level in open oceans benveniste 2011 altimetry is a technique for measuring height the main principle of which is the measurement of time taken by a radar pulse for the two way travel from the satellite to the surface chelton et al 2001 one of the first missions demonstrating the scientific utility of this technique were seasat geosat and ers1 launched in 1978 1985 and 1991 respectively however data acquired by those satellites were not sufficiently accurate for addressing many problems of ocean circulation fu et al 1994 the breakthrough in radar altimetry occurred in 1992 with the launch of the topex poseidon satellite its improved measurement quality resulted from the precise determination of the orbit tapley et al 1994 the topex poseidon successors jason 1 jason 2 and jason 3 offered a further improvement in data accuracy lafon 2005 vaze et al 2010 through the development of the altimetric technology it became possible to monitor inland waters including lakes wetlands and rivers e g cazenave et al 1997 crétaux and birkett 2006 silva et al 2010 crétaux et al 2011 the first attempts to determine water levels of rivers on a basis of altimetric measurements were constrained by the minimum channel width of 1 km birkett 1998 however over the past two decades several technological improvements enabled water level measurements over small water bodies with width below 200 m e g sulistioadi et al 2015 schneider et al 2018 first the development of the synthetic aperture radar sar mode enabled a better spatial resolution of the signal in the along track direction as well as the noise reduction quartly et al 2020 moreover new altimeters benefit from operating in the open loop mode which allows tracking the signal directly inside the reception window thanks to the onboard elevation data taburet et al 2020 finally numerous retracking algorithms e g the threshold retracker ocog ice 1 were developed to retrack different types of waveforms huang et al 2019 silva et al 2010 argued that the river width is not a factor limiting the quality of water level time series according to maillard et al 2015 there are currently three environmental factors that may affect the measurement 1 land cover along the satellite track in the vicinity of the river 2 river channel morphology width direction and shape as well as 3 land topography near the channel apart from the technological and environmental factors the applicability of altimetric data in inland water hydrology is limited by low spatial density of ground tracks and temporal satellite repeat cycle resolutions considering the currently operational satellites jason 3 has a 10 day sentinel 3a and sentinel 3b a 27 day and cryosat a 369 day repeat cycle with spacing between ground tracks at the equator of 315 104 and 7 5 km respectively a solution to the problem of the compromise between spatial and temporal resolution is the multi mission altimetry tourian et al 2016 used water levels derived from topex poseidon envisat saral altika cryosat 2 and jason 2 altimetric missions at 40 virtual stations intersections of a satellite ground track with a water body hereinafter abbreviated as vs located along the po river the correlation of these data with in situ measurements ranged from 0 5 to 0 8 another example of the multi mission altimetry of inland waters is presented by biancamaria et al 2017 who determined twelve vs at the garonne river retrieving water levels from the envisat saral altika and jason 2 satellites those authors investigated the satellite altimetry performance over a medium river within a steep sided valley new perspectives for measuring water surface elevation at ungauged sites have been opened with the launch of sentinel 3a on 16th february 2016 with an along track resolution of 250 m sentinel 3a possesses a great potential in monitoring water levels of inland water bodies bogning et al 2018 and normandin et al 2018 used water levels retrieved from a few altimeters including sentinel 3a to assess their performance in the ogooué river and the inner niger delta le gac et al 2021 investigated the benefits of the open loop tracking command oltc which for the sentinel 3a showed the satisfying performance and promising quality for future measurement opportunities the analysis of sentinel 3a data over mountain rivers using a number of retrackers has been conducted by huang et al 2019 and jiang et al 2020 it is thus apparent that sentinel 3a operating with a sar mode altimeter at a global scale and with the open loop tracking mode reveals a great potential for observing inland water bodies even in complex terrain although radar altimetry has been shown to be useful for measuring water levels of small and medium rivers its performance has not been subject of a comprehensive scrutiny over the vistula and odra river basins a preliminary study has been conducted by halicki 2020 who investigated the correlation between water levels based on the sentinel 3a altimetry and measurements from adjacent gauges located along polish rivers altimetry data derived from the hydroweb database online database providing continuous time series for the altimetry based levels of large lakes reservoirs and rivers for main polish rivers showed a mean correlation coefficient of 0 93 however halicki 2020 has not investigated the accuracy of altimetric radar measurement at vs located along polish rivers in general focusing on the use of altimetry in poland apart from the studies on capturing variation of the southern baltic sea e g dinardo et al 2018 pająk and kowalczyk 2019 there has not been any comprehensive investigation of the environmental factors which might affect the altimetric measurements at vs located in the vistula and odra river basins this research aims to examine the accuracy of water levels of the selected polish rivers based on altimetric data from the sentinel 3a satellite study the influence of several factors river width river channel morphology geographical setting of the vs and the land cover in its vicinity on the altimetric measurements 2 material and methods 2 1 study area the study area i e the basins of the vistula and odra rivers covers 90 of the territory of poland most of this area is characterized by low elevation slightly sloping towards the north east the only mountainous regions sudetes and carpathians are located in the southern part of the country according to the köppen climate classification the study area is characterized by the cfb temperate oceanic climate in the west and dfb warm summer humid continental climate in the east kottek et al 2006 water levels recorded along the following six biggest polish rivers are considered vistula odra warta bug narew and san fig 1 according to the classification of rivers based on width meybeck et al 1996 the studied water bodies are classified as small width 40 200 m and medium width 200 800 m rivers with length varying from 458 to 1022 km table 1 following the criteria of dynowska 1997 wrzesiński 2017 has identified five flow regimes of polish rivers four of which describe the flow of rivers considered in this study the identification of flow regimes adopted after dynowska 1997 has been based on the percentage of the average outflow in a spring or summer month in relation to the average annual outflow the flow characteristics of the san river and the southern sections of the vistula and odra rivers located in the mountains southern poland are described as the nival pluvial type both the narew and bug rivers have the nival flow regime explicitly formed the nival regime middly formed describes the flow characteristics of most of the odra vistula and warta rivers sections in central part of poland the flow characteristics of the vistula and warta rivers reveal the nival flow regime feebly formed water level maximum values occur in spring which corresponds to snow thawing period low water levels occur usually at the turn of summer and autumn 2 2 datasets 2 2 1 altimetric data altimetry is a technique of measuring height to obtain water levels from satellite radar altimetry two values are indispensable 1 the distance between the satellite and the water surface the altimeter range r measured on a basis of the round trip time of an electromagnetic wave emitted by the radar altimeter and 2 the satellite altitude h alt with reference to an ellipsoid obtained due to the precisely determined orbit to improve the measurement accuracy geophysical e g solid earth tide and polar tide and atmospheric e g ionospheric dry tropospheric and wet tropospheric corrections need to be performed the height of the reflected surface is calculated as follows 1 h waterlevel h alt r corr atmospheric corr geophysical where h waterlevel is the calculated water level h alt is the sentinel 3a altitude r is the altimeter range and corr atmospheric corr geophysical are the atmospheric and geophysical corrections sentinel 3a is an earth observation satellite launched on 16th february 2016 developed by the european space agency as a part of the copernicus programme fletcher 2012 the satellite was inserted into a sun synchronous orbit with the height of 814 5 km and the 27 day repeat cycle the orbit offers 385 ground tracks with spacing of 104 km at the equator one of the sentinel 3a onboard instruments is the synthetic aperture radar altimeter sral operating in two radar modes the low resolution mode lrm and the synthetic aperture radar sar mode the instrument uses both the ku band and the c band frequencies the two tracking modes provided in the sral design are the closed loop and the open loop mode over the entire study area the altimeter operates in the open loop mode there are several methods for obtaining altimetry based water levels using various retracking algorithms water level data over large lakes and rivers are also provided through several online data hubs e g the database for hydrological time series of inland waters dahiti https dahiti dgfi tum de en hydroweb http hydroweb theia land fr or thematic exploitation platform tep for hydrology https hydrology tep eu however at the moment of the analysis the tep for hydrology database did not contain water levels from polish rivers the dahiti database provided only measurements at two vs located in poland in this study we use the altimetric data from hydroweb altimetry based water levels of polish rivers are also available on the copernicus global land service but these measurements are calculated in a similiar approach as in hydroweb differences between water levels available in these databases do not exceed 0 5 cm for the studied vs hydroweb provides time series specified by the laboratoire d etudes en géophysique et océanographie spatiales legos and computed by collecte localisation satellites cls on behalf of centre national d etudes spatiales cnes and copernicus global land water levels of the studied rivers are computed using the offset centre of gravity ocog retracker the hydroweb altimetry data is referenced to egm 2008 geoid and corrected for solid earth tide pole tide ionospheric delay wet and dry tropospheric delay rosmorduc and vayre 2020 at the time of the analysis there had been 34 vs of the sentinel 3a satellite over the study area located along six rivers vistula 8 odra 10 warta 6 bug 5 narew 3 and san 2 fig 1 2 2 2 in situ data water levels from 40 gauges operationally measured by the institute of meteorology and water management national research institute instytut meteorologii i gospodarki wodnej państwowy instytut badawczy imgw pib are acquired in order to evaluate the quality of the altimetric data for each vs one upstream and one downstream adjacent gauge is selected fig 1 the water levels referenced to the kronsztadt 86 vertical datum are provided in csv sheet format with a time step of 10 min in case of data gaps shorter than 5 days water levels are linearly interpolated by calculating the missing values on a basis of the gap size number of 10 min steps and the vertical difference between the water levels before and after the gap for example considering a data gap of two hours 12 steps and the water levels of 150 cm and 153 cm before and after the gap we add 0 25 cm to the interpolated and adjacent measurements the reason why we chose the 5 day interpolation period was that we needed continuous 10 day time series of in situ measurements in order to calculate the time lag at each time of the satellite pass see methods due to the fact that no gaps greater than 2 days occurred at the times of the satellite passes table 2 such a considerable interpolation period did not have a meaningful impact on the comparison presented in this paper the number of cases with missing in situ data from the times of the altimetric measurement is of 57 for the interpolated datasets considering the total number of such juxtapositions 3112 which is a result of 1552 sentinel 3a measurements compared to two adjacent gauges the percentage of missing in situ data is of 1 83 the time span of gauge data ranges from april 2016 to august 2019 which corresponds to the time frame of the selected altimetric data 2 3 methods 2 3 1 comparing altimetry data with in situ measurements the process of comparing water level measurement vs vs in situ data is adopted after halicki 2020 first two adjacent gauges are assigned to each virtual station the mean distance between a vs and an in situ station is 20 12 km which indicates that the stations are sufficiently close to allow for a reliable comparison of their water levels however since the distances vary from 0 49 to 72 74 km it is essential when comparing the water levels to take into account the time shift occurring between the analysed stations the unification of times is based on a two gauge relationship first for every altimetry based water level measured at a vs the upstream and downstream gauges data sets are extracted using the 10 day moving window 5 days backward and 5 days forward from the measurement time second the cross correlation between water level time series at downstream and upstream gauges is calculated in order to estimate such a time lag for which the data sets are maximally correlated the occurrence of time lags is visualized in fig 2 which is an example of a 10 day time series recorded at two adjacent gauges before and after shifting it is apparent from the graph that water levels at these gauges are maximally correlated after the correction of the time lag of 13 5 h after computing the time lag between the time series at the adjacent gauges the time lag of water to travel between each vs and its nearest in situ stations is linearly computed using the ratio between the first distance from vs to gauge and the second distance from upstream to downstream gauge in cases of data gaps longer than 5 days the time lag is not calculated and set to 0 furthermore in situations of small water level variation when the hydrographs do not contain evident spikes of water levels recorded at both gauges the obtained time lag is set to 0 for each altimetric measurement water levels from both adjacent gauges are assigned using the estimated time lag each moment of measurement is shifted forward for downstream gauges and backward for upstream gauges in order to eliminate the time difference between the compared data sets for example let us consider an altimetric measurement taken at 08 00 am with the estimated time lags between the vs and the neighbouring gauges upstream and downstream of 5 h 10 min and 3 h 20 min respectively in such a situation we compare the obtained water level at the virtual site with the upstream gauge measurement taken at 02 50 am and the downstream gauge measurement taken at 11 20 am considering the temporal resolution of the imgw pib in situ time series 10 min altimetry based water levels every 27 days are compared with measurements taken within a short time frame before after the radar reading data processing is performed using the python programming language and its several libraries rpy2 pandas numpy datetime 2 3 2 statistical measures due to different vertical datums egm 2008 geoid for sentinel 3a data and kronsztadt 86 for in situ heights water levels are not compared directly we adopt the approach described in detail by sulistioadi et al 2015 who suggested to utilize water level anomalies instead of using absolute water level variation the anomaly calculation is based on subtracting the mean water level from the observed water level herein the sentinel 3a water level anomaly time series for a given vs is computed as a difference between the observed sentinel 3a heights measured at this vs and the corresponding mean value april 2016 august 2019 similarly in situ water level anomaly time series for a given hydrologic gauge is calculated as a difference between water levels measured at this site and their mean value april 2016 august 2019 the root mean square error rmse is calculated to measure how the satellite based water level anomalies depart from in situ anomalies it is described as 2 rmse i 1 n x i y i 2 n where x i is the sentinel 3a water level anomaly y i is in situ water level anomaly and n is the sample size to compare anomalies the nash sutcliffe efficiency nse is also used nash and sutcliffe 1970 it belongs to a few standard measures for assessing the performance of hydrologic models krause et al 2005 the nse statistics is defined by the following formula 3 nse 1 i 1 n x i y i 2 i 1 n y i y 2 where x i is the sentinel 3a water anomaly y i is in situ water level anomaly n is the sample size and y is the mean of the in situ water level anomalies the nse statistics summarizes the agreement between the observations and estimates however it does not express errors themselves but it is a measure of estimation skills therefore it enables the comparison of the performance of a given method for dissimilar rivers the nse values range between and 1 in the context of our scrutiny if the altimetry and in situ water levels agree in amplitude phase and mean nse is approximately equal to 1 if nse is about 0 it means that the satellite based estimation of water levels has skills similar to averaging in situ data negative nse values indicate that averaging data is even better approach for measuring water level than the reconstruction of heights based on sentinel 3a 2 3 3 environmental factors the obtained results are confronted with environmental factors affecting the altimetry measurements e g maillard et al 2015 as shown in fig 1 all vs are located within flat terrain with altitudes of vs ranging from 8 to 190 m a s l which is why the topographic factor is not taken into consideration the determination of land cover along the satellite ground track in the vicinity of a river is conducted using the corine land cover 2018 data and resulted in the concise information on land structure within the 1 km buffer around each vs in addition using the google earth imagery the river channel morphology and the geographical setting of each vs are studied in terms of 1 the occurrence of sandbars 2 the alignment of river channel in respect to the satellite ground tracks 3 the occurrence of multiple river crossing with the satellite ground track this enables the distinction between vs where the aforementioned circumstances occur and vs where they are not present to verify the correlation between river width and the obtained rmse nse for a given vs we calculate the pearson correlation coefficient the statistics is studied both for all of the virtual sites and separately for the vs located on small width 40 200 m and medium width 200 800 m rivers due to the small sample problem only 10 cases at medium rivers and 24 cases at small rivers instead of applying the asymptotic correlation its bootstrap version is calculated with b number of re sampling of 1 million efron 1992 3 results 3 1 the accuracy of the sentinel 3a altimetry based water levels table 3 shows the obtained rmse and nse values which are presented for each pair vs vs gauge both for upstream and downstream adjacent imgw pib station the rmse values range from 0 12 to 0 44 m with mean of 0 22 m in addition the nse values confirm a considerable quality of sentinel 3a data i e in 67 out of 68 cases nse ranges from 0 40 to 0 98 with mean of 0 84 only water level estimates obtained from the wis wis s3a 0300 01 virtual site compared to the adjacent kraków bielany gauge heights reveal a negative nse coefficient 3 29 however two barrages are located on the vistula river between these stations fig 3 which might be the reason of the negative value of nse moreover the comparison between water levels from this vs and the downstream adjacent gauge sierosławice shows a much better estimation rmse of 0 22 m and nse of 0 84 also table 3 juxtaposes river width ranging from 40 to 610 m measured on the basis of google earth imagery as well as the distance between the vs and the adjacent gauges most of the virtual sites 24 of 34 are located along narrow river channels below 200 m and nine of them are located on rivers narrower than 100 m the mean distance between vs and a neighbouring gauge is 20 12 km ranging from 0 49 to 72 74 km more than half of the pairs 37 of 68 are located less than 20 km apart a comparison between water level anomalies from the selected virtual sites and their adjacent upstream gauges is shown in fig 4 for the sake of brevity four vs were chosen which represent sites on a narrow fig 4a b and a medium fig 4c d river channel characterized by high fig 4b c and moderate fig 4a d accuracy each figure shows a good agreement between water level anomalies the time series of the ode war s3a 0386 00 and wis wis s3a 0255 00 virtual sites are characterized by low rmse 14 10 and 14 92 cm respectively and high nse both 0 97 the altimetry based water levels agree well with in situ heights both during low and high water stages and in addition both for narrow and medium river widths fig 4b c considerably lower agreement can also be found both for the narrow channel 40 m and medium channels fig 4a d despite the moderate rmse values 25 49 and 36 71 cm respectively nse showed a slightly worse agreement between altimetry and in situ data 0 64 and 0 40 respectively one of the reasons for the poor performance might be the high reflectivity of sandbars which occur on both sites fig 5 due to data gap in the międzychód gauge time series the height from ode war s3a 0386 00 measured in august 2018 has not been taken into consideration fig 4b altimetry based water level anomalies also correspond well with daily averages of water stages measured at upstream gauges fig 6 for the analysis the same set of vs was chosen as in fig 4 in most cases the sentinel 3a data fit in situ time series however there are a few periods where the altimeter has not provided data from october 2017 to may 2018 most of water level data from the ode war s3a 0728 00 virtual site differs from in situ measurements by several dozens of centimeters up to 65 cm fig 6a furthermore stages from the wis wis s3a 0300 00 virtual site from november 2018 to may 2019 also differ considerably from the reference data fig 6d in contrast the altimetry measurements presented in fig 6b c show high agreement with in situ time series without discrepancies all graphs showing water level anomalies for each of the vs compared to the water level anomalies and their daily average both from the upstream and downstream neighbouring gauges are presented in the supplementary material fig a1 a2 a3 a4 3 2 factors controlling accuracy of water level estimation at vs 3 2 1 dissimilarities between water levels from vs and neigbouring gauges altimetry based water levels estimated at vs may depart from in situ data due to several factors first the gauging stations should be located in the vicinity of vs kittel et al 2021 argued that for a suitable and direct comparison gauges should be located closer than 20 km from vs on the contrary bogning et al 2018 analysed measurements from vs located more than 100 km apart from a gauge on the ogooué river however only one in situ station was available along this river second the comparison might be affected by tributaries between the two stations for example biancamaria et al 2017 and kittel et al 2021 excluded all pairs between which there was a major tributary third the presence of hydraulic structures e g weirs dams between vs and gauge can also aggravate the agreement biancamaria et al 2017 argued that several weirs located on the garonne river between a vs and the adjacent gauge can explain the significant rmse of the alltimetry based water levels in this study we did not exclude any pair of stations vs gauge due to the above mentioned factors fig 3 shows the spatial distribution of the calculated nse values presented with 1 tributaries with length 100 km flowing into the river sections between the compared stations 2 hydraulic structures barrages and locks located between the compared stations and 3 adjacent gauges the distance from vs to the neighbouring gauge does not seem to have an impact on the obtained results bearing in mind that the stations are up to 72 74 km apart for example despite sufficient proximity water levels from the virtual site located 1 74 km downstream of the radomyśl gauge san river show one of the lowest nse value 0 66 one of the reasons might be the occurrence of sandbars moreover the nse of water levels from this vs is low either when comparing with upstream or downstream gauge data in contrast water levels from the virtual site located 26 34 km upstream of the chełmno gauge vistula river are characterized by high nse value 0 97 the occurrence of tributaries in most cases does not result in a considerably lower water level agreement for example water levels from the virtual site upstream of the santok gauge warta river show high nse 0 94 despite the major tributary noteć river flowing into the river between the compared stations in contrast the measurements from the virtual site located dowstream the słubice gauge odra river show a much worse agreement with the dowstream adjacent gauge kostrzyn nad odrą heights than with water levels recorded at the neighbouring upstream słubice gauge this might be due to the confluence of warta river to the odra river which is located between the vs and the kostrzyn nad odrą gauge only one virtual site is located in the proximity of hydraulic structures vs adjacent to the kraków bielany gauge on the vistula river and it shows a considerably lower agreement of water levels however it should be noted that the occurrence of hydraulic structures does not influence the performance of the altimetric measurement it only makes the comparison of vs heights with gauge data less legitimate since there might be discrepancies between those hydrograms due to water level regulations this inference is supported by the correlation coefficient between hydrograms at neighbouring gauges the correlation between water levels at kraków bielany and sierosławice is of 0 85 and is significantly lower than the mean correlation between hydrograms corresponding all the investigated gauge pairs 0 973 3 2 2 factors controlling altimetric measurements the use of radar altimetry over rivers is constrained by a set of limiting factors see introduction the correlation between river width and the obtained results does not show any significant relationship neither taking into account all vs nor considering separately vs located on small and medium river sections table 4 if such a relationship existed the correlation 1 between river width and rmse would have a strong negative value and 2 between river width and nse would reveal a strong positive value the highest absolute correlation between river width and rmse or nse 0 282 and 0 307 respectively is found for small rivers and for the association between virtual sites and the corresponding downstream gauges the correlation for rmse is positive and for nse is negative which suggests an inverse relationship the strength of which is weak or the relation is even not existent the results suggest no significant influence of river width on the accuracy of the altimetic data considering the river width ranging from 40 to 610 m the influence of environmental factors on the altimetric measurement has been widely described by maillard et al 2015 the land cover structure in the 1 km buffer of each vs sorted in descending order by the nse value of altimetry based time series compared to the upstream gauge measurements shows no clear relationship with the sentinel 3a data quality fig 5 most of the areas are dominated by the agricultural land type which due to low surface roughness are unfavourable for the altimetric measurement the land cover structure is similar in most of the vs buffers either with high or low nse values in terms of the river channel morphology 1 in the vicinity of 16 of 34 virtual sites sandbanks were recognized 2 the river channel parallel to the satellite ground track occurred at 6 virtual sites 3 multiple river crossing by the satellite ground track occurred at 9 vs in order to quantify the comparison we presented the summarized land cover structure for vs with higher 0 8 and lower 0 8 nse value table 5 the nse value of 0 8 has been indicated as the threshold for an efficient prognosis donigian et al 1983 as cited by moriasi et al 2007 and gupta et al 1999 each of the land cover type occupies similar portion of terrain in the two nse based classes this indicates low or even no influence of land cover on the altimetric measurement however among virtual sites with nse 0 8 the percentage of sites with the occurrence of complex river channel morphology and unfavourable geographical setting of the vs is significantly lower 56 52 than among vs with nse 0 8 81 82 it suggests that among the studied factors which may potentially control altimetric measurements over inland waters unfavourable geographical setting and river morphology mainly the presence of sand bars protruding water surface or being only slightly submerged is the only element that leads to the deterioration of altimetry skills in general it is apparent from fig 3 that the spatial distribution of nse corresponds to the degree of river regulation the highest quality of altimetric measurements is recorded for the lower warta river which was intensively regulated at the turn of 18th and 19th century kaniecki 2014 slightly worse but still skillful water level estimation is measured by sentinel 3a along the middle and lower odra river which was also meaningfully influenced by human interventions both in its middle ciszewski 2003 and lower reach kreft and parzonka 2007 due to these regulations conducted to enable inland navigation less sandbars and river islands occur within the river channels which is favourable to altimetry measurements in contrast the lowest quality of altimetric measurements is found for virtual sites located along the vistula river which is known as a natural river żelazo 2006 4 discussion altimetry based water levels of six polish rivers collected every 27 days at 34 sentinel 3a virtual sites processed by hydroweb constitute a considerable source of hydrological information the altimeter provides accurate measurements even on small river sections with width below 50 m during the nearly 3 5 years time frame data gaps occurred only in 48 of 1556 measurement epochs which corresponds to only 3 08 of readings the accuracy of the sentinel 3a water levels is considerable the obtained rmse values 0 12 0 44 m agree well with the results of other studies assessing the accuracy of sentinel 3a data in different regions table 6 however the above comparison should be made knowing the distance between vs and in situ stations jiang et al 2020 zaidi et al 2020 and kittel et al 2021 compared water levels from vs with gauges located in close proximity below 3 4 and 20 km apart respectively due to small number of gauges bogning et al 2018 and normandin et al 2018 compared water levels from sites located even over 100 km apart in this study we did not discard any vs due to the distance from the closest gauge which ranged from 0 49 to 72 74 km table 6 many authors found that topography and land cover may impact the accuracy of altimetric measurements over inland waters for instance jiang et al 2020 studied vs located along chinese rivers some of which in mountainous areas according to these authors the abruptly changing topography might aggravate the altimeter performance and cause high errors table 6 normandin et al 2018 studied the inner niger delta they argued that high errors table 6 might occur due to several river streams or floodplain lakes in the vicinity of vs which can result in the complexity of waveforms hampering the determination of range by the retracker on contrary one of the vs investigated by kittel et al 2021 despite its location on a floodplain is characterized by very low rmse 0 14 m herein we investigated vs located on flat terrain and therefore the role of topography could not be addressed indeed it is apparent from table 3 that rmse values are low 0 12 0 44 m with mean of 0 22 m with relatively low dispersion standard deviation of rmse 0 07 m similarly land cover types in the vicinity of most vs are similar and therefore it is not an important factor affecting the data quality fig 5 which stands in contrast with land cover related findings of maillard et al 2015 majority of the studies listed in table 6 assessed the accuracy of altimetry based water levels retrieved manually using various services e g the esa gpod grid processing on demand https gpod eo esa int this allowed to calculate water levels using a variety of approaches for example by applying various retrackers setting different water masks or outliers removal criteria one of a few studies on the quality of altimetric measurements over inland water based on data acquired from online hubs was conducted by schwatke et al 2015 who presented a new method for estimating water level time series over inland water bodies which forms bases for dahiti the authors analysed the accuracy of altimetric measurements carried out at 20 vs of the envisat ers 2 jason 1 jason 2 topex poseidon and saral altika satellites located in the amazon basin derived from three online data hubs dahiti hydroweb and river lake the obtained rmse was of 0 08 1 14 m 0 24 3 36 m and 0 15 3 19 m respectively for these data hubs our scrutiny is yet another example of studies on river altimetry based on data acquired from data hubs similarly to the paper by schwatke et al 2015 we processed data extracted from hydroweb however widths of the studied rivers vary considerably in our study rmse values are smaller than those presented by schwatke et al 2015 for much wider rivers although this result is promising it needs to be interpreted with caution since considerable errors on some of vs published by schwatke et al 2015 might be driven by large absolute water level variations more than 10 m the variability definitely exceeds the absolute water level variations of polish rivers another study of the altimetry based water levels from the dahiti data hub has recently been presented by scherer et al 2020 who proposed a new approach for estimating discharge using satellite altimetry and remote sensing images the authors utilized water levels of the lower mississippi river from 20 vs of various satellites among which there was 1 vs of the sentinel 3a the obtained rmse of the sentinel 3a measurements was of 0 14 m table 6 which proves the considerable quality of the dahiti data hub it should be noted however that the mississippi river is one of the world s biggest rivers incomparably larger than polish rivers we also found that there is no correlation between river width for widths 200 m and statistics for assessing the skills of water level estimation table 4 our result agrees well with findings published by silva et al 2010 and jiang et al 2020 who argued that river width is not a factor which strongly affects the quality of altimetry based water levels in this context it is worth referring to the paper by huang et al 2018 who used a different technology the jason 2 3 and envisat retracted altimetric data for monitoring brahmaputra river water levels these authors arrived at the conclusion that their retracting algorithm is suitable for rivers with widths of 300 m though they considered channel sections of 200 1000 m wide interestingly the presence of tributaries between the compared stations does not seem to aggravate the agreement between vs and in situ data fig 3 however major tributaries are perceived by other authors as objects which may impede the comparison between adjacent stations biancamaria et al 2017 kittel et al 2021 low agreement between water levels from the kraków bielany gauge and the adjacent vs could have been caused by the presence of hydraulic structures on this river section this is in agreement with the work of biancamaria et al 2017 who argue that the presence of weirs may explain a portion of water level estimation error at virtual sites again it is to be mentioned that hydraulic structures might aggravate the comparison between hydrograms but not the altimetric measurement itself the spatial distribution of nse performance of altimetry over the studied rivers is associated with the degree of river regulation fig 3 with good and considerable skills along the regulated rivers odra and warta and the mediocre performance for the natural river vistula also skills of water level reconstruction along regulated channels may be associated with river channel morphology which in our case studies is complex along the vistula river presence of extended accumulation landforms such as sandbars and less diverse along the other two rivers rare occurrence of large scale bedforms complex river channel morphology and unfavourable geographical setting of the vs occurred more often at vs characterized by lower nse 0 8 table 5 this corresponds with the findings of maillard et al 2015 who stated that the occurrence of sandbars but also river channel parallel to satellite ground track or its multiple crossing strongly influences the altimeter measurement 5 conclusions over past decades satellite radar altimetry has provided steadily improving water level measurements over inland water bodies further progress was brought by the launch of sentinel 3a and 3b satellites which are the first missions operating globally in the open loop mode and carrying the sar radar altimeter sral in this paper we studied water levels at 34 virtual stations of the sentinel 3a satellite located within the vistula and odra basins in poland altimetric data have been acquired from the hydroweb database and cover the period from april 2016 to august 2019 the vs are located along narrow width 40 200 m and medium width 200 610 m river sections of the six biggest polish rivers vistula odra warta bug narew and san we compared water level anomalies between vs time series and measurements from two adjacent gauges one upstream and one downstream each virtual site accounting for time lags between those data sets the main conclusions are the following rmse of altimetry based water level measurements along small and medium rivers in poland ranges from 0 12 to 0 44 m with mean of 0 22 m nse of altimetry based water level reconstructions at 34 virtual sites located along small and medium polish rivers varies between 0 4 and 0 98 with mean of 0 84 for 67 out of 68 pairs of time series there is no evidence for meaningful correlation between accuracy rmse or skills nse of water level measurements carried out by sentinel 3a and river width there are no signatures of dependency between accuracy rmse or skills nse of altimetry based water level reconstructions and land cover the only environmental factors affecting the quality of altimeter measurements are the complex river channel morphology presence of inter channel sand bars etc and the unfavourable geographical setting of the vs which occurred more often at virtual sites characterized by lower nse 0 8 considering the recent launch of sentinel 3b as well as the planned launch of sentinel 3c 3d and the surface water and ocean topography swot mission it is very likely that satellite radar altimetry will continue to provide accurate inland water level measurements bridging the gap in the globally decreasing number of gauges moreover the recently updated hydroweb database contains an increased number of vs over polish rivers the database contains 74 and 54 vs for the sentinel 3a and 3b satellites respectively this facilitates the access to numerous high quality altimetry data encouraging their further exploration and use inter alia to forecast water levels and increase the knowledge about various hydrological processes 6 description of authors responsibilities m h conceived the study wrote the manuscript produced figures carried out hydrological and statistical analysis developed software formulated conclusions t n developed key function in the software contributed to the manuscript participated in the inference credit authorship contribution statement michał halicki conceptualization methodology software formal analysis investigation resources data curation writing original draft writing review editing visualization funding acquisition tomasz niedzielski conceptualization software investigation resources supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research performed in this paper has been carried out in frame of the doctoral school of the university of wrocław based on altimetric data retrieved from hydroweb as well as hydrologic data previously provided in 2019 by institute for meteorology and water management state research institute imgw pib the research work towards the revision of the manuscript i e the comparison of water levels measured by sentinel 3a retrieved from different altimetric data hubs as well as the analysis of river regulation in poland has been conducted in frame of the research project no 2020 38 e st10 00295 within the sonata bis programme of the national science centre poland the publication is partially financed by the program excellence initiative research university we acknowledge the authors of hydroweb for providing processed altimetry data we are also grateful to prof mariusz szymanowski for discussions on methodology appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j jhydrol 2021 127355 supplementary data the following are the supplementary data to this article supplementary data 1 
3637,spur dike has been widely used as one of the river training structures to increase the stability of riverbanks and embankments scour around spur dikes affects their hydraulic performance and stability hence the precise calculation of scour depth variation with time at spur dikes is essential to the design of safe and economical spur dikes this study focuses on assessing the scour depth variation with time around a vertical wall spur dike in cohesive sediment mixtures using soft computing techniques based on 26 experiments performed and the data collected from existing literature specifically three novel machine learning techniques including gradient boosting decision tree gbdt cascaded forward neural network cfnn and kernel ridge regression krr were developed for accurate prediction of scour depth at the nose and wake zones of spur dikes an efficient best subset regression bsr was implemented to identify the best input combinations for two different scenarios nose and wake scenarios the results demonstrated that the gbdt model outperformed the cfnn and krr models in both scenarios in addition the sensitivity analysis based on mutual information of datasets indicated that the clay percentage pc and the ratio of cohesion to frictional angle of sediment mixture c ϕ were the most effective variables in the nose and wake scenarios respectively keywords spur dike cohesive sediments gradient boosting decision tree cascaded forward neural network kernel ridge regression 1 introduction scour occurs due to the erosive action of flowing water barbhuiya and dey 2004 kothyari and ranga raju 2001 pandey et al 2018b scour is responsible for the failure of many hydraulic structures chavan and kumar 2017 kothyari et al 2007 lodhi et al 2016 pandey et al 2018a singh et al 2020 hence it is crucial to accurately predict the scour depth around the hydraulic structures such as bridge piers abutments and spur dikes spur dikes are mainly used for reducing the flow velocity and diverting the main channel flow hager and oliveto 2002 kothyari et al 2007 the scour depth at a spur dike mainly depends on its length flow parameters and sediment characteristics azamathulla et al 2010 azamathulla et al 2008 karna et al 2015 pandey et al 2019 singh et al 2020 studies have been conducted to examine scour around spur dikes in uniform and non uniform cohesionless sediment beds bahrami yarahmadi et al 2020 duan et al 2009 ezzeldin and rageh 2018 giglou et al 2018 kothyari et al 2007 kothyari and ranga raju 2001 masjedi et al 2010 pandey et al 2020a pandey et al 2015 radan and vaghefi 2016 ying 2014 zhang et al 2018 oliveto and hager 2002 oliveto and hager 2005 kothyari et al 2007 and pandey et al 2015 pandey et al 2021 proposed dimensionless equations to calculate the scour depth variation with time around spur dikes and abutment founded cohesionless sediments and found scour depth is mainly a function of densimetric particle froude number oliveto and hager 2005 extended the study to incorporate the scour around singular and multiple spur dikes and sloping abutments founded in cohesionless sediment mixtures kothyari et al 2007 found that the scour rate around the spur dikes mainly depends on the difference between the total bed shear stress and the critical bed shear stress inception accordingly they related scour rate to the difference between the actual densimetric froude number and entrainment densimetric froude number of particles they used oliveto and hager s 2002 experimental data and proposed a new relationship for calculation the temporal variation of scour depth around spur dike in non cohesive sediments however alluvial streams often consist of both cohesive and cohesionless bed materials or a mixture of different sediments e g sand gravel clay or clay gravel mixtures jain et al 2015 lodhi et al 2016 usually a sediment mixture with clay can be found in upland catchments jain et al 2015 for a cohesive stream bed its clay percentage drainage conditions and moisture content play a significant role in scour depth prediction jain and kothyari 2009 the cohesive properties of a cohesive sediment mixture control its sediment bonding and resistance against the sediment transport jain and kothyari 2009 kothyari and jain 2010 lodhi et al 2018 for cohesive sediments it is difficult to determine an incipient condition and estimate scour depth variation due to their varying properties ansari et al 2002 kothyari and jain 2008 some studies on cohesive sediment scour have been conducted ansari et al 2007 2003 2002 briaud et al 2009 1999 jain and kothyari 2009 kothyari and jain 2008 lodhi et al 2018 lodhi et al 2016 however few efforts have been made to calculate the scour depth of a spur dike in cohesive sediments lodhi et al 2018 lodhi et al 2016 quantifying scour depth variation with time in cohesive sediments is challenging due to their complex erosion characteristics briaud et al 1999 chaudhuri et al 2018 debnath and chaudhuri 2012 ansari et al 2002a ansari et al 2007 briaud et al 2009 chaudhuri et al 2018 debnath and chaudhuri 2010a debnath and chaudhuri 2010b jain and kothyari 2009 kothyari and jain 2010 and lodhi et al 2016 lodhi et al 2018 studied local scour in cohesive sand silt clay sediment mixtures lodhi et al 2018 conducted an experimental study on temporal scour depth variation in the wake region of a spur dike in cohesive sediments the experimental outcomes showed that the scour processes and the development of scour hole were completely different than the non cohesive sediment beds they concluded that scour processes and scour hole geometry around the spur dike depend on unconfined clay content and compressive strength of cohesive sediment the spur dike scour depth decreases with increase in unconfined compressive strength and clay percentage of cohesive sediment recently soft computing techniques have been used for scour depth prediction aamir and ahmad 2019 ahmad et al 2017 ahmadianfar et al 2019 azamathulla et al 2010 kayaturk 2005 khan et al 2014 khan et al 2012 najafzadeh et al 2013 pandey et al 2020b pandey et al 2020c raikar et al 2016 thanh et al 2014 azamathulla and mohd yusoff 2013 used different soft computing techniques to predict the scour depth below river pipelines and showed good agreements with experimental values najafzadeh et al 2014 and najafzadeh and lim 2015 applied the group method of data handling to estimate the downstream scour at sluice gates and ski jump bucket spillways aamir and ahmad 2019 used the adaptive neuro fuzzy interference system anfis and artificial neural network ann for computing the maximum scour depth at the downstream of a rigid apron under wall jets and found that the anfis and ann models provided better results than previously proposed regression and empirical equations jamei and ahmadianfar 2020 performed a comprehensive ai based investigation on debris accumulation near bridge piers ahmadianfar et al 2019 developed an artificial intelligence approach for prediction of wave induced local scour depth near circular piles the objective of this study is to develop three novel machine learning approaches including gradient boosting decision tree gbdt cascaded forward neural network cfnn and kernel ridge regression krr to analyze the maximum scour depth for spur dikes in cohesive sediment beds under a clear water condition the data from 26 laboratory flume experiments with 417 temporal scour depth datasets are used in this study the performances of all soft computing models are compared and evaluated by using various statistical metrics graphical tools and some existing predictive equations as a new effort this study aims to quantify the temporal variation of scour depth around a spur dike in cohesive sediments using the soft computing based approaches 2 materials and methods for the design of spur dikes it is essential to accurately estimate scour depth variation with time under different sediment and hydraulics conditions theoretically the scour processes of spur dikes are similar to those around bridge piers and abutments except the influence of boundary layer induced by the stream wall kothyari and ranga raju 2001 2 1 dimensional considerations in a cohesive sediment mixture scour depth is mainly influenced by several cohesive sediment properties including unconfined compressive strength clay content antecedent moisture content and dry density of the sediment kothyari et al 2014 lodhi et al 2018 in compacted cohesive sediment beds clay percentage and water content are the most influential parameters ansari et al 2002 debnath and chaudhuri 2012 debnath and chaudhuri 2010a lodhi et al 2018 lodhi et al 2016 it is difficult to quantify the impact of such parameters on scour processes using analytical methods in cohesive sediments the forces between particles e g van der waals and electrostatic forces also are significant influencing factors in general van der waals forces are weaker than electromagnetic forces lodhi et al 2018 such forces resist the sediment erosion and scouring ansari et al 2002 lodhi et al 2018 the temporal variation of scour depth around a spur dike in cohesive sediments is mostly influenced by the following parameters 1 d o f p c c u d a φ c φ sh γ d γ w γ s u c s u t d e where do is the scour depth at time t in the cohesive sediment mixture pc is the clay percentage of the cohesive sediment mixture cu is the cohesion of pure clay da is the arithmetic mean size of sediments calculated by using the method by jain and kothyari 2009 φ c is the internal friction angle of the sediment φ sh is the internal friction angle of clay γ d is the dry density γ w is the specific weight of water γ s is the specific weight of the sediment ucs is the unconfined compressive strength u is the time averaged flow velocity and de is the scour depth in non cohesive sediments φ c cu t and ucs can be expressed as lodhi et al 2018 2 φ p c tan φ c 1 p c tan φ sh tan φ sh 3 c p c c u γ s γ w d a 4 t t u d a 5 uc s ucs γ s γ w d a where φ is the dimensionless frictional angle of the sediment mixture c is the dimensionless cohesion t is the dimensionless time and uc s is the dimensionless unconfined compressive strength in this study clay was added in different proportions and the value of dimensionless cohesion in various clay gravel cg and clay sand gravel csg mixtures was calculated by using the clay percentage pc thus eq 1 can be rewritten as 6 d o f p c φ c γ w γ d u c s t d e using the buckingham s π theorem eq 6 can be rearranged in a nondimensional form 7 d o d e f p c c φ u c s γ d γ w t since the parameter of γ d γ w shows a negligible effect on scour processes jain and kothyari 2010 lodhi et al 2018 it can be removed from eq 7 8 d o d e f p c c φ u c s t by normalizing the scour depth with the transverse length spur dike b eq 8 can be revised as 9 d o b f p c c φ u c s t d z in eq 9 dz can be calculated by using de kothyari et al 2007 10 d z d e b 2 y 1 3 0 272 σ 0 5 f d f db 2 3 log t where dz is the dimensionless scour depth in a non cohesive sediment mixture b is the length of the spur dike y is the depth of approaching flow σ is the geometric standard deviation of particle sizes fd is the densimetric particle froude number fdb is the densimetric particle froude number scour inception and t is the dimensionless time 2 2 experimental setup and procedure 2 2 1 flume experiment details a series of 26 experiments were carried out to measure the scour depth around a spur dike in clay gravel cg and clay sand gravel csg sediment mixtures all experiments were performed by using a rectangular flume with a fixed bed fig 1 a in the hydraulic engineering research laboratory at indian institute of technology roorkee the flume was 25 0 m long 1 0 m wide and 0 30 m deep the test section of the flume was 4 0 m long 1 0 m wide and 0 60 m deep starting from 12 0 m downstream of the flume inlet an overhead tank was used to control the flume discharge by maintaining a constant head and an ultrasonic flowmeter installed at the flume inlet pipe was used to measure the discharge the depth of approaching flow was regulated by using a tail gate which was located at the downstream end of the flume three rectangular spur dikes of different transverse lengths 0 061 m 0 089 m and 0 115 m were used in this study the surfaces of the pipes were painted to have a smooth finish for all experiments a single spur dike was fixed at the left side of the flume at a 90 angle from 14 0 m downstream to the flume entrance the test section was covered with a transparent perspex sheet to prevent scour around the spur dike once desired flow conditions were achieved the perspex sheet was removed carefully to ensure that no scour occurred due to this the variation of scour depth with time was measured by a flat bottom vernier point gauge with an accuracy of 0 1 mm the flat bottom vernier point gauge helped avoid its penetration in the scour hole during scour measurement table 1 illustrates the experimental conditions for the two different sediment mixtures i e cg and csg fig 1a illustrates the experimental setup and fig 1b shows the scour hole for run r1 2 2 2 sediment mixtures and preparation of sediment bed in the experiments two different cohesive sediment mixtures i e cg and csg were used different percentages of clay were mixed with gravel and sand gravel thus the two sediment mixtures had different properties the properties of clay and its mixtures were determined as per the indian standard code is 2720 10 1991 is 2720 29 1975 and is 1498 1970 a laser particle size analyzer was used to determine the median diameter d 50 0 0014 mm and the geometric standard deviation of particle sizes σ 2 16 in addition the plasticity index was 21 the plastic limit was 22 the liquid limit was 43 the optimum moisture content was 19 the maximum dry density was 16 43 kn m3 the cohesion at optimum moisture content was 49 23 kn m2 the angle of friction at optimum moisture content was 30 7 and the relative density was 2 65 for a non cohesive sediment the values of d50 were 2 7 mm and 0 24 mm and the values of σ were 1 21 and 1 41 for gravel and sand respectively for the cg mixture bed the clay percentage varied from 10 to 50 by weight and then the clay was mixed with gravels similarly for the csg mixture bed the clay percentage varied from 10 to 50 by weight and then it was mixed with equal amounts of sand and gravel clear water was added to the mixture and the sediments were completely mixed the prepared mixture was covered with a polythene sheet for 24 h to allow a uniform distribution of moisture the sediments were again mixed thoroughly before packing the sediment mixture into the test section the flume working section was completely filled with the prepared sediment mixture after the installation of the spur dike this flume bed was compacted in three different layers with a thickness of 0 10 m using the dynamic compaction technique ansari et al 2002a 2007 jain and kothyari 2009 all experiments were carried out for a period of 20 48 h or until an equilibrium scour condition was reached scour depths with different time intervals were measured at the upstream nose and the downstream wake of the spur dike an equilibrium scour condition was assumed to be achieved when two consecutive scour depths were found to be equal or had a difference of 0 1 cm after 2 h of measurement table 1 shows the measured data and flow conditions for the cg and csg mixtures for the nose and wake of the spur dike 2 3 field data and pre processing based on the parameters including pc c ϕ ucs and t the dimensionless scour depth do b was determined for two scenarios 1 scour depth at the nose of the spur dike and 2 scour depth at the wake of the spur dike table 2 shows the six statistical measures i e minimum maximum mean standard deviation skewness and kurtosis for all parameters in both scenarios t has the highest skewness kurtosis and standard deviation values skewness 1 927 kurtosis 5 433 and std deviation 36821679 for scenario 1 skewness 1 824 kurtosis 4 053 and std deviation 42378377 for scenario 2 fig 2 displays the matrix correlation mc for all parameters the upper diagonal mc scenario 1 indicates that pc with the highest pearson correlation 0 691 can be identified as the most efficient input parameter for predicting the scour depth at the nose of the spur dike as shown in the lower diagonal mc scenario 2 pc with a pearson correlation of 0 616 also is the most important parameter for estimating the scour depth at the wake of the spur dike it should be noted that the calculated correlation can only cover a linear behavior between the input dataset and the output to better assess the impact of each parameter on the prediction of do b the best subset regression bsr technique was utilized in this study to select the most effective input parameters for developing the data driven models ddm jamei et al 2021c according to this method four criteria including the adjusted r2 mallows coefficient cp kobayashi and sakata 1990 akaike s aic kolarević et al 2014 and schwarz s sbc schwarz 1978 were employed to choose the best combination of the input parameters in this study three combinations of the input parameters combs 1 3 were considered for both scenarios table 3 fig 3 displays the results obtained by the bsr for the two scenarios for the first scenario combo 1 and combo 2 r2 0 602 and 0 601 cp 5 000 and 5 293 aic 1097 500 and 1097 210 and sbc 1077 400 and 1081 077 respectively are selected as the best combinations for developing all data driven models for the second scenario combo 1 and combo 2 r2 0 570 and 0 570 cp 5 000 and 4 145 aic 1365 750 and 1366 594 and sbc 1334 600 and 1349 672 respectively are also chosen as the best combinations 2 4 development of soft computing approaches 2 4 1 cascaded forward neural network cfnn method an ann model consists of several layers one layer involves some neurons that are linked by using the weighting coefficients with the following layer in the ann a neuron is expressed by its activation level which is used to propagate the information from the input layer to the output layer to achieve suitable weights the ann must learn from the known input and output dataset the model calculates an error between the experimental dataset and the calculated dataset during the learning procedure therefore the values of weights can be improved by utilizing the error back propagation bp procedure until obtaining a possible smallest error consequently the trained neural network can be employed to compute other response to new inputs that have never been introduced to the ann gholizadeh et al 2020 a common feed forward neural network ffnn is formed by an input layer an output layer and one or more hidden layers the ffnn is the first topology of an ann which is applied as the bp to modify the weight connections over the learning process abujazar et al 2018 the cascade forward backpropagation neural network cfnn is similar to the ffnn zeng et al 2021 the main difference is that in the cfnn the weights of each subsequent layer coming from the previous layers and input parameters in this method there is a weighted connection from the input dataset to each layer and from each layer to the sequential layers similar to the ffnn the bp method in the cfnn includes three phases feedforward ff of the input error calculating and weight adjustment in the ff phase the information moves in only one direction forward in fact the information is transmitted through the input layer and by the hidden layer to the output layer after the ff phase the process continues with the calculation of error abujazar et al 2018 in the last phase the weights are updated and the calculations are performed again this phase is completed until the stopping criterion is met in the cfnn the bp method like the levenberg marquardt lm algorithm is used to find suitable weights that connect neurons to the others fig 4 shows the schematic of the cfnn structure 2 4 2 kernel ridge regression krr in multiple regressions determining the number of independent variables to be used in the model is challenging as the number of variables increases overfitting occurs on the other hand a decrease in the number of variables causes underfitting if too many variables are used in the regression model a higher error will be introduced in the estimated value of the dependent variable while fewer than necessary variables in the model will increase the variance of the model these problems in multiple regression can be overcome by using the ridge regression model saunders et al 1998 in which the variance of the estimates peaks when there are multiple variables the kernel ridge regression krr model is a kernel based machine learning model used for nonlinear problems an et al 2007 the krr method can effectively overcome the problem of overfitting in regression by using the tuning and kernel technique to obtain nonlinear relationships the krr model can be expressed as ali et al 2019 11 arg min 1 q o 1 q f o y o 2 λ f h 2 12 f o p 1 q α p φ x p x o where h is the hilbert norm space y is the input vector q 1 and α is the solution vector q 1 for a kernel matrix m m k can be obtained by using the selected input data ali et al 2020 13 k p o φ x p x o eq 12 can be summarized as follows 14 k λ q i y 15 y o 1 q α o φ x o x in the training step the value of α is approximated by using the solution of equation 14 which is then used for the test phase to predict the unknown value of sample x in equation 15 also the krr algorithm searches for the optimal values of α and λ from a set of parameters in krr linear polynomial and gaussian kernels are used to achieve optimal accuracy the linear polynomial and gaussian kernel relationships are respectively defined as follows ali et al 2019 16 φ x p x o x p t x o 17 φ x p x o x p t x o r d 18 φ x p x o e x p x p x o 2 2 σ 2 where t denotes the transpose of the matrix and d is the vector dimension in this research the gird search method was applied to identify the optimal kernel parameters 2 4 3 gradient boosted decision trees gbdt gradient boosting tree as a non parametric method is one of the iterative ensemble machine learning approaches which has the capabilities of solving regression and classification problems truong et al 2020 by considering vector input x x 1 x 2 x n and output y like other boosting strategy gradient boosting tree combines weak prediction models regression trees to achieve a more powerful learner with an iterative strategy in this paradigm additive decision trees as trained in regard to the whole ensemble error in a forward stage wise fashion fitting are sequentially produced a new ensemble predictive model f x based on the training sample y i x i i 1 n which is enhanced by implementing the previous information of grown trees and minimizing the predefined loss function ψ y f x as follows friedman 2001 19 f x argmin f x ψ y h x the gbdt in an iterative fashion obtains f x by an additive tree ensemble truong et al 2020 20 f x i 0 m β m h x where h x denotes the weak learner additive tree β m denotes the expansion confidents and m is the total number of trees weak learners the steps for training the gbdt model can be described as follows friedman 2001 1 start training with an initial guess f x upon f 0 x argmin γ i 1 n ψ y i γ where n denotes the training sample number 2 for m 1 m repeat steps 3 to 6 3 compute the current pseudo residual by y im ψ y i f x i f x i f m x f m 1 x 4 determine the optimal value of β m argmin γ i 1 n ψ y i f m 1 x i β h x i 5 partition the input vector x into l disjoint region r lm which is related to the mth tree and the lth terminal node regression tree thus eq 19 can rearranged in a simple form as follows 21 γ lm argmin γ xi r lm ψ y i f m 1 x i γ 6 fit a new ensemble tree model f m x by updating f m 1 x in the region of r lm as follows friedman 2001 22 f m x f m 1 x υ γ lm 1 x r lm in addition υ adjusts the learning rate of training which has a positive effect on the better generalization error fig 5 shows the schematic of the gbdt model all the stages of predicting the scour depth around a spur dike for the nose and wake scenarios are depicted in fig 6 2 5 goodness of fit criteria in this study five statistical metrics are used to assess the performances of the three data driven models i e cfnn gbdt and krr which are detailed as follows jamei et al 2021a a correlation coefficient r ahmadianfar et al 2021 23 r l 1 n d 0 b p l d 0 b p d 0 b o l d 0 b o l 1 n d 0 b p l d 0 l p 2 l 1 n d 0 b o l d 0 b o 2 1 r 1 b root mean square error rmse 24 rmse 1 n l 1 n d 0 b o l d 0 b p l 2 0 5 c mean absolute percentage error mape 25 mape 100 n l 1 n d 0 b o l d 0 b p l d s b o l d u 95 1 96 st d e 2 r m s e 2 e king gupta kge 26 kge 1 r 1 2 s t d p s t d o 1 2 d 0 b p d 0 b o 1 2 where d 0 l o l and d 0 l p l denote the l th observed and predicted normalized scour depths and d 0 b o and d 0 b p denote the mean observed and predicted normalized scour depths also n denotes the number of datasets and stde is the standard deviation of the errors 2 6 sensitivity analysis to identify the most sensitive input parameters to predict scour depth it is essential to carry out correlation and regression analyses as stated in section 3 the most important input parameter to estimate scour depth was t for both scenarios since there is a nonlinear relationship between the input parameters and the output it is necessary to implement a robust sensitivity analysis in this study the mutual information mi was employed for determining the most influential variables for each scenario the mi between two parameters w and v can be expressed as huoh 2013 27 m i w v s w s w v in which the entropy of the parameters w and v are described as probability p x which is given by huoh 2013 28 s w w x l o g p x p x 29 s w v x w p x x y v l o g p y x p y x where p x x denotes the marginal distribution for p x x y v p x y and the conditional distribution of parameter y for given can be expressed as p y x p y x p x x a low mi shows a small reduction in uncertainty a high mi implies a large reduction and a zero mi indicates that two parameters are independent 2 7 outlier detection and applicability domain outlier observations are the data that are usually far from the main bulk of the data outlier data introduce uncertainties that can affect the prediction of a model varamesh et al 2017 thus outlier data must be identified one of the most commonly used methods for identifying the outliers is the leverage approach in which the values of the leverage index are defined as the diagonal elements of the following matrix rehamnia et al n d rousseeuw and leroy 2005 30 h x x t x x 1 where x is a matrix n k n is the number of samples and k is the number of variables in the model the standardized residual sr values are defined as the percentage of the standardized difference between the observed data and the data obtained from the model jamei et al 2021b to identify outliers the leverage index is plotted against the standardized residual williams plot the values of sr 3 are the criteria used for detecting outliers the critical value of the leverage index h is also considered to be 3 p n where p is the number of input variables k plus one and n is the total number of data used in the development of the model if the value of the leverage index of the prediction is higher than h the prediction will not be reliable varamesh et al 2017 therefore if most of the data are in the range of 3 s r 3 and 0 h h it can be concluded that the data used for the development of the model as well as the predicted values are in the applicability domain and the developed model is statistically valid rousseeuw and leroy 2005 3 results and discussion in this research three ddms were developed to predict the scour depths at the nose and wake of a spur dike the percentage of clay pc dimensionless time t dimensionless ratio of cohesion to angle of friction c ϕ and dimensionless unconfined compressive strength of cohesive sediment mixture ucs were selected as independent variables to predict the scour depths at the nose scenario 1 and the wake scenario 2 of the spur dike in cohesive sediment mixtures for each scenario two superior combinations obtaining from the best subset selection were examined to identify the best outcome from the predictive models 3 1 nose scenario table 3 lists the statistical metrics of the cfnn gbdt and krr models for the training testing and all datasets for combo 1 cfnn r 0 9794 rmse 0 0842 kge 0 9758 and u95 0 8333 had a slightly better performance in the testing phase than gbdt r 0 9786 rmse 0 0890 and u95 0 8295 and krr r 0 9680 rmse 0 1081 and u95 0 8207 however gbdt with a smaller mape 17 2142 achieved the same accuracy as that of cfnn besides gbdt with the highest r 0 9875 and kge 0 9736 and the lowest error metrics rmse 0 0666 and mape 15 8569 outperformed cfnn r 0 9856 and rmse 0 0714 and krr r 0 9722 and rmse 0 0989 in the prediction of scour depth at the nose of the spur dike in all dataset for combo 2 gbdt which had the best performance in the training r 0 9928 and kge 0 9761 testing r 0 9717 and kge 0 9529 and all dataset r 0 9874 and kge 0 9709 was identified as the superior predictive model followed by cfnn and krr thus the gbdt and cfnn models achieved higher accuracy in comb 1 than that of combo 2 whereas krr showed a better performance in combo 2 furthermore in terms of the r values cfnn r 0 9856 for combo 1 and r 0 9739 for combo 2 yielded better results than krr r 0 9722 for combo 1 and r 0 9609 for combo 2 fig 7 shows the scatter plot of the predicted results from the three ddms for both selective combinations the values of do b estimated by the gbdt and cfnn models exhibit better agreement with the observed data than those from the krr model for both combinations it can be observed that the majority of the data points of the gbdt model for both selective combinations fall within the benchmark error lines 25 and 25 thus gbdt yielded more reliable results than cfnn and krr overall combo 1 was identified as the best combination in the prediction of normalized scour depth at the nose of the spur dike in cohesive sediment mixtures to assess the robustness of the three ddms the distribution functions of the observed and predicted normalized scour depths based on different quartile criteria q25 mean q75 and iqr were created for the best combination combo 1 fig 8 it can be found that gbdt and cfnn q25 0 102 and 0 100 respectively which were closest to the observed q25 0 101 yielded more accurate predictions of scour depth in the nose scenario also the gbdt and cfnn models with iqr values of 0 581 and 0 589 respectively were in good agreement with the observational value iqr 0 585 in the validation stage of the three ddms the relative deviation rd functions were determined to assess the precision of the predictions for combo 1 fig 9 illustrated the results of error analysis including the probability density of rd for each model left column and the variability of rd versus the observed do b right column in the nose scenario according to the rd band gbdt 262 6 and 182 5 for the training and testing respectively outperformed cfnn training 514 6 and test 281 2 and krr training 612 3 and test 672 it should be noted that most rd values for the three ddms occurred in a range of do b 0 0 5 fig 10 displays the cumulative frequency of absolute relative deviation cfard of each predictive model in the best combination of the nose scenario for all datasets the results indicated that more than 70 of the data points predicted by the three ddms had a value of rd equal to or smaller than 15 which confirmed that the three ddms had the same performance and acceptable accuracy in the prediction of normalized scour depth at the nose of the spur dike the accuracy assessment for the three models demonstrated that less than 7 of the data points had a value of rd greater than or equal to 50 3 2 wake scenario table 4 shows the results of combs 1 and 2 for the cfnn gbdt and krr models in the wake scenario the values of correlation coefficient and mape for the testing phase in combo 1 revealed that the performance order follows gbdt r 0 9843 and mape 22 0909 cfnn r 0 9772 and mape 22 8637 and krr r 0 9711and mape 26 8115 in terms of correlation coefficient rmse and kge for comb 2 gbdt training r 0 9947 rmse 0 0412 and kge 0 9856 testing r 0 9852 rmse 0 0657 and kge 0 9664 provided more reliable results than cfnn testing r 0 9687 and rmse 0 0940 and krr testing r 0 9689 and rmse 0 0944 overall the performances of all models were better for combo 1 that those for combo 2 fig 11 depicts that gbdt in both combinations had the best fit in comparison with cfnn and krr in combo 1 i e optimal input combination cfnn and krr had similar performance in terms of accuracy and efficiency however cfnn was the second best model for the prediction of scour depth at the wake zone of the spur dike to further evaluate the accuracy of the three ddms in the wake scenario for combo 1 the probability distribution functions of rd of the observed and predicted normalized scour depths were calculated fig 12 according to the criteria of q50 and iqr gbdt mean 0 357 and iqr 0 613 and cfnn mean 0 361 and iqr 0 615 in comparison with the observed data mean 0 346 and iqr 0 634 are the most promising models the probability density and variability of rd versus the observed do b in combo 1 optimal combination are illustrated in fig 13 indicating that gbdt training 131 8 testing 324 achieved more promising performance than cfnn training 476 6 testing 482 5 and krr training 625 9 testing 950 5 fig 14 shows the cfard obtained from the three ddms for all datasets indicating that more than 60 of the data points predicted by the three ddms had a value of rd equal to or smaller than 15 which confirmed that all the three ddms had similar performance and acceptable accuracy in the prediction of normalized scour depths at the nose of the spur dike however gbdt with the highest reliability was identified as the most precise model followed by cfnn and krr 3 3 discussion in this research three ddms were developed for predicting scour depth at the nose and wake zone of spur dikes in cohesive sediment mixtures it has been demonstrated that combo 1 including pc t c ϕ and ucs as input variables in the wake scenario was superior to combo 2 including pc t and ucs in the nose scenario cfnn and gbdt had the best performance in combo 1 whereas krr had better performance in comb 2 than that in combo 1 in the wake scenario gbdt in both scenarios rnose 0 9875 and rwake 0 9947 was selected as the best model for the prediction of normalized scour depth around the spur dike in cohesive sediment mixtures cfnn rnose 0 9856 and rwake 0 9803 and krr rnose 0 9722 and rwake 0 9741 can be used as a reliable tool with acceptable accuracy as a suggestion for future research the stacked generalization models can be explored for blending the advantages of standalone learners and consequently enhancing the accuracy of modeling it also should be noted that the reliability and validity of the three ddms presented herein were assessed only for the range of the data used in the modeling of normalized scour depths around spur dikes in the cohesive sediment mixture 3 4 sensitivity analysis results the mi values of all parameters variables for the two scenarios are listed in table 5 the most effective parameters for the first scenario were pc mi 0 474 and c ϕ mi 0 410 while the most sensitive parameter for the second scenario was c ϕ mi 0 338 the results demonstrated that the most important input parameters for the two scenarios also varied with different selective combinations table 6 3 5 results of outlier detection and applicability domain in the present study the leverage approach was used to evaluate the reliability of the developed ddms figs 15 and 16 show the williams plots of the estimated nose and wake scour depths respectively indicating that there was no data in the range of 3 s r 3 and thus there was no outlier data in the dataset for model development as shown in figs 15 and 16 some data were in the range of h h implying that the prediction was not reliable but the ratio of the number of those data to the total number of the data was very small therefore according to the results obtained from the leverage approach it can be concluded that the developed models i e krr gbt and cfnn had no outlier data and their predictions also were statistically valid 4 conclusion in this study a comprehensive ml based investigation was conducted to predict the temporal changes in scour depth around the vertical wall spur dike in cohesive sediment mixtures for two critical zones nose and wake for this purpose three ml models including cfnn gbdt and krr were developed the datasets used to develop the models included 417 samples for the nose scenario and 508 series of laboratory data for the wake scenario four dimensionless parameters including percentage of clay pc dimensionless time t dimensionless ratio of cohesion to the angle of friction c ϕ and dimensionless unconfined compressive strength of the cohesive sediment mixture ucs were considered as the model inputs and the normalized scour depths d 0 b at the nose and wake were the model output in the nose scenario scenario 1 the gbdt model with the first input combination combo 1 for all the datasets achieved the highest accuracy r 0 9875 rmse 0 0666 and u95 0 8179 for all the three models the first combination of input parameters combo 1 yielded more accurate results than combo 2 in the wake scenario scenario 2 the gbdt model with combo 1 for all the datasets showed the best performance r 0 9947 rmse 0 0407 and u95 0 7711 like scenario 1 combo 1 also resulted in highly accurate predictions in scenario 2 the modeling results demonstrated that all the models achieved acceptable accuracy in ranges of 0 d o b 0 75 and 0 d o b 1 for the nose and wake scenarios respectively to identify the most sensitive input parameters to estimate scour depth the mutual information was employed according to the mi the c ϕ was identified as the most effective parameter for both scenarios the results indicated that the most effective parameters for the first scenario were pc mi 0 474 and c ϕ mi 0 410 and the most important parameter for the second scenario was c ϕ mi 0 338 this study demonstrated that the most important input parameters for both scenarios were dependent on the combinations of input parameters finally to detect possible outlier data and model applicability domain the leverage approach was used and the results showed that only a small percentage of the data fell out of the applicability domain of the models and no outlier data was observed credit authorship contribution statement manish pandey writing review experimentation editing formal analysis mehdi jamei conceptualization software visualization writing review editing formal analysis supervision project leader iman ahmadianfar writing original draft methodology writing review editing supervision masoud karbasi investigation writing original draft writing review editing a s lodhi writing original draft experimentation methodology writing review editing xuefeng chu writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
3637,spur dike has been widely used as one of the river training structures to increase the stability of riverbanks and embankments scour around spur dikes affects their hydraulic performance and stability hence the precise calculation of scour depth variation with time at spur dikes is essential to the design of safe and economical spur dikes this study focuses on assessing the scour depth variation with time around a vertical wall spur dike in cohesive sediment mixtures using soft computing techniques based on 26 experiments performed and the data collected from existing literature specifically three novel machine learning techniques including gradient boosting decision tree gbdt cascaded forward neural network cfnn and kernel ridge regression krr were developed for accurate prediction of scour depth at the nose and wake zones of spur dikes an efficient best subset regression bsr was implemented to identify the best input combinations for two different scenarios nose and wake scenarios the results demonstrated that the gbdt model outperformed the cfnn and krr models in both scenarios in addition the sensitivity analysis based on mutual information of datasets indicated that the clay percentage pc and the ratio of cohesion to frictional angle of sediment mixture c ϕ were the most effective variables in the nose and wake scenarios respectively keywords spur dike cohesive sediments gradient boosting decision tree cascaded forward neural network kernel ridge regression 1 introduction scour occurs due to the erosive action of flowing water barbhuiya and dey 2004 kothyari and ranga raju 2001 pandey et al 2018b scour is responsible for the failure of many hydraulic structures chavan and kumar 2017 kothyari et al 2007 lodhi et al 2016 pandey et al 2018a singh et al 2020 hence it is crucial to accurately predict the scour depth around the hydraulic structures such as bridge piers abutments and spur dikes spur dikes are mainly used for reducing the flow velocity and diverting the main channel flow hager and oliveto 2002 kothyari et al 2007 the scour depth at a spur dike mainly depends on its length flow parameters and sediment characteristics azamathulla et al 2010 azamathulla et al 2008 karna et al 2015 pandey et al 2019 singh et al 2020 studies have been conducted to examine scour around spur dikes in uniform and non uniform cohesionless sediment beds bahrami yarahmadi et al 2020 duan et al 2009 ezzeldin and rageh 2018 giglou et al 2018 kothyari et al 2007 kothyari and ranga raju 2001 masjedi et al 2010 pandey et al 2020a pandey et al 2015 radan and vaghefi 2016 ying 2014 zhang et al 2018 oliveto and hager 2002 oliveto and hager 2005 kothyari et al 2007 and pandey et al 2015 pandey et al 2021 proposed dimensionless equations to calculate the scour depth variation with time around spur dikes and abutment founded cohesionless sediments and found scour depth is mainly a function of densimetric particle froude number oliveto and hager 2005 extended the study to incorporate the scour around singular and multiple spur dikes and sloping abutments founded in cohesionless sediment mixtures kothyari et al 2007 found that the scour rate around the spur dikes mainly depends on the difference between the total bed shear stress and the critical bed shear stress inception accordingly they related scour rate to the difference between the actual densimetric froude number and entrainment densimetric froude number of particles they used oliveto and hager s 2002 experimental data and proposed a new relationship for calculation the temporal variation of scour depth around spur dike in non cohesive sediments however alluvial streams often consist of both cohesive and cohesionless bed materials or a mixture of different sediments e g sand gravel clay or clay gravel mixtures jain et al 2015 lodhi et al 2016 usually a sediment mixture with clay can be found in upland catchments jain et al 2015 for a cohesive stream bed its clay percentage drainage conditions and moisture content play a significant role in scour depth prediction jain and kothyari 2009 the cohesive properties of a cohesive sediment mixture control its sediment bonding and resistance against the sediment transport jain and kothyari 2009 kothyari and jain 2010 lodhi et al 2018 for cohesive sediments it is difficult to determine an incipient condition and estimate scour depth variation due to their varying properties ansari et al 2002 kothyari and jain 2008 some studies on cohesive sediment scour have been conducted ansari et al 2007 2003 2002 briaud et al 2009 1999 jain and kothyari 2009 kothyari and jain 2008 lodhi et al 2018 lodhi et al 2016 however few efforts have been made to calculate the scour depth of a spur dike in cohesive sediments lodhi et al 2018 lodhi et al 2016 quantifying scour depth variation with time in cohesive sediments is challenging due to their complex erosion characteristics briaud et al 1999 chaudhuri et al 2018 debnath and chaudhuri 2012 ansari et al 2002a ansari et al 2007 briaud et al 2009 chaudhuri et al 2018 debnath and chaudhuri 2010a debnath and chaudhuri 2010b jain and kothyari 2009 kothyari and jain 2010 and lodhi et al 2016 lodhi et al 2018 studied local scour in cohesive sand silt clay sediment mixtures lodhi et al 2018 conducted an experimental study on temporal scour depth variation in the wake region of a spur dike in cohesive sediments the experimental outcomes showed that the scour processes and the development of scour hole were completely different than the non cohesive sediment beds they concluded that scour processes and scour hole geometry around the spur dike depend on unconfined clay content and compressive strength of cohesive sediment the spur dike scour depth decreases with increase in unconfined compressive strength and clay percentage of cohesive sediment recently soft computing techniques have been used for scour depth prediction aamir and ahmad 2019 ahmad et al 2017 ahmadianfar et al 2019 azamathulla et al 2010 kayaturk 2005 khan et al 2014 khan et al 2012 najafzadeh et al 2013 pandey et al 2020b pandey et al 2020c raikar et al 2016 thanh et al 2014 azamathulla and mohd yusoff 2013 used different soft computing techniques to predict the scour depth below river pipelines and showed good agreements with experimental values najafzadeh et al 2014 and najafzadeh and lim 2015 applied the group method of data handling to estimate the downstream scour at sluice gates and ski jump bucket spillways aamir and ahmad 2019 used the adaptive neuro fuzzy interference system anfis and artificial neural network ann for computing the maximum scour depth at the downstream of a rigid apron under wall jets and found that the anfis and ann models provided better results than previously proposed regression and empirical equations jamei and ahmadianfar 2020 performed a comprehensive ai based investigation on debris accumulation near bridge piers ahmadianfar et al 2019 developed an artificial intelligence approach for prediction of wave induced local scour depth near circular piles the objective of this study is to develop three novel machine learning approaches including gradient boosting decision tree gbdt cascaded forward neural network cfnn and kernel ridge regression krr to analyze the maximum scour depth for spur dikes in cohesive sediment beds under a clear water condition the data from 26 laboratory flume experiments with 417 temporal scour depth datasets are used in this study the performances of all soft computing models are compared and evaluated by using various statistical metrics graphical tools and some existing predictive equations as a new effort this study aims to quantify the temporal variation of scour depth around a spur dike in cohesive sediments using the soft computing based approaches 2 materials and methods for the design of spur dikes it is essential to accurately estimate scour depth variation with time under different sediment and hydraulics conditions theoretically the scour processes of spur dikes are similar to those around bridge piers and abutments except the influence of boundary layer induced by the stream wall kothyari and ranga raju 2001 2 1 dimensional considerations in a cohesive sediment mixture scour depth is mainly influenced by several cohesive sediment properties including unconfined compressive strength clay content antecedent moisture content and dry density of the sediment kothyari et al 2014 lodhi et al 2018 in compacted cohesive sediment beds clay percentage and water content are the most influential parameters ansari et al 2002 debnath and chaudhuri 2012 debnath and chaudhuri 2010a lodhi et al 2018 lodhi et al 2016 it is difficult to quantify the impact of such parameters on scour processes using analytical methods in cohesive sediments the forces between particles e g van der waals and electrostatic forces also are significant influencing factors in general van der waals forces are weaker than electromagnetic forces lodhi et al 2018 such forces resist the sediment erosion and scouring ansari et al 2002 lodhi et al 2018 the temporal variation of scour depth around a spur dike in cohesive sediments is mostly influenced by the following parameters 1 d o f p c c u d a φ c φ sh γ d γ w γ s u c s u t d e where do is the scour depth at time t in the cohesive sediment mixture pc is the clay percentage of the cohesive sediment mixture cu is the cohesion of pure clay da is the arithmetic mean size of sediments calculated by using the method by jain and kothyari 2009 φ c is the internal friction angle of the sediment φ sh is the internal friction angle of clay γ d is the dry density γ w is the specific weight of water γ s is the specific weight of the sediment ucs is the unconfined compressive strength u is the time averaged flow velocity and de is the scour depth in non cohesive sediments φ c cu t and ucs can be expressed as lodhi et al 2018 2 φ p c tan φ c 1 p c tan φ sh tan φ sh 3 c p c c u γ s γ w d a 4 t t u d a 5 uc s ucs γ s γ w d a where φ is the dimensionless frictional angle of the sediment mixture c is the dimensionless cohesion t is the dimensionless time and uc s is the dimensionless unconfined compressive strength in this study clay was added in different proportions and the value of dimensionless cohesion in various clay gravel cg and clay sand gravel csg mixtures was calculated by using the clay percentage pc thus eq 1 can be rewritten as 6 d o f p c φ c γ w γ d u c s t d e using the buckingham s π theorem eq 6 can be rearranged in a nondimensional form 7 d o d e f p c c φ u c s γ d γ w t since the parameter of γ d γ w shows a negligible effect on scour processes jain and kothyari 2010 lodhi et al 2018 it can be removed from eq 7 8 d o d e f p c c φ u c s t by normalizing the scour depth with the transverse length spur dike b eq 8 can be revised as 9 d o b f p c c φ u c s t d z in eq 9 dz can be calculated by using de kothyari et al 2007 10 d z d e b 2 y 1 3 0 272 σ 0 5 f d f db 2 3 log t where dz is the dimensionless scour depth in a non cohesive sediment mixture b is the length of the spur dike y is the depth of approaching flow σ is the geometric standard deviation of particle sizes fd is the densimetric particle froude number fdb is the densimetric particle froude number scour inception and t is the dimensionless time 2 2 experimental setup and procedure 2 2 1 flume experiment details a series of 26 experiments were carried out to measure the scour depth around a spur dike in clay gravel cg and clay sand gravel csg sediment mixtures all experiments were performed by using a rectangular flume with a fixed bed fig 1 a in the hydraulic engineering research laboratory at indian institute of technology roorkee the flume was 25 0 m long 1 0 m wide and 0 30 m deep the test section of the flume was 4 0 m long 1 0 m wide and 0 60 m deep starting from 12 0 m downstream of the flume inlet an overhead tank was used to control the flume discharge by maintaining a constant head and an ultrasonic flowmeter installed at the flume inlet pipe was used to measure the discharge the depth of approaching flow was regulated by using a tail gate which was located at the downstream end of the flume three rectangular spur dikes of different transverse lengths 0 061 m 0 089 m and 0 115 m were used in this study the surfaces of the pipes were painted to have a smooth finish for all experiments a single spur dike was fixed at the left side of the flume at a 90 angle from 14 0 m downstream to the flume entrance the test section was covered with a transparent perspex sheet to prevent scour around the spur dike once desired flow conditions were achieved the perspex sheet was removed carefully to ensure that no scour occurred due to this the variation of scour depth with time was measured by a flat bottom vernier point gauge with an accuracy of 0 1 mm the flat bottom vernier point gauge helped avoid its penetration in the scour hole during scour measurement table 1 illustrates the experimental conditions for the two different sediment mixtures i e cg and csg fig 1a illustrates the experimental setup and fig 1b shows the scour hole for run r1 2 2 2 sediment mixtures and preparation of sediment bed in the experiments two different cohesive sediment mixtures i e cg and csg were used different percentages of clay were mixed with gravel and sand gravel thus the two sediment mixtures had different properties the properties of clay and its mixtures were determined as per the indian standard code is 2720 10 1991 is 2720 29 1975 and is 1498 1970 a laser particle size analyzer was used to determine the median diameter d 50 0 0014 mm and the geometric standard deviation of particle sizes σ 2 16 in addition the plasticity index was 21 the plastic limit was 22 the liquid limit was 43 the optimum moisture content was 19 the maximum dry density was 16 43 kn m3 the cohesion at optimum moisture content was 49 23 kn m2 the angle of friction at optimum moisture content was 30 7 and the relative density was 2 65 for a non cohesive sediment the values of d50 were 2 7 mm and 0 24 mm and the values of σ were 1 21 and 1 41 for gravel and sand respectively for the cg mixture bed the clay percentage varied from 10 to 50 by weight and then the clay was mixed with gravels similarly for the csg mixture bed the clay percentage varied from 10 to 50 by weight and then it was mixed with equal amounts of sand and gravel clear water was added to the mixture and the sediments were completely mixed the prepared mixture was covered with a polythene sheet for 24 h to allow a uniform distribution of moisture the sediments were again mixed thoroughly before packing the sediment mixture into the test section the flume working section was completely filled with the prepared sediment mixture after the installation of the spur dike this flume bed was compacted in three different layers with a thickness of 0 10 m using the dynamic compaction technique ansari et al 2002a 2007 jain and kothyari 2009 all experiments were carried out for a period of 20 48 h or until an equilibrium scour condition was reached scour depths with different time intervals were measured at the upstream nose and the downstream wake of the spur dike an equilibrium scour condition was assumed to be achieved when two consecutive scour depths were found to be equal or had a difference of 0 1 cm after 2 h of measurement table 1 shows the measured data and flow conditions for the cg and csg mixtures for the nose and wake of the spur dike 2 3 field data and pre processing based on the parameters including pc c ϕ ucs and t the dimensionless scour depth do b was determined for two scenarios 1 scour depth at the nose of the spur dike and 2 scour depth at the wake of the spur dike table 2 shows the six statistical measures i e minimum maximum mean standard deviation skewness and kurtosis for all parameters in both scenarios t has the highest skewness kurtosis and standard deviation values skewness 1 927 kurtosis 5 433 and std deviation 36821679 for scenario 1 skewness 1 824 kurtosis 4 053 and std deviation 42378377 for scenario 2 fig 2 displays the matrix correlation mc for all parameters the upper diagonal mc scenario 1 indicates that pc with the highest pearson correlation 0 691 can be identified as the most efficient input parameter for predicting the scour depth at the nose of the spur dike as shown in the lower diagonal mc scenario 2 pc with a pearson correlation of 0 616 also is the most important parameter for estimating the scour depth at the wake of the spur dike it should be noted that the calculated correlation can only cover a linear behavior between the input dataset and the output to better assess the impact of each parameter on the prediction of do b the best subset regression bsr technique was utilized in this study to select the most effective input parameters for developing the data driven models ddm jamei et al 2021c according to this method four criteria including the adjusted r2 mallows coefficient cp kobayashi and sakata 1990 akaike s aic kolarević et al 2014 and schwarz s sbc schwarz 1978 were employed to choose the best combination of the input parameters in this study three combinations of the input parameters combs 1 3 were considered for both scenarios table 3 fig 3 displays the results obtained by the bsr for the two scenarios for the first scenario combo 1 and combo 2 r2 0 602 and 0 601 cp 5 000 and 5 293 aic 1097 500 and 1097 210 and sbc 1077 400 and 1081 077 respectively are selected as the best combinations for developing all data driven models for the second scenario combo 1 and combo 2 r2 0 570 and 0 570 cp 5 000 and 4 145 aic 1365 750 and 1366 594 and sbc 1334 600 and 1349 672 respectively are also chosen as the best combinations 2 4 development of soft computing approaches 2 4 1 cascaded forward neural network cfnn method an ann model consists of several layers one layer involves some neurons that are linked by using the weighting coefficients with the following layer in the ann a neuron is expressed by its activation level which is used to propagate the information from the input layer to the output layer to achieve suitable weights the ann must learn from the known input and output dataset the model calculates an error between the experimental dataset and the calculated dataset during the learning procedure therefore the values of weights can be improved by utilizing the error back propagation bp procedure until obtaining a possible smallest error consequently the trained neural network can be employed to compute other response to new inputs that have never been introduced to the ann gholizadeh et al 2020 a common feed forward neural network ffnn is formed by an input layer an output layer and one or more hidden layers the ffnn is the first topology of an ann which is applied as the bp to modify the weight connections over the learning process abujazar et al 2018 the cascade forward backpropagation neural network cfnn is similar to the ffnn zeng et al 2021 the main difference is that in the cfnn the weights of each subsequent layer coming from the previous layers and input parameters in this method there is a weighted connection from the input dataset to each layer and from each layer to the sequential layers similar to the ffnn the bp method in the cfnn includes three phases feedforward ff of the input error calculating and weight adjustment in the ff phase the information moves in only one direction forward in fact the information is transmitted through the input layer and by the hidden layer to the output layer after the ff phase the process continues with the calculation of error abujazar et al 2018 in the last phase the weights are updated and the calculations are performed again this phase is completed until the stopping criterion is met in the cfnn the bp method like the levenberg marquardt lm algorithm is used to find suitable weights that connect neurons to the others fig 4 shows the schematic of the cfnn structure 2 4 2 kernel ridge regression krr in multiple regressions determining the number of independent variables to be used in the model is challenging as the number of variables increases overfitting occurs on the other hand a decrease in the number of variables causes underfitting if too many variables are used in the regression model a higher error will be introduced in the estimated value of the dependent variable while fewer than necessary variables in the model will increase the variance of the model these problems in multiple regression can be overcome by using the ridge regression model saunders et al 1998 in which the variance of the estimates peaks when there are multiple variables the kernel ridge regression krr model is a kernel based machine learning model used for nonlinear problems an et al 2007 the krr method can effectively overcome the problem of overfitting in regression by using the tuning and kernel technique to obtain nonlinear relationships the krr model can be expressed as ali et al 2019 11 arg min 1 q o 1 q f o y o 2 λ f h 2 12 f o p 1 q α p φ x p x o where h is the hilbert norm space y is the input vector q 1 and α is the solution vector q 1 for a kernel matrix m m k can be obtained by using the selected input data ali et al 2020 13 k p o φ x p x o eq 12 can be summarized as follows 14 k λ q i y 15 y o 1 q α o φ x o x in the training step the value of α is approximated by using the solution of equation 14 which is then used for the test phase to predict the unknown value of sample x in equation 15 also the krr algorithm searches for the optimal values of α and λ from a set of parameters in krr linear polynomial and gaussian kernels are used to achieve optimal accuracy the linear polynomial and gaussian kernel relationships are respectively defined as follows ali et al 2019 16 φ x p x o x p t x o 17 φ x p x o x p t x o r d 18 φ x p x o e x p x p x o 2 2 σ 2 where t denotes the transpose of the matrix and d is the vector dimension in this research the gird search method was applied to identify the optimal kernel parameters 2 4 3 gradient boosted decision trees gbdt gradient boosting tree as a non parametric method is one of the iterative ensemble machine learning approaches which has the capabilities of solving regression and classification problems truong et al 2020 by considering vector input x x 1 x 2 x n and output y like other boosting strategy gradient boosting tree combines weak prediction models regression trees to achieve a more powerful learner with an iterative strategy in this paradigm additive decision trees as trained in regard to the whole ensemble error in a forward stage wise fashion fitting are sequentially produced a new ensemble predictive model f x based on the training sample y i x i i 1 n which is enhanced by implementing the previous information of grown trees and minimizing the predefined loss function ψ y f x as follows friedman 2001 19 f x argmin f x ψ y h x the gbdt in an iterative fashion obtains f x by an additive tree ensemble truong et al 2020 20 f x i 0 m β m h x where h x denotes the weak learner additive tree β m denotes the expansion confidents and m is the total number of trees weak learners the steps for training the gbdt model can be described as follows friedman 2001 1 start training with an initial guess f x upon f 0 x argmin γ i 1 n ψ y i γ where n denotes the training sample number 2 for m 1 m repeat steps 3 to 6 3 compute the current pseudo residual by y im ψ y i f x i f x i f m x f m 1 x 4 determine the optimal value of β m argmin γ i 1 n ψ y i f m 1 x i β h x i 5 partition the input vector x into l disjoint region r lm which is related to the mth tree and the lth terminal node regression tree thus eq 19 can rearranged in a simple form as follows 21 γ lm argmin γ xi r lm ψ y i f m 1 x i γ 6 fit a new ensemble tree model f m x by updating f m 1 x in the region of r lm as follows friedman 2001 22 f m x f m 1 x υ γ lm 1 x r lm in addition υ adjusts the learning rate of training which has a positive effect on the better generalization error fig 5 shows the schematic of the gbdt model all the stages of predicting the scour depth around a spur dike for the nose and wake scenarios are depicted in fig 6 2 5 goodness of fit criteria in this study five statistical metrics are used to assess the performances of the three data driven models i e cfnn gbdt and krr which are detailed as follows jamei et al 2021a a correlation coefficient r ahmadianfar et al 2021 23 r l 1 n d 0 b p l d 0 b p d 0 b o l d 0 b o l 1 n d 0 b p l d 0 l p 2 l 1 n d 0 b o l d 0 b o 2 1 r 1 b root mean square error rmse 24 rmse 1 n l 1 n d 0 b o l d 0 b p l 2 0 5 c mean absolute percentage error mape 25 mape 100 n l 1 n d 0 b o l d 0 b p l d s b o l d u 95 1 96 st d e 2 r m s e 2 e king gupta kge 26 kge 1 r 1 2 s t d p s t d o 1 2 d 0 b p d 0 b o 1 2 where d 0 l o l and d 0 l p l denote the l th observed and predicted normalized scour depths and d 0 b o and d 0 b p denote the mean observed and predicted normalized scour depths also n denotes the number of datasets and stde is the standard deviation of the errors 2 6 sensitivity analysis to identify the most sensitive input parameters to predict scour depth it is essential to carry out correlation and regression analyses as stated in section 3 the most important input parameter to estimate scour depth was t for both scenarios since there is a nonlinear relationship between the input parameters and the output it is necessary to implement a robust sensitivity analysis in this study the mutual information mi was employed for determining the most influential variables for each scenario the mi between two parameters w and v can be expressed as huoh 2013 27 m i w v s w s w v in which the entropy of the parameters w and v are described as probability p x which is given by huoh 2013 28 s w w x l o g p x p x 29 s w v x w p x x y v l o g p y x p y x where p x x denotes the marginal distribution for p x x y v p x y and the conditional distribution of parameter y for given can be expressed as p y x p y x p x x a low mi shows a small reduction in uncertainty a high mi implies a large reduction and a zero mi indicates that two parameters are independent 2 7 outlier detection and applicability domain outlier observations are the data that are usually far from the main bulk of the data outlier data introduce uncertainties that can affect the prediction of a model varamesh et al 2017 thus outlier data must be identified one of the most commonly used methods for identifying the outliers is the leverage approach in which the values of the leverage index are defined as the diagonal elements of the following matrix rehamnia et al n d rousseeuw and leroy 2005 30 h x x t x x 1 where x is a matrix n k n is the number of samples and k is the number of variables in the model the standardized residual sr values are defined as the percentage of the standardized difference between the observed data and the data obtained from the model jamei et al 2021b to identify outliers the leverage index is plotted against the standardized residual williams plot the values of sr 3 are the criteria used for detecting outliers the critical value of the leverage index h is also considered to be 3 p n where p is the number of input variables k plus one and n is the total number of data used in the development of the model if the value of the leverage index of the prediction is higher than h the prediction will not be reliable varamesh et al 2017 therefore if most of the data are in the range of 3 s r 3 and 0 h h it can be concluded that the data used for the development of the model as well as the predicted values are in the applicability domain and the developed model is statistically valid rousseeuw and leroy 2005 3 results and discussion in this research three ddms were developed to predict the scour depths at the nose and wake of a spur dike the percentage of clay pc dimensionless time t dimensionless ratio of cohesion to angle of friction c ϕ and dimensionless unconfined compressive strength of cohesive sediment mixture ucs were selected as independent variables to predict the scour depths at the nose scenario 1 and the wake scenario 2 of the spur dike in cohesive sediment mixtures for each scenario two superior combinations obtaining from the best subset selection were examined to identify the best outcome from the predictive models 3 1 nose scenario table 3 lists the statistical metrics of the cfnn gbdt and krr models for the training testing and all datasets for combo 1 cfnn r 0 9794 rmse 0 0842 kge 0 9758 and u95 0 8333 had a slightly better performance in the testing phase than gbdt r 0 9786 rmse 0 0890 and u95 0 8295 and krr r 0 9680 rmse 0 1081 and u95 0 8207 however gbdt with a smaller mape 17 2142 achieved the same accuracy as that of cfnn besides gbdt with the highest r 0 9875 and kge 0 9736 and the lowest error metrics rmse 0 0666 and mape 15 8569 outperformed cfnn r 0 9856 and rmse 0 0714 and krr r 0 9722 and rmse 0 0989 in the prediction of scour depth at the nose of the spur dike in all dataset for combo 2 gbdt which had the best performance in the training r 0 9928 and kge 0 9761 testing r 0 9717 and kge 0 9529 and all dataset r 0 9874 and kge 0 9709 was identified as the superior predictive model followed by cfnn and krr thus the gbdt and cfnn models achieved higher accuracy in comb 1 than that of combo 2 whereas krr showed a better performance in combo 2 furthermore in terms of the r values cfnn r 0 9856 for combo 1 and r 0 9739 for combo 2 yielded better results than krr r 0 9722 for combo 1 and r 0 9609 for combo 2 fig 7 shows the scatter plot of the predicted results from the three ddms for both selective combinations the values of do b estimated by the gbdt and cfnn models exhibit better agreement with the observed data than those from the krr model for both combinations it can be observed that the majority of the data points of the gbdt model for both selective combinations fall within the benchmark error lines 25 and 25 thus gbdt yielded more reliable results than cfnn and krr overall combo 1 was identified as the best combination in the prediction of normalized scour depth at the nose of the spur dike in cohesive sediment mixtures to assess the robustness of the three ddms the distribution functions of the observed and predicted normalized scour depths based on different quartile criteria q25 mean q75 and iqr were created for the best combination combo 1 fig 8 it can be found that gbdt and cfnn q25 0 102 and 0 100 respectively which were closest to the observed q25 0 101 yielded more accurate predictions of scour depth in the nose scenario also the gbdt and cfnn models with iqr values of 0 581 and 0 589 respectively were in good agreement with the observational value iqr 0 585 in the validation stage of the three ddms the relative deviation rd functions were determined to assess the precision of the predictions for combo 1 fig 9 illustrated the results of error analysis including the probability density of rd for each model left column and the variability of rd versus the observed do b right column in the nose scenario according to the rd band gbdt 262 6 and 182 5 for the training and testing respectively outperformed cfnn training 514 6 and test 281 2 and krr training 612 3 and test 672 it should be noted that most rd values for the three ddms occurred in a range of do b 0 0 5 fig 10 displays the cumulative frequency of absolute relative deviation cfard of each predictive model in the best combination of the nose scenario for all datasets the results indicated that more than 70 of the data points predicted by the three ddms had a value of rd equal to or smaller than 15 which confirmed that the three ddms had the same performance and acceptable accuracy in the prediction of normalized scour depth at the nose of the spur dike the accuracy assessment for the three models demonstrated that less than 7 of the data points had a value of rd greater than or equal to 50 3 2 wake scenario table 4 shows the results of combs 1 and 2 for the cfnn gbdt and krr models in the wake scenario the values of correlation coefficient and mape for the testing phase in combo 1 revealed that the performance order follows gbdt r 0 9843 and mape 22 0909 cfnn r 0 9772 and mape 22 8637 and krr r 0 9711and mape 26 8115 in terms of correlation coefficient rmse and kge for comb 2 gbdt training r 0 9947 rmse 0 0412 and kge 0 9856 testing r 0 9852 rmse 0 0657 and kge 0 9664 provided more reliable results than cfnn testing r 0 9687 and rmse 0 0940 and krr testing r 0 9689 and rmse 0 0944 overall the performances of all models were better for combo 1 that those for combo 2 fig 11 depicts that gbdt in both combinations had the best fit in comparison with cfnn and krr in combo 1 i e optimal input combination cfnn and krr had similar performance in terms of accuracy and efficiency however cfnn was the second best model for the prediction of scour depth at the wake zone of the spur dike to further evaluate the accuracy of the three ddms in the wake scenario for combo 1 the probability distribution functions of rd of the observed and predicted normalized scour depths were calculated fig 12 according to the criteria of q50 and iqr gbdt mean 0 357 and iqr 0 613 and cfnn mean 0 361 and iqr 0 615 in comparison with the observed data mean 0 346 and iqr 0 634 are the most promising models the probability density and variability of rd versus the observed do b in combo 1 optimal combination are illustrated in fig 13 indicating that gbdt training 131 8 testing 324 achieved more promising performance than cfnn training 476 6 testing 482 5 and krr training 625 9 testing 950 5 fig 14 shows the cfard obtained from the three ddms for all datasets indicating that more than 60 of the data points predicted by the three ddms had a value of rd equal to or smaller than 15 which confirmed that all the three ddms had similar performance and acceptable accuracy in the prediction of normalized scour depths at the nose of the spur dike however gbdt with the highest reliability was identified as the most precise model followed by cfnn and krr 3 3 discussion in this research three ddms were developed for predicting scour depth at the nose and wake zone of spur dikes in cohesive sediment mixtures it has been demonstrated that combo 1 including pc t c ϕ and ucs as input variables in the wake scenario was superior to combo 2 including pc t and ucs in the nose scenario cfnn and gbdt had the best performance in combo 1 whereas krr had better performance in comb 2 than that in combo 1 in the wake scenario gbdt in both scenarios rnose 0 9875 and rwake 0 9947 was selected as the best model for the prediction of normalized scour depth around the spur dike in cohesive sediment mixtures cfnn rnose 0 9856 and rwake 0 9803 and krr rnose 0 9722 and rwake 0 9741 can be used as a reliable tool with acceptable accuracy as a suggestion for future research the stacked generalization models can be explored for blending the advantages of standalone learners and consequently enhancing the accuracy of modeling it also should be noted that the reliability and validity of the three ddms presented herein were assessed only for the range of the data used in the modeling of normalized scour depths around spur dikes in the cohesive sediment mixture 3 4 sensitivity analysis results the mi values of all parameters variables for the two scenarios are listed in table 5 the most effective parameters for the first scenario were pc mi 0 474 and c ϕ mi 0 410 while the most sensitive parameter for the second scenario was c ϕ mi 0 338 the results demonstrated that the most important input parameters for the two scenarios also varied with different selective combinations table 6 3 5 results of outlier detection and applicability domain in the present study the leverage approach was used to evaluate the reliability of the developed ddms figs 15 and 16 show the williams plots of the estimated nose and wake scour depths respectively indicating that there was no data in the range of 3 s r 3 and thus there was no outlier data in the dataset for model development as shown in figs 15 and 16 some data were in the range of h h implying that the prediction was not reliable but the ratio of the number of those data to the total number of the data was very small therefore according to the results obtained from the leverage approach it can be concluded that the developed models i e krr gbt and cfnn had no outlier data and their predictions also were statistically valid 4 conclusion in this study a comprehensive ml based investigation was conducted to predict the temporal changes in scour depth around the vertical wall spur dike in cohesive sediment mixtures for two critical zones nose and wake for this purpose three ml models including cfnn gbdt and krr were developed the datasets used to develop the models included 417 samples for the nose scenario and 508 series of laboratory data for the wake scenario four dimensionless parameters including percentage of clay pc dimensionless time t dimensionless ratio of cohesion to the angle of friction c ϕ and dimensionless unconfined compressive strength of the cohesive sediment mixture ucs were considered as the model inputs and the normalized scour depths d 0 b at the nose and wake were the model output in the nose scenario scenario 1 the gbdt model with the first input combination combo 1 for all the datasets achieved the highest accuracy r 0 9875 rmse 0 0666 and u95 0 8179 for all the three models the first combination of input parameters combo 1 yielded more accurate results than combo 2 in the wake scenario scenario 2 the gbdt model with combo 1 for all the datasets showed the best performance r 0 9947 rmse 0 0407 and u95 0 7711 like scenario 1 combo 1 also resulted in highly accurate predictions in scenario 2 the modeling results demonstrated that all the models achieved acceptable accuracy in ranges of 0 d o b 0 75 and 0 d o b 1 for the nose and wake scenarios respectively to identify the most sensitive input parameters to estimate scour depth the mutual information was employed according to the mi the c ϕ was identified as the most effective parameter for both scenarios the results indicated that the most effective parameters for the first scenario were pc mi 0 474 and c ϕ mi 0 410 and the most important parameter for the second scenario was c ϕ mi 0 338 this study demonstrated that the most important input parameters for both scenarios were dependent on the combinations of input parameters finally to detect possible outlier data and model applicability domain the leverage approach was used and the results showed that only a small percentage of the data fell out of the applicability domain of the models and no outlier data was observed credit authorship contribution statement manish pandey writing review experimentation editing formal analysis mehdi jamei conceptualization software visualization writing review editing formal analysis supervision project leader iman ahmadianfar writing original draft methodology writing review editing supervision masoud karbasi investigation writing original draft writing review editing a s lodhi writing original draft experimentation methodology writing review editing xuefeng chu writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
3638,the stormwater infiltration system sis has been recognized as a feasible way to manage stormwater and restore streamflow as a lumped representation of the flow and transport processes the groundwater transit time distribution ttd is highly relevant to this restoration goal however the influence of the sis on groundwater ttds has rarely been studied in this paper we propose a novel analytical model for groundwater ttds in regional urban aquifers accounting for the impact of the sis this analytical solution is developed for a homogeneous 2 d cross section of an idealized unconfined aquifer following the dupuit forchheimer assumption the analytical solution is verified through the comparison with simulated ttds using the lagrangian particle tracking algorithm the global sensitivity analysis reveals that the stormwater infiltration rate the number of infiltration facilities the size of the urban area and the evapotranspiration are the most important factors for groundwater mean transit times mtts although groundwater discharge and mtt can be restored to the pre urban one groundwater ttds will inevitably deviate from the pre urban ones due to the alteration from diffuse recharge to infiltration focused recharge indicating that the urban groundwater flow regime cannot be fully restored to the pre urban conditions overall as a first order approximation of the real world urban groundwater system the proposed analytical model provides decision making support for urban water resources management and the design of the sis keywords transit time distributions urban aquifer stormwater infiltration system infiltrationfocused recharge analytical solution nomenclature p lt 1 precipitation rate e lt 1 evapotranspiration rate r lt 1 diffuse recharge rate k lt 1 saturated hydraulic conductivity x l horizontal position h l hydraulic head q p l2t 1 groundwater discharge in the pre urban scenario r s l2t 1 focused recharge rate of each infiltration facility l l horizontal length of the aquifer l l distance from the center of the urban area to the discharge zone w l half of the urban area s size h l l fixed downgradient head α β ratio of r s to p and ratio of r s to r respectively n s number of stormwater infiltration facilities l s l distance from the sis centroid to the downgradient end of the urban area w s l half of the sis length i index of the stormwater infiltration facilities h h d h u l mean saturated thickness of the whole aquifer the downgradient zone and the upgradient zone respectively θ effective porosity a t transit time τ p t mean transit time mtt in the pre urban scenario v lt 1 flow velocity ρ i a t transit time distribution ttd of the ith subdomain τ i t mtt of the ith subdomain h j l mean saturated thickness of the jth subdomain λ i weight of the ith recharge component a α β l w l s w s τ q dimensionless parameters and variables 1 introduction the past 50 years have witnessed a significant increase in urbanization across the globe until 2017 more than 4 billion people live in urban areas un population division 2018 the share of the urban population is projected to reach 66 in 2050 un population division 2018 correspondingly there is a mounting need to guarantee the freshwater supply in urban areas in which urban groundwater resources play a critical part cuthbert et al 2019 hoekstra et al 2018 larsen et al 2016 piao et al 2010 soulsby et al 2014 urbanization alters the regional water balance by a changing the land use type of vegetation and paved areas and the corresponding spatial organization of evapotranspiration et and groundwater recharge b enabling artificial abstraction of surface water and groundwater for urban water supply and c reestablishing the water balance through water supply and wastewater infrastructure that can change the patterns of recharge and discharge bhaskar et al 2016a claessens et al 2006 kaeseberg et al 2018 oudin et al 2018 soulsby et al 2015 conceptually urbanization is likely to generate more quick flow components with the increased surface runoff from sealing areas and the effect of the urban drainage network garcia fresca and sharp 2005 schwartz smith 2014 leaking infrastructure artificial drainage structures and climate and anthropogenic effects lead to a strongly heterogeneous urban hydrologic signal lerner 2002 schwartz smith 2014 another unique feature of the urban hydrologic system lies in the various potential contamination sources including sewer leakage landfill site industrial spillages solid wastes and fertilizers among others vázquez suñé et al 2005 urbanization may degrade the surface water quality through the fast convey of stormwater via artificial drainage networks and the reduction of sustained discharges bonneau et al 2017 king et al 2005 vietz et al 2014 correspondingly a major goal of urban water management is to restore the catchment scale hydrology to the corresponding pre urban conditions walsh et al 2012 in this regard many stormwater management methods have been developed and among which stormwater infiltration system sis has become a state of the art tool to mitigate the stormwater impacts and restore the pre urban hydrological and ecological conditions hamel et al 2013 hamel fletcher 2014 stormwater infiltration recharges groundwater and alters the groundwater circulation therefore restoring discharge bonneau et al 2017 infiltration focused stormwater facilities including rain gardens infiltration trenches and wells etc could also alter the spatial organization of the recharge from diffuse to point source bonneau et al 2017 hamel fletcher 2014 the groundwater transit time distribution ttd is defined as the distribution of transit times for water parcels in a given groundwater aquifer it provides critical insights into the transport and mixing of water parcels and the aquifer s resilience to non point source contaminants heße et al 2017 kumar et al 2020 for instance previous studies reveal that the legacy nitrogen released from soil and groundwater may dominate the nitrogen in surface water implying that complete removal of nitrogen source could still cost decades to meet the water quality goals van meter et al 2016 van meter et al 2018 the mean transit times mtts of regional groundwater range from decades to centuries and produce old discharges eberts et al 2012 jing et al 2019 lu et al 2019 michael k stewart et al 2016 some tracer based studies suggest that the mtt in urban catchments is likely to be shorter than the non urban tributary kuhlemann et al 2020 soulsby et al 2015 the breadth of groundwater ttd is strongly controlled by the recharge rate and location engdahl maxwell 2015 jing et al 2019 kollet maxwell 2008 leray et al 2019 impervious surfaces reduce the groundwater recharge and generate potentially older discharge while leakages from water mains or sewer networks increase the total recharge and produce younger discharge bhaskar et al 2016b minnig et al 2018 studies on how the sis affects peak flows and floods have been conducted widely while groundwater discharge water tables and transit times have received relatively little attention jefferson et al 2017 although some studies have investigated the response of groundwater resources to urbanization and stormwater infiltration most of them have only focused on the response of groundwater quantity and flow dynamics hamel fletcher 2014 hardison et al 2009 loperfido et al 2014 voisin et al 2018 walsh et al 2012 wang cai 2010 the sis can augment the baseflow through increasing recharge moore et al 2020 the spatial distribution of stormwater infiltration facilities strongly affects the catchment scale water balances choat bhaskar 2020 compared with the flow related studies only a limited number of studies have focused on the response of groundwater ttds to urbanization and most of them have employed tracer experiments and presumed travel time models kuhlemann et al 2020 mccance et al 2018 mcmahon et al 2008 soulsby et al 2015 however the impact of the sis on groundwater transit times is still poorly understood understanding how sis affects groundwater ttds and mtts is crucial to the adaptive strategies of urban freshwater resources management and has great implications for the restoration of stream water quality analytical models have been recognized as a computationally efficient approach to identifying the primary controls on groundwater ttds many analytical solutions have been developed for aquifers with uniform recharge and constant properties eriksson 1958 haitjema 1995 aquifers under linearly variable recharge conditions etcheverry 2001 and wedge aquifers under uniform or linearly variable conditions etcheverry 2001 leray et al 2012 nevertheless to the best of our knowledge no analytical framework exists for the evaluation of urban groundwater ttds accounting for the composite effects of urbanization and the sis in this study we propose a novel analytical approach for groundwater ttds through which the effects of urbanization and spatial organization of the sis can be explicitly accounted for the analytical model follows the dupuit forchheimer assumption and it is verified against numerical results using lagrangian particle tracking through local and global sensitivity analyses we demonstrate the usefulness of the analytical model in aiding the planning of the sis 2 model and methods 2 1 model conceptualization and study design the main focus of this study is the ttds in the watershed scale unconfined groundwater system we set up an idealized watershed model to approximate the real world flow conditions this type of urban watershed can be conceptualized using a 2 d cross sectional model parallel to the main groundwater flow direction fig 1 the length of the aquifer is much greater than the thickness implying that the vertical component of flow velocity is neglectable relative to the horizontal one accordingly the groundwater flow system follows the dupuit forchheimer assumption the aquifer is bounded by impervious boundaries at the upgradient side and the bottom representing the natural groundwater divide and the impervious bedrock the downgradient side of the aquifer is assigned with a fixed head boundary condition representing a perennial surface water body overlaying this groundwater aquifer is a soil zone this soil zone receives uniform precipitation p and has a homogeneous actual et e therefore in the natural state a diffuse recharge r is uniformly applied onto the upper surface of the groundwater aquifers 1 r p e we set up two scenarios namely a pre urban scenario and an urban scenario fig 1 the pre urban scenario is the scenario before urbanization fig 1a in the urban scenario the impervious area generates quick stormwater runoff and intercepts the infiltration into the groundwater aquifer acting as an impervious barrier to the groundwater flow system the foundations of the urban structures do not interfere with the water table an sis e g infiltration basin rain garden drywell recharge or combinations of them is embedded in the urban area fig 1b a typical infiltration facility is infiltration trenches which are shallow excavations that are filled with highly permeable gravels or stones to transfer surface runoff into subsurface infiltration fig 2 infiltration systems are only approximately 2 3 of the corresponding impervious catchment area which typically generate localized point source recharges jefferson et al 2017 they collect rainfall detain stormwater and infiltrate groundwater aquifers besides the infiltration focused stormwater facilities transform the diffuse recharge into point source recharge through pipes trenches or wells bonneau et al 2017 accordingly the sis is conceptualized using several uniformly distributed infiltration points beneath the urban structure which produces infiltration focused point source recharge fig 1b 2 2 solutions for fluxes and water tables in this subsection we give explicit expressions for fluxes and water tables in the pre urban scenario the groundwater discharge q p is denoted as 2 q p r l where r is the diffuse recharge lt 1 and l is the horizontal length of the aquifer l following the dupuit forchheimer assumption the groundwater head h is a function of the horizontal position x dupuit 1863 3 h x r k l 2 x 2 h l 2 where k is the saturated hydraulic conductivity lt 1 and h l is the fixed downgradient head l fig 1b in the urban scenario several stormwater infiltration facilities collect the precipitation and transfer them into infiltration into the deep groundwater aquifer we assume each infiltration facility collects a precipitation volume of r s l2t 1 which equals the total precipitation in an area of α l we also use a parameter β l to denote the ratio of r s to the diffuse recharge in this regard r s can be expressed by 4 r s α p β r assuming the total number of stormwater infiltration facilities is n s the total groundwater discharge of the aquifer is expressed by 5 q r l 2 w β n s where w is half of the size of the urban area l following the equation of dupuit forchheimer ellipse the hydraulic head on the downgradient side of the urban area can be expressed as dupuit 1863 6 h x r k l 2 w β n s 2 x 2 w β n s 2 h l 2 x l l w where l is the distance from the center of the urban area to the discharge zone l accordingly the groundwater head at the downgradient end of the urban area h 0 can be calculated using eq 6 the groundwater flow system beneath the urban area is divided into several subdomains by stormwater infiltration points fig 2 the horizontal positions of those infiltration points can be expressed by 7 x i l l w i 0 l l w l s w s 2 w s i 1 n s 1 i 1 2 n s l l w i n s 1 where l s is the distance from the sis centroid to the downgradient end of the urban area l and w s is half of the horizontal length of the sis l note that i 0 and i n s 1 are the downgradient and upgradient ends of the urban area fig 2 under the steady state the groundwater discharge of the ith subdomain q i equals to the total recharge of this subdomain 8 q i r l l w β n s 1 i i 1 2 n s 1 for the dupuit type groundwater flow in the ith subdomain darcy s law can be used to describe q i 9 q i k h d h d x combining and integrating eq 8 and eq 9 leads to the hydraulic head at the ith point hi 10 h i 2 q i x i 1 x i k h i 1 2 i 1 2 n s 1 the above equation is known as the dupuit forchheimer discharge formula similar to the downgradient side of the urban area the hydraulic head in the upgradient recharge zone can be expressed by 11 h x r k l l w 2 x 2 h n s 1 2 x l l w having derived expressions of hydraulic heads for all subdomains the water table in the whole domain can be explicitly achieved 2 3 solutions for the pre urban ttds the pre urban scenario is a typical case wherein an exponential form of the ttd holds eriksson 1958 haitjema 1995 małoszewski zuber 1982 raats 1977 vogel 1967 in the pre urban scenario the saturated groundwater aquifer is locally homogeneous and has a constant recharge rate following the dupuit forchheimer assumption the groundwater ttds can be expressed by 12 ρ t a 1 τ p exp a τ p where ρ t a is the probability density function pdf of groundwater transit times a is the transit time t and τ p is the mean transit time in the pre urban scenario t which can be seen as 13 τ p θ h r where θ is the effective porosity of aquifer and h denotes the mean thickness of the saturated aquifer l which can be calculated by integrating eq 3 2 4 solutions for the urban ttds as shown in fig 1 the urban groundwater aquifer receives recharges from three independent sources the upgradient diffuse recharge the point source stormwater infiltration and the downgradient diffuse recharge the composite groundwater ttd of the total groundwater discharge is a linear combination of individual distributions of each influx the ttd for water parcels recharged from the downgradient zone is denoted by ρ 0 a for any point at the location ζ in the downgradient recharge zone where ζ is the distance to the downgradient end of the urban area fig 1 the total influx q in ζ can be expressed as 14 q in ζ r l l w β n s ζ under the dupuit forchheimer assumption the flow velocity v ζ can expressed as 15 v ζ r l l w β n s ζ θ h d where h d is the mean saturated thickness in the downgradient recharge zone l which can be calculated by integrating eq 6 the transit time of water recharged at location ζ a ζ can be seen as 16 a ζ ζ l w r l l w β n s ζ θ h d 1 d ζ ln l 2 w β n s l l w β n s ζ τ d where τ d θ h d r the inversion function of a ζ ζ a is given by 17 ζ a l 2 w β n s exp a τ 0 l l w β n s a a 0 where a 0 is defined by a 0 τ d ln l 2 w β n s l l w β n s for a steady state system the cumulative distribution function cdf p 0 a can be expressed as etcheverry perrochet 2000 18 p 0 a q out a q out 19 q out a r l w ζ a where q out a is the outflow wherein the water transit times are less than a l2t 1 and q out is the total outflow at the discharge zone l2t 1 the pdf of water mass recharged from the downgradient recharge zone ρ 0 a can be expressed by 20 ρ 0 a d p 0 a da 1 q out d q out a da combining eq 17 eq 19 and eq 20 we can obtain the expression for ρ 0 a 21 ρ 0 a l 2 w β n s τ d l w exp a τ d a a 0 0 a a 0 furthermore the mtt for water parcels recharged in the downgradient zone τ 0 also has an explicit form 22 τ 0 1 l l w β n s l w ln l l w β n s l 2 w β n s τ d the second recharge source is the point source recharge from sis the ttd for water parcels recharged from the i th infiltration point ρ i a can be expressed using the piston flow model 23 ρ i a 1 a a i i 1 2 n s 0 a i 1 a a i i 1 2 n s where a i is the transit time of water parcels recharged from the i th infiltration point t groundwater flow beneath the urban area can be decomposed into a sequence of piston flows by stormwater infiltration points therefore we first calculate the individual transit times in these subdomains fig 3 a i can be calculated recursively 24 a i a 0 j 1 i δ a j i 1 2 n s 1 where δ a j is the transit time in the jth subdomain fig 3 which can be approximated by 25 δ a j l s w s v 1 j 1 2 w s v i n s 1 j 2 3 n s 2 w l s w s v n s 1 j n s 1 where v j is the mean fluid velocity at the jth subdomain which is further calculated by 26 v j q j θ h j j 1 2 n s 1 where h j is the mean saturated thickness of the jth subdomain which is obtained through integrating eq 9 q j is the total influx of the jth subdomain which is given by eq 8 the third recharge source is the upgradient diffuse recharge under the dupuit forchheimer assumption the ttds for water mass recharged upgradient follow the exponential piston flow model leray et al 2016 the ttds for upgradient diffuse recharge ρ n s 1 a is therefore a lagged system 27 ρ n s 1 a 1 τ u exp a a n s 1 τ u a a n s 1 0 a a n s 1 where a n s 1 can be calculated using eq 24 and τ u θ h u r h u is the mean saturated thickness in the upgradient recharge zone l having derived three individual ttds for three recharge zones we can obtain the ttd for the whole domain through the mass weighted average of individual ttds 28 ρ a i 0 n s 1 λ i ρ i a where λ i is the weight of the i th recharge component which is given by 29 λ i l w l 2 w β n s i 0 β l 2 w β n s i 1 2 n s l l w l 2 w β n s i n s 1 accordingly the composite ttd for the whole domain ρ a is given by 30 ρ a 1 τ d exp a τ d a a 0 0 a i a a i 1 i 0 1 n s β l 2 w β n s a a i i 1 2 n s l l w τ u l 2 w β n s exp a a n s 1 τ u a a n s 1 meanwhile we can also obtain the explicit form of τ for the whole groundwater flow system through the weighted sum of λ i 31 τ i 0 n s 1 λ i τ i where τ i is the mtt of the ith recharge component which is further given by 32 τ i 1 l l w β n s l w ln l l w β n s l 2 w β n s τ d i 0 a i i 1 2 n s τ u a n s 1 i n s 1 to generalize the problem we further define the dimensionless variables as follows a a τ p α α w β β w l l l w w l l s l s w and w s w s w employing these dimensionless variables we get the dimensionless form of ttds for the urban groundwater system 33 ρ a 1 τ d exp τ p a τ d a a 0 0 a i a a i 1 i 0 1 n s β w 1 2 w β w n s a a i i 1 2 n s 1 l w τ u 1 2 w β w n s exp τ p a a n s 1 τ u a a n s 1 2 5 numerical model a numerical model was established to test the accuracy of the analytical solution flow field simulations were performed using the finite difference algorithm embedded in the hydrologic model modflow 2005 harbaugh 2005 and ttds were simulated using the particle tracking package modpath version 6 pollock 2012 the cross sectional model was discretized into a regular mesh with 50 rows in the vertical direction and 500 columns in the horizontal direction all parameter values of the numerical model are identical to the analytical model as shown in table 2 a large number of particles 2000 5000 depending on the urban area were uniformly injected onto the diffuse recharge zone as well as the infiltration points at the beginning of the simulation period the number of released particles is proportional to the recharge rate to guarantee the conservation of mass simulated ttds were realized using the histogram of particles transit times 2 6 summary statistics and sensitivity analysis as a quantitative evaluation of the ttd range we use the normalized mtt τ as the summary statistics which is defined as 34 τ τ τ p we also quantify the relative change in groundwater discharge caused by the urbanization q which is defined as 35 q q q p where q and qp can be calculated using eq 5 and eq 2 respectively in this study we explore the influences of seven parameters e l w α n s l s and w s except for these seven parameters other parameters are assigned with constant values p 800 mm yr k 2 0 10 5 m s θ 0 28 and l 500 m the sensitivity analysis follows a two step procedure first we perform a local one at a time sensitivity analysis on each parameter this local sensitivity analysis quantifies how changes in parameter itself alter the summary statistics i e τ and q second we perform a global sensitivity analysis for the full parameter space using sobol method saltelli et al 1999 2010 sobol 2001 in the variance based sobol method the first order sensitivity indices s i are used to characterize the first order i e individual contribution of the parameter to the total variance matrix the total order sensitivity indices s ti is used to characterize the total contribution including the first order contribution and the interactions with other parameters to the variance of objective functions accordingly the contributions of high order interactions are realized by subtracting the s i from s ti rosolem et al 2012 sobol 2001 parameter values are sampled in the parameter space through monte carlo integration the feasible ranges of parameters for the global sensitivity analysis are shown in table 1 adjustable ranges of parameters are set broadly to cover different urban hydrogeological conditions 3 results to test the analytical solutions we first compare the computed ttds using the analytical solution with simulated ones using the particle tracking scheme we then conducted an in depth sensitivity analysis to explore the sensitivities of discharge water table and ttds to parameters 3 1 verification of the analytical solution we set up six verification cases case1 to case6 to evaluate the accuracy of the proposed analytical solution these verification cases cover a wide range of parameter values as shown in table 2 ttds derived from simulations and analytical models are shown in fig 4 while the distributed flow pathlines and transit times of released particles are shown in fig 5 in all cases derived ttds using the analytical solution show good correspondences with the simulation results what stands out from fig 4 is that ttds in the urban scenario blue solid lines in fig 4 significantly deviate from those in the pre urban scenario grey dashed lines in fig 4 reflecting the alteration in the groundwater flow regime induced from impervious area and sis overall the accuracy of analytical solutions is successfully verified by the good correspondence between analytical and numerical solutions fig 5 further shows how the impervious area and the infiltration focused recharge alter the flow pathways and transit times it is apparent that the impervious surface prevents infiltration into the groundwater aquifer and results in reduced groundwater recharge the stormwater infiltration points introduce extra recharge and compensate for the reduction in recharge besides the majority of particle transit times are smaller than the mtt as indicated by the large fraction of blue pathlines and only a small portion of injected particles have long transit times as indicated by the red lines in fig 5 this coincides with the tailing behavior of ttds as shown in fig 4 3 2 controls of urbanization on discharge and water table under the steady state four model parameters p e w and α control the discharge given that p is fixed with a constant value of 800 mm yr we focus on the responses of q to changes in e w and α as shown in fig 6 q increases with e from 0 72 when e 300 mm yr to 1 24 when e 700 mm yr this indicates that the influence of urbanization on groundwater discharge strongly depends on et q is negatively related to the size of the urban area w which is not surprising because the sealing surface reduces the total recharge and attenuates the groundwater discharge it is also apparent that q is positively related to α since stormwater infiltration contributes significantly to the total recharge furthermore sobol sensitivity analysis reveals that all q is highly sensitive to all three parameters fig 6d sobol sensitivity analysis also suggests that interactions among parameters greatly contribute to the total output variance of q fig 6d changes in groundwater transit times are highly dependent on water tables because higher water tables tend to increase transit times and vice versa haitjema 1995 in this subsection we present the results of local sensitivity analysis in which we vary one parameter at a time and hold other parameters constant at the default values given in table 1 fig 7 what stands out from fig 7 is that changes in water tables are greater in the upgradient zone than those in the downgradient zone which is because of the fixed water table at the downgradient end water tables are found nearly insensitive to the distance of the urban area to the discharge zone l and the size of the urban area w fig 7a and b these low sensitivities can be attributed to the fact that sis partially restores the groundwater recharge and therefore weakens the influence of urbanization on the water table both the increase in individual infiltration rate i e α and that in the number of infiltration facilities i e n s give rise to increased water tables fig 7c and d the position of the infiltration points l s also weakly affect the water table such that a larger l s leads to a greater increase in the upgradient water table while the length of sis w s seems to weakly control the water table fig 7e and f 3 3 controls of urbanization on groundwater ttds in this subsection we systematically investigate the controls of parameters on groundwater mtts since the parameter space is wide we display results using uniformly sampled parameter values and explore how the normalized mtt τ respond to those sampled parameters values except for the target parameter of the sensitivity analysis the other parameters follow the default values shown in table 1 we categorize model parameters into two groups parameters associated with land use change e l and w and parameters associated with the sis α n s l s and w s and display their sensitivities in fig 8 meanwhile the sensitivities of full transit time pdfs are shown in appendix a to disentangle the indirect effect of sis on τ we set up two cases a case without sis α 0 and a case with sis α 0 2 fig 8 what is striking about fig 8 is that the sensitivities of parameters are highly dependent on the stormwater infiltration as shown in fig 8a there is a clear trend of decreasing τ with increasing e the yellow dashed line for the case where sis exists specifically if e is large enough urbanization can introduce a smaller mtt compared to the pre urban one this is attributed to the fact that the water loss in the urban area is smaller than that in the natural vegetation cover therefore a higher e results in a greater reduction in τ however this trend is reversed if no sis is present the blue solid line this comparison reveals that sis can partially restore groundwater transit times for urban shallow aquifers in both cases τ is nearly insensitive to l fig 8b the control of w on τ is highly dependent on the existence of sis if no sis is present τ is found to be positively related to the size of the urban area w which is not surprising because the impervious area reduces the total recharge and generates relatively older groundwater discharge fig 8c however in the case where sis is present the control of w on τ is weakened which can be explained by the fact that sis partially compensates for the reduction in recharge caused by the impervious area fig 8c fig 8d e f and g present the sensitivities of τ to parameters associated with sis the parameter describing the stormwater infiltration rate α is found to be negatively associated with τ α strongly controls τ through modifying the flow velocity from the infiltration point down to the discharge zone a similar trend can be found in fig 8e wherein τ decreases with n s noticeably mtt can be fully restored i e τ 1 by eight stormwater infiltration facilities n s 8 using the default infiltration rate moreover τ is weakly dependent on the position of the infiltration points l s and the length of sis w s fig 8f and g overall τ is found to be dominantly controlled by the et e the size of the urban area w the individual stormwater infiltration rate α and the number of stormwater infiltration facilities n s nevertheless the relative importance of these parameters as well as the effects of parameters interactions on the groundwater ttds are still unknown the global sensitivity analysis in the following subsection helps to further uncover these relations fig 9 presents the results of sobol variance based sensitivity analysis to disentangle the effects of sis on parameter sensitivities we first analyzed the parameter sensitivities without sis and then incorporated the effect of sis into the analysis the most striking result to emerge from fig 9 is that the relative importance of parameters strongly depends on the condition of stormwater infiltration for the case without sis the total output variance of τ is found only strongly controlled by w with a s ti value of 0 99 this is not surprising because urbanization mainly affects the groundwater ttds through the sealing of the surface and the prevention of infiltration into deep groundwater in contrast for the case with sis the total output variance of τ is primarily controlled by α w e and n s interestingly the total output variance of τ appears insensitive to the position and length of sis l s and w s fig 9b fig 9 also shows that the indirect effects of parameters significantly contribute to the total variance in τ for the case with sis as indicated by the large values of s ti s i this suggests the great contribution from interactions among parameters to the total predictive uncertainty in urban groundwater ttds 4 discussion 4 1 direct and indirect influences of model parameters on transit times unlike previous studies that have employed environmental tracers kuhlemann et al 2020 soulsby et al 2015 vázquez suñé et al 2010 or conceptual hydrologic models hamel fletcher 2014 kaeseberg et al 2018 trinh chui 2013 this study is based on the explicit representation of groundwater flow pathways which is physically more sound these above stated methods inevitably rely on the presumed shapes of ttds e g exponential gamma or beta model which are subject to high uncertainty and may not suit the complex urban groundwater system refsgaard et al 2016 m k stewart et al 2012 in contrast our analytical model has a limited number of parameters and does not require tracer data our analytical model can provide a first order estimate of groundwater transit times for the complex urban groundwater system the sensitivity analysis suggests that the modification of the sis on groundwater recharge pattern i e the alteration of diffuse recharge to point source recharge could significantly deviate the shape and breadth of groundwater ttds from the pre urban ones fig 10 the sis also significantly alters the sensitivities of other parameters through indirect effects the responses of τ to e and w show distinct trends when the condition of stormwater infiltration changes fig 8a b and c this strong indirect effect of α is confirmed by the large value of s ti s i as shown in fig 9b more importantly the deviation from pre urban ttds implies an amplified risk of aquifer contamination because stormwater may be compounded by sewage pollution due to insufficient wastewater treatment in many regions of the world mccance et al 2018 walsh et al 2005 these negative impacts of imperviousness and stormwater infiltration facilities may further threaten the quality of groundwater and stream water parajulee et al 2019 renouf et al 2017 4 2 implications for the urban stormwater management for environmental benefits there has been a mounding need to mitigate the hydrological disturbance from urbanization and restore the pre urban flow and ecological conditions hamel et al 2013 trinh chui 2013 the proposed analytical model explicitly quantifies the influence of the sis on discharge water table and transit times which has important implications for urban stormwater management for example we can obtain the optimal stormwater infiltration rate and the number of infiltration facilities that reproduce the pre urban mtt fig 8 which helps to guide the design of the sis the in depth sensitivity analysis underlines the high sensitivities of mtt on the infiltration rate and the number of stormwater infiltration facilities in contrast the position and length of the sis appear to have minor effects on the groundwater mtt this finding suggests that the position and the horizontal extent of infiltration facilities e g infiltration wells can be flexibly adjusted as long as the total infiltration rate keeps constant which may not affect the effectiveness of the sis moreover our study implies that the flow pathways and mtt may not be restored simultaneously to their pre urban conditions fig 4 and fig 5 through the investigation using analytical and numerical approaches we found that the first moment of transit times i e mtt can be restored to the pre urban one only when both the infiltration rate and the number of infiltration facilities are large enough which may hardly be achieved in reality fanelli et al 2017 moreover even the mtt is restored to the pre urban one the transit times of individual particles will inevitably be more divergent than the pre urban ones fig 4 this finding reveals that the restoration of the first order moment of transit times alone does not guarantee the restoration of groundwater flow regime because the second moment of transit times will inevitably deviate from the pre urban one this alteration in flow regime gives rise to the potential alteration in groundwater quality because transit times reflect the resilience of the aquifer to nonpoint source contamination heße et al 2017 jing et al 2021 urbanization alters the groundwater flow pathways and transit times amplifying or attenuating the response time of stream water quality to contaminant inputs even treated with the sis the urban hydrological system may not be fully restored to the pre urban condition due to the diversified flow pathways this finding is in line with jefferson et al 2017 wherein they propose hysteretic trajectories for the response of catchment function to urbanization 4 3 limitations of the analytical approach like any other analytical model the proposed analytical approach is subject to various assumptions including the homogeneous media the uniform diffuse recharge and the imperviousness of the urban surface those assumptions limit the applicability of the analytical model in real world urban hydrogeologic systems since the meteorological topographical and hydrogeological properties of real world urban catchments are typically heterogeneous kirchner 2016 leray et al 2016 schwartz smith 2014 another limitation of the analytical model is the assumption that the urban sealing area is fully impervious which may be an over simplified assumption for complex real world applications besides we assume a piston type flow of infiltrated water parcels in the unsaturated zone implying that the diffusion of water parcels in the unsaturated zone is neglected this assumption needs to be carefully tested when applying the analytical model in real world applications furthermore infiltration based stormwater management can generate variable responses of discharge in different urban catchments due to their different levels of urban development fanelli et al 2017 our analytical model does not consider the heterogeneity of urban development such as the level of imperviousness and the leakage from sewer systems overall subject to many assumptions and simplifications the proposed analytical solution is valid only for the idealized urban hydrogeologic system the combination with other methods e g distributed hydrologic model tracer experiment and remote sensing is strongly recommended when applying the proposed model 5 conclusions we have developed an analytical model for the groundwater ttds in a regional unconfined groundwater system considering the influence of urbanization and the sis the analytical model explicitly accounts for the effects of 1 the land use change caused by urban imperviousness and 2 the alteration from diffuse to point source recharge on groundwater ttds the solution has been derived for the saturated groundwater flow in a 2 d aquifer cross section under the dupuit forchheimer assumption verified by the comparison with the numerical solutions the developed analytical model shows all distinguishing characteristics of closed form expressions formulated with several parameters it enables the implementation of computationally expensive sobol sensitivity analysis the comprehensive sensitivity analysis suggests that the stormwater infiltration rate the number of infiltration facilities the et and the size of the urban area are the most sensitive parameters to urban groundwater mtts while stormwater infiltration rate is critical to the groundwater mtts the position and length of the sis appear to have marginal effects on groundwater mtts the sensitivity analysis suggests that simultaneous restoration of discharge and transit times is impossible due to the alteration in flow pathways although the first moment of transit times can be restored to the pre urban one the shapes of ttds will inevitably change in response to the imperviousness and the infiltration focused recharge overall being computationally efficient the proposed analytical model surpasses existing transit time models in terms of explicitly accounting for the impact of urban imperviousness and sis it provides decision making support for the design of the sis and has great implications for the restoration of urban stream hydrology credit authorship contribution statement miao jing methodology investigation writing original draft estanislao pujades methodology writing review editing chunhui lu conceptualization investigation resources writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements c lu acknowledges the financial support from the national key r d program of china 2021yfc3200500 national natural science foundation of china 51879088 and the natural science foundation of jiangsu province bk20190023 m jing acknowledges the financial support from the national natural science foundation of china 52109012 appendix a changes of transit time pdfs in response to sampled parameter values see fig a1 
3638,the stormwater infiltration system sis has been recognized as a feasible way to manage stormwater and restore streamflow as a lumped representation of the flow and transport processes the groundwater transit time distribution ttd is highly relevant to this restoration goal however the influence of the sis on groundwater ttds has rarely been studied in this paper we propose a novel analytical model for groundwater ttds in regional urban aquifers accounting for the impact of the sis this analytical solution is developed for a homogeneous 2 d cross section of an idealized unconfined aquifer following the dupuit forchheimer assumption the analytical solution is verified through the comparison with simulated ttds using the lagrangian particle tracking algorithm the global sensitivity analysis reveals that the stormwater infiltration rate the number of infiltration facilities the size of the urban area and the evapotranspiration are the most important factors for groundwater mean transit times mtts although groundwater discharge and mtt can be restored to the pre urban one groundwater ttds will inevitably deviate from the pre urban ones due to the alteration from diffuse recharge to infiltration focused recharge indicating that the urban groundwater flow regime cannot be fully restored to the pre urban conditions overall as a first order approximation of the real world urban groundwater system the proposed analytical model provides decision making support for urban water resources management and the design of the sis keywords transit time distributions urban aquifer stormwater infiltration system infiltrationfocused recharge analytical solution nomenclature p lt 1 precipitation rate e lt 1 evapotranspiration rate r lt 1 diffuse recharge rate k lt 1 saturated hydraulic conductivity x l horizontal position h l hydraulic head q p l2t 1 groundwater discharge in the pre urban scenario r s l2t 1 focused recharge rate of each infiltration facility l l horizontal length of the aquifer l l distance from the center of the urban area to the discharge zone w l half of the urban area s size h l l fixed downgradient head α β ratio of r s to p and ratio of r s to r respectively n s number of stormwater infiltration facilities l s l distance from the sis centroid to the downgradient end of the urban area w s l half of the sis length i index of the stormwater infiltration facilities h h d h u l mean saturated thickness of the whole aquifer the downgradient zone and the upgradient zone respectively θ effective porosity a t transit time τ p t mean transit time mtt in the pre urban scenario v lt 1 flow velocity ρ i a t transit time distribution ttd of the ith subdomain τ i t mtt of the ith subdomain h j l mean saturated thickness of the jth subdomain λ i weight of the ith recharge component a α β l w l s w s τ q dimensionless parameters and variables 1 introduction the past 50 years have witnessed a significant increase in urbanization across the globe until 2017 more than 4 billion people live in urban areas un population division 2018 the share of the urban population is projected to reach 66 in 2050 un population division 2018 correspondingly there is a mounting need to guarantee the freshwater supply in urban areas in which urban groundwater resources play a critical part cuthbert et al 2019 hoekstra et al 2018 larsen et al 2016 piao et al 2010 soulsby et al 2014 urbanization alters the regional water balance by a changing the land use type of vegetation and paved areas and the corresponding spatial organization of evapotranspiration et and groundwater recharge b enabling artificial abstraction of surface water and groundwater for urban water supply and c reestablishing the water balance through water supply and wastewater infrastructure that can change the patterns of recharge and discharge bhaskar et al 2016a claessens et al 2006 kaeseberg et al 2018 oudin et al 2018 soulsby et al 2015 conceptually urbanization is likely to generate more quick flow components with the increased surface runoff from sealing areas and the effect of the urban drainage network garcia fresca and sharp 2005 schwartz smith 2014 leaking infrastructure artificial drainage structures and climate and anthropogenic effects lead to a strongly heterogeneous urban hydrologic signal lerner 2002 schwartz smith 2014 another unique feature of the urban hydrologic system lies in the various potential contamination sources including sewer leakage landfill site industrial spillages solid wastes and fertilizers among others vázquez suñé et al 2005 urbanization may degrade the surface water quality through the fast convey of stormwater via artificial drainage networks and the reduction of sustained discharges bonneau et al 2017 king et al 2005 vietz et al 2014 correspondingly a major goal of urban water management is to restore the catchment scale hydrology to the corresponding pre urban conditions walsh et al 2012 in this regard many stormwater management methods have been developed and among which stormwater infiltration system sis has become a state of the art tool to mitigate the stormwater impacts and restore the pre urban hydrological and ecological conditions hamel et al 2013 hamel fletcher 2014 stormwater infiltration recharges groundwater and alters the groundwater circulation therefore restoring discharge bonneau et al 2017 infiltration focused stormwater facilities including rain gardens infiltration trenches and wells etc could also alter the spatial organization of the recharge from diffuse to point source bonneau et al 2017 hamel fletcher 2014 the groundwater transit time distribution ttd is defined as the distribution of transit times for water parcels in a given groundwater aquifer it provides critical insights into the transport and mixing of water parcels and the aquifer s resilience to non point source contaminants heße et al 2017 kumar et al 2020 for instance previous studies reveal that the legacy nitrogen released from soil and groundwater may dominate the nitrogen in surface water implying that complete removal of nitrogen source could still cost decades to meet the water quality goals van meter et al 2016 van meter et al 2018 the mean transit times mtts of regional groundwater range from decades to centuries and produce old discharges eberts et al 2012 jing et al 2019 lu et al 2019 michael k stewart et al 2016 some tracer based studies suggest that the mtt in urban catchments is likely to be shorter than the non urban tributary kuhlemann et al 2020 soulsby et al 2015 the breadth of groundwater ttd is strongly controlled by the recharge rate and location engdahl maxwell 2015 jing et al 2019 kollet maxwell 2008 leray et al 2019 impervious surfaces reduce the groundwater recharge and generate potentially older discharge while leakages from water mains or sewer networks increase the total recharge and produce younger discharge bhaskar et al 2016b minnig et al 2018 studies on how the sis affects peak flows and floods have been conducted widely while groundwater discharge water tables and transit times have received relatively little attention jefferson et al 2017 although some studies have investigated the response of groundwater resources to urbanization and stormwater infiltration most of them have only focused on the response of groundwater quantity and flow dynamics hamel fletcher 2014 hardison et al 2009 loperfido et al 2014 voisin et al 2018 walsh et al 2012 wang cai 2010 the sis can augment the baseflow through increasing recharge moore et al 2020 the spatial distribution of stormwater infiltration facilities strongly affects the catchment scale water balances choat bhaskar 2020 compared with the flow related studies only a limited number of studies have focused on the response of groundwater ttds to urbanization and most of them have employed tracer experiments and presumed travel time models kuhlemann et al 2020 mccance et al 2018 mcmahon et al 2008 soulsby et al 2015 however the impact of the sis on groundwater transit times is still poorly understood understanding how sis affects groundwater ttds and mtts is crucial to the adaptive strategies of urban freshwater resources management and has great implications for the restoration of stream water quality analytical models have been recognized as a computationally efficient approach to identifying the primary controls on groundwater ttds many analytical solutions have been developed for aquifers with uniform recharge and constant properties eriksson 1958 haitjema 1995 aquifers under linearly variable recharge conditions etcheverry 2001 and wedge aquifers under uniform or linearly variable conditions etcheverry 2001 leray et al 2012 nevertheless to the best of our knowledge no analytical framework exists for the evaluation of urban groundwater ttds accounting for the composite effects of urbanization and the sis in this study we propose a novel analytical approach for groundwater ttds through which the effects of urbanization and spatial organization of the sis can be explicitly accounted for the analytical model follows the dupuit forchheimer assumption and it is verified against numerical results using lagrangian particle tracking through local and global sensitivity analyses we demonstrate the usefulness of the analytical model in aiding the planning of the sis 2 model and methods 2 1 model conceptualization and study design the main focus of this study is the ttds in the watershed scale unconfined groundwater system we set up an idealized watershed model to approximate the real world flow conditions this type of urban watershed can be conceptualized using a 2 d cross sectional model parallel to the main groundwater flow direction fig 1 the length of the aquifer is much greater than the thickness implying that the vertical component of flow velocity is neglectable relative to the horizontal one accordingly the groundwater flow system follows the dupuit forchheimer assumption the aquifer is bounded by impervious boundaries at the upgradient side and the bottom representing the natural groundwater divide and the impervious bedrock the downgradient side of the aquifer is assigned with a fixed head boundary condition representing a perennial surface water body overlaying this groundwater aquifer is a soil zone this soil zone receives uniform precipitation p and has a homogeneous actual et e therefore in the natural state a diffuse recharge r is uniformly applied onto the upper surface of the groundwater aquifers 1 r p e we set up two scenarios namely a pre urban scenario and an urban scenario fig 1 the pre urban scenario is the scenario before urbanization fig 1a in the urban scenario the impervious area generates quick stormwater runoff and intercepts the infiltration into the groundwater aquifer acting as an impervious barrier to the groundwater flow system the foundations of the urban structures do not interfere with the water table an sis e g infiltration basin rain garden drywell recharge or combinations of them is embedded in the urban area fig 1b a typical infiltration facility is infiltration trenches which are shallow excavations that are filled with highly permeable gravels or stones to transfer surface runoff into subsurface infiltration fig 2 infiltration systems are only approximately 2 3 of the corresponding impervious catchment area which typically generate localized point source recharges jefferson et al 2017 they collect rainfall detain stormwater and infiltrate groundwater aquifers besides the infiltration focused stormwater facilities transform the diffuse recharge into point source recharge through pipes trenches or wells bonneau et al 2017 accordingly the sis is conceptualized using several uniformly distributed infiltration points beneath the urban structure which produces infiltration focused point source recharge fig 1b 2 2 solutions for fluxes and water tables in this subsection we give explicit expressions for fluxes and water tables in the pre urban scenario the groundwater discharge q p is denoted as 2 q p r l where r is the diffuse recharge lt 1 and l is the horizontal length of the aquifer l following the dupuit forchheimer assumption the groundwater head h is a function of the horizontal position x dupuit 1863 3 h x r k l 2 x 2 h l 2 where k is the saturated hydraulic conductivity lt 1 and h l is the fixed downgradient head l fig 1b in the urban scenario several stormwater infiltration facilities collect the precipitation and transfer them into infiltration into the deep groundwater aquifer we assume each infiltration facility collects a precipitation volume of r s l2t 1 which equals the total precipitation in an area of α l we also use a parameter β l to denote the ratio of r s to the diffuse recharge in this regard r s can be expressed by 4 r s α p β r assuming the total number of stormwater infiltration facilities is n s the total groundwater discharge of the aquifer is expressed by 5 q r l 2 w β n s where w is half of the size of the urban area l following the equation of dupuit forchheimer ellipse the hydraulic head on the downgradient side of the urban area can be expressed as dupuit 1863 6 h x r k l 2 w β n s 2 x 2 w β n s 2 h l 2 x l l w where l is the distance from the center of the urban area to the discharge zone l accordingly the groundwater head at the downgradient end of the urban area h 0 can be calculated using eq 6 the groundwater flow system beneath the urban area is divided into several subdomains by stormwater infiltration points fig 2 the horizontal positions of those infiltration points can be expressed by 7 x i l l w i 0 l l w l s w s 2 w s i 1 n s 1 i 1 2 n s l l w i n s 1 where l s is the distance from the sis centroid to the downgradient end of the urban area l and w s is half of the horizontal length of the sis l note that i 0 and i n s 1 are the downgradient and upgradient ends of the urban area fig 2 under the steady state the groundwater discharge of the ith subdomain q i equals to the total recharge of this subdomain 8 q i r l l w β n s 1 i i 1 2 n s 1 for the dupuit type groundwater flow in the ith subdomain darcy s law can be used to describe q i 9 q i k h d h d x combining and integrating eq 8 and eq 9 leads to the hydraulic head at the ith point hi 10 h i 2 q i x i 1 x i k h i 1 2 i 1 2 n s 1 the above equation is known as the dupuit forchheimer discharge formula similar to the downgradient side of the urban area the hydraulic head in the upgradient recharge zone can be expressed by 11 h x r k l l w 2 x 2 h n s 1 2 x l l w having derived expressions of hydraulic heads for all subdomains the water table in the whole domain can be explicitly achieved 2 3 solutions for the pre urban ttds the pre urban scenario is a typical case wherein an exponential form of the ttd holds eriksson 1958 haitjema 1995 małoszewski zuber 1982 raats 1977 vogel 1967 in the pre urban scenario the saturated groundwater aquifer is locally homogeneous and has a constant recharge rate following the dupuit forchheimer assumption the groundwater ttds can be expressed by 12 ρ t a 1 τ p exp a τ p where ρ t a is the probability density function pdf of groundwater transit times a is the transit time t and τ p is the mean transit time in the pre urban scenario t which can be seen as 13 τ p θ h r where θ is the effective porosity of aquifer and h denotes the mean thickness of the saturated aquifer l which can be calculated by integrating eq 3 2 4 solutions for the urban ttds as shown in fig 1 the urban groundwater aquifer receives recharges from three independent sources the upgradient diffuse recharge the point source stormwater infiltration and the downgradient diffuse recharge the composite groundwater ttd of the total groundwater discharge is a linear combination of individual distributions of each influx the ttd for water parcels recharged from the downgradient zone is denoted by ρ 0 a for any point at the location ζ in the downgradient recharge zone where ζ is the distance to the downgradient end of the urban area fig 1 the total influx q in ζ can be expressed as 14 q in ζ r l l w β n s ζ under the dupuit forchheimer assumption the flow velocity v ζ can expressed as 15 v ζ r l l w β n s ζ θ h d where h d is the mean saturated thickness in the downgradient recharge zone l which can be calculated by integrating eq 6 the transit time of water recharged at location ζ a ζ can be seen as 16 a ζ ζ l w r l l w β n s ζ θ h d 1 d ζ ln l 2 w β n s l l w β n s ζ τ d where τ d θ h d r the inversion function of a ζ ζ a is given by 17 ζ a l 2 w β n s exp a τ 0 l l w β n s a a 0 where a 0 is defined by a 0 τ d ln l 2 w β n s l l w β n s for a steady state system the cumulative distribution function cdf p 0 a can be expressed as etcheverry perrochet 2000 18 p 0 a q out a q out 19 q out a r l w ζ a where q out a is the outflow wherein the water transit times are less than a l2t 1 and q out is the total outflow at the discharge zone l2t 1 the pdf of water mass recharged from the downgradient recharge zone ρ 0 a can be expressed by 20 ρ 0 a d p 0 a da 1 q out d q out a da combining eq 17 eq 19 and eq 20 we can obtain the expression for ρ 0 a 21 ρ 0 a l 2 w β n s τ d l w exp a τ d a a 0 0 a a 0 furthermore the mtt for water parcels recharged in the downgradient zone τ 0 also has an explicit form 22 τ 0 1 l l w β n s l w ln l l w β n s l 2 w β n s τ d the second recharge source is the point source recharge from sis the ttd for water parcels recharged from the i th infiltration point ρ i a can be expressed using the piston flow model 23 ρ i a 1 a a i i 1 2 n s 0 a i 1 a a i i 1 2 n s where a i is the transit time of water parcels recharged from the i th infiltration point t groundwater flow beneath the urban area can be decomposed into a sequence of piston flows by stormwater infiltration points therefore we first calculate the individual transit times in these subdomains fig 3 a i can be calculated recursively 24 a i a 0 j 1 i δ a j i 1 2 n s 1 where δ a j is the transit time in the jth subdomain fig 3 which can be approximated by 25 δ a j l s w s v 1 j 1 2 w s v i n s 1 j 2 3 n s 2 w l s w s v n s 1 j n s 1 where v j is the mean fluid velocity at the jth subdomain which is further calculated by 26 v j q j θ h j j 1 2 n s 1 where h j is the mean saturated thickness of the jth subdomain which is obtained through integrating eq 9 q j is the total influx of the jth subdomain which is given by eq 8 the third recharge source is the upgradient diffuse recharge under the dupuit forchheimer assumption the ttds for water mass recharged upgradient follow the exponential piston flow model leray et al 2016 the ttds for upgradient diffuse recharge ρ n s 1 a is therefore a lagged system 27 ρ n s 1 a 1 τ u exp a a n s 1 τ u a a n s 1 0 a a n s 1 where a n s 1 can be calculated using eq 24 and τ u θ h u r h u is the mean saturated thickness in the upgradient recharge zone l having derived three individual ttds for three recharge zones we can obtain the ttd for the whole domain through the mass weighted average of individual ttds 28 ρ a i 0 n s 1 λ i ρ i a where λ i is the weight of the i th recharge component which is given by 29 λ i l w l 2 w β n s i 0 β l 2 w β n s i 1 2 n s l l w l 2 w β n s i n s 1 accordingly the composite ttd for the whole domain ρ a is given by 30 ρ a 1 τ d exp a τ d a a 0 0 a i a a i 1 i 0 1 n s β l 2 w β n s a a i i 1 2 n s l l w τ u l 2 w β n s exp a a n s 1 τ u a a n s 1 meanwhile we can also obtain the explicit form of τ for the whole groundwater flow system through the weighted sum of λ i 31 τ i 0 n s 1 λ i τ i where τ i is the mtt of the ith recharge component which is further given by 32 τ i 1 l l w β n s l w ln l l w β n s l 2 w β n s τ d i 0 a i i 1 2 n s τ u a n s 1 i n s 1 to generalize the problem we further define the dimensionless variables as follows a a τ p α α w β β w l l l w w l l s l s w and w s w s w employing these dimensionless variables we get the dimensionless form of ttds for the urban groundwater system 33 ρ a 1 τ d exp τ p a τ d a a 0 0 a i a a i 1 i 0 1 n s β w 1 2 w β w n s a a i i 1 2 n s 1 l w τ u 1 2 w β w n s exp τ p a a n s 1 τ u a a n s 1 2 5 numerical model a numerical model was established to test the accuracy of the analytical solution flow field simulations were performed using the finite difference algorithm embedded in the hydrologic model modflow 2005 harbaugh 2005 and ttds were simulated using the particle tracking package modpath version 6 pollock 2012 the cross sectional model was discretized into a regular mesh with 50 rows in the vertical direction and 500 columns in the horizontal direction all parameter values of the numerical model are identical to the analytical model as shown in table 2 a large number of particles 2000 5000 depending on the urban area were uniformly injected onto the diffuse recharge zone as well as the infiltration points at the beginning of the simulation period the number of released particles is proportional to the recharge rate to guarantee the conservation of mass simulated ttds were realized using the histogram of particles transit times 2 6 summary statistics and sensitivity analysis as a quantitative evaluation of the ttd range we use the normalized mtt τ as the summary statistics which is defined as 34 τ τ τ p we also quantify the relative change in groundwater discharge caused by the urbanization q which is defined as 35 q q q p where q and qp can be calculated using eq 5 and eq 2 respectively in this study we explore the influences of seven parameters e l w α n s l s and w s except for these seven parameters other parameters are assigned with constant values p 800 mm yr k 2 0 10 5 m s θ 0 28 and l 500 m the sensitivity analysis follows a two step procedure first we perform a local one at a time sensitivity analysis on each parameter this local sensitivity analysis quantifies how changes in parameter itself alter the summary statistics i e τ and q second we perform a global sensitivity analysis for the full parameter space using sobol method saltelli et al 1999 2010 sobol 2001 in the variance based sobol method the first order sensitivity indices s i are used to characterize the first order i e individual contribution of the parameter to the total variance matrix the total order sensitivity indices s ti is used to characterize the total contribution including the first order contribution and the interactions with other parameters to the variance of objective functions accordingly the contributions of high order interactions are realized by subtracting the s i from s ti rosolem et al 2012 sobol 2001 parameter values are sampled in the parameter space through monte carlo integration the feasible ranges of parameters for the global sensitivity analysis are shown in table 1 adjustable ranges of parameters are set broadly to cover different urban hydrogeological conditions 3 results to test the analytical solutions we first compare the computed ttds using the analytical solution with simulated ones using the particle tracking scheme we then conducted an in depth sensitivity analysis to explore the sensitivities of discharge water table and ttds to parameters 3 1 verification of the analytical solution we set up six verification cases case1 to case6 to evaluate the accuracy of the proposed analytical solution these verification cases cover a wide range of parameter values as shown in table 2 ttds derived from simulations and analytical models are shown in fig 4 while the distributed flow pathlines and transit times of released particles are shown in fig 5 in all cases derived ttds using the analytical solution show good correspondences with the simulation results what stands out from fig 4 is that ttds in the urban scenario blue solid lines in fig 4 significantly deviate from those in the pre urban scenario grey dashed lines in fig 4 reflecting the alteration in the groundwater flow regime induced from impervious area and sis overall the accuracy of analytical solutions is successfully verified by the good correspondence between analytical and numerical solutions fig 5 further shows how the impervious area and the infiltration focused recharge alter the flow pathways and transit times it is apparent that the impervious surface prevents infiltration into the groundwater aquifer and results in reduced groundwater recharge the stormwater infiltration points introduce extra recharge and compensate for the reduction in recharge besides the majority of particle transit times are smaller than the mtt as indicated by the large fraction of blue pathlines and only a small portion of injected particles have long transit times as indicated by the red lines in fig 5 this coincides with the tailing behavior of ttds as shown in fig 4 3 2 controls of urbanization on discharge and water table under the steady state four model parameters p e w and α control the discharge given that p is fixed with a constant value of 800 mm yr we focus on the responses of q to changes in e w and α as shown in fig 6 q increases with e from 0 72 when e 300 mm yr to 1 24 when e 700 mm yr this indicates that the influence of urbanization on groundwater discharge strongly depends on et q is negatively related to the size of the urban area w which is not surprising because the sealing surface reduces the total recharge and attenuates the groundwater discharge it is also apparent that q is positively related to α since stormwater infiltration contributes significantly to the total recharge furthermore sobol sensitivity analysis reveals that all q is highly sensitive to all three parameters fig 6d sobol sensitivity analysis also suggests that interactions among parameters greatly contribute to the total output variance of q fig 6d changes in groundwater transit times are highly dependent on water tables because higher water tables tend to increase transit times and vice versa haitjema 1995 in this subsection we present the results of local sensitivity analysis in which we vary one parameter at a time and hold other parameters constant at the default values given in table 1 fig 7 what stands out from fig 7 is that changes in water tables are greater in the upgradient zone than those in the downgradient zone which is because of the fixed water table at the downgradient end water tables are found nearly insensitive to the distance of the urban area to the discharge zone l and the size of the urban area w fig 7a and b these low sensitivities can be attributed to the fact that sis partially restores the groundwater recharge and therefore weakens the influence of urbanization on the water table both the increase in individual infiltration rate i e α and that in the number of infiltration facilities i e n s give rise to increased water tables fig 7c and d the position of the infiltration points l s also weakly affect the water table such that a larger l s leads to a greater increase in the upgradient water table while the length of sis w s seems to weakly control the water table fig 7e and f 3 3 controls of urbanization on groundwater ttds in this subsection we systematically investigate the controls of parameters on groundwater mtts since the parameter space is wide we display results using uniformly sampled parameter values and explore how the normalized mtt τ respond to those sampled parameters values except for the target parameter of the sensitivity analysis the other parameters follow the default values shown in table 1 we categorize model parameters into two groups parameters associated with land use change e l and w and parameters associated with the sis α n s l s and w s and display their sensitivities in fig 8 meanwhile the sensitivities of full transit time pdfs are shown in appendix a to disentangle the indirect effect of sis on τ we set up two cases a case without sis α 0 and a case with sis α 0 2 fig 8 what is striking about fig 8 is that the sensitivities of parameters are highly dependent on the stormwater infiltration as shown in fig 8a there is a clear trend of decreasing τ with increasing e the yellow dashed line for the case where sis exists specifically if e is large enough urbanization can introduce a smaller mtt compared to the pre urban one this is attributed to the fact that the water loss in the urban area is smaller than that in the natural vegetation cover therefore a higher e results in a greater reduction in τ however this trend is reversed if no sis is present the blue solid line this comparison reveals that sis can partially restore groundwater transit times for urban shallow aquifers in both cases τ is nearly insensitive to l fig 8b the control of w on τ is highly dependent on the existence of sis if no sis is present τ is found to be positively related to the size of the urban area w which is not surprising because the impervious area reduces the total recharge and generates relatively older groundwater discharge fig 8c however in the case where sis is present the control of w on τ is weakened which can be explained by the fact that sis partially compensates for the reduction in recharge caused by the impervious area fig 8c fig 8d e f and g present the sensitivities of τ to parameters associated with sis the parameter describing the stormwater infiltration rate α is found to be negatively associated with τ α strongly controls τ through modifying the flow velocity from the infiltration point down to the discharge zone a similar trend can be found in fig 8e wherein τ decreases with n s noticeably mtt can be fully restored i e τ 1 by eight stormwater infiltration facilities n s 8 using the default infiltration rate moreover τ is weakly dependent on the position of the infiltration points l s and the length of sis w s fig 8f and g overall τ is found to be dominantly controlled by the et e the size of the urban area w the individual stormwater infiltration rate α and the number of stormwater infiltration facilities n s nevertheless the relative importance of these parameters as well as the effects of parameters interactions on the groundwater ttds are still unknown the global sensitivity analysis in the following subsection helps to further uncover these relations fig 9 presents the results of sobol variance based sensitivity analysis to disentangle the effects of sis on parameter sensitivities we first analyzed the parameter sensitivities without sis and then incorporated the effect of sis into the analysis the most striking result to emerge from fig 9 is that the relative importance of parameters strongly depends on the condition of stormwater infiltration for the case without sis the total output variance of τ is found only strongly controlled by w with a s ti value of 0 99 this is not surprising because urbanization mainly affects the groundwater ttds through the sealing of the surface and the prevention of infiltration into deep groundwater in contrast for the case with sis the total output variance of τ is primarily controlled by α w e and n s interestingly the total output variance of τ appears insensitive to the position and length of sis l s and w s fig 9b fig 9 also shows that the indirect effects of parameters significantly contribute to the total variance in τ for the case with sis as indicated by the large values of s ti s i this suggests the great contribution from interactions among parameters to the total predictive uncertainty in urban groundwater ttds 4 discussion 4 1 direct and indirect influences of model parameters on transit times unlike previous studies that have employed environmental tracers kuhlemann et al 2020 soulsby et al 2015 vázquez suñé et al 2010 or conceptual hydrologic models hamel fletcher 2014 kaeseberg et al 2018 trinh chui 2013 this study is based on the explicit representation of groundwater flow pathways which is physically more sound these above stated methods inevitably rely on the presumed shapes of ttds e g exponential gamma or beta model which are subject to high uncertainty and may not suit the complex urban groundwater system refsgaard et al 2016 m k stewart et al 2012 in contrast our analytical model has a limited number of parameters and does not require tracer data our analytical model can provide a first order estimate of groundwater transit times for the complex urban groundwater system the sensitivity analysis suggests that the modification of the sis on groundwater recharge pattern i e the alteration of diffuse recharge to point source recharge could significantly deviate the shape and breadth of groundwater ttds from the pre urban ones fig 10 the sis also significantly alters the sensitivities of other parameters through indirect effects the responses of τ to e and w show distinct trends when the condition of stormwater infiltration changes fig 8a b and c this strong indirect effect of α is confirmed by the large value of s ti s i as shown in fig 9b more importantly the deviation from pre urban ttds implies an amplified risk of aquifer contamination because stormwater may be compounded by sewage pollution due to insufficient wastewater treatment in many regions of the world mccance et al 2018 walsh et al 2005 these negative impacts of imperviousness and stormwater infiltration facilities may further threaten the quality of groundwater and stream water parajulee et al 2019 renouf et al 2017 4 2 implications for the urban stormwater management for environmental benefits there has been a mounding need to mitigate the hydrological disturbance from urbanization and restore the pre urban flow and ecological conditions hamel et al 2013 trinh chui 2013 the proposed analytical model explicitly quantifies the influence of the sis on discharge water table and transit times which has important implications for urban stormwater management for example we can obtain the optimal stormwater infiltration rate and the number of infiltration facilities that reproduce the pre urban mtt fig 8 which helps to guide the design of the sis the in depth sensitivity analysis underlines the high sensitivities of mtt on the infiltration rate and the number of stormwater infiltration facilities in contrast the position and length of the sis appear to have minor effects on the groundwater mtt this finding suggests that the position and the horizontal extent of infiltration facilities e g infiltration wells can be flexibly adjusted as long as the total infiltration rate keeps constant which may not affect the effectiveness of the sis moreover our study implies that the flow pathways and mtt may not be restored simultaneously to their pre urban conditions fig 4 and fig 5 through the investigation using analytical and numerical approaches we found that the first moment of transit times i e mtt can be restored to the pre urban one only when both the infiltration rate and the number of infiltration facilities are large enough which may hardly be achieved in reality fanelli et al 2017 moreover even the mtt is restored to the pre urban one the transit times of individual particles will inevitably be more divergent than the pre urban ones fig 4 this finding reveals that the restoration of the first order moment of transit times alone does not guarantee the restoration of groundwater flow regime because the second moment of transit times will inevitably deviate from the pre urban one this alteration in flow regime gives rise to the potential alteration in groundwater quality because transit times reflect the resilience of the aquifer to nonpoint source contamination heße et al 2017 jing et al 2021 urbanization alters the groundwater flow pathways and transit times amplifying or attenuating the response time of stream water quality to contaminant inputs even treated with the sis the urban hydrological system may not be fully restored to the pre urban condition due to the diversified flow pathways this finding is in line with jefferson et al 2017 wherein they propose hysteretic trajectories for the response of catchment function to urbanization 4 3 limitations of the analytical approach like any other analytical model the proposed analytical approach is subject to various assumptions including the homogeneous media the uniform diffuse recharge and the imperviousness of the urban surface those assumptions limit the applicability of the analytical model in real world urban hydrogeologic systems since the meteorological topographical and hydrogeological properties of real world urban catchments are typically heterogeneous kirchner 2016 leray et al 2016 schwartz smith 2014 another limitation of the analytical model is the assumption that the urban sealing area is fully impervious which may be an over simplified assumption for complex real world applications besides we assume a piston type flow of infiltrated water parcels in the unsaturated zone implying that the diffusion of water parcels in the unsaturated zone is neglected this assumption needs to be carefully tested when applying the analytical model in real world applications furthermore infiltration based stormwater management can generate variable responses of discharge in different urban catchments due to their different levels of urban development fanelli et al 2017 our analytical model does not consider the heterogeneity of urban development such as the level of imperviousness and the leakage from sewer systems overall subject to many assumptions and simplifications the proposed analytical solution is valid only for the idealized urban hydrogeologic system the combination with other methods e g distributed hydrologic model tracer experiment and remote sensing is strongly recommended when applying the proposed model 5 conclusions we have developed an analytical model for the groundwater ttds in a regional unconfined groundwater system considering the influence of urbanization and the sis the analytical model explicitly accounts for the effects of 1 the land use change caused by urban imperviousness and 2 the alteration from diffuse to point source recharge on groundwater ttds the solution has been derived for the saturated groundwater flow in a 2 d aquifer cross section under the dupuit forchheimer assumption verified by the comparison with the numerical solutions the developed analytical model shows all distinguishing characteristics of closed form expressions formulated with several parameters it enables the implementation of computationally expensive sobol sensitivity analysis the comprehensive sensitivity analysis suggests that the stormwater infiltration rate the number of infiltration facilities the et and the size of the urban area are the most sensitive parameters to urban groundwater mtts while stormwater infiltration rate is critical to the groundwater mtts the position and length of the sis appear to have marginal effects on groundwater mtts the sensitivity analysis suggests that simultaneous restoration of discharge and transit times is impossible due to the alteration in flow pathways although the first moment of transit times can be restored to the pre urban one the shapes of ttds will inevitably change in response to the imperviousness and the infiltration focused recharge overall being computationally efficient the proposed analytical model surpasses existing transit time models in terms of explicitly accounting for the impact of urban imperviousness and sis it provides decision making support for the design of the sis and has great implications for the restoration of urban stream hydrology credit authorship contribution statement miao jing methodology investigation writing original draft estanislao pujades methodology writing review editing chunhui lu conceptualization investigation resources writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements c lu acknowledges the financial support from the national key r d program of china 2021yfc3200500 national natural science foundation of china 51879088 and the natural science foundation of jiangsu province bk20190023 m jing acknowledges the financial support from the national natural science foundation of china 52109012 appendix a changes of transit time pdfs in response to sampled parameter values see fig a1 
3639,many uncertainties are involved in flood control operation of a multi reservoir system and result in risks for the system risk analysis for reservoir flood control operation is essential for decision making traditional flood control risk analysis only takes flood forecast error as the main risk source ignoring the influence of dynamic control of flood limited water level on reservoir initial water level for flood regulation in this study the spatial correlation of reservoir initial water level errors and the spatiotemporal correlation of flood forecast errors are identified via copula function a risk analysis model considering both upstream and downstream is established for multi objective flood control operation of a complex reservoir system coupling multi dimensional uncertainties of reservoir initial water levels flood forecast errors reservoir capacity curve errors reservoir discharge curve errors and river flood routing errors the impact of multiple risk sources with spatiotemporal correlations on reservoir flood control operation is then evaluated and the competitive tradeoff between flood control risks in upstream and downstream analyzed the model is applied to a mixed four reservoir system in pi river basin in china results indicated that 1 there is a strong correlation between the reservoir initial water level errors in space and also between the flood forecast errors in space and time which can be effectively described by copula function and ignoring the correlations will underestimate the flood control risk 2 the two objective values of upstream and downstream show a clear competitive relationship and the solution that prefers one objective has low risk marginal benefit thus choosing a compromise solution can balance risks 3 coupling the initial water level uncertainty reduces the flood control risk caused by the flood forecast errors to a certain extent but also lead to the increase of extreme risk loss keywords uncertainty dynamic control of flood limited water level copula function multi objective flood control operation risk analysis 1 introduction as one of the main natural disasters flood seriously endangers human life and property safety kundzewicz et al 2019 reservoirs with a major purpose of flood control have gradually formed a comprehensive system from point to surface in a whole basin during the past years joint operation of multiple reservoirs plays an important role in achieving efficient flood management and water resources utilization through making the best of reservoir storage compensation however real time multi reservoir flood control operation involves many uncertainties flood control operation based on risk control and management is of great significance for coupling multiple risk factors and ensuring safe flood management ouarda and labadie 2001 morss et al 2005 zhu et al 2017 in real time flood control operation the operation scheme is made according to the flood forecast information forecasting errors exist in flood forecast owing to some uncertain factors such as rainfall input model structure and parameters diao et al 2007 chen et al 2016 underestimating the actual inflow in the forecast may result in risk events due to high reservoir level or excessive discharge it is widely accepted that flood forecast error is the main risk source in reservoir flood control operation zhu et al 2018 chen et al 2015a chen et al 2015b derived the analytical expression of flood risk using the stochastic differential equation of reservoir flood routing which is based on normal distribution described flood forecasting errors due to the high convergence of weather forecast underlying surface conditions in space and the interrelated errors of forecast model in time a multi order time space correlation is also formed in flood forecast uncertainty many scholars have incorporated the error correlation into flood control risk study for multi reservoir systems zhao et al 2011 zhao et al 2013 established a martingale model to describe the dynamic evolution of hydrological forecast uncertainty and evaluated its impact on real time reservoir operation decision making xu et al 2021 took the complicated correlation in flood forecast errors into account by simulating flood scenarios with copula function and then conducted flood risk analysis and risk diagnosis for the reservoir system in addition to flood forecast uncertainty engineering parameter errors flood propagation uncertainty and time delay of real time decision making are also risk factors causing flood control risk diao and wang 2010 calculated the integated risk using monte carlo simulation method based on latin hypercube sampling considering hydrological hydraulic level storage and time delay uncertainties chen et al 2017 proposed a decomposition integration method to decompose a complex flood control system and analyzed the reservoir and downstream flood risks by comprehensively considering errors of flood forecast reservoir capacity curve discharge curve and flood routing model moreover reservoir flood control operation is also a multi objective problem coordinating the upstream and downstream safeties which are often in conflict with each other storing floodwater in reservoir as much as possible would increase flood control losses of the dam and the reservoir area while releasing too much floodwater downstream would increase the flood pressure on the downstream river zhu et al 2017 developed a multiobjective stochastic programming with recourse model for optimal flood control operation considering the forecast evolution the pareto front under uncertainty was derived through the constraint method coupled with a two step process reasonable results were obtained from an application on pubugou reservoir chen et al 2020 proposed a multi objective risk management model for a parallel reservoir system based on nsga iii consisting of a risk optimal operation submodel a risk assessment submodel and an optimization submodel the model was applied to huaihe river basin to analyze the trade off between different objectives it can be seen from the above studies that with the improvement of flood control engineering system and the development of flood control operation theory the research on flood control risk of reservoir systems is gradually becoming systematic and comprehensive which is manifested in that the research object is from a single reservoir to multireservoir systems the risk source identification is from a single factor to multiple factors and the operation objective is from a single objective to multiple objectives however the current research only considers the uncertainties of information input and the engineering itself and the reservoir flood control operations are all started from the designed flood limited water level flwl that is the initial conditions uncertainty is not considered in the current context of water scarcity floodwater utilization has become an important way to improve water resources utilization rate under the premise of ensuring flood control safety as the main task during flood seasons the reservoir system should also take into account the flood resources utilization so as to give full play to the comprehensive benefits of the engineering system chang et al 2017 flood resource utilization is mainly based on dynamic control of flood limited water level dc flwl of reservoirs chen et al 2013 ding et al 2015 traditionally before the occurrence of a flood reservoir level should always be maintained at or below the designed flwl to accommodate a possible impending large flood currently based on increasingly accurate hydro meteorological forecasting techniques the flwl can be raised for water use when no flood is forecasted this is known as dc flwl the upper bound of flwl is usually determined by calculating the pre release water in the effective forecast lead time zhou et al 2018 introduced a modified aggregation decomposition method to calculate the upper limits of flwls for cascade reservoirs according to forecast inflow and dynamic operation rules lu et al 2020b proposed a two stage pre release based on forecasts method to identify the upper bound of reservoir flwl through coupling weather forecast and flood forecast due to forecast errors the upper bound of flwl determined based on the forecast information also has uncertainty flood resource utilization is usually to refill water in the flood recession period to make profits and use or release floodwater to drop the reservoir level to the designed flwl when the next flood occurs however if the weather forecast fails to forecast a rainfall or the flood forecast underestimates the actual inflow the floodwater stored in the flood control capacity can not be released in time which will lead to the reservoir water level higher than the designed flwl at the occurrence of the flood causing additional flood control risk gabriel martin et al 2019 lu et al 2020a lu et al 2020b lu et al 2020a coupled the uncertainty of initial regulating water level caused by dc flwl with the uncertainty of flood forecast for a single reservoir and analyzed the difference in the impact of the two risk sources on reservoir flood control risk to the authors knowledge there are yet no studies on the flood control risk for complex multi reservoir systems caused by the uncertainty of reservoir initial regulating water levels based on dc flwl in this paper the initial water level uncertainty is introduced into multi reservoir flood control risk analysis where the risk analysis model is established by coupling multiple uncertain risk sources in the risk sources identification the correlation between initial regulating water level errors of different reservoirs and the spatial and temporal dependences of flood forecast errors are described using copula functions the upstream and downstream objectives in flood control operation are both taken into consideration to develop a two objective optimal operation model then the influences of each uncertainty and the mixed dependences in uncertainties on the system flood control risk and the risk variation between upstream and downstream are analyzed the rest of this paper is organized as follows section 2 elaborates the proposed methodology including identification of uncertainties in initial water level flood forecast reservoir capacity curve reservoir discharge curve and river flood routing stochastic simulation of multi objective flood control operation model for a multi reservoir system and flood control risk analysis for the reservoir system section 3 shows the application results of the methodology with a case study of the mixed reservoir system in pi river basin section 4 presents the analysis and discussion of the results the final conclusions are provided in section 5 2 methodology this section is presented in three parts uncertainties in flood control operation of a multi reservoir system multi objective flood control operation model and risk definition and calculation the framework of the proposed methodology is shown in fig 1 2 1 uncertainties in flood control operation of a multi reservoir system five uncertainties are considered the reservoir initial water level uncertainty the hydrological uncertainty of flood forecast the hydraulic uncertainty of reservoir discharge capacity the uncertainty of reservoir capacity curve and the uncertainty of river flood routing among them the correlation of the initial water level uncertainties between reservoirs and the time space correlation of flood forecast errors between catchment intervals and time periods are taken into account the existing multivariate analysis methods mainly include multivariate normal distribution multivariate exponential distribution gumbel mixed model and gumbel logic model copula function etc the copula function has been widely studied and applied in recent years because of its flexible marginal distributions and diverse joint distribution structures which has unique advantages for establishing multivariate complex coupling relations grimaldi and serinaldi 2006 lee and salas 2011 we adopted the copula function to characterize the uncertainty correlations copula function is a multivariate probability distribution whose marginal distributions obey 0 1 uniform distribution sklar s theorem sklar 1959 shows that copula function can connect multivariate probability distributions to their one dimensional marginal distributions for any n variable x1 x2 xn the multivariate joint cumulative distribution function f x1 x2 xn can be expressed as the marginal distributions of random variables fi xi and a connection function c 1 f x 1 x 2 x n c f 1 x 1 f 2 x 2 f n x n if the joint probability density function of the multi variable is f then 2 f x 1 x 2 x n c f 1 x 1 f 2 x 2 f n x n f 1 x 1 f n x n where c f 1 x 1 f n x n c f 1 x 1 f n x n f 1 x 1 f n x n if the marginal distributions fi xi are continuous there is a unique copula function two common families of copula functions are elliptical copulas gaussian student t copula and archimedean copulas gumbel clayton frank etc the copula function expression and parameter range are shown in the appendix 2 1 1 initial water level uncertainty the method of pre release based on forecasts is to determine the excess water storage in the recession period of a flood with the water flow for utilization as the pre release flow in the forecasted no rain period pre release for water supply and the downstream safety discharge as the pre release flow in the effective lead time of the next flood pre release for flood control lu et al 2020 the equation is shown in eq 3 3 δ w 0 t d q m d t t d 1 t d t f α q s q fl t d t where w is the upper bound of the excess storage qm is the water flow for utilization td is the forecasted no rain period tf is the effective forecast lead time of flood forecast α is the discount coefficient of safety discharge qs is the safety discharge at the downstream flood control point and qfl t is the forecasted flood flow the current time is set as 0 forecast information including the no rain period in weather forecast and the flood inflow in flood forecast is required for calculating the excess storage in decision making however the deviation between forecast and actual information can cause the calculated excess storage deviating from the actual required excess storage which will result in the initial reservoir water level for the next flood being higher than the original designed flwl we denote the actual required excess storage as wa on the premise of overstoring w determined by the forecast information wa is pre released based on the actual situation then the initial water level z 0 is 4 z 0 f v x δ w δ w a where vx is the reservoir storage at the designed flwl and f is the level capacity curve it can be known from eq 4 that empirical samples of the reservoir initial water level according to the pre release based on forecasts method can be obtained from historical forecast data and measured data for a multi reservoir system consisting of m reservoirs the aggregation decomposition method zhou et al 2014 is utilized to calculate the sample values of the initial water level of each reservoir due to the high correlation of the forecast information within a basin the initial water level uncertainty of each reservoir also has a complex coupling relationship the copula function is used to establish the joint distribution function of the initial level of each reservoir z 0 1 z 0 2 z 0 m for stochastic simulation the specific steps are as follows 1 calculate the marginal distribution function values of z 0 1 z 0 2 z 0 m according to their empirical samples using the non parametric method 2 fit the parameters of each alternative copula function using the maximum likelihood estimation method 3 calculate the goodness of fit statistics aic akaike information criterion rmse the root mean square error and dmax k s test statistic zhang and singh 2006 chen et al 2017 to select the optimal copula model 4 generate m random vectors θ 1 θ 2 θ m with correlations obeying 0 1 uniform distribution according to the optimal copula model the vector length is l i e the simulation number 5 calculate the simulation values of the initial water level of each reservoir z 0 1 l z 0 2 l z 0 m l l 1 2 l through inverse calculation of the marginal distribution of each variable according to the sample values of the random vectors obtained in the previous step 2 1 2 flood forecast uncertainty due to rainfall input and hydrological model errors the flood forecast errors of a multi reservoir system are correlated to a temporal and spatial context which is shown in the error correlation between different catchment intervals and different forecast times huang et al 2018 catchment intervals include the intervals above reservoirs and above downstream flood control points define the forecast errors at time t of the i th reservoir and the j th downstream interval ei t ej t as the difference between the forecast value and the observed value shown in eq 5 5 e i t q r for i t q r obs i t e j t q l for j t q l obs j t t 1 2 t where qrfor i t qrobs i t are the forecasted and observed inflow of the i th reservoir respectively qlfor j t qlobs j t are the forecasted and observed inflow of the j th downstream interval respectively and t is the total forecast time issued by the forecast system for a multi reservoir system containing m reservoirs and n downstream flood control intervals the forecast error can be presented as the following matrix with a dimension of m n t 6 e e 1 1 e 1 2 e 1 t e 2 1 e 2 2 e 2 t e m n 1 e m n 2 e m n t the archimedean copula embraces a large number of decompositions in the application of high dimensional variables the parameter estimation is complicated and part of joint distribution information is easily lost while the elliptical copula can be structured based on the correlation coefficient matrix between variables which has certain advantages in structuring high dimensional distribution models chen et al 2016 the student t copula is applied in this study to establish the joint distribution of the spatiotemporally correlated forecast errors and stochastic simulation is carried out based on the copula model the specific steps are as follows 1 count the flood forecast errors of each catchment interval to obtain the error samples from historical forecast and measured data then establish their marginal distributions 2 estimate the parameters of the t copula function using the maximum likelihood method 3 generate m n t random vectors of error distribution function values for each catchment interval and forecast period θ 1 1 θ 1 t θ 2 1 θ 2 t θ m n 1 θ m n t following 0 1 uniform distribution the vector length is l i e the simulation number 4 obtain the simulation values of forecast error of each catchment interval and forecast period e 1 1 l e 1 t l e 2 1 l e 2 t l e m n 1 l e m n t l l 1 2 l by inverse calculation of the marginal distribution of each variable according to the sample series of distribution function values in the previous step 5 add the error series to the forecast process to obtain the reservoir inflow series and the flood control interval inflow series 7 q r i t l q r obs i t e i t l i 1 m t 1 t l 1 l 8 q l j t l q l obs j t e j t l j 1 n t 1 t l 1 l where q r i t l is the simulated inflow of the i th reservoir at time t of the l th simulation and q l j t l is the simulated inflow of the j th flood control interval at time t of the l th simulation 2 1 3 uncertainties in reservoir discharge curve reservoir capacity curve and river flood routing 1 the uncertainty in reservoir discharge curve is due to the difference between actual and design discharge capacity caused by the size of discharge facilities discharge coefficient and measurement errors to account for this uncertainty a random error factor ε 1 i is introduced for the discharge capacity so that the actual discharge capacity is expressed as 9 q max i t f zq z i t 1 ε 1 i where q max i t is the discharge capacity of the i th reservoir at time t zi t is the water level of the i th reservoir at time t and fzq is the reservoir discharge curve studies have shown that the normal distribution is the best probability distribution model for hydraulic uncertainty chu 1992 that is ε 1 i n 0 σ 1 i 2 in which σ 1 i is the standard deviation of the error distribution of reservoir i which can be determined from measured reservoir discharge data 2 the reservoir level storage uncertainty is mainly shown in the reservoir capacity curve errors caused by sediment erosion and deposition dynamic reservoir capacity and measurement errors introducing a random error factor ε 2 i for the reservoir capacity curve the actual water level capacity relationship is expressed as 10 v i t f zv z i t 1 ε 2 i where v i t is the storage capacity of reservoir i at time t and fzv is the reservoir capacity curve it is also assumed that ε 2 i obeys the normal distribution ε 2 i n 0 σ 2 i 2 in which σ 2 i is the standard deviation of the error distribution of reservoir i which can be determined from measured reservoir capacity data 3 the uncertainty in flood routing is mainly due to the discrepancy between the calculated downstream flood flow and the actual flow caused by the model error using the muskingum flood evolution model and introducing a flood propagation random error factor ε 3 i the actual downstream flow is expressed as 11 q c i t r q i t 1 ε 3 i where q c i t is the response of the outflow from reservoir i at the downstream flood control point or at the downstream reservoir at time t qi t is the outflow of reservoir i at time t and r is the muskingum model in the same way ε 3 i is set to follow the normal distribution ε 3 i n 0 σ 3 i 2 where σ 3 i is the standard deviation of the error distribution of reservoir i which can be determined from measured downstream flow data based on the above normal distributions the errors of each reservoir discharge curve reservoir capacity curve and river flood routing can be generated respectively ε 1 1 l ε 1 2 l ε 1 m l ε 2 1 l ε 2 2 l ε 2 m l ε 3 1 l ε 3 2 l ε 3 m l l 1 2 l 2 2 multi objective flood control operation model for a multi reservoir system in the flood control operation of a multi reservoir system we need to dynamically coordinate the flood control capacity of each reservoir and develop operation strategies based on real time forecast information to ensure the flood control safety of the reservoir system generally the flood control objectives include the safeties of reservoir itself and downstream of the reservoir for the reservoir safety upstream submergence and dam safety due to high water levels should be considered downstream safety is mainly about scouring resulted from excessive river flow embankment safety caused by high river levels etc the two objectives are usually in conflict with each other preference for upstream safety needs to increase discharge as much as possible to lower reservoir water level while downstream safety requires reservoir to retain as much floodwater as possible it is an important issue to be addressed to coordinate the two objectives in flood control operation of a multi reservoir system this study establishes a flood regulation model considering the two objectives and explores the trade off between the conflicting objectives and the risk variation between upstream and downstream the objective function and constraints for the l th stochastic scenario are shown below 2 2 1 objective functions the upstream flood control objective is to minimize the maximum occupation rate of flood control capacity in the flood regulation expressed as 12 min f 1 i 1 m max v i l t v x i v max i t 1 t where v i l t is the water storage of reservoir i at time t in the l th stochastic scenario vx i is the storage of reservoir i at the designed flwl and v max i is the flood control capacity of reservoir i the downstream flood control objective is to minimize the total ratio of the maximum discharge and the allowable maximum discharge of each reservoir expressed as 13 min f 2 i 1 m max q i l t q i t t 1 t where q i l t is the outflow from reservoir i at time t in the l th stochastic scenario and q i t is the maximum allowable discharge of reservoir i 2 2 2 constraints constraints include 1 water balance equation 14 v i l t 1 v i l t k ω i r q c k l t q i l t q i l t δ t where v i l t v i l t 1 are respectively the water storage of reservoir i at the beginning and end of time period t in the l th stochastic scenario ω i r represents all the upstream reservoirs that have a direct hydraulic connection to reservoir i q c k l t is the flow response of the outflow of the k th upstream reservoir at reservoir i q i l t and q i l t are respectively the inflow and outflow of reservoir i in time period t and t is the operation time interval 2 reservoir water level limits 15 z i t z i l t z i t where z i l t is the water level of reservoir i at time t in the l th stochastic scenario and z i t z i t are the lower and upper bounds of the water level of reservoir i at time t respectively 3 outflow limits 16 q i t q i l t q i t where q i t q i t are the lower and upper bounds of the outflow of reservoir i at time t respectively the lower bounds are set to satisfy the minimum ecological flow and basic water supply the upper bounds can be determined according to the downstream flood control situation 4 discharge capacity limits 17 q i l t q max i t 5 outflow variation limits 18 q i l t 1 q i l t δ q i where δ q i is the maximum allowable discharge variation of reservoir i between adjacent times 6 initial and boundary conditions 19 z i l 0 z 0 i l 20 z i l t z e i where z i l 0 is the initial regulating water level of reservoir i at the initial time t 0 in the l th stochastic scenario z 0 i l is the simulated initial water level of reservoir i in the l th stochastic scenario z i l t is the final water level of reservoir i at the end time t t of an operation period in the l th stochastic scenario and zei is the target final water level of reservoir i which is generally set as the designed flwl or the upper bound of dc flwl based on forecast information for flood resource utilization 2 2 3 solution algorithm currently the main methods for solving multi objective optimization problems are the weighted method multi objective transformed into single objective constraint method objective transformed into constraint nsga nondominated sorting genetic algorithm and other evolutionary algorithms we adopt nsga iii algorithm deb and jain 2014 jain and deb 2014 for the proposed model this algorithm is an improved multi objective optimization algorithm based on a fast nondominated sorting genetic algorithm deb et al 2002 and its effectiveness has been proved in many studies the outflow of each reservoir is taken as the decision variables the stage wise trial and error method zhong et al 2003 commonly used in reservoir flood control operation is employed for constraint handling pareto fronts corresponding to l stochastic scenarios can be then obtained respectively the algorithm flow is shown in fig 2 2 3 risk definition for multi reservoir flood control operation the uncertainty in each risk factor leads to the uncertainty in the outcome of multi reservoir flood control operation the stochastic simulation model for multi objective flood control operation of multiple reservoirs yields what is in effect a series of target sample data corresponding to the random samples of risk factors the highest reservoir level and the maximum flow at the downstream flood control point are usually used as the target variables for risk calculations influenced by uncertainties these target variables are actually random variables with certain distributions the flood control risk of a multi reservoir system includes the flood control risks of each reservoir and each downstream flood control point in the system and the risk of the entire system defined as follows 1 reservoir flood control risk 21 p ri p r o b z max i z s i c o u n t l z max i l z s i l where pri is the flood control risk of reservoir i z max i is the highest water level of reservoir i and zs i is the safe water level of reservoir i which can be set according to real time flood control requirements 2 downstream flood control risk 22 p qi p r o b q c max i q c s i c o u n t l q c max i l q c s i l where pqi is the flood control risk at the downstream of reservoir i qc max i is the maximum flow at the downstream of reservoir i and qcs i is the safety discharge at the downstream of reservoir i 3 system risk if the operation result of any element in the reservoir system exceeds the given safety threshold the system is considered to be at risk therefore we define the system risk p s as the probability that the highest water level of any reservoir or the maximum flow at any downstream flood control point exceeds its safety threshold expressed as 23 p s c o u n t l z max i l z s i o r q c max i l q c s i l i 1 2 m 3 case study 3 1 study area a mixed reservoir system on the pi river in the huai river basin is selected as the case study the reservoirs in the pi river basin are located in the upper reaches of the huai river basin on a tributary the east pi river there are foziling fzl mozitan mzt and bailianya bly reservoirs with a catchment area of 1840 km2 one reservoir called xianghongdian xhd is on the west pi river incorporating a catchment area of 1400 km2 the reservoir system contains two individual flood control points and one common flood control point which are huoshan hs at the downstream of bmf reservoirs bly mzt and fzl reservoirs dushan ds at the downstream of xhd reservoir and hengpaitou hpt at the downstream of the entire system respectively the schematic of the flood control system is shown in fig 3 the forecast time of the system forecast model is 72 h with a time interval of 3 h some characteristics and parameters of the reservoirs are presented in table 1 3 2 stochastic simulation of risk sources we carried out stochastic simulations for errors of initial water levels flood forecasts discharge capacity water level storage capacity and river flood routing to analyze the flood control risks of the reservoir system the simulation number l 100 3 2 1 initial water level uncertainty on the premise that there is no rain in the meteorological forecast with a 24 hour rolling forecast the forecasted no rain days are used as the no rain period in excess storage calculation by the pre release based on forecasts method when there is rainfall in the weather forecast no rain day is 0 the reservoirs do not store excess water the actual required excess storage wa based on measured data and the theoretical excess storage w based on forecast information are calculated using the measured and forecast information of the flood seasons june to september of 2007 2015 the empirical samples of the initial water level of each reservoir are then derived based on eq 4 and the sample size is 909 after removing the cases with forecasted rainfall the correlation coefficients of the empirical samples of the four reservoirs are shown in eq 24 it can be seen that the initial water levels of the four reservoirs have a strong correlation due to the high correlation of forecast errors within the basin especially the three reservoirs of bmf between which the correlation coefficients are higher than 0 9 located on the west pi river xhd reservoir is relatively independent of bmf reservoirs on the east pi river therefore the correlation coefficients between xhd and bmf reservoirs are lower 24 cor 1 0 93 0 90 0 43 0 93 1 0 90 0 42 0 90 0 90 1 0 42 0 43 0 42 0 42 1 five common copula functions gaussian t gumbel clayton and frank were used to fit the joint distribution of the empirical samples of the four reservoirs and the goodness of fit was tested the goodness of fit statistics of each copula model are listed in table 2 the smaller aic rmse and dmax values the better the fitting effect from table 2 we can see that the t copula has the best goodness of fit for the initial water levels of the four reservoirs thus t copula is selected as the optimal copula model to describe the correlation between the reservoir initial water levels and the fitting parameters are obtained through the maximum likelihood method as shown in table 3 the comparison of the empirical copula values and the theoretical values of the fitted t copula is shown in fig 4 from which it can be seen that the empirical values are consistent with the fitted values with the scatter points evenly distributing around the 45 straight line indicating that the t copula function has a good fitting effect for the sample data based on the fitted t copula and inverse calculation of marginal distribution 100 simulation initial water level values of the four reservoirs are obtained their frequency distributions are shown in fig 5 the random initial water levels of each reservoir are densest at the original designed flwls and gradually decrease to both sides which is consistent with the distribution regularity of forecast errors lu et al 2020b 3 2 2 flood forecast uncertainty this flood control system includes forecasts of five catchment intervals namely the catchment intervals of bly mzt fzl and xhd reservoirs and the interval between reservoirs and hpt flood control point the forecast lead time is 72 h and the time step is 3 h based on historical forecast and observed flood series the forecast error samples of each catchment interval and each forecast period are obtained the marginal distribution is established by the normal distribution and the joint distribution is fitted by t copula function with a variable dimension of 5 24 the correlation coefficient matrices of the observed forecast error series and the 100 spatiotemporally correlated random forecast error samples generated with the t copula function are shown in fig 6 this figure demonstrates that the flood forecasts of the reservoir system have a clear spatial and temporal correlation character the forecast errors of each catchment interval are strongly correlated in time i e between different forecast periods diagonal squares the forecasts of the three reservoirs of bmf located on the east pi river have a high spatial correlation while their spatial correlation with that of xhd reservoir on the west pi river is weaker moreover the flood forecast of the hpt flood control interval is also spatially high correlated with that of bmf reservoirs and weakly correlated with that of xhd reservoir a comparison of fig 6 a and b shows that the random error samples generated by t copula have a good simulation effect and have a high correlation match with the measured sample series a forecast flood in july 2016 was taken as the experimental flood sequence and the corresponding 100 stochastic flood processes were obtained by adding the simulated random forecast errors on it as shown in fig 7 the random distribution of inflow in each period is shown in the figure the stochastic flows are symmetrically distributed on both sides of the forecast flow and become more widely distributed as the magnitude of the forecast flow increases to examine the preservation of marginal distribution characteristics of the simulation results srinivas and srinivasan 2001 statistical attributes mean value and standard deviation of the simulated and historical samples are presented in table 4 taking peak flow in each catchment interval as an example it can be seen that the statistical attributes of forecast uncertainties are well preserved by the generated samples 3 2 3 other uncertainties the errors in discharge capacity level capacity and flood routing are all set to a normal distribution denoted as ε 1 i n 0 0 052 ε 2 i n 0 0 052 and ε 3 i n 0 0 052 i 1 4 then 100 random numbers that obey the above distributions are generated as the random error samples of the three uncertainties 3 3 experiment settings for multi objective risk analysis the nsga iii algorithm was run with parameters set as follows population size n 50 number of iterations maxgen 5000 parameters of each reservoir in the model are listed in table 5 in order to compare the impact of the initial water level uncertainty and the flood forecast uncertainty on the flood control risk of the reservoir system and to analyze the impact of the dependences in the two uncertainties four numerical experiments are designed and applied to the model denoted as case 1 case 2 case 3 and case 4 respectively case 1 stochastic simulation taking into account the flood forecast uncertainty and discharge capacity level capacity and flood routing uncertainties the model input is the simulation samples of the flood forecast stochastic scenarios considering the time space correlations and the errors of discharge capacity etc and the initial regulating level of each reservoir is set as the designed flwl case 2 stochastic simulation taking into account the initial water level uncertainty and discharge capacity level capacity and flood routing uncertainties the model input is the simulation samples of the initial regulating water levels considering the spatial correlations and the errors of discharge capacity etc and the flood process uses the deterministic forecast flood process case 3 stochastic simulation taking into account all the uncertainties including the five uncertainties of initial water level flood forecast discharge capacity level capacity and flood routing the model input is the simulation samples of the initial regulating water levels considering the spatial correlations the flood forecast stochastic scenarios considering the spatiotemporal correlations and the errors of discharge capacity etc case 4 stochastic simulation taking into account all the uncertainties but ignoring the correlations in the uncertainties the model input is the randomly generated reservoir initial water levels flood forecast errors without considering correlations and the errors of reservoir discharge curve reservoir capacity curve and river flood routing 3 4 results of the flood control risks to verify the multi objective flood control operation model and conduct risk calculation and analysis the deterministic multi objective operation results without considering errors are presented first see section 3 4 1 where each reservoir is operated from the designed flwl with the forecasted flood the original discharge curve capacity curve and the deterministic flood routing parameters based on the deterministic operation results and the stochastic simulation results of the above four cases the calculation and analysis of reservoir downstream and system risks are then shown in section 3 4 2 3 4 1 deterministic multi objective operation the pareto non inferior solution front of the multi objective operation model is shown in fig 8 a and the curve of hypervolume index hv with the number of evolution generations is shown in fig 8 b as can be seen from fig 8 a there is an obvious competition between objectives f 1 and f 2 i e the highest water level and the maximum outflow of each reservoir are oppositely transformed with a decrease in the highest water level accompanied by an increase in the maximum outflow fig 8 b shows that hv remains stable when the iteration number reaches 2000 and the algorithm tends to converge the 50 non inferior operation schemes are shown in figs 9 and 10 fig 9 presents 50 water level processes for each reservoir with each starting at the designed flwl and reaching the target water level at the end time there are different processes in between representing the operation schemes corresponding to different non inferior solutions among them the difference in water level processes of bly reservoir in bmf subsystem is the largest it is due to the maximum flood control capacity of bly reservoir has an advantage in optimizing the first objective by the algorithm fig 10 a d shows 50 non inferior outflow processes of each reservoir and fig 10 e illustrates 50 non inferior flow processes at hpt flood control point downstream of the entire system which is the sum of outflow processes from fzl xhd via river routing and lateral inflow processes above hpt the river flood routing is calculated by the muskingum method with parameters c0 0 25 c1 0 57 c2 0 18 3 4 2 flood control risk evaluation based on the non inferior solutions obtained from stochastic simulation the flood control risks of four reservoirs three flood control points and the whole system are calculated respectively the sequence numbers of the non inferior solutions of the multi objective operation are 1 2 50 in order from smallest to largest of objective f 1 f 2 from largest to smallest as shown in fig 8 a the maximum water levels of bly mzt fzl and xhd reservoirs in non inferior solution 50 in the deterministic multi objective operation results are 209 7 189 5 125 129 m respectively set as the safe water levels of the four reservoirs the safety discharge at hs ds and hpt flood control points are set to 3000 1500 and 8400 m3 s respectively according to the current flood control situation the risk results of the four cases obtained based on the risk calculation equations in section 2 3 are shown in tables 6 9 due to limited space the tables only present the results of 11 solutions of 1 5 10 50 from the tables it can be seen that the risk values of the four reservoirs basically show a trend of gradually increasing as the objective value of the highest reservoir level increases among which the risk value of bly reservoir varies the most this is related to the more discrete non inferior water level processes of bly caused by the predominance of the flood control capacity of bly in bmf subsystem as explained in section 3 4 1 meanwhile the risks of downstream flood control points are decreased with the solution number the risk of ds flood control point at the downstream of xhd reservoir is 0 the reason is that the outflow of xhd reservoir is set below the safety flow of 1500 m3 s at ds in the model a comparison of the system risk rates of different non inferior solutions for the four cases is shown in fig 11 from this figure and the calculated risk results it can be learned that 1 from the performance of multi objective non inferior solutions the system risks all show a trend of first decreasing and then increasing as the objective value of f 1 goes from the lowest to the highest this indicates that in the non inferior solution front the marginal benefit of risk is relatively low for the extreme objective values a compromise solution in the middle part should be selected to balance the risk 2 from the impact of risk sources combination in general the relationship between the risk magnitude is case 1 case 3 case 2 that is the risk of considering only flood forecast and other uncertainties case 1 is greater than that of considering flood forecast initial water level and other uncertainties case 3 and the risks of these two are much greater than that of considering only initial water level and other uncertainties case 2 it illustrates that coupling the initial water level uncertainty will reduce the flood control risk caused by flood forecast errors to a certain extent this is because the traditional flood risk analysis considering flood forecast uncertainty sets the reservoir initial water level at the designed flwl in fact there is a large probability that the initial water level is lower than the designed flwl 3 from the impact of the correlations in risk sources comparing the risk results of considering the uncertainties with spatiotemporal correlations case 3 and without correlations case 4 it is found that the risk of case 4 is less than that of case 3 indicating that ignoring the mixed dependences in risk sources will lead to an underestimate of the system flood control risk 4 discussions the model results are further discussed and analyzed based on the stochastic simulation results of operation processes from the 50 non inferior solutions three representative solutions solution i which is fully biased towards the upstream object f 1 solution ii which is a compromise between the upstream and downstream solution iii which is fully biased towards the downstream object f 2 shown in fig 8 a are selected based on topsis zhu et al 2017 for the analysis of the stochastic simulation results firstly the compromise solution solution ii is used to demonstrate the stochastic operation processes and then the three non inferior solutions solution i ii and iii are compared and analyzed in terms of their statistical extreme values 1 stochastic operation processes of solution ii fig 12 presents the stochastic water level processes of each reservoir for the four cases of the trade off solution ii with the safe level of each reservoir identified by a horizontal line from fig 12 we can know that for case 1 3 ① when the effect of initial water level is not taken into account the water level dispersion caused by the flood forecast uncertainty shows a trend of increasing then decreasing case 1 on the one hand the distribution range of flood forecast error gradually increases with the rise of the flood fig 7 and on the other hand it is due to the constraint of the reservoir target final water level in the model ② the initial water level uncertainty has the strongest water level dispersion at the initial time t 1 but gradually decreases as the process develops case 2 indicating that the initial water level has some influence on subsequent flood regulation but the influence decreases with time the longer the flood regulation time the smaller the impact for a short duration flood regulation process this impact is nonnegligible ③ the stochastic water level processes considering all uncertainty risk sources case 3 couples the effects of the first two cases with the distribution similar to that of case 1 in the early flood regulation period and the distribution of the range above the median similar to that of case 2 in the late period comparing the effects of considering correlations or not cases 3 4 reveals that ignoring correlations in risk sources significantly reduces the dispersion ranges of reservoir levels in the late flood regulation period especially the ranges above the median values the stochastic outflow processes of each reservoir and flow processes at hpt for the four cases are shown in fig 13 with the safety flow of each point identified by a horizontal line it can be seen that the outflow from each reservoir is distributed between the given maximum and minimum values we can know from fig 13 e that in terms of the distribution of the maximum flow discharge comparing case 1 3 case 2 has the narrowest dispersion range case 3 the largest and case 1 lies between them it suggests that the initial water level has the least influence compared with only considering flood forecast error and other errors of discharge capacity and so on coupling the initial water level uncertainty will somewhat reduce the discharge distribution range 2 comparative analysis of solution i ii and iii the stochastic simulation results of the maximum water levels of the four reservoirs for solution i ii and iii are shown in fig 14 and the stochastic simulations of the maximum downstream flows represented by the flood control point at the downstream of the entire system hpt are shown in fig 15 as can be seen from fig 14 the distributions of the highest water levels of bly and mzt reservoirs tend to move upward with solution i iii and the upward trend of bly is more significant the distributions of different solutions of fzl reservoir is concentrated because the highest water level appears close to the end of the operation period fig 12 c therefore except for some outliers caused by extreme flood processes with large errors most simulation results converge to 125 m the highest water level distribution of xhd reservoir moves up slightly with solution i iii but the difference is small the reason is that xhd has very large storage capacity even widely varying discharge schemes within the upper and lower outflow limits will only result in a gentle change in maximum water level contrary to the changing trend of the reservoir results the distributions of the maximum downstream flows in fig 15 show a downward trend with the three solutions indicating the competitive relationship between the upstream and downstream objectives the highest water level distributions of the four cases in fig 14 corresponds to the flood control risk rates of each reservoir in tables 6 9 that is under the influence of different combinations of risk sources the risk magnitude is case 1 case 3 case 2 and under the influence of spatiotemporal correlations the risk magnitude is case 3 case 4 however the risk rate only represents the probability of exceeding the safety threshold which is a concept of frequency and cannot fully represent the severity of the risk event for example in fig 14 a the risk rate of bly reservoir in case 1 is greater than that in case 3 but there exist some extreme values in case 3 greater than those in case 1 indicating that extreme risk events are more likely to occur in case 3 we introduce the conditional loss at risk also known as conditional value at risk cvar to characterize extreme risk events and measure the severity of risk events cvar refers to the mean value of losses in the tail exceeding a threshold at a given confidence level rockafellar and uryasev 2002 expressed as 25a cva r α l e l l v a r α l 1 α var α l l pdf l dl 26a va r α l min cdf l α where l is the loss function to display the risk indicator results directly we use the highest reservoir level and maximum flow as loss function for upstream and downstream α is the confidence level α 0 1 varα l denotes the minimum risk loss at the confidence level α pdf is the probability density function and cdf is the cumulative probability function table 10 displays the cvar values with the confidence level α 90 for the highest water level of each reservoir and the maximum flow at each flood control point it can be seen that ① the cvar of the reservoir highest water level increases with the increase of the objective value f 1 solution i iii while that of the maximum downstream flow decreases gradually the cvar of ds is always 1500 m3 s this is because the outflow of xhd is restricted to 1500 m3 s below which is distributed on the tail beyond the 90 confidence level ② on the whole the relationship between the magnitude of cvar of each reservoir is case 3 case 1 case 2 case 3 case 4 by comparing the relationship between the magnitude of the risk rates it can be seen that although the risk rate considering all uncertainties case 3 is less than that considering only flood forecast and other uncertainties case 1 the cvar is higher this means that while coupling initial water level uncertainty will reduce the risk rate due to the offsetting effect of errors it increases the cvar value this is the extreme risk event caused by the combined effect of the initial water level extremes and the flood forecast error extremes and is more severe than the case where only the flood forecast uncertainty is considered ③ the cvar values without considering the correlations in risk sources case 4 are much smaller than those considering the correlations case 3 indicating that under the influence of the correlations the reservoir system may have high initial regulating water levels and high flood inflows at the same time ignoring the correlations will underestimate the occurrence probability of system mass risk events 5 conclusions the traditional reservoir flood control risk analysis lacks full consideration of the risk source of dc flwl the dependences in risk sources and multiple objectives in flood control operation this study establishes a multi objective risk analysis model for a multi reservoir system under multi dimensional uncertainties coupling the initial water level uncertainty flood forecast errors reservoir capacity curve errors reservoir discharge curve errors and river flood routing errors the application results of a four reservoir system in the pi river basin show that 1 the initial regulating water level of each reservoir derived through the pre release based on forecasts method has a strong spatial correlation among the commonly used copula models t copula has the best fitting effect for it 2 there is a high correlation between flood forecast errors in different catchments and different forecast periods and t copula function can be used to accurately quantify the multi order spatiotemporal correlations of errors 3 ignoring the spatiotemporal correlations in risk sources will lead to an underestimate of flood control risk in a multi reservoir system especially the joint extreme risk events of the system 4 in multi reservoir flood control operation there is an obvious competition between reservoir and downstream objectives that is the reservoir highest water level and maximum outflow are in an opposing relationship 5 in the multi objective risk analysis for a reservoir system the system risk first decreases and then increases with the change of the objective value which indicates that in the non inferior solution front of multi objective operation the marginal benefit of risk is low for the extreme objective values a compromise solution in the middle part should be selected to balance the risk 6 the flood control risk caused by the initial water level uncertainty cannot be neglected coupling the initial water level uncertainty will reduce the flood control risk rate resulted from flood forecast errors to a certain extent but will increase the conditional loss at risk that is it may encounter more severe risk event than the case considering only the flood forecast uncertainty declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national key r d program of china grant no 2017yfc0405606 the national natural science foundation of china grant no 52079037 and 52009029 the fundamental research funds for the central universities grant no b200202032 the china postdoctoral science foundation grant nos 2020t130169 and 2019m661715 appendix a gaussian copula 25b c u 1 u 2 u n ρ φ 1 u 1 φ 1 u n 1 2 π n 2 ρ 1 2 exp 1 2 w t ρ 1 w d w where φ is the standard normal distribution function ρ is an n order symmetric positive definite matrix and w w 1 w 2 wn is the vector of integral variables t copula 26b c u 1 u 2 u n ρ υ t υ 1 u 1 t υ 1 u n γ υ n 2 γ υ 2 π υ n 2 ρ 1 2 1 w t ρ 1 w υ υ n 2 d w where t υ is the standard t distribution function with degree of freedom υ ρ is an n order symmetric positive definite matrix and w w 1 w 2 wn is the vector of integral variables gumbel copula 27 c u 1 u 2 u n exp ln u 1 θ ln u 2 θ ln u n θ 1 θ θ 1 clayton copula 28 c u 1 u 2 u n u 1 θ u 2 θ u n θ n 1 1 θ θ 0 frank copula 29 c u 1 u 2 u n 1 θ ln 1 exp θ u 1 1 exp θ u 2 1 exp θ u n 1 exp θ 1 2 θ 0 
3639,many uncertainties are involved in flood control operation of a multi reservoir system and result in risks for the system risk analysis for reservoir flood control operation is essential for decision making traditional flood control risk analysis only takes flood forecast error as the main risk source ignoring the influence of dynamic control of flood limited water level on reservoir initial water level for flood regulation in this study the spatial correlation of reservoir initial water level errors and the spatiotemporal correlation of flood forecast errors are identified via copula function a risk analysis model considering both upstream and downstream is established for multi objective flood control operation of a complex reservoir system coupling multi dimensional uncertainties of reservoir initial water levels flood forecast errors reservoir capacity curve errors reservoir discharge curve errors and river flood routing errors the impact of multiple risk sources with spatiotemporal correlations on reservoir flood control operation is then evaluated and the competitive tradeoff between flood control risks in upstream and downstream analyzed the model is applied to a mixed four reservoir system in pi river basin in china results indicated that 1 there is a strong correlation between the reservoir initial water level errors in space and also between the flood forecast errors in space and time which can be effectively described by copula function and ignoring the correlations will underestimate the flood control risk 2 the two objective values of upstream and downstream show a clear competitive relationship and the solution that prefers one objective has low risk marginal benefit thus choosing a compromise solution can balance risks 3 coupling the initial water level uncertainty reduces the flood control risk caused by the flood forecast errors to a certain extent but also lead to the increase of extreme risk loss keywords uncertainty dynamic control of flood limited water level copula function multi objective flood control operation risk analysis 1 introduction as one of the main natural disasters flood seriously endangers human life and property safety kundzewicz et al 2019 reservoirs with a major purpose of flood control have gradually formed a comprehensive system from point to surface in a whole basin during the past years joint operation of multiple reservoirs plays an important role in achieving efficient flood management and water resources utilization through making the best of reservoir storage compensation however real time multi reservoir flood control operation involves many uncertainties flood control operation based on risk control and management is of great significance for coupling multiple risk factors and ensuring safe flood management ouarda and labadie 2001 morss et al 2005 zhu et al 2017 in real time flood control operation the operation scheme is made according to the flood forecast information forecasting errors exist in flood forecast owing to some uncertain factors such as rainfall input model structure and parameters diao et al 2007 chen et al 2016 underestimating the actual inflow in the forecast may result in risk events due to high reservoir level or excessive discharge it is widely accepted that flood forecast error is the main risk source in reservoir flood control operation zhu et al 2018 chen et al 2015a chen et al 2015b derived the analytical expression of flood risk using the stochastic differential equation of reservoir flood routing which is based on normal distribution described flood forecasting errors due to the high convergence of weather forecast underlying surface conditions in space and the interrelated errors of forecast model in time a multi order time space correlation is also formed in flood forecast uncertainty many scholars have incorporated the error correlation into flood control risk study for multi reservoir systems zhao et al 2011 zhao et al 2013 established a martingale model to describe the dynamic evolution of hydrological forecast uncertainty and evaluated its impact on real time reservoir operation decision making xu et al 2021 took the complicated correlation in flood forecast errors into account by simulating flood scenarios with copula function and then conducted flood risk analysis and risk diagnosis for the reservoir system in addition to flood forecast uncertainty engineering parameter errors flood propagation uncertainty and time delay of real time decision making are also risk factors causing flood control risk diao and wang 2010 calculated the integated risk using monte carlo simulation method based on latin hypercube sampling considering hydrological hydraulic level storage and time delay uncertainties chen et al 2017 proposed a decomposition integration method to decompose a complex flood control system and analyzed the reservoir and downstream flood risks by comprehensively considering errors of flood forecast reservoir capacity curve discharge curve and flood routing model moreover reservoir flood control operation is also a multi objective problem coordinating the upstream and downstream safeties which are often in conflict with each other storing floodwater in reservoir as much as possible would increase flood control losses of the dam and the reservoir area while releasing too much floodwater downstream would increase the flood pressure on the downstream river zhu et al 2017 developed a multiobjective stochastic programming with recourse model for optimal flood control operation considering the forecast evolution the pareto front under uncertainty was derived through the constraint method coupled with a two step process reasonable results were obtained from an application on pubugou reservoir chen et al 2020 proposed a multi objective risk management model for a parallel reservoir system based on nsga iii consisting of a risk optimal operation submodel a risk assessment submodel and an optimization submodel the model was applied to huaihe river basin to analyze the trade off between different objectives it can be seen from the above studies that with the improvement of flood control engineering system and the development of flood control operation theory the research on flood control risk of reservoir systems is gradually becoming systematic and comprehensive which is manifested in that the research object is from a single reservoir to multireservoir systems the risk source identification is from a single factor to multiple factors and the operation objective is from a single objective to multiple objectives however the current research only considers the uncertainties of information input and the engineering itself and the reservoir flood control operations are all started from the designed flood limited water level flwl that is the initial conditions uncertainty is not considered in the current context of water scarcity floodwater utilization has become an important way to improve water resources utilization rate under the premise of ensuring flood control safety as the main task during flood seasons the reservoir system should also take into account the flood resources utilization so as to give full play to the comprehensive benefits of the engineering system chang et al 2017 flood resource utilization is mainly based on dynamic control of flood limited water level dc flwl of reservoirs chen et al 2013 ding et al 2015 traditionally before the occurrence of a flood reservoir level should always be maintained at or below the designed flwl to accommodate a possible impending large flood currently based on increasingly accurate hydro meteorological forecasting techniques the flwl can be raised for water use when no flood is forecasted this is known as dc flwl the upper bound of flwl is usually determined by calculating the pre release water in the effective forecast lead time zhou et al 2018 introduced a modified aggregation decomposition method to calculate the upper limits of flwls for cascade reservoirs according to forecast inflow and dynamic operation rules lu et al 2020b proposed a two stage pre release based on forecasts method to identify the upper bound of reservoir flwl through coupling weather forecast and flood forecast due to forecast errors the upper bound of flwl determined based on the forecast information also has uncertainty flood resource utilization is usually to refill water in the flood recession period to make profits and use or release floodwater to drop the reservoir level to the designed flwl when the next flood occurs however if the weather forecast fails to forecast a rainfall or the flood forecast underestimates the actual inflow the floodwater stored in the flood control capacity can not be released in time which will lead to the reservoir water level higher than the designed flwl at the occurrence of the flood causing additional flood control risk gabriel martin et al 2019 lu et al 2020a lu et al 2020b lu et al 2020a coupled the uncertainty of initial regulating water level caused by dc flwl with the uncertainty of flood forecast for a single reservoir and analyzed the difference in the impact of the two risk sources on reservoir flood control risk to the authors knowledge there are yet no studies on the flood control risk for complex multi reservoir systems caused by the uncertainty of reservoir initial regulating water levels based on dc flwl in this paper the initial water level uncertainty is introduced into multi reservoir flood control risk analysis where the risk analysis model is established by coupling multiple uncertain risk sources in the risk sources identification the correlation between initial regulating water level errors of different reservoirs and the spatial and temporal dependences of flood forecast errors are described using copula functions the upstream and downstream objectives in flood control operation are both taken into consideration to develop a two objective optimal operation model then the influences of each uncertainty and the mixed dependences in uncertainties on the system flood control risk and the risk variation between upstream and downstream are analyzed the rest of this paper is organized as follows section 2 elaborates the proposed methodology including identification of uncertainties in initial water level flood forecast reservoir capacity curve reservoir discharge curve and river flood routing stochastic simulation of multi objective flood control operation model for a multi reservoir system and flood control risk analysis for the reservoir system section 3 shows the application results of the methodology with a case study of the mixed reservoir system in pi river basin section 4 presents the analysis and discussion of the results the final conclusions are provided in section 5 2 methodology this section is presented in three parts uncertainties in flood control operation of a multi reservoir system multi objective flood control operation model and risk definition and calculation the framework of the proposed methodology is shown in fig 1 2 1 uncertainties in flood control operation of a multi reservoir system five uncertainties are considered the reservoir initial water level uncertainty the hydrological uncertainty of flood forecast the hydraulic uncertainty of reservoir discharge capacity the uncertainty of reservoir capacity curve and the uncertainty of river flood routing among them the correlation of the initial water level uncertainties between reservoirs and the time space correlation of flood forecast errors between catchment intervals and time periods are taken into account the existing multivariate analysis methods mainly include multivariate normal distribution multivariate exponential distribution gumbel mixed model and gumbel logic model copula function etc the copula function has been widely studied and applied in recent years because of its flexible marginal distributions and diverse joint distribution structures which has unique advantages for establishing multivariate complex coupling relations grimaldi and serinaldi 2006 lee and salas 2011 we adopted the copula function to characterize the uncertainty correlations copula function is a multivariate probability distribution whose marginal distributions obey 0 1 uniform distribution sklar s theorem sklar 1959 shows that copula function can connect multivariate probability distributions to their one dimensional marginal distributions for any n variable x1 x2 xn the multivariate joint cumulative distribution function f x1 x2 xn can be expressed as the marginal distributions of random variables fi xi and a connection function c 1 f x 1 x 2 x n c f 1 x 1 f 2 x 2 f n x n if the joint probability density function of the multi variable is f then 2 f x 1 x 2 x n c f 1 x 1 f 2 x 2 f n x n f 1 x 1 f n x n where c f 1 x 1 f n x n c f 1 x 1 f n x n f 1 x 1 f n x n if the marginal distributions fi xi are continuous there is a unique copula function two common families of copula functions are elliptical copulas gaussian student t copula and archimedean copulas gumbel clayton frank etc the copula function expression and parameter range are shown in the appendix 2 1 1 initial water level uncertainty the method of pre release based on forecasts is to determine the excess water storage in the recession period of a flood with the water flow for utilization as the pre release flow in the forecasted no rain period pre release for water supply and the downstream safety discharge as the pre release flow in the effective lead time of the next flood pre release for flood control lu et al 2020 the equation is shown in eq 3 3 δ w 0 t d q m d t t d 1 t d t f α q s q fl t d t where w is the upper bound of the excess storage qm is the water flow for utilization td is the forecasted no rain period tf is the effective forecast lead time of flood forecast α is the discount coefficient of safety discharge qs is the safety discharge at the downstream flood control point and qfl t is the forecasted flood flow the current time is set as 0 forecast information including the no rain period in weather forecast and the flood inflow in flood forecast is required for calculating the excess storage in decision making however the deviation between forecast and actual information can cause the calculated excess storage deviating from the actual required excess storage which will result in the initial reservoir water level for the next flood being higher than the original designed flwl we denote the actual required excess storage as wa on the premise of overstoring w determined by the forecast information wa is pre released based on the actual situation then the initial water level z 0 is 4 z 0 f v x δ w δ w a where vx is the reservoir storage at the designed flwl and f is the level capacity curve it can be known from eq 4 that empirical samples of the reservoir initial water level according to the pre release based on forecasts method can be obtained from historical forecast data and measured data for a multi reservoir system consisting of m reservoirs the aggregation decomposition method zhou et al 2014 is utilized to calculate the sample values of the initial water level of each reservoir due to the high correlation of the forecast information within a basin the initial water level uncertainty of each reservoir also has a complex coupling relationship the copula function is used to establish the joint distribution function of the initial level of each reservoir z 0 1 z 0 2 z 0 m for stochastic simulation the specific steps are as follows 1 calculate the marginal distribution function values of z 0 1 z 0 2 z 0 m according to their empirical samples using the non parametric method 2 fit the parameters of each alternative copula function using the maximum likelihood estimation method 3 calculate the goodness of fit statistics aic akaike information criterion rmse the root mean square error and dmax k s test statistic zhang and singh 2006 chen et al 2017 to select the optimal copula model 4 generate m random vectors θ 1 θ 2 θ m with correlations obeying 0 1 uniform distribution according to the optimal copula model the vector length is l i e the simulation number 5 calculate the simulation values of the initial water level of each reservoir z 0 1 l z 0 2 l z 0 m l l 1 2 l through inverse calculation of the marginal distribution of each variable according to the sample values of the random vectors obtained in the previous step 2 1 2 flood forecast uncertainty due to rainfall input and hydrological model errors the flood forecast errors of a multi reservoir system are correlated to a temporal and spatial context which is shown in the error correlation between different catchment intervals and different forecast times huang et al 2018 catchment intervals include the intervals above reservoirs and above downstream flood control points define the forecast errors at time t of the i th reservoir and the j th downstream interval ei t ej t as the difference between the forecast value and the observed value shown in eq 5 5 e i t q r for i t q r obs i t e j t q l for j t q l obs j t t 1 2 t where qrfor i t qrobs i t are the forecasted and observed inflow of the i th reservoir respectively qlfor j t qlobs j t are the forecasted and observed inflow of the j th downstream interval respectively and t is the total forecast time issued by the forecast system for a multi reservoir system containing m reservoirs and n downstream flood control intervals the forecast error can be presented as the following matrix with a dimension of m n t 6 e e 1 1 e 1 2 e 1 t e 2 1 e 2 2 e 2 t e m n 1 e m n 2 e m n t the archimedean copula embraces a large number of decompositions in the application of high dimensional variables the parameter estimation is complicated and part of joint distribution information is easily lost while the elliptical copula can be structured based on the correlation coefficient matrix between variables which has certain advantages in structuring high dimensional distribution models chen et al 2016 the student t copula is applied in this study to establish the joint distribution of the spatiotemporally correlated forecast errors and stochastic simulation is carried out based on the copula model the specific steps are as follows 1 count the flood forecast errors of each catchment interval to obtain the error samples from historical forecast and measured data then establish their marginal distributions 2 estimate the parameters of the t copula function using the maximum likelihood method 3 generate m n t random vectors of error distribution function values for each catchment interval and forecast period θ 1 1 θ 1 t θ 2 1 θ 2 t θ m n 1 θ m n t following 0 1 uniform distribution the vector length is l i e the simulation number 4 obtain the simulation values of forecast error of each catchment interval and forecast period e 1 1 l e 1 t l e 2 1 l e 2 t l e m n 1 l e m n t l l 1 2 l by inverse calculation of the marginal distribution of each variable according to the sample series of distribution function values in the previous step 5 add the error series to the forecast process to obtain the reservoir inflow series and the flood control interval inflow series 7 q r i t l q r obs i t e i t l i 1 m t 1 t l 1 l 8 q l j t l q l obs j t e j t l j 1 n t 1 t l 1 l where q r i t l is the simulated inflow of the i th reservoir at time t of the l th simulation and q l j t l is the simulated inflow of the j th flood control interval at time t of the l th simulation 2 1 3 uncertainties in reservoir discharge curve reservoir capacity curve and river flood routing 1 the uncertainty in reservoir discharge curve is due to the difference between actual and design discharge capacity caused by the size of discharge facilities discharge coefficient and measurement errors to account for this uncertainty a random error factor ε 1 i is introduced for the discharge capacity so that the actual discharge capacity is expressed as 9 q max i t f zq z i t 1 ε 1 i where q max i t is the discharge capacity of the i th reservoir at time t zi t is the water level of the i th reservoir at time t and fzq is the reservoir discharge curve studies have shown that the normal distribution is the best probability distribution model for hydraulic uncertainty chu 1992 that is ε 1 i n 0 σ 1 i 2 in which σ 1 i is the standard deviation of the error distribution of reservoir i which can be determined from measured reservoir discharge data 2 the reservoir level storage uncertainty is mainly shown in the reservoir capacity curve errors caused by sediment erosion and deposition dynamic reservoir capacity and measurement errors introducing a random error factor ε 2 i for the reservoir capacity curve the actual water level capacity relationship is expressed as 10 v i t f zv z i t 1 ε 2 i where v i t is the storage capacity of reservoir i at time t and fzv is the reservoir capacity curve it is also assumed that ε 2 i obeys the normal distribution ε 2 i n 0 σ 2 i 2 in which σ 2 i is the standard deviation of the error distribution of reservoir i which can be determined from measured reservoir capacity data 3 the uncertainty in flood routing is mainly due to the discrepancy between the calculated downstream flood flow and the actual flow caused by the model error using the muskingum flood evolution model and introducing a flood propagation random error factor ε 3 i the actual downstream flow is expressed as 11 q c i t r q i t 1 ε 3 i where q c i t is the response of the outflow from reservoir i at the downstream flood control point or at the downstream reservoir at time t qi t is the outflow of reservoir i at time t and r is the muskingum model in the same way ε 3 i is set to follow the normal distribution ε 3 i n 0 σ 3 i 2 where σ 3 i is the standard deviation of the error distribution of reservoir i which can be determined from measured downstream flow data based on the above normal distributions the errors of each reservoir discharge curve reservoir capacity curve and river flood routing can be generated respectively ε 1 1 l ε 1 2 l ε 1 m l ε 2 1 l ε 2 2 l ε 2 m l ε 3 1 l ε 3 2 l ε 3 m l l 1 2 l 2 2 multi objective flood control operation model for a multi reservoir system in the flood control operation of a multi reservoir system we need to dynamically coordinate the flood control capacity of each reservoir and develop operation strategies based on real time forecast information to ensure the flood control safety of the reservoir system generally the flood control objectives include the safeties of reservoir itself and downstream of the reservoir for the reservoir safety upstream submergence and dam safety due to high water levels should be considered downstream safety is mainly about scouring resulted from excessive river flow embankment safety caused by high river levels etc the two objectives are usually in conflict with each other preference for upstream safety needs to increase discharge as much as possible to lower reservoir water level while downstream safety requires reservoir to retain as much floodwater as possible it is an important issue to be addressed to coordinate the two objectives in flood control operation of a multi reservoir system this study establishes a flood regulation model considering the two objectives and explores the trade off between the conflicting objectives and the risk variation between upstream and downstream the objective function and constraints for the l th stochastic scenario are shown below 2 2 1 objective functions the upstream flood control objective is to minimize the maximum occupation rate of flood control capacity in the flood regulation expressed as 12 min f 1 i 1 m max v i l t v x i v max i t 1 t where v i l t is the water storage of reservoir i at time t in the l th stochastic scenario vx i is the storage of reservoir i at the designed flwl and v max i is the flood control capacity of reservoir i the downstream flood control objective is to minimize the total ratio of the maximum discharge and the allowable maximum discharge of each reservoir expressed as 13 min f 2 i 1 m max q i l t q i t t 1 t where q i l t is the outflow from reservoir i at time t in the l th stochastic scenario and q i t is the maximum allowable discharge of reservoir i 2 2 2 constraints constraints include 1 water balance equation 14 v i l t 1 v i l t k ω i r q c k l t q i l t q i l t δ t where v i l t v i l t 1 are respectively the water storage of reservoir i at the beginning and end of time period t in the l th stochastic scenario ω i r represents all the upstream reservoirs that have a direct hydraulic connection to reservoir i q c k l t is the flow response of the outflow of the k th upstream reservoir at reservoir i q i l t and q i l t are respectively the inflow and outflow of reservoir i in time period t and t is the operation time interval 2 reservoir water level limits 15 z i t z i l t z i t where z i l t is the water level of reservoir i at time t in the l th stochastic scenario and z i t z i t are the lower and upper bounds of the water level of reservoir i at time t respectively 3 outflow limits 16 q i t q i l t q i t where q i t q i t are the lower and upper bounds of the outflow of reservoir i at time t respectively the lower bounds are set to satisfy the minimum ecological flow and basic water supply the upper bounds can be determined according to the downstream flood control situation 4 discharge capacity limits 17 q i l t q max i t 5 outflow variation limits 18 q i l t 1 q i l t δ q i where δ q i is the maximum allowable discharge variation of reservoir i between adjacent times 6 initial and boundary conditions 19 z i l 0 z 0 i l 20 z i l t z e i where z i l 0 is the initial regulating water level of reservoir i at the initial time t 0 in the l th stochastic scenario z 0 i l is the simulated initial water level of reservoir i in the l th stochastic scenario z i l t is the final water level of reservoir i at the end time t t of an operation period in the l th stochastic scenario and zei is the target final water level of reservoir i which is generally set as the designed flwl or the upper bound of dc flwl based on forecast information for flood resource utilization 2 2 3 solution algorithm currently the main methods for solving multi objective optimization problems are the weighted method multi objective transformed into single objective constraint method objective transformed into constraint nsga nondominated sorting genetic algorithm and other evolutionary algorithms we adopt nsga iii algorithm deb and jain 2014 jain and deb 2014 for the proposed model this algorithm is an improved multi objective optimization algorithm based on a fast nondominated sorting genetic algorithm deb et al 2002 and its effectiveness has been proved in many studies the outflow of each reservoir is taken as the decision variables the stage wise trial and error method zhong et al 2003 commonly used in reservoir flood control operation is employed for constraint handling pareto fronts corresponding to l stochastic scenarios can be then obtained respectively the algorithm flow is shown in fig 2 2 3 risk definition for multi reservoir flood control operation the uncertainty in each risk factor leads to the uncertainty in the outcome of multi reservoir flood control operation the stochastic simulation model for multi objective flood control operation of multiple reservoirs yields what is in effect a series of target sample data corresponding to the random samples of risk factors the highest reservoir level and the maximum flow at the downstream flood control point are usually used as the target variables for risk calculations influenced by uncertainties these target variables are actually random variables with certain distributions the flood control risk of a multi reservoir system includes the flood control risks of each reservoir and each downstream flood control point in the system and the risk of the entire system defined as follows 1 reservoir flood control risk 21 p ri p r o b z max i z s i c o u n t l z max i l z s i l where pri is the flood control risk of reservoir i z max i is the highest water level of reservoir i and zs i is the safe water level of reservoir i which can be set according to real time flood control requirements 2 downstream flood control risk 22 p qi p r o b q c max i q c s i c o u n t l q c max i l q c s i l where pqi is the flood control risk at the downstream of reservoir i qc max i is the maximum flow at the downstream of reservoir i and qcs i is the safety discharge at the downstream of reservoir i 3 system risk if the operation result of any element in the reservoir system exceeds the given safety threshold the system is considered to be at risk therefore we define the system risk p s as the probability that the highest water level of any reservoir or the maximum flow at any downstream flood control point exceeds its safety threshold expressed as 23 p s c o u n t l z max i l z s i o r q c max i l q c s i l i 1 2 m 3 case study 3 1 study area a mixed reservoir system on the pi river in the huai river basin is selected as the case study the reservoirs in the pi river basin are located in the upper reaches of the huai river basin on a tributary the east pi river there are foziling fzl mozitan mzt and bailianya bly reservoirs with a catchment area of 1840 km2 one reservoir called xianghongdian xhd is on the west pi river incorporating a catchment area of 1400 km2 the reservoir system contains two individual flood control points and one common flood control point which are huoshan hs at the downstream of bmf reservoirs bly mzt and fzl reservoirs dushan ds at the downstream of xhd reservoir and hengpaitou hpt at the downstream of the entire system respectively the schematic of the flood control system is shown in fig 3 the forecast time of the system forecast model is 72 h with a time interval of 3 h some characteristics and parameters of the reservoirs are presented in table 1 3 2 stochastic simulation of risk sources we carried out stochastic simulations for errors of initial water levels flood forecasts discharge capacity water level storage capacity and river flood routing to analyze the flood control risks of the reservoir system the simulation number l 100 3 2 1 initial water level uncertainty on the premise that there is no rain in the meteorological forecast with a 24 hour rolling forecast the forecasted no rain days are used as the no rain period in excess storage calculation by the pre release based on forecasts method when there is rainfall in the weather forecast no rain day is 0 the reservoirs do not store excess water the actual required excess storage wa based on measured data and the theoretical excess storage w based on forecast information are calculated using the measured and forecast information of the flood seasons june to september of 2007 2015 the empirical samples of the initial water level of each reservoir are then derived based on eq 4 and the sample size is 909 after removing the cases with forecasted rainfall the correlation coefficients of the empirical samples of the four reservoirs are shown in eq 24 it can be seen that the initial water levels of the four reservoirs have a strong correlation due to the high correlation of forecast errors within the basin especially the three reservoirs of bmf between which the correlation coefficients are higher than 0 9 located on the west pi river xhd reservoir is relatively independent of bmf reservoirs on the east pi river therefore the correlation coefficients between xhd and bmf reservoirs are lower 24 cor 1 0 93 0 90 0 43 0 93 1 0 90 0 42 0 90 0 90 1 0 42 0 43 0 42 0 42 1 five common copula functions gaussian t gumbel clayton and frank were used to fit the joint distribution of the empirical samples of the four reservoirs and the goodness of fit was tested the goodness of fit statistics of each copula model are listed in table 2 the smaller aic rmse and dmax values the better the fitting effect from table 2 we can see that the t copula has the best goodness of fit for the initial water levels of the four reservoirs thus t copula is selected as the optimal copula model to describe the correlation between the reservoir initial water levels and the fitting parameters are obtained through the maximum likelihood method as shown in table 3 the comparison of the empirical copula values and the theoretical values of the fitted t copula is shown in fig 4 from which it can be seen that the empirical values are consistent with the fitted values with the scatter points evenly distributing around the 45 straight line indicating that the t copula function has a good fitting effect for the sample data based on the fitted t copula and inverse calculation of marginal distribution 100 simulation initial water level values of the four reservoirs are obtained their frequency distributions are shown in fig 5 the random initial water levels of each reservoir are densest at the original designed flwls and gradually decrease to both sides which is consistent with the distribution regularity of forecast errors lu et al 2020b 3 2 2 flood forecast uncertainty this flood control system includes forecasts of five catchment intervals namely the catchment intervals of bly mzt fzl and xhd reservoirs and the interval between reservoirs and hpt flood control point the forecast lead time is 72 h and the time step is 3 h based on historical forecast and observed flood series the forecast error samples of each catchment interval and each forecast period are obtained the marginal distribution is established by the normal distribution and the joint distribution is fitted by t copula function with a variable dimension of 5 24 the correlation coefficient matrices of the observed forecast error series and the 100 spatiotemporally correlated random forecast error samples generated with the t copula function are shown in fig 6 this figure demonstrates that the flood forecasts of the reservoir system have a clear spatial and temporal correlation character the forecast errors of each catchment interval are strongly correlated in time i e between different forecast periods diagonal squares the forecasts of the three reservoirs of bmf located on the east pi river have a high spatial correlation while their spatial correlation with that of xhd reservoir on the west pi river is weaker moreover the flood forecast of the hpt flood control interval is also spatially high correlated with that of bmf reservoirs and weakly correlated with that of xhd reservoir a comparison of fig 6 a and b shows that the random error samples generated by t copula have a good simulation effect and have a high correlation match with the measured sample series a forecast flood in july 2016 was taken as the experimental flood sequence and the corresponding 100 stochastic flood processes were obtained by adding the simulated random forecast errors on it as shown in fig 7 the random distribution of inflow in each period is shown in the figure the stochastic flows are symmetrically distributed on both sides of the forecast flow and become more widely distributed as the magnitude of the forecast flow increases to examine the preservation of marginal distribution characteristics of the simulation results srinivas and srinivasan 2001 statistical attributes mean value and standard deviation of the simulated and historical samples are presented in table 4 taking peak flow in each catchment interval as an example it can be seen that the statistical attributes of forecast uncertainties are well preserved by the generated samples 3 2 3 other uncertainties the errors in discharge capacity level capacity and flood routing are all set to a normal distribution denoted as ε 1 i n 0 0 052 ε 2 i n 0 0 052 and ε 3 i n 0 0 052 i 1 4 then 100 random numbers that obey the above distributions are generated as the random error samples of the three uncertainties 3 3 experiment settings for multi objective risk analysis the nsga iii algorithm was run with parameters set as follows population size n 50 number of iterations maxgen 5000 parameters of each reservoir in the model are listed in table 5 in order to compare the impact of the initial water level uncertainty and the flood forecast uncertainty on the flood control risk of the reservoir system and to analyze the impact of the dependences in the two uncertainties four numerical experiments are designed and applied to the model denoted as case 1 case 2 case 3 and case 4 respectively case 1 stochastic simulation taking into account the flood forecast uncertainty and discharge capacity level capacity and flood routing uncertainties the model input is the simulation samples of the flood forecast stochastic scenarios considering the time space correlations and the errors of discharge capacity etc and the initial regulating level of each reservoir is set as the designed flwl case 2 stochastic simulation taking into account the initial water level uncertainty and discharge capacity level capacity and flood routing uncertainties the model input is the simulation samples of the initial regulating water levels considering the spatial correlations and the errors of discharge capacity etc and the flood process uses the deterministic forecast flood process case 3 stochastic simulation taking into account all the uncertainties including the five uncertainties of initial water level flood forecast discharge capacity level capacity and flood routing the model input is the simulation samples of the initial regulating water levels considering the spatial correlations the flood forecast stochastic scenarios considering the spatiotemporal correlations and the errors of discharge capacity etc case 4 stochastic simulation taking into account all the uncertainties but ignoring the correlations in the uncertainties the model input is the randomly generated reservoir initial water levels flood forecast errors without considering correlations and the errors of reservoir discharge curve reservoir capacity curve and river flood routing 3 4 results of the flood control risks to verify the multi objective flood control operation model and conduct risk calculation and analysis the deterministic multi objective operation results without considering errors are presented first see section 3 4 1 where each reservoir is operated from the designed flwl with the forecasted flood the original discharge curve capacity curve and the deterministic flood routing parameters based on the deterministic operation results and the stochastic simulation results of the above four cases the calculation and analysis of reservoir downstream and system risks are then shown in section 3 4 2 3 4 1 deterministic multi objective operation the pareto non inferior solution front of the multi objective operation model is shown in fig 8 a and the curve of hypervolume index hv with the number of evolution generations is shown in fig 8 b as can be seen from fig 8 a there is an obvious competition between objectives f 1 and f 2 i e the highest water level and the maximum outflow of each reservoir are oppositely transformed with a decrease in the highest water level accompanied by an increase in the maximum outflow fig 8 b shows that hv remains stable when the iteration number reaches 2000 and the algorithm tends to converge the 50 non inferior operation schemes are shown in figs 9 and 10 fig 9 presents 50 water level processes for each reservoir with each starting at the designed flwl and reaching the target water level at the end time there are different processes in between representing the operation schemes corresponding to different non inferior solutions among them the difference in water level processes of bly reservoir in bmf subsystem is the largest it is due to the maximum flood control capacity of bly reservoir has an advantage in optimizing the first objective by the algorithm fig 10 a d shows 50 non inferior outflow processes of each reservoir and fig 10 e illustrates 50 non inferior flow processes at hpt flood control point downstream of the entire system which is the sum of outflow processes from fzl xhd via river routing and lateral inflow processes above hpt the river flood routing is calculated by the muskingum method with parameters c0 0 25 c1 0 57 c2 0 18 3 4 2 flood control risk evaluation based on the non inferior solutions obtained from stochastic simulation the flood control risks of four reservoirs three flood control points and the whole system are calculated respectively the sequence numbers of the non inferior solutions of the multi objective operation are 1 2 50 in order from smallest to largest of objective f 1 f 2 from largest to smallest as shown in fig 8 a the maximum water levels of bly mzt fzl and xhd reservoirs in non inferior solution 50 in the deterministic multi objective operation results are 209 7 189 5 125 129 m respectively set as the safe water levels of the four reservoirs the safety discharge at hs ds and hpt flood control points are set to 3000 1500 and 8400 m3 s respectively according to the current flood control situation the risk results of the four cases obtained based on the risk calculation equations in section 2 3 are shown in tables 6 9 due to limited space the tables only present the results of 11 solutions of 1 5 10 50 from the tables it can be seen that the risk values of the four reservoirs basically show a trend of gradually increasing as the objective value of the highest reservoir level increases among which the risk value of bly reservoir varies the most this is related to the more discrete non inferior water level processes of bly caused by the predominance of the flood control capacity of bly in bmf subsystem as explained in section 3 4 1 meanwhile the risks of downstream flood control points are decreased with the solution number the risk of ds flood control point at the downstream of xhd reservoir is 0 the reason is that the outflow of xhd reservoir is set below the safety flow of 1500 m3 s at ds in the model a comparison of the system risk rates of different non inferior solutions for the four cases is shown in fig 11 from this figure and the calculated risk results it can be learned that 1 from the performance of multi objective non inferior solutions the system risks all show a trend of first decreasing and then increasing as the objective value of f 1 goes from the lowest to the highest this indicates that in the non inferior solution front the marginal benefit of risk is relatively low for the extreme objective values a compromise solution in the middle part should be selected to balance the risk 2 from the impact of risk sources combination in general the relationship between the risk magnitude is case 1 case 3 case 2 that is the risk of considering only flood forecast and other uncertainties case 1 is greater than that of considering flood forecast initial water level and other uncertainties case 3 and the risks of these two are much greater than that of considering only initial water level and other uncertainties case 2 it illustrates that coupling the initial water level uncertainty will reduce the flood control risk caused by flood forecast errors to a certain extent this is because the traditional flood risk analysis considering flood forecast uncertainty sets the reservoir initial water level at the designed flwl in fact there is a large probability that the initial water level is lower than the designed flwl 3 from the impact of the correlations in risk sources comparing the risk results of considering the uncertainties with spatiotemporal correlations case 3 and without correlations case 4 it is found that the risk of case 4 is less than that of case 3 indicating that ignoring the mixed dependences in risk sources will lead to an underestimate of the system flood control risk 4 discussions the model results are further discussed and analyzed based on the stochastic simulation results of operation processes from the 50 non inferior solutions three representative solutions solution i which is fully biased towards the upstream object f 1 solution ii which is a compromise between the upstream and downstream solution iii which is fully biased towards the downstream object f 2 shown in fig 8 a are selected based on topsis zhu et al 2017 for the analysis of the stochastic simulation results firstly the compromise solution solution ii is used to demonstrate the stochastic operation processes and then the three non inferior solutions solution i ii and iii are compared and analyzed in terms of their statistical extreme values 1 stochastic operation processes of solution ii fig 12 presents the stochastic water level processes of each reservoir for the four cases of the trade off solution ii with the safe level of each reservoir identified by a horizontal line from fig 12 we can know that for case 1 3 ① when the effect of initial water level is not taken into account the water level dispersion caused by the flood forecast uncertainty shows a trend of increasing then decreasing case 1 on the one hand the distribution range of flood forecast error gradually increases with the rise of the flood fig 7 and on the other hand it is due to the constraint of the reservoir target final water level in the model ② the initial water level uncertainty has the strongest water level dispersion at the initial time t 1 but gradually decreases as the process develops case 2 indicating that the initial water level has some influence on subsequent flood regulation but the influence decreases with time the longer the flood regulation time the smaller the impact for a short duration flood regulation process this impact is nonnegligible ③ the stochastic water level processes considering all uncertainty risk sources case 3 couples the effects of the first two cases with the distribution similar to that of case 1 in the early flood regulation period and the distribution of the range above the median similar to that of case 2 in the late period comparing the effects of considering correlations or not cases 3 4 reveals that ignoring correlations in risk sources significantly reduces the dispersion ranges of reservoir levels in the late flood regulation period especially the ranges above the median values the stochastic outflow processes of each reservoir and flow processes at hpt for the four cases are shown in fig 13 with the safety flow of each point identified by a horizontal line it can be seen that the outflow from each reservoir is distributed between the given maximum and minimum values we can know from fig 13 e that in terms of the distribution of the maximum flow discharge comparing case 1 3 case 2 has the narrowest dispersion range case 3 the largest and case 1 lies between them it suggests that the initial water level has the least influence compared with only considering flood forecast error and other errors of discharge capacity and so on coupling the initial water level uncertainty will somewhat reduce the discharge distribution range 2 comparative analysis of solution i ii and iii the stochastic simulation results of the maximum water levels of the four reservoirs for solution i ii and iii are shown in fig 14 and the stochastic simulations of the maximum downstream flows represented by the flood control point at the downstream of the entire system hpt are shown in fig 15 as can be seen from fig 14 the distributions of the highest water levels of bly and mzt reservoirs tend to move upward with solution i iii and the upward trend of bly is more significant the distributions of different solutions of fzl reservoir is concentrated because the highest water level appears close to the end of the operation period fig 12 c therefore except for some outliers caused by extreme flood processes with large errors most simulation results converge to 125 m the highest water level distribution of xhd reservoir moves up slightly with solution i iii but the difference is small the reason is that xhd has very large storage capacity even widely varying discharge schemes within the upper and lower outflow limits will only result in a gentle change in maximum water level contrary to the changing trend of the reservoir results the distributions of the maximum downstream flows in fig 15 show a downward trend with the three solutions indicating the competitive relationship between the upstream and downstream objectives the highest water level distributions of the four cases in fig 14 corresponds to the flood control risk rates of each reservoir in tables 6 9 that is under the influence of different combinations of risk sources the risk magnitude is case 1 case 3 case 2 and under the influence of spatiotemporal correlations the risk magnitude is case 3 case 4 however the risk rate only represents the probability of exceeding the safety threshold which is a concept of frequency and cannot fully represent the severity of the risk event for example in fig 14 a the risk rate of bly reservoir in case 1 is greater than that in case 3 but there exist some extreme values in case 3 greater than those in case 1 indicating that extreme risk events are more likely to occur in case 3 we introduce the conditional loss at risk also known as conditional value at risk cvar to characterize extreme risk events and measure the severity of risk events cvar refers to the mean value of losses in the tail exceeding a threshold at a given confidence level rockafellar and uryasev 2002 expressed as 25a cva r α l e l l v a r α l 1 α var α l l pdf l dl 26a va r α l min cdf l α where l is the loss function to display the risk indicator results directly we use the highest reservoir level and maximum flow as loss function for upstream and downstream α is the confidence level α 0 1 varα l denotes the minimum risk loss at the confidence level α pdf is the probability density function and cdf is the cumulative probability function table 10 displays the cvar values with the confidence level α 90 for the highest water level of each reservoir and the maximum flow at each flood control point it can be seen that ① the cvar of the reservoir highest water level increases with the increase of the objective value f 1 solution i iii while that of the maximum downstream flow decreases gradually the cvar of ds is always 1500 m3 s this is because the outflow of xhd is restricted to 1500 m3 s below which is distributed on the tail beyond the 90 confidence level ② on the whole the relationship between the magnitude of cvar of each reservoir is case 3 case 1 case 2 case 3 case 4 by comparing the relationship between the magnitude of the risk rates it can be seen that although the risk rate considering all uncertainties case 3 is less than that considering only flood forecast and other uncertainties case 1 the cvar is higher this means that while coupling initial water level uncertainty will reduce the risk rate due to the offsetting effect of errors it increases the cvar value this is the extreme risk event caused by the combined effect of the initial water level extremes and the flood forecast error extremes and is more severe than the case where only the flood forecast uncertainty is considered ③ the cvar values without considering the correlations in risk sources case 4 are much smaller than those considering the correlations case 3 indicating that under the influence of the correlations the reservoir system may have high initial regulating water levels and high flood inflows at the same time ignoring the correlations will underestimate the occurrence probability of system mass risk events 5 conclusions the traditional reservoir flood control risk analysis lacks full consideration of the risk source of dc flwl the dependences in risk sources and multiple objectives in flood control operation this study establishes a multi objective risk analysis model for a multi reservoir system under multi dimensional uncertainties coupling the initial water level uncertainty flood forecast errors reservoir capacity curve errors reservoir discharge curve errors and river flood routing errors the application results of a four reservoir system in the pi river basin show that 1 the initial regulating water level of each reservoir derived through the pre release based on forecasts method has a strong spatial correlation among the commonly used copula models t copula has the best fitting effect for it 2 there is a high correlation between flood forecast errors in different catchments and different forecast periods and t copula function can be used to accurately quantify the multi order spatiotemporal correlations of errors 3 ignoring the spatiotemporal correlations in risk sources will lead to an underestimate of flood control risk in a multi reservoir system especially the joint extreme risk events of the system 4 in multi reservoir flood control operation there is an obvious competition between reservoir and downstream objectives that is the reservoir highest water level and maximum outflow are in an opposing relationship 5 in the multi objective risk analysis for a reservoir system the system risk first decreases and then increases with the change of the objective value which indicates that in the non inferior solution front of multi objective operation the marginal benefit of risk is low for the extreme objective values a compromise solution in the middle part should be selected to balance the risk 6 the flood control risk caused by the initial water level uncertainty cannot be neglected coupling the initial water level uncertainty will reduce the flood control risk rate resulted from flood forecast errors to a certain extent but will increase the conditional loss at risk that is it may encounter more severe risk event than the case considering only the flood forecast uncertainty declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national key r d program of china grant no 2017yfc0405606 the national natural science foundation of china grant no 52079037 and 52009029 the fundamental research funds for the central universities grant no b200202032 the china postdoctoral science foundation grant nos 2020t130169 and 2019m661715 appendix a gaussian copula 25b c u 1 u 2 u n ρ φ 1 u 1 φ 1 u n 1 2 π n 2 ρ 1 2 exp 1 2 w t ρ 1 w d w where φ is the standard normal distribution function ρ is an n order symmetric positive definite matrix and w w 1 w 2 wn is the vector of integral variables t copula 26b c u 1 u 2 u n ρ υ t υ 1 u 1 t υ 1 u n γ υ n 2 γ υ 2 π υ n 2 ρ 1 2 1 w t ρ 1 w υ υ n 2 d w where t υ is the standard t distribution function with degree of freedom υ ρ is an n order symmetric positive definite matrix and w w 1 w 2 wn is the vector of integral variables gumbel copula 27 c u 1 u 2 u n exp ln u 1 θ ln u 2 θ ln u n θ 1 θ θ 1 clayton copula 28 c u 1 u 2 u n u 1 θ u 2 θ u n θ n 1 1 θ θ 0 frank copula 29 c u 1 u 2 u n 1 θ ln 1 exp θ u 1 1 exp θ u 2 1 exp θ u n 1 exp θ 1 2 θ 0 
