index,text
20795,in multi body offshore systems a telescopic gangway is often adopted for personnel transfer the feasibility and safety of which are crucial the coupled dynamics and gangway responses of a turret moored floating production storage and offloading fpso unit and a semi submersible accommodation platform ap were investigated numerically in this study both side by side arrangement and the configuration that ap is tandem at the stern of fpso were considered the hydrodynamics considering multi body wave interaction were calculated in frequency domain based on potential theory the non linearity of second order wave drifts moorings and turret was fulfilled in time domain we focused mainly on the effects of multi body interactions on hydrodynamics and gangway responses the hydrodynamic interactions have a negligible effect on the global motions of fpso whereas it more strongly affects ap the interference is more intense in side by side scenario than in tandem configuration the gangway responses are governed by relative translational motions between two vessels and are also related to its initial arrangement since weathervaning of fpso can cause a large yaw offset non collinear sea states are considered in addition to cases with different significant wave heights extreme gangway responses are predicted according to weibull distribution by which the environment criteria are determined keywords fpso semi submersible side by side tandem gangway responses extreme values nomenclature δ l gangway extension η angle between gangway and vertical plane φ angle between gangway and horizontal plane θ h angle between gangway and global x axis θ z vertical angle between gangway and gangway tower l gangway length l 0 initial gangway length q exceedance probability ap accommodation platform dof degree of freedom dp dynamic positioning fpso floating production storage and offloading psd power spectral density rao response amplitude operator sbs side by side tdm tandem 1 introduction since the mid 1980s the offshore oil and gas industry has grown rapidly owing to industrial development and increasing demand for resources the floating production storage and offloading fpso unit is an innovative floating vessel designed for the processing and storage of crude oil before tanker transportation in china a total of 13 fpsos were in service as of july 2019 offshore magazine 2019 fpso has a large storage capacity and ample deck space providing better layout flexibility tahar and kim 2003 it is equipped with a single point mooring system which means that the vessel is free to rotate around the mooring system this behaviour is known as weathervaning sanchez mondragon et al 2017 and it allows the vessel to change its orientation with respect to the prevailing environmental direction to reduce the relative vessel environment angle and the resulting load on moorings howell et al 2006 in practical operation a fpso is usually connected to a massive permanent riser system and moorings thus it is costly to return the vessel to a shipyard for maintenance cong et al 2018 the personnel working on board need to be accommodated offshore kunkyebe and georgiev 2015 the accommodation platform ap is designed to provide better living conditions for crews working on the production vessel to meet class regulations it can also provide additional space for crane facilities power sources and storage for operating materials and equipment as well as reducing the space requirements and operating weight of the production vessel ramirez and fernandes 2017 the two vessels are generally arranged in a side by side sbs or tandem tdm configuration a telescopic gangway is mounted on the ap for personnel transfer its dynamic responses are crucial to the reliability up time and economic benefits of berthing a clear understanding of the coupled hydrodynamics and characteristics of gangway motions is essential the dynamic interactions for two floating bodies in waves are complex on the one hand the environmental loads including waves wind and current are different from the corresponding single body results there are complicated multi hull and wave interactions which cause diffraction and radiation waves between underwater structures the vessel motions can be amplified by superimposed waves at some wave frequencies pessoa et al 2015 and water resonance has been observed in the narrow gap between floating bodies zhao et al 2018 liu and falzarano 2019 nearby structures also have shielding effects on the wind and current loads on the other hand nonlinear mechanical connections such as moorings fenders and hawsers are usually adopted to limit the global motions feng and bai 2017 in contrast to vessels with a spread mooring system the turret moored fpso may change its heading angle appreciably within short periods ma et al 2013 this unique characteristic poses a potential risk to operational safety because a nearby service vessel cannot follow the fpso as it swings a collision may occur in addition the loads on moorings are increased causing excessive wear and damage to the mooring chains this study considers mainly two aspects according to the above hydrodynamic problems the two body hydrodynamics especially for the case of a turret moored fpso and the calculation and assessment of gangway responses which are quite related to global relative motions potential theory is a popular approach to solve the multi body hydrodynamics it has been applied to many practical projects such as floatover installation xu et al 2016 tension leg platform tlp and tender assisted drilling vessel tad coupled systems ramirez and fernandes 2017 li et al 2018 and fpso flotel systems kunkyebe and georgiev 2015 oil and gas offloading using an fpso or a floating liquefied natural gas vessel floating alongside a shuttle tanker has also attracted considerable attention the hydrodynamics including the vessel motions koo and kim 2005 second order wave loads line tensions zhao et al 2014 and collision risk gao et al 2014 have been solved for both the sbs and tdm configurations two body interference has been observed especially in the sbs configuration for overestimated water surface motions in narrow gaps the damping lid method fournier et al 2006 watai et al 2015 is an effective tool to suppress unrealistic water resonance the viscous fluid method feng et al 2017 has also been adopted to obtain relatively accurate predictions previous studies have focused mainly on the two body coupled hydrodynamics of fpso tanker systems few researches is about the application of a semi submersible ap alongside an fpso or the characteristics of gangway responses morandini and l hostis 2005 calculated some basic gangway motions for an fpso flotel system in a tdm configuration dong et al 2019 performed a detailed numerical and experimental study of the gangway responses in a coupled tlp tad system and predicted the extreme values as for the case of fpso li et al 2015 and huang et al 2018 analyzed parallel and non parallel configurations of an fpso with a service vessel respectively their simulations were performed in the frequency domain assuming a linear system cong et al 2018 investigated the wave current interaction and a dynamic positioning dp control scheme for a semi flotel connected to an fpso however this study focussed on the environmental sheltering and global vessel motions not the gangway responses this study investigates the coupled dynamics of an fpso and a semi submersible ap and motions of the gangway between them two configurations are considered the sbs and tdm at the stern of fpso one important concern is the hydrodynamic problem resulting from environmental sheltering the wave interaction is solved using two body wave diffraction and radiation theory note that aps are typically equipped with a dp system to maintain the relative positions which can balance the time independent wind and current loads and mean wave drift forces as well as second order wave slow drift excitations li et al 2015 in addition the interference on fpso s wind and current forces is negligible because of the size difference between the two bodies dong et al 2020 therefore the wind and current drag effects are considered only for the fpso using the single body results the passive motion compensated gangway can adjust its length and rotation according to the vessels relative positions it does not affect the rigidity of the coupled system or restrict the platform motions hence the gangway attachment points can be regarded as ideal joints huang et al 2018 this paper is organised as follows the theoretical background is briefly introduced in section 2 section 3 describes the coupled fpso ap system including the berthing configurations the main parameters of the two vessels and the sea conditions used in the numerical simulations the numerical results for the coupled system are discussed in section 4 including the single body results validated by experimental values the two body hydrodynamics the dynamic gangway responses and the prediction of the limiting sea states the main conclusions are summarised in section 5 2 methodology 2 1 dynamics of a two body system in waves the hydrodynamics of a multi body coupled system are directly related to the environmental loads which consist of the wave wind and current loads and corresponding shielding effects the wave interaction can be solved by two body wave diffraction and radiation theory there does exist twin body interference on wind and current loads especially for aps with small dimensions near an fpso with a large displacement as mentioned above aps are typically equipped with a dp system to maintain the relative positions which can balance the drift effects caused by the wind current and second order wave loads thus it is reasonable to exclude these drift forces on the ap during berthing analysis as an approximation wu 2014 because the interference on the environmental loads on the fpso is negligible owing to the size difference between the two bodies li et al 2015 and the fpso is often located upstream the single body wind and current drag effects are considered for the fpso briefly the following environmental excitations are considered in this study ap only the first order wave frequency excitation fpso the wind and current loads measured from single body wind tunnel tests and the first and second order wave drift loads the nonlinear motion equation for the fpso ap coupled system in time domain can be written as 1 m 11 a 11 a 12 a 21 m 22 a 22 x 1 t x 2 t 0 d τ r 11 τ r 12 τ r 21 τ r 22 τ x 1 t τ x 2 t τ c 11 c 22 x 1 t x 2 t f 1 f 2 1 st f 1 0 2 nd f 1 f 2 m f 1 0 w f 1 0 c where m and c are the inertia and hydrostatic restoring force matrices respectively a is the added mass at infinite frequency r τ is the retardation function matrix the right side of the equation represents the following external forces the first and second order wave drift forces f 1 st and f 2 nd mooring tension f m wind load f w and current load f c the superscript in parentheses denotes the body number assuming inviscid and irrotational flow the wave interaction problem can be solved by multi body wave diffraction and radiation theory lee 1995 the boundary value problems bvps of the velocity potentials are similar to those for the single body case except for the body surface conditions 2 φ j 1 n n j 1 on body 1 φ j 1 n 0 on body 2 φ j 2 n 0 on body 1 φ j 2 n n j 2 on body 2 where φ j is the unit radiation potential caused by the j th mode motion of the floating body and n is the unit normal vector pointing toward the fluid although the bvps are those of a system with zero speed and no current they are still applicable under a low speed current zhao et al 2014 yue et al 2020 which is 0 69 m s in this study it should be noted that the additional hydrodynamic damping induced by current thus is not included the above equations are solved by the green function method newman 1985 the total unsteady velocity potential can then be determined by linear superposition the hydrodynamic pressure p on the mean wet surfaces s b is obtained using the linear bernoulli equation gonzález et al 2015 and the first order wave loads are derived by integrating p over s b the second order wave drifts are crucial because they can cause large slow yaw rotation of a single point moored fpso this can make it difficult for the ap to follow the fpso and increase the environmental loads on the hull risers and moorings sanchez mondragon et al 2018 in this study the near field solution mciver 1986 is adopted to calculate the mean wave forces accordingly the difference frequency wave drift loads are approximated by newman s method newman 1974 the retardation function is calculated by fourier integration of the frequency dependent damping matrix b f at frequency f i e r τ c τ 0 4 b f cos 2 π f t d f where c τ exp 3 τ t c 2 is a cutoff scaling function t c is the cutoff time after which the retardation function is truncated and assumed to be zero because it decays to zero as τ goes to orcina 2015 f w and f c are applied by specified constant forces thus wind gusts and additional current damping are not included the lumped mass method niedzwecki and thampi 1991 is used to simulate the dynamics of the mooring lines which are discretized as a series of lumps of mass joined by massless springs clearly the numerical process mainly consists of two parts firstly the hydrodynamic parameters are solved in frequency domain to suppress the exaggerated calculated roll motion additional roll damping in a percentage of critical damping b c r i t is applied according to the decay test results for a single vessel then the nonlinear coupled analysis is conducted in time domain since the calculated hydrodynamics added mass potential damping and wave force transfer functions except for motion responses are used as inputs for equation 1 additional linear and quadratic damping are also added to well reproduce the real world results equation 1 is solved by an implicit integration scheme with the generalised α method chung and hulbert 1993 this method can effectively remove the nonphysical high frequency responses of the system and provide much more stable convergence using a controllable damping parameter the time step is 0 1 s with two simulation stages the first stage is 150 s long during this period the environmental conditions are ramped up slowly from zero to the specified values the second stage has a duration of 3 h and the results discussed below are obtained in this stage 2 2 dynamic gangway responses the passive motion compensated gangway can adjust its stroke azimuth and attitude angles according to the relative positions of the vessels it cannot bear any axial load hence the connection between the gangway and vessel can be simplified as an ideal joint the gangway responses can then be derived from the global motions of the two vessels we assume that the gangway connects the fpso and ap at points 1 p1 and 2 p2 with initial positions x 1 y 1 z 1 and x 2 y 2 z 2 respectively in each local coordinate system p2 is at the top of gangway tower and p3 is at the bottom with an initial position x 3 y 3 z 3 the positions of these three points are listed in table 1 according to the research from dong et al 2019 the dynamic gangway motion responses including the instantaneous gangway length l t extension δ l t luffing angle θ z the vertical angle between the gangway and the top plate of gangway tower and rotation angle θ h can be calculated as follows 3 l t δ x 2 δ y 2 δ z 2 x 1 x 2 2 y 1 y 2 2 z 1 z 2 2 4 δ l t l t l 0 5 θ z η φ 6 φ arctan z 2 z 1 x 1 x 2 2 y 1 y 2 2 7 η arctan x 2 x 3 2 y 2 y 3 2 z 2 z 3 8 θ h arctan x 1 x 2 y 1 y 2 for sbs arctan y 1 y 2 x 1 x 2 for tdm where x i y i z i is the translational motion of p i relative to the global coordinate o x y z including the contribution from the structure rotation l 0 is the initial gangway length φ is the angle between the gangway and the horizontal plane and η is the angle between the gangway tower and the vertical plane fig 1 shows the definitions of the gangway attitude angles for the sbs configuration as an example 2 3 extreme value statistics it is usually assumed that the sea states are stationary ergodic processes subsequently the vessel responses satisfy the gaussian distribution for a linear system if the stochastic process is narrow banded the peak response values will follow a rayleigh distribution longuet higgins 1952 since the second order low frequency drift of the fpso is also considered in this study the rayleigh distribution is no longer suitable thus the two parameter weibull distribution is adopted for extreme value prediction this probabilistic model can capture the nonlinearity of the data via appropriate parameters moan et al 2005 xiao et al 2015 fig 2 shows an example of the peak values of gangway extension fitted by rayleigh and weibull distributions for the sbs arrangement under ec1 refer to table 4 the cumulative distribution function f w x of the weibull model is 9 f w x 1 exp x λ k where λ is the scale parameter and k is the shape parameter the following logarithmic expression is more frequently used 10 log log 1 f w x m n log x the unknown parameters m and n can be obtained by fitting the calculated peak values from short term sea conditions the response extrema corresponding to a given exceedance probability q can be derived as 11 1 f w x q 3 fpso ap coupled system 3 1 coordinate systems three coordinate systems are introduced to describe the motions of a two body floating system in waves global coordinate system o x y z the origin is at the mean surface level local coordinate systems o f x f y f z f and o a x a y a z a these systems are fixed at the centre of gravity cog of each floating body relative to its mean position the positive x f x a y f y a and z f z a axes point toward the bow toward port and upward respectively two coupling arrangements are considered the two vessels are arranged sbs and the ap is tdm at the stern of the fpso see fig 3 the positions of the two local coordinates in o x y z are listed in table 2 for d 37 4 m which is the minimum distance between the underwater structures of the fpso and ap note that d depends on the relative positions of p1 and p2 resulting an initial gangway length of 38 m the incident angles 0 and 90 are along the x and y axes respectively 3 2 hull models and mooring lines the 120 000 dwt fpso operates at a water depth of 420 m it is moored through an internal turret which allows the vessel to freely rotate in response to the sea state the turret is maintained at its position by nine identical catenary mooring lines in a 3 3 pattern as shown in fig 4 a the three line bundles are evenly spread and the angle between the lines in each bundle is 5 thus there is a 110 opening between the line groups each line consists of three segments as chain wire rope and chain the semi submersible ap features two pontoons four columns and four bracings during the numerical simulations four horizontal soft springs with an axial stiffness of 4100 kn are utilized to stop the ap from drifting away see fig 4 b these springs are soft enough that they will not limit the wave frequency motion responses of ap the main parameters of the two vessels are listed in table 3 3 3 environmental conditions both collinear and non collinear sea conditions are considered based on the south china sea states with 1 year return period as listed in table 4 the irregular waves are described by the jonswap spectrum using a significant wave height h s peak wave period t p and spectral peakedness parameter γ the wind and current drag effects on the fpso are applied according to the ocimf method oil companies international marine forum 1994 by multiplying the measured force coefficients from wind tunnel tests by the square of a specified flow velocity the equivalent drag forces are summarised in table 5 only the static wind effect is included and there is no hydrodynamic damping due to the current 4 results and discussion 4 1 single body results before the two body coupled simulations the single body results including the model of vessel geometry mass distribution and mooring stiffness were validated single body tests of the fpso and ap with a scale ratio of 1 60 were performed separately in the deep water offshore basin at shanghai jiao tong university china the experiments included static offset and decay tests in calm water as well as white noise wave tests to obtain the motion response amplitude operators raos fig 5 shows the restoring force versus the offset of fpso in the surge direction the vessel was pulled along both the 0 and 180 directions the results indicate that the fpso moorings are modelled appropriately the natural periods of fpso and ap are listed in table 6 the differences between the measured and calculated values are less than 3 fig 6 shows the global motion responses of the fpso obtained from white noise wave tests the corresponding numerical results are shown for comparison only the degrees of freedom dofs with a large response amplitude under each wave incident angle are presented which can reach 0 5 m m or m except for yaw for most dofs the potential damping derived from the diffraction radiation theory is often adequate to describe the motions of offshore structures this is not particularly true for the roll motion of a long floating structure because the roll damping is highly nonlinear due to viscous effects and the potential damping is in a small percentage of the total damping pessoa et al 2015 moreover the amplification in roll may be large since the roll natural period usually falls in the wave frequency range chakrabarti 2001 to suppress the exaggerated roll motions resulting from the inviscid potential theory additional roll damping was added in frequency domain calculations using the approach of faltinsen 1990 the two results agree well with each other in most cases especially for sway heave roll and yaw discrepancies are observed in surge and pitch in the range of 12 19 s to ensure a reliable numerical model power spectral density psd curves of fpso motions derived from a time domain simulation are also compared in fig 7 the simulating conditions are only an irregular wave described by the jonswap spectrum is acting on the fpso hull h s 13 6 m t p 16 3 s γ 2 4 and wave direction is 180 as clarified before additional linear and quadratic damping terms are applied to heave roll and pitch modes during time domain simulations with specific values listed in table 7 the surge response has distinct low frequency characteristics there is only one large peak at 0 04 rad s about the surge natural period of 154 7 s and almost no response energy within the wave frequency range the numerical results coincide with test values especially in low frequency range for the pitch motion the measured values are slightly smaller than calculated rao results due to the neglect of water viscosity additional damping added to pitch mode in the time domain calculation makes the simulated results match well with measurements fig 7 c the calculated motion raos of ap for the single body case in fig 8 are in much better agreement with the test results than those of the fpso the differences in yaw are caused by the small response amplitude which is less than 0 1 m it is difficult for the optical motion acquisition system to capture such a small response accurately all of the above results indicate that the models are established with sufficient accuracy for two body coupled analysis 4 2 two body hydrodynamics the 6 dof motions are defined relative to the local coordinate system fixed on each body and the environmental directions see table 4 are specified according to the global coordinate as illustrated in fig 3 b and d o a x a y a z a on the ap in the tdm scenario is rotated counter clockwise by 90 about the z axis relative to o x y z thus the raos of ap for different configurations should be compared under the wave incident angles shown in fig 9 and the legends in fig 10 13 to ensure that the same mode of motion is discussed fig 10 shows the global motion responses of the fpso and ap for the single and two body coupled configurations at a heading of 0 the effects of multi body hydrodynamic interactions on fpso motions are negligible because the underwater part of ap is columns with small waterplane areas the dimensions of which are small compared to the wavelength thus it has an insignificant effect on wave propagation faltinsen 1990 the size difference between the two vessels is another reason since the two vessels are arranged in parallel along the incident waves motions of ap does not differ notably from that of the ap alone in the range of 8 13 s the motion amplitudes are slightly amplified by twin body hydrodynamic interactions especially for pitch from fig 11 and the twin body motion equation in frequency domain j 1 12 ω 2 m k j a k j ω i ω b k j ω c k j ξ j ω f k ω k j 1 12 where ξ j is the motion amplitude of the j th mode the pitch amplification is caused by the larger wave excitation force f 5 in two body configurations the interference is more intense in the sbs scenario than in the tdm configuration the reason is that the waves caused by ap are obstructed by the side profile of the fpso in a sbs arrangement whereas they are blocked by the transverse profile in the tdm configuration the side profile of fpso l o a 256 m is approximately five times larger than the transverse section dimension b 49 m at headings of 45 and 90 the results of fpso are not presented because its motions are not greatly affected by multi hull and wave interactions figs 12 and 13 with a 45 heading once the two vessels are arranged sbs the fpso can shelter the ap the two body coupled results are clearly smaller than those of the ap alone at 5 15 s besides the significant shielding effects on sway and roll under a beam sea the pitch response of ap is also excited which should be zero in the single body configuration fig 13 c the interference in tdm scenario is not as intense because ap is upstream of the fpso and it causes only slight fluctuations due to the asymmetric layoff of the sbs configuration the hydrodynamics of ap under 135 225 and 315 headings are also compared with those of 45 wave angle in fig 14 under 135 incident waves the fpso can still provide shelter while it is not quite significant since the ap is close to the fpso bow the ap locates upwards with a heading of 225 and 315 the hydrodynamic interactions cause fluctuations of ap motions in a wide range even with amplify effect at certain wave periods the pitch response at about 12s 4 3 dynamic gangway responses assuming that the ap can follow the drift motion of the fpso it will berth relative to the mean drift position of the fpso under different sea states in time domain simulations this ensures an initial gangway length of approximately 38 m the calculated results discussed in this section are the dynamic responses relative to the mean drift motions 4 3 1 different two body coupled configurations fig 15 shows the psd curves of dynamic gangway responses and relative motions between different gangway attaching points under ec1 in sbs configuration the response characteristic of gangway extension δ l is similar to that of y 1 y 2 this finding is also reflected in the absolute values of the pearson correlation coefficients rodgers and nicewander 1988 between x 1 x 2 y 1 y 2 and z 1 z 2 and δ l which are 0 19 0 93 and 0 22 respectively because the gangway is initially aligned with the y axis the change in y 1 y 2 directly affects its stroke x 1 x 2 and z 1 z 2 are small compared to l 0 thus they have a negligible impact on the gangway extension δ l has a low frequency feature that only one peak appears at approximately 0 048 rad s sway natural frequency of ap caused by the four soft horizontal springs at this frequency the resonant sway motion of ap results in a large gangway stroke the gangway luffing angle θ z exhibits both low frequency and wave frequency responses because it is determined by both φ and η the psd curve of component φ is similar to that of z 1 z 2 fig 15 b and c because the denominator in eqn 6 is roughly equal to l 0 the two peaks are in wave frequency range one is excited mainly by wave energy and the other represents the resonant heave motion of the fpso another component η is governed by z 2 z 3 owing to the initial height difference between p2 and p3 the rotation response θ h follows the trend of x 1 x 2 because the 180 incident wave is along the x axis θ h has an obvious peak near the fpso surge natural frequency 0 041 rad s corresponding results for the tdm scenario are shown in fig 16 only the differences between the two configurations are discussed since the gangway is aligned with the x axis the extension response is determined by the relative longitudinal motion between two vessels x 1 x 2 δ l and x 1 x 2 have distinct responses around the fpso surge natural period 0 041 rad s because of the large surge motion of the fpso which is excited by the second order wave drift effects the response of θ z is very similar to that of φ in both low frequency and wave frequency ranges in contrast to the findings for the sbs configuration φ is not only dominated by z 1 z 2 at 0 4 0 6 and 0 63 rad s but also has a significant response at low frequencies owing to the large x 1 x 2 θ h has the same characteristics as y 1 y 2 excited by the fpso sway motion the overall response is not obvious because the incident wave and coupled system are symmetrical about the x axis by comparing the psd curves and the statistics of gangway motions in table 8 we find that the gangway has larger responses in the tdm scenario except for θ h the extreme values of δ l when the two vessels are arranged in tdm are more than six times those of the sbs case the reason is that p1 is located at the fpso stern and its longitudinal distance from the turret centre is approximately 230 m even a small yaw angle of the fpso around the turret can cause evident translational motion of p1 thus the sbs configuration is advantageous for gangway operation and berthing security 4 3 2 effects of non collinear sea states fig 17 shows the statistical properties of gangway responses through the violin plot it depicts the probability density without making any assumptions of the underlying statistical distribution it also displays the median the lower quartile q1 or 25 the upper quartile q3 or 75 and the interquartile range iqr q3 q1 of samples the fpso and ap are in a sbs configuration when the incident wave and current are non collinear ec2 ec5 the dynamic gangway responses particularly that of δ l becomes more significant with increasing angle α between the wave and current the only exception is θ h which is affected only slightly by the current direction in non collinear cases the fpso is equilibrium at the mean yaw angle r z under the action of mean wave drift and current loads due to weathervaning r z is also the angle between the time dependent wave excitations and the midline of the vessel at this position fig 18 which causes the fpso to swing around the turret the yaw amplitude increases with increasing α as shown in fig 19 a and the standard deviations are 0 09 0 21 0 30 and 0 36 for ec2 ec3 ec4 and ec5 respectively the sway motion of p1 increases accordingly resulting in a large extension response as discussed above θ z is determined mainly by z 1 z 2 the time series of z 1 z 2 in fig 19 b indicate that the relative vertical motion between p1 and p2 is more apparent in non collinear cases as for the results of tdm arrangement fig 20 δ l and θ z exhibit a slight decrease and increase respectively with increasing α whereas θ h increases significantly the mean yaw angle of the fpso r z is 0 1 5 8 8 5 and 12 8 under ec2 ec5 respectively thus the component of wave force acting on the hull along o 1 x 1 axis becomes smaller consequently the surge motion of the fpso or p1 is decreased resulting in a smaller x 1 x 2 see fig 21 a which directly affects the gangway extension and in fact has the largest effect the reason for the change in θ z is the same as that in a sbs configuration the standard deviations of z 1 z 2 are 0 70 0 71 0 73 and 0 77 for ec2 ec3 ec4 and ec5 respectively the evident increase in θ h results from the notable increase in yaw motion of the fpso as illustrated in fig 21 b accordingly the transverse relative motion between p1 and p2 y 1 y 2 increases as well as θ h the statistics of dynamic gangway responses when the wind is also non parallel to the wave and current ec6 in the sbs and tdm configurations are listed in tables 9 and 10 respectively the variation trend is the same as that for ec2 ec5 and the change in the gangway responses is more significant owing to the non collinear wind 4 3 3 effects of significant wave height h s to investigate the effects of significant wave height the fpso ap coupled system in the sbs configuration is simulated in time domain for different h s in the range 4 0 7 5 m under 180 collinear wave wind and current t p 10 0 s γ 1 2 v w 15 4 m s and v c 0 69 m s fig 22 shows the calculated dynamic gangway responses with quadratic fitting curves the case of h s 0 m is also included where the results represent the initial state of the gangway there is a second order relationship between all the statistical properties of gangway responses and h s especially for δ l and θ h the reason is that the two types of gangway responses are dominated mainly by the relative motions between fpso and ap in the horizontal plane as explained in section 4 3 1 which are affected most strongly by the second order wave drift excitations 4 3 4 extreme value prediction the short term extreme gangway responses during a 3 h period are predicted using a two parameter weibull distribution table 11 shows the results for ec1 and ec6 in the sbs and tdm configurations when the coupled system is under the action of collinear and non collinear wave wind and current conditions q is the exceedance probability the sbs scenario is also preferable for fpso ap coupled operation fig 23 shows the extreme values for q in the range 10 1 10 7 in the sbs under ec1 and ec6 the δ l values show that the gangway tends to be elongated and the θ z values show that it is always in a luffing down attitude considering that the acceptance criteria for gangway operation are δ l 5 m 20 luffing up θ z 15 luffing down and θ h 180 dong et al 2019 the feasibility of gangway operation depends mainly on its extension and downward luffing angle it can still be operated under ec1 collinear sea states with an exceedance probability as low as 10 7 whereas the value is q 10 3 under ec6 non parallel wave wind and current to derive the limiting sea conditions for gangway operation more numerical simulations are conducted for the sbs configuration with different h s and t p values both collinear and non collinear sea states ec1 and ec6 are considered h s and t p are selected in the range 3 6 t p h s 5 recommended by dnv gl 2007 fig 24 shows the results calculated on the basis of the estimated 3 h extreme values of gangway elongation and luffing angle l c is the characteristic length of ap column which is 14 m for the collinear cases gangway failure will be caused by excessive luffing movement rather than gangway extension by contrast for the non collinear cases the criterion for the stroke of the gangway is more important 5 concluding remarks the coupled dynamics and gangway motion responses of a turret moored fpso and a semi submersible ap are investigated numerically the sbs and tdm at the stern of fpso configurations are considered we focus mainly on the effects of two body interactions on the hydrodynamics and gangway responses since the weathervaning of the fpso can cause a large yaw offset non collinear sea states are also investigated the extreme gangway motions are predicted according to a two parameter weibull distribution to obtain the limiting sea states for gangway operation the following conclusions are obtained 1 the gangway extension is governed mainly by relative motion of the two vessels along its initial span direction the luffing angle is determined by the vertical relative motion the response of the rotation angle follows the trend of relative motion along the x and y axes in the sbs and tdm configurations respectively 2 for a single point moored fpso the gangway motion is more significant under non collinear wave wind and current conditions because of the large yaw movement of the fpso in addition there is a quadratic relationship between the significant wave height h s and gangway responses 3 for fpso ap coupled operation the sbs scenario is preferable to the tdm configuration owing to the smaller gangway motion responses the feasibility of gangway operation depends mainly on its extension and downward luffing angle in the sbs arrangement for collinear sea states gangway failure will be caused by excessive luffing movement rather than extension by contrast for the non collinear cases the stroke of gangway is more important the limiting sea states are calculated based on two parameter weibull distribution which can be a reference for practical operation credit authorship contribution statement qing dong writing original draft data curation investigation visualization xiaoxian guo writing review editing methodology xin li resources investigation wenyue lu validation jianmin yang supervision funding acquisition conceptualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors are grateful for the support of the ministry of industry and information technology of china project no 2016 54 and the shanghai innovation action plan of science and technology grant no 19dz1207300 
20795,in multi body offshore systems a telescopic gangway is often adopted for personnel transfer the feasibility and safety of which are crucial the coupled dynamics and gangway responses of a turret moored floating production storage and offloading fpso unit and a semi submersible accommodation platform ap were investigated numerically in this study both side by side arrangement and the configuration that ap is tandem at the stern of fpso were considered the hydrodynamics considering multi body wave interaction were calculated in frequency domain based on potential theory the non linearity of second order wave drifts moorings and turret was fulfilled in time domain we focused mainly on the effects of multi body interactions on hydrodynamics and gangway responses the hydrodynamic interactions have a negligible effect on the global motions of fpso whereas it more strongly affects ap the interference is more intense in side by side scenario than in tandem configuration the gangway responses are governed by relative translational motions between two vessels and are also related to its initial arrangement since weathervaning of fpso can cause a large yaw offset non collinear sea states are considered in addition to cases with different significant wave heights extreme gangway responses are predicted according to weibull distribution by which the environment criteria are determined keywords fpso semi submersible side by side tandem gangway responses extreme values nomenclature δ l gangway extension η angle between gangway and vertical plane φ angle between gangway and horizontal plane θ h angle between gangway and global x axis θ z vertical angle between gangway and gangway tower l gangway length l 0 initial gangway length q exceedance probability ap accommodation platform dof degree of freedom dp dynamic positioning fpso floating production storage and offloading psd power spectral density rao response amplitude operator sbs side by side tdm tandem 1 introduction since the mid 1980s the offshore oil and gas industry has grown rapidly owing to industrial development and increasing demand for resources the floating production storage and offloading fpso unit is an innovative floating vessel designed for the processing and storage of crude oil before tanker transportation in china a total of 13 fpsos were in service as of july 2019 offshore magazine 2019 fpso has a large storage capacity and ample deck space providing better layout flexibility tahar and kim 2003 it is equipped with a single point mooring system which means that the vessel is free to rotate around the mooring system this behaviour is known as weathervaning sanchez mondragon et al 2017 and it allows the vessel to change its orientation with respect to the prevailing environmental direction to reduce the relative vessel environment angle and the resulting load on moorings howell et al 2006 in practical operation a fpso is usually connected to a massive permanent riser system and moorings thus it is costly to return the vessel to a shipyard for maintenance cong et al 2018 the personnel working on board need to be accommodated offshore kunkyebe and georgiev 2015 the accommodation platform ap is designed to provide better living conditions for crews working on the production vessel to meet class regulations it can also provide additional space for crane facilities power sources and storage for operating materials and equipment as well as reducing the space requirements and operating weight of the production vessel ramirez and fernandes 2017 the two vessels are generally arranged in a side by side sbs or tandem tdm configuration a telescopic gangway is mounted on the ap for personnel transfer its dynamic responses are crucial to the reliability up time and economic benefits of berthing a clear understanding of the coupled hydrodynamics and characteristics of gangway motions is essential the dynamic interactions for two floating bodies in waves are complex on the one hand the environmental loads including waves wind and current are different from the corresponding single body results there are complicated multi hull and wave interactions which cause diffraction and radiation waves between underwater structures the vessel motions can be amplified by superimposed waves at some wave frequencies pessoa et al 2015 and water resonance has been observed in the narrow gap between floating bodies zhao et al 2018 liu and falzarano 2019 nearby structures also have shielding effects on the wind and current loads on the other hand nonlinear mechanical connections such as moorings fenders and hawsers are usually adopted to limit the global motions feng and bai 2017 in contrast to vessels with a spread mooring system the turret moored fpso may change its heading angle appreciably within short periods ma et al 2013 this unique characteristic poses a potential risk to operational safety because a nearby service vessel cannot follow the fpso as it swings a collision may occur in addition the loads on moorings are increased causing excessive wear and damage to the mooring chains this study considers mainly two aspects according to the above hydrodynamic problems the two body hydrodynamics especially for the case of a turret moored fpso and the calculation and assessment of gangway responses which are quite related to global relative motions potential theory is a popular approach to solve the multi body hydrodynamics it has been applied to many practical projects such as floatover installation xu et al 2016 tension leg platform tlp and tender assisted drilling vessel tad coupled systems ramirez and fernandes 2017 li et al 2018 and fpso flotel systems kunkyebe and georgiev 2015 oil and gas offloading using an fpso or a floating liquefied natural gas vessel floating alongside a shuttle tanker has also attracted considerable attention the hydrodynamics including the vessel motions koo and kim 2005 second order wave loads line tensions zhao et al 2014 and collision risk gao et al 2014 have been solved for both the sbs and tdm configurations two body interference has been observed especially in the sbs configuration for overestimated water surface motions in narrow gaps the damping lid method fournier et al 2006 watai et al 2015 is an effective tool to suppress unrealistic water resonance the viscous fluid method feng et al 2017 has also been adopted to obtain relatively accurate predictions previous studies have focused mainly on the two body coupled hydrodynamics of fpso tanker systems few researches is about the application of a semi submersible ap alongside an fpso or the characteristics of gangway responses morandini and l hostis 2005 calculated some basic gangway motions for an fpso flotel system in a tdm configuration dong et al 2019 performed a detailed numerical and experimental study of the gangway responses in a coupled tlp tad system and predicted the extreme values as for the case of fpso li et al 2015 and huang et al 2018 analyzed parallel and non parallel configurations of an fpso with a service vessel respectively their simulations were performed in the frequency domain assuming a linear system cong et al 2018 investigated the wave current interaction and a dynamic positioning dp control scheme for a semi flotel connected to an fpso however this study focussed on the environmental sheltering and global vessel motions not the gangway responses this study investigates the coupled dynamics of an fpso and a semi submersible ap and motions of the gangway between them two configurations are considered the sbs and tdm at the stern of fpso one important concern is the hydrodynamic problem resulting from environmental sheltering the wave interaction is solved using two body wave diffraction and radiation theory note that aps are typically equipped with a dp system to maintain the relative positions which can balance the time independent wind and current loads and mean wave drift forces as well as second order wave slow drift excitations li et al 2015 in addition the interference on fpso s wind and current forces is negligible because of the size difference between the two bodies dong et al 2020 therefore the wind and current drag effects are considered only for the fpso using the single body results the passive motion compensated gangway can adjust its length and rotation according to the vessels relative positions it does not affect the rigidity of the coupled system or restrict the platform motions hence the gangway attachment points can be regarded as ideal joints huang et al 2018 this paper is organised as follows the theoretical background is briefly introduced in section 2 section 3 describes the coupled fpso ap system including the berthing configurations the main parameters of the two vessels and the sea conditions used in the numerical simulations the numerical results for the coupled system are discussed in section 4 including the single body results validated by experimental values the two body hydrodynamics the dynamic gangway responses and the prediction of the limiting sea states the main conclusions are summarised in section 5 2 methodology 2 1 dynamics of a two body system in waves the hydrodynamics of a multi body coupled system are directly related to the environmental loads which consist of the wave wind and current loads and corresponding shielding effects the wave interaction can be solved by two body wave diffraction and radiation theory there does exist twin body interference on wind and current loads especially for aps with small dimensions near an fpso with a large displacement as mentioned above aps are typically equipped with a dp system to maintain the relative positions which can balance the drift effects caused by the wind current and second order wave loads thus it is reasonable to exclude these drift forces on the ap during berthing analysis as an approximation wu 2014 because the interference on the environmental loads on the fpso is negligible owing to the size difference between the two bodies li et al 2015 and the fpso is often located upstream the single body wind and current drag effects are considered for the fpso briefly the following environmental excitations are considered in this study ap only the first order wave frequency excitation fpso the wind and current loads measured from single body wind tunnel tests and the first and second order wave drift loads the nonlinear motion equation for the fpso ap coupled system in time domain can be written as 1 m 11 a 11 a 12 a 21 m 22 a 22 x 1 t x 2 t 0 d τ r 11 τ r 12 τ r 21 τ r 22 τ x 1 t τ x 2 t τ c 11 c 22 x 1 t x 2 t f 1 f 2 1 st f 1 0 2 nd f 1 f 2 m f 1 0 w f 1 0 c where m and c are the inertia and hydrostatic restoring force matrices respectively a is the added mass at infinite frequency r τ is the retardation function matrix the right side of the equation represents the following external forces the first and second order wave drift forces f 1 st and f 2 nd mooring tension f m wind load f w and current load f c the superscript in parentheses denotes the body number assuming inviscid and irrotational flow the wave interaction problem can be solved by multi body wave diffraction and radiation theory lee 1995 the boundary value problems bvps of the velocity potentials are similar to those for the single body case except for the body surface conditions 2 φ j 1 n n j 1 on body 1 φ j 1 n 0 on body 2 φ j 2 n 0 on body 1 φ j 2 n n j 2 on body 2 where φ j is the unit radiation potential caused by the j th mode motion of the floating body and n is the unit normal vector pointing toward the fluid although the bvps are those of a system with zero speed and no current they are still applicable under a low speed current zhao et al 2014 yue et al 2020 which is 0 69 m s in this study it should be noted that the additional hydrodynamic damping induced by current thus is not included the above equations are solved by the green function method newman 1985 the total unsteady velocity potential can then be determined by linear superposition the hydrodynamic pressure p on the mean wet surfaces s b is obtained using the linear bernoulli equation gonzález et al 2015 and the first order wave loads are derived by integrating p over s b the second order wave drifts are crucial because they can cause large slow yaw rotation of a single point moored fpso this can make it difficult for the ap to follow the fpso and increase the environmental loads on the hull risers and moorings sanchez mondragon et al 2018 in this study the near field solution mciver 1986 is adopted to calculate the mean wave forces accordingly the difference frequency wave drift loads are approximated by newman s method newman 1974 the retardation function is calculated by fourier integration of the frequency dependent damping matrix b f at frequency f i e r τ c τ 0 4 b f cos 2 π f t d f where c τ exp 3 τ t c 2 is a cutoff scaling function t c is the cutoff time after which the retardation function is truncated and assumed to be zero because it decays to zero as τ goes to orcina 2015 f w and f c are applied by specified constant forces thus wind gusts and additional current damping are not included the lumped mass method niedzwecki and thampi 1991 is used to simulate the dynamics of the mooring lines which are discretized as a series of lumps of mass joined by massless springs clearly the numerical process mainly consists of two parts firstly the hydrodynamic parameters are solved in frequency domain to suppress the exaggerated calculated roll motion additional roll damping in a percentage of critical damping b c r i t is applied according to the decay test results for a single vessel then the nonlinear coupled analysis is conducted in time domain since the calculated hydrodynamics added mass potential damping and wave force transfer functions except for motion responses are used as inputs for equation 1 additional linear and quadratic damping are also added to well reproduce the real world results equation 1 is solved by an implicit integration scheme with the generalised α method chung and hulbert 1993 this method can effectively remove the nonphysical high frequency responses of the system and provide much more stable convergence using a controllable damping parameter the time step is 0 1 s with two simulation stages the first stage is 150 s long during this period the environmental conditions are ramped up slowly from zero to the specified values the second stage has a duration of 3 h and the results discussed below are obtained in this stage 2 2 dynamic gangway responses the passive motion compensated gangway can adjust its stroke azimuth and attitude angles according to the relative positions of the vessels it cannot bear any axial load hence the connection between the gangway and vessel can be simplified as an ideal joint the gangway responses can then be derived from the global motions of the two vessels we assume that the gangway connects the fpso and ap at points 1 p1 and 2 p2 with initial positions x 1 y 1 z 1 and x 2 y 2 z 2 respectively in each local coordinate system p2 is at the top of gangway tower and p3 is at the bottom with an initial position x 3 y 3 z 3 the positions of these three points are listed in table 1 according to the research from dong et al 2019 the dynamic gangway motion responses including the instantaneous gangway length l t extension δ l t luffing angle θ z the vertical angle between the gangway and the top plate of gangway tower and rotation angle θ h can be calculated as follows 3 l t δ x 2 δ y 2 δ z 2 x 1 x 2 2 y 1 y 2 2 z 1 z 2 2 4 δ l t l t l 0 5 θ z η φ 6 φ arctan z 2 z 1 x 1 x 2 2 y 1 y 2 2 7 η arctan x 2 x 3 2 y 2 y 3 2 z 2 z 3 8 θ h arctan x 1 x 2 y 1 y 2 for sbs arctan y 1 y 2 x 1 x 2 for tdm where x i y i z i is the translational motion of p i relative to the global coordinate o x y z including the contribution from the structure rotation l 0 is the initial gangway length φ is the angle between the gangway and the horizontal plane and η is the angle between the gangway tower and the vertical plane fig 1 shows the definitions of the gangway attitude angles for the sbs configuration as an example 2 3 extreme value statistics it is usually assumed that the sea states are stationary ergodic processes subsequently the vessel responses satisfy the gaussian distribution for a linear system if the stochastic process is narrow banded the peak response values will follow a rayleigh distribution longuet higgins 1952 since the second order low frequency drift of the fpso is also considered in this study the rayleigh distribution is no longer suitable thus the two parameter weibull distribution is adopted for extreme value prediction this probabilistic model can capture the nonlinearity of the data via appropriate parameters moan et al 2005 xiao et al 2015 fig 2 shows an example of the peak values of gangway extension fitted by rayleigh and weibull distributions for the sbs arrangement under ec1 refer to table 4 the cumulative distribution function f w x of the weibull model is 9 f w x 1 exp x λ k where λ is the scale parameter and k is the shape parameter the following logarithmic expression is more frequently used 10 log log 1 f w x m n log x the unknown parameters m and n can be obtained by fitting the calculated peak values from short term sea conditions the response extrema corresponding to a given exceedance probability q can be derived as 11 1 f w x q 3 fpso ap coupled system 3 1 coordinate systems three coordinate systems are introduced to describe the motions of a two body floating system in waves global coordinate system o x y z the origin is at the mean surface level local coordinate systems o f x f y f z f and o a x a y a z a these systems are fixed at the centre of gravity cog of each floating body relative to its mean position the positive x f x a y f y a and z f z a axes point toward the bow toward port and upward respectively two coupling arrangements are considered the two vessels are arranged sbs and the ap is tdm at the stern of the fpso see fig 3 the positions of the two local coordinates in o x y z are listed in table 2 for d 37 4 m which is the minimum distance between the underwater structures of the fpso and ap note that d depends on the relative positions of p1 and p2 resulting an initial gangway length of 38 m the incident angles 0 and 90 are along the x and y axes respectively 3 2 hull models and mooring lines the 120 000 dwt fpso operates at a water depth of 420 m it is moored through an internal turret which allows the vessel to freely rotate in response to the sea state the turret is maintained at its position by nine identical catenary mooring lines in a 3 3 pattern as shown in fig 4 a the three line bundles are evenly spread and the angle between the lines in each bundle is 5 thus there is a 110 opening between the line groups each line consists of three segments as chain wire rope and chain the semi submersible ap features two pontoons four columns and four bracings during the numerical simulations four horizontal soft springs with an axial stiffness of 4100 kn are utilized to stop the ap from drifting away see fig 4 b these springs are soft enough that they will not limit the wave frequency motion responses of ap the main parameters of the two vessels are listed in table 3 3 3 environmental conditions both collinear and non collinear sea conditions are considered based on the south china sea states with 1 year return period as listed in table 4 the irregular waves are described by the jonswap spectrum using a significant wave height h s peak wave period t p and spectral peakedness parameter γ the wind and current drag effects on the fpso are applied according to the ocimf method oil companies international marine forum 1994 by multiplying the measured force coefficients from wind tunnel tests by the square of a specified flow velocity the equivalent drag forces are summarised in table 5 only the static wind effect is included and there is no hydrodynamic damping due to the current 4 results and discussion 4 1 single body results before the two body coupled simulations the single body results including the model of vessel geometry mass distribution and mooring stiffness were validated single body tests of the fpso and ap with a scale ratio of 1 60 were performed separately in the deep water offshore basin at shanghai jiao tong university china the experiments included static offset and decay tests in calm water as well as white noise wave tests to obtain the motion response amplitude operators raos fig 5 shows the restoring force versus the offset of fpso in the surge direction the vessel was pulled along both the 0 and 180 directions the results indicate that the fpso moorings are modelled appropriately the natural periods of fpso and ap are listed in table 6 the differences between the measured and calculated values are less than 3 fig 6 shows the global motion responses of the fpso obtained from white noise wave tests the corresponding numerical results are shown for comparison only the degrees of freedom dofs with a large response amplitude under each wave incident angle are presented which can reach 0 5 m m or m except for yaw for most dofs the potential damping derived from the diffraction radiation theory is often adequate to describe the motions of offshore structures this is not particularly true for the roll motion of a long floating structure because the roll damping is highly nonlinear due to viscous effects and the potential damping is in a small percentage of the total damping pessoa et al 2015 moreover the amplification in roll may be large since the roll natural period usually falls in the wave frequency range chakrabarti 2001 to suppress the exaggerated roll motions resulting from the inviscid potential theory additional roll damping was added in frequency domain calculations using the approach of faltinsen 1990 the two results agree well with each other in most cases especially for sway heave roll and yaw discrepancies are observed in surge and pitch in the range of 12 19 s to ensure a reliable numerical model power spectral density psd curves of fpso motions derived from a time domain simulation are also compared in fig 7 the simulating conditions are only an irregular wave described by the jonswap spectrum is acting on the fpso hull h s 13 6 m t p 16 3 s γ 2 4 and wave direction is 180 as clarified before additional linear and quadratic damping terms are applied to heave roll and pitch modes during time domain simulations with specific values listed in table 7 the surge response has distinct low frequency characteristics there is only one large peak at 0 04 rad s about the surge natural period of 154 7 s and almost no response energy within the wave frequency range the numerical results coincide with test values especially in low frequency range for the pitch motion the measured values are slightly smaller than calculated rao results due to the neglect of water viscosity additional damping added to pitch mode in the time domain calculation makes the simulated results match well with measurements fig 7 c the calculated motion raos of ap for the single body case in fig 8 are in much better agreement with the test results than those of the fpso the differences in yaw are caused by the small response amplitude which is less than 0 1 m it is difficult for the optical motion acquisition system to capture such a small response accurately all of the above results indicate that the models are established with sufficient accuracy for two body coupled analysis 4 2 two body hydrodynamics the 6 dof motions are defined relative to the local coordinate system fixed on each body and the environmental directions see table 4 are specified according to the global coordinate as illustrated in fig 3 b and d o a x a y a z a on the ap in the tdm scenario is rotated counter clockwise by 90 about the z axis relative to o x y z thus the raos of ap for different configurations should be compared under the wave incident angles shown in fig 9 and the legends in fig 10 13 to ensure that the same mode of motion is discussed fig 10 shows the global motion responses of the fpso and ap for the single and two body coupled configurations at a heading of 0 the effects of multi body hydrodynamic interactions on fpso motions are negligible because the underwater part of ap is columns with small waterplane areas the dimensions of which are small compared to the wavelength thus it has an insignificant effect on wave propagation faltinsen 1990 the size difference between the two vessels is another reason since the two vessels are arranged in parallel along the incident waves motions of ap does not differ notably from that of the ap alone in the range of 8 13 s the motion amplitudes are slightly amplified by twin body hydrodynamic interactions especially for pitch from fig 11 and the twin body motion equation in frequency domain j 1 12 ω 2 m k j a k j ω i ω b k j ω c k j ξ j ω f k ω k j 1 12 where ξ j is the motion amplitude of the j th mode the pitch amplification is caused by the larger wave excitation force f 5 in two body configurations the interference is more intense in the sbs scenario than in the tdm configuration the reason is that the waves caused by ap are obstructed by the side profile of the fpso in a sbs arrangement whereas they are blocked by the transverse profile in the tdm configuration the side profile of fpso l o a 256 m is approximately five times larger than the transverse section dimension b 49 m at headings of 45 and 90 the results of fpso are not presented because its motions are not greatly affected by multi hull and wave interactions figs 12 and 13 with a 45 heading once the two vessels are arranged sbs the fpso can shelter the ap the two body coupled results are clearly smaller than those of the ap alone at 5 15 s besides the significant shielding effects on sway and roll under a beam sea the pitch response of ap is also excited which should be zero in the single body configuration fig 13 c the interference in tdm scenario is not as intense because ap is upstream of the fpso and it causes only slight fluctuations due to the asymmetric layoff of the sbs configuration the hydrodynamics of ap under 135 225 and 315 headings are also compared with those of 45 wave angle in fig 14 under 135 incident waves the fpso can still provide shelter while it is not quite significant since the ap is close to the fpso bow the ap locates upwards with a heading of 225 and 315 the hydrodynamic interactions cause fluctuations of ap motions in a wide range even with amplify effect at certain wave periods the pitch response at about 12s 4 3 dynamic gangway responses assuming that the ap can follow the drift motion of the fpso it will berth relative to the mean drift position of the fpso under different sea states in time domain simulations this ensures an initial gangway length of approximately 38 m the calculated results discussed in this section are the dynamic responses relative to the mean drift motions 4 3 1 different two body coupled configurations fig 15 shows the psd curves of dynamic gangway responses and relative motions between different gangway attaching points under ec1 in sbs configuration the response characteristic of gangway extension δ l is similar to that of y 1 y 2 this finding is also reflected in the absolute values of the pearson correlation coefficients rodgers and nicewander 1988 between x 1 x 2 y 1 y 2 and z 1 z 2 and δ l which are 0 19 0 93 and 0 22 respectively because the gangway is initially aligned with the y axis the change in y 1 y 2 directly affects its stroke x 1 x 2 and z 1 z 2 are small compared to l 0 thus they have a negligible impact on the gangway extension δ l has a low frequency feature that only one peak appears at approximately 0 048 rad s sway natural frequency of ap caused by the four soft horizontal springs at this frequency the resonant sway motion of ap results in a large gangway stroke the gangway luffing angle θ z exhibits both low frequency and wave frequency responses because it is determined by both φ and η the psd curve of component φ is similar to that of z 1 z 2 fig 15 b and c because the denominator in eqn 6 is roughly equal to l 0 the two peaks are in wave frequency range one is excited mainly by wave energy and the other represents the resonant heave motion of the fpso another component η is governed by z 2 z 3 owing to the initial height difference between p2 and p3 the rotation response θ h follows the trend of x 1 x 2 because the 180 incident wave is along the x axis θ h has an obvious peak near the fpso surge natural frequency 0 041 rad s corresponding results for the tdm scenario are shown in fig 16 only the differences between the two configurations are discussed since the gangway is aligned with the x axis the extension response is determined by the relative longitudinal motion between two vessels x 1 x 2 δ l and x 1 x 2 have distinct responses around the fpso surge natural period 0 041 rad s because of the large surge motion of the fpso which is excited by the second order wave drift effects the response of θ z is very similar to that of φ in both low frequency and wave frequency ranges in contrast to the findings for the sbs configuration φ is not only dominated by z 1 z 2 at 0 4 0 6 and 0 63 rad s but also has a significant response at low frequencies owing to the large x 1 x 2 θ h has the same characteristics as y 1 y 2 excited by the fpso sway motion the overall response is not obvious because the incident wave and coupled system are symmetrical about the x axis by comparing the psd curves and the statistics of gangway motions in table 8 we find that the gangway has larger responses in the tdm scenario except for θ h the extreme values of δ l when the two vessels are arranged in tdm are more than six times those of the sbs case the reason is that p1 is located at the fpso stern and its longitudinal distance from the turret centre is approximately 230 m even a small yaw angle of the fpso around the turret can cause evident translational motion of p1 thus the sbs configuration is advantageous for gangway operation and berthing security 4 3 2 effects of non collinear sea states fig 17 shows the statistical properties of gangway responses through the violin plot it depicts the probability density without making any assumptions of the underlying statistical distribution it also displays the median the lower quartile q1 or 25 the upper quartile q3 or 75 and the interquartile range iqr q3 q1 of samples the fpso and ap are in a sbs configuration when the incident wave and current are non collinear ec2 ec5 the dynamic gangway responses particularly that of δ l becomes more significant with increasing angle α between the wave and current the only exception is θ h which is affected only slightly by the current direction in non collinear cases the fpso is equilibrium at the mean yaw angle r z under the action of mean wave drift and current loads due to weathervaning r z is also the angle between the time dependent wave excitations and the midline of the vessel at this position fig 18 which causes the fpso to swing around the turret the yaw amplitude increases with increasing α as shown in fig 19 a and the standard deviations are 0 09 0 21 0 30 and 0 36 for ec2 ec3 ec4 and ec5 respectively the sway motion of p1 increases accordingly resulting in a large extension response as discussed above θ z is determined mainly by z 1 z 2 the time series of z 1 z 2 in fig 19 b indicate that the relative vertical motion between p1 and p2 is more apparent in non collinear cases as for the results of tdm arrangement fig 20 δ l and θ z exhibit a slight decrease and increase respectively with increasing α whereas θ h increases significantly the mean yaw angle of the fpso r z is 0 1 5 8 8 5 and 12 8 under ec2 ec5 respectively thus the component of wave force acting on the hull along o 1 x 1 axis becomes smaller consequently the surge motion of the fpso or p1 is decreased resulting in a smaller x 1 x 2 see fig 21 a which directly affects the gangway extension and in fact has the largest effect the reason for the change in θ z is the same as that in a sbs configuration the standard deviations of z 1 z 2 are 0 70 0 71 0 73 and 0 77 for ec2 ec3 ec4 and ec5 respectively the evident increase in θ h results from the notable increase in yaw motion of the fpso as illustrated in fig 21 b accordingly the transverse relative motion between p1 and p2 y 1 y 2 increases as well as θ h the statistics of dynamic gangway responses when the wind is also non parallel to the wave and current ec6 in the sbs and tdm configurations are listed in tables 9 and 10 respectively the variation trend is the same as that for ec2 ec5 and the change in the gangway responses is more significant owing to the non collinear wind 4 3 3 effects of significant wave height h s to investigate the effects of significant wave height the fpso ap coupled system in the sbs configuration is simulated in time domain for different h s in the range 4 0 7 5 m under 180 collinear wave wind and current t p 10 0 s γ 1 2 v w 15 4 m s and v c 0 69 m s fig 22 shows the calculated dynamic gangway responses with quadratic fitting curves the case of h s 0 m is also included where the results represent the initial state of the gangway there is a second order relationship between all the statistical properties of gangway responses and h s especially for δ l and θ h the reason is that the two types of gangway responses are dominated mainly by the relative motions between fpso and ap in the horizontal plane as explained in section 4 3 1 which are affected most strongly by the second order wave drift excitations 4 3 4 extreme value prediction the short term extreme gangway responses during a 3 h period are predicted using a two parameter weibull distribution table 11 shows the results for ec1 and ec6 in the sbs and tdm configurations when the coupled system is under the action of collinear and non collinear wave wind and current conditions q is the exceedance probability the sbs scenario is also preferable for fpso ap coupled operation fig 23 shows the extreme values for q in the range 10 1 10 7 in the sbs under ec1 and ec6 the δ l values show that the gangway tends to be elongated and the θ z values show that it is always in a luffing down attitude considering that the acceptance criteria for gangway operation are δ l 5 m 20 luffing up θ z 15 luffing down and θ h 180 dong et al 2019 the feasibility of gangway operation depends mainly on its extension and downward luffing angle it can still be operated under ec1 collinear sea states with an exceedance probability as low as 10 7 whereas the value is q 10 3 under ec6 non parallel wave wind and current to derive the limiting sea conditions for gangway operation more numerical simulations are conducted for the sbs configuration with different h s and t p values both collinear and non collinear sea states ec1 and ec6 are considered h s and t p are selected in the range 3 6 t p h s 5 recommended by dnv gl 2007 fig 24 shows the results calculated on the basis of the estimated 3 h extreme values of gangway elongation and luffing angle l c is the characteristic length of ap column which is 14 m for the collinear cases gangway failure will be caused by excessive luffing movement rather than gangway extension by contrast for the non collinear cases the criterion for the stroke of the gangway is more important 5 concluding remarks the coupled dynamics and gangway motion responses of a turret moored fpso and a semi submersible ap are investigated numerically the sbs and tdm at the stern of fpso configurations are considered we focus mainly on the effects of two body interactions on the hydrodynamics and gangway responses since the weathervaning of the fpso can cause a large yaw offset non collinear sea states are also investigated the extreme gangway motions are predicted according to a two parameter weibull distribution to obtain the limiting sea states for gangway operation the following conclusions are obtained 1 the gangway extension is governed mainly by relative motion of the two vessels along its initial span direction the luffing angle is determined by the vertical relative motion the response of the rotation angle follows the trend of relative motion along the x and y axes in the sbs and tdm configurations respectively 2 for a single point moored fpso the gangway motion is more significant under non collinear wave wind and current conditions because of the large yaw movement of the fpso in addition there is a quadratic relationship between the significant wave height h s and gangway responses 3 for fpso ap coupled operation the sbs scenario is preferable to the tdm configuration owing to the smaller gangway motion responses the feasibility of gangway operation depends mainly on its extension and downward luffing angle in the sbs arrangement for collinear sea states gangway failure will be caused by excessive luffing movement rather than extension by contrast for the non collinear cases the stroke of gangway is more important the limiting sea states are calculated based on two parameter weibull distribution which can be a reference for practical operation credit authorship contribution statement qing dong writing original draft data curation investigation visualization xiaoxian guo writing review editing methodology xin li resources investigation wenyue lu validation jianmin yang supervision funding acquisition conceptualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors are grateful for the support of the ministry of industry and information technology of china project no 2016 54 and the shanghai innovation action plan of science and technology grant no 19dz1207300 
20796,nonlinear blade effects and overall dynamic coupling of floating offshore wind turbines fowts are investigated using the latest developments in nonlinear beam theory and multibody dynamics an aero hydro servo elastic coupled model is developed combining momentum based beam theory mbbt and the momentum cloud method mcm based on a multi time scale coupling scheme in which geometrically exact blades are coupled with a highly compliant floating platform design that allows large angular motions comprehensive simulations are performed and the results are analyzed to demonstrate the importance of nonlinear effects and dynamic coupling of fowts nonlinear blade dynamics are shown to be critical in assessments of turbine performance and blade fatigue the highly compliant floater design is found to be feasible in realistic operating conditions a strong one way dynamic coupling is observed from platform motions to blade vibrations axi asymmetric response of the blades is found to induce significant imbalanced aerodynamic loading onto the turbine and the platform keywords nonlinear dynamics multi scale coupling momentum based beam theory momentum cloud method highly compliant floating wind turbine 1 introduction siting wind farms in the ocean has distinct advantages over onshore locations including availability of adequate space near population centers desirable wind characteristics and the possibility of building larger more efficient turbines because of reduced public concern about noise and visual impact however development of offshore wind turbines far from shore has been hindered by deep waters which makes bottom fixed structures prohibitively expensive fowts may be the most practical offshore wind energy technology for deep waters the dynamic behavior of fowt systems is highly complex because these structures are subject to irregular and nonlinear loads induced by both winds and waves nonlinear response of the blades and dynamic coupling between global rotational motion caused by gyroscopic effects of the whirling blades fully coupled aero hydro servo elastic modeling is crucial to complete analysis and design of fowt systems detailed simulation of these highly nonlinear systems should ideally include aerodynamic forcing acting on turbine blades hydrostatic and hydrodynamic loads on the floating platform active control of the electromechanical systems structural dynamics of flexible components inertial effects of the overall multibody system and force response of the mooring system blade element momentum bem and generalized dynamic wake gdw theories are commonly applied to aerodynamic modeling in existing wind turbine simulation codes aero hydro coupled modeling is made possible by combining bem or gdw aerodynamic model with conventional hydrodynamic methods used in oil and gas industry such as morison s equation or potential flow theory cordle and jonkman 2011 use of high fidelity computational fluid dynamics cfd simulation techniques has become increasingly popular for aerodynamic and hydrodynamic modeling of fowts tran and kim 2015 2016 2018 leble and barakos 2016 liu et al 2016 2017 however cfd techniques mainly have been applied to fowts that are modeled as multi rigid body systems because coupled simulation with structure flexibility and fluid interaction using cfd is extremely costly the fatigue aerodynamics structures and turbulence fast package is a broadly recognized dynamic simulator of wind turbines developed by the national renewable energy laboratory nrel u s though its underlying floating body solver is limited to small angles jonkman and jonkman 2016 the most recent developments of fowt modeling continuously improve the capability and accuracy of coupled models through combining advanced theories of aerodynamics hydrodynamics structural dynamics and mooring dynamics for instance the hybrid coordinate method is combined with kane s method to describe the kinematics and kinetics of fowts in the darwind code chen et al 2019 aqwa is combined with fast to enhance the simulation capabilities of nonlinear hydrodynamics and nonlinear mooring dynamics in the f2 a framework yang et al 2020 and the hierarchical programming and the object oriented modeling approach are used to allow for easy modification and replacement of individual components in the mowit library leimeister et al 2020 international energy agency has conducted several rounds of code to code comparisons for offshore wind turbine modeling and has found the simulations to be reasonably accurate but has indicated specific areas for potential enhancement jonkman et al 2010 vorpahl et al 2014 robertson et al 2014 2017 one of the potential improvements identified is coupled dynamic analysis of fowt blades wang et al 2016a rafiee et al 2017 computing the coupled dynamics of rotating blades with a floating platform is challenging irregular non inertial frames are introduced by blade rotation on the top of a moving tower subject to winds and waves large deflections are introduced by increasingly longer and more flexible blades linear euler bernoulli beam theory has been employed in early blade solvers such as flex øye 1999 and elastodyn jonkman and buhl 2005 in which effects of structural coupling and large deflections are neglected a methodology combining multibody theory with linear timoshenko beam elements has been used simpack wind cordle and jonkman 2011 hawc2 kim et al 2013 and blade dnv gl 2015 model individual blade elements as deformable bodies represented by linear finite elements geometrically exact beam theory gebt is a class of nonlinear beam dynamic theories hodges 2006 bauchau 2011 that is preferred to model fowt blades because it captures geometric and kinematic nonlinearities of beam structures geometric nonlinearities are nonlinear relationships between displacements and strains which are induced by large deformations and cause geometric stiffening kinematic nonlinearities are nonlinear relationships among displacements velocities and accelerations that are associated with overall rotation or angular deformation such as centrifugal and coriolis effects gebt was first applied to fowt blades in the fast package with the introduction of the beamdyn module wang et al 2016b the conventional finite element method interpolates a continuous quantity between nodes as a sum of shape functions which cannot be directly applied to gebt because three dimensional 3d rotations are non additive quantities numerical implementation becomes more complicated when blades undergo large overall motion because the overall rigid body motion of an undeformed blade and the rigid body motion of each deformable element both need to be considered carefully to ensure strain measures remain invariant to rigid body motion crisfield and jelenić 1999 wiener milenković parameters are used in beamdyn to represent 3d rotations and the governing equations used are formulated in an inertial frame such that rigid body motion must be removed prior to finite element interpolation and subsequently be restored afterwards wang et al 2017 wang and yu 2017 moreover analysis of a fully coupled fowt system is inherently a multi scale problem blade vibrations turbine spin and platform motions have distinctly different frequency ranges efficient quantification of nonlinear blade effects and overall dynamic coupling requires advanced beam theories to be coupled with large angle analysis methods using multi time scale schemes smaller and less costly floating platform designs have been proposed for fowts wang and sweetman 2012 sweetman and wang 2012 a family of six truncated spar platform designs are developed based on the oc3 hywind spar jonkman 2010 by gao and sweetman 2018 with drafts ranging from 62 m to 97 m which all conform to the industry standard structural guide api bulletin 2u the truncated designs have significantly lower hydrodynamic stiffnesses in pitch and roll making them highly compliant relative to the original spar and offer considerable reduction of manufacturing and installation costs at the expense of slightly reduced power output different from traditional fowt designs highly compliant fowts are subject to large angular platform motions wang and sweetman develop the mcm for multibody systems and apply it to highly compliant fowts in which a fowt system is represented by three rigid bodies wang and sweetman 2013 or six rigid bodies sweetman and wang 2014 this method does not rely on small angular displacement assumptions for dynamic and hydrodynamic computations but blades were modeled as rigid bodies tang and sweetman 2019 develop mbbt a non inertial frame formulation of gebt in which dynamic quantities are referred to non inertial moving reference frames mbbt is more suitable for fowt applications than other gebt formulations the moving frame method adopted in mbbt enables governing equations to be solved explicitly in arbitrary non inertial frame fully preserving nonlinear and inertial effects of the blades and enabling direct coupling between the blade solver and a separate multibody solver in a multi scale framework furthermore the nonlinear mbbt can be solved using a piecewise linear stepping scheme tang and sweetman 2019 allowing direct application of the conventional finite volume or finite element methods to nonlinear blades without special treatment of 3d rotations the work underlying this paper combines the latest developments in nonlinear beam theory and large angle multibody dynamics to assess the nonlinear effects and dynamic coupling within a fowt system mbbt and the mcm are combined to develop an aero hydro servo elastic coupled model for fowts compared to other fowt modeling methods the proposed method has three distinctive advantages first application of mbbt enables geometrically exact computation of turbine blades in non inertial frames using standard finite volume or finite element methods without special treatment fully preserving inertial effects and offering robust and accurate nonlinear blade simulation secondly application of mbbt to blade modeling enables easy multi time scale coupling with multibody models allowing blade and multibody system to be solved using different time step sizes which is nontrivial to be implemented using kane s method moreover the proposed mbbt mcm coupled method does not rely on small angles assumptions and therefore is capable of modeling highly compliant fowts and highly flexible blades that experience large angular displacements nonlinear effects and coupled dynamics of the blades are studied in this paper using the geometrically exact mbbt model and the overall dynamic response of fowts especially for a highly compliant design is investigated using the mbbt mcm coupled method two different spar floaters with the 5 mw reference turbine from nrel jonkman et al 2009 are studied under realistic environmental conditions the mcm is used to solve the three rigid body system hub nacelle and tower spar and mbbt is applied to compute the vibration and response of the flexible blades via a multi time scale coupling scheme simulation results computed using the fast package are used to benchmark the numerical tool developed as part of this work the coupling effects between blade vibrations and platform motions are numerically investigated using singular value decomposition svd of the blade response and computing the power spectrum of each of the resulting response modes the remainder of this paper is organized as following brief reviews of mbbt and the mcm are presented in section 2 the proposed multi time scale coupling scheme between rigid and flexible bodies and the overall coupling framework are developed in section 3 structural configurations simulation conditions the validation tests and post processing for fatigue are presented in section 4 nonlinear blade effects highly compliant floater designs and overall coupled dynamics are analyzed and discussed in section 5 2 technical background 2 1 momentum based beam theory mbbt is a 3d nonlinear gebt that rigorously includes geometric and kinematic nonlinearities subject to two assumptions cross sectional deformations are assumed to be small such that inertial properties of cross sections remain constant cross sectional internal forces and moments are assumed to be functions of strain measures and or time derivatives of strain measures these assumptions have been shown to be applicable to composite wind turbine blades hodges and yu 2007 jonnalagadda and whitcomb 2014 the coordinate systems used in mbbt are presented in fig 1 an inertial cartesian coordinate system fixed to the earth is denoted as global coordinate g a non inertial cartesian coordinate fixed to the undeformed beam is denoted as floating coordinate f translation and rotation of f relative to g represent the rigid body motion of an undeformed beam curvilinear coordinate s is attached to the elastic axis of an undeformed unstressed beam another curvilinear coordinate s is similarly attached to the elastic axis of the deformed beam two sets of local coordinates are defined at each point along s and s the local undeformed cartesian coordinate l is fixed to elastic center p 0 including b and c on the cross sectional plane and a tangent to the undeformed elastic axis the deformed local cartesian coordinate d is fixed to the elastic center of the displaced cross section including b and c remain on the deformed cross sectional plane translation and rotation of d relative to l represent the beam deflection the absolute motion measured in global coordinate g of any point along the beam can be expressed as a sum of two parts a prescribed overall rigid body motion of the undeformed beam plus the unknown displacements resulting from the beam deflection the unknown translational displacements are measured in local undeformed coordinate l u l u 1 u 2 u 3 t the unknown rotational displacement are defined using the 1 2 3 sequenced euler angles of 3d finite rotations θ θ 1 θ 2 θ 3 t rotational coordinate transformation matrices are used to transfer vectors from one coordinate system to another the subscripts of a transformation matrix indicate the post and pre transformation coordinates and the subscript of a vector indicate in which coordinate the vector is resolved for example transformation matrix t d l enables a translational displacement vector resolved in local undeformed coordinate l to be resolved in deformed coordinate d as u d t d l u l coordinate transformation matrices can be computed based on the 1 2 3 euler angle rotation sequence sweetman and wang 2014 bold font is used to indicate vectors or matrices and no einstein summation convention is implied throughout this paper translational and rotational governing equations of motion eom s are derived based on a momentum balance of each differential cross sectional beam element 1 f f e x t m a f w ω f r f w p 0 t f l u l t f l t l d e d ω f ω f r f w p 0 t f l u l t f l t l d e d t f l t l d ω d e d ω d ω d e d 2 ω f t f l u l t l d ω d e d t f l u l t f l t l d t f l t l d f d t f l t l d f d 2 m f e x t g ω f t f l t l d i d g t d l t l f ω f ω d t f l t l d ω d i d g t d l t l f ω f ω d t f l t l d i d g t d l t l f ω f ω d t f l t l d i d g ω d t d l t l f ω f t f l t l d t f l t l d m d p t f l t l d m d p t f l t l d e d k d f d t f l t l d e d f d t f l t l d γ e 1 f d in which m is the mass per unit length and i d g is the mass moment of inertia about center of mass g a g w is the absolute acceleration of point w ω f is the angular velocity of overall rigid body motion ω d is the angular velocity of local deflection f f e x t and m f e x t g are the total forces and moments about g resulting from external loads f d and m d p are the cross section internal force and moment about elastic center p r f w p 0 is the position vector pointing from w to p 0 e d r d p g is the eccentricity e 1 1 0 0 t is a unit vector γ is the local linear strain and k d axial t d f t f d is the curvature vector of the deformed curvilinear coordinate s furthermore denotes spatial derivatives with respect to curvilinear coordinate s and denote the first and second order time derivatives denotes the skew symmetric matrix of a vector used to represent cross products as matrix multiplications and axial denotes the axial vector computed from a skew symmetric matrix eqs 1 and 2 are the nonlinear eom s in vector form established in floating frame f a displacement based in terms of u l and θ formulation of mbbt can be obtained by combining these eom s with constitutive relation of eq 3 assuming linear elasticity strain measures of eqs 4 and 5 angular motion of eq 6 and transformation matrices of eq 7 3 f d m d p k 11 k 12 k 21 k 22 γ κ 4 γ t d l e 1 t l f t f l u l u l e 1 5 κ axial t d l t l f t f l t l d t d l t l d t l f t f l 6 ω d t d l t l d 7 t l d t d l 1 cos θ 2 cos θ 3 cos θ 2 sin θ 3 sin θ 2 cos θ 1 sin θ 3 cos θ 3 sin θ 1 sin θ 2 cos θ 1 cos θ 3 sin θ 1 sin θ 2 sin θ 3 cos θ 2 sin θ 1 sin θ 1 sin θ 3 cos θ 1 cos θ 3 sin θ 2 cos θ 3 sin θ 1 cos θ 1 sin θ 2 sin θ 3 cos θ 1 cos θ 2 in which κ is the local angular strain k 11 k 12 k 21 and k 22 are 3 3 cross sectional constitutive matrices rayleigh damping can be included in the resulting formulation with introduction of stiffness and mass damping coefficients geometric nonlinearities are captured by the computation of nonlinear strains in eqs 4 and 5 kinematic nonlinearities are captured in the governing eom s of eqs 1 and 2 blade dynamic effects of eccentricity anisotropic material coupling and initial twist curvature are captured by the terms associated with e d cross sectional constitutive matrices and t f l t l f respectively the overall rigid body motion of an undeformed beam introduces significant inertial forces and moments through translational acceleration a f w rotational velocity ω f and rotational acceleration ω f the inertial term that includes ω f ω f in eq 1 represents the centrifugal force introduced by the rigid body rotation and the inertial term that includes 2 ω f in eq 1 represents the coriolis effect the first term in the right hand side of eq 2 implies that the rigid body rotation alone ω f 0 ω d 0 will cause inertial moment the second and third terms in the right hand side of eq 2 imply that angular displacement alone ω f 0 ω d 0 will induce nonlinear inertial moments inclusion of these inertial terms is critical in accurate analysis of blade dynamic effects such as gyroscopic effects and the coupling between blade vibrations and platform motions a linearized version of the fully nonlinear mbbt has been derived by assuming small strains and small angular displacements such that all nonlinear terms with respect to displacements in eqs 1 and 2 can be neglected tang and sweetman 2019 the linearized mbbt solver is used in this work to compute the linear blade model for comparison to the nonlinear blades a separation of displacement technique has been developed to rigorously reduce nonlinear beam dynamics to a series of piecewise linear models at each time step a linear system of governing equations is established for an evolving base configuration and then solved the resulting incremental solutions are used to update base configuration and renew governing equations in a geometrically exact manner between time steps preserving nonlinear effects a standard finite volume discretization has been applied to the piecewise linear mbbt model and the resulting solver has been demonstrated to capture large deflection geometric and kinematic nonlinearities and coupling inertial effects the piecewise linear mbbt solver is used in this work to compute the nonlinear blade model 2 2 momentum based multibody theory the mcm is based on applying the conservation of momentum directly to a multi rigid body system and makes use of prescribed motion between each contiguous body to simplify the eom s sweetman and wang 2014 the absolute translation of the center of mass of the system and the rotation of a base body within the system are chosen as reference coordinates the relative rotations between the base body and contiguous bodies along the kinematic chain within the system are chosen to be relative coordinates the effects of which are captured as a series of cascading transformation matrices the final result is that the motion of an n body system can be conveniently represented using six only eom s that are updated at each time step for the evolving configuration of the system the solutions to three coupled rotational eom s are euler angles describing the rotation of the base body the solutions to three coupled translational eom s are the translation of the system measured at its center of mass which are then transferred into translation of the base body inverse dynamic analysis can be used to obtain internal forcing between any two contiguous bodies the advantage of the mcm is that only six degrees of freedom appear in the eom s regardless of multibody system complexity an in house multibody code has been developed using the mcm which has previously been applied to several multi rigid body models of fowt wang and sweetman 2012 2013 sweetman and wang 2014 and now is coupled with the mbbt based blade solvers as part of the present work 3 nonlinear dynamic coupling 3 1 dynamics of fowt systems the time domain simulation method proposed here accurately models complicated dynamic effects of a fowt system aerodynamic loads are computed for the instantaneous wind velocity and angle of attack relative to each of numerous blade elements such that aeroelastic effects are included turbine control is employed to actively adjust the pitch angle of the blades which directly impacts wind forcing on the turbine hydrodynamic effects are included by computing the hydrodynamic forces using morison s equation with strip theory and linear wave theory in which the instantaneous fluid velocity and acceleration relative to each of the moving spar segments are used nonlinear multibody dynamics are included using the mcm in which the euler angle formulation is used to represent the instantaneous configuration and exact kinematics of the multibody system nonlinear blade dynamics are included using the geometrically exact mbbt model geometric and kinematic nonlinearities are shown to be important for accurate modeling of fowt blades while it is reasonable to neglect constitutive and damping nonlinearities such that linear elastic material and rayleigh damping are adopted geometric nonlinearities result from nonlinear beam strains and induce the axial foreshortening effect which leads to significant geometric stiffening for the whirling blades because of centrifugal forces acting in blade axial direction kinematic nonlinearities result from nonlinear inertial terms in the beam theory which induces significant nonlinear inertial loads to the blades subject to turbine rotation and platform motions gyroscopic effects of the whirling blades are captured implicitly through dynamic coupling between the flexible blades and the multibody system with the gyroscopic moments resulting from summing the inertial effects of the elements of each blade in a moving reference frame 3 2 multi time scale coupling a multi time scale dynamic coupling scheme between rigid and flexible bodies is developed to enable fully coupled simulation of fowt systems flexible blades are modeled as cantilever beams and the resulting forces and moments at the roots of the blades are applied to a three rigid body system that represents the hub nacelle and tower spar motions of the three rigid body system are computed using external loads including gravity hydrostatic and hydrodynamic loads on the floater loads from the mooring lines and resultant loads from the blade roots acting on the rotating hub the overall rigid body motion of each blade is represented by a non inertial moving frame attached to the root of each blade which moves and rotates with the hub blade dynamics are computed using external loads and inertial forcing external loads include gravity and aerodynamic loads inertial forcing caused by the overall rigid body motion of blades such as centrifugal and coriolis forces are included as inertial terms in mbbt the proposed framework of the fully coupled fowt analysis is shown in fig 2 the turbsim code from nrel jonkman and kilcher 2012 is used to generate irregular winds which simulates wind fields and time histories from power spectra based on linear turbulence models gaussian process the aerodyn module from the fast package jonkman and jonkman 2013 is used to compute aerodynamic loads on each blade element based on the bem theory the piecewise linear mbbt solver is used to compute nonlinear blade dynamics of each blade modeled as a cantilever beam while the linearized mbbt is applied to compute the linear blade model for comparison a hub rotation module that represents the turbine drivetrain is developed to compute shaft torque power output and instantaneous hub spin the discon control routine from the fast package is adopted to regulate turbine operation which includes both shaft torque control at low wind speeds and blade pitch control at higher winds a hydrodynamic solver is developed to compute fluid kinematics for an irregular sea state using linear wave theory and then to compute hydrodynamic loads relative to the moving spar using morison s equation a hydrostatic solver is developed to compute the buoyancy force and the location of the center of buoyancy using the instantaneous position of the platform including changes to the water plane and to the submerged portion due to platform motions a mooring module is developed to compute restoring forces and moments from the mooring lines using the instantaneous relative position between the attachment and the anchor points and each mooring line is assumed to be a massless linear spring in which the effects of line dynamics and sag of the line are neglected the mcm multibody solver is coupled in this multi time scale framework to compute large angle displacements and relative motion within the three rigid body system of hub nacelle and tower spar the multi time scale coupling scheme is shown in fig 2 application of two different time step sizes substantially enhances computational efficiency because the rate at which the blade samples the irregular wind field and the blade vibrations have much higher frequencies than global platform motions aerodynamics and dynamics of the blades and hub rotations are computed using a smaller time step size δ t the multibody system and the turbine control response are computed using a larger time step size δ t responses of the flexible blades and the multibody system are exchanged between larger time steps in a weakly coupled manner deflections of each blade in response to external loads and motions of each non inertial reference frame are computed using multiple smaller time steps between two larger time steps the resulting blade root forces and moments are averaged over the larger time step and applied to the averaged root positions in the multibody system as external loads the tower position velocities and accelerations are computed at each of the larger time steps and assumed to be constant between these larger time steps hub rotations are computed using the smaller time steps to enable the blades to adequately sample the wind field 4 numerical simulations 4 1 system configurations all simulation examples model the 5 mw reference wind turbine from nrel jonkman et al 2009 the cut in rated and cut out wind speeds of the turbine are 3 m s 11 4 m s and 25 m s respectively and the rated rotor speed is 12 1 revolutions per minute rpm coupled dynamics of fowts especially for highly compliant designs are investigated through comparison between the responses of the original 120 m draft oc3 hywind spar design jonkman 2010 and a compliant 74 m draft truncated design gao and sweetman 2018 table 1 presents the properties of these two fowt platforms the mooring system is modified from the original three catenary lines to a four taut leg 90 apart mooring system to be compatible with both spar designs the mooring lines are anchored 800 m away from the spar with depth of 320 m and are attached to the spar at the center of mass of the complete fowt system fig 3 the mooring lines are assumed to have axial stiffness of 384 243 kn per unit strain 4 2 environmental conditions four load cases are simulated in this study the first three load cases represent typical operating conditions which conform to industry standard design load case dlc 1 2 in iec 61400 3 iec 2009 irregular wind fields are numerically simulated using the normal turbulence model for the first three load cases the mean wind speeds at the 90 m hub height are 7 m s 11 m s and 15 m s respectively a fully arisen pierson moskowitz pm sea state is assumed resulting irregular waves with significant wave heights of 0 66 m 1 62 m and 3 01 m and peak period of 4 03 s 6 43 s and 8 63 s for the 7 m s 11 m s and 15 m s winds respectively the fourth load case represents an extreme operating condition which conforms to dlc 1 6a in iec 61400 3 the irregular wind field has a mean wind speed of 25 m s at the hub height which is the cut off wind speed the turbine remains operating in simulations without brake to test system survivability in such extreme condition an extreme irregular wave process representing the 50 year extreme in the western region of the gulf of mexico is selected as per industry standard api 2int met the significant wave height is 11 3 m and the peak period is 14 4 s irregular waves in each of the load cases are generated using the random phase angle method one thousand regular harmonic functions are combined to approximate the sea surface each of which has a fixed amplitude computed from the corresponding pm spectrum and has a random phase angle incoming directions of winds and waves are assumed to be aligned and constant in all load cases such that yaw control of the wind turbine is deactivated in simulations twelve simulation cases are shown in table 2 including the reference cases in which the tower is fixed at an upright position and not subject to wave loading the fowt configurations with the standard 120 m spar and the highly compliant 74 m spar are each simulated subject to the typical and extreme operating conditions the platform and blades have zero initial displacements and initial turbine rotation speeds are 8 47 rpm 11 9 rpm 12 1 rpm and 12 1 rpm for the 7 m s 11 m s 15 m s and 25 m s winds respectively the simulation cases in sections 5 2 and 5 3 are computed in time domain for 3660 s the transient responses of the first minute are discarded and the results of the last one hour are used for fatigue and frequency domain analyses conforming to the simulation requirements from section 7 5 4 in iec 61400 3 4 3 validation tests the new modeling method that couples mbbt and the mcm is verified by benchmarking against the widely recognized fast package version 8 only the fowt with the stiff 120 m spar is benchmarked because of the small angle assumptions implicit to fast each blade is discretized into 23 elements in the mbbt blade model each blade in fast beamdyn is represented by single fifth order legendre spectral finite element the first and second validation tests are performed respectively to verify the computation of hydrodynamics and the mooring system and the computation of aerodynamics and the drivetrain a regular wave with wave height of 1 0 m and period of 5 0 s is applied to the fowt in which turbine rotation and aerodynamic loads are neglected figs 4 and 5 show the platform and blade responses computed by fast and the new mbbt mcm coupled model the test results show good agreement despite the fact that fast includes tower flexibility and mooring line dynamics and computes hydrodynamic loads based on potential flow theory a constant 9 m s wind is applied at the 90 m hub height with a logarithmic wind shear profile to simulate the startup of the fowt from zero turbine rotation and zero floater displacements in calm seas figs 6 and 7 show that the platform and turbine responses are in good agreement the two solvers predict sightly different turbine rotation during the startup transit stage such that a constant phases difference in blade responses remains because the blades have a constant difference in azimuth angle after reaching the steady state convergence tests are also performed to verify each of the two time step sizes used in flexible blade dynamics and multibody system dynamics results computed using δ t 0 02 s for the mcm solver and δ t 0 005 s for the mbbt solver are nearly identical to those computed using 0 003 s for both solvers figs 4 7 therefore the time step sizes are set to be 0 02 s and 0 005 s for all the following simulations the last validation test is to model the fowt subject to irregular waves and winds simulation case 120 m typical ii is applied and the resulting platform and turbine responses are presented in figs 8 and 9 the results from fast and the mbbt mcm coupled model match well the mbbt mcm model predicts stronger gyroscopic coupling which leads to slightly greater platform response in roll and sway 4 4 fatigue post processing accumulated fatigue damage of the blades are computed using the normal strain method cross sectional deformations are assumed to be small in the mbbt model such that the plane cross section assumption is used here for reconstruction of normal strain measures on cross sections from the blade model response normal strain ϵ a a at a point on a blade cross section is computed as 8 ϵ a a d b d c m b e i b b d c m c e i c c d b n e a in which d b and d c are the coordinates of a point measured in the deformed local coordinate d fig 10 m b m c and n are cross sectional bending moments and axial force computed by the blade solver and e i b b e i c c and e a are cross sectional bending stiffnesses and axial stiffness the number of strain reversals for different strain amplitudes and mean strains are calculated using the rainflow analysis the resulting accumulated fatigue damage at a point is then evaluated using miner s rule 9 d t i j n i j t n i j in which n i j t is the number of cycles having the i th strain amplitude and the j th mean strain in a time history of t seconds and n i j is the number of cycles to failure subject to the i th strain amplitude and the j th mean strain the accumulated damage over t seconds is converted to 1 year equivalent damage by assuming the turbine is subject to the same simulation conditions continuously for one year such that d 1 y e a r d t t 60 24 365 and the resulting fatigue life in years is equal to 1 d 1 y e a r the material properties of the nrel 5 mw turbine blades are not available only the structural and aerodynamic properties are provided in open literature fossum et al 2013 apply a glass fiber material named s1 to the blade shell in fatigue study the same material s1 is selected in this work as the shell material of the 5 mw turbine blades for fatigue analysis fig 11 shows the constant life diagram of this material including the data for three values of r which is the normal strain ratio r ϵ a a m i n ϵ a a m a x the number of cycles to failure n i j for each strain amplitude and mean strain combination is obtained from the constant life diagram the partial material safety factor of 1 45 and the consequence of failure factor of 1 15 are considered in fatigue computation according to industry standard dnv ds j102 time histories of normal strain are computed for 80 points on the edge around each blade cross section see fig 10 for example and total 23 cross sections along the blade are included table 3 such that 1840 strain histories of one blade are analyzed for each simulation case 5 results and discussion 5 1 nonlinear blade dynamics a series of cases are established specially to investigate nonlinear blade effects on turbine performance blade response and blade fatigue by comparing the results between the linear and nonlinear blade models the tower is fully restrained from motion and deformation in these cases and a steady wind with a logarithmic shear profile is applied table 4 shows the power output rotation speed shaft torque total wind thrust and blade pitch angle of the turbine for various wind speeds the linear blade model overestimates turbine performance when wind speed is below the rated speed and its pitch is set to greater angles by the pitch controller at wind speeds higher than 11 m s which leads to considerable underestimation of turbine wind thrust table 5 presents the steady mean displacements at the tip of individual blade and the largest 1 year equivalent fatigue damage with the corresponding location the linear blade model significantly overestimates blade deflection and fatigue damage at all tested wind speeds turbine performance is overestimated by the linear model because the foreshortening effect is neglected foreshortening is a nonlinear geometric effect that effectively reduces the swept area and therefore power output of a turbine the blade tip moves towards the hub when a blade deflects in bending like the blade is shortened blade deflection and fatigue damage are overestimated by the linear model because the foreshortening and geometric stiffening effects are neglected foreshortening reduces aerodynamic loads onto the blades and results in geometric stiffening under centrifugal force the inward displacement due to bending deflection is counteracted by the outward centrifugal force effectively stiffening the blades erroneous locations of fatigue hotspots are also predicted by the linear blade model the largest wind thrust blade deflection and fatigue damage occur at the rated wind speed because the blades are subject to the greatest aerodynamic loads when the turbine reaches to its design optimum blade pitch control is activated and turbine performance is regulated when wind speed is higher than the rated speed reducing wind thrust blade deflection and fatigue damage the results of this comparison show that nonlinear blade dynamics must be considered to assess turbine performance blade response and blade fatigue even for a static support structure in benign operating conditions the relative effect of nonlinear blade dynamics on overall platform response is further assessed using the realistic operating conditions established in section 4 2 three cases from table 2 120 m typical i ii and iii are simulated using both linear and nonlinear blade models when the wind speed is below the rated speed and blade pitch control is not activated 120 m typical i the linear results over predict turbine power output but differences in platform dynamic response are found to be small fig 12 as would be expected because the wind thrust is nearly equal table 4 effects of nonlinear blade dynamics on overall fowt response are found to be important for turbines operating around the rated wind speed 120 m typical ii fig 13 demonstrates that inappropriate use of a linear blade model can lead to noticeable error in global platform motions the difference in platform pitch results from the controller setting different blade pitch angles causing varying wind thrust as the control is switched on and off when the wind speed is much higher than the rated speed 120 m typical iii differences in platform motions are found to be small fig 14 because pitch angles assigned to both linear and nonlinear blades are nearly equivalent the results of this comparison suggest that the design of the blade pitch control algorithm used in a numerical model should ideally be customized for use with either a linear or nonlinear blade model and the use of an accurate nonlinear blade model is critical to proper design of blade pitch control algorithm the piecewise linear mbbt blade solver is used exclusively throughout the remainder of this paper to accurately model nonlinear blade effects 5 2 highly compliant fowt the feasibility of the highly compliant fowt design with a 74 m spar is demonstrated through a series of simulation cases including typical and extreme operating conditions the simulation results indicate that the 74 m spar fowt design survives the extreme condition and operates effectively in the typical conditions fig 15 shows the compliant design has much greater pitch motion but only slightly less power output in the typical i load case in which the mean wind speed is 7 m s the shorter more compliant 74 m spar has lower hydrodynamic stiffness in pitch and roll but identical stiffness in yaw such that larger pitch and roll motion but similar yaw motion are observed blade pitch control is not activated in this range of low wind speed and power output from the highly compliant design is slightly lower because the larger platform pitch results in a smaller projection of the swept area perpendicular to the air flow the mean pitch angles are 6 9 4 and 2 2 6 for 74 m and 120 m spars respectively and the corresponding means of power output are 1 38 mw and 1 45 mw figs 16 and 17 show simulation results for cases typical ii and typical iii in which blade pitch control is activated only the pitch and roll motions are presented yaw motion is very similar between the two spars the highly compliant design has larger platform pitch and roll motion and similar power output fig 18 presents the results from the simulation cases of 74 m extreme and 120 m extreme in which the fowts operate around the cut off wind speed of 25 m s in an extreme sea state the platform pitch angles computed for the extreme condition are smaller than that in the typical conditions which conforms to the test results in table 4 the blade pitch angle increases with wind speed after the pitch control is activated reducing wind thrust onto the fowt and therefore the platform pitch blade fatigue is also investigated for the highly compliant platform design table 6 summarizes the maximum 1 year equivalent fatigue damages and their corresponding locations computed for the two fowt designs and for a static fixed tower blade fatigue damage generally increases with increasing wind speed and wave height for all the three support structures dramatic increases in blade fatigue damage are observed in the extreme condition this extreme condition is at the operation limit above which the turbine would normally be parked the blade pitch controller assigns very large pitch angle to the blades to regulate the turbine in such extreme condition fig 18 vs figs 16 and 17 resulting in different dynamic response of the blades figs 19 and 20 respectively show the hotspots of blade fatigue and the range of flapwise deflection for various simulation cases the location of maximum fatigue damage is on the pressure side near the blade root for the typical operating conditions where there is a large mean tension associated with global blade bending however both the suction and pressure sides of the blade are exposed to compression tension cycles for the extreme cases in which the location of maximum damage moves closer to the blade tip on the suction side the highly compliant 74 m spar surprisingly shows less blade fatigue damage than its stiffer counterparts when subject to mild sea states and relatively low wind speeds typical i and ii conditions the maximum load on the blades during sudden wind gusts is reduced because the tower motion partially absorb dynamic impacts of the wind however the two spars show worse blade fatigue damage than the fixed tower when subject to wild sea states and higher winds typical iii and extreme conditions large tower motions introduce significant inertial loading onto the blades resulting in larger blade deflection fig 20 and worse fatigue damage table 6 these fatigue results suggest an opportunity to improve blade fatigue performance by optimizing the combined stiffness of the blades and platform in the design process the results also demonstrate the close relationship between blade vibrations and platform motions 5 3 coupled dynamics of fowt coupled dynamics of fowt systems are investigated using a spectral analysis of platform motions combined with a svd analysis of blade vibrations svd is a method commonly used to decompose discrete numerical dynamic displacements into proper orthogonal modes poms the resulting poms are mathematically orthogonal mode shapes that optimally represent the dynamic displacements along the blade a ratio is computed between the singular value associated with each pom and the sum of all singular values this ratio indicates the importance of each pom as a percentage of the total response poms differ from conventional eigenmodes in that they are not solely dependent on structure properties but also include load effects such that they are more suitable for nonlinear dynamic analysis under complex loading the peak frequencies are identified in the power spectral densities psds of platform pitch and of the first two poms of blade displacements figs 21 and 22 these psds are computed from time histories extracted from the simulation cases of 74 m typical iii 74 m extreme 120 m typical iii and 120 m extreme the pitch natural frequencies of the 74 m and 120 m spars are computed to be 0 022 hz and 0 031 hz respectively and the incoming wave peak frequencies are 0 116 hz and 0 069 hz in the typical iii and extreme conditions respectively energy peaks at these frequencies are clearly observed on the psd plots of platform pitch figs 21 and 22 the first pom of blade vibration is dominated by flapwise bending while the second pom is dominated by edgewise bending the sum of the first two poms accounts for 96 of the total blade displacements in the typical iii condition and 87 in the extreme condition gravity is the dominant periodic loading on the blades and appears as an energy peak at turbine rotation frequency of about 0 2 hz on the psds of blade poms in which turbine speed is regulated to 12 1 rpm significant amount of energy is also observed at the wave peak frequencies and at the platform natural frequencies on the psd plots of blade poms implying a strong one way dynamic coupling from platform motions to blade vibrations fig 23 shows a significant coupling between platform yaw motion and blade revolution energy peaks at blade revolution frequencies 3 9 rpm 0 45 hz for case typical i and 3 12 rpm 0 6 hz for cases typical ii and iii are found to be caused by the imbalance of aerodynamic loading associated with axi asymmetric deflection of the three blades four special cases are simulated to investigate the origins of imbalanced aerodynamic loading aerodynamic yaw moments applied on the top of a vertically fixed tower are compared for the 5 mw wind turbine subject to four different conditions a 13 m s constant uniform wind without turbine tilt and without gravity b 13 m s constant uniform wind without turbine tilt but with gravity c 13 m s constant uniform wind with 10 turbine tilt but without gravity and d 13 m s constant wind including wind shear without turbine tilt and without gravity table 7 shows the mean standard deviation and peak frequency of the aerodynamic yaw moment computed in each of the four cases the results for case a show that the yaw moment remains zero once steady state is reached the major blade deflection in this gravity free case is flapwise bending induced by aerodynamic thrust blades deflection is the same for each of the three blades in absence of turbine tilt wind shear and gravity such that the turbine remains axi symmetric about the spin axis and the aerodynamic forces are balanced by the three blades the only difference between cases a and b is the inclusion of gravitational acceleration individual blades deflect under their own weight causing the turbine to be axi asymmetric about the spin axis within the rotating plane the sum of aerodynamic forces of the three blades results in the 345 6 kn m mean yaw moment shown for case b case c is intended to investigate the effect of turbine tilt in absence of gravity the only difference between cases a and c is that the turbine is tilted up by 10 from the vertical the source of the 910 3 kn m mean yaw moment shown for case c is the changing angle of attack of each blade element as the blade sweeps over the tilted rotating plane case d is intended to investigate the effect of wind shear on imbalanced aerodynamic loading the wind velocity is higher at the top on the rotating plane such that the incoming wind velocity and the angle of attack vary as the blade progresses through the swept area the relatively high standard deviation for case d results from the uneven number of blades precluding an effective moment balance across the rotor hub the results of these four cases suggest that the imbalance of aerodynamic loading is common because axi asymmetric response of the blades can be induced by many factors and imbalanced aerodynamic loading generally increases with turbine size imbalanced aerodynamic loading also appears in other directions but the effects on pitch and roll of a spar platform show much less than that on yaw motion because the stiffness and damping are both much higher in pitch and roll 6 conclusions nonlinear effects and dynamic coupling of fowt systems including a highly compliant design are assessed using a multi time scale dynamic coupling method that combines mbbt and the mcm the mbbt mcm coupled model allows for large displacement angles and the resulting nonlinearities the combined multibody and flexible beam analysis method has been shown to effectively capture nonlinear blade dynamics and various dynamic coupling behaviors of fowt systems twelve realistic cases are simulated for typical and extreme operating conditions and two sets of idealistic cases are simulated for investigation of nonlinear blade effects and imbalanced aerodynamic loading significant findings are presented below 1 nonlinear blade dynamics have been demonstrated to be important for estimations of turbine performance and blade fatigue and should be considered in the design of blade pitch control algorithm linear blade model has been shown to overestimate power output by 5 8 for wind speeds lower than the rated speed and to dramatically over predict blade fatigue damage by 1 2 times 2 a highly compliant fowt design with a 74 m draft spar has been demonstrated to be feasible in both typical and extreme operating conditions and its blade fatigue damage has been found to be comparable with the original 120 m draft design blade fatigue analysis has shown that increasing support structure compliance can potentially mitigate blade fatigue damage but excessively large platform oscillations adversely affect blade fatigue life 3 imbalanced aerodynamic loading has been demonstrated to be induced by axi asymmetric blade responses associated with gravity turbine tilt and wind shear imbalanced aerodynamic loading has found to be synchronized with blade revolution and the resulting platform yaw motion has been observed 4 one way coupling from platform motions to blade vibrations through inertial effects has been demonstrated blade vibrations hardly affect platform motions because of the huge differences in mass and in natural frequency credit authorship contribution statement shanran tang methodology software validation formal analysis investigation writing original draft bert sweetman conceptualization resources supervision writing review editing ju gao software formal analysis investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20796,nonlinear blade effects and overall dynamic coupling of floating offshore wind turbines fowts are investigated using the latest developments in nonlinear beam theory and multibody dynamics an aero hydro servo elastic coupled model is developed combining momentum based beam theory mbbt and the momentum cloud method mcm based on a multi time scale coupling scheme in which geometrically exact blades are coupled with a highly compliant floating platform design that allows large angular motions comprehensive simulations are performed and the results are analyzed to demonstrate the importance of nonlinear effects and dynamic coupling of fowts nonlinear blade dynamics are shown to be critical in assessments of turbine performance and blade fatigue the highly compliant floater design is found to be feasible in realistic operating conditions a strong one way dynamic coupling is observed from platform motions to blade vibrations axi asymmetric response of the blades is found to induce significant imbalanced aerodynamic loading onto the turbine and the platform keywords nonlinear dynamics multi scale coupling momentum based beam theory momentum cloud method highly compliant floating wind turbine 1 introduction siting wind farms in the ocean has distinct advantages over onshore locations including availability of adequate space near population centers desirable wind characteristics and the possibility of building larger more efficient turbines because of reduced public concern about noise and visual impact however development of offshore wind turbines far from shore has been hindered by deep waters which makes bottom fixed structures prohibitively expensive fowts may be the most practical offshore wind energy technology for deep waters the dynamic behavior of fowt systems is highly complex because these structures are subject to irregular and nonlinear loads induced by both winds and waves nonlinear response of the blades and dynamic coupling between global rotational motion caused by gyroscopic effects of the whirling blades fully coupled aero hydro servo elastic modeling is crucial to complete analysis and design of fowt systems detailed simulation of these highly nonlinear systems should ideally include aerodynamic forcing acting on turbine blades hydrostatic and hydrodynamic loads on the floating platform active control of the electromechanical systems structural dynamics of flexible components inertial effects of the overall multibody system and force response of the mooring system blade element momentum bem and generalized dynamic wake gdw theories are commonly applied to aerodynamic modeling in existing wind turbine simulation codes aero hydro coupled modeling is made possible by combining bem or gdw aerodynamic model with conventional hydrodynamic methods used in oil and gas industry such as morison s equation or potential flow theory cordle and jonkman 2011 use of high fidelity computational fluid dynamics cfd simulation techniques has become increasingly popular for aerodynamic and hydrodynamic modeling of fowts tran and kim 2015 2016 2018 leble and barakos 2016 liu et al 2016 2017 however cfd techniques mainly have been applied to fowts that are modeled as multi rigid body systems because coupled simulation with structure flexibility and fluid interaction using cfd is extremely costly the fatigue aerodynamics structures and turbulence fast package is a broadly recognized dynamic simulator of wind turbines developed by the national renewable energy laboratory nrel u s though its underlying floating body solver is limited to small angles jonkman and jonkman 2016 the most recent developments of fowt modeling continuously improve the capability and accuracy of coupled models through combining advanced theories of aerodynamics hydrodynamics structural dynamics and mooring dynamics for instance the hybrid coordinate method is combined with kane s method to describe the kinematics and kinetics of fowts in the darwind code chen et al 2019 aqwa is combined with fast to enhance the simulation capabilities of nonlinear hydrodynamics and nonlinear mooring dynamics in the f2 a framework yang et al 2020 and the hierarchical programming and the object oriented modeling approach are used to allow for easy modification and replacement of individual components in the mowit library leimeister et al 2020 international energy agency has conducted several rounds of code to code comparisons for offshore wind turbine modeling and has found the simulations to be reasonably accurate but has indicated specific areas for potential enhancement jonkman et al 2010 vorpahl et al 2014 robertson et al 2014 2017 one of the potential improvements identified is coupled dynamic analysis of fowt blades wang et al 2016a rafiee et al 2017 computing the coupled dynamics of rotating blades with a floating platform is challenging irregular non inertial frames are introduced by blade rotation on the top of a moving tower subject to winds and waves large deflections are introduced by increasingly longer and more flexible blades linear euler bernoulli beam theory has been employed in early blade solvers such as flex øye 1999 and elastodyn jonkman and buhl 2005 in which effects of structural coupling and large deflections are neglected a methodology combining multibody theory with linear timoshenko beam elements has been used simpack wind cordle and jonkman 2011 hawc2 kim et al 2013 and blade dnv gl 2015 model individual blade elements as deformable bodies represented by linear finite elements geometrically exact beam theory gebt is a class of nonlinear beam dynamic theories hodges 2006 bauchau 2011 that is preferred to model fowt blades because it captures geometric and kinematic nonlinearities of beam structures geometric nonlinearities are nonlinear relationships between displacements and strains which are induced by large deformations and cause geometric stiffening kinematic nonlinearities are nonlinear relationships among displacements velocities and accelerations that are associated with overall rotation or angular deformation such as centrifugal and coriolis effects gebt was first applied to fowt blades in the fast package with the introduction of the beamdyn module wang et al 2016b the conventional finite element method interpolates a continuous quantity between nodes as a sum of shape functions which cannot be directly applied to gebt because three dimensional 3d rotations are non additive quantities numerical implementation becomes more complicated when blades undergo large overall motion because the overall rigid body motion of an undeformed blade and the rigid body motion of each deformable element both need to be considered carefully to ensure strain measures remain invariant to rigid body motion crisfield and jelenić 1999 wiener milenković parameters are used in beamdyn to represent 3d rotations and the governing equations used are formulated in an inertial frame such that rigid body motion must be removed prior to finite element interpolation and subsequently be restored afterwards wang et al 2017 wang and yu 2017 moreover analysis of a fully coupled fowt system is inherently a multi scale problem blade vibrations turbine spin and platform motions have distinctly different frequency ranges efficient quantification of nonlinear blade effects and overall dynamic coupling requires advanced beam theories to be coupled with large angle analysis methods using multi time scale schemes smaller and less costly floating platform designs have been proposed for fowts wang and sweetman 2012 sweetman and wang 2012 a family of six truncated spar platform designs are developed based on the oc3 hywind spar jonkman 2010 by gao and sweetman 2018 with drafts ranging from 62 m to 97 m which all conform to the industry standard structural guide api bulletin 2u the truncated designs have significantly lower hydrodynamic stiffnesses in pitch and roll making them highly compliant relative to the original spar and offer considerable reduction of manufacturing and installation costs at the expense of slightly reduced power output different from traditional fowt designs highly compliant fowts are subject to large angular platform motions wang and sweetman develop the mcm for multibody systems and apply it to highly compliant fowts in which a fowt system is represented by three rigid bodies wang and sweetman 2013 or six rigid bodies sweetman and wang 2014 this method does not rely on small angular displacement assumptions for dynamic and hydrodynamic computations but blades were modeled as rigid bodies tang and sweetman 2019 develop mbbt a non inertial frame formulation of gebt in which dynamic quantities are referred to non inertial moving reference frames mbbt is more suitable for fowt applications than other gebt formulations the moving frame method adopted in mbbt enables governing equations to be solved explicitly in arbitrary non inertial frame fully preserving nonlinear and inertial effects of the blades and enabling direct coupling between the blade solver and a separate multibody solver in a multi scale framework furthermore the nonlinear mbbt can be solved using a piecewise linear stepping scheme tang and sweetman 2019 allowing direct application of the conventional finite volume or finite element methods to nonlinear blades without special treatment of 3d rotations the work underlying this paper combines the latest developments in nonlinear beam theory and large angle multibody dynamics to assess the nonlinear effects and dynamic coupling within a fowt system mbbt and the mcm are combined to develop an aero hydro servo elastic coupled model for fowts compared to other fowt modeling methods the proposed method has three distinctive advantages first application of mbbt enables geometrically exact computation of turbine blades in non inertial frames using standard finite volume or finite element methods without special treatment fully preserving inertial effects and offering robust and accurate nonlinear blade simulation secondly application of mbbt to blade modeling enables easy multi time scale coupling with multibody models allowing blade and multibody system to be solved using different time step sizes which is nontrivial to be implemented using kane s method moreover the proposed mbbt mcm coupled method does not rely on small angles assumptions and therefore is capable of modeling highly compliant fowts and highly flexible blades that experience large angular displacements nonlinear effects and coupled dynamics of the blades are studied in this paper using the geometrically exact mbbt model and the overall dynamic response of fowts especially for a highly compliant design is investigated using the mbbt mcm coupled method two different spar floaters with the 5 mw reference turbine from nrel jonkman et al 2009 are studied under realistic environmental conditions the mcm is used to solve the three rigid body system hub nacelle and tower spar and mbbt is applied to compute the vibration and response of the flexible blades via a multi time scale coupling scheme simulation results computed using the fast package are used to benchmark the numerical tool developed as part of this work the coupling effects between blade vibrations and platform motions are numerically investigated using singular value decomposition svd of the blade response and computing the power spectrum of each of the resulting response modes the remainder of this paper is organized as following brief reviews of mbbt and the mcm are presented in section 2 the proposed multi time scale coupling scheme between rigid and flexible bodies and the overall coupling framework are developed in section 3 structural configurations simulation conditions the validation tests and post processing for fatigue are presented in section 4 nonlinear blade effects highly compliant floater designs and overall coupled dynamics are analyzed and discussed in section 5 2 technical background 2 1 momentum based beam theory mbbt is a 3d nonlinear gebt that rigorously includes geometric and kinematic nonlinearities subject to two assumptions cross sectional deformations are assumed to be small such that inertial properties of cross sections remain constant cross sectional internal forces and moments are assumed to be functions of strain measures and or time derivatives of strain measures these assumptions have been shown to be applicable to composite wind turbine blades hodges and yu 2007 jonnalagadda and whitcomb 2014 the coordinate systems used in mbbt are presented in fig 1 an inertial cartesian coordinate system fixed to the earth is denoted as global coordinate g a non inertial cartesian coordinate fixed to the undeformed beam is denoted as floating coordinate f translation and rotation of f relative to g represent the rigid body motion of an undeformed beam curvilinear coordinate s is attached to the elastic axis of an undeformed unstressed beam another curvilinear coordinate s is similarly attached to the elastic axis of the deformed beam two sets of local coordinates are defined at each point along s and s the local undeformed cartesian coordinate l is fixed to elastic center p 0 including b and c on the cross sectional plane and a tangent to the undeformed elastic axis the deformed local cartesian coordinate d is fixed to the elastic center of the displaced cross section including b and c remain on the deformed cross sectional plane translation and rotation of d relative to l represent the beam deflection the absolute motion measured in global coordinate g of any point along the beam can be expressed as a sum of two parts a prescribed overall rigid body motion of the undeformed beam plus the unknown displacements resulting from the beam deflection the unknown translational displacements are measured in local undeformed coordinate l u l u 1 u 2 u 3 t the unknown rotational displacement are defined using the 1 2 3 sequenced euler angles of 3d finite rotations θ θ 1 θ 2 θ 3 t rotational coordinate transformation matrices are used to transfer vectors from one coordinate system to another the subscripts of a transformation matrix indicate the post and pre transformation coordinates and the subscript of a vector indicate in which coordinate the vector is resolved for example transformation matrix t d l enables a translational displacement vector resolved in local undeformed coordinate l to be resolved in deformed coordinate d as u d t d l u l coordinate transformation matrices can be computed based on the 1 2 3 euler angle rotation sequence sweetman and wang 2014 bold font is used to indicate vectors or matrices and no einstein summation convention is implied throughout this paper translational and rotational governing equations of motion eom s are derived based on a momentum balance of each differential cross sectional beam element 1 f f e x t m a f w ω f r f w p 0 t f l u l t f l t l d e d ω f ω f r f w p 0 t f l u l t f l t l d e d t f l t l d ω d e d ω d ω d e d 2 ω f t f l u l t l d ω d e d t f l u l t f l t l d t f l t l d f d t f l t l d f d 2 m f e x t g ω f t f l t l d i d g t d l t l f ω f ω d t f l t l d ω d i d g t d l t l f ω f ω d t f l t l d i d g t d l t l f ω f ω d t f l t l d i d g ω d t d l t l f ω f t f l t l d t f l t l d m d p t f l t l d m d p t f l t l d e d k d f d t f l t l d e d f d t f l t l d γ e 1 f d in which m is the mass per unit length and i d g is the mass moment of inertia about center of mass g a g w is the absolute acceleration of point w ω f is the angular velocity of overall rigid body motion ω d is the angular velocity of local deflection f f e x t and m f e x t g are the total forces and moments about g resulting from external loads f d and m d p are the cross section internal force and moment about elastic center p r f w p 0 is the position vector pointing from w to p 0 e d r d p g is the eccentricity e 1 1 0 0 t is a unit vector γ is the local linear strain and k d axial t d f t f d is the curvature vector of the deformed curvilinear coordinate s furthermore denotes spatial derivatives with respect to curvilinear coordinate s and denote the first and second order time derivatives denotes the skew symmetric matrix of a vector used to represent cross products as matrix multiplications and axial denotes the axial vector computed from a skew symmetric matrix eqs 1 and 2 are the nonlinear eom s in vector form established in floating frame f a displacement based in terms of u l and θ formulation of mbbt can be obtained by combining these eom s with constitutive relation of eq 3 assuming linear elasticity strain measures of eqs 4 and 5 angular motion of eq 6 and transformation matrices of eq 7 3 f d m d p k 11 k 12 k 21 k 22 γ κ 4 γ t d l e 1 t l f t f l u l u l e 1 5 κ axial t d l t l f t f l t l d t d l t l d t l f t f l 6 ω d t d l t l d 7 t l d t d l 1 cos θ 2 cos θ 3 cos θ 2 sin θ 3 sin θ 2 cos θ 1 sin θ 3 cos θ 3 sin θ 1 sin θ 2 cos θ 1 cos θ 3 sin θ 1 sin θ 2 sin θ 3 cos θ 2 sin θ 1 sin θ 1 sin θ 3 cos θ 1 cos θ 3 sin θ 2 cos θ 3 sin θ 1 cos θ 1 sin θ 2 sin θ 3 cos θ 1 cos θ 2 in which κ is the local angular strain k 11 k 12 k 21 and k 22 are 3 3 cross sectional constitutive matrices rayleigh damping can be included in the resulting formulation with introduction of stiffness and mass damping coefficients geometric nonlinearities are captured by the computation of nonlinear strains in eqs 4 and 5 kinematic nonlinearities are captured in the governing eom s of eqs 1 and 2 blade dynamic effects of eccentricity anisotropic material coupling and initial twist curvature are captured by the terms associated with e d cross sectional constitutive matrices and t f l t l f respectively the overall rigid body motion of an undeformed beam introduces significant inertial forces and moments through translational acceleration a f w rotational velocity ω f and rotational acceleration ω f the inertial term that includes ω f ω f in eq 1 represents the centrifugal force introduced by the rigid body rotation and the inertial term that includes 2 ω f in eq 1 represents the coriolis effect the first term in the right hand side of eq 2 implies that the rigid body rotation alone ω f 0 ω d 0 will cause inertial moment the second and third terms in the right hand side of eq 2 imply that angular displacement alone ω f 0 ω d 0 will induce nonlinear inertial moments inclusion of these inertial terms is critical in accurate analysis of blade dynamic effects such as gyroscopic effects and the coupling between blade vibrations and platform motions a linearized version of the fully nonlinear mbbt has been derived by assuming small strains and small angular displacements such that all nonlinear terms with respect to displacements in eqs 1 and 2 can be neglected tang and sweetman 2019 the linearized mbbt solver is used in this work to compute the linear blade model for comparison to the nonlinear blades a separation of displacement technique has been developed to rigorously reduce nonlinear beam dynamics to a series of piecewise linear models at each time step a linear system of governing equations is established for an evolving base configuration and then solved the resulting incremental solutions are used to update base configuration and renew governing equations in a geometrically exact manner between time steps preserving nonlinear effects a standard finite volume discretization has been applied to the piecewise linear mbbt model and the resulting solver has been demonstrated to capture large deflection geometric and kinematic nonlinearities and coupling inertial effects the piecewise linear mbbt solver is used in this work to compute the nonlinear blade model 2 2 momentum based multibody theory the mcm is based on applying the conservation of momentum directly to a multi rigid body system and makes use of prescribed motion between each contiguous body to simplify the eom s sweetman and wang 2014 the absolute translation of the center of mass of the system and the rotation of a base body within the system are chosen as reference coordinates the relative rotations between the base body and contiguous bodies along the kinematic chain within the system are chosen to be relative coordinates the effects of which are captured as a series of cascading transformation matrices the final result is that the motion of an n body system can be conveniently represented using six only eom s that are updated at each time step for the evolving configuration of the system the solutions to three coupled rotational eom s are euler angles describing the rotation of the base body the solutions to three coupled translational eom s are the translation of the system measured at its center of mass which are then transferred into translation of the base body inverse dynamic analysis can be used to obtain internal forcing between any two contiguous bodies the advantage of the mcm is that only six degrees of freedom appear in the eom s regardless of multibody system complexity an in house multibody code has been developed using the mcm which has previously been applied to several multi rigid body models of fowt wang and sweetman 2012 2013 sweetman and wang 2014 and now is coupled with the mbbt based blade solvers as part of the present work 3 nonlinear dynamic coupling 3 1 dynamics of fowt systems the time domain simulation method proposed here accurately models complicated dynamic effects of a fowt system aerodynamic loads are computed for the instantaneous wind velocity and angle of attack relative to each of numerous blade elements such that aeroelastic effects are included turbine control is employed to actively adjust the pitch angle of the blades which directly impacts wind forcing on the turbine hydrodynamic effects are included by computing the hydrodynamic forces using morison s equation with strip theory and linear wave theory in which the instantaneous fluid velocity and acceleration relative to each of the moving spar segments are used nonlinear multibody dynamics are included using the mcm in which the euler angle formulation is used to represent the instantaneous configuration and exact kinematics of the multibody system nonlinear blade dynamics are included using the geometrically exact mbbt model geometric and kinematic nonlinearities are shown to be important for accurate modeling of fowt blades while it is reasonable to neglect constitutive and damping nonlinearities such that linear elastic material and rayleigh damping are adopted geometric nonlinearities result from nonlinear beam strains and induce the axial foreshortening effect which leads to significant geometric stiffening for the whirling blades because of centrifugal forces acting in blade axial direction kinematic nonlinearities result from nonlinear inertial terms in the beam theory which induces significant nonlinear inertial loads to the blades subject to turbine rotation and platform motions gyroscopic effects of the whirling blades are captured implicitly through dynamic coupling between the flexible blades and the multibody system with the gyroscopic moments resulting from summing the inertial effects of the elements of each blade in a moving reference frame 3 2 multi time scale coupling a multi time scale dynamic coupling scheme between rigid and flexible bodies is developed to enable fully coupled simulation of fowt systems flexible blades are modeled as cantilever beams and the resulting forces and moments at the roots of the blades are applied to a three rigid body system that represents the hub nacelle and tower spar motions of the three rigid body system are computed using external loads including gravity hydrostatic and hydrodynamic loads on the floater loads from the mooring lines and resultant loads from the blade roots acting on the rotating hub the overall rigid body motion of each blade is represented by a non inertial moving frame attached to the root of each blade which moves and rotates with the hub blade dynamics are computed using external loads and inertial forcing external loads include gravity and aerodynamic loads inertial forcing caused by the overall rigid body motion of blades such as centrifugal and coriolis forces are included as inertial terms in mbbt the proposed framework of the fully coupled fowt analysis is shown in fig 2 the turbsim code from nrel jonkman and kilcher 2012 is used to generate irregular winds which simulates wind fields and time histories from power spectra based on linear turbulence models gaussian process the aerodyn module from the fast package jonkman and jonkman 2013 is used to compute aerodynamic loads on each blade element based on the bem theory the piecewise linear mbbt solver is used to compute nonlinear blade dynamics of each blade modeled as a cantilever beam while the linearized mbbt is applied to compute the linear blade model for comparison a hub rotation module that represents the turbine drivetrain is developed to compute shaft torque power output and instantaneous hub spin the discon control routine from the fast package is adopted to regulate turbine operation which includes both shaft torque control at low wind speeds and blade pitch control at higher winds a hydrodynamic solver is developed to compute fluid kinematics for an irregular sea state using linear wave theory and then to compute hydrodynamic loads relative to the moving spar using morison s equation a hydrostatic solver is developed to compute the buoyancy force and the location of the center of buoyancy using the instantaneous position of the platform including changes to the water plane and to the submerged portion due to platform motions a mooring module is developed to compute restoring forces and moments from the mooring lines using the instantaneous relative position between the attachment and the anchor points and each mooring line is assumed to be a massless linear spring in which the effects of line dynamics and sag of the line are neglected the mcm multibody solver is coupled in this multi time scale framework to compute large angle displacements and relative motion within the three rigid body system of hub nacelle and tower spar the multi time scale coupling scheme is shown in fig 2 application of two different time step sizes substantially enhances computational efficiency because the rate at which the blade samples the irregular wind field and the blade vibrations have much higher frequencies than global platform motions aerodynamics and dynamics of the blades and hub rotations are computed using a smaller time step size δ t the multibody system and the turbine control response are computed using a larger time step size δ t responses of the flexible blades and the multibody system are exchanged between larger time steps in a weakly coupled manner deflections of each blade in response to external loads and motions of each non inertial reference frame are computed using multiple smaller time steps between two larger time steps the resulting blade root forces and moments are averaged over the larger time step and applied to the averaged root positions in the multibody system as external loads the tower position velocities and accelerations are computed at each of the larger time steps and assumed to be constant between these larger time steps hub rotations are computed using the smaller time steps to enable the blades to adequately sample the wind field 4 numerical simulations 4 1 system configurations all simulation examples model the 5 mw reference wind turbine from nrel jonkman et al 2009 the cut in rated and cut out wind speeds of the turbine are 3 m s 11 4 m s and 25 m s respectively and the rated rotor speed is 12 1 revolutions per minute rpm coupled dynamics of fowts especially for highly compliant designs are investigated through comparison between the responses of the original 120 m draft oc3 hywind spar design jonkman 2010 and a compliant 74 m draft truncated design gao and sweetman 2018 table 1 presents the properties of these two fowt platforms the mooring system is modified from the original three catenary lines to a four taut leg 90 apart mooring system to be compatible with both spar designs the mooring lines are anchored 800 m away from the spar with depth of 320 m and are attached to the spar at the center of mass of the complete fowt system fig 3 the mooring lines are assumed to have axial stiffness of 384 243 kn per unit strain 4 2 environmental conditions four load cases are simulated in this study the first three load cases represent typical operating conditions which conform to industry standard design load case dlc 1 2 in iec 61400 3 iec 2009 irregular wind fields are numerically simulated using the normal turbulence model for the first three load cases the mean wind speeds at the 90 m hub height are 7 m s 11 m s and 15 m s respectively a fully arisen pierson moskowitz pm sea state is assumed resulting irregular waves with significant wave heights of 0 66 m 1 62 m and 3 01 m and peak period of 4 03 s 6 43 s and 8 63 s for the 7 m s 11 m s and 15 m s winds respectively the fourth load case represents an extreme operating condition which conforms to dlc 1 6a in iec 61400 3 the irregular wind field has a mean wind speed of 25 m s at the hub height which is the cut off wind speed the turbine remains operating in simulations without brake to test system survivability in such extreme condition an extreme irregular wave process representing the 50 year extreme in the western region of the gulf of mexico is selected as per industry standard api 2int met the significant wave height is 11 3 m and the peak period is 14 4 s irregular waves in each of the load cases are generated using the random phase angle method one thousand regular harmonic functions are combined to approximate the sea surface each of which has a fixed amplitude computed from the corresponding pm spectrum and has a random phase angle incoming directions of winds and waves are assumed to be aligned and constant in all load cases such that yaw control of the wind turbine is deactivated in simulations twelve simulation cases are shown in table 2 including the reference cases in which the tower is fixed at an upright position and not subject to wave loading the fowt configurations with the standard 120 m spar and the highly compliant 74 m spar are each simulated subject to the typical and extreme operating conditions the platform and blades have zero initial displacements and initial turbine rotation speeds are 8 47 rpm 11 9 rpm 12 1 rpm and 12 1 rpm for the 7 m s 11 m s 15 m s and 25 m s winds respectively the simulation cases in sections 5 2 and 5 3 are computed in time domain for 3660 s the transient responses of the first minute are discarded and the results of the last one hour are used for fatigue and frequency domain analyses conforming to the simulation requirements from section 7 5 4 in iec 61400 3 4 3 validation tests the new modeling method that couples mbbt and the mcm is verified by benchmarking against the widely recognized fast package version 8 only the fowt with the stiff 120 m spar is benchmarked because of the small angle assumptions implicit to fast each blade is discretized into 23 elements in the mbbt blade model each blade in fast beamdyn is represented by single fifth order legendre spectral finite element the first and second validation tests are performed respectively to verify the computation of hydrodynamics and the mooring system and the computation of aerodynamics and the drivetrain a regular wave with wave height of 1 0 m and period of 5 0 s is applied to the fowt in which turbine rotation and aerodynamic loads are neglected figs 4 and 5 show the platform and blade responses computed by fast and the new mbbt mcm coupled model the test results show good agreement despite the fact that fast includes tower flexibility and mooring line dynamics and computes hydrodynamic loads based on potential flow theory a constant 9 m s wind is applied at the 90 m hub height with a logarithmic wind shear profile to simulate the startup of the fowt from zero turbine rotation and zero floater displacements in calm seas figs 6 and 7 show that the platform and turbine responses are in good agreement the two solvers predict sightly different turbine rotation during the startup transit stage such that a constant phases difference in blade responses remains because the blades have a constant difference in azimuth angle after reaching the steady state convergence tests are also performed to verify each of the two time step sizes used in flexible blade dynamics and multibody system dynamics results computed using δ t 0 02 s for the mcm solver and δ t 0 005 s for the mbbt solver are nearly identical to those computed using 0 003 s for both solvers figs 4 7 therefore the time step sizes are set to be 0 02 s and 0 005 s for all the following simulations the last validation test is to model the fowt subject to irregular waves and winds simulation case 120 m typical ii is applied and the resulting platform and turbine responses are presented in figs 8 and 9 the results from fast and the mbbt mcm coupled model match well the mbbt mcm model predicts stronger gyroscopic coupling which leads to slightly greater platform response in roll and sway 4 4 fatigue post processing accumulated fatigue damage of the blades are computed using the normal strain method cross sectional deformations are assumed to be small in the mbbt model such that the plane cross section assumption is used here for reconstruction of normal strain measures on cross sections from the blade model response normal strain ϵ a a at a point on a blade cross section is computed as 8 ϵ a a d b d c m b e i b b d c m c e i c c d b n e a in which d b and d c are the coordinates of a point measured in the deformed local coordinate d fig 10 m b m c and n are cross sectional bending moments and axial force computed by the blade solver and e i b b e i c c and e a are cross sectional bending stiffnesses and axial stiffness the number of strain reversals for different strain amplitudes and mean strains are calculated using the rainflow analysis the resulting accumulated fatigue damage at a point is then evaluated using miner s rule 9 d t i j n i j t n i j in which n i j t is the number of cycles having the i th strain amplitude and the j th mean strain in a time history of t seconds and n i j is the number of cycles to failure subject to the i th strain amplitude and the j th mean strain the accumulated damage over t seconds is converted to 1 year equivalent damage by assuming the turbine is subject to the same simulation conditions continuously for one year such that d 1 y e a r d t t 60 24 365 and the resulting fatigue life in years is equal to 1 d 1 y e a r the material properties of the nrel 5 mw turbine blades are not available only the structural and aerodynamic properties are provided in open literature fossum et al 2013 apply a glass fiber material named s1 to the blade shell in fatigue study the same material s1 is selected in this work as the shell material of the 5 mw turbine blades for fatigue analysis fig 11 shows the constant life diagram of this material including the data for three values of r which is the normal strain ratio r ϵ a a m i n ϵ a a m a x the number of cycles to failure n i j for each strain amplitude and mean strain combination is obtained from the constant life diagram the partial material safety factor of 1 45 and the consequence of failure factor of 1 15 are considered in fatigue computation according to industry standard dnv ds j102 time histories of normal strain are computed for 80 points on the edge around each blade cross section see fig 10 for example and total 23 cross sections along the blade are included table 3 such that 1840 strain histories of one blade are analyzed for each simulation case 5 results and discussion 5 1 nonlinear blade dynamics a series of cases are established specially to investigate nonlinear blade effects on turbine performance blade response and blade fatigue by comparing the results between the linear and nonlinear blade models the tower is fully restrained from motion and deformation in these cases and a steady wind with a logarithmic shear profile is applied table 4 shows the power output rotation speed shaft torque total wind thrust and blade pitch angle of the turbine for various wind speeds the linear blade model overestimates turbine performance when wind speed is below the rated speed and its pitch is set to greater angles by the pitch controller at wind speeds higher than 11 m s which leads to considerable underestimation of turbine wind thrust table 5 presents the steady mean displacements at the tip of individual blade and the largest 1 year equivalent fatigue damage with the corresponding location the linear blade model significantly overestimates blade deflection and fatigue damage at all tested wind speeds turbine performance is overestimated by the linear model because the foreshortening effect is neglected foreshortening is a nonlinear geometric effect that effectively reduces the swept area and therefore power output of a turbine the blade tip moves towards the hub when a blade deflects in bending like the blade is shortened blade deflection and fatigue damage are overestimated by the linear model because the foreshortening and geometric stiffening effects are neglected foreshortening reduces aerodynamic loads onto the blades and results in geometric stiffening under centrifugal force the inward displacement due to bending deflection is counteracted by the outward centrifugal force effectively stiffening the blades erroneous locations of fatigue hotspots are also predicted by the linear blade model the largest wind thrust blade deflection and fatigue damage occur at the rated wind speed because the blades are subject to the greatest aerodynamic loads when the turbine reaches to its design optimum blade pitch control is activated and turbine performance is regulated when wind speed is higher than the rated speed reducing wind thrust blade deflection and fatigue damage the results of this comparison show that nonlinear blade dynamics must be considered to assess turbine performance blade response and blade fatigue even for a static support structure in benign operating conditions the relative effect of nonlinear blade dynamics on overall platform response is further assessed using the realistic operating conditions established in section 4 2 three cases from table 2 120 m typical i ii and iii are simulated using both linear and nonlinear blade models when the wind speed is below the rated speed and blade pitch control is not activated 120 m typical i the linear results over predict turbine power output but differences in platform dynamic response are found to be small fig 12 as would be expected because the wind thrust is nearly equal table 4 effects of nonlinear blade dynamics on overall fowt response are found to be important for turbines operating around the rated wind speed 120 m typical ii fig 13 demonstrates that inappropriate use of a linear blade model can lead to noticeable error in global platform motions the difference in platform pitch results from the controller setting different blade pitch angles causing varying wind thrust as the control is switched on and off when the wind speed is much higher than the rated speed 120 m typical iii differences in platform motions are found to be small fig 14 because pitch angles assigned to both linear and nonlinear blades are nearly equivalent the results of this comparison suggest that the design of the blade pitch control algorithm used in a numerical model should ideally be customized for use with either a linear or nonlinear blade model and the use of an accurate nonlinear blade model is critical to proper design of blade pitch control algorithm the piecewise linear mbbt blade solver is used exclusively throughout the remainder of this paper to accurately model nonlinear blade effects 5 2 highly compliant fowt the feasibility of the highly compliant fowt design with a 74 m spar is demonstrated through a series of simulation cases including typical and extreme operating conditions the simulation results indicate that the 74 m spar fowt design survives the extreme condition and operates effectively in the typical conditions fig 15 shows the compliant design has much greater pitch motion but only slightly less power output in the typical i load case in which the mean wind speed is 7 m s the shorter more compliant 74 m spar has lower hydrodynamic stiffness in pitch and roll but identical stiffness in yaw such that larger pitch and roll motion but similar yaw motion are observed blade pitch control is not activated in this range of low wind speed and power output from the highly compliant design is slightly lower because the larger platform pitch results in a smaller projection of the swept area perpendicular to the air flow the mean pitch angles are 6 9 4 and 2 2 6 for 74 m and 120 m spars respectively and the corresponding means of power output are 1 38 mw and 1 45 mw figs 16 and 17 show simulation results for cases typical ii and typical iii in which blade pitch control is activated only the pitch and roll motions are presented yaw motion is very similar between the two spars the highly compliant design has larger platform pitch and roll motion and similar power output fig 18 presents the results from the simulation cases of 74 m extreme and 120 m extreme in which the fowts operate around the cut off wind speed of 25 m s in an extreme sea state the platform pitch angles computed for the extreme condition are smaller than that in the typical conditions which conforms to the test results in table 4 the blade pitch angle increases with wind speed after the pitch control is activated reducing wind thrust onto the fowt and therefore the platform pitch blade fatigue is also investigated for the highly compliant platform design table 6 summarizes the maximum 1 year equivalent fatigue damages and their corresponding locations computed for the two fowt designs and for a static fixed tower blade fatigue damage generally increases with increasing wind speed and wave height for all the three support structures dramatic increases in blade fatigue damage are observed in the extreme condition this extreme condition is at the operation limit above which the turbine would normally be parked the blade pitch controller assigns very large pitch angle to the blades to regulate the turbine in such extreme condition fig 18 vs figs 16 and 17 resulting in different dynamic response of the blades figs 19 and 20 respectively show the hotspots of blade fatigue and the range of flapwise deflection for various simulation cases the location of maximum fatigue damage is on the pressure side near the blade root for the typical operating conditions where there is a large mean tension associated with global blade bending however both the suction and pressure sides of the blade are exposed to compression tension cycles for the extreme cases in which the location of maximum damage moves closer to the blade tip on the suction side the highly compliant 74 m spar surprisingly shows less blade fatigue damage than its stiffer counterparts when subject to mild sea states and relatively low wind speeds typical i and ii conditions the maximum load on the blades during sudden wind gusts is reduced because the tower motion partially absorb dynamic impacts of the wind however the two spars show worse blade fatigue damage than the fixed tower when subject to wild sea states and higher winds typical iii and extreme conditions large tower motions introduce significant inertial loading onto the blades resulting in larger blade deflection fig 20 and worse fatigue damage table 6 these fatigue results suggest an opportunity to improve blade fatigue performance by optimizing the combined stiffness of the blades and platform in the design process the results also demonstrate the close relationship between blade vibrations and platform motions 5 3 coupled dynamics of fowt coupled dynamics of fowt systems are investigated using a spectral analysis of platform motions combined with a svd analysis of blade vibrations svd is a method commonly used to decompose discrete numerical dynamic displacements into proper orthogonal modes poms the resulting poms are mathematically orthogonal mode shapes that optimally represent the dynamic displacements along the blade a ratio is computed between the singular value associated with each pom and the sum of all singular values this ratio indicates the importance of each pom as a percentage of the total response poms differ from conventional eigenmodes in that they are not solely dependent on structure properties but also include load effects such that they are more suitable for nonlinear dynamic analysis under complex loading the peak frequencies are identified in the power spectral densities psds of platform pitch and of the first two poms of blade displacements figs 21 and 22 these psds are computed from time histories extracted from the simulation cases of 74 m typical iii 74 m extreme 120 m typical iii and 120 m extreme the pitch natural frequencies of the 74 m and 120 m spars are computed to be 0 022 hz and 0 031 hz respectively and the incoming wave peak frequencies are 0 116 hz and 0 069 hz in the typical iii and extreme conditions respectively energy peaks at these frequencies are clearly observed on the psd plots of platform pitch figs 21 and 22 the first pom of blade vibration is dominated by flapwise bending while the second pom is dominated by edgewise bending the sum of the first two poms accounts for 96 of the total blade displacements in the typical iii condition and 87 in the extreme condition gravity is the dominant periodic loading on the blades and appears as an energy peak at turbine rotation frequency of about 0 2 hz on the psds of blade poms in which turbine speed is regulated to 12 1 rpm significant amount of energy is also observed at the wave peak frequencies and at the platform natural frequencies on the psd plots of blade poms implying a strong one way dynamic coupling from platform motions to blade vibrations fig 23 shows a significant coupling between platform yaw motion and blade revolution energy peaks at blade revolution frequencies 3 9 rpm 0 45 hz for case typical i and 3 12 rpm 0 6 hz for cases typical ii and iii are found to be caused by the imbalance of aerodynamic loading associated with axi asymmetric deflection of the three blades four special cases are simulated to investigate the origins of imbalanced aerodynamic loading aerodynamic yaw moments applied on the top of a vertically fixed tower are compared for the 5 mw wind turbine subject to four different conditions a 13 m s constant uniform wind without turbine tilt and without gravity b 13 m s constant uniform wind without turbine tilt but with gravity c 13 m s constant uniform wind with 10 turbine tilt but without gravity and d 13 m s constant wind including wind shear without turbine tilt and without gravity table 7 shows the mean standard deviation and peak frequency of the aerodynamic yaw moment computed in each of the four cases the results for case a show that the yaw moment remains zero once steady state is reached the major blade deflection in this gravity free case is flapwise bending induced by aerodynamic thrust blades deflection is the same for each of the three blades in absence of turbine tilt wind shear and gravity such that the turbine remains axi symmetric about the spin axis and the aerodynamic forces are balanced by the three blades the only difference between cases a and b is the inclusion of gravitational acceleration individual blades deflect under their own weight causing the turbine to be axi asymmetric about the spin axis within the rotating plane the sum of aerodynamic forces of the three blades results in the 345 6 kn m mean yaw moment shown for case b case c is intended to investigate the effect of turbine tilt in absence of gravity the only difference between cases a and c is that the turbine is tilted up by 10 from the vertical the source of the 910 3 kn m mean yaw moment shown for case c is the changing angle of attack of each blade element as the blade sweeps over the tilted rotating plane case d is intended to investigate the effect of wind shear on imbalanced aerodynamic loading the wind velocity is higher at the top on the rotating plane such that the incoming wind velocity and the angle of attack vary as the blade progresses through the swept area the relatively high standard deviation for case d results from the uneven number of blades precluding an effective moment balance across the rotor hub the results of these four cases suggest that the imbalance of aerodynamic loading is common because axi asymmetric response of the blades can be induced by many factors and imbalanced aerodynamic loading generally increases with turbine size imbalanced aerodynamic loading also appears in other directions but the effects on pitch and roll of a spar platform show much less than that on yaw motion because the stiffness and damping are both much higher in pitch and roll 6 conclusions nonlinear effects and dynamic coupling of fowt systems including a highly compliant design are assessed using a multi time scale dynamic coupling method that combines mbbt and the mcm the mbbt mcm coupled model allows for large displacement angles and the resulting nonlinearities the combined multibody and flexible beam analysis method has been shown to effectively capture nonlinear blade dynamics and various dynamic coupling behaviors of fowt systems twelve realistic cases are simulated for typical and extreme operating conditions and two sets of idealistic cases are simulated for investigation of nonlinear blade effects and imbalanced aerodynamic loading significant findings are presented below 1 nonlinear blade dynamics have been demonstrated to be important for estimations of turbine performance and blade fatigue and should be considered in the design of blade pitch control algorithm linear blade model has been shown to overestimate power output by 5 8 for wind speeds lower than the rated speed and to dramatically over predict blade fatigue damage by 1 2 times 2 a highly compliant fowt design with a 74 m draft spar has been demonstrated to be feasible in both typical and extreme operating conditions and its blade fatigue damage has been found to be comparable with the original 120 m draft design blade fatigue analysis has shown that increasing support structure compliance can potentially mitigate blade fatigue damage but excessively large platform oscillations adversely affect blade fatigue life 3 imbalanced aerodynamic loading has been demonstrated to be induced by axi asymmetric blade responses associated with gravity turbine tilt and wind shear imbalanced aerodynamic loading has found to be synchronized with blade revolution and the resulting platform yaw motion has been observed 4 one way coupling from platform motions to blade vibrations through inertial effects has been demonstrated blade vibrations hardly affect platform motions because of the huge differences in mass and in natural frequency credit authorship contribution statement shanran tang methodology software validation formal analysis investigation writing original draft bert sweetman conceptualization resources supervision writing review editing ju gao software formal analysis investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20797,wind generated waves are often treated as stochastic processes there is particular interest in their spectral density functions which are often expressed in some parametric form such spectral density functions are used as inputs when modelling structural response or other engineering concerns therefore accurate and precise recovery of the parameters of such a form from observed wave records is important current techniques are known to struggle with recovering certain parameters especially the peak enhancement factor and spectral tail decay we introduce an approach from the statistical literature known as the de biased whittle likelihood and address some practical concerns regarding its implementation in the context of wind generated waves we demonstrate through numerical simulation that the de biased whittle likelihood outperforms current techniques such as least squares fitting both in terms of accuracy and precision of the recovered parameters we also provide a method for estimating the uncertainty of parameter estimates we perform an example analysis on a data set recorded off the coast of new zealand to illustrate some of the extra practical concerns that arise when estimating the parameters of spectra from observed data keywords wave spectrum parameter estimation jonswap spectral likelihood de biased whittle likelihood parameter uncertainty 1 introduction due to the random nature of wind generated gravity waves it is common to treat them as stochastic processes there is particular interest in the spectral density function of such wave processes for this reason it is important that we are able to construct good spectral density estimators using such an estimator estimates of the spectral density function can be obtained from observed wave records broadly speaking there are two approaches for obtaining such an estimator non parametric and parametric the most basic non parametric spectral density estimator is the periodogram the fourier transform of the sample autocovariance however the periodogram is a noisy estimator therefore many less noisy estimators such as that of bartlett 1948 have been developed the second approach is to use a parametric spectral density estimator here we assume that the spectral density function follows a parametric form meaning that the inference task becomes estimation of the parameters of this form in general parametric estimators are often preferable because they result in smoother estimates and more concise representations of the spectral density function and the parameters themselves provide physical interpretation of the nature of the wave process many such parametric forms have been developed in the oceanography literature phillips 1958 gave theoretical arguments for the tail behaviour of the spectral density function for wind generated wave processes based on this pierson and moskowitz 1964 established a parametric form that characterised the spectral density function of a fully developed sea describing both the spectral tail and peak behaviour this was later extended by hasselmann et al 1973 so that the parametric form could encompass a wider variety of spectral density functions including those associated with fetch limited wave processes this widely used parametric form is usually known as the jonswap spectral form it should be noted that we use jonswap to refer to the original formulation given by hasselmann et al 1973 with a tail decay of ω 5 where ω denotes angular frequency despite general acceptance of the jonswap spectral form amongst practitioners there is debate concerning the values of the tail decay index and peak enhancement factor arguments for an ω 5 tail decay made by phillips 1958 were called into question by toba 1973 and later by phillips 1985 who argued that an ω 4 tail had a stronger theoretical basis experimental work such as hasselmann et al 1973 and battjes et al 1987 found evidence for both ω 4 and ω 5 tail decays while hwang et al 2017 could not find evidence for either further suggesting that the tail decay index should be treated as a free parameter in addition there is a large literature speculating on other tail behaviours such as the occurrence of a transition frequency from ω 4 to ω 5 forristall 1981 ewans and kibblewhite 1986 babanin 2010 for example it is also common to fix the peak enhancement factor to 3 3 however there is little evidence for using precisely this value in this work we adopt a more general version of the jonswap spectral form which treats both the tail decay index and peak enhancement factor as free parameters though our methods also apply to the special cases mentioned in terms of estimating the remaining parameters of interest 1 1 to avoid potential confusion it should be noted that we are interested in estimating the parameters of assumed parametric forms for the spectral density function such as the generalised jonswap and not spectral parameters of a sea state such as significant wave height h s many authors rodríguez and soares 1999 ewans and mcconochie 2018 for example have found that both the tail decay index and peak enhancement factor are hard to estimate accurately using current techniques however both of these parameters are important for determining the properties of a given sea state our contention is that current techniques are not sufficiently accurate or precise to allow strong statements to be made concerning the true values of the tail decay index or peak enhancement factor from typical data sets indeed in section 5 we demonstrate with simulated half hour records that estimates for the tail decay using current estimation techniques range from ω 3 to ω 6 when the true tail decay is known to be ω 4 because there is too much variability in the estimates it is impossible to determine from data of such lengths if the true tail decay is ω 4 or ω 5 in this work we present an alternative technique that is capable of obtaining these parameters more accurately and precisely and show in simulated data that this technique can distinguish ω 4 and ω 5 tail decays even from short records the standard approach for estimating parameters of a stochastic model from data is by using maximum likelihood inference when an analytical form for the likelihood function is known such parameters can be optimally estimated using maximum likelihood pawitan 2001 however in the case of wind generated wave processes the exact probability distribution is unknown though it is possible to make the simplifying assumption that the wave process is gaussian for many sea states this assumption will not be reasonable for this reason it has become common for oceanographers to use a non parametric estimator of the spectral density function and obtain parameters by fitting a parametric form in the least squares sense however such least squares estimators will in general be sub optimal when compared to full maximum likelihood constable 1988 we therefore turn to frequency domain likelihoods which are widely used in both time series analysis and spatial statistics nordman and lahiri 2006 fuentes 2007 for example the canonical approach is to use an approximation to maximum likelihood known as the whittle likelihood whittle 1953 the whittle likelihood can be computed quickly using fast fourier transforms and does not require gaussianity dzhaparidze and yaglom 1983 however the whittle likelihood has been shown to produce biased estimates for small sample sizes dahlhaus 1988 velasco and robinson 2000 sykulski et al 2019 developed a de biased version of the whittle likelihood that corrects for this bias without sacrificing the computational speed or making extra distributional assumptions in section 3 4 we will provide some intuition as to why we would expect the de biased whittle likelihood to perform better than least squares both in terms of accuracy bias and precision variance then in section 5 we evidence this claim using numerical simulations the contributions of this paper are as follows firstly we introduce the de biased whittle likelihood estimator for use on wind generated wave processes section 3 secondly we detail practical concerns regarding the implementation of the estimation procedure for wind generated ocean wave processes section 4 with accompanying matlab code provided on github grainger 2021 this includes an important generalisation of the sykulski et al 2019 procedure to allow parameters to be fitted directly to the proposed spectral form without having to posit an analytical form for the time domain theoretical autocovariance sequence as required in sykulski et al 2019 but unavailable for ocean wave spectral forms thirdly we present a novel reformulation of the variance of the de biased whittle likelihood estimator which can be used to quantify the uncertainty of parameter estimates section 6 finally we perform a detailed simulation and field data study comparing the performance of different parametric spectral density estimators for wind generated wave processes sections 5 and 7 2 background so far we have used the word wave loosely to describe the shifting nature of the sea surface in truth we are actually interested in modelling the displacement of the sea surface from the resting surface of course in reality this is a 3 dimensional phenomena but in this paper we shall consider the vertical displacement of the surface over time at a specific location in space we can think of the displacement at a given time as being a random variable with some distribution therefore we can describe the displacement over time by a stochastic process an indexed family of random variables which we shall denote x x t t r note that this is a family of random variables indexed over continuous time as the actual physical process is constantly changing however since we cannot actually record data continuously in time we must instead settle for recording the process at discrete points in time we assume that the data are being sampled regularly and denote the sampling interval δ and the process that arises from sampling x every δ seconds we shall call x δ x t δ t z for the duration of a given record observations of the sea surface are usually assumed to be from an underlying process x that is second order stationary this means x satisfies all of the following conditions 1 e x t e x 0 2 e x t 2 3 e x t x s e x t s x 0 for all t s r however the sea surface is not actually stationary it evolves over time one way to circumvent this is to notice that whilst the conditions at sea do evolve over time they do so relatively slowly if we sample frequently therefore we treat the sea surface as being stationary over short time intervals sometimes known as sea states this is essentially the same approach as locally stationary modelling in time series analysis dahlhaus 2012 ideally we would make this sea state as short as possible however we must balance this with another fundamental statement the more observations we have the more confident we can be in our inferences the question of the correct time interval to use will not be covered here though it is useful to keep in mind that improving the precision of parameter estimates will mean that we could use shorter sea states in our analysis this would allow us to track the evolution of certain meteorological processes such as tropical cyclones at a higher precision and resolution to summarise the underlying wind generated wave process is not second order stationary however for short enough time windows this is a widely used working assumption that allows some inference to be made about the process in question the analysis of second order stationary stochastic processes usually involves two important characteristics the autocovariance and the spectral density function the autocovariance of a process at a given lag τ is just the covariance of a process with itself τ time steps later more formally the autocovariance is c τ e x τ x 0 e x τ e x 0 for our purposes we assume that e x t 0 for all t r noting that if this is not the case then by first removing the mean of the data we can obtain a process with the desired property therefore the autocovariance simplifies to c τ e x τ x 0 the spectral density function is a frequency domain analogue of the autocovariance which for the stochastic processes x and x δ we shall denote f ω and f δ ω respectively a formal construction of the spectral density function can be found in for example brockwell and davis 2006 page 118 for the discrete time process or doob 1953 page 522 for the continuous time process however for our purposes it suffices to note the following relations firstly for the discrete time process 1 f δ ω δ 2 π τ c τ δ exp i ω τ δ for ω π δ π δ where π δ is the nyquist frequency and is the highest observable frequency of the sampled process secondly for the continuous time process 2 f ω 1 2 π c τ exp i ω τ d τ for almost every ω r i e equal except on a set of measure zero 2 2 note that we are working with angular frequency here and for all examples in this paper this is measured in units of rad s 1 similarly the inverse relations are 3 c τ δ π δ π δ f δ ω exp i ω τ δ d ω for τ z and 4 c τ f ω exp i ω τ d ω for τ r the spectral density of the discrete time process f δ ω can be thought of as an aliased version of the continuous time spectral density function f ω more formally we have the following relation 5 f δ ω k f ω 2 π k δ for ω π δ π δ percival and walden 1993 chapter 4 in section 5 we demonstrate that aliasing can cause bias in parameter estimation which is why it is important to define both f ω and f δ ω and understand their relationship 2 1 non parametric spectral density estimators though our purpose is the analysis of parametric spectral density estimators it is also pertinent to define some of the non parametric spectral density estimators that are used throughout this paper there are two important properties that should be considered when choosing an estimator the first of these is bias which is the expectation of the estimator minus the true value ideally we would want to choose an estimator that is unbiased i e has a bias of zero this is often not possible but the weaker condition of asymptotically unbiased is often achievable an estimator is said to be asymptotically unbiased if as the number of observations increases the bias tends to zero the second important property is consistency for an estimator to be consistent it must converge in probability to the true parameter as the number of observations tends to infinity more formally denote the true parameter by θ 0 and an estimator from a series of n observations by θ ˆ n then θ ˆ n is a consistent estimator if for all ϵ 0 p θ ˆ n θ 0 ϵ 0 as n the most basic non parametric estimator for the spectral density function of a discrete time process is the periodogram let x δ n x 0 x δ x δ n 1 be a series of n consecutive random variables from x δ then the periodogram is defined as i ω δ 2 π n t 0 n 1 x δ t exp i t δ ω 2 for ω r in practice the periodogram is typically only evaluated at the fourier frequencies ω 2 π j δ n using the fft procedure where j n 2 1 n 2 for convenience we shall write ω n δ for the set of these frequencies it should also be noted that the periodogram is an estimator for the spectral density of the discrete time process f δ ω not the spectral density of the continuous time process f ω the periodogram can be shown to be an asymptotically unbiased estimator for f δ ω but the periodogram is not consistent for this reason modified versions of the periodogram which are consistent are usually used as an alternative to the periodogram one such modified periodogram suggested by welch 1967 splits the series into smaller segments applies a window calculates the periodogram of each segment and then averages these modified periodograms at each frequency in practice welch s method results in an estimate that is less noisy than a standard periodogram but has lost resolution in frequency and may be more biased a subset of such methods is known as bartlett s method bartlett 1948 this approach uses non overlapping segments with no window function in other words bartlett s estimator is 6 i b ω δ 2 π p l p 1 p t p 1 l 1 p l x δ t exp i t δ ω 2 where p is the number of segments and l is the number of observations in each segment with p l n 2 2 models for the sea surface when describing the sea surface models are often expressed in terms of the spectral density function many different spectral density functions have been developed for ocean waves perhaps most notably the jonswap spectra developed by hasselmann et al 1973 we shall consider a more general model which encompasses many of the other waves models that have been developed following mackay 2016 we use the following parameterisation 7 s g ω θ α ω r exp r s ω ω p s γ δ ω θ where δ ω θ exp 1 2 σ ω θ 2 ω ω p 1 2 and σ ω θ σ 1 for ω ω p σ 2 for ω ω p for ω 0 where α ω p s 0 γ 1 r 1 3 3 mackay 2016 gives the condition that r 0 however for the spectral density to be integrable such that the stochastic process has finite variance we require that r 1 and θ denotes the vector of parameters typically and for the remainder of this paper σ 1 σ 2 and s are set to 0 07 0 09 and 4 respectively mackay 2016 in this case the parameter vector is θ α ω p γ r also let θ denote the parameter space the set of possible values that θ can take then for this general model the parameter space is θ 0 0 1 1 r 4 note that 7 is a one sided spectral density and is not defined at ω 0 we shall work with the two sided version as this fits in with the way we have defined the spectral density function the way techniques are described in the statistical literature and the way fast fourier transforms are implemented on a computer therefore we define f g r θ 0 8 f g ω θ s g ω θ 2 for ω 0 0 for ω 0 s g ω θ 2 for ω 0 we shall refer to the function defined by 8 as the generalised jonswap spectral form in this formulation α is measured in units of m 2 s 1 r rad r 1 ω p in rad s 1 and γ and r are dimensionless for convenience we omit the units in future references 3 fitting parametric spectral density functions the process of fitting a parametric spectral density function to observations can be thought of as estimating the parameters of a statistical model which we denote θ the techniques discussed in this section are applicable to a broad class of spectral density functions as such we consider the general case and shall write f ω θ for the spectral density function of the continuous time process given some choice of parameters θ we shall also write f δ ω θ and c τ θ for the spectral density function of the discrete time process and the autocovariance function respectively for convenience we shall sometimes refer to the spectral density function of the continuous time process as the spectral density function and the spectral density function of the discrete time process as the aliased spectral density function we also write σ θ for the covariance matrix of the multivariate random variable corresponding to n consecutive random variables from x δ we now describe each of the fitting methods discussed in this paper 3 1 least squares current approaches to estimating parameters of spectral density functions used in the ocean waves literature such as the approaches described by ewans and mcconochie 2018 usually involves two key steps firstly a non parametric estimator of the spectral density function is constructed secondly a curve fitting algorithm is used so that the corresponding parametric form is a good fit for the observed data typically this involves minimising the square distance between the parametric form and non parametric spectral density estimator as such we shall refer to such approaches as least squares fitting techniques for the purpose of this section we let i ω denote a general non parametric spectral density estimator this could be the periodogram i ω bartlett estimator i b ω or some other non parametric spectral density estimator the second part of this fitting routine involves fitting the parametric form to the obtained non parametric estimator typically this is done by minimising the euclidean distance between the non parametric estimator and the parametric spectral density function we therefore must minimise the objective function given by 9 ℓ l s θ x δ n ω ω f ω θ i ω 2 where ω ω n δ the choice of ω is discussed in section 4 1 in other words the least squares estimator for θ is defined as θ ˆ l s argmin θ θ ℓ l s θ x δ n this approach could be adapted to account for aliasing by replacing f ω θ with f δ ω θ the aliased spectral density function however such a modified approach is not currently used in the ocean waves literature and therefore we shall use the form given by 9 in our simulation study part of the reason that least squares performs poorly is that the variance of a spectral estimate will be different at different frequencies this means that low density areas of the spectral density function such as the high frequency tail tend to be under weighted for this reason log transforms are often used in least squares objective functions especially in the statistics literature bloomfield 1973 because standard least squares is widely used in the ocean waves literature we present a comparison of standard least square in this paper however in simulations not shown in this paper log least squares still does not perform as well as the de biased whittle likelihood whilst log least squares does provide better estimates of the spectral tail decay index than standard least squares some of the other parameter estimates have increased bias when compared to standard least squares plots of these log least squares simulations are available on github grainger 2021 3 2 maximum likelihood maximum likelihood inference treats the sea surface data as observations of a random variable with a given distribution the parameters for this distribution are chosen by maximising the probability of observing the data given that the underlying distribution has certain parameters for the moment let the sea surface observations be multivariate gaussian with expectation zero and an unknown covariance matrix σ θ the log likelihood function for observations of such a process is 10 ℓ m l θ x δ n 1 2 n log 2 π log σ θ x δ n t σ θ 1 x δ n where x δ n t denotes the transpose of x δ n the maximum likelihood estimator is then obtained by maximising the log likelihood function more formally the maximum likelihood estimator of θ is θ ˆ m l argmax θ θ ℓ m l θ x δ n provided that the underlying random variable is actually multivariate gaussian this technique will provide asymptotically optimal estimates of θ in the sense that they converge at an optimal rate see pawitan 2001 chapter 8 5 for more details this approach can be computationally expensive because evaluating the objective function given by 10 requires the inversion of an n n matrix also if we want to model a distribution that is not gaussian then a different log likelihood function must be used this may take significantly longer to compute or may not even be tractable as previously discussed wave processes will not typically be precisely gaussian however in section 5 we shall compare fitting techniques on simulated gaussian processes in the first instance in this case full maximum likelihood provides a useful benchmark to compare the performance of other estimators to the optimal choice of estimator 3 3 spectral likelihood to avoid some of the problems associated with maximum likelihood estimation we can use approximations to the likelihood known as pseudo or quasi likelihoods to gain some of the accuracy and precision of maximum likelihood while keeping computational costs and distributional assumptions low one such quasi likelihood 4 4 these likelihoods are usually referred to as quasi likelihoods however we also use the term spectral likelihood as it integrates nicely with current terminology used in the literature as well as giving an intuitive sense of what a spectral likelihood does is known as the whittle likelihood whittle 1953 the whittle likelihood has been used in a wide range of applications due to its computational efficiency and fairly free distributional assumptions in particular we no longer need to assume that the underlying process is gaussian in its discretised form the whittle likelihood is 11 ℓ w θ x δ n ω ω log f ω θ i ω f ω θ where i ω denotes the periodogram ordinate at angular frequency ω the corresponding estimator is again obtained by maximising this spectral likelihood which we shall denote by θ ˆ w argmax θ θ ℓ w θ x δ n this estimator also does not account for aliasing however by replacing f ω θ with f δ ω θ in 11 we obtain an estimator that does account for aliasing we shall refer to this as the aliased whittle likelihood though it should be noted that some authors refer to this as simply the whittle likelihood though this aliased approach accounts for some of the bias in the whittle likelihood other forms of bias introduced through phenomena such as blurring are still present percival and walden 1993 chapter 6 sykulski et al 2019 introduced the de biased whittle likelihood to deal with both aliasing and blurring simultaneously the de biased whittle likelihood is 12 ℓ d w θ x δ n ω ω log f n ω θ i ω f n ω θ where f n ω θ e i ω θ is the expected periodogram as noted by sykulski et al 2019 the expected periodogram can be calculated in o n log n time by using the relation 13 e i ω θ δ 2 π re 2 τ 0 n 1 1 τ n c τ θ exp i ω τ δ c 0 θ the resulting estimator can then be expressed as θ ˆ d w argmax θ θ ℓ d w θ x δ n despite being constructed from the periodogram an inconsistent estimator of the spectral density function the de biased whittle likelihood is a consistent estimator of the parameters for the parametric model the de biased whittle likelihood is able to address the deficiencies in the periodogram without introducing bias by accounting for the finite sample properties of the periodogram sykulski et al 2019 also show that under certain conditions the de biased whittle estimator converges optimally these condition are discussed further in appendix c 3 4 comparison in section 5 we perform a simulation study to compare each of the estimators that we have discussed however we can also try to build some intuition as to why certain approaches are likely to be more effective than others to achieve this we shall consider the conditions in which each technique would be equivalent to full maximum likelihood for a finite sample then evaluate how likely it is that said assumptions are satisfied note that this is not and nor is it intended to be a formal proof results related to the convergence of de biased whittle estimators and their proofs can be found in sykulski et al 2019 rather this is a sketch of what is going on under the hood that causes the de biased whittle likelihood to outperform least squares based techniques maximum likelihood inference works by making probabilistic statements about the distribution of data and then using this to work out the parameter choice that would have been most likely to have given rise to the data in question the part of this process of interest to us here is making such distributional statements for this comparison we shall think of the non parametric spectral density estimates as the data and shall consider what their distribution would need to be for least squares or the whittle likelihood to be the optimum likelihood function for this data 5 5 this differs from full maximum likelihood on the time series as we have lost the phase information in calculating a spectral density estimate then for the least squares approach to yield the same parameter estimates as the optimum likelihood function we would need the non parametric spectral density estimator used in the fitting routine i ω to satisfy the following four assumptions firstly at each frequency the non parametric estimator must be gaussian in general this is not true for non parametric spectral density estimators though it is true asymptotically for some of them e g bartlett s method secondly the expectation of the non parametric estimator must be equal to the spectral density function at a given frequency this is not actually true for non parametric spectral density estimators as these are constructed to estimate the aliased spectral density function not the spectral density function of the continuous time process though this aliasing could be accounted for by modifying the spectral form used in the fitting routine such modification is not standard practice and many non parametric spectral density estimators are still biased thirdly the variance of the non parametric spectral density estimator must be the same for each frequency this is not the case for non parametric spectral density estimators in general as the variance at a given frequency depends on the spectral density function at that frequency brockwell and davis 2006 though weighted least squares approaches such as the approach proposed by chiu 1988 do begin to address the problem of assumption three they are not widely used and still make the first and second assumptions fourthly the non parametric estimators at any two different frequencies must be uncorrelated this assumption is discussed further in section 3 5 for the whittle likelihood to yield the same parameter estimates as the optimum likelihood function we would need the following three assumptions on the periodogram to hold firstly we would require the periodogram to be exponentially distributed at each fourier frequency 6 6 a slightly different assumption is made about the zero and nyquist frequency though in practice they are often omitted secondly we would require that the expectation of the periodogram is equal to the spectral density function at a given frequency and consequently that the variance is the square of the spectral density function thirdly the periodogram at any two different frequencies must be uncorrelated at fixed frequencies the first assumption is true asymptotically for linear processes brockwell and davis 2006 and for some classes of non linear processes shao and wu 2007 at first glance this may seem to be similar to the asymptotic normality of bartlett modified periodograms that are often used in least squares however it should be noted that in the case of the periodogram this asymptotic result is in terms of the number of observations whereas for bartlett modified periodograms this result is in terms of the number of segments that are used which is much smaller when it comes to the second assumption the periodogram is an asymptotically unbiased estimator of the aliased spectral density function for this reason the aliased version of the whittle likelihood should be used over the standard version again it may seem that this is also true for bartlett modified periodograms as bartlett s method averages periodograms and each periodogram is an asymptotically unbiased estimator of the aliased spectral density function therefore if we were to adjust for this aliasing least squares would be justified however each of these component periodograms are calculated from small segments of the full record so it is difficult to invoke asymptotic results indeed this creates somewhat of a catch 22 for bartlett least squares to get asymptotic normality we must average many periodograms but this results in using shorter segments for each periodogram introducing bias and vice versa the de biased whittle likelihood sykulski et al 2019 bypasses the second assumption made by the whittle likelihood altogether as it uses the theoretical expectation of the periodogram in place of the spectral density function this means that even for small sample sizes the de biased whittle likelihood produces estimates with very small to no bias the final assumption the assumption of independence between frequencies is required by both least squares and spectral likelihoods however the whittle likelihood is also in a strong position when it comes to satisfying this assumption this is because asymptotically the periodogram is uncorrelated at different frequencies and we are using the longest periodogram possible given the length of the data of course least squares techniques could be used on the raw periodogram meaning that the second and last assumptions are just as likely to be satisfied as when using spectral likelihoods but in this case the asymptotic normality required for least squares will not be satisfied nor in general will the constant variance assumption when it comes to the final assumption for both least squares and spectral likelihood techniques there are some practical concerns that should be considered in particular when the aliased spectral density has high dynamic range the frequencies are often correlated as we shall shortly show in the case of wind generated waves this issue does not present itself for 1 hz data although for higher sampling frequencies such as 4 hz data the periodogram is often highly correlated to solve this problem we can turn to differencing a technique that is well established for reducing correlations in the periodogram velasco and robinson 2000 3 5 differencing if the periodogram is highly correlated across frequencies spectral likelihoods will perform poorly when compared to full maximum likelihood velasco and robinson 2000 differencing can sometimes provide a convenient mechanism for removing such correlations define the differenced process as y t x t δ x t we briefly switch notation and let c x τ and f x ω denote the autocovariance and spectral density function of x at τ and ω respectively and likewise c y τ and f y ω for the differenced process y first notice that 14 c y τ e y 0 y τ e x δ x τ δ x 0 x τ δ x δ x τ x 0 x τ 2 c x τ c τ δ c τ δ by stationarity then from 2 we can see that 15 f y ω 2 c x τ c τ δ c τ δ exp i τ ω d τ 2 f x ω e i ω δ f x ω e i ω δ f x ω 2 1 cos ω δ f x ω 4 sin 2 ω δ 2 f x ω therefore differencing can be easily incorporated into the fitting techniques that have been discussed in this paper by simply replacing x with the differenced process y and f x with f y using the relation given by 15 consider the correlation matrix of the periodogram the matrix with i j th element defined to be the correlation between the periodogram at the i th and j th fourier frequencies fig 1 shows a plot of the correlation matrix for the periodogram of a wind generated wave process estimated using the technique described in appendix b we can see that for data recorded at a 1 hz sampling rate there is little correlation in the periodogram however this is not the case for 4 hz data we can also see that the periodogram of the differenced process is almost completely uncorrelated even for the 4 hz data 7 7 it should be noted that the region of high correlation in the top left corner of each of the correlation matrices is part of the reason for removing such frequencies from the objective function when performing fits as discussed further in section 4 1 from the signal processing perspective this has reduced the dynamic range of the spectrum as we are multiplying the spectral density function by something that is close to zero for angular frequencies that are small but is close to one near the nyquist down weighting the peak far more than the tail 4 practical concerns for implementation with the generalised jonswap in section 3 we described some techniques that can be used to estimate model parameters when implementing these techniques for ocean wave models there are some practical concerns that must be addressed firstly we need not use all of the fourier frequencies when fitting the model indeed it may be preferable to remove some frequencies that are contaminated by some other process or by observational noise secondly there is no known analytical form for the autocovariance corresponding to many of the spectral density functions used when modelling ocean waves therefore numerical techniques for estimating the autocovariance play an important role in many of the fitting procedures discussed in section 3 in particular it is necessary for both the de biased whittle likelihood and for full maximum likelihood 4 1 frequency selection many of the estimators defined in section 3 involve minimising or maximising objective functions which are expressed as the sum over some set of frequencies ω ω n δ the most simple choice for this set ω is just the set of fourier frequencies ω n δ at first glance this would seem like the most sensible choice as omitting frequencies is essentially the same as throwing away data points however there are many different circumstances in which it is preferable to remove some of the frequencies from the fit one practical reason for removing certain frequencies is that for very low frequencies the generalised jonswap spectra is zero to machine precision this often introduces numerical instabilities especially for objective functions that involve dividing by the spectral density function such as the whittle likelihood as can be seen in fig 1 there is also a region of high correlation in the low frequencies which provides an additional motivation for removing such frequencies an alternative method to reducing correlations in the periodogram is to use tapered versions of the spectral density estimate in the whittle likelihood dahlhaus 1988 but in simulations available on github we found omitting frequencies from the fit to be a better solution than tapering in terms of the resulting bias and variance of parameter estimates another reason for removing certain frequencies from the fit is that it can help to remove noise processes that are present in a record for example wave records often contain a low frequency swell component but we are interested in the parameters of the wind sea component by removing frequencies in which the swell is dominant we are better able to model the wind sea component of a sea state on top of this there is an added technical concern when using the whittle and de biased whittle likelihoods the zero and nyquist frequencies must be omitted or a modified version of the summand must used for those frequencies this is because these methods are based on the asymptotic distribution of the periodogram which is different at the nyquist and zero frequency than it is at other frequencies fitting the model in this way can be thought of as fitting a semi parametric model as some of the frequencies are being modelled using a parametric model and the remaining frequencies by some non parametric model such as the periodogram it is worth noting that this approach can actually be applied to full maximum likelihood as well this can be achieved by transforming both the observations and autocovariance of the model into the frequency domain applying a band pass filter and then transforming back while this is possible in theory it is fiddly in practice and is no longer exact this demonstrates another major advantage of spectral likelihoods it is far easier to filter out undesired frequencies from the model fit however the choice of frequencies to be used in the fit should be made prior to the objective function being optimised otherwise the number of degrees of freedom could be changing throughout the optimisation routine which would likely result in additional bias 4 2 numerical estimation of the autocovariance to calculate both the multivariate gaussian likelihood and de biased whittle likelihood we require the autocovariance of the process given a certain parameter choice in 10 for the multivariate gaussian likelihood and 13 for the de biased whittle likelihood for the generalised jonswap spectra there is no analytical form for this autocovariance as such the autocovariance must be approximated numerically firstly recall that the autocovariance is the fourier transform of the spectral density function as defined in 4 and we wish to obtain the autocovariance at lags 0 δ n 1 δ the first problem we encounter is that this integral is over the entire real line clearly we cannot approximate such an integral numerically and must instead settle for integrating up to some finite frequency such that the spectral density function beyond that frequency is sufficiently small in particular it is convenient to choose a multiple of the nyquist frequency as the integral will be approximated using a fast fourier transform so the desired lags can be extracted by sub sampling if a multiple of the nyquist is used in the integration therefore based on eq 4 we can construct the approximate autocovariance 16 c ˆ τ l π δ l π δ f ω exp i τ ω d ω for l n 1 2 3 alternatively we could consider the relation given in eq 3 between the autocovariance and the discrete time spectral density function in this case we would first need to approximate the spectral density function for the discrete time process to do this we use a truncated version of the relation given by eq 5 between the spectral density of the continuous and discrete time processes consider the approximation of the aliased spectral density function given by 17 f δ ω k k k f ω 2 π k δ for k n 0 0 1 2 then we can construct the alternative approximation to the autocovariance given by 18 c τ π δ π δ f δ ω exp i τ ω d ω notice that we may write 19 c τ π δ π δ k k k f ω 2 π k δ exp i τ ω d ω k k k π δ π δ f ω 2 π k δ exp i τ ω d ω k k k 2 k 1 π δ 2 k 1 π δ f ω exp i τ ω d ω 2 k 1 π δ 2 k 1 π δ f ω exp i τ ω d ω from 19 we can see that if l 2 k 1 then c ˆ τ and c τ are equivalent in practice these integrals must be approximated numerically to do this we consider a riemann approximation with bins of width 2 π m δ by choosing m to be some integer bigger than 2 n we can obtain the desired lags by performing a fast fourier transform and then sub sampling appropriately we can now see that the approximation based on c ˆ τ in 16 can be computed in o l m log l m time however computing the second approximation based on c τ in 18 requires first computing f ω at m frequencies taking o l m operations and then performing a fourier transform on m frequencies requiring o m log m operations in other words the first approach requires o m l log l l log m operations whereas the second only requires o m l log m operations for this reason we use the latter approach when approximating the autocovariance first approximating the aliased spectral density then approximating the autocovariance the choice of k or equivalently l depends on the tail behaviour of the spectral density function in question in practice we choose k so that for frequencies beyond 2 k 1 π δ the spectral density is below some threshold typically 1 0 6 m 2 s rad 1 though k should really be chosen so that it scales with n for convergence results to still apply the choice of m is based on the required accuracy of the integral approximation and should be tuned accordingly for the generalised jonswap we have found that m max 8192 2 n is a good choice 5 simulation study though it is possible to make theoretical statements about the asymptotic behaviour of different estimators from a practical perspective their finite sample behaviour is of primary interest to investigate this we perform a simulation study to assess the performance of the estimators described in section 3 in this simulation study we compare six different fitting techniques based on these estimators the first which we call least squares uses the curve fitting approach with the periodogram the second approach is similar but uses bartlett s method to estimate the spectral density function which we refer to as bartlett least squares the window size is chosen so that we have a spectral resolution of 0 2 π i e the window size is 100 δ 8 8 clearly for some values of δ this would not be an integer however for the values of δ that we choose it is for 1 28 hz data this corresponds to a window size of 128 the third and fourth approaches are the whittle and aliased whittle likelihoods respectively the final two approaches are the de biased whittle likelihood and full time domain maximum likelihood 5 1 method to investigate the effectiveness of different fitting approaches we simulate a linear wave record with a known parametric spectral density function and then re estimate the parameters from the simulated record by repeatedly performing this process we can assess the bias and variance of each of the estimators discussed in section 3 for the purposes of the simulation study we let x δ n be a random variable with a multivariate normal distribution resulting from sub sampling the continuous time mean zero stationary gaussian process x where x has spectral density function f g ω θ defined by 8 we then simulate a realisation of x δ n using the circulant embedding method described by davies and harte 1987 and for complex valued processes by percival 2006 we choose to use circulant embedding over the typical approaches for simulating gaussian processes often used in the ocean waves literature such as the method due to tucker et al 1984 as these methods only approximately simulate a gaussian process with the given spectral density function whereas circulant embedding is exact up to the quality of the approximation of the autocovariance that is used furthermore many techniques such as the method proposed by tucker et al 1984 or the more recent modification due to mérigaud and ringwood 2018 do not account for aliasing when simulating the process since we are explicitly interested in the effect that aliasing has on recovered parameters it is important that we simulate something that is as close as we can get to a gaussian process with the desired aliased spectral density function circulant embedding generates time series with all of the sampling effects discussed by tucker et al 1984 but also includes additional finite sampling effects such as aliasing and correlations between spectral estimates at different frequencies such effects should be present in generated time series but are not in time series generated using the method suggested by tucker et al 1984 more details can be found in davies and harte 1987 dietrich and newsam 1997 and wood and chan 1994 to perform the fitting we first choose one of the objective functions described in section 3 and optimise this using the fmincon function in matlab with maximisation done by minimising the negative of the objective function an initial guess for the fitting procedure needs to be provided for each of the parameters for ω p we use the frequency corresponding to the largest value of the periodogram for r we use a basic linear regression coefficient between the log spectral density and log periodogram over the tail frequencies where the tail is chosen to be all frequencies that are closer to the nyquist than the peak we choose to initialise γ by setting it equal to 3 this is because choosing γ heuristically is not easy and γ 3 is close to the value commonly assumed by many oceanographers in practice the initial choice of γ does not seem to have a huge impact on the final fitted values however the optimisation could also be run with multiple starting values of γ and the best estimate could then be selected once these parameters are initialised α is initialised so that the area under the initial parametric spectral density function matches the area under the periodogram in simulations we find that the inference is not sensitive to the initial guess provided it is sensible in practice we are often fitting models to multiple consecutive sea states in this case it can be more efficient to use the parameter estimates for the previous sea state as initial values when optimising 5 2 a canonical sea state we shall begin by considering how each of the estimators perform for one choice of true parameters before showing that the results are robust to the true parameters in particular we begin by considering a spectral density function of the form described in section 2 2 with σ 1 0 07 σ 2 0 09 and s 4 treated as known and with α 0 7 ω p 0 7 γ 3 3 and r 4 treated as unknown parameters to be estimated the reason for choosing these parameters is that α 0 7 roughly corresponds to the scaling present when using phillip s constant in a jonswap spectra ω p 0 7 is a reasonable choice for peak frequency γ 3 3 is commonly assumed to be the peak enhancement factor and r 4 is one of the suggested values for the tail decay index half hour records sampled at 1 28 hz a standard time interval and sampling frequency for wave records were simulated and the parameters were estimated using each of the six estimation methods described above the resulting estimates across 1000 repeated simulations are summarised in fig 2 alongside the time taken to perform the optimisation for comparison the true value of each parameter is given by a horizontal black dashed line perhaps the most striking feature of fig 2 is the difference in the variability in estimates of the tail parameter r when comparing least squares type techniques to likelihood based techniques least squares techniques recover parameter estimates ranging from well beyond three to five making it very difficult to make any statements about the true value of the tail decay however we can see that statistical techniques such as the de biased whittle likelihood are able to recover the original tail parameter to within a few decimal places therefore by using the de biased whittle likelihood practitioners would be able to distinguish between ω 4 and ω 5 spectral tails in observed records though it should be noted that this assumes the wind sea had a spectral density that is well described by a generalised jonswap and so we cannot provide model free estimates of the tail decay in particular a different model would be required for a transition in tail decays over frequency such as the effect discussed by babanin 2010 however the de biased whittle likelihood is generic and could be applied to other models provided they satisfied certain conditions see appendix c we can also see that the de biased whittle likelihood offers an improvement in estimates of γ performing almost as well as full maximum likelihood it is also interesting that bias can be seen in both the whittle and aliased whittle likelihood estimates but that this bias is not present in the de biased whittle likelihood estimates this verifies that the de biased whittle likelihood is indeed accounting for some of the bias present in standard whittle likelihood and demonstrates why de biased whittle likelihood is necessary over the aliased whittle likelihood which can still be seen to be biased for some parameters in the analysis of fig 2 full maximum likelihood provides the best estimates in terms of root mean square error however this comes at significant computational cost whilst giving limited improvement in bias and variance when compared to the de biased whittle likelihood often during optimisation parameters may trade off against one another therefore it is also important to look at the joint behaviour of parameter estimates fig 3 shows a scatter plot of the de biased whittle likelihood estimates from fig 2 we can see that there is very strong correlation between the estimates of α and r and some negative correlation between α and γ this likely occurs because γ and r change the area under the spectral density function so α is likely to be adjusted to compensate though it would be possible to reparameterise to try and avoid this it does not seem to have a significant impact on the resulting estimates and is therefore not necessary in practice longer sea states are often used to estimate model parameters therefore we also compare some of the methods for 3 h records fig 4 shows the comparison of least squares bartlett least squares and de biased whittle likelihood estimates for these 3 h records the variance in the first two estimators has indeed decreased when compared to the estimates from half hour records shown in fig 2 however by comparing the de biased whittle likelihood estimates in fig 2 to the least squares estimates in fig 4 we can see that the de biased whittle likelihood used on a half hour record yields better estimates than the least squares based estimates performed on 3 h records the longer record reduces the variance of the least squares and bartlett least squares techniques enough to allow us to see another interesting feature namely that there is significant bias present in the bartlett least squares estimates that is not present in the standard least squares estimates this demonstrates that non parametric smoothing can have unexpected consequences when used to fit a parametric spectral density function in essence by using the de biased whittle likelihood we can obtain more accurate and precise parameter estimates whilst simultaneously reducing the length of the record required to obtain the estimates this improvement is especially noticeable and important for the peak enhancement factor γ and tail decay index r in practice this has two important consequences firstly we can reduce the amount of time for which the surface is assumed to be stationary this means that we can fit stationary models to weather systems that evolve very quickly such as tropical cyclones secondly we can obtain parameter estimates at more frequent time intervals this higher parameter resolution means that we gain a more detailed insight into how certain parameters evolve throughout the course of a meteorological event 5 3 robustness of results in section 5 2 we have demonstrated that the de biased whittle likelihood can produce parameter estimates that are both more accurate and more precise than those produced by least squares techniques without making huge sacrifices in terms of computational time however it is also important to check that these results extend to different choices of the true parameter in table 1 we present the results of a simulation study comparing least squares bartlett least squares and the de biased whittle likelihood over 24 different choices of true parameter for each choice of true parameter we calculated the percentage bias standard deviation sd and root mean square error rmse of the estimates relative to the true parameter we then averaged over all the choices of true parameter yielding an average percent bias sd and rmse for each parameter the parameter choices used to perform these simulations were all the combinations of α 0 7 ω p 0 7 0 9 1 2 γ 1 2 3 3 5 and r 4 5 boxplots for each set of parameter choices are available on github grainger 2021 we can see from table 1 that there are substantial reductions in both the bias and standard deviation of all the estimated parameters true parameters on the boundary of the parameter space can cause problems when performing parametric estimation as such we shall further discuss the results for the special case when γ 1 the fitted parameters for half hour simulated records with true parameter values α 0 7 ω p 0 7 γ 1 and r 5 using the least squares bartlett least squares and de biased whittle likelihood techniques can be seen in fig 5 this is an interesting case because not only does the true parameter lie on the boundary of the parameter space but this value of γ corresponds to a pierson moskowitz spectrum for a fully developed sea this means that such a value of γ could occur in nature and as such it is important that we can model this case the problem is that the theoretical guarantees for an approach such as the de biased whittle likelihood rely on the assumption that the true parameter does not lie on the boundary of the parameter space since this is not the case for γ 1 therefore we must take care when dealing with records for which the true value of γ may indeed be 1 in particular we can see from fig 5 that the de biased whittle likelihood estimates for γ is not normally distributed a result that is assumed when constructing the confidence intervals that are described later in section 6 one way to deal with this problem is to fit both a model with γ 1 fixed and one with γ as a free parameter and then test to see if there is evidence for γ 1 such a procedure allows us to circumvent potential issues caused by γ lying on the boundary of the parameter space this could be performed by using the procedure developed by sykulski et al 2017 adapted to the 1d case 5 4 differencing for high sampling frequencies as we discussed in section 3 5 for wind generated waves observed at a 4 hz sampling rate the periodogram is highly correlated as noted in section 3 4 in this case we would expect spectral techniques to perform poorly compared to full maximum likelihood differencing can reduce the correlation in the periodogram and therefore can be a powerful tool to remove bias from spectral methods fig 6 shows box plots of estimated parameters for least squares bartlett least squares and de biased whittle likelihood techniques both with and without differencing for both 1 hz and 4 hz data in this case 2048 s worth of data was simulated per record i e 2048 observations for the 1 hz simulation and 8192 for the 4 hz simulation we can see little benefit from differencing in the 1 hz estimates fig 6 a however when it comes to 4 hz data there is a major benefit to differencing especially for the de biased whittle likelihood because there is little difference between the de biased whittle fits on the original and differenced 1 hz data we would recommend that differencing is used as standard to protect against the issues seen in fig 6 b at the very least investigating the correlation matrix of the periodogram should be an important diagnostic when fitting spectral models 6 quantifying estimation uncertainty as with any statistical analysis it is important to quantify the uncertainty in the parameter estimates that are obtained using the de biased whittle likelihood sykulski et al 2019 developed an approach for quantifying the asymptotic variance of the estimator for a single time series say that we have p parameters that are written in a vector θ and are interested in the de biased whittle likelihood estimator θ ˆ d w of the true parameter vector θ sykulski et al 2019 decompose the variance as 20 var θ ˆ d w e h θ 1 var ℓ d w θ e h θ 1 where h θ denotes the matrix of second derivatives of the log likelihood function ℓ d w θ and denotes the vector of first derivatives of ℓ d w θ now for the de biased whittle likelihood we may write 21 θ j ℓ d θ ω ω 1 f n ω θ i ω f n 2 ω θ f n ω θ θ j for j 1 p as will be seen in appendix b this is required to calculate var ℓ d w θ additionally we may write 22 e 2 θ j θ k ℓ d θ ω ω 1 f n 2 ω θ f n ω θ θ j f n ω θ θ k for j k 1 p therefore we require only the first derivative of the expected periodogram in order to compute both parts of the variance decomposition given by 20 furthermore the triangle function and fourier basis are constant with respect to θ so from 13 we have that 23 θ j f n ω θ δ 2 π re 2 τ 0 n 1 1 τ n c τ θ θ j exp i ω τ δ c 0 θ θ j for j 1 p in other words to calculate the derivative of the expected periodogram we may first calculate the derivative of the autocovariance then calculate the expected periodogram of the process with that derivative as its autocovariance in the case of the generalised jonswap spectral density function when an analytical form for such autocovariance is unavailable we may instead approximate the derivative of the autocovariance by first approximating the derivatives of the aliased spectral density function and then of the autocovariance in appendix a we show that for the generalised jonswap form partial derivatives of f δ ω θ can be calculated from the derivatives of the spectral density function and that the resulting derivatives are continuous therefore by leibniz s rule 24 θ j c τ θ π δ π δ f δ ω θ θ j exp i ω τ d ω as a result we may approximate the derivative of the autocovariance from the derivative of the aliased spectral density function in the same way that we approximated the autocovariance from the aliased spectral density function in section 4 therefore each partial derivative can be computed in the same time it would take to do one function evaluation which is faster than using numerical approximations for the derivative e g finite differencing methods in appendix b we discuss a novel procedure for estimating var ℓ d w θ in a computationally efficient manner combining this with the approach for obtaining derivatives we can estimate the variance of the de biased whittle likelihood estimator using 20 this enables the computation of approximate confidence intervals for our estimates by using the asymptotic normality of the estimator and standard theory for confidence intervals 7 maui data observations of fetch limited seas made near the maui a platform off the coast of new zealand between november 1986 and november 1987 have been studied previously by ewans and kibblewhite 1986 and ewans 1998 we revisit these observations to demonstrate additional practical concerns when applying the techniques discussed in this paper to observed wave records observations were taken using a datawell wavec buoy at a location with a water depth of 110 m data were recorded for 20 min at a sampling rate of 1 28 hz then there is a gap of 10 min while data is processed non parametric spectral density estimates were recorded for each of these intervals while the raw time series was only retained for the first 20 min of a 3 h segment in other words a 20 min record is available starting at 00 00 03 00 06 00 etc for each day for the sake of illustration we shall analyse the behaviour of spectral parameters throughout a single storm event from the 2nd to the 7th of november 1986 9 9 note that this is not intended to make general statements about the behaviour of these parameters rather we are illustrating some of the additional practical concerns faced when analysing recorded wave time series as can be seen from fig 7 throughout the first and second days the conditions become steadily more severe before calming down over the proceeding days transforming to the frequency domain we see the presence of persistent swell which remains fairly constant throughout all of the records parameters of the wind sea component of these bi modal seas are estimated by first removing contaminated frequencies from the objective function with optimisation proceeding as previously described 10 10 this can be thought of as first applying a high pass filter then fitting a uni modal model to the resulting filtered record ideally we would aim to fit a bi modal model that was designed to also describe the swell component however such an approach is beyond the scope of this paper though we note that preliminary results for such a procedure are encouraging and are discussed further in section 8 it was also observed that frequencies beyond 3 rad s 1 exhibited a different behaviour from the rest of the spectral tail we suspect this may be related to the physical response of the buoy to the waves though we do not know exactly how such behaviour should be modelled therefore we also chose to omit those frequencies in the spectral fitting procedure when using each of the fitting procedures after filtering out the aforementioned frequencies a generalised jonswap spectral form was fitted to each of the sea states in turn using least squares bartlett least squares and the de biased whittle likelihood these estimates are shown in fig 7 a from fig 7 a we can see that especially for the tail index the de biased whittle estimates seem more stable than both the least squares and bartlett least squares estimates fig 7 b shows the de biased whittle likelihood estimates and approximate 95 point wise confidence intervals calculated using the technique described in section 6 it is worth noting that these confidence intervals are based on the asymptotic distribution of the estimator in particular we assume asymptotic normality of the estimator this is especially problematic for values near to or on the boundary of the parameter space as the confidence interval may include values outside the boundary to represent this in fig 7 b we only shade regions of the confidence interval that are within the parameter space such confidence intervals enable us to better understand and communicate the uncertainty surrounding parameter estimates this uncertainty we argue should be considered when using these parameters as inputs for other related models from fig 7 b we can see that the parameters behave broadly as expected when moving through the storm we see a steady evolution in peak frequency throughout the growth of the wind sea component alongside large values of γ as the storm is developing after this point the values of γ reside close to 1 we can also see that there is a greater level of uncertainty when h s was low this is because there is very little energy in the wind sea component however as the storm evolves this uncertainty quickly reduces the uncertainty surrounding the peak enhancement factor remains fairly high through the second half of the first day even when the uncertainty around other parameters has reduced this is because when the true value of γ is large at frequencies around the peak the periodogram has more variance and it is these frequencies that contain the information about γ a useful diagnostic tool for spectral models can be constructed by noticing that under certain technical conditions i ω e i ω θ should be approximately exponentially distributed with mean 1 brockwell and davis 2006 where i ω denotes the periodogram this result is specific to the periodogram and is not true in general for non parametric spectral density estimators therefore if we calculate this ratio for a given model at each fourier frequency we can then compare the quantiles of these fractions to the quantiles of an exponential distribution with mean 1 using a q q plot figs 8 a and 8 b show the periodograms and fitted models on both the standard scale and the decibel scale respectively for 4 time periods during the early development of the storm fig 8 c shows the corresponding q q plots which demonstrate how well each of the models fits the data the closer the points on the q q plot are to the reference line y x the better we can see from fig 8 c that the de biased whittle likelihood consistently outperforms the other techniques plots for the remaining sea states are available on github grainger 2021 8 discussion and conclusion the de biased whittle likelihood has been shown to yield major improvements in both the bias and variance of estimated parameters for wind generated waves in particular the tail decay index can be estimated to much greater levels of accuracy and precision than when using least squares techniques such an improvement will enable reliable tracking of the tail decay index s behaviour throughout the course of meteorological events allowing oceanographers to gain fresh insights into the behaviour of wind generated waves we have also demonstrated some improvement in the estimation of the peak enhancement factor the de biased whittle estimator recovers estimates that are of similar quality to full maximum likelihood which can be thought of as optimal since information about the peak enhancement factor is contained in a small region around the peak frequency it is not surprising that it is so hard to estimate because there is significant variability in estimates of the peak enhancement factor it is essential that we can describe uncertainty surrounding parameter estimates when performing an analysis for this reason the development of computationally efficient techniques for quantifying uncertainty surrounding the estimated parameters is important we have shown that the method presented by sykulski et al 2019 for estimating the variance of the de biased whittle estimator can be modified so that it can be computed using 2d fast fourier transforms combining this with an analytical approach for calculating derivatives we are able to calculate the uncertainty in parameter estimates accurately and quickly in addition differencing can be used so that we can cope with high sampling frequency data which tend to be correlated in the frequency domain as we discussed previously when performing simulations we chose to use circulant embedding davies and harte 1987 to obtain realisations of gaussian processes with the desired covariance matrix this is different to the standard method used for simulating linear ocean waves presented by tucker et al 1984 or to the adapted version due to mérigaud and ringwood 2018 which is preferable the first difference is that the standard waves method is only approximate and does not exactly simulate a gaussian process with the desired covariance equivalently spectral density the second is that these methods do not account for the aliasing that we would expect to be present in a record essentially treating the spectral density as if it is zero beyond the nyquist frequency though for many applications this will not matter the methods discussed in this paper will be sensitive to this difference if the simulated record does not have the aliasing that should be present then the parameters estimated using the de biased whittle likelihood will seem biased and standard whittle will often seem better this is important because if a method such as tucker et al 1984 was used to perform the simulation study described in this paper the results would be different as likelihood based estimation will be sensitive to this problem which could be thought of as model miss specification as we are trying to fit a model with a non zero density beyond the nyquist to a process that has been simulated with no density above the nyquist least squares is somewhat invariant to this problem as it mainly effects frequencies where the spectral density function is small and least squares is not heavily influenced by such frequencies we have also developed a matlab toolbox implementing the methods discussed in this paper this is available alongside code to generate the figures in this paper and additional supplementary figures on github grainger 2021 the toolbox contains code to perform each of the fitting techniques discussed in this paper on arbitrary processes as well as a function implementing the generalised jonswap including first and second derivatives which can then be used straight out the box on top of this the user may provide any spectral density function they wish provided it satisfies the assumptions in appendix c and then use the toolbox to obtain parameter estimates from observations alongside this an implementation of circulant embedding is provided enabling exact simulation of a desired gaussian process though the de biased whittle likelihood has been seen to perform well in the estimation of wind seas we have yet to fully explore its potential when we wish to describe multi modal seas e g including one or more swell components in this paper we were able to describe the wind sea component of such sea states by first removing swell with a high pass filter however it would be preferable to develop and fit models that were bi modal themselves avoiding the need for partitioning schemes to determine which frequencies should be filtered indeed such a procedure could be extended to describe seas with any number of components using model selection to determine the number of components that are actually present such techniques could also allow for the development of model based partitioning schemes that would separate overlapping wind sea and swell components in the development of such multi modal models it would be important to consider the interactions between different component weather systems in particular techniques such as higher order spectral analysis could be used to determine if any non linear interactions were present and help characterise them such interactions could then also be parameterised and fitted using similar techniques to those discussed in this paper another important aspect of wind generated waves is their directional characteristics one approach to describing these is to assume some dispersion relation between wave number and frequency and then look at frequency direction spectra which can be estimated for example from heave pitch roll buoys longuet higgins et al 1963 however it may preferable to model the three recorded series instead requiring the use of a multivariate extension to the de biased whittle likelihood these are all important avenues of further investigation in summary we have demonstrated that by using the de biased whittle likelihood we are able to obtain more accurate and precise estimates of parameters for the wind sea component of a wind generated wave process in o n log n time using differencing we are able to overcome correlations in the periodogram that are common in data sampled at a high frequency furthermore we have described a procedure which can be used to obtain the variance of such estimates in o n 2 log n time together these developments will improve the tools available to practitioners both in terms of fitting models to data and describing the associated uncertainty credit authorship contribution statement jake p grainger conceptualisation methodology software validation formal analysis investigation writing visualisation adam m sykulski conceptualisation methodology formal analysis writing philip jonathan conceptualisation methodology writing visualisation kevin ewans conceptualisation methodology resources data curation writing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements j p grainger s research was funded by the uk engineering and physical sciences research council grant ep l015692 1 and jba trust the work of a m sykulski was funded by the uk engineering and physical sciences research council grant ep r01860x 1 we thank rob lamb of jba and lancaster university uk for discussions we also thank two anonymous reviewers for their feedback appendix a derivatives of ocean wave spectra when calculating the derivatives of the generalised jonswap form special care must be taken around the peak frequency and zero frequency to check that the generalised jonswap form is actually differentiable we do not show this here but for the first derivatives there is no issue though this is not the case for the second derivatives which do not all exist at the peak consider the generalised jonswap spectral form f g ω θ we may write for ω 0 ω f g ω θ α 2 ω r exp r s ω ω p s γ δ ω θ r ω p ω ω p s 1 r ω δ ω θ ω ω p log γ ω p 2 σ ω θ 2 f g ω θ r ω p ω ω p s 1 r ω δ ω θ ω ω p log γ ω p 2 σ ω θ 2 0 as ω 0 α f g ω θ ω r exp r s ω ω p s γ δ ω θ 2 f g ω θ α 0 as ω 0 ω p f g ω θ α 2 ω r exp r s ω ω p s γ δ ω θ δ ω θ log γ ω σ ω θ 2 ω ω p ω p 3 ω r ω p 2 ω ω p s 1 f g ω θ δ ω θ log γ ω σ ω θ 2 ω ω p ω p 3 ω r ω p 2 ω ω p s 1 0 as ω 0 γ f g ω θ α ω r exp r s ω ω p s δ ω θ γ δ ω θ 1 2 f g ω θ δ ω θ γ 0 as ω 0 r f g ω θ α ω r exp r s ω ω p s γ δ ω θ log ω 1 s ω ω p s 2 f g ω θ log ω 1 s ω ω p s 0 as ω 0 by the chain rule for ω 0 ω f g ω θ ω f g ω θ α f g ω θ α f g ω θ ω p f g ω θ ω p f g ω θ γ f g ω θ γ f g ω θ r f g ω θ r f g ω θ finally for ω 0 since f g 0 α ω p γ r 0 we may write ω f g ω θ ω 0 0 α f g 0 θ 0 ω p f g 0 θ 0 γ f g 0 θ 0 r f g 0 θ 0 therefore we see that f g has continuous first derivatives proposition 1 for all x ω α ω p γ r the series k x f g ω 2 π k δ θ converges uniformly proof firstly due to symmetry we may consider the series k l x f g ω 2 π k δ θ where l is such that ω p π δ 2 π l δ now write g k ω θ f g ω 2 π k δ θ and g k x ω θ x f g ω 2 π k δ θ next notice that g k ω θ α γ ω 2 π k δ r α γ π δ 2 π k δ r α γ π δ r 2 k 1 r let m k α γ π δ r 2 k 1 r it now suffices to notice that each of the partial derivatives can be written as f g ω θ multiplied by some other function furthermore each of these functions can be bounded therefore we may write g k x ω θ c x m k for some constants c x 0 finally k l m k so by the weierstrass m test we have uniform convergence by extension we can see that k x f g ω 2 π k δ θ is also uniformly convergent proposition 2 for all x ω α ω p γ r x f δ ω θ k x f g ω 2 π k δ θ furthermore x f δ ω θ is continuous proof this first part follows from proposition 1 the convergence of k f g ω 2 π k δ θ the continuous differentiability of f g and theorem 4 4 20 of trench 2013 the continuity follows from the continuity of the derivatives of f g and the uniform limit theorem appendix b computing the variance of the first derivative sykulski et al 2019 decompose the variance of the first derivative of the de biased whittle likelihood as follows var θ i ℓ d w θ j 1 n k 1 n a i j θ a i k θ cov i ω j i ω k where ω j ω k denote fourier frequencies and a i j θ f n ω θ θ i 1 f n 2 ω j θ to estimate the variance they propose using var ˆ θ i ℓ d w θ j 1 n k 1 n a i j θ ˆ d w a i k θ ˆ d w cov ˆ i ω j i ω k for ocean wave models a i j θ ˆ d w can be easily computed by using the results from appendix a so from sykulski et al 2019 we are interested in computing cov ˆ i ω j i ω k δ 2 π n π δ π δ f δ ω θ d n δ ω j ω d n δ ω k ω d ω 2 where d n v sin n v 2 sin v 2 e i v n 1 2 to do this efficiently first note that d n v sin n v 2 sin v 2 e i v n 1 2 e i n v 2 e i n v 2 e i v 2 e i v 2 e i v n 1 2 e i n v 2 e i v 2 e i n v 1 e i v 1 e i v n 1 2 e i n 1 v 2 e i v n 1 2 s 0 n 1 e i s v by geometric series e i n v s 0 n 1 e i s v it is also convenient to write d n v sin n v 2 sin v 2 e i v n 1 2 e i v s 0 n 1 e i s v now consider the function h j k ω f δ ω θ d n δ ω j ω d n δ ω k ω f δ ω θ e i n δ ω j ω s 0 n 1 e i s δ ω j ω e i δ ω k ω r 0 n 1 e i r δ ω k ω e i δ n ω j ω k s 0 n 1 r 0 n 1 e i s δ ω j e i r δ ω k f δ ω θ e i δ n 1 ω e i δ s r ω where we have rearranged for later convenience we can now see by linearity of integration that π δ π δ h j k ω d ω e i δ n ω j ω k s 0 n 1 r 0 n 1 e i s δ ω j e i r δ ω k π δ π δ f δ ω θ e i δ n 1 ω e i δ s r ω d ω thus for r 0 n 1 and s 0 n 1 we must calculate π δ π δ f δ ω θ e i δ n 1 ω e i δ r s ω d ω notice that by letting t r s we need to calculate the following integral for t 0 2 n 1 1 π δ π δ f δ ω θ e i δ n 1 ω e i δ t ω d ω for clarity let q ω f δ ω θ e i δ n 1 ω then we need to compute 25 q t π δ π δ q ω e i δ t ω d ω for t 0 2 n 2 we notice that this is a fourier transform and we can obtain an approximation of this integral at each of the required t by doing an fft on the relevant length 2 n 1 sequence the details of this are discussed in appendix b 1 this means that we only need to do one fourier transform and can then sub this into the previous sums now we require π δ π δ h j k ω d ω e i δ n ω j ω k s 0 n 1 r 0 n 1 e i s δ ω j e i r δ ω k q r s e i δ n ω j ω k s 0 n 1 r 0 n 1 q r s e i δ 2 π r k s j n δ e i δ n ω j ω k s 0 n 1 r 0 n 1 q r s e i 2 π r k s j n where q r s q r s this is a 2d fourier transform and can be computed efficiently for j k 0 n 1 this means we take o n 2 log n time importantly libraries exist to compute this very quickly in most programming languages finally cov ˆ i ω j i ω k δ 2 π n π δ π δ h j k ω d ω 2 δ 2 π n e i δ n ω j ω k s 0 n 1 r 0 n 1 q r s e i 2 π r k s j n 2 δ 2 π n s 0 n 1 r 0 n 1 q r s e i 2 π r k s j n 2 b 1 approximating q t note that we must still approximate q t at t 0 2 n 2 we aim to approximate the integral in 25 to achieve this we use the riemann sum given by 26 q t 2 π m δ j 0 m 1 q 2 π j m δ e i t δ 2 π j m δ an fft will produce values of q t for t 0 1 m 1 therefore provided m 2 n 1 we can obtain approximations of the desired integrals appendix c assumptions for de biased whittle theorem 1 of sykulski et al 2019 gives assumptions for the optimal convergence of the de biased whittle likelihood estimator the first of these assumptions is that the parameter space is compact with non null interior and that the true value of the parameter lies in the interior of the parameter space this is not strictly satisfied by the generalised jonswap spectral density however for physical reasons the parameter space can be restricted so that it is compact the greater problem is that a value of γ 1 which corresponds to the fully developed sea described by pierson and moskowitz 1964 may occur in nature and would violate this assumption in section 5 3 we demonstrate that in this case the de biased whittle likelihood estimator still performs well the second assumption is that the spectral density of the aliased process is bounded above and is bounded below by some positive real number this is satisfied by the generalised jonswap spectral density the aliased spectrum is bounded below by the non aliased spectrum and is bounded above by the variance of x t which is finite therefore the only frequency remaining to consider is zero as the spectral density is zero when ω 0 however contributions from above the nyquist frequency are positive and as such the aliased spectral density at zero will also be positive assumption three relates to parameter identifiability informally this requires the aliased spectral density function to be different for different choices of θ intuitively provided the sampling interval is sufficiently small so that the peak frequency is smaller than the nyquist then each of the parameters is changing the shape of the generalised jonswap spectrum in a different way such that the parameters will in general be identifiable for a sufficient sample size the fourth assumption states that the aliased spectral density function must be continuous in θ and riemann integrable in ω this is satisfied for the generalised jonswap spectral form as it is continuous in θ and ω assumption five states that the expected periodogram has two continuous derivatives in θ and that these derivatives are bounded uniformly for all n furthermore the first derivatives are required to have θ n non zero frequencies strictly speaking the generalised jonswap is not twice differentiable the second derivative does not exist at the peak due to the step function σ ω θ however a simple adaptation can be made by replacing σ ω θ with 27 σ ω θ σ 1 σ 2 σ 1 1 2 1 π arctan c ω ω p where c 0 is chosen to be large this has the advantage of having continuous second derivatives and is essentially equivalent to the generalised jonswap because c can be chosen such that it would be impossible to distinguish between the two models from observed data since this part of the generalised jonswap was developed empirically there is no practical difference in using the step function over this reformulation indeed in keeping with the general philosophy of statistical modelling all models are wrong but some models are useful we suggest that this alternative formulation is just as appropriate as the generalised jonswap but more useful here as it allows us to show this assumption is satisfied by similar arguments to those presented in appendices a and b we can see that the aliased spectral density has continuous second derivatives the autocovariance then has continuous second derivatives by a similar argument to that in section 6 and noting that the second derivative of the aliased spectral density function is integrable and so therefore the second derivative of the autocovariance must be continuous as they can be shown to be fourier pairs therefore the expected periodogram also has continuous second derivatives by linearity of derivatives and the fact that linear combinations of continuous functions are continuous these derivatives are also bounded uniformly for all n due to the compactness of the set of frequencies ω and the parameter space θ the final assumption states that the process in question is fourth order stationary with finite fourth order moments and absolutely summable fourth order cumulants clearly this is true for a gaussian process as second order stationarity implies strict stationarity for gaussian and it is also true for some non linear processes such as the class of non linear processes discussed by sykulski et al 2019 finally in our simulations the estimator based on the de biased whittle likelihood performs in broad agreement with the theory for example we observed desirable properties such as root n convergence when exploring different values of n we also did not find any problems with local minima during optimisation for any of the record lengths considered suggesting that the parameters of the generalised jonswap form are indeed identifiable in practice for sufficiently long records 
20797,wind generated waves are often treated as stochastic processes there is particular interest in their spectral density functions which are often expressed in some parametric form such spectral density functions are used as inputs when modelling structural response or other engineering concerns therefore accurate and precise recovery of the parameters of such a form from observed wave records is important current techniques are known to struggle with recovering certain parameters especially the peak enhancement factor and spectral tail decay we introduce an approach from the statistical literature known as the de biased whittle likelihood and address some practical concerns regarding its implementation in the context of wind generated waves we demonstrate through numerical simulation that the de biased whittle likelihood outperforms current techniques such as least squares fitting both in terms of accuracy and precision of the recovered parameters we also provide a method for estimating the uncertainty of parameter estimates we perform an example analysis on a data set recorded off the coast of new zealand to illustrate some of the extra practical concerns that arise when estimating the parameters of spectra from observed data keywords wave spectrum parameter estimation jonswap spectral likelihood de biased whittle likelihood parameter uncertainty 1 introduction due to the random nature of wind generated gravity waves it is common to treat them as stochastic processes there is particular interest in the spectral density function of such wave processes for this reason it is important that we are able to construct good spectral density estimators using such an estimator estimates of the spectral density function can be obtained from observed wave records broadly speaking there are two approaches for obtaining such an estimator non parametric and parametric the most basic non parametric spectral density estimator is the periodogram the fourier transform of the sample autocovariance however the periodogram is a noisy estimator therefore many less noisy estimators such as that of bartlett 1948 have been developed the second approach is to use a parametric spectral density estimator here we assume that the spectral density function follows a parametric form meaning that the inference task becomes estimation of the parameters of this form in general parametric estimators are often preferable because they result in smoother estimates and more concise representations of the spectral density function and the parameters themselves provide physical interpretation of the nature of the wave process many such parametric forms have been developed in the oceanography literature phillips 1958 gave theoretical arguments for the tail behaviour of the spectral density function for wind generated wave processes based on this pierson and moskowitz 1964 established a parametric form that characterised the spectral density function of a fully developed sea describing both the spectral tail and peak behaviour this was later extended by hasselmann et al 1973 so that the parametric form could encompass a wider variety of spectral density functions including those associated with fetch limited wave processes this widely used parametric form is usually known as the jonswap spectral form it should be noted that we use jonswap to refer to the original formulation given by hasselmann et al 1973 with a tail decay of ω 5 where ω denotes angular frequency despite general acceptance of the jonswap spectral form amongst practitioners there is debate concerning the values of the tail decay index and peak enhancement factor arguments for an ω 5 tail decay made by phillips 1958 were called into question by toba 1973 and later by phillips 1985 who argued that an ω 4 tail had a stronger theoretical basis experimental work such as hasselmann et al 1973 and battjes et al 1987 found evidence for both ω 4 and ω 5 tail decays while hwang et al 2017 could not find evidence for either further suggesting that the tail decay index should be treated as a free parameter in addition there is a large literature speculating on other tail behaviours such as the occurrence of a transition frequency from ω 4 to ω 5 forristall 1981 ewans and kibblewhite 1986 babanin 2010 for example it is also common to fix the peak enhancement factor to 3 3 however there is little evidence for using precisely this value in this work we adopt a more general version of the jonswap spectral form which treats both the tail decay index and peak enhancement factor as free parameters though our methods also apply to the special cases mentioned in terms of estimating the remaining parameters of interest 1 1 to avoid potential confusion it should be noted that we are interested in estimating the parameters of assumed parametric forms for the spectral density function such as the generalised jonswap and not spectral parameters of a sea state such as significant wave height h s many authors rodríguez and soares 1999 ewans and mcconochie 2018 for example have found that both the tail decay index and peak enhancement factor are hard to estimate accurately using current techniques however both of these parameters are important for determining the properties of a given sea state our contention is that current techniques are not sufficiently accurate or precise to allow strong statements to be made concerning the true values of the tail decay index or peak enhancement factor from typical data sets indeed in section 5 we demonstrate with simulated half hour records that estimates for the tail decay using current estimation techniques range from ω 3 to ω 6 when the true tail decay is known to be ω 4 because there is too much variability in the estimates it is impossible to determine from data of such lengths if the true tail decay is ω 4 or ω 5 in this work we present an alternative technique that is capable of obtaining these parameters more accurately and precisely and show in simulated data that this technique can distinguish ω 4 and ω 5 tail decays even from short records the standard approach for estimating parameters of a stochastic model from data is by using maximum likelihood inference when an analytical form for the likelihood function is known such parameters can be optimally estimated using maximum likelihood pawitan 2001 however in the case of wind generated wave processes the exact probability distribution is unknown though it is possible to make the simplifying assumption that the wave process is gaussian for many sea states this assumption will not be reasonable for this reason it has become common for oceanographers to use a non parametric estimator of the spectral density function and obtain parameters by fitting a parametric form in the least squares sense however such least squares estimators will in general be sub optimal when compared to full maximum likelihood constable 1988 we therefore turn to frequency domain likelihoods which are widely used in both time series analysis and spatial statistics nordman and lahiri 2006 fuentes 2007 for example the canonical approach is to use an approximation to maximum likelihood known as the whittle likelihood whittle 1953 the whittle likelihood can be computed quickly using fast fourier transforms and does not require gaussianity dzhaparidze and yaglom 1983 however the whittle likelihood has been shown to produce biased estimates for small sample sizes dahlhaus 1988 velasco and robinson 2000 sykulski et al 2019 developed a de biased version of the whittle likelihood that corrects for this bias without sacrificing the computational speed or making extra distributional assumptions in section 3 4 we will provide some intuition as to why we would expect the de biased whittle likelihood to perform better than least squares both in terms of accuracy bias and precision variance then in section 5 we evidence this claim using numerical simulations the contributions of this paper are as follows firstly we introduce the de biased whittle likelihood estimator for use on wind generated wave processes section 3 secondly we detail practical concerns regarding the implementation of the estimation procedure for wind generated ocean wave processes section 4 with accompanying matlab code provided on github grainger 2021 this includes an important generalisation of the sykulski et al 2019 procedure to allow parameters to be fitted directly to the proposed spectral form without having to posit an analytical form for the time domain theoretical autocovariance sequence as required in sykulski et al 2019 but unavailable for ocean wave spectral forms thirdly we present a novel reformulation of the variance of the de biased whittle likelihood estimator which can be used to quantify the uncertainty of parameter estimates section 6 finally we perform a detailed simulation and field data study comparing the performance of different parametric spectral density estimators for wind generated wave processes sections 5 and 7 2 background so far we have used the word wave loosely to describe the shifting nature of the sea surface in truth we are actually interested in modelling the displacement of the sea surface from the resting surface of course in reality this is a 3 dimensional phenomena but in this paper we shall consider the vertical displacement of the surface over time at a specific location in space we can think of the displacement at a given time as being a random variable with some distribution therefore we can describe the displacement over time by a stochastic process an indexed family of random variables which we shall denote x x t t r note that this is a family of random variables indexed over continuous time as the actual physical process is constantly changing however since we cannot actually record data continuously in time we must instead settle for recording the process at discrete points in time we assume that the data are being sampled regularly and denote the sampling interval δ and the process that arises from sampling x every δ seconds we shall call x δ x t δ t z for the duration of a given record observations of the sea surface are usually assumed to be from an underlying process x that is second order stationary this means x satisfies all of the following conditions 1 e x t e x 0 2 e x t 2 3 e x t x s e x t s x 0 for all t s r however the sea surface is not actually stationary it evolves over time one way to circumvent this is to notice that whilst the conditions at sea do evolve over time they do so relatively slowly if we sample frequently therefore we treat the sea surface as being stationary over short time intervals sometimes known as sea states this is essentially the same approach as locally stationary modelling in time series analysis dahlhaus 2012 ideally we would make this sea state as short as possible however we must balance this with another fundamental statement the more observations we have the more confident we can be in our inferences the question of the correct time interval to use will not be covered here though it is useful to keep in mind that improving the precision of parameter estimates will mean that we could use shorter sea states in our analysis this would allow us to track the evolution of certain meteorological processes such as tropical cyclones at a higher precision and resolution to summarise the underlying wind generated wave process is not second order stationary however for short enough time windows this is a widely used working assumption that allows some inference to be made about the process in question the analysis of second order stationary stochastic processes usually involves two important characteristics the autocovariance and the spectral density function the autocovariance of a process at a given lag τ is just the covariance of a process with itself τ time steps later more formally the autocovariance is c τ e x τ x 0 e x τ e x 0 for our purposes we assume that e x t 0 for all t r noting that if this is not the case then by first removing the mean of the data we can obtain a process with the desired property therefore the autocovariance simplifies to c τ e x τ x 0 the spectral density function is a frequency domain analogue of the autocovariance which for the stochastic processes x and x δ we shall denote f ω and f δ ω respectively a formal construction of the spectral density function can be found in for example brockwell and davis 2006 page 118 for the discrete time process or doob 1953 page 522 for the continuous time process however for our purposes it suffices to note the following relations firstly for the discrete time process 1 f δ ω δ 2 π τ c τ δ exp i ω τ δ for ω π δ π δ where π δ is the nyquist frequency and is the highest observable frequency of the sampled process secondly for the continuous time process 2 f ω 1 2 π c τ exp i ω τ d τ for almost every ω r i e equal except on a set of measure zero 2 2 note that we are working with angular frequency here and for all examples in this paper this is measured in units of rad s 1 similarly the inverse relations are 3 c τ δ π δ π δ f δ ω exp i ω τ δ d ω for τ z and 4 c τ f ω exp i ω τ d ω for τ r the spectral density of the discrete time process f δ ω can be thought of as an aliased version of the continuous time spectral density function f ω more formally we have the following relation 5 f δ ω k f ω 2 π k δ for ω π δ π δ percival and walden 1993 chapter 4 in section 5 we demonstrate that aliasing can cause bias in parameter estimation which is why it is important to define both f ω and f δ ω and understand their relationship 2 1 non parametric spectral density estimators though our purpose is the analysis of parametric spectral density estimators it is also pertinent to define some of the non parametric spectral density estimators that are used throughout this paper there are two important properties that should be considered when choosing an estimator the first of these is bias which is the expectation of the estimator minus the true value ideally we would want to choose an estimator that is unbiased i e has a bias of zero this is often not possible but the weaker condition of asymptotically unbiased is often achievable an estimator is said to be asymptotically unbiased if as the number of observations increases the bias tends to zero the second important property is consistency for an estimator to be consistent it must converge in probability to the true parameter as the number of observations tends to infinity more formally denote the true parameter by θ 0 and an estimator from a series of n observations by θ ˆ n then θ ˆ n is a consistent estimator if for all ϵ 0 p θ ˆ n θ 0 ϵ 0 as n the most basic non parametric estimator for the spectral density function of a discrete time process is the periodogram let x δ n x 0 x δ x δ n 1 be a series of n consecutive random variables from x δ then the periodogram is defined as i ω δ 2 π n t 0 n 1 x δ t exp i t δ ω 2 for ω r in practice the periodogram is typically only evaluated at the fourier frequencies ω 2 π j δ n using the fft procedure where j n 2 1 n 2 for convenience we shall write ω n δ for the set of these frequencies it should also be noted that the periodogram is an estimator for the spectral density of the discrete time process f δ ω not the spectral density of the continuous time process f ω the periodogram can be shown to be an asymptotically unbiased estimator for f δ ω but the periodogram is not consistent for this reason modified versions of the periodogram which are consistent are usually used as an alternative to the periodogram one such modified periodogram suggested by welch 1967 splits the series into smaller segments applies a window calculates the periodogram of each segment and then averages these modified periodograms at each frequency in practice welch s method results in an estimate that is less noisy than a standard periodogram but has lost resolution in frequency and may be more biased a subset of such methods is known as bartlett s method bartlett 1948 this approach uses non overlapping segments with no window function in other words bartlett s estimator is 6 i b ω δ 2 π p l p 1 p t p 1 l 1 p l x δ t exp i t δ ω 2 where p is the number of segments and l is the number of observations in each segment with p l n 2 2 models for the sea surface when describing the sea surface models are often expressed in terms of the spectral density function many different spectral density functions have been developed for ocean waves perhaps most notably the jonswap spectra developed by hasselmann et al 1973 we shall consider a more general model which encompasses many of the other waves models that have been developed following mackay 2016 we use the following parameterisation 7 s g ω θ α ω r exp r s ω ω p s γ δ ω θ where δ ω θ exp 1 2 σ ω θ 2 ω ω p 1 2 and σ ω θ σ 1 for ω ω p σ 2 for ω ω p for ω 0 where α ω p s 0 γ 1 r 1 3 3 mackay 2016 gives the condition that r 0 however for the spectral density to be integrable such that the stochastic process has finite variance we require that r 1 and θ denotes the vector of parameters typically and for the remainder of this paper σ 1 σ 2 and s are set to 0 07 0 09 and 4 respectively mackay 2016 in this case the parameter vector is θ α ω p γ r also let θ denote the parameter space the set of possible values that θ can take then for this general model the parameter space is θ 0 0 1 1 r 4 note that 7 is a one sided spectral density and is not defined at ω 0 we shall work with the two sided version as this fits in with the way we have defined the spectral density function the way techniques are described in the statistical literature and the way fast fourier transforms are implemented on a computer therefore we define f g r θ 0 8 f g ω θ s g ω θ 2 for ω 0 0 for ω 0 s g ω θ 2 for ω 0 we shall refer to the function defined by 8 as the generalised jonswap spectral form in this formulation α is measured in units of m 2 s 1 r rad r 1 ω p in rad s 1 and γ and r are dimensionless for convenience we omit the units in future references 3 fitting parametric spectral density functions the process of fitting a parametric spectral density function to observations can be thought of as estimating the parameters of a statistical model which we denote θ the techniques discussed in this section are applicable to a broad class of spectral density functions as such we consider the general case and shall write f ω θ for the spectral density function of the continuous time process given some choice of parameters θ we shall also write f δ ω θ and c τ θ for the spectral density function of the discrete time process and the autocovariance function respectively for convenience we shall sometimes refer to the spectral density function of the continuous time process as the spectral density function and the spectral density function of the discrete time process as the aliased spectral density function we also write σ θ for the covariance matrix of the multivariate random variable corresponding to n consecutive random variables from x δ we now describe each of the fitting methods discussed in this paper 3 1 least squares current approaches to estimating parameters of spectral density functions used in the ocean waves literature such as the approaches described by ewans and mcconochie 2018 usually involves two key steps firstly a non parametric estimator of the spectral density function is constructed secondly a curve fitting algorithm is used so that the corresponding parametric form is a good fit for the observed data typically this involves minimising the square distance between the parametric form and non parametric spectral density estimator as such we shall refer to such approaches as least squares fitting techniques for the purpose of this section we let i ω denote a general non parametric spectral density estimator this could be the periodogram i ω bartlett estimator i b ω or some other non parametric spectral density estimator the second part of this fitting routine involves fitting the parametric form to the obtained non parametric estimator typically this is done by minimising the euclidean distance between the non parametric estimator and the parametric spectral density function we therefore must minimise the objective function given by 9 ℓ l s θ x δ n ω ω f ω θ i ω 2 where ω ω n δ the choice of ω is discussed in section 4 1 in other words the least squares estimator for θ is defined as θ ˆ l s argmin θ θ ℓ l s θ x δ n this approach could be adapted to account for aliasing by replacing f ω θ with f δ ω θ the aliased spectral density function however such a modified approach is not currently used in the ocean waves literature and therefore we shall use the form given by 9 in our simulation study part of the reason that least squares performs poorly is that the variance of a spectral estimate will be different at different frequencies this means that low density areas of the spectral density function such as the high frequency tail tend to be under weighted for this reason log transforms are often used in least squares objective functions especially in the statistics literature bloomfield 1973 because standard least squares is widely used in the ocean waves literature we present a comparison of standard least square in this paper however in simulations not shown in this paper log least squares still does not perform as well as the de biased whittle likelihood whilst log least squares does provide better estimates of the spectral tail decay index than standard least squares some of the other parameter estimates have increased bias when compared to standard least squares plots of these log least squares simulations are available on github grainger 2021 3 2 maximum likelihood maximum likelihood inference treats the sea surface data as observations of a random variable with a given distribution the parameters for this distribution are chosen by maximising the probability of observing the data given that the underlying distribution has certain parameters for the moment let the sea surface observations be multivariate gaussian with expectation zero and an unknown covariance matrix σ θ the log likelihood function for observations of such a process is 10 ℓ m l θ x δ n 1 2 n log 2 π log σ θ x δ n t σ θ 1 x δ n where x δ n t denotes the transpose of x δ n the maximum likelihood estimator is then obtained by maximising the log likelihood function more formally the maximum likelihood estimator of θ is θ ˆ m l argmax θ θ ℓ m l θ x δ n provided that the underlying random variable is actually multivariate gaussian this technique will provide asymptotically optimal estimates of θ in the sense that they converge at an optimal rate see pawitan 2001 chapter 8 5 for more details this approach can be computationally expensive because evaluating the objective function given by 10 requires the inversion of an n n matrix also if we want to model a distribution that is not gaussian then a different log likelihood function must be used this may take significantly longer to compute or may not even be tractable as previously discussed wave processes will not typically be precisely gaussian however in section 5 we shall compare fitting techniques on simulated gaussian processes in the first instance in this case full maximum likelihood provides a useful benchmark to compare the performance of other estimators to the optimal choice of estimator 3 3 spectral likelihood to avoid some of the problems associated with maximum likelihood estimation we can use approximations to the likelihood known as pseudo or quasi likelihoods to gain some of the accuracy and precision of maximum likelihood while keeping computational costs and distributional assumptions low one such quasi likelihood 4 4 these likelihoods are usually referred to as quasi likelihoods however we also use the term spectral likelihood as it integrates nicely with current terminology used in the literature as well as giving an intuitive sense of what a spectral likelihood does is known as the whittle likelihood whittle 1953 the whittle likelihood has been used in a wide range of applications due to its computational efficiency and fairly free distributional assumptions in particular we no longer need to assume that the underlying process is gaussian in its discretised form the whittle likelihood is 11 ℓ w θ x δ n ω ω log f ω θ i ω f ω θ where i ω denotes the periodogram ordinate at angular frequency ω the corresponding estimator is again obtained by maximising this spectral likelihood which we shall denote by θ ˆ w argmax θ θ ℓ w θ x δ n this estimator also does not account for aliasing however by replacing f ω θ with f δ ω θ in 11 we obtain an estimator that does account for aliasing we shall refer to this as the aliased whittle likelihood though it should be noted that some authors refer to this as simply the whittle likelihood though this aliased approach accounts for some of the bias in the whittle likelihood other forms of bias introduced through phenomena such as blurring are still present percival and walden 1993 chapter 6 sykulski et al 2019 introduced the de biased whittle likelihood to deal with both aliasing and blurring simultaneously the de biased whittle likelihood is 12 ℓ d w θ x δ n ω ω log f n ω θ i ω f n ω θ where f n ω θ e i ω θ is the expected periodogram as noted by sykulski et al 2019 the expected periodogram can be calculated in o n log n time by using the relation 13 e i ω θ δ 2 π re 2 τ 0 n 1 1 τ n c τ θ exp i ω τ δ c 0 θ the resulting estimator can then be expressed as θ ˆ d w argmax θ θ ℓ d w θ x δ n despite being constructed from the periodogram an inconsistent estimator of the spectral density function the de biased whittle likelihood is a consistent estimator of the parameters for the parametric model the de biased whittle likelihood is able to address the deficiencies in the periodogram without introducing bias by accounting for the finite sample properties of the periodogram sykulski et al 2019 also show that under certain conditions the de biased whittle estimator converges optimally these condition are discussed further in appendix c 3 4 comparison in section 5 we perform a simulation study to compare each of the estimators that we have discussed however we can also try to build some intuition as to why certain approaches are likely to be more effective than others to achieve this we shall consider the conditions in which each technique would be equivalent to full maximum likelihood for a finite sample then evaluate how likely it is that said assumptions are satisfied note that this is not and nor is it intended to be a formal proof results related to the convergence of de biased whittle estimators and their proofs can be found in sykulski et al 2019 rather this is a sketch of what is going on under the hood that causes the de biased whittle likelihood to outperform least squares based techniques maximum likelihood inference works by making probabilistic statements about the distribution of data and then using this to work out the parameter choice that would have been most likely to have given rise to the data in question the part of this process of interest to us here is making such distributional statements for this comparison we shall think of the non parametric spectral density estimates as the data and shall consider what their distribution would need to be for least squares or the whittle likelihood to be the optimum likelihood function for this data 5 5 this differs from full maximum likelihood on the time series as we have lost the phase information in calculating a spectral density estimate then for the least squares approach to yield the same parameter estimates as the optimum likelihood function we would need the non parametric spectral density estimator used in the fitting routine i ω to satisfy the following four assumptions firstly at each frequency the non parametric estimator must be gaussian in general this is not true for non parametric spectral density estimators though it is true asymptotically for some of them e g bartlett s method secondly the expectation of the non parametric estimator must be equal to the spectral density function at a given frequency this is not actually true for non parametric spectral density estimators as these are constructed to estimate the aliased spectral density function not the spectral density function of the continuous time process though this aliasing could be accounted for by modifying the spectral form used in the fitting routine such modification is not standard practice and many non parametric spectral density estimators are still biased thirdly the variance of the non parametric spectral density estimator must be the same for each frequency this is not the case for non parametric spectral density estimators in general as the variance at a given frequency depends on the spectral density function at that frequency brockwell and davis 2006 though weighted least squares approaches such as the approach proposed by chiu 1988 do begin to address the problem of assumption three they are not widely used and still make the first and second assumptions fourthly the non parametric estimators at any two different frequencies must be uncorrelated this assumption is discussed further in section 3 5 for the whittle likelihood to yield the same parameter estimates as the optimum likelihood function we would need the following three assumptions on the periodogram to hold firstly we would require the periodogram to be exponentially distributed at each fourier frequency 6 6 a slightly different assumption is made about the zero and nyquist frequency though in practice they are often omitted secondly we would require that the expectation of the periodogram is equal to the spectral density function at a given frequency and consequently that the variance is the square of the spectral density function thirdly the periodogram at any two different frequencies must be uncorrelated at fixed frequencies the first assumption is true asymptotically for linear processes brockwell and davis 2006 and for some classes of non linear processes shao and wu 2007 at first glance this may seem to be similar to the asymptotic normality of bartlett modified periodograms that are often used in least squares however it should be noted that in the case of the periodogram this asymptotic result is in terms of the number of observations whereas for bartlett modified periodograms this result is in terms of the number of segments that are used which is much smaller when it comes to the second assumption the periodogram is an asymptotically unbiased estimator of the aliased spectral density function for this reason the aliased version of the whittle likelihood should be used over the standard version again it may seem that this is also true for bartlett modified periodograms as bartlett s method averages periodograms and each periodogram is an asymptotically unbiased estimator of the aliased spectral density function therefore if we were to adjust for this aliasing least squares would be justified however each of these component periodograms are calculated from small segments of the full record so it is difficult to invoke asymptotic results indeed this creates somewhat of a catch 22 for bartlett least squares to get asymptotic normality we must average many periodograms but this results in using shorter segments for each periodogram introducing bias and vice versa the de biased whittle likelihood sykulski et al 2019 bypasses the second assumption made by the whittle likelihood altogether as it uses the theoretical expectation of the periodogram in place of the spectral density function this means that even for small sample sizes the de biased whittle likelihood produces estimates with very small to no bias the final assumption the assumption of independence between frequencies is required by both least squares and spectral likelihoods however the whittle likelihood is also in a strong position when it comes to satisfying this assumption this is because asymptotically the periodogram is uncorrelated at different frequencies and we are using the longest periodogram possible given the length of the data of course least squares techniques could be used on the raw periodogram meaning that the second and last assumptions are just as likely to be satisfied as when using spectral likelihoods but in this case the asymptotic normality required for least squares will not be satisfied nor in general will the constant variance assumption when it comes to the final assumption for both least squares and spectral likelihood techniques there are some practical concerns that should be considered in particular when the aliased spectral density has high dynamic range the frequencies are often correlated as we shall shortly show in the case of wind generated waves this issue does not present itself for 1 hz data although for higher sampling frequencies such as 4 hz data the periodogram is often highly correlated to solve this problem we can turn to differencing a technique that is well established for reducing correlations in the periodogram velasco and robinson 2000 3 5 differencing if the periodogram is highly correlated across frequencies spectral likelihoods will perform poorly when compared to full maximum likelihood velasco and robinson 2000 differencing can sometimes provide a convenient mechanism for removing such correlations define the differenced process as y t x t δ x t we briefly switch notation and let c x τ and f x ω denote the autocovariance and spectral density function of x at τ and ω respectively and likewise c y τ and f y ω for the differenced process y first notice that 14 c y τ e y 0 y τ e x δ x τ δ x 0 x τ δ x δ x τ x 0 x τ 2 c x τ c τ δ c τ δ by stationarity then from 2 we can see that 15 f y ω 2 c x τ c τ δ c τ δ exp i τ ω d τ 2 f x ω e i ω δ f x ω e i ω δ f x ω 2 1 cos ω δ f x ω 4 sin 2 ω δ 2 f x ω therefore differencing can be easily incorporated into the fitting techniques that have been discussed in this paper by simply replacing x with the differenced process y and f x with f y using the relation given by 15 consider the correlation matrix of the periodogram the matrix with i j th element defined to be the correlation between the periodogram at the i th and j th fourier frequencies fig 1 shows a plot of the correlation matrix for the periodogram of a wind generated wave process estimated using the technique described in appendix b we can see that for data recorded at a 1 hz sampling rate there is little correlation in the periodogram however this is not the case for 4 hz data we can also see that the periodogram of the differenced process is almost completely uncorrelated even for the 4 hz data 7 7 it should be noted that the region of high correlation in the top left corner of each of the correlation matrices is part of the reason for removing such frequencies from the objective function when performing fits as discussed further in section 4 1 from the signal processing perspective this has reduced the dynamic range of the spectrum as we are multiplying the spectral density function by something that is close to zero for angular frequencies that are small but is close to one near the nyquist down weighting the peak far more than the tail 4 practical concerns for implementation with the generalised jonswap in section 3 we described some techniques that can be used to estimate model parameters when implementing these techniques for ocean wave models there are some practical concerns that must be addressed firstly we need not use all of the fourier frequencies when fitting the model indeed it may be preferable to remove some frequencies that are contaminated by some other process or by observational noise secondly there is no known analytical form for the autocovariance corresponding to many of the spectral density functions used when modelling ocean waves therefore numerical techniques for estimating the autocovariance play an important role in many of the fitting procedures discussed in section 3 in particular it is necessary for both the de biased whittle likelihood and for full maximum likelihood 4 1 frequency selection many of the estimators defined in section 3 involve minimising or maximising objective functions which are expressed as the sum over some set of frequencies ω ω n δ the most simple choice for this set ω is just the set of fourier frequencies ω n δ at first glance this would seem like the most sensible choice as omitting frequencies is essentially the same as throwing away data points however there are many different circumstances in which it is preferable to remove some of the frequencies from the fit one practical reason for removing certain frequencies is that for very low frequencies the generalised jonswap spectra is zero to machine precision this often introduces numerical instabilities especially for objective functions that involve dividing by the spectral density function such as the whittle likelihood as can be seen in fig 1 there is also a region of high correlation in the low frequencies which provides an additional motivation for removing such frequencies an alternative method to reducing correlations in the periodogram is to use tapered versions of the spectral density estimate in the whittle likelihood dahlhaus 1988 but in simulations available on github we found omitting frequencies from the fit to be a better solution than tapering in terms of the resulting bias and variance of parameter estimates another reason for removing certain frequencies from the fit is that it can help to remove noise processes that are present in a record for example wave records often contain a low frequency swell component but we are interested in the parameters of the wind sea component by removing frequencies in which the swell is dominant we are better able to model the wind sea component of a sea state on top of this there is an added technical concern when using the whittle and de biased whittle likelihoods the zero and nyquist frequencies must be omitted or a modified version of the summand must used for those frequencies this is because these methods are based on the asymptotic distribution of the periodogram which is different at the nyquist and zero frequency than it is at other frequencies fitting the model in this way can be thought of as fitting a semi parametric model as some of the frequencies are being modelled using a parametric model and the remaining frequencies by some non parametric model such as the periodogram it is worth noting that this approach can actually be applied to full maximum likelihood as well this can be achieved by transforming both the observations and autocovariance of the model into the frequency domain applying a band pass filter and then transforming back while this is possible in theory it is fiddly in practice and is no longer exact this demonstrates another major advantage of spectral likelihoods it is far easier to filter out undesired frequencies from the model fit however the choice of frequencies to be used in the fit should be made prior to the objective function being optimised otherwise the number of degrees of freedom could be changing throughout the optimisation routine which would likely result in additional bias 4 2 numerical estimation of the autocovariance to calculate both the multivariate gaussian likelihood and de biased whittle likelihood we require the autocovariance of the process given a certain parameter choice in 10 for the multivariate gaussian likelihood and 13 for the de biased whittle likelihood for the generalised jonswap spectra there is no analytical form for this autocovariance as such the autocovariance must be approximated numerically firstly recall that the autocovariance is the fourier transform of the spectral density function as defined in 4 and we wish to obtain the autocovariance at lags 0 δ n 1 δ the first problem we encounter is that this integral is over the entire real line clearly we cannot approximate such an integral numerically and must instead settle for integrating up to some finite frequency such that the spectral density function beyond that frequency is sufficiently small in particular it is convenient to choose a multiple of the nyquist frequency as the integral will be approximated using a fast fourier transform so the desired lags can be extracted by sub sampling if a multiple of the nyquist is used in the integration therefore based on eq 4 we can construct the approximate autocovariance 16 c ˆ τ l π δ l π δ f ω exp i τ ω d ω for l n 1 2 3 alternatively we could consider the relation given in eq 3 between the autocovariance and the discrete time spectral density function in this case we would first need to approximate the spectral density function for the discrete time process to do this we use a truncated version of the relation given by eq 5 between the spectral density of the continuous and discrete time processes consider the approximation of the aliased spectral density function given by 17 f δ ω k k k f ω 2 π k δ for k n 0 0 1 2 then we can construct the alternative approximation to the autocovariance given by 18 c τ π δ π δ f δ ω exp i τ ω d ω notice that we may write 19 c τ π δ π δ k k k f ω 2 π k δ exp i τ ω d ω k k k π δ π δ f ω 2 π k δ exp i τ ω d ω k k k 2 k 1 π δ 2 k 1 π δ f ω exp i τ ω d ω 2 k 1 π δ 2 k 1 π δ f ω exp i τ ω d ω from 19 we can see that if l 2 k 1 then c ˆ τ and c τ are equivalent in practice these integrals must be approximated numerically to do this we consider a riemann approximation with bins of width 2 π m δ by choosing m to be some integer bigger than 2 n we can obtain the desired lags by performing a fast fourier transform and then sub sampling appropriately we can now see that the approximation based on c ˆ τ in 16 can be computed in o l m log l m time however computing the second approximation based on c τ in 18 requires first computing f ω at m frequencies taking o l m operations and then performing a fourier transform on m frequencies requiring o m log m operations in other words the first approach requires o m l log l l log m operations whereas the second only requires o m l log m operations for this reason we use the latter approach when approximating the autocovariance first approximating the aliased spectral density then approximating the autocovariance the choice of k or equivalently l depends on the tail behaviour of the spectral density function in question in practice we choose k so that for frequencies beyond 2 k 1 π δ the spectral density is below some threshold typically 1 0 6 m 2 s rad 1 though k should really be chosen so that it scales with n for convergence results to still apply the choice of m is based on the required accuracy of the integral approximation and should be tuned accordingly for the generalised jonswap we have found that m max 8192 2 n is a good choice 5 simulation study though it is possible to make theoretical statements about the asymptotic behaviour of different estimators from a practical perspective their finite sample behaviour is of primary interest to investigate this we perform a simulation study to assess the performance of the estimators described in section 3 in this simulation study we compare six different fitting techniques based on these estimators the first which we call least squares uses the curve fitting approach with the periodogram the second approach is similar but uses bartlett s method to estimate the spectral density function which we refer to as bartlett least squares the window size is chosen so that we have a spectral resolution of 0 2 π i e the window size is 100 δ 8 8 clearly for some values of δ this would not be an integer however for the values of δ that we choose it is for 1 28 hz data this corresponds to a window size of 128 the third and fourth approaches are the whittle and aliased whittle likelihoods respectively the final two approaches are the de biased whittle likelihood and full time domain maximum likelihood 5 1 method to investigate the effectiveness of different fitting approaches we simulate a linear wave record with a known parametric spectral density function and then re estimate the parameters from the simulated record by repeatedly performing this process we can assess the bias and variance of each of the estimators discussed in section 3 for the purposes of the simulation study we let x δ n be a random variable with a multivariate normal distribution resulting from sub sampling the continuous time mean zero stationary gaussian process x where x has spectral density function f g ω θ defined by 8 we then simulate a realisation of x δ n using the circulant embedding method described by davies and harte 1987 and for complex valued processes by percival 2006 we choose to use circulant embedding over the typical approaches for simulating gaussian processes often used in the ocean waves literature such as the method due to tucker et al 1984 as these methods only approximately simulate a gaussian process with the given spectral density function whereas circulant embedding is exact up to the quality of the approximation of the autocovariance that is used furthermore many techniques such as the method proposed by tucker et al 1984 or the more recent modification due to mérigaud and ringwood 2018 do not account for aliasing when simulating the process since we are explicitly interested in the effect that aliasing has on recovered parameters it is important that we simulate something that is as close as we can get to a gaussian process with the desired aliased spectral density function circulant embedding generates time series with all of the sampling effects discussed by tucker et al 1984 but also includes additional finite sampling effects such as aliasing and correlations between spectral estimates at different frequencies such effects should be present in generated time series but are not in time series generated using the method suggested by tucker et al 1984 more details can be found in davies and harte 1987 dietrich and newsam 1997 and wood and chan 1994 to perform the fitting we first choose one of the objective functions described in section 3 and optimise this using the fmincon function in matlab with maximisation done by minimising the negative of the objective function an initial guess for the fitting procedure needs to be provided for each of the parameters for ω p we use the frequency corresponding to the largest value of the periodogram for r we use a basic linear regression coefficient between the log spectral density and log periodogram over the tail frequencies where the tail is chosen to be all frequencies that are closer to the nyquist than the peak we choose to initialise γ by setting it equal to 3 this is because choosing γ heuristically is not easy and γ 3 is close to the value commonly assumed by many oceanographers in practice the initial choice of γ does not seem to have a huge impact on the final fitted values however the optimisation could also be run with multiple starting values of γ and the best estimate could then be selected once these parameters are initialised α is initialised so that the area under the initial parametric spectral density function matches the area under the periodogram in simulations we find that the inference is not sensitive to the initial guess provided it is sensible in practice we are often fitting models to multiple consecutive sea states in this case it can be more efficient to use the parameter estimates for the previous sea state as initial values when optimising 5 2 a canonical sea state we shall begin by considering how each of the estimators perform for one choice of true parameters before showing that the results are robust to the true parameters in particular we begin by considering a spectral density function of the form described in section 2 2 with σ 1 0 07 σ 2 0 09 and s 4 treated as known and with α 0 7 ω p 0 7 γ 3 3 and r 4 treated as unknown parameters to be estimated the reason for choosing these parameters is that α 0 7 roughly corresponds to the scaling present when using phillip s constant in a jonswap spectra ω p 0 7 is a reasonable choice for peak frequency γ 3 3 is commonly assumed to be the peak enhancement factor and r 4 is one of the suggested values for the tail decay index half hour records sampled at 1 28 hz a standard time interval and sampling frequency for wave records were simulated and the parameters were estimated using each of the six estimation methods described above the resulting estimates across 1000 repeated simulations are summarised in fig 2 alongside the time taken to perform the optimisation for comparison the true value of each parameter is given by a horizontal black dashed line perhaps the most striking feature of fig 2 is the difference in the variability in estimates of the tail parameter r when comparing least squares type techniques to likelihood based techniques least squares techniques recover parameter estimates ranging from well beyond three to five making it very difficult to make any statements about the true value of the tail decay however we can see that statistical techniques such as the de biased whittle likelihood are able to recover the original tail parameter to within a few decimal places therefore by using the de biased whittle likelihood practitioners would be able to distinguish between ω 4 and ω 5 spectral tails in observed records though it should be noted that this assumes the wind sea had a spectral density that is well described by a generalised jonswap and so we cannot provide model free estimates of the tail decay in particular a different model would be required for a transition in tail decays over frequency such as the effect discussed by babanin 2010 however the de biased whittle likelihood is generic and could be applied to other models provided they satisfied certain conditions see appendix c we can also see that the de biased whittle likelihood offers an improvement in estimates of γ performing almost as well as full maximum likelihood it is also interesting that bias can be seen in both the whittle and aliased whittle likelihood estimates but that this bias is not present in the de biased whittle likelihood estimates this verifies that the de biased whittle likelihood is indeed accounting for some of the bias present in standard whittle likelihood and demonstrates why de biased whittle likelihood is necessary over the aliased whittle likelihood which can still be seen to be biased for some parameters in the analysis of fig 2 full maximum likelihood provides the best estimates in terms of root mean square error however this comes at significant computational cost whilst giving limited improvement in bias and variance when compared to the de biased whittle likelihood often during optimisation parameters may trade off against one another therefore it is also important to look at the joint behaviour of parameter estimates fig 3 shows a scatter plot of the de biased whittle likelihood estimates from fig 2 we can see that there is very strong correlation between the estimates of α and r and some negative correlation between α and γ this likely occurs because γ and r change the area under the spectral density function so α is likely to be adjusted to compensate though it would be possible to reparameterise to try and avoid this it does not seem to have a significant impact on the resulting estimates and is therefore not necessary in practice longer sea states are often used to estimate model parameters therefore we also compare some of the methods for 3 h records fig 4 shows the comparison of least squares bartlett least squares and de biased whittle likelihood estimates for these 3 h records the variance in the first two estimators has indeed decreased when compared to the estimates from half hour records shown in fig 2 however by comparing the de biased whittle likelihood estimates in fig 2 to the least squares estimates in fig 4 we can see that the de biased whittle likelihood used on a half hour record yields better estimates than the least squares based estimates performed on 3 h records the longer record reduces the variance of the least squares and bartlett least squares techniques enough to allow us to see another interesting feature namely that there is significant bias present in the bartlett least squares estimates that is not present in the standard least squares estimates this demonstrates that non parametric smoothing can have unexpected consequences when used to fit a parametric spectral density function in essence by using the de biased whittle likelihood we can obtain more accurate and precise parameter estimates whilst simultaneously reducing the length of the record required to obtain the estimates this improvement is especially noticeable and important for the peak enhancement factor γ and tail decay index r in practice this has two important consequences firstly we can reduce the amount of time for which the surface is assumed to be stationary this means that we can fit stationary models to weather systems that evolve very quickly such as tropical cyclones secondly we can obtain parameter estimates at more frequent time intervals this higher parameter resolution means that we gain a more detailed insight into how certain parameters evolve throughout the course of a meteorological event 5 3 robustness of results in section 5 2 we have demonstrated that the de biased whittle likelihood can produce parameter estimates that are both more accurate and more precise than those produced by least squares techniques without making huge sacrifices in terms of computational time however it is also important to check that these results extend to different choices of the true parameter in table 1 we present the results of a simulation study comparing least squares bartlett least squares and the de biased whittle likelihood over 24 different choices of true parameter for each choice of true parameter we calculated the percentage bias standard deviation sd and root mean square error rmse of the estimates relative to the true parameter we then averaged over all the choices of true parameter yielding an average percent bias sd and rmse for each parameter the parameter choices used to perform these simulations were all the combinations of α 0 7 ω p 0 7 0 9 1 2 γ 1 2 3 3 5 and r 4 5 boxplots for each set of parameter choices are available on github grainger 2021 we can see from table 1 that there are substantial reductions in both the bias and standard deviation of all the estimated parameters true parameters on the boundary of the parameter space can cause problems when performing parametric estimation as such we shall further discuss the results for the special case when γ 1 the fitted parameters for half hour simulated records with true parameter values α 0 7 ω p 0 7 γ 1 and r 5 using the least squares bartlett least squares and de biased whittle likelihood techniques can be seen in fig 5 this is an interesting case because not only does the true parameter lie on the boundary of the parameter space but this value of γ corresponds to a pierson moskowitz spectrum for a fully developed sea this means that such a value of γ could occur in nature and as such it is important that we can model this case the problem is that the theoretical guarantees for an approach such as the de biased whittle likelihood rely on the assumption that the true parameter does not lie on the boundary of the parameter space since this is not the case for γ 1 therefore we must take care when dealing with records for which the true value of γ may indeed be 1 in particular we can see from fig 5 that the de biased whittle likelihood estimates for γ is not normally distributed a result that is assumed when constructing the confidence intervals that are described later in section 6 one way to deal with this problem is to fit both a model with γ 1 fixed and one with γ as a free parameter and then test to see if there is evidence for γ 1 such a procedure allows us to circumvent potential issues caused by γ lying on the boundary of the parameter space this could be performed by using the procedure developed by sykulski et al 2017 adapted to the 1d case 5 4 differencing for high sampling frequencies as we discussed in section 3 5 for wind generated waves observed at a 4 hz sampling rate the periodogram is highly correlated as noted in section 3 4 in this case we would expect spectral techniques to perform poorly compared to full maximum likelihood differencing can reduce the correlation in the periodogram and therefore can be a powerful tool to remove bias from spectral methods fig 6 shows box plots of estimated parameters for least squares bartlett least squares and de biased whittle likelihood techniques both with and without differencing for both 1 hz and 4 hz data in this case 2048 s worth of data was simulated per record i e 2048 observations for the 1 hz simulation and 8192 for the 4 hz simulation we can see little benefit from differencing in the 1 hz estimates fig 6 a however when it comes to 4 hz data there is a major benefit to differencing especially for the de biased whittle likelihood because there is little difference between the de biased whittle fits on the original and differenced 1 hz data we would recommend that differencing is used as standard to protect against the issues seen in fig 6 b at the very least investigating the correlation matrix of the periodogram should be an important diagnostic when fitting spectral models 6 quantifying estimation uncertainty as with any statistical analysis it is important to quantify the uncertainty in the parameter estimates that are obtained using the de biased whittle likelihood sykulski et al 2019 developed an approach for quantifying the asymptotic variance of the estimator for a single time series say that we have p parameters that are written in a vector θ and are interested in the de biased whittle likelihood estimator θ ˆ d w of the true parameter vector θ sykulski et al 2019 decompose the variance as 20 var θ ˆ d w e h θ 1 var ℓ d w θ e h θ 1 where h θ denotes the matrix of second derivatives of the log likelihood function ℓ d w θ and denotes the vector of first derivatives of ℓ d w θ now for the de biased whittle likelihood we may write 21 θ j ℓ d θ ω ω 1 f n ω θ i ω f n 2 ω θ f n ω θ θ j for j 1 p as will be seen in appendix b this is required to calculate var ℓ d w θ additionally we may write 22 e 2 θ j θ k ℓ d θ ω ω 1 f n 2 ω θ f n ω θ θ j f n ω θ θ k for j k 1 p therefore we require only the first derivative of the expected periodogram in order to compute both parts of the variance decomposition given by 20 furthermore the triangle function and fourier basis are constant with respect to θ so from 13 we have that 23 θ j f n ω θ δ 2 π re 2 τ 0 n 1 1 τ n c τ θ θ j exp i ω τ δ c 0 θ θ j for j 1 p in other words to calculate the derivative of the expected periodogram we may first calculate the derivative of the autocovariance then calculate the expected periodogram of the process with that derivative as its autocovariance in the case of the generalised jonswap spectral density function when an analytical form for such autocovariance is unavailable we may instead approximate the derivative of the autocovariance by first approximating the derivatives of the aliased spectral density function and then of the autocovariance in appendix a we show that for the generalised jonswap form partial derivatives of f δ ω θ can be calculated from the derivatives of the spectral density function and that the resulting derivatives are continuous therefore by leibniz s rule 24 θ j c τ θ π δ π δ f δ ω θ θ j exp i ω τ d ω as a result we may approximate the derivative of the autocovariance from the derivative of the aliased spectral density function in the same way that we approximated the autocovariance from the aliased spectral density function in section 4 therefore each partial derivative can be computed in the same time it would take to do one function evaluation which is faster than using numerical approximations for the derivative e g finite differencing methods in appendix b we discuss a novel procedure for estimating var ℓ d w θ in a computationally efficient manner combining this with the approach for obtaining derivatives we can estimate the variance of the de biased whittle likelihood estimator using 20 this enables the computation of approximate confidence intervals for our estimates by using the asymptotic normality of the estimator and standard theory for confidence intervals 7 maui data observations of fetch limited seas made near the maui a platform off the coast of new zealand between november 1986 and november 1987 have been studied previously by ewans and kibblewhite 1986 and ewans 1998 we revisit these observations to demonstrate additional practical concerns when applying the techniques discussed in this paper to observed wave records observations were taken using a datawell wavec buoy at a location with a water depth of 110 m data were recorded for 20 min at a sampling rate of 1 28 hz then there is a gap of 10 min while data is processed non parametric spectral density estimates were recorded for each of these intervals while the raw time series was only retained for the first 20 min of a 3 h segment in other words a 20 min record is available starting at 00 00 03 00 06 00 etc for each day for the sake of illustration we shall analyse the behaviour of spectral parameters throughout a single storm event from the 2nd to the 7th of november 1986 9 9 note that this is not intended to make general statements about the behaviour of these parameters rather we are illustrating some of the additional practical concerns faced when analysing recorded wave time series as can be seen from fig 7 throughout the first and second days the conditions become steadily more severe before calming down over the proceeding days transforming to the frequency domain we see the presence of persistent swell which remains fairly constant throughout all of the records parameters of the wind sea component of these bi modal seas are estimated by first removing contaminated frequencies from the objective function with optimisation proceeding as previously described 10 10 this can be thought of as first applying a high pass filter then fitting a uni modal model to the resulting filtered record ideally we would aim to fit a bi modal model that was designed to also describe the swell component however such an approach is beyond the scope of this paper though we note that preliminary results for such a procedure are encouraging and are discussed further in section 8 it was also observed that frequencies beyond 3 rad s 1 exhibited a different behaviour from the rest of the spectral tail we suspect this may be related to the physical response of the buoy to the waves though we do not know exactly how such behaviour should be modelled therefore we also chose to omit those frequencies in the spectral fitting procedure when using each of the fitting procedures after filtering out the aforementioned frequencies a generalised jonswap spectral form was fitted to each of the sea states in turn using least squares bartlett least squares and the de biased whittle likelihood these estimates are shown in fig 7 a from fig 7 a we can see that especially for the tail index the de biased whittle estimates seem more stable than both the least squares and bartlett least squares estimates fig 7 b shows the de biased whittle likelihood estimates and approximate 95 point wise confidence intervals calculated using the technique described in section 6 it is worth noting that these confidence intervals are based on the asymptotic distribution of the estimator in particular we assume asymptotic normality of the estimator this is especially problematic for values near to or on the boundary of the parameter space as the confidence interval may include values outside the boundary to represent this in fig 7 b we only shade regions of the confidence interval that are within the parameter space such confidence intervals enable us to better understand and communicate the uncertainty surrounding parameter estimates this uncertainty we argue should be considered when using these parameters as inputs for other related models from fig 7 b we can see that the parameters behave broadly as expected when moving through the storm we see a steady evolution in peak frequency throughout the growth of the wind sea component alongside large values of γ as the storm is developing after this point the values of γ reside close to 1 we can also see that there is a greater level of uncertainty when h s was low this is because there is very little energy in the wind sea component however as the storm evolves this uncertainty quickly reduces the uncertainty surrounding the peak enhancement factor remains fairly high through the second half of the first day even when the uncertainty around other parameters has reduced this is because when the true value of γ is large at frequencies around the peak the periodogram has more variance and it is these frequencies that contain the information about γ a useful diagnostic tool for spectral models can be constructed by noticing that under certain technical conditions i ω e i ω θ should be approximately exponentially distributed with mean 1 brockwell and davis 2006 where i ω denotes the periodogram this result is specific to the periodogram and is not true in general for non parametric spectral density estimators therefore if we calculate this ratio for a given model at each fourier frequency we can then compare the quantiles of these fractions to the quantiles of an exponential distribution with mean 1 using a q q plot figs 8 a and 8 b show the periodograms and fitted models on both the standard scale and the decibel scale respectively for 4 time periods during the early development of the storm fig 8 c shows the corresponding q q plots which demonstrate how well each of the models fits the data the closer the points on the q q plot are to the reference line y x the better we can see from fig 8 c that the de biased whittle likelihood consistently outperforms the other techniques plots for the remaining sea states are available on github grainger 2021 8 discussion and conclusion the de biased whittle likelihood has been shown to yield major improvements in both the bias and variance of estimated parameters for wind generated waves in particular the tail decay index can be estimated to much greater levels of accuracy and precision than when using least squares techniques such an improvement will enable reliable tracking of the tail decay index s behaviour throughout the course of meteorological events allowing oceanographers to gain fresh insights into the behaviour of wind generated waves we have also demonstrated some improvement in the estimation of the peak enhancement factor the de biased whittle estimator recovers estimates that are of similar quality to full maximum likelihood which can be thought of as optimal since information about the peak enhancement factor is contained in a small region around the peak frequency it is not surprising that it is so hard to estimate because there is significant variability in estimates of the peak enhancement factor it is essential that we can describe uncertainty surrounding parameter estimates when performing an analysis for this reason the development of computationally efficient techniques for quantifying uncertainty surrounding the estimated parameters is important we have shown that the method presented by sykulski et al 2019 for estimating the variance of the de biased whittle estimator can be modified so that it can be computed using 2d fast fourier transforms combining this with an analytical approach for calculating derivatives we are able to calculate the uncertainty in parameter estimates accurately and quickly in addition differencing can be used so that we can cope with high sampling frequency data which tend to be correlated in the frequency domain as we discussed previously when performing simulations we chose to use circulant embedding davies and harte 1987 to obtain realisations of gaussian processes with the desired covariance matrix this is different to the standard method used for simulating linear ocean waves presented by tucker et al 1984 or to the adapted version due to mérigaud and ringwood 2018 which is preferable the first difference is that the standard waves method is only approximate and does not exactly simulate a gaussian process with the desired covariance equivalently spectral density the second is that these methods do not account for the aliasing that we would expect to be present in a record essentially treating the spectral density as if it is zero beyond the nyquist frequency though for many applications this will not matter the methods discussed in this paper will be sensitive to this difference if the simulated record does not have the aliasing that should be present then the parameters estimated using the de biased whittle likelihood will seem biased and standard whittle will often seem better this is important because if a method such as tucker et al 1984 was used to perform the simulation study described in this paper the results would be different as likelihood based estimation will be sensitive to this problem which could be thought of as model miss specification as we are trying to fit a model with a non zero density beyond the nyquist to a process that has been simulated with no density above the nyquist least squares is somewhat invariant to this problem as it mainly effects frequencies where the spectral density function is small and least squares is not heavily influenced by such frequencies we have also developed a matlab toolbox implementing the methods discussed in this paper this is available alongside code to generate the figures in this paper and additional supplementary figures on github grainger 2021 the toolbox contains code to perform each of the fitting techniques discussed in this paper on arbitrary processes as well as a function implementing the generalised jonswap including first and second derivatives which can then be used straight out the box on top of this the user may provide any spectral density function they wish provided it satisfies the assumptions in appendix c and then use the toolbox to obtain parameter estimates from observations alongside this an implementation of circulant embedding is provided enabling exact simulation of a desired gaussian process though the de biased whittle likelihood has been seen to perform well in the estimation of wind seas we have yet to fully explore its potential when we wish to describe multi modal seas e g including one or more swell components in this paper we were able to describe the wind sea component of such sea states by first removing swell with a high pass filter however it would be preferable to develop and fit models that were bi modal themselves avoiding the need for partitioning schemes to determine which frequencies should be filtered indeed such a procedure could be extended to describe seas with any number of components using model selection to determine the number of components that are actually present such techniques could also allow for the development of model based partitioning schemes that would separate overlapping wind sea and swell components in the development of such multi modal models it would be important to consider the interactions between different component weather systems in particular techniques such as higher order spectral analysis could be used to determine if any non linear interactions were present and help characterise them such interactions could then also be parameterised and fitted using similar techniques to those discussed in this paper another important aspect of wind generated waves is their directional characteristics one approach to describing these is to assume some dispersion relation between wave number and frequency and then look at frequency direction spectra which can be estimated for example from heave pitch roll buoys longuet higgins et al 1963 however it may preferable to model the three recorded series instead requiring the use of a multivariate extension to the de biased whittle likelihood these are all important avenues of further investigation in summary we have demonstrated that by using the de biased whittle likelihood we are able to obtain more accurate and precise estimates of parameters for the wind sea component of a wind generated wave process in o n log n time using differencing we are able to overcome correlations in the periodogram that are common in data sampled at a high frequency furthermore we have described a procedure which can be used to obtain the variance of such estimates in o n 2 log n time together these developments will improve the tools available to practitioners both in terms of fitting models to data and describing the associated uncertainty credit authorship contribution statement jake p grainger conceptualisation methodology software validation formal analysis investigation writing visualisation adam m sykulski conceptualisation methodology formal analysis writing philip jonathan conceptualisation methodology writing visualisation kevin ewans conceptualisation methodology resources data curation writing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements j p grainger s research was funded by the uk engineering and physical sciences research council grant ep l015692 1 and jba trust the work of a m sykulski was funded by the uk engineering and physical sciences research council grant ep r01860x 1 we thank rob lamb of jba and lancaster university uk for discussions we also thank two anonymous reviewers for their feedback appendix a derivatives of ocean wave spectra when calculating the derivatives of the generalised jonswap form special care must be taken around the peak frequency and zero frequency to check that the generalised jonswap form is actually differentiable we do not show this here but for the first derivatives there is no issue though this is not the case for the second derivatives which do not all exist at the peak consider the generalised jonswap spectral form f g ω θ we may write for ω 0 ω f g ω θ α 2 ω r exp r s ω ω p s γ δ ω θ r ω p ω ω p s 1 r ω δ ω θ ω ω p log γ ω p 2 σ ω θ 2 f g ω θ r ω p ω ω p s 1 r ω δ ω θ ω ω p log γ ω p 2 σ ω θ 2 0 as ω 0 α f g ω θ ω r exp r s ω ω p s γ δ ω θ 2 f g ω θ α 0 as ω 0 ω p f g ω θ α 2 ω r exp r s ω ω p s γ δ ω θ δ ω θ log γ ω σ ω θ 2 ω ω p ω p 3 ω r ω p 2 ω ω p s 1 f g ω θ δ ω θ log γ ω σ ω θ 2 ω ω p ω p 3 ω r ω p 2 ω ω p s 1 0 as ω 0 γ f g ω θ α ω r exp r s ω ω p s δ ω θ γ δ ω θ 1 2 f g ω θ δ ω θ γ 0 as ω 0 r f g ω θ α ω r exp r s ω ω p s γ δ ω θ log ω 1 s ω ω p s 2 f g ω θ log ω 1 s ω ω p s 0 as ω 0 by the chain rule for ω 0 ω f g ω θ ω f g ω θ α f g ω θ α f g ω θ ω p f g ω θ ω p f g ω θ γ f g ω θ γ f g ω θ r f g ω θ r f g ω θ finally for ω 0 since f g 0 α ω p γ r 0 we may write ω f g ω θ ω 0 0 α f g 0 θ 0 ω p f g 0 θ 0 γ f g 0 θ 0 r f g 0 θ 0 therefore we see that f g has continuous first derivatives proposition 1 for all x ω α ω p γ r the series k x f g ω 2 π k δ θ converges uniformly proof firstly due to symmetry we may consider the series k l x f g ω 2 π k δ θ where l is such that ω p π δ 2 π l δ now write g k ω θ f g ω 2 π k δ θ and g k x ω θ x f g ω 2 π k δ θ next notice that g k ω θ α γ ω 2 π k δ r α γ π δ 2 π k δ r α γ π δ r 2 k 1 r let m k α γ π δ r 2 k 1 r it now suffices to notice that each of the partial derivatives can be written as f g ω θ multiplied by some other function furthermore each of these functions can be bounded therefore we may write g k x ω θ c x m k for some constants c x 0 finally k l m k so by the weierstrass m test we have uniform convergence by extension we can see that k x f g ω 2 π k δ θ is also uniformly convergent proposition 2 for all x ω α ω p γ r x f δ ω θ k x f g ω 2 π k δ θ furthermore x f δ ω θ is continuous proof this first part follows from proposition 1 the convergence of k f g ω 2 π k δ θ the continuous differentiability of f g and theorem 4 4 20 of trench 2013 the continuity follows from the continuity of the derivatives of f g and the uniform limit theorem appendix b computing the variance of the first derivative sykulski et al 2019 decompose the variance of the first derivative of the de biased whittle likelihood as follows var θ i ℓ d w θ j 1 n k 1 n a i j θ a i k θ cov i ω j i ω k where ω j ω k denote fourier frequencies and a i j θ f n ω θ θ i 1 f n 2 ω j θ to estimate the variance they propose using var ˆ θ i ℓ d w θ j 1 n k 1 n a i j θ ˆ d w a i k θ ˆ d w cov ˆ i ω j i ω k for ocean wave models a i j θ ˆ d w can be easily computed by using the results from appendix a so from sykulski et al 2019 we are interested in computing cov ˆ i ω j i ω k δ 2 π n π δ π δ f δ ω θ d n δ ω j ω d n δ ω k ω d ω 2 where d n v sin n v 2 sin v 2 e i v n 1 2 to do this efficiently first note that d n v sin n v 2 sin v 2 e i v n 1 2 e i n v 2 e i n v 2 e i v 2 e i v 2 e i v n 1 2 e i n v 2 e i v 2 e i n v 1 e i v 1 e i v n 1 2 e i n 1 v 2 e i v n 1 2 s 0 n 1 e i s v by geometric series e i n v s 0 n 1 e i s v it is also convenient to write d n v sin n v 2 sin v 2 e i v n 1 2 e i v s 0 n 1 e i s v now consider the function h j k ω f δ ω θ d n δ ω j ω d n δ ω k ω f δ ω θ e i n δ ω j ω s 0 n 1 e i s δ ω j ω e i δ ω k ω r 0 n 1 e i r δ ω k ω e i δ n ω j ω k s 0 n 1 r 0 n 1 e i s δ ω j e i r δ ω k f δ ω θ e i δ n 1 ω e i δ s r ω where we have rearranged for later convenience we can now see by linearity of integration that π δ π δ h j k ω d ω e i δ n ω j ω k s 0 n 1 r 0 n 1 e i s δ ω j e i r δ ω k π δ π δ f δ ω θ e i δ n 1 ω e i δ s r ω d ω thus for r 0 n 1 and s 0 n 1 we must calculate π δ π δ f δ ω θ e i δ n 1 ω e i δ r s ω d ω notice that by letting t r s we need to calculate the following integral for t 0 2 n 1 1 π δ π δ f δ ω θ e i δ n 1 ω e i δ t ω d ω for clarity let q ω f δ ω θ e i δ n 1 ω then we need to compute 25 q t π δ π δ q ω e i δ t ω d ω for t 0 2 n 2 we notice that this is a fourier transform and we can obtain an approximation of this integral at each of the required t by doing an fft on the relevant length 2 n 1 sequence the details of this are discussed in appendix b 1 this means that we only need to do one fourier transform and can then sub this into the previous sums now we require π δ π δ h j k ω d ω e i δ n ω j ω k s 0 n 1 r 0 n 1 e i s δ ω j e i r δ ω k q r s e i δ n ω j ω k s 0 n 1 r 0 n 1 q r s e i δ 2 π r k s j n δ e i δ n ω j ω k s 0 n 1 r 0 n 1 q r s e i 2 π r k s j n where q r s q r s this is a 2d fourier transform and can be computed efficiently for j k 0 n 1 this means we take o n 2 log n time importantly libraries exist to compute this very quickly in most programming languages finally cov ˆ i ω j i ω k δ 2 π n π δ π δ h j k ω d ω 2 δ 2 π n e i δ n ω j ω k s 0 n 1 r 0 n 1 q r s e i 2 π r k s j n 2 δ 2 π n s 0 n 1 r 0 n 1 q r s e i 2 π r k s j n 2 b 1 approximating q t note that we must still approximate q t at t 0 2 n 2 we aim to approximate the integral in 25 to achieve this we use the riemann sum given by 26 q t 2 π m δ j 0 m 1 q 2 π j m δ e i t δ 2 π j m δ an fft will produce values of q t for t 0 1 m 1 therefore provided m 2 n 1 we can obtain approximations of the desired integrals appendix c assumptions for de biased whittle theorem 1 of sykulski et al 2019 gives assumptions for the optimal convergence of the de biased whittle likelihood estimator the first of these assumptions is that the parameter space is compact with non null interior and that the true value of the parameter lies in the interior of the parameter space this is not strictly satisfied by the generalised jonswap spectral density however for physical reasons the parameter space can be restricted so that it is compact the greater problem is that a value of γ 1 which corresponds to the fully developed sea described by pierson and moskowitz 1964 may occur in nature and would violate this assumption in section 5 3 we demonstrate that in this case the de biased whittle likelihood estimator still performs well the second assumption is that the spectral density of the aliased process is bounded above and is bounded below by some positive real number this is satisfied by the generalised jonswap spectral density the aliased spectrum is bounded below by the non aliased spectrum and is bounded above by the variance of x t which is finite therefore the only frequency remaining to consider is zero as the spectral density is zero when ω 0 however contributions from above the nyquist frequency are positive and as such the aliased spectral density at zero will also be positive assumption three relates to parameter identifiability informally this requires the aliased spectral density function to be different for different choices of θ intuitively provided the sampling interval is sufficiently small so that the peak frequency is smaller than the nyquist then each of the parameters is changing the shape of the generalised jonswap spectrum in a different way such that the parameters will in general be identifiable for a sufficient sample size the fourth assumption states that the aliased spectral density function must be continuous in θ and riemann integrable in ω this is satisfied for the generalised jonswap spectral form as it is continuous in θ and ω assumption five states that the expected periodogram has two continuous derivatives in θ and that these derivatives are bounded uniformly for all n furthermore the first derivatives are required to have θ n non zero frequencies strictly speaking the generalised jonswap is not twice differentiable the second derivative does not exist at the peak due to the step function σ ω θ however a simple adaptation can be made by replacing σ ω θ with 27 σ ω θ σ 1 σ 2 σ 1 1 2 1 π arctan c ω ω p where c 0 is chosen to be large this has the advantage of having continuous second derivatives and is essentially equivalent to the generalised jonswap because c can be chosen such that it would be impossible to distinguish between the two models from observed data since this part of the generalised jonswap was developed empirically there is no practical difference in using the step function over this reformulation indeed in keeping with the general philosophy of statistical modelling all models are wrong but some models are useful we suggest that this alternative formulation is just as appropriate as the generalised jonswap but more useful here as it allows us to show this assumption is satisfied by similar arguments to those presented in appendices a and b we can see that the aliased spectral density has continuous second derivatives the autocovariance then has continuous second derivatives by a similar argument to that in section 6 and noting that the second derivative of the aliased spectral density function is integrable and so therefore the second derivative of the autocovariance must be continuous as they can be shown to be fourier pairs therefore the expected periodogram also has continuous second derivatives by linearity of derivatives and the fact that linear combinations of continuous functions are continuous these derivatives are also bounded uniformly for all n due to the compactness of the set of frequencies ω and the parameter space θ the final assumption states that the process in question is fourth order stationary with finite fourth order moments and absolutely summable fourth order cumulants clearly this is true for a gaussian process as second order stationarity implies strict stationarity for gaussian and it is also true for some non linear processes such as the class of non linear processes discussed by sykulski et al 2019 finally in our simulations the estimator based on the de biased whittle likelihood performs in broad agreement with the theory for example we observed desirable properties such as root n convergence when exploring different values of n we also did not find any problems with local minima during optimisation for any of the record lengths considered suggesting that the parameters of the generalised jonswap form are indeed identifiable in practice for sufficiently long records 
20798,in this paper a fully nonlinear unsteady potential flow method is used to predict added resistance heave and pitch for the kvlcc2 hull in regular head waves at design speed the method presents a nonlinear decomposition of the velocity potential and the wave field and an adaptive grid refinement a formulation for the acceleration potential is used to obtain the pressure to improve computational efficiency a barnes hut algorithm is introduced a grid dependency study and a study on the impact of different time steps on the solution are performed numerical results have been compared with experimental data for the design speed a general good agreement is found for added resistance especially for longer waves heave and pitch are properly computed for all wave lengths in the range λ l p p 0 4 to 1 4 keywords fully nonlinear boundary element method acceleration potential adaptive grid refinement kvlcc2 1 introduction due to the increasing demand of transport of goods at sea across the planet and thanks to a constantly improving technology fleet and ship sizes have been growing steadily in order to reduce pollution in the maritime sector the marine environment protection committee mepc of the international maritime organization imo has introduced rules to address energy efficiency of new ships the energy efficiency design index eedi has been included in those rules and it represents the carbon dioxide c o 2 produced per ship s capacity mile to estimate the c o 2 emitted the operational scenario of the engine propeller system is needed therefore to obtain a reliable evaluation of the eedi the resistance has to be predicted with good accuracy historically the power required to reach the design speed was estimated based on the evaluation of the resistance in calm water there is an expected increase of around 15 30 in the resistance when a ship is sailing in a seaway the so called sea margin was applied to the power estimated from the calm water calculations resulting in an approximately 15 larger power installed the attention now is moving towards the evaluation of the ship performances when sailing in a seaway without relying on an approximate approach which added a 15 to the power predicted there are three ways to predict the performances of a ship sailing in waves empirical methods numerical calculations and model tests since model tests are quite expensive and time consuming designers often rely on numerical methods for a large portion of the design process there are different types of numerical methods available to evaluate the performances of a ship sailing in a seaway the most advanced and accurate methods used nowadays to evaluate added resistance and ship motions are based on the unsteady reynolds averaged navier stokes equations urans see for instance el moctar et al 2010 or sadat hosseini et al 2013 even though these methods can provide accurate results they are still quite demanding in terms of computational effort for this reason they are not widely used during the early stages of the design process or to optimize the hull forms more common are analytical formulations and potential flow methods when it comes to potential flow methods there are several ways to evaluate the added resistance the far field approach was introduced by maruo 1957 and modified in the following years by himself and by joosen 1966 some years later following the method proposed by maruo gerritsma and beukelman 1972 introduced the radiated energy approach to evaluate added resistance in head waves the so called near field method was initially introduced by faltinsen et al 1980 with this method the resistance is evaluated by integrating the hydrodynamic pressure on the hull surface in the same paper faltinsen proposed also a simplified formulation to obtain added resistance in short waves where the method presented some deficiencies the near field method has been widely applied in recent years with the evolution of potential flow codes towards nonlinear time domain methods joncquez et al 2008 and liu et al 2011 computed added resistance for multiple hull forms using different 3d panel methods and applied both the far field and near field approaches to compare results joncquez used a 3d time domain high order boundary element method with neumann kelvin nk and double body db linearizations to compute the forces while liu used a 3d frequency domain panel method and a hybrid time domain rankine source green function method kim et al 2012 computed added resistance using a time domain rankine panel method with nk and db linearizations applying both the far and near field approaches guha and falzarano 2015 adopted a green function panel method to estimate the added resistance with a near field approach for a number of different hulls and compared the results with other numerical methods and with model tests in recent last years an increasing number of fully nonlinear potential flow methods have been presented engsig karup et al 2009 developed a fully nonlinear 3d potential flow method to simulate water waves and ducrozet et al 2010 extended it for wave wave and wave structure interaction in the case of a fixed circular cylinder mola et al 2017 developed a fully nonlinear potential flow method adding a pressure patch in the stern area and used it to evaluate the performances of different hulls in calm water in the work presented here shipflow motions a fully nonlinear unsteady potential flow boundary element code based on a mixed eulerian lagrangian mel approach as presented in kjellberg et al 2011 and kjellberg et al 2012 is extended to include a nonlinear decomposition of the velocity potential and the wave field a barnes hut algorithm and an adaptive grid refinement scheme are introduced for computational efficiency as well as an acceleration potential approach for the pressure this allows for a finer discretization around the hull and at areas of the free surface where a finer resolution is required results are presented for added resistance heave and pitch for the kvlcc2 hull in regular head waves at design speed grid and time step refinement studies are included as well as comparisons with experimental results carried out at sspa sweden ab 2 mathematical model 2 1 coordinate systems to describe the position and the orientation of the hull and the forces acting on it three coordinate systems are used an earth fixed right handed coordinate system with its origin at an arbitrary point on the initial free surface the free surface evolution and the equations governing the flow are expressed in this system a body fixed coordinate system with its origin at the center of gravity of the ship this system is used to express the forces acting on the ship a body fixed inertial coordinate system this system is centered on the vertical line passing through the center of gravity and placed on the waterplane it is only allowed to move on the horizontal plane and it is used to describe the motion of the ship 2 2 boundary value problem in order to simulate the flow around a hull sailing in a seaway the navier stokes equation has to be solved since this is quite expensive in terms of computational power a number of simplifying hypotheses can be introduced if we assume that the fluid is homogeneous inviscid incompressible and irrotational there exists a scalar quantity referred to as velocity potential φ that describes the flow the velocity potential is defined as 1 φ φ x φ y φ z u v w u substituting equation 1 into the continuity equation for incompressible fluids we obtain laplace s equation 2 2 φ 0 2 2 1 free surface boundary conditions to solve this partial differential equation which defines the boundary value problem bvp boundary conditions have to be introduced on the boundaries of the domain on the free surface the kinematic and dynamic boundary conditions are applied being x x y z the position of a fluid particle on the free surface the fully nonlinear kinematic and dynamic boundary conditions are respectively 3 d x d t d x d t d y d t d z d t u v w φ 4 d φ d t g z 1 2 φ φ p a ρ where g is the gravitational acceleration ρ is the fluid density and p a is the atmospheric pressure d d t is the material derivative and is defined as 5 d d t t φ 2 2 2 body boundary conditions neumann type boundary conditions are applied on the instantaneous wetted body surface and on the bottom of the domain imposing no flow through such surfaces i e impermeability condition 6 φ n φ n n u ω r where n is the normal to the surface pointing into the fluid domain u and ω are the translational and angular velocities and r is the distance between the surface and the center of rotation on the bottom an impermeability condition is applied 7 φ n 0 2 3 unsteady pressure and forces the total pressure on the hull is given by bernoulli s equation 8 p ρ φ t 1 2 φ 2 g z the hydrodynamic forces acting on the body can then be computed by integrating the pressure over the wetted hull surface 9 f s b p n d s where f f 1 f 2 f 3 and the moments according to 10 f s b p r n d s where f f 4 f 5 f 6 2 4 acceleration potential the partial time derivative of the velocity potential φ t appears in the unsteady bernoulli equation this term can be obtained using a backward difference scheme if the rigid body motions is known however for a free floating body this typically causes problems with stability one way of getting around this is to directly calculate φ t from its boundary conditions as proposed by kang and gong 1990 this method is based on a modal decomposition of the rigid body acceleration components which implies the solution of n 1 additional bvp where n is the number of degrees of freedom of the rigid body 2 5 nonlinear decomposition to increase the efficiency of the computations a nonlinear decomposition of the solution as described by ducrozet et al 2010 is adopted the free surface elevation ζ and the velocity potential φ are decomposed into an incident and a scattered part where the incident terms describe the undisturbed incident wave field and the scattered terms describe any disturbance to the incident wave field 11 ζ ζ i ζ s φ φ i φ s in practice this means that for a computation with no incident wave field i e calm water the incident wave elevation ζ i and the incident velocity potential φ i are zero and the total solution is represented fully by the scattered part in the presence of an incident wave field ζ s and φ s contain the disturbance by the hull and the effects of the interactions between this disturbance and the incident wave field the decomposition results in a new formulation of the free surface boundary conditions 12 d x d t φ i φ s 13 d φ d t g z 1 2 φ i φ s φ i φ s p a ρ since the incident wave field is a solution to the laplace problem the laplace problem for the scattered solution becomes 14 2 φ s 0 x d φ s φ φ i x s f φ s n v ω r n φ i n x s b for the fluid domain d bounded by the free surface s f and the wetted body surface s b note that the free surface boundary conditions 12 and 13 have to be evaluated at the total surface elevation ζ ζ i ζ s this means that the incident part of the potential φ i also has to be evaluated at the total surface elevation ζ also note that the free surface evolution tracking in time is done for the total solution scattered plus incident in order not to loose nonlinear effects the pressure can finally be calculated in two different ways where the scattered part is either evaluated by means of backward differences φ d s t or based on the acceleration potential φ p s t 15 p d ρ φ i t φ d s t 1 2 φ 2 g z 16 p p ρ φ i t φ p s t 1 2 φ 2 g z 3 numerical method in this section some details of the method are discussed since the method is unsteady a scheme for the integration in time has to be introduced a fourth order runge kutta is used for the first four time steps while a fourth order adams bashforth moulton method is adopted for the remaining part of the simulation 3 1 boundary element method the bvp described in section 2 2 is solved using a boundary element method bem the surface of the ship and the free surface are discretized by means of flat quadrilateral panels with an unknown constant strength source distribution to obtain the source strength σ the green s function is used given two points p and q on the domain green s function is defined as 17 g 1 4 π r p q where 18 r p q x p x q 2 y p y q 2 z p z q 2 if there are only sources on the boundary of the domain the velocity potential at a point p becomes using green s theorem 19 φ p 1 α s g φ q n d s where s is the boundary of the domain n is the normal direction of the panel α is the solid angle and g is the green s function and represents the potential of a source the solid angle α is equal to 1 if p is inside the domain and 1 2 if p belongs to the boundary for a point p in the fluid domain then the velocity potential is 20 φ p 1 4 π s 1 r p q σ q d s 3 2 free surface evolution in the formulation described above the time dependency is introduced by the fully nonlinear boundary conditions on the free surface the evolution in time of the free surface is obtain with a mixed eulerian lagrangian mel approach introduced by longuet higgins and cokelet 1976 using markers tracing the free surface and its velocity potential with this methodology each step is divided into two sub steps 1 eulerian step the bvp is solved by means of the bem at the end of this step the velocity potential and velocity at the markers are calculated 2 lagrangian step the free surface boundary conditions defined in equations 21 and 22 are integrated in time and the position of the markers is updated once the lagrangian step is finished a new free surface mesh is generated by interpolating the surface elevation in addition the boundary conditions for the next eularian step are obtained by interpolating the velocity potential of the markers the interpolation can handle sets of structured or unstructured points by enforcing a single valued free surface thin plate splines can be used for this purpose 3 3 damping zone in order to avoid unwanted reflection from the domain boundaries a damping zone is introduced the damping zone ensures that the solutions from the inner and outer domain match at the intersection due to the presence of a body in the inner domain the velocity potential is expected to be different compared with the outer domain which is known a priori the damping zone phases out this difference introducing a damping term in the free surface boundary conditions for the extension of the damping zone 21 d x d t φ i φ s ν x damp 22 d φ d t g z 1 2 φ i φ s φ i φ s p a ρ ν φ damp where ν is a damping factor based on a quadratic function of the generalised space variable s 23 ν s 0 for s s 0 μ s s 0 2 for s s 0 in which s 0 marks the beginning of the artificial damping zone and μ is a tuning factor due to the decomposition of the velocity potential the damping function is only applied to the scattered part and is expressed as 24 x damp 0 0 ζ s φ damp φ s 3 4 free surface mesh generation the code presented here uses an automatic unstructured free surface mesh generation the mesh generator which is embedded in the code re evaluates the free surface at the end of each lagrangian step the body is meshed before the first time step only the domain is discretized with quadrilateral panels of varying dimensions following the scheme presented in section 3 4 1 3 4 1 adaptive mesh refinement to increase efficiency and accuracy of the computations an adaptive mesh refinement is used this is also possible thanks to the decomposition of the velocity potential which allows for a coarser discretization away from the bodies the adaptive mesh refinement is applied on the free surface while on the hull the panelization is kept constant during a simulation an initial refinement is applied on the hull too based on local curvature furthermore a refined band on panels is added around the waterline and on the bow and stern an example of the refinement around the stern for the kvlcc2 can be seen in fig 1 on the free surface instead an adaptive refinement scheme is used at each time step if a criterion is met every time a criterion is met for a panel this is split recursively into four sub panels the user specifies a maximum level of refinement which represents the maximum number of subdivisions a panel can go through there are two criteria that trigger the refinement one is connected with the intersection between the free surface and the hull and the second one is based on the curvature of the scattered free surface elevation ζ s regardless of the criterion though there will never be two neighboring panels with more than one level difference between the two on the intersection between the free surface and the hull the panels have the maximum level of refinement moving away from the hull the levels are linearly decreased it can happen that when a panel is split into its four sub panels due to the presence of the hull one of these can end up being completely inside the hull this sub panel will then be discarded and the refinement will continue on those cut by the intersection between free surface and the hull since the domain is discretized by quadrilateral panels at the end of this process there will still be gaps between the free surface and the hull even for the maximum level of refinement to get rid of these gaps the hanging nodes of the panels closest to the hull are stretched until the waterline the nodes can be stretched along a grid line or diagonally the direction d s for the stretching is chosen to avoid overlaps with neighboring panels the panel p on the body closest to the hanging node n is used to evaluate the distance d the node has to be stretched for the algorithm then moves the node along d s for a fraction of d until the node is on the hull the comparison of the intersection between the hull and the free surface before and after the stretching can be seen in fig 2 as far as the criterion on the curvature is concerned the refinement is triggered if the curvature between two control points in the vertical plane exceeds a fixed value in this way it is possible to have a coarse representation of the incoming waves and have a finer mesh on the waves generated by the hull a comparison between the initial time step with the hull at rest and the final one with the generated waves for the kvlcc2 in calm water can be seen in fig 3 since the method is fully nonlinear it means that the boundary conditions have to be applied on the exact free surface location to satisfy this requirement the mesh generator and consequentially the refinement scheme are called at each sub time step of the adam bashforth moulton method 3 5 barnes hut algorithm in order to further decrease the computational effort a barnes hut algorithm presented by barnes and hut 1986 is used thanks to this algorithm the computational effort needed to solve bvp decreases from o n 2 to o n log n with this algorithm panels are grouped together in nodes based on the distance of an area of interest when the bvp is solved the panels belonging to one node are treated as a single panel furthermore the further away the node is from the point of interest the smaller the influence of the node on it grouping more panels into a single node will result in a faster computation at the expenses of the accuracy this can be controlled by the user specifying the ratio between the dimensions of a node i e how many panels it contains and the distance at which the influence of the node fades away the barnes hut algorithm was initially introduced to deal with astrophysics simulations where the influence of gravity decreases with 1 r 2 since the influence of the velocity potential varies with a 1 r function some problems in accuracy can arise to deal with this problem a multipole expansion method is adopted 4 simulations setup in this section a description of the setup of the numerical simulations is given a more detailed insight about the mesh resolution on the free surface and what different levels mean will be given in section 5 the hull used for this study is the kvlcc2 tanker and the numerical results are compared with the experimental tests carried out at sspa sweden ab the ship has been tested at the design speed of 15 5 k n in head waves for wave lengths going from λ 0 4 l p p to λ 1 4 l p p with 0 1 interval the main particulars of the ship are given in table 1 the scale factor is λ 68 to properly replicate the conditions of the towing tank the body hull is towed using a set of springs the stiffness of the springs is the same of those used in the towing tank at the beginning of the simulation the ship is at rest to have a smooth transition from rest to the prescribed speed an acceleration ramp is imposed to keep the transient as little as possible the discretized domain is set as follow it extends for 3 l p p upstream and 3 l p p downstream from the centerplane of the ship and for 2 l p p sidewards the domain and the extension of the damping zone can be seen in fig 4 in the figure it is possible to see the variation of the strength of the damping factor ν s as presented in section 3 3 from zero in the vicinity of the hull to its maximum value on the domain boundaries since only calm water and head waves are simulated a symmetry condition is applied on the longitudinal plane the length of the simulations is set in order to have a number of encounter periods between the ship and the incoming waves which ensures a convergence in the forces the number of encounter periods goes from a maximum of 100 for λ 0 4 l p p to a minimum of 44 for λ 1 4 l p p the time step is set in relation to the fundamental wave period of the steady generated waves calculated based on the froude number for the grid dependency described in section 5 the time step is set equal to 30 time steps per fundamental period a more detailed description of the time stepping and the investigation on how this affects the solution is presented in section 6 the incoming waves replicate the ones tested in the model basin the wave steepness s w h w λ is equal to 0 02 for wave lengths up to λ 0 9 l p p and 0 01 for longer waves due to the depth of the tank a deep water condition can be assumed for waves no longer than λ 1 4 l p p 5 grid convergence a grid dependency study has been carried out to find the best compromise between accuracy and computational time this study focuses on the resolution of the free surface while the mesh on the hull is the same for all the cases as mentioned in section 3 4 the mesh on the hull is refined around the intersection with the waterplane and around high flared areas for this study a total number of approximately 5 3k panels are used to discretize half of the hull the hull can be seen in fig 5 and has the same mesh for all simulations 5 1 definition of the cases as far as the free surface is concerned both criteria that trigger the refinement are varied and analyzed separately in table 2 an overview of the different settings is provided initially the same maximum level of refinement is kept on the intersection between the free surface and the hull and on the curvature of the free surface these cases correspond to group a ids 1 2 and 3 in the table note that it is not possible to have a higher resolution on the free surface based on the curvature than around the waterplane afterward for group b cases 4 5 and 6 the level around the hull is kept constant and the level on the curvature is varied in this way since the mesh around the hull does not change it is possible to analyze the influence of the resolution of the generated waves on the solution throughout this study the initial base grid is the same the number of panels with a level zero of refinement in x and y direction are 36 and 12 respectively the last part of the grid convergence analysis consisted in varying the base grid corresponding to cases 7 8 and 9 group c in the table compared to the reference case the size of the area of the panels of the base grid was varied with a factor of 2 5 2 calm water to summarize the study can be divided into three steps as can be seen in table 2 in the table it is also possible to see the initial and final number of panels on the free surface in calm water and the number of panel along the waterline wl note that cases 3 6 and 8 represent the same condition a visual representation of the calm water simulations with a fully developed wave system can be seen in fig 7 due to the adaptive grid refinement the number of panels for each simulation varies in time since the ship starts at rest there is no refinement at the initial time step due to the curvature of the free surface as the ship reaches the prescribed speed the number of panels will increase and it will oscillate around a mean value in fig 6 it is possible to see the time series of the number of panels for the case 2 in waves with wave length λ 1 2 l p p it can be relevant to compare the number of panels per fundamental wave length as well the fundamental wave length is calculated as λ 2 π f n 2 l the number of panels per fundamental wave length is obtained on the waterline and on a longitudinal wave cut at y 0 15 l p p 2 l p p long which starts 0 25 l p p forward of the fore perpendicular and pointing downstream the values for the different cases are reported in table 3 since cases 3 4 5 6 and 8 have the same refinement on the intersection between the hull and the free surface they have the same number of panels per wave length 5 3 head waves to analyze the convergence of different meshes and find a compromise between accuracy and computational time the cases listed in table 2 were tested with incoming head waves to assess the convergence added resistance coefficient and non dimensional heave and pitch were compared the added resistance r a w in head waves is defined as the difference between the resistance in waves r w and the resistance in calm water r c the added resistance coefficient is defined as 25 c a w r a w ρ g a 2 b 2 l p p being b the breadth of the ship and a the wave amplitude heave and pitch are nondimensionalized with wave amplitude and wave slope respectively in fig 8 the variation of the added resistance coefficient with the number of panels in waves for wave lengths λ 0 6 1 0 1 2 l p p can be observed in figs 9 and 10 the influence of the number of panels on heave and pitch can be seen for the same wave lengths since the total number of panels on the free surface varies with time an average value of the tail of the simulation is taken as can be seen the variation for the motions is very limited while bigger discrepancies are found for the added resistance coefficient nevertheless the biggest discrepancies for added resistance can be seen for case 1 2 and 4 these cases represent the coarsest resolutions and for cases 1 and 2 there are not enough panels around the waterline to properly resolve the forces acting on the hull the other important aspect to keep in mind when selecting the mesh resolution is the computational time needed to run the simulations in table 4 the computational time t c for the different cases is reported for some of the wave lengths the computations were run on 4 cores on an intel i7 7700k cpu 4 20 ghz in the table the computational time per wave encounter is also presented this value represents an average is obtained dividing the total computational time with the number of encounter periods the case with id number 4 was not run on the same computer therefore the time is not reported 5 4 selection combining the information given in figs 8 10 on the convergence of the forces with the one in table 4 we can say the best compromise between accuracy and computational effort is given by cases 5 and 7 although cases 3 6 and 8 which represent the same condition provide closer results to case 9 which is the finest mesh they require higher computational time compared to cases 5 and 7 in order to select a case between 5 and 7 it is worth to look at contour plots and at a wave cut for the calm water simulations the wave cuts at y 0 15 l p p are shown in fig 11 and the contour plots in fig 12 as can be seen case 7 gives closer results in terms of wave cut to case 8 as well as a slightly better resolved wave system therefore case 7 is selected for the comparison with experimental results 6 time step dependency after the grid dependency was performed a grid resolution was selected for the comparison with the experimental data the case selected for the comparison is case 7 as discussed in section 5 4 after a quick comparison with the experimental data it was observed that a further investigation was needed for the short waves range before proceeding with the comparison with the experimental results then the influence of the time step on the solution was investigated as mentioned in section 4 the time step for the simulations is based on the fundamental wave length λ 2 π f n 2 l for the grid dependency a number of 30 time steps per fundamental wave period was chosen for this investigation three more values were selected 15 45 and 60 steps per fundamental wave period since the value of the time step and the length of the simulations are the same for all the wave lengths the number of time steps per encounter period will vary for the different cases in table 5 the number of time steps per encounter period can be observed for different wave lengths for all the cases the added resistance coefficient was evaluated for different wave lengths using different time step sizes the wave lengths used range from λ 0 4 l p p to λ 0 9 l p p in fig 13 the added resistance coefficient is shown contour plots for λ 0 5 l p p for the different cases are shown in fig 14 there are two main points that can be highlighted from fig 13 first of all there is a clear convergence increasing the number of steps per fundamental period although the contour plots of fig 14 seem quite similar the difference in the added resistance coefficient is not negligible especially for shorter waves furthermore the relative difference between the four cases diminishes with increasing wave length as reported in seo et al 2014 in short waves nonlinearities play an important role in the evaluation of added resistance since the code used here assumes fully nonlinear boundary conditions and the forces are obtained from the direct integration of the nonlinear pressure on the hull surface the discrepancies in the short waves range could be mainly due to an insufficient number of time steps for these cases as can be seen in table 5 the case selected for the comparison with experimental results is the one with 45 steps per fundamental wave period as can be seen for fig 13 the difference between this case and the case with 60 steps is very small furthermore there is a significant change in computational time 7 results the selection of the mesh and the time step size was discussed in sections 5 4 and 6 the comparison with experimental data is presented in this section the experimental conditions are reported in section 4 three different runs were performed in the towing tank and are visible in the following figures for a correct estimation of the added resistance it is important that the motions are evaluated correctly in figs 15 and 16 the comparison for heave and pitch is shown simulated heave and pitch match extremely well the experimental data in the small waves range for longer waves a very good agreement can still be seen although heave and pitch are slightly overpredicted in fig 17 it is possible to see the comparison between the simulated added resistance coefficient from the current fully nonlinear potential flow and the ones obtained with model tests and from other simulations available in literature the other methods used for comparison are a linear potential flow presented in hizir et al 2019 a partially nonlinear potential flow method and an euler method presented in seo et al 2014 and an urans method presented in sadat hosseini et al 2013 as can be seen except for the linear potential flow method there is a general good agreement between the current work and the other computations and the model test results especially for waves longer than λ 1 0 l p p for short waves there is a higher scatter in the results since the forces in waves are closer in value to the one obtained in calm water even a small difference will result in a bigger discrepancy in the added resistance coefficient it must be pointed out also that the wave steepness for the present method was the same as in the experiments s w 1 50 for λ 0 9 and s w 1 100 for 0 9 λ 1 4 while the steepness for the other methods was s w 1 60 for the linear potential flow s w 1 40 for the partially nonlinear potential flow and euler method and s w 1 53 for the urans method 8 discussion in the work presented here a fully nonlinear potential flow boundary element method has been used to evaluate added resistance heave and pitch for the kvlcc2 tanker in head waves in this context fully nonlinear means that the method is expected to capture all nonlinearities that are not due to viscosity the fully nonlinear kinematic and dynamic boundary conditions are applied on the free surface the wavy intersection between the hull and the free surface is computed and updated in each time step geometrical nonlinearities due to the variation of the water plane area are captured interactions between incoming waves diffraction waves radiation waves and waves due to the speed of the hull are all captured simultaneously in the total velocity potential methods based on the potential flow approximation are however limited to cases where the influence of viscous effects on the area covered by potential flow are expected to be small a thin boundary layer developing along a hull has a small effect while the flow downstream of a blunt stern is dominated by viscous effects and cannot be captured accurately by potential flow the results presented here were in good agreement with experimental results and with other methods nevertheless it must be pointed out that only small wave steepness values were used for the simulations and the froude number is not high when stepping outside of these conditions problems could arise due to the potential flow assumption when it comes to the speed of the hull the current method is not able to simulate pre planing and planing regimes in order to obtain the lift vortices or prescribed flow would have to be included another problem that would arise when simulating a planing hull is the presence of sprays and breaking waves produced by the hull which cannot be replicated by a potential flow method similarly to the sprays and breaking waves produced by the hull too steep waves cannot be simulated either since they would result in breaking waves and overturning waves 9 conclusion in the paper presented here an unsteady fully nonlinear potential flow method is used to evaluate added resistance and vertical motions for the kvlcc2 tanker hull numerical results are compared with experiments the code uses an adaptive grid refinement which allows for a finer mesh around the hull and a coarser representation of the domain further away increasing accuracy and efficiency of the computations this is well paired with the nonlinear decomposition of the velocity potential used in the code which further increase the efficiency since the potential of the incoming waves is known coarser representation of the domain can be used away from the hull in order to reduce the computational time a barnes hut algorithm is implemented in the code furthermore a formulation for the acceleration potential is introduced in order to reduce the numerical error deriving from the differentiation of the velocity potential in the bernoulli s equation before comparing the numerical results with the experimental data a grid dependency study was performed aimed at finding the best compromise between computational effort and accuracy of the results as can be seen in the figures presented in section 5 small variations in the solution can be observed excluding cases 1 2 and 4 where not enough panels are used to discretize the domain especially around the waterline for cases 1 and 2 to achieve a good agreement with experimental data the resolution of the grid has to be at least as fine as the one used for case 7 increasing the number of panels though the computational time per encounter period rises with a factor of almost 2 between two consecutive refinements before performing the comparison with the experimental data a time step dependency study was performed it was noted that this had an influence on short waves and the difference between different time step sizes diminished with increasing wave length although contour plots did not show any major difference between the different possibilities a clear convergence was visible when looking at the added resistance coefficient finally the numerical results for heave and pitch match very well with the experimental data for all wave lengths the added resistance coefficient was compared with experimental results and with other numerical methods including linear potential partially nonlinear potential flow euler method and urans and a general good agreement is found for shorter waves there is a bigger discrepancy but the added resistance is still comparable to experimental results and the other methods for this range even a small deviation in the estimation of the force could lead to bigger differences in terms of added resistance coefficient furthermore different numerical methods used different waves steepness as presented in section 7 making it hard to compare the results it is not possible to conclude from this comparison that any method is significantly superior to the others for the kvlcc2 case when looking at the total computational time it must be kept in mind that several encounter periods are simulated they range between 44 for the case λ 1 4 l p p up to 100 for the shortest waves nevertheless there is room for improvement in terms of computational time when it comes to the code itself first of all the code has not been optimized yet as far as computational efficiency is concerned another key aspect to keep in mind is that with the current method for the acceleration potential one laplace problem is solved for each degree of freedom there are more efficient ways to deal with this issue which will be implemented in the future on the other hand the pre process phase is very efficient there is an automatic mesh generator within the program which allows to create the mesh on the hull at the first time step and which continues to mesh the free surface during every time step credit authorship contribution statement francesco coslovich investigation martin kjellberg software validation writing review editing magnus östberg software validation writing review editing carl erik janson supervision funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this research is funded by chalmers university of technology the experimental results were provided by sspa sweden ab 
20798,in this paper a fully nonlinear unsteady potential flow method is used to predict added resistance heave and pitch for the kvlcc2 hull in regular head waves at design speed the method presents a nonlinear decomposition of the velocity potential and the wave field and an adaptive grid refinement a formulation for the acceleration potential is used to obtain the pressure to improve computational efficiency a barnes hut algorithm is introduced a grid dependency study and a study on the impact of different time steps on the solution are performed numerical results have been compared with experimental data for the design speed a general good agreement is found for added resistance especially for longer waves heave and pitch are properly computed for all wave lengths in the range λ l p p 0 4 to 1 4 keywords fully nonlinear boundary element method acceleration potential adaptive grid refinement kvlcc2 1 introduction due to the increasing demand of transport of goods at sea across the planet and thanks to a constantly improving technology fleet and ship sizes have been growing steadily in order to reduce pollution in the maritime sector the marine environment protection committee mepc of the international maritime organization imo has introduced rules to address energy efficiency of new ships the energy efficiency design index eedi has been included in those rules and it represents the carbon dioxide c o 2 produced per ship s capacity mile to estimate the c o 2 emitted the operational scenario of the engine propeller system is needed therefore to obtain a reliable evaluation of the eedi the resistance has to be predicted with good accuracy historically the power required to reach the design speed was estimated based on the evaluation of the resistance in calm water there is an expected increase of around 15 30 in the resistance when a ship is sailing in a seaway the so called sea margin was applied to the power estimated from the calm water calculations resulting in an approximately 15 larger power installed the attention now is moving towards the evaluation of the ship performances when sailing in a seaway without relying on an approximate approach which added a 15 to the power predicted there are three ways to predict the performances of a ship sailing in waves empirical methods numerical calculations and model tests since model tests are quite expensive and time consuming designers often rely on numerical methods for a large portion of the design process there are different types of numerical methods available to evaluate the performances of a ship sailing in a seaway the most advanced and accurate methods used nowadays to evaluate added resistance and ship motions are based on the unsteady reynolds averaged navier stokes equations urans see for instance el moctar et al 2010 or sadat hosseini et al 2013 even though these methods can provide accurate results they are still quite demanding in terms of computational effort for this reason they are not widely used during the early stages of the design process or to optimize the hull forms more common are analytical formulations and potential flow methods when it comes to potential flow methods there are several ways to evaluate the added resistance the far field approach was introduced by maruo 1957 and modified in the following years by himself and by joosen 1966 some years later following the method proposed by maruo gerritsma and beukelman 1972 introduced the radiated energy approach to evaluate added resistance in head waves the so called near field method was initially introduced by faltinsen et al 1980 with this method the resistance is evaluated by integrating the hydrodynamic pressure on the hull surface in the same paper faltinsen proposed also a simplified formulation to obtain added resistance in short waves where the method presented some deficiencies the near field method has been widely applied in recent years with the evolution of potential flow codes towards nonlinear time domain methods joncquez et al 2008 and liu et al 2011 computed added resistance for multiple hull forms using different 3d panel methods and applied both the far field and near field approaches to compare results joncquez used a 3d time domain high order boundary element method with neumann kelvin nk and double body db linearizations to compute the forces while liu used a 3d frequency domain panel method and a hybrid time domain rankine source green function method kim et al 2012 computed added resistance using a time domain rankine panel method with nk and db linearizations applying both the far and near field approaches guha and falzarano 2015 adopted a green function panel method to estimate the added resistance with a near field approach for a number of different hulls and compared the results with other numerical methods and with model tests in recent last years an increasing number of fully nonlinear potential flow methods have been presented engsig karup et al 2009 developed a fully nonlinear 3d potential flow method to simulate water waves and ducrozet et al 2010 extended it for wave wave and wave structure interaction in the case of a fixed circular cylinder mola et al 2017 developed a fully nonlinear potential flow method adding a pressure patch in the stern area and used it to evaluate the performances of different hulls in calm water in the work presented here shipflow motions a fully nonlinear unsteady potential flow boundary element code based on a mixed eulerian lagrangian mel approach as presented in kjellberg et al 2011 and kjellberg et al 2012 is extended to include a nonlinear decomposition of the velocity potential and the wave field a barnes hut algorithm and an adaptive grid refinement scheme are introduced for computational efficiency as well as an acceleration potential approach for the pressure this allows for a finer discretization around the hull and at areas of the free surface where a finer resolution is required results are presented for added resistance heave and pitch for the kvlcc2 hull in regular head waves at design speed grid and time step refinement studies are included as well as comparisons with experimental results carried out at sspa sweden ab 2 mathematical model 2 1 coordinate systems to describe the position and the orientation of the hull and the forces acting on it three coordinate systems are used an earth fixed right handed coordinate system with its origin at an arbitrary point on the initial free surface the free surface evolution and the equations governing the flow are expressed in this system a body fixed coordinate system with its origin at the center of gravity of the ship this system is used to express the forces acting on the ship a body fixed inertial coordinate system this system is centered on the vertical line passing through the center of gravity and placed on the waterplane it is only allowed to move on the horizontal plane and it is used to describe the motion of the ship 2 2 boundary value problem in order to simulate the flow around a hull sailing in a seaway the navier stokes equation has to be solved since this is quite expensive in terms of computational power a number of simplifying hypotheses can be introduced if we assume that the fluid is homogeneous inviscid incompressible and irrotational there exists a scalar quantity referred to as velocity potential φ that describes the flow the velocity potential is defined as 1 φ φ x φ y φ z u v w u substituting equation 1 into the continuity equation for incompressible fluids we obtain laplace s equation 2 2 φ 0 2 2 1 free surface boundary conditions to solve this partial differential equation which defines the boundary value problem bvp boundary conditions have to be introduced on the boundaries of the domain on the free surface the kinematic and dynamic boundary conditions are applied being x x y z the position of a fluid particle on the free surface the fully nonlinear kinematic and dynamic boundary conditions are respectively 3 d x d t d x d t d y d t d z d t u v w φ 4 d φ d t g z 1 2 φ φ p a ρ where g is the gravitational acceleration ρ is the fluid density and p a is the atmospheric pressure d d t is the material derivative and is defined as 5 d d t t φ 2 2 2 body boundary conditions neumann type boundary conditions are applied on the instantaneous wetted body surface and on the bottom of the domain imposing no flow through such surfaces i e impermeability condition 6 φ n φ n n u ω r where n is the normal to the surface pointing into the fluid domain u and ω are the translational and angular velocities and r is the distance between the surface and the center of rotation on the bottom an impermeability condition is applied 7 φ n 0 2 3 unsteady pressure and forces the total pressure on the hull is given by bernoulli s equation 8 p ρ φ t 1 2 φ 2 g z the hydrodynamic forces acting on the body can then be computed by integrating the pressure over the wetted hull surface 9 f s b p n d s where f f 1 f 2 f 3 and the moments according to 10 f s b p r n d s where f f 4 f 5 f 6 2 4 acceleration potential the partial time derivative of the velocity potential φ t appears in the unsteady bernoulli equation this term can be obtained using a backward difference scheme if the rigid body motions is known however for a free floating body this typically causes problems with stability one way of getting around this is to directly calculate φ t from its boundary conditions as proposed by kang and gong 1990 this method is based on a modal decomposition of the rigid body acceleration components which implies the solution of n 1 additional bvp where n is the number of degrees of freedom of the rigid body 2 5 nonlinear decomposition to increase the efficiency of the computations a nonlinear decomposition of the solution as described by ducrozet et al 2010 is adopted the free surface elevation ζ and the velocity potential φ are decomposed into an incident and a scattered part where the incident terms describe the undisturbed incident wave field and the scattered terms describe any disturbance to the incident wave field 11 ζ ζ i ζ s φ φ i φ s in practice this means that for a computation with no incident wave field i e calm water the incident wave elevation ζ i and the incident velocity potential φ i are zero and the total solution is represented fully by the scattered part in the presence of an incident wave field ζ s and φ s contain the disturbance by the hull and the effects of the interactions between this disturbance and the incident wave field the decomposition results in a new formulation of the free surface boundary conditions 12 d x d t φ i φ s 13 d φ d t g z 1 2 φ i φ s φ i φ s p a ρ since the incident wave field is a solution to the laplace problem the laplace problem for the scattered solution becomes 14 2 φ s 0 x d φ s φ φ i x s f φ s n v ω r n φ i n x s b for the fluid domain d bounded by the free surface s f and the wetted body surface s b note that the free surface boundary conditions 12 and 13 have to be evaluated at the total surface elevation ζ ζ i ζ s this means that the incident part of the potential φ i also has to be evaluated at the total surface elevation ζ also note that the free surface evolution tracking in time is done for the total solution scattered plus incident in order not to loose nonlinear effects the pressure can finally be calculated in two different ways where the scattered part is either evaluated by means of backward differences φ d s t or based on the acceleration potential φ p s t 15 p d ρ φ i t φ d s t 1 2 φ 2 g z 16 p p ρ φ i t φ p s t 1 2 φ 2 g z 3 numerical method in this section some details of the method are discussed since the method is unsteady a scheme for the integration in time has to be introduced a fourth order runge kutta is used for the first four time steps while a fourth order adams bashforth moulton method is adopted for the remaining part of the simulation 3 1 boundary element method the bvp described in section 2 2 is solved using a boundary element method bem the surface of the ship and the free surface are discretized by means of flat quadrilateral panels with an unknown constant strength source distribution to obtain the source strength σ the green s function is used given two points p and q on the domain green s function is defined as 17 g 1 4 π r p q where 18 r p q x p x q 2 y p y q 2 z p z q 2 if there are only sources on the boundary of the domain the velocity potential at a point p becomes using green s theorem 19 φ p 1 α s g φ q n d s where s is the boundary of the domain n is the normal direction of the panel α is the solid angle and g is the green s function and represents the potential of a source the solid angle α is equal to 1 if p is inside the domain and 1 2 if p belongs to the boundary for a point p in the fluid domain then the velocity potential is 20 φ p 1 4 π s 1 r p q σ q d s 3 2 free surface evolution in the formulation described above the time dependency is introduced by the fully nonlinear boundary conditions on the free surface the evolution in time of the free surface is obtain with a mixed eulerian lagrangian mel approach introduced by longuet higgins and cokelet 1976 using markers tracing the free surface and its velocity potential with this methodology each step is divided into two sub steps 1 eulerian step the bvp is solved by means of the bem at the end of this step the velocity potential and velocity at the markers are calculated 2 lagrangian step the free surface boundary conditions defined in equations 21 and 22 are integrated in time and the position of the markers is updated once the lagrangian step is finished a new free surface mesh is generated by interpolating the surface elevation in addition the boundary conditions for the next eularian step are obtained by interpolating the velocity potential of the markers the interpolation can handle sets of structured or unstructured points by enforcing a single valued free surface thin plate splines can be used for this purpose 3 3 damping zone in order to avoid unwanted reflection from the domain boundaries a damping zone is introduced the damping zone ensures that the solutions from the inner and outer domain match at the intersection due to the presence of a body in the inner domain the velocity potential is expected to be different compared with the outer domain which is known a priori the damping zone phases out this difference introducing a damping term in the free surface boundary conditions for the extension of the damping zone 21 d x d t φ i φ s ν x damp 22 d φ d t g z 1 2 φ i φ s φ i φ s p a ρ ν φ damp where ν is a damping factor based on a quadratic function of the generalised space variable s 23 ν s 0 for s s 0 μ s s 0 2 for s s 0 in which s 0 marks the beginning of the artificial damping zone and μ is a tuning factor due to the decomposition of the velocity potential the damping function is only applied to the scattered part and is expressed as 24 x damp 0 0 ζ s φ damp φ s 3 4 free surface mesh generation the code presented here uses an automatic unstructured free surface mesh generation the mesh generator which is embedded in the code re evaluates the free surface at the end of each lagrangian step the body is meshed before the first time step only the domain is discretized with quadrilateral panels of varying dimensions following the scheme presented in section 3 4 1 3 4 1 adaptive mesh refinement to increase efficiency and accuracy of the computations an adaptive mesh refinement is used this is also possible thanks to the decomposition of the velocity potential which allows for a coarser discretization away from the bodies the adaptive mesh refinement is applied on the free surface while on the hull the panelization is kept constant during a simulation an initial refinement is applied on the hull too based on local curvature furthermore a refined band on panels is added around the waterline and on the bow and stern an example of the refinement around the stern for the kvlcc2 can be seen in fig 1 on the free surface instead an adaptive refinement scheme is used at each time step if a criterion is met every time a criterion is met for a panel this is split recursively into four sub panels the user specifies a maximum level of refinement which represents the maximum number of subdivisions a panel can go through there are two criteria that trigger the refinement one is connected with the intersection between the free surface and the hull and the second one is based on the curvature of the scattered free surface elevation ζ s regardless of the criterion though there will never be two neighboring panels with more than one level difference between the two on the intersection between the free surface and the hull the panels have the maximum level of refinement moving away from the hull the levels are linearly decreased it can happen that when a panel is split into its four sub panels due to the presence of the hull one of these can end up being completely inside the hull this sub panel will then be discarded and the refinement will continue on those cut by the intersection between free surface and the hull since the domain is discretized by quadrilateral panels at the end of this process there will still be gaps between the free surface and the hull even for the maximum level of refinement to get rid of these gaps the hanging nodes of the panels closest to the hull are stretched until the waterline the nodes can be stretched along a grid line or diagonally the direction d s for the stretching is chosen to avoid overlaps with neighboring panels the panel p on the body closest to the hanging node n is used to evaluate the distance d the node has to be stretched for the algorithm then moves the node along d s for a fraction of d until the node is on the hull the comparison of the intersection between the hull and the free surface before and after the stretching can be seen in fig 2 as far as the criterion on the curvature is concerned the refinement is triggered if the curvature between two control points in the vertical plane exceeds a fixed value in this way it is possible to have a coarse representation of the incoming waves and have a finer mesh on the waves generated by the hull a comparison between the initial time step with the hull at rest and the final one with the generated waves for the kvlcc2 in calm water can be seen in fig 3 since the method is fully nonlinear it means that the boundary conditions have to be applied on the exact free surface location to satisfy this requirement the mesh generator and consequentially the refinement scheme are called at each sub time step of the adam bashforth moulton method 3 5 barnes hut algorithm in order to further decrease the computational effort a barnes hut algorithm presented by barnes and hut 1986 is used thanks to this algorithm the computational effort needed to solve bvp decreases from o n 2 to o n log n with this algorithm panels are grouped together in nodes based on the distance of an area of interest when the bvp is solved the panels belonging to one node are treated as a single panel furthermore the further away the node is from the point of interest the smaller the influence of the node on it grouping more panels into a single node will result in a faster computation at the expenses of the accuracy this can be controlled by the user specifying the ratio between the dimensions of a node i e how many panels it contains and the distance at which the influence of the node fades away the barnes hut algorithm was initially introduced to deal with astrophysics simulations where the influence of gravity decreases with 1 r 2 since the influence of the velocity potential varies with a 1 r function some problems in accuracy can arise to deal with this problem a multipole expansion method is adopted 4 simulations setup in this section a description of the setup of the numerical simulations is given a more detailed insight about the mesh resolution on the free surface and what different levels mean will be given in section 5 the hull used for this study is the kvlcc2 tanker and the numerical results are compared with the experimental tests carried out at sspa sweden ab the ship has been tested at the design speed of 15 5 k n in head waves for wave lengths going from λ 0 4 l p p to λ 1 4 l p p with 0 1 interval the main particulars of the ship are given in table 1 the scale factor is λ 68 to properly replicate the conditions of the towing tank the body hull is towed using a set of springs the stiffness of the springs is the same of those used in the towing tank at the beginning of the simulation the ship is at rest to have a smooth transition from rest to the prescribed speed an acceleration ramp is imposed to keep the transient as little as possible the discretized domain is set as follow it extends for 3 l p p upstream and 3 l p p downstream from the centerplane of the ship and for 2 l p p sidewards the domain and the extension of the damping zone can be seen in fig 4 in the figure it is possible to see the variation of the strength of the damping factor ν s as presented in section 3 3 from zero in the vicinity of the hull to its maximum value on the domain boundaries since only calm water and head waves are simulated a symmetry condition is applied on the longitudinal plane the length of the simulations is set in order to have a number of encounter periods between the ship and the incoming waves which ensures a convergence in the forces the number of encounter periods goes from a maximum of 100 for λ 0 4 l p p to a minimum of 44 for λ 1 4 l p p the time step is set in relation to the fundamental wave period of the steady generated waves calculated based on the froude number for the grid dependency described in section 5 the time step is set equal to 30 time steps per fundamental period a more detailed description of the time stepping and the investigation on how this affects the solution is presented in section 6 the incoming waves replicate the ones tested in the model basin the wave steepness s w h w λ is equal to 0 02 for wave lengths up to λ 0 9 l p p and 0 01 for longer waves due to the depth of the tank a deep water condition can be assumed for waves no longer than λ 1 4 l p p 5 grid convergence a grid dependency study has been carried out to find the best compromise between accuracy and computational time this study focuses on the resolution of the free surface while the mesh on the hull is the same for all the cases as mentioned in section 3 4 the mesh on the hull is refined around the intersection with the waterplane and around high flared areas for this study a total number of approximately 5 3k panels are used to discretize half of the hull the hull can be seen in fig 5 and has the same mesh for all simulations 5 1 definition of the cases as far as the free surface is concerned both criteria that trigger the refinement are varied and analyzed separately in table 2 an overview of the different settings is provided initially the same maximum level of refinement is kept on the intersection between the free surface and the hull and on the curvature of the free surface these cases correspond to group a ids 1 2 and 3 in the table note that it is not possible to have a higher resolution on the free surface based on the curvature than around the waterplane afterward for group b cases 4 5 and 6 the level around the hull is kept constant and the level on the curvature is varied in this way since the mesh around the hull does not change it is possible to analyze the influence of the resolution of the generated waves on the solution throughout this study the initial base grid is the same the number of panels with a level zero of refinement in x and y direction are 36 and 12 respectively the last part of the grid convergence analysis consisted in varying the base grid corresponding to cases 7 8 and 9 group c in the table compared to the reference case the size of the area of the panels of the base grid was varied with a factor of 2 5 2 calm water to summarize the study can be divided into three steps as can be seen in table 2 in the table it is also possible to see the initial and final number of panels on the free surface in calm water and the number of panel along the waterline wl note that cases 3 6 and 8 represent the same condition a visual representation of the calm water simulations with a fully developed wave system can be seen in fig 7 due to the adaptive grid refinement the number of panels for each simulation varies in time since the ship starts at rest there is no refinement at the initial time step due to the curvature of the free surface as the ship reaches the prescribed speed the number of panels will increase and it will oscillate around a mean value in fig 6 it is possible to see the time series of the number of panels for the case 2 in waves with wave length λ 1 2 l p p it can be relevant to compare the number of panels per fundamental wave length as well the fundamental wave length is calculated as λ 2 π f n 2 l the number of panels per fundamental wave length is obtained on the waterline and on a longitudinal wave cut at y 0 15 l p p 2 l p p long which starts 0 25 l p p forward of the fore perpendicular and pointing downstream the values for the different cases are reported in table 3 since cases 3 4 5 6 and 8 have the same refinement on the intersection between the hull and the free surface they have the same number of panels per wave length 5 3 head waves to analyze the convergence of different meshes and find a compromise between accuracy and computational time the cases listed in table 2 were tested with incoming head waves to assess the convergence added resistance coefficient and non dimensional heave and pitch were compared the added resistance r a w in head waves is defined as the difference between the resistance in waves r w and the resistance in calm water r c the added resistance coefficient is defined as 25 c a w r a w ρ g a 2 b 2 l p p being b the breadth of the ship and a the wave amplitude heave and pitch are nondimensionalized with wave amplitude and wave slope respectively in fig 8 the variation of the added resistance coefficient with the number of panels in waves for wave lengths λ 0 6 1 0 1 2 l p p can be observed in figs 9 and 10 the influence of the number of panels on heave and pitch can be seen for the same wave lengths since the total number of panels on the free surface varies with time an average value of the tail of the simulation is taken as can be seen the variation for the motions is very limited while bigger discrepancies are found for the added resistance coefficient nevertheless the biggest discrepancies for added resistance can be seen for case 1 2 and 4 these cases represent the coarsest resolutions and for cases 1 and 2 there are not enough panels around the waterline to properly resolve the forces acting on the hull the other important aspect to keep in mind when selecting the mesh resolution is the computational time needed to run the simulations in table 4 the computational time t c for the different cases is reported for some of the wave lengths the computations were run on 4 cores on an intel i7 7700k cpu 4 20 ghz in the table the computational time per wave encounter is also presented this value represents an average is obtained dividing the total computational time with the number of encounter periods the case with id number 4 was not run on the same computer therefore the time is not reported 5 4 selection combining the information given in figs 8 10 on the convergence of the forces with the one in table 4 we can say the best compromise between accuracy and computational effort is given by cases 5 and 7 although cases 3 6 and 8 which represent the same condition provide closer results to case 9 which is the finest mesh they require higher computational time compared to cases 5 and 7 in order to select a case between 5 and 7 it is worth to look at contour plots and at a wave cut for the calm water simulations the wave cuts at y 0 15 l p p are shown in fig 11 and the contour plots in fig 12 as can be seen case 7 gives closer results in terms of wave cut to case 8 as well as a slightly better resolved wave system therefore case 7 is selected for the comparison with experimental results 6 time step dependency after the grid dependency was performed a grid resolution was selected for the comparison with the experimental data the case selected for the comparison is case 7 as discussed in section 5 4 after a quick comparison with the experimental data it was observed that a further investigation was needed for the short waves range before proceeding with the comparison with the experimental results then the influence of the time step on the solution was investigated as mentioned in section 4 the time step for the simulations is based on the fundamental wave length λ 2 π f n 2 l for the grid dependency a number of 30 time steps per fundamental wave period was chosen for this investigation three more values were selected 15 45 and 60 steps per fundamental wave period since the value of the time step and the length of the simulations are the same for all the wave lengths the number of time steps per encounter period will vary for the different cases in table 5 the number of time steps per encounter period can be observed for different wave lengths for all the cases the added resistance coefficient was evaluated for different wave lengths using different time step sizes the wave lengths used range from λ 0 4 l p p to λ 0 9 l p p in fig 13 the added resistance coefficient is shown contour plots for λ 0 5 l p p for the different cases are shown in fig 14 there are two main points that can be highlighted from fig 13 first of all there is a clear convergence increasing the number of steps per fundamental period although the contour plots of fig 14 seem quite similar the difference in the added resistance coefficient is not negligible especially for shorter waves furthermore the relative difference between the four cases diminishes with increasing wave length as reported in seo et al 2014 in short waves nonlinearities play an important role in the evaluation of added resistance since the code used here assumes fully nonlinear boundary conditions and the forces are obtained from the direct integration of the nonlinear pressure on the hull surface the discrepancies in the short waves range could be mainly due to an insufficient number of time steps for these cases as can be seen in table 5 the case selected for the comparison with experimental results is the one with 45 steps per fundamental wave period as can be seen for fig 13 the difference between this case and the case with 60 steps is very small furthermore there is a significant change in computational time 7 results the selection of the mesh and the time step size was discussed in sections 5 4 and 6 the comparison with experimental data is presented in this section the experimental conditions are reported in section 4 three different runs were performed in the towing tank and are visible in the following figures for a correct estimation of the added resistance it is important that the motions are evaluated correctly in figs 15 and 16 the comparison for heave and pitch is shown simulated heave and pitch match extremely well the experimental data in the small waves range for longer waves a very good agreement can still be seen although heave and pitch are slightly overpredicted in fig 17 it is possible to see the comparison between the simulated added resistance coefficient from the current fully nonlinear potential flow and the ones obtained with model tests and from other simulations available in literature the other methods used for comparison are a linear potential flow presented in hizir et al 2019 a partially nonlinear potential flow method and an euler method presented in seo et al 2014 and an urans method presented in sadat hosseini et al 2013 as can be seen except for the linear potential flow method there is a general good agreement between the current work and the other computations and the model test results especially for waves longer than λ 1 0 l p p for short waves there is a higher scatter in the results since the forces in waves are closer in value to the one obtained in calm water even a small difference will result in a bigger discrepancy in the added resistance coefficient it must be pointed out also that the wave steepness for the present method was the same as in the experiments s w 1 50 for λ 0 9 and s w 1 100 for 0 9 λ 1 4 while the steepness for the other methods was s w 1 60 for the linear potential flow s w 1 40 for the partially nonlinear potential flow and euler method and s w 1 53 for the urans method 8 discussion in the work presented here a fully nonlinear potential flow boundary element method has been used to evaluate added resistance heave and pitch for the kvlcc2 tanker in head waves in this context fully nonlinear means that the method is expected to capture all nonlinearities that are not due to viscosity the fully nonlinear kinematic and dynamic boundary conditions are applied on the free surface the wavy intersection between the hull and the free surface is computed and updated in each time step geometrical nonlinearities due to the variation of the water plane area are captured interactions between incoming waves diffraction waves radiation waves and waves due to the speed of the hull are all captured simultaneously in the total velocity potential methods based on the potential flow approximation are however limited to cases where the influence of viscous effects on the area covered by potential flow are expected to be small a thin boundary layer developing along a hull has a small effect while the flow downstream of a blunt stern is dominated by viscous effects and cannot be captured accurately by potential flow the results presented here were in good agreement with experimental results and with other methods nevertheless it must be pointed out that only small wave steepness values were used for the simulations and the froude number is not high when stepping outside of these conditions problems could arise due to the potential flow assumption when it comes to the speed of the hull the current method is not able to simulate pre planing and planing regimes in order to obtain the lift vortices or prescribed flow would have to be included another problem that would arise when simulating a planing hull is the presence of sprays and breaking waves produced by the hull which cannot be replicated by a potential flow method similarly to the sprays and breaking waves produced by the hull too steep waves cannot be simulated either since they would result in breaking waves and overturning waves 9 conclusion in the paper presented here an unsteady fully nonlinear potential flow method is used to evaluate added resistance and vertical motions for the kvlcc2 tanker hull numerical results are compared with experiments the code uses an adaptive grid refinement which allows for a finer mesh around the hull and a coarser representation of the domain further away increasing accuracy and efficiency of the computations this is well paired with the nonlinear decomposition of the velocity potential used in the code which further increase the efficiency since the potential of the incoming waves is known coarser representation of the domain can be used away from the hull in order to reduce the computational time a barnes hut algorithm is implemented in the code furthermore a formulation for the acceleration potential is introduced in order to reduce the numerical error deriving from the differentiation of the velocity potential in the bernoulli s equation before comparing the numerical results with the experimental data a grid dependency study was performed aimed at finding the best compromise between computational effort and accuracy of the results as can be seen in the figures presented in section 5 small variations in the solution can be observed excluding cases 1 2 and 4 where not enough panels are used to discretize the domain especially around the waterline for cases 1 and 2 to achieve a good agreement with experimental data the resolution of the grid has to be at least as fine as the one used for case 7 increasing the number of panels though the computational time per encounter period rises with a factor of almost 2 between two consecutive refinements before performing the comparison with the experimental data a time step dependency study was performed it was noted that this had an influence on short waves and the difference between different time step sizes diminished with increasing wave length although contour plots did not show any major difference between the different possibilities a clear convergence was visible when looking at the added resistance coefficient finally the numerical results for heave and pitch match very well with the experimental data for all wave lengths the added resistance coefficient was compared with experimental results and with other numerical methods including linear potential partially nonlinear potential flow euler method and urans and a general good agreement is found for shorter waves there is a bigger discrepancy but the added resistance is still comparable to experimental results and the other methods for this range even a small deviation in the estimation of the force could lead to bigger differences in terms of added resistance coefficient furthermore different numerical methods used different waves steepness as presented in section 7 making it hard to compare the results it is not possible to conclude from this comparison that any method is significantly superior to the others for the kvlcc2 case when looking at the total computational time it must be kept in mind that several encounter periods are simulated they range between 44 for the case λ 1 4 l p p up to 100 for the shortest waves nevertheless there is room for improvement in terms of computational time when it comes to the code itself first of all the code has not been optimized yet as far as computational efficiency is concerned another key aspect to keep in mind is that with the current method for the acceleration potential one laplace problem is solved for each degree of freedom there are more efficient ways to deal with this issue which will be implemented in the future on the other hand the pre process phase is very efficient there is an automatic mesh generator within the program which allows to create the mesh on the hull at the first time step and which continues to mesh the free surface during every time step credit authorship contribution statement francesco coslovich investigation martin kjellberg software validation writing review editing magnus östberg software validation writing review editing carl erik janson supervision funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this research is funded by chalmers university of technology the experimental results were provided by sspa sweden ab 
20799,wave breaking is one of the most violent phenomena in air water interface interactions that need to be considered in ship and offshore structures design spilling breaking waves induced by a shallowly submerged hydrofoil are investigated using a navier stokes solver for two phase flow computed wave profiles and velocity fields are compared with experimental results and good agreement obtained a related non breaking wave case is designed based on the same numerical model to distinguish the hydrodynamic characteristics of the spilling breaking waves and allow investigation of effects on waves downstream the velocity profile and turbulence intensity profiles at different sections from the two cases are compared with measurement data where available a detailed comparison of the wave breaking process compared to the non breaking wave is provided further the energy dissipation processes for the two cases are analyzed and the ratio of the turbulent dissipation rate to the total energy dissipation calculated it is shown that a large amount of energy is dissipated in the region of the breaking wave when compared to the non breaking wave approximately 12 of the total energy dissipation may be attributed to the wave breaking process induced by energy redistribution and additional contributions to turbulent fluctuations in the breaker keywords spilling breaking waves hydrofoil turbulence energy dissipation turbulent free surface flow 1 introduction wave breaking is a violent two phase interface interaction phenomenon which dramatically increases the transfer of momentum mass and energy between air and water one can easily observe the wave breaking phenomenon in the deep sea in the surf zone and in the flow around ships and ocean engineering structures a thorough understanding of the physics of turbulence and energy dissipation processes is necessary for a better understanding of breaking waves the dynamic significance of breaking waves has drawn more and more attention in recent years however our knowledge of breaking waves is limited especially the quantitative understanding of the mechanism of breaking and the post breaking phase this lack of knowledge is due to the challenging difficulties to be faced in observing the conditions under which the breaking waves appear the rapid generation of vorticity and turbulence the way they interact with the free surface and the amount of energy dissipated because of the breaker in the view of the complex processes involved in breaking waves it is not surprising that the problem in its entirety is not thoroughly understood in order to simplify as much as possible a series of non breaking spilling breaking waves created by a fully submerged three dimensional hydrofoil in steady horizontal motion was first studied experimentally by duncan 1983 this test case has become a classical benchmark this test case has become a classical benchmark and the present work is also focused on the spilling breaking waves generated by a shallowly submerged hydrofoil early experimental studies of spilling breaking waves are mainly focused on wave profiles and their relationship with the position of the spilling breaker and its geometric parameters duncan 1983 duncan 1981 velocity and turbulence quantities in the trailing wake mori 1986 hydraulic jump after the breaker battjes and sakai 1981 and initial breaking process lin and rockwell 1995 miller et al 1999 these experiments provided qualitative observation and a set of measurements of breakers and the following waves these data also built an empirical base for numerical models for steady spilling waves with the development of measurement techniques more and more detailed velocity turbulence and void fraction data have been investigated with particle image velocimetry piv techniques kang et al 2012 and laser doppler anemometer lda system mossa 2010 in recent studies of breaking waves however experimental techniques still suffer from certain difficulties in dealing with such violent two phase flows stern et al 2013 in particular obtaining measurements for the air phase at the same time as the water phase is problematic in early numerical studies non linear potential flow boundary integral methods and boundary element methods are widely used to prescribe pressure distributions to represent the effects of breaking waves longuet higgins and cokelet 1976 however only the early stage of the non linear breaking wave motion is captured and it is hard to predict the wave behaviour after the initial breaking it is worth noting that the potential flow theory and one phase flow solvers can only simulate the evolution of waves and their effects on flow beneath the free surface to a limited extent even if they are combined with breaking wave models coint and tulin 1994 muscari and mascio 2003 tatlock et al 2018 bakhtyar et al 2009 in two phase flow solvers both the air and water phase are solved in a coupled manner based on reynold s averaged navier stokes equations which allow a detailed investigation of the complex flow generated by the breaking waves and provide more information about the turbulence and energy dissipation process iafrati and campana 2005 investigated the role played by surface tension in the breaking events and the instantaneous vorticity field under the breaking waves by solving navier stokes equations and using a level set method for free surface capture karim et al 2014 applied a two dimensional implicit finite volume method fvm to solve reynolds averaged navier stokes rans equation and used volume of fluid vof method to analyze the performance of a hydrofoil at different submergence depths the wave profiles are computed satisfactorily by the two phase flow solver compared with the experimental data similar studies investigate breaking and non breaking waves above the hydrofoil and the influence of free surface effects with different hydrofoils naca 0015 karim et al 2014 naca 4412 uddin and karim 2017 naca 0012 prasad et al 2015 and naca0024 jin et al 2019 with different submergence depths most of these results are compared to experiments but focus primarily on the global structure of the breaker and only the wave profiles are validated the detailed investigation of the velocity field and turbulent flow within the spilling breaker is still lacking this work therefore focuses on the detailed hydrodynamic characteristics of spilling breaking waves a new comparison between a breaking wave case and a non breaking wave case is designed to resolve the small scale features of the interface breaking up droplets and air bubbles which distinguish the breaking wave from a non breaking wave and their effects on the following wave train analysis is performed of the mean flow the turbulent intensities and energy dissipation downward and downstream a two phase flow solver is applied to study the turbulence and energy dissipation in the spilling breaking waves downstream of a shallowly submerged foil naca0024 the numerical model is first validated for the spilling breaking waves with three different grids through a comparison with the experiment performed by mossa 2010 then a non breaking wave is designed with a similar computational set up to better understand the physical features of the viscous flow numerical simulations are performed for these two cases to investigate the free surface transformation during the wave breaking process the velocity and turbulence intensity profiles at different locations downstream of the hydrofoil are investigated to understand the turbulence underneath the spilling breaker further the energy dissipation processes are analyzed alongside the flume during the wave breaking for both cases 2 mathematical model in this study a finite volume discretization is used to solve the unsteady reynolds averaged navier stokes urans equations and incorporated with an algebraic volume of fluid avof method applied to solve for the free surface behaviours the simulation is performed using a standard two phase flow solver interfoam in openfoam the standard rans k ε turbulence model is used to describe the turbulence flow which mainly exists in the area around the hydrofoil and free surface zone 2 1 governing equations in the two phase flow solver interfoam the fluids are considered as two incompressible isothermal and immiscible fluids jacobsen et al 2012 the governing equations are the mass continuity equation and momentum conservation equation are written as 1 u 0 2 ρ u t ρ u u p t ρ f b where u is the velocity field throughout the domain ρ is the density of fluid p is pressure t is the viscous stress tensor and f b are the body forces per unit mass which is the acceleration due to gravity and surface tension effects at the interface 2 2 free surface model the interfoam solver uses the multidimensional universal limiter for explicit solution mules method to resolve the flow of both air and water phases and the evolution of the interface between them it is an algebraic vof avof method and no interface reconstruction process is applied during the calculation two immiscible fluids are considered as one effective fluid throughout the domain the free surface is tracked as 3 α t u α 0 where α is the volume fraction which is defined as the relative proportion of water in each cell if α 1 the cell is full of water and if α 0 the cell is full of air and in any case the cell contains the interface between air and water generally the iso surface α 0 5 is used to present the position of the free surface in mules an artificial compression term is added to the conventional transport equation equation 3 to limit the amount of interface smearing 4 α t ρ u α u r 1 α α 0 where u r is the artificial velocity field used to compress the interface and which takes effect only near the interface the expression for this term is found in deshpande et al 2012 in the post processing step the iso contour of volume function α 0 5 is defined to be the location of the free surface the surface tension plays an important role in spilling breaking waves since the pressure jump mainly depends on the curvature of the free surface it is therefore necessary to take the surface tension into account to capture the free surface accurately in the interfoam solver the surface tension term mentioned in eqn 2 is evaluated using a continuum surface force csf model 5 f σ σκ δ α where σ is surface tension σ 0 072 kg s2 in an air water system κ is the curvature of the free surface and is defined as 6 κ α α 2 3 turbulence model for modelling turbulent flow a standard k ε model turbulence model is used to model the effects of turbulence because the model has been demonstrated to perform well in the fully turbulent region and in free shear layers menter 1994 this is a semi empirical model based on two transport equations for the turbulent kinetic energy k and its rate of dissipation ε the two equations are 7 ρ k t ρ k u i x i x j μ t σ k k x j 2 μ t e i j e i j ρ ε 8 ρ ε t ρ ε u i x i x j μ t σ ε ε x j c 1 ε ε k 2 μ t e i j e i j c 2 ε ρ ε 2 k here e i j is component of rate of deformation σ k σ ε c 1 ε and c 2 ε are constants and μ t is turbulent viscosity and calculated by combining k and ε as follows 9 μ t ρ c μ k 2 ε where c μ is a constant 2 4 discretization schemes and solver settings for the spatial domain the standard gaussian finite volume integration method is usually used based on summing values on the cell faces to achieve higher accuracy when integrating of the derivative terms mohseni et al 2018 for the convection terms in the momentum equations the gradient terms u and divergence terms ρ φ u a gauss linear scheme is used which is second order gaussian integration φ ρ u is the flux the gauss scheme is also the only choice of discretization for viscous terms containing laplacian terms like ν u jacobsen et al 2012 and a gauss linear corrected scheme is used in the present work with unbounded second order and conservation numerical behaviours for the terms with volume function α the discretization uses a gauss vanleer scheme which is second order and bounded to deal with the discontinuity across the interface between air and water for turbulent equations φ k and φ ε a gauss limited linearv 1 scheme is used which is second order and bounded for time discretization the second order backward implicit scheme is used for the solution of velocity and pressure the pimple piso simple algorithm is used for pressure velocity coupling which is a hybrid of a pressure implicit splitting operator piso algorithm and a semi implicit method for pressure linked equations simple algorithm 3 code verification the verification of the validity of the two phase flow solver is performed against the experimental results obtained by duncan 1983 who investigated the breaking and non breaking wave resistance of a two dimensional hydrofoil by changing water depth and angle of attack with the aim of validating the two phase flow solver two cases are chosen on the basis of the experimental conditions used in duncan 1983 and simulations undertaken of free surface flow generated by a naca 0012 hydrofoil the parameters of the two validation cases are listed in table 1 for case 1 a regular non breaking flow is generated behind the foil whilst for case 2 the waves are in a breaking state around x 0 5 as occurred in duncan s results the simulations are conducted on a 2d computational domain of x 2 4 and y 1 1 with a naca 0012 hydrofoil fixed at 0 0 the inlet velocity imposed at the inlet boundary is fixed with u 0 8 m s for both water and air phases the initial free surface elevation is set according to the submergence depth given in table 1 physical parameters for both phases are chosen the same as in the experiment figs 1 and 2 show a comparison of the wave profiles computed by the two phase flow solver at t 100s with the experimental data from duncan s research duncan 1983 it is clear that the predicted wave profiles are in very good agreement with the experimental data 4 computational implementation and convergence study 4 1 computational set up the numerical tests are carried out in a three dimensional 3d numerical flume the results are compared with the experimental data by mossa 2010 using an lda system the geometric model is built from standard naca0024 hydrofoil coordinates shown in fig 3 the origin of the x coordinate is placed level with the leading edge of the hydrofoil and y coordinate at the flume bottom and the foil is fixed with the chord length c 0 2 m at an angle of attack of 10 the entire computational domain and the different boundary conditions applied at inlet outlet bottom upper and on the hydrofoil are shown in fig 4 the front and back boundary conditions are set as slip boundary conditions to avoid extra vortices on the wall the length of the inlet and outlet boundaries are 1 5c the same as the channel used in the experiments while that of the upper and bottom boundaries are 25c shorter than the real test facility the shorter domain was chosen to reduce computational costs while retaining the quality of the numerical solution the leading edge of the hydrofoil is placed at a height of 0 5c from the bottom and at a distance 10c from the inlet boundary where the upstream and downstream influence of the hydrofoil on the measured flow was negligible the width of the numerical flume is set as 0 5c in the numerical simulation the initial free surface is set as still water level over the horizontal bottom at h 0 19 m the flow rate at the inlet boundary is set at a fixed discharge φ of 0 038036 m3 s with a uniform velocity is 1 001 m s in the water domain at t 0s while the velocity of the air phase keeps at zero the corresponding initial reynolds number re ρ u c μ with ρ water density 1000 kg m3 and water dynamic viscosity 0 001 ns m2 is 190 180 and the froude number fr u g h with g gravity acceleration of 0 7336 six measurement sections are placed along the flume at x 0 25 m 0 426 m 0 523 m 0 67 m 0 8 m and 1 025 m from the leading edge of the hydrofoil on the longitudinal section of the flume to measure the free surface elevation and velocity fields according to the experiment at the first two sections the flow from the upper and lower parts of the hydrofoil mixes with each other and the hydrofoil wake is initially generated and developed the next two sections are positioned in the spilling wave breaking zone the last two sections are chosen in the wake flow area and the flow tends to return to a uniform state with increased distance from the trailing edge 4 2 mesh generation and grid independency study the meshing of the blocks consists of conformal non orthogonal structured elements throughout the whole computational domain a refined meshing is employed near the hydrofoil see fig 5 bottom boundary and free surface compared to the remainder of the rest of the domain to capture better the near wall turbulent flow and wave profile the standard wall function versteeg et al 1995 is employed for the near wall treatment the estimation of the distance to the wall is based on the skin friction coefficient c f as follows prasad et al 2015 10 c f 0 026 r e 1 7 the distance to the wall is defined with the non dimensional parameter y 11 y u f y υ where u f is the friction velocity at the nearest wall y is the distance to the nearest wall and υ is the water kinematic viscosity the values of y around the hydrofoil and the bottom boundary in the present simulations are in the range 5 10 grid space and time step convergency studies are carried out for the free surface evaluation and the drag and lift coefficients of the hydrofoil in the numerical flume to capture spilling breaking waves the resolution for the spatial discretization of the region near the free surface is important in the numerical simulation so a cuboid mesh is designed in the breaking wave area near the free surface three different grids namely mesh a mesh b and mesh c are applied in this study to check the convergence studies of the results the refinement factor for both spatial and temporal is set to 2 with the maximum courant number co 0 5 in all these cases the total cell number for mesh a is 11 16 million with mesh size dx dy 0 0014 m mesh b is 15 784 million with dx dy 0 001 m and mesh c is 22 32 million with dx dy 0 0007 m while the mesh size on z direction dz 0 002 m in all three meshes to reduce the calculation in this section the simulation of the hydrofoil is in the same conditions as the experiment reported by mossa 2010 the spilling breaking wave is simulated and compared with the experiment the convergence of the free surface profile at 30s is shown in fig 6 a the iso surfaces with α 0 5 is used to present the position of the free surface the overall structures of the free surface obtained on the three grids are very similar it can be noted that for all meshes although the water level downstream is slightly overestimated the spilling breaking wave region shows a very good accordance with the experiment in both wave height and length the position and height of the wave downstream of the hydrofoil are better predicted on a fine grid than on a coarse grid and a finer grid can capture more details of the free surface with higher grid resolution to show the differences between wave profiles clearly the spilling breaking wave zone is enlarged and shown in fig 6 b the main bodies of water are almost overlapped in the three grid sizes while the crest of wave is slightly more downstream in mesh a more and smaller water droplets and air bubbles generated by the breaker can be observed on the finer meshes mesh b and c in and after the breaking wave zone although the overall large scale dynamics of wave breaking waves obtained on the three grids are very similar small scale features like droplets and air entrainment which are captured better by the finer meshed mesh b and c are not well understand stern et al 2013 and the effect of the small scale details on the dynamics of interface breaking is investigated in this study the computed values of lift and drag coefficients with these three grids are also calculated and compared in fig 7 it is seen that there is a small amount of change in results for increasing the number of cells from mesh a to mesh c the variations are 0 126 for lift force and 0 33 for drag force the convergence ratio decreases with the increase of mesh number which means the numerical model is monotonically converging according to the analysis of wave profiles and force components mesh b is selected as appropriate resolution since droplets and bubbles are captured better than mash a while the calculation is less demanding than mesh c in all simulations adaptive time steps are used with a maximum allowed courant number co in order to check the time independence of the cfd simulations three co numbers are tested based on the chosen mesh b co 0 1 co 0 5 and co 1 0 again the wave profiles at t 30s for different co numbers are extracted and compared similar results are obtained with all three co numbers with the main body of the water overlapped see fig 8 the positions of droplets and air bubbles are not exactly the same but appear in similar areas a co 0 5 is thus adopted to achieve a necessary condition for time convergence whilst keeping the calculation to an acceptable computational burden 5 results and discussion 5 1 numerical set up in order to investigate the hydrodynamic properties of spilling breaking waves and the effect of the breaking wave on the resulting waves a non breaking wave case is designed as a reference the state of a wave generated behind the hydrofoil is highly affected by the submergence depth duncan 1983 performed a series of experiments to investigate the breaking and non breaking waves caused by changing the submerged depth this work was used to guide the present investigation and thus the only difference between the initial condition of the two cases in the present work is the depth of water which is the deciding factor for the wave state generated behind the foil the initial conditions for the designed non breaking wave case are slightly different from the spilling breaking wave case with a higher initial free surface elevation and a lower uniform velocity at the inlet boundary the discharge φ keeps the same value as that in the experiment and between the two cases simulated the initial conditions for the two cases are illustrated in table 2 other computational set ups such as mesh and boundary conditions remain exactly the same the numerical results obtained from the two cases are compared with the measurement data in the experiment for the breaking wave case the instantaneous wave surface profiles and pressure fields are compared between the two cases followed by data analysis on the velocity fields 5 2 instantaneous results in order to investigate the deformation of the free surface during the spilling breaking waves the instantaneous contour of the free surface with volume fraction value α 0 5 for the two cases are shown in figs 9 and 10 with pressure and velocity fields respectively the results are obtained at t 30s when the breaker stays at the same position for more than 10 s the position of the main water body maintains the same shape whilst the small scale features such as droplets and air bubbles repeat a similar process with time see fig 11 the locations of six measurement sections are shown in fig 9 as mentioned before the six sections are set at maximum froude number s1 the generation of waves s2 spilling breaking first wave crest s3 s4 and wake region s5 s6 fig 9 presents the contours of pressure distribution with lines of constant pressure the pressure here represents the dynamic pressure obtained by subtracting the hydrostatic pressure from the total pressure p r g h p ρ g h this term is advantageous for analyzing the contribution of pressure to the wave deformation process for both of the cases the changes of pressure are negligible in the air region but significant in the water region higher pressure values are concentrated at the front of the hydrofoil and a region of more uniform pressure is progressively created further along the hydrofoil little difference can be observed in the suction pressure produced by the hydrofoil after the trailing edge the pressure distributions are similar before the wave breaking region as for the region downstream the pressure distributions differ from one to the other though both of them are typical pressure patterns for free surface flows with high pressure near a wave crest and low pressure under a wave trough the first wave crest in the non breaking wave case is significantly higher than in breaking wave case with higher pressure as well there are also visible variations of pressure in the following waves in the non breaking case while negligible changes can be observed in the breaking wave case under the almost flat free surface after the spilling breaker fig 10 illustrates the velocity magnitude fields for both the water and air regions as with the pressure fields the velocity distributions are similar between the two cases before the breaker the velocity of the main region of air remains at zero but is increased closer to the free surface there is a high shear flow around and behind the hydrofoil in a region between the free surface and the bottom there is no obvious boundary layer separation around the hydrofoil and the flow is completely attached along the wall boundary the velocity on the face side of the hydrofoil does not change much and remains roughly uniform until the flow reaches the hydrofoil the velocity on the back side is very high near the leading edge and then gradually decreases alongside the trailing edge of the hydrofoil the differences start at around x 0 4 m where the spilling breaking waves are fully developed a vortex appears in the first wave crest where the spilling breaking wave is produced the velocity inside of the vortex decreases sharply and reaches zero at the tip of wave crest in the non breaking case the velocity decreases with the height of the wave as well but is more gently and smoothly resulting in a steady wave train after the foil the detailed analysis of velocity profiles computed in breaking and non breaking case will be given in the next section with the comparison to experiments 5 3 velocity profiles the turbulent flow around the hydrofoil and near the free surface is described by the standard rans k ε turbulence model the analysis of velocity fields is also based on the reynolds decomposition even though it is a 3d simulations the width of the numerical flume is relatively short and the main hydrodynamic characteristics vary along the x and y directions so only two terms of velocity components u and v are investigated in the present work the velocity data are separated in their time averaged values u and v and the fluctuation terms u and v 12 u u u u 1 t 0 t u d t 13 v v v v 1 t 0 t v d t where the t is the integration time in actual data analysis the first 20 s unsteady period is neglected during this period the uniform inlet flow is accelerated by the hydrofoil and the flat free surface deforms and turns into the waves after this transient period the flow reaches a steady state the data from the following 10s is then considered and averaged to obtain the mean velocities and the fluctuation terms the time averaged horizontal velocity u at the six measurement sections are shown in fig 12 the red dots are data obtained from the experiment mossa 2010 the solid lines are the results of the spilling breaking case and the dashed lines are the results of non breaking waves in general the numerical simulation results for the spilling breaking waves agree quite well with the experiments especially in the hydrofoil wake and the spilling breaking wave area the uniform inlet flow is accelerated by the hydrofoil the velocities of main body of water increase from section x 0 25 m to x 0 426 m and decrease sharply from the breaking wave region around x 0 523 m to x 0 67 m the change of the velocities after that diminishes in magnitude and the flow tends to be uniform again the hydrofoil wake is captured at section x 0 25 m with a sudden reduction of velocity near the hydrofoil level y 0 07 m the horizontal velocities reach a maximum at this point except for a small region just downstream of the trailing edge a thick wake is produced by the nearly separated flow on the top back of the hydrofoil strong velocity gradients also occur near the trailing edge of the hydrofoil this is caused by the mixing of the flow from the upper and lower parts of the hydrofoil and leads to an increase of the velocity above the upper side of the hydrofoil this defect diminishes in magnitude with the flow direction but can still be observed at section x 0 8 m especially for the spilling breaking case it is not surprising that the cfd simulations in both cases fail to capture the sharp defect of horizontal velocity downstream of the trailing edge and are not as sensitive as the efd techniques fig 12 section x 0 25 m only large scale turbulent motions are directly calculated with small scale vortical structures are modelled by the adopted rans k ε turbulence model the mesh sizes in this region are smaller than the turbulent length scale more sensitive turbulence model such as large eddy simulation les may help to improve the description of turbulent flow although much smaller turbulence can be captured with higher grid resolutions or a better turbulence model the overall large scale dynamics of turbulence are not affected and are captured with the present model besides the decrease of velocity in the hydrofoil wake and bottom region there is a strong decrease near the free surface region all the way along the flow direction these decreases in velocity in the breaking wave case are well captured in the numerical simulations and have the same trend as the experimental data the main parts of the velocity fields are similar between the spilling breaking waves and non breaking cases while the biggest differences occur in the free surface region on the first two sections x 0 25 m and x 0 426 m the two cases are similar with a slightly decrease in a narrow band near the free surface the band extends greatly into an area with a height of around 0 07 m in the region between section x 0 523 m and x 0 67 m in this region the spilling breaker is fully developed in the spilling breaking waves case and the steepest wave is generated in the non breaking wave case the velocity defect in spilling breaking waves is larger than in the non breaking case this is because there is a stronger turbulent flow below the breakers and this is confirmed by the turbulence intensity profiles analyzed in section 4 3 in the region following the breaking the turbulent trailing wake behind the spilling breaker gradually diminishes but at a longer distance downstream than in the non breaking wave case there is still a small defect observed at the section x 0 8 m while in the non breaking wave case the velocity changes smoothly without a sharp decrease near the free surface on the last section the velocity profiles of the two cases tends to be similar again it is interesting to observe that the horizontal velocity u is underestimated by a larger amount further downstream in the breaking wave region compared to efd data at section x 0 8 m and x 1 025 m one possible reason for this discrepancy may be in the setting of the initial still water level which may affect the position of the free surface a related phenomenon can be seen in fig 6 where the water level downstream is slightly higher than in the experiments the flux rate remains the same at every section as the inlet boundary in the cfd simulation to guaranteed mass conservation in the calculations it is interesting to note that an approximate check of the flux rate φ in the efd data mossa 2010 by integrating velocity on the section x 0 8 m and x 1 025 m is larger than the fixed discharge from the upstream gate fig 13 presents the time averaged vertical velocity profiles v at the different sections the values of v are much smaller than the horizonal components the hydrofoil wake is also correctly captured at the first section near the hydrofoil tail the sudden reduction of the vertical velocity component v after the spilling breaking waves steepest wave in non breaking case from section x 0 523 m to x 0 67 m the velocity profiles of the two cases are almost overlapped with each other while some fluctuations can be observed in the breaking waves area near the free surface the vertical velocity v decreases close to zero at section x 0 8 m and x 1 025 m and the horizontal velocity u tends to be uniform except near the non slip bottom wall the influence of the hydrofoil on the flow is greatly reduced 5 4 turbulence intensity profiles as shown in eq 11 and eq 12 the velocity data u and v are separated into their time averaged values u and v and fluctuations u u u and v v v for the statistically turbulent flow the turbulence intensities are obtained from a root mean square value of the velocity fields 14 u r m s 1 n i 1 n u i u 2 15 v r m s 1 n i 1 n v i v 2 where n is the number of recorded values during the steady state it should be noted that the velocity fluctuations around the mean flow in the turbulent flow depend both on the small scale and large scale unsteady vorticity generated by the hydrofoil however in the rans k ε turbulence model the entire turbulence spectrum is modelled and the resolved scales are assumed to be above the inertial subrange therefore the turbulence intensities in the steady state conditions are here referred to as large scale motions the values of turbulence intensities u r m s and u r m s at the six measurement sections are compared with the experimental values in figs 14 and 15 good agreement is achieved between the spilling breaking wave results and the experimental values although the horizontal turbulence intensity is slightly underestimated in the far fields behind the hydrofoil where the flow tends to be uniform again the turbulent flow beneath the free surface is much gentler compared to the region close to the hydrofoil the very small scale turbulence will not be captured by the adopted rans k ε turbulence model similar to the time averaged velocity profiles the main parts of the breaking and non breaking wave case are almost overlapped while some differences occur in the breaking waves area compared to non breaking wave case with much more moderate horizontal turbulent intensity of an almost uniform value of u r m s 0 2 m s in the whole water domain in the breaking waves case large turbulent intensities concentrate near the free surface especially in the breaking wave area between section x 0 523 m and x 0 67 m and decays downward and downstream the greatest horizontal turbulent intensity reaches 0 45 m s in the breaker the region of turbulent flow is consistent with the area of the decrease in time averaged horizontal velocity fig 12 with a stronger shear layer or a surface roller induced by the spilling breaking waves there seems to be a streamline dividing the upper turbulent roller from the main flow beneath the breaker the precise determination of the location of the dividing line is impossible because of the rapid mixing in the experiment battjes and sakai 1981 but is more obvious in the numerical simulation results of turbulent intensity in fig 14 and reynolds shear stress in fig 16 the time averaged vertical velocities v are much smaller than the horizontal velocities u the same is true for the vertical fluctuation terms where v r m s are smaller than the horizontal ones greater values of turbulent intensities can be observed in the breaking wave area than the non breaking case but decrease immediately after the breaker it is interesting to see that the turbulent intensities are slightly underestimated in the wake right after the tail of hydrofoil at the section x 0 25 m and the far downstream of the flow at the section x 1 025 m this may be caused by the rans turbulence model used in the present work which fails to capture very small scale unsteady motions in the rans models the attentions are focused on the mean flow and the effects of turbulence on the mean flow properties the mesh sizes in the turbulent flow region near the free surface flume bottom around and after the foil are smaller than the turbulent length scales the very peak fluctuations may be smoothed by time or space when analyzing the data however even though the very small scale unsteady motions are not captured the effects are modelled by the rans model and has been considered when solving the mean flow motion 5 5 reynolds shear stresses the cross correction of the two fluctuating velocity components u v is inversely proportional to the reynolds shear stress battjes and sakai 1981 and takes into account the effect of the modelled small scale turbulent eddies padova et al 2016 the calculation of the cross product is given as follows 16 u v 1 n i 1 n u i u v i v fig 16 shows the values of the cross correlation u v at the six measurement sections as may be expected the reynolds shear stresses are particularly large in the region of breaking waves near the free surface while in the mean water beneath the breaker the values of shear stress are close to zero the highest value of u v could be over 0 3 m2 s2 at the tip of breaking waves which is three times that in non breaking wave case in light of the results of figs 14 16 it is possible to conclude that there is a wake generated by the hydrofoil starting from the spilling breaker and going downstream but limited to the region near the surface the contours of the cross product of the two fluctuating velocity components u v are shown in fig 17 compared to the violent breaking wave case the u v contours are much smoother in the non breaking case as observed in the profile in the non breaking case a high u v region exists on the upstream side of the first wave this indicates that reynolds shear stress plays an important role in the transformation from non breaking waves to breaking waves on the one hand it represents energy transport i e energy continuously transforming from the averaged motion to turbulent kinetic energy on the other hand the strong shear stress induces energy dissipation into heat by viscous forces as shown in fig 12 x 0 523 m the averaged velocity reduced dramatically where the value of u v is large the energy will be discussed in section 4 5 5 6 energy dissipation process a useful approach in estimating the energy dissipation rate is to integrate the energy balance equation according to bernoulli s principle in the x direction and calculate its decay huang et al 2009 this has an advantage of including all the factors that may cause energy like the bottom friction the total fluid energy dissipation ratio can be calculated from the deficiency of the time averaged energy flux through the application of the energy balance equation in the cross sections of x direction the mean total energy flux per width f is defined as 17 f b h p 1 2 ρ u 2 v 2 ρ g y u d y where b is the position of bottom and h is the height of the free surface the total mechanical energy flux of flow f can be divided into kinetic and potential terms 18 f k b h 1 2 ρ u 2 v 2 u d y 19 f p b h p ρ g y u d y the energy dissipation ratio d is defined by 20 d f f x f 0 f 0 where f x is the local energy flux at a section x in the x direction and f 0 is the energy flux at section x 0 m for the breaking wave case the whole process in the x direction can be divided into three stages acceleration stage wave breaking stage and quasi steady stage according to the variation of energy flux at the first section x 0 m 81 7 of energy flux is composed of f p only 18 3 is f k the fluid is then accelerated by the hydrofoil and the fluid energy is gradually transferred from f p to f k and the f k reaches a maximum at x 0 4 m which is more than twice its initial value before the hydrofoil in the wave breaking stage 0 3 m x 0 5 m f k decreases significantly indicating that the wave transfers its energy from kinetic energy back to potential energy after the breaking area the flow becomes steady and close to a quasi steady state at x 0 7 m with gentle turbulence dissipation remaining about 6 of the energy of the initial incident flow energy is dissipated after all these three stages see fig 19 and about 50 of the dissipated energy is lost during the wave breaking area for the non breaking wave case the main processes of energy distribution are similar to the breaking waves case but the transformation between potential and kinetic energy is gentler in the region between x 0 3 m and 0 4 m where the first wave in non breaking wave case and breaking waves in spilling breaking wave case developed the maximum kinetic energy rate at x 0 3 m and 0 4 m is 35 in the non breaking wave case which is 5 smaller than that in the breaking wave case as shown in fig 19 the discrepancy of energy dissipation rate between the two cases is quite large in this region but gradually reduces after the breaking wave area this indicates that the violent turbulent flow generated in the breaking increases the dissipation rate but its contribution to the dissipation ceases immediately after the breaker the free surface eruptions in spilling wave breaking indicate that the broken free surface is a result of the strong turbulence generated underneath the free surface meeting the free surface kandasamy et al 2009 breaking induced turbulence can be produced by fluid shear or friction in between water and air turbulence induces a two fold transfer of the fluid energy a the fluid energy reduces as energy transfers from large to smaller length scales and b smaller energy cascade is dissipated by viscous forces in order to investigate the ratio of the turbulence dissipation rate to the total energy dissipation rate the turbulent kinetic energy tke k and the turbulence dissipation rate ε is recorded and analyzed drazen and melville 2009 a typical budget equation for turbulent kinetic energy is given by 21 d k d t t p ε where d k d t is the mean flow material derivative of tke and t is the turbulence transport of tke p is the production of tke the value of tke for water phase can be calculated by turbulence intensities 22 f t k b h 1 2 ρ u 2 v 2 u d y the loss energy induced by turbulent motions can be integrated and time averaged as 23 d t k 0 x d x b h ρ ε d y d t k may be approximated to within 5 uncertainty by the averaged energy dissipation the turbulence dissipation rate fluctuates rapidly because of the highly unsteady breaking wave as expected from the analysis of the velocity field the values of tke are extremely high at the breaking area and the upstream area of the first wave generated by the hydrofoil in non breaking wave case see fig 20 in a spilling breaker the roller region turns a portion of the flow energy into tke turbulence generated in the breaker is diffused in the flow and depth directions with a consequence of a lower turbulence fluid the spread of turbulence energy is confined only to the close part of the breaker however in the case of a non breaking wave the tke generated on the upstream side of the first wave spreads over the entire water with a gentle decrease in the magnitude the value of tke downstream is twice as large as the breaking waves case this difference may be caused by a large amount of energy dissipated during the breaking process and the flow tending to return to a uniform state with less energy exchanges after that the distribution of turbulence dissipation rate ε is similar to the distribution of tke with peaks at the breaker region and below the first wave this can also be concluded from figs 18 and 19 the proportion of kinetic and potential energy remains fluctuating in the non breaking wave case but is almost constant after the breaker in breaking wave case the ratio of turbulent dissipation d t k to the total energy dissipation d f is shown in fig 21 to investigate the contribution of the turbulent motions at the starting point x 0 m the ratio is not very small and is 8 it can be seen that the foil starts to have an effect on the uniform flow from this section and the flow is accelerated by the hydrofoil the turbulence is initially generated and the ratio decrease along the hydrofoil this indicates the major part of the total energy may be lost or transported to elsewhere such as the heat induced by friction of hydrofoil surface or bottom in the case of breaking waves the ratio increases rapidly in the breaker area and reaches to 20 the rapid increase evidences the intense turbulence production during the process however the increase stops shortly after the breaker the ratio of turbulent energy dissipation remains at around 20 with a small fluctuation of less than 1 in the case of non breaking wave the ratio starts to increase at x 0 5 m where the turbulent flow is already fully developed and the dissipation of turbulence is greater than the production mechanisms the ratio keeps increasing after the first wave crest with tke downstream based on a comparison of the two cases it is found that the turbulent energy induced by the breaking wave is about 12 of the total energy dissipation 6 conclusion a two phase flow solver is applied to the numerical simulation of the turbulence and energy dissipation process in the waves generated downstream of a shallowly submerged hydrofoil the analysis is performed based on urans equations incorporated with an algebraic avof method for free surface capture and a standard rans k ε turbulence model for turbulent flow description the numerical model is validated for a spilling breaking wave case though a comparison with the experiment by mossa 2010 and the numerical results show excellent agreement with the experimental data for the wave profiles the free surface flow is shown to be determined satisfactorily by the avof method the standard rans k ε turbulence model predicts well the strong turbulent flow after the submerged hydrofoil but has limitations with the turbulent flow further downstream a direct comparison of flow conditions between a breaking and non breaking wave case is conducted to allow investigation of the characteristics of the wave breaking process the difference in the velocity fields between the spilling breaking waves and non breaking waves are concentrated on the breaking area where the instantaneous horizontal velocities drop sharply to zero in the breaking case analysis of the velocity and turbulence intensity profiles for the two cases indicates that there a stronger shear layer or a surface roller induced by the spilling breaker divided by a streamline from the main flow beneath the breaker extremely violent turbulent flow exists in this shear layer and the greatest value of turbulent intensities inside the breaker is up to three times that in non breaking waves besides the values of turbulent intensities the analysis of the cross correction of the two fluctuating velocity components indicates that the reynolds shear stress plays an important role in the decrease of velocity near the free surface and transformation from non breaking waves to breaking waves by transporting energy from averaged motion to turbulent kinetic energy and heat by viscous forces further the energy dissipation processes along the wave flume for the two cases are analyzed and the ratio of the turbulent dissipation rate to the total energy dissipation is calculated for the breaking wave case about 6 of the energy of the initial incident flow energy is dissipated after the whole process and about half of the dissipated energy is lost during the wave breaking region the ratio of turbulent dissipation to the total energy dissipation also shows a dramatic increase in this region compared to the non breaking case the energy redistributes and contributes to turbulent fluctuations in the breaker and the breaker induced turbulence induces approximately 12 of the total energy dissipation this direct comparison between the breaking wave case and non breaking wave case thus enables the hydrodynamic characteristics of spilling breaking waves to be clearly distinguished credit author statement qiu jin methodology software formal analysis investigation writing original dominic hudson supervision validation visualization writing review editing pandeli temarel supervision project administration w geraint price supervision conceptualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the university of southampton and the china scholarship council 
20799,wave breaking is one of the most violent phenomena in air water interface interactions that need to be considered in ship and offshore structures design spilling breaking waves induced by a shallowly submerged hydrofoil are investigated using a navier stokes solver for two phase flow computed wave profiles and velocity fields are compared with experimental results and good agreement obtained a related non breaking wave case is designed based on the same numerical model to distinguish the hydrodynamic characteristics of the spilling breaking waves and allow investigation of effects on waves downstream the velocity profile and turbulence intensity profiles at different sections from the two cases are compared with measurement data where available a detailed comparison of the wave breaking process compared to the non breaking wave is provided further the energy dissipation processes for the two cases are analyzed and the ratio of the turbulent dissipation rate to the total energy dissipation calculated it is shown that a large amount of energy is dissipated in the region of the breaking wave when compared to the non breaking wave approximately 12 of the total energy dissipation may be attributed to the wave breaking process induced by energy redistribution and additional contributions to turbulent fluctuations in the breaker keywords spilling breaking waves hydrofoil turbulence energy dissipation turbulent free surface flow 1 introduction wave breaking is a violent two phase interface interaction phenomenon which dramatically increases the transfer of momentum mass and energy between air and water one can easily observe the wave breaking phenomenon in the deep sea in the surf zone and in the flow around ships and ocean engineering structures a thorough understanding of the physics of turbulence and energy dissipation processes is necessary for a better understanding of breaking waves the dynamic significance of breaking waves has drawn more and more attention in recent years however our knowledge of breaking waves is limited especially the quantitative understanding of the mechanism of breaking and the post breaking phase this lack of knowledge is due to the challenging difficulties to be faced in observing the conditions under which the breaking waves appear the rapid generation of vorticity and turbulence the way they interact with the free surface and the amount of energy dissipated because of the breaker in the view of the complex processes involved in breaking waves it is not surprising that the problem in its entirety is not thoroughly understood in order to simplify as much as possible a series of non breaking spilling breaking waves created by a fully submerged three dimensional hydrofoil in steady horizontal motion was first studied experimentally by duncan 1983 this test case has become a classical benchmark this test case has become a classical benchmark and the present work is also focused on the spilling breaking waves generated by a shallowly submerged hydrofoil early experimental studies of spilling breaking waves are mainly focused on wave profiles and their relationship with the position of the spilling breaker and its geometric parameters duncan 1983 duncan 1981 velocity and turbulence quantities in the trailing wake mori 1986 hydraulic jump after the breaker battjes and sakai 1981 and initial breaking process lin and rockwell 1995 miller et al 1999 these experiments provided qualitative observation and a set of measurements of breakers and the following waves these data also built an empirical base for numerical models for steady spilling waves with the development of measurement techniques more and more detailed velocity turbulence and void fraction data have been investigated with particle image velocimetry piv techniques kang et al 2012 and laser doppler anemometer lda system mossa 2010 in recent studies of breaking waves however experimental techniques still suffer from certain difficulties in dealing with such violent two phase flows stern et al 2013 in particular obtaining measurements for the air phase at the same time as the water phase is problematic in early numerical studies non linear potential flow boundary integral methods and boundary element methods are widely used to prescribe pressure distributions to represent the effects of breaking waves longuet higgins and cokelet 1976 however only the early stage of the non linear breaking wave motion is captured and it is hard to predict the wave behaviour after the initial breaking it is worth noting that the potential flow theory and one phase flow solvers can only simulate the evolution of waves and their effects on flow beneath the free surface to a limited extent even if they are combined with breaking wave models coint and tulin 1994 muscari and mascio 2003 tatlock et al 2018 bakhtyar et al 2009 in two phase flow solvers both the air and water phase are solved in a coupled manner based on reynold s averaged navier stokes equations which allow a detailed investigation of the complex flow generated by the breaking waves and provide more information about the turbulence and energy dissipation process iafrati and campana 2005 investigated the role played by surface tension in the breaking events and the instantaneous vorticity field under the breaking waves by solving navier stokes equations and using a level set method for free surface capture karim et al 2014 applied a two dimensional implicit finite volume method fvm to solve reynolds averaged navier stokes rans equation and used volume of fluid vof method to analyze the performance of a hydrofoil at different submergence depths the wave profiles are computed satisfactorily by the two phase flow solver compared with the experimental data similar studies investigate breaking and non breaking waves above the hydrofoil and the influence of free surface effects with different hydrofoils naca 0015 karim et al 2014 naca 4412 uddin and karim 2017 naca 0012 prasad et al 2015 and naca0024 jin et al 2019 with different submergence depths most of these results are compared to experiments but focus primarily on the global structure of the breaker and only the wave profiles are validated the detailed investigation of the velocity field and turbulent flow within the spilling breaker is still lacking this work therefore focuses on the detailed hydrodynamic characteristics of spilling breaking waves a new comparison between a breaking wave case and a non breaking wave case is designed to resolve the small scale features of the interface breaking up droplets and air bubbles which distinguish the breaking wave from a non breaking wave and their effects on the following wave train analysis is performed of the mean flow the turbulent intensities and energy dissipation downward and downstream a two phase flow solver is applied to study the turbulence and energy dissipation in the spilling breaking waves downstream of a shallowly submerged foil naca0024 the numerical model is first validated for the spilling breaking waves with three different grids through a comparison with the experiment performed by mossa 2010 then a non breaking wave is designed with a similar computational set up to better understand the physical features of the viscous flow numerical simulations are performed for these two cases to investigate the free surface transformation during the wave breaking process the velocity and turbulence intensity profiles at different locations downstream of the hydrofoil are investigated to understand the turbulence underneath the spilling breaker further the energy dissipation processes are analyzed alongside the flume during the wave breaking for both cases 2 mathematical model in this study a finite volume discretization is used to solve the unsteady reynolds averaged navier stokes urans equations and incorporated with an algebraic volume of fluid avof method applied to solve for the free surface behaviours the simulation is performed using a standard two phase flow solver interfoam in openfoam the standard rans k ε turbulence model is used to describe the turbulence flow which mainly exists in the area around the hydrofoil and free surface zone 2 1 governing equations in the two phase flow solver interfoam the fluids are considered as two incompressible isothermal and immiscible fluids jacobsen et al 2012 the governing equations are the mass continuity equation and momentum conservation equation are written as 1 u 0 2 ρ u t ρ u u p t ρ f b where u is the velocity field throughout the domain ρ is the density of fluid p is pressure t is the viscous stress tensor and f b are the body forces per unit mass which is the acceleration due to gravity and surface tension effects at the interface 2 2 free surface model the interfoam solver uses the multidimensional universal limiter for explicit solution mules method to resolve the flow of both air and water phases and the evolution of the interface between them it is an algebraic vof avof method and no interface reconstruction process is applied during the calculation two immiscible fluids are considered as one effective fluid throughout the domain the free surface is tracked as 3 α t u α 0 where α is the volume fraction which is defined as the relative proportion of water in each cell if α 1 the cell is full of water and if α 0 the cell is full of air and in any case the cell contains the interface between air and water generally the iso surface α 0 5 is used to present the position of the free surface in mules an artificial compression term is added to the conventional transport equation equation 3 to limit the amount of interface smearing 4 α t ρ u α u r 1 α α 0 where u r is the artificial velocity field used to compress the interface and which takes effect only near the interface the expression for this term is found in deshpande et al 2012 in the post processing step the iso contour of volume function α 0 5 is defined to be the location of the free surface the surface tension plays an important role in spilling breaking waves since the pressure jump mainly depends on the curvature of the free surface it is therefore necessary to take the surface tension into account to capture the free surface accurately in the interfoam solver the surface tension term mentioned in eqn 2 is evaluated using a continuum surface force csf model 5 f σ σκ δ α where σ is surface tension σ 0 072 kg s2 in an air water system κ is the curvature of the free surface and is defined as 6 κ α α 2 3 turbulence model for modelling turbulent flow a standard k ε model turbulence model is used to model the effects of turbulence because the model has been demonstrated to perform well in the fully turbulent region and in free shear layers menter 1994 this is a semi empirical model based on two transport equations for the turbulent kinetic energy k and its rate of dissipation ε the two equations are 7 ρ k t ρ k u i x i x j μ t σ k k x j 2 μ t e i j e i j ρ ε 8 ρ ε t ρ ε u i x i x j μ t σ ε ε x j c 1 ε ε k 2 μ t e i j e i j c 2 ε ρ ε 2 k here e i j is component of rate of deformation σ k σ ε c 1 ε and c 2 ε are constants and μ t is turbulent viscosity and calculated by combining k and ε as follows 9 μ t ρ c μ k 2 ε where c μ is a constant 2 4 discretization schemes and solver settings for the spatial domain the standard gaussian finite volume integration method is usually used based on summing values on the cell faces to achieve higher accuracy when integrating of the derivative terms mohseni et al 2018 for the convection terms in the momentum equations the gradient terms u and divergence terms ρ φ u a gauss linear scheme is used which is second order gaussian integration φ ρ u is the flux the gauss scheme is also the only choice of discretization for viscous terms containing laplacian terms like ν u jacobsen et al 2012 and a gauss linear corrected scheme is used in the present work with unbounded second order and conservation numerical behaviours for the terms with volume function α the discretization uses a gauss vanleer scheme which is second order and bounded to deal with the discontinuity across the interface between air and water for turbulent equations φ k and φ ε a gauss limited linearv 1 scheme is used which is second order and bounded for time discretization the second order backward implicit scheme is used for the solution of velocity and pressure the pimple piso simple algorithm is used for pressure velocity coupling which is a hybrid of a pressure implicit splitting operator piso algorithm and a semi implicit method for pressure linked equations simple algorithm 3 code verification the verification of the validity of the two phase flow solver is performed against the experimental results obtained by duncan 1983 who investigated the breaking and non breaking wave resistance of a two dimensional hydrofoil by changing water depth and angle of attack with the aim of validating the two phase flow solver two cases are chosen on the basis of the experimental conditions used in duncan 1983 and simulations undertaken of free surface flow generated by a naca 0012 hydrofoil the parameters of the two validation cases are listed in table 1 for case 1 a regular non breaking flow is generated behind the foil whilst for case 2 the waves are in a breaking state around x 0 5 as occurred in duncan s results the simulations are conducted on a 2d computational domain of x 2 4 and y 1 1 with a naca 0012 hydrofoil fixed at 0 0 the inlet velocity imposed at the inlet boundary is fixed with u 0 8 m s for both water and air phases the initial free surface elevation is set according to the submergence depth given in table 1 physical parameters for both phases are chosen the same as in the experiment figs 1 and 2 show a comparison of the wave profiles computed by the two phase flow solver at t 100s with the experimental data from duncan s research duncan 1983 it is clear that the predicted wave profiles are in very good agreement with the experimental data 4 computational implementation and convergence study 4 1 computational set up the numerical tests are carried out in a three dimensional 3d numerical flume the results are compared with the experimental data by mossa 2010 using an lda system the geometric model is built from standard naca0024 hydrofoil coordinates shown in fig 3 the origin of the x coordinate is placed level with the leading edge of the hydrofoil and y coordinate at the flume bottom and the foil is fixed with the chord length c 0 2 m at an angle of attack of 10 the entire computational domain and the different boundary conditions applied at inlet outlet bottom upper and on the hydrofoil are shown in fig 4 the front and back boundary conditions are set as slip boundary conditions to avoid extra vortices on the wall the length of the inlet and outlet boundaries are 1 5c the same as the channel used in the experiments while that of the upper and bottom boundaries are 25c shorter than the real test facility the shorter domain was chosen to reduce computational costs while retaining the quality of the numerical solution the leading edge of the hydrofoil is placed at a height of 0 5c from the bottom and at a distance 10c from the inlet boundary where the upstream and downstream influence of the hydrofoil on the measured flow was negligible the width of the numerical flume is set as 0 5c in the numerical simulation the initial free surface is set as still water level over the horizontal bottom at h 0 19 m the flow rate at the inlet boundary is set at a fixed discharge φ of 0 038036 m3 s with a uniform velocity is 1 001 m s in the water domain at t 0s while the velocity of the air phase keeps at zero the corresponding initial reynolds number re ρ u c μ with ρ water density 1000 kg m3 and water dynamic viscosity 0 001 ns m2 is 190 180 and the froude number fr u g h with g gravity acceleration of 0 7336 six measurement sections are placed along the flume at x 0 25 m 0 426 m 0 523 m 0 67 m 0 8 m and 1 025 m from the leading edge of the hydrofoil on the longitudinal section of the flume to measure the free surface elevation and velocity fields according to the experiment at the first two sections the flow from the upper and lower parts of the hydrofoil mixes with each other and the hydrofoil wake is initially generated and developed the next two sections are positioned in the spilling wave breaking zone the last two sections are chosen in the wake flow area and the flow tends to return to a uniform state with increased distance from the trailing edge 4 2 mesh generation and grid independency study the meshing of the blocks consists of conformal non orthogonal structured elements throughout the whole computational domain a refined meshing is employed near the hydrofoil see fig 5 bottom boundary and free surface compared to the remainder of the rest of the domain to capture better the near wall turbulent flow and wave profile the standard wall function versteeg et al 1995 is employed for the near wall treatment the estimation of the distance to the wall is based on the skin friction coefficient c f as follows prasad et al 2015 10 c f 0 026 r e 1 7 the distance to the wall is defined with the non dimensional parameter y 11 y u f y υ where u f is the friction velocity at the nearest wall y is the distance to the nearest wall and υ is the water kinematic viscosity the values of y around the hydrofoil and the bottom boundary in the present simulations are in the range 5 10 grid space and time step convergency studies are carried out for the free surface evaluation and the drag and lift coefficients of the hydrofoil in the numerical flume to capture spilling breaking waves the resolution for the spatial discretization of the region near the free surface is important in the numerical simulation so a cuboid mesh is designed in the breaking wave area near the free surface three different grids namely mesh a mesh b and mesh c are applied in this study to check the convergence studies of the results the refinement factor for both spatial and temporal is set to 2 with the maximum courant number co 0 5 in all these cases the total cell number for mesh a is 11 16 million with mesh size dx dy 0 0014 m mesh b is 15 784 million with dx dy 0 001 m and mesh c is 22 32 million with dx dy 0 0007 m while the mesh size on z direction dz 0 002 m in all three meshes to reduce the calculation in this section the simulation of the hydrofoil is in the same conditions as the experiment reported by mossa 2010 the spilling breaking wave is simulated and compared with the experiment the convergence of the free surface profile at 30s is shown in fig 6 a the iso surfaces with α 0 5 is used to present the position of the free surface the overall structures of the free surface obtained on the three grids are very similar it can be noted that for all meshes although the water level downstream is slightly overestimated the spilling breaking wave region shows a very good accordance with the experiment in both wave height and length the position and height of the wave downstream of the hydrofoil are better predicted on a fine grid than on a coarse grid and a finer grid can capture more details of the free surface with higher grid resolution to show the differences between wave profiles clearly the spilling breaking wave zone is enlarged and shown in fig 6 b the main bodies of water are almost overlapped in the three grid sizes while the crest of wave is slightly more downstream in mesh a more and smaller water droplets and air bubbles generated by the breaker can be observed on the finer meshes mesh b and c in and after the breaking wave zone although the overall large scale dynamics of wave breaking waves obtained on the three grids are very similar small scale features like droplets and air entrainment which are captured better by the finer meshed mesh b and c are not well understand stern et al 2013 and the effect of the small scale details on the dynamics of interface breaking is investigated in this study the computed values of lift and drag coefficients with these three grids are also calculated and compared in fig 7 it is seen that there is a small amount of change in results for increasing the number of cells from mesh a to mesh c the variations are 0 126 for lift force and 0 33 for drag force the convergence ratio decreases with the increase of mesh number which means the numerical model is monotonically converging according to the analysis of wave profiles and force components mesh b is selected as appropriate resolution since droplets and bubbles are captured better than mash a while the calculation is less demanding than mesh c in all simulations adaptive time steps are used with a maximum allowed courant number co in order to check the time independence of the cfd simulations three co numbers are tested based on the chosen mesh b co 0 1 co 0 5 and co 1 0 again the wave profiles at t 30s for different co numbers are extracted and compared similar results are obtained with all three co numbers with the main body of the water overlapped see fig 8 the positions of droplets and air bubbles are not exactly the same but appear in similar areas a co 0 5 is thus adopted to achieve a necessary condition for time convergence whilst keeping the calculation to an acceptable computational burden 5 results and discussion 5 1 numerical set up in order to investigate the hydrodynamic properties of spilling breaking waves and the effect of the breaking wave on the resulting waves a non breaking wave case is designed as a reference the state of a wave generated behind the hydrofoil is highly affected by the submergence depth duncan 1983 performed a series of experiments to investigate the breaking and non breaking waves caused by changing the submerged depth this work was used to guide the present investigation and thus the only difference between the initial condition of the two cases in the present work is the depth of water which is the deciding factor for the wave state generated behind the foil the initial conditions for the designed non breaking wave case are slightly different from the spilling breaking wave case with a higher initial free surface elevation and a lower uniform velocity at the inlet boundary the discharge φ keeps the same value as that in the experiment and between the two cases simulated the initial conditions for the two cases are illustrated in table 2 other computational set ups such as mesh and boundary conditions remain exactly the same the numerical results obtained from the two cases are compared with the measurement data in the experiment for the breaking wave case the instantaneous wave surface profiles and pressure fields are compared between the two cases followed by data analysis on the velocity fields 5 2 instantaneous results in order to investigate the deformation of the free surface during the spilling breaking waves the instantaneous contour of the free surface with volume fraction value α 0 5 for the two cases are shown in figs 9 and 10 with pressure and velocity fields respectively the results are obtained at t 30s when the breaker stays at the same position for more than 10 s the position of the main water body maintains the same shape whilst the small scale features such as droplets and air bubbles repeat a similar process with time see fig 11 the locations of six measurement sections are shown in fig 9 as mentioned before the six sections are set at maximum froude number s1 the generation of waves s2 spilling breaking first wave crest s3 s4 and wake region s5 s6 fig 9 presents the contours of pressure distribution with lines of constant pressure the pressure here represents the dynamic pressure obtained by subtracting the hydrostatic pressure from the total pressure p r g h p ρ g h this term is advantageous for analyzing the contribution of pressure to the wave deformation process for both of the cases the changes of pressure are negligible in the air region but significant in the water region higher pressure values are concentrated at the front of the hydrofoil and a region of more uniform pressure is progressively created further along the hydrofoil little difference can be observed in the suction pressure produced by the hydrofoil after the trailing edge the pressure distributions are similar before the wave breaking region as for the region downstream the pressure distributions differ from one to the other though both of them are typical pressure patterns for free surface flows with high pressure near a wave crest and low pressure under a wave trough the first wave crest in the non breaking wave case is significantly higher than in breaking wave case with higher pressure as well there are also visible variations of pressure in the following waves in the non breaking case while negligible changes can be observed in the breaking wave case under the almost flat free surface after the spilling breaker fig 10 illustrates the velocity magnitude fields for both the water and air regions as with the pressure fields the velocity distributions are similar between the two cases before the breaker the velocity of the main region of air remains at zero but is increased closer to the free surface there is a high shear flow around and behind the hydrofoil in a region between the free surface and the bottom there is no obvious boundary layer separation around the hydrofoil and the flow is completely attached along the wall boundary the velocity on the face side of the hydrofoil does not change much and remains roughly uniform until the flow reaches the hydrofoil the velocity on the back side is very high near the leading edge and then gradually decreases alongside the trailing edge of the hydrofoil the differences start at around x 0 4 m where the spilling breaking waves are fully developed a vortex appears in the first wave crest where the spilling breaking wave is produced the velocity inside of the vortex decreases sharply and reaches zero at the tip of wave crest in the non breaking case the velocity decreases with the height of the wave as well but is more gently and smoothly resulting in a steady wave train after the foil the detailed analysis of velocity profiles computed in breaking and non breaking case will be given in the next section with the comparison to experiments 5 3 velocity profiles the turbulent flow around the hydrofoil and near the free surface is described by the standard rans k ε turbulence model the analysis of velocity fields is also based on the reynolds decomposition even though it is a 3d simulations the width of the numerical flume is relatively short and the main hydrodynamic characteristics vary along the x and y directions so only two terms of velocity components u and v are investigated in the present work the velocity data are separated in their time averaged values u and v and the fluctuation terms u and v 12 u u u u 1 t 0 t u d t 13 v v v v 1 t 0 t v d t where the t is the integration time in actual data analysis the first 20 s unsteady period is neglected during this period the uniform inlet flow is accelerated by the hydrofoil and the flat free surface deforms and turns into the waves after this transient period the flow reaches a steady state the data from the following 10s is then considered and averaged to obtain the mean velocities and the fluctuation terms the time averaged horizontal velocity u at the six measurement sections are shown in fig 12 the red dots are data obtained from the experiment mossa 2010 the solid lines are the results of the spilling breaking case and the dashed lines are the results of non breaking waves in general the numerical simulation results for the spilling breaking waves agree quite well with the experiments especially in the hydrofoil wake and the spilling breaking wave area the uniform inlet flow is accelerated by the hydrofoil the velocities of main body of water increase from section x 0 25 m to x 0 426 m and decrease sharply from the breaking wave region around x 0 523 m to x 0 67 m the change of the velocities after that diminishes in magnitude and the flow tends to be uniform again the hydrofoil wake is captured at section x 0 25 m with a sudden reduction of velocity near the hydrofoil level y 0 07 m the horizontal velocities reach a maximum at this point except for a small region just downstream of the trailing edge a thick wake is produced by the nearly separated flow on the top back of the hydrofoil strong velocity gradients also occur near the trailing edge of the hydrofoil this is caused by the mixing of the flow from the upper and lower parts of the hydrofoil and leads to an increase of the velocity above the upper side of the hydrofoil this defect diminishes in magnitude with the flow direction but can still be observed at section x 0 8 m especially for the spilling breaking case it is not surprising that the cfd simulations in both cases fail to capture the sharp defect of horizontal velocity downstream of the trailing edge and are not as sensitive as the efd techniques fig 12 section x 0 25 m only large scale turbulent motions are directly calculated with small scale vortical structures are modelled by the adopted rans k ε turbulence model the mesh sizes in this region are smaller than the turbulent length scale more sensitive turbulence model such as large eddy simulation les may help to improve the description of turbulent flow although much smaller turbulence can be captured with higher grid resolutions or a better turbulence model the overall large scale dynamics of turbulence are not affected and are captured with the present model besides the decrease of velocity in the hydrofoil wake and bottom region there is a strong decrease near the free surface region all the way along the flow direction these decreases in velocity in the breaking wave case are well captured in the numerical simulations and have the same trend as the experimental data the main parts of the velocity fields are similar between the spilling breaking waves and non breaking cases while the biggest differences occur in the free surface region on the first two sections x 0 25 m and x 0 426 m the two cases are similar with a slightly decrease in a narrow band near the free surface the band extends greatly into an area with a height of around 0 07 m in the region between section x 0 523 m and x 0 67 m in this region the spilling breaker is fully developed in the spilling breaking waves case and the steepest wave is generated in the non breaking wave case the velocity defect in spilling breaking waves is larger than in the non breaking case this is because there is a stronger turbulent flow below the breakers and this is confirmed by the turbulence intensity profiles analyzed in section 4 3 in the region following the breaking the turbulent trailing wake behind the spilling breaker gradually diminishes but at a longer distance downstream than in the non breaking wave case there is still a small defect observed at the section x 0 8 m while in the non breaking wave case the velocity changes smoothly without a sharp decrease near the free surface on the last section the velocity profiles of the two cases tends to be similar again it is interesting to observe that the horizontal velocity u is underestimated by a larger amount further downstream in the breaking wave region compared to efd data at section x 0 8 m and x 1 025 m one possible reason for this discrepancy may be in the setting of the initial still water level which may affect the position of the free surface a related phenomenon can be seen in fig 6 where the water level downstream is slightly higher than in the experiments the flux rate remains the same at every section as the inlet boundary in the cfd simulation to guaranteed mass conservation in the calculations it is interesting to note that an approximate check of the flux rate φ in the efd data mossa 2010 by integrating velocity on the section x 0 8 m and x 1 025 m is larger than the fixed discharge from the upstream gate fig 13 presents the time averaged vertical velocity profiles v at the different sections the values of v are much smaller than the horizonal components the hydrofoil wake is also correctly captured at the first section near the hydrofoil tail the sudden reduction of the vertical velocity component v after the spilling breaking waves steepest wave in non breaking case from section x 0 523 m to x 0 67 m the velocity profiles of the two cases are almost overlapped with each other while some fluctuations can be observed in the breaking waves area near the free surface the vertical velocity v decreases close to zero at section x 0 8 m and x 1 025 m and the horizontal velocity u tends to be uniform except near the non slip bottom wall the influence of the hydrofoil on the flow is greatly reduced 5 4 turbulence intensity profiles as shown in eq 11 and eq 12 the velocity data u and v are separated into their time averaged values u and v and fluctuations u u u and v v v for the statistically turbulent flow the turbulence intensities are obtained from a root mean square value of the velocity fields 14 u r m s 1 n i 1 n u i u 2 15 v r m s 1 n i 1 n v i v 2 where n is the number of recorded values during the steady state it should be noted that the velocity fluctuations around the mean flow in the turbulent flow depend both on the small scale and large scale unsteady vorticity generated by the hydrofoil however in the rans k ε turbulence model the entire turbulence spectrum is modelled and the resolved scales are assumed to be above the inertial subrange therefore the turbulence intensities in the steady state conditions are here referred to as large scale motions the values of turbulence intensities u r m s and u r m s at the six measurement sections are compared with the experimental values in figs 14 and 15 good agreement is achieved between the spilling breaking wave results and the experimental values although the horizontal turbulence intensity is slightly underestimated in the far fields behind the hydrofoil where the flow tends to be uniform again the turbulent flow beneath the free surface is much gentler compared to the region close to the hydrofoil the very small scale turbulence will not be captured by the adopted rans k ε turbulence model similar to the time averaged velocity profiles the main parts of the breaking and non breaking wave case are almost overlapped while some differences occur in the breaking waves area compared to non breaking wave case with much more moderate horizontal turbulent intensity of an almost uniform value of u r m s 0 2 m s in the whole water domain in the breaking waves case large turbulent intensities concentrate near the free surface especially in the breaking wave area between section x 0 523 m and x 0 67 m and decays downward and downstream the greatest horizontal turbulent intensity reaches 0 45 m s in the breaker the region of turbulent flow is consistent with the area of the decrease in time averaged horizontal velocity fig 12 with a stronger shear layer or a surface roller induced by the spilling breaking waves there seems to be a streamline dividing the upper turbulent roller from the main flow beneath the breaker the precise determination of the location of the dividing line is impossible because of the rapid mixing in the experiment battjes and sakai 1981 but is more obvious in the numerical simulation results of turbulent intensity in fig 14 and reynolds shear stress in fig 16 the time averaged vertical velocities v are much smaller than the horizontal velocities u the same is true for the vertical fluctuation terms where v r m s are smaller than the horizontal ones greater values of turbulent intensities can be observed in the breaking wave area than the non breaking case but decrease immediately after the breaker it is interesting to see that the turbulent intensities are slightly underestimated in the wake right after the tail of hydrofoil at the section x 0 25 m and the far downstream of the flow at the section x 1 025 m this may be caused by the rans turbulence model used in the present work which fails to capture very small scale unsteady motions in the rans models the attentions are focused on the mean flow and the effects of turbulence on the mean flow properties the mesh sizes in the turbulent flow region near the free surface flume bottom around and after the foil are smaller than the turbulent length scales the very peak fluctuations may be smoothed by time or space when analyzing the data however even though the very small scale unsteady motions are not captured the effects are modelled by the rans model and has been considered when solving the mean flow motion 5 5 reynolds shear stresses the cross correction of the two fluctuating velocity components u v is inversely proportional to the reynolds shear stress battjes and sakai 1981 and takes into account the effect of the modelled small scale turbulent eddies padova et al 2016 the calculation of the cross product is given as follows 16 u v 1 n i 1 n u i u v i v fig 16 shows the values of the cross correlation u v at the six measurement sections as may be expected the reynolds shear stresses are particularly large in the region of breaking waves near the free surface while in the mean water beneath the breaker the values of shear stress are close to zero the highest value of u v could be over 0 3 m2 s2 at the tip of breaking waves which is three times that in non breaking wave case in light of the results of figs 14 16 it is possible to conclude that there is a wake generated by the hydrofoil starting from the spilling breaker and going downstream but limited to the region near the surface the contours of the cross product of the two fluctuating velocity components u v are shown in fig 17 compared to the violent breaking wave case the u v contours are much smoother in the non breaking case as observed in the profile in the non breaking case a high u v region exists on the upstream side of the first wave this indicates that reynolds shear stress plays an important role in the transformation from non breaking waves to breaking waves on the one hand it represents energy transport i e energy continuously transforming from the averaged motion to turbulent kinetic energy on the other hand the strong shear stress induces energy dissipation into heat by viscous forces as shown in fig 12 x 0 523 m the averaged velocity reduced dramatically where the value of u v is large the energy will be discussed in section 4 5 5 6 energy dissipation process a useful approach in estimating the energy dissipation rate is to integrate the energy balance equation according to bernoulli s principle in the x direction and calculate its decay huang et al 2009 this has an advantage of including all the factors that may cause energy like the bottom friction the total fluid energy dissipation ratio can be calculated from the deficiency of the time averaged energy flux through the application of the energy balance equation in the cross sections of x direction the mean total energy flux per width f is defined as 17 f b h p 1 2 ρ u 2 v 2 ρ g y u d y where b is the position of bottom and h is the height of the free surface the total mechanical energy flux of flow f can be divided into kinetic and potential terms 18 f k b h 1 2 ρ u 2 v 2 u d y 19 f p b h p ρ g y u d y the energy dissipation ratio d is defined by 20 d f f x f 0 f 0 where f x is the local energy flux at a section x in the x direction and f 0 is the energy flux at section x 0 m for the breaking wave case the whole process in the x direction can be divided into three stages acceleration stage wave breaking stage and quasi steady stage according to the variation of energy flux at the first section x 0 m 81 7 of energy flux is composed of f p only 18 3 is f k the fluid is then accelerated by the hydrofoil and the fluid energy is gradually transferred from f p to f k and the f k reaches a maximum at x 0 4 m which is more than twice its initial value before the hydrofoil in the wave breaking stage 0 3 m x 0 5 m f k decreases significantly indicating that the wave transfers its energy from kinetic energy back to potential energy after the breaking area the flow becomes steady and close to a quasi steady state at x 0 7 m with gentle turbulence dissipation remaining about 6 of the energy of the initial incident flow energy is dissipated after all these three stages see fig 19 and about 50 of the dissipated energy is lost during the wave breaking area for the non breaking wave case the main processes of energy distribution are similar to the breaking waves case but the transformation between potential and kinetic energy is gentler in the region between x 0 3 m and 0 4 m where the first wave in non breaking wave case and breaking waves in spilling breaking wave case developed the maximum kinetic energy rate at x 0 3 m and 0 4 m is 35 in the non breaking wave case which is 5 smaller than that in the breaking wave case as shown in fig 19 the discrepancy of energy dissipation rate between the two cases is quite large in this region but gradually reduces after the breaking wave area this indicates that the violent turbulent flow generated in the breaking increases the dissipation rate but its contribution to the dissipation ceases immediately after the breaker the free surface eruptions in spilling wave breaking indicate that the broken free surface is a result of the strong turbulence generated underneath the free surface meeting the free surface kandasamy et al 2009 breaking induced turbulence can be produced by fluid shear or friction in between water and air turbulence induces a two fold transfer of the fluid energy a the fluid energy reduces as energy transfers from large to smaller length scales and b smaller energy cascade is dissipated by viscous forces in order to investigate the ratio of the turbulence dissipation rate to the total energy dissipation rate the turbulent kinetic energy tke k and the turbulence dissipation rate ε is recorded and analyzed drazen and melville 2009 a typical budget equation for turbulent kinetic energy is given by 21 d k d t t p ε where d k d t is the mean flow material derivative of tke and t is the turbulence transport of tke p is the production of tke the value of tke for water phase can be calculated by turbulence intensities 22 f t k b h 1 2 ρ u 2 v 2 u d y the loss energy induced by turbulent motions can be integrated and time averaged as 23 d t k 0 x d x b h ρ ε d y d t k may be approximated to within 5 uncertainty by the averaged energy dissipation the turbulence dissipation rate fluctuates rapidly because of the highly unsteady breaking wave as expected from the analysis of the velocity field the values of tke are extremely high at the breaking area and the upstream area of the first wave generated by the hydrofoil in non breaking wave case see fig 20 in a spilling breaker the roller region turns a portion of the flow energy into tke turbulence generated in the breaker is diffused in the flow and depth directions with a consequence of a lower turbulence fluid the spread of turbulence energy is confined only to the close part of the breaker however in the case of a non breaking wave the tke generated on the upstream side of the first wave spreads over the entire water with a gentle decrease in the magnitude the value of tke downstream is twice as large as the breaking waves case this difference may be caused by a large amount of energy dissipated during the breaking process and the flow tending to return to a uniform state with less energy exchanges after that the distribution of turbulence dissipation rate ε is similar to the distribution of tke with peaks at the breaker region and below the first wave this can also be concluded from figs 18 and 19 the proportion of kinetic and potential energy remains fluctuating in the non breaking wave case but is almost constant after the breaker in breaking wave case the ratio of turbulent dissipation d t k to the total energy dissipation d f is shown in fig 21 to investigate the contribution of the turbulent motions at the starting point x 0 m the ratio is not very small and is 8 it can be seen that the foil starts to have an effect on the uniform flow from this section and the flow is accelerated by the hydrofoil the turbulence is initially generated and the ratio decrease along the hydrofoil this indicates the major part of the total energy may be lost or transported to elsewhere such as the heat induced by friction of hydrofoil surface or bottom in the case of breaking waves the ratio increases rapidly in the breaker area and reaches to 20 the rapid increase evidences the intense turbulence production during the process however the increase stops shortly after the breaker the ratio of turbulent energy dissipation remains at around 20 with a small fluctuation of less than 1 in the case of non breaking wave the ratio starts to increase at x 0 5 m where the turbulent flow is already fully developed and the dissipation of turbulence is greater than the production mechanisms the ratio keeps increasing after the first wave crest with tke downstream based on a comparison of the two cases it is found that the turbulent energy induced by the breaking wave is about 12 of the total energy dissipation 6 conclusion a two phase flow solver is applied to the numerical simulation of the turbulence and energy dissipation process in the waves generated downstream of a shallowly submerged hydrofoil the analysis is performed based on urans equations incorporated with an algebraic avof method for free surface capture and a standard rans k ε turbulence model for turbulent flow description the numerical model is validated for a spilling breaking wave case though a comparison with the experiment by mossa 2010 and the numerical results show excellent agreement with the experimental data for the wave profiles the free surface flow is shown to be determined satisfactorily by the avof method the standard rans k ε turbulence model predicts well the strong turbulent flow after the submerged hydrofoil but has limitations with the turbulent flow further downstream a direct comparison of flow conditions between a breaking and non breaking wave case is conducted to allow investigation of the characteristics of the wave breaking process the difference in the velocity fields between the spilling breaking waves and non breaking waves are concentrated on the breaking area where the instantaneous horizontal velocities drop sharply to zero in the breaking case analysis of the velocity and turbulence intensity profiles for the two cases indicates that there a stronger shear layer or a surface roller induced by the spilling breaker divided by a streamline from the main flow beneath the breaker extremely violent turbulent flow exists in this shear layer and the greatest value of turbulent intensities inside the breaker is up to three times that in non breaking waves besides the values of turbulent intensities the analysis of the cross correction of the two fluctuating velocity components indicates that the reynolds shear stress plays an important role in the decrease of velocity near the free surface and transformation from non breaking waves to breaking waves by transporting energy from averaged motion to turbulent kinetic energy and heat by viscous forces further the energy dissipation processes along the wave flume for the two cases are analyzed and the ratio of the turbulent dissipation rate to the total energy dissipation is calculated for the breaking wave case about 6 of the energy of the initial incident flow energy is dissipated after the whole process and about half of the dissipated energy is lost during the wave breaking region the ratio of turbulent dissipation to the total energy dissipation also shows a dramatic increase in this region compared to the non breaking case the energy redistributes and contributes to turbulent fluctuations in the breaker and the breaker induced turbulence induces approximately 12 of the total energy dissipation this direct comparison between the breaking wave case and non breaking wave case thus enables the hydrodynamic characteristics of spilling breaking waves to be clearly distinguished credit author statement qiu jin methodology software formal analysis investigation writing original dominic hudson supervision validation visualization writing review editing pandeli temarel supervision project administration w geraint price supervision conceptualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the university of southampton and the china scholarship council 
