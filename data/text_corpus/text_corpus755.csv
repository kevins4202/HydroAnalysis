index,text
3775,a knowledge of the evolution of isotopic composition of air masses humidity and precipitation in the western cordilleras of the central andes is still incomplete this study contributes to a better understanding of the factors that control the δ18o and δ2h contents in precipitation water in the north of chile above 2000 m a s l this paper deals with 1 the relevant effects and processes that control the spatial longitude latitude and altitude distribution of stable isotope contents of precipitation events in northern chile 2 the influence of local meteorological variables temperature precipitation and relative humidity on the δ18o and δ2h of precipitation and 3 the estimation of these meteorological and isotopic variables at specific sites to achieve these objectives the relationships between geospatial and meteorological values are identified and analysed followed by the estimation with empirical models these estimation models linear and non linear are obtained after examining validating and calibrating techniques to find the best fit this results in models for temperature relative humidity and precipitation for each month of the year in the same way three isotopic models are derived from the spatial and meteorological variables summer winter and annual temperature has been shown to be controlled to a greater extent by altitude and latitude while relative humidity is by latitude and precipitation in summer is by altitude and latitude monthly meteorological variables have been estimated throughout the study area precipitation δ18o and δ2h are controlled mainly by temperature and altitude and to a lesser extent by latitude longitude and precipitation in the same way three isotopic models are derived from the spatial and meteorological variables summer winter and annual this opens a new perspective of precipitation and its isotopic contents but also allows the calculation of runoff and aquifer recharge and the path for linking future precipitation and aquifer recharge through their isotopic composition keywords central andes northern chile spatial distribution climatology isotopic composition precipitation water resources generation 1 introduction 1 1 general considerations the water resources of a given area depend on precipitation in addition to water coming from neighbouring territories part of precipitation produces aquifer recharge through diffuse processes and infiltration of runoff and other surface water in parts of the territory the scarce water resources in arid areas generally have important environmental and ecological roles and support traditional local human populations but they are also needed to supply other beneficial human activities such as agriculture raising animals urbanization mining industry and tourism these demands all compete among themselves for the available water resources consequently management is needed as well as setting the basis for sound water governance decision making needs the support of different types of studies as well as the corresponding monitoring in this context the isotopic composition of water is an important and necessary study tool raemia 2019 the isotopic composition contents of water samples refers to the stable 2r 2h 1h and 18r 18o 16o isotopic ratios given as delta deviation between sample m and standard s ratios δ rm rs rs the average isotopic composition of precipitation is a characteristic of each region given that precipitation can be one of the main factors of aquifer recharge knowledge characterization and recording of its isotopic content is of fundamental importance when a hydrological study is initiated and carried out custodio and llamas 1983 dapeña and panarello 2007 raemia 2019 δ18o and δ2h contents in precipitation surface runoff and recharge are influenced by many factors 1 the δ18o values of seawater from which the condensing air moisture originates araguas araguas et al 2000 jasechko 2019 2 meteorological conditions relative humidity temperature of the sea surface wind regime and friction between the air and the water surface that control how nonequilibrium isotopic fractionation is produced during the evaporation of ocean water merlivat and jouzel 1979 3 the in cloud microphysical processes galewsky and hurley 2010 galewsky and samuels crow 2015 risi 2009 risi et al 2008 tharammal et al 2017 vimeux et al 2011 4 second order kinetic effects such as snow formation or evaporation below the cloud base 5 mixing of air masses coming from different oceanic or large sea regions araguas araguas et al 2000 6 mixed precipitation water recycled from evapotranspiration over continents gat 2000 gat and matsui 1991 salati et al 1979 7 temperature driven rain occurring when moisture advects over continents gat 1996 8 physical conditions i e temperature pressure humidity during condensation to generate precipitation gonfiantini et al 2001 merlivat and jouzel 1979 and 9 moisture conditions below the clouds and partial evaporation of precipitation along the path between clouds and the ground bailey et al 2018 craig 1961 dansgaard 1964 feng et al 2009 jasechko 2019 1 2 specific considerations on geography and stable isotopes in precipitation in the study area the central andes are formed by two mountain ranges western cordillera and eastern cordillera separated by a highplain that has an average altitude of 4000 m a s l meters above sea level called the altiplano or puna fig 1 which has a large number of recent volcanoes in the central andes the spatial and temporal distribution of the isotopic composition of rainfall has been occasionally analysed in numerous studies since the 1980 s in the eastern cordillera the greatest amount of rain of the year occurs during the summer called altiplanic winter or bolivian winter the factors that control the progressive depletion in heavy isotopes of precipitation from the eastern lowlands to the altiplano are known fig 1 araguas araguas et al 2000 bershaw et al 2016 fiorella et al 2015b 2015a gonfiantini et al 2001 herrera et al 2006 insel et al 2013 2009 roche et al 1999 rozanski and araguás araguás 1995 vimeux et al 2011 2005 vuille 1999 most of the atmospheric humidity that reaches the altiplano from eastern cordillera in summer shows i the continental effect caused by the movement of the air masses above the amazon and gran chaco basins starting from the atlantic ocean herrera et al 2006 mardones 1998 valdivielso et al 2022 ii the recycling effect by the increase in vapor due to the evapotranspiration of vegetation and evaporation from water bodies iii the altitude effect when the air mass arrives at the andes aravena et al 1999 grilli et al 1999 magaritz et al 1989 risacher et al 1998 iv the empirical relationships between temperature aravena et al 1999 and amount effects bershaw et al 2016 jasechko 2019 samuels crow et al 2014 v the formation of clouds that originate from deep convective activity aggarwal et al 2016 aravena et al 1999 1989 these air masses are dragged by the strong easterly winds to the altiplano the western cordillera and the lowlands with precipitation increasingly depleted in heavy isotopes conversely in the western cordillera during the austral winter the easterly winds weaken and the anticyclone from the pacific ocean approaches the continent intensifying the westerly winds the humboldt current from antarctica reduces the temperature of the pacific ocean thus decreasing evaporation therefore rainfall in the altiplano at this time comes from low humidity air masses from the pacific ocean andressen et al 2007 aravena et al 1999 bershaw et al 2016 de porras et al 2017 fuenzalida and rutllant 1986 mardones 1998 valdivielso et al 2022 2020 vuille and ammann 1997 although it is a small fraction of yearly rainfall these air masses from the west cross the desert suffer continental effects and then rise over the andes where they are affected by altitude mardones 1998 and temperature effects finally these air masses precipitate as frontal precipitation raindrops may evaporate during their journey from the cloud base to the earth s surface aravena et al 1999 salazar et al 1998 depending on atmospheric humidity and its isotopic composition and on rainfall amount the difference in the origin of air masses and the type of precipitation between summer and winter in the western cordillera and steep and rough orography favours the mixing of air masses of different origins aravena et al 1999 bershaw et al 2016 garreaud and wallace 1998 grilli et al 1999 mardones 1998 sarricolea et al 2017 scheihing 2018 valdivielso et al 2022 vuille and werner 2005 explains that there is no consensus on the relative importance of the effects of all the factors that control the depletion of heavy isotopes in precipitation in the western cordillera valdivielso et al 2021d 2020 for this reason the main focus of this current study is the identification of climate conditions in areas with precipitation isotopic data but without meteorological information of the moment when the samples were taken or the area to create a basis for understanding hydrological processes the origin of precipitation in cloud microphysical processes and the vapor isotopic composition are out of the scope of this study to determine these variables it is necessary to have for each individual rainfall event the isotopic analysis and the exact date this information is generally not available as the previous studies analysed the isotopic composition of accumulated rain samples during a period without identifying the time and quantity of the individual rain events or without meteorological stations near the sample locations therefore the innovation of this study is the capability of estimating meteorological and isotopic variables of rainfall in areas with scarce and low data quality where models that require more detailed information cannot be applied in this present study the main focus is the identification of climate conditions in areas with precipitation isotopic data but without meteorological information on the samples or the area to create a basis for understanding hydrological processes the goals are as follows 1 determination of the relevant effects and processes that control the spatial longitude latitude and altitude distribution of stable isotopes of precipitation events in northern chile 2 assessment of the influence of local meteorological variables temperature precipitation and relative humidity in the δ18o and δ2h of precipitation water and 3 the estimation of these meteorological and isotopic variables at specific sites to achieve these goals the following steps are followed identify statistically significant geospatial features that influence precipitation relative humidity and temperature in northern chile estimate the monthly meteorological variables dominating in the places where the isotopic composition of precipitation data is available identify statistically significant geospatial and meteorological features that influence the isotopic composition of precipitation in northern chile and estimate the intraseasonal and spatial variability of the isotopic composition of monthly rainfall thus providing a better understanding of the stable isotopic hydrology of the region and its climatic importance this study is structured as follows a brief description of the climate in northern chile section 2 the data and methodology used section 3 the presentation and discussion of the results section 4 and finally the conclusions section 5 2 climate the study area is located in northern chile 17 s to 26 s and 67 w to 71 w fig 2 a administratively from north to south it corresponds to the arica and parinacota region tarapacá region and antofagasta region fig 2b which are collectively designated the norte grande macroregión the study area is part of the norte grande macroregión above 2000 m a s l it is characterized by endorheic basins with many lakes lagoons and salt flats this type of basin exists in the altiplano and in the central depression pampa del tamarugal basin in addition there are a few exorheic basins to the pacific ocean the lluta river camiña river and loa river there is a fast west east topographic slope from sea level up to 6348 m a s l parinacota volcano the andes mountain range extends north to south along the continent and all of chile the climate is arid with an average annual precipitation as low as 0 1 mm year in chaca at 350 m a s l and up to 200 250 mm year at elevations above 4000 m a s l houston 2006a the maximum precipitation occurs during austral summer december january february march called altiplano winter or bolivian winter precipitation increases with altitude with an altitudinal gradient depending on the elevation in pampa del tamarugal it is 3 1 mm yr 100 m up to 3500 m a s l and up to 13 6 mm yr 100 m above that elevation uribe et al 2015 a hyperarid climate dominates in the atacama desert that extends parallel to the coast sánchez murillo et al 2018 between the andes and the coastal cordillera on the coast the regulatory effect of marine waters is one of the factors that influences temperature di castri and hajek 1976 the thermal oscillation increases inlandward as a consequence of the distance to the ocean and the abruptness of the high mountain ranges ciren 2013 the temperature shows a marked altitudinal and latitudinal decrease according to the köppen geiger climate classification fig 2b from the coastline to the andes desert climates bw predominate from 17 30 s to 28 15 s with smaller semiarid climate areas bs a warm desert climate bwh exists in coastal river valleys and extends to the pampa del tamarugal and the mejillones peninsula in winter a tundra climate is found in high areas with amazonian influence et w from northern chile to 27 8 s and semiarid cold bsk w areas extend to 24 21 s and widen from calama to the salar de atacama sarricolea et al 2017 3 methods 3 1 meteorological data in the first step the daily records from 131 automatic weather stations are used these weather stations belong to the general directorate of waters of chile center for climate and resilience research 2020 dga 2020 and to the soquimich company sqm fig 2c the weather stations are located at elevations ranging from 2000 to 5100 m a s l and their spatial distribution is heterogeneous as shown in table s1 the temperature t dataset in the 1969 to 2019 period is obtained from 65 stations air relative humidity rh dataset from 35 stations is from 1986 to 2019 and precipitation p dataset from 130 meteorological stations is from 1958 to 2019 the dataset used in this work are available in valdivielso et al 2021a the second step of data treatment is a quality control process involving identifying outliers the outlier selection criteria is achieved by cross analysis of extreme periods of climatological events for temperature and relative humidity values 95 and less than 5 percentiles of data are considered as outliers corresponding to 9 7 and 10 of the total available daily temperature 176 465 data and relative humidity 60 395 data values for monthly precipitation irregular measurements were cross checked and the outliers were defined which amount 0 7 of the total monthly values 29 065 data in the third step after the outliers are removed the average monthly temperature and relative humidity values and the accumulated monthly precipitation values of each recorded year are calculated for each month and season therefore for the most complete stations 12 average values are obtained in total that is a monthly value for each meteorological parameter 3 2 isotope data isotopic data in the study area from previously published studies were included in this analysis alpers and whittemore 1990 aravena et al 1999 1989 cortecci et al 2005 cricyt 2017 fritz et al 1981 godfrey et al 2019 herrera et al 2016 2006 lagos 2016 lópez et al 2016 moran et al 2019 uribe et al 2015 valdivielso et al 2022 the dataset consists of 300 isotope analyses in the 1973 2017 period from rain and snow samples accumulated daily or monthly the water isotope standard is the vienna standard mean ocean water vsmow which is considered equivalent the standard mean ocean water smow gonfiantini 1978 lin et al 2016 the deuterium excess is defined here as d ex δ2h 8 δ18o some isotope analyses are excluded from the analysis because they have anomalous values of d ex which may indicate the effect of nonequilibrium processes after leaving the base of the cloud rainwater with a negative d ex may show large isotopic fractionation by evaporation probably due to a failure in the sampling or transport of the sample bershaw et al 2016 gonfiantini et al 2001 herrera et al 2016 2006 snow with a d ex well above 20 21 31 may be explained by diffusive fractionation at very low temperatures bershaw et al 2016 landais et al 2012 the 280 isotope samples finally considered correspond to 81 different locations points fig 2c the isotopic monthly average values are calculated for each month of the year at each point from the monthly and daily samples the distribution of the 179 monthly isotopic values from 1973 to 2019 is spatially heterogeneous as shown in table s1 as well as temporally heterogeneous datasets used in this work are available in valdivielso et al 2021b the months with the greatest number of isotopic samples correspond to the rainiest months the distribution of the samples is highly seasonal sixty five percent are concentrated in summer december january february march and 17 are concentrated in winter june july august for this reason due to the differences in atmospheric circulation and seasonal meteorological differences 3 isotopic models were selected summer winter and annual this study focuses on the characterization of geographic and meteorological factors hence the average isotopic values have not been weighted by precipitation as it is often done to identify aquifer recharge zones in a basin putman et al 2019 raemia 2019 3 3 statistical analysis and estimation model to understand and model the relationships among meteorological variables geospatial features and the isotopic composition of precipitation the first step is to investigate the effects of geospatial features altitude latitude and longitude on the meteorological variables a total of seven empirical linear and nonlinear regression functions are selected and their variables are adjusted to the available input data to obtain the best possible fit the five linear regression approaches applied are elasticnet kwangmoo et al 2007 bayesian ridge tipping 2001 least angle regression efron et al 2004 bayesian automatic relevance determination ard regression mackay 1994 and orthogonal matching pursuit mallat and zhang 1993 while the two nonlinear methods are support vector regression platt 1999 and random forest regressor geurts et al 2006 in some of these methods the hyperparameter optimization brute force searching technique was applied to calibrate the estimator by finding the best set of hypervariables that corresponds to the best model chicco 2017 hsu et al 2016 it has to be mentioned that although using the spatial variables as model input could result in poor predictive performance ploton et al 2020 variables can not be simply discarded because of the scarcity of the available data and notable impact of non correlated share of the values on the estimation models analysis of variance anova techniques were applied to select the best of the seven regression models for the different variables studied this was done by calculating the f statistical test and the corresponding ρ values markowski and markowski 1990 considering a 95 confidence level significance level of ρ values 0 05 for each variable of interest the statistically significant geospatial variables were selected for regression in cases where there were fewer than two variables with ρ values less than the significance level two variables with minimal ρ values were chosen for regression the fit is better when r2 values are close to 1 the best model is selected by comparing the r2 values corresponding to the different models the k fold cross validation is a resampling method to avoid overfitting and to validate the model the dataset is randomly split into k groups each group is used as the test dataset and the rest k 1 of the groups are used as the dataset to train the model then the evaluation score for the k models is evaluated using the test group and summarized taylor and tibshirani 2015 in this case the dataset is randomly split into 10 groups and then the model is trained 10 times by 9 groups of data as the training dataset and 1 group as the testing dataset then the mean of the calculated r2 values is the evaluation score applying cross validation in every brute force searching step results in a model validated by a random test dataset by comparing the mean r2 of cross validation for each set of hypervariables the model with higher r2 was chosen as the best calibrated model for that specific regression method then the definitive model was selected by comparing the r2 values from different linear and nonlinear methods with the meteorological models obtained it is possible to estimate the values of temperature relative humidity and amount of precipitation at any specific location in the area and month the next step is analysing the isotopic composition of precipitation based on meteorological models obtained from geographical information these meteorological models estimate meteorological data at locations with isotopic composition data the statistically significant geographic and meteorological features that influence each isotopic composition δ18o and δ2h are chosen and used to estimate isotopic composition values the isotopic composition model workflow is the same as that applied to estimate the meteorological variables which now fits the best model for each isotopic composition variable the random forest rf method is the method that best fits the measured data in all months table s9 the rf is a group of randomized decision trees that create a diverse set of regressors each tree as a regressor that include randomness in each node of a tree the best split strategy is found based on all introduced features by using an rf the variance in the estimator will decrease in comparison with an individual decision tree coupling meteorological and isotopic composition models yields the isotopic composition values at any point the workflow scheme of the statistical analysis and the estimation model is shown in fig 3 and figure s1 the the executable to run the meteorological and isotopic models and the corresponding executable guide are available in valdivielso et al 2021c 4 results and discussion the relevant results derived from the application of the same seven empirical models to meteorological variables and precipitation isotope compositions are summarized in the following subsections a detailed demonstration of results obtained is included in the supplementary material 4 1 meteorological models meteorological models estimate temperature relative humidity and precipitation independently for each month of the year for desired locations according to longitude latitude and altitude temperature shows a strong relationship with altitude throughout the year ρ 2 45e 20 and it is higher in summer ρ 3 21e 33 table s2 and figure s2 temperature decreases at higher altitudes consistent with the decrease in pressure as air expands upwards table 1 latitude also strongly influences temperature ρ 6 40e 05 and this relationship is higher in summer ρ 2 72e 10 which increases from north to south the mean r2 score between observed and calculated temperatures is 0 97 table s3 in laguna tuyajto herrera et al 2016 and risacher et al 1999 consider that the average air temperature is 1 c and the temperature model estimates an average of 3 c relative humidity has a strong relationship with latitude throughout the year ρ 1 12e 05 table s4 and decreases from north to south this is due to the extreme aridity of the salar de atacama in the antofagasta region köppen class bw arid to a lesser extent relative humidity in summer decreases from west to east ρ 3 87e 04 relative humidity also increases with altitude ρ 1 41e 04 the mean r2 score between observed and calculated relative humidity is 0 87 table s5 the average summer precipitation increases with altitude ρ 1 88e 10 and decreases from north to south ρ 5 74e 09 table 2 houston 2006b and houston and hartley 2003 associate this altitude control to the shadow effect of the rain shadow effect created by the andes the average annual precipitation does not have strong relationships with any geospatial variables altitude ρ 8 10e 02 latitude ρ 1 57e 01 longitude ρ 2 08e 01 because the altitude and longitude gradients and distribution of rainfall are not as marked along the year except for summer months december january february march this is because rains during the summer are more abundant and frequent in the north and high areas decreasing towards the south and towards the low areas corresponding to the altiplano winter or bolivian winter precipitation conversely during the rest of the year there are different sources of rainfall and irregular distributions coming from the pacific ocean table 2 houston 2006b considers that precipitation has strong latitudinal control table s6 presents the relationship of the observed values with the calculated values the mean r2 score between observed and calculated precipitation is 0 66 herrera et al 2006 estimate that the mean annual precipitation in the chungrá lake area north of the study area arica and parinacota region is 331 mm and the precipitation model estimates an average of 300 mm year uribe et al 2015 consider a precipitation range of 130 and 180 mm yr in the salar del huasco while the model estimates 105 mm yr in laguna tuyajto the average precipitation has been estimated is between 150 and 200 mm yr by herrera et al 2016 180 mm yr by risacher et al 1999 and the precipitation model estimates an average of 140 mm yr fig 4 a illustrates the standard deviation of cross validation scores of meteorological estimation model cross validation score average on test dataset for each month as an indicator of the estimator uncertainty it can be seen that in summer the standard deviation of the scores are lower than in winter or the whole year this is due to the predictable or erratic behavior of the meteorological variables for instance in summer the precipitation presents a clear gradient but in the rest of the year its behaviour is more chaotic due to the meteorological processes mentioned above see table 3 furthermore average standard deviations of humidity 0 41 followed by precipitation 0 30 and temperature 0 10 show that there is higher estimation uncertainty in humidity models than in models which take into account the precipitation and temperature variables the estimations obtained from these models are illustrated spatially for each meteorological parameter in maps in the supplementary material for each month of the year figures s4 s6 s8 s10 s14 s16 and s18 and the calculated average annual temperature relative humidity and precipitation in the study area appear in fig 5 4 2 isotopic model the δ2h and δ18o contents present the same features in agreement with the high covariance between δ2h and δ18o for this reason only the results for δ18o are shown below high correlation coefficient and a certain amount of collinearity between variables is detected but it can not be treated due to the scarcity of the available data i e between temperature and altitude and longitude and latitude table s7 the isotopic model for δ18o of precipitation in summer depends largely on altitude ρ 4 59e 08 followed by temperature ρ 1 86e 07 latitude ρ 2 03e 05 longitude ρ 2 31e 02 and to a lesser extent by precipitation ρ 1 91e 02 figure s3 this may be due to decreasing of evaporation withincreasing altitude this effect is reduced in winter when the effect that mostly controls δ18o is temperature ρ 7 78e 04 which in turn is correlated with altitude ρ 1 50e 03 precipitation ρ 1 49e 02 and to a lesser extent by relative humidity ρ 1 51e 02 this could be due to the lower temperature lower relative humidity and less evaporation as at higher altitude water is in the solid phase the annual δ18o presents a strong relationship with temperature ρ 3 47e 11 followed by altitude ρ 1 29e 10 latitude ρ 7 78e 04 and to a lesser extent by longitude ρ 3 97e 02 fig 6 notice that the last parameter has poor relationship with the rest of the meteorological and isotopic variables because of the relative reduced longitude range compared with the large range in latitude of the study area and hence high spatial dispersion across latitude for the area the statistical measures of the quality of calculated values with isotopic models are shown in table s8 fig 4b illustrates the standard deviation of cross validation scores of the isotopic estimation model cross validation score average on test dataset for each station summer winter and the whole year as an indicator of estimator uncertainty the uncertainty for δ18o and δ2h in each season is alike which is expected based on the similar behavior of the values it can be seen that in summer and in the whole year the standard deviation of the scores is lower than in winter by comparing fig 4b and table s1 it can be said that there is a meaningful correlation between the number of available data and the standard deviation of the estimation scores this is reflected in the smallest number of winter samples and the largest standard deviation the effect that most influences δ18o is temperature according to δ18o 0 51 t c 14 2 table 4 similar to that calculated in the salar de surire in the arica and parinacota region risacher et al 1999 and according to the world relation δ18o 0 7 t c 13 clark and fritz 1997 the next effect that most influences δ18o is altitude fiorella et al 2015a the calculated altitudinal gradient of δ18o 28 100 m in summer and 0 29 100 m annual is consistent with previous studies 0 2 100 m in tarapacá region acosta and custodio 2008 0 34 100 m in the altiplano of antofagasta region herrera et al 2016 and 0 26 100 m villablanca 2009 0 5 100 m in the altiplano dictuc 2008 the world gradient is between 0 15 to 0 5 100 m clark and fritz 1997 in general the lower the latitude 18 s the lower the temperature is so precipitation is more depleted in heavy isotopes this is because the salar de atacama which has high temperatures is in the higher latitudes of the study area 24 s summer precipitation is more enriched in heavy isotopes than winter precipitation table 3 as observed in the salar de atacama valdivielso et al 2022 fig 7 shows that there is an oscillation of the meteorological variables throughout the year the maximum values of temperature relative humidity and precipitation are in summer while the minimum values are in winter the maximum δ18o values are produced during the summer and decrease in the winter months this oscillation appears clearly in the antofagasta region but it softens towards the north this is because the antofagasta region between the depression of the salar de atacama and the altiplano presents a greater variation in elevation than the other regions the local meteorological water lines lmwls have slopes slightly lower than the commonly accepted global meteorological water line gmwl slope of 8 craig 1961 craig and gordon 1965 raemia 2019 the correlation lines between δ18o and δ2h have slopes between 6 4 and 7 3 and intercepts between 6 7 and 3 these results are consistent with those obtained in putman et al 2019 for arid climates slopes between 5 and 7 and intercepts between 0 and 15 and for the cryosphere köppen class e with slopes between 7 and 8 and intercepts between 20 and 5 these low slopes could be due to subcloud evaporation in dry air putman et al 2019 d ex tends to show possible evaporation effects regionally d ex is generally about 12 which is slightly higher than the world oceanic average value of 10 figure s22 there are seasonal effects that make the summer and winter periods different the supplementary material presents the calculated δ18o maps in the study area for the summer and winter months and the year and the relationship of the observed values with the calculated values figures s5 s7 s9 s11 s13 s15 s17 s19 and s21 the calculated average annual δ18o weighted δ18o and weighted d ex appear in fig 5 5 summary and conclusions the isotopic samples of precipitation collected in the study area in the regions of arica and parinacota tarapacá and antofagasta at altitudes above 2000 m a s l usually accumulate several rainfall events and the meteorological data at the time the precipitation occurred are unknown therefore to determine the influence of these two aspects a compilation of temperature relative humidity and precipitation records of all available meteorological stations in the area was performed first meteorological models were developed that independently estimate temperature relative humidity and precipitation for each month of the year for the locations defined by longitude latitude and altitude the next step was to define the isotopic models from the relationships with the geospatial and meteorological variables temperature and elevation are highly correlated and have the strongest regional control over δ18o latitude and longitude play an important role in the general variations in all the analysed variables with decreasing precipitation and relative humidity from north to south while temperature increases in the interannual analysis precipitation is dominated by the differences in atmospheric circulation throughout the year in summer the abundant convective precipitation in the north is depleted in heavy isotopes this influence decreases southward and precipitation remains enriched in heavy isotopes in winter mainly in the antofagasta region precipitation from the pacific ocean is lighter in heavy isotopes than summer precipitation this study is regional and covers the period from 1975 to 2019 as the isotopic samples accumulate several unidentified rain events the sea surface temperatures ssts the relative air humidity of the different sources of atmospheric water and the back trajectories of the air masses are unknown and the type of clouds that generated the precipitation was not identified for this reason existing atmospheric general circulation models agcms are not used and mean values and approximations are not considered however models with high correlation scores have been obtained in the study area isotopic precipitation data are scarce and there are many more isotopic data from surface water and groundwater therefore in basins without isotopic data on rainfall groundwater data can be geographically related to identify aquifer recharge zones and assign them to aquifers in this way improved sustainable management of water resources will be achieved in hydrological basins with scarce isotopic information on rainfall in northern chile the methodology developed here and the main results constitute a necessary intermediate step to a more detailed and accurate knowledge of water resources generation in the study area which is needed for water resource planning and setting the basis for water governance declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the agencia estatal de investigación from the spanish ministry of science and innovation and the idaea csic a centre of excellence severo ochoa cex2018 000794 s the authors thank sqm chile for their support in obtaining the isotopic and meteorological data r criollo gratefully acknowledges the financial support from the balearic island government through the margalida comas postdoctoral fellowship programme pd 036 2020 the authors are thankful to dr carlos ayora for his critical and constructive comments on the manuscript of this paper as well as to the unknown reviewers for their constructive contributions appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 127380 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 supplementary data 3 supplementary data 4 
3775,a knowledge of the evolution of isotopic composition of air masses humidity and precipitation in the western cordilleras of the central andes is still incomplete this study contributes to a better understanding of the factors that control the δ18o and δ2h contents in precipitation water in the north of chile above 2000 m a s l this paper deals with 1 the relevant effects and processes that control the spatial longitude latitude and altitude distribution of stable isotope contents of precipitation events in northern chile 2 the influence of local meteorological variables temperature precipitation and relative humidity on the δ18o and δ2h of precipitation and 3 the estimation of these meteorological and isotopic variables at specific sites to achieve these objectives the relationships between geospatial and meteorological values are identified and analysed followed by the estimation with empirical models these estimation models linear and non linear are obtained after examining validating and calibrating techniques to find the best fit this results in models for temperature relative humidity and precipitation for each month of the year in the same way three isotopic models are derived from the spatial and meteorological variables summer winter and annual temperature has been shown to be controlled to a greater extent by altitude and latitude while relative humidity is by latitude and precipitation in summer is by altitude and latitude monthly meteorological variables have been estimated throughout the study area precipitation δ18o and δ2h are controlled mainly by temperature and altitude and to a lesser extent by latitude longitude and precipitation in the same way three isotopic models are derived from the spatial and meteorological variables summer winter and annual this opens a new perspective of precipitation and its isotopic contents but also allows the calculation of runoff and aquifer recharge and the path for linking future precipitation and aquifer recharge through their isotopic composition keywords central andes northern chile spatial distribution climatology isotopic composition precipitation water resources generation 1 introduction 1 1 general considerations the water resources of a given area depend on precipitation in addition to water coming from neighbouring territories part of precipitation produces aquifer recharge through diffuse processes and infiltration of runoff and other surface water in parts of the territory the scarce water resources in arid areas generally have important environmental and ecological roles and support traditional local human populations but they are also needed to supply other beneficial human activities such as agriculture raising animals urbanization mining industry and tourism these demands all compete among themselves for the available water resources consequently management is needed as well as setting the basis for sound water governance decision making needs the support of different types of studies as well as the corresponding monitoring in this context the isotopic composition of water is an important and necessary study tool raemia 2019 the isotopic composition contents of water samples refers to the stable 2r 2h 1h and 18r 18o 16o isotopic ratios given as delta deviation between sample m and standard s ratios δ rm rs rs the average isotopic composition of precipitation is a characteristic of each region given that precipitation can be one of the main factors of aquifer recharge knowledge characterization and recording of its isotopic content is of fundamental importance when a hydrological study is initiated and carried out custodio and llamas 1983 dapeña and panarello 2007 raemia 2019 δ18o and δ2h contents in precipitation surface runoff and recharge are influenced by many factors 1 the δ18o values of seawater from which the condensing air moisture originates araguas araguas et al 2000 jasechko 2019 2 meteorological conditions relative humidity temperature of the sea surface wind regime and friction between the air and the water surface that control how nonequilibrium isotopic fractionation is produced during the evaporation of ocean water merlivat and jouzel 1979 3 the in cloud microphysical processes galewsky and hurley 2010 galewsky and samuels crow 2015 risi 2009 risi et al 2008 tharammal et al 2017 vimeux et al 2011 4 second order kinetic effects such as snow formation or evaporation below the cloud base 5 mixing of air masses coming from different oceanic or large sea regions araguas araguas et al 2000 6 mixed precipitation water recycled from evapotranspiration over continents gat 2000 gat and matsui 1991 salati et al 1979 7 temperature driven rain occurring when moisture advects over continents gat 1996 8 physical conditions i e temperature pressure humidity during condensation to generate precipitation gonfiantini et al 2001 merlivat and jouzel 1979 and 9 moisture conditions below the clouds and partial evaporation of precipitation along the path between clouds and the ground bailey et al 2018 craig 1961 dansgaard 1964 feng et al 2009 jasechko 2019 1 2 specific considerations on geography and stable isotopes in precipitation in the study area the central andes are formed by two mountain ranges western cordillera and eastern cordillera separated by a highplain that has an average altitude of 4000 m a s l meters above sea level called the altiplano or puna fig 1 which has a large number of recent volcanoes in the central andes the spatial and temporal distribution of the isotopic composition of rainfall has been occasionally analysed in numerous studies since the 1980 s in the eastern cordillera the greatest amount of rain of the year occurs during the summer called altiplanic winter or bolivian winter the factors that control the progressive depletion in heavy isotopes of precipitation from the eastern lowlands to the altiplano are known fig 1 araguas araguas et al 2000 bershaw et al 2016 fiorella et al 2015b 2015a gonfiantini et al 2001 herrera et al 2006 insel et al 2013 2009 roche et al 1999 rozanski and araguás araguás 1995 vimeux et al 2011 2005 vuille 1999 most of the atmospheric humidity that reaches the altiplano from eastern cordillera in summer shows i the continental effect caused by the movement of the air masses above the amazon and gran chaco basins starting from the atlantic ocean herrera et al 2006 mardones 1998 valdivielso et al 2022 ii the recycling effect by the increase in vapor due to the evapotranspiration of vegetation and evaporation from water bodies iii the altitude effect when the air mass arrives at the andes aravena et al 1999 grilli et al 1999 magaritz et al 1989 risacher et al 1998 iv the empirical relationships between temperature aravena et al 1999 and amount effects bershaw et al 2016 jasechko 2019 samuels crow et al 2014 v the formation of clouds that originate from deep convective activity aggarwal et al 2016 aravena et al 1999 1989 these air masses are dragged by the strong easterly winds to the altiplano the western cordillera and the lowlands with precipitation increasingly depleted in heavy isotopes conversely in the western cordillera during the austral winter the easterly winds weaken and the anticyclone from the pacific ocean approaches the continent intensifying the westerly winds the humboldt current from antarctica reduces the temperature of the pacific ocean thus decreasing evaporation therefore rainfall in the altiplano at this time comes from low humidity air masses from the pacific ocean andressen et al 2007 aravena et al 1999 bershaw et al 2016 de porras et al 2017 fuenzalida and rutllant 1986 mardones 1998 valdivielso et al 2022 2020 vuille and ammann 1997 although it is a small fraction of yearly rainfall these air masses from the west cross the desert suffer continental effects and then rise over the andes where they are affected by altitude mardones 1998 and temperature effects finally these air masses precipitate as frontal precipitation raindrops may evaporate during their journey from the cloud base to the earth s surface aravena et al 1999 salazar et al 1998 depending on atmospheric humidity and its isotopic composition and on rainfall amount the difference in the origin of air masses and the type of precipitation between summer and winter in the western cordillera and steep and rough orography favours the mixing of air masses of different origins aravena et al 1999 bershaw et al 2016 garreaud and wallace 1998 grilli et al 1999 mardones 1998 sarricolea et al 2017 scheihing 2018 valdivielso et al 2022 vuille and werner 2005 explains that there is no consensus on the relative importance of the effects of all the factors that control the depletion of heavy isotopes in precipitation in the western cordillera valdivielso et al 2021d 2020 for this reason the main focus of this current study is the identification of climate conditions in areas with precipitation isotopic data but without meteorological information of the moment when the samples were taken or the area to create a basis for understanding hydrological processes the origin of precipitation in cloud microphysical processes and the vapor isotopic composition are out of the scope of this study to determine these variables it is necessary to have for each individual rainfall event the isotopic analysis and the exact date this information is generally not available as the previous studies analysed the isotopic composition of accumulated rain samples during a period without identifying the time and quantity of the individual rain events or without meteorological stations near the sample locations therefore the innovation of this study is the capability of estimating meteorological and isotopic variables of rainfall in areas with scarce and low data quality where models that require more detailed information cannot be applied in this present study the main focus is the identification of climate conditions in areas with precipitation isotopic data but without meteorological information on the samples or the area to create a basis for understanding hydrological processes the goals are as follows 1 determination of the relevant effects and processes that control the spatial longitude latitude and altitude distribution of stable isotopes of precipitation events in northern chile 2 assessment of the influence of local meteorological variables temperature precipitation and relative humidity in the δ18o and δ2h of precipitation water and 3 the estimation of these meteorological and isotopic variables at specific sites to achieve these goals the following steps are followed identify statistically significant geospatial features that influence precipitation relative humidity and temperature in northern chile estimate the monthly meteorological variables dominating in the places where the isotopic composition of precipitation data is available identify statistically significant geospatial and meteorological features that influence the isotopic composition of precipitation in northern chile and estimate the intraseasonal and spatial variability of the isotopic composition of monthly rainfall thus providing a better understanding of the stable isotopic hydrology of the region and its climatic importance this study is structured as follows a brief description of the climate in northern chile section 2 the data and methodology used section 3 the presentation and discussion of the results section 4 and finally the conclusions section 5 2 climate the study area is located in northern chile 17 s to 26 s and 67 w to 71 w fig 2 a administratively from north to south it corresponds to the arica and parinacota region tarapacá region and antofagasta region fig 2b which are collectively designated the norte grande macroregión the study area is part of the norte grande macroregión above 2000 m a s l it is characterized by endorheic basins with many lakes lagoons and salt flats this type of basin exists in the altiplano and in the central depression pampa del tamarugal basin in addition there are a few exorheic basins to the pacific ocean the lluta river camiña river and loa river there is a fast west east topographic slope from sea level up to 6348 m a s l parinacota volcano the andes mountain range extends north to south along the continent and all of chile the climate is arid with an average annual precipitation as low as 0 1 mm year in chaca at 350 m a s l and up to 200 250 mm year at elevations above 4000 m a s l houston 2006a the maximum precipitation occurs during austral summer december january february march called altiplano winter or bolivian winter precipitation increases with altitude with an altitudinal gradient depending on the elevation in pampa del tamarugal it is 3 1 mm yr 100 m up to 3500 m a s l and up to 13 6 mm yr 100 m above that elevation uribe et al 2015 a hyperarid climate dominates in the atacama desert that extends parallel to the coast sánchez murillo et al 2018 between the andes and the coastal cordillera on the coast the regulatory effect of marine waters is one of the factors that influences temperature di castri and hajek 1976 the thermal oscillation increases inlandward as a consequence of the distance to the ocean and the abruptness of the high mountain ranges ciren 2013 the temperature shows a marked altitudinal and latitudinal decrease according to the köppen geiger climate classification fig 2b from the coastline to the andes desert climates bw predominate from 17 30 s to 28 15 s with smaller semiarid climate areas bs a warm desert climate bwh exists in coastal river valleys and extends to the pampa del tamarugal and the mejillones peninsula in winter a tundra climate is found in high areas with amazonian influence et w from northern chile to 27 8 s and semiarid cold bsk w areas extend to 24 21 s and widen from calama to the salar de atacama sarricolea et al 2017 3 methods 3 1 meteorological data in the first step the daily records from 131 automatic weather stations are used these weather stations belong to the general directorate of waters of chile center for climate and resilience research 2020 dga 2020 and to the soquimich company sqm fig 2c the weather stations are located at elevations ranging from 2000 to 5100 m a s l and their spatial distribution is heterogeneous as shown in table s1 the temperature t dataset in the 1969 to 2019 period is obtained from 65 stations air relative humidity rh dataset from 35 stations is from 1986 to 2019 and precipitation p dataset from 130 meteorological stations is from 1958 to 2019 the dataset used in this work are available in valdivielso et al 2021a the second step of data treatment is a quality control process involving identifying outliers the outlier selection criteria is achieved by cross analysis of extreme periods of climatological events for temperature and relative humidity values 95 and less than 5 percentiles of data are considered as outliers corresponding to 9 7 and 10 of the total available daily temperature 176 465 data and relative humidity 60 395 data values for monthly precipitation irregular measurements were cross checked and the outliers were defined which amount 0 7 of the total monthly values 29 065 data in the third step after the outliers are removed the average monthly temperature and relative humidity values and the accumulated monthly precipitation values of each recorded year are calculated for each month and season therefore for the most complete stations 12 average values are obtained in total that is a monthly value for each meteorological parameter 3 2 isotope data isotopic data in the study area from previously published studies were included in this analysis alpers and whittemore 1990 aravena et al 1999 1989 cortecci et al 2005 cricyt 2017 fritz et al 1981 godfrey et al 2019 herrera et al 2016 2006 lagos 2016 lópez et al 2016 moran et al 2019 uribe et al 2015 valdivielso et al 2022 the dataset consists of 300 isotope analyses in the 1973 2017 period from rain and snow samples accumulated daily or monthly the water isotope standard is the vienna standard mean ocean water vsmow which is considered equivalent the standard mean ocean water smow gonfiantini 1978 lin et al 2016 the deuterium excess is defined here as d ex δ2h 8 δ18o some isotope analyses are excluded from the analysis because they have anomalous values of d ex which may indicate the effect of nonequilibrium processes after leaving the base of the cloud rainwater with a negative d ex may show large isotopic fractionation by evaporation probably due to a failure in the sampling or transport of the sample bershaw et al 2016 gonfiantini et al 2001 herrera et al 2016 2006 snow with a d ex well above 20 21 31 may be explained by diffusive fractionation at very low temperatures bershaw et al 2016 landais et al 2012 the 280 isotope samples finally considered correspond to 81 different locations points fig 2c the isotopic monthly average values are calculated for each month of the year at each point from the monthly and daily samples the distribution of the 179 monthly isotopic values from 1973 to 2019 is spatially heterogeneous as shown in table s1 as well as temporally heterogeneous datasets used in this work are available in valdivielso et al 2021b the months with the greatest number of isotopic samples correspond to the rainiest months the distribution of the samples is highly seasonal sixty five percent are concentrated in summer december january february march and 17 are concentrated in winter june july august for this reason due to the differences in atmospheric circulation and seasonal meteorological differences 3 isotopic models were selected summer winter and annual this study focuses on the characterization of geographic and meteorological factors hence the average isotopic values have not been weighted by precipitation as it is often done to identify aquifer recharge zones in a basin putman et al 2019 raemia 2019 3 3 statistical analysis and estimation model to understand and model the relationships among meteorological variables geospatial features and the isotopic composition of precipitation the first step is to investigate the effects of geospatial features altitude latitude and longitude on the meteorological variables a total of seven empirical linear and nonlinear regression functions are selected and their variables are adjusted to the available input data to obtain the best possible fit the five linear regression approaches applied are elasticnet kwangmoo et al 2007 bayesian ridge tipping 2001 least angle regression efron et al 2004 bayesian automatic relevance determination ard regression mackay 1994 and orthogonal matching pursuit mallat and zhang 1993 while the two nonlinear methods are support vector regression platt 1999 and random forest regressor geurts et al 2006 in some of these methods the hyperparameter optimization brute force searching technique was applied to calibrate the estimator by finding the best set of hypervariables that corresponds to the best model chicco 2017 hsu et al 2016 it has to be mentioned that although using the spatial variables as model input could result in poor predictive performance ploton et al 2020 variables can not be simply discarded because of the scarcity of the available data and notable impact of non correlated share of the values on the estimation models analysis of variance anova techniques were applied to select the best of the seven regression models for the different variables studied this was done by calculating the f statistical test and the corresponding ρ values markowski and markowski 1990 considering a 95 confidence level significance level of ρ values 0 05 for each variable of interest the statistically significant geospatial variables were selected for regression in cases where there were fewer than two variables with ρ values less than the significance level two variables with minimal ρ values were chosen for regression the fit is better when r2 values are close to 1 the best model is selected by comparing the r2 values corresponding to the different models the k fold cross validation is a resampling method to avoid overfitting and to validate the model the dataset is randomly split into k groups each group is used as the test dataset and the rest k 1 of the groups are used as the dataset to train the model then the evaluation score for the k models is evaluated using the test group and summarized taylor and tibshirani 2015 in this case the dataset is randomly split into 10 groups and then the model is trained 10 times by 9 groups of data as the training dataset and 1 group as the testing dataset then the mean of the calculated r2 values is the evaluation score applying cross validation in every brute force searching step results in a model validated by a random test dataset by comparing the mean r2 of cross validation for each set of hypervariables the model with higher r2 was chosen as the best calibrated model for that specific regression method then the definitive model was selected by comparing the r2 values from different linear and nonlinear methods with the meteorological models obtained it is possible to estimate the values of temperature relative humidity and amount of precipitation at any specific location in the area and month the next step is analysing the isotopic composition of precipitation based on meteorological models obtained from geographical information these meteorological models estimate meteorological data at locations with isotopic composition data the statistically significant geographic and meteorological features that influence each isotopic composition δ18o and δ2h are chosen and used to estimate isotopic composition values the isotopic composition model workflow is the same as that applied to estimate the meteorological variables which now fits the best model for each isotopic composition variable the random forest rf method is the method that best fits the measured data in all months table s9 the rf is a group of randomized decision trees that create a diverse set of regressors each tree as a regressor that include randomness in each node of a tree the best split strategy is found based on all introduced features by using an rf the variance in the estimator will decrease in comparison with an individual decision tree coupling meteorological and isotopic composition models yields the isotopic composition values at any point the workflow scheme of the statistical analysis and the estimation model is shown in fig 3 and figure s1 the the executable to run the meteorological and isotopic models and the corresponding executable guide are available in valdivielso et al 2021c 4 results and discussion the relevant results derived from the application of the same seven empirical models to meteorological variables and precipitation isotope compositions are summarized in the following subsections a detailed demonstration of results obtained is included in the supplementary material 4 1 meteorological models meteorological models estimate temperature relative humidity and precipitation independently for each month of the year for desired locations according to longitude latitude and altitude temperature shows a strong relationship with altitude throughout the year ρ 2 45e 20 and it is higher in summer ρ 3 21e 33 table s2 and figure s2 temperature decreases at higher altitudes consistent with the decrease in pressure as air expands upwards table 1 latitude also strongly influences temperature ρ 6 40e 05 and this relationship is higher in summer ρ 2 72e 10 which increases from north to south the mean r2 score between observed and calculated temperatures is 0 97 table s3 in laguna tuyajto herrera et al 2016 and risacher et al 1999 consider that the average air temperature is 1 c and the temperature model estimates an average of 3 c relative humidity has a strong relationship with latitude throughout the year ρ 1 12e 05 table s4 and decreases from north to south this is due to the extreme aridity of the salar de atacama in the antofagasta region köppen class bw arid to a lesser extent relative humidity in summer decreases from west to east ρ 3 87e 04 relative humidity also increases with altitude ρ 1 41e 04 the mean r2 score between observed and calculated relative humidity is 0 87 table s5 the average summer precipitation increases with altitude ρ 1 88e 10 and decreases from north to south ρ 5 74e 09 table 2 houston 2006b and houston and hartley 2003 associate this altitude control to the shadow effect of the rain shadow effect created by the andes the average annual precipitation does not have strong relationships with any geospatial variables altitude ρ 8 10e 02 latitude ρ 1 57e 01 longitude ρ 2 08e 01 because the altitude and longitude gradients and distribution of rainfall are not as marked along the year except for summer months december january february march this is because rains during the summer are more abundant and frequent in the north and high areas decreasing towards the south and towards the low areas corresponding to the altiplano winter or bolivian winter precipitation conversely during the rest of the year there are different sources of rainfall and irregular distributions coming from the pacific ocean table 2 houston 2006b considers that precipitation has strong latitudinal control table s6 presents the relationship of the observed values with the calculated values the mean r2 score between observed and calculated precipitation is 0 66 herrera et al 2006 estimate that the mean annual precipitation in the chungrá lake area north of the study area arica and parinacota region is 331 mm and the precipitation model estimates an average of 300 mm year uribe et al 2015 consider a precipitation range of 130 and 180 mm yr in the salar del huasco while the model estimates 105 mm yr in laguna tuyajto the average precipitation has been estimated is between 150 and 200 mm yr by herrera et al 2016 180 mm yr by risacher et al 1999 and the precipitation model estimates an average of 140 mm yr fig 4 a illustrates the standard deviation of cross validation scores of meteorological estimation model cross validation score average on test dataset for each month as an indicator of the estimator uncertainty it can be seen that in summer the standard deviation of the scores are lower than in winter or the whole year this is due to the predictable or erratic behavior of the meteorological variables for instance in summer the precipitation presents a clear gradient but in the rest of the year its behaviour is more chaotic due to the meteorological processes mentioned above see table 3 furthermore average standard deviations of humidity 0 41 followed by precipitation 0 30 and temperature 0 10 show that there is higher estimation uncertainty in humidity models than in models which take into account the precipitation and temperature variables the estimations obtained from these models are illustrated spatially for each meteorological parameter in maps in the supplementary material for each month of the year figures s4 s6 s8 s10 s14 s16 and s18 and the calculated average annual temperature relative humidity and precipitation in the study area appear in fig 5 4 2 isotopic model the δ2h and δ18o contents present the same features in agreement with the high covariance between δ2h and δ18o for this reason only the results for δ18o are shown below high correlation coefficient and a certain amount of collinearity between variables is detected but it can not be treated due to the scarcity of the available data i e between temperature and altitude and longitude and latitude table s7 the isotopic model for δ18o of precipitation in summer depends largely on altitude ρ 4 59e 08 followed by temperature ρ 1 86e 07 latitude ρ 2 03e 05 longitude ρ 2 31e 02 and to a lesser extent by precipitation ρ 1 91e 02 figure s3 this may be due to decreasing of evaporation withincreasing altitude this effect is reduced in winter when the effect that mostly controls δ18o is temperature ρ 7 78e 04 which in turn is correlated with altitude ρ 1 50e 03 precipitation ρ 1 49e 02 and to a lesser extent by relative humidity ρ 1 51e 02 this could be due to the lower temperature lower relative humidity and less evaporation as at higher altitude water is in the solid phase the annual δ18o presents a strong relationship with temperature ρ 3 47e 11 followed by altitude ρ 1 29e 10 latitude ρ 7 78e 04 and to a lesser extent by longitude ρ 3 97e 02 fig 6 notice that the last parameter has poor relationship with the rest of the meteorological and isotopic variables because of the relative reduced longitude range compared with the large range in latitude of the study area and hence high spatial dispersion across latitude for the area the statistical measures of the quality of calculated values with isotopic models are shown in table s8 fig 4b illustrates the standard deviation of cross validation scores of the isotopic estimation model cross validation score average on test dataset for each station summer winter and the whole year as an indicator of estimator uncertainty the uncertainty for δ18o and δ2h in each season is alike which is expected based on the similar behavior of the values it can be seen that in summer and in the whole year the standard deviation of the scores is lower than in winter by comparing fig 4b and table s1 it can be said that there is a meaningful correlation between the number of available data and the standard deviation of the estimation scores this is reflected in the smallest number of winter samples and the largest standard deviation the effect that most influences δ18o is temperature according to δ18o 0 51 t c 14 2 table 4 similar to that calculated in the salar de surire in the arica and parinacota region risacher et al 1999 and according to the world relation δ18o 0 7 t c 13 clark and fritz 1997 the next effect that most influences δ18o is altitude fiorella et al 2015a the calculated altitudinal gradient of δ18o 28 100 m in summer and 0 29 100 m annual is consistent with previous studies 0 2 100 m in tarapacá region acosta and custodio 2008 0 34 100 m in the altiplano of antofagasta region herrera et al 2016 and 0 26 100 m villablanca 2009 0 5 100 m in the altiplano dictuc 2008 the world gradient is between 0 15 to 0 5 100 m clark and fritz 1997 in general the lower the latitude 18 s the lower the temperature is so precipitation is more depleted in heavy isotopes this is because the salar de atacama which has high temperatures is in the higher latitudes of the study area 24 s summer precipitation is more enriched in heavy isotopes than winter precipitation table 3 as observed in the salar de atacama valdivielso et al 2022 fig 7 shows that there is an oscillation of the meteorological variables throughout the year the maximum values of temperature relative humidity and precipitation are in summer while the minimum values are in winter the maximum δ18o values are produced during the summer and decrease in the winter months this oscillation appears clearly in the antofagasta region but it softens towards the north this is because the antofagasta region between the depression of the salar de atacama and the altiplano presents a greater variation in elevation than the other regions the local meteorological water lines lmwls have slopes slightly lower than the commonly accepted global meteorological water line gmwl slope of 8 craig 1961 craig and gordon 1965 raemia 2019 the correlation lines between δ18o and δ2h have slopes between 6 4 and 7 3 and intercepts between 6 7 and 3 these results are consistent with those obtained in putman et al 2019 for arid climates slopes between 5 and 7 and intercepts between 0 and 15 and for the cryosphere köppen class e with slopes between 7 and 8 and intercepts between 20 and 5 these low slopes could be due to subcloud evaporation in dry air putman et al 2019 d ex tends to show possible evaporation effects regionally d ex is generally about 12 which is slightly higher than the world oceanic average value of 10 figure s22 there are seasonal effects that make the summer and winter periods different the supplementary material presents the calculated δ18o maps in the study area for the summer and winter months and the year and the relationship of the observed values with the calculated values figures s5 s7 s9 s11 s13 s15 s17 s19 and s21 the calculated average annual δ18o weighted δ18o and weighted d ex appear in fig 5 5 summary and conclusions the isotopic samples of precipitation collected in the study area in the regions of arica and parinacota tarapacá and antofagasta at altitudes above 2000 m a s l usually accumulate several rainfall events and the meteorological data at the time the precipitation occurred are unknown therefore to determine the influence of these two aspects a compilation of temperature relative humidity and precipitation records of all available meteorological stations in the area was performed first meteorological models were developed that independently estimate temperature relative humidity and precipitation for each month of the year for the locations defined by longitude latitude and altitude the next step was to define the isotopic models from the relationships with the geospatial and meteorological variables temperature and elevation are highly correlated and have the strongest regional control over δ18o latitude and longitude play an important role in the general variations in all the analysed variables with decreasing precipitation and relative humidity from north to south while temperature increases in the interannual analysis precipitation is dominated by the differences in atmospheric circulation throughout the year in summer the abundant convective precipitation in the north is depleted in heavy isotopes this influence decreases southward and precipitation remains enriched in heavy isotopes in winter mainly in the antofagasta region precipitation from the pacific ocean is lighter in heavy isotopes than summer precipitation this study is regional and covers the period from 1975 to 2019 as the isotopic samples accumulate several unidentified rain events the sea surface temperatures ssts the relative air humidity of the different sources of atmospheric water and the back trajectories of the air masses are unknown and the type of clouds that generated the precipitation was not identified for this reason existing atmospheric general circulation models agcms are not used and mean values and approximations are not considered however models with high correlation scores have been obtained in the study area isotopic precipitation data are scarce and there are many more isotopic data from surface water and groundwater therefore in basins without isotopic data on rainfall groundwater data can be geographically related to identify aquifer recharge zones and assign them to aquifers in this way improved sustainable management of water resources will be achieved in hydrological basins with scarce isotopic information on rainfall in northern chile the methodology developed here and the main results constitute a necessary intermediate step to a more detailed and accurate knowledge of water resources generation in the study area which is needed for water resource planning and setting the basis for water governance declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the agencia estatal de investigación from the spanish ministry of science and innovation and the idaea csic a centre of excellence severo ochoa cex2018 000794 s the authors thank sqm chile for their support in obtaining the isotopic and meteorological data r criollo gratefully acknowledges the financial support from the balearic island government through the margalida comas postdoctoral fellowship programme pd 036 2020 the authors are thankful to dr carlos ayora for his critical and constructive comments on the manuscript of this paper as well as to the unknown reviewers for their constructive contributions appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 127380 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 supplementary data 3 supplementary data 4 
3776,the high dimensionality of predictor variables reduces the predictive accuracy of statistical downscaling models principal component analysis pca is one of the extensively used approaches for reducing the dimensionality of the predictors however pca reduces the efficiency of downscaling models when a nonlinear predictor predictand relationship exists to solve this issue the representative grid location rgl approach was used to minimise the dimension of the predictor variables thus a novel rgl mars multivariate adaptive regression spline based downscaling model was proposed in the current study the proposed model was compared with pca mlr principal component analysis multiple linear regression mars and pca mars downscaling methods eight general circulation models gcms were considered out of which only can esm2 second generation canadian earth system model gcm was found suitable for the study area three criteria i e correlation coefficient cc mutual information mi and decision tree dt were used for the selection of dominant predictors it was observed that cmd cc mi dt predictors when used with the rgl mars downscaling method showed the best performance nse 74 89 root mean square error rmse 10 40 mm the results revealed that rainfall simulated by the rgl mars model captured the standard deviation and coefficient of variation in the observed rainfall whereas the rest failed to do so the rgl mars model solved the issue of underprediction of wet season rainfall and overprediction of dry season rainfall the rgl mars addressed the issue with an improved nse of 62 89 and rmse of 18 45 mm thus the result exhibited that integration of mars with the rgl perform better compared to the pca this study also demonstrated that downscaling model outcomes were more reliable for the wet than the dry season the future rainfall projection indicated that the rainfall fluctuation might be more in the dry season than the wet season the proposed downscaling method can improve the accuracy of rainfall projections under various climatic conditions subsequently coupled with a range of hydrological and land surface models to better understand the catchment characteristics and the water balance dynamics in future climate studies keywords statistical downscaling general circulation models representative grid location multivariate adaptive regression spline decision tree multiple linear regression 1 introduction all regions of the world have already experienced a discernible impact of climate change on water resources and freshwater ecosystems intergovernmental panel on climate change ipcc 2021 it is predicted that climate change will severely affect the magnitude and spatiotemporal trends of hydro climatic parameters including rainfall guo et al 2020 these changes will have crucial effects on the environment human communities and existing and potential water resources yazdandoost et al 2021 further the major impacts of climate change include the increase in the frequency of extreme events viz drought flood and cyclonic storms hallegatte et al 2013 poulose et al 2020 studies have already reported that an increase in the inter annual variability in rainfall events due to climate change was the primary cause of disasters like drought and flood bermúdez et al 2020 tabari et al 2020 additionally rainfall variability has remarkable effects on the socio economic condition of the human race and the effect is more predominant when the country s economy depends on agricultural productions it is partially due to a strong dependency of humankind on rainfed agriculture that is affected by inadequate rainfall gbode et al 2021 the rapidly transforming climate is the primary reason for the increasing rainfall variability hamada et al 2012 thus it is highly essential to study the future rainfall scenario conventionally the earth system models esm viz general circulation models gcm sahoo and panda 2020 and model for interdisciplinary research on climate miroc kawamiya et al 2020 simulate the impact of greenhouse gas emission and project the hydroclimatic variables for the future among the esms gcm is one of the most reliable frequently used and efficient tools available for obtaining the future climate change projection of climatic variables further gcms reproduce past climatic alterations efficiently using natural and anthropogenic factors ipcc 2021 however the coarse spatial resolution of gcm e g canesm2 2 8 2 8 bnu esm 2 8 2 8 hadgem2 ao 1 2 1 9 is causing the hindrance to study the climatic impact on a regional or local scale tabari et al 2020 these major differences between the resolution of gcm outputs and basin scale hydrological variables viz evapotranspiration temperatures streamflow lead to uncertainty in basin scale hydrological fluxes dash et al 2021a sahoo and sahoo 2020 broadly these downscaling techniques are classified into two classes i dynamical downscaling dd and ii statistical downscaling sd the dd involves complex physical processes in the atmosphere and requires extensive capital investment for computation whereas the sd models empirically link the gcm outputs with fine scale meteorological parameters sachindra et al 2018 the sd techniques became popular because of their cost effectiveness and simplicity compared to the dd technique sachindra et al 2014 the multiple linear regression mlr method is one of the oldest and commonly used sd techniques the mlr technique performs poorly when nonlinear predictor predictand relationships exist sachindra et al 2014 similarly the nonlinearity could be better addressed by generalised linear models glm compared to the mlr method however the glm needs a relatively large dataset and is sensitive to outliers beecham et al 2014 the effect of outliers in nonlinear problems could be neutralised by the artificial neural networks ann technique however the approach is susceptible to overfitting and the process is also difficult to interpret as it is a black box model sachindra et al 2018 the k nearest neighbourhood knn is a flexible and evolutionary method that requires no training period and can incorporate additional data seamlessly without affecting the model s accuracy lee et al 2017 conversely the knn method does not work well with a large high dimensional dataset and is sensitive to missing data and outliers shashikanth et al 2018 genetic programming gp is a nonlinear regression method that works well with noisy data and can handle large datasets with the limitation in computational time sachindra et al 2018 the support vector machine svm is also a nonlinear regression method that works well with outliers and solves overfitting issues luo et al 2019 the multivariate adaptive regression splines mars technique has similar abilities as the svm but outcomes of the mars technique are simpler to interpret adnan et al 2020 the gp and least square svm based downscaling models were found superior to the mlr models as the gp and svm models could handle predictor predictand nonlinearity better compared to the mlr downscaling model sachindra et al 2013 the svm models showed higher predictive accuracy compared to the ann model due to the issue of overfitting associated with the ann model duhan and pandey 2015 goly et al 2014 reported that the svm downscaling approaches demonstrated superiority over stepwise regression sr and positive coefficient regression pcr models owing to two reasons i better accounting of predictor predictand nonlinearity by svm and ii less overfitting compared to the sr and pcr models adnan et al 2020 reported that mars and least square svm downscaling approaches showed similar performance accuracy further hoang et al 2017 compared the predictive accuracy of multi gene genetic programming mggp mars ann and lssvm regression methods and found that the mars regression technique outperformed the rest of the models the superiority of mars downscaling models might be attributed to their ability to handle nonlinearity better compared to the rest of the models yin et al 2018 adnan et al 2020 thus the mars downscaling technique could be used as an effective tool to solve the issue the accuracy of the mars model could be further improved by reducing the collinearity among predictors dormann et al 2013 interestingly earlier studies proposed several collinearity reduction techniques viz principal component analysis pca anowar et al 2021 multidimensional scaling salvi and ghosh 2013 devak and dhanya 2016 copula sahoo et al 2020 independent component analysis teegavarapu and goly 2018 maximum variance unfolding goly et al 2014 t distributed stochastic neighbor embedding t sne gisbrecht et al 2015 anowar et al 2021 and uniform manifold approximation and projection umap becht et al 2019 to decrease the dimensionality of the predictor variables among all these algorithms the pca is one of the extensively used collinearity reduction techniques anowar et al 2021 the pca reduces the complexity of datasets and still preserves their trends and patterns it does so by transforming the data into reduced dimensions which act as summaries of features the primary motivation of pca is to decorrelate the dataset i e remove second order dependencies shlens 2014 higher order dependencies are very common in downscaling studies that reduce the effectiveness of pca past studies have reported that pca works poorly when a nonlinear relationship predictor predictand exists shao et al 2014 further pca is an unsupervised approach that finds patterns without reference to prior knowledge about the variable the principal components pcs in the pca are heavily weighted along the variables having a higher magnitude and ignores other variables lever et al 2017 the utilisation of pcs as inputs can also degrade the efficiency of the model sachindra et al 2013 furthermore pca can only be used with variables having similar statistical distribution sehgal et al 2018 because of these aforementioned issues linked with pca the representative grid location rgl sachindra and kanae 2019 was also employed in this study the rgl approach minimises the dimensionality of predictors by removing gcm predictor variables having high inter grid correlation unlike pca the rgl approach doesn t break the structure of the predictors and preserves the original structure of the dataset thus the rgl technique does not have the majority of the problem faced by the pca approach in the light of the above reviews this manuscript explores the following research questions i how does the coupling of dimensionality reduction techniques like pca and rgl techniques with standalone multivariate adaptive regression spline mars downscaling model affect the accuracy of the standalone model and ii how the pca coupled mlr model standalone mars model pca mars model and rgl mars model perform for predictor selected by correlation coefficient cc method mutual information mi method decision tree dt method and the cmd method cc mi dt under dry and wet seasons in light of the preceding reviews the following objectives are decided for the study i development of an rgl based mars rgl mars downscaling model and ii performance evaluation of the rgl mars model with pca based mlr model pca mlr standalone mars model and pca based mars model pca mars 2 study area the complete development and evaluation of the proposed downscaling algorithms were performed on the selected province of india eastern gujarat area 82 696 km2 and rajasthan area 3 42 239 km2 fig 1 the study area lies between the 18 32 n latitude and 68 80 e longitude in order to check the applicability and reliability of the developed algorithms two completely different climatic regions were selected i the eastern gujarat region one of the most flood prone regions in india sharma et al 2011 ii rajasthan one of the most drought and desertification prone regions in the country mishra et al 2021 kalyan et al 2021 praveen et al 2020 demonstrated that the eastern gujarat region showed the highest temporal variability in rainfall compared to other regions of the country an increase in cyclone wind intensity and coastal inundation in the future was also reported for the study area poulose et al 2020 in addition to all these hallegatte et al 2013 claimed that the periphery region of eastern gujarat would experience a 3 increase of average annual gross domestic product gdp loss due to flood in 2050 compared to 2005 thus the study was conducted over the selected eastern gujarat and rajasthan regions that possess two distinct climatic traits as rainfall is one of the major factors of disasters like drought and flood bermúdez et al 2020 tabari et al 2020 rainfall was considered the primary parameter to apply and evaluate the performance of the developed algorithms 3 applied data observed monthly rainfall for the eastern gujarat and rajasthan regions were acquired from two different sources these sources include the indian institute of tropical meteorology iitm and the prediction of worldwide energy resources power project of nasa the iitm provides weighted average monthly rainfall data based on high quality information obtained from 316 rainfall observatories appropriately distributed throughout the area iitm archive provides highly reliable data till 2006 hence due to absence of recent rainfall data the power project data acquired for 1982 2018 was selected to extend the iitm data obtained for 1961 2006 the 25 years overlapping period 1982 2006 between these two datasets was employed for testing the reliability of the power project data for extending iitm data the power project provides rainfall data having a spatial resolution of 0 5 0 5 fig 1 the thiessen polygon method was utilised to obtain weighted average power project data for the study area the two most common gcm series being frequently used by researchers are the coupled model inter comparison project phase 3 cmip3 gcms and coupled model inter comparison project phase 5 cmip5 gcms however nourani et al 2019 reported that downscaling models perform better with cmip5 gcms compared to cmip3 gcms hence eight cmip5 gcms were used in this study table 1 shows the model resolution and the research center that developed the gcms used in this study table 2 presents the predictors employed in this study chosen considering past literature and the physical aspect of the predictors e g teegavarapu and goly 2018 gridded ncep ncar reanalysis data 2 5 2 5 was attained from national oceanic and atmospheric administration physical science laboratory noaa psl archive over 20 25 n and 70 75 e for the period 1961 2018 served as predictors for the downscaling model fig 1 shows the gcm and ncep ncar grid boxes covering the entire study area the cmip5 gcm data were obtained from the ipcc website 3 1 atmospheric domain selection in this study the domain of 5 5 grid points having a spatial resolution of 2 5 x 2 5 was used fig 1 najafi et al 2011 used an atmospheric domain with 7 4 grid points with a resolution of 2 5 x 2 5 for downscaling monthly rainfall and demonstrated that the square shape of the atmospheric domain is not mandatory for downscaling studies however the highly rectangular shape of the domain will affect the atmospheric circulation by giving more weightage to the influence coming from the wider side and neglecting the narrower side sachindra et al 2014 thus domains having such a form should not be used for downscaling studies vast atmospheric domains will increase the expenditure and time required for the study however a large domain helps to detect the effects of atmospheric circulation for a broad area if the domain is very small it may not describe the atmospheric circulations responsible for the spatial aspect of climatology in the basin hence the domain of proper shape and size should be selected before any downscaling study in light of the above reviews a 5 5 point domain having a resolution of 2 5 x 2 5 was chosen for the current study the domain size was decided based on its capability to describe the atmospheric process that affect the rainfall in the area of interest after finalising the atmospheric domain the gcm predictors were interpolated at ncep ncar grid points 4 material and methods 4 1 gcm and predictor selection criteria in the current study predictand referred to the observed rainfall pcpobs and the gcm variables were considered the predictor variables three criteria i e pearson correlation coefficient cc mutual information mi shiba 2020 and m5 algorithm of the decision tree dt hamze ziabari and bakhshpoori 2018 were utilised to select gcm and extract dominant gcm variables cc and mi between the observed and gcm rainfall from 1961 to 2000 were estimated to select proper gcm for the study area a similar gcm selection approach was adopted by nourani et al 2019 a threshold value of 0 6 was considered for both cc and mi for gcm selection among eight gcms considered only can esm2 gcm precipitation showed strong linear cc and nonlinear mi connections with the predictand for eastern gujarat and rajasthan and was used for downscaling the ncep ncar reanalysis data was used in this study instead of the gcm historical dataset due to the following two reasons i gcm outputs contain large bias that introduces higher uncertainty in the downscaled data as datasets are produced by very high quality climate models that receive inputs from the surface air and satellite observation platforms raje and mujumdar 2011 and ii it is appropriate to use the ncep ncar reanalysis data instead of gcm historical data when only one gcm is used for downscaling goly et al 2014 table 2 presents the ncep ncar predictors employed in this study considering past literature and the physical aspect of the predictors teegavarapu and goly 2018 even after the gcm selection the number of predictors for the 25 ncep ncar grid point was 3275 131 25 the application of such a large number of predictors would drastically reduce the predictive accuracy of the model to eradicate the problem dominant predictors were extracted using cc mi and dt methods and utilised as the input for the downscaling model the predictors were selected for all the gcm grid points covering the 25 ncep ncar grid points around the study area fig 1 4 1 1 correlation coefficient the correlation coefficient cc is a standard indicator to assess the strength of the linear link between two datasets its value ranges between 1 and 1 the values 1 and 1 imply a strong positive and negative linear predictor predictand association whereas zero indicates no link between the predictor and predictand the cc between the dominant gcm variable x with a mean of x and observed rainfall pcpobs y with a mean of y is defined by eq 1 as 1 c c x x y y x x 2 y y 2 the cc value indicates the strength of linear relationship between the predictor variables and the predictand 4 1 2 mutual information mutual information mi quantifies statistical dependence between predictor and predictand the mi values have a range of 0 the value zero indicates no mutual information whereas higher mi values imply greater mutual information for predictand pcpobs y and the dominant gcm variable x having marginal distributions p x and p y respectively and a joint distribution p xy mi between x and y is expressed in eq 2 as 2 m i p x y log 2 p x y p x p y the mi value indicates the strength of nonlinear relationship between the predictor variables and the predictand tavakol davani et al 2013 4 1 3 decision tree the decision tree dt technique is a robust technique to carry out prediction and classification typically a tree consists of four portions that include leaf node branch and root in a dt leaf and root indicate the first and last nodes respectively as the dt method is a graphical approach interpretation of the outcomes is more straightforward than other techniques in this study the m5 algorithm of dt is used as it is a more efficient classifier than other algorithms when used for continuous numeric variables nourani et al 2019 the m5 model is comparable with a piecewise linear function consisting of several tree regression models kiranmai and laxmi 2018 the typical regression model contains a single equation for the whole dataset whereas tree based regression divides the data into several subsets known as the leaf each leaf is linked to a regression equation first the split criterion is employed to construct the m5 model tree the split criterion minimises the standard deviation of each data class obtained at each node the standard deviation reduction sdr by the split criterion is estimated by eq 3 as 3 s d r s d p p i p s d p i where p and pi are the entire dataset and subset of data received at each node respectively and sd refers to the standard deviation of the dataset such splitting leads to the creation of a huge tree hence the size of the large tree is reduced by pruning branches and replacing them with regression functions the m5 algorithm of dt employed in the current study performs pruning on the large tree with great efficiency the model tree is also used to extract dominant predictor variables predictors of each class are classified and compared by the decision tree in this study the predictors that carry higher importance are allocated at the upper nodes of the tree and predictors with lower importance are found at the end nodes predictors located at the upper nodes are chosen as dominant predictors weka software kiranmai and laxmi 2018 was utilised to carry out the m5 model tree in the current study dt can identify the variables with both linear and nonlinear dependencies exist between the predictor and the predictand nourani et al 2019 4 2 gcm skill estimation by variable convergence score vcs the skill of a gcm is a measure to evaluate the reliability of the gcm projection one of the robust criteria for measuring the gcm skill is the variable convergence score vcs ojha et al 2014 the vcs compares variables in time and space based on the coefficient of variation cv the cv provides an advantage over other statistics as it is insensitive to the absolute values of the variable because a wide range of values are expected from different variables a skill score based on the cv is appropriate as it is the ratio of the standard deviation to the mean of the values the cv value calculated at each grid cell for the three pressure levels from the collection of mean annual results from eight gcms forms the basis for vcs the vcs is a simple comparison between the cv value of one variable or one region with that of another the vcs is determined by calculating the cumulative distribution of the cv values for all locations variables pressure levels and time the relative position of a particular cv value compared with all other cv values can be measured in this way instead of fitting a theoretical distribution to the cv values the skill score is based on an empirical cumulative distribution function cdf to maintain simplicity and effectiveness the estimation procedure of the vcs was outlined below combine the results from all models for one ensemble for a particular variable for each grid for each 10 year window three ten year windows i e 2030 2050 and 2070 as shown in eq 4 4 x j t x j t z 1 l x j t z 2 l x j t z 3 l x j t z n l where x j t z n l variable x at grid point j at time t level z from model n and emission scenario l calculate cv for each cell c v j t x which is the ratio of the standard deviation to mean for the vector x j t pool the cv values for all grids variables levels emission scenarios and 10 year windows in this study 25 grid points 40 variables 33 variables are surface variables three pressure levels 500 hpa 700 hpa and 850 hpa two emission scenarios rcp 4 5 and rcp 8 5 and three 10 year windows were considered yielding a pool of 8100 cv values as explained below 25 grid points 33 variables 3 pressure levels 1 emission scenario 3 10 year windows 7 grid points 3 surface variables 1 pressure levels 1 emission scenario 3 10 year windows 8100 values calculate the empirical cdf of cv values assuming that the pooled cv values come from a common distribution that characterises the variability of the climatic variables eq 5 5 f c v r n where r rank of the individual cv value and n total number of cv values calculate the vcs for a particular variable x or a particular grid cell j according to eq 6 6 v c s x j 100 1 f c v the rationale behind the vcs is to calculate convergence based on the cv values of the variable across all gcms it is expected that the gcm with for which the variables that exhibit high vcs low cv could be considered as a promising gcm for rainfall projection 4 3 gcm interpolation the downscaling model established using the ncep ncar data cannot be utilised directly to predict future rainfall using gcm data due to the resolution difference between these two variables hence the gcm variables were interpolated at the ncep grid points to resolve the issue a linear regression based interpolation method goly et al 2014 was utilised in the current study instead of traditional spatial interpolation techniques the mlr based interpolation method is described in eq 7 7 y j g c m n k 1 n m k y j k g c m j where y j k g c m denotes the gcm variables at the kth grid at the jth interval of time m k refers to the regression coefficients n is the overall number of gcm grid points and y j g c m n indicates the gcm variables at the ncep ncar grid points 4 4 downscaling model in this study downscaling was performed on a monthly scale however the performance evaluation of the downscaling models was done using seasonal data a year was divided into two seasons in the current study i e wet season and dry season the wet season rainfall was obtained by the sum of rainfall from june to november and the dry season rainfall referred to the sum of rainfall from december to may the techniques used in this study for downscaling model development are explained in the following section 4 4 1 principal component analysis pca the pca mathematically transforms original variables which may be correlated into loadings using eigenvectors and eigenvalues pca shrinks the data set by identifying new set of variables called principal components pcs which contain the maximumvariance in the original dataset furthermore because the principal components are orthonormalto one another there is no redundant information many researchers have reported using the pca method in downscaling works anowar et al 2021 for performing the pca first the covariance matrix of the normalised variables is computed each variable is standardised by subtracting the mean and the outcome isdivided by the standard deviation of the original variable the eigen vectors derived from the covariance matrix are employed for pca the eigen vectorsare ordered so that the first onecorresponds to the largest eigen value and the kth eigen vector to the kth largest eigen value λk the kth principal component at time t pckt is computed by eq 8 as 8 p c k t q e k q p t q p q s q where pt q is the value of qth variable mean sea level pressure geopotential height at any node at time t p q and s q are the mean and standard deviation of the variable p q and ekq is the qth element of the eigen vector corresponding to kth eigen value the percentage of total variance ωk explained by the kth principal component is given by eq 9 9 ω k λ k m 1 m λ m where m is the dimensionality of the original dataset 4 4 2 multiple linear regression mlr the mlr method is one of the commonly used downscaling methods employed in climatic change studies this method performs poorly when a nonlinear predictor predictand relationship exists in the mlr approach pcs are used as predictors and the rainfall is used as predictand several past studies have reported the successful use of this method for statistical downscaling goly et al 2014 sachindra et al 2014 the general expression for mlr is presented by eq 10 10 p c p o b s i 1 n c i x p c i c ε pcpobs represent the observed rainfall pci is the ith principal component ci is the regression coefficient c is the intercept and ε is the error term 4 4 3 rgl mars model development the mars is a nonlinear and nonparametric regression technique given by friedman 1991 the mars model generates piecewise basis functions that help in explaining the nonlinearity in the predictor predictand relationship this approach automatically discovers nonlinearity and appropriate data structure in the predictors predictand relation employing a weighted summation on linear or polynomial basis functions in the proposed rgl mars method rgl was used to minimise dimensionality and redundancy in the predictors and then the mars technique was used to perform regression in the rgl method the spatially least intercorrelated datasets for each predictor for each grid were identified the method was applied for both wet and dry seasons separately the rgl method is explained in the following steps 1 spatial correlations using cc between the datasets of probable predictor xi at all grid points in the domain were estimated as seen in fig 2 the correlations between predictor xi at different grid points i j were determined with respect to each other it generates a correlation matrix that demonstrates the correlation of predictor xi between any two grid points 2 the grid point showing the highest number of high correlation cc 0 8 with other grid points was found from the correlation matrix the grid point is termed as the first representative grid location rgl for the probable predictor xi for example data at grid point pe d fig 2 are strongly linked with the data at q number of grid points predictors in the green box as no other grid point displays more than the q number of highly correlated grid points for predictor xi the grid point pe d is considered the first rgl 3 data of the first rgl and variables strongly associated with it are removed from the dataset xi for example data of xi at the grid points confined by the green box fig 2 are eliminated from the original data set hence the size of the correlation matrix reduces and reduces the dimensionality of predictors 4 steps 2 and 3 are performed on remaining xi data to detect subsequent rgls and continued till no rgl is left for the predictor 5 correlation between the rgl datasets of predictor xi and the predictand was determined the rgl datasets that showed a cc value higher than the threshold value of 0 6 were selected 6 after that steps 1 5 were performed on all other probable predictors e g x1 x2 xi xn the predictors chosen in step 5 were combined and used as input for the downscaling model 7 steps 1 6 were repeated for both wet and dry seasons of both study areas rgl produces predictors having the least spatial correlation thus the likelihood of the presence of redundant information in the model inputs is reduced after conducting rgl mars regression was performed between the predictand and final set of predictors obtained by rgl researchers had demonstrated the successful use of the mars method for statistical downscaling for both linear and nonlinear predictor predictand relations yin et al 2018 a forward backward approach is adopted for accomplishing the mars process adnan et al 2020 during the forward step the model overfits the data due to numerous basis functions bfs in the mars technique the predictors and knots for the bfs are selected automatically in general the mars based model can be described as the following structure eq 11 11 f x δ 0 m 1 m δ m h m x i where hm xi are bfs δ are the coefficients determined by the minimum sum of squared errors from bfs and m accounts for the number of bfs redundant bfs are removed in the backward phase utilising the generalised cross validation criteria to enhance prediction efficiency adnan et al 2020 an open source package called earth milborrow 2014 created in r language was utilised to carry out the mars test 4 5 model evaluation criteria two statistical indicators have been used for the performance assessment of these four downscaling models these indicators include nash sutcliffe efficiency nse and root mean square error rmse these indicators are commonly used in literature for the comparison of various models ljung box statistic q is used to check the significance of serial correlation in the residual series ljung and box 1978 4 6 bias correction downscaling models produce erroneous predictions due to uncertainties linked with the gcm predictors and the downscaling approach thus the bias correction approach eq 12 suggested by mahmood and babel 2013 was used for eliminating bias in the current study 12 p c p b x p o p s where pc is the corrected future monthly rainfall data pb is the biased future monthly rainfall data p o and p s are the observed and simulated mean monthly rainfall data from 1961 to 2018 5 result and discussion 5 1 rainfall data extraction in this study due to the absence of observed rainfall data from a single reliable source two different sources i e the iitm archive and the power project of nasa were used these two datasets had a 25 years 1982 2006 overlapping period that was used to check the suitability of the power project data for extending the iitm rainfall data the scatter plot of the iitm and the power project rainfall for eastern gujarat fig 3 a and rajasthan fig 3 b showed a strong association between both datasets the reliability of the power project data was further checked by performing the ljung box test on residuals of the two rainfall datasets at a 95 confidence interval ci the ljung box statistic value for eastern gujarat q 21 82 p 0 12 and rajasthan q 13 54 p 0 19 suggested acceptance of the alternative hypothesis i e the residual series is serially independent these tests suggested that the power project rainfall data could be used for extending the iitm rainfall record for the 2006 2018 study period for both study areas 5 2 dominant predictor selection among the eight gcms considered only can esm2 gcm precipitation showed a strong linear cc and nonlinear mi connection with the predictand and was used for downscaling table 3 thus only the can esm2 gcm was used for obtaining future projections the ncep ncar reanalysis and can esm2 gcm data have spatial resolutions of 2 5 2 5 and 2 8 2 8 respectively hence the gcm predictors were successfully obtained at ncep ncar grid points by the mlr based interpolation section 4 3 the dominant predictors of the can esm2 gcm for both seasons were extracted by cc mi and dt methods for wet and dry seasons for eastern gujarat table 4 and rajasthan table 5 all predictors selected for the study showed a high value of cc and mi in the dt method the predictors located at the upper nodes of the tree were considered dominant predictors probable predictors should be chosen considering past literature and atmospheric processes influencing the predictand khan et al 2020 such predictors avoid the likelihood of introducing irrelevant information to the downscaling model several past works of literature najafi et al 2011 pichuka and maity 2017 al mukhtar and qasim 2019 reported using these gcm variables tables 4 and 5 for downscaling rainfall it was noticed that dominant predictors extracted by the cc method table 4 and 5 were humidity type variables i e pr hus for both study regions the linear relationship between humidity type variables and rainfall might be due to their strong connection with atmospheric moisture content nourani et al 2019 mi predictor selection approach typically picks nonlinear predictors zonal wind ua geopotential height zg 500 sea level pressure psl and temperature related parameters i e tas were the dominant predictors in the mi based feature extraction method in both of the study areas nourani et al 2019 demonstrated a nonlinear relation between rainfall and the above predictors the predictors selected by the dt method were a combination of both linear and nonlinear predictors in other words the dt based predictor selection approach has the properties of both cc and mi methods another predictor category was formed by combining the variables extracted by cc mi and dt methods and termed it as the cmd method in this study downscaling was carried out for these four categories of predictors 5 3 gcm skill estimation by vcs the cv values varied from a minimum of 0 001 to a maximum of 2 69 the empirical cumulative distribution of all 8100 cv values is shown in fig 4 a the larger values of cvs mainly correspond to grid points over the rajasthan region it was due to the high fluctuation of rainfall in the desert region fig 4 b presents the vcs for the dominant predictor variables for the eight gcms the gcms showed the best convergence for geopotential height mean sea level pressure and air temperature and the scores were lower for precipitable water and wind velocity the results were in line with the outcomes of ojha et al 2014 it was noticed that the canesm2 gcm scored the highest vcs for all of the dominant predictor variables hence the canesm2 gcm variables were used for the future rainfall projection 5 4 rgl and pca the first few pcs explaining 95 variance were selected as predictors for downscaling model development by pca mlr and pca mars methods table 6 depicts the least correlated grid points found by the rgl method for each probable predictor for both wet and dry seasons of eastern gujarat and rajasthan 5 5 downscaling model comparison mean and coefficient of variation cv of observed and modelled rainfall for calibration 1961 2005 and validation 2006 2018 periods of wet and dry seasons for eastern gujarat and rajasthan were presented in fig 5 the nse and rmse for different models for the study areas were tabulated in tables 7 and 8 the four downscaling models were ranked in tables 9 and 10 for different predictor selection approaches based on the outcomes obtained in tables 7 and 8 downscaling was performed by pca mlr mars pca mars and rgl mars methods before the commencement of the downscaling process the dominant predictors were standardised over the period 1961 2018 in this study 70 of data were used for calibration 1961 2005 and the remaining 30 for validation 2006 2018 the downscaling models reproduced the observed mean of the rainfall with reasonable accuracy within 10 variation during wet and dry seasons for both eastern gujarat and rajasthan fig 5 our finding was consistent with past studies e g sachindra et al 2013 2014 sachindra and perera 2018 that showed the ability of downscaling models to reproduce the mean of predictand accurately only the rgl mars model captured the sd and the cv of the observed rainfall during both seasons for both study areas whereas the rest of the models failed to do so it indicated that the rgl mars downscaling model was superior to the rest of the models the characteristics were more noticeable in the outputs of the pca mlr and pca mars models during both seasons for both regions it might be due to the inability of the models to explain the total variance in the predictand dataset hewitson et al 2013 sachindra et al 2014 it happened because of the bias in gcms due to the narrow understanding of the atmospheric processes and simplified representation of the complex climate system in gcms li et al 2010 rgl mars method overcomes the problem to some extent these models underpredicted average wet season rainfall high rainfall and overpredicted average dry season rainfall low rainfall during both dry and wet seasons in both eastern gujarat and rajasthan areas fig 5 our finding was in agreement with sachindra et al 2014 the variance in the observed rainfall series was higher compared to the variance in the predictor variables hence the downscaling model trained by the gcm data explained the medium range of variance in the predictand variable better compared to the extreme values in other words these models simulated the average rainfall more effectively than extreme rainfall events sachindra et al 2014 high cv was reported in the dry season compared to the wet season which implied that the dry season was susceptible to more extreme events compared to the wet season gur et al 2015 thus the downscaling model simulation is unreliable in the dry season as it poorly simulates extreme events high sd was observed in the wet season compared to the dry season 5 5 1 downscaling using cc predictors as seen in tables 7 and 8 the rgl mars method performed better than other downscaling approaches during both dry and wet seasons for both eastern gujarat nse 62 72 rmse 22 45 mm and rajasthan nse 58 67 rmse 13 47 mm better performance of the rgl mars method compared to the mars technique indicated that coupling of the rgl with the mars technique boosted the accuracy of the mars downscaling method for linear or cc based predictors further the mars technique was affected by the multicollinearity in the predictor dataset which reduced its efficiency koc and bozdogan 2015 our result disagrees with roy et al 2020 who reported that the mars method was not severely affected by collinearity in the predictors the pca mlr downscaling approach outperformed the mars and pca mars methods during the validation period wet season in the eastern gujarat region tables 7 and 9 it might be due to the fact that pca worked well with data showing linear behaviour lee et al 2020 conversely the poor performance of the pca mlr approach for for rajasthan region tables 8 and 10 might be attributed to the fact that the wet season rainfall in arid regions strongly influenced by predictors that show nonlinear variation with rainfall shao et al 2014 the mars and the pca mlr downscaling methods demonstrated the least accuracy during the wet and dry seasons respectively in the eastern gujarat area tables 7 and 9 the cc predictors might have a higher linear and nonlinear connection with the predictand during wet and dry seasons respectively which leads to the above result goly et al 2014 the pca technique improved reduced the accuracy of the mars downscaling method during the wet dry season our results were in line with tavakol davani et al 2013 however the pca mlr approach was the least accurate model for dry and wet seasons in the rajasthan area tables 8 and 10 the poor performance of the pca mlr model might be attributed to the nonlinear effect of climatic variables on rainfall gao et al 2017 5 5 2 downscaling using mi predictors the mi method extracts nonlinear predictors as seen in tables 7 10 the rgl mars method showed the best performance followed by the mars technique for both eastern gujarat nse 65 79 rmse 20 40 mm and rajasthan nse 61 74 rmse 12 43 mm regions the rgl technique boosts whereas pca reduces the accuracy of the mars downscaling technique when used with mi based predictors the deterioration in the performance might be due to the fact that pca does not work well when a nonlinear predictor predictand relationship exists shao et al 2014 the pca mlr method showed the least accuracy for mi predictors followed by the pca mars approach for both study areas the low efficiency of the mlr downscaling models might be due to its assumption of the linear predictor predictand relationship that is not followed by the mi predictors tavakol davani et al 2013 5 5 3 downscaling using dt predictors dt extracts multilinear a combination of linear and nonlinear predictors it was evident from tables 7 10 that the rgl mars method was found superior to the rest of the three methods during dry and wet seasons in both eastern gujarat nse 79 85 rmse 18 38 mm and rajasthan nse 74 79 rmse 10 40 mm when dt predictors were used it indicated that the rgl approach improves the predictive accuracy of the mars method in the case of the dt predictors it was also evident that rgl was superior to pca when used with multilinear predictors during the calibration period of the wet season for both eastern gujarat and rajasthan pca mars outperformed the mars method whereas pca mars performed poorly compared to mars during the validation period of the wet season for both regions the downscaling models performed better during the calibration period compared to the validation period due to the fact that the calibration was performed in a comparatively wet period sachindra et al 2014 the poor performance of pca mlr and pca mars methods during the dry season for both study areas showed that pca based downscaling methods might not yield satisfactory results when employed for downscaling dry season rainfall with multilinear dt predictors it could be interpreted that the dry season rainfall predicted by these two models was less reliable compared to the wet season rainfall timm et al 2015 and daksiya et al 2017 also showed that statistical downscaling gives more reliable results for wet seasons compared to the dry season results showed that downscaling models performed more efficiently for the dt method compared to cc and mi methods otherwise stated downscaling models capture more variance in the predictand when a combination of linear and nonlinear predictors is used it might be due to the fact that dt possess the merits of both linear and nonlinear feature extraction methods and has overcome the error magnification problem faced by the nonlinear predictor selection approaches tavakol davani et al 2013 in contrast the mi approach extracts nonlinear predictors only and ignores linear ones hence the dt based predictor selection technique was found superior to cc and mi methods 5 5 4 downscaling using cmd predictors cmd method consists of all predictors selected by cc mi and dt method it was evident from tables 7 10 rgl mars method was found the best downscaling method among the four methods followed by the mars technique for both eastern gujarat nse 79 89 rmse 18 35 mm and rajasthan nse 74 83 rmse 10 40 mm when used with cmd predictors it showed that the rgl pca method improved reduced the accuracy of the mars method during both dry and wet seasons for the study areas pca mlr technique showed the least accuracy during the wet season for both eastern gujarat and rajasthan both pca mlr and pca mars methods performed poorly during the dry season as reported earlier the pca based methods could not perform accurately during the dry season when used with multilinear predictors it was noticed that downscaling models showed greater accuracy for the cmd approach compared to cc mi and dt methods thus it was concluded that the cmd predictor extraction method is an improvement over dt based predictor selection technique the better performance of the cmd method compared to dt was due to the fact that the cmd approach accounts for more probable predictors that were missed by the dt method owing to the above reason the cmd method describes more variance in the predictand dataset compared to the dt method to better visualise the result the cumulative distribution function cdf plots of the model simulations for the cmd predictor was provided in the fig s1 of the supplementary material the model simulations mostly underpredicted the wet season rainfall and overpredicted the dry season rainfall for eastern gujarat and rajasthan fig 6 the result was consistent with the outcomes obtained earlier it was observed that the rainfall simulated by rgl mars followed that of observed rainfall more accurately compared to the rest of the methods fig 7 it was also noticed that the simulated rainfall followed the observed rainfall more closely during the wet season than the dry season it indicated that there was more uncertainty associated with dry season rainfall compared to wet season rainfall it was concluded that the rgl mars method provided the most optimal result when combined with cmd predictors rgl mars outperformed the mars downscaling method for linear and nonlinear predictor predictand relationships for all predictor selection methods tables 7 10 thus the rgl mars model could be considered an improvement over the mars downscaling model tavakol davani et al 2013 it might be due to the ability of the proposed model to reduce the multicollinearity among predictor variables that the mars model had failed to achieve koc and bozdogan 2015 the proposed downscaling method was superior to the pca mars method yousefzadeh et al 2019 for all predictor extraction techniques it might be due to the inability of the pca mars approach to deal with nonlinearity that was addressed by the rgl mars method the rgl mars downscaling model is an improvement over the rgl based gp downscaling model sachindra and kanae 2019 the superior performance of the proposed model might be attributed to two significant factors i high predictive accuracy of mars algorithm compared to gp hoang et al 2017 and ii deteriorated the efficiency of gp models due to inappropriate selection of fitness function population size essential parameters e g the rate of mutation and crossover and the criteria for a new population yang 2020 5 6 future rainfall projection 5 6 1 projection for downscaling models using cmd predictors all models showed consistent trend during both dry and wet seasons for rcp 4 5 and 8 5 fig 8 in eastern gujarat region increase in rainfall might be observed during the 21st century for both rcp 4 5 and 8 5 in the rajasthan region rainfall would increase initially but it might decrease during the end of the century as the rgl mars model is considered the base model the detailed analysis of the rainfall projection obtained by this model is discussed in following section 5 6 2 projection for rgl mars model for dry and wet seasons finally seasonal rainfall was projected for the future 2018 2099 under rcp 4 5 and rcp 8 5 scenario of the can esm2 gcm for eastern gujarat and rajasthan the rgl mars model with the cmd predictors was picked as the best downscaling model and utilised for the purpose bias correction was performed on the projected rainfall data as seen in fig 9 a eastern gujarat would experience a rise in rainfall in the future i e 2020 s 2005 2035 2050 s 2035 2065 and 2080 s 2065 2095 during both wet and dry seasons under both rcp 4 5 and 8 5 scenarios our findings agreed with salvi and ghosh 2013 who showed a rainfall increase in the future in india s western coastline many researchers reported an increase in rainfall in the proximity of the region singh et al 2015 bal et al 2016 pichuka and maity 2017 dash et al 2021b the rise in rainfall might be due to the increase in the surface temperature which boosts the evapotranspiration rate thus rainfall increases shokri kuehni et al 2017 the increase in rainfall might also be due to the melting of permafrost that might trigger the release of methane and co2 which raises the temperature and increases the rainfall bindoff et al 2019 further with the removal of the ice sheet albedo decrease and lead to a rise in temperature and precipitation however the increase in the surface temperature might help raise the rainfall with several limitations total moisture available in the system ability of the region to sustain feedback loop processes under a warming climate etc the rise in average rainfall with respect to baseline was expected to be in the range of 2 9 15 2 under the rcp 4 5 scenario and 9 9 38 8 under the rcp 8 5 scenario during the wet season similarly the rise in mean rainfall was anticipated to range between 16 5 and 66 9 under the rcp 4 5 scenario and 30 1 128 1 under the rcp 8 5 scenario during the dry season it was noticed that more increase in rainfall would appear under the rcp 8 5 scenario compared to the rcp 4 5 scenario it might be due to the highest emission of greenhouse gases under the rcp 8 5 pathway that was way more than other rcps luhunga et al 2018 yaduvanshi et al 2019 yin et al 2020 it was also noticed that the increase in rainfall in the dry season would be higher than in the wet season our outcomes were in line with murray tortarolo et al 2017 the projected rainfall showed a different pattern for rajasthan fig 9 c during the wet season rainfall is expected to rise by 5 25 and 13 16 under the rcp 4 5 and rcp 8 5 scenarios respectively during the 2020 s however a wet season rainfall reduction by 1 4 and 5 2 with respect to baseline might be noticed during the 2050 s and 2080 s respectively under the rcp 4 5 scenario similarly a decrease in rainfall magnitude with respect to baseline was expected to be 6 2 and 10 1 under the rcp 8 5 scenario during the 2050 s and 2080 s respectively the dry season in rajasthan might experience a rainfall reduction of 2 8 17 7 under the rcp 4 5 scenario and a decrease of 4 5 28 7 under the rcp 4 8 scenario our result agrees with previously reported observations of the dry season becoming drier konapala et al 2020 pradhan et al 2019 an increase in the cv in the projected rainfall series was noticed during both wet and dry seasons for both eastern gujarat fig 9 b and rajasthan fig 9 d it indicated that there would be an increase in the frequency and magnitude of extreme rainfall in the coming time bi et al 2017 pichuka and maity 2020 the projected rainfall was expected to have a cv of range 0 22 2020 s 0 37 2080 s under the rcp 4 5 scenario and 0 31 2020 s 0 50 2080 s under the rcp 8 5 scenario during the wet season for the eastern gujarat region similarly the cv range of 0 35 2020 s 0 59 2080 s under rcp 4 5 and 0 42 2020 s 0 73 2080 s was expected during the dry season for the area for rajasthan region cv would range between 0 26 2020 s 0 34 2080 s under rcp 4 5 scenario and 0 29 2020 s 0 46 2080 s under rcp 8 5 scenario during wet season similarly cv would span between 0 53 2020 s 0 65 2080 s under rcp 4 5 and 0 56 2020 s 0 75 2080 s under rcp 8 5 scenario during the dry season of the area it indicated an increase in magnitude and frequency of extreme rainfall events in the dry season would be more than the wet season lestari et al 2019 the fluctuation of rainfall was high in the dry season because the influence of variability related to el niño southern oscillation enso and indian ocean dipole iod in the dry season was stronger compared to the wet season hamada et al 2012 suman and maity 2020 reported an increase in iod in the future that further explained the rise of dry season rainfall 6 conclusion in this study a novel downscaling model was proposed viz rgl mars the proposed rgl mars model was compared with three downscaling models i e pca mlr mars pca mars models these models were tested for predictors extracted by cc mi dt and cmd methods for dry and wet seasons separately for two different climatic zones the outcomes of the study lead to the following conclusions i for all of the predictors rgl based method was proven superior to pca based approach in other words the rgl method improved the predictive accuracy of the mars method while pca degraded its efficiency during both the wet and dry seasons rgl mars performed superiorly compared to the rest of the methods for all of the predictor extraction methods ii the rainfall simulated by these downscaling models could replicate the mean of the observed rainfall with good accuracy nse 74 89 cc 77 94 rmse 10 40 however only the rgl mars model captured the sd and cv of the observed rainfall and the rest of the models failed to do so the rgl mars model solved the problem of underprediction of wet season rainfall and overprediction of dry season rainfall iii the cmd predictors produced better results compared to other predictor extraction methods for all downscaling models the rgl mars model combined with cmd predictors was considered as a benchmark model for future rainfall projection future work might consider advanced machine learning techniques for downscaling e g particle swarm optimisation pso mars the gcms the proposed rgl mars model is an enhancement over existing downscaling methodologies and will provide more accurate predictions under various climatic conditions furthermore the downscaled rainfalls can be well integrated with a range of hydrological and land surface models to understand better the catchment characteristics and the water balance dynamics in future climate studies data availability iitm rainfall data can be obtained from https tropmet res in static pages php page id 52 power project rainfall data can be acquired from https power larc nasa gov data access viewer data of the eight cmip5 gcms used in the study can be retrieved from the ipcc website http www ipcc data org sim gcm monthly ar5 reference archive html ncep ncar data can be acquired from the noaa archive https psl noaa gov data gridded data ncep reanalysis html funding this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors credit authorship contribution statement kanhu charan panda conceptualization investigation methodology software validation formal analysis writing original draft visualization r m singh writing review editing supervision l n thakural resources writing review editing supervision debi prasad sahoo writing review editing software validation formal analysis writing original draft visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 127381 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3776,the high dimensionality of predictor variables reduces the predictive accuracy of statistical downscaling models principal component analysis pca is one of the extensively used approaches for reducing the dimensionality of the predictors however pca reduces the efficiency of downscaling models when a nonlinear predictor predictand relationship exists to solve this issue the representative grid location rgl approach was used to minimise the dimension of the predictor variables thus a novel rgl mars multivariate adaptive regression spline based downscaling model was proposed in the current study the proposed model was compared with pca mlr principal component analysis multiple linear regression mars and pca mars downscaling methods eight general circulation models gcms were considered out of which only can esm2 second generation canadian earth system model gcm was found suitable for the study area three criteria i e correlation coefficient cc mutual information mi and decision tree dt were used for the selection of dominant predictors it was observed that cmd cc mi dt predictors when used with the rgl mars downscaling method showed the best performance nse 74 89 root mean square error rmse 10 40 mm the results revealed that rainfall simulated by the rgl mars model captured the standard deviation and coefficient of variation in the observed rainfall whereas the rest failed to do so the rgl mars model solved the issue of underprediction of wet season rainfall and overprediction of dry season rainfall the rgl mars addressed the issue with an improved nse of 62 89 and rmse of 18 45 mm thus the result exhibited that integration of mars with the rgl perform better compared to the pca this study also demonstrated that downscaling model outcomes were more reliable for the wet than the dry season the future rainfall projection indicated that the rainfall fluctuation might be more in the dry season than the wet season the proposed downscaling method can improve the accuracy of rainfall projections under various climatic conditions subsequently coupled with a range of hydrological and land surface models to better understand the catchment characteristics and the water balance dynamics in future climate studies keywords statistical downscaling general circulation models representative grid location multivariate adaptive regression spline decision tree multiple linear regression 1 introduction all regions of the world have already experienced a discernible impact of climate change on water resources and freshwater ecosystems intergovernmental panel on climate change ipcc 2021 it is predicted that climate change will severely affect the magnitude and spatiotemporal trends of hydro climatic parameters including rainfall guo et al 2020 these changes will have crucial effects on the environment human communities and existing and potential water resources yazdandoost et al 2021 further the major impacts of climate change include the increase in the frequency of extreme events viz drought flood and cyclonic storms hallegatte et al 2013 poulose et al 2020 studies have already reported that an increase in the inter annual variability in rainfall events due to climate change was the primary cause of disasters like drought and flood bermúdez et al 2020 tabari et al 2020 additionally rainfall variability has remarkable effects on the socio economic condition of the human race and the effect is more predominant when the country s economy depends on agricultural productions it is partially due to a strong dependency of humankind on rainfed agriculture that is affected by inadequate rainfall gbode et al 2021 the rapidly transforming climate is the primary reason for the increasing rainfall variability hamada et al 2012 thus it is highly essential to study the future rainfall scenario conventionally the earth system models esm viz general circulation models gcm sahoo and panda 2020 and model for interdisciplinary research on climate miroc kawamiya et al 2020 simulate the impact of greenhouse gas emission and project the hydroclimatic variables for the future among the esms gcm is one of the most reliable frequently used and efficient tools available for obtaining the future climate change projection of climatic variables further gcms reproduce past climatic alterations efficiently using natural and anthropogenic factors ipcc 2021 however the coarse spatial resolution of gcm e g canesm2 2 8 2 8 bnu esm 2 8 2 8 hadgem2 ao 1 2 1 9 is causing the hindrance to study the climatic impact on a regional or local scale tabari et al 2020 these major differences between the resolution of gcm outputs and basin scale hydrological variables viz evapotranspiration temperatures streamflow lead to uncertainty in basin scale hydrological fluxes dash et al 2021a sahoo and sahoo 2020 broadly these downscaling techniques are classified into two classes i dynamical downscaling dd and ii statistical downscaling sd the dd involves complex physical processes in the atmosphere and requires extensive capital investment for computation whereas the sd models empirically link the gcm outputs with fine scale meteorological parameters sachindra et al 2018 the sd techniques became popular because of their cost effectiveness and simplicity compared to the dd technique sachindra et al 2014 the multiple linear regression mlr method is one of the oldest and commonly used sd techniques the mlr technique performs poorly when nonlinear predictor predictand relationships exist sachindra et al 2014 similarly the nonlinearity could be better addressed by generalised linear models glm compared to the mlr method however the glm needs a relatively large dataset and is sensitive to outliers beecham et al 2014 the effect of outliers in nonlinear problems could be neutralised by the artificial neural networks ann technique however the approach is susceptible to overfitting and the process is also difficult to interpret as it is a black box model sachindra et al 2018 the k nearest neighbourhood knn is a flexible and evolutionary method that requires no training period and can incorporate additional data seamlessly without affecting the model s accuracy lee et al 2017 conversely the knn method does not work well with a large high dimensional dataset and is sensitive to missing data and outliers shashikanth et al 2018 genetic programming gp is a nonlinear regression method that works well with noisy data and can handle large datasets with the limitation in computational time sachindra et al 2018 the support vector machine svm is also a nonlinear regression method that works well with outliers and solves overfitting issues luo et al 2019 the multivariate adaptive regression splines mars technique has similar abilities as the svm but outcomes of the mars technique are simpler to interpret adnan et al 2020 the gp and least square svm based downscaling models were found superior to the mlr models as the gp and svm models could handle predictor predictand nonlinearity better compared to the mlr downscaling model sachindra et al 2013 the svm models showed higher predictive accuracy compared to the ann model due to the issue of overfitting associated with the ann model duhan and pandey 2015 goly et al 2014 reported that the svm downscaling approaches demonstrated superiority over stepwise regression sr and positive coefficient regression pcr models owing to two reasons i better accounting of predictor predictand nonlinearity by svm and ii less overfitting compared to the sr and pcr models adnan et al 2020 reported that mars and least square svm downscaling approaches showed similar performance accuracy further hoang et al 2017 compared the predictive accuracy of multi gene genetic programming mggp mars ann and lssvm regression methods and found that the mars regression technique outperformed the rest of the models the superiority of mars downscaling models might be attributed to their ability to handle nonlinearity better compared to the rest of the models yin et al 2018 adnan et al 2020 thus the mars downscaling technique could be used as an effective tool to solve the issue the accuracy of the mars model could be further improved by reducing the collinearity among predictors dormann et al 2013 interestingly earlier studies proposed several collinearity reduction techniques viz principal component analysis pca anowar et al 2021 multidimensional scaling salvi and ghosh 2013 devak and dhanya 2016 copula sahoo et al 2020 independent component analysis teegavarapu and goly 2018 maximum variance unfolding goly et al 2014 t distributed stochastic neighbor embedding t sne gisbrecht et al 2015 anowar et al 2021 and uniform manifold approximation and projection umap becht et al 2019 to decrease the dimensionality of the predictor variables among all these algorithms the pca is one of the extensively used collinearity reduction techniques anowar et al 2021 the pca reduces the complexity of datasets and still preserves their trends and patterns it does so by transforming the data into reduced dimensions which act as summaries of features the primary motivation of pca is to decorrelate the dataset i e remove second order dependencies shlens 2014 higher order dependencies are very common in downscaling studies that reduce the effectiveness of pca past studies have reported that pca works poorly when a nonlinear relationship predictor predictand exists shao et al 2014 further pca is an unsupervised approach that finds patterns without reference to prior knowledge about the variable the principal components pcs in the pca are heavily weighted along the variables having a higher magnitude and ignores other variables lever et al 2017 the utilisation of pcs as inputs can also degrade the efficiency of the model sachindra et al 2013 furthermore pca can only be used with variables having similar statistical distribution sehgal et al 2018 because of these aforementioned issues linked with pca the representative grid location rgl sachindra and kanae 2019 was also employed in this study the rgl approach minimises the dimensionality of predictors by removing gcm predictor variables having high inter grid correlation unlike pca the rgl approach doesn t break the structure of the predictors and preserves the original structure of the dataset thus the rgl technique does not have the majority of the problem faced by the pca approach in the light of the above reviews this manuscript explores the following research questions i how does the coupling of dimensionality reduction techniques like pca and rgl techniques with standalone multivariate adaptive regression spline mars downscaling model affect the accuracy of the standalone model and ii how the pca coupled mlr model standalone mars model pca mars model and rgl mars model perform for predictor selected by correlation coefficient cc method mutual information mi method decision tree dt method and the cmd method cc mi dt under dry and wet seasons in light of the preceding reviews the following objectives are decided for the study i development of an rgl based mars rgl mars downscaling model and ii performance evaluation of the rgl mars model with pca based mlr model pca mlr standalone mars model and pca based mars model pca mars 2 study area the complete development and evaluation of the proposed downscaling algorithms were performed on the selected province of india eastern gujarat area 82 696 km2 and rajasthan area 3 42 239 km2 fig 1 the study area lies between the 18 32 n latitude and 68 80 e longitude in order to check the applicability and reliability of the developed algorithms two completely different climatic regions were selected i the eastern gujarat region one of the most flood prone regions in india sharma et al 2011 ii rajasthan one of the most drought and desertification prone regions in the country mishra et al 2021 kalyan et al 2021 praveen et al 2020 demonstrated that the eastern gujarat region showed the highest temporal variability in rainfall compared to other regions of the country an increase in cyclone wind intensity and coastal inundation in the future was also reported for the study area poulose et al 2020 in addition to all these hallegatte et al 2013 claimed that the periphery region of eastern gujarat would experience a 3 increase of average annual gross domestic product gdp loss due to flood in 2050 compared to 2005 thus the study was conducted over the selected eastern gujarat and rajasthan regions that possess two distinct climatic traits as rainfall is one of the major factors of disasters like drought and flood bermúdez et al 2020 tabari et al 2020 rainfall was considered the primary parameter to apply and evaluate the performance of the developed algorithms 3 applied data observed monthly rainfall for the eastern gujarat and rajasthan regions were acquired from two different sources these sources include the indian institute of tropical meteorology iitm and the prediction of worldwide energy resources power project of nasa the iitm provides weighted average monthly rainfall data based on high quality information obtained from 316 rainfall observatories appropriately distributed throughout the area iitm archive provides highly reliable data till 2006 hence due to absence of recent rainfall data the power project data acquired for 1982 2018 was selected to extend the iitm data obtained for 1961 2006 the 25 years overlapping period 1982 2006 between these two datasets was employed for testing the reliability of the power project data for extending iitm data the power project provides rainfall data having a spatial resolution of 0 5 0 5 fig 1 the thiessen polygon method was utilised to obtain weighted average power project data for the study area the two most common gcm series being frequently used by researchers are the coupled model inter comparison project phase 3 cmip3 gcms and coupled model inter comparison project phase 5 cmip5 gcms however nourani et al 2019 reported that downscaling models perform better with cmip5 gcms compared to cmip3 gcms hence eight cmip5 gcms were used in this study table 1 shows the model resolution and the research center that developed the gcms used in this study table 2 presents the predictors employed in this study chosen considering past literature and the physical aspect of the predictors e g teegavarapu and goly 2018 gridded ncep ncar reanalysis data 2 5 2 5 was attained from national oceanic and atmospheric administration physical science laboratory noaa psl archive over 20 25 n and 70 75 e for the period 1961 2018 served as predictors for the downscaling model fig 1 shows the gcm and ncep ncar grid boxes covering the entire study area the cmip5 gcm data were obtained from the ipcc website 3 1 atmospheric domain selection in this study the domain of 5 5 grid points having a spatial resolution of 2 5 x 2 5 was used fig 1 najafi et al 2011 used an atmospheric domain with 7 4 grid points with a resolution of 2 5 x 2 5 for downscaling monthly rainfall and demonstrated that the square shape of the atmospheric domain is not mandatory for downscaling studies however the highly rectangular shape of the domain will affect the atmospheric circulation by giving more weightage to the influence coming from the wider side and neglecting the narrower side sachindra et al 2014 thus domains having such a form should not be used for downscaling studies vast atmospheric domains will increase the expenditure and time required for the study however a large domain helps to detect the effects of atmospheric circulation for a broad area if the domain is very small it may not describe the atmospheric circulations responsible for the spatial aspect of climatology in the basin hence the domain of proper shape and size should be selected before any downscaling study in light of the above reviews a 5 5 point domain having a resolution of 2 5 x 2 5 was chosen for the current study the domain size was decided based on its capability to describe the atmospheric process that affect the rainfall in the area of interest after finalising the atmospheric domain the gcm predictors were interpolated at ncep ncar grid points 4 material and methods 4 1 gcm and predictor selection criteria in the current study predictand referred to the observed rainfall pcpobs and the gcm variables were considered the predictor variables three criteria i e pearson correlation coefficient cc mutual information mi shiba 2020 and m5 algorithm of the decision tree dt hamze ziabari and bakhshpoori 2018 were utilised to select gcm and extract dominant gcm variables cc and mi between the observed and gcm rainfall from 1961 to 2000 were estimated to select proper gcm for the study area a similar gcm selection approach was adopted by nourani et al 2019 a threshold value of 0 6 was considered for both cc and mi for gcm selection among eight gcms considered only can esm2 gcm precipitation showed strong linear cc and nonlinear mi connections with the predictand for eastern gujarat and rajasthan and was used for downscaling the ncep ncar reanalysis data was used in this study instead of the gcm historical dataset due to the following two reasons i gcm outputs contain large bias that introduces higher uncertainty in the downscaled data as datasets are produced by very high quality climate models that receive inputs from the surface air and satellite observation platforms raje and mujumdar 2011 and ii it is appropriate to use the ncep ncar reanalysis data instead of gcm historical data when only one gcm is used for downscaling goly et al 2014 table 2 presents the ncep ncar predictors employed in this study considering past literature and the physical aspect of the predictors teegavarapu and goly 2018 even after the gcm selection the number of predictors for the 25 ncep ncar grid point was 3275 131 25 the application of such a large number of predictors would drastically reduce the predictive accuracy of the model to eradicate the problem dominant predictors were extracted using cc mi and dt methods and utilised as the input for the downscaling model the predictors were selected for all the gcm grid points covering the 25 ncep ncar grid points around the study area fig 1 4 1 1 correlation coefficient the correlation coefficient cc is a standard indicator to assess the strength of the linear link between two datasets its value ranges between 1 and 1 the values 1 and 1 imply a strong positive and negative linear predictor predictand association whereas zero indicates no link between the predictor and predictand the cc between the dominant gcm variable x with a mean of x and observed rainfall pcpobs y with a mean of y is defined by eq 1 as 1 c c x x y y x x 2 y y 2 the cc value indicates the strength of linear relationship between the predictor variables and the predictand 4 1 2 mutual information mutual information mi quantifies statistical dependence between predictor and predictand the mi values have a range of 0 the value zero indicates no mutual information whereas higher mi values imply greater mutual information for predictand pcpobs y and the dominant gcm variable x having marginal distributions p x and p y respectively and a joint distribution p xy mi between x and y is expressed in eq 2 as 2 m i p x y log 2 p x y p x p y the mi value indicates the strength of nonlinear relationship between the predictor variables and the predictand tavakol davani et al 2013 4 1 3 decision tree the decision tree dt technique is a robust technique to carry out prediction and classification typically a tree consists of four portions that include leaf node branch and root in a dt leaf and root indicate the first and last nodes respectively as the dt method is a graphical approach interpretation of the outcomes is more straightforward than other techniques in this study the m5 algorithm of dt is used as it is a more efficient classifier than other algorithms when used for continuous numeric variables nourani et al 2019 the m5 model is comparable with a piecewise linear function consisting of several tree regression models kiranmai and laxmi 2018 the typical regression model contains a single equation for the whole dataset whereas tree based regression divides the data into several subsets known as the leaf each leaf is linked to a regression equation first the split criterion is employed to construct the m5 model tree the split criterion minimises the standard deviation of each data class obtained at each node the standard deviation reduction sdr by the split criterion is estimated by eq 3 as 3 s d r s d p p i p s d p i where p and pi are the entire dataset and subset of data received at each node respectively and sd refers to the standard deviation of the dataset such splitting leads to the creation of a huge tree hence the size of the large tree is reduced by pruning branches and replacing them with regression functions the m5 algorithm of dt employed in the current study performs pruning on the large tree with great efficiency the model tree is also used to extract dominant predictor variables predictors of each class are classified and compared by the decision tree in this study the predictors that carry higher importance are allocated at the upper nodes of the tree and predictors with lower importance are found at the end nodes predictors located at the upper nodes are chosen as dominant predictors weka software kiranmai and laxmi 2018 was utilised to carry out the m5 model tree in the current study dt can identify the variables with both linear and nonlinear dependencies exist between the predictor and the predictand nourani et al 2019 4 2 gcm skill estimation by variable convergence score vcs the skill of a gcm is a measure to evaluate the reliability of the gcm projection one of the robust criteria for measuring the gcm skill is the variable convergence score vcs ojha et al 2014 the vcs compares variables in time and space based on the coefficient of variation cv the cv provides an advantage over other statistics as it is insensitive to the absolute values of the variable because a wide range of values are expected from different variables a skill score based on the cv is appropriate as it is the ratio of the standard deviation to the mean of the values the cv value calculated at each grid cell for the three pressure levels from the collection of mean annual results from eight gcms forms the basis for vcs the vcs is a simple comparison between the cv value of one variable or one region with that of another the vcs is determined by calculating the cumulative distribution of the cv values for all locations variables pressure levels and time the relative position of a particular cv value compared with all other cv values can be measured in this way instead of fitting a theoretical distribution to the cv values the skill score is based on an empirical cumulative distribution function cdf to maintain simplicity and effectiveness the estimation procedure of the vcs was outlined below combine the results from all models for one ensemble for a particular variable for each grid for each 10 year window three ten year windows i e 2030 2050 and 2070 as shown in eq 4 4 x j t x j t z 1 l x j t z 2 l x j t z 3 l x j t z n l where x j t z n l variable x at grid point j at time t level z from model n and emission scenario l calculate cv for each cell c v j t x which is the ratio of the standard deviation to mean for the vector x j t pool the cv values for all grids variables levels emission scenarios and 10 year windows in this study 25 grid points 40 variables 33 variables are surface variables three pressure levels 500 hpa 700 hpa and 850 hpa two emission scenarios rcp 4 5 and rcp 8 5 and three 10 year windows were considered yielding a pool of 8100 cv values as explained below 25 grid points 33 variables 3 pressure levels 1 emission scenario 3 10 year windows 7 grid points 3 surface variables 1 pressure levels 1 emission scenario 3 10 year windows 8100 values calculate the empirical cdf of cv values assuming that the pooled cv values come from a common distribution that characterises the variability of the climatic variables eq 5 5 f c v r n where r rank of the individual cv value and n total number of cv values calculate the vcs for a particular variable x or a particular grid cell j according to eq 6 6 v c s x j 100 1 f c v the rationale behind the vcs is to calculate convergence based on the cv values of the variable across all gcms it is expected that the gcm with for which the variables that exhibit high vcs low cv could be considered as a promising gcm for rainfall projection 4 3 gcm interpolation the downscaling model established using the ncep ncar data cannot be utilised directly to predict future rainfall using gcm data due to the resolution difference between these two variables hence the gcm variables were interpolated at the ncep grid points to resolve the issue a linear regression based interpolation method goly et al 2014 was utilised in the current study instead of traditional spatial interpolation techniques the mlr based interpolation method is described in eq 7 7 y j g c m n k 1 n m k y j k g c m j where y j k g c m denotes the gcm variables at the kth grid at the jth interval of time m k refers to the regression coefficients n is the overall number of gcm grid points and y j g c m n indicates the gcm variables at the ncep ncar grid points 4 4 downscaling model in this study downscaling was performed on a monthly scale however the performance evaluation of the downscaling models was done using seasonal data a year was divided into two seasons in the current study i e wet season and dry season the wet season rainfall was obtained by the sum of rainfall from june to november and the dry season rainfall referred to the sum of rainfall from december to may the techniques used in this study for downscaling model development are explained in the following section 4 4 1 principal component analysis pca the pca mathematically transforms original variables which may be correlated into loadings using eigenvectors and eigenvalues pca shrinks the data set by identifying new set of variables called principal components pcs which contain the maximumvariance in the original dataset furthermore because the principal components are orthonormalto one another there is no redundant information many researchers have reported using the pca method in downscaling works anowar et al 2021 for performing the pca first the covariance matrix of the normalised variables is computed each variable is standardised by subtracting the mean and the outcome isdivided by the standard deviation of the original variable the eigen vectors derived from the covariance matrix are employed for pca the eigen vectorsare ordered so that the first onecorresponds to the largest eigen value and the kth eigen vector to the kth largest eigen value λk the kth principal component at time t pckt is computed by eq 8 as 8 p c k t q e k q p t q p q s q where pt q is the value of qth variable mean sea level pressure geopotential height at any node at time t p q and s q are the mean and standard deviation of the variable p q and ekq is the qth element of the eigen vector corresponding to kth eigen value the percentage of total variance ωk explained by the kth principal component is given by eq 9 9 ω k λ k m 1 m λ m where m is the dimensionality of the original dataset 4 4 2 multiple linear regression mlr the mlr method is one of the commonly used downscaling methods employed in climatic change studies this method performs poorly when a nonlinear predictor predictand relationship exists in the mlr approach pcs are used as predictors and the rainfall is used as predictand several past studies have reported the successful use of this method for statistical downscaling goly et al 2014 sachindra et al 2014 the general expression for mlr is presented by eq 10 10 p c p o b s i 1 n c i x p c i c ε pcpobs represent the observed rainfall pci is the ith principal component ci is the regression coefficient c is the intercept and ε is the error term 4 4 3 rgl mars model development the mars is a nonlinear and nonparametric regression technique given by friedman 1991 the mars model generates piecewise basis functions that help in explaining the nonlinearity in the predictor predictand relationship this approach automatically discovers nonlinearity and appropriate data structure in the predictors predictand relation employing a weighted summation on linear or polynomial basis functions in the proposed rgl mars method rgl was used to minimise dimensionality and redundancy in the predictors and then the mars technique was used to perform regression in the rgl method the spatially least intercorrelated datasets for each predictor for each grid were identified the method was applied for both wet and dry seasons separately the rgl method is explained in the following steps 1 spatial correlations using cc between the datasets of probable predictor xi at all grid points in the domain were estimated as seen in fig 2 the correlations between predictor xi at different grid points i j were determined with respect to each other it generates a correlation matrix that demonstrates the correlation of predictor xi between any two grid points 2 the grid point showing the highest number of high correlation cc 0 8 with other grid points was found from the correlation matrix the grid point is termed as the first representative grid location rgl for the probable predictor xi for example data at grid point pe d fig 2 are strongly linked with the data at q number of grid points predictors in the green box as no other grid point displays more than the q number of highly correlated grid points for predictor xi the grid point pe d is considered the first rgl 3 data of the first rgl and variables strongly associated with it are removed from the dataset xi for example data of xi at the grid points confined by the green box fig 2 are eliminated from the original data set hence the size of the correlation matrix reduces and reduces the dimensionality of predictors 4 steps 2 and 3 are performed on remaining xi data to detect subsequent rgls and continued till no rgl is left for the predictor 5 correlation between the rgl datasets of predictor xi and the predictand was determined the rgl datasets that showed a cc value higher than the threshold value of 0 6 were selected 6 after that steps 1 5 were performed on all other probable predictors e g x1 x2 xi xn the predictors chosen in step 5 were combined and used as input for the downscaling model 7 steps 1 6 were repeated for both wet and dry seasons of both study areas rgl produces predictors having the least spatial correlation thus the likelihood of the presence of redundant information in the model inputs is reduced after conducting rgl mars regression was performed between the predictand and final set of predictors obtained by rgl researchers had demonstrated the successful use of the mars method for statistical downscaling for both linear and nonlinear predictor predictand relations yin et al 2018 a forward backward approach is adopted for accomplishing the mars process adnan et al 2020 during the forward step the model overfits the data due to numerous basis functions bfs in the mars technique the predictors and knots for the bfs are selected automatically in general the mars based model can be described as the following structure eq 11 11 f x δ 0 m 1 m δ m h m x i where hm xi are bfs δ are the coefficients determined by the minimum sum of squared errors from bfs and m accounts for the number of bfs redundant bfs are removed in the backward phase utilising the generalised cross validation criteria to enhance prediction efficiency adnan et al 2020 an open source package called earth milborrow 2014 created in r language was utilised to carry out the mars test 4 5 model evaluation criteria two statistical indicators have been used for the performance assessment of these four downscaling models these indicators include nash sutcliffe efficiency nse and root mean square error rmse these indicators are commonly used in literature for the comparison of various models ljung box statistic q is used to check the significance of serial correlation in the residual series ljung and box 1978 4 6 bias correction downscaling models produce erroneous predictions due to uncertainties linked with the gcm predictors and the downscaling approach thus the bias correction approach eq 12 suggested by mahmood and babel 2013 was used for eliminating bias in the current study 12 p c p b x p o p s where pc is the corrected future monthly rainfall data pb is the biased future monthly rainfall data p o and p s are the observed and simulated mean monthly rainfall data from 1961 to 2018 5 result and discussion 5 1 rainfall data extraction in this study due to the absence of observed rainfall data from a single reliable source two different sources i e the iitm archive and the power project of nasa were used these two datasets had a 25 years 1982 2006 overlapping period that was used to check the suitability of the power project data for extending the iitm rainfall data the scatter plot of the iitm and the power project rainfall for eastern gujarat fig 3 a and rajasthan fig 3 b showed a strong association between both datasets the reliability of the power project data was further checked by performing the ljung box test on residuals of the two rainfall datasets at a 95 confidence interval ci the ljung box statistic value for eastern gujarat q 21 82 p 0 12 and rajasthan q 13 54 p 0 19 suggested acceptance of the alternative hypothesis i e the residual series is serially independent these tests suggested that the power project rainfall data could be used for extending the iitm rainfall record for the 2006 2018 study period for both study areas 5 2 dominant predictor selection among the eight gcms considered only can esm2 gcm precipitation showed a strong linear cc and nonlinear mi connection with the predictand and was used for downscaling table 3 thus only the can esm2 gcm was used for obtaining future projections the ncep ncar reanalysis and can esm2 gcm data have spatial resolutions of 2 5 2 5 and 2 8 2 8 respectively hence the gcm predictors were successfully obtained at ncep ncar grid points by the mlr based interpolation section 4 3 the dominant predictors of the can esm2 gcm for both seasons were extracted by cc mi and dt methods for wet and dry seasons for eastern gujarat table 4 and rajasthan table 5 all predictors selected for the study showed a high value of cc and mi in the dt method the predictors located at the upper nodes of the tree were considered dominant predictors probable predictors should be chosen considering past literature and atmospheric processes influencing the predictand khan et al 2020 such predictors avoid the likelihood of introducing irrelevant information to the downscaling model several past works of literature najafi et al 2011 pichuka and maity 2017 al mukhtar and qasim 2019 reported using these gcm variables tables 4 and 5 for downscaling rainfall it was noticed that dominant predictors extracted by the cc method table 4 and 5 were humidity type variables i e pr hus for both study regions the linear relationship between humidity type variables and rainfall might be due to their strong connection with atmospheric moisture content nourani et al 2019 mi predictor selection approach typically picks nonlinear predictors zonal wind ua geopotential height zg 500 sea level pressure psl and temperature related parameters i e tas were the dominant predictors in the mi based feature extraction method in both of the study areas nourani et al 2019 demonstrated a nonlinear relation between rainfall and the above predictors the predictors selected by the dt method were a combination of both linear and nonlinear predictors in other words the dt based predictor selection approach has the properties of both cc and mi methods another predictor category was formed by combining the variables extracted by cc mi and dt methods and termed it as the cmd method in this study downscaling was carried out for these four categories of predictors 5 3 gcm skill estimation by vcs the cv values varied from a minimum of 0 001 to a maximum of 2 69 the empirical cumulative distribution of all 8100 cv values is shown in fig 4 a the larger values of cvs mainly correspond to grid points over the rajasthan region it was due to the high fluctuation of rainfall in the desert region fig 4 b presents the vcs for the dominant predictor variables for the eight gcms the gcms showed the best convergence for geopotential height mean sea level pressure and air temperature and the scores were lower for precipitable water and wind velocity the results were in line with the outcomes of ojha et al 2014 it was noticed that the canesm2 gcm scored the highest vcs for all of the dominant predictor variables hence the canesm2 gcm variables were used for the future rainfall projection 5 4 rgl and pca the first few pcs explaining 95 variance were selected as predictors for downscaling model development by pca mlr and pca mars methods table 6 depicts the least correlated grid points found by the rgl method for each probable predictor for both wet and dry seasons of eastern gujarat and rajasthan 5 5 downscaling model comparison mean and coefficient of variation cv of observed and modelled rainfall for calibration 1961 2005 and validation 2006 2018 periods of wet and dry seasons for eastern gujarat and rajasthan were presented in fig 5 the nse and rmse for different models for the study areas were tabulated in tables 7 and 8 the four downscaling models were ranked in tables 9 and 10 for different predictor selection approaches based on the outcomes obtained in tables 7 and 8 downscaling was performed by pca mlr mars pca mars and rgl mars methods before the commencement of the downscaling process the dominant predictors were standardised over the period 1961 2018 in this study 70 of data were used for calibration 1961 2005 and the remaining 30 for validation 2006 2018 the downscaling models reproduced the observed mean of the rainfall with reasonable accuracy within 10 variation during wet and dry seasons for both eastern gujarat and rajasthan fig 5 our finding was consistent with past studies e g sachindra et al 2013 2014 sachindra and perera 2018 that showed the ability of downscaling models to reproduce the mean of predictand accurately only the rgl mars model captured the sd and the cv of the observed rainfall during both seasons for both study areas whereas the rest of the models failed to do so it indicated that the rgl mars downscaling model was superior to the rest of the models the characteristics were more noticeable in the outputs of the pca mlr and pca mars models during both seasons for both regions it might be due to the inability of the models to explain the total variance in the predictand dataset hewitson et al 2013 sachindra et al 2014 it happened because of the bias in gcms due to the narrow understanding of the atmospheric processes and simplified representation of the complex climate system in gcms li et al 2010 rgl mars method overcomes the problem to some extent these models underpredicted average wet season rainfall high rainfall and overpredicted average dry season rainfall low rainfall during both dry and wet seasons in both eastern gujarat and rajasthan areas fig 5 our finding was in agreement with sachindra et al 2014 the variance in the observed rainfall series was higher compared to the variance in the predictor variables hence the downscaling model trained by the gcm data explained the medium range of variance in the predictand variable better compared to the extreme values in other words these models simulated the average rainfall more effectively than extreme rainfall events sachindra et al 2014 high cv was reported in the dry season compared to the wet season which implied that the dry season was susceptible to more extreme events compared to the wet season gur et al 2015 thus the downscaling model simulation is unreliable in the dry season as it poorly simulates extreme events high sd was observed in the wet season compared to the dry season 5 5 1 downscaling using cc predictors as seen in tables 7 and 8 the rgl mars method performed better than other downscaling approaches during both dry and wet seasons for both eastern gujarat nse 62 72 rmse 22 45 mm and rajasthan nse 58 67 rmse 13 47 mm better performance of the rgl mars method compared to the mars technique indicated that coupling of the rgl with the mars technique boosted the accuracy of the mars downscaling method for linear or cc based predictors further the mars technique was affected by the multicollinearity in the predictor dataset which reduced its efficiency koc and bozdogan 2015 our result disagrees with roy et al 2020 who reported that the mars method was not severely affected by collinearity in the predictors the pca mlr downscaling approach outperformed the mars and pca mars methods during the validation period wet season in the eastern gujarat region tables 7 and 9 it might be due to the fact that pca worked well with data showing linear behaviour lee et al 2020 conversely the poor performance of the pca mlr approach for for rajasthan region tables 8 and 10 might be attributed to the fact that the wet season rainfall in arid regions strongly influenced by predictors that show nonlinear variation with rainfall shao et al 2014 the mars and the pca mlr downscaling methods demonstrated the least accuracy during the wet and dry seasons respectively in the eastern gujarat area tables 7 and 9 the cc predictors might have a higher linear and nonlinear connection with the predictand during wet and dry seasons respectively which leads to the above result goly et al 2014 the pca technique improved reduced the accuracy of the mars downscaling method during the wet dry season our results were in line with tavakol davani et al 2013 however the pca mlr approach was the least accurate model for dry and wet seasons in the rajasthan area tables 8 and 10 the poor performance of the pca mlr model might be attributed to the nonlinear effect of climatic variables on rainfall gao et al 2017 5 5 2 downscaling using mi predictors the mi method extracts nonlinear predictors as seen in tables 7 10 the rgl mars method showed the best performance followed by the mars technique for both eastern gujarat nse 65 79 rmse 20 40 mm and rajasthan nse 61 74 rmse 12 43 mm regions the rgl technique boosts whereas pca reduces the accuracy of the mars downscaling technique when used with mi based predictors the deterioration in the performance might be due to the fact that pca does not work well when a nonlinear predictor predictand relationship exists shao et al 2014 the pca mlr method showed the least accuracy for mi predictors followed by the pca mars approach for both study areas the low efficiency of the mlr downscaling models might be due to its assumption of the linear predictor predictand relationship that is not followed by the mi predictors tavakol davani et al 2013 5 5 3 downscaling using dt predictors dt extracts multilinear a combination of linear and nonlinear predictors it was evident from tables 7 10 that the rgl mars method was found superior to the rest of the three methods during dry and wet seasons in both eastern gujarat nse 79 85 rmse 18 38 mm and rajasthan nse 74 79 rmse 10 40 mm when dt predictors were used it indicated that the rgl approach improves the predictive accuracy of the mars method in the case of the dt predictors it was also evident that rgl was superior to pca when used with multilinear predictors during the calibration period of the wet season for both eastern gujarat and rajasthan pca mars outperformed the mars method whereas pca mars performed poorly compared to mars during the validation period of the wet season for both regions the downscaling models performed better during the calibration period compared to the validation period due to the fact that the calibration was performed in a comparatively wet period sachindra et al 2014 the poor performance of pca mlr and pca mars methods during the dry season for both study areas showed that pca based downscaling methods might not yield satisfactory results when employed for downscaling dry season rainfall with multilinear dt predictors it could be interpreted that the dry season rainfall predicted by these two models was less reliable compared to the wet season rainfall timm et al 2015 and daksiya et al 2017 also showed that statistical downscaling gives more reliable results for wet seasons compared to the dry season results showed that downscaling models performed more efficiently for the dt method compared to cc and mi methods otherwise stated downscaling models capture more variance in the predictand when a combination of linear and nonlinear predictors is used it might be due to the fact that dt possess the merits of both linear and nonlinear feature extraction methods and has overcome the error magnification problem faced by the nonlinear predictor selection approaches tavakol davani et al 2013 in contrast the mi approach extracts nonlinear predictors only and ignores linear ones hence the dt based predictor selection technique was found superior to cc and mi methods 5 5 4 downscaling using cmd predictors cmd method consists of all predictors selected by cc mi and dt method it was evident from tables 7 10 rgl mars method was found the best downscaling method among the four methods followed by the mars technique for both eastern gujarat nse 79 89 rmse 18 35 mm and rajasthan nse 74 83 rmse 10 40 mm when used with cmd predictors it showed that the rgl pca method improved reduced the accuracy of the mars method during both dry and wet seasons for the study areas pca mlr technique showed the least accuracy during the wet season for both eastern gujarat and rajasthan both pca mlr and pca mars methods performed poorly during the dry season as reported earlier the pca based methods could not perform accurately during the dry season when used with multilinear predictors it was noticed that downscaling models showed greater accuracy for the cmd approach compared to cc mi and dt methods thus it was concluded that the cmd predictor extraction method is an improvement over dt based predictor selection technique the better performance of the cmd method compared to dt was due to the fact that the cmd approach accounts for more probable predictors that were missed by the dt method owing to the above reason the cmd method describes more variance in the predictand dataset compared to the dt method to better visualise the result the cumulative distribution function cdf plots of the model simulations for the cmd predictor was provided in the fig s1 of the supplementary material the model simulations mostly underpredicted the wet season rainfall and overpredicted the dry season rainfall for eastern gujarat and rajasthan fig 6 the result was consistent with the outcomes obtained earlier it was observed that the rainfall simulated by rgl mars followed that of observed rainfall more accurately compared to the rest of the methods fig 7 it was also noticed that the simulated rainfall followed the observed rainfall more closely during the wet season than the dry season it indicated that there was more uncertainty associated with dry season rainfall compared to wet season rainfall it was concluded that the rgl mars method provided the most optimal result when combined with cmd predictors rgl mars outperformed the mars downscaling method for linear and nonlinear predictor predictand relationships for all predictor selection methods tables 7 10 thus the rgl mars model could be considered an improvement over the mars downscaling model tavakol davani et al 2013 it might be due to the ability of the proposed model to reduce the multicollinearity among predictor variables that the mars model had failed to achieve koc and bozdogan 2015 the proposed downscaling method was superior to the pca mars method yousefzadeh et al 2019 for all predictor extraction techniques it might be due to the inability of the pca mars approach to deal with nonlinearity that was addressed by the rgl mars method the rgl mars downscaling model is an improvement over the rgl based gp downscaling model sachindra and kanae 2019 the superior performance of the proposed model might be attributed to two significant factors i high predictive accuracy of mars algorithm compared to gp hoang et al 2017 and ii deteriorated the efficiency of gp models due to inappropriate selection of fitness function population size essential parameters e g the rate of mutation and crossover and the criteria for a new population yang 2020 5 6 future rainfall projection 5 6 1 projection for downscaling models using cmd predictors all models showed consistent trend during both dry and wet seasons for rcp 4 5 and 8 5 fig 8 in eastern gujarat region increase in rainfall might be observed during the 21st century for both rcp 4 5 and 8 5 in the rajasthan region rainfall would increase initially but it might decrease during the end of the century as the rgl mars model is considered the base model the detailed analysis of the rainfall projection obtained by this model is discussed in following section 5 6 2 projection for rgl mars model for dry and wet seasons finally seasonal rainfall was projected for the future 2018 2099 under rcp 4 5 and rcp 8 5 scenario of the can esm2 gcm for eastern gujarat and rajasthan the rgl mars model with the cmd predictors was picked as the best downscaling model and utilised for the purpose bias correction was performed on the projected rainfall data as seen in fig 9 a eastern gujarat would experience a rise in rainfall in the future i e 2020 s 2005 2035 2050 s 2035 2065 and 2080 s 2065 2095 during both wet and dry seasons under both rcp 4 5 and 8 5 scenarios our findings agreed with salvi and ghosh 2013 who showed a rainfall increase in the future in india s western coastline many researchers reported an increase in rainfall in the proximity of the region singh et al 2015 bal et al 2016 pichuka and maity 2017 dash et al 2021b the rise in rainfall might be due to the increase in the surface temperature which boosts the evapotranspiration rate thus rainfall increases shokri kuehni et al 2017 the increase in rainfall might also be due to the melting of permafrost that might trigger the release of methane and co2 which raises the temperature and increases the rainfall bindoff et al 2019 further with the removal of the ice sheet albedo decrease and lead to a rise in temperature and precipitation however the increase in the surface temperature might help raise the rainfall with several limitations total moisture available in the system ability of the region to sustain feedback loop processes under a warming climate etc the rise in average rainfall with respect to baseline was expected to be in the range of 2 9 15 2 under the rcp 4 5 scenario and 9 9 38 8 under the rcp 8 5 scenario during the wet season similarly the rise in mean rainfall was anticipated to range between 16 5 and 66 9 under the rcp 4 5 scenario and 30 1 128 1 under the rcp 8 5 scenario during the dry season it was noticed that more increase in rainfall would appear under the rcp 8 5 scenario compared to the rcp 4 5 scenario it might be due to the highest emission of greenhouse gases under the rcp 8 5 pathway that was way more than other rcps luhunga et al 2018 yaduvanshi et al 2019 yin et al 2020 it was also noticed that the increase in rainfall in the dry season would be higher than in the wet season our outcomes were in line with murray tortarolo et al 2017 the projected rainfall showed a different pattern for rajasthan fig 9 c during the wet season rainfall is expected to rise by 5 25 and 13 16 under the rcp 4 5 and rcp 8 5 scenarios respectively during the 2020 s however a wet season rainfall reduction by 1 4 and 5 2 with respect to baseline might be noticed during the 2050 s and 2080 s respectively under the rcp 4 5 scenario similarly a decrease in rainfall magnitude with respect to baseline was expected to be 6 2 and 10 1 under the rcp 8 5 scenario during the 2050 s and 2080 s respectively the dry season in rajasthan might experience a rainfall reduction of 2 8 17 7 under the rcp 4 5 scenario and a decrease of 4 5 28 7 under the rcp 4 8 scenario our result agrees with previously reported observations of the dry season becoming drier konapala et al 2020 pradhan et al 2019 an increase in the cv in the projected rainfall series was noticed during both wet and dry seasons for both eastern gujarat fig 9 b and rajasthan fig 9 d it indicated that there would be an increase in the frequency and magnitude of extreme rainfall in the coming time bi et al 2017 pichuka and maity 2020 the projected rainfall was expected to have a cv of range 0 22 2020 s 0 37 2080 s under the rcp 4 5 scenario and 0 31 2020 s 0 50 2080 s under the rcp 8 5 scenario during the wet season for the eastern gujarat region similarly the cv range of 0 35 2020 s 0 59 2080 s under rcp 4 5 and 0 42 2020 s 0 73 2080 s was expected during the dry season for the area for rajasthan region cv would range between 0 26 2020 s 0 34 2080 s under rcp 4 5 scenario and 0 29 2020 s 0 46 2080 s under rcp 8 5 scenario during wet season similarly cv would span between 0 53 2020 s 0 65 2080 s under rcp 4 5 and 0 56 2020 s 0 75 2080 s under rcp 8 5 scenario during the dry season of the area it indicated an increase in magnitude and frequency of extreme rainfall events in the dry season would be more than the wet season lestari et al 2019 the fluctuation of rainfall was high in the dry season because the influence of variability related to el niño southern oscillation enso and indian ocean dipole iod in the dry season was stronger compared to the wet season hamada et al 2012 suman and maity 2020 reported an increase in iod in the future that further explained the rise of dry season rainfall 6 conclusion in this study a novel downscaling model was proposed viz rgl mars the proposed rgl mars model was compared with three downscaling models i e pca mlr mars pca mars models these models were tested for predictors extracted by cc mi dt and cmd methods for dry and wet seasons separately for two different climatic zones the outcomes of the study lead to the following conclusions i for all of the predictors rgl based method was proven superior to pca based approach in other words the rgl method improved the predictive accuracy of the mars method while pca degraded its efficiency during both the wet and dry seasons rgl mars performed superiorly compared to the rest of the methods for all of the predictor extraction methods ii the rainfall simulated by these downscaling models could replicate the mean of the observed rainfall with good accuracy nse 74 89 cc 77 94 rmse 10 40 however only the rgl mars model captured the sd and cv of the observed rainfall and the rest of the models failed to do so the rgl mars model solved the problem of underprediction of wet season rainfall and overprediction of dry season rainfall iii the cmd predictors produced better results compared to other predictor extraction methods for all downscaling models the rgl mars model combined with cmd predictors was considered as a benchmark model for future rainfall projection future work might consider advanced machine learning techniques for downscaling e g particle swarm optimisation pso mars the gcms the proposed rgl mars model is an enhancement over existing downscaling methodologies and will provide more accurate predictions under various climatic conditions furthermore the downscaled rainfalls can be well integrated with a range of hydrological and land surface models to understand better the catchment characteristics and the water balance dynamics in future climate studies data availability iitm rainfall data can be obtained from https tropmet res in static pages php page id 52 power project rainfall data can be acquired from https power larc nasa gov data access viewer data of the eight cmip5 gcms used in the study can be retrieved from the ipcc website http www ipcc data org sim gcm monthly ar5 reference archive html ncep ncar data can be acquired from the noaa archive https psl noaa gov data gridded data ncep reanalysis html funding this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors credit authorship contribution statement kanhu charan panda conceptualization investigation methodology software validation formal analysis writing original draft visualization r m singh writing review editing supervision l n thakural resources writing review editing supervision debi prasad sahoo writing review editing software validation formal analysis writing original draft visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 127381 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3777,in relatively large forested watersheds different types of forest disturbances such as timber harvesting wildfire and insect infestation often cumulatively and interactively affect runoff there is a general lack of studies examining cumulative hydrological impacts caused by different types of forest disturbance particularly in boreal forested watersheds in this study we evaluated the impacts of cumulative forest disturbances timber harvesting mountain pine beetle mpb infestation and wildfire on annual runoff in two large forested watersheds situated in the boreal northern interior of british columbia bc canada the study period was divided into the reference period of 1981 to 2003 and the disturbance period of 2004 to 2018 time series analysis cross correlation was used to determine the statistical relationship between cumulative forest disturbances and annual runoff while two quantification methods including the modified double mass curve mdmc and a sensitivity based technique were applied to separate the effects of cumulative forest disturbances and climate variability to annual runoff surprisingly our results contradict the well accepted conclusion that annual runoff increases with forest disturbances we found that cumulative forest disturbances overall decreased annual runoff in the study watersheds with varied reductions depending on severities of dominated disturbance types and post disturbance forest dynamics our results also revealed that both cumulative forest disturbance and climate variability played an additive role in decreasing annual runoff during the entire disturbance period these results provide valuable implications for supporting water management in boreal forested watersheds in the context of the warming climate keywords cumulative forest disturbances dynamic responses annual runoff climate variability additive effects boreal forests 1 introduction the hydrological effects of forest disturbances e g harvesting wildfire insect infestation have long been studied for various forest types climate and hydrological regimes hallema et al 2018 li et al 2017 zhang et al 2017a zhang and wei 2021 a common conclusion is that forest disturbances increase annual runoff because forest removal reduces canopy interception loss and transpiration bosch and hewlett 1982 brown et al 2005 stednick 1996 however there are some inconsistent findings such as no significant change or declines in annual runoff caused by non stand replacing forest disturbances goeking and tarboton 2020 nevertheless the relationship between forest disturbances and hydrology continues to receive growing attention worldwide due to more frequent and severe forest disturbances induced by climate change impacts e g recent catastrophic fires in australia and the united states in 2020 and their significant consequences e g flood hazards after catastrophic fires adams et al 2020 robinne et al 2021 for relatively large landscapes forest disturbances are cumulative over space and time as are their hydrological effects the effects of cumulative forest disturbances on hydrology are likely dependent on the severities of individual forest disturbance types and post disturbance vegetation dynamics for example stand replacing disturbances e g forest harvesting and high severity wildfires can directly remove entire forest stands and compact soil surfaces by ground based machinery or produce hydrophobic soil resulting in abruptly increased annual runoff caldwell et al 2020 moore et al 2020 in contrast non stand replacing disturbances e g insect infestation and tree die off often produce gradual changes in forest structures and consequently induce variable and gradual hydrological responses goeking and tarboton 2020 a good example is mountain pine beetle mpb infestations that often move through phases of initial attack green phase tree death when the trees turn red red phase and a period where the needles fall off the tree grey phase followed by regrowth of surviving trees and saplings mcewen et al 2020 winkler et al 2010 redding et al 2008 cumulative forest disturbances refer to the addition of multiple disturbance types over space and or accumulation of the same disturbance type repeating over time scherer 2011 although the effects of individual forest disturbance types on hydrology have been extensively studied much less research assesses cumulative forest disturbances over large watersheds or landscapes and their hydrological impacts as our planning and management scales often operate across larger geographic areas such research is critically needed forest disturbance and climate variability are commonly viewed as two dominating drivers that affect watershed scale hydrological processes in forested watersheds de niel and willems 2019 zhang et al 2017b li et al 2018 existing studies have demonstrated that the hydrological responses are determined by the magnitude and direction of each driver giles hansen et al 2019 li et al 2018 yu et al 2019 to explicitly evaluate cumulative forest disturbance impacts on watershed hydrology any climatic influence on hydrological variables must be quantitatively separated or accounted for in the past decade various techniques have been developed for such a separation dey and mishra 2017 aryal and zhu 2020 including the modified double mass curve wei and zhang 2010 sensitivity based methods zhang et al 2011 temporal trend analyses biederman et al 2015 and the tomer schilling framework tomer and schilling 2009 wei et al 2013 provided a summary on various separation techniques and recommended a combined approach of two or more techniques for a more robust assessment british columbia bc canada which is largely covered by forests experiences a large number of disturbances and therefore requires an improved understanding of hydrological responses to changes in forests each year an average of 77 million m3 of forests is harvested in bc with more than 70 occurring in the bc interior environmental reporting bc 2018 since the late 1990 s a large proportion of forests in the bc interior have been attacked by mpb as a result of climate change since warm winters are more favorable for the survival of beetles dhar et al 2016 as of 2008 mpb had attacked approximately 14 5 million hectares of forests in the bc interior leading to the loss of forested lands forest ecosystem services e g carbon sequestration and associated hydrological functioning e g flood control redding et al 2008 in addition there were several extreme wildfire seasons in bc over the past ten years in 2014 alone 1455 wildfires were recorded burning more than 360 000 ha of the province government of british columbia 2014 the severe cumulative forest disturbances in the bc interior highlight a unique research opportunity to assess how cumulative forest disturbances affect hydrology in this study we investigated annual runoff responses to cumulative forest disturbances in two large boreal forested watersheds osilinka and mesilinka located in the northern interior of bc we aimed to answer two scientific questions 1 how did annual runoff respond to cumulative forest disturbances in two large boreal forested watersheds and 2 what were the relative contributions of climate variability and cumulative forest disturbances to annual runoff variations we selected two watersheds located in headwater systems of the williston reservoir the largest reservoir in bc to explore these questions in the hopes the results from this study could also directly support the sustainable management of downstream water resources 2 materials and methods 2 1 study watersheds the osilinka and mesilinka two large boreal forested watersheds with gauged areas of 1950 and 3060 km2 respectively are located in the peace river basin in the northern interior of bc fig 1 these rivers flow into the williston reservoir that spans 1770 km2 which is managed by the provincial utility bc hydro for hydroelectricity power generation at the 2730 mw wac bennett dam and the 694 mw peace canyon dam both watersheds have experienced high levels of cumulative forest disturbances with more than 20 area being affected as of 2018 watershed elevations range from 810 to 2435 m above sea level asl in the osilinka and from 723 to 2407 m asl in the mesilinka with the mean elevations of 1394 and 1410 m asl respectively table 1 both watersheds are predominantly covered by engelmann spruce subalpine fir essf and boreal white and black spruce bwbs biogeoclimatic zones with the dominant tree species being lodgepole pine which is the most abundant species in these watersheds that is attacked by mpb winkler et al 2010 during the entire study period from 1981 to 2018 both watersheds experienced cold climates with mean annual air temperatures of 1 8 and 2 2 c in the osilinka and mesilinka respectively table 1 mean annual precipitation p in these two northern watersheds is about 800 mm with intra annual distributions of precipitation being relatively even snowfall represents more than 50 of the annual precipitation leading to a considerable freshet in spring due to snow melting both watersheds can be classified as energy limited systems with the dryness index a ratio of potential evapotranspiration to precipitation being 1 0 creed et al 2014 2 2 data era5 land is a global reanalysis dataset released by the european centre for medium range weather forecasts muñoz sabater 2019 the product derives from data assimilation algorithms combining forecasts with available observations to estimate different climatic variables more than 50 climatic variables are estimated in the era5 land dataset from 1981 present with a spatial resolution of 0 1 9 km in this study mean tmean maximum tmax and minimum tmin air temperatures snowfall and precipitation at the monthly scale were collected from the era5 land climate dataset monthly variables during the entire hydrological year october to september were summed or averaged as annual variables in addition a temperature based potential evapotranspiration pet estimation method the hargreaves equation was used to calculate watershed pet at the annual scale eq 1 hargreaves and samani 1985 1 pet 0 0023 r a t max t min 2 17 8 t max t min 0 5 where ra is the extraterrestrial radiation and tmin and tmax are the minimum and maximum temperatures c daily discharges were acquired from water survey of canada station ids 07ec004 for the osilinka river and 07ec003 for the mesilinka river annual discharges m3 s 1 were converted into runoff depths with the unit of mm according to the drainage area between 1981 and 2018 mean annual runoff q was 573 mm in the osilinka and 460 mm in the mesilinka table 1 mean runoff ratio rr is defined as the ratio of annual runoff to annual precipitation indicating the runoff production ability of precipitation rr was higher in the osilinka with the value of 0 69 while the corresponding value in the mesilinka was 0 55 table 1 two provincial level databases the vegetation resource inventory vri and the consolidated cutblocks databases were obtained from the british columbia ministry of forests lands natural resources operations and rural development flnrord https catalogue data gov bc ca dataset the vri database version 2019 provides detailed information on tree characteristics disturbance type and year up to 2018 but logging records are incomplete in the vri database to fill in the missing harvesting data in the vri we used the consolidated cutblocks database version 2019 which summarizes logging information up to the end of 2018 from bc ministry of flnrord as submitted by forestry companies it contains complete records of forest harvest size location and logging period by combining the vri and consolidated cutblocks databases we generated complete and comprehensive long term records of forest disturbance history within our watersheds 2 3 methods 2 3 1 estimating cumulative forest disturbances and defining disturbance periods there are three major forest disturbance types in the interior of bc harvesting mpb infestation and wildfire these forest disturbances occur cumulatively varying over space and time to assess the hydrological effects of these cumulative forest disturbances we used the cumulative equivalent clear cut area ceca as a cumulative forest disturbance proxy which captures different disturbances over space and time and accounts for post disturbance recoveries due to forest regeneration giles hansen et al 2021 lewis and huggard 2010 vore et al 2020 the equivalent clear cut area eca of each disturbance type defined as the area that has been clear cut burned and insect infested with a reduction factor eca coefficient to account for hydrological recovery due to forest regeneration was calculated prior to ceca estimations winkler and boon 2017 once the annual eca for each disturbance type is estimated the values are summed to calculate the ceca of the watershed eca estimations of harvested and burned forests are different from those of mpb infestation logging and wildfires produce abrupt changes by removing forest stands while mpb often leads to partial mortality of overstory with surviving vegetation remaining intact as such different eca coefficients were assigned to reflect these differences between disparate disturbance types zhang and wei 2012 for example if all trees in a stand are burned or harvested with all stands being removed the eca coefficient is assigned to be 100 in the second year with its subsequent values being decreased according to years of recovery in contrast if all trees in a stand are affected by mpb the values of eca coefficients in the following years increase during green red and grey phases and then decrease with regeneration time the osilinka and mesilinka watersheds were essentially undisturbed before 1983 and 1975 respectively fig 2 low levels of logging were recorded during the entire study period with the maximum logging ceca 6 in both watersheds fig 2a and 2b forests have been largely and intensively attacked by mpb since 2004 fig 2c and 2d with ceca caused by mpb infestation near 12 by the end of 2018 in addition there was also an extreme wildfire season in 2014 when 5 4 and 15 9 of the watershed s areas were burned in the osilinka and mesilinka respectively vore et al 2020 in 2014 alone ceca increased by 4 9 in the osilinka and 11 9 in the mesilinka due to the wildfire at the end of the study period 2018 ceca due to wildfire reached 8 5 in the osilinka and 12 0 in the mesilinka in sum ceca increased considerably since 2004 and reached 24 6 and 25 7 in the osilinka and mesilinka respectively in 2018 after analyzing the forest disturbance history of the two watersheds the whole study period was divided into the reference period from 1981 to 2003 and the disturbance period between 2004 and 2018 during the reference period the maximum ceca was only 6 and 3 in the osilinka and mesilinka respectively while the ceca dramatically increased by 18 6 in the osilinka and 22 7 in the mesilinka during the disturbance period 2 3 2 detecting trends in climatic and hydrological variables trend analysis has been widely used to identify the significance of temporal trends in hydrometeorological data providing potential evidence to understand the dynamics of hydrological variations beck et al 2013 in this study sen s slope estimator was calculated da silva et al 2015 jehanzaib et al 2020 and the p value of the slope was examined to identify the possible significance of temporal trends in hydrological and climatic variables p q rr tmean tmax tmin pet and the ratio of snowfall to precipitation the trend package in r was used to summarize sen s slopes and their p values r core team 2020 in this study long term trends during the entire study period 1981 2018 were examined the significance of this two tailed test was assessed at α 0 10 level we selected a significance level of 0 10 in the trend analysis to identify potential trends since the study period spans only 38 years 2 3 3 identifying cross correlation relationships to identify whether cumulative forest disturbances represented by ceca can significantly affect annual runoff time series cross correlation was employed in comparison to traditional correlation tests e g kendall and spearman tests cross correlation can further determine causal relationships and lagged effects between tested variables podobnik and stanley 2008 for the watersheds the effects of cumulative forest disturbances on annual runoff may not be significant in the disturbed year but the effects could be significant in the subsequent years suggesting the lagged effects of cumulative forest disturbances the major advantage of cross correlation analysis is that it can identify lagged causality between two data series ceca and annual runoff to conduct cross correlation tests autocorrelations in the selected variables need to be accounted for if there are autocorrelations arima autoregressive integrated moving average models are built to remove autocorrelations and the stationary residuals are further used to conduct cross correlation analysis in this study arima models of ceca and annual runoff were individually constructed and then cross correlations were tested between their residuals arima model constructions and cross correlation tests were conducted in r r core team 2020 2 3 4 comparing runoff ratios runoff ratio rr calculated as the ratio of annual runoff to annual precipitation can be used to interpret cumulative forest disturbance impacts on runoff guardiola claramonte et al 2011 in this study rr values were compared between the reference and disturbance periods using the nonparametric mann whitney u test mann and whitney 1947 the mann whitney u test has been widely used in hydrological studies to detect the significant differences between variables or periods because the test is insensitive to the distribution type of data samples aryal and zhu 2020 the assumption of the mann whitney u test is that the samples should be independent thus we tested the independence of rr series by computing autocorrelation functions and confirmed that there is no autocorrelation suggesting that the rr series are independent 2 3 5 quantifying annual runoff responses to cumulative forest disturbances in this study we aimed at quantifying cumulative forest disturbance impacts on annual runoff by separating the relative influence of cumulative forest disturbances and climatic variability to annual runoff a change in annual runoff between the reference and disturbance periods can be evaluated as 2 δ q tot q dis q ref where δqtot is the total change in annual runoff mm qdis and qref are the observed annual runoff mm in the disturbance and reference periods once the total change in annual runoff was determined as above two robust methods the modified double mass curve mdmc and the sensitivity based approach were performed to separate the relative influence of cumulative forest disturbances δqf and climatic variability δqc on runoff on the annual basis the mdmc developed by wei and zhang 2010 combines both graphical and statistical analyses to separate the effects of forest disturbances and climatic variability on annual runoff in a single watershed the technique has been successfully applied in various watersheds in canada and china giles hansen et al 2019 hou et al 2021 li et al 2018 liu et al 2015 zhang et al 2017b a general assumption of mdmc is that accumulated climate variability has a near linear effect on accumulated annual runoff if cumulative forest disturbances play a limited role to check the possible issue of stationarity in climate data which could affect stationarity in annual runoff non parametric trend analysis and breakpoint test on critical climate variables p pet and the ratio of snowfall to precipitation were applied if cumulative forest disturbances have significant impacts on accumulated annual runoff the curve would deviate from the baseline different from the traditional double mass curve the x axis of the mdmc refers to the accumulated effective precipitation pae i e the difference between precipitation and predicted evapotranspiration and represents an integrated index of climate variability while the y axis represents the accumulated annual runoff qa the predicted evapotranspiration etp was computed using fu s budyko equation eq 3 fu 1981 yang et al 2007 indicating the contribution of climate variability the w parameter in eq 3 for each watershed was derived according to water balance in the reference period and the derived w was further used in the sensitivity based approach since the effect of climate variability would be consistent during the disturbance period a linear regression model was created using pae and qa from the reference period and applied to simulate qa in the disturbance period represented as qap according to the disturbance pae the differences between qa and qap in the disturbance period were identified as the accumulated annual runoff responses to cumulative forest disturbances δqaf with annual values for both cumulative forest disturbance δqf and climate effects δqc being quantified accordingly eqs 4 5 more detailed descriptions of the mdmc method can be found in wei and zhang 2010 3 et p p 1 p e t p 1 p e t p w 1 w 4 δ q af q a q ap 5 δ q c δ q tot δ q f where etp denotes the predicted annual evapotranspiration mm pet is annual potential evapotranspiration mm estimated from eq 1 p is annual precipitation mm and w is the watershed property parameter qa and qap are the observed and predicted accumulated annual runoff mm and δqf and δqc represent the annual runoff response to cumulative forest disturbances and climate variability mm respectively the second quantification method the sensitivity based approach was also applied to estimate the annual runoff responses to climate variability and cumulative forest disturbances during the disturbance period lv et al 2019 the sensitivity based method assumes that annual runoff responses to climate variability are mainly determined by changes in annual pet and p wei et al 2013 thus δqc can be evaluated as 6 δ q c β δ p γ δ p e t where δp and δpet denote the change in annual p and pet mm during the disturbance period and β and γ are sensitivity coefficients of p and pet which are computed from eqs 7 8 7 β 1 p e t p w 1 w 1 8 γ 1 p p e t w 1 w 1 1 where w is the same parameter as in eq 3 finally δqf was estimated as the difference between total runoff change δqtot and δqc 3 results 3 1 trends in climatic and hydrological variables using sen s slope estimators we assessed long term trends in climatic and hydrological variables fig 3 no significant trends in annual precipitation were detected in either watershed p greater than 0 10 fig 3a annual runoff decreased during the period of 1981 to 2018 in both watersheds with a significant decreasing trend in the mesilinka p 0 10 while insignificant in the osilinka fig 3b however rrs decreased significantly by the same rate of 0 002 yr 1 in the osilinka p 0 074 and mesilinka p 0 012 over the entire study period fig 3c meanwhile the trend analysis suggests air temperatures increased significantly in the study watersheds from 1981 to 2018 with the annual mean air temperature rising by 0 027 c yr 1 in the osilinka p 0 078 and 0 025 c yr 1 in the mesilinka p 0 083 fig 3d similar significantly upward trends were also detected in maximum tmax and minimum tmin temperatures fig 3e and 3f pet increased insignificantly from 1981 to 2018 fig 3g while the ratios of snowfall to precipitation had limited changes during the study period fig 3h by use of the pettitt test no significant change point was found in these climatic and hydrological variables trend analyses and breakpoint tests in p pet and the ratio of snowfall to precipitation confirmed that there are insignificant trends and no breakpoints during the entire study period which suggest that climate variability did not affect stationarity in annual runoff slater et al 2021 3 2 cross correlations between cumulative forest disturbances and annual runoff the arima model structures of ceca and annual runoff and the results of cross correlation tests are shown in table 2 cross correlation tests suggest that ceca significantly p 0 05 decreased annual q with a 0 year lag in the osilinka and the lag of 4 years in the mesilinka highlighting that cumulative forest disturbances significantly caused reductions of annual runoff in the study watersheds and that the largest effects of forest disturbance on runoff may not be immediately evident in the mesilinka 3 3 changes in runoff ratios mann whitney u tests indicate rrs in the disturbance periods were significantly p 0 10 different from those in the reference periods in both watersheds fig 4 during the reference period 1981 to 2003 the average rr was 0 71 in the osilinka fig 4a and 0 57 in the mesilinka fig 4b following the cumulative forest disturbances rr dropped to 0 67 in the osilinka and 0 52 in the mesilinka in the disturbance period from 2004 to 2018 the significantly lower rr in the disturbance period is consistent with the results from the cross correlation tests presented in section 3 2 3 4 responses of annual runoff to cumulative forest disturbances and climatic variability during the entire disturbance period 2004 2018 annual runoff δqtot declined by 41 7 mm in the osilinka and 43 7 mm in the mesilinka compared with the reference period table 3 the mdmcs clearly show that cumulative forest disturbances since 2004 decreased annual runoff in both the study watersheds fig 5 cumulative forest disturbances decreased annual runoff δqf mdmc by 36 1 and 29 7 mm in the osilinka and mesilinka respectively table 3 while climate variability played a similar role in annual runoff variations δqc mdmc with annual runoff decreasing by 5 6 mm in the osilinka and 14 0 mm in the mesilinka the same direction of both cumulative forest disturbance and climate variability demonstrates that both drivers additively reduced annual runoff the sensitivity based method reveals similar results as those from the mdmcs table 3 the changes in climate variables pet and p led to 3 6 and 11 8 mm declines in annual runoff δqc sen in the osilinka and mesilinka respectively while the corresponding runoff variations induced by cumulative forest disturbances δqf sen were 38 1 and 31 9 mm the results from the sensitivity based approach also suggest an additive decline in annual runoff caused by cumulative forest disturbances and climate variability during the entire disturbance period we further assessed the dynamic responses of annual runoff to cumulative forest disturbances since there were extreme wildfires in 2014 we divided the entire disturbance period into 2004 2013 and 2014 2018 from 2004 to 2013 annual runoff diminished considerably through cumulative forest disturbances with the averaged from two methods δqf of 45 5 mm in the osilinka δqf mdmc 45 0 mm and δqf sen 46 0 mm and 38 5 mm in the mesilinka δqf mdmc 37 8 mm and δqf sen 39 1 mm during 2014 and 2018 cumulative forest disturbances still decreased annual runoff but the magnitudes became smaller the mdmcs show that annual runoff decreased by 18 2 and 13 4 mm in the osilinka and mesilinka respectively while 22 2 and 17 4 mm reductions were identified from the sensitivity based approach respectively table 3 due to cumulative forest disturbances the smaller annual runoff reduction in the period of 2014 2018 might be due to the increasing effects of wildfires on runoff in this period 4 discussion 4 1 decreasing effects of cumulative forest disturbances on annual runoff the changes or trends in annual runoff observations q in two watersheds fig 3b provide some useful information about general trends but they do not give any information about causation this is why time series cross correlation analysis was applied our results from cross correlations mann whitney u tests and the analyses of the relative contributions the mdmcs and the sensitivity based approach all consistently show that cumulative forest disturbances significantly decreased annual runoff in both study watersheds figs 4 5 and tables 2 3 this conclusion contradicts the general conclusion in forest hydrological studies that forest disturbances normally increase annual runoff brown et al 2005 li et al 2017 zhang et al 2017a zhou et al 2015 nevertheless some recent studies have also found that non stand replacing disturbances e g insect infestation tree die off and drought related mortality reduced annual runoff bart et al 2016 slinski et al 2016 for instance biederman et al 2015 evaluated annual mean flow responses to bark beetle infestation induced tree die off in eight catchments in the colorado river basin and found that annual mean flows in the darling creek keystone gulch and red sandstone creek catchments significantly declined following bark beetle driven forest die off they believe that the declines were due to increasing snow sublimation transpiration of surviving trees and evaporation from the sub canopy biederman et al 2014 bennett et al 2018 applied the variable infiltration capacity vic hydrological model to estimate evapotranspiration and runoff responses to multiple climate scenario induced forest disturbances in the san juan river basin usa and indicated that runoff was 6 11 lower with climate driven forest disturbances they attribute flow reductions to the depletion of soil moisture due to higher soil evaporation and transpiration under climate induced forest disturbance these contrasting findings indicate complicated and diverse hydrological responses to cumulative forest disturbances from 2004 to 2013 cumulative forest disturbances were dominated by mpb infestation the surviving trees the overstory trees that are not susceptible to mpb and young trees in the understory have an important effect on post infestation hydrological partitioning the decreased annual runoff caused by cumulative forest disturbances in these boreal watersheds could be explained by the following reasons firstly increasing air temperature and energy input can prolong the growing season of unaffected boreal forests resulting in increments in evapotranspiration and decrements in annual runoff tao et al 2014 we found that air temperatures tmean tmax and tmin significantly increased in both watersheds fig 3d 3f increasing temperatures can augment pet which is a key factor for forest growth promoting a longer growing season for the overstory trees that are not susceptible to mpb they consume more water during the prolonged growing season and consequently greater actual evapotranspiration is expected and less annual runoff is observed secondly transpiration of surviving trees after mpb infestation recovers much faster than expected mcewen et al 2020 conducted tree core analysis in mpb affected forests in the northern interior of bc and indicated that carbon storage of surviving lodgepole pine recovered from mpb infestation in 11 years which is much faster than recovery after harvesting finally the decreased runoff may imply that understory evapotranspiration gains as well as a rapid growth response of survived overstory trees probably resulting from the sublimation of snowpack and increased transpiration of the surviving vegetation bennett et al 2018 biederman et al 2014 goeking and tarboton 2020 after pine needlefall due to the large mpb infestation in the osilinka and mesilinka beginning around 2004 more water and energy e g solar radiation wind speed and momentum reaching the surface and the increased transfer of sensible and latent heat are available for surviving vegetation growth and regeneration the young trees in the understory exhibit competitive release and consume a large amount of water for faster growth resulting in greater understory evapotranspiration bart et al 2016 confirmed that rapid regeneration of the understory can significantly increase transpiration and total evapotranspiration and consequently decrease annual runoff in addition increased soil evaporation after mpb infestation could also partially offset overstory transpiration reductions reed et al 2018 our analysis shows that annual runoff responses to cumulative forest disturbances were dynamic and variable over the study period the reductions in annual runoff were quite considerable between 2004 and 2013 while the values were smaller from 2014 to 2018 table 3 the smaller values of annual runoff reduction from 2014 to 2018 were likely due to the increasing effects of the large scale wildfires on annual runoff which partially offset the decreasing hydrological effects of cumulative forest disturbances of which mpb infestation was dominant the increasing impacts of wildfire on runoff have been widely recognized for example caldwell et al 2020 estimated impacts of large scale wildfires in 2016 on hydrological processes in the southern appalachian mountains usa and found that wildfires increased annual runoff with 39 higher annual runoff amount being examined in burned regions than unburned areas hallema et al 2018 revealed that high severity burns can yield greater impacts on hydrological processes such as producing higher runoff than low or moderate severity fires the individual effects of wildfires in 2014 on annual runoff are likely to be positive due to the removal of forest stands overall the increasing effects of wildfire would partially offset the decreasing effects of mpb infestation and consequently led to smaller reduction in the period of 2014 to 2018 wildfire and mpb dominated period our finding highlights that annual runoff responses to cumulative forest disturbances are varied and dynamic 4 2 additive decreasing effects of cumulative forest disturbances and climate variability in the osilinka and mesilinka watersheds cumulative forest disturbances and climate variability additively decreased runoff during the entire disturbance period 2004 2018 here additive means that both cumulative forest disturbances and climate variability decrease annual runoff it does not imply a simple additive relationship between the two drivers additive effects of forest change and climate variability on runoff have been observed in other studies such as yu et al 2019 which found that gradual forest change and climate variability simultaneously increased runoff in a forested watershed in northeastern china in a global assessment 40 of 67 case studies exhibited additive declines due to climate and forest change and 11 of 67 noted additive augmentations li et al 2017 our results suggest that the effects of climate variability on runoff are varied and never consistent changes in annual pet and p δpet and δp in table 3 are indicators of climate variability which can contribute to changes in annual runoff δqc during the entire disturbance period 2004 2018 minor changes in precipitation were identified in the osilinka δp 0 3 mm and mesilinka δp 5 4 mm while pet values in the disturbance period were 11 2 and 11 6 mm higher than the reference period pet in the osilinka and mesilinka respectively table 3 the increased pet due to increasing air temperatures fig 3d 3f results in runoff reductions i e the decreased δqc specifically we found that climate variability played a different role in runoff δqc in two sub disturbance periods which suggests that changes in precipitation δp dominate δqc with the consistent increasing pet playing a secondary role from 2004 to 2013 annual precipitation was 19 7 and 13 3 mm higher in the osilinka and mesilinka compared with the reference period respectively coupled with the effect of pet and p the averaged from two methods δqc values were estimated as 14 9 and 7 1 mm in the osilinka and mesilinka respectively in comparison annual precipitation largely decreased by 38 6 mm in the osilinka and 42 8 mm in the mesilinka from 2014 to 2018 table 3 resulting in the averaged δqc of 43 9 and 52 8 mm in the osilinka and mesilinka respectively these results suggest that the effects of climate variability on runoff are varied and never consistent nevertheless the effects of cumulative forest disturbances on annual runoff were negative in terms of decreasing effects in all three periods despite varied effects caused by climatic variability in the study watershed additionally berghuijs et al 2014 indicated that in cold watersheds with significant winter snowfall precipitation during winter seasons is gradually shifting from snow towards rain due to a warming climate which can decrease runoff persistently however our study did not identify significant changes in the snow to precipitation partitioning during the study period fig 3h from 2004 to 2013 climate variability and cumulative forest disturbances showed the contrasted impact directions on runoff table 3 numerous studies have confirmed that climate variability and forest disturbances have offsetting due to contrasted impact direction effects on runoff variations in forested watersheds zhang et al 2017b in li et al s 2017 meta data analysis 16 of 67 studies indicated an offsetting impact of forest change and climate variability zhang and wei 2012 found forest disturbances increased annual mean flow while climate variability decreased flow in the baker creek watershed in the central bc interior resulting in limited changes in annual runoff the offsetting effects of these two drivers can stabilize water resources and buffer changes in runoff khoi and suetsugi 2014 as climate fluctuates annually the impacts of climate on annual flow can be positive or negative and thus the hydrological effects between climate and forest disturbance can be additive or offsetting either one having important implications for runoff 4 3 uncertainty and implications for management and future studies one possible uncertainty needs discussing here according to the remote sensing based land cover images there is permanent snowpack in the west of the watersheds persistent increasing temperatures could increase the melting of permanent snowpack and consequently augment annual runoff however the portions of permanent snowpack are very small 0 5 in both watersheds and their impacts on our analysis and conclusion are expected to be minor instead considering possible increased melting from permanent snowpack would even reinforce our conclusion as the significantly reduced streamflow caused by cumulative forest disturbance was still detected after its offsetting the possible streamflow increasing from the melting our main finding that cumulative forest disturbances decreased annual runoff in two boreal forested watersheds in the bc northern interior is contrasted with major findings in the southern and central interior of bc li et al 2018 zhang et al 2017b these contrasted conclusions demonstrated that forest and watershed management for water provision and coping with environmental hazards such as floods and droughts must be planned and designed according to the regional ecosystem context in addition forest disturbances will likely be more frequent and intensive under future climate change impacts in the northern regional forested watersheds of bc if the additive declines in runoff are intensified in the future they would likely elevate pressures on water supply aquatic habitats and reservoir management in the region thus special attention should be paid to the interactions between future forest disturbance and climate change as they have significant implications for future water supply flow regimes and aquatic functions the dynamic responses of annual runoff to cumulative forest disturbances demonstrate that net hydrological responses are largely dependent on interplays of multiple types of disturbance and post disturbance forest dynamics over time future studies should pay attention to the differences in the immediate impacts and post disturbance forest dynamics among these disturbance types in the cold northern forest region these studies should elucidate mechanisms by which hydrological impacts caused by cumulative forest disturbances are governed in addition future studies should pay attention to how cumulative forest disturbances and climate affect hydrology at shorter time intervals e g sub annual seasonal with inclusion of possible permanent snowpack to better understand interactions among them 5 conclusions the effects of cumulative forest disturbances on hydrology are rarely evaluated in boreal forested watersheds from this study we conclude that cumulative forest disturbances overall decreased annual runoff this major finding is contrasted with the previously well accepted conclusion that forest disturbances generally increase runoff we also conclude both cumulative forest disturbance and climate variability played an additively declined role in annual runoff during the entire disturbance period our study suggests that hydrological responses to cumulative forest disturbances are dynamic and complicated and more research is needed to assess the differences in hydrological impacts and recoveries among various types of forest disturbance so that the hydrological effects of cumulative forest disturbances can be better understood in the study region credit authorship contribution statement yiping hou conceptualization methodology investigation formal analysis writing original draft data curation xiaohua wei conceptualization methodology writing review editing funding acquisition supervision project administration margot vore writing review editing data curation resources stephen j déry project administration writing review editing resources tom pypker project administration writing review editing resources krysta giles hansen data curation methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors thank the china scholarship council csc for sponsoring yiping hou we appreciate dr mingfang zhang university of electronic science and technology of china for constructive suggestions in improving the manuscript we would also like to thank the editor dr sally e thompson the associate editor dr giulia vico and two anonymous reviewers for their constructive comments and suggestions on this paper this work is supported by the interior university research coalition iurc through its tri university disaster pr3 collaborative grant program grant no f19 00283 
3777,in relatively large forested watersheds different types of forest disturbances such as timber harvesting wildfire and insect infestation often cumulatively and interactively affect runoff there is a general lack of studies examining cumulative hydrological impacts caused by different types of forest disturbance particularly in boreal forested watersheds in this study we evaluated the impacts of cumulative forest disturbances timber harvesting mountain pine beetle mpb infestation and wildfire on annual runoff in two large forested watersheds situated in the boreal northern interior of british columbia bc canada the study period was divided into the reference period of 1981 to 2003 and the disturbance period of 2004 to 2018 time series analysis cross correlation was used to determine the statistical relationship between cumulative forest disturbances and annual runoff while two quantification methods including the modified double mass curve mdmc and a sensitivity based technique were applied to separate the effects of cumulative forest disturbances and climate variability to annual runoff surprisingly our results contradict the well accepted conclusion that annual runoff increases with forest disturbances we found that cumulative forest disturbances overall decreased annual runoff in the study watersheds with varied reductions depending on severities of dominated disturbance types and post disturbance forest dynamics our results also revealed that both cumulative forest disturbance and climate variability played an additive role in decreasing annual runoff during the entire disturbance period these results provide valuable implications for supporting water management in boreal forested watersheds in the context of the warming climate keywords cumulative forest disturbances dynamic responses annual runoff climate variability additive effects boreal forests 1 introduction the hydrological effects of forest disturbances e g harvesting wildfire insect infestation have long been studied for various forest types climate and hydrological regimes hallema et al 2018 li et al 2017 zhang et al 2017a zhang and wei 2021 a common conclusion is that forest disturbances increase annual runoff because forest removal reduces canopy interception loss and transpiration bosch and hewlett 1982 brown et al 2005 stednick 1996 however there are some inconsistent findings such as no significant change or declines in annual runoff caused by non stand replacing forest disturbances goeking and tarboton 2020 nevertheless the relationship between forest disturbances and hydrology continues to receive growing attention worldwide due to more frequent and severe forest disturbances induced by climate change impacts e g recent catastrophic fires in australia and the united states in 2020 and their significant consequences e g flood hazards after catastrophic fires adams et al 2020 robinne et al 2021 for relatively large landscapes forest disturbances are cumulative over space and time as are their hydrological effects the effects of cumulative forest disturbances on hydrology are likely dependent on the severities of individual forest disturbance types and post disturbance vegetation dynamics for example stand replacing disturbances e g forest harvesting and high severity wildfires can directly remove entire forest stands and compact soil surfaces by ground based machinery or produce hydrophobic soil resulting in abruptly increased annual runoff caldwell et al 2020 moore et al 2020 in contrast non stand replacing disturbances e g insect infestation and tree die off often produce gradual changes in forest structures and consequently induce variable and gradual hydrological responses goeking and tarboton 2020 a good example is mountain pine beetle mpb infestations that often move through phases of initial attack green phase tree death when the trees turn red red phase and a period where the needles fall off the tree grey phase followed by regrowth of surviving trees and saplings mcewen et al 2020 winkler et al 2010 redding et al 2008 cumulative forest disturbances refer to the addition of multiple disturbance types over space and or accumulation of the same disturbance type repeating over time scherer 2011 although the effects of individual forest disturbance types on hydrology have been extensively studied much less research assesses cumulative forest disturbances over large watersheds or landscapes and their hydrological impacts as our planning and management scales often operate across larger geographic areas such research is critically needed forest disturbance and climate variability are commonly viewed as two dominating drivers that affect watershed scale hydrological processes in forested watersheds de niel and willems 2019 zhang et al 2017b li et al 2018 existing studies have demonstrated that the hydrological responses are determined by the magnitude and direction of each driver giles hansen et al 2019 li et al 2018 yu et al 2019 to explicitly evaluate cumulative forest disturbance impacts on watershed hydrology any climatic influence on hydrological variables must be quantitatively separated or accounted for in the past decade various techniques have been developed for such a separation dey and mishra 2017 aryal and zhu 2020 including the modified double mass curve wei and zhang 2010 sensitivity based methods zhang et al 2011 temporal trend analyses biederman et al 2015 and the tomer schilling framework tomer and schilling 2009 wei et al 2013 provided a summary on various separation techniques and recommended a combined approach of two or more techniques for a more robust assessment british columbia bc canada which is largely covered by forests experiences a large number of disturbances and therefore requires an improved understanding of hydrological responses to changes in forests each year an average of 77 million m3 of forests is harvested in bc with more than 70 occurring in the bc interior environmental reporting bc 2018 since the late 1990 s a large proportion of forests in the bc interior have been attacked by mpb as a result of climate change since warm winters are more favorable for the survival of beetles dhar et al 2016 as of 2008 mpb had attacked approximately 14 5 million hectares of forests in the bc interior leading to the loss of forested lands forest ecosystem services e g carbon sequestration and associated hydrological functioning e g flood control redding et al 2008 in addition there were several extreme wildfire seasons in bc over the past ten years in 2014 alone 1455 wildfires were recorded burning more than 360 000 ha of the province government of british columbia 2014 the severe cumulative forest disturbances in the bc interior highlight a unique research opportunity to assess how cumulative forest disturbances affect hydrology in this study we investigated annual runoff responses to cumulative forest disturbances in two large boreal forested watersheds osilinka and mesilinka located in the northern interior of bc we aimed to answer two scientific questions 1 how did annual runoff respond to cumulative forest disturbances in two large boreal forested watersheds and 2 what were the relative contributions of climate variability and cumulative forest disturbances to annual runoff variations we selected two watersheds located in headwater systems of the williston reservoir the largest reservoir in bc to explore these questions in the hopes the results from this study could also directly support the sustainable management of downstream water resources 2 materials and methods 2 1 study watersheds the osilinka and mesilinka two large boreal forested watersheds with gauged areas of 1950 and 3060 km2 respectively are located in the peace river basin in the northern interior of bc fig 1 these rivers flow into the williston reservoir that spans 1770 km2 which is managed by the provincial utility bc hydro for hydroelectricity power generation at the 2730 mw wac bennett dam and the 694 mw peace canyon dam both watersheds have experienced high levels of cumulative forest disturbances with more than 20 area being affected as of 2018 watershed elevations range from 810 to 2435 m above sea level asl in the osilinka and from 723 to 2407 m asl in the mesilinka with the mean elevations of 1394 and 1410 m asl respectively table 1 both watersheds are predominantly covered by engelmann spruce subalpine fir essf and boreal white and black spruce bwbs biogeoclimatic zones with the dominant tree species being lodgepole pine which is the most abundant species in these watersheds that is attacked by mpb winkler et al 2010 during the entire study period from 1981 to 2018 both watersheds experienced cold climates with mean annual air temperatures of 1 8 and 2 2 c in the osilinka and mesilinka respectively table 1 mean annual precipitation p in these two northern watersheds is about 800 mm with intra annual distributions of precipitation being relatively even snowfall represents more than 50 of the annual precipitation leading to a considerable freshet in spring due to snow melting both watersheds can be classified as energy limited systems with the dryness index a ratio of potential evapotranspiration to precipitation being 1 0 creed et al 2014 2 2 data era5 land is a global reanalysis dataset released by the european centre for medium range weather forecasts muñoz sabater 2019 the product derives from data assimilation algorithms combining forecasts with available observations to estimate different climatic variables more than 50 climatic variables are estimated in the era5 land dataset from 1981 present with a spatial resolution of 0 1 9 km in this study mean tmean maximum tmax and minimum tmin air temperatures snowfall and precipitation at the monthly scale were collected from the era5 land climate dataset monthly variables during the entire hydrological year october to september were summed or averaged as annual variables in addition a temperature based potential evapotranspiration pet estimation method the hargreaves equation was used to calculate watershed pet at the annual scale eq 1 hargreaves and samani 1985 1 pet 0 0023 r a t max t min 2 17 8 t max t min 0 5 where ra is the extraterrestrial radiation and tmin and tmax are the minimum and maximum temperatures c daily discharges were acquired from water survey of canada station ids 07ec004 for the osilinka river and 07ec003 for the mesilinka river annual discharges m3 s 1 were converted into runoff depths with the unit of mm according to the drainage area between 1981 and 2018 mean annual runoff q was 573 mm in the osilinka and 460 mm in the mesilinka table 1 mean runoff ratio rr is defined as the ratio of annual runoff to annual precipitation indicating the runoff production ability of precipitation rr was higher in the osilinka with the value of 0 69 while the corresponding value in the mesilinka was 0 55 table 1 two provincial level databases the vegetation resource inventory vri and the consolidated cutblocks databases were obtained from the british columbia ministry of forests lands natural resources operations and rural development flnrord https catalogue data gov bc ca dataset the vri database version 2019 provides detailed information on tree characteristics disturbance type and year up to 2018 but logging records are incomplete in the vri database to fill in the missing harvesting data in the vri we used the consolidated cutblocks database version 2019 which summarizes logging information up to the end of 2018 from bc ministry of flnrord as submitted by forestry companies it contains complete records of forest harvest size location and logging period by combining the vri and consolidated cutblocks databases we generated complete and comprehensive long term records of forest disturbance history within our watersheds 2 3 methods 2 3 1 estimating cumulative forest disturbances and defining disturbance periods there are three major forest disturbance types in the interior of bc harvesting mpb infestation and wildfire these forest disturbances occur cumulatively varying over space and time to assess the hydrological effects of these cumulative forest disturbances we used the cumulative equivalent clear cut area ceca as a cumulative forest disturbance proxy which captures different disturbances over space and time and accounts for post disturbance recoveries due to forest regeneration giles hansen et al 2021 lewis and huggard 2010 vore et al 2020 the equivalent clear cut area eca of each disturbance type defined as the area that has been clear cut burned and insect infested with a reduction factor eca coefficient to account for hydrological recovery due to forest regeneration was calculated prior to ceca estimations winkler and boon 2017 once the annual eca for each disturbance type is estimated the values are summed to calculate the ceca of the watershed eca estimations of harvested and burned forests are different from those of mpb infestation logging and wildfires produce abrupt changes by removing forest stands while mpb often leads to partial mortality of overstory with surviving vegetation remaining intact as such different eca coefficients were assigned to reflect these differences between disparate disturbance types zhang and wei 2012 for example if all trees in a stand are burned or harvested with all stands being removed the eca coefficient is assigned to be 100 in the second year with its subsequent values being decreased according to years of recovery in contrast if all trees in a stand are affected by mpb the values of eca coefficients in the following years increase during green red and grey phases and then decrease with regeneration time the osilinka and mesilinka watersheds were essentially undisturbed before 1983 and 1975 respectively fig 2 low levels of logging were recorded during the entire study period with the maximum logging ceca 6 in both watersheds fig 2a and 2b forests have been largely and intensively attacked by mpb since 2004 fig 2c and 2d with ceca caused by mpb infestation near 12 by the end of 2018 in addition there was also an extreme wildfire season in 2014 when 5 4 and 15 9 of the watershed s areas were burned in the osilinka and mesilinka respectively vore et al 2020 in 2014 alone ceca increased by 4 9 in the osilinka and 11 9 in the mesilinka due to the wildfire at the end of the study period 2018 ceca due to wildfire reached 8 5 in the osilinka and 12 0 in the mesilinka in sum ceca increased considerably since 2004 and reached 24 6 and 25 7 in the osilinka and mesilinka respectively in 2018 after analyzing the forest disturbance history of the two watersheds the whole study period was divided into the reference period from 1981 to 2003 and the disturbance period between 2004 and 2018 during the reference period the maximum ceca was only 6 and 3 in the osilinka and mesilinka respectively while the ceca dramatically increased by 18 6 in the osilinka and 22 7 in the mesilinka during the disturbance period 2 3 2 detecting trends in climatic and hydrological variables trend analysis has been widely used to identify the significance of temporal trends in hydrometeorological data providing potential evidence to understand the dynamics of hydrological variations beck et al 2013 in this study sen s slope estimator was calculated da silva et al 2015 jehanzaib et al 2020 and the p value of the slope was examined to identify the possible significance of temporal trends in hydrological and climatic variables p q rr tmean tmax tmin pet and the ratio of snowfall to precipitation the trend package in r was used to summarize sen s slopes and their p values r core team 2020 in this study long term trends during the entire study period 1981 2018 were examined the significance of this two tailed test was assessed at α 0 10 level we selected a significance level of 0 10 in the trend analysis to identify potential trends since the study period spans only 38 years 2 3 3 identifying cross correlation relationships to identify whether cumulative forest disturbances represented by ceca can significantly affect annual runoff time series cross correlation was employed in comparison to traditional correlation tests e g kendall and spearman tests cross correlation can further determine causal relationships and lagged effects between tested variables podobnik and stanley 2008 for the watersheds the effects of cumulative forest disturbances on annual runoff may not be significant in the disturbed year but the effects could be significant in the subsequent years suggesting the lagged effects of cumulative forest disturbances the major advantage of cross correlation analysis is that it can identify lagged causality between two data series ceca and annual runoff to conduct cross correlation tests autocorrelations in the selected variables need to be accounted for if there are autocorrelations arima autoregressive integrated moving average models are built to remove autocorrelations and the stationary residuals are further used to conduct cross correlation analysis in this study arima models of ceca and annual runoff were individually constructed and then cross correlations were tested between their residuals arima model constructions and cross correlation tests were conducted in r r core team 2020 2 3 4 comparing runoff ratios runoff ratio rr calculated as the ratio of annual runoff to annual precipitation can be used to interpret cumulative forest disturbance impacts on runoff guardiola claramonte et al 2011 in this study rr values were compared between the reference and disturbance periods using the nonparametric mann whitney u test mann and whitney 1947 the mann whitney u test has been widely used in hydrological studies to detect the significant differences between variables or periods because the test is insensitive to the distribution type of data samples aryal and zhu 2020 the assumption of the mann whitney u test is that the samples should be independent thus we tested the independence of rr series by computing autocorrelation functions and confirmed that there is no autocorrelation suggesting that the rr series are independent 2 3 5 quantifying annual runoff responses to cumulative forest disturbances in this study we aimed at quantifying cumulative forest disturbance impacts on annual runoff by separating the relative influence of cumulative forest disturbances and climatic variability to annual runoff a change in annual runoff between the reference and disturbance periods can be evaluated as 2 δ q tot q dis q ref where δqtot is the total change in annual runoff mm qdis and qref are the observed annual runoff mm in the disturbance and reference periods once the total change in annual runoff was determined as above two robust methods the modified double mass curve mdmc and the sensitivity based approach were performed to separate the relative influence of cumulative forest disturbances δqf and climatic variability δqc on runoff on the annual basis the mdmc developed by wei and zhang 2010 combines both graphical and statistical analyses to separate the effects of forest disturbances and climatic variability on annual runoff in a single watershed the technique has been successfully applied in various watersheds in canada and china giles hansen et al 2019 hou et al 2021 li et al 2018 liu et al 2015 zhang et al 2017b a general assumption of mdmc is that accumulated climate variability has a near linear effect on accumulated annual runoff if cumulative forest disturbances play a limited role to check the possible issue of stationarity in climate data which could affect stationarity in annual runoff non parametric trend analysis and breakpoint test on critical climate variables p pet and the ratio of snowfall to precipitation were applied if cumulative forest disturbances have significant impacts on accumulated annual runoff the curve would deviate from the baseline different from the traditional double mass curve the x axis of the mdmc refers to the accumulated effective precipitation pae i e the difference between precipitation and predicted evapotranspiration and represents an integrated index of climate variability while the y axis represents the accumulated annual runoff qa the predicted evapotranspiration etp was computed using fu s budyko equation eq 3 fu 1981 yang et al 2007 indicating the contribution of climate variability the w parameter in eq 3 for each watershed was derived according to water balance in the reference period and the derived w was further used in the sensitivity based approach since the effect of climate variability would be consistent during the disturbance period a linear regression model was created using pae and qa from the reference period and applied to simulate qa in the disturbance period represented as qap according to the disturbance pae the differences between qa and qap in the disturbance period were identified as the accumulated annual runoff responses to cumulative forest disturbances δqaf with annual values for both cumulative forest disturbance δqf and climate effects δqc being quantified accordingly eqs 4 5 more detailed descriptions of the mdmc method can be found in wei and zhang 2010 3 et p p 1 p e t p 1 p e t p w 1 w 4 δ q af q a q ap 5 δ q c δ q tot δ q f where etp denotes the predicted annual evapotranspiration mm pet is annual potential evapotranspiration mm estimated from eq 1 p is annual precipitation mm and w is the watershed property parameter qa and qap are the observed and predicted accumulated annual runoff mm and δqf and δqc represent the annual runoff response to cumulative forest disturbances and climate variability mm respectively the second quantification method the sensitivity based approach was also applied to estimate the annual runoff responses to climate variability and cumulative forest disturbances during the disturbance period lv et al 2019 the sensitivity based method assumes that annual runoff responses to climate variability are mainly determined by changes in annual pet and p wei et al 2013 thus δqc can be evaluated as 6 δ q c β δ p γ δ p e t where δp and δpet denote the change in annual p and pet mm during the disturbance period and β and γ are sensitivity coefficients of p and pet which are computed from eqs 7 8 7 β 1 p e t p w 1 w 1 8 γ 1 p p e t w 1 w 1 1 where w is the same parameter as in eq 3 finally δqf was estimated as the difference between total runoff change δqtot and δqc 3 results 3 1 trends in climatic and hydrological variables using sen s slope estimators we assessed long term trends in climatic and hydrological variables fig 3 no significant trends in annual precipitation were detected in either watershed p greater than 0 10 fig 3a annual runoff decreased during the period of 1981 to 2018 in both watersheds with a significant decreasing trend in the mesilinka p 0 10 while insignificant in the osilinka fig 3b however rrs decreased significantly by the same rate of 0 002 yr 1 in the osilinka p 0 074 and mesilinka p 0 012 over the entire study period fig 3c meanwhile the trend analysis suggests air temperatures increased significantly in the study watersheds from 1981 to 2018 with the annual mean air temperature rising by 0 027 c yr 1 in the osilinka p 0 078 and 0 025 c yr 1 in the mesilinka p 0 083 fig 3d similar significantly upward trends were also detected in maximum tmax and minimum tmin temperatures fig 3e and 3f pet increased insignificantly from 1981 to 2018 fig 3g while the ratios of snowfall to precipitation had limited changes during the study period fig 3h by use of the pettitt test no significant change point was found in these climatic and hydrological variables trend analyses and breakpoint tests in p pet and the ratio of snowfall to precipitation confirmed that there are insignificant trends and no breakpoints during the entire study period which suggest that climate variability did not affect stationarity in annual runoff slater et al 2021 3 2 cross correlations between cumulative forest disturbances and annual runoff the arima model structures of ceca and annual runoff and the results of cross correlation tests are shown in table 2 cross correlation tests suggest that ceca significantly p 0 05 decreased annual q with a 0 year lag in the osilinka and the lag of 4 years in the mesilinka highlighting that cumulative forest disturbances significantly caused reductions of annual runoff in the study watersheds and that the largest effects of forest disturbance on runoff may not be immediately evident in the mesilinka 3 3 changes in runoff ratios mann whitney u tests indicate rrs in the disturbance periods were significantly p 0 10 different from those in the reference periods in both watersheds fig 4 during the reference period 1981 to 2003 the average rr was 0 71 in the osilinka fig 4a and 0 57 in the mesilinka fig 4b following the cumulative forest disturbances rr dropped to 0 67 in the osilinka and 0 52 in the mesilinka in the disturbance period from 2004 to 2018 the significantly lower rr in the disturbance period is consistent with the results from the cross correlation tests presented in section 3 2 3 4 responses of annual runoff to cumulative forest disturbances and climatic variability during the entire disturbance period 2004 2018 annual runoff δqtot declined by 41 7 mm in the osilinka and 43 7 mm in the mesilinka compared with the reference period table 3 the mdmcs clearly show that cumulative forest disturbances since 2004 decreased annual runoff in both the study watersheds fig 5 cumulative forest disturbances decreased annual runoff δqf mdmc by 36 1 and 29 7 mm in the osilinka and mesilinka respectively table 3 while climate variability played a similar role in annual runoff variations δqc mdmc with annual runoff decreasing by 5 6 mm in the osilinka and 14 0 mm in the mesilinka the same direction of both cumulative forest disturbance and climate variability demonstrates that both drivers additively reduced annual runoff the sensitivity based method reveals similar results as those from the mdmcs table 3 the changes in climate variables pet and p led to 3 6 and 11 8 mm declines in annual runoff δqc sen in the osilinka and mesilinka respectively while the corresponding runoff variations induced by cumulative forest disturbances δqf sen were 38 1 and 31 9 mm the results from the sensitivity based approach also suggest an additive decline in annual runoff caused by cumulative forest disturbances and climate variability during the entire disturbance period we further assessed the dynamic responses of annual runoff to cumulative forest disturbances since there were extreme wildfires in 2014 we divided the entire disturbance period into 2004 2013 and 2014 2018 from 2004 to 2013 annual runoff diminished considerably through cumulative forest disturbances with the averaged from two methods δqf of 45 5 mm in the osilinka δqf mdmc 45 0 mm and δqf sen 46 0 mm and 38 5 mm in the mesilinka δqf mdmc 37 8 mm and δqf sen 39 1 mm during 2014 and 2018 cumulative forest disturbances still decreased annual runoff but the magnitudes became smaller the mdmcs show that annual runoff decreased by 18 2 and 13 4 mm in the osilinka and mesilinka respectively while 22 2 and 17 4 mm reductions were identified from the sensitivity based approach respectively table 3 due to cumulative forest disturbances the smaller annual runoff reduction in the period of 2014 2018 might be due to the increasing effects of wildfires on runoff in this period 4 discussion 4 1 decreasing effects of cumulative forest disturbances on annual runoff the changes or trends in annual runoff observations q in two watersheds fig 3b provide some useful information about general trends but they do not give any information about causation this is why time series cross correlation analysis was applied our results from cross correlations mann whitney u tests and the analyses of the relative contributions the mdmcs and the sensitivity based approach all consistently show that cumulative forest disturbances significantly decreased annual runoff in both study watersheds figs 4 5 and tables 2 3 this conclusion contradicts the general conclusion in forest hydrological studies that forest disturbances normally increase annual runoff brown et al 2005 li et al 2017 zhang et al 2017a zhou et al 2015 nevertheless some recent studies have also found that non stand replacing disturbances e g insect infestation tree die off and drought related mortality reduced annual runoff bart et al 2016 slinski et al 2016 for instance biederman et al 2015 evaluated annual mean flow responses to bark beetle infestation induced tree die off in eight catchments in the colorado river basin and found that annual mean flows in the darling creek keystone gulch and red sandstone creek catchments significantly declined following bark beetle driven forest die off they believe that the declines were due to increasing snow sublimation transpiration of surviving trees and evaporation from the sub canopy biederman et al 2014 bennett et al 2018 applied the variable infiltration capacity vic hydrological model to estimate evapotranspiration and runoff responses to multiple climate scenario induced forest disturbances in the san juan river basin usa and indicated that runoff was 6 11 lower with climate driven forest disturbances they attribute flow reductions to the depletion of soil moisture due to higher soil evaporation and transpiration under climate induced forest disturbance these contrasting findings indicate complicated and diverse hydrological responses to cumulative forest disturbances from 2004 to 2013 cumulative forest disturbances were dominated by mpb infestation the surviving trees the overstory trees that are not susceptible to mpb and young trees in the understory have an important effect on post infestation hydrological partitioning the decreased annual runoff caused by cumulative forest disturbances in these boreal watersheds could be explained by the following reasons firstly increasing air temperature and energy input can prolong the growing season of unaffected boreal forests resulting in increments in evapotranspiration and decrements in annual runoff tao et al 2014 we found that air temperatures tmean tmax and tmin significantly increased in both watersheds fig 3d 3f increasing temperatures can augment pet which is a key factor for forest growth promoting a longer growing season for the overstory trees that are not susceptible to mpb they consume more water during the prolonged growing season and consequently greater actual evapotranspiration is expected and less annual runoff is observed secondly transpiration of surviving trees after mpb infestation recovers much faster than expected mcewen et al 2020 conducted tree core analysis in mpb affected forests in the northern interior of bc and indicated that carbon storage of surviving lodgepole pine recovered from mpb infestation in 11 years which is much faster than recovery after harvesting finally the decreased runoff may imply that understory evapotranspiration gains as well as a rapid growth response of survived overstory trees probably resulting from the sublimation of snowpack and increased transpiration of the surviving vegetation bennett et al 2018 biederman et al 2014 goeking and tarboton 2020 after pine needlefall due to the large mpb infestation in the osilinka and mesilinka beginning around 2004 more water and energy e g solar radiation wind speed and momentum reaching the surface and the increased transfer of sensible and latent heat are available for surviving vegetation growth and regeneration the young trees in the understory exhibit competitive release and consume a large amount of water for faster growth resulting in greater understory evapotranspiration bart et al 2016 confirmed that rapid regeneration of the understory can significantly increase transpiration and total evapotranspiration and consequently decrease annual runoff in addition increased soil evaporation after mpb infestation could also partially offset overstory transpiration reductions reed et al 2018 our analysis shows that annual runoff responses to cumulative forest disturbances were dynamic and variable over the study period the reductions in annual runoff were quite considerable between 2004 and 2013 while the values were smaller from 2014 to 2018 table 3 the smaller values of annual runoff reduction from 2014 to 2018 were likely due to the increasing effects of the large scale wildfires on annual runoff which partially offset the decreasing hydrological effects of cumulative forest disturbances of which mpb infestation was dominant the increasing impacts of wildfire on runoff have been widely recognized for example caldwell et al 2020 estimated impacts of large scale wildfires in 2016 on hydrological processes in the southern appalachian mountains usa and found that wildfires increased annual runoff with 39 higher annual runoff amount being examined in burned regions than unburned areas hallema et al 2018 revealed that high severity burns can yield greater impacts on hydrological processes such as producing higher runoff than low or moderate severity fires the individual effects of wildfires in 2014 on annual runoff are likely to be positive due to the removal of forest stands overall the increasing effects of wildfire would partially offset the decreasing effects of mpb infestation and consequently led to smaller reduction in the period of 2014 to 2018 wildfire and mpb dominated period our finding highlights that annual runoff responses to cumulative forest disturbances are varied and dynamic 4 2 additive decreasing effects of cumulative forest disturbances and climate variability in the osilinka and mesilinka watersheds cumulative forest disturbances and climate variability additively decreased runoff during the entire disturbance period 2004 2018 here additive means that both cumulative forest disturbances and climate variability decrease annual runoff it does not imply a simple additive relationship between the two drivers additive effects of forest change and climate variability on runoff have been observed in other studies such as yu et al 2019 which found that gradual forest change and climate variability simultaneously increased runoff in a forested watershed in northeastern china in a global assessment 40 of 67 case studies exhibited additive declines due to climate and forest change and 11 of 67 noted additive augmentations li et al 2017 our results suggest that the effects of climate variability on runoff are varied and never consistent changes in annual pet and p δpet and δp in table 3 are indicators of climate variability which can contribute to changes in annual runoff δqc during the entire disturbance period 2004 2018 minor changes in precipitation were identified in the osilinka δp 0 3 mm and mesilinka δp 5 4 mm while pet values in the disturbance period were 11 2 and 11 6 mm higher than the reference period pet in the osilinka and mesilinka respectively table 3 the increased pet due to increasing air temperatures fig 3d 3f results in runoff reductions i e the decreased δqc specifically we found that climate variability played a different role in runoff δqc in two sub disturbance periods which suggests that changes in precipitation δp dominate δqc with the consistent increasing pet playing a secondary role from 2004 to 2013 annual precipitation was 19 7 and 13 3 mm higher in the osilinka and mesilinka compared with the reference period respectively coupled with the effect of pet and p the averaged from two methods δqc values were estimated as 14 9 and 7 1 mm in the osilinka and mesilinka respectively in comparison annual precipitation largely decreased by 38 6 mm in the osilinka and 42 8 mm in the mesilinka from 2014 to 2018 table 3 resulting in the averaged δqc of 43 9 and 52 8 mm in the osilinka and mesilinka respectively these results suggest that the effects of climate variability on runoff are varied and never consistent nevertheless the effects of cumulative forest disturbances on annual runoff were negative in terms of decreasing effects in all three periods despite varied effects caused by climatic variability in the study watershed additionally berghuijs et al 2014 indicated that in cold watersheds with significant winter snowfall precipitation during winter seasons is gradually shifting from snow towards rain due to a warming climate which can decrease runoff persistently however our study did not identify significant changes in the snow to precipitation partitioning during the study period fig 3h from 2004 to 2013 climate variability and cumulative forest disturbances showed the contrasted impact directions on runoff table 3 numerous studies have confirmed that climate variability and forest disturbances have offsetting due to contrasted impact direction effects on runoff variations in forested watersheds zhang et al 2017b in li et al s 2017 meta data analysis 16 of 67 studies indicated an offsetting impact of forest change and climate variability zhang and wei 2012 found forest disturbances increased annual mean flow while climate variability decreased flow in the baker creek watershed in the central bc interior resulting in limited changes in annual runoff the offsetting effects of these two drivers can stabilize water resources and buffer changes in runoff khoi and suetsugi 2014 as climate fluctuates annually the impacts of climate on annual flow can be positive or negative and thus the hydrological effects between climate and forest disturbance can be additive or offsetting either one having important implications for runoff 4 3 uncertainty and implications for management and future studies one possible uncertainty needs discussing here according to the remote sensing based land cover images there is permanent snowpack in the west of the watersheds persistent increasing temperatures could increase the melting of permanent snowpack and consequently augment annual runoff however the portions of permanent snowpack are very small 0 5 in both watersheds and their impacts on our analysis and conclusion are expected to be minor instead considering possible increased melting from permanent snowpack would even reinforce our conclusion as the significantly reduced streamflow caused by cumulative forest disturbance was still detected after its offsetting the possible streamflow increasing from the melting our main finding that cumulative forest disturbances decreased annual runoff in two boreal forested watersheds in the bc northern interior is contrasted with major findings in the southern and central interior of bc li et al 2018 zhang et al 2017b these contrasted conclusions demonstrated that forest and watershed management for water provision and coping with environmental hazards such as floods and droughts must be planned and designed according to the regional ecosystem context in addition forest disturbances will likely be more frequent and intensive under future climate change impacts in the northern regional forested watersheds of bc if the additive declines in runoff are intensified in the future they would likely elevate pressures on water supply aquatic habitats and reservoir management in the region thus special attention should be paid to the interactions between future forest disturbance and climate change as they have significant implications for future water supply flow regimes and aquatic functions the dynamic responses of annual runoff to cumulative forest disturbances demonstrate that net hydrological responses are largely dependent on interplays of multiple types of disturbance and post disturbance forest dynamics over time future studies should pay attention to the differences in the immediate impacts and post disturbance forest dynamics among these disturbance types in the cold northern forest region these studies should elucidate mechanisms by which hydrological impacts caused by cumulative forest disturbances are governed in addition future studies should pay attention to how cumulative forest disturbances and climate affect hydrology at shorter time intervals e g sub annual seasonal with inclusion of possible permanent snowpack to better understand interactions among them 5 conclusions the effects of cumulative forest disturbances on hydrology are rarely evaluated in boreal forested watersheds from this study we conclude that cumulative forest disturbances overall decreased annual runoff this major finding is contrasted with the previously well accepted conclusion that forest disturbances generally increase runoff we also conclude both cumulative forest disturbance and climate variability played an additively declined role in annual runoff during the entire disturbance period our study suggests that hydrological responses to cumulative forest disturbances are dynamic and complicated and more research is needed to assess the differences in hydrological impacts and recoveries among various types of forest disturbance so that the hydrological effects of cumulative forest disturbances can be better understood in the study region credit authorship contribution statement yiping hou conceptualization methodology investigation formal analysis writing original draft data curation xiaohua wei conceptualization methodology writing review editing funding acquisition supervision project administration margot vore writing review editing data curation resources stephen j déry project administration writing review editing resources tom pypker project administration writing review editing resources krysta giles hansen data curation methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors thank the china scholarship council csc for sponsoring yiping hou we appreciate dr mingfang zhang university of electronic science and technology of china for constructive suggestions in improving the manuscript we would also like to thank the editor dr sally e thompson the associate editor dr giulia vico and two anonymous reviewers for their constructive comments and suggestions on this paper this work is supported by the interior university research coalition iurc through its tri university disaster pr3 collaborative grant program grant no f19 00283 
3778,soil moisture is a critical variable for evaluating water movement in hillslope hydrology to understand its temporal response patterns via statistical distribution time series of soil moisture spatial distributions were collected for nine months along a steep montane hillside in this study a novel synthesized probability density function was introduced to accurately describe the soil moisture variability in conjunction with controls the optimal number of componential distribution model was determined using hidden markov model hmm a univariate hmm captured the profile development of latent soil moisture states as well as the transitional probabilities between regression and switch patterns that were useful for categorizing soil moisture variability corresponding to hydrological processes the deeper and lower the locations in the hillslope the greater the complexity in soil moisture latent states indicating a higher number of flow paths both seasonal and event based soil moisture variations were adequately characterized through the identification of latent soil moisture states the impact of environmental factors on soil moisture was evaluated via a comparative analysis of multivariate hmm and principle component analysis revealing that the controlling factors were related to the context of seasonal and spatial variability as well as wetting and drying periods during rainfall event keywords soil moisture hidden markov model principle component analysis hillslope hydrology control factors 1 introduction the spatiotemporal variation of soil moisture is an important factor of hillslope hydrology not only for understanding the hydrological processes and flow paths of runoff but for landslide prediction as well vereecken et al 2013 shen et al 2016 liao et al 2017 dari et al 2019 lee and kim 2020 both the climate vegetation soil interactions and the hydrological connectivity between the soil layers determine soil moisture variability at the hillslope scale tromp van meerveld and mcdonnell 2006 mcguire and mcdonnell 2010 guo et al 2014 tromp van meerveld et al 2015 the inter or auto relationship between historical soil moisture data can be described in both time and frequency domains via probability density functions pdfs temporal stability analyses seasonality and serial correlations lee and hornberger 2006 vereecken et al 2013 gao et al 2015 kim 2016 ghannam et al 2016 whereas controls of soil moisture variability can be explained through various environmental factors such as terrain soil texture and vegetation hu et al 2017 gwak and kim 2017 liang et al 2017 yang et al 2017 the sufficient characterization of soil moisture variability is necessary for designing an optimal monitoring network e g appropriate selection of representative measurement points and can be further utilized for remote sensing analyses singh et al 2019 soil moisture pdfs have been analyzed for a single designated location across a monitoring period or by assessing spatial distributions at specific times vereecken et al 2013 dralle and thompson 2016 further identification of latent states in soil moisture time series either in situ or remotely sensed data has been explored teuling et al 2005 lee and hornberger 2006 daly et al 2009 vivoni et al 2010 li et al 2013 vilasa et al 2017 soil moisture status has been described as either dry or wet according to bimodal pdfs for daily and monthly datasets teuling et al 2005 lee and hornberger 2006 indeed several statistical distributions have been used to describe soil moisture pdfs indicating either bi or multi modal distributions ryu and famiglietti 2005 herbst et al 2009 penna et al 2009 existing bimodal approximations of soil moisture time series variability can be insufficient for capturing the complexity of seasonal hydrological processes runoff generation and hillslope stability lee and kim 2019 wicki et al 2020 therefore a relaxation of soil moisture pdf using optimum numbers of statistical distribution can be a useful approach for realistic identification of hidden latent status and its process configuration in the present study a time series of in situ soil moisture data was acquired to identify previously unknown factors controlling the states of soil moisture variability accordingly the spatial distribution of soil moisture was analyzed via pdf and its relationship was interpreted in the context of environmental factor distribution such elaboration of horizontal and vertical soil moisture pdfs according to seasonality enabled the characterization of the controlling hydrological and environmental factors as a result an appropriate modeling approach was put forth for the simultaneous consideration of spatiotemporal variability with respect to latent state configuration to this end a hidden markov model hmm was introduced to characterize the soil moisture variability under the assumption that the serially dependent observations can be conditionally modeled via a number of unobserved states as hmms have been applied in downscaling various spatial soil moisture and rainfall datasets and for detecting hydrologic regime features and for substituting seasonal variability for spatial datasets mehrotra and sharma 2005 gelati et al 2010 bracken et al 2014 these models have been shown to successfully estimate the number of latent soil moisture states while efficiently optimizing the spatiotemporal distribution of time series data due to their serial dependence and autocorrelation korres et al 2015 burns et al 2016 kwon et al 2018 jacobs et al 2020 kim et al 2020 in this study we systematically apply hmm to measure dataset to address two research questions as follows 1 how can the multi modal pdf feature of soil moisture datasets be optimized and seasonally characterized in terms of soil moisture latent status and transition along hillslope transects 2 what are the most important environmental factors controlling the soil moisture redistribution and what is the corresponding interpretations for seasonal and event based variability these answers will provide useful insight for modeling of hillslope hydrological processes and the controlling processes of soil moisture distribution useful for understanding water flux drivers of unsaturated zones over both the short event based response and long term seasonal response 2 materials and methods 2 1 study area a steep hillslope was selected at the headwaters of the sulmachun watershed of the imjin river in northwestern south korea an integrated hydrologic monitoring system was used for recording parameters such as streamflow soil tension and soil moisture as well as eco hydrometeorological variables including rainfall evapotranspiration relative humidity and solar radiation across fig 1 eco hydrometeorological measurements were obtained in 30 min intervals at a flux tower located 50 m from the study area the average annual evaporation and rainfall over the last five years was 393 and 1 067 mm respectively with 70 of the annual rainfall concentrated between june and august during the asian monsoon season the refined digital elevation models dems 0 5 m surface and subsurface resolution were obtained through field survey using a theodolite dt 208p topcon japan in addition to direct measurement of soil depth with tapes and poles the terrain slope and elevation of the hillslope ranged from 11 to 27 and 200 260 m above sea level respectively leptosols were the primary surface soil type and cambisols were found at depth the dominant soil textures were loamy sand and sandy loam with a mean bulk density of 1 36 g cm 3 and porosity between 25 and 49 the hillslope primarily consisted of gneiss composites underlain by granite bedrock with negligible fracture development soil layer depth ranged between 25 and 95 cm and vegetation consisted of a mixture of polemoniales shrubby quercus and a coniferous canopy of pinus densiflora the leaf area index lai obtained with a lai 2000 li cor usa ranged between 0 98 and 1 06 for november and 2 98 3 97 for may 2 2 data acquisition the spatial distribution of saturation tendency was approximated via digital terrain analysis beven and kirkby 1979 one of multiple flow direction algorithms md multiple direction for infinity seibert and mcglynn 2007 was applied to the surface and subsurface dems for the upslope contributing area and the topographic wetness index twi was calculated accordingly the soil moisture monitoring locations fig 1 were determined according to the twi values along two transects a buriable waveguide length 20 cm diameter 0 3 cm was inserted parallel to the surface at three depths 10 30 60 cm in 13 of the 19 measuring sites and two depths 10 30 cm in the six sites for monitoring surface and subsurface soil multiplex minitrase soilmoisture equipment corp usa were used for soil moisture signal detection and time series data recording spatiotemporal variability of soil moisture was recorded in two hour intervals between march 26 and december 8 2016 and it was converted into daily interval for analysis a tipping bucket rain gauge te525mm campbell scientific inc usa was installed near the central point of the hillslope and rainfall data were collected every 10 min from april to early december 2016 fig 1 rainfall data were converted into two hours averages the soil texture properties twi contributing area ca surface slope slp aspect asp soil depth sd and distance to stream ds for all measuring sites are presented in table 1 2 3 hmm assuming the stochastic structure of soil moisture observations can be represented by a first order of autoregressive process lai 1978 the markov model can be a useful platform to efficiently characterize soil moisture time series a series of soil moisture state can be delineated through the application of hmm to soil moisture observations the hmm consisted of two parts an unobserved parameter process of latent states q t t 1 2 t to follow the markov process as ρ q t q t 1 q t 2 q t n and a state dependent process of observations sm t t 1 2 t where the distribution of soil moisture sm t depends only on the current state q t not the previous states or observations as p sm t q t the markov chains for q t have m states and sm t is an m state hmm a standard hmm for time series data λ can be characterized by the four components λ m π a b where m is the number of latent states π is the initial state distribution a is the transition probability matrix associated with the latent states and b is the probability distribution associated with the observation events zucchini et al 2016 a standard univariate first order hmm can be described as 1 π π i p q i i w i t h 1 i m 2 a a ij p q t j q t 1 i w i t h 1 i j m 3 b b i s m t ρ sm t s m q t i w i t h 1 i m if the observation probability distribution is a finite mixture with a normal distribution the observation distributions can be approximated with the mean μ i and standard deviation σ i as 4 b i sm t 1 2 π σ i e x p sm t μ i 2 2 σ i 2 if the soil moisture were collected in multiple locations as a vectored time series the multivariate hmm mhmm can be applied to a sequence of vectors as multivariate observations s m t sm 1 t sm 2 t sm s t for measuring points s at time t of a markov chain with a sequence of latent states accordingly a normally distributed finite mixture with k components were used for the observation probability distribution of the soil moisture time series s m t according to eq 5 5 b i s m t q t i k 1 k c ik n o r m a l μ ik σ ik where c ik μ ik and σ ik are the mixture coefficient mean vector and covariance matrix for the k th mixture component at state i respectively and c ik satisfies the stochastic constraints k 1 k c ik 1 and c ik 0 for all stations and latent states the multivariate normally distributed hmm can be approximated as follows 6 n o r m a l μ ik σ ik 1 2 π s 2 σ ik 1 2 e x p 0 5 s m t μ ik σ ik 1 s m t μ ik the construction of the hmm was performed under a multistate modeling platform in r v0 6 3 jackson 2019 all parameters were optimized through maximizing the direct likelihood function ρ s m t λ the probability of the optimal latent sequence ρ q s m t λ was estimated according to the observation sequence and hmm as solved via the viterbi algorithm zucchini et al 2016 2 4 principal component regression in this study the impact of various environmental factors to soil moisture redistribution can be comprehensively investigated through modeling study of mhmm and principle component analysis pca pca is a statistical method for reducing the dimensionality of multivariate datasets via projecting a multi dimensional data matrix onto the linearly uncorrelated lower dimensions while minimizing dataset variance principal components pcs can be identified through the linear combinations of variables with sufficient variance covariance explanatory power the pc matrix y of the spatiotemporal soil moisture s m t distribution matrix at site s and time t can be obtained through kth linear combinations as y 1 l 11 sm 1 l 21 sm 2 l s 1 sm s l 1 s m t 7 y k l 1 k sm 1 l 2 k sm 2 l sk sm s l k s m t where s m i is a vector with a dimension as 1 t and l i is the coefficient vector with dimensions s 1 the kth linear combinations for pcs can be simplified as follows 8 y y 1 y 2 y k l 1 s m t l 2 s m t l k s m t l 1 l 2 l k s m t l s m t where y has the dimension of k t and l is the linear coefficient matrix with dimension of s k therefore a dimensionality reduction of the soil moisture spatial distribution was achieved by projecting the s dimensional dataset onto the k dimensional basis two conditional requirements for determining pcs were present that the pc represents a linear combination with the maximum variance explained as 9 max α v a r i a n c e y i max α l i σ l i where the vector of l i with constraints of l i 1 and the relationship between pairwise pcs is uncorrelated as follows 10 c o v a r i a n c e y i y j l i σ l j 0 where σ is the covariance of s m t the 1st pc is selected as the linear combination of the coefficient vector with the maximum possible variance explained the 2nd pc is selected under the same criteria among the remaining combinations uncorrelated to the 1st pc principal component regression pcr employed the pcs as the dependent variables and the spatial distribution of environmental factors as the independent variables to identify the predominant controlling factors of spatiotemporal soil moisture variation 3 results and discussion to apply the hmm on a soil moisture time series we identified stochastic characteristics in the entire soil moisture dataset and then extracted the latent states from univariate soil moisture time series analysis furthermore multivariate soil moisture analysis was performed to characterize multi modality depending on the spatial distribution of soil moisture which was then compared with the spatial distribution of environmental factors to provide explanations for hillslope hydrological processes 3 1 soil moisture distribution in time figure 2 shows the autoregressive ar coefficients obtained from modeling soil moisture time series for all sites fitness of delineated models were checked through the χ 2 residual test with all residuals satisfying the white noise assumption most models were ar 1 except for several sites located in the downslope area b8 c1 c5 and c6 with longer memory effects due to the subsurface lateral flow from upslope kim 2016 even complicated models in downslope locations showed higher parameter estimates for the ar 1 term than at higher orders since the markov process can be assumed for series maintaining a significant ar 1 process the stochastic characterization of soil moisture can be adequately approximated by the first order markov model lai 1978 the pdfs of the soil moisture time series for each site were fit to one of four statistical distributions normal lognormal gamma and weibull using a kolmogorov smirnov test table 2 however none of these statistical distributions could effectively describe soil moisture pdfs indicating multi modal characteristics in the soil moisture response therefore a hartigan s dip test was employed to check for multi modality significance as the majority of soil moisture pdfs expressed multi model features they can be best described through combining pdfs of multiple states the degree and frequency of multi modality tended to increase in downslope areas and at deeper depths table 2 as had been partially shown for the hydrometric transit time in a previous study kim 2014 accordingly the greater the number of flow paths and corresponding higher complexity of the soil moisture response in downslope indicated that multiple pdfs were better suited for capturing the patterns observed 3 2 univariate hmm the stochastic feature of soil moisture time series can be investigated through the identification of latent soil moisture states the most important latent states for explaining the soil moisture dataset were explored via a univariate hmm uhmm a normalized distribution was selected as the foundation for multi modal soil moisture pdfs i e multi modal distributions were identified by a combination of multiple normal distributions with distinct means and variance to identify the best model in terms of accuracy and parsimony the model maintaining the smallest bayesian information criterion bic with latent soil moisture states between two and 10 was selected figure 3 a shows the bic distributions of various uhmms at site a2 and depths of 10 30 and 60 cm where the minimum latent status number were 4 5 and 5 respectively normalized pdfs for each latent state and histograms from datasets are presented in fig 3 b d for depths of 10 30 and 60 cm respectively accordingly the multi modal features of the datasets were better captured through combinations of optimum uhmms rather than those with traditional binary distributions of dry or wet state at site a2 fig 3 e shows bic distribution at sit c6 indicating increasing trend of minimum bic for deeper depth 4 5 6 for depths in 10 30 and 60 cm pdf fittings of optimized multiple normal distributions also indicate better finesses than those for dry and wet status fittings fig 3 f h a similar procedure was applied to all study sites and the selected number of latent soil moisture states ranged between four and eight fig 4 notably greater than the traditional two latent soil moisture states wet and dry reported in previous studies teuling et al 2005 lee and hornberger 2006 thus the soil moisture variation pattern can be further characterized and categorized by several additional states the average number of latent soil moisture states across all sites was 6 1 and increased with depth 10 30 and 60 cm averages were 5 7 6 3 and 6 5 respectively and similar increasing trend of multi modal pdf was reported for soil moisture in a previous study li et al 2013 these findings were consistent with the results of hartigan s dip test that multi modality was more pronounced at depth table 2 the increasing pattern of latent soil moisture states in uhmm at deeper depths can be explained by more complex hydrological processes at deeper depth than those for shallower point van schaik et al 2008 kim et al 2014 zhu et al 2014 the inter state transition uhmm probability matrix held two transitional patterns a switch pattern which changed into other states and a regression pattern which changed back to the original state and the average probabilities for each pattern were calculated for the uhmm with four latent soil moisture states four regression and 12 switch probabilities were generated the corresponding probabilities of uhmm for all soil moisture measurements were expressed as 84 7 and 3 3 for regression and switch patterns respectively it was thus concluded that soil moisture variability tended to maintain the range of origin pattern and shifted to other patterns that were less common the probability ratios of soil moisture at each depth are shown in fig 4 specifically the mean of probability of the regression pattern increased with depth whereas that of the switch pattern decreased along the depth profile the decreased soil moisture variability at depth fig 4 may be explained via the decreased direct effects of hydrometeorological drivers e g rainfall and evapotranspiration at deeper depth he et al 2012 liu et al 2017 lee and kim 2019 3 3 multivariate hmm vertical and lateral distribution the soil moisture responses in the depth profile or lateral distribution can interact due to connectivity by vertical or lateral flow at a hillslope scale the mhmm was applied to the soil moisture dataset across multiple sites examining both vertical profiles and lateral spatial distribution table 3 the number of latent soil moisture states in the mhmm for vertical soil moisture data was equal to or greater 7 9 than those across lateral space 5 7 implying that there were comparatively more patterns of markov processes for vertical soil moisture profiles accordingly the heterogeneity among soil moisture variation according to depth was relatively higher than that of lateral variation gwak et al 2017 the daily oscillation of evaporative flux introduced substantial interactions along the vertical profile lee and kim 2019 wang et al 2021 considering infiltration and exfiltration along the vertical profile modeling with multiple soil moisture measurement depths can provide a useful perspective for process identification the modeled number of latent soil moisture states for the 13 study sites varied between seven and nine table 3 as the estimated number of latent soil moisture states in the mhmms along the vertical profile table 3 were greater than those in the uhmms fig 4 it can be concluded that the interaction across soil moisture depth may be more important than the interactions from univariate features for the determination of soil moisture status and probability distribution identification e g number of latent soil moisture states and patterns figure 5 a presents the time series of soil moisture profiles for site a2 upslope and its latent state distribution table 3 during 2016 a combination of seven latent soil moisture states represented the temporal response features of soil moisture at site a2 the distribution of latent soil moisture states in late june and august showed similar recession features of soil moisture variation the abrupt increase in the number of latent soil moisture states correlated with big rainfall events were also similar except for those in early spring and late autumn and the increasing soil moisture observed in late may and late july displayed different latent state distributions as well furthermore the increasing soil moisture recorded in october showed unique recession latent patterns when compared to all other seasons time series of soil moisture and latent distributions at site c6 downslope indicated a slower recession and diminished peak response with more complicated latent state distributions fig 5b the similar recession patterns between late june and august held a higher number of latent soil moisture states than those at a2 similarities in soil moisture variability between both upslope and downslope locations can be seen in the period following late october when no rainfall input was received the higher number of latent soil moisture states and greater heterogeneity observed at site c6 can be explained by the greater number of flow paths such as lateral subsurface flow heading toward the downslope direction kim 2014 the temporal distribution of latent soil moisture states indicated the transition of soil moisture for rainfall events and its seasonal response pattern fig 6 a and b presents the variation of latent soil moisture states from spring to autumn along transects a and b and both distributions from hilltop to downslope appeared different except for the late autumn the number of latent soil moisture states was greatest in the downslope sites for both transects and the frequency of latent state shifts substantially increased downslope as well e g a6 and b8 showed very high frequency response patterns this further supported that the complexity of soil moisture recharge tended to increase downslope due to the higher number of flow paths as one approached the stream generation point however the similarity in latent state distributions between adjacent locations was low indicating the wetness along transects can vary although always increasing downslope fig 6 a and b display that existing lumped models e g three or four reservoir models of hillslope hydrologic response behavior substantially simplified the complicated features of soil moisture variability 3 4 environmental factors and soil moisture by pcr the controlling environmental factors of soil moisture distribution are important to understand for characterization of hillslope hydrological processes and landslide prevention pca was performed to identify the primary mechanisms behind spatiotemporal distribution of soil moisture tromp van meerveld and mcdonnell 2006 perry and niemann 2008 the pearson correlation coefficient was used to identify the relationship between soil moisture distribution and the pcs by season the pcs varied in space and by sd as well as with fine scale temporal shifts during rainfall and the subsequent recession period perry and niemann 2008 korres et al 2010 gwak and kim 2017 based on the latent soil moisture states from the mhmm pca was applied table 4 presents the proportions of variance explained by the pcs across all latent soil moisture states and depths the variation explained by the 1st pc ranged 80 4 98 4 and the 1st and 2nd pc sum was 90 across all latent soil moisture states the proportion of variance explained by the 1st pc tended to increase with depth indicating a greater impact of soil environmental drivers and decreased effects of climatic factors the relationship between the spatial distribution of the 1st pc and the environmental factors was investigated and table 6 presents the pearson correlation coefficients of the 1st pc across all latent soil moisture states and depths the spatial distribution of soil texture percent sand clay and silt was important at 10 cm depth whereas significant positive relationships were found for topographic attributes e g twi and ca and a significant negative relationship with sd was identified at depths of 30 and 60 cm the overall impact of sd was more pronounced at 60 cm the 10 cm results seen in table 5 can likely be explained by the decreased sand and increased silt contents providing higher soil moisture retention thus the greater the hydraulic conductivity the less soil tension can create the conditions for vertical drainage to greater depths indeed significant soil moisture relationships between sand and silt at the soil surface have been previously documented korres et al 2010 baroni et al 2013 hu et al 2017 gwak and kim 2017 the significant impacts of twi and ca occasionally appeared at 30 cm depth where the impacts of surface and the bedrock boundary were minimized this means that daily soil moisture movement was strongly associated with matrix flow slow rather than pipe flow or boundary flow fast flows along the surface and bedrock layer the stronger correlations of twi and ca at states 1 and 2 table 5 coincided with the relatively low mean soil moisture contents 8 1 and 10 2 at 30 cm depth table 6 implying that the higher correlations between soil moisture and terrain based attributes can be more apparent under relatively dry conditions kaiser and mcglynn 2018 the negative correlations of sd can likely be explained by the increased moisture and decreased soil layer thickness above due to the vertical recharge across shallower soil regolith 3 5 seasonal latent soil moisture states the frequency of monthly latent soil moisture states and the statistics obtained from the mhmms are presented in table 6 the total rainfall 977 5 mm was primarily concentrated in april may july and october the greater the amount of rainfall amo the higher the number of latent soil moisture states across all depths indicating that precipitation was the primary driver of observed soil moisture variability the monthly frequencies at 10 cm depth indicated that states 3 5 6 and 7 existed in the spring and autumn and states 6 and 7 held the most explanatory power for soil moisture variability during rainfall events between june and september the rainy season features fell either in state 1 or 2 state 4 was a distinctive feature observed in the autumn at 10 cm depth found only between october and december at 30 cm depth the dominant latent soil moisture states during spring and early autumn were states 4 5 and 6 whereas states 1 2 and 3 were predominant in the rainy season between june and august distributions of latent soil moisture states at 60 cm depth indicated that states 3 4 and 5 represented the features of spring and autumn while states 1 and 2 best represented the rainy season features state 7 at 10 cm and state 1 at 30 cm held the highest means per depth appearing solely during in rainy days 100 but a similar feature at 60 cm was not observed accordingly the dominant control of precipitation appears to be limited at a depth between 30 and 60 cm while multiple states were observed in the spring states 3 5 and 6 at 10 cm and states 4 5 and 6 at 30 cm the latent state distributions for the autumn were state 4 at 10 cm state 5 at 30 cm and states 3 and 4 at 60 cm depth mainly occurring between october and december the mean soil moisture values at each of the three depths were 11 7 13 7 and 14 5 respectively almost identical to the means of normal distribution for state 3 at 10 cm state 4 at 30 cm and state 3 at 60 cm thus the composition of latent soil moisture states was unique for the spring rainy and autumn seasons the means across the entire period at each depth were also obtained they may serve as useful references of hillslope soil moisture patterning these seasonal distributions indicated that the delineated latent soil moisture states obtained from the mhmms are useful for the classification and characterization of seasonal soil moisture response patterns which were further confirmed by the apparent distinction of two dry seasons spring and autumn hydrologic behavior has been approximated using several storage based models at a hillslope scale loritz et al 2017 fan et al 2019 the performance of a physically based model can be substantially improved if the spatially and temporally varied water storage feature obtained in this study is properly implemented into the model structure gao et al 2014 gharari et al 2015 furthermore the identification of temporal and spatial variation in critical soil moisture can be important in the prediction of rainfall landslide at the hillslope scale onda et al 2004 fan et al 2016 3 6 soil moisture control and seasonal hydrological processes the seasonality of soil moisture control factors can be identified through the comparative analysis of tables 5 and 6 for states 6 and 7 the combination of soil texture and asp were dominant during the spring and the impact of soil texture alone controlled the autumn at 10 cm depths states 3 and 4 whereas both texture and asp were important under wet conditions rainfall and soil texture alone was dominant during periods of moderate wetness immediately after rainfall asp was the dominant factor during dry conditions post recession periods mcmillan and srinivasan 2015 chen et al 2019 the controlling environmental factors at 30 cm depth were distinct combinations of twi ca and sd were primary factors during spring states 5 and 6 stronger impacts of terrain attributes and sd controls states 1 2 4 and 5 were revealed during rainy season and state 5 was the dominant process during late autumn at 60 cm the primary spring factor was sd states 3 4 and 5 and the rainy season was governed by dual controls twi and sd states 1 and 2 with the effects of sd becoming stronger in late autumn states 3 and 4 sd was predominant under wet condition rainfall while both twi and sd were important during relatively dry conditions recession while the infiltration along the vertical profile was important across all seasons the impact of twi was greater during the recession period indicating the development of storm flow in the subsurface layers further the increased impacts of twi and ca during the dry post recession period can likely be explained by the assumption of redistribution under steady flow for twi beven and kirkby 1979 the impact of rainfall was most pronounced for states 6 and 7 states 6 and 7 and states 4 and 5 at 10 30 and 60 cm depths respectively this implies that the important environmental factors during rainfall events were soil texture and as at 10 cm depth and sd at 30 and 60 cm depths the significance of terrain based attributes appeared most pronounced under relatively dry conditions states 1 and 2 at 30 cm depth and states 1 and 2 at 60 cm depth the complete redistribution of soil water in hillslope regolith was thus more correlated with terrain based indices twi or ca liang et al 2017 kaiser and mcglynn 2018 4 conclusion the pdfs of soil moisture for different hillslope location were characterized through a combination of statistical distributions here time series analysis indicated that the hmm can be used to delineate multiple statuses and processes dependent upon sd and transect location the optimum combination of uhmms provided a superior representation of multi modal soil moisture features than traditional approaches based on wet and dry statuses both regression and switched patterns from a probability matrix of hmms were used to improve process based understanding of soil moisture variation and interactions between soil moisture across vertical profiles and lateral distribution were highlighted through mhmms to explain seasonal soil moisture variability according to their dominant latent soil moisture states the controlling factors of soil moisture distribution were identified through the integration of multiple hmms and pca depending on sd and season these distinct factors were obtained via a mhmm of spatiotemporal soil moisture data and its correlation to latent soil moisture states associated with environmental factors variations of the dominant environmental factors demonstrated that while local factors such as soil texture and aspect were important at shallower depths the impact of global domain factors such as upslope ca and twi were stronger at depth during period of rainfall and its subsequent recession credit authorship contribution statement eunhyung lee data curation methodology software sanghyun kim conceptualization validation visualization writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements authors would like to express a sincere appreciation for reviewers and editorial board of journal of hydrology funding this work was supported by the basic research program 2016r1d1a1b02008137 of the national research foundation from republic of korea 
3778,soil moisture is a critical variable for evaluating water movement in hillslope hydrology to understand its temporal response patterns via statistical distribution time series of soil moisture spatial distributions were collected for nine months along a steep montane hillside in this study a novel synthesized probability density function was introduced to accurately describe the soil moisture variability in conjunction with controls the optimal number of componential distribution model was determined using hidden markov model hmm a univariate hmm captured the profile development of latent soil moisture states as well as the transitional probabilities between regression and switch patterns that were useful for categorizing soil moisture variability corresponding to hydrological processes the deeper and lower the locations in the hillslope the greater the complexity in soil moisture latent states indicating a higher number of flow paths both seasonal and event based soil moisture variations were adequately characterized through the identification of latent soil moisture states the impact of environmental factors on soil moisture was evaluated via a comparative analysis of multivariate hmm and principle component analysis revealing that the controlling factors were related to the context of seasonal and spatial variability as well as wetting and drying periods during rainfall event keywords soil moisture hidden markov model principle component analysis hillslope hydrology control factors 1 introduction the spatiotemporal variation of soil moisture is an important factor of hillslope hydrology not only for understanding the hydrological processes and flow paths of runoff but for landslide prediction as well vereecken et al 2013 shen et al 2016 liao et al 2017 dari et al 2019 lee and kim 2020 both the climate vegetation soil interactions and the hydrological connectivity between the soil layers determine soil moisture variability at the hillslope scale tromp van meerveld and mcdonnell 2006 mcguire and mcdonnell 2010 guo et al 2014 tromp van meerveld et al 2015 the inter or auto relationship between historical soil moisture data can be described in both time and frequency domains via probability density functions pdfs temporal stability analyses seasonality and serial correlations lee and hornberger 2006 vereecken et al 2013 gao et al 2015 kim 2016 ghannam et al 2016 whereas controls of soil moisture variability can be explained through various environmental factors such as terrain soil texture and vegetation hu et al 2017 gwak and kim 2017 liang et al 2017 yang et al 2017 the sufficient characterization of soil moisture variability is necessary for designing an optimal monitoring network e g appropriate selection of representative measurement points and can be further utilized for remote sensing analyses singh et al 2019 soil moisture pdfs have been analyzed for a single designated location across a monitoring period or by assessing spatial distributions at specific times vereecken et al 2013 dralle and thompson 2016 further identification of latent states in soil moisture time series either in situ or remotely sensed data has been explored teuling et al 2005 lee and hornberger 2006 daly et al 2009 vivoni et al 2010 li et al 2013 vilasa et al 2017 soil moisture status has been described as either dry or wet according to bimodal pdfs for daily and monthly datasets teuling et al 2005 lee and hornberger 2006 indeed several statistical distributions have been used to describe soil moisture pdfs indicating either bi or multi modal distributions ryu and famiglietti 2005 herbst et al 2009 penna et al 2009 existing bimodal approximations of soil moisture time series variability can be insufficient for capturing the complexity of seasonal hydrological processes runoff generation and hillslope stability lee and kim 2019 wicki et al 2020 therefore a relaxation of soil moisture pdf using optimum numbers of statistical distribution can be a useful approach for realistic identification of hidden latent status and its process configuration in the present study a time series of in situ soil moisture data was acquired to identify previously unknown factors controlling the states of soil moisture variability accordingly the spatial distribution of soil moisture was analyzed via pdf and its relationship was interpreted in the context of environmental factor distribution such elaboration of horizontal and vertical soil moisture pdfs according to seasonality enabled the characterization of the controlling hydrological and environmental factors as a result an appropriate modeling approach was put forth for the simultaneous consideration of spatiotemporal variability with respect to latent state configuration to this end a hidden markov model hmm was introduced to characterize the soil moisture variability under the assumption that the serially dependent observations can be conditionally modeled via a number of unobserved states as hmms have been applied in downscaling various spatial soil moisture and rainfall datasets and for detecting hydrologic regime features and for substituting seasonal variability for spatial datasets mehrotra and sharma 2005 gelati et al 2010 bracken et al 2014 these models have been shown to successfully estimate the number of latent soil moisture states while efficiently optimizing the spatiotemporal distribution of time series data due to their serial dependence and autocorrelation korres et al 2015 burns et al 2016 kwon et al 2018 jacobs et al 2020 kim et al 2020 in this study we systematically apply hmm to measure dataset to address two research questions as follows 1 how can the multi modal pdf feature of soil moisture datasets be optimized and seasonally characterized in terms of soil moisture latent status and transition along hillslope transects 2 what are the most important environmental factors controlling the soil moisture redistribution and what is the corresponding interpretations for seasonal and event based variability these answers will provide useful insight for modeling of hillslope hydrological processes and the controlling processes of soil moisture distribution useful for understanding water flux drivers of unsaturated zones over both the short event based response and long term seasonal response 2 materials and methods 2 1 study area a steep hillslope was selected at the headwaters of the sulmachun watershed of the imjin river in northwestern south korea an integrated hydrologic monitoring system was used for recording parameters such as streamflow soil tension and soil moisture as well as eco hydrometeorological variables including rainfall evapotranspiration relative humidity and solar radiation across fig 1 eco hydrometeorological measurements were obtained in 30 min intervals at a flux tower located 50 m from the study area the average annual evaporation and rainfall over the last five years was 393 and 1 067 mm respectively with 70 of the annual rainfall concentrated between june and august during the asian monsoon season the refined digital elevation models dems 0 5 m surface and subsurface resolution were obtained through field survey using a theodolite dt 208p topcon japan in addition to direct measurement of soil depth with tapes and poles the terrain slope and elevation of the hillslope ranged from 11 to 27 and 200 260 m above sea level respectively leptosols were the primary surface soil type and cambisols were found at depth the dominant soil textures were loamy sand and sandy loam with a mean bulk density of 1 36 g cm 3 and porosity between 25 and 49 the hillslope primarily consisted of gneiss composites underlain by granite bedrock with negligible fracture development soil layer depth ranged between 25 and 95 cm and vegetation consisted of a mixture of polemoniales shrubby quercus and a coniferous canopy of pinus densiflora the leaf area index lai obtained with a lai 2000 li cor usa ranged between 0 98 and 1 06 for november and 2 98 3 97 for may 2 2 data acquisition the spatial distribution of saturation tendency was approximated via digital terrain analysis beven and kirkby 1979 one of multiple flow direction algorithms md multiple direction for infinity seibert and mcglynn 2007 was applied to the surface and subsurface dems for the upslope contributing area and the topographic wetness index twi was calculated accordingly the soil moisture monitoring locations fig 1 were determined according to the twi values along two transects a buriable waveguide length 20 cm diameter 0 3 cm was inserted parallel to the surface at three depths 10 30 60 cm in 13 of the 19 measuring sites and two depths 10 30 cm in the six sites for monitoring surface and subsurface soil multiplex minitrase soilmoisture equipment corp usa were used for soil moisture signal detection and time series data recording spatiotemporal variability of soil moisture was recorded in two hour intervals between march 26 and december 8 2016 and it was converted into daily interval for analysis a tipping bucket rain gauge te525mm campbell scientific inc usa was installed near the central point of the hillslope and rainfall data were collected every 10 min from april to early december 2016 fig 1 rainfall data were converted into two hours averages the soil texture properties twi contributing area ca surface slope slp aspect asp soil depth sd and distance to stream ds for all measuring sites are presented in table 1 2 3 hmm assuming the stochastic structure of soil moisture observations can be represented by a first order of autoregressive process lai 1978 the markov model can be a useful platform to efficiently characterize soil moisture time series a series of soil moisture state can be delineated through the application of hmm to soil moisture observations the hmm consisted of two parts an unobserved parameter process of latent states q t t 1 2 t to follow the markov process as ρ q t q t 1 q t 2 q t n and a state dependent process of observations sm t t 1 2 t where the distribution of soil moisture sm t depends only on the current state q t not the previous states or observations as p sm t q t the markov chains for q t have m states and sm t is an m state hmm a standard hmm for time series data λ can be characterized by the four components λ m π a b where m is the number of latent states π is the initial state distribution a is the transition probability matrix associated with the latent states and b is the probability distribution associated with the observation events zucchini et al 2016 a standard univariate first order hmm can be described as 1 π π i p q i i w i t h 1 i m 2 a a ij p q t j q t 1 i w i t h 1 i j m 3 b b i s m t ρ sm t s m q t i w i t h 1 i m if the observation probability distribution is a finite mixture with a normal distribution the observation distributions can be approximated with the mean μ i and standard deviation σ i as 4 b i sm t 1 2 π σ i e x p sm t μ i 2 2 σ i 2 if the soil moisture were collected in multiple locations as a vectored time series the multivariate hmm mhmm can be applied to a sequence of vectors as multivariate observations s m t sm 1 t sm 2 t sm s t for measuring points s at time t of a markov chain with a sequence of latent states accordingly a normally distributed finite mixture with k components were used for the observation probability distribution of the soil moisture time series s m t according to eq 5 5 b i s m t q t i k 1 k c ik n o r m a l μ ik σ ik where c ik μ ik and σ ik are the mixture coefficient mean vector and covariance matrix for the k th mixture component at state i respectively and c ik satisfies the stochastic constraints k 1 k c ik 1 and c ik 0 for all stations and latent states the multivariate normally distributed hmm can be approximated as follows 6 n o r m a l μ ik σ ik 1 2 π s 2 σ ik 1 2 e x p 0 5 s m t μ ik σ ik 1 s m t μ ik the construction of the hmm was performed under a multistate modeling platform in r v0 6 3 jackson 2019 all parameters were optimized through maximizing the direct likelihood function ρ s m t λ the probability of the optimal latent sequence ρ q s m t λ was estimated according to the observation sequence and hmm as solved via the viterbi algorithm zucchini et al 2016 2 4 principal component regression in this study the impact of various environmental factors to soil moisture redistribution can be comprehensively investigated through modeling study of mhmm and principle component analysis pca pca is a statistical method for reducing the dimensionality of multivariate datasets via projecting a multi dimensional data matrix onto the linearly uncorrelated lower dimensions while minimizing dataset variance principal components pcs can be identified through the linear combinations of variables with sufficient variance covariance explanatory power the pc matrix y of the spatiotemporal soil moisture s m t distribution matrix at site s and time t can be obtained through kth linear combinations as y 1 l 11 sm 1 l 21 sm 2 l s 1 sm s l 1 s m t 7 y k l 1 k sm 1 l 2 k sm 2 l sk sm s l k s m t where s m i is a vector with a dimension as 1 t and l i is the coefficient vector with dimensions s 1 the kth linear combinations for pcs can be simplified as follows 8 y y 1 y 2 y k l 1 s m t l 2 s m t l k s m t l 1 l 2 l k s m t l s m t where y has the dimension of k t and l is the linear coefficient matrix with dimension of s k therefore a dimensionality reduction of the soil moisture spatial distribution was achieved by projecting the s dimensional dataset onto the k dimensional basis two conditional requirements for determining pcs were present that the pc represents a linear combination with the maximum variance explained as 9 max α v a r i a n c e y i max α l i σ l i where the vector of l i with constraints of l i 1 and the relationship between pairwise pcs is uncorrelated as follows 10 c o v a r i a n c e y i y j l i σ l j 0 where σ is the covariance of s m t the 1st pc is selected as the linear combination of the coefficient vector with the maximum possible variance explained the 2nd pc is selected under the same criteria among the remaining combinations uncorrelated to the 1st pc principal component regression pcr employed the pcs as the dependent variables and the spatial distribution of environmental factors as the independent variables to identify the predominant controlling factors of spatiotemporal soil moisture variation 3 results and discussion to apply the hmm on a soil moisture time series we identified stochastic characteristics in the entire soil moisture dataset and then extracted the latent states from univariate soil moisture time series analysis furthermore multivariate soil moisture analysis was performed to characterize multi modality depending on the spatial distribution of soil moisture which was then compared with the spatial distribution of environmental factors to provide explanations for hillslope hydrological processes 3 1 soil moisture distribution in time figure 2 shows the autoregressive ar coefficients obtained from modeling soil moisture time series for all sites fitness of delineated models were checked through the χ 2 residual test with all residuals satisfying the white noise assumption most models were ar 1 except for several sites located in the downslope area b8 c1 c5 and c6 with longer memory effects due to the subsurface lateral flow from upslope kim 2016 even complicated models in downslope locations showed higher parameter estimates for the ar 1 term than at higher orders since the markov process can be assumed for series maintaining a significant ar 1 process the stochastic characterization of soil moisture can be adequately approximated by the first order markov model lai 1978 the pdfs of the soil moisture time series for each site were fit to one of four statistical distributions normal lognormal gamma and weibull using a kolmogorov smirnov test table 2 however none of these statistical distributions could effectively describe soil moisture pdfs indicating multi modal characteristics in the soil moisture response therefore a hartigan s dip test was employed to check for multi modality significance as the majority of soil moisture pdfs expressed multi model features they can be best described through combining pdfs of multiple states the degree and frequency of multi modality tended to increase in downslope areas and at deeper depths table 2 as had been partially shown for the hydrometric transit time in a previous study kim 2014 accordingly the greater the number of flow paths and corresponding higher complexity of the soil moisture response in downslope indicated that multiple pdfs were better suited for capturing the patterns observed 3 2 univariate hmm the stochastic feature of soil moisture time series can be investigated through the identification of latent soil moisture states the most important latent states for explaining the soil moisture dataset were explored via a univariate hmm uhmm a normalized distribution was selected as the foundation for multi modal soil moisture pdfs i e multi modal distributions were identified by a combination of multiple normal distributions with distinct means and variance to identify the best model in terms of accuracy and parsimony the model maintaining the smallest bayesian information criterion bic with latent soil moisture states between two and 10 was selected figure 3 a shows the bic distributions of various uhmms at site a2 and depths of 10 30 and 60 cm where the minimum latent status number were 4 5 and 5 respectively normalized pdfs for each latent state and histograms from datasets are presented in fig 3 b d for depths of 10 30 and 60 cm respectively accordingly the multi modal features of the datasets were better captured through combinations of optimum uhmms rather than those with traditional binary distributions of dry or wet state at site a2 fig 3 e shows bic distribution at sit c6 indicating increasing trend of minimum bic for deeper depth 4 5 6 for depths in 10 30 and 60 cm pdf fittings of optimized multiple normal distributions also indicate better finesses than those for dry and wet status fittings fig 3 f h a similar procedure was applied to all study sites and the selected number of latent soil moisture states ranged between four and eight fig 4 notably greater than the traditional two latent soil moisture states wet and dry reported in previous studies teuling et al 2005 lee and hornberger 2006 thus the soil moisture variation pattern can be further characterized and categorized by several additional states the average number of latent soil moisture states across all sites was 6 1 and increased with depth 10 30 and 60 cm averages were 5 7 6 3 and 6 5 respectively and similar increasing trend of multi modal pdf was reported for soil moisture in a previous study li et al 2013 these findings were consistent with the results of hartigan s dip test that multi modality was more pronounced at depth table 2 the increasing pattern of latent soil moisture states in uhmm at deeper depths can be explained by more complex hydrological processes at deeper depth than those for shallower point van schaik et al 2008 kim et al 2014 zhu et al 2014 the inter state transition uhmm probability matrix held two transitional patterns a switch pattern which changed into other states and a regression pattern which changed back to the original state and the average probabilities for each pattern were calculated for the uhmm with four latent soil moisture states four regression and 12 switch probabilities were generated the corresponding probabilities of uhmm for all soil moisture measurements were expressed as 84 7 and 3 3 for regression and switch patterns respectively it was thus concluded that soil moisture variability tended to maintain the range of origin pattern and shifted to other patterns that were less common the probability ratios of soil moisture at each depth are shown in fig 4 specifically the mean of probability of the regression pattern increased with depth whereas that of the switch pattern decreased along the depth profile the decreased soil moisture variability at depth fig 4 may be explained via the decreased direct effects of hydrometeorological drivers e g rainfall and evapotranspiration at deeper depth he et al 2012 liu et al 2017 lee and kim 2019 3 3 multivariate hmm vertical and lateral distribution the soil moisture responses in the depth profile or lateral distribution can interact due to connectivity by vertical or lateral flow at a hillslope scale the mhmm was applied to the soil moisture dataset across multiple sites examining both vertical profiles and lateral spatial distribution table 3 the number of latent soil moisture states in the mhmm for vertical soil moisture data was equal to or greater 7 9 than those across lateral space 5 7 implying that there were comparatively more patterns of markov processes for vertical soil moisture profiles accordingly the heterogeneity among soil moisture variation according to depth was relatively higher than that of lateral variation gwak et al 2017 the daily oscillation of evaporative flux introduced substantial interactions along the vertical profile lee and kim 2019 wang et al 2021 considering infiltration and exfiltration along the vertical profile modeling with multiple soil moisture measurement depths can provide a useful perspective for process identification the modeled number of latent soil moisture states for the 13 study sites varied between seven and nine table 3 as the estimated number of latent soil moisture states in the mhmms along the vertical profile table 3 were greater than those in the uhmms fig 4 it can be concluded that the interaction across soil moisture depth may be more important than the interactions from univariate features for the determination of soil moisture status and probability distribution identification e g number of latent soil moisture states and patterns figure 5 a presents the time series of soil moisture profiles for site a2 upslope and its latent state distribution table 3 during 2016 a combination of seven latent soil moisture states represented the temporal response features of soil moisture at site a2 the distribution of latent soil moisture states in late june and august showed similar recession features of soil moisture variation the abrupt increase in the number of latent soil moisture states correlated with big rainfall events were also similar except for those in early spring and late autumn and the increasing soil moisture observed in late may and late july displayed different latent state distributions as well furthermore the increasing soil moisture recorded in october showed unique recession latent patterns when compared to all other seasons time series of soil moisture and latent distributions at site c6 downslope indicated a slower recession and diminished peak response with more complicated latent state distributions fig 5b the similar recession patterns between late june and august held a higher number of latent soil moisture states than those at a2 similarities in soil moisture variability between both upslope and downslope locations can be seen in the period following late october when no rainfall input was received the higher number of latent soil moisture states and greater heterogeneity observed at site c6 can be explained by the greater number of flow paths such as lateral subsurface flow heading toward the downslope direction kim 2014 the temporal distribution of latent soil moisture states indicated the transition of soil moisture for rainfall events and its seasonal response pattern fig 6 a and b presents the variation of latent soil moisture states from spring to autumn along transects a and b and both distributions from hilltop to downslope appeared different except for the late autumn the number of latent soil moisture states was greatest in the downslope sites for both transects and the frequency of latent state shifts substantially increased downslope as well e g a6 and b8 showed very high frequency response patterns this further supported that the complexity of soil moisture recharge tended to increase downslope due to the higher number of flow paths as one approached the stream generation point however the similarity in latent state distributions between adjacent locations was low indicating the wetness along transects can vary although always increasing downslope fig 6 a and b display that existing lumped models e g three or four reservoir models of hillslope hydrologic response behavior substantially simplified the complicated features of soil moisture variability 3 4 environmental factors and soil moisture by pcr the controlling environmental factors of soil moisture distribution are important to understand for characterization of hillslope hydrological processes and landslide prevention pca was performed to identify the primary mechanisms behind spatiotemporal distribution of soil moisture tromp van meerveld and mcdonnell 2006 perry and niemann 2008 the pearson correlation coefficient was used to identify the relationship between soil moisture distribution and the pcs by season the pcs varied in space and by sd as well as with fine scale temporal shifts during rainfall and the subsequent recession period perry and niemann 2008 korres et al 2010 gwak and kim 2017 based on the latent soil moisture states from the mhmm pca was applied table 4 presents the proportions of variance explained by the pcs across all latent soil moisture states and depths the variation explained by the 1st pc ranged 80 4 98 4 and the 1st and 2nd pc sum was 90 across all latent soil moisture states the proportion of variance explained by the 1st pc tended to increase with depth indicating a greater impact of soil environmental drivers and decreased effects of climatic factors the relationship between the spatial distribution of the 1st pc and the environmental factors was investigated and table 6 presents the pearson correlation coefficients of the 1st pc across all latent soil moisture states and depths the spatial distribution of soil texture percent sand clay and silt was important at 10 cm depth whereas significant positive relationships were found for topographic attributes e g twi and ca and a significant negative relationship with sd was identified at depths of 30 and 60 cm the overall impact of sd was more pronounced at 60 cm the 10 cm results seen in table 5 can likely be explained by the decreased sand and increased silt contents providing higher soil moisture retention thus the greater the hydraulic conductivity the less soil tension can create the conditions for vertical drainage to greater depths indeed significant soil moisture relationships between sand and silt at the soil surface have been previously documented korres et al 2010 baroni et al 2013 hu et al 2017 gwak and kim 2017 the significant impacts of twi and ca occasionally appeared at 30 cm depth where the impacts of surface and the bedrock boundary were minimized this means that daily soil moisture movement was strongly associated with matrix flow slow rather than pipe flow or boundary flow fast flows along the surface and bedrock layer the stronger correlations of twi and ca at states 1 and 2 table 5 coincided with the relatively low mean soil moisture contents 8 1 and 10 2 at 30 cm depth table 6 implying that the higher correlations between soil moisture and terrain based attributes can be more apparent under relatively dry conditions kaiser and mcglynn 2018 the negative correlations of sd can likely be explained by the increased moisture and decreased soil layer thickness above due to the vertical recharge across shallower soil regolith 3 5 seasonal latent soil moisture states the frequency of monthly latent soil moisture states and the statistics obtained from the mhmms are presented in table 6 the total rainfall 977 5 mm was primarily concentrated in april may july and october the greater the amount of rainfall amo the higher the number of latent soil moisture states across all depths indicating that precipitation was the primary driver of observed soil moisture variability the monthly frequencies at 10 cm depth indicated that states 3 5 6 and 7 existed in the spring and autumn and states 6 and 7 held the most explanatory power for soil moisture variability during rainfall events between june and september the rainy season features fell either in state 1 or 2 state 4 was a distinctive feature observed in the autumn at 10 cm depth found only between october and december at 30 cm depth the dominant latent soil moisture states during spring and early autumn were states 4 5 and 6 whereas states 1 2 and 3 were predominant in the rainy season between june and august distributions of latent soil moisture states at 60 cm depth indicated that states 3 4 and 5 represented the features of spring and autumn while states 1 and 2 best represented the rainy season features state 7 at 10 cm and state 1 at 30 cm held the highest means per depth appearing solely during in rainy days 100 but a similar feature at 60 cm was not observed accordingly the dominant control of precipitation appears to be limited at a depth between 30 and 60 cm while multiple states were observed in the spring states 3 5 and 6 at 10 cm and states 4 5 and 6 at 30 cm the latent state distributions for the autumn were state 4 at 10 cm state 5 at 30 cm and states 3 and 4 at 60 cm depth mainly occurring between october and december the mean soil moisture values at each of the three depths were 11 7 13 7 and 14 5 respectively almost identical to the means of normal distribution for state 3 at 10 cm state 4 at 30 cm and state 3 at 60 cm thus the composition of latent soil moisture states was unique for the spring rainy and autumn seasons the means across the entire period at each depth were also obtained they may serve as useful references of hillslope soil moisture patterning these seasonal distributions indicated that the delineated latent soil moisture states obtained from the mhmms are useful for the classification and characterization of seasonal soil moisture response patterns which were further confirmed by the apparent distinction of two dry seasons spring and autumn hydrologic behavior has been approximated using several storage based models at a hillslope scale loritz et al 2017 fan et al 2019 the performance of a physically based model can be substantially improved if the spatially and temporally varied water storage feature obtained in this study is properly implemented into the model structure gao et al 2014 gharari et al 2015 furthermore the identification of temporal and spatial variation in critical soil moisture can be important in the prediction of rainfall landslide at the hillslope scale onda et al 2004 fan et al 2016 3 6 soil moisture control and seasonal hydrological processes the seasonality of soil moisture control factors can be identified through the comparative analysis of tables 5 and 6 for states 6 and 7 the combination of soil texture and asp were dominant during the spring and the impact of soil texture alone controlled the autumn at 10 cm depths states 3 and 4 whereas both texture and asp were important under wet conditions rainfall and soil texture alone was dominant during periods of moderate wetness immediately after rainfall asp was the dominant factor during dry conditions post recession periods mcmillan and srinivasan 2015 chen et al 2019 the controlling environmental factors at 30 cm depth were distinct combinations of twi ca and sd were primary factors during spring states 5 and 6 stronger impacts of terrain attributes and sd controls states 1 2 4 and 5 were revealed during rainy season and state 5 was the dominant process during late autumn at 60 cm the primary spring factor was sd states 3 4 and 5 and the rainy season was governed by dual controls twi and sd states 1 and 2 with the effects of sd becoming stronger in late autumn states 3 and 4 sd was predominant under wet condition rainfall while both twi and sd were important during relatively dry conditions recession while the infiltration along the vertical profile was important across all seasons the impact of twi was greater during the recession period indicating the development of storm flow in the subsurface layers further the increased impacts of twi and ca during the dry post recession period can likely be explained by the assumption of redistribution under steady flow for twi beven and kirkby 1979 the impact of rainfall was most pronounced for states 6 and 7 states 6 and 7 and states 4 and 5 at 10 30 and 60 cm depths respectively this implies that the important environmental factors during rainfall events were soil texture and as at 10 cm depth and sd at 30 and 60 cm depths the significance of terrain based attributes appeared most pronounced under relatively dry conditions states 1 and 2 at 30 cm depth and states 1 and 2 at 60 cm depth the complete redistribution of soil water in hillslope regolith was thus more correlated with terrain based indices twi or ca liang et al 2017 kaiser and mcglynn 2018 4 conclusion the pdfs of soil moisture for different hillslope location were characterized through a combination of statistical distributions here time series analysis indicated that the hmm can be used to delineate multiple statuses and processes dependent upon sd and transect location the optimum combination of uhmms provided a superior representation of multi modal soil moisture features than traditional approaches based on wet and dry statuses both regression and switched patterns from a probability matrix of hmms were used to improve process based understanding of soil moisture variation and interactions between soil moisture across vertical profiles and lateral distribution were highlighted through mhmms to explain seasonal soil moisture variability according to their dominant latent soil moisture states the controlling factors of soil moisture distribution were identified through the integration of multiple hmms and pca depending on sd and season these distinct factors were obtained via a mhmm of spatiotemporal soil moisture data and its correlation to latent soil moisture states associated with environmental factors variations of the dominant environmental factors demonstrated that while local factors such as soil texture and aspect were important at shallower depths the impact of global domain factors such as upslope ca and twi were stronger at depth during period of rainfall and its subsequent recession credit authorship contribution statement eunhyung lee data curation methodology software sanghyun kim conceptualization validation visualization writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements authors would like to express a sincere appreciation for reviewers and editorial board of journal of hydrology funding this work was supported by the basic research program 2016r1d1a1b02008137 of the national research foundation from republic of korea 
3779,urban waterlogging often causes urban disasters and the rapid early warning and comprehensive analysis of the urban waterlogging can help disaster defenses however the warning of waterlogging through the monitoring data cannot give grid distribution and the forecast of hydrological models cannot ensure rapid early warning to obtain a grid rapid early warning result for a region like an urban area a method needs to be proposed which can meet the above problems in this research automl automatic machine learning based on genetic algorithm was recommended to construct the rapid early warning and comprehensive analysis models for urban waterlogging by compared with the other three machine learning algorithms catboost categorical boosting xgboost extreme gradient boosting and bpdnn back propagation deep learning neural network in the models the forecast and historical precipitation obtained from the integrated nowcasting through comprehensive analysis system inca the difference of elevation and the urban waterlogging risk maps provided by tianjin meteorological administration were employed as the input sources the input precipitation duration was determined as 12 h based on the sensitivity analysis of the influence of various precipitation duration on waterlogging depths due to the non digital discrete dataset features the urban waterlogging risk maps were transformed to the weight of each corresponding risk level according to the area of each risk level and the number of samples falling in each risk level the difference of elevation was characterized by the average elevations of various distances from the points of concern the output waterlogging depths were compared with the waterlogging depths monitored in tianjin china whose quality was controlled by eliminating the records of the waterlogging depths lasting for a long time after the end of rainfall the comparison of the models constructed by different methods demonstrated that the automl performed better nse and r2 0 92 cc 0 95 rmse1 1 1 9 cm than the other three models the forecast waterlogging depths by automl was also coherent with the monitoring waterlogging depths nse and r2 0 9 cc 0 95 rmse 1 7 2 2 cm for that local topography and waterlogging risk are considered the automl models can be used in the area without the monitoring of water level quickly predict waterlogging depths and give spatial grid results for rapidly early warning keywords urban waterlogging automatic machine learning algorithm based on genetic algorithms rapid early warning xgboost catboost bpdnn comprehensive analysis abbreviations automl automatic machine learning algorithm based on genetic algorithms 1 introduction urban waterlogging is an urban disaster mostly induced by heavy precipitation which affects the normal functioning of the city damages the urban ecological environment and even causes serious economic losses and human casualties the formation of urban waterlogging is closely related to climate change and urbanization quan 2014 wang et al 2017 global warming accelerates the urban hydrology cycle while rapid urbanization reduces the natural infiltration storage as well as retention capacity of the underlying surface resulting in increased surface runoff production and shorter confluence time jiao et al 2019 urban waterlogging is of high frequency susceptibility and spatial diversity in the rainy season the precipitation duration is related to the waterlogging duration and the maximum precipitation has a positive correlation with the waterlogging area and depth jiao et al 2019 therefore the prediction and warning of urban waterlogging requires comprehensive consideration of precipitation and its duration topography the type of underlying surfaces and the capacity of the urban drainage network and so on since china proposed the sponge city construction plan in 2013 sang and yang 2017 wang et al 2018 a large number of water level monitoring stations have been planned and established in large and medium sized cities in china which has been applied in the warning of waterlogging disaster yang et al 2014 however the warning of waterlogging based on the monitoring waterlogging depths hardly plays a role in providing an early warning to guide disaster prevention a variety of hydrological models e g swmm mouse pwri mike etc can simulate urban waterlogging caused by heavy precipitation and provide the warning of waterlogging by combining the predicted precipitation su et al 2016 however most hydrological models take a long computation time so that they often fail to provide warning in time for the waterlogging caused by burst rainstorms moreover the input data for the hydrological models are complex including detailed pipe network data water system distribution road and street distribution etc which makes them difficult to be applied regularly machine learning is characterized as fast and flexible and has been applied in forecasting flood or waterlogging in hydrology field the development machine learning method is over 20 years history early in 1990s a back propagation neural network based model has been proposed to perform river flood forecasting campolo et al 1999 immediately following the development of machine learning more structures were invented and applied in hydrology chen propose a decision group back propagation neural network for flood forecasting chen et al 2010 and there are rnn based models chen et al 2013 chang et al 2014 applied for urban flood control or flood forecasting as well as lstm based model fang et al 2020 and cnn based model kabir et al 2020 are all proposed for urban flood forecasting and relative area in recent years back to 2012 ensemble methods in ml have attract a great attention of the scientific community kazienko et al 2013 the basic principle of the ensemble model is to turn multiple weak learners into strong learners based on meta learning or simply averaging it is stated and proven that ensemble learning can overcome related shortcomings of ordinary learning of ml models including statistical problems when the search space is too large for the available training data computational problems where the learning algorithm fails to find the optimum solution and representation problems when the learning algorithms lack appropriate fitness functions zounemat kermani et al 2021 especially while dealing with high dimensional complex regression and classification problems in the last four years 2018 2021 more and more ensemble machine learning methods with have been applied in hydrology field yin et al 2018 berkhahn et al 2019 wei et al 2020 specially boost algorithms have been employed in several studies shafizadeh moghadam et al 2018 implemented for flood susceptibility assessment several statistical and machine learning models as well as seven ensemble approaches hossein 2018 their findings revealed that the boosted regression trees model was superior to the individual machine learning models mars cart ann and etc korean researcher kim kim et al 2020 with his team in 2020 explore the daily streamflow based on different antecedent times series forecasting by compared with mars m5tree and average ensemble machine leaning models aeml which shows that aeml is superior to m5tree and mars tree based model mirzaei and his team proved that xgboost is better than other ensemble methods in flood susceptibility assessment mirzaei et al 2021 with the introduction of some tricks the original bpdnn can be treated as an ensemble model of multiple nonlinear models by adding activation functions and dropout layers but these ensemble based models lack preprocessing and feature selection capabilities even the latest algorithm catboost are simply preprocessing data by using one hot how to adequately mine the data and find more effective features another solution is mentioned which is hybrid model like the anfis a p c n et al 2004 lstm alo yuan et al 2018 or lssvm gsa adnan et al 2017 which get good performance in hydrological time series focus more on data preprocess and feature selection combining and how to combine hybrid models ability to process data and select features with ensemble models become questions thus an idea was put forward that those machines create new neural networks by themselves during meta learning the corresponding algorithms are called automatic machine learning automatic machine learning tries to automatize the steps of feature extraction model and algorithm selection parameter optimization and so on so that it needs no human assistance and avoids man made bias one framework of the automatic machine learning would be used in this research which called automatic machine learning based on genetic algorithm automl le et al 2020 the automl first applies on rna seq expression and the first time applies in hydrology hence it would be compared with other ensemble model which has been proven good performance in hydrology xgboost the ability to match xgboost in other field catboost and deep learning neural network which has the similar structure with ensemble machine learning models bpdnn tianjin is a big coastal city in north china where is the confluence of a few of rivers it confronts upstream flood waterlogging resulted from heavy rainfall and tide during flood season which can easily cause waterlogging disasters in central tianjin city therefore the early warning and comprehensive analysis models for urban waterlogging were established with the automl algorithm based on the experimental comparison with the other three ensemble models catboost xgboost bpdnn given the combined effect of multiple factors on urban waterlogging the models used the parameters related to precipitation topography urban waterlogging risk maps in tianjin china as input the operational forecast and comprehensive analysis of precipitation made sure to quickly generate information of water depths to save more valuable time for the arrangement of disaster defense 2 data sources the data used in the model construction include the monitoring waterlogging depths the forecast and comprehensive analysis of precipitation as well as the static data including the topographic elevation and urban waterlogging risk maps in tianjin 2 1 the waterlogging depth monitoring data most cities in china have established an urban waterlogging monitoring network based on internet of things iot technology to monitor the waterlogging depth in real time in tianjin waterlogging monitoring equipment was installed inside streetlight poles monitoring poles and signal base stations and thin film pressure sensors were placed in parallel to the ground at the shoulder of the road for waterlogging monitoring the waterlogging monitoring data used in this paper are data collected from 25 waterlogging monitoring stations established in 2018 which will be used in models training and validation and from 145 waterlogging monitoring stations established in 2019 in tianjin which will be used in independent test in section 5 fig 1 the original sample interval is 5 min in total there were over 8 000 records of waterlogging depth in 2018 while only 3 124 records were within 5 min before and after the hours the waterlogging depths were less than 10 cm in most times and the waterlogging depths of 10 cm 20 cm 20 cm 30 cm 30 cm 40 cm and above 40 cm were 12 5 4 9 3 3 and 6 0 of the records respectively the recorded maximum waterlogging depth was 80 cm occurred during the heavy precipitation on 23 24 july when the maximum accumulated precipitation at the monitoring stations was 210 5 mm waterlogging depth monitoring data during four typical heavy precipitation processes in 2019 26 27 may 22 23 july 1 2 august and 9 10 august were selected for further independent test the maximum waterlogging depths for these four processes were 28 8 cm 43 5 cm 57 2 cm and 36 8 cm respectively the heavy precipitation on 26 27 may concentrated in 1 h with maximum hourly precipitation of 33 7 mm the heavy precipitation on 22 23 july concentrated in 3 h with the maximum 1 h 2 h and 3 h precipitations of 51 1 mm 64 2 mm and 107 6 mm respectively the maximum 1 h and 2 h precipitations on 1 2 august were 61 7 mm and 81 5 mm respectively on 9 10 august the maximum 1 h and 2 h precipitations were 53 8 mm and 62 5 mm respectively 2 2 the comprehensive analysis and forecast precipitation the comprehensive analysis and forecast precipitation are derived from inca haiden et al 2011 with a spatial resolution of 1 km and a temporal resolution of 10 min inca is nowcasting and comprehensive analysis system developed by the austrian national meteorological service recommended by inca ce the world weather research program forecasting demonstration project and applied in more than a dozen countries and regions the comprehensive analysis of precipitation combines the data collected from radars and ground weather stations while the forecast precipitation is the extrapolated results which merge the forecasting data from numerical weather prediction models such as rmaps grapes meso ec and other ensemble forecasts and the precipitation data collected from ground weather stations radars and satellites the nearest neighbor method was used to extract the precipitation for each of the waterlogging depth monitoring stations from the forecast and comprehensive analysis of precipitation from the precipitations and waterlogging depths at different monitoring stations table 1 though the precipitation time series are similar at some stations e g monitoring stations 1 and 2 monitoring stations 5 and 6 the waterlogging depths can be significantly different from each other due to the differences in waterlogging risk level and local topography similarly when the waterlogging depths are similar at some stations e g monitoring stations 2 and 6 monitoring stations 1 3 4 and 5 the characteristics of precipitation can also be significantly different according to the statistics of the comprehensive analysis of precipitation at waterlogging monitoring stations from may to september in 2018 heavy precipitation prone period the number of rain days day precipitation 0 1 mm at each monitoring station ranged from 34 to 46 the number of days with day precipitation 10 mm ranged from 5 to 15 the number of days with day precipitation 25 mm ranged from 1 to 5 and the number of days with day precipitation 50 mm ranged from 1 to 3 the vast majority of monitoring stations experienced heavy rainstorms and the maximum cumulative precipitation exceeded 200 mm the maximum 1 h 2 h 3 h 6 h 12 h cumulative precipitations in all processes were 51 3 mm 85 1 mm 95 5 mm 145 4 mm and 208 8 mm respectively the duration of rainfall was usually not 12 h and the longest duration is 16 h on 24 july from may to september in 2019 the number of rain days at the monitoring stations ranged from 40 to 63 the number of days with day precipitation 10 mm ranged from 10 to 14 the number of days with day precipitation 25 mm ranged from 2 to 8 and the number of days with day precipitation 50 mm ranged from 1 to 4 only a few monitoring stations experienced rainstorms with maximum cumulative precipitation of 120 3 mm for all precipitation events the maximum 1 h 2 h 3 h 6 h 12 h cumulative precipitation are 61 7 mm 107 7 mm 113 5 mm 120 1 mm 120 3 mm respectively heavy rainfall persists within 6 h in most cases 2 3 static data the urban waterlogging risk maps fig 2 and topographic elevation data ping fig 3 of tianjin city were also collected the waterlogging risk maps provided by tianjin meteorological administration were made through the combination of the inundation extents and depths of various return periods and the population distribution based on the minute level precipitation data of tianjin and the characteristics of urban waterlogging during typical heavy precipitation simulated by the urban hydrological model the topographic elevations were extracted from srtm with 90 m spatial resolution 3 introduction to the algorithms 3 1 automatic machine learning algorithm based on genetic algorithm the genetic algorithm based automated machine learning algorithm trang et al 2020 can automatically search for machine learning methods features transform and parameters and compare the different combinations of machine learning algorithms and parameters to select the optimal deep machine learning model from thousands of possible pipelines and the combinations of hyperparameters in a genetic algorithm like manner the framework of this algorithm is shown in fig 4 in the dashed box is the tree based pipeline optimization tool tpot process an automated machine learning application package written in python that applies a genetic algorithm for selecting the feature and algorithmic model to generate machine learning code automl genetic algorithm is a computational model of biological evolutionary processes that simulate the darwinian mechanisms of natural selection and genetics which is an iterative optimization method with the idea of creating children based on the features parameters of the parents at the end of each iteration each model is scored and the most suitable machine learning pipeline for the project is picked out from the initial pipelines or the pipelines of the previous iteration and fused into a new combined pipeline based on the 12 machine learning regressors 14 preprocessors and 4 feature selectors at the same time the optimal hyperparameters and pipelines are selected as the pipeline of the final model through a certain number of iterations the framework of the model screening process is shown in fig 5 the steps of genetic planning are as follows ① initialization random initialize 100 tree based pipelines and evaluates their balanced cross validation accuracy on the dataset ② elimination selects the top 20 pipelines in the population according to the nsga ii selection scheme where pipelines are selected to simultaneously maximize classification regression accuracy on the dataset while minimizing the number of operators in the pipeline ③ splitting a total of 100 pipelines i e 5 copies of the 20 pipelines obtained from ② are conducted as initialized offspring ④ mutation 5 of the offspring swap the operators on the pipeline with another 5 of the offspring the remaining 90 of the offspring have performed the add subtract and transfer operators with equal probability 1 3 ⑤ go to step ② and repeat the process 100 times if the algorithm is configured as above i e 100 100 10000 pipelines must be trained it will be very time consuming therefore in tpot the training can be interrupted at any time and the current optimal pipeline will be output moreover tpot provides the warm start parameters to continue at the break points 3 2 catboost algorithm categorical boosting the catboost algorithm a machine learning library opened by russian search giant yandex in 2017 is a member of the boosting algorithm family similar to xgboost extreme gbdt and lightgbm light gradient boosting machine the catboost algorithm is still an improved implementation under the gbdt gradient boosting decision tree algorithm framework catboost is a gbdt framework based on the oblivious trees algorithm with fewer parameters supporting category based variables and high accuracy and mainly addresses the efficient and reasonable processing of the category features in addition catboost also solves the problems of gradient bias and prediction shift thereby it reduces the occurrence of overfitting and improves the accuracy and generalization ability of the algorithm prokhorenkova et al 2017 dorogush et al 2018 catboost automatically deals with categorical features in a special approach firstly the statistics of category features are performed by counting the occurrence of a certain category then the hyperparameters are added to generate new numerical features the category features are not numerical but discrete sets such as the risk levels in this research in gradient boosting algorithms these categorical features are usually converted to one or more numerical features for gbdt the simplest way is to replace the categorical features with the average value of their corresponding labels in a decision tree the average value of the labels will be used as the criterion for node splitting an approach known as greedy target based statistics greedy ts an obvious drawback of this approach is that features usually contain more information than labels which can result in a conditional bias problem when the structure and distribution of the data are different between the training and test datasets if the average values of the labels are forced to represent the features catboost applies ordered boost into avoiding the bias of gradient estimation and thus solves the problem of prediction shift like all standard gradient boosting algorithms catboost fits the gradient of the current model by constructing a new tree however all classical boosting algorithms suffer from an overfitting problem caused by biased pointwise gradient estimates the gradients used in each step are estimated with the same data points from the current model which results in the deviation between the distribution of the estimated gradients and the true distribution of the gradients in any domain of the feature space in addition the prediction shift also includes the target leakage caused by applying ts into the process of category features to address the gradient bias and prediction shift catboost improved the classical gradient boosting algorithm many algorithms that utilize gbdt techniques e g xgboost lightgbm construct the next tree in two stages selecting the tree structure and calculating the values at the leaf nodes after fixing the tree structure to select the best tree structure the algorithm constructs the tree by enumerating different splits then the algorithm calculates values at the resulting leaf nodes calculating scores of the resulting trees and finally selecting the best split the values at the leaf nodes in both stages are calculated as an approximation to the gradient or newton step length in catboost unbiased estimation of the gradient step is applied for the first stage and the traditional gbdt scheme is applied in the second stage in addition by the combination of category features catboost allows the application of the links between features which greatly enriches the feature dimension catboost s base model uses oblivious tree and calculates the leaf value in the way different from the traditional boosting algorithm which calculates the average all of these improvements can prevent the model from being overfitted 3 3 xgboost algorithm extreme gradient boosting the xgboost algorithm an open machine learning source developed by tianqi chen et al and widely used efficiently implements the gbdt algorithm with the improvements of algorithms and engineering applications li et al 2017 kadiyala and kumar 2018 zheng and wu 2019 pathak et al 2020 xgboost is essentially a gbdt but significantly improved in speed and efficiency ① for that the traditional greedy method of enumerating all possible split nodes of each feature is too inefficient xgboost implements an approximate algorithm to find the best split node the general idea of which is to enumerate several possible candidates for the split note with the percentile method and then find the best split node from the candidates according to the formula finding the split node ② considering that the training data can be sparse xgboost can specify the default direction of branches for missing values or specified values which can greatly improve the efficiency of the algorithm ③ the feature columns are sorted and stored in memory as blocks which can be reused in iterations although the boosting algorithm must iterate serially it can process each feature column in parallel ④ xgboost can improve the efficiency of the algorithm by firstly collecting the data into a buffer inside the thread and then computing it ⑤ xgboost also considers how to efficiently use disk to improve the efficiency of the algorithm as much as possible when the amount of data is large and memory is not enough including multi threading combination data compression and slicing methods in contrast to gbdt instead of simply combining several cart trees repeatedly xgboost uses an additive model that takes the error generated by the model s last prediction a model made by combining the t 1 trees as a reference for the next tree the t tree i e the residual error between the model s predicted and actual values is used as the input data for the next tree and so on with each tree added its loss function decreases continuously in addition xgboost introduces a regular term in the loss function to control the complexity of the tree and prevent overfitting a second order taylor expansion is used to make the objective function closer to the true loss function and weighted quantile sketch is used to select split nodes which grows dynamically through structural scoring and splitting losses 3 4 back propagation deep learning neural network bpdnn the bp neural network proposed in 1986 by a group of scientists led by rumelhart and mcclelland is a multi layer feed forward network trained according to an error back propagation algorithm the learning rule is to use the fastest descent method to continuously adjust the weights and thresholds of the network by backpropagation to minimize the sum of squared errors of the network the loss is firstly obtained by forward propagation the final output and the loss between the output and actual values are calculated according to the input samples the given initialized weight w and the bias term b then the error is backpropagated the output is backpropagated every layer in some way through the hidden layers to the input layer and the error is apportioned to all units in each layer so that the error signal of each unit in each layer is obtained which is the basis to correct each unit s weight with the development of machine learning in recent years the bpdnn model has been improved in which the introduction of dropout activation function batch normalization and early stopoing and more advanced optimization functions adam have made bpdnn more complex and better performance the introduction of dropout for example makes the model s robust performance improved and also can be seen as a group of bp models ensemble and the introduction of activation functions such as relu selu and leakyrelu makes the original linear model into a nonlinear model and because the bp neural network itself has multi layer features to some extent also makes the ensemble model has a more complex structure 4 model construction and comparative analysis 4 1 sample selection the most impact factors on waterlogging are considered in the study of the waterlogging risk in most cities so that the waterlogging risk maps were chosen as one of the input sources of the model however in respect of the prediction or simulation of waterlogging depths the waterlogging risk levels are relatively coarse the waterlogging locations and depths in an area with the same drainage conditions are closely related to the topography thus the topographic elevation is also considered as an input source of the model heavy rain is an important factor contributing to waterlogging and therefore precipitation factors for example amount and duration of precipitation are also considered as the model input source the above sources are fed into each machine learning model to obtain the correlation models of waterlogging depth and precipitation topography waterlogging risk i e the comprehensive analysis and forecast models of waterlogging depth for the comprehensive analysis models of waterlogging depth only the comprehensive analysis precipitation with a certain duration is input for the forecast models of waterlogging depth the precipitation from the forecast time back to a certain time are input the hourly precipitation time series at each waterlogging depth monitoring station was extracted from the comprehensive analysis and nowcasting grid precipitation as input precipitation though waterlogging depths were sampled at each 5 min for all monitoring stations only the hour data can be used to consist with the hourly precipitation if only the hour data was selected it would lose a lot of effective training samples therefore the time tolerance interval was set to 5 min that is the data 5 min before and after the hour data were also treated as hourly data for getting more effective samples the spatial resolution of the topographic elevation is 90 m the elevation at a waterlogging site is set as d0 the average elevation at 90 m away from the site is set as d1 the average elevation at 270 m away from the site is set as d2 and the average elevation at 450 m away from the site is set as d3 the four elevation parameters are the input elevation parameters of the models according to the waterlogging risk maps the waterlogging risk levels are divided into 6 levels the ratio of waterlogging depths recorded in the area of each risk level is set as pdi and the ratio of the area of each risk level to the whole area is set as pai set the weight wi to make pdi pai wi const i 1 2 3 4 5 6 in which the weight of the area of no waterlogging risk is 0 according to the rule the weights wi were determined as 0 0 25 0 5 0 8 4 5 for 1 6 levels and applied as the input parameters of the risk levels to verify the models 75 of the data was set as a training set and the other 25 of the data was set as a test set through a random sampling method the random sampling method is random select through 51 events which divided by day such allocation is made to maintain similar statistic characteristics 2 343 about 75 monitoring waterlogging depths and precipitation at all stations in 2018 were finally selected as the training set and the other 781 about 25 monitoring waterlogging depths and precipitation were used as the testing set and data in 2019 was set as a validation set for independent inspection 4 2 model parameter settings the parameters of the automl are set as follows the number of iterations for creating offspring new individuals generation 100 the initial number of created individuals population size 100 the number of new required individuals per generation offspring size 100 the mutation rate i e the probability of a random change in the value of an attribute mutation rate 0 9 the percentage of individuals for creating offspring crossover rate 0 1 to find the optimal hyperparameters and results a grid search method table 2 was applied to catboost and xgboost for the catboost algorithm max depth and learning rate were put into the grid search meanwhile the early stopping also activated when training the model what is more the different loss functions were also applied into the model to get the optimal results catboost has its own function to process the categorical features so the waterlogging risk levels are put into the catboost s automatically feature extraction model for the xgboost algorithm max depth learning rate gamma and min child weight was all put into grid searching also early stopping was activated in xgboost the final parameters of the algorithms are as follows for the catboost algorithm cat features waterlogging risk levels max depth 9 n estimators 600 loss function rmse for the xgboost algorithm max depth 9 n estimators 500 learning rate 0 01 gamma 0 9 min chid weight 6 for the bpdnn a three hidden layer network with 500 iterations was employed which has 128 neurons in the first layer relu as activation function and 256 neurons in the second layer relu as activation function as well as 512 neurons in the third layer relu as activation function with adam as the optimization function and mean squared error as the loss function to reduce the time consuming and find optimal result the weight decay start learning rate 0 01 decay factor 0 8 patience 5 and min delta 1 10 8 and early stopping patience 20 were also applied in the model to prevent the overfitting the dropout 0 2 layer added before the final output layer in the experiment the deep layer network was also tested however the result did not perform better compared with the there hidden layer network as a result a three hidden layer network was applied in this paper 4 3 performance evaluation parameters to evaluate the performance of various models the statistical evaluation criteria would be used in the following which are nash sutcliffe model efficiency coefficient nse r square r2 and correlation coefficient cc for evaluating the predicting ability of models mean absolute percentage error mape for evaluating the dispersion between prediction and ground true root mean square error rmse for evaluate the bias between prediction and ground true from the paper by moriasi et al model can be said to be satisfactorily accurate when nse 0 5 good when nse 0 7 very good when nse 0 8 moriasi et al 2007 r2 follows the same pattern as nse cc always gives a better result compared with nse and r2 but still be regard as a criterion for evaluating the predictive power of models as for the forecast precipitation results of inca 1 2 h lead time we used the ts threat score for different levels of precipitation 1 cc i 1 n f i f o i o i 1 n f i f 2 i 1 n o i o 2 2 r 2 1 n i 1 n f i o 2 n 1 i 1 n o i o 2 3 mape 1 n i 1 n f i o i o i 4 rmse 1 n i 1 n f i o i 2 1 2 5 nse 1 i 1 n f i o i i 1 n o i o 2 4 4 data cleaning the investigation of the monitoring waterlogging depths and the corresponding precipitation showed that two possibilities were attributing to the discrete points one is the too short time of the input precipitation because in some cases precipitation was discontinuous and can still impact the subsequent waterlogging process the other is unreasonable data in the monitoring waterlogging depths i e fluctuating water depths were still recorded for a long time after the end of precipitation fig 6 for the first possibility a detailed analysis was provided in the next section for the second possibility the monitoring waterlogging depths were cleaned the data of monitoring waterlogging depths after 12 h from the end of precipitation were removed 4 5 the sensitivity test of precipitation parameters the influence of data quality was tested through the automl by comparing the comprehensive analysis waterlogging depths with and without data cleaning firstly the 1 h comprehensive analysis of precipitation and monitoring waterlogging depths without cleaning were used to construct the model compared the waterlogging depths simulated by the model with the monitoring waterlogging depths fig 7 we got that the r2 0 6703 nse 0 6797 cc 0 8277 rmse 4 9495 mape 0 3729 from fig 7 there are some discrete points for example those inside the red circles in fig 7 then the 1 h comprehensive analysis of precipitation and cleaned waterlogging depths were used to construct the model the relationship between the simulated waterlogging depths by the model and monitoring waterlogging depths was shown in fig 8 from fig 8 the dispersed points became less the statistical evaluation criteria performed better as the r2 nse cc increased to 0 8753 0 7197 0 7643 separately unfilter 0 8277 0 603 0 6797 and mape decreased by 6 rmse decreased to 4 3929 unfilter 4 9495 to find the best duration of precipitation input for the model we evaluate the correlation coefficients between cumulative precipitation and waterlogging depths were shown in fig 9 according to the method in chang et al 2014 within 3 h the correlation coefficients between cumulative precipitation and waterlogging depths increase rapidly with the increasing duration of precipitation as for 3 12 h the correlation coefficients between cumulative precipitation and waterlogging depths increase slowly with the increasing duration of precipitation for 12 24 h the correlation coefficients between cumulative precipitation and waterlogging depths decrease gradually with the increased duration of precipitation according to the statistics of the tianjin urban precipitation provided by tianjin meteorology administration the duration of short time heavy precipitation in tianjin is generally within 3 h therefore the 1 h 3 h and 12 h precipitations were chosen as inputs for further study of the effect of precipitation duration the different precipitation including 1 h precipitation 3 h cumulative precipitation 3 h hourly precipitation process cumulative precipitation 12 h hourly precipitation were applied to constructing the comprehensive analysis models for further study the simulated waterlogging depths were compared with the monitoring waterlogging depths as shown in table 3 table 4 and fig 10 fig 8 fig 7 as seen in the figures and the tables the parametric scheme for the time series of precipitation gives better results than the parametric scheme for the accumulation of precipitation the result with input of the 12 h hourly precipitation showed the best correlation the maximum nse r2 and cc to the monitoring waterlogging depths with the smallest errors the minimum rmse and the fewest dispersion the minimum mape no matter in automl catboost xgboost or bpdnn therefore 12 h hourly precipitation was finally chosen as the input precipitation parameters for the comprehensive analysis and forecasting models more discussion about model comparison is expanded in section 4 6 4 6 comparison of the four models the four models were constructed through the four algorithms automl catboost xgboost and bpdnn in which the input precipitation parameters were the comprehensive analysis of 5 parameterization options 1 h precipitation 3 h cumulative precipitation 3 h hourly precipitation process cumulative precipitation 12 h hourly precipitation the waterlogging depths obtained from the four models were compared with the monitoring waterlogging depths as shown in table 3 and table 4 from the tables the automl model with parameterization scheme 12 h hourly precipitation works best and give the highest score of all four models in all five criteria nse 0 9588 r2 0 9581 cc 0 9793 mape 0 1737 rmse 1 8377 following were catboost and xgboost which are both with parameterization scheme 12 h hourly precipitation as for the bpdnn the best parameterization scheme result is worse than other parametric solutions with moderate results of other models furthermore violin chat hintze and nelson 1998 was also introduced to compare the more detail of the simulated and monitoring water depths from the violin chart fig 11 with parameterization scheme 12 h hourly precipitation the inversion distribution of automl is the most similar to the observation the inversion distribution of xgboost and catboost rank the second and third bpdnn ranks the last in general automl performed the best no matter in which kind of parameterization scheme above five parameterization scheme 12 h hourly precipitation will be used as the final parameterization in inversion models and further application in prediction models bpdnn algorithm is suitable for the learning of big data and multi parameter inputs for the learning of small data it is more likely to overfit the small data and underfit the target task the samples of extremely heavy precipitation were smaller and the distribution of whole data is uneven which resulted in the lower weight of the extreme and the more moderate results for the extreme condition as shown in fig 12 during the precipitation process on 24th july 2018 the waterlogging depths given by the bpdnn algorithm were smaller than both the monitoring waterlogging depths and those simulated by the ensemble algorithms at 4o clock and 11 12 while the results were on the contrary at 6o clock although structurally the dropout layer in the model allows the bpdnn to be considered as a combination of multiple bpdnns of equal depth this ensemble approach is a simple stitching of multiple models which is not effective in data feature mining for the boost algorithms a very important capability is the mining of data features for xgboost catboost and the automl each iteration adds a tree to the existing trees to fit the residuals between the prediction of the existing trees and true values and the new tree will increase a new pattern in respect of feature quantities regardless of the precipitation process moreover the generalization ability of the models is improved due to the addition of the regular term the automl applies methods such as rbfsampler and pca into the classification of data which can improve the mining of the features therefore the automl algorithm can construct a better model than the xgboost and catboost algorithms the catboost algorithm has different choices of scoring functions from the xgboost algorithm the catboost algorithm not only inherits the scoring function in the xgboost algorithm but also extends it with other scoring functions to determine whether the leaves are split or not and introduces gradient information to guide the split of the base trees instead of the gini coefficients used in the cart tree the flexibility of the evaluation metrics and the ability of the catboost algorithm to effectively handle category based features allow catboost more ability to learn than xgboost therefore the results from the model trained by the catboost algorithm are more consistent with the monitoring waterlogging depths 4 7 the waterlogging depth prediction model considering the difference between the predicted precipitation and the comprehensive analysis precipitation a prediction model of waterlogging depth was constructed by the automl with the nowcasting and comprehensive analysis precipitation ts is usually used to evaluate the accuracy of nowcasting precipitation it is defined as 6 ts correct forecast o b s e r v e d c o r r e c t for a perfect forecast correct forecast observed to yield a ts of 1 the worst possible forecast with correct 0 yields a ts of zero the ts evaluation of the nowcasting precipitation obtained from inca as table 5 showed that nowcasting results of tianjin urban area in 2019 for 1 h lead time performed well as for 2 h lead time the result turned worse therefore only the forecast model of water depths in 1 h lead time was established the forecast and comprehensive analysis of precipitation were combined for the forecast of waterlogging depths for example the future 1 h forecast precipitation and 11 h comprehensive analysis precipitation in the past were used to build the prediction model of the future 1 h the results obtained from the model showed good coherence to the monitoring waterlogging depths fig 13 and the last column in table 3 with the r2 of approximately 0 90 nse of approximately 0 90 cc of approximately 0 95 rmse of about 2 8 cm mape of about 15 9 the forecast model demonstrated good forecasting ability in 1 h lead time the result represented that this model could be applied in forecasting applications moreover we compared the automl forecast model with other related nowcasting model chang et al 2014 the 1 h lead time show outstanding results compared with other methods ann narx of 1 h lead time no matter in nse cc or rmse 5 independent testing of the models to test the spatial or temporal robustness of the models for comprehensive analyzed and forecast waterlogging depths we need independent test with the expansion of observation points has increased from 25 in 2018 to 145 stations in 20 199 fig 1 it provided more new observation dataset which are independent both in time and in space in the study area we pick four heavy precipitation processes on 26 27 may 23 24 july 2 3 august and 9 10 august in 2019 which is independent of training and testing dataset in 2018 fig 14 and fig 15 selected hourly dataset from precipitation and waterlogging depths and applied into automl which performance the best of four compared models and take 12 h hourly time series as the precipitation input the results are as follows the comprehensively analyzed waterlogging depths are coherent to the monitoring waterlogging depths with the r2 above 0 93 nse above 0 92 cc above 0 96 rmse of 1 1 1 9 cm and mape less than 10 the forecast waterlogging depths are also consistent with the monitoring waterlogging depths with r2 above 0 89 nse above 0 89 the cc above 0 94 rmse of 1 7 2 2 cm and mape less than 26 as the automl model was build based on 25 waterlogging monitoring sites in 2018 and the application was based on 145 monitoring stations in 2019 the results showed that the model was robust no matter in spatial or in temporal 6 conclusion urban waterlogging is related to the factors such as precipitation and its duration terrain and topography the type of underlying surface the capacity of the urban drainage network and so on these factors should be comprehensively considered in the prediction and inversion of waterlogging depths on the basis of the comparison of the four algorithms automl xgboost catboost bpdnn the automl algorithm was recommended to construct the forecast and comprehensive analysis models of waterlogging depths for its better performance the input data of the models were the observations of waterlogging depths monitoring at 25 monitor stations in tianjin in 2018 the waterlogging risk maps terrain elevation and the precipitation forecast and real time analyzed by inca the quality of the data and the selection of precipitation parameters had a significant impact on the accuracy of the models given the relationship between precipitation and waterlogging depths the data of waterlogging depths recorded for a long time after the end of precipitation were removed which significantly improved the accuracy of the models the influence of the duration of precipitation on the waterlogging depths was investigated to determine the input precipitation parameters as 12 hourly precipitations less duration of input precipitation results in lower accuracy of the models and the hourly precipitation as input parameters is prior to the cumulative precipitation for the same duration in most machine learning algorithms the data of non numerical features cannot be directly employed therefore the weights were set to characterize the waterlogging risk levels based on the relative proportion of records of waterlogging depths in each risk level and the proportion of the area of each risk level to the whole area the terrain elevation is characterized by the average elevations at different distances the four ensemble machine learning algorithms automl catboost xgboost bpdnn were compared due to the advantages of the automl catboost and xgboost in data feature extraction the accuracy of the models constructed by the above three ensemble algorithms are higher than that by bpdnn among the automl catboost xgboost automl is prior to catboost and xgboost in accuracy owing to the methods in feature extraction and optimized selection of automl the forecast and comprehensive analysis of waterlogging depths by automl were coherent to the monitoring waterlogging depths with the r2 and nse larger than 0 89 the models have a good performance on forecasting and comprehensive analyzing waterlogging depths at 145 monitor stations for the four typical heavy precipitation processes in 2019 in independent test the models run fast it tested on a 4 core 8g ram cpu and cost less than 1 min for a spatial resolution of 1 km in downtown area of tianjin which is roughly a 90 x 80 rectangle meshgrid and can be applied in nowcasting operations however the hazard precipitation is mainly short time heavy rainfall mostly in three hours in tianjin with occasionally long time precipitation about 12 h moreover the monitor stations located in plain areas therefore the models are suitable for the plain area where short time heavy rainfall is the main characteristic of precipitation as for the area with large topographic differences for example mountain area the model is to be tested the forecast accuracy of waterlogging depth is closely related to the accuracy of forecast and comprehensive analysis of precipitation as the lead time of precipitation increases the accuracy of the forecast precipitation decreases significantly table 5 and so does the accuracy of the forecast waterlogging depths credit authorship contribution statement yuchen guo conceptualization methodology formal analysis data curation resources validation writing original draft project administration lihong quan investigation validation formal analysis data curation writing original draft supervision project administration funding acquisition lili song resources writing review editing funding acquisition hao liang project administration resources declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests national key r d program project 2018yfc1507800 tianjin science and technology major special project and engineering 17zxcxsf00060 science and technology project of state grid corporation of china 5200 202056140a 0 0 00 acknowledgments as the corresponding author i would like to express my gratitude to national key r d program project 2018yfc1507800 tianjin science and technology major special project and engineering 17zxcxsf00060 and science and technology project of state grid corporation of china 5200 202056140a 0 0 00 for providing financial support for this research project 
3779,urban waterlogging often causes urban disasters and the rapid early warning and comprehensive analysis of the urban waterlogging can help disaster defenses however the warning of waterlogging through the monitoring data cannot give grid distribution and the forecast of hydrological models cannot ensure rapid early warning to obtain a grid rapid early warning result for a region like an urban area a method needs to be proposed which can meet the above problems in this research automl automatic machine learning based on genetic algorithm was recommended to construct the rapid early warning and comprehensive analysis models for urban waterlogging by compared with the other three machine learning algorithms catboost categorical boosting xgboost extreme gradient boosting and bpdnn back propagation deep learning neural network in the models the forecast and historical precipitation obtained from the integrated nowcasting through comprehensive analysis system inca the difference of elevation and the urban waterlogging risk maps provided by tianjin meteorological administration were employed as the input sources the input precipitation duration was determined as 12 h based on the sensitivity analysis of the influence of various precipitation duration on waterlogging depths due to the non digital discrete dataset features the urban waterlogging risk maps were transformed to the weight of each corresponding risk level according to the area of each risk level and the number of samples falling in each risk level the difference of elevation was characterized by the average elevations of various distances from the points of concern the output waterlogging depths were compared with the waterlogging depths monitored in tianjin china whose quality was controlled by eliminating the records of the waterlogging depths lasting for a long time after the end of rainfall the comparison of the models constructed by different methods demonstrated that the automl performed better nse and r2 0 92 cc 0 95 rmse1 1 1 9 cm than the other three models the forecast waterlogging depths by automl was also coherent with the monitoring waterlogging depths nse and r2 0 9 cc 0 95 rmse 1 7 2 2 cm for that local topography and waterlogging risk are considered the automl models can be used in the area without the monitoring of water level quickly predict waterlogging depths and give spatial grid results for rapidly early warning keywords urban waterlogging automatic machine learning algorithm based on genetic algorithms rapid early warning xgboost catboost bpdnn comprehensive analysis abbreviations automl automatic machine learning algorithm based on genetic algorithms 1 introduction urban waterlogging is an urban disaster mostly induced by heavy precipitation which affects the normal functioning of the city damages the urban ecological environment and even causes serious economic losses and human casualties the formation of urban waterlogging is closely related to climate change and urbanization quan 2014 wang et al 2017 global warming accelerates the urban hydrology cycle while rapid urbanization reduces the natural infiltration storage as well as retention capacity of the underlying surface resulting in increased surface runoff production and shorter confluence time jiao et al 2019 urban waterlogging is of high frequency susceptibility and spatial diversity in the rainy season the precipitation duration is related to the waterlogging duration and the maximum precipitation has a positive correlation with the waterlogging area and depth jiao et al 2019 therefore the prediction and warning of urban waterlogging requires comprehensive consideration of precipitation and its duration topography the type of underlying surfaces and the capacity of the urban drainage network and so on since china proposed the sponge city construction plan in 2013 sang and yang 2017 wang et al 2018 a large number of water level monitoring stations have been planned and established in large and medium sized cities in china which has been applied in the warning of waterlogging disaster yang et al 2014 however the warning of waterlogging based on the monitoring waterlogging depths hardly plays a role in providing an early warning to guide disaster prevention a variety of hydrological models e g swmm mouse pwri mike etc can simulate urban waterlogging caused by heavy precipitation and provide the warning of waterlogging by combining the predicted precipitation su et al 2016 however most hydrological models take a long computation time so that they often fail to provide warning in time for the waterlogging caused by burst rainstorms moreover the input data for the hydrological models are complex including detailed pipe network data water system distribution road and street distribution etc which makes them difficult to be applied regularly machine learning is characterized as fast and flexible and has been applied in forecasting flood or waterlogging in hydrology field the development machine learning method is over 20 years history early in 1990s a back propagation neural network based model has been proposed to perform river flood forecasting campolo et al 1999 immediately following the development of machine learning more structures were invented and applied in hydrology chen propose a decision group back propagation neural network for flood forecasting chen et al 2010 and there are rnn based models chen et al 2013 chang et al 2014 applied for urban flood control or flood forecasting as well as lstm based model fang et al 2020 and cnn based model kabir et al 2020 are all proposed for urban flood forecasting and relative area in recent years back to 2012 ensemble methods in ml have attract a great attention of the scientific community kazienko et al 2013 the basic principle of the ensemble model is to turn multiple weak learners into strong learners based on meta learning or simply averaging it is stated and proven that ensemble learning can overcome related shortcomings of ordinary learning of ml models including statistical problems when the search space is too large for the available training data computational problems where the learning algorithm fails to find the optimum solution and representation problems when the learning algorithms lack appropriate fitness functions zounemat kermani et al 2021 especially while dealing with high dimensional complex regression and classification problems in the last four years 2018 2021 more and more ensemble machine learning methods with have been applied in hydrology field yin et al 2018 berkhahn et al 2019 wei et al 2020 specially boost algorithms have been employed in several studies shafizadeh moghadam et al 2018 implemented for flood susceptibility assessment several statistical and machine learning models as well as seven ensemble approaches hossein 2018 their findings revealed that the boosted regression trees model was superior to the individual machine learning models mars cart ann and etc korean researcher kim kim et al 2020 with his team in 2020 explore the daily streamflow based on different antecedent times series forecasting by compared with mars m5tree and average ensemble machine leaning models aeml which shows that aeml is superior to m5tree and mars tree based model mirzaei and his team proved that xgboost is better than other ensemble methods in flood susceptibility assessment mirzaei et al 2021 with the introduction of some tricks the original bpdnn can be treated as an ensemble model of multiple nonlinear models by adding activation functions and dropout layers but these ensemble based models lack preprocessing and feature selection capabilities even the latest algorithm catboost are simply preprocessing data by using one hot how to adequately mine the data and find more effective features another solution is mentioned which is hybrid model like the anfis a p c n et al 2004 lstm alo yuan et al 2018 or lssvm gsa adnan et al 2017 which get good performance in hydrological time series focus more on data preprocess and feature selection combining and how to combine hybrid models ability to process data and select features with ensemble models become questions thus an idea was put forward that those machines create new neural networks by themselves during meta learning the corresponding algorithms are called automatic machine learning automatic machine learning tries to automatize the steps of feature extraction model and algorithm selection parameter optimization and so on so that it needs no human assistance and avoids man made bias one framework of the automatic machine learning would be used in this research which called automatic machine learning based on genetic algorithm automl le et al 2020 the automl first applies on rna seq expression and the first time applies in hydrology hence it would be compared with other ensemble model which has been proven good performance in hydrology xgboost the ability to match xgboost in other field catboost and deep learning neural network which has the similar structure with ensemble machine learning models bpdnn tianjin is a big coastal city in north china where is the confluence of a few of rivers it confronts upstream flood waterlogging resulted from heavy rainfall and tide during flood season which can easily cause waterlogging disasters in central tianjin city therefore the early warning and comprehensive analysis models for urban waterlogging were established with the automl algorithm based on the experimental comparison with the other three ensemble models catboost xgboost bpdnn given the combined effect of multiple factors on urban waterlogging the models used the parameters related to precipitation topography urban waterlogging risk maps in tianjin china as input the operational forecast and comprehensive analysis of precipitation made sure to quickly generate information of water depths to save more valuable time for the arrangement of disaster defense 2 data sources the data used in the model construction include the monitoring waterlogging depths the forecast and comprehensive analysis of precipitation as well as the static data including the topographic elevation and urban waterlogging risk maps in tianjin 2 1 the waterlogging depth monitoring data most cities in china have established an urban waterlogging monitoring network based on internet of things iot technology to monitor the waterlogging depth in real time in tianjin waterlogging monitoring equipment was installed inside streetlight poles monitoring poles and signal base stations and thin film pressure sensors were placed in parallel to the ground at the shoulder of the road for waterlogging monitoring the waterlogging monitoring data used in this paper are data collected from 25 waterlogging monitoring stations established in 2018 which will be used in models training and validation and from 145 waterlogging monitoring stations established in 2019 in tianjin which will be used in independent test in section 5 fig 1 the original sample interval is 5 min in total there were over 8 000 records of waterlogging depth in 2018 while only 3 124 records were within 5 min before and after the hours the waterlogging depths were less than 10 cm in most times and the waterlogging depths of 10 cm 20 cm 20 cm 30 cm 30 cm 40 cm and above 40 cm were 12 5 4 9 3 3 and 6 0 of the records respectively the recorded maximum waterlogging depth was 80 cm occurred during the heavy precipitation on 23 24 july when the maximum accumulated precipitation at the monitoring stations was 210 5 mm waterlogging depth monitoring data during four typical heavy precipitation processes in 2019 26 27 may 22 23 july 1 2 august and 9 10 august were selected for further independent test the maximum waterlogging depths for these four processes were 28 8 cm 43 5 cm 57 2 cm and 36 8 cm respectively the heavy precipitation on 26 27 may concentrated in 1 h with maximum hourly precipitation of 33 7 mm the heavy precipitation on 22 23 july concentrated in 3 h with the maximum 1 h 2 h and 3 h precipitations of 51 1 mm 64 2 mm and 107 6 mm respectively the maximum 1 h and 2 h precipitations on 1 2 august were 61 7 mm and 81 5 mm respectively on 9 10 august the maximum 1 h and 2 h precipitations were 53 8 mm and 62 5 mm respectively 2 2 the comprehensive analysis and forecast precipitation the comprehensive analysis and forecast precipitation are derived from inca haiden et al 2011 with a spatial resolution of 1 km and a temporal resolution of 10 min inca is nowcasting and comprehensive analysis system developed by the austrian national meteorological service recommended by inca ce the world weather research program forecasting demonstration project and applied in more than a dozen countries and regions the comprehensive analysis of precipitation combines the data collected from radars and ground weather stations while the forecast precipitation is the extrapolated results which merge the forecasting data from numerical weather prediction models such as rmaps grapes meso ec and other ensemble forecasts and the precipitation data collected from ground weather stations radars and satellites the nearest neighbor method was used to extract the precipitation for each of the waterlogging depth monitoring stations from the forecast and comprehensive analysis of precipitation from the precipitations and waterlogging depths at different monitoring stations table 1 though the precipitation time series are similar at some stations e g monitoring stations 1 and 2 monitoring stations 5 and 6 the waterlogging depths can be significantly different from each other due to the differences in waterlogging risk level and local topography similarly when the waterlogging depths are similar at some stations e g monitoring stations 2 and 6 monitoring stations 1 3 4 and 5 the characteristics of precipitation can also be significantly different according to the statistics of the comprehensive analysis of precipitation at waterlogging monitoring stations from may to september in 2018 heavy precipitation prone period the number of rain days day precipitation 0 1 mm at each monitoring station ranged from 34 to 46 the number of days with day precipitation 10 mm ranged from 5 to 15 the number of days with day precipitation 25 mm ranged from 1 to 5 and the number of days with day precipitation 50 mm ranged from 1 to 3 the vast majority of monitoring stations experienced heavy rainstorms and the maximum cumulative precipitation exceeded 200 mm the maximum 1 h 2 h 3 h 6 h 12 h cumulative precipitations in all processes were 51 3 mm 85 1 mm 95 5 mm 145 4 mm and 208 8 mm respectively the duration of rainfall was usually not 12 h and the longest duration is 16 h on 24 july from may to september in 2019 the number of rain days at the monitoring stations ranged from 40 to 63 the number of days with day precipitation 10 mm ranged from 10 to 14 the number of days with day precipitation 25 mm ranged from 2 to 8 and the number of days with day precipitation 50 mm ranged from 1 to 4 only a few monitoring stations experienced rainstorms with maximum cumulative precipitation of 120 3 mm for all precipitation events the maximum 1 h 2 h 3 h 6 h 12 h cumulative precipitation are 61 7 mm 107 7 mm 113 5 mm 120 1 mm 120 3 mm respectively heavy rainfall persists within 6 h in most cases 2 3 static data the urban waterlogging risk maps fig 2 and topographic elevation data ping fig 3 of tianjin city were also collected the waterlogging risk maps provided by tianjin meteorological administration were made through the combination of the inundation extents and depths of various return periods and the population distribution based on the minute level precipitation data of tianjin and the characteristics of urban waterlogging during typical heavy precipitation simulated by the urban hydrological model the topographic elevations were extracted from srtm with 90 m spatial resolution 3 introduction to the algorithms 3 1 automatic machine learning algorithm based on genetic algorithm the genetic algorithm based automated machine learning algorithm trang et al 2020 can automatically search for machine learning methods features transform and parameters and compare the different combinations of machine learning algorithms and parameters to select the optimal deep machine learning model from thousands of possible pipelines and the combinations of hyperparameters in a genetic algorithm like manner the framework of this algorithm is shown in fig 4 in the dashed box is the tree based pipeline optimization tool tpot process an automated machine learning application package written in python that applies a genetic algorithm for selecting the feature and algorithmic model to generate machine learning code automl genetic algorithm is a computational model of biological evolutionary processes that simulate the darwinian mechanisms of natural selection and genetics which is an iterative optimization method with the idea of creating children based on the features parameters of the parents at the end of each iteration each model is scored and the most suitable machine learning pipeline for the project is picked out from the initial pipelines or the pipelines of the previous iteration and fused into a new combined pipeline based on the 12 machine learning regressors 14 preprocessors and 4 feature selectors at the same time the optimal hyperparameters and pipelines are selected as the pipeline of the final model through a certain number of iterations the framework of the model screening process is shown in fig 5 the steps of genetic planning are as follows ① initialization random initialize 100 tree based pipelines and evaluates their balanced cross validation accuracy on the dataset ② elimination selects the top 20 pipelines in the population according to the nsga ii selection scheme where pipelines are selected to simultaneously maximize classification regression accuracy on the dataset while minimizing the number of operators in the pipeline ③ splitting a total of 100 pipelines i e 5 copies of the 20 pipelines obtained from ② are conducted as initialized offspring ④ mutation 5 of the offspring swap the operators on the pipeline with another 5 of the offspring the remaining 90 of the offspring have performed the add subtract and transfer operators with equal probability 1 3 ⑤ go to step ② and repeat the process 100 times if the algorithm is configured as above i e 100 100 10000 pipelines must be trained it will be very time consuming therefore in tpot the training can be interrupted at any time and the current optimal pipeline will be output moreover tpot provides the warm start parameters to continue at the break points 3 2 catboost algorithm categorical boosting the catboost algorithm a machine learning library opened by russian search giant yandex in 2017 is a member of the boosting algorithm family similar to xgboost extreme gbdt and lightgbm light gradient boosting machine the catboost algorithm is still an improved implementation under the gbdt gradient boosting decision tree algorithm framework catboost is a gbdt framework based on the oblivious trees algorithm with fewer parameters supporting category based variables and high accuracy and mainly addresses the efficient and reasonable processing of the category features in addition catboost also solves the problems of gradient bias and prediction shift thereby it reduces the occurrence of overfitting and improves the accuracy and generalization ability of the algorithm prokhorenkova et al 2017 dorogush et al 2018 catboost automatically deals with categorical features in a special approach firstly the statistics of category features are performed by counting the occurrence of a certain category then the hyperparameters are added to generate new numerical features the category features are not numerical but discrete sets such as the risk levels in this research in gradient boosting algorithms these categorical features are usually converted to one or more numerical features for gbdt the simplest way is to replace the categorical features with the average value of their corresponding labels in a decision tree the average value of the labels will be used as the criterion for node splitting an approach known as greedy target based statistics greedy ts an obvious drawback of this approach is that features usually contain more information than labels which can result in a conditional bias problem when the structure and distribution of the data are different between the training and test datasets if the average values of the labels are forced to represent the features catboost applies ordered boost into avoiding the bias of gradient estimation and thus solves the problem of prediction shift like all standard gradient boosting algorithms catboost fits the gradient of the current model by constructing a new tree however all classical boosting algorithms suffer from an overfitting problem caused by biased pointwise gradient estimates the gradients used in each step are estimated with the same data points from the current model which results in the deviation between the distribution of the estimated gradients and the true distribution of the gradients in any domain of the feature space in addition the prediction shift also includes the target leakage caused by applying ts into the process of category features to address the gradient bias and prediction shift catboost improved the classical gradient boosting algorithm many algorithms that utilize gbdt techniques e g xgboost lightgbm construct the next tree in two stages selecting the tree structure and calculating the values at the leaf nodes after fixing the tree structure to select the best tree structure the algorithm constructs the tree by enumerating different splits then the algorithm calculates values at the resulting leaf nodes calculating scores of the resulting trees and finally selecting the best split the values at the leaf nodes in both stages are calculated as an approximation to the gradient or newton step length in catboost unbiased estimation of the gradient step is applied for the first stage and the traditional gbdt scheme is applied in the second stage in addition by the combination of category features catboost allows the application of the links between features which greatly enriches the feature dimension catboost s base model uses oblivious tree and calculates the leaf value in the way different from the traditional boosting algorithm which calculates the average all of these improvements can prevent the model from being overfitted 3 3 xgboost algorithm extreme gradient boosting the xgboost algorithm an open machine learning source developed by tianqi chen et al and widely used efficiently implements the gbdt algorithm with the improvements of algorithms and engineering applications li et al 2017 kadiyala and kumar 2018 zheng and wu 2019 pathak et al 2020 xgboost is essentially a gbdt but significantly improved in speed and efficiency ① for that the traditional greedy method of enumerating all possible split nodes of each feature is too inefficient xgboost implements an approximate algorithm to find the best split node the general idea of which is to enumerate several possible candidates for the split note with the percentile method and then find the best split node from the candidates according to the formula finding the split node ② considering that the training data can be sparse xgboost can specify the default direction of branches for missing values or specified values which can greatly improve the efficiency of the algorithm ③ the feature columns are sorted and stored in memory as blocks which can be reused in iterations although the boosting algorithm must iterate serially it can process each feature column in parallel ④ xgboost can improve the efficiency of the algorithm by firstly collecting the data into a buffer inside the thread and then computing it ⑤ xgboost also considers how to efficiently use disk to improve the efficiency of the algorithm as much as possible when the amount of data is large and memory is not enough including multi threading combination data compression and slicing methods in contrast to gbdt instead of simply combining several cart trees repeatedly xgboost uses an additive model that takes the error generated by the model s last prediction a model made by combining the t 1 trees as a reference for the next tree the t tree i e the residual error between the model s predicted and actual values is used as the input data for the next tree and so on with each tree added its loss function decreases continuously in addition xgboost introduces a regular term in the loss function to control the complexity of the tree and prevent overfitting a second order taylor expansion is used to make the objective function closer to the true loss function and weighted quantile sketch is used to select split nodes which grows dynamically through structural scoring and splitting losses 3 4 back propagation deep learning neural network bpdnn the bp neural network proposed in 1986 by a group of scientists led by rumelhart and mcclelland is a multi layer feed forward network trained according to an error back propagation algorithm the learning rule is to use the fastest descent method to continuously adjust the weights and thresholds of the network by backpropagation to minimize the sum of squared errors of the network the loss is firstly obtained by forward propagation the final output and the loss between the output and actual values are calculated according to the input samples the given initialized weight w and the bias term b then the error is backpropagated the output is backpropagated every layer in some way through the hidden layers to the input layer and the error is apportioned to all units in each layer so that the error signal of each unit in each layer is obtained which is the basis to correct each unit s weight with the development of machine learning in recent years the bpdnn model has been improved in which the introduction of dropout activation function batch normalization and early stopoing and more advanced optimization functions adam have made bpdnn more complex and better performance the introduction of dropout for example makes the model s robust performance improved and also can be seen as a group of bp models ensemble and the introduction of activation functions such as relu selu and leakyrelu makes the original linear model into a nonlinear model and because the bp neural network itself has multi layer features to some extent also makes the ensemble model has a more complex structure 4 model construction and comparative analysis 4 1 sample selection the most impact factors on waterlogging are considered in the study of the waterlogging risk in most cities so that the waterlogging risk maps were chosen as one of the input sources of the model however in respect of the prediction or simulation of waterlogging depths the waterlogging risk levels are relatively coarse the waterlogging locations and depths in an area with the same drainage conditions are closely related to the topography thus the topographic elevation is also considered as an input source of the model heavy rain is an important factor contributing to waterlogging and therefore precipitation factors for example amount and duration of precipitation are also considered as the model input source the above sources are fed into each machine learning model to obtain the correlation models of waterlogging depth and precipitation topography waterlogging risk i e the comprehensive analysis and forecast models of waterlogging depth for the comprehensive analysis models of waterlogging depth only the comprehensive analysis precipitation with a certain duration is input for the forecast models of waterlogging depth the precipitation from the forecast time back to a certain time are input the hourly precipitation time series at each waterlogging depth monitoring station was extracted from the comprehensive analysis and nowcasting grid precipitation as input precipitation though waterlogging depths were sampled at each 5 min for all monitoring stations only the hour data can be used to consist with the hourly precipitation if only the hour data was selected it would lose a lot of effective training samples therefore the time tolerance interval was set to 5 min that is the data 5 min before and after the hour data were also treated as hourly data for getting more effective samples the spatial resolution of the topographic elevation is 90 m the elevation at a waterlogging site is set as d0 the average elevation at 90 m away from the site is set as d1 the average elevation at 270 m away from the site is set as d2 and the average elevation at 450 m away from the site is set as d3 the four elevation parameters are the input elevation parameters of the models according to the waterlogging risk maps the waterlogging risk levels are divided into 6 levels the ratio of waterlogging depths recorded in the area of each risk level is set as pdi and the ratio of the area of each risk level to the whole area is set as pai set the weight wi to make pdi pai wi const i 1 2 3 4 5 6 in which the weight of the area of no waterlogging risk is 0 according to the rule the weights wi were determined as 0 0 25 0 5 0 8 4 5 for 1 6 levels and applied as the input parameters of the risk levels to verify the models 75 of the data was set as a training set and the other 25 of the data was set as a test set through a random sampling method the random sampling method is random select through 51 events which divided by day such allocation is made to maintain similar statistic characteristics 2 343 about 75 monitoring waterlogging depths and precipitation at all stations in 2018 were finally selected as the training set and the other 781 about 25 monitoring waterlogging depths and precipitation were used as the testing set and data in 2019 was set as a validation set for independent inspection 4 2 model parameter settings the parameters of the automl are set as follows the number of iterations for creating offspring new individuals generation 100 the initial number of created individuals population size 100 the number of new required individuals per generation offspring size 100 the mutation rate i e the probability of a random change in the value of an attribute mutation rate 0 9 the percentage of individuals for creating offspring crossover rate 0 1 to find the optimal hyperparameters and results a grid search method table 2 was applied to catboost and xgboost for the catboost algorithm max depth and learning rate were put into the grid search meanwhile the early stopping also activated when training the model what is more the different loss functions were also applied into the model to get the optimal results catboost has its own function to process the categorical features so the waterlogging risk levels are put into the catboost s automatically feature extraction model for the xgboost algorithm max depth learning rate gamma and min child weight was all put into grid searching also early stopping was activated in xgboost the final parameters of the algorithms are as follows for the catboost algorithm cat features waterlogging risk levels max depth 9 n estimators 600 loss function rmse for the xgboost algorithm max depth 9 n estimators 500 learning rate 0 01 gamma 0 9 min chid weight 6 for the bpdnn a three hidden layer network with 500 iterations was employed which has 128 neurons in the first layer relu as activation function and 256 neurons in the second layer relu as activation function as well as 512 neurons in the third layer relu as activation function with adam as the optimization function and mean squared error as the loss function to reduce the time consuming and find optimal result the weight decay start learning rate 0 01 decay factor 0 8 patience 5 and min delta 1 10 8 and early stopping patience 20 were also applied in the model to prevent the overfitting the dropout 0 2 layer added before the final output layer in the experiment the deep layer network was also tested however the result did not perform better compared with the there hidden layer network as a result a three hidden layer network was applied in this paper 4 3 performance evaluation parameters to evaluate the performance of various models the statistical evaluation criteria would be used in the following which are nash sutcliffe model efficiency coefficient nse r square r2 and correlation coefficient cc for evaluating the predicting ability of models mean absolute percentage error mape for evaluating the dispersion between prediction and ground true root mean square error rmse for evaluate the bias between prediction and ground true from the paper by moriasi et al model can be said to be satisfactorily accurate when nse 0 5 good when nse 0 7 very good when nse 0 8 moriasi et al 2007 r2 follows the same pattern as nse cc always gives a better result compared with nse and r2 but still be regard as a criterion for evaluating the predictive power of models as for the forecast precipitation results of inca 1 2 h lead time we used the ts threat score for different levels of precipitation 1 cc i 1 n f i f o i o i 1 n f i f 2 i 1 n o i o 2 2 r 2 1 n i 1 n f i o 2 n 1 i 1 n o i o 2 3 mape 1 n i 1 n f i o i o i 4 rmse 1 n i 1 n f i o i 2 1 2 5 nse 1 i 1 n f i o i i 1 n o i o 2 4 4 data cleaning the investigation of the monitoring waterlogging depths and the corresponding precipitation showed that two possibilities were attributing to the discrete points one is the too short time of the input precipitation because in some cases precipitation was discontinuous and can still impact the subsequent waterlogging process the other is unreasonable data in the monitoring waterlogging depths i e fluctuating water depths were still recorded for a long time after the end of precipitation fig 6 for the first possibility a detailed analysis was provided in the next section for the second possibility the monitoring waterlogging depths were cleaned the data of monitoring waterlogging depths after 12 h from the end of precipitation were removed 4 5 the sensitivity test of precipitation parameters the influence of data quality was tested through the automl by comparing the comprehensive analysis waterlogging depths with and without data cleaning firstly the 1 h comprehensive analysis of precipitation and monitoring waterlogging depths without cleaning were used to construct the model compared the waterlogging depths simulated by the model with the monitoring waterlogging depths fig 7 we got that the r2 0 6703 nse 0 6797 cc 0 8277 rmse 4 9495 mape 0 3729 from fig 7 there are some discrete points for example those inside the red circles in fig 7 then the 1 h comprehensive analysis of precipitation and cleaned waterlogging depths were used to construct the model the relationship between the simulated waterlogging depths by the model and monitoring waterlogging depths was shown in fig 8 from fig 8 the dispersed points became less the statistical evaluation criteria performed better as the r2 nse cc increased to 0 8753 0 7197 0 7643 separately unfilter 0 8277 0 603 0 6797 and mape decreased by 6 rmse decreased to 4 3929 unfilter 4 9495 to find the best duration of precipitation input for the model we evaluate the correlation coefficients between cumulative precipitation and waterlogging depths were shown in fig 9 according to the method in chang et al 2014 within 3 h the correlation coefficients between cumulative precipitation and waterlogging depths increase rapidly with the increasing duration of precipitation as for 3 12 h the correlation coefficients between cumulative precipitation and waterlogging depths increase slowly with the increasing duration of precipitation for 12 24 h the correlation coefficients between cumulative precipitation and waterlogging depths decrease gradually with the increased duration of precipitation according to the statistics of the tianjin urban precipitation provided by tianjin meteorology administration the duration of short time heavy precipitation in tianjin is generally within 3 h therefore the 1 h 3 h and 12 h precipitations were chosen as inputs for further study of the effect of precipitation duration the different precipitation including 1 h precipitation 3 h cumulative precipitation 3 h hourly precipitation process cumulative precipitation 12 h hourly precipitation were applied to constructing the comprehensive analysis models for further study the simulated waterlogging depths were compared with the monitoring waterlogging depths as shown in table 3 table 4 and fig 10 fig 8 fig 7 as seen in the figures and the tables the parametric scheme for the time series of precipitation gives better results than the parametric scheme for the accumulation of precipitation the result with input of the 12 h hourly precipitation showed the best correlation the maximum nse r2 and cc to the monitoring waterlogging depths with the smallest errors the minimum rmse and the fewest dispersion the minimum mape no matter in automl catboost xgboost or bpdnn therefore 12 h hourly precipitation was finally chosen as the input precipitation parameters for the comprehensive analysis and forecasting models more discussion about model comparison is expanded in section 4 6 4 6 comparison of the four models the four models were constructed through the four algorithms automl catboost xgboost and bpdnn in which the input precipitation parameters were the comprehensive analysis of 5 parameterization options 1 h precipitation 3 h cumulative precipitation 3 h hourly precipitation process cumulative precipitation 12 h hourly precipitation the waterlogging depths obtained from the four models were compared with the monitoring waterlogging depths as shown in table 3 and table 4 from the tables the automl model with parameterization scheme 12 h hourly precipitation works best and give the highest score of all four models in all five criteria nse 0 9588 r2 0 9581 cc 0 9793 mape 0 1737 rmse 1 8377 following were catboost and xgboost which are both with parameterization scheme 12 h hourly precipitation as for the bpdnn the best parameterization scheme result is worse than other parametric solutions with moderate results of other models furthermore violin chat hintze and nelson 1998 was also introduced to compare the more detail of the simulated and monitoring water depths from the violin chart fig 11 with parameterization scheme 12 h hourly precipitation the inversion distribution of automl is the most similar to the observation the inversion distribution of xgboost and catboost rank the second and third bpdnn ranks the last in general automl performed the best no matter in which kind of parameterization scheme above five parameterization scheme 12 h hourly precipitation will be used as the final parameterization in inversion models and further application in prediction models bpdnn algorithm is suitable for the learning of big data and multi parameter inputs for the learning of small data it is more likely to overfit the small data and underfit the target task the samples of extremely heavy precipitation were smaller and the distribution of whole data is uneven which resulted in the lower weight of the extreme and the more moderate results for the extreme condition as shown in fig 12 during the precipitation process on 24th july 2018 the waterlogging depths given by the bpdnn algorithm were smaller than both the monitoring waterlogging depths and those simulated by the ensemble algorithms at 4o clock and 11 12 while the results were on the contrary at 6o clock although structurally the dropout layer in the model allows the bpdnn to be considered as a combination of multiple bpdnns of equal depth this ensemble approach is a simple stitching of multiple models which is not effective in data feature mining for the boost algorithms a very important capability is the mining of data features for xgboost catboost and the automl each iteration adds a tree to the existing trees to fit the residuals between the prediction of the existing trees and true values and the new tree will increase a new pattern in respect of feature quantities regardless of the precipitation process moreover the generalization ability of the models is improved due to the addition of the regular term the automl applies methods such as rbfsampler and pca into the classification of data which can improve the mining of the features therefore the automl algorithm can construct a better model than the xgboost and catboost algorithms the catboost algorithm has different choices of scoring functions from the xgboost algorithm the catboost algorithm not only inherits the scoring function in the xgboost algorithm but also extends it with other scoring functions to determine whether the leaves are split or not and introduces gradient information to guide the split of the base trees instead of the gini coefficients used in the cart tree the flexibility of the evaluation metrics and the ability of the catboost algorithm to effectively handle category based features allow catboost more ability to learn than xgboost therefore the results from the model trained by the catboost algorithm are more consistent with the monitoring waterlogging depths 4 7 the waterlogging depth prediction model considering the difference between the predicted precipitation and the comprehensive analysis precipitation a prediction model of waterlogging depth was constructed by the automl with the nowcasting and comprehensive analysis precipitation ts is usually used to evaluate the accuracy of nowcasting precipitation it is defined as 6 ts correct forecast o b s e r v e d c o r r e c t for a perfect forecast correct forecast observed to yield a ts of 1 the worst possible forecast with correct 0 yields a ts of zero the ts evaluation of the nowcasting precipitation obtained from inca as table 5 showed that nowcasting results of tianjin urban area in 2019 for 1 h lead time performed well as for 2 h lead time the result turned worse therefore only the forecast model of water depths in 1 h lead time was established the forecast and comprehensive analysis of precipitation were combined for the forecast of waterlogging depths for example the future 1 h forecast precipitation and 11 h comprehensive analysis precipitation in the past were used to build the prediction model of the future 1 h the results obtained from the model showed good coherence to the monitoring waterlogging depths fig 13 and the last column in table 3 with the r2 of approximately 0 90 nse of approximately 0 90 cc of approximately 0 95 rmse of about 2 8 cm mape of about 15 9 the forecast model demonstrated good forecasting ability in 1 h lead time the result represented that this model could be applied in forecasting applications moreover we compared the automl forecast model with other related nowcasting model chang et al 2014 the 1 h lead time show outstanding results compared with other methods ann narx of 1 h lead time no matter in nse cc or rmse 5 independent testing of the models to test the spatial or temporal robustness of the models for comprehensive analyzed and forecast waterlogging depths we need independent test with the expansion of observation points has increased from 25 in 2018 to 145 stations in 20 199 fig 1 it provided more new observation dataset which are independent both in time and in space in the study area we pick four heavy precipitation processes on 26 27 may 23 24 july 2 3 august and 9 10 august in 2019 which is independent of training and testing dataset in 2018 fig 14 and fig 15 selected hourly dataset from precipitation and waterlogging depths and applied into automl which performance the best of four compared models and take 12 h hourly time series as the precipitation input the results are as follows the comprehensively analyzed waterlogging depths are coherent to the monitoring waterlogging depths with the r2 above 0 93 nse above 0 92 cc above 0 96 rmse of 1 1 1 9 cm and mape less than 10 the forecast waterlogging depths are also consistent with the monitoring waterlogging depths with r2 above 0 89 nse above 0 89 the cc above 0 94 rmse of 1 7 2 2 cm and mape less than 26 as the automl model was build based on 25 waterlogging monitoring sites in 2018 and the application was based on 145 monitoring stations in 2019 the results showed that the model was robust no matter in spatial or in temporal 6 conclusion urban waterlogging is related to the factors such as precipitation and its duration terrain and topography the type of underlying surface the capacity of the urban drainage network and so on these factors should be comprehensively considered in the prediction and inversion of waterlogging depths on the basis of the comparison of the four algorithms automl xgboost catboost bpdnn the automl algorithm was recommended to construct the forecast and comprehensive analysis models of waterlogging depths for its better performance the input data of the models were the observations of waterlogging depths monitoring at 25 monitor stations in tianjin in 2018 the waterlogging risk maps terrain elevation and the precipitation forecast and real time analyzed by inca the quality of the data and the selection of precipitation parameters had a significant impact on the accuracy of the models given the relationship between precipitation and waterlogging depths the data of waterlogging depths recorded for a long time after the end of precipitation were removed which significantly improved the accuracy of the models the influence of the duration of precipitation on the waterlogging depths was investigated to determine the input precipitation parameters as 12 hourly precipitations less duration of input precipitation results in lower accuracy of the models and the hourly precipitation as input parameters is prior to the cumulative precipitation for the same duration in most machine learning algorithms the data of non numerical features cannot be directly employed therefore the weights were set to characterize the waterlogging risk levels based on the relative proportion of records of waterlogging depths in each risk level and the proportion of the area of each risk level to the whole area the terrain elevation is characterized by the average elevations at different distances the four ensemble machine learning algorithms automl catboost xgboost bpdnn were compared due to the advantages of the automl catboost and xgboost in data feature extraction the accuracy of the models constructed by the above three ensemble algorithms are higher than that by bpdnn among the automl catboost xgboost automl is prior to catboost and xgboost in accuracy owing to the methods in feature extraction and optimized selection of automl the forecast and comprehensive analysis of waterlogging depths by automl were coherent to the monitoring waterlogging depths with the r2 and nse larger than 0 89 the models have a good performance on forecasting and comprehensive analyzing waterlogging depths at 145 monitor stations for the four typical heavy precipitation processes in 2019 in independent test the models run fast it tested on a 4 core 8g ram cpu and cost less than 1 min for a spatial resolution of 1 km in downtown area of tianjin which is roughly a 90 x 80 rectangle meshgrid and can be applied in nowcasting operations however the hazard precipitation is mainly short time heavy rainfall mostly in three hours in tianjin with occasionally long time precipitation about 12 h moreover the monitor stations located in plain areas therefore the models are suitable for the plain area where short time heavy rainfall is the main characteristic of precipitation as for the area with large topographic differences for example mountain area the model is to be tested the forecast accuracy of waterlogging depth is closely related to the accuracy of forecast and comprehensive analysis of precipitation as the lead time of precipitation increases the accuracy of the forecast precipitation decreases significantly table 5 and so does the accuracy of the forecast waterlogging depths credit authorship contribution statement yuchen guo conceptualization methodology formal analysis data curation resources validation writing original draft project administration lihong quan investigation validation formal analysis data curation writing original draft supervision project administration funding acquisition lili song resources writing review editing funding acquisition hao liang project administration resources declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests national key r d program project 2018yfc1507800 tianjin science and technology major special project and engineering 17zxcxsf00060 science and technology project of state grid corporation of china 5200 202056140a 0 0 00 acknowledgments as the corresponding author i would like to express my gratitude to national key r d program project 2018yfc1507800 tianjin science and technology major special project and engineering 17zxcxsf00060 and science and technology project of state grid corporation of china 5200 202056140a 0 0 00 for providing financial support for this research project 
