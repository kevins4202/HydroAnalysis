index,text
6370,this paper focuses on water allocation in an irrigation district considering water rights transaction the relationship between the reservoir authority and the sub area managers is explored based on a novel stackelberg nash cournot equilibrium model in this framework the reservoir authority has higher priority in allocating initial water rights to sancha town danjing and xinmin villages after get the decisions from the reservoir authority the sub area managers decide water distribution to multi crops planting areas and water rights transaction with the promise of nash cournot equilibrium then the reservoir authority can modify his decision by stackelberg strategic interaction to obtain the optimal irrigation strategy fuzzy goal programming and genetic algorithm methods are applied in this context a stackelberg nash cournot equilibrium solution can be obtained the proposed model is applied to sancha irrigation area and the results show that more available water can be distributed in sancha town while guaranteeing the equity among the sub areas in this irrigation district more water was utilized for wheat and oilseed rape than paddy and bean which matched the fact that wheat and oilseed rape grow in quarters with relatively less rainfall inflows a changeable and uncertain environment regarding inflow levels planting areas and irrigation coefficient take potential challenges to agricultural irrigation process hence to cope with the challenges cope with the future uncertainty and offer more information on the adjustment of agricultural irrigation patterns scenario technique is applied by changing the three parameters inflow levels planting areas and irrigation coefficient respectively finally to highlight the superiority of the proposed model a comparative analysis is conducted in a situation without considering the water market which verifies the importance and effectiveness of water rights transaction keywords optimal water allocation water market stackelberg nash cournot equilibrium agriculture irrigation district 1 introduction less than 1 of the fresh water on earth can be used directly worse still per capita fresh water in china accounts for only a quarter of that in the world agriculture uses 70 of all fresh water around the world and up to 95 in several developing countries such as china liu et al 2017a b because of the uneven rainfall growing water scarcity has been one of the leading challenges for the field of agriculture the united nations 2017 to be specific water resources allocated to agricultural sector often reach the low limit of demand in arid and semi arid regions li et al 2017 in addition the united nations food and agriculture organization fao warned that demographic trends has added urgency to the issue the united nations 2014 given water scarcity the concern on agriculture irrigation management is intensive china which is known as an agricultural country produces more than 70 of food crops 80 of cotton and 90 of vegetables of the total global production li and guo 2014 which implies that more water resources are used for irrigation as china s population expands so will the demand for water qiu 2010 therefore a new path to agricultural irrigation planning is needed with the increasing water demand fao noted that employing water saving irrigation techniques has the obvious impact on coping with water scarcity in agriculture the united nations 2014 however there is still much work to be done by optimizing the water irrigation pattern in agricultural sector which is seemed as a soft path to achieve food security and sustainable development recently various mathematical programming approaches were successfully applied to water resource management liu et al 2017a tarebari et al 2018 zeng et al 2014 in terms of the agricultural sector qiang et al 2018 optimized the water allocation to different crops of groundwater and surface water fazlali and shourian 2018 studied the optimum water allocation and crop planning problems xie et al 2017 studied agricultural water resource planning with an inexact stochastic fuzzy programming model li et al 2016 optimally allocated limited agricultural water resources to different irrigation areas by maximizing system benefits while minimizing the water shortage penalty dai and li 2013 developed a multistage irrigation water allocation model for planning agricultural activities moradi jalal et al 2007 maximized the annual benefit of the multi crop system over a planning period li and guo 2014 considered the objectives regarding economic social and ecological benefits and then applied the modified multi objective model to a real case study in minqin county gansu province china tan et al 2017 used a multi objective programming method for supporting the optimal use of water resources in agriculture in all the above studies verified that multi objective optimization methods can be effective tools for addressing water allocation under multiple conflicting objectives in the agricultural irrigation system in the previous articles social and economic perspectives are two widely focus when it came to water allocation davijani et al 2016 tan et al 2017 however as time went on equality became one of the most concerns when it comes to multiple participants which may consists of economic social and environmental factors mousavi et al 2017 hence it is vital to consider the equity factor when allocating the initial water rights to each different water users still three major challenges remained for the multi objective programming of water resources in the agriculture irrigation system first the sequential order and strategic interaction among multiple hierarchical decision makers was not analysed deeply in practice agricultural irrigation systems are complex the reservoir authority has the prior right to allocate initial water rights to each sub area and each sub area manager distributes a given volume of water among different crops it is needed to think of each sub area s strategic feedback based on which the authority could change his decision second there are conflict existing among multiple sub areas as each focuses on its own economic benefits the economic benefits of sub areas are related to obtained water resources third water demand in other areas cannot be satisfied with scarce water irrigation while some regions are destroyed by too much water to overcome the above mentioned challenges a bi level programming framework is developed to deeply explore the whole water allocation process liu 1998 sherali et al 1983 with two kinds of decision makers the authority and each sub area s manager in this way the decision variables in the lower level constraints have an influence on upper level decision making and correspondingly the upper level decision result affects the lower level decision making therefore around a reservoir all parties in the two levels should be considered besides water rights transaction should be fully considered which helps to relieve water supply imbalance and improve water usage efficiency in different sub areas for many years countries have called for market systems to solve this surplus and shortage issue raffensperger and read 2009 water rights trading is an effective way to promote efficient water allocation wang et al 2017 xu et al 2016 wu 2014 within the water market crops are no longer limited to the water rights in their own planting area and can have access to the total water resources around the reservoir in this paper water transaction is considered lower level decision makers are allowed to sell or buy water from the water market after being given initial water rights therefore a stackelberg nash cournot equilibrium model that considers water rights transaction is proposed as we know there are few studies examining agricultural water resource allocation to fill this gap we aim to identify a satisfactory irrigation pattern for each crop in each sub area based on a stackelberg nash cournot equilibrium model which leads to food security and sustainable development bi level programming problems are non deterministic polynomial time np hard problems the optimal solution for bi level problems only exists when both upper and lower level objectives are in an optimal state which is hard to achieve directly to solve this problem a heuristic process is considered combining the fuzzy goal programming approach and genetic algorithm ga method the fuzzy goal programming approach uses a membership function to transfer each objective saraj and sadeghi 2014 ga which originated from the analogy of biological evolution was first proposed by hayes roth 1975 and it exploits historical information to speculate on new offspring with expected improved performance zomaya et al 2015 in all the proposed model considering the water market is a prominent method in the management of agricultural water the purpose of which is planning the water rights for multiple sub areas water distribution to multi crops with the permission of water rights transaction the rest of this paper is organized as follows section 2 describes the study background section 3 presents the bi level programming model section 4 shows the results and scenario analysis section 5 concludes the paper 2 study area the sancha lake is a tributary of the tuojiang river in sichuan province and it is the second largest lake in sichuan province while being three times as large as hangzhou west lake the sancha lake reservoir was constructed in the sixth phase of the dujiangyan dongfengqu project to store water the reservoir area is in the middle latitudes of the northern hemisphere where the four seasons are distinct and rainfall varies from area to area around the reservoir large amount of water is needed for supplying an irrigation area of 530 700 mu for the cultivation of crops and vegetables including 200 000 mu of land irrigation the sancha lake reservoir contains primarily agricultural water especially for farmland the irrigation system contains three main cropping areas regions the sancha area xinmin area and danjing area with the total cropping area of around 1 061 435 and 213 ha hm2 respectively as shown in fig 1 the water available for allocation includes stored water and effective rainfall conjunctive use of surface water and groundwater increase crop yields and enhance the general efficiency of water resource allocation xie et al 2017 das et al 2015 the link between water demand crops cropping land and additional rainfall is vital for consideration consider a one year planning horizon in this study we divide the planning horizon into four periods corresponding to the crops growing times the first period is from october to december of the past year the second is from january to march the third from april to june and the fourth from july to september the developed model considers seasonal characteristics and information on the amount of monthly rainfall based on historical data in sancha town danjing village and xinmin village during 1999 2010 and table 1 reflects the average annual situation fig 1 also shows that the rainfall displays uneven characteristics and it mainly scattered in quarter 3 yearly paddy wheat bean and oilseed rape are the four main crops in sancha town danjing village and xinmin village paddy and wheat are food crops bean is an economic crop and oilseed rape is an oil crop table 1 also shows the planting areas of the four crops in the three sub areas which are obtained from ziyang city statistical yearbook 3 research method 3 1 conceptual framework during the process of water allocation there exist two types of decision makers namely the sancha lake reservoir authority the authority and the irrigated sub areas managers the managers based on the above analysis we conceptualize the water allocation process as a bi level programming framework as shown in fig 2 based on the stackelberg nash cournot equilibrium meanwhile to improve the efficiency of water allocation and maximize the commercial utilization of water resources water transaction is considered in this paper 3 2 basic assumptions the model is developed based on the following assumptions 1 the total demand for water in each quarter is satisfied by the sancha lake reservoir rainfall and traded water 2 water distribution is no longer limited to the initial water rights allocated by the authority also water rights can be traded among sub areas 3 the trading price is predefined by decision makers who promise that it is no higher than the price of water bought from the reservoir 4 we consider a one year planning horizon which is divided into four quarters corresponding to the crops growing times winter in the past period and spring summer and autumn in this period 3 3 notations the following notations are used to develop the model i index of the sub area around the sancha lake reservoir i 1 2 m j index of the crop type in the sub area j 1 2 n t index of the stages of regional water resource planning and management t 1 2 t auxiliary variables b ij t benefit parameter for crop j in sub area i in stage t per unit of water allocated γ water price set by the leader c i cost of water bought from the water market η irrigation coefficient a ij t area allocated to crop j in season t of sub area i f ij yield from the jth crop per unit of acreage in sub area i a b and c positive parameters in the water production function pre defined correlation coefficient for the model e t ij crop water requirement p t precipitation ξ t effective rainfall fuzzy number β rainfall coefficient v i t maximum volume of reservoir storage r i t net revenue gross revenue minus the cost of inputs decision variables x i t initial water rights of sub area i in stage t determined by the upper level decision maker y ij t water used by crop y in sub area i in stage t determined by the lower level decision maker bs w i t amount of water bought from other sub areas bs w i t amount of water sold to other sub areas τ i 0 1 variable on whether to buy water or not state variables s t water available in the reservoir s t 1 amount of water stored at the end of period t in the reservoir s 0 initial water available in the reservoir 3 4 stackelberg nash cournot equilibrium model based on the above bi level programming framework two hierarchical decision making entities are considered the upper level decision maker is the authority who allocates initial water rights denoted by the decision variable x i t to sub areas the lower level decision maker is the manager who distributes water denoted by y ij t and sells buys excess additional water rights to from another sub area denoted by bs w i t under a mutually cooperative situation 3 4 1 upper level decision making process based on the principle of equity the authority aims to minimize the disparity of water allocation per unit of economic benefit in each sub area in this way the leader can judge how much initial water rights must be allocated among the sub areas thus we briefly state the modelling process as follows to pursue water allocation equity among different sub areas eq 1 is proposed for representing this concept as an objective function e of 0 means that different sub areas obtain the same water allocation per unit of economic benefit and a greater value of e means that one sub area need to be allocated much more water for economic benefits 1 min x i t i 1 m i 2 m x i t a i t r i t x i t a i t r i t where x i t a i t r i t is the water allocation per unit of economic benefit in sub area i which implies a simulation for finding an optimal water resource allocation pattern for grow more rice with less water moreover the net revenue function is the profit from crop yield as shown in eq 2 2 r i t 1 t j 1 n b ij f ij t a ij t γ x i t a i t c i b s w i t a i t c i b s w i t a i t i 1 2 m 3 4 1 1 constraints this decision entity is subject to the following constraints 1 reservoir water balance the available water in sancha lake reservoir consists of unused water in the last period and the effective rainfall supplement the remaining water in this period is calculated by the available water in this period minus the allocated water 3 s t s t 1 ξ t a t i 1 m x i t a i t 2 water allocation availability the amount of water that can be allocated to each sub area is fully constrained by the available water in the reservoir in this period in other words the total allocated water rights to sub areas cannot surpass the water storage of the reservoir in this period 4 i 1 m x i t a i t s t ξ t a t 3 reservoir storage capability the reservoir s storage capacity is limited so exceeding the maximum storage capacity causes waste therefore the water available in this period should not exceed the total reservoir storage capability 5 s t v t 3 4 2 lower level decision making process the lower level decision maker is the manager the sub areas managers prefer to maximize the economic benefits the establishment of water markets is considered a measure that allows transaction of water rights among users in a decentralized manner and attenuates the effects of water scarcity goetz et al 2017 the objective function maximize the economic benefits the followers aim to pursue more economic benefits for their own sub areas with the permission of water rights transaction as shown in the following objective function 6 6 max y ij t τ i α ij b s w i t i 1 m r i i 1 m t 1 t j 1 n b ij f ij t a ij t γ x i t a i t c i b s w i t a i t c i b s w i t a i t 3 4 2 1 constraints 1 water distribution availability three types of water are available for each sub area to distribute to multi crops water from rights given by the leader water bought from the water market and effective rainfall in other words the total distribution of water to crops cannot surpass the available water 7 j 1 n y ij t a ij t x i t a i t τ i b s w i t a i t τ i 1 b s w i t a i t i 1 2 m 8 τ i 0 x i t ξ i t j 1 n e t ij t a ii t 1 x i t ξ i t j 1 n e t ij t a t 2 the transaction constraint each sub area manager has to look after his or her sub area s benefit when deciding to participate in trading when the water withdrawal of a sub area is more than the water rights the manager needs to buy water from the water market conversely the manager can sell extra water on the water market if trading water leads to more benefit than from using it to irrigate crops in this way buyers gain from additional production generated because of the acquired water and sellers gain more economic benefits by selling water rights in the meantime some constraints are needed for the water market first the volume of water resource to be sold cannot exceed that in the sub area in this period second the price of water for transferring rights should not be higher than the price of water bought from the reservoir otherwise it will lead to more water transaction before meeting the water demand of native crops which will in turn endanger sustainable development 9 bs w i t a i t x i t a i t j 1 n y ij t a ij t i 1 2 m 10 bs w i t b s w i t 0 i 1 2 m 3 crop water production function there is a relation between yield and absorbed water aljamal et al 2000 tong and guo 2013 thus we use a mathematical description parabola model to describe the influence of water on crop yield 11 f ij a ξ i t η j 1 n y ij t 2 b ξ i t η j 1 n y ij t c i 1 2 m j 1 2 n 4 efficient rainfall rainfall is an additional supplement for crops water needs as well as for filling the reservoir it is acknowledged that water allocation is somewhat influenced by effective rainfall in different seasons hence an equation calculating the effective rainfall for crops is added 12 ξ i t β p i t a i i 1 2 m 3 4 3 global model on the whole the authority allocates the initial water rights to each irrigated sub area based on equity the managers independently distribute water for various crops irrigation or sell buy water by maximizing the economic benefits as different sub areas have multi objectives a solution based on the nash cournot equilibrium without violating the other sub areas is acceptable and a global model 13 can be proposed by integrating 1 12 13 min x i t i 1 m i 2 m x i t a i t r i t x i t a i t r i t s j r i t 1 t j 1 n b ij f ij t a ij t γ x i t a i t c i b s w i t a i t c i b s w i t a i t i 1 2 m s t s t 1 ξ t a t i 1 m x i t a i t i 1 m x i t a i t s t ξ t a t s t v t max y ij t τ i α ij b s w i t i 1 m r i s j j 1 n y ij t a ij t x i t a i t τ i b s w i t a i t τ i 1 b s w i t a i t i 1 2 m τ i 0 x i t ξ i t j 1 n e t ij t a ii t 1 x i t ξ i t j 1 n e t ij t a ii t b s w i t a i t x i t a i t j 1 n y ij t a ij t i 1 2 m b s w i t b s w i t 0 i 1 2 m f ij a ξ i t η j 1 n y ij t 2 b ξ i t η j 1 n y ij t c i 1 2 m j 1 2 n ξ i t β p i t a i i 1 2 m 3 5 solution methods a bi level programming model with multiple followers is a non convex non deterministic polynomial time hard problem for which it is difficult to find an optimal solution instead we tend to search a satisfactory solution for the proposed model with a heuristic algorithm as shown in fig 3 in cases wherein several objective functions conflicting and incommensurable exist the optimal solution for one function is not necessarily optimal for the other functions and hence one may introduce the notion of a satisfactory solution step 1 transform the proposed model into single objective models in which each objective has its corresponding constraints and calculate the maximum and minimum values of each objective step 2 construct the membership function of upper and lower objective functions based on the fuzzy goal programming approach step 3 maximize the total membership functions thereby obtaining the most satisfactory solution using the ga method 3 5 1 fuzzy goal programming approach first calculate the maximum and minimum solutions f max f min f i m a x f i m i n of the objective functions in two levels in isolation baky 2009 second construct the membership functions of each objective function as 14 and 15 third maximize the total membership functions of upper and lower objective functions 14 m u 0 f f max f max f f max f min f min f f max 1 f f min 15 m i l 0 f i f i min f i f i min f i max f i min f i min f f i max 1 f i f i max 3 5 2 genetic algorithm ga which is a heuristic search method has recently demonstrated considerable success in providing good solutions to many complex optimization problems thus it has received more and more attention liu 1998 and has been widely used for solving optimization problems ga involves a process of evolution to find a satisfactory solution after this process of evolution changes may occur in the genes if these changes provide additional advantages in facing the challenges of survival new species evolve from the old ones unsuccessful changes are eliminated by natural selection konak et al 2006 3 5 3 experimental solution process the experimental data of water production function come from the farmland irrigation research institute of the chinese academy of agricultural sciences which show the relationship between water consumption and yields using a parabola model the coefficients of the water production function a b and c and the price of the four crops are shown in table 2 based on the china agricultural product price information network we optimize the leader and followers objective functions separately as shown in table 3 which may be optimal only for each of their own objectives but unacceptable for the others objectives it is obvious that one objective conflicts with another for example the authority pays more attention to equity expressed by the disparity in the water allocated per unit of economic benefit in each sub area while sub area managers focus on economic benefits from crop yields also there are conflicts among sancha town danjing village and xinmin village therefore an optimal solution that simultaneously optimizes each objective function is almost impossible instead the proposed model can find a satisfactory solution for the authority and managers in other words given an acceptable level of the membership function we maximize the weighted sum of the membership functions of each objective function if the obtained membership functions are all no less than the given level the solution is considered satisfactory in this way equity and economic development in each sub area are simultaneously considered which is helpful for sustainable development 4 results and discussion 4 1 optimal irrigation strategies based on the fuzzy goal programming approach and genetic algorithm we get a satisfactory solution as shown in table 4 fig 4 shows that sancha town is allocated the most water rights followed by danjing village and xinmin village danjing and xinmin villages managers choose to sell water rights to the water market while sancha town s manager decides to buy additional water from the water market to gain more yields based on the results we conclude that more available water can be distributed in sancha town while guaranteeing the equity of water allocation table 5 shows that each sub area manager prefers to distribute more water to wheat and oilseed rape than paddy and bean which matches the fact that wheat and oilseed rape grow in quarters with relatively less rainfall inflows see fig 1 also table 5 represents the absorbed water of each crop corresponding yields kilogram per unit of hectare and the economic benefits of each sub area the result illustrates that sancha town produces the most economic benefits followed by danjing village and xinmin village achieves the least economic benefits it is interesting to find that given a fixed level of economic benefits xinmin village needs the least initial water rights on the contrary danjing village requires the most initial water rights the result implies that more measures are needed in xinmin village to make full use of water rights save water and achieve sustainable development 4 2 scenario analysis the long term view for the analysis of sustainable development in sancha lake reservoir needs to consider the future uncertainties resulting from the limited understanding of the current situation and natural stochastic changes hence scenario techniques are used to explore future uncertainty and its impacts on the results 4 2 1 scenario analysis in different inflow years in the water resources allocation system water from rainfall is an uncertain supplement to irrigated water niu et al 2016 in this study scenario analysis is conducted to determine what adjustments are made to the irrigation patterns in the average inflow year and identify a desired water allocation plan for irrigation under multiple uncertain inflow levels generally considering the historical data on rainfall four additional possible scenarios are used to obtain the water resource patterns that is increase by 10 and decrease by 20 as well as 40 and 60 deviation from the existing average inflow year in this way the future uncertainty and extreme situations are fully considered scenario 1 when decision makers are optimistic about future rainfall they assume there will be more inflow inputs in the future than the existing average inflow year namely with an increment of 10 scenario 2 when decision makers take a fairly conservative attitude for the future inflow level they consider the inflow level will be 80 of the existing average inflow scenario 3 when decision makers take a very conservative attitude for future inflow level they consider the inflow level will be 60 of the existing average inflow scenario 4 when decision makers take an absolutely conservative attitude for the future inflow level they consider the inflow level will be 40 of the existing average inflow 4 2 2 scenario analysis of planting areas the planting area is essential for water management in the agricultural sector in order to decide how much water should be allocated to different crops for achieving the net system benefit from cultivated land dai and li 2013 here we consider planting areas as the parameter in the model as follows scenario 5 assuming the model is solved in the average inflow year and provided that the planting areas increase in 2030 as in table 6 some changes appear in the water allocation patterns 4 2 3 scenario analysis in irrigation coefficient the irrigation coefficient has the potential to save water and improve economic benefit in this section we assume the irrigation technology is improved expressed by the increase in the irrigation coefficient η from 0 5 to 0 65 scenario 6 there is a situation with higher irrigation coefficient 4 2 4 discussion a discussion based on the results obtained by examining different scenarios and comparing them is given as follows proposition 1 drought leads to a decrease in economic benefits generally when the inflow level decreases the total economic benefits decrease and they show an obvious decline at the 40 inflow level as shown in fig 5 based on our analysis this is because more initial water rights are needed with the decrease in inflow levels leading to an increase in water costs in the meantime four crops face yield losses with the decline of available water which correspondingly reduces the economic benefits especially for paddy and bean the yields decline continuously and significantly with the decrease in inflow levels see table 7 proposition 2 larger planting areas lead to an increase in economic benefits obviously with the increase in the planting area water irrigation per unit of the economic benefits decrease based on the proposed model with the increasing water requirement in 2030 xinmin village s manager decides to make full use of water and provide more water for crop irrigation on the contrary danjing village s manager chooses to sell water rights instead of irrigating the native crops as a result table 8 shows that equity and economic benefits are improved with the increase in the planting area proposition 3 higher irrigation technology has potential to push the process of sustainable development as we know the irrigation coefficient and absorbing coefficient has an influence on crop productivity in this study the irrigation coefficient is 0 5 by weighting all the crops irrigation coefficients if water saving irrigation is adopted the irrigation coefficient or water productivity would increase for example if the irrigation coefficient increases from 0 5 to 0 65 the sancha lake reservoir authority will give less initial water rights to each sub area especially the value of x 2 a 2 r 2 decreases significantly from 0 45 to 0 32 which implies that less water is required to get a unit of economic benefit in danjing village in other words higher irrigation technology has potential to save water and push the process of sustainable development in addition more crop yields and economic benefits can be obtained especially in sancha town and xinmin village 4 3 comparison analysis to highlight the superiority of the proposed model we compare the results in section 4 3 to those obtained by a model without the water market comparison 1 a situation without considering the water market based on the solved results a proposition obtained based on the comparison is given as follows proposition 4 water rights transaction improves equity and economic benefits table 9 presents the solutions obtained by a model without the water market and those obtained by the proposed model under the water market danjing and xinmin villages managers choose to sell water instead of direct irrigation which leads to higher economic profits as a result the total economic benefits in the three sub areas increase from 18 363 384 rmb to 20 135 189 rmb and the allocation pattern reflects more equity thus considering the water market has the potential to improve economic benefits and consume less water per unit of economic benefit which verifies the effectiveness of the water market and the ability to promote sustainable utilization of water resources 4 4 managerial insights results obtained from the proposed model in different scenarios show wide variations which provide more information for decision makers to design the corresponding allocation plan therefore various measures would need to be developed to cope with different situations insight 1 water allocation and distribution need to be adjusted in different scenarios table 8 describes the amount of initial water rights allocated to each sub area generally with the decrease in inflow level more water is needed for each sub area table 7 indicates that more water is needed for crop irrigation because of the decrease in rainfall correspondingly we find that managers have different attitudes toward crops at different inflow levels for example more water needs to be allocated to paddy with the decrease in rainfall until the yield is not worth the irrigated water in other words when the inflow level decreases by 60 the sub area managers choose to provide more water to wheat and oilseed rape for more economic benefits at the same time it is interesting to find that irrigation water for oilseed rape has the least fluctuation which implies that oilseed rape is less sensitive to water insight 2 water rights transaction is proved to lead to sustainable usage and development according to the results in comparison analysis water rights transaction is worth being carried out as it is effective to improve the equity degree and economic benefits it is worth noting that a reasonable coordination mechanism is needed to improve the water rights transactions for example when the inflow level is much below the 40 average inflow level sancha town s manager should consider selling the water rights to the water market moreover if the initial water markets are larger than 2642 103 m3 danjing village s manager should consider buying more water from the water market which is helpful to gain more crop yields for xinmin village if the initial water rights are around 2320 103 m3 but no less than 1815 103 m3 it is suggested to buy more water for irrigation therefore it is suggested to sell water rights if more economic benefits can be obtained with the permission of food security insight 3 hard and soft paths should be combined together to promotes efficient utilization of water resources for sustainable development of agricultural irrigation it is suggested to combine the hard and soft paths when managing the water allocation process which correspondingly promotes efficient utilization of water resources higher irrigation technology has potential to save water push the process of sustainable development obtain more crop yields and economic benefits meanwhile soft path such as water market is a good way to promote sustainable development in agricultural irrigation system and get higher economic benefits 5 conclusion and further research our motivation for this study is to effectively allocate water resources in the agricultural sector for sustainable development the proposed stackelberg nash cournot equilibrium model considered not only the equilibrium between the authority and managers but also the trade off between each sub area this study s background is that the authority has higher priority in allocating initial water rights to sancha town danjing village and xinmin village in china in the sub areas the managers decide on the water rights transaction and water distribution to multi crops based on collected data we applied the proposed model to obtain a satisfactory solution the results showed that sancha town was usually allocated the most water rights followed by danjing village and xinmin village with the permission of water rights transaction danjing and xinmin villages managers chose to sell water rights to the water market while sancha town s manager decided to buy additional water from the water market to gain more yields besides more water was utilized for wheat and oilseed rape than paddy and bean which matched the fact that wheat and oilseed rape grow in quarters with relatively less rainfall inflows to offer more information on the adjustment of agricultural irrigation patterns three parameters inflow planting areas and irrigation coefficient were changed results showed that inflow levels planting areas and effective irrigation technologies all influenced the water allocation patterns and led to different equity degrees and economic benefits finally to highlight the superiority of the proposed model another comparative analysis without considering water transaction was conducted the results showed that the economic benefits of the three sub areas were enhanced which implied the importance and effectiveness of the water market in addition the value of water allocation per unit of the economic benefit decreased largely after considering the water market indicating that the proposed model was able to consume less water per unit of the economic benefit which verified the ability of the proposed model to promote sustainable development of water resources in the future it is vital to further study the transaction price if the price is too high it may lead some users to demand more initial water keep more water for their own or sell the water to the water market before satisfying their own irrigation demand therefore the step water price mechanism for different amounts of used water is suggested for future study declaration of competing interest none acknowledgements we thank those who have given constructive comments and feedback to help improve this paper support was provided by the national natural science foundation of china grant no 71771157 
6370,this paper focuses on water allocation in an irrigation district considering water rights transaction the relationship between the reservoir authority and the sub area managers is explored based on a novel stackelberg nash cournot equilibrium model in this framework the reservoir authority has higher priority in allocating initial water rights to sancha town danjing and xinmin villages after get the decisions from the reservoir authority the sub area managers decide water distribution to multi crops planting areas and water rights transaction with the promise of nash cournot equilibrium then the reservoir authority can modify his decision by stackelberg strategic interaction to obtain the optimal irrigation strategy fuzzy goal programming and genetic algorithm methods are applied in this context a stackelberg nash cournot equilibrium solution can be obtained the proposed model is applied to sancha irrigation area and the results show that more available water can be distributed in sancha town while guaranteeing the equity among the sub areas in this irrigation district more water was utilized for wheat and oilseed rape than paddy and bean which matched the fact that wheat and oilseed rape grow in quarters with relatively less rainfall inflows a changeable and uncertain environment regarding inflow levels planting areas and irrigation coefficient take potential challenges to agricultural irrigation process hence to cope with the challenges cope with the future uncertainty and offer more information on the adjustment of agricultural irrigation patterns scenario technique is applied by changing the three parameters inflow levels planting areas and irrigation coefficient respectively finally to highlight the superiority of the proposed model a comparative analysis is conducted in a situation without considering the water market which verifies the importance and effectiveness of water rights transaction keywords optimal water allocation water market stackelberg nash cournot equilibrium agriculture irrigation district 1 introduction less than 1 of the fresh water on earth can be used directly worse still per capita fresh water in china accounts for only a quarter of that in the world agriculture uses 70 of all fresh water around the world and up to 95 in several developing countries such as china liu et al 2017a b because of the uneven rainfall growing water scarcity has been one of the leading challenges for the field of agriculture the united nations 2017 to be specific water resources allocated to agricultural sector often reach the low limit of demand in arid and semi arid regions li et al 2017 in addition the united nations food and agriculture organization fao warned that demographic trends has added urgency to the issue the united nations 2014 given water scarcity the concern on agriculture irrigation management is intensive china which is known as an agricultural country produces more than 70 of food crops 80 of cotton and 90 of vegetables of the total global production li and guo 2014 which implies that more water resources are used for irrigation as china s population expands so will the demand for water qiu 2010 therefore a new path to agricultural irrigation planning is needed with the increasing water demand fao noted that employing water saving irrigation techniques has the obvious impact on coping with water scarcity in agriculture the united nations 2014 however there is still much work to be done by optimizing the water irrigation pattern in agricultural sector which is seemed as a soft path to achieve food security and sustainable development recently various mathematical programming approaches were successfully applied to water resource management liu et al 2017a tarebari et al 2018 zeng et al 2014 in terms of the agricultural sector qiang et al 2018 optimized the water allocation to different crops of groundwater and surface water fazlali and shourian 2018 studied the optimum water allocation and crop planning problems xie et al 2017 studied agricultural water resource planning with an inexact stochastic fuzzy programming model li et al 2016 optimally allocated limited agricultural water resources to different irrigation areas by maximizing system benefits while minimizing the water shortage penalty dai and li 2013 developed a multistage irrigation water allocation model for planning agricultural activities moradi jalal et al 2007 maximized the annual benefit of the multi crop system over a planning period li and guo 2014 considered the objectives regarding economic social and ecological benefits and then applied the modified multi objective model to a real case study in minqin county gansu province china tan et al 2017 used a multi objective programming method for supporting the optimal use of water resources in agriculture in all the above studies verified that multi objective optimization methods can be effective tools for addressing water allocation under multiple conflicting objectives in the agricultural irrigation system in the previous articles social and economic perspectives are two widely focus when it came to water allocation davijani et al 2016 tan et al 2017 however as time went on equality became one of the most concerns when it comes to multiple participants which may consists of economic social and environmental factors mousavi et al 2017 hence it is vital to consider the equity factor when allocating the initial water rights to each different water users still three major challenges remained for the multi objective programming of water resources in the agriculture irrigation system first the sequential order and strategic interaction among multiple hierarchical decision makers was not analysed deeply in practice agricultural irrigation systems are complex the reservoir authority has the prior right to allocate initial water rights to each sub area and each sub area manager distributes a given volume of water among different crops it is needed to think of each sub area s strategic feedback based on which the authority could change his decision second there are conflict existing among multiple sub areas as each focuses on its own economic benefits the economic benefits of sub areas are related to obtained water resources third water demand in other areas cannot be satisfied with scarce water irrigation while some regions are destroyed by too much water to overcome the above mentioned challenges a bi level programming framework is developed to deeply explore the whole water allocation process liu 1998 sherali et al 1983 with two kinds of decision makers the authority and each sub area s manager in this way the decision variables in the lower level constraints have an influence on upper level decision making and correspondingly the upper level decision result affects the lower level decision making therefore around a reservoir all parties in the two levels should be considered besides water rights transaction should be fully considered which helps to relieve water supply imbalance and improve water usage efficiency in different sub areas for many years countries have called for market systems to solve this surplus and shortage issue raffensperger and read 2009 water rights trading is an effective way to promote efficient water allocation wang et al 2017 xu et al 2016 wu 2014 within the water market crops are no longer limited to the water rights in their own planting area and can have access to the total water resources around the reservoir in this paper water transaction is considered lower level decision makers are allowed to sell or buy water from the water market after being given initial water rights therefore a stackelberg nash cournot equilibrium model that considers water rights transaction is proposed as we know there are few studies examining agricultural water resource allocation to fill this gap we aim to identify a satisfactory irrigation pattern for each crop in each sub area based on a stackelberg nash cournot equilibrium model which leads to food security and sustainable development bi level programming problems are non deterministic polynomial time np hard problems the optimal solution for bi level problems only exists when both upper and lower level objectives are in an optimal state which is hard to achieve directly to solve this problem a heuristic process is considered combining the fuzzy goal programming approach and genetic algorithm ga method the fuzzy goal programming approach uses a membership function to transfer each objective saraj and sadeghi 2014 ga which originated from the analogy of biological evolution was first proposed by hayes roth 1975 and it exploits historical information to speculate on new offspring with expected improved performance zomaya et al 2015 in all the proposed model considering the water market is a prominent method in the management of agricultural water the purpose of which is planning the water rights for multiple sub areas water distribution to multi crops with the permission of water rights transaction the rest of this paper is organized as follows section 2 describes the study background section 3 presents the bi level programming model section 4 shows the results and scenario analysis section 5 concludes the paper 2 study area the sancha lake is a tributary of the tuojiang river in sichuan province and it is the second largest lake in sichuan province while being three times as large as hangzhou west lake the sancha lake reservoir was constructed in the sixth phase of the dujiangyan dongfengqu project to store water the reservoir area is in the middle latitudes of the northern hemisphere where the four seasons are distinct and rainfall varies from area to area around the reservoir large amount of water is needed for supplying an irrigation area of 530 700 mu for the cultivation of crops and vegetables including 200 000 mu of land irrigation the sancha lake reservoir contains primarily agricultural water especially for farmland the irrigation system contains three main cropping areas regions the sancha area xinmin area and danjing area with the total cropping area of around 1 061 435 and 213 ha hm2 respectively as shown in fig 1 the water available for allocation includes stored water and effective rainfall conjunctive use of surface water and groundwater increase crop yields and enhance the general efficiency of water resource allocation xie et al 2017 das et al 2015 the link between water demand crops cropping land and additional rainfall is vital for consideration consider a one year planning horizon in this study we divide the planning horizon into four periods corresponding to the crops growing times the first period is from october to december of the past year the second is from january to march the third from april to june and the fourth from july to september the developed model considers seasonal characteristics and information on the amount of monthly rainfall based on historical data in sancha town danjing village and xinmin village during 1999 2010 and table 1 reflects the average annual situation fig 1 also shows that the rainfall displays uneven characteristics and it mainly scattered in quarter 3 yearly paddy wheat bean and oilseed rape are the four main crops in sancha town danjing village and xinmin village paddy and wheat are food crops bean is an economic crop and oilseed rape is an oil crop table 1 also shows the planting areas of the four crops in the three sub areas which are obtained from ziyang city statistical yearbook 3 research method 3 1 conceptual framework during the process of water allocation there exist two types of decision makers namely the sancha lake reservoir authority the authority and the irrigated sub areas managers the managers based on the above analysis we conceptualize the water allocation process as a bi level programming framework as shown in fig 2 based on the stackelberg nash cournot equilibrium meanwhile to improve the efficiency of water allocation and maximize the commercial utilization of water resources water transaction is considered in this paper 3 2 basic assumptions the model is developed based on the following assumptions 1 the total demand for water in each quarter is satisfied by the sancha lake reservoir rainfall and traded water 2 water distribution is no longer limited to the initial water rights allocated by the authority also water rights can be traded among sub areas 3 the trading price is predefined by decision makers who promise that it is no higher than the price of water bought from the reservoir 4 we consider a one year planning horizon which is divided into four quarters corresponding to the crops growing times winter in the past period and spring summer and autumn in this period 3 3 notations the following notations are used to develop the model i index of the sub area around the sancha lake reservoir i 1 2 m j index of the crop type in the sub area j 1 2 n t index of the stages of regional water resource planning and management t 1 2 t auxiliary variables b ij t benefit parameter for crop j in sub area i in stage t per unit of water allocated γ water price set by the leader c i cost of water bought from the water market η irrigation coefficient a ij t area allocated to crop j in season t of sub area i f ij yield from the jth crop per unit of acreage in sub area i a b and c positive parameters in the water production function pre defined correlation coefficient for the model e t ij crop water requirement p t precipitation ξ t effective rainfall fuzzy number β rainfall coefficient v i t maximum volume of reservoir storage r i t net revenue gross revenue minus the cost of inputs decision variables x i t initial water rights of sub area i in stage t determined by the upper level decision maker y ij t water used by crop y in sub area i in stage t determined by the lower level decision maker bs w i t amount of water bought from other sub areas bs w i t amount of water sold to other sub areas τ i 0 1 variable on whether to buy water or not state variables s t water available in the reservoir s t 1 amount of water stored at the end of period t in the reservoir s 0 initial water available in the reservoir 3 4 stackelberg nash cournot equilibrium model based on the above bi level programming framework two hierarchical decision making entities are considered the upper level decision maker is the authority who allocates initial water rights denoted by the decision variable x i t to sub areas the lower level decision maker is the manager who distributes water denoted by y ij t and sells buys excess additional water rights to from another sub area denoted by bs w i t under a mutually cooperative situation 3 4 1 upper level decision making process based on the principle of equity the authority aims to minimize the disparity of water allocation per unit of economic benefit in each sub area in this way the leader can judge how much initial water rights must be allocated among the sub areas thus we briefly state the modelling process as follows to pursue water allocation equity among different sub areas eq 1 is proposed for representing this concept as an objective function e of 0 means that different sub areas obtain the same water allocation per unit of economic benefit and a greater value of e means that one sub area need to be allocated much more water for economic benefits 1 min x i t i 1 m i 2 m x i t a i t r i t x i t a i t r i t where x i t a i t r i t is the water allocation per unit of economic benefit in sub area i which implies a simulation for finding an optimal water resource allocation pattern for grow more rice with less water moreover the net revenue function is the profit from crop yield as shown in eq 2 2 r i t 1 t j 1 n b ij f ij t a ij t γ x i t a i t c i b s w i t a i t c i b s w i t a i t i 1 2 m 3 4 1 1 constraints this decision entity is subject to the following constraints 1 reservoir water balance the available water in sancha lake reservoir consists of unused water in the last period and the effective rainfall supplement the remaining water in this period is calculated by the available water in this period minus the allocated water 3 s t s t 1 ξ t a t i 1 m x i t a i t 2 water allocation availability the amount of water that can be allocated to each sub area is fully constrained by the available water in the reservoir in this period in other words the total allocated water rights to sub areas cannot surpass the water storage of the reservoir in this period 4 i 1 m x i t a i t s t ξ t a t 3 reservoir storage capability the reservoir s storage capacity is limited so exceeding the maximum storage capacity causes waste therefore the water available in this period should not exceed the total reservoir storage capability 5 s t v t 3 4 2 lower level decision making process the lower level decision maker is the manager the sub areas managers prefer to maximize the economic benefits the establishment of water markets is considered a measure that allows transaction of water rights among users in a decentralized manner and attenuates the effects of water scarcity goetz et al 2017 the objective function maximize the economic benefits the followers aim to pursue more economic benefits for their own sub areas with the permission of water rights transaction as shown in the following objective function 6 6 max y ij t τ i α ij b s w i t i 1 m r i i 1 m t 1 t j 1 n b ij f ij t a ij t γ x i t a i t c i b s w i t a i t c i b s w i t a i t 3 4 2 1 constraints 1 water distribution availability three types of water are available for each sub area to distribute to multi crops water from rights given by the leader water bought from the water market and effective rainfall in other words the total distribution of water to crops cannot surpass the available water 7 j 1 n y ij t a ij t x i t a i t τ i b s w i t a i t τ i 1 b s w i t a i t i 1 2 m 8 τ i 0 x i t ξ i t j 1 n e t ij t a ii t 1 x i t ξ i t j 1 n e t ij t a t 2 the transaction constraint each sub area manager has to look after his or her sub area s benefit when deciding to participate in trading when the water withdrawal of a sub area is more than the water rights the manager needs to buy water from the water market conversely the manager can sell extra water on the water market if trading water leads to more benefit than from using it to irrigate crops in this way buyers gain from additional production generated because of the acquired water and sellers gain more economic benefits by selling water rights in the meantime some constraints are needed for the water market first the volume of water resource to be sold cannot exceed that in the sub area in this period second the price of water for transferring rights should not be higher than the price of water bought from the reservoir otherwise it will lead to more water transaction before meeting the water demand of native crops which will in turn endanger sustainable development 9 bs w i t a i t x i t a i t j 1 n y ij t a ij t i 1 2 m 10 bs w i t b s w i t 0 i 1 2 m 3 crop water production function there is a relation between yield and absorbed water aljamal et al 2000 tong and guo 2013 thus we use a mathematical description parabola model to describe the influence of water on crop yield 11 f ij a ξ i t η j 1 n y ij t 2 b ξ i t η j 1 n y ij t c i 1 2 m j 1 2 n 4 efficient rainfall rainfall is an additional supplement for crops water needs as well as for filling the reservoir it is acknowledged that water allocation is somewhat influenced by effective rainfall in different seasons hence an equation calculating the effective rainfall for crops is added 12 ξ i t β p i t a i i 1 2 m 3 4 3 global model on the whole the authority allocates the initial water rights to each irrigated sub area based on equity the managers independently distribute water for various crops irrigation or sell buy water by maximizing the economic benefits as different sub areas have multi objectives a solution based on the nash cournot equilibrium without violating the other sub areas is acceptable and a global model 13 can be proposed by integrating 1 12 13 min x i t i 1 m i 2 m x i t a i t r i t x i t a i t r i t s j r i t 1 t j 1 n b ij f ij t a ij t γ x i t a i t c i b s w i t a i t c i b s w i t a i t i 1 2 m s t s t 1 ξ t a t i 1 m x i t a i t i 1 m x i t a i t s t ξ t a t s t v t max y ij t τ i α ij b s w i t i 1 m r i s j j 1 n y ij t a ij t x i t a i t τ i b s w i t a i t τ i 1 b s w i t a i t i 1 2 m τ i 0 x i t ξ i t j 1 n e t ij t a ii t 1 x i t ξ i t j 1 n e t ij t a ii t b s w i t a i t x i t a i t j 1 n y ij t a ij t i 1 2 m b s w i t b s w i t 0 i 1 2 m f ij a ξ i t η j 1 n y ij t 2 b ξ i t η j 1 n y ij t c i 1 2 m j 1 2 n ξ i t β p i t a i i 1 2 m 3 5 solution methods a bi level programming model with multiple followers is a non convex non deterministic polynomial time hard problem for which it is difficult to find an optimal solution instead we tend to search a satisfactory solution for the proposed model with a heuristic algorithm as shown in fig 3 in cases wherein several objective functions conflicting and incommensurable exist the optimal solution for one function is not necessarily optimal for the other functions and hence one may introduce the notion of a satisfactory solution step 1 transform the proposed model into single objective models in which each objective has its corresponding constraints and calculate the maximum and minimum values of each objective step 2 construct the membership function of upper and lower objective functions based on the fuzzy goal programming approach step 3 maximize the total membership functions thereby obtaining the most satisfactory solution using the ga method 3 5 1 fuzzy goal programming approach first calculate the maximum and minimum solutions f max f min f i m a x f i m i n of the objective functions in two levels in isolation baky 2009 second construct the membership functions of each objective function as 14 and 15 third maximize the total membership functions of upper and lower objective functions 14 m u 0 f f max f max f f max f min f min f f max 1 f f min 15 m i l 0 f i f i min f i f i min f i max f i min f i min f f i max 1 f i f i max 3 5 2 genetic algorithm ga which is a heuristic search method has recently demonstrated considerable success in providing good solutions to many complex optimization problems thus it has received more and more attention liu 1998 and has been widely used for solving optimization problems ga involves a process of evolution to find a satisfactory solution after this process of evolution changes may occur in the genes if these changes provide additional advantages in facing the challenges of survival new species evolve from the old ones unsuccessful changes are eliminated by natural selection konak et al 2006 3 5 3 experimental solution process the experimental data of water production function come from the farmland irrigation research institute of the chinese academy of agricultural sciences which show the relationship between water consumption and yields using a parabola model the coefficients of the water production function a b and c and the price of the four crops are shown in table 2 based on the china agricultural product price information network we optimize the leader and followers objective functions separately as shown in table 3 which may be optimal only for each of their own objectives but unacceptable for the others objectives it is obvious that one objective conflicts with another for example the authority pays more attention to equity expressed by the disparity in the water allocated per unit of economic benefit in each sub area while sub area managers focus on economic benefits from crop yields also there are conflicts among sancha town danjing village and xinmin village therefore an optimal solution that simultaneously optimizes each objective function is almost impossible instead the proposed model can find a satisfactory solution for the authority and managers in other words given an acceptable level of the membership function we maximize the weighted sum of the membership functions of each objective function if the obtained membership functions are all no less than the given level the solution is considered satisfactory in this way equity and economic development in each sub area are simultaneously considered which is helpful for sustainable development 4 results and discussion 4 1 optimal irrigation strategies based on the fuzzy goal programming approach and genetic algorithm we get a satisfactory solution as shown in table 4 fig 4 shows that sancha town is allocated the most water rights followed by danjing village and xinmin village danjing and xinmin villages managers choose to sell water rights to the water market while sancha town s manager decides to buy additional water from the water market to gain more yields based on the results we conclude that more available water can be distributed in sancha town while guaranteeing the equity of water allocation table 5 shows that each sub area manager prefers to distribute more water to wheat and oilseed rape than paddy and bean which matches the fact that wheat and oilseed rape grow in quarters with relatively less rainfall inflows see fig 1 also table 5 represents the absorbed water of each crop corresponding yields kilogram per unit of hectare and the economic benefits of each sub area the result illustrates that sancha town produces the most economic benefits followed by danjing village and xinmin village achieves the least economic benefits it is interesting to find that given a fixed level of economic benefits xinmin village needs the least initial water rights on the contrary danjing village requires the most initial water rights the result implies that more measures are needed in xinmin village to make full use of water rights save water and achieve sustainable development 4 2 scenario analysis the long term view for the analysis of sustainable development in sancha lake reservoir needs to consider the future uncertainties resulting from the limited understanding of the current situation and natural stochastic changes hence scenario techniques are used to explore future uncertainty and its impacts on the results 4 2 1 scenario analysis in different inflow years in the water resources allocation system water from rainfall is an uncertain supplement to irrigated water niu et al 2016 in this study scenario analysis is conducted to determine what adjustments are made to the irrigation patterns in the average inflow year and identify a desired water allocation plan for irrigation under multiple uncertain inflow levels generally considering the historical data on rainfall four additional possible scenarios are used to obtain the water resource patterns that is increase by 10 and decrease by 20 as well as 40 and 60 deviation from the existing average inflow year in this way the future uncertainty and extreme situations are fully considered scenario 1 when decision makers are optimistic about future rainfall they assume there will be more inflow inputs in the future than the existing average inflow year namely with an increment of 10 scenario 2 when decision makers take a fairly conservative attitude for the future inflow level they consider the inflow level will be 80 of the existing average inflow scenario 3 when decision makers take a very conservative attitude for future inflow level they consider the inflow level will be 60 of the existing average inflow scenario 4 when decision makers take an absolutely conservative attitude for the future inflow level they consider the inflow level will be 40 of the existing average inflow 4 2 2 scenario analysis of planting areas the planting area is essential for water management in the agricultural sector in order to decide how much water should be allocated to different crops for achieving the net system benefit from cultivated land dai and li 2013 here we consider planting areas as the parameter in the model as follows scenario 5 assuming the model is solved in the average inflow year and provided that the planting areas increase in 2030 as in table 6 some changes appear in the water allocation patterns 4 2 3 scenario analysis in irrigation coefficient the irrigation coefficient has the potential to save water and improve economic benefit in this section we assume the irrigation technology is improved expressed by the increase in the irrigation coefficient η from 0 5 to 0 65 scenario 6 there is a situation with higher irrigation coefficient 4 2 4 discussion a discussion based on the results obtained by examining different scenarios and comparing them is given as follows proposition 1 drought leads to a decrease in economic benefits generally when the inflow level decreases the total economic benefits decrease and they show an obvious decline at the 40 inflow level as shown in fig 5 based on our analysis this is because more initial water rights are needed with the decrease in inflow levels leading to an increase in water costs in the meantime four crops face yield losses with the decline of available water which correspondingly reduces the economic benefits especially for paddy and bean the yields decline continuously and significantly with the decrease in inflow levels see table 7 proposition 2 larger planting areas lead to an increase in economic benefits obviously with the increase in the planting area water irrigation per unit of the economic benefits decrease based on the proposed model with the increasing water requirement in 2030 xinmin village s manager decides to make full use of water and provide more water for crop irrigation on the contrary danjing village s manager chooses to sell water rights instead of irrigating the native crops as a result table 8 shows that equity and economic benefits are improved with the increase in the planting area proposition 3 higher irrigation technology has potential to push the process of sustainable development as we know the irrigation coefficient and absorbing coefficient has an influence on crop productivity in this study the irrigation coefficient is 0 5 by weighting all the crops irrigation coefficients if water saving irrigation is adopted the irrigation coefficient or water productivity would increase for example if the irrigation coefficient increases from 0 5 to 0 65 the sancha lake reservoir authority will give less initial water rights to each sub area especially the value of x 2 a 2 r 2 decreases significantly from 0 45 to 0 32 which implies that less water is required to get a unit of economic benefit in danjing village in other words higher irrigation technology has potential to save water and push the process of sustainable development in addition more crop yields and economic benefits can be obtained especially in sancha town and xinmin village 4 3 comparison analysis to highlight the superiority of the proposed model we compare the results in section 4 3 to those obtained by a model without the water market comparison 1 a situation without considering the water market based on the solved results a proposition obtained based on the comparison is given as follows proposition 4 water rights transaction improves equity and economic benefits table 9 presents the solutions obtained by a model without the water market and those obtained by the proposed model under the water market danjing and xinmin villages managers choose to sell water instead of direct irrigation which leads to higher economic profits as a result the total economic benefits in the three sub areas increase from 18 363 384 rmb to 20 135 189 rmb and the allocation pattern reflects more equity thus considering the water market has the potential to improve economic benefits and consume less water per unit of economic benefit which verifies the effectiveness of the water market and the ability to promote sustainable utilization of water resources 4 4 managerial insights results obtained from the proposed model in different scenarios show wide variations which provide more information for decision makers to design the corresponding allocation plan therefore various measures would need to be developed to cope with different situations insight 1 water allocation and distribution need to be adjusted in different scenarios table 8 describes the amount of initial water rights allocated to each sub area generally with the decrease in inflow level more water is needed for each sub area table 7 indicates that more water is needed for crop irrigation because of the decrease in rainfall correspondingly we find that managers have different attitudes toward crops at different inflow levels for example more water needs to be allocated to paddy with the decrease in rainfall until the yield is not worth the irrigated water in other words when the inflow level decreases by 60 the sub area managers choose to provide more water to wheat and oilseed rape for more economic benefits at the same time it is interesting to find that irrigation water for oilseed rape has the least fluctuation which implies that oilseed rape is less sensitive to water insight 2 water rights transaction is proved to lead to sustainable usage and development according to the results in comparison analysis water rights transaction is worth being carried out as it is effective to improve the equity degree and economic benefits it is worth noting that a reasonable coordination mechanism is needed to improve the water rights transactions for example when the inflow level is much below the 40 average inflow level sancha town s manager should consider selling the water rights to the water market moreover if the initial water markets are larger than 2642 103 m3 danjing village s manager should consider buying more water from the water market which is helpful to gain more crop yields for xinmin village if the initial water rights are around 2320 103 m3 but no less than 1815 103 m3 it is suggested to buy more water for irrigation therefore it is suggested to sell water rights if more economic benefits can be obtained with the permission of food security insight 3 hard and soft paths should be combined together to promotes efficient utilization of water resources for sustainable development of agricultural irrigation it is suggested to combine the hard and soft paths when managing the water allocation process which correspondingly promotes efficient utilization of water resources higher irrigation technology has potential to save water push the process of sustainable development obtain more crop yields and economic benefits meanwhile soft path such as water market is a good way to promote sustainable development in agricultural irrigation system and get higher economic benefits 5 conclusion and further research our motivation for this study is to effectively allocate water resources in the agricultural sector for sustainable development the proposed stackelberg nash cournot equilibrium model considered not only the equilibrium between the authority and managers but also the trade off between each sub area this study s background is that the authority has higher priority in allocating initial water rights to sancha town danjing village and xinmin village in china in the sub areas the managers decide on the water rights transaction and water distribution to multi crops based on collected data we applied the proposed model to obtain a satisfactory solution the results showed that sancha town was usually allocated the most water rights followed by danjing village and xinmin village with the permission of water rights transaction danjing and xinmin villages managers chose to sell water rights to the water market while sancha town s manager decided to buy additional water from the water market to gain more yields besides more water was utilized for wheat and oilseed rape than paddy and bean which matched the fact that wheat and oilseed rape grow in quarters with relatively less rainfall inflows to offer more information on the adjustment of agricultural irrigation patterns three parameters inflow planting areas and irrigation coefficient were changed results showed that inflow levels planting areas and effective irrigation technologies all influenced the water allocation patterns and led to different equity degrees and economic benefits finally to highlight the superiority of the proposed model another comparative analysis without considering water transaction was conducted the results showed that the economic benefits of the three sub areas were enhanced which implied the importance and effectiveness of the water market in addition the value of water allocation per unit of the economic benefit decreased largely after considering the water market indicating that the proposed model was able to consume less water per unit of the economic benefit which verified the ability of the proposed model to promote sustainable development of water resources in the future it is vital to further study the transaction price if the price is too high it may lead some users to demand more initial water keep more water for their own or sell the water to the water market before satisfying their own irrigation demand therefore the step water price mechanism for different amounts of used water is suggested for future study declaration of competing interest none acknowledgements we thank those who have given constructive comments and feedback to help improve this paper support was provided by the national natural science foundation of china grant no 71771157 
6371,chinese cities have been experiencing unprecedented growth for over three decades and the resulting urbanization is having a remarkable impact on the hydrological cycle at the local and regional scale this study therefore examined the influence of urbanization on nonstationarity of annual and seasonal precipitation extremes in china using daily precipitation data from 1857 stations for 1961 2014 and ncar ncep and era interim reanalysis datasets results of trend change point and bootstrap analyses revealed that urban signatures on long term changes i e trends and magnitudes of precipitation extremes were not prominently visible at the national scale however a nonstationary frequency analysis of precipitation extremes by a generalized additive model for location scale and shape gamlss framework with a cluster of 66 models showed that urbanization caused nonstationarity in precipitation extremes at local and regional scales such as north china further significant nonstationarity tended to occur more in urbanizing areas than in rural and urbanized areas suggesting that land use land cover lulc transition i e rural areas turning into urban areas played an important role in introducing nonstationarity furthermore analysis of large scale circulation patterns using k mean clustering showed that urban signatures on extremes were not prominent at the national scale but at the regional scale further studies are needed to enumerate physical mechanisms causing the impact of local environmental changes on precipitation extremes at different geographical locations over china keywords urbanization precipitation extremes long term changes nonstationarity gamlss china 1 introduction weather and climate extremes have devastating effects on human society as well as the environment parry et al 2007 zhang et al 2016 in the backdrop of global warming and climate change precipitation extremes have been reported to become more frequent and intense across the globe donat et al 2016 ingram 2016 the theoretical explanation for increases in precipitation extremes is that atmospheric water holding capacity is expected to increase exponentially with temperature based on the clausius clapeyron c c equation and that atmospheric water content is expected to increase accordingly allen and ingram 2002 pall et al 2007 willett et al 2007 gu et al 2017a however more and more regional studies have reported that global warming may not lead to increases in precipitation extremes in some regions e g maeda et al 2012 vittal et al 2016 because precipitation extremes are influenced by many other factors such as tropical cyclones gu et al 2017b zhang et al 2017 topography zhang et al 2014a as well as land surface conditions urbanization soil moisture etc liu et al 2014a b ford et al 2015 yang et al 2017a c while urbanization has been causing growing concerns because of its impact on changes in precipitation extremes sun et al 2016 zhao et al 2016 the twentieth century has witnessed rapid urbanization and exponential population growth worldwide the percentage of urban population rose from 13 in 1900 to 49 in 2005 and is projected to reach 60 in 2030 united nations 2011 such intensive urbanization may exert substantial impacts on changes in regional precipitation extremes besides global warming urban heat island uhi is another critical factor causing urban areas to become hotter uhi impacts precipitation extremes by influencing the development of clouds local convection aerosols and so on ren et al 2008 shepherd et al 2010 yang et al 2013a b increasing observational evidence and climate model simulations have demonstrated the relationship between urbanization and precipitation during the past several decades vittal et al 2013 wang et al 2015a c holst et al 2016 cristiano et al 2017 china the most populous country in the world is experiencing rapid urbanization as seen from more than doubling of urban population since 2012 besides changes in precipitation extremes caused by global climate change and local land use land cover lulc changes e g urbanization are greatly impacting floods droughts and food safety therefore a multitude of studies have analyzed the relationship between precipitation and urbanization in china sun and shu 2007 miao et al 2011 liang et al 2013 chen et al 2015 dou et al 2015 wang et al 2015a c yang et al 2017a c these studies show that urbanization affects the spatial distribution and amount of precipitation and tends to amplify precipitation for example yang et al 2017a c found that higher frequencies and amounts of short duration intense rainfall events occurred in or near the central urban areas in beijing than in rural areas however other studies found negative effects of urbanization on precipitation e g guo et al 2006 zhang et al 2009 wang et al 2012 this indicates that urban effects on precipitation regimes were not understood well although a number of studies have related urbanization to the intensification of precipitation there is a considerable debate and or discrepancy concerning the influence of urbanization versus large scale forcing on changes in precipitation extremes and on changing patterns of urban areas in china in spite of inconsistencies with respect to the effect of urbanization on precipitation previous studies mainly focused on three urban areas namely beijing shanghai and the pearl river delta to the best of our knowledge studies at the national scale that examine the impacts of urbanization on long term changes of precipitation extremes are very limited although long term changes of precipitation extremes have been widely examined in different parts of china the results are mainly linked to global climate change without considering the effect of urbanization zhang et al 2012 2014b yang et al 2013a b chi et al 2016 besides nonstationary frequency analysis fa in precipitation extremes was also analyzed due to its importance in infrastructure design milly et al 2008 min et al 2011 mondal and mujumdar 2015 showed that local changes were more responsible for causing nonstationarity in precipitation extremes than other physical covariates such as nature variability the objectives of this study therefore were 1 to examine the effect of urbanization on long term changes in annual and seasonal precipitation extremes and 2 to link nonstationarity of annual and seasonal precipitation extremes to the extent of urbanization in china results of this study would have relevance in planning and policy formulation for urbanized urbanizing and rural areas in china 2 data in situ precipitation observations from 2474 rain gauge stations across china were obtained from the china meteorological information center e g ma et al 2015 zhang et al 2017 the quality of this data has been checked and controlled before its release specifically any extreme visibly erroneous minima and maxima were removed and sites with data judged unreliable were discarded for example a value will be deleted if it is twice higher than the highest value ever occurred the maximum 6 h rainfall accumulation was 830 mm at the linzhuang station during the august 1975 flood yang et al 2017a c a station is excluded from the analysis if the percentage of missing values is larger than 5 we further homogenized this data using the method described in xu et al 2013 and detected and adjusted the temporal inhomogeneity in the data using the easterling peterson technique li et al 2004 as a result a total of 1857 stations are retained for analysis in this study 1336 out of total 1857 stations without missing data accounts for 72 additionally 445 out of total 1857 stations with missing data less than 1 accounts for 24 a total of 96 stations have missing data with a percentage less than 1 the missing precipitation values for 1 2 days were filled by the average precipitation of the neighboring days data missing for consecutive days were interpolated by the long term average of the same days of other years for the objectives of this study the gap fill method did not significantly affect the final results a similar method had been used by zhang et al 2011 to fill daily missing precipitation values here we used the annual and seasonal spring march to may summer june to august autumn september to november winter december to february maxima of each station to define precipitation extremes we chose these indices because they can characterize extreme events that often cause impacts on the society these annual and seasonal indices can be also used to estimate the probability of extreme events of certain return period which are used in infrastructure design min et al 2011 there are different ways to define urban and rural stations such as based on population vittal et al 2013 station history size of built up areas ren et al 2015 etc the urbanization in china can be unambiguously divided into two halves during the periods of 1961 2014 1961 1987 with weak urbanization effects and 1988 2014 with rapid urbanization since the reform and opening up policy in the 1980s the lulc data from 1980s and 2015 with a spatial resolution of 1 1 km were collected from data center for resources and environmental sciences chinese academy of sciences resdc http www resdc cn the lulc data shows discernible urban areas and rapid urban expansion e g liu et al 2014a b therefore a simple but valid method was used to define rural urbanizing and urbanized stations following the liao et al 2018 and luo and lau 2018 1 rural stations with their locations in rural areas in both the 1980s and 2015 2 urbanizing stations with their locations in rural areas in the 1980s but in urban areas in 2015 and 3 urbanized stations with their locations in urban areas in both the 1980s and 2015 there were 1115 341 401 stations classified as rural urbanizing and urbanized stations respectively fig s1 the number of urban stations in our manuscript is similar with that in liao et al 2018 and luo and lau 2018 considering impacts of large scale circulation patterns on precipitation extremes individual large scale meteorological variables i e air temperature humidity pressure u winds v winds and vertical wind velocity were also included in analysis precipitation can be related to atmospheric circulation which is a consequence of pressure and temperature differences wind flow and availability of moisture shastri et al 2015 large scale daily circulation data was collected from the national centers for environmental prediction ncep national center for atmospheric research ncar reanalysis project kalnay et al 1996 http www cdc noaa gov cdc reanalysis reanalysis html and the european center for medium range weather forecasts interim re analysis era interim dee et al 2011 https www ecmwf int en forecasts datasets archive datasets reanalysis datasets era interim ncep reanalysis data covering the period of 1948 present is an old product which may not be suitable for long term analysis e g wang et al 2016 while era reanalysis data covering the period of 1979 present which is released in recent years with higher quality the pressure level of 500 hpa was analyzed in this study because it is the representative level for the mean steering flow of convective storms hagemeyer 1991 3 methods 3 1 trend and change point analysis long term trends of annual and seasonal extremes were quantified using nonparametric mann kendall rank statistics mann 1945 kendall 1975 which has been widely used to assess monotonic trends in hydrologic and climate data it has been recommended by the world meteorological organization wmo machiwal and jha 2012 due to the fact that it is less sensitive to outliers than parametric statistics and does not require normality or linearity assumption the significance level was set as 0 05 the change point analysis was also applied to these annual and seasonal extremes to identify the timing of change points a number of statistical tests for detecting the change point have been used in previous studies such as mann whitney u test zhang et al 2014c moving t test jiang et al 2002 pettitt test villarini et al 2009 etc among these tests the pettitt test was chosen to detect change points due to the following reasons 1 it is a nonparametric rank based test without presupposing the location of change point and 2 the p value of the test statistic can be computed using the approximate limited distribution pettitt 1979 mallakpour and villarini 2016 the null hypothesis that no change occurs in the time series is rejected when the p value is less than 0 05 3 2 stationary and nonstationary frequency analysis the extreme value theory is used to analyze the tail of a distribution for precipitation extremes and is applied to estimate return periods of rare events the accuracy of a return period estimated by traditional stationary frequency analysis is questionable when the time series of precipitation extremes violates the stationary assumption in this study we defined stationarity of a precipitation extreme time series as free of trends shifts or periodicity the above mentioned trend and change point analysis was also used to identify the stationarity of precipitation extremes which has been widely used in previous studies e g villarini et al 2011 gu et al 2017b in addition the bootstrap technique was also employed to assess if these parameters of distribution functions of these extremes exhibited significant changes kharin and zwiers 2005 vittal et al 2013 from the time series of precipitation extremes during 1961 1987 period the bootstrap method was used to resample a new time series by which the generalized extreme value gev distribution was then fitted as a result we can obtain one set of estimated parameters of gev distribution the above procedures will be repeated by 1000 times and then 1000 sets of estimated parameters were obtained during 1961 1987 period in the same way for the time series of precipitation extremes during 1988 2014 period we can also obtain 1000 sets of estimated parameters the changes corresponded to an approximately 20 statistical significance level at which the 60 confidence interval of any of the distribution parameters did not overlap pre 1987 and post 1987 overall the precipitation extreme series was nonstationary when it satisfied any of the significance level of trend change point or bootstrap for frequency analysis in precipitation extremes a cluster of 66 generalized additive model for location scale and shape gamlss based frequency analysis model was developed to estimate the return period a detailed description on the 66 models is provided in table s1 in the supporting information the 66 nonstationary models were performed for only those stations that showed the nonstationary in precipitation extremes otherwise the stationary models with these probability distributions were conducted the gamlss model proposed by rigby and stasinopoulos 2005 has been widely used in nonstationary frequency analysis as it provides a flexible choice compared with classical generalized additive models gam e g villarini et al 2009 lópez and franés 2013 the gamlss model assumes that independent observations y i for i 1 2 3 n following the distribution function of fy yi θi where θi θi1 θi2 θip is a vector of p parameters accounting for location scale and shape random variable characteristics generally p is less than or equal to four since one two three and four distribution parameters guarantee enough flexibility for most applications the distribution parameters were related to the explanatory variables by monotonic link functions g k for k 1 2 p where the parameters were modeled through proper link functions gamlss involves several models and in particular the semi parametric additive formulation was used in this paper 1 g k θ k x k β k j 1 m h jk x jk where θk are the parameter vector of length n xk is a matrix of explanatory variables of order n m in this study the explanatory variable is time βk is a parameter vector of length m and hjk denotes the functional dependence of the distribution parameters on explanatory variables xjk which is a column of matrix xk this dependence can be linear nonlinear or smoothened through smoothing terms the stationary and nonstationary modeling framework proposed and implemented in the study is provided in fig 1 3 3 clustering analysis the changes detected in this study i e trends change points and nonstationarity in annual and seasonal precipitation extremes can be caused by large scale circulation patterns to examine this first the eight meteorologically homogenous regions in china were considered which were identified by zhang and lin 1985 and were further validated by xiao et al 2013 the zonally averaged precipitation in each region was calculated second six large scale daily predictors i e air temperature relative humidity pressure u winds v winds and vertical wind velocity in each region were considered to reduce dimensionality without reducing the variability of original datasets by a principal component analysis salvi et al 2013 taking region i as an example there are 84 2 5 2 5 grids covering this region each of the six large scale daily predictors i e air temperature relative humidity pressure u winds v winds and vertical wind velocity in region i was first normalized to eliminate the differences in magnitude of values among these predictors then we obtained six normalized 19723 84 matrixes where the 19723 indicates the number of daily values during the 1961 2014 and the 84 indicates the number of grids covering the region i we combined the six matrixes by column to form a 19723 504 matrix which was the input values for the principal component analysis the principal components selected must represent about 95 of the total variance third we performed a cluster analysis by implementing k mean clustering with the principal components as inputs k mean clustering aims to partition n observations into k groups mcqueen 1967 the technique is an unsupervised classification technique and reads the selected principal components of daily observed climatic variables which represent the daily large scale circulation pattern then daily large scale circulation patterns were clustered with each day associated with a specific cluster that is referred to as climate state of the particular day finally dunn s index was used to optimize the total number of clusters dunn 1973 after completing the above steps the zonally averaged precipitation in each region was divided into two equal halves of 27 years i e 1961 1987 and 1988 2014 and then quantile values were estimated starting from 75 to 99 for both halves for each cluster of homogeneous climatic zones after this process differences in the quantile values for both halves provided the possible impact of urbanization and precipitation extremes on precipitation because the large scale circulation patterns were controlled shastri et al 2015 the clustering analysis framework proposed and implemented in the study is provided in fig 1 4 results 4 1 impact of urbanization on long term changes in precipitation extremes the 54 year period i e 1961 2014 was divided into two segments pre 1987 period i e 1961 1987 with low level urban expansion and post 1987 period i e 1988 2014 with rapid urbanization analysis of spatially averaged annual and seasonal extremes in china revealed that trends of pre 1987 and post 1987 had similar patterns among rural urbanizing and urbanized areas fig 2 increasing trends in both periods i e pre 1987 and post 1987 in spring and winter and a shift from decreasing into increasing trends from pre 1987 to post 1987 in autumn were observed in all rural urbanizing and urbanized areas annual and seasonal precipitation extremes during the post 1987 period were detected with increasing trends in all of rural urbanizing and urbanized areas which was probably because of the c c relationship that precipitation extremes increase under global warming min et al 2011 donat et al 2016 gu et al 2017a however no significant differences in the increasing slopes among rural urbanizing and urbanized areas were found suggesting that urbanization had a limited effect on the increasing trends of annual and seasonal precipitation extremes in the post 1987 period trend analysis of annual and seasonal precipitation extremes at individual stations was also performed for both periods pre 1987 and post 1987 fig 3 here three categories of trends were considered positive trend increasing at 0 05 significance level negative trend decreasing at 0 05 significance level and no trend trend not significant at 0 05 level more than 90 of the stations showed no trend in annual and seasonal precipitation extremes during both periods no discernible spatial patterns of annual and seasonal precipitation extremes were observed at stations with significant trends during the pre 1987 period in contrast to the pre 1987 period stations with significant trends during the post 1987 period were less spatially varying in china especially in autumn and winter for example the northern part of china is dominated by stations with increasing trends in autumn while the southwestern central part is dominated by stations with decreasing trends in winter these two parts with significant trends are mainly rural areas implying that the changes in large scale regional weather lead to significant increases in precipitation extremes in urban areas such as north china eastern china southeastern china no clustering of stations with significant trends can be observed during the post 1987 period indicating no prominent urban signatures of extremes in terms of trends furthermore changes in trend types of each grid from pre 1987 to post 1987 periods e g from increasing to decreasing trends from decreasing to increasing trends etc were also analyzed fig 3c f i l o the percentages of stations that experienced changes in trend types after 1987 i e the percentages of stations with no similarity were almost similar among all rural urbanizing and urbanized stations also analysis of trends in annual and seasonal precipitation extremes during the 54 year period i e 1961 2014 showed that a few stations had significant trends with high spatial heterogeneity among stations fig s1 which is in line with yang et al 2013a b the change point analysis also illustrated that urban stations did not have significant changes in trend directions in annual and seasonal precipitation extremes which is consistent with the results of gu et al 2017b fig s1 so far results provided limited evidence of the effect of urbanization on long term trends in annual and seasonal precipitation extremes then we analyzed whether urbanization had significant impacts on magnitudes of precipitation extremes stationary fa was applied to estimate the magnitudes of extremes of 50 year return period in pre 1987 and post 1987 periods fig 4 the percentages of increases and decreases in precipitation extremes were almost 50 to 50 of the stations and the percentages were almost the same with those in rural urbanizing and urbanized stations the spatial patterns of changes in extremes of 50 year return period showed discernible regional characteristics with increases mainly in south and northwest china and decreases mainly in north china in annual and seasonal precipitation extremes similar spatial patterns in rural urbanizing and urbanized stations were also observed suggesting that regional changes in extremes of 50 year return period were more dominated by synoptic large scale circulations than local urbanization however it should be noted that the changes in the magnitudes of precipitation extremes of 50 year return period can be affected by the fitting of statistical distributions and hence the bootstrapping approach was applied to estimate the changes with significance level kharin and zwiers 2005 fig 5 again the percentages of stations with positive and negative changes a total about 30 in annual and seasonal precipitation extremes were consistent among all rural urbanizing and urbanized stations the spatial patterns at stations with significant changes were not observed with evident differences among all rural urbanizing and urbanized stations hence urban signature was not prominent on changes in the magnitudes of annual and seasonal precipitation extremes at the national scale from fig 5 it was evident that both positive and negative changes in urbanizing and urbanized stations were found and that positive negative changes tended to occur in north china south china this points out that precipitation extremes may not always be intensified in urban areas as hypothesized by kishtawal et al 2010 which may also depend on regional characteristics such as geographical location water vapor condition monsoon tropical cyclones and so on 4 2 impact of urbanization on nonstationary fa of precipitation extremes trend analysis change point analysis and a bootstrapping approach were also used to identify the nonstationarity in annual and seasonal precipitation extremes and results provided limited evidence of the violation of the stationarity assumption in both annual and seasonal precipitation extremes fig 6 only about 10 of the stations exhibited significant nonstationarity and about 20 in winter among the stations with nonstationarity the percentages of rural urbanizing and urbanized stations were almost in line with the percentages of rural urbanizing and urbanized stations to total stations i e 60 18 and 22 respectively thus it was difficult to confirm that urbanization was a major factor that caused nonstationarity in annual and seasonal precipitation extremes at the national scale however in a particular region such as north china and eastern china the two areas with high level of urbanization nonstationarity tended to occur in urbanizing and urbanized stations especially in annual spring and summer precipitation extremes this indicates that urban signatures of nonstationarity in precipitation extremes were prominent in the regional scale the nonstationarity was modeled by implementing a cluster of 66 gamlss models to conduct fa the akaike information criterion aic and worm plots were used to identify the best fitting model among the nonstationary stations about 80 and 20 of stations were best fitted by first and second order nonstationary models respectively fig 7 this result stresses the importance of conjugal application of both first and second order nonstationary models two representative stations with the optimal models of first and second order nonstationary models in both annual and seasonal precipitation extremes were selected to evaluate the performance of the proposed framework the changes in location and scale parameters the two parameters of fitted extreme value distribution function in a 30 year moving window and the probability density functions pdf in three periods i e 1961 1985 1975 2000 1986 2014 are shown in fig 7 it is quite evident that both location and scale parameters showed significant changes and that the pdf also exhibited changes in the three periods these results ensure the satisfactory performance of the proposed nonstationary gamlss models the 50 year return period at the nonstationary stations was estimated by the nonstationary gamlss models and compared with those estimated by the stationary model fig 8 among these nonstationary stations more than 50 of the stations showed positive changes in annual and seasonal precipitation extremes except in autumn implying more intense 50 year precipitation for nonsationary fa the median values of absolute differences in 50 year precipitation estimated by stationary and nonstationary fa were calculated at rural urbanizing and urbanized stations separately results showed that the magnitudes of absolute differences were higher in urbanizing stations than those at rural and urbanized stations in annual spring summer and autumn the return periods under stationary and nonstationary conditions at 15 exemplary stations at different locations belong to rural urbanizing and urbanized areas fig s3 also showed more noticeable differences fig s4 the percentages of differences between stationary and nonstationary frequency analyses for the 50 year return period were 25 23 5 22 9 19 9 and 12 higher than or closet to those at rural and urbanizing stations fig s4 the performances of these 15 exemplary stations were validated by worm plot fig s5 fig s5 shows no significant deviations from normality in the residuals for all 15 exemplary stations indicating the model fitted satisfactorily furthermore because urban signatures of extremes were more pronounced at the regional scale than at the national scale return periods estimated by stationary and nonstationary fa in spatial zonally averaged precipitation extremes classified as rural urbanizing and urbanized classes at the regional scale were analyzed fig 9 region vi north china fig s2 was selected as a typical region that urbanization had a strong effect on nonstationarity in precipitation extremes fig 6 because most of nonstationary stations coincided with urbanizing and urbanized areas in region vi fig s6 significant changes in return periods were found for the zonally averaged precipitation extremes at urbanizing stations which were larger than those at rural and urbanized stations this characteristic was the most obvious in annual precipitation extremes fig 9a c these results indicate that the urbanizing process i e from rural to urban transition can lead to nonstationarity in precipitation extremes 4 3 identification of the effects of urbanization on changes in precipitation extremes although nonstationarity in precipitation extremes was detected in urban areas it was not certain whether the nonstationarity was primarily caused by local lulc changes or changes in large scale circulation patterns to examine this the k mean method was used to cluster daily precipitation into different classes in each meteorologically homogenous region based on era interim reanalysis data and dunn s index was used to select the optimum number of classes table s2 which were 5 4 4 2 5 3 2 and 2 for region i to region viii respectively table s2 therefore the centroids of clusters 1 and 2 for large scale climate variables namely air temperature pressure relative humidity u wind v wind and vertical wind velocity are shown in fig 10 differences between the cluster centroids for all variables were observed which shows the importance of classification to understand the existence of different circulation patterns to understand the influence of urbanization on precipitation extremes the spatial zonally averaged daily precipitation datasets in each region were divided into two equal halves 1979 1997 and 1998 2014 considering the period of era interim reanalysis data the distribution of circulation classes in both periods had little change in each region fig s7 then the quantile values from 75 to 99 were calculated in each period for cluster 1 and cluster 2 figs 11 and 12 the differences in quantiles between the two periods were probably caused by local urbanization because the large scale circulation patterns were controlled shastri et al 2015 in cluster 1 changes in the high quantile values i e the values corresponding to more than 90th of daily precipitation for urbanized and urbanizing stations were only found in regions i iii iv and vii while changes in the high quantile values were not prominent at rural stations in these regions fig 11 we also employed ncep reanalysis data to determine the classes for these climate variables table s3 and compared the high quantile values during the two periods of 1961 1987 and 1988 2014 for each region in cluster1 fig s8 the two equal periods are corresponding to the above partitions on the periods of impacts of urbanization on precipitation changes in the high quantile values for urbanized and urbanizing stations were only found in regions i ii and vii and can be observed in fig s8 which is similar with that obtained from era interim fig 11 among the three regions regions iv and vii are two of the most highly urbanized areas including the richest provinces such as beijing the capital of china jiangsu zhejiang and shanghai the lower mean vertical wind velocity in cluster 1 over region vii was indicative of favorable weather conditions for the development of uhi szegedi and kircsi 2003 blazejczyk et al 2006 at the same time high pressure in cluster 1 in region vii suggested a favorable condition for the uhi impacts morris and simmonds 2000 in cluster 2 region i was the only area with obvious differences in high quantile values between the two periods not for rural classes but for urbanizing classes fig 12 most regions showed little changes in high quantile values for all of rural urbanizing and urbanized classes between the two periods similar results can also be found in fig s9 obtained from ncep reanalysis data in cluster 2 in which region vi was the only area with obvious differences in high quantile values between the two periods not for rural class but for urbanizing and urbanized classes it was evident that when the large scale circulation pattern was controlled changes in precipitation quantiles in urban stations were associated primarily with the influence of local changes such as urbanization it should be noted that most regions showed little changes in high quantile values for all of rural urbanizing and urbanized classes between the two periods overall the results obtained from both era interim and ncep reanalysis data show that urban signatures on precipitation extremes are not prominent at the national scale but are at the regional scale 5 discussion results indicated that it was difficult to illustrate the presence of a possible climate change signal and urban signature in long term changes in annual and seasonal precipitation extremes because most of the stations did not have significant trends or change points in precipitation extremes in all three periods 1961 1985 1986 2014 and 1961 2014 fig 3 fig s1 this feature was in good agreement with previous studies e g yang et al 2013a b gu et al 2017b the spatial distributions of changes in the 50 year return period of annual and seasonal precipitation extremes showed noticeable regional patterns figs 4 5 which were also in line with previous studies e g chen et al 2014 wang et al 2015a guan et al 2017 yang et al 2017a c for example increases in annual precipitation extremes after 1987 in northeast china south china and northwest china were also observed by yang et al 2017a c and guan et al 2017 respectively there are different meteorological and climatological mechanisms that transport moisture that can produce extreme precipitation to china i e tropical cyclones convection thunderstorms frontal passages and sea surface temperature sst anomalies hirschboeck 1988 most of these studies attributed the changes in precipitation extremes to global changes such as changes in sea surface temperature sst anomalies and global warming e g chen et al 2014 chen and sun 2017 gu et al 2017c gao et al 2017 recently chen and sun 2017 pointed out that human induced warming has increased daily precipitation extremes by approximately 13 based on previous studies and the fact that urban areas count for only 0 7 of the chinese territory wang et al 2015b large scale circulation patterns may be a more important dominant factor for the long term changes in precipitation extremes at the national scale yang et al 2016 also validated that climate warming contributes to more than 80 of total thermal loading over beijing city with the rest effect from urbanization however many studies have pointed out that the local climates e g temperature precipitation of urban areas are significantly different from nearby suburbs sun and shu 2007 miao et al 2011 liang et al 2013 chen et al 2015 urbanization may affect the patterns and extremes of local precipitation through urban roughness uhi modified winds and aerosols niyogi et al 2007 our results also indicate that urbanization causes nonstationarity in precipitation extremes in some regions such as north china fig 6 furthermore obvious differences in high quantile values not for rural classes but for urbanizing and urbanized classes are detected over north china and central china region vi and vii when large scale circulation patterns are controlled figs 11 and 12 both areas have the highest level of urbanization in china in which strong influences of urbanization on local precipitation i e beijiang and shanghai have been identified in previous studies e g liang et al 2013 yang et al 2017a c the findings of this study are consistent with those in previous studies but also highlight that changes in return periods estimated by stationary and nonstationary models are more noticeable at urbanizing stations that at rural and urbanized stations figs 8 and 9 wang et al 2015a also found that high level urban development caused no significant changes in precipitation the possible reason is that the lulc will not change substantially and the feedbacks of changes in lulc on local circulation patterns will remain unchanged after urbanization slows down and stabilizes which will lead to precipitation extremes becoming stationary again however in urbanizing areas rapid urban expansion is undergoing and the rapid transition in lulc may cause local circulation changes considerably the physical processes of urbanization affecting local precipitation are complex and still a huge challenge to face urban atmospheric circulation associated with precipitation is modified and affected mainly by land cover and urban aerosols however the impacts of land cover and urban aerosols on urban modification of precipitation may vary and be sensitive with the different degrees of urbanization wang et al 2015a c taking the greater beijing metropolitan area gbma as an example intensive precipitation has been verified by observations and can be confirmed as a result of urbanization yang et al 2017a c urbanization affecting surface air temperature surface air pressure relative humidity and near surface wind directions for example modifying diurnal temperature and air pressure cycles adjusts local water cycle and regulates precipitation process over gbma yang et al 2017a c specifically urban surface roughness enhances convergence and thus increases atmospheric vertical motions and even precipitation lin et al 2011 and urban emissions produce aerosols increasing the cloud condensation nuclei han et al 2012 as gbma expanded during the past several decades the sub urban areas are translated to urban areas continually with skyscrapers larger population and more factory activities which lead to increasing surface roughness and urban aerosols and thus altering precipitation characters unremittingly however after gbma expand to a certain extent no more increases of surface roughness and urban aerosols may make the atmospheric stabilized and precipitation characters stationary again wang et al 2015a c singh et al 2016 wang et al 2015b pointed out that the contributions of urban heat island to climate of the whole of china can be negligible less than 1 by considering the spatial scale of urbanization effects yang et al 2017a c used hourly surface air and precipitation data from high network stations to explore the association of short duration intense precipitation with urbanization in the beijing urban area indicating that the strongest association is found in or near the central urban area paul et al 2018 further pointed out that the impacts of urbanization on precipitation extremes can be detected only in stations located inside the urban pockets with intensified precipitation even in urban areas the signature of urbanization in precipitation extremes is not uniform but more prominent at few pockets where intensification in precipitation can be observed and simulated with increasing spatial variability on the one hand precipitation is strengthened by the unstable conditions prevailing in the boundary layer while the increased instability is not apparent everywhere in the city numerical simulations showed that several urban pockets of updrafts and downdrafts trigger the precipitation instability significantly paul et al 2018 on the other hand aerosol is another important factor influencing precipitation extremes in urban areas the contrasting impacts of increased aerosols on precipitation processes between upstream and downstream areas can also contribute to increasing spatial variability of precipitation extremes taking the greater beijing metropolitan area gbma as an example increasing aerosols can suppress enhance convection and precipitation over upstream downstream areas of the gbma zhong et al 2015 the spatial variability of urban signature in precipitation extremes prompts us to conduct more work of the impacts of urban pockets on the stationarity of precipitation extremes 6 summary and conclusions based on lulc data the stations are classified in three categories rural urbanizing and urbanized stations trend change point and gev distribution are used to analyze nonstationarity in annual and seasonal precipitation extremes in the three categories the 54 year period 1961 2014 is divided into two periods 1961 1987 with low level of urbanization and 1988 2014 with a rapidly urbanizing process changes in long term trends and 50 year return period between the two periods were applied to demonstrate the influences of urbanization on precipitation extremes in our results limited evidence supports that urban signatures on extremes are prominent at the national scale 1 no obvious differences can be observed in nationally averaged annual and seasonal precipitation extremes among rural urbanizing and urbanized classes 2 the spatial patterns of station based trends in annual and seasonal precipitation extremes in rural urbanizing and urbanized stations are similar 3 the stations with significant trends are clustered in several parts of china such as the northern part of china in autumn and the southwestern central part of china in winter which are considered as regional trends governed by synoptic large scale circulation rather than local urbanization 4 few shifts i e significant changes in trend directions can be detected in urbanizing and urbanized stations by using change point analysis and 5 the spatial distributions of changes in 50 year return period are similar among rural urbanizing and urbanized stations we also examined the influences of urbanization on nonstationary fa in annual and seasonal precipitation extremes using a cluster of 66 gamlss models proposed in this study this framework is capable of capturing both the linear and nonlinear characteristics of precipitation extremes only about 10 of the stations show significant nonstationarities in annual and seasonal precipitation extremes and this number reaches 18 in winter among these nonstationary stations about 20 of stations are chosen for second order nonstationary models highlighting the importance of conjugal application of both first and second order nonstationary models with consideration of an adequate number of models that can relax a wide range of assumptions results of nonstationary models show that the signature of nonstationarity is more significant at the regional scale than that at the national scale although the percentages of nonstationary stations in rural urbanizing and urbanized classes are almost in line with the percentages of rural urbanizing and urbanized stations to total stations nonstationarity tends to occur in urbanizing and urbanized stations over a particular region such as north china and eastern china the two areas with high level of urbanization especially for annual spring summer precipitation extremes additionally our results also reveal that the signature of nonstationarity in precipitation extremes tends to be greater in urbanizing stations where lulc transition is still underway and local changes may be more drastic compared with rural and urbanized stations to further examine the changes in precipitation extremes due to large scale circulation or local changes k mean cluster analysis is applied to classify the zonally averaged daily precipitation into several groups in the same group large scale circulation pattern is controlled most of the meteorologically homogenous regions do not display any differences in quantile values between the periods of 1961 1987 and 1988 2014 stressing that urban signature is not prominent at the national scale however we indeed observe that regions vi and vii which have the highest level of urbanization in china display obvious differences in high quantile values between the two periods for urbanizing and urbanized classes overall this study attempts to examine the influence of urbanization on annual and seasonal extremes in terms of long term change and nonstationarity at the national scale results highlight that large scale circulations may be the dominating factor in long term changes in annual and seasonal precipitation extremes at the national scale while urbanization affects the relationship between large scale circulation and precipitation extremes at the regional scale this study has relevance in the context of adaptation and policy formulation especially under the impact of urbanization and climate change in rural urbanizing and urbanized areas it should be noted that there are large uncertainties on our results due to the limitation of record length we also highlight the importance of future model based studies such as dynamic experiment with regional climate models to understand the physical processes of impacts of local changes in precipitation extremes at different geographical locations in china declaration of competing interest here we declare no conflicts of interests acknowledgments this work is financially supported by the national science foundation for distinguished young scholars of china grant no 51425903 the national key r d program of china grant no 2018yfa0605603 the strategic priority research program grant of the chinese academy of sciences grant no xda19070402 the fund for creative research groups of national natural science foundation of china grant no 41621061 and the fundamental research funds for the central universities china university of geosciences wuhan grant no cugcj1702 and cug180614 our cordial gratitude should be extended to the editor prof dr emmanouil anagnostou and anonymous reviewers for their professional and pertinent comments which are greatly helpful for further quality improvement of this manuscript appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 05 070 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
6371,chinese cities have been experiencing unprecedented growth for over three decades and the resulting urbanization is having a remarkable impact on the hydrological cycle at the local and regional scale this study therefore examined the influence of urbanization on nonstationarity of annual and seasonal precipitation extremes in china using daily precipitation data from 1857 stations for 1961 2014 and ncar ncep and era interim reanalysis datasets results of trend change point and bootstrap analyses revealed that urban signatures on long term changes i e trends and magnitudes of precipitation extremes were not prominently visible at the national scale however a nonstationary frequency analysis of precipitation extremes by a generalized additive model for location scale and shape gamlss framework with a cluster of 66 models showed that urbanization caused nonstationarity in precipitation extremes at local and regional scales such as north china further significant nonstationarity tended to occur more in urbanizing areas than in rural and urbanized areas suggesting that land use land cover lulc transition i e rural areas turning into urban areas played an important role in introducing nonstationarity furthermore analysis of large scale circulation patterns using k mean clustering showed that urban signatures on extremes were not prominent at the national scale but at the regional scale further studies are needed to enumerate physical mechanisms causing the impact of local environmental changes on precipitation extremes at different geographical locations over china keywords urbanization precipitation extremes long term changes nonstationarity gamlss china 1 introduction weather and climate extremes have devastating effects on human society as well as the environment parry et al 2007 zhang et al 2016 in the backdrop of global warming and climate change precipitation extremes have been reported to become more frequent and intense across the globe donat et al 2016 ingram 2016 the theoretical explanation for increases in precipitation extremes is that atmospheric water holding capacity is expected to increase exponentially with temperature based on the clausius clapeyron c c equation and that atmospheric water content is expected to increase accordingly allen and ingram 2002 pall et al 2007 willett et al 2007 gu et al 2017a however more and more regional studies have reported that global warming may not lead to increases in precipitation extremes in some regions e g maeda et al 2012 vittal et al 2016 because precipitation extremes are influenced by many other factors such as tropical cyclones gu et al 2017b zhang et al 2017 topography zhang et al 2014a as well as land surface conditions urbanization soil moisture etc liu et al 2014a b ford et al 2015 yang et al 2017a c while urbanization has been causing growing concerns because of its impact on changes in precipitation extremes sun et al 2016 zhao et al 2016 the twentieth century has witnessed rapid urbanization and exponential population growth worldwide the percentage of urban population rose from 13 in 1900 to 49 in 2005 and is projected to reach 60 in 2030 united nations 2011 such intensive urbanization may exert substantial impacts on changes in regional precipitation extremes besides global warming urban heat island uhi is another critical factor causing urban areas to become hotter uhi impacts precipitation extremes by influencing the development of clouds local convection aerosols and so on ren et al 2008 shepherd et al 2010 yang et al 2013a b increasing observational evidence and climate model simulations have demonstrated the relationship between urbanization and precipitation during the past several decades vittal et al 2013 wang et al 2015a c holst et al 2016 cristiano et al 2017 china the most populous country in the world is experiencing rapid urbanization as seen from more than doubling of urban population since 2012 besides changes in precipitation extremes caused by global climate change and local land use land cover lulc changes e g urbanization are greatly impacting floods droughts and food safety therefore a multitude of studies have analyzed the relationship between precipitation and urbanization in china sun and shu 2007 miao et al 2011 liang et al 2013 chen et al 2015 dou et al 2015 wang et al 2015a c yang et al 2017a c these studies show that urbanization affects the spatial distribution and amount of precipitation and tends to amplify precipitation for example yang et al 2017a c found that higher frequencies and amounts of short duration intense rainfall events occurred in or near the central urban areas in beijing than in rural areas however other studies found negative effects of urbanization on precipitation e g guo et al 2006 zhang et al 2009 wang et al 2012 this indicates that urban effects on precipitation regimes were not understood well although a number of studies have related urbanization to the intensification of precipitation there is a considerable debate and or discrepancy concerning the influence of urbanization versus large scale forcing on changes in precipitation extremes and on changing patterns of urban areas in china in spite of inconsistencies with respect to the effect of urbanization on precipitation previous studies mainly focused on three urban areas namely beijing shanghai and the pearl river delta to the best of our knowledge studies at the national scale that examine the impacts of urbanization on long term changes of precipitation extremes are very limited although long term changes of precipitation extremes have been widely examined in different parts of china the results are mainly linked to global climate change without considering the effect of urbanization zhang et al 2012 2014b yang et al 2013a b chi et al 2016 besides nonstationary frequency analysis fa in precipitation extremes was also analyzed due to its importance in infrastructure design milly et al 2008 min et al 2011 mondal and mujumdar 2015 showed that local changes were more responsible for causing nonstationarity in precipitation extremes than other physical covariates such as nature variability the objectives of this study therefore were 1 to examine the effect of urbanization on long term changes in annual and seasonal precipitation extremes and 2 to link nonstationarity of annual and seasonal precipitation extremes to the extent of urbanization in china results of this study would have relevance in planning and policy formulation for urbanized urbanizing and rural areas in china 2 data in situ precipitation observations from 2474 rain gauge stations across china were obtained from the china meteorological information center e g ma et al 2015 zhang et al 2017 the quality of this data has been checked and controlled before its release specifically any extreme visibly erroneous minima and maxima were removed and sites with data judged unreliable were discarded for example a value will be deleted if it is twice higher than the highest value ever occurred the maximum 6 h rainfall accumulation was 830 mm at the linzhuang station during the august 1975 flood yang et al 2017a c a station is excluded from the analysis if the percentage of missing values is larger than 5 we further homogenized this data using the method described in xu et al 2013 and detected and adjusted the temporal inhomogeneity in the data using the easterling peterson technique li et al 2004 as a result a total of 1857 stations are retained for analysis in this study 1336 out of total 1857 stations without missing data accounts for 72 additionally 445 out of total 1857 stations with missing data less than 1 accounts for 24 a total of 96 stations have missing data with a percentage less than 1 the missing precipitation values for 1 2 days were filled by the average precipitation of the neighboring days data missing for consecutive days were interpolated by the long term average of the same days of other years for the objectives of this study the gap fill method did not significantly affect the final results a similar method had been used by zhang et al 2011 to fill daily missing precipitation values here we used the annual and seasonal spring march to may summer june to august autumn september to november winter december to february maxima of each station to define precipitation extremes we chose these indices because they can characterize extreme events that often cause impacts on the society these annual and seasonal indices can be also used to estimate the probability of extreme events of certain return period which are used in infrastructure design min et al 2011 there are different ways to define urban and rural stations such as based on population vittal et al 2013 station history size of built up areas ren et al 2015 etc the urbanization in china can be unambiguously divided into two halves during the periods of 1961 2014 1961 1987 with weak urbanization effects and 1988 2014 with rapid urbanization since the reform and opening up policy in the 1980s the lulc data from 1980s and 2015 with a spatial resolution of 1 1 km were collected from data center for resources and environmental sciences chinese academy of sciences resdc http www resdc cn the lulc data shows discernible urban areas and rapid urban expansion e g liu et al 2014a b therefore a simple but valid method was used to define rural urbanizing and urbanized stations following the liao et al 2018 and luo and lau 2018 1 rural stations with their locations in rural areas in both the 1980s and 2015 2 urbanizing stations with their locations in rural areas in the 1980s but in urban areas in 2015 and 3 urbanized stations with their locations in urban areas in both the 1980s and 2015 there were 1115 341 401 stations classified as rural urbanizing and urbanized stations respectively fig s1 the number of urban stations in our manuscript is similar with that in liao et al 2018 and luo and lau 2018 considering impacts of large scale circulation patterns on precipitation extremes individual large scale meteorological variables i e air temperature humidity pressure u winds v winds and vertical wind velocity were also included in analysis precipitation can be related to atmospheric circulation which is a consequence of pressure and temperature differences wind flow and availability of moisture shastri et al 2015 large scale daily circulation data was collected from the national centers for environmental prediction ncep national center for atmospheric research ncar reanalysis project kalnay et al 1996 http www cdc noaa gov cdc reanalysis reanalysis html and the european center for medium range weather forecasts interim re analysis era interim dee et al 2011 https www ecmwf int en forecasts datasets archive datasets reanalysis datasets era interim ncep reanalysis data covering the period of 1948 present is an old product which may not be suitable for long term analysis e g wang et al 2016 while era reanalysis data covering the period of 1979 present which is released in recent years with higher quality the pressure level of 500 hpa was analyzed in this study because it is the representative level for the mean steering flow of convective storms hagemeyer 1991 3 methods 3 1 trend and change point analysis long term trends of annual and seasonal extremes were quantified using nonparametric mann kendall rank statistics mann 1945 kendall 1975 which has been widely used to assess monotonic trends in hydrologic and climate data it has been recommended by the world meteorological organization wmo machiwal and jha 2012 due to the fact that it is less sensitive to outliers than parametric statistics and does not require normality or linearity assumption the significance level was set as 0 05 the change point analysis was also applied to these annual and seasonal extremes to identify the timing of change points a number of statistical tests for detecting the change point have been used in previous studies such as mann whitney u test zhang et al 2014c moving t test jiang et al 2002 pettitt test villarini et al 2009 etc among these tests the pettitt test was chosen to detect change points due to the following reasons 1 it is a nonparametric rank based test without presupposing the location of change point and 2 the p value of the test statistic can be computed using the approximate limited distribution pettitt 1979 mallakpour and villarini 2016 the null hypothesis that no change occurs in the time series is rejected when the p value is less than 0 05 3 2 stationary and nonstationary frequency analysis the extreme value theory is used to analyze the tail of a distribution for precipitation extremes and is applied to estimate return periods of rare events the accuracy of a return period estimated by traditional stationary frequency analysis is questionable when the time series of precipitation extremes violates the stationary assumption in this study we defined stationarity of a precipitation extreme time series as free of trends shifts or periodicity the above mentioned trend and change point analysis was also used to identify the stationarity of precipitation extremes which has been widely used in previous studies e g villarini et al 2011 gu et al 2017b in addition the bootstrap technique was also employed to assess if these parameters of distribution functions of these extremes exhibited significant changes kharin and zwiers 2005 vittal et al 2013 from the time series of precipitation extremes during 1961 1987 period the bootstrap method was used to resample a new time series by which the generalized extreme value gev distribution was then fitted as a result we can obtain one set of estimated parameters of gev distribution the above procedures will be repeated by 1000 times and then 1000 sets of estimated parameters were obtained during 1961 1987 period in the same way for the time series of precipitation extremes during 1988 2014 period we can also obtain 1000 sets of estimated parameters the changes corresponded to an approximately 20 statistical significance level at which the 60 confidence interval of any of the distribution parameters did not overlap pre 1987 and post 1987 overall the precipitation extreme series was nonstationary when it satisfied any of the significance level of trend change point or bootstrap for frequency analysis in precipitation extremes a cluster of 66 generalized additive model for location scale and shape gamlss based frequency analysis model was developed to estimate the return period a detailed description on the 66 models is provided in table s1 in the supporting information the 66 nonstationary models were performed for only those stations that showed the nonstationary in precipitation extremes otherwise the stationary models with these probability distributions were conducted the gamlss model proposed by rigby and stasinopoulos 2005 has been widely used in nonstationary frequency analysis as it provides a flexible choice compared with classical generalized additive models gam e g villarini et al 2009 lópez and franés 2013 the gamlss model assumes that independent observations y i for i 1 2 3 n following the distribution function of fy yi θi where θi θi1 θi2 θip is a vector of p parameters accounting for location scale and shape random variable characteristics generally p is less than or equal to four since one two three and four distribution parameters guarantee enough flexibility for most applications the distribution parameters were related to the explanatory variables by monotonic link functions g k for k 1 2 p where the parameters were modeled through proper link functions gamlss involves several models and in particular the semi parametric additive formulation was used in this paper 1 g k θ k x k β k j 1 m h jk x jk where θk are the parameter vector of length n xk is a matrix of explanatory variables of order n m in this study the explanatory variable is time βk is a parameter vector of length m and hjk denotes the functional dependence of the distribution parameters on explanatory variables xjk which is a column of matrix xk this dependence can be linear nonlinear or smoothened through smoothing terms the stationary and nonstationary modeling framework proposed and implemented in the study is provided in fig 1 3 3 clustering analysis the changes detected in this study i e trends change points and nonstationarity in annual and seasonal precipitation extremes can be caused by large scale circulation patterns to examine this first the eight meteorologically homogenous regions in china were considered which were identified by zhang and lin 1985 and were further validated by xiao et al 2013 the zonally averaged precipitation in each region was calculated second six large scale daily predictors i e air temperature relative humidity pressure u winds v winds and vertical wind velocity in each region were considered to reduce dimensionality without reducing the variability of original datasets by a principal component analysis salvi et al 2013 taking region i as an example there are 84 2 5 2 5 grids covering this region each of the six large scale daily predictors i e air temperature relative humidity pressure u winds v winds and vertical wind velocity in region i was first normalized to eliminate the differences in magnitude of values among these predictors then we obtained six normalized 19723 84 matrixes where the 19723 indicates the number of daily values during the 1961 2014 and the 84 indicates the number of grids covering the region i we combined the six matrixes by column to form a 19723 504 matrix which was the input values for the principal component analysis the principal components selected must represent about 95 of the total variance third we performed a cluster analysis by implementing k mean clustering with the principal components as inputs k mean clustering aims to partition n observations into k groups mcqueen 1967 the technique is an unsupervised classification technique and reads the selected principal components of daily observed climatic variables which represent the daily large scale circulation pattern then daily large scale circulation patterns were clustered with each day associated with a specific cluster that is referred to as climate state of the particular day finally dunn s index was used to optimize the total number of clusters dunn 1973 after completing the above steps the zonally averaged precipitation in each region was divided into two equal halves of 27 years i e 1961 1987 and 1988 2014 and then quantile values were estimated starting from 75 to 99 for both halves for each cluster of homogeneous climatic zones after this process differences in the quantile values for both halves provided the possible impact of urbanization and precipitation extremes on precipitation because the large scale circulation patterns were controlled shastri et al 2015 the clustering analysis framework proposed and implemented in the study is provided in fig 1 4 results 4 1 impact of urbanization on long term changes in precipitation extremes the 54 year period i e 1961 2014 was divided into two segments pre 1987 period i e 1961 1987 with low level urban expansion and post 1987 period i e 1988 2014 with rapid urbanization analysis of spatially averaged annual and seasonal extremes in china revealed that trends of pre 1987 and post 1987 had similar patterns among rural urbanizing and urbanized areas fig 2 increasing trends in both periods i e pre 1987 and post 1987 in spring and winter and a shift from decreasing into increasing trends from pre 1987 to post 1987 in autumn were observed in all rural urbanizing and urbanized areas annual and seasonal precipitation extremes during the post 1987 period were detected with increasing trends in all of rural urbanizing and urbanized areas which was probably because of the c c relationship that precipitation extremes increase under global warming min et al 2011 donat et al 2016 gu et al 2017a however no significant differences in the increasing slopes among rural urbanizing and urbanized areas were found suggesting that urbanization had a limited effect on the increasing trends of annual and seasonal precipitation extremes in the post 1987 period trend analysis of annual and seasonal precipitation extremes at individual stations was also performed for both periods pre 1987 and post 1987 fig 3 here three categories of trends were considered positive trend increasing at 0 05 significance level negative trend decreasing at 0 05 significance level and no trend trend not significant at 0 05 level more than 90 of the stations showed no trend in annual and seasonal precipitation extremes during both periods no discernible spatial patterns of annual and seasonal precipitation extremes were observed at stations with significant trends during the pre 1987 period in contrast to the pre 1987 period stations with significant trends during the post 1987 period were less spatially varying in china especially in autumn and winter for example the northern part of china is dominated by stations with increasing trends in autumn while the southwestern central part is dominated by stations with decreasing trends in winter these two parts with significant trends are mainly rural areas implying that the changes in large scale regional weather lead to significant increases in precipitation extremes in urban areas such as north china eastern china southeastern china no clustering of stations with significant trends can be observed during the post 1987 period indicating no prominent urban signatures of extremes in terms of trends furthermore changes in trend types of each grid from pre 1987 to post 1987 periods e g from increasing to decreasing trends from decreasing to increasing trends etc were also analyzed fig 3c f i l o the percentages of stations that experienced changes in trend types after 1987 i e the percentages of stations with no similarity were almost similar among all rural urbanizing and urbanized stations also analysis of trends in annual and seasonal precipitation extremes during the 54 year period i e 1961 2014 showed that a few stations had significant trends with high spatial heterogeneity among stations fig s1 which is in line with yang et al 2013a b the change point analysis also illustrated that urban stations did not have significant changes in trend directions in annual and seasonal precipitation extremes which is consistent with the results of gu et al 2017b fig s1 so far results provided limited evidence of the effect of urbanization on long term trends in annual and seasonal precipitation extremes then we analyzed whether urbanization had significant impacts on magnitudes of precipitation extremes stationary fa was applied to estimate the magnitudes of extremes of 50 year return period in pre 1987 and post 1987 periods fig 4 the percentages of increases and decreases in precipitation extremes were almost 50 to 50 of the stations and the percentages were almost the same with those in rural urbanizing and urbanized stations the spatial patterns of changes in extremes of 50 year return period showed discernible regional characteristics with increases mainly in south and northwest china and decreases mainly in north china in annual and seasonal precipitation extremes similar spatial patterns in rural urbanizing and urbanized stations were also observed suggesting that regional changes in extremes of 50 year return period were more dominated by synoptic large scale circulations than local urbanization however it should be noted that the changes in the magnitudes of precipitation extremes of 50 year return period can be affected by the fitting of statistical distributions and hence the bootstrapping approach was applied to estimate the changes with significance level kharin and zwiers 2005 fig 5 again the percentages of stations with positive and negative changes a total about 30 in annual and seasonal precipitation extremes were consistent among all rural urbanizing and urbanized stations the spatial patterns at stations with significant changes were not observed with evident differences among all rural urbanizing and urbanized stations hence urban signature was not prominent on changes in the magnitudes of annual and seasonal precipitation extremes at the national scale from fig 5 it was evident that both positive and negative changes in urbanizing and urbanized stations were found and that positive negative changes tended to occur in north china south china this points out that precipitation extremes may not always be intensified in urban areas as hypothesized by kishtawal et al 2010 which may also depend on regional characteristics such as geographical location water vapor condition monsoon tropical cyclones and so on 4 2 impact of urbanization on nonstationary fa of precipitation extremes trend analysis change point analysis and a bootstrapping approach were also used to identify the nonstationarity in annual and seasonal precipitation extremes and results provided limited evidence of the violation of the stationarity assumption in both annual and seasonal precipitation extremes fig 6 only about 10 of the stations exhibited significant nonstationarity and about 20 in winter among the stations with nonstationarity the percentages of rural urbanizing and urbanized stations were almost in line with the percentages of rural urbanizing and urbanized stations to total stations i e 60 18 and 22 respectively thus it was difficult to confirm that urbanization was a major factor that caused nonstationarity in annual and seasonal precipitation extremes at the national scale however in a particular region such as north china and eastern china the two areas with high level of urbanization nonstationarity tended to occur in urbanizing and urbanized stations especially in annual spring and summer precipitation extremes this indicates that urban signatures of nonstationarity in precipitation extremes were prominent in the regional scale the nonstationarity was modeled by implementing a cluster of 66 gamlss models to conduct fa the akaike information criterion aic and worm plots were used to identify the best fitting model among the nonstationary stations about 80 and 20 of stations were best fitted by first and second order nonstationary models respectively fig 7 this result stresses the importance of conjugal application of both first and second order nonstationary models two representative stations with the optimal models of first and second order nonstationary models in both annual and seasonal precipitation extremes were selected to evaluate the performance of the proposed framework the changes in location and scale parameters the two parameters of fitted extreme value distribution function in a 30 year moving window and the probability density functions pdf in three periods i e 1961 1985 1975 2000 1986 2014 are shown in fig 7 it is quite evident that both location and scale parameters showed significant changes and that the pdf also exhibited changes in the three periods these results ensure the satisfactory performance of the proposed nonstationary gamlss models the 50 year return period at the nonstationary stations was estimated by the nonstationary gamlss models and compared with those estimated by the stationary model fig 8 among these nonstationary stations more than 50 of the stations showed positive changes in annual and seasonal precipitation extremes except in autumn implying more intense 50 year precipitation for nonsationary fa the median values of absolute differences in 50 year precipitation estimated by stationary and nonstationary fa were calculated at rural urbanizing and urbanized stations separately results showed that the magnitudes of absolute differences were higher in urbanizing stations than those at rural and urbanized stations in annual spring summer and autumn the return periods under stationary and nonstationary conditions at 15 exemplary stations at different locations belong to rural urbanizing and urbanized areas fig s3 also showed more noticeable differences fig s4 the percentages of differences between stationary and nonstationary frequency analyses for the 50 year return period were 25 23 5 22 9 19 9 and 12 higher than or closet to those at rural and urbanizing stations fig s4 the performances of these 15 exemplary stations were validated by worm plot fig s5 fig s5 shows no significant deviations from normality in the residuals for all 15 exemplary stations indicating the model fitted satisfactorily furthermore because urban signatures of extremes were more pronounced at the regional scale than at the national scale return periods estimated by stationary and nonstationary fa in spatial zonally averaged precipitation extremes classified as rural urbanizing and urbanized classes at the regional scale were analyzed fig 9 region vi north china fig s2 was selected as a typical region that urbanization had a strong effect on nonstationarity in precipitation extremes fig 6 because most of nonstationary stations coincided with urbanizing and urbanized areas in region vi fig s6 significant changes in return periods were found for the zonally averaged precipitation extremes at urbanizing stations which were larger than those at rural and urbanized stations this characteristic was the most obvious in annual precipitation extremes fig 9a c these results indicate that the urbanizing process i e from rural to urban transition can lead to nonstationarity in precipitation extremes 4 3 identification of the effects of urbanization on changes in precipitation extremes although nonstationarity in precipitation extremes was detected in urban areas it was not certain whether the nonstationarity was primarily caused by local lulc changes or changes in large scale circulation patterns to examine this the k mean method was used to cluster daily precipitation into different classes in each meteorologically homogenous region based on era interim reanalysis data and dunn s index was used to select the optimum number of classes table s2 which were 5 4 4 2 5 3 2 and 2 for region i to region viii respectively table s2 therefore the centroids of clusters 1 and 2 for large scale climate variables namely air temperature pressure relative humidity u wind v wind and vertical wind velocity are shown in fig 10 differences between the cluster centroids for all variables were observed which shows the importance of classification to understand the existence of different circulation patterns to understand the influence of urbanization on precipitation extremes the spatial zonally averaged daily precipitation datasets in each region were divided into two equal halves 1979 1997 and 1998 2014 considering the period of era interim reanalysis data the distribution of circulation classes in both periods had little change in each region fig s7 then the quantile values from 75 to 99 were calculated in each period for cluster 1 and cluster 2 figs 11 and 12 the differences in quantiles between the two periods were probably caused by local urbanization because the large scale circulation patterns were controlled shastri et al 2015 in cluster 1 changes in the high quantile values i e the values corresponding to more than 90th of daily precipitation for urbanized and urbanizing stations were only found in regions i iii iv and vii while changes in the high quantile values were not prominent at rural stations in these regions fig 11 we also employed ncep reanalysis data to determine the classes for these climate variables table s3 and compared the high quantile values during the two periods of 1961 1987 and 1988 2014 for each region in cluster1 fig s8 the two equal periods are corresponding to the above partitions on the periods of impacts of urbanization on precipitation changes in the high quantile values for urbanized and urbanizing stations were only found in regions i ii and vii and can be observed in fig s8 which is similar with that obtained from era interim fig 11 among the three regions regions iv and vii are two of the most highly urbanized areas including the richest provinces such as beijing the capital of china jiangsu zhejiang and shanghai the lower mean vertical wind velocity in cluster 1 over region vii was indicative of favorable weather conditions for the development of uhi szegedi and kircsi 2003 blazejczyk et al 2006 at the same time high pressure in cluster 1 in region vii suggested a favorable condition for the uhi impacts morris and simmonds 2000 in cluster 2 region i was the only area with obvious differences in high quantile values between the two periods not for rural classes but for urbanizing classes fig 12 most regions showed little changes in high quantile values for all of rural urbanizing and urbanized classes between the two periods similar results can also be found in fig s9 obtained from ncep reanalysis data in cluster 2 in which region vi was the only area with obvious differences in high quantile values between the two periods not for rural class but for urbanizing and urbanized classes it was evident that when the large scale circulation pattern was controlled changes in precipitation quantiles in urban stations were associated primarily with the influence of local changes such as urbanization it should be noted that most regions showed little changes in high quantile values for all of rural urbanizing and urbanized classes between the two periods overall the results obtained from both era interim and ncep reanalysis data show that urban signatures on precipitation extremes are not prominent at the national scale but are at the regional scale 5 discussion results indicated that it was difficult to illustrate the presence of a possible climate change signal and urban signature in long term changes in annual and seasonal precipitation extremes because most of the stations did not have significant trends or change points in precipitation extremes in all three periods 1961 1985 1986 2014 and 1961 2014 fig 3 fig s1 this feature was in good agreement with previous studies e g yang et al 2013a b gu et al 2017b the spatial distributions of changes in the 50 year return period of annual and seasonal precipitation extremes showed noticeable regional patterns figs 4 5 which were also in line with previous studies e g chen et al 2014 wang et al 2015a guan et al 2017 yang et al 2017a c for example increases in annual precipitation extremes after 1987 in northeast china south china and northwest china were also observed by yang et al 2017a c and guan et al 2017 respectively there are different meteorological and climatological mechanisms that transport moisture that can produce extreme precipitation to china i e tropical cyclones convection thunderstorms frontal passages and sea surface temperature sst anomalies hirschboeck 1988 most of these studies attributed the changes in precipitation extremes to global changes such as changes in sea surface temperature sst anomalies and global warming e g chen et al 2014 chen and sun 2017 gu et al 2017c gao et al 2017 recently chen and sun 2017 pointed out that human induced warming has increased daily precipitation extremes by approximately 13 based on previous studies and the fact that urban areas count for only 0 7 of the chinese territory wang et al 2015b large scale circulation patterns may be a more important dominant factor for the long term changes in precipitation extremes at the national scale yang et al 2016 also validated that climate warming contributes to more than 80 of total thermal loading over beijing city with the rest effect from urbanization however many studies have pointed out that the local climates e g temperature precipitation of urban areas are significantly different from nearby suburbs sun and shu 2007 miao et al 2011 liang et al 2013 chen et al 2015 urbanization may affect the patterns and extremes of local precipitation through urban roughness uhi modified winds and aerosols niyogi et al 2007 our results also indicate that urbanization causes nonstationarity in precipitation extremes in some regions such as north china fig 6 furthermore obvious differences in high quantile values not for rural classes but for urbanizing and urbanized classes are detected over north china and central china region vi and vii when large scale circulation patterns are controlled figs 11 and 12 both areas have the highest level of urbanization in china in which strong influences of urbanization on local precipitation i e beijiang and shanghai have been identified in previous studies e g liang et al 2013 yang et al 2017a c the findings of this study are consistent with those in previous studies but also highlight that changes in return periods estimated by stationary and nonstationary models are more noticeable at urbanizing stations that at rural and urbanized stations figs 8 and 9 wang et al 2015a also found that high level urban development caused no significant changes in precipitation the possible reason is that the lulc will not change substantially and the feedbacks of changes in lulc on local circulation patterns will remain unchanged after urbanization slows down and stabilizes which will lead to precipitation extremes becoming stationary again however in urbanizing areas rapid urban expansion is undergoing and the rapid transition in lulc may cause local circulation changes considerably the physical processes of urbanization affecting local precipitation are complex and still a huge challenge to face urban atmospheric circulation associated with precipitation is modified and affected mainly by land cover and urban aerosols however the impacts of land cover and urban aerosols on urban modification of precipitation may vary and be sensitive with the different degrees of urbanization wang et al 2015a c taking the greater beijing metropolitan area gbma as an example intensive precipitation has been verified by observations and can be confirmed as a result of urbanization yang et al 2017a c urbanization affecting surface air temperature surface air pressure relative humidity and near surface wind directions for example modifying diurnal temperature and air pressure cycles adjusts local water cycle and regulates precipitation process over gbma yang et al 2017a c specifically urban surface roughness enhances convergence and thus increases atmospheric vertical motions and even precipitation lin et al 2011 and urban emissions produce aerosols increasing the cloud condensation nuclei han et al 2012 as gbma expanded during the past several decades the sub urban areas are translated to urban areas continually with skyscrapers larger population and more factory activities which lead to increasing surface roughness and urban aerosols and thus altering precipitation characters unremittingly however after gbma expand to a certain extent no more increases of surface roughness and urban aerosols may make the atmospheric stabilized and precipitation characters stationary again wang et al 2015a c singh et al 2016 wang et al 2015b pointed out that the contributions of urban heat island to climate of the whole of china can be negligible less than 1 by considering the spatial scale of urbanization effects yang et al 2017a c used hourly surface air and precipitation data from high network stations to explore the association of short duration intense precipitation with urbanization in the beijing urban area indicating that the strongest association is found in or near the central urban area paul et al 2018 further pointed out that the impacts of urbanization on precipitation extremes can be detected only in stations located inside the urban pockets with intensified precipitation even in urban areas the signature of urbanization in precipitation extremes is not uniform but more prominent at few pockets where intensification in precipitation can be observed and simulated with increasing spatial variability on the one hand precipitation is strengthened by the unstable conditions prevailing in the boundary layer while the increased instability is not apparent everywhere in the city numerical simulations showed that several urban pockets of updrafts and downdrafts trigger the precipitation instability significantly paul et al 2018 on the other hand aerosol is another important factor influencing precipitation extremes in urban areas the contrasting impacts of increased aerosols on precipitation processes between upstream and downstream areas can also contribute to increasing spatial variability of precipitation extremes taking the greater beijing metropolitan area gbma as an example increasing aerosols can suppress enhance convection and precipitation over upstream downstream areas of the gbma zhong et al 2015 the spatial variability of urban signature in precipitation extremes prompts us to conduct more work of the impacts of urban pockets on the stationarity of precipitation extremes 6 summary and conclusions based on lulc data the stations are classified in three categories rural urbanizing and urbanized stations trend change point and gev distribution are used to analyze nonstationarity in annual and seasonal precipitation extremes in the three categories the 54 year period 1961 2014 is divided into two periods 1961 1987 with low level of urbanization and 1988 2014 with a rapidly urbanizing process changes in long term trends and 50 year return period between the two periods were applied to demonstrate the influences of urbanization on precipitation extremes in our results limited evidence supports that urban signatures on extremes are prominent at the national scale 1 no obvious differences can be observed in nationally averaged annual and seasonal precipitation extremes among rural urbanizing and urbanized classes 2 the spatial patterns of station based trends in annual and seasonal precipitation extremes in rural urbanizing and urbanized stations are similar 3 the stations with significant trends are clustered in several parts of china such as the northern part of china in autumn and the southwestern central part of china in winter which are considered as regional trends governed by synoptic large scale circulation rather than local urbanization 4 few shifts i e significant changes in trend directions can be detected in urbanizing and urbanized stations by using change point analysis and 5 the spatial distributions of changes in 50 year return period are similar among rural urbanizing and urbanized stations we also examined the influences of urbanization on nonstationary fa in annual and seasonal precipitation extremes using a cluster of 66 gamlss models proposed in this study this framework is capable of capturing both the linear and nonlinear characteristics of precipitation extremes only about 10 of the stations show significant nonstationarities in annual and seasonal precipitation extremes and this number reaches 18 in winter among these nonstationary stations about 20 of stations are chosen for second order nonstationary models highlighting the importance of conjugal application of both first and second order nonstationary models with consideration of an adequate number of models that can relax a wide range of assumptions results of nonstationary models show that the signature of nonstationarity is more significant at the regional scale than that at the national scale although the percentages of nonstationary stations in rural urbanizing and urbanized classes are almost in line with the percentages of rural urbanizing and urbanized stations to total stations nonstationarity tends to occur in urbanizing and urbanized stations over a particular region such as north china and eastern china the two areas with high level of urbanization especially for annual spring summer precipitation extremes additionally our results also reveal that the signature of nonstationarity in precipitation extremes tends to be greater in urbanizing stations where lulc transition is still underway and local changes may be more drastic compared with rural and urbanized stations to further examine the changes in precipitation extremes due to large scale circulation or local changes k mean cluster analysis is applied to classify the zonally averaged daily precipitation into several groups in the same group large scale circulation pattern is controlled most of the meteorologically homogenous regions do not display any differences in quantile values between the periods of 1961 1987 and 1988 2014 stressing that urban signature is not prominent at the national scale however we indeed observe that regions vi and vii which have the highest level of urbanization in china display obvious differences in high quantile values between the two periods for urbanizing and urbanized classes overall this study attempts to examine the influence of urbanization on annual and seasonal extremes in terms of long term change and nonstationarity at the national scale results highlight that large scale circulations may be the dominating factor in long term changes in annual and seasonal precipitation extremes at the national scale while urbanization affects the relationship between large scale circulation and precipitation extremes at the regional scale this study has relevance in the context of adaptation and policy formulation especially under the impact of urbanization and climate change in rural urbanizing and urbanized areas it should be noted that there are large uncertainties on our results due to the limitation of record length we also highlight the importance of future model based studies such as dynamic experiment with regional climate models to understand the physical processes of impacts of local changes in precipitation extremes at different geographical locations in china declaration of competing interest here we declare no conflicts of interests acknowledgments this work is financially supported by the national science foundation for distinguished young scholars of china grant no 51425903 the national key r d program of china grant no 2018yfa0605603 the strategic priority research program grant of the chinese academy of sciences grant no xda19070402 the fund for creative research groups of national natural science foundation of china grant no 41621061 and the fundamental research funds for the central universities china university of geosciences wuhan grant no cugcj1702 and cug180614 our cordial gratitude should be extended to the editor prof dr emmanouil anagnostou and anonymous reviewers for their professional and pertinent comments which are greatly helpful for further quality improvement of this manuscript appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 05 070 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
6372,the lack of stream gauging data worldwide has inspired an abundance of methods attempting to predict the complex natural process of streamflow a set of traditional regression equations have been developed by the u s geological survey for the state of iowa however several inconsistencies were noted including irregular region definition and varying input parameters between regions to overcome the common problems faced in modelling and to combat the irregularities in the regression equations a new group method of data handling gmdh algorithm has been proposed using a combination of the classical combinatorial gmdh and multilayer gmdh to predict the 2 year peak flow data from 365 stream gauges located in the state of iowa were used in the model development the new algorithm was compared to the two classical algorithms and the traditional linear regression equations developed by the u s geological survey the new algorithm which requires fewer input parameters without relying on regionalization was found to be the best method the developed algorithm is based on a more robust hydrologic theory and therefore is a reliable method for predicting the 2 year peak flow for ungauged basins the two main hypotheses inspired by the past regression equations and suggested in this study were that regionalization is not necessary and that using fewer input parameters to avoid redundancy still produces a robust prediction method this study has developed a novel and reliable prediction method for peak flow prediction at ungauged basins while advancing insight into the most influential variables governing the magnitude of the flow keywords group method of data handling gmdh floods rivers ungauged basins streamflow 1 introduction the hydrologic cycle is a complex natural system which consists of many equally complex sub systems streamflow is one sub system and knowledge of streamflow is necessary for watershed planning and design it can be measured in the field however long term data are required to make appropriate decisions and assess risks associated with certain magnitudes of flows long term consistent stream gauging data is sparse across the world decades of modelling efforts have been put forth attempting to quantify the principal factors governing streamflow to develop an accurate prediction method hrachowitz et al 2013 streamflow can be reported in several ways one common method is the return period for example the 2 year return period flow q2 the return period categorizes the probability associated with a certain magnitude of flow being equalled or exceeded in any given year usgs 2016 to statistically determine the return period flows for a basin either long term data or an accurate model for estimation are needed many modelling techniques have been used for evaluating return period peak flows with some success such as linear regression spatial proximity and region of influence ahn and palmer 2016 haddad and rahman 2012 merz and blöschl 2005 razavi and coulibaly 2013 when a linear regression is used for peak flow prediction purposes basin characteristics are related to the desired peak flow quantile by statistically determining the optimal variable weighting this can be carried out using a variety of linear regression procedures regardless of the procedure the general assumptions made are that the model is linear and each input is independent has equal variance and is normally distributed su et al 2012 violations to these assumptions may introduce some error into the linear regression model however the extent of the error is unknown su et al 2012 considering the complexity of the inherent non linearity present in natural systems many complications occur when modelling attempts being made soft computation methods have been frequently used throughout recent decade that can produce efficient and more accurate method for solving complex problems in the water resources field tayfur 2012 ebtehaj et al 2019 one concern regarding the application some of the artificial approaches is that they are not able to produce an explicit expression between input and output variables in water resources engineering an expression can help acquire better insight into a problem for practical application the group method of data handling gmdh method is a powerful subset of artificial intelligence ai methods for modeling complex water resources multi parameter problems gmdh is utilized in diverse problems such as trap efficiency of detention dams parsaie et al 2017 soil cumulative infiltration rahmati 2017 rainfall runoff modeling zhang et al 2013 lake level variation zaji et al 2018 and simulating river characteristics najafzadeh and tafarojnoruz 2016 shaghaghi et al 2018 the main goal of this study is to evaluate the three different gmdh based methods on the stream gauging data from iowa and determine if these methods can overcome the limitations of the original regression equations developed for predicting the 2 year peak flow sensitivity analysis results of gmdh based equation for each input variable were carried out to investigate the effect of hydrological parameters of the basin on 2 year return flow prediction 2 materials and methods 2 1 group method of data handling ivakhnenko 1968 presented a technique for constructing a higher order polynomial known as group method of data handling to overcome the dead end problem of equation complexity and linear dependency present in standard regression equations two examples of algorithms used in nonlinear modeling problems are combinatorial and multilayer gmdh algorithms 2 1 1 combinatorial gmdh algorithm the combinatorial gmdh algorithm cga is the main single layer algorithm for gmdh the flowchart of the cga is presented in fig 1 the matrix of input dataset comprises of n points of observed samples related to a set of m parameters these samples are categorized into two groups training subsamples na and testing subsamples nb the training sub samples are employed to generate the optimal model structure by minimizing the following fitness function 1 ar s 1 n b i 1 n b y i y i b 2 min the k fold cross validation criteria which considers all information in data samples by a random selection of training and testing sub samples for instance k 5 is used as the fitness function a comprehensive inquiry is performed on models classed into gatherings of equivalent complexity allowing one to plan the comprehensive search termination rule for instance the primary layer could use the data held on each section of the sample and a full inquiry is connected to every conceivable model of the form 2 y a 0 a 1 x i i 1 2 m non linear individuals are taken as novel input parameters in the training data sub sample the progress of the yield variable is indicated by the user all models in the next layer are arranged in the following form 3 y a 0 a 1 x i a 2 x j j 1 2 m the models are assessed for consistency with the measured samples continuing until the criterion is satisfied due to the constraint inflicted by the time of computation period it is recommended to extend parameters due to a criterion value after some iterations layer and calculation time while arranging the models at that point full arranging techniques proceed for the chosen set of best variables until progress is negligible this offers the probability to set considerably more information factors at the input and to save successful factors between layers to discover the ideal model generally modeling a nonlinear problem with combinational gmdh algorithm consists of five steps as shown in fig 1 the data sample for training and testing are defined in the first step in the second step different layers are presented to describe the complexity of models the optimal models are formed in the third step and the optimal model is selected in the fourth step finally the additional model definition is done by discriminating criteria during the fifth step 2 1 2 multilayer gmdh algorithm mga the classical structure of the gmdh method ivakhnenko 1971 1995 is a self organized and unidirectional network for solving complex nonlinear problems the gmdh consists of several layers and each layer consists of several neurons all neurons have the same structure two inputs and one output each neuron consists of five weights and one bias establishes the processing operation between the input and output data according to the following equation 4 y ik n x i α x i β b k w 1 k x i α w 2 k x i β w 3 k x i α 2 w 4 k x i β 2 w 5 k x i α x i β i 1 2 n where n is the number of input variables k 1 2 3 cm 2 α β 1 2 3 m and m is a number of neurons in the previous layer weights are calculated based on the least square error method and then embedded in specified and fixed values within each neuron the obvious feature of this network is that the previous stage or the previous layer s neurons are the factor and generator of the production of new neurons in the number of cm 2 m m 1 2 and among the produced neurons certain deletions to avoid network divergence farlow 1984 neurons that remain for the continuation and expansion of the network may be omitted to form the network convergence form because they are not linked to the last layer s neuron which is referred to as inactive neurons the criterion for the selection and removal of a set of neurons in a layer is the ratio of the sum of squared errors rj 2 between the actual output values yi and the output of the neuron jth yij as follows 5 r j 2 i 1 n y i y ij 2 i 1 n y i 2 j 1 2 3 c m 2 where m is the number of selected neurons in the previous layer the mapping between input and output variables by this type of neural network is represented by the volterra linear function as follows 6 y a 0 i 1 m a i x i i 1 m j 1 m a ij x i x j i 1 m j 1 m k 1 m a ijk x i x j x k the structure for the neurons is given in a summary form of two second order variables as follows 7 y i f x ip x iq a 0 a 1 x ip a 2 x iq a 3 x ip x iq a 4 x ip 2 a 5 x iq 2 the function f has six coefficients that are unknown which for all pairings dependent on system x ip x iq i 1 2 n yields the desired output y i i 1 2 n the following statement is minimized based on the least square error rule 8 e m i n k 1 n f x ki x kj y i 2 accordingly an equation system with six unknown parameters and n equations is solved 9 y 1 a 0 a 1 x 1 p a 2 x 1 q a 3 x 1 p x 1 q a 4 x 1 p 2 a 5 x 1 q 2 y 2 a 0 a 1 x 2 p a 2 x 2 q a 3 x 2 2 p x 2 q a 4 x 2 p 2 a 5 x 2 q 2 y n a 0 a 1 x np a 2 x nq a 3 x np x nq a 4 x np 2 a 5 x nq 2 the above mentioned equation system is presented in the following matrix form 10 aa y where 11 a a 0 a 1 a 2 a 3 a 4 a 5 t 12 y y 1 y 2 y 3 a n 13 a 1 x 1 p x 1 q x 1 p x 1 q x 1 p 2 x 1 q 2 1 x 2 p x 2 q x 2 p x 2 q x 2 p 2 x 2 q 2 1 x np x nq x np x nq x np 2 x nq 2 the least square method from multiple regression analysis produces the normal equations solution as follows 14 a a t a 1 a t y 2 1 3 generalized structure of gmdh algorithm gsga in the previous sub sections two different algorithms were introduced for modeling nonlinear systems using the gmdh method cga and mga both algorithms present certain disadvantages which can be improved upon using new encoding the benefits of single layer self organizing systems are shown in their simplicity and capacity to perform through the arrangement of the model structure however as the quantity of terms expands so does the number of the indispensable observations which limit them from poorly characterized frameworks portrayed by a low quantity of accessible observations and incomplete input vectors the main shortcomings of the cga are related to the computational capability for modeling highly complicated models the calculation time is long because of the total sorting out strategy which constrains the quantity of power and terms in the last model another limitation in modeling nonlinear problems using the mga method is that only two variables are considered as inputs for each neuron in addition the structure of mga is presented as a second order polynomial eq 7 in classical multilayer gmdh techniques the input variables of each neuron are selected from adjacent neurons in this study to overcome the disadvantages while capitalizing on the numerous advantages of both cga and mga strategies a new gmdh based method was encoded in matlab software deemed the generalized structure of gmdh algorithm gsga the proposed method overcomes the limitations present in both classical algorithms in the gsga method both mga and cga are considered and the optimal model is selected based on the akaike information criterion aic ebtehaj et al 2014 as follows 15 aic n log 1 n i 1 n y i y i 2 2 k where n is the number of samples y and y are the observed and predicted samples and k is the number of modifiable variables for example using mga with two inputs and one neuron eq 7 k is equal to 6 the defined structure in gsga is not as constant as in eq 7 it could be a neuron with more than two inputs a higher order polynomial or it could be selected from the inputs of a neuron from other layers the main structure defining the cga algorithm for the gsga method is as follows i in the first structure all possible multiplied pairs are considered as the model structure xi xj ii in addition to the terms considered in the second state xi xj all possible squares will be considered xi xj xj 2 iii the difference of this structure compared to the previous is all possible divided pairs are used instead of all possible squares xi xj xi xj iv the fourth structure is the custom polynomial in this state the optimum polynomial is gained based on the defined values as following maximum power of a variable minimum power of a variable maximum total power in a term and a maximum number of a variable in a term the main defined structure in the mga algorithm is as follows i linear a 0 a 1 x i a 2 x j ii polynomial a 0 a 1 x i a 2 xj a 3 xi xj iii quadratic polynomial a 0 a 1 xi a 2 xj a 3 xi xj a 4 xi 2 a 5 xj 2 and iv custom use of custom polynomial function by defined values as those presented in the fourth structure of the cga the following example defines a different structure the maximum number of power maximum total power and maximum number in a term is equal to 2 where the minimum power is equal to zero this is a special kind of gsga which yields eq 7 by increasing the maximum power and maximum total power to 4 and decreasing the maximum number in a term the following equation is developed 16 y i f x ip x iq a 0 a 1 x ip a 2 x ip 2 a 3 x ip 3 a 4 x ip 4 a 5 x iq a 6 x iq 2 a 7 x iq 3 a 8 x iq 4 the flowchart of the gsga is presented in fig 2 2 2 data collection the data used to develop the original regression equations and descriptions of the methods followed for the data collection in iowa is publicly available in the methods for estimating annual exceedance probability discharges for streams in iowa based on data through water year 2010 report by eash et al 2013 this data set was used in this study to apply the three gmdh methods to compare to the original regression equations 365 stream gauges from iowa and surrounding states with their corresponding basin characteristics and peak flow data were collected the location of each stream gauge is shown in fig 3 the q2 for each stream gauge was determined through statistical analysis by eash et al 2013 through the regression analysis carried out by eash et al 2013 it was determined the best prediction variables were basin drainage area da the maximum 24 hour precipitation that occurs on average once every 10 years i24h10y the constant of channel maintenance ccm the percent of da within the des moines lobe landform region desmoin the measure of basin shape bshape and the average saturated hydraulic conductivity of the soil ksatssur da is the most frequently included parameter in streamflow prediction methods and it has a high correlation with peak flow values ahn and palmer 2016 atieh et al 2015 2017 aziz et al 2014 it is positively correlated with q2 for a larger value of da a higher q2 is expected eash et al 2013 a precipitation variable is typically included in prediction methods however the most common variable is the mean annual precipitation map curran et al 2016 eash et al 2013 olson and veilleux 2014 map is commonly included because it is measured at many locations and easily obtained iowa uses i24h10y instead as a predictor variable which may give a better indication of higher flow events compared to map the variation in i24h10y is shown in fig 4 a the difference in i24h10y across the state is only 32 mm demonstrating a homogenous representation for this variable cmm represents the drainage density of the basin and is calculated by dividing the drainage area by the total length of the streams in the basin eash et al 2013 a basin with fewer streams per da will result in a higher ccm conversely a basin with more streams per da will have a lower ccm ccm was found to be negatively correlated with q2 eash et al 2013 iowa is the only state found to incorporate this variable in their peak flow regression equations and it was only used in the equation for region 1 table 1 desmoin represents the percent of the basin in the des moines lobe during the last glaciation in north america approximately 12 000 years ago a massive ice sheet encroached onto the mid continental usa prior 1991 this developed the des moines landform which still distinctly represents the glacial activity that occurred in iowa prior to agriculture activity it was estimated that 44 of the des moines region was wetlands miller et al 2009 which has created poorly drained soils in the region prior 1991 most of the natural lakes in iowa are in this landform region prior 1991 the distinct landscape represented by the des moines lobe makes it a logical variable to include in the prediction of peak flows in iowa eash et al 2013 found that desmoin was negatively correlated with the peak flow therefore areas with higher desmoin have lower peak flows bshape is the ratio of basin length squared over the drainage area of the basin eash et al 2013 found that bshape was negatively correlated with peak flow this means that basins with a larger length to width ratio typically have lower peak flows the longer flow path will increase the travel time to the outlet increasing opportunities for losses through abstractions and therefore resulting in lower peak flow the larger length to width ratio may also provide more opportunities for runoff to concentrate along the flow path a decreasing volume that reaches the outlet ksatssur represents the soil pores ability to transmit water when saturated eash et al 2013 the lower the value of ksatssur the lower the infiltration ability therefore the higher the runoff ksatssur is negatively correlated with runoff which in theory will contribute to lower peak flow ksattsur ranges from 2 7 μm s to 32 1 μm s which has significant spatial variation across the state shown in fig 4b the northeast corner of iowa has the highest ksattsur which should indicate areas of lower flow south iowa has the lowest ksattsur indicating that this area will generate higher peak flows comparing both maps in fig 4 the areas with the lowest ksattsur in the south receive relatively higher i24h10y if i24h10y is the best precipitation indicator of the 2 year peak flow and ksattsur is an influential predictor of the soil conditions than the south of iowa should be receiving the highest flows in the state both ksattsur and i24h10y exhibit similar spatial trends across iowa the correlation coefficient was calculated to be 0 53 showing that they are negatively correlated both should be considered as variables to predict q2 the range of each variable collected for analysis is reported in table 2 3 development of gmdh based equations in this study four different gmdh based methods were evaluated to determine if a more reliable prediction of q2 could be produced compared to the previously developed regression equations the same independent variables used for the regression equations are used as the model inputs for the first three gmdh based methods cga mga and gsga da desmoin i24h10y ksatssur bshape ccm the following model has been developed based on the independent variables 17 q 2 f da desmoin i 24 h10y ksatssur bshape ccm the fourth model used the gsga method using different input variables da i24h10y and ksatssur the fourth model was applied to determine if a comparable results could be produced using fewer input variables the three input variables were chosen based on the perceived relevance and the high visual variability across the state the first step in gmdh based modeling is to categorize all samples into training sub samples and testing sub samples the user defined parameters are selected next they are the maximum power of a variable minimum power of a variable maximum total power in a term and a maximum number of variables in a term these parameters are changed throughout the modeling process to find the best model three different gmdh algorithms are employed in this study the three algorithms are cga mga and gsga the gsga is a combination of cga and mga modified to overcome the limitations present in both cga and mga therefore the final gsga model is likely to have a similar structure to the cga or mga models the structure of the proposed equation by mga is shown in fig 5 from fig 5 the optimum structure used adjacent and non adjacent layers in the neurons of the second and fourth layers the best explicit equation for q2 prediction derived from cga mga gsga and gsga with only three variables are presented in the following boxes box 1 the optimal equation for q2 cga box 2 the optimal equation for q2 mga box 3 the optimal equation for q2 gsga box 4 the optimal equation for q2 gsga with da i24h10y and ksatssur as input parameters 4 performance evaluation criteria the capability of the proposed gmdh based method for predicting the 2 year peak flow at ungauged basins is evaluated using two absolute indices correlation coefficient r mean absolute error mae and root mean square error rmse and one relative index mean absolute relative error mare as shown in eqs 18 21 18 r i 1 n o i o p i p i 1 n o i o 2 i 1 n p i p 2 2 19 mae 1 n i 1 n o i p i 20 rmse 1 n i 1 n o i p i 2 21 mare 1 n i 1 n o i p i o i where oi and pi are the observed and predicted values respectively o and p are the means of observed and predicted values respectively and n is the number of samples the mae and rmse indicate the goodness of fit due to the sign of the deviations of the observed data from the predicted peak flow values it should be noted that the rmse index is suited for normally distributed predicted errors chai and draxler 2014 and is not appropriate for all prediction models the mae index is employed to assess all differences between predicted and observed values irrespective of the sign yaseen et al 2017 the mare considers the relative error of the predicted values related to the observed values the r value is bound in a range of 11 which designates the covariance in the observed peak flows mae rmse and r are insusceptible to outliers and the proportional and additive difference among the observations and predictions for instance a shift in all predicted values can prompt mistaken conclusions if the model is assessed exclusively based on r the precision of proposed gmdh based equations is determined using the nash sutcliffe coefficient ens nash and sutcliffe 1970 22 e ns 1 i 1 n q o i q f i 2 i 1 n q o i q o i 2 e ns 1 where qo i and qf i are observed and predicted discharge values and is the mean of the observed discharge value 5 results and discussion 5 1 usgs regression equations for the state of iowa the u s geological survey usgs has developed an extensive set of regression equations for predicting return period peak flows for most of the states in the usa including the state of iowa to develop the regression equations for iowa a set of 394 stream gauges were used with the gauges being divided into three homogenous regions eash et al 2013 both ordinary least squares ols and general least squares regression gls analysis were employed as regression techniques for equation development ols was used to develop the preliminary set of equations by determining the best set of variable combinations gls was used to refine and develop the final set of equations because this method takes into consideration the length and variance in streamflow records therefore gauges with varying record length can be used with confidence in the same analysis eash et al 2013 the 2 year peak flow regression equations developed for the three defined regions in iowa are in table 1 each equation performs very well for the data it was developed upon however the equations are non transferable to other regions or states the three equations have several similarities which have inspired the goal of the present study to develop one model to predict peak flows for iowa without using regionalization while maintaining similar accuracy fig 3 shows the relative locations of the region boundaries as determined by eash et al 2013 in certain locations the three regions are very close together with an approximate separation difference of only 50 km however the average difference in calculated flow rates using the three different equations is significant each equation was applied to the entire data set which revealed an average difference between regions 1 and 2 of 32 7 m3 s regions 2 and 3 of 25 8 m3 s and regions 1 and 3 of 45 9 m3 s many stream gauges are located very close to the regions boarder which emphasizes the error that will occur if the wrong equation is applied each equation uses a different combination of input variables the only constant variable between the equations is da da is incorporated in regions 1 and 3 in a similar fashion however in region 2 it is part of the equation in a more convoluted manner since da is independent of location the form of da in region 2 is unexpected according to the regression equations ccm desmoin and bshape are unique properties of regions 1 2 and 3 respectively both ccm and bshape are functions of da ccm is also a function of the total length of streams in the basin ccm has a small variation of 3 35 km2 km throughout the entire state region 1 is the only region that incorporates this variable where the variation between minimum and maximum values is only 3 km2 km regions 2 and 3 still exhibit variation in ccm of 1 04 km2 km and 0 66 km2 km respectively however it is not included in the equation bshape ranges from 0 55 km to 22 4 km exhibiting more variation than ccm but no logical conclusion can be drawn to explain why such a basin specific variable is only significant in region 3 desmoin is a variable that is specific to iowa the majority of region 1 is within the desmoin landform region eash et al 2013 however this variable is only incorporated in region 2 region 2 has a few stream gauges that border region 1 therefore some basins in region 2 cover a portion of the desmoin landform it is interesting that desmoin is not included in region 1 eash et al 2013 explain that ccm is used to represent the effects of glacial activity in region 1 therefore it is interesting that ccm is not used in region 2 as well the decision to include ccm desmoin and bshape in only one region each pose the hypothesis that they may not be necessary to include in prediction at all i24h10y is the precipitation variable incorporated in the regression equation but it is only applied to the equation for region 1 precipitation is the driving force of any flooding event and therefore some representation of the precipitation should be used in a prediction equation fig 4a displays the spatial variation in i24h10y across iowa although i24h10y only varies from 95 mm to 127 mm that still represents a 29 difference across the state the highest value of i24h10y is in the southeast corner of the state conversely the lowest i24h10y is in the northwest corner of the state disregarding i24h10y in regions 2 and 3 would be more logical if the regional delineation followed the spatial variation in i24h10y region 3 covers portions of both the highest and lowest i24h10y region 1 has the smallest variation in i24h10y and is the only region to incorporate the variable ksatssur is only incorporated in the equation for region 3 region 3 exhibits the most spatial variability in ksatssur as it covers some of the highest values in the northeast corner and the lowest values in the southern region of the state region 2 does exhibit spatial variation in ksatssur however it is not included in the equation ksatssur is a property of the soil and it has been found that the conditions of the soil affect the magnitude of the peak flow experienced in a basin grillakis et al 2016 the significant spatial variation and the impact that soil properties can have on the magnitude of the peak flow confirm that ksatssur is an important variable to include the regional delineation does not align with the spatial variation in the chosen input variables which strengthens the hypothesis that regionalization is not necessary for prediction 5 2 performance evaluation of gmdh based equation fig 6 shows the performance of the fourth gmdh based model in predicting q2 following the input combination in eq 17 the mga and gsga models perform well in predicting the maximum value of the q2 while the cga model has weaker prediction capabilities the mga model has weaker performance with very low values of q2 resulting in high errors therefore caution should be taken using mga models if it is known that q2 is low in the different samples all proposed models both under and over predict q2 values fig 6 also displays the error distribution of each of the models the cga model exhibits a right skew distribution where the mga exhibits an extreme left skew distribution of absolute error the gsga model s error is closest to a normal distribution in comparison to the other models the quantitative comparison between the various six inputs gmdh methods presented in table 3 shows that the lowest and highest relative error values are related to gsga mare 0 85 and mga mare 2 14 respectively gsga also has the best overall rmse while mga has the worst rmse in addition the absolute error index of the gsga method rmse 1501 13 is significantly better than the two classic methods cga rmse 1546 78 and mga rmse 1623 92 the smallest aic index which simultaneously considers the accuracy and complexity of the model also proves superior to the cga method aic 1191 33 it should be noted that the low level of accuracy related to cga model in all relative and absolute errors results in lower confidence when using this model it is concluded that the proposed method in this study gsga has been able to increase the accuracy of q2 prediction by solving the weaknesses associated with cga and mga such as the lack of use of neurons of non adjacent layers the limited number of parameters per layer and the limitation of maximum power associated with different terms recognizing that the gsga method outperformed the classical gmdh based equations this method was further refined to include only three relevant input variables da i24h10y and ksatssur the three parameter gsga model has a relative error mare 1 35 that is higher than the original gsga using six inputs mare 0 85 the absolute indices r 0 95 rmse 1567 9 are comparable to the original three gmdh based methods but are better than the usgs regression equation results r 0 87 rmse 1682 the ens of all four models are very similar cga 0 88 mga 0 88 gsga six parameters 0 89 usgs 0 88 gsga three parameters 0 95 this shows that using more input variables does not increase the predictive power of the model using da i24h10y and ksatssur as inputs maintain prediction accuracy in addition aic results show that gsga 3 input model with aic 1168 3 has greater accuracy compared to what usgs 6 input has with aic 1282 57 from a logistical standpoint this model is easier to apply as it requires only three inputs and regionalization was eliminated this model is more coherent compared to the regression equations it is imperative in model development to have a strong understanding of the incorporation and structure of each input from a hydrological perspective to ensure that the trends will remain true for ungauged basins the main advantage to the three parameter gsga method is that it does not require regionalization to apply the equation regardless of geographical location with iowa the method can be applied however to apply the usgs regression equations first the region must be determined boxplots relating the absolute error were developed to 1 further investigate the q2 prediction performance of the proposed models and 2 to evaluate the error distribution as shown in fig 7 the highest relative error occurred using the mga method the distribution of the error presented in the boxplots represents the performance of the proposed method in this study at maximum q2 rates the maximum value associated with gsga is lower than both of cga and mga and is approximately half that of the mga method in addition the lowest average absolute error is related to the gsga method the boxplots provide additional strength to the conclusion that the gsga method which simultaneously uses the two structures presented in classical methods and modifies these structures to overcome the constraints of these methods has improved the accuracy of the peak flow prediction 5 3 uncertainty analysis a quantitative evaluation of the uncertainties associated with the estimation of q2 is provided using developed gsga versus the classical cga and mga to calculate the uncertainty of the developed models the individual prediction error ipe mean of ipe mipe and standard deviation of ipe sdipe should be computed the ipe mipe and sdipe are defined as 23 ipe p j o j 24 mipe 1 n j 1 n ip e j 25 sdipe j 1 n ip e j m i p e 2 n 1 where p and o are the predicted and the observed values respectively and n is the number of samples a negative or positive value of mipe demonstrates the forecasting model underestimating or overestimating the observed samples respectively the confidence band is defined around the estimated values of an error using the wilson score method without continuity correction ebtehaj et al 2017 considering 1 96 sdipe produced a roughly 95 confidence bound the results of the uncertainty analysis which shows the 95 prediction interval error pei the width of uncertainty band wub sdipe and ipe are presented in table 4 the mipe value for cga mga and the three input gsga are positive while the gsga mipe is negative in fact predicting q2 using gsga provides an overall underestimation while the other two methods provide an overestimation of q2 the mipe for the three parameters gsga is low demonstrating less uncertainty with the overestimations the wub for gsga wub 154 73 is the lowest value among cga wub 159 43 three input gsga wub 161 61 and mga wub 167 37 the lowest 95 pei is related to gsga method 5 4 partial derivative sensitivity analysis pdsa to investigate the variation in trends of q2 prediction inflicted by each input variable a partial derivative sensitivity analysis pdsa was applied shaghaghi et al 2017 ebtehaj et al 2018 in this approach the sensitivity of the target variable to each input variable is studied using the partial derivative of the proposed equation related to each input variables t xi i 1 2 n where n is the number of input variables the lower or higher value of the pdsa implies a lower or higher sensitivity of the proposed model to the target variable a positive value of pdsa denotes that an increase in the desired variable results in an increase of the target variable conversely a negative pdsa value means that an increase in the variable results in a decrease of the target variable the pdsa results from cga mga gsga and the three input gsga models relative to the input variables are provided in figs 8 11 respectively the variation in trends for the cga mga and gsga are relatively similar so the sensitivity values in a different range as often positive as they are negative it should be noted that the negative values in cga and mga are much higher than the positive values it is shown that an extreme reduction of the dependent variable q2 is caused by an increase of the independent variable bshape comparison of three models indicates that the gsga and mga models have the highest and lowest sensitivity to bshape parameter respectively the sensitivity shown in the gsga model is intuitive from a hydrological perspective as a higher bshape indicates basins with a larger length to width ratio which results in lower q2 values the variation in q2 caused by ccm for cga is constantly positive therefore an increase in ccm results in a slight change in q2 using the cga model the sensitivity of the mga and gsga models in relation to ccm has no clear trend the sensitivity sign for these models is as often positive as they are negative for ccm values less than one an increase in ccm values leads to a greater decrease in the estimation of q2 by mga model it should be noted that the sensitivity value of the gsga model in relation ccm is greater than cga and mga models the sensitivity values when da is changed is positive most of the time for all four models this was expected as da is positively correlated with q2 by increasing the value of da the sensitivity decreases as such the sensitivity is sometimes negative for the mga model and the three input gsga model overall a slight change in da results in an increase in the q2 estimation calculated by all three gmdh based models like the two previous parameters bshape and ccm the highest sensitivity values are related to the gsga model the pdsa results show that the mga and gsga models do not have a definite trend compared to changes in the desmoin parameter the only noteworthy trend is that the sensitivity of the mga and gsga models to desmoin is negative at both minimum and maximum values the difference between the cga model and these two models is that at the maximum values the sensitivity is positive precipitation is the causal force driving any flooding event and it was expected that q2 would be sensitive to changes in i24h10y the sensitivity of the cga to the i24h10y parameter is very high compared to the other parameters and the sensitivity sign is positive for all samples therefore a slight change in the i24h10y results in a significant change in q2 estimated by cga the sensitivity sign for i24h10y is positive most of the time indicating that an increase in the variable leads to an increase in q2 no distinct trend is apparent for gsga therefore it is difficult to draw any conclusions from this model unlike cga and gsga where no clear and permanent change is observed the trend of the mga equation related to i24h10y has a second order variation the three input gsga model exhibits high sensitivity to i24h10y the trend in sensitivity has both an increasing and a decreasing trend as i24h10y increases again making it difficult to draw conclusions about the effect of this parameter on this model the variation of gsga in relation to ksatssur is negative most of the time but does not exhibit a clear trend the negative sensitivity sign is logical as a lower value of ksatssur indicates a lower infiltration capacity which in turn should cause an increase in the peak flow the three input gsga model has a similar trend in sensitivity however it has more positive sensitivity values the variation of cga and mga in relation to ksatssur do not have a clear trend or a consistent sensitivity sign the sensitivity analysis is an important aspect of evaluating model performance the sensitivity analysis provides further evidence of the enhanced prediction performance provided by the gsga method the sensitivity trends can be explained by hydrologic theory even if the model can produce accurate results if the trends exhibited by the model oppose known theories or cannot be explained in a logical manner then it is likely the model will not produce accurate results at ungauged locations 6 conclusions a novel gmdh based algorithm coined gsga for predicting the 2 year peak flow at streams in iowa has been developed the gsga is a combination of two classical gmdh based algorithms cga and mga by developing a new encoding structure to simultaneously evaluate the two methods the disadvantages when they are employed separately are overcome data from 365 stream gauges located in the state of iowa were collected for model development traditional regression equations developed by the usgs for iowa were also tested on the data set to compare to the gmdh based algorithms the state was divided into three separate regions where each region was assigned a unique equation for prediction the different structure and input variables as well as the questionable regions defined insinuates that error may occur at ungauged sites having three different equations creates a lack of cohesion between predictions and errors near the regional boundaries three gmdh based equations and the traditional usgs regression equations rely on six input parameters da i24h10y ksatssur bshape ccm and desmoin the inconsistent inclusion of the six variables and in the traditional usgs regression equations led to a third gsga equation using only three input variables this model achieved an r value of 0 89 and an ens of 0 89 which is very comparable to the original three gmdh based equations using six variables this method shows that using more variables is not necessary and regionalization can be avoided uncertainty analysis and a partial derivative sensitivity analysis were performed for the four gmdh based methods the smallest wub and 95 confidence limits occurred using the gsga method the sensitivity analysis revealed interesting trends between the predicted q2 and the selected input variables for example most of the models were very sensitive to changes in i24h10y the sensitivity was mostly positive which indicates that an increase in i24h10y will increase the magnitude of q2 in the model from the sensitivity analysis some unclear trends were noted using ccm bshape and desmoin providing further evidence to eliminate them as prediction variables using both gsga models the trends in sensitivity were the most logical based on hydrologic theory this study has shown that one reliable prediction method can be employed to predict the 2 year peak flow in iowa to a high degree of accuracy and is supported by the context of hydrologic perspectives declaration of competing interest none acknowledgements the authors would like to acknowledge the financial support of the discovery grant program trust fund 400675 natural sciences and engineering research council of canada nserc for funding this research 
6372,the lack of stream gauging data worldwide has inspired an abundance of methods attempting to predict the complex natural process of streamflow a set of traditional regression equations have been developed by the u s geological survey for the state of iowa however several inconsistencies were noted including irregular region definition and varying input parameters between regions to overcome the common problems faced in modelling and to combat the irregularities in the regression equations a new group method of data handling gmdh algorithm has been proposed using a combination of the classical combinatorial gmdh and multilayer gmdh to predict the 2 year peak flow data from 365 stream gauges located in the state of iowa were used in the model development the new algorithm was compared to the two classical algorithms and the traditional linear regression equations developed by the u s geological survey the new algorithm which requires fewer input parameters without relying on regionalization was found to be the best method the developed algorithm is based on a more robust hydrologic theory and therefore is a reliable method for predicting the 2 year peak flow for ungauged basins the two main hypotheses inspired by the past regression equations and suggested in this study were that regionalization is not necessary and that using fewer input parameters to avoid redundancy still produces a robust prediction method this study has developed a novel and reliable prediction method for peak flow prediction at ungauged basins while advancing insight into the most influential variables governing the magnitude of the flow keywords group method of data handling gmdh floods rivers ungauged basins streamflow 1 introduction the hydrologic cycle is a complex natural system which consists of many equally complex sub systems streamflow is one sub system and knowledge of streamflow is necessary for watershed planning and design it can be measured in the field however long term data are required to make appropriate decisions and assess risks associated with certain magnitudes of flows long term consistent stream gauging data is sparse across the world decades of modelling efforts have been put forth attempting to quantify the principal factors governing streamflow to develop an accurate prediction method hrachowitz et al 2013 streamflow can be reported in several ways one common method is the return period for example the 2 year return period flow q2 the return period categorizes the probability associated with a certain magnitude of flow being equalled or exceeded in any given year usgs 2016 to statistically determine the return period flows for a basin either long term data or an accurate model for estimation are needed many modelling techniques have been used for evaluating return period peak flows with some success such as linear regression spatial proximity and region of influence ahn and palmer 2016 haddad and rahman 2012 merz and blöschl 2005 razavi and coulibaly 2013 when a linear regression is used for peak flow prediction purposes basin characteristics are related to the desired peak flow quantile by statistically determining the optimal variable weighting this can be carried out using a variety of linear regression procedures regardless of the procedure the general assumptions made are that the model is linear and each input is independent has equal variance and is normally distributed su et al 2012 violations to these assumptions may introduce some error into the linear regression model however the extent of the error is unknown su et al 2012 considering the complexity of the inherent non linearity present in natural systems many complications occur when modelling attempts being made soft computation methods have been frequently used throughout recent decade that can produce efficient and more accurate method for solving complex problems in the water resources field tayfur 2012 ebtehaj et al 2019 one concern regarding the application some of the artificial approaches is that they are not able to produce an explicit expression between input and output variables in water resources engineering an expression can help acquire better insight into a problem for practical application the group method of data handling gmdh method is a powerful subset of artificial intelligence ai methods for modeling complex water resources multi parameter problems gmdh is utilized in diverse problems such as trap efficiency of detention dams parsaie et al 2017 soil cumulative infiltration rahmati 2017 rainfall runoff modeling zhang et al 2013 lake level variation zaji et al 2018 and simulating river characteristics najafzadeh and tafarojnoruz 2016 shaghaghi et al 2018 the main goal of this study is to evaluate the three different gmdh based methods on the stream gauging data from iowa and determine if these methods can overcome the limitations of the original regression equations developed for predicting the 2 year peak flow sensitivity analysis results of gmdh based equation for each input variable were carried out to investigate the effect of hydrological parameters of the basin on 2 year return flow prediction 2 materials and methods 2 1 group method of data handling ivakhnenko 1968 presented a technique for constructing a higher order polynomial known as group method of data handling to overcome the dead end problem of equation complexity and linear dependency present in standard regression equations two examples of algorithms used in nonlinear modeling problems are combinatorial and multilayer gmdh algorithms 2 1 1 combinatorial gmdh algorithm the combinatorial gmdh algorithm cga is the main single layer algorithm for gmdh the flowchart of the cga is presented in fig 1 the matrix of input dataset comprises of n points of observed samples related to a set of m parameters these samples are categorized into two groups training subsamples na and testing subsamples nb the training sub samples are employed to generate the optimal model structure by minimizing the following fitness function 1 ar s 1 n b i 1 n b y i y i b 2 min the k fold cross validation criteria which considers all information in data samples by a random selection of training and testing sub samples for instance k 5 is used as the fitness function a comprehensive inquiry is performed on models classed into gatherings of equivalent complexity allowing one to plan the comprehensive search termination rule for instance the primary layer could use the data held on each section of the sample and a full inquiry is connected to every conceivable model of the form 2 y a 0 a 1 x i i 1 2 m non linear individuals are taken as novel input parameters in the training data sub sample the progress of the yield variable is indicated by the user all models in the next layer are arranged in the following form 3 y a 0 a 1 x i a 2 x j j 1 2 m the models are assessed for consistency with the measured samples continuing until the criterion is satisfied due to the constraint inflicted by the time of computation period it is recommended to extend parameters due to a criterion value after some iterations layer and calculation time while arranging the models at that point full arranging techniques proceed for the chosen set of best variables until progress is negligible this offers the probability to set considerably more information factors at the input and to save successful factors between layers to discover the ideal model generally modeling a nonlinear problem with combinational gmdh algorithm consists of five steps as shown in fig 1 the data sample for training and testing are defined in the first step in the second step different layers are presented to describe the complexity of models the optimal models are formed in the third step and the optimal model is selected in the fourth step finally the additional model definition is done by discriminating criteria during the fifth step 2 1 2 multilayer gmdh algorithm mga the classical structure of the gmdh method ivakhnenko 1971 1995 is a self organized and unidirectional network for solving complex nonlinear problems the gmdh consists of several layers and each layer consists of several neurons all neurons have the same structure two inputs and one output each neuron consists of five weights and one bias establishes the processing operation between the input and output data according to the following equation 4 y ik n x i α x i β b k w 1 k x i α w 2 k x i β w 3 k x i α 2 w 4 k x i β 2 w 5 k x i α x i β i 1 2 n where n is the number of input variables k 1 2 3 cm 2 α β 1 2 3 m and m is a number of neurons in the previous layer weights are calculated based on the least square error method and then embedded in specified and fixed values within each neuron the obvious feature of this network is that the previous stage or the previous layer s neurons are the factor and generator of the production of new neurons in the number of cm 2 m m 1 2 and among the produced neurons certain deletions to avoid network divergence farlow 1984 neurons that remain for the continuation and expansion of the network may be omitted to form the network convergence form because they are not linked to the last layer s neuron which is referred to as inactive neurons the criterion for the selection and removal of a set of neurons in a layer is the ratio of the sum of squared errors rj 2 between the actual output values yi and the output of the neuron jth yij as follows 5 r j 2 i 1 n y i y ij 2 i 1 n y i 2 j 1 2 3 c m 2 where m is the number of selected neurons in the previous layer the mapping between input and output variables by this type of neural network is represented by the volterra linear function as follows 6 y a 0 i 1 m a i x i i 1 m j 1 m a ij x i x j i 1 m j 1 m k 1 m a ijk x i x j x k the structure for the neurons is given in a summary form of two second order variables as follows 7 y i f x ip x iq a 0 a 1 x ip a 2 x iq a 3 x ip x iq a 4 x ip 2 a 5 x iq 2 the function f has six coefficients that are unknown which for all pairings dependent on system x ip x iq i 1 2 n yields the desired output y i i 1 2 n the following statement is minimized based on the least square error rule 8 e m i n k 1 n f x ki x kj y i 2 accordingly an equation system with six unknown parameters and n equations is solved 9 y 1 a 0 a 1 x 1 p a 2 x 1 q a 3 x 1 p x 1 q a 4 x 1 p 2 a 5 x 1 q 2 y 2 a 0 a 1 x 2 p a 2 x 2 q a 3 x 2 2 p x 2 q a 4 x 2 p 2 a 5 x 2 q 2 y n a 0 a 1 x np a 2 x nq a 3 x np x nq a 4 x np 2 a 5 x nq 2 the above mentioned equation system is presented in the following matrix form 10 aa y where 11 a a 0 a 1 a 2 a 3 a 4 a 5 t 12 y y 1 y 2 y 3 a n 13 a 1 x 1 p x 1 q x 1 p x 1 q x 1 p 2 x 1 q 2 1 x 2 p x 2 q x 2 p x 2 q x 2 p 2 x 2 q 2 1 x np x nq x np x nq x np 2 x nq 2 the least square method from multiple regression analysis produces the normal equations solution as follows 14 a a t a 1 a t y 2 1 3 generalized structure of gmdh algorithm gsga in the previous sub sections two different algorithms were introduced for modeling nonlinear systems using the gmdh method cga and mga both algorithms present certain disadvantages which can be improved upon using new encoding the benefits of single layer self organizing systems are shown in their simplicity and capacity to perform through the arrangement of the model structure however as the quantity of terms expands so does the number of the indispensable observations which limit them from poorly characterized frameworks portrayed by a low quantity of accessible observations and incomplete input vectors the main shortcomings of the cga are related to the computational capability for modeling highly complicated models the calculation time is long because of the total sorting out strategy which constrains the quantity of power and terms in the last model another limitation in modeling nonlinear problems using the mga method is that only two variables are considered as inputs for each neuron in addition the structure of mga is presented as a second order polynomial eq 7 in classical multilayer gmdh techniques the input variables of each neuron are selected from adjacent neurons in this study to overcome the disadvantages while capitalizing on the numerous advantages of both cga and mga strategies a new gmdh based method was encoded in matlab software deemed the generalized structure of gmdh algorithm gsga the proposed method overcomes the limitations present in both classical algorithms in the gsga method both mga and cga are considered and the optimal model is selected based on the akaike information criterion aic ebtehaj et al 2014 as follows 15 aic n log 1 n i 1 n y i y i 2 2 k where n is the number of samples y and y are the observed and predicted samples and k is the number of modifiable variables for example using mga with two inputs and one neuron eq 7 k is equal to 6 the defined structure in gsga is not as constant as in eq 7 it could be a neuron with more than two inputs a higher order polynomial or it could be selected from the inputs of a neuron from other layers the main structure defining the cga algorithm for the gsga method is as follows i in the first structure all possible multiplied pairs are considered as the model structure xi xj ii in addition to the terms considered in the second state xi xj all possible squares will be considered xi xj xj 2 iii the difference of this structure compared to the previous is all possible divided pairs are used instead of all possible squares xi xj xi xj iv the fourth structure is the custom polynomial in this state the optimum polynomial is gained based on the defined values as following maximum power of a variable minimum power of a variable maximum total power in a term and a maximum number of a variable in a term the main defined structure in the mga algorithm is as follows i linear a 0 a 1 x i a 2 x j ii polynomial a 0 a 1 x i a 2 xj a 3 xi xj iii quadratic polynomial a 0 a 1 xi a 2 xj a 3 xi xj a 4 xi 2 a 5 xj 2 and iv custom use of custom polynomial function by defined values as those presented in the fourth structure of the cga the following example defines a different structure the maximum number of power maximum total power and maximum number in a term is equal to 2 where the minimum power is equal to zero this is a special kind of gsga which yields eq 7 by increasing the maximum power and maximum total power to 4 and decreasing the maximum number in a term the following equation is developed 16 y i f x ip x iq a 0 a 1 x ip a 2 x ip 2 a 3 x ip 3 a 4 x ip 4 a 5 x iq a 6 x iq 2 a 7 x iq 3 a 8 x iq 4 the flowchart of the gsga is presented in fig 2 2 2 data collection the data used to develop the original regression equations and descriptions of the methods followed for the data collection in iowa is publicly available in the methods for estimating annual exceedance probability discharges for streams in iowa based on data through water year 2010 report by eash et al 2013 this data set was used in this study to apply the three gmdh methods to compare to the original regression equations 365 stream gauges from iowa and surrounding states with their corresponding basin characteristics and peak flow data were collected the location of each stream gauge is shown in fig 3 the q2 for each stream gauge was determined through statistical analysis by eash et al 2013 through the regression analysis carried out by eash et al 2013 it was determined the best prediction variables were basin drainage area da the maximum 24 hour precipitation that occurs on average once every 10 years i24h10y the constant of channel maintenance ccm the percent of da within the des moines lobe landform region desmoin the measure of basin shape bshape and the average saturated hydraulic conductivity of the soil ksatssur da is the most frequently included parameter in streamflow prediction methods and it has a high correlation with peak flow values ahn and palmer 2016 atieh et al 2015 2017 aziz et al 2014 it is positively correlated with q2 for a larger value of da a higher q2 is expected eash et al 2013 a precipitation variable is typically included in prediction methods however the most common variable is the mean annual precipitation map curran et al 2016 eash et al 2013 olson and veilleux 2014 map is commonly included because it is measured at many locations and easily obtained iowa uses i24h10y instead as a predictor variable which may give a better indication of higher flow events compared to map the variation in i24h10y is shown in fig 4 a the difference in i24h10y across the state is only 32 mm demonstrating a homogenous representation for this variable cmm represents the drainage density of the basin and is calculated by dividing the drainage area by the total length of the streams in the basin eash et al 2013 a basin with fewer streams per da will result in a higher ccm conversely a basin with more streams per da will have a lower ccm ccm was found to be negatively correlated with q2 eash et al 2013 iowa is the only state found to incorporate this variable in their peak flow regression equations and it was only used in the equation for region 1 table 1 desmoin represents the percent of the basin in the des moines lobe during the last glaciation in north america approximately 12 000 years ago a massive ice sheet encroached onto the mid continental usa prior 1991 this developed the des moines landform which still distinctly represents the glacial activity that occurred in iowa prior to agriculture activity it was estimated that 44 of the des moines region was wetlands miller et al 2009 which has created poorly drained soils in the region prior 1991 most of the natural lakes in iowa are in this landform region prior 1991 the distinct landscape represented by the des moines lobe makes it a logical variable to include in the prediction of peak flows in iowa eash et al 2013 found that desmoin was negatively correlated with the peak flow therefore areas with higher desmoin have lower peak flows bshape is the ratio of basin length squared over the drainage area of the basin eash et al 2013 found that bshape was negatively correlated with peak flow this means that basins with a larger length to width ratio typically have lower peak flows the longer flow path will increase the travel time to the outlet increasing opportunities for losses through abstractions and therefore resulting in lower peak flow the larger length to width ratio may also provide more opportunities for runoff to concentrate along the flow path a decreasing volume that reaches the outlet ksatssur represents the soil pores ability to transmit water when saturated eash et al 2013 the lower the value of ksatssur the lower the infiltration ability therefore the higher the runoff ksatssur is negatively correlated with runoff which in theory will contribute to lower peak flow ksattsur ranges from 2 7 μm s to 32 1 μm s which has significant spatial variation across the state shown in fig 4b the northeast corner of iowa has the highest ksattsur which should indicate areas of lower flow south iowa has the lowest ksattsur indicating that this area will generate higher peak flows comparing both maps in fig 4 the areas with the lowest ksattsur in the south receive relatively higher i24h10y if i24h10y is the best precipitation indicator of the 2 year peak flow and ksattsur is an influential predictor of the soil conditions than the south of iowa should be receiving the highest flows in the state both ksattsur and i24h10y exhibit similar spatial trends across iowa the correlation coefficient was calculated to be 0 53 showing that they are negatively correlated both should be considered as variables to predict q2 the range of each variable collected for analysis is reported in table 2 3 development of gmdh based equations in this study four different gmdh based methods were evaluated to determine if a more reliable prediction of q2 could be produced compared to the previously developed regression equations the same independent variables used for the regression equations are used as the model inputs for the first three gmdh based methods cga mga and gsga da desmoin i24h10y ksatssur bshape ccm the following model has been developed based on the independent variables 17 q 2 f da desmoin i 24 h10y ksatssur bshape ccm the fourth model used the gsga method using different input variables da i24h10y and ksatssur the fourth model was applied to determine if a comparable results could be produced using fewer input variables the three input variables were chosen based on the perceived relevance and the high visual variability across the state the first step in gmdh based modeling is to categorize all samples into training sub samples and testing sub samples the user defined parameters are selected next they are the maximum power of a variable minimum power of a variable maximum total power in a term and a maximum number of variables in a term these parameters are changed throughout the modeling process to find the best model three different gmdh algorithms are employed in this study the three algorithms are cga mga and gsga the gsga is a combination of cga and mga modified to overcome the limitations present in both cga and mga therefore the final gsga model is likely to have a similar structure to the cga or mga models the structure of the proposed equation by mga is shown in fig 5 from fig 5 the optimum structure used adjacent and non adjacent layers in the neurons of the second and fourth layers the best explicit equation for q2 prediction derived from cga mga gsga and gsga with only three variables are presented in the following boxes box 1 the optimal equation for q2 cga box 2 the optimal equation for q2 mga box 3 the optimal equation for q2 gsga box 4 the optimal equation for q2 gsga with da i24h10y and ksatssur as input parameters 4 performance evaluation criteria the capability of the proposed gmdh based method for predicting the 2 year peak flow at ungauged basins is evaluated using two absolute indices correlation coefficient r mean absolute error mae and root mean square error rmse and one relative index mean absolute relative error mare as shown in eqs 18 21 18 r i 1 n o i o p i p i 1 n o i o 2 i 1 n p i p 2 2 19 mae 1 n i 1 n o i p i 20 rmse 1 n i 1 n o i p i 2 21 mare 1 n i 1 n o i p i o i where oi and pi are the observed and predicted values respectively o and p are the means of observed and predicted values respectively and n is the number of samples the mae and rmse indicate the goodness of fit due to the sign of the deviations of the observed data from the predicted peak flow values it should be noted that the rmse index is suited for normally distributed predicted errors chai and draxler 2014 and is not appropriate for all prediction models the mae index is employed to assess all differences between predicted and observed values irrespective of the sign yaseen et al 2017 the mare considers the relative error of the predicted values related to the observed values the r value is bound in a range of 11 which designates the covariance in the observed peak flows mae rmse and r are insusceptible to outliers and the proportional and additive difference among the observations and predictions for instance a shift in all predicted values can prompt mistaken conclusions if the model is assessed exclusively based on r the precision of proposed gmdh based equations is determined using the nash sutcliffe coefficient ens nash and sutcliffe 1970 22 e ns 1 i 1 n q o i q f i 2 i 1 n q o i q o i 2 e ns 1 where qo i and qf i are observed and predicted discharge values and is the mean of the observed discharge value 5 results and discussion 5 1 usgs regression equations for the state of iowa the u s geological survey usgs has developed an extensive set of regression equations for predicting return period peak flows for most of the states in the usa including the state of iowa to develop the regression equations for iowa a set of 394 stream gauges were used with the gauges being divided into three homogenous regions eash et al 2013 both ordinary least squares ols and general least squares regression gls analysis were employed as regression techniques for equation development ols was used to develop the preliminary set of equations by determining the best set of variable combinations gls was used to refine and develop the final set of equations because this method takes into consideration the length and variance in streamflow records therefore gauges with varying record length can be used with confidence in the same analysis eash et al 2013 the 2 year peak flow regression equations developed for the three defined regions in iowa are in table 1 each equation performs very well for the data it was developed upon however the equations are non transferable to other regions or states the three equations have several similarities which have inspired the goal of the present study to develop one model to predict peak flows for iowa without using regionalization while maintaining similar accuracy fig 3 shows the relative locations of the region boundaries as determined by eash et al 2013 in certain locations the three regions are very close together with an approximate separation difference of only 50 km however the average difference in calculated flow rates using the three different equations is significant each equation was applied to the entire data set which revealed an average difference between regions 1 and 2 of 32 7 m3 s regions 2 and 3 of 25 8 m3 s and regions 1 and 3 of 45 9 m3 s many stream gauges are located very close to the regions boarder which emphasizes the error that will occur if the wrong equation is applied each equation uses a different combination of input variables the only constant variable between the equations is da da is incorporated in regions 1 and 3 in a similar fashion however in region 2 it is part of the equation in a more convoluted manner since da is independent of location the form of da in region 2 is unexpected according to the regression equations ccm desmoin and bshape are unique properties of regions 1 2 and 3 respectively both ccm and bshape are functions of da ccm is also a function of the total length of streams in the basin ccm has a small variation of 3 35 km2 km throughout the entire state region 1 is the only region that incorporates this variable where the variation between minimum and maximum values is only 3 km2 km regions 2 and 3 still exhibit variation in ccm of 1 04 km2 km and 0 66 km2 km respectively however it is not included in the equation bshape ranges from 0 55 km to 22 4 km exhibiting more variation than ccm but no logical conclusion can be drawn to explain why such a basin specific variable is only significant in region 3 desmoin is a variable that is specific to iowa the majority of region 1 is within the desmoin landform region eash et al 2013 however this variable is only incorporated in region 2 region 2 has a few stream gauges that border region 1 therefore some basins in region 2 cover a portion of the desmoin landform it is interesting that desmoin is not included in region 1 eash et al 2013 explain that ccm is used to represent the effects of glacial activity in region 1 therefore it is interesting that ccm is not used in region 2 as well the decision to include ccm desmoin and bshape in only one region each pose the hypothesis that they may not be necessary to include in prediction at all i24h10y is the precipitation variable incorporated in the regression equation but it is only applied to the equation for region 1 precipitation is the driving force of any flooding event and therefore some representation of the precipitation should be used in a prediction equation fig 4a displays the spatial variation in i24h10y across iowa although i24h10y only varies from 95 mm to 127 mm that still represents a 29 difference across the state the highest value of i24h10y is in the southeast corner of the state conversely the lowest i24h10y is in the northwest corner of the state disregarding i24h10y in regions 2 and 3 would be more logical if the regional delineation followed the spatial variation in i24h10y region 3 covers portions of both the highest and lowest i24h10y region 1 has the smallest variation in i24h10y and is the only region to incorporate the variable ksatssur is only incorporated in the equation for region 3 region 3 exhibits the most spatial variability in ksatssur as it covers some of the highest values in the northeast corner and the lowest values in the southern region of the state region 2 does exhibit spatial variation in ksatssur however it is not included in the equation ksatssur is a property of the soil and it has been found that the conditions of the soil affect the magnitude of the peak flow experienced in a basin grillakis et al 2016 the significant spatial variation and the impact that soil properties can have on the magnitude of the peak flow confirm that ksatssur is an important variable to include the regional delineation does not align with the spatial variation in the chosen input variables which strengthens the hypothesis that regionalization is not necessary for prediction 5 2 performance evaluation of gmdh based equation fig 6 shows the performance of the fourth gmdh based model in predicting q2 following the input combination in eq 17 the mga and gsga models perform well in predicting the maximum value of the q2 while the cga model has weaker prediction capabilities the mga model has weaker performance with very low values of q2 resulting in high errors therefore caution should be taken using mga models if it is known that q2 is low in the different samples all proposed models both under and over predict q2 values fig 6 also displays the error distribution of each of the models the cga model exhibits a right skew distribution where the mga exhibits an extreme left skew distribution of absolute error the gsga model s error is closest to a normal distribution in comparison to the other models the quantitative comparison between the various six inputs gmdh methods presented in table 3 shows that the lowest and highest relative error values are related to gsga mare 0 85 and mga mare 2 14 respectively gsga also has the best overall rmse while mga has the worst rmse in addition the absolute error index of the gsga method rmse 1501 13 is significantly better than the two classic methods cga rmse 1546 78 and mga rmse 1623 92 the smallest aic index which simultaneously considers the accuracy and complexity of the model also proves superior to the cga method aic 1191 33 it should be noted that the low level of accuracy related to cga model in all relative and absolute errors results in lower confidence when using this model it is concluded that the proposed method in this study gsga has been able to increase the accuracy of q2 prediction by solving the weaknesses associated with cga and mga such as the lack of use of neurons of non adjacent layers the limited number of parameters per layer and the limitation of maximum power associated with different terms recognizing that the gsga method outperformed the classical gmdh based equations this method was further refined to include only three relevant input variables da i24h10y and ksatssur the three parameter gsga model has a relative error mare 1 35 that is higher than the original gsga using six inputs mare 0 85 the absolute indices r 0 95 rmse 1567 9 are comparable to the original three gmdh based methods but are better than the usgs regression equation results r 0 87 rmse 1682 the ens of all four models are very similar cga 0 88 mga 0 88 gsga six parameters 0 89 usgs 0 88 gsga three parameters 0 95 this shows that using more input variables does not increase the predictive power of the model using da i24h10y and ksatssur as inputs maintain prediction accuracy in addition aic results show that gsga 3 input model with aic 1168 3 has greater accuracy compared to what usgs 6 input has with aic 1282 57 from a logistical standpoint this model is easier to apply as it requires only three inputs and regionalization was eliminated this model is more coherent compared to the regression equations it is imperative in model development to have a strong understanding of the incorporation and structure of each input from a hydrological perspective to ensure that the trends will remain true for ungauged basins the main advantage to the three parameter gsga method is that it does not require regionalization to apply the equation regardless of geographical location with iowa the method can be applied however to apply the usgs regression equations first the region must be determined boxplots relating the absolute error were developed to 1 further investigate the q2 prediction performance of the proposed models and 2 to evaluate the error distribution as shown in fig 7 the highest relative error occurred using the mga method the distribution of the error presented in the boxplots represents the performance of the proposed method in this study at maximum q2 rates the maximum value associated with gsga is lower than both of cga and mga and is approximately half that of the mga method in addition the lowest average absolute error is related to the gsga method the boxplots provide additional strength to the conclusion that the gsga method which simultaneously uses the two structures presented in classical methods and modifies these structures to overcome the constraints of these methods has improved the accuracy of the peak flow prediction 5 3 uncertainty analysis a quantitative evaluation of the uncertainties associated with the estimation of q2 is provided using developed gsga versus the classical cga and mga to calculate the uncertainty of the developed models the individual prediction error ipe mean of ipe mipe and standard deviation of ipe sdipe should be computed the ipe mipe and sdipe are defined as 23 ipe p j o j 24 mipe 1 n j 1 n ip e j 25 sdipe j 1 n ip e j m i p e 2 n 1 where p and o are the predicted and the observed values respectively and n is the number of samples a negative or positive value of mipe demonstrates the forecasting model underestimating or overestimating the observed samples respectively the confidence band is defined around the estimated values of an error using the wilson score method without continuity correction ebtehaj et al 2017 considering 1 96 sdipe produced a roughly 95 confidence bound the results of the uncertainty analysis which shows the 95 prediction interval error pei the width of uncertainty band wub sdipe and ipe are presented in table 4 the mipe value for cga mga and the three input gsga are positive while the gsga mipe is negative in fact predicting q2 using gsga provides an overall underestimation while the other two methods provide an overestimation of q2 the mipe for the three parameters gsga is low demonstrating less uncertainty with the overestimations the wub for gsga wub 154 73 is the lowest value among cga wub 159 43 three input gsga wub 161 61 and mga wub 167 37 the lowest 95 pei is related to gsga method 5 4 partial derivative sensitivity analysis pdsa to investigate the variation in trends of q2 prediction inflicted by each input variable a partial derivative sensitivity analysis pdsa was applied shaghaghi et al 2017 ebtehaj et al 2018 in this approach the sensitivity of the target variable to each input variable is studied using the partial derivative of the proposed equation related to each input variables t xi i 1 2 n where n is the number of input variables the lower or higher value of the pdsa implies a lower or higher sensitivity of the proposed model to the target variable a positive value of pdsa denotes that an increase in the desired variable results in an increase of the target variable conversely a negative pdsa value means that an increase in the variable results in a decrease of the target variable the pdsa results from cga mga gsga and the three input gsga models relative to the input variables are provided in figs 8 11 respectively the variation in trends for the cga mga and gsga are relatively similar so the sensitivity values in a different range as often positive as they are negative it should be noted that the negative values in cga and mga are much higher than the positive values it is shown that an extreme reduction of the dependent variable q2 is caused by an increase of the independent variable bshape comparison of three models indicates that the gsga and mga models have the highest and lowest sensitivity to bshape parameter respectively the sensitivity shown in the gsga model is intuitive from a hydrological perspective as a higher bshape indicates basins with a larger length to width ratio which results in lower q2 values the variation in q2 caused by ccm for cga is constantly positive therefore an increase in ccm results in a slight change in q2 using the cga model the sensitivity of the mga and gsga models in relation to ccm has no clear trend the sensitivity sign for these models is as often positive as they are negative for ccm values less than one an increase in ccm values leads to a greater decrease in the estimation of q2 by mga model it should be noted that the sensitivity value of the gsga model in relation ccm is greater than cga and mga models the sensitivity values when da is changed is positive most of the time for all four models this was expected as da is positively correlated with q2 by increasing the value of da the sensitivity decreases as such the sensitivity is sometimes negative for the mga model and the three input gsga model overall a slight change in da results in an increase in the q2 estimation calculated by all three gmdh based models like the two previous parameters bshape and ccm the highest sensitivity values are related to the gsga model the pdsa results show that the mga and gsga models do not have a definite trend compared to changes in the desmoin parameter the only noteworthy trend is that the sensitivity of the mga and gsga models to desmoin is negative at both minimum and maximum values the difference between the cga model and these two models is that at the maximum values the sensitivity is positive precipitation is the causal force driving any flooding event and it was expected that q2 would be sensitive to changes in i24h10y the sensitivity of the cga to the i24h10y parameter is very high compared to the other parameters and the sensitivity sign is positive for all samples therefore a slight change in the i24h10y results in a significant change in q2 estimated by cga the sensitivity sign for i24h10y is positive most of the time indicating that an increase in the variable leads to an increase in q2 no distinct trend is apparent for gsga therefore it is difficult to draw any conclusions from this model unlike cga and gsga where no clear and permanent change is observed the trend of the mga equation related to i24h10y has a second order variation the three input gsga model exhibits high sensitivity to i24h10y the trend in sensitivity has both an increasing and a decreasing trend as i24h10y increases again making it difficult to draw conclusions about the effect of this parameter on this model the variation of gsga in relation to ksatssur is negative most of the time but does not exhibit a clear trend the negative sensitivity sign is logical as a lower value of ksatssur indicates a lower infiltration capacity which in turn should cause an increase in the peak flow the three input gsga model has a similar trend in sensitivity however it has more positive sensitivity values the variation of cga and mga in relation to ksatssur do not have a clear trend or a consistent sensitivity sign the sensitivity analysis is an important aspect of evaluating model performance the sensitivity analysis provides further evidence of the enhanced prediction performance provided by the gsga method the sensitivity trends can be explained by hydrologic theory even if the model can produce accurate results if the trends exhibited by the model oppose known theories or cannot be explained in a logical manner then it is likely the model will not produce accurate results at ungauged locations 6 conclusions a novel gmdh based algorithm coined gsga for predicting the 2 year peak flow at streams in iowa has been developed the gsga is a combination of two classical gmdh based algorithms cga and mga by developing a new encoding structure to simultaneously evaluate the two methods the disadvantages when they are employed separately are overcome data from 365 stream gauges located in the state of iowa were collected for model development traditional regression equations developed by the usgs for iowa were also tested on the data set to compare to the gmdh based algorithms the state was divided into three separate regions where each region was assigned a unique equation for prediction the different structure and input variables as well as the questionable regions defined insinuates that error may occur at ungauged sites having three different equations creates a lack of cohesion between predictions and errors near the regional boundaries three gmdh based equations and the traditional usgs regression equations rely on six input parameters da i24h10y ksatssur bshape ccm and desmoin the inconsistent inclusion of the six variables and in the traditional usgs regression equations led to a third gsga equation using only three input variables this model achieved an r value of 0 89 and an ens of 0 89 which is very comparable to the original three gmdh based equations using six variables this method shows that using more variables is not necessary and regionalization can be avoided uncertainty analysis and a partial derivative sensitivity analysis were performed for the four gmdh based methods the smallest wub and 95 confidence limits occurred using the gsga method the sensitivity analysis revealed interesting trends between the predicted q2 and the selected input variables for example most of the models were very sensitive to changes in i24h10y the sensitivity was mostly positive which indicates that an increase in i24h10y will increase the magnitude of q2 in the model from the sensitivity analysis some unclear trends were noted using ccm bshape and desmoin providing further evidence to eliminate them as prediction variables using both gsga models the trends in sensitivity were the most logical based on hydrologic theory this study has shown that one reliable prediction method can be employed to predict the 2 year peak flow in iowa to a high degree of accuracy and is supported by the context of hydrologic perspectives declaration of competing interest none acknowledgements the authors would like to acknowledge the financial support of the discovery grant program trust fund 400675 natural sciences and engineering research council of canada nserc for funding this research 
6373,dam break flows in both triangular and rectangular channels are investigated experimentally in the present study laboratory measurements are carried out in a prismatic and smooth flume with a horizontal and wet bed for two different reservoir heads and four tailwater levels during the experiments digital image processing is applied as a flow measurement technique both water surface profiles and stage hydrographs are obtained effectively by means of video images with eight adjacent cameras the dam break flows in triangular and rectangular channels show common features jet formation in the downstream of the dam during the initial dam break stage similarity of the water surface profiles behind the dam for different depth ratios at a specific time insignificant effects of the depth ratio on the negative wave front and strong dependence of the shock wave front on the depth ratio in a triangular channel the negative wave front moves slower than that in a rectangular channel and extra negative waves propagating towards upstream direction does not form for all depth ratios considered in this study while they have been observed in a rectangular channel for large values of α representing the ratio of initial tailwater depth and reservoir depth i e α 0 3 and 0 4 meantime these extra negative waves result in an undulation of the water surface profile in the reservoir and an apparent increase of water depth at the dam the water depth at the dam section for different depth ratios is 60 70 of the initial reservoir head and the shock wave front propagates slower as the depth ratio increases for the triangular channel for water depth ratios α 0 1 and 0 2 the shock wave front moves faster than that in a rectangular channel and the contrary is true for α 0 4 for α 0 3 the propagation speed of the shock wave front approximates that in a rectangular channel present study contributes to the understanding of the effect of wet downstream conditions on dam break flows in triangular channels and provides detailed experimental data for validating both the analytical and the numerical solutions keywords dam break negative wave shock wave extra negative wave triangular channel image processing 1 introduction dam break floods may cause major damage to lives and property in the path of the flood wave propagation a dam break flood is strongly influenced by many factors su and barnes 1970 sakkas and strelkoff 1973 1976 katopodes and strelkoff 1978 katopodes and schamber 1983 schamber and katopodes 1984 wu et al 1993 1999 zanuttigh and lamberti 2011 wang et al 2017 among which the cross sectional shape of river is the primary factor according to the cross sectional shape rivers can be divided into two categories wide shallow rivers and narrow deep rivers the former ones appear in plain areas often conceptualized as compound channels or even rectangular channels in studies and the second ones can be found in mountainous regions conceptualized as triangular channels experimental investigation of dam break flows is visual compared with the methods of theoretical analysis and numerical simulation the laboratory data can be also used to validate the theoretical and numerical models the experimental data available in literature mainly refer to the dam break flows in rectangular channels dressler 1954 miller and chaudhry 1989 bellos et al 1992 fraccarollo and toro 1995 lauber and hager 1998a b stansby et al 1998 bukreev and gusev 2005 soares frazao and zech 2007 ozmen cagatay and kocaman 2010 2012 oertel and bung 2012 chen et al 2013 larocque et al 2013 ozmen cagatay et al 2014 and kocaman and ozmen cagatay 2015 liu et al 2018 liu et al 2019a b obviously the propagation of dam break flood waves in different types of rivers is different how does the dam break flood waves propagate in a triangular channel what is the effect of wet conditions on the wave movement in a triangular channel many questions on dam break floods in a triangular channel are not clear and need to be studied urgently however to the best of the authors knowledge there is no detailed experimental study available on the dam break flow in triangular flumes with a wet bed so it is the objective which will be studied in this paper in the present study the wave propagations of dam break flood in rectangular and triangular channels are investigated experimentally on the conditions of two initially reservoir levels and a series of tailwater levels in experiments eight adjacent ccd cameras are adopted for synchronously recording the flow along the upstream and downstream channels digital image processing being of non intrusive has been used widely as a measuring technique in the laboratory tests of dam break flows lauber and hager 1998a b stansby et al 1998 aureli et al 2008 soares frazao and zech 2007 ozmen cagatay and kocaman 2010 kocaman and ozmen cagatay 2012 ozmen cagatay and kocaman 2012 ozmen cagatay et al 2014 kocaman and ozmen cagatay 2015 liu et al 2019b the time evolutions of water depths or water levels are obtained directly from the record video images through the digital image processing the measuring technique adopted in this study can produce complete visualization of the flow behavior along the entire flume without test repetitions based on this technique the dam break flows in both rectangular and triangular channels will be compared in detail 2 facilities and instrumentation the experiments are conducted at the state key laboratory of hydraulics and mountain river engineering sichuan university china the rectangular flume with length of 18 m width of 1 m and height of 1 09 m is made of stalinite supported by a steel frame it is divided by a 15 mm thick fiberglass plate into two reaches the length of the upstream and the downstream ones are 8 37 m and 9 63 m long respectively the geometry and dimensions of the reservoir and downstream channel are shown in fig 1 when the experiments for the rectangular flume are completed the flume cross section is modified to be a triangle the left wall remains vertical for recording the flow with cameras and the slope of the right wall is 45 the instantaneous dam break is simulated by lifting the plate instantly with an electromagnetic brake asynchronous motor according to the recommendation of lauber and hager 1998a the plate removal time should be shorter than 2 h 0 g 1 2 h 0 is the upstream water depth and g is the gravity acceleration 9 8 m s2 for a sudden removal in the present tests h 0 is defined as the average water depth in the upstream of the plate i e h 0 a u b u a u and b u are the initially upstream cross sectional area and the water surface width respectively because the cross sectional shapes considered in this study include both rectangle and triangle the plate removal time is between 0 1667 s and 0 2500 s for the rectangular channel and in the range of 0 1250 0 1875 s for the triangular channel from video records so both of them satisfy the revised transient failure condition the plate removal time is smaller in the triangular channel than that in the rectangular channel due to the reduce of the hydrostatic pressure on the gate the wet bed condition can be guaranteed by adjusting a steel gate located at the downstream end of the flume two groups of experiments are carried out for different initial reservoir levels in the first group initial reservoir depth is taken as 0 6 m and in the second one it is 0 4 m the depth ratios α 0 1 and 0 4 where α h d h u h u and h d are initial reservoir depth and initial tailwater depth respectively are usually used for representing shallow and deep tailwater conditions respectively stansby et al 1998 ozmen cagatay and kocaman 2010 kocaman and ozmen cagatay 2015 in each group four initial tailwater depths are tested corresponding to four depth ratios i e α 0 1 0 2 0 3 and 0 4 to ensure the quality of the video and make it more convenient to use the image processing technology the background is covered with a smooth white car sticker and the reservoir water and tailwater are dyed with methyl violet in experiment to avoid noise from the reflection of the flume glass during image processing a dark colored curtain is arranged on both sides of the flume to eliminate the shadow caused by natural light 3 flow measuring technique during the experiment digital image processing is used to obtain the free surface profiles the digital imaging system contains three parts a computer eight high speed ccd cameras and the matlab software the mathworks inc 2016 in which camera calibration frame grap synchronous images combination and binarization and so on are conducted in the test eight ccd cameras are arranged along the flume and in parallel at the same side of the flume with equal interval of 1 4 m to capture the evolution of the water flow cameras are turned on wirelessly by a remote control in order to make cameras work synchronously as shown in fig 2 the flow measurement contains two parts calibration process and water depth acquisition the usage of wide angle lens causes radial and tangential distortions of the images thus the calibration for images is required to correct the distortions a calibration board containing 11 horizontal and 10 vertical uniform black and white colored square meshes is used in which the mesh size was 100 mm 100 mm in addition a margin of 50 mm is left around the calibration board for the calibration toolbox to recognize the corner points in the calibration process the calibration board is filmed from different orientation and at different distance twenty five video images are selected to obtain the intrinsic and extrinsic parameters of each camera as well as the calibration code from camera calibration app in order to obtain the water depth firstly the flow is synchronously recorded with eight adjacent ccd cameras then the recorded raw images are digitized as 1440 1920 pixels at 48 frames s and imported into the matlab software for calibration by aid of the calibration code eight synchronous and undistorted images are cropped due to the margin overlap between adjacent images and then are combined producing an extensive view through the entire flume as a reference for image combination a red ruler is placed on the upper side of the channel walls afterwards all images are grayed and binarized with threshold values for capturing the air water interface a median filter function is applied for the images to minimize unwanted stain like traces of any ambient object caused by lighting device the edge for representing the free surface profile interface is identified the number of black pixels per column in the binary images is recorded the coordinate transformation scale from image unit pixel to the actual dimension mm is determined according to the red ruler finally the water depth is obtained with the scale in the present study the actual length represented by one pixel is calculated as approximately 1 8 mm unlike the methods used by stansby et al 1998 and soares frazao and zech 2007 the measuring technique adopted in this experimental study does not need test repetitions to acquire the complete visualization of the flow behavior along the entire flume the present measuring method needs no frame grabber card and is different from that used by ozmen cagatay and kocaman 2010 kocaman and ozmen cagatay 2012 ozmen cagatay and kocaman 2012 ozmen cagatay et al 2014 and kocaman and ozmen cagatay 2015 water depth profiles against time can be obtained directly from the recorded video images processed by means of digital image processing technique without the need of any wave probes causing no disturbance to the flow field thus the time evolution of water depth at any desired section can be acquired by a vertical line located at the processed video images representing a virtual wave probe virtual wave probe can be a perfect substitute for the physical instrument in experimental measurements which was used in the study of kocaman and ozmen cagatay 2015 the depth hydrographs acquired by the digital image processing adopted in present study were compared with the measurements by the traditional wave probes and the maximum relative error was about 10 the comparison between these two kinds of acquisition techniques shows very good agreement and more details can be found in the study by liu et al 2019b during the present experiments 480 video images which are equivalent to the duration of ten seconds are analyzed for each test 4 results and discussion in this section experimental results of dam break waves in a triangular channel over initially wet bed with four distinct tailwater levels are presented and they are compared with the measured data in a rectangular channel 4 1 evolution of dam break flow video images of the flow evolution for α 0 1 and 0 4 with initial reservoir depth of 0 4 m are shown in fig 3 in each frame presented in fig 3 upper two images represent results from a triangular channel with α 0 1 and 0 4 respectively and lower two images represent results from a rectangular channel with α 0 1 and 0 4 respectively each image shows the flows in the range from 8 m x 8 m in the upstream to 7 7 m in the downstream reaches x 7 7 m upon removing the dam the tailwater is dragged by the initial reservoir water due to the gravity effect and the tailwater resists to the drag force as a result the dam break wave front is broken and a jet is formed downstream during the initial stage which forced the flow to move upward upper two frames in fig 3 this jet like phenomenon is quite similar with the behavior of the dam break flow at initial stages in a rectangular channel lower two frames in fig 3 and this founding was also observed in the studies by stansby et al 1998 ozmen cagatay and kocaman 2010 and kocaman and ozmen cagatay 2015 it is indicated from fig 3 that the speed of the wave front is higher for α 0 1 than that for α 0 4 both in triangular and rectangular channels thus both of the wave breaking and jet formation for α 0 1 occur earlier than those for α 0 4 fig 3 also shows some differences between the dam break flows in triangular and rectangular channels the wave front in a triangular channel moves faster than that in a rectangular channel for α 0 1 and the contrary is true for α 0 4 the arrival times of wave front at the downstream ends of triangular and rectangular flumes since dam break for α 0 1 are just about 4 60 s and 5 12 s respectively and 6 04 s and 5 19 s for α 0 4 respectively the jet after dam break initiation seems to be weaker in a triangular channel than that in a rectangular channel for example the observations at t 0 25 s for α 0 1 and at t 0 5 s for α 0 4 it drops back down the tailwater and produces air entrainment early in a triangular channel for α 0 1 i e substantial foaming in the free surface of the wave front caused by air entrainment has been formed at t 0 5 s while the jet remains robust in a rectangular channel once the dam is removed the tailwater resists to the drag force caused by the initial reservoir water when the depth ratio is large enough i e the tailwater level is very high the resistance force caused by the tailwater on the reservoir water will produces extra negative waves called extra negative wave train that originate from the dam site propagating toward the upstream end of the channel extra negative waves occurred in the experiments conducted by kocaman and ozmen cagatay 2015 liu et al 2019a experimentally investigated both the speed as well as the crest of the first extra negative wave and concluded that extra negative waves would appear if the depth ratio was not smaller than 0 3 the first and second extra negative waves are formed approximately at t 1 s and 3 5 s for α 0 4 in a rectangular channel respectively in the triangular channel extra negative waves cannot be observed for α 0 4 the time evolutions of dam break flow with h u of 0 6 m are quite similar to those with h u of 0 4 m as shown in fig 4 the wave front moves faster as h u increases because of more potential energy for example at t 0 25 s the jet in the downstream of dam had fallen back the tailwater producing air entrainment in a triangular channel with hu 0 6 m for α 0 1 while it is still observed at that time with hu 0 4 m the arrival of wave front at the downstream ends of triangular and rectangular flumes after dam break for α 0 1 take about 3 62 s and 4 19 s respectively and 4 77 s and 4 25 s for α 0 4 respectively 4 2 water surface profile water surface profiles along the triangular channel at t 0 5 s 1 0 s 1 5 s 2 0 s 2 5 s 3 0 s and 3 5 s for four depth ratios i e α 0 1 0 2 0 3 and 0 4 with hu 0 4 m are shown in fig 5 with sudden removal of the gate both the negative wave propagating to the upstream and the shock wave moving to the downstream of the channel are formed the dimensionless water surface profiles in the upstream of the dam for different depth ratios at a specific time overlap each other and the water depths at the dam section are around 60 70 of hu for the triangular channel the effect of the depth ratio on the propagation of the negative wave front is insignificant the flow movement in the downstream of the dam is related to the depth ratio and four different water surface profiles are observed obviously the main characteristics are that the shock wave front propagates slower with the increase of depth ratio and the lag becomes larger as the time goes on a remarkable rise of water surface profile due to the jet is formed close to the dam for α 0 2 0 3 and 0 4 at t 0 5 s and becomes more obvious the rise of water surface profile occurs earlier for α 0 1 and disappeared before t 0 5 s fig 6 shows the water surface profiles along the rectangular channel at t 0 5 3 5 s 0 5 s 1 0 s 1 5 s 2 0 s 2 5 s 3 0 s and 3 5 s for four depth ratios i e α 0 1 0 2 0 3 and 0 4 with hu 0 4 m the water surface profiles behind the dam for different depth ratios at a specific time show similar shapes in the rectangular channel and this founding is the same as that in the triangular channel the negative wave front moves faster in the rectangular channel than that in the triangular channel for α 0 1 and 0 2 the dimensionless water depths at the dam section remain below 0 5 for α 0 3 and 0 4 the extra negative waves occur soon after the dam break resulting in the undulation of the water surface profiles in the upstream of the dam and a sharp increase of water depth at the dam for the water surface profiles in the downstream of the dam a remarkable rise of water surface profile close to the dam forms for all water depth ratios considered in this study the difference of the propagation speed of the shock wave front for different depth ratios in the rectangular channel is not as large as that in the triangular channel for α 0 1 and 0 2 the shock wave fronts move slower in the rectangular channel than that in the triangular channel and the contrary is true for α 0 4 roughly synchronous propagations of the shock wave fronts in both rectangular and triangular channels were observed for α 0 3 water surface profiles along the triangular and rectangular channels at t 0 5 3 5 s for four depth ratios i e α 0 1 0 2 0 3 and 0 4 with hu 0 6 m are shown in figs 7 and 8 the similarity of the water surface profiles behind the dam for different depth ratios at a specific time are observed in both triangular and rectangular channels as the same as those at hu 0 4 m it should be noted that the dimensionless water depths at the dam site are in the range of 0 6 0 7 in the triangular channel for different depth ratios the water surface undulations in the reservoir due to extra negative waves for α 0 3 and 0 4 at hu 0 6 m in the rectangular channel takes place earlier than those at hu 0 4 m for example at t 0 5 s and α 0 3 the dimensionless water depth at the dam section has exceeded 0 5 at hu 0 6 m and that for hu 0 4 m is still smaller than 0 5 at t 0 5 s the rises of the downstream water surface profiles close to the dam for all water depth ratios at hu 0 6 m are not larger than those at hu 0 4 m i e the dimensionless water depth at the crest is below 0 5 at hu 0 6 m and is above 0 5 at hu 0 4 m however these rises remain for a longer time at hu 0 6 m than those at hu 0 4 m for example at t 2 0 s the rise of the downstream water surface for α 0 3 at hu 0 6 m was still observed and it disappears at hu 0 4 m 4 3 stage hydrographs the stage hydrographs at seven sections i e x 7 m 4 m 2 m 0 16 m 2 m 4 m and 6 m are acquired directly from the synchronous recorded images the section of x 0 16 m which is nearest section to dam is used for approximately representing the dam site time evolutions of water depth for α 0 1 0 2 0 3 0 4 as well as hu 0 4 m and 0 6 m at all chosen positions are shown in figs 9 and 10 h and t are divided by hu and hu g 1 2 to obtain non dimensional flow depth and time respectively in the reservoir once the negative wave front reaches to measurement sections water level falls slowly the stage hydrographs for different water depth ratios at a chosen position are close to each other in the triangular channel the water level falls later in the triangular channel than that in the rectangular channel at same position indicating that the negative wave front propagates slower in the triangular channel than that in the rectangular channel the difference in the inception of water level falling for both triangular and rectangular channels becomes inconspicuous when the measurement section is close to the dam at the farthest section x 7 m to dam the stage hydrograph for α 0 4 rises slightly after a period of falling in the rectangular channel this phenomenon is provoked by the extra negative wave which occurs for large water depth ratios liu et al 2019a cantero chinchilla et al 2016 concluded that the nonhydrostatic pressure was responsible for the formation of extra negative wave the extra negative wave becomes obvious when the measurement section approaches the dam take the nearest position x 0 16 m to dam for example five crests of extra negative waves are formed for the period up to t g hu 1 2 50 equivalent to ten seconds and extra negative waves occurred for α 0 3 and the wavelength is large for small water depth ratio for smaller water depth ratios i e α 0 1 and 0 2 extra negative waves are not observed in the downstream of the dam once the shock wave front arrives at measurement sections water level rapidly rises the inception of water level rising takes place earlier in the triangular channel than that in the rectangular channel for α 0 1 and 0 2 because the propagation velocity of shock wave in the triangular channel is larger than that in the rectangular channel and the contrary is true for α 0 3 and 0 4 the difference of the inception of water level rising for both triangular and rectangular channels is larger when the measurement section is far from the dam the water levels remain constant after a rapid rise in the triangular channel a peak of water level after a rapid rise is formed in the rectangular channel for α 0 2 0 3 and 0 4 the peak is not obvious with the increase of the distance from the dam a remarkable peak of water level after a rapid rise is not observed in the triangular channel a second rapid rise of water level at x 6 00 m is observed for both α 0 3 and 0 4 in the rectangular channel which is caused by a reflected wave from the gate it is used for adjusting the initial downstream water level located at the downstream end moreover the stage hydrographs for hu 0 6 m behave similarly to those for hu 0 4 m the main difference is that the initial time of water level change at each measuring position is earlier for the case of hu 0 6 m the water level rising at all measurement sections in the downstream channel occurs for hu 0 6 m earlier than that for hu 0 4 m due to the increase of shock wave celerity the reflected waves from the gate at the downstream end are also formed for hu 0 6 m earlier than that for hu 0 4 m for example a second rapid rise at x 4 00 m occurs for hu 0 6 m under the case of both α 0 3 and 0 4 during the first ten seconds in the rectangular channel which is not observed for hu 0 4 m 5 conclusions experiments of dam break flows in both triangular and rectangular channels are conducted on the conditions of two initially reservoir heads i e hu 0 4 and 0 6 m and four tailwater levels i e α 0 1 0 2 0 3 and 0 4 in this study the experimental data are obtained using digital image processing the flow measuring technique is non intrusive and can produce valuable results concerning water surface profiles along the whole channel for any time as well as the stage hydrographs at any position without disturbing the flow common features of the dam break flows in triangular and rectangular channels are found as follows 1 a jet occurs in the downstream of the dam for different water depth ratios during the initial dam break stage resulting a remarkable rise of water surface profile 2 the shape of the water surface profiles behind the dam for different depth ratios at a specific time remains similar and 3 the effect of the depth ratio on the propagation of the negative wave front is insignificant and the movement of the shock wave front downstream of the dam is related to the depth ratio differences between the dam break flow characteristics in both channels are also analyzed in triangular channel the dimensionless water depth at the dam section for different water depth ratios is in the range of 0 6 0 7 the propagation speed of the shock wave front shows slower as the depth ratio increases and the lag becomes larger as the time goes on in the rectangular channel the negative wave front moves faster than that in the triangular channel for small water depth ratios i e α 0 1 and 0 2 the dimensionless water depths at the dam section remain below 0 5 for large water depth ratios i e α 0 3 and 0 4 extra negative wave propagating toward the upstream channel end forms soon after the dam break resulting in an undulation of the water surface profile in the reservoir and an apparent increase of water depth at the dam the difference among the speeds of the shock wave fronts for different depth ratios is not as large as that in the triangular channel for α 0 1 and 0 2 the shock wave fronts move slower than that in the triangular channel and the contrary is true for α 0 4 for α 0 3 the shock wave fronts in both rectangular and triangular channels move synchronously in the rough the findings are useful for understanding the effect of tailwater levels on the propagation of dam break flood waves in a triangular channel the current laboratory data can be used to validate both the analytical and the numerical solutions due to lack of detailed experimental study related to dam break flows in triangular channels in the literature declaration of competing interest none acknowledgements this study is supported by the national key research and development program of china grant no 2018yfc1505000 the national natural science foundation of china grant no 51879179 and sichuan science and technology program no 2019jdtd0007 we can send the experimental data to any interested readers if they send the requirement to us by email 
6373,dam break flows in both triangular and rectangular channels are investigated experimentally in the present study laboratory measurements are carried out in a prismatic and smooth flume with a horizontal and wet bed for two different reservoir heads and four tailwater levels during the experiments digital image processing is applied as a flow measurement technique both water surface profiles and stage hydrographs are obtained effectively by means of video images with eight adjacent cameras the dam break flows in triangular and rectangular channels show common features jet formation in the downstream of the dam during the initial dam break stage similarity of the water surface profiles behind the dam for different depth ratios at a specific time insignificant effects of the depth ratio on the negative wave front and strong dependence of the shock wave front on the depth ratio in a triangular channel the negative wave front moves slower than that in a rectangular channel and extra negative waves propagating towards upstream direction does not form for all depth ratios considered in this study while they have been observed in a rectangular channel for large values of α representing the ratio of initial tailwater depth and reservoir depth i e α 0 3 and 0 4 meantime these extra negative waves result in an undulation of the water surface profile in the reservoir and an apparent increase of water depth at the dam the water depth at the dam section for different depth ratios is 60 70 of the initial reservoir head and the shock wave front propagates slower as the depth ratio increases for the triangular channel for water depth ratios α 0 1 and 0 2 the shock wave front moves faster than that in a rectangular channel and the contrary is true for α 0 4 for α 0 3 the propagation speed of the shock wave front approximates that in a rectangular channel present study contributes to the understanding of the effect of wet downstream conditions on dam break flows in triangular channels and provides detailed experimental data for validating both the analytical and the numerical solutions keywords dam break negative wave shock wave extra negative wave triangular channel image processing 1 introduction dam break floods may cause major damage to lives and property in the path of the flood wave propagation a dam break flood is strongly influenced by many factors su and barnes 1970 sakkas and strelkoff 1973 1976 katopodes and strelkoff 1978 katopodes and schamber 1983 schamber and katopodes 1984 wu et al 1993 1999 zanuttigh and lamberti 2011 wang et al 2017 among which the cross sectional shape of river is the primary factor according to the cross sectional shape rivers can be divided into two categories wide shallow rivers and narrow deep rivers the former ones appear in plain areas often conceptualized as compound channels or even rectangular channels in studies and the second ones can be found in mountainous regions conceptualized as triangular channels experimental investigation of dam break flows is visual compared with the methods of theoretical analysis and numerical simulation the laboratory data can be also used to validate the theoretical and numerical models the experimental data available in literature mainly refer to the dam break flows in rectangular channels dressler 1954 miller and chaudhry 1989 bellos et al 1992 fraccarollo and toro 1995 lauber and hager 1998a b stansby et al 1998 bukreev and gusev 2005 soares frazao and zech 2007 ozmen cagatay and kocaman 2010 2012 oertel and bung 2012 chen et al 2013 larocque et al 2013 ozmen cagatay et al 2014 and kocaman and ozmen cagatay 2015 liu et al 2018 liu et al 2019a b obviously the propagation of dam break flood waves in different types of rivers is different how does the dam break flood waves propagate in a triangular channel what is the effect of wet conditions on the wave movement in a triangular channel many questions on dam break floods in a triangular channel are not clear and need to be studied urgently however to the best of the authors knowledge there is no detailed experimental study available on the dam break flow in triangular flumes with a wet bed so it is the objective which will be studied in this paper in the present study the wave propagations of dam break flood in rectangular and triangular channels are investigated experimentally on the conditions of two initially reservoir levels and a series of tailwater levels in experiments eight adjacent ccd cameras are adopted for synchronously recording the flow along the upstream and downstream channels digital image processing being of non intrusive has been used widely as a measuring technique in the laboratory tests of dam break flows lauber and hager 1998a b stansby et al 1998 aureli et al 2008 soares frazao and zech 2007 ozmen cagatay and kocaman 2010 kocaman and ozmen cagatay 2012 ozmen cagatay and kocaman 2012 ozmen cagatay et al 2014 kocaman and ozmen cagatay 2015 liu et al 2019b the time evolutions of water depths or water levels are obtained directly from the record video images through the digital image processing the measuring technique adopted in this study can produce complete visualization of the flow behavior along the entire flume without test repetitions based on this technique the dam break flows in both rectangular and triangular channels will be compared in detail 2 facilities and instrumentation the experiments are conducted at the state key laboratory of hydraulics and mountain river engineering sichuan university china the rectangular flume with length of 18 m width of 1 m and height of 1 09 m is made of stalinite supported by a steel frame it is divided by a 15 mm thick fiberglass plate into two reaches the length of the upstream and the downstream ones are 8 37 m and 9 63 m long respectively the geometry and dimensions of the reservoir and downstream channel are shown in fig 1 when the experiments for the rectangular flume are completed the flume cross section is modified to be a triangle the left wall remains vertical for recording the flow with cameras and the slope of the right wall is 45 the instantaneous dam break is simulated by lifting the plate instantly with an electromagnetic brake asynchronous motor according to the recommendation of lauber and hager 1998a the plate removal time should be shorter than 2 h 0 g 1 2 h 0 is the upstream water depth and g is the gravity acceleration 9 8 m s2 for a sudden removal in the present tests h 0 is defined as the average water depth in the upstream of the plate i e h 0 a u b u a u and b u are the initially upstream cross sectional area and the water surface width respectively because the cross sectional shapes considered in this study include both rectangle and triangle the plate removal time is between 0 1667 s and 0 2500 s for the rectangular channel and in the range of 0 1250 0 1875 s for the triangular channel from video records so both of them satisfy the revised transient failure condition the plate removal time is smaller in the triangular channel than that in the rectangular channel due to the reduce of the hydrostatic pressure on the gate the wet bed condition can be guaranteed by adjusting a steel gate located at the downstream end of the flume two groups of experiments are carried out for different initial reservoir levels in the first group initial reservoir depth is taken as 0 6 m and in the second one it is 0 4 m the depth ratios α 0 1 and 0 4 where α h d h u h u and h d are initial reservoir depth and initial tailwater depth respectively are usually used for representing shallow and deep tailwater conditions respectively stansby et al 1998 ozmen cagatay and kocaman 2010 kocaman and ozmen cagatay 2015 in each group four initial tailwater depths are tested corresponding to four depth ratios i e α 0 1 0 2 0 3 and 0 4 to ensure the quality of the video and make it more convenient to use the image processing technology the background is covered with a smooth white car sticker and the reservoir water and tailwater are dyed with methyl violet in experiment to avoid noise from the reflection of the flume glass during image processing a dark colored curtain is arranged on both sides of the flume to eliminate the shadow caused by natural light 3 flow measuring technique during the experiment digital image processing is used to obtain the free surface profiles the digital imaging system contains three parts a computer eight high speed ccd cameras and the matlab software the mathworks inc 2016 in which camera calibration frame grap synchronous images combination and binarization and so on are conducted in the test eight ccd cameras are arranged along the flume and in parallel at the same side of the flume with equal interval of 1 4 m to capture the evolution of the water flow cameras are turned on wirelessly by a remote control in order to make cameras work synchronously as shown in fig 2 the flow measurement contains two parts calibration process and water depth acquisition the usage of wide angle lens causes radial and tangential distortions of the images thus the calibration for images is required to correct the distortions a calibration board containing 11 horizontal and 10 vertical uniform black and white colored square meshes is used in which the mesh size was 100 mm 100 mm in addition a margin of 50 mm is left around the calibration board for the calibration toolbox to recognize the corner points in the calibration process the calibration board is filmed from different orientation and at different distance twenty five video images are selected to obtain the intrinsic and extrinsic parameters of each camera as well as the calibration code from camera calibration app in order to obtain the water depth firstly the flow is synchronously recorded with eight adjacent ccd cameras then the recorded raw images are digitized as 1440 1920 pixels at 48 frames s and imported into the matlab software for calibration by aid of the calibration code eight synchronous and undistorted images are cropped due to the margin overlap between adjacent images and then are combined producing an extensive view through the entire flume as a reference for image combination a red ruler is placed on the upper side of the channel walls afterwards all images are grayed and binarized with threshold values for capturing the air water interface a median filter function is applied for the images to minimize unwanted stain like traces of any ambient object caused by lighting device the edge for representing the free surface profile interface is identified the number of black pixels per column in the binary images is recorded the coordinate transformation scale from image unit pixel to the actual dimension mm is determined according to the red ruler finally the water depth is obtained with the scale in the present study the actual length represented by one pixel is calculated as approximately 1 8 mm unlike the methods used by stansby et al 1998 and soares frazao and zech 2007 the measuring technique adopted in this experimental study does not need test repetitions to acquire the complete visualization of the flow behavior along the entire flume the present measuring method needs no frame grabber card and is different from that used by ozmen cagatay and kocaman 2010 kocaman and ozmen cagatay 2012 ozmen cagatay and kocaman 2012 ozmen cagatay et al 2014 and kocaman and ozmen cagatay 2015 water depth profiles against time can be obtained directly from the recorded video images processed by means of digital image processing technique without the need of any wave probes causing no disturbance to the flow field thus the time evolution of water depth at any desired section can be acquired by a vertical line located at the processed video images representing a virtual wave probe virtual wave probe can be a perfect substitute for the physical instrument in experimental measurements which was used in the study of kocaman and ozmen cagatay 2015 the depth hydrographs acquired by the digital image processing adopted in present study were compared with the measurements by the traditional wave probes and the maximum relative error was about 10 the comparison between these two kinds of acquisition techniques shows very good agreement and more details can be found in the study by liu et al 2019b during the present experiments 480 video images which are equivalent to the duration of ten seconds are analyzed for each test 4 results and discussion in this section experimental results of dam break waves in a triangular channel over initially wet bed with four distinct tailwater levels are presented and they are compared with the measured data in a rectangular channel 4 1 evolution of dam break flow video images of the flow evolution for α 0 1 and 0 4 with initial reservoir depth of 0 4 m are shown in fig 3 in each frame presented in fig 3 upper two images represent results from a triangular channel with α 0 1 and 0 4 respectively and lower two images represent results from a rectangular channel with α 0 1 and 0 4 respectively each image shows the flows in the range from 8 m x 8 m in the upstream to 7 7 m in the downstream reaches x 7 7 m upon removing the dam the tailwater is dragged by the initial reservoir water due to the gravity effect and the tailwater resists to the drag force as a result the dam break wave front is broken and a jet is formed downstream during the initial stage which forced the flow to move upward upper two frames in fig 3 this jet like phenomenon is quite similar with the behavior of the dam break flow at initial stages in a rectangular channel lower two frames in fig 3 and this founding was also observed in the studies by stansby et al 1998 ozmen cagatay and kocaman 2010 and kocaman and ozmen cagatay 2015 it is indicated from fig 3 that the speed of the wave front is higher for α 0 1 than that for α 0 4 both in triangular and rectangular channels thus both of the wave breaking and jet formation for α 0 1 occur earlier than those for α 0 4 fig 3 also shows some differences between the dam break flows in triangular and rectangular channels the wave front in a triangular channel moves faster than that in a rectangular channel for α 0 1 and the contrary is true for α 0 4 the arrival times of wave front at the downstream ends of triangular and rectangular flumes since dam break for α 0 1 are just about 4 60 s and 5 12 s respectively and 6 04 s and 5 19 s for α 0 4 respectively the jet after dam break initiation seems to be weaker in a triangular channel than that in a rectangular channel for example the observations at t 0 25 s for α 0 1 and at t 0 5 s for α 0 4 it drops back down the tailwater and produces air entrainment early in a triangular channel for α 0 1 i e substantial foaming in the free surface of the wave front caused by air entrainment has been formed at t 0 5 s while the jet remains robust in a rectangular channel once the dam is removed the tailwater resists to the drag force caused by the initial reservoir water when the depth ratio is large enough i e the tailwater level is very high the resistance force caused by the tailwater on the reservoir water will produces extra negative waves called extra negative wave train that originate from the dam site propagating toward the upstream end of the channel extra negative waves occurred in the experiments conducted by kocaman and ozmen cagatay 2015 liu et al 2019a experimentally investigated both the speed as well as the crest of the first extra negative wave and concluded that extra negative waves would appear if the depth ratio was not smaller than 0 3 the first and second extra negative waves are formed approximately at t 1 s and 3 5 s for α 0 4 in a rectangular channel respectively in the triangular channel extra negative waves cannot be observed for α 0 4 the time evolutions of dam break flow with h u of 0 6 m are quite similar to those with h u of 0 4 m as shown in fig 4 the wave front moves faster as h u increases because of more potential energy for example at t 0 25 s the jet in the downstream of dam had fallen back the tailwater producing air entrainment in a triangular channel with hu 0 6 m for α 0 1 while it is still observed at that time with hu 0 4 m the arrival of wave front at the downstream ends of triangular and rectangular flumes after dam break for α 0 1 take about 3 62 s and 4 19 s respectively and 4 77 s and 4 25 s for α 0 4 respectively 4 2 water surface profile water surface profiles along the triangular channel at t 0 5 s 1 0 s 1 5 s 2 0 s 2 5 s 3 0 s and 3 5 s for four depth ratios i e α 0 1 0 2 0 3 and 0 4 with hu 0 4 m are shown in fig 5 with sudden removal of the gate both the negative wave propagating to the upstream and the shock wave moving to the downstream of the channel are formed the dimensionless water surface profiles in the upstream of the dam for different depth ratios at a specific time overlap each other and the water depths at the dam section are around 60 70 of hu for the triangular channel the effect of the depth ratio on the propagation of the negative wave front is insignificant the flow movement in the downstream of the dam is related to the depth ratio and four different water surface profiles are observed obviously the main characteristics are that the shock wave front propagates slower with the increase of depth ratio and the lag becomes larger as the time goes on a remarkable rise of water surface profile due to the jet is formed close to the dam for α 0 2 0 3 and 0 4 at t 0 5 s and becomes more obvious the rise of water surface profile occurs earlier for α 0 1 and disappeared before t 0 5 s fig 6 shows the water surface profiles along the rectangular channel at t 0 5 3 5 s 0 5 s 1 0 s 1 5 s 2 0 s 2 5 s 3 0 s and 3 5 s for four depth ratios i e α 0 1 0 2 0 3 and 0 4 with hu 0 4 m the water surface profiles behind the dam for different depth ratios at a specific time show similar shapes in the rectangular channel and this founding is the same as that in the triangular channel the negative wave front moves faster in the rectangular channel than that in the triangular channel for α 0 1 and 0 2 the dimensionless water depths at the dam section remain below 0 5 for α 0 3 and 0 4 the extra negative waves occur soon after the dam break resulting in the undulation of the water surface profiles in the upstream of the dam and a sharp increase of water depth at the dam for the water surface profiles in the downstream of the dam a remarkable rise of water surface profile close to the dam forms for all water depth ratios considered in this study the difference of the propagation speed of the shock wave front for different depth ratios in the rectangular channel is not as large as that in the triangular channel for α 0 1 and 0 2 the shock wave fronts move slower in the rectangular channel than that in the triangular channel and the contrary is true for α 0 4 roughly synchronous propagations of the shock wave fronts in both rectangular and triangular channels were observed for α 0 3 water surface profiles along the triangular and rectangular channels at t 0 5 3 5 s for four depth ratios i e α 0 1 0 2 0 3 and 0 4 with hu 0 6 m are shown in figs 7 and 8 the similarity of the water surface profiles behind the dam for different depth ratios at a specific time are observed in both triangular and rectangular channels as the same as those at hu 0 4 m it should be noted that the dimensionless water depths at the dam site are in the range of 0 6 0 7 in the triangular channel for different depth ratios the water surface undulations in the reservoir due to extra negative waves for α 0 3 and 0 4 at hu 0 6 m in the rectangular channel takes place earlier than those at hu 0 4 m for example at t 0 5 s and α 0 3 the dimensionless water depth at the dam section has exceeded 0 5 at hu 0 6 m and that for hu 0 4 m is still smaller than 0 5 at t 0 5 s the rises of the downstream water surface profiles close to the dam for all water depth ratios at hu 0 6 m are not larger than those at hu 0 4 m i e the dimensionless water depth at the crest is below 0 5 at hu 0 6 m and is above 0 5 at hu 0 4 m however these rises remain for a longer time at hu 0 6 m than those at hu 0 4 m for example at t 2 0 s the rise of the downstream water surface for α 0 3 at hu 0 6 m was still observed and it disappears at hu 0 4 m 4 3 stage hydrographs the stage hydrographs at seven sections i e x 7 m 4 m 2 m 0 16 m 2 m 4 m and 6 m are acquired directly from the synchronous recorded images the section of x 0 16 m which is nearest section to dam is used for approximately representing the dam site time evolutions of water depth for α 0 1 0 2 0 3 0 4 as well as hu 0 4 m and 0 6 m at all chosen positions are shown in figs 9 and 10 h and t are divided by hu and hu g 1 2 to obtain non dimensional flow depth and time respectively in the reservoir once the negative wave front reaches to measurement sections water level falls slowly the stage hydrographs for different water depth ratios at a chosen position are close to each other in the triangular channel the water level falls later in the triangular channel than that in the rectangular channel at same position indicating that the negative wave front propagates slower in the triangular channel than that in the rectangular channel the difference in the inception of water level falling for both triangular and rectangular channels becomes inconspicuous when the measurement section is close to the dam at the farthest section x 7 m to dam the stage hydrograph for α 0 4 rises slightly after a period of falling in the rectangular channel this phenomenon is provoked by the extra negative wave which occurs for large water depth ratios liu et al 2019a cantero chinchilla et al 2016 concluded that the nonhydrostatic pressure was responsible for the formation of extra negative wave the extra negative wave becomes obvious when the measurement section approaches the dam take the nearest position x 0 16 m to dam for example five crests of extra negative waves are formed for the period up to t g hu 1 2 50 equivalent to ten seconds and extra negative waves occurred for α 0 3 and the wavelength is large for small water depth ratio for smaller water depth ratios i e α 0 1 and 0 2 extra negative waves are not observed in the downstream of the dam once the shock wave front arrives at measurement sections water level rapidly rises the inception of water level rising takes place earlier in the triangular channel than that in the rectangular channel for α 0 1 and 0 2 because the propagation velocity of shock wave in the triangular channel is larger than that in the rectangular channel and the contrary is true for α 0 3 and 0 4 the difference of the inception of water level rising for both triangular and rectangular channels is larger when the measurement section is far from the dam the water levels remain constant after a rapid rise in the triangular channel a peak of water level after a rapid rise is formed in the rectangular channel for α 0 2 0 3 and 0 4 the peak is not obvious with the increase of the distance from the dam a remarkable peak of water level after a rapid rise is not observed in the triangular channel a second rapid rise of water level at x 6 00 m is observed for both α 0 3 and 0 4 in the rectangular channel which is caused by a reflected wave from the gate it is used for adjusting the initial downstream water level located at the downstream end moreover the stage hydrographs for hu 0 6 m behave similarly to those for hu 0 4 m the main difference is that the initial time of water level change at each measuring position is earlier for the case of hu 0 6 m the water level rising at all measurement sections in the downstream channel occurs for hu 0 6 m earlier than that for hu 0 4 m due to the increase of shock wave celerity the reflected waves from the gate at the downstream end are also formed for hu 0 6 m earlier than that for hu 0 4 m for example a second rapid rise at x 4 00 m occurs for hu 0 6 m under the case of both α 0 3 and 0 4 during the first ten seconds in the rectangular channel which is not observed for hu 0 4 m 5 conclusions experiments of dam break flows in both triangular and rectangular channels are conducted on the conditions of two initially reservoir heads i e hu 0 4 and 0 6 m and four tailwater levels i e α 0 1 0 2 0 3 and 0 4 in this study the experimental data are obtained using digital image processing the flow measuring technique is non intrusive and can produce valuable results concerning water surface profiles along the whole channel for any time as well as the stage hydrographs at any position without disturbing the flow common features of the dam break flows in triangular and rectangular channels are found as follows 1 a jet occurs in the downstream of the dam for different water depth ratios during the initial dam break stage resulting a remarkable rise of water surface profile 2 the shape of the water surface profiles behind the dam for different depth ratios at a specific time remains similar and 3 the effect of the depth ratio on the propagation of the negative wave front is insignificant and the movement of the shock wave front downstream of the dam is related to the depth ratio differences between the dam break flow characteristics in both channels are also analyzed in triangular channel the dimensionless water depth at the dam section for different water depth ratios is in the range of 0 6 0 7 the propagation speed of the shock wave front shows slower as the depth ratio increases and the lag becomes larger as the time goes on in the rectangular channel the negative wave front moves faster than that in the triangular channel for small water depth ratios i e α 0 1 and 0 2 the dimensionless water depths at the dam section remain below 0 5 for large water depth ratios i e α 0 3 and 0 4 extra negative wave propagating toward the upstream channel end forms soon after the dam break resulting in an undulation of the water surface profile in the reservoir and an apparent increase of water depth at the dam the difference among the speeds of the shock wave fronts for different depth ratios is not as large as that in the triangular channel for α 0 1 and 0 2 the shock wave fronts move slower than that in the triangular channel and the contrary is true for α 0 4 for α 0 3 the shock wave fronts in both rectangular and triangular channels move synchronously in the rough the findings are useful for understanding the effect of tailwater levels on the propagation of dam break flood waves in a triangular channel the current laboratory data can be used to validate both the analytical and the numerical solutions due to lack of detailed experimental study related to dam break flows in triangular channels in the literature declaration of competing interest none acknowledgements this study is supported by the national key research and development program of china grant no 2018yfc1505000 the national natural science foundation of china grant no 51879179 and sichuan science and technology program no 2019jdtd0007 we can send the experimental data to any interested readers if they send the requirement to us by email 
6374,among different sources of uncertainty in hydrologic modeling i e model structure parameter estimation input data etc consecutive error reduction of model initial conditions can prevent a model from drifting away from reality and consequently improving model estimates most approaches that evaluated the correction of initial conditions through data assimilation da have focused on improving hydrologic model simulations i e under observed forcings rather than evaluating the model performance in a forecasting context this paper investigates the utility of ensemble kalman filter enkf data assimilation in which available observed streamflow is exploited to update state variables of a conceptual water balance model for forecasting monthly streamflow over 340 rainfall dominated river basins across the contiguous united states conus our results demonstrate that after enkf application streamflow simulation skill improves in terms of both relative root mean square error r rmse and correlation coefficient cc for almost 90 of the selected river basins evaluating the model performance under different flow conditions shows that enkf has stronger positive effect on monthly low flow predictions comparing to monthly high flows particularly during the summer season the utility of enkf is also assessed in the context of 1 month ahead streamflow forecasting due to the updated model initial conditions streamflow forecasts are improved throughout the year even though the skill in hydrologic forecasts is predominantly dependent on the accuracy of precipitation forecasts keywords streamflow forecasting hydrologic data assimilation conceptual water balance model 1 introduction monthly to seasonal m2s streamflow forecasts derived using climate information are crucial for several fields such as agricultural studies climate change impacts groundwater assessment and developing proactive water management strategies sankarasubramanian et al 2009 vörösmarty et al 2000 najafi et al 2018 but developing skillful m2s streamflow forecasts significantly varies between rainfall dominated and snow dominated hydrological regimes koster et al 2010 the skill of m2s streamflow forecasting for snow dominated basins predominantly depends on the accuracy in estimating the initial snow water equivalent swe conditions for instance maurer et al 2004 showed that swe plays an important role in the skill of seasonal streamflow forecasts over the western us on the other hand for rainfall dominated basins utilizing precipitation forecasts from general circulation models gcm substantially improves the streamflow forecasting skill particularly during the winter season mazrooei et al 2015 sinha and sankarasubramanian 2013 the skill of m2s precipitation forecasts over the contiguous united states conus varies spatially and heavily depends on the exogenous climate conditions such as intensity of enso over the tropical pacific devineni et al 2008 goddard et al 2003 armal et al 2018 thus a realistic assessment of m2s streamflow forecasting skill over rainfall dominated basins needs to consider climate forecasts given the determining role of skillful climate forcing in hydrology one could consider additional strategies to reduce the uncertainty from other sources e g initial conditions inaccurate model parameters and structural deficiency of model and consequently improve the hydrologic model predictions moradkhani et al 2005 sinha et al 2014 for instance considerable effort has been made on improving the estimation of model parameters beven and binley 1992 vrugt et al 2003 due to high nonlinearity and complexity of the watershed dynamics errors in forcing data and equifinality of model parameters it is impossible to perfectly calibrate hydrologic models vrugt et al 2008 even if the models are well calibrated using manual automatic calibration the deficiency in the model structure results in a mismatch between the model products and observations ajami et al 2004 moradkhani et al 2005 li and sankarasubramanian 2012 moreover studies have argued the importance of preserving model parsimony for improving hydrologic predictions wolock and mccabe 1999 recent studies have also emphasized that a detailed representation of hydrologic processes in model building should be pursued depending on the time scale of interest in predicting hydrological fluxes sivapalan et al 2003 still there is an advantage in using a conceptual watershed model which is the relative simplicity and computational efficiency particularly for making predictions at monthly time scales singh and woolhiser 2002 martinez and gupta 2010 demonstrated that abcd model a simple lumped model is able to adequately simulate monthly streamflows across the conus further gcm climate forecasts are typically available at coarse spatio temporal resolutions and in order to match the resolutions of distributed land surface models lsms it is necessary to employ spatial downscaling and temporal disaggregation techniques both of these post processing of the climate forecasts in particular temporal disaggregation from monthly to daily time steps have been shown to arise errors in m2s streamflow forecasts sinha et al 2014 mazrooei et al 2015 hence a lumped watershed model has been applied for developing monthly streamflow forecasts uncertainty in model s initial conditions also plays an important role in determining the skill of hydrologic predictions studies have shown that forcing lsms just with climatological precipitation and temperature i e uninformed forecasts but updated with initial soil moisture conditions from model simulations using observed forcings provide critical information in forecasting seasonal streamflow over rainfall dominated basins mahanama et al 2012 sinha and sankarasubramanian 2013 found that updating initial soil moisture contents in a rainfall dominated basin provides improved m2s streamflow forecasts moreover correcting initial conditions by assimilating recently observed land surface conditions e g soil moisture swe streamflow further improves hydrologic predictions li et al 2016 moradkhani and sorooshian 2009 rüdiger et al 2006 abdi and yasi 2015 vrugt et al 2006 komma et al 2008 data assimilation da techniques were first introduced by meteorologists and have been applied to improve operational weather forecasting over the last few decades rabier 2005 reichle 2008 however application of da in hydrological studies started recently due to lack of suitable large domain long term observations of initial states along with the lack of proper quantification of the uncertainty in observations and hydrologic models liu et al 2012 in general da methods are divided into two types variational and sequential methods mclaughlin 2002 variational data assimilation is commonly used in numerical weather prediction whereas sequential data assimilation is applied in hydrological models since it is more suitable for distributed data sets mclaughlin 2002 seo et al 2003 bertino et al 2003 in rainfall dominated catchments assimilation of near surface soil moisture data improves the estimation of land surface fluxes thereby enhancing the streamflow predictions pauwels et al 2001 de lannoy et al 2007 reichle 2008 montzka et al 2011 alvarez garreton et al 2016 several studies also reported the advancements in operational short term hydrological forecasting with the aid of assimilation of streamflow records in distributed models vrugt et al 2006 rüdiger et al 2006 clark et al 2008 increasing availability of remotely sensed observations along with the need of real time hydrologic forecasting for water management applications has made da a focal point for assessing and implementing potential improvements in streamflow forecasting liu et al 2012 moradkhani et al 2004 the main challenge in assimilating land surface conditions e g soil moisture is primarily associated with the limited availability of continuous observed information in long term because the ground measurements of soil moisture content are hard and expensive to acquire especially over a large spatial domain most of the da studies tend to use remotely sensed data of such variables covering a large spatial domain however the remotely sensed information is available only from late 1990s and containing substantial measurement errors on the other hand assimilating gauge measured observed streamflow data is advantageous since it directly integrates the basin response having relatively small measurement error and the records are available for multiple decades across the conus hence observed streamflow data could be exploited in order to update the state variables of hydrologic models and respectively analyze the impacts on m2s streamflow forecasts over longer study periods pauwels and de lannoy 2006 aubert et al 2003 clark et al 2008 da in hydrological studies have been focused on improving both lumped and distributed models moradkhani and sorooshian 2009 while most of the above studies have applied da in a hydrologic simulation scheme i e under observed forcings there are limited studies evaluating improved m2s streamflow forecasts by using both climate forecasts and da the main intent of this study is to quantify and assess the potential improvements in the skill of practical m2s streamflow forecasts through correction of model s initial land surface conditions we consider abcd lumped watershed model and the correction in the model s initial state is achieved by assimilating previous month streamflow observations over rainfall dominated basins across the conus in another word we try to investigate the utility of ensemble kalman filter enkf data assimilation using observed streamflow data in improving m2s streamflow forecasts the manuscript is organized as follows we first present the hydroclimatic data set along with the details of the conceptual watershed model and the procedure for assimilating streamflow records through enkf within the water balance model then the performance of the hydrologic model is assessed with and without enkf application with observed forcings in simulating the observed streamflow following that the utility of enkf is evaluated in developing monthly streamflow forecasts using 1 month ahead climate forecasts from echam4 5 gcm finally the findings are summarized in the context of forcings and the role of corrected initial conditions in improving streamflow forecasts over rainfall runoff regime 2 hydroclimatic data and climate forecasts the temporal span of this study is a 39 water year period from 1971 to 2010 the first 19 years 1971 1990 are used to calibrate the hydrologic model see section 3 1 and the rest of the 20 years 1991 2010 for model validation purposes monthly time series of variables such as potential evapotranspiration pet streamflow observations q and forecasted and observed precipitation p were acquired from multiple sources that are explained next 2 1 streamflow data the streamflow observation data is obtained from the hydro climatic data network hcdn compiled by slack et al 1993 hcdn stations are stream gauges whose records are not influenced by anthropogenic activities such as upstream storage and groundwater pumping sankarasubramanian and vogel 2003 vogel and sankarasubramanian 2005 this dataset includes average daily monthly and annual records of streamflow over almost 1700 unique stations across the entire country for the past century however the start and end dates of the records are not same for all the stations and in some cases there are gaps in the length of the records therefore we limited our analyses to 340 stations that have continuous monthly time series of streamflow observations for the period of 1971 2010 fig 1 the selected river basins are classified as rainfall dominated basins in which the precipitation is the greatest contributor to the streamflow as opposed to snow dominated river basins where the snowpack ablation plays the most critical role in basin dynamics our approach for this classification is adapted based on the grouping described by martinez and gupta 2010 where they used predominant snow cover data from sturm et al 1995 along with modification of the snow versus no snow contour through visual inspection here all the hcdn basins inside the huc regions 3 6 8 11 12 13 and 15 were defined as rainfall dominated basins since they are located in the us sunbelt region south of the 37 n latitude with long summers and short and mild winters along with the river basins in huc 17 and 18 located in western coast 2 2 potential evapotranspiration data daily estimations of potential evapotranspiration pet over the period of 1971 2010 are obtained from penman monteith method generated by the variable infiltration capacity vic land surface model forced with observed meteorological data sinha et al 2014 vic model is a distributed model that has penman monteith method to estimate pet at 1 8 spatial resolution liang et al 1994 1996 in this study the 1 8 daily pet estimations were spatially averaged over the selected basins boundaries and aggregated to monthly values 2 3 precipitation observations and forecasts monthly time series of observed precipitation p over the period of 1971 2010 are obtained by taking the spatial average over each basin boundary using the maurer et al 2002 dataset these meteorological observations are available at 1 8 spatial resolution on a daily and monthly temporal scale for the conus derived by interpolating between observations from rain gauges across the country to develop a gridded observed meteorological dataset however interpolated data is likely to contain more errors under specific circumstances such as complex topographies low gauge density in a region and high seasonality of meteorological variables mazrooei 2014 monthly updated precipitation forecasts consisting of 24 ensemble members at 2 8 spatial resolution and at monthly timestep are obtained from echam4 5 general circulation model gcm accessible at international research institute of climate and society iri data library li and goddard 2005 these retrospective precipitation forecasts are then downscaled to 1 8 spatial resolution using a statistical downscaling approach based on principal component regression pcr for a given month for each 1 8 grid cell in the study area the ensemble mean of monthly precipitation forecasts from four nearest 2 8 neighboring grids are selected as predictors and the corresponding observed monthly precipitation of the finer grid cell is assigned as predictand then an adaptive pcr model is developed using the 25 years of data prior to the forecasting year as training period for example to obtain spatially downscaled forecast for a given 1 8 grid for january 1991 antecedent 25 years of january data i e from 1966 to 1990 serves as the training period since the coarse scale gridded precipitation forecasts have high spatial correlation with each other pcr is selected to build the statistical model between predictors and predictand pcr is capable of transforming the predictors in such a way that the inter correlation between predictors is minimized thus each of them has a unique valuable information mazrooei and sankarasubramanian 2017 a thorough assessment of the seasonal skill in the downscaled precipitation forecasts can be found in mazrooei et al 2015 3 methodology 3 1 abcd model the abcd model is a nonlinear physically based and lumped water balance model which accepts monthly precipitation p and potential evapotranspiration pet as inputs obtains soil moisture storage s and groundwater storage g as state variables and producing streamflow q as the output this model was first introduced by thomas 1981 and thomas et al 1983 as an adequate model in performing regional water resources assessment the abcd model was later compared with various monthly water balance models vandewiele et al 1992 the performance of the abcd model is evaluated by using 39 years of monthly data for calibration and validation purposes accordingly the dataset is divided into two parts i e the calibration period containing 19 years of data water year 1972 1990 and the validation period of 20 years water years 1991 2010 the data during the calibration period is used in an optimization framework with the objective of minimizing the errors between simulated and observed streamflows further description of the abcd model structure is provided in appendix a for each river basin the abcd model performance during the validation period was then evaluated using relative root mean square error r rmse for each month eq 1 1 r rmse m 1 n t 1 n q m t sim q m t obs 2 q m obs where m and t denote a specific month and year respectively q m t sim and q m t obs refer to the corresponding modeled and observed flows respectively and n is the total number of years in the evaluation period 20 years root mean square error rmse is a common used metric to indicate the accuracy in simulated forecasted flows hyndman and koehler 2006 however we considered r rmse since it is a normalized version of the rmse based on the climatology of the streamflow thus it allows us to compare the model performance across different months and also across the basins in addition to model precision for the purpose of measuring the strength of the model in predicting the variability of the observed flows pearson s correlation coefficient is also computed between streamflow simulations forecasts and observations also pearson s correlation is checked for statistical significance at 95 confidence level i e 1 96 n 3 where n denotes the length of the vector of data points used in calculating the correlation steel et al 1960 3 2 application of enkf to abcd model sequential data assimilation i e filtering ingests the up to date observed information into the model state variables in order to improve model initial conditions prior to next timestep kalman filter kf is a sequential filter introduced by kalman 1960 which is appropriate for models with linear dynamics while for non linear models extended kalman filter ekf is commonly employed reichle et al 2002 jazwinski 2007 however for large scale systems both methods are computationally demanding and ekf may produce instabilities and divergence if nonlinearities are strong miller et al 1994 reichle et al 2002 to overcome these limitations the ensemble kalman filter enkf was first introduced by evensen 1994 and later clarified by burgers et al 1998 enkf propagates the updated ensemble states from the previous timestep through a nonlinear model and computes the forecast state error covariance matrix afterwards consequently when observations are provided the state ensemble can be updated based on a statistical relationship between state covariance and observational error covariance moradkhani et al 2005 a description of the general enkf framework is presented in appendix b enkf can be employed in various hydrologic models here we denote the abcd model as a nonlinear system h θ x t 1 i u t i which requires the model parameter set θ a b c d table 1 ensemble of initial states x t 1 i s t 1 i g t 1 i consisting of two state variables soil moisture storage and groundwater storage and the ensemble of perturbed forcing data u t i p t i pe t i containing precipitation and potential evapotranspiration variables where i denotes the ensemble member the h model then estimates the prior state variables and ensemble of streamflow q t i at time t using eqs a 1 a 6 in the abcd model formulation 2 q t i x t i h θ x t 1 i u t i when the streamflow observation q t is available updated ensembles of soil moisture storage and groundwater storage at time t can be computed in order to be used in the next time step model integration enkf implementation in the abcd model is listed in three steps initialization forecast and update steps burgers et al 1998 reichle et al 2002 here we apply those steps in the context of the abcd model for streamflow forecasting for a given river basin described as follows i initialization model parameters are estimated using the abcd model with no enkf by minimizing the mse during the calibration period water years 1972 1990 as described in a the initial ensemble of the two state variables s 0 1 n and g 0 1 n with n 100 ensemble members are generated for the first time step of validation period based on a normal distribution with mean and variance equal to the mean and 0 5 variance of the monthly climatological precipitation and streamflow of september respectively and stored into the state matrix x 0 2 n ii forecast step at any time step t an ensemble of perturbed forcing data is created around the observed forecasted value with variance equal to 0 5 variance of the forcings computed during the same month over the calibration period for each ensemble member i estimation of streamflow and prior model states q t i x t i are developed using eq 2 iii update step an ensemble of streamflow observations q t i is generated by slightly perturbing the streamflow observation at time t with a gaussian noise having variance equal to 0 5 variance of the observed streamflows during the same month over the calibration period our perturbation approach is adopted from burgers et al 1998 and the observational uncertainty is considered based on the stage discharge relationship herschy 1994 the covariance matrices t q and t q are then calculated using the estimated and observed streamflow ensembles respectively in addition we compute the cross covariance matrix between the prior state and estimated flow t x q using eq 3 next kalman gain is quantified by eq 4 which is a reshaped form of eq b 7 and finally model states are updated through eq 5 3 t x q x t i e x t i q t i e q t i t n 1 4 k t t x q t q t q 1 5 x t i x t i k t q t i q t i 4 results 4 1 abcd model performance for each river basin monthly streamflow simulations from the abcd model no data assimilation were evaluated over 20 years water years 1991 2010 in terms of r rmse eq 1 and pearson s correlation coefficient and the model performance is summarized during seasons presented in fig 2 results show that simulated flows during winter and fall seasons have the lowest errors and highest correlation across the seasons while the abcd model performs poorly during the summer season when almost half of the selected river basins show insignificant r rmse greater than one analyzing the model performance across the study area suggests that the abcd model has the lowest errors and highest correlation over higher latitudes of the west coast and regions of the appalachian highlands in the southeast however the model performance is poor for those basins located in central huc regions mostly classified as arid or semi arid basins with flat terrain characteristic and low runoff to rainfall ratio fig 1 correlation maps in fig 2 indicate significant correlation in predicting observed flows throughout the year over approximately 91 of the selected hcdn stations across the conus this shows the remarkable ability of the abcd model in simulating the variability of streamflows during all the seasons for rainfall dominated river basins notably over southeast and west coast our findings on the skill in streamflow predictions using a monthly water balance model are in line with the results of martinez and gupta 2010 and hay and mccabe 2002 studies in which the performance of a conceptual water balance model is evaluated over the conus 4 2 role of enkf in improving abcd model performance based on the enkf methodology described earlier abcd model state variables including soil moisture storage and groundwater storage were updated by assimilating available streamflow observations prior to the model iteration r rmse of the abcd model simulations fig 2 are then compared to the performance of the abcd model coupled with the enkf framework abcd enkf during the validation period and the seasonal assessment of the enkf impact on the performance of the abcd model is computed in terms of differences in r rmse metric shown in fig 3 the enkf is implemented using ensemble size n 100 and the r rmse of the abcd enkf is computed based on the ensemble mean of the simulations from this figure we infer that enkf is able to improve the accuracy in simulating monthly flows throughout the year for almost 80 of the river basins this overall improvement in simulated errors is the highest during the summer season where the r rmse is reduced by 8 on average across the selected river basins the greatest positive impact of enkf is found over the river basins where the abcd model has lower skill in simulating streamflow i e r rmse 1 mostly located in southwest us even for those river basins located in southeast where the abcd model has overall good performance streamflow prediction accuracy is improved constantly throughout the year after implementing enkf data assimilation nevertheless in some cases the enkf does not result in improved simulations accordingly downgrades the modeling accuracy further analysis fig 4 of the effect of enkf on the performance of the model in simulating low and high flows monthly streamflow less than 10 th percentile and greater than 90 th percentile respectively according to monthly climatology of the streamflow observations reveals that enkf is constantly advantageous in enhancing the accuracy of low flow predictions as opposed to high flows the improvements in low flows after utilizing enkf 0 05 reduction in r rmse on average are strongest over river basins located in arid water resources regions with lower monthly runoff this emphasizes the importance of data assimilation using observed streamflow data for low flow condition which is critical for drought forecasting and management ahmadalipour et al 2017 in contrast we can not see such general improvement in the high flow simulations in which the river basins are in saturated conditions and updating the model initial conditions using precedent observed streamflow may not have effective control on the simulation skill furthermore in such extreme events divergence in the enkf is likely to happen because of strong nonlinearities in the model thus overfitting the state updates dechant and moradkhani 2012 mcphillips et al 2018 4 3 enkf impact on streamflow forecasting the main focus of this study is to explore the potential benefits of data assimilation using observed streamflow in the context of enhancing operational hydrologic forecasting to develop 1 month ahead streamflow forecasts spatially downscaled precipitation forecasts from echam4 5 gcm were forced into the abcd model with calibrated parameters for the validation period as we infer from fig 5 most of the stations exhibit poor forecasting skill in terms of r rmse as well as correlation coefficient comparison between skill in 1 month ahead streamflow forecasts and streamflow simulations fig 2 unfolds that the main source of error in the forecasted streamflow is the imprecise precipitation forcing this is expected in a rainfall dominated river basin where the errors in precipitation forecasts dominate the errors in initial hydrologic conditions thereby determining the streamflow forecasting skill sinha and sankarasubramanian 2013 at the same time the forcing error propagates into model state variables when the model integrates forward in time which can be adjusted by data assimilation following this 1 month ahead precipitation forecasts are applied to the abcd model with enkf and the performance is compared to 1 month ahead forecasts from the abcd model itself in order to quantify the role of enkf application in monthly streamflow forecasting fig 6 displays the differences in terms of r rmse metric and correlation coefficient of streamflow forecasts with and without enkf implementation this figure clearly emphasizes the ability of da using streamflow observations in improving the skill of streamflow forecasting for rainfall dominated river basins especially in boosting correlation coefficients after updating model initial conditions based on enkf the r rmse of forecasts improves by 0 07 on average over almost 90 of the selected river basins and the correlation coefficient is increased by 0 18 on average for 95 of the basins nevertheless a few number of basins from the central water resources regions are negatively affected by enkf application mostly during winter and spring seasons these basins are located in lower elevations have smaller drainage area and lower percentage of storage i e less number of lakes ponds and swamps in the drainage area note that this figure presents the changes in the verification metrics and in order to determine the basins with significant skill in forecasting it should be compared with fig 5 5 summary and discussion this paper has investigated the utility of ensemble kalman filter enkf in updating abcd water balance model initial conditions in order to improve monthly streamflow forecasts totally 340 rainfall dominated river basins across the contiguous u s conus were selected for this analysis enkf was fed with monthly streamflow observations acquired from the hcdn dataset to update soil moisture and groundwater storage s t and g t the two state variables of the abcd lump model observed meteorological forcings during the water years 1971 2010 were used to execute the abcd model with without enkf data assimilation under a simulation scheme while the first 19 years of data 1971 1990 were considered for estimating model parameters and the rest 20 years 1991 2010 for validation purposes furthermore 1 month ahead precipitation forecasts from echam4 5 gcm were spatially downscaled to basin level and then forced into the abcd model in order to assess the model performance under a practical forecasting scheme it is important to note that by using a lumped watershed model we eliminated the need of temporal disaggregation of climate forecasts which have been shown to add significant error in seasonal streamflow forecasting mazrooei et al 2015 a quantitative comparison between the skill of 1 month ahead streamflow forecasts from abcd model and the forecasts from abcd enkf model was conducted and argued in terms of relative root mean square error r rmse and correlation coefficient cc findings from this study show that monthly streamflow simulations from abcd model have an acceptable to good overall performance particularly during wet seasons and over river basins with higher runoff to rainfall ratio mostly located in the southeast and west coast almost 90 of the river basins exhibit a significant correlation coefficient between observed and simulated streamflows during the validation period further application of enkf in abcd model is successful in reducing the r rmse of monthly simulations over at least 80 of the selected river basins the greatest improvement in simulated errors happens in summer season during which r rmse decreases by 0 08 on average over 89 of the basins evaluation of the monthly streamflow forecasts developed without the application of enkf shows limited skill which primarily arises from inaccurate precipitation forcings where on average only 6 of the river basins showing significant correlation and 52 of the basins having r rmse larger than one it is important to note that even without application of enkf the initial watershed conditions were updated from model simulations using observed forcings prior to forecasting however after the application of enkf and continuous correction of the model state variables the percentage of river basins with significant skill in streamflow forecasting increases substantially where on average 49 and 73 of the basins exhibit significant cc during spring and summer seasons respectively furthermore enkf improves the accuracy of streamflow forecasts by 7 reduction in r rmse on average over approximately 90 of the selected river basins this shows that correcting initial land surface conditions using observed streamflow based through enkf da improves the monthly streamflow forecasts developed using climate forecasts over rainfall runoff regimes additional analyses on the low high monthly flow simulations also reveal that our da approach is more effective in reducing errors in simulated low monthly flows compared to high monthly flows this finding is in line with aubert et al 2003 who concluded that assimilation of streamflow observations improves low flow simulations but to enhance high flow simulations assimilation of soil moisture observations is more effective we identified that after implementing enkf under simulation scheme error reduction i e r rmse in simulated flows is quite significant as opposed to the improvements in capturing the observed streamflow variability i e correlation this predominantly arises from the reduction of model bias in simulating observed streamflow as a result of the corrected initial conditions moreover the quantified improvements in the forecasting skill is important as it significantly improves the model accuracy and the correlation coefficient thus da implementation using gauge measured flows would be of interest to operational forecasting community several recommendations can be considered for future work based on this study the data assimilation experimental setup used in this study could also be applied to snow dominated catchments hence the conceptual water balance model should be augmented with a temperature index method or a more detailed energy based snow ablation model in addition in such river basins because the initial conditions of snow pack play a more dominant role in determining the hydrologic modeling skill assimilation of point measured streamflow observations may not necessarily improve the simulated streamflow products so continuous updates of swe using snow pack observations may be needed to improve streamflow forecasts sun et al 2004 clark et al 2006 huang et al 2017 our enkf methodology uses a fixed value of input error variance and observational error while these parameters can vary either in temporal or spatial dimension hence based on the basin s location and characteristics further assessment can be done on tuning these parameters within da moradkhani et al 2005 mazrooei 2017 according to aubert et al 2003 coupled assimilation of both streamflow and soil moisture observations into conceptual models results in improved streamflow predictions while the lack of a comprehensive dataset of soil moisture records is still a barrier this analysis shows that the gauge measured streamflow observations could be used in hydrologic da for promising correction of model states using a conceptual water balance model also alleviates the requirement of distributed soil moisture observations thus for better monthly streamflow forecasting at specific stream gauges conceptual watershed model with updated initial states through assimilation of observed streamflow could help in improving the skill although it heavily depends on the skill of precipitation forecasts even though this study used ordinary least squares for model calibration which assumes normality of residuals one could use other objective functions e g heteroscedastic maximum likelihood approach for better model calibration we analyzed the dependency between the skewness of model residuals during calibration period and r rmse after enkf implementation during validation period for all the basins and did not find a significant relationship between them figure not shown this is quite possible as model calibration is expected to improve the overall fit of the model whereas enkf improves model performance by correcting the model s state at every time step hence the information added to correct initial states is expected to carry more information as opposed to finding a better parameter set the focus of this study was on monthly streamflow forecasting yet the analysis could be applied using a hydrologic model at daily or sub daily time steps to implement this temporal disaggregation approaches should be employed for developing daily climate forcings from monthly gcm forecasts however it is shown that temporal disaggregation is the dominant source of errors in the modeling chain compared to spatial downscaling or model uncertainty mazrooei et al 2015 moreover updating state conditions at finer time scales should also depend on the basin characteristics such as basin scale time of concentration and the time lag between the upstream state conditions and observations at outlet pauwels and de lannoy 2006 given this sub monthly hydrologic forecasting can still benefit from data assimilation at finer time steps using observed streamflow which should help in seamless development of multi timescale streamflow forecasts declaration of competing interest none declared acknowledgments this work was supported by national science foundation grants cbet 0954405 cbet 1204368 and ccf 1442909 we would also like to thank the anonymous reviewers whose comments and suggestions helped us in improving the manuscript appendix a abcd model description the abcd model has four parameters a b c and d each has a specific physical interpretation which is described in table 1 during each monthly simulation two internal variables termed as available water wt and evapotranspiration opportunity yt are defined and estimated using precipitation and evapotranspiration forcings along with estimation of soil moisture storage state variable from prior time step based on following equations a 1 w t p t s t 1 a 2 y t e t s t where p t and e t represent the precipitation and actual evapotranspiration at timestep t s t 1 and s t denotes the soil moisture storage at the beginning and the end of period t respectively y t is postulated as a nonlinear function of w t eq a 3 a 3 y t w t w t b 2 a w t b 2 a 2 w t b a evapotranspiration opportunity y t is further partitioned into actual evapotranspiration e t and fraction of soil moisture storage s t by relating the rate of soil moisture loss to potential evapotranspiration eq a 4 a 4 e t y t 1 exp pe t b water available for runoff w t y t is then separated into upper zone contribution to runoff direct runoff 1 c w t y t and recharge to groundwater c w t y t by the parameter c groundwater recharge is added to the lower soil zone state variable g t 1 in order to compute the groundwater storage g t at the end of period t finally groundwater discharge to the stream channel is modeled according to the linear relationship d g t where d is the fourth parameter defining the groundwater average residence time based on continuity g t is updated using eq a 5 and the total streamflow is computed based on eq a 6 a 5 g t g t 1 c w t y t d g t a 6 q t 1 c w t y t d g t the data in the calibration period water years 1972 1990 were used to find the optimum values of the model parameters through trust region reflective least squares optimization algorithm that minimizes the mean square errors mse between model simulations and the observations considering the parameter constraints listed in table 1 further analyses on the model bias during calibration period are provided as the supplementary materials appendix b ensemble kalman filter enkf according to the general framework of enkf evensen 2003 the nonlinear function f estimates prior ensemble states x t i at time t based on updated posterior state from previous timestep x t 1 i model parameters θ and ensemble of forcing data u t i eqs b 1 and b 2 the function h relates the current model state ensemble x t i to the observation ensemble y t i eq b 3 generated by adding the noise t i to the actual observation y t eq b 4 b 1 x t i f x t 1 i θ u t i b 2 u t i u t η t i η t i n 0 t u b 3 y t i h x t i θ b 4 y t i y t t i t i n 0 t y where i denotes the i th ensemble member i 1 n η t i is the added noise to forcing data with covariance t u and t i is the noise added to the actual observations with predefined covariance t y for each timestep t when the observation becomes available the posterior model state ensemble can be computed based on a linear correction of the prior state ensemble b 5 x t i x t i k t y t i y t i where k t refers to the kalman gain matrix that corrects the model prediction depending on the accuracy of the observation and is quantified as b 6 k t t x h t h t x h t t y 1 where t x represents the prior state error covariance and can be estimated if the true state variables are known t x e x t x t true x t x t true t eq b 6 shows the standard form of kalman gain where the computation of t x is necessary in ensemble based approach enkf the kalman gain can be quantified as eq b 7 which is a modified version of the standard kalman gain eq b 6 evensen 2003 and the estimation of t x is not explicitly needed thereby making it easier to implement into systems with high nonlinear dynamics with relatively low computational complexity b 7 k t t x y t y t y 1 where t x y is the forecast cross covariance between the prior state variables x t i and the measurement prediction y t i and t y is the forecasts error covariance matrix of the measurement prediction y t i appendix c supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j jhydrol 2019 05 071 supplementary data the following are the supplementary data to this article supplementary data 1 
6374,among different sources of uncertainty in hydrologic modeling i e model structure parameter estimation input data etc consecutive error reduction of model initial conditions can prevent a model from drifting away from reality and consequently improving model estimates most approaches that evaluated the correction of initial conditions through data assimilation da have focused on improving hydrologic model simulations i e under observed forcings rather than evaluating the model performance in a forecasting context this paper investigates the utility of ensemble kalman filter enkf data assimilation in which available observed streamflow is exploited to update state variables of a conceptual water balance model for forecasting monthly streamflow over 340 rainfall dominated river basins across the contiguous united states conus our results demonstrate that after enkf application streamflow simulation skill improves in terms of both relative root mean square error r rmse and correlation coefficient cc for almost 90 of the selected river basins evaluating the model performance under different flow conditions shows that enkf has stronger positive effect on monthly low flow predictions comparing to monthly high flows particularly during the summer season the utility of enkf is also assessed in the context of 1 month ahead streamflow forecasting due to the updated model initial conditions streamflow forecasts are improved throughout the year even though the skill in hydrologic forecasts is predominantly dependent on the accuracy of precipitation forecasts keywords streamflow forecasting hydrologic data assimilation conceptual water balance model 1 introduction monthly to seasonal m2s streamflow forecasts derived using climate information are crucial for several fields such as agricultural studies climate change impacts groundwater assessment and developing proactive water management strategies sankarasubramanian et al 2009 vörösmarty et al 2000 najafi et al 2018 but developing skillful m2s streamflow forecasts significantly varies between rainfall dominated and snow dominated hydrological regimes koster et al 2010 the skill of m2s streamflow forecasting for snow dominated basins predominantly depends on the accuracy in estimating the initial snow water equivalent swe conditions for instance maurer et al 2004 showed that swe plays an important role in the skill of seasonal streamflow forecasts over the western us on the other hand for rainfall dominated basins utilizing precipitation forecasts from general circulation models gcm substantially improves the streamflow forecasting skill particularly during the winter season mazrooei et al 2015 sinha and sankarasubramanian 2013 the skill of m2s precipitation forecasts over the contiguous united states conus varies spatially and heavily depends on the exogenous climate conditions such as intensity of enso over the tropical pacific devineni et al 2008 goddard et al 2003 armal et al 2018 thus a realistic assessment of m2s streamflow forecasting skill over rainfall dominated basins needs to consider climate forecasts given the determining role of skillful climate forcing in hydrology one could consider additional strategies to reduce the uncertainty from other sources e g initial conditions inaccurate model parameters and structural deficiency of model and consequently improve the hydrologic model predictions moradkhani et al 2005 sinha et al 2014 for instance considerable effort has been made on improving the estimation of model parameters beven and binley 1992 vrugt et al 2003 due to high nonlinearity and complexity of the watershed dynamics errors in forcing data and equifinality of model parameters it is impossible to perfectly calibrate hydrologic models vrugt et al 2008 even if the models are well calibrated using manual automatic calibration the deficiency in the model structure results in a mismatch between the model products and observations ajami et al 2004 moradkhani et al 2005 li and sankarasubramanian 2012 moreover studies have argued the importance of preserving model parsimony for improving hydrologic predictions wolock and mccabe 1999 recent studies have also emphasized that a detailed representation of hydrologic processes in model building should be pursued depending on the time scale of interest in predicting hydrological fluxes sivapalan et al 2003 still there is an advantage in using a conceptual watershed model which is the relative simplicity and computational efficiency particularly for making predictions at monthly time scales singh and woolhiser 2002 martinez and gupta 2010 demonstrated that abcd model a simple lumped model is able to adequately simulate monthly streamflows across the conus further gcm climate forecasts are typically available at coarse spatio temporal resolutions and in order to match the resolutions of distributed land surface models lsms it is necessary to employ spatial downscaling and temporal disaggregation techniques both of these post processing of the climate forecasts in particular temporal disaggregation from monthly to daily time steps have been shown to arise errors in m2s streamflow forecasts sinha et al 2014 mazrooei et al 2015 hence a lumped watershed model has been applied for developing monthly streamflow forecasts uncertainty in model s initial conditions also plays an important role in determining the skill of hydrologic predictions studies have shown that forcing lsms just with climatological precipitation and temperature i e uninformed forecasts but updated with initial soil moisture conditions from model simulations using observed forcings provide critical information in forecasting seasonal streamflow over rainfall dominated basins mahanama et al 2012 sinha and sankarasubramanian 2013 found that updating initial soil moisture contents in a rainfall dominated basin provides improved m2s streamflow forecasts moreover correcting initial conditions by assimilating recently observed land surface conditions e g soil moisture swe streamflow further improves hydrologic predictions li et al 2016 moradkhani and sorooshian 2009 rüdiger et al 2006 abdi and yasi 2015 vrugt et al 2006 komma et al 2008 data assimilation da techniques were first introduced by meteorologists and have been applied to improve operational weather forecasting over the last few decades rabier 2005 reichle 2008 however application of da in hydrological studies started recently due to lack of suitable large domain long term observations of initial states along with the lack of proper quantification of the uncertainty in observations and hydrologic models liu et al 2012 in general da methods are divided into two types variational and sequential methods mclaughlin 2002 variational data assimilation is commonly used in numerical weather prediction whereas sequential data assimilation is applied in hydrological models since it is more suitable for distributed data sets mclaughlin 2002 seo et al 2003 bertino et al 2003 in rainfall dominated catchments assimilation of near surface soil moisture data improves the estimation of land surface fluxes thereby enhancing the streamflow predictions pauwels et al 2001 de lannoy et al 2007 reichle 2008 montzka et al 2011 alvarez garreton et al 2016 several studies also reported the advancements in operational short term hydrological forecasting with the aid of assimilation of streamflow records in distributed models vrugt et al 2006 rüdiger et al 2006 clark et al 2008 increasing availability of remotely sensed observations along with the need of real time hydrologic forecasting for water management applications has made da a focal point for assessing and implementing potential improvements in streamflow forecasting liu et al 2012 moradkhani et al 2004 the main challenge in assimilating land surface conditions e g soil moisture is primarily associated with the limited availability of continuous observed information in long term because the ground measurements of soil moisture content are hard and expensive to acquire especially over a large spatial domain most of the da studies tend to use remotely sensed data of such variables covering a large spatial domain however the remotely sensed information is available only from late 1990s and containing substantial measurement errors on the other hand assimilating gauge measured observed streamflow data is advantageous since it directly integrates the basin response having relatively small measurement error and the records are available for multiple decades across the conus hence observed streamflow data could be exploited in order to update the state variables of hydrologic models and respectively analyze the impacts on m2s streamflow forecasts over longer study periods pauwels and de lannoy 2006 aubert et al 2003 clark et al 2008 da in hydrological studies have been focused on improving both lumped and distributed models moradkhani and sorooshian 2009 while most of the above studies have applied da in a hydrologic simulation scheme i e under observed forcings there are limited studies evaluating improved m2s streamflow forecasts by using both climate forecasts and da the main intent of this study is to quantify and assess the potential improvements in the skill of practical m2s streamflow forecasts through correction of model s initial land surface conditions we consider abcd lumped watershed model and the correction in the model s initial state is achieved by assimilating previous month streamflow observations over rainfall dominated basins across the conus in another word we try to investigate the utility of ensemble kalman filter enkf data assimilation using observed streamflow data in improving m2s streamflow forecasts the manuscript is organized as follows we first present the hydroclimatic data set along with the details of the conceptual watershed model and the procedure for assimilating streamflow records through enkf within the water balance model then the performance of the hydrologic model is assessed with and without enkf application with observed forcings in simulating the observed streamflow following that the utility of enkf is evaluated in developing monthly streamflow forecasts using 1 month ahead climate forecasts from echam4 5 gcm finally the findings are summarized in the context of forcings and the role of corrected initial conditions in improving streamflow forecasts over rainfall runoff regime 2 hydroclimatic data and climate forecasts the temporal span of this study is a 39 water year period from 1971 to 2010 the first 19 years 1971 1990 are used to calibrate the hydrologic model see section 3 1 and the rest of the 20 years 1991 2010 for model validation purposes monthly time series of variables such as potential evapotranspiration pet streamflow observations q and forecasted and observed precipitation p were acquired from multiple sources that are explained next 2 1 streamflow data the streamflow observation data is obtained from the hydro climatic data network hcdn compiled by slack et al 1993 hcdn stations are stream gauges whose records are not influenced by anthropogenic activities such as upstream storage and groundwater pumping sankarasubramanian and vogel 2003 vogel and sankarasubramanian 2005 this dataset includes average daily monthly and annual records of streamflow over almost 1700 unique stations across the entire country for the past century however the start and end dates of the records are not same for all the stations and in some cases there are gaps in the length of the records therefore we limited our analyses to 340 stations that have continuous monthly time series of streamflow observations for the period of 1971 2010 fig 1 the selected river basins are classified as rainfall dominated basins in which the precipitation is the greatest contributor to the streamflow as opposed to snow dominated river basins where the snowpack ablation plays the most critical role in basin dynamics our approach for this classification is adapted based on the grouping described by martinez and gupta 2010 where they used predominant snow cover data from sturm et al 1995 along with modification of the snow versus no snow contour through visual inspection here all the hcdn basins inside the huc regions 3 6 8 11 12 13 and 15 were defined as rainfall dominated basins since they are located in the us sunbelt region south of the 37 n latitude with long summers and short and mild winters along with the river basins in huc 17 and 18 located in western coast 2 2 potential evapotranspiration data daily estimations of potential evapotranspiration pet over the period of 1971 2010 are obtained from penman monteith method generated by the variable infiltration capacity vic land surface model forced with observed meteorological data sinha et al 2014 vic model is a distributed model that has penman monteith method to estimate pet at 1 8 spatial resolution liang et al 1994 1996 in this study the 1 8 daily pet estimations were spatially averaged over the selected basins boundaries and aggregated to monthly values 2 3 precipitation observations and forecasts monthly time series of observed precipitation p over the period of 1971 2010 are obtained by taking the spatial average over each basin boundary using the maurer et al 2002 dataset these meteorological observations are available at 1 8 spatial resolution on a daily and monthly temporal scale for the conus derived by interpolating between observations from rain gauges across the country to develop a gridded observed meteorological dataset however interpolated data is likely to contain more errors under specific circumstances such as complex topographies low gauge density in a region and high seasonality of meteorological variables mazrooei 2014 monthly updated precipitation forecasts consisting of 24 ensemble members at 2 8 spatial resolution and at monthly timestep are obtained from echam4 5 general circulation model gcm accessible at international research institute of climate and society iri data library li and goddard 2005 these retrospective precipitation forecasts are then downscaled to 1 8 spatial resolution using a statistical downscaling approach based on principal component regression pcr for a given month for each 1 8 grid cell in the study area the ensemble mean of monthly precipitation forecasts from four nearest 2 8 neighboring grids are selected as predictors and the corresponding observed monthly precipitation of the finer grid cell is assigned as predictand then an adaptive pcr model is developed using the 25 years of data prior to the forecasting year as training period for example to obtain spatially downscaled forecast for a given 1 8 grid for january 1991 antecedent 25 years of january data i e from 1966 to 1990 serves as the training period since the coarse scale gridded precipitation forecasts have high spatial correlation with each other pcr is selected to build the statistical model between predictors and predictand pcr is capable of transforming the predictors in such a way that the inter correlation between predictors is minimized thus each of them has a unique valuable information mazrooei and sankarasubramanian 2017 a thorough assessment of the seasonal skill in the downscaled precipitation forecasts can be found in mazrooei et al 2015 3 methodology 3 1 abcd model the abcd model is a nonlinear physically based and lumped water balance model which accepts monthly precipitation p and potential evapotranspiration pet as inputs obtains soil moisture storage s and groundwater storage g as state variables and producing streamflow q as the output this model was first introduced by thomas 1981 and thomas et al 1983 as an adequate model in performing regional water resources assessment the abcd model was later compared with various monthly water balance models vandewiele et al 1992 the performance of the abcd model is evaluated by using 39 years of monthly data for calibration and validation purposes accordingly the dataset is divided into two parts i e the calibration period containing 19 years of data water year 1972 1990 and the validation period of 20 years water years 1991 2010 the data during the calibration period is used in an optimization framework with the objective of minimizing the errors between simulated and observed streamflows further description of the abcd model structure is provided in appendix a for each river basin the abcd model performance during the validation period was then evaluated using relative root mean square error r rmse for each month eq 1 1 r rmse m 1 n t 1 n q m t sim q m t obs 2 q m obs where m and t denote a specific month and year respectively q m t sim and q m t obs refer to the corresponding modeled and observed flows respectively and n is the total number of years in the evaluation period 20 years root mean square error rmse is a common used metric to indicate the accuracy in simulated forecasted flows hyndman and koehler 2006 however we considered r rmse since it is a normalized version of the rmse based on the climatology of the streamflow thus it allows us to compare the model performance across different months and also across the basins in addition to model precision for the purpose of measuring the strength of the model in predicting the variability of the observed flows pearson s correlation coefficient is also computed between streamflow simulations forecasts and observations also pearson s correlation is checked for statistical significance at 95 confidence level i e 1 96 n 3 where n denotes the length of the vector of data points used in calculating the correlation steel et al 1960 3 2 application of enkf to abcd model sequential data assimilation i e filtering ingests the up to date observed information into the model state variables in order to improve model initial conditions prior to next timestep kalman filter kf is a sequential filter introduced by kalman 1960 which is appropriate for models with linear dynamics while for non linear models extended kalman filter ekf is commonly employed reichle et al 2002 jazwinski 2007 however for large scale systems both methods are computationally demanding and ekf may produce instabilities and divergence if nonlinearities are strong miller et al 1994 reichle et al 2002 to overcome these limitations the ensemble kalman filter enkf was first introduced by evensen 1994 and later clarified by burgers et al 1998 enkf propagates the updated ensemble states from the previous timestep through a nonlinear model and computes the forecast state error covariance matrix afterwards consequently when observations are provided the state ensemble can be updated based on a statistical relationship between state covariance and observational error covariance moradkhani et al 2005 a description of the general enkf framework is presented in appendix b enkf can be employed in various hydrologic models here we denote the abcd model as a nonlinear system h θ x t 1 i u t i which requires the model parameter set θ a b c d table 1 ensemble of initial states x t 1 i s t 1 i g t 1 i consisting of two state variables soil moisture storage and groundwater storage and the ensemble of perturbed forcing data u t i p t i pe t i containing precipitation and potential evapotranspiration variables where i denotes the ensemble member the h model then estimates the prior state variables and ensemble of streamflow q t i at time t using eqs a 1 a 6 in the abcd model formulation 2 q t i x t i h θ x t 1 i u t i when the streamflow observation q t is available updated ensembles of soil moisture storage and groundwater storage at time t can be computed in order to be used in the next time step model integration enkf implementation in the abcd model is listed in three steps initialization forecast and update steps burgers et al 1998 reichle et al 2002 here we apply those steps in the context of the abcd model for streamflow forecasting for a given river basin described as follows i initialization model parameters are estimated using the abcd model with no enkf by minimizing the mse during the calibration period water years 1972 1990 as described in a the initial ensemble of the two state variables s 0 1 n and g 0 1 n with n 100 ensemble members are generated for the first time step of validation period based on a normal distribution with mean and variance equal to the mean and 0 5 variance of the monthly climatological precipitation and streamflow of september respectively and stored into the state matrix x 0 2 n ii forecast step at any time step t an ensemble of perturbed forcing data is created around the observed forecasted value with variance equal to 0 5 variance of the forcings computed during the same month over the calibration period for each ensemble member i estimation of streamflow and prior model states q t i x t i are developed using eq 2 iii update step an ensemble of streamflow observations q t i is generated by slightly perturbing the streamflow observation at time t with a gaussian noise having variance equal to 0 5 variance of the observed streamflows during the same month over the calibration period our perturbation approach is adopted from burgers et al 1998 and the observational uncertainty is considered based on the stage discharge relationship herschy 1994 the covariance matrices t q and t q are then calculated using the estimated and observed streamflow ensembles respectively in addition we compute the cross covariance matrix between the prior state and estimated flow t x q using eq 3 next kalman gain is quantified by eq 4 which is a reshaped form of eq b 7 and finally model states are updated through eq 5 3 t x q x t i e x t i q t i e q t i t n 1 4 k t t x q t q t q 1 5 x t i x t i k t q t i q t i 4 results 4 1 abcd model performance for each river basin monthly streamflow simulations from the abcd model no data assimilation were evaluated over 20 years water years 1991 2010 in terms of r rmse eq 1 and pearson s correlation coefficient and the model performance is summarized during seasons presented in fig 2 results show that simulated flows during winter and fall seasons have the lowest errors and highest correlation across the seasons while the abcd model performs poorly during the summer season when almost half of the selected river basins show insignificant r rmse greater than one analyzing the model performance across the study area suggests that the abcd model has the lowest errors and highest correlation over higher latitudes of the west coast and regions of the appalachian highlands in the southeast however the model performance is poor for those basins located in central huc regions mostly classified as arid or semi arid basins with flat terrain characteristic and low runoff to rainfall ratio fig 1 correlation maps in fig 2 indicate significant correlation in predicting observed flows throughout the year over approximately 91 of the selected hcdn stations across the conus this shows the remarkable ability of the abcd model in simulating the variability of streamflows during all the seasons for rainfall dominated river basins notably over southeast and west coast our findings on the skill in streamflow predictions using a monthly water balance model are in line with the results of martinez and gupta 2010 and hay and mccabe 2002 studies in which the performance of a conceptual water balance model is evaluated over the conus 4 2 role of enkf in improving abcd model performance based on the enkf methodology described earlier abcd model state variables including soil moisture storage and groundwater storage were updated by assimilating available streamflow observations prior to the model iteration r rmse of the abcd model simulations fig 2 are then compared to the performance of the abcd model coupled with the enkf framework abcd enkf during the validation period and the seasonal assessment of the enkf impact on the performance of the abcd model is computed in terms of differences in r rmse metric shown in fig 3 the enkf is implemented using ensemble size n 100 and the r rmse of the abcd enkf is computed based on the ensemble mean of the simulations from this figure we infer that enkf is able to improve the accuracy in simulating monthly flows throughout the year for almost 80 of the river basins this overall improvement in simulated errors is the highest during the summer season where the r rmse is reduced by 8 on average across the selected river basins the greatest positive impact of enkf is found over the river basins where the abcd model has lower skill in simulating streamflow i e r rmse 1 mostly located in southwest us even for those river basins located in southeast where the abcd model has overall good performance streamflow prediction accuracy is improved constantly throughout the year after implementing enkf data assimilation nevertheless in some cases the enkf does not result in improved simulations accordingly downgrades the modeling accuracy further analysis fig 4 of the effect of enkf on the performance of the model in simulating low and high flows monthly streamflow less than 10 th percentile and greater than 90 th percentile respectively according to monthly climatology of the streamflow observations reveals that enkf is constantly advantageous in enhancing the accuracy of low flow predictions as opposed to high flows the improvements in low flows after utilizing enkf 0 05 reduction in r rmse on average are strongest over river basins located in arid water resources regions with lower monthly runoff this emphasizes the importance of data assimilation using observed streamflow data for low flow condition which is critical for drought forecasting and management ahmadalipour et al 2017 in contrast we can not see such general improvement in the high flow simulations in which the river basins are in saturated conditions and updating the model initial conditions using precedent observed streamflow may not have effective control on the simulation skill furthermore in such extreme events divergence in the enkf is likely to happen because of strong nonlinearities in the model thus overfitting the state updates dechant and moradkhani 2012 mcphillips et al 2018 4 3 enkf impact on streamflow forecasting the main focus of this study is to explore the potential benefits of data assimilation using observed streamflow in the context of enhancing operational hydrologic forecasting to develop 1 month ahead streamflow forecasts spatially downscaled precipitation forecasts from echam4 5 gcm were forced into the abcd model with calibrated parameters for the validation period as we infer from fig 5 most of the stations exhibit poor forecasting skill in terms of r rmse as well as correlation coefficient comparison between skill in 1 month ahead streamflow forecasts and streamflow simulations fig 2 unfolds that the main source of error in the forecasted streamflow is the imprecise precipitation forcing this is expected in a rainfall dominated river basin where the errors in precipitation forecasts dominate the errors in initial hydrologic conditions thereby determining the streamflow forecasting skill sinha and sankarasubramanian 2013 at the same time the forcing error propagates into model state variables when the model integrates forward in time which can be adjusted by data assimilation following this 1 month ahead precipitation forecasts are applied to the abcd model with enkf and the performance is compared to 1 month ahead forecasts from the abcd model itself in order to quantify the role of enkf application in monthly streamflow forecasting fig 6 displays the differences in terms of r rmse metric and correlation coefficient of streamflow forecasts with and without enkf implementation this figure clearly emphasizes the ability of da using streamflow observations in improving the skill of streamflow forecasting for rainfall dominated river basins especially in boosting correlation coefficients after updating model initial conditions based on enkf the r rmse of forecasts improves by 0 07 on average over almost 90 of the selected river basins and the correlation coefficient is increased by 0 18 on average for 95 of the basins nevertheless a few number of basins from the central water resources regions are negatively affected by enkf application mostly during winter and spring seasons these basins are located in lower elevations have smaller drainage area and lower percentage of storage i e less number of lakes ponds and swamps in the drainage area note that this figure presents the changes in the verification metrics and in order to determine the basins with significant skill in forecasting it should be compared with fig 5 5 summary and discussion this paper has investigated the utility of ensemble kalman filter enkf in updating abcd water balance model initial conditions in order to improve monthly streamflow forecasts totally 340 rainfall dominated river basins across the contiguous u s conus were selected for this analysis enkf was fed with monthly streamflow observations acquired from the hcdn dataset to update soil moisture and groundwater storage s t and g t the two state variables of the abcd lump model observed meteorological forcings during the water years 1971 2010 were used to execute the abcd model with without enkf data assimilation under a simulation scheme while the first 19 years of data 1971 1990 were considered for estimating model parameters and the rest 20 years 1991 2010 for validation purposes furthermore 1 month ahead precipitation forecasts from echam4 5 gcm were spatially downscaled to basin level and then forced into the abcd model in order to assess the model performance under a practical forecasting scheme it is important to note that by using a lumped watershed model we eliminated the need of temporal disaggregation of climate forecasts which have been shown to add significant error in seasonal streamflow forecasting mazrooei et al 2015 a quantitative comparison between the skill of 1 month ahead streamflow forecasts from abcd model and the forecasts from abcd enkf model was conducted and argued in terms of relative root mean square error r rmse and correlation coefficient cc findings from this study show that monthly streamflow simulations from abcd model have an acceptable to good overall performance particularly during wet seasons and over river basins with higher runoff to rainfall ratio mostly located in the southeast and west coast almost 90 of the river basins exhibit a significant correlation coefficient between observed and simulated streamflows during the validation period further application of enkf in abcd model is successful in reducing the r rmse of monthly simulations over at least 80 of the selected river basins the greatest improvement in simulated errors happens in summer season during which r rmse decreases by 0 08 on average over 89 of the basins evaluation of the monthly streamflow forecasts developed without the application of enkf shows limited skill which primarily arises from inaccurate precipitation forcings where on average only 6 of the river basins showing significant correlation and 52 of the basins having r rmse larger than one it is important to note that even without application of enkf the initial watershed conditions were updated from model simulations using observed forcings prior to forecasting however after the application of enkf and continuous correction of the model state variables the percentage of river basins with significant skill in streamflow forecasting increases substantially where on average 49 and 73 of the basins exhibit significant cc during spring and summer seasons respectively furthermore enkf improves the accuracy of streamflow forecasts by 7 reduction in r rmse on average over approximately 90 of the selected river basins this shows that correcting initial land surface conditions using observed streamflow based through enkf da improves the monthly streamflow forecasts developed using climate forecasts over rainfall runoff regimes additional analyses on the low high monthly flow simulations also reveal that our da approach is more effective in reducing errors in simulated low monthly flows compared to high monthly flows this finding is in line with aubert et al 2003 who concluded that assimilation of streamflow observations improves low flow simulations but to enhance high flow simulations assimilation of soil moisture observations is more effective we identified that after implementing enkf under simulation scheme error reduction i e r rmse in simulated flows is quite significant as opposed to the improvements in capturing the observed streamflow variability i e correlation this predominantly arises from the reduction of model bias in simulating observed streamflow as a result of the corrected initial conditions moreover the quantified improvements in the forecasting skill is important as it significantly improves the model accuracy and the correlation coefficient thus da implementation using gauge measured flows would be of interest to operational forecasting community several recommendations can be considered for future work based on this study the data assimilation experimental setup used in this study could also be applied to snow dominated catchments hence the conceptual water balance model should be augmented with a temperature index method or a more detailed energy based snow ablation model in addition in such river basins because the initial conditions of snow pack play a more dominant role in determining the hydrologic modeling skill assimilation of point measured streamflow observations may not necessarily improve the simulated streamflow products so continuous updates of swe using snow pack observations may be needed to improve streamflow forecasts sun et al 2004 clark et al 2006 huang et al 2017 our enkf methodology uses a fixed value of input error variance and observational error while these parameters can vary either in temporal or spatial dimension hence based on the basin s location and characteristics further assessment can be done on tuning these parameters within da moradkhani et al 2005 mazrooei 2017 according to aubert et al 2003 coupled assimilation of both streamflow and soil moisture observations into conceptual models results in improved streamflow predictions while the lack of a comprehensive dataset of soil moisture records is still a barrier this analysis shows that the gauge measured streamflow observations could be used in hydrologic da for promising correction of model states using a conceptual water balance model also alleviates the requirement of distributed soil moisture observations thus for better monthly streamflow forecasting at specific stream gauges conceptual watershed model with updated initial states through assimilation of observed streamflow could help in improving the skill although it heavily depends on the skill of precipitation forecasts even though this study used ordinary least squares for model calibration which assumes normality of residuals one could use other objective functions e g heteroscedastic maximum likelihood approach for better model calibration we analyzed the dependency between the skewness of model residuals during calibration period and r rmse after enkf implementation during validation period for all the basins and did not find a significant relationship between them figure not shown this is quite possible as model calibration is expected to improve the overall fit of the model whereas enkf improves model performance by correcting the model s state at every time step hence the information added to correct initial states is expected to carry more information as opposed to finding a better parameter set the focus of this study was on monthly streamflow forecasting yet the analysis could be applied using a hydrologic model at daily or sub daily time steps to implement this temporal disaggregation approaches should be employed for developing daily climate forcings from monthly gcm forecasts however it is shown that temporal disaggregation is the dominant source of errors in the modeling chain compared to spatial downscaling or model uncertainty mazrooei et al 2015 moreover updating state conditions at finer time scales should also depend on the basin characteristics such as basin scale time of concentration and the time lag between the upstream state conditions and observations at outlet pauwels and de lannoy 2006 given this sub monthly hydrologic forecasting can still benefit from data assimilation at finer time steps using observed streamflow which should help in seamless development of multi timescale streamflow forecasts declaration of competing interest none declared acknowledgments this work was supported by national science foundation grants cbet 0954405 cbet 1204368 and ccf 1442909 we would also like to thank the anonymous reviewers whose comments and suggestions helped us in improving the manuscript appendix a abcd model description the abcd model has four parameters a b c and d each has a specific physical interpretation which is described in table 1 during each monthly simulation two internal variables termed as available water wt and evapotranspiration opportunity yt are defined and estimated using precipitation and evapotranspiration forcings along with estimation of soil moisture storage state variable from prior time step based on following equations a 1 w t p t s t 1 a 2 y t e t s t where p t and e t represent the precipitation and actual evapotranspiration at timestep t s t 1 and s t denotes the soil moisture storage at the beginning and the end of period t respectively y t is postulated as a nonlinear function of w t eq a 3 a 3 y t w t w t b 2 a w t b 2 a 2 w t b a evapotranspiration opportunity y t is further partitioned into actual evapotranspiration e t and fraction of soil moisture storage s t by relating the rate of soil moisture loss to potential evapotranspiration eq a 4 a 4 e t y t 1 exp pe t b water available for runoff w t y t is then separated into upper zone contribution to runoff direct runoff 1 c w t y t and recharge to groundwater c w t y t by the parameter c groundwater recharge is added to the lower soil zone state variable g t 1 in order to compute the groundwater storage g t at the end of period t finally groundwater discharge to the stream channel is modeled according to the linear relationship d g t where d is the fourth parameter defining the groundwater average residence time based on continuity g t is updated using eq a 5 and the total streamflow is computed based on eq a 6 a 5 g t g t 1 c w t y t d g t a 6 q t 1 c w t y t d g t the data in the calibration period water years 1972 1990 were used to find the optimum values of the model parameters through trust region reflective least squares optimization algorithm that minimizes the mean square errors mse between model simulations and the observations considering the parameter constraints listed in table 1 further analyses on the model bias during calibration period are provided as the supplementary materials appendix b ensemble kalman filter enkf according to the general framework of enkf evensen 2003 the nonlinear function f estimates prior ensemble states x t i at time t based on updated posterior state from previous timestep x t 1 i model parameters θ and ensemble of forcing data u t i eqs b 1 and b 2 the function h relates the current model state ensemble x t i to the observation ensemble y t i eq b 3 generated by adding the noise t i to the actual observation y t eq b 4 b 1 x t i f x t 1 i θ u t i b 2 u t i u t η t i η t i n 0 t u b 3 y t i h x t i θ b 4 y t i y t t i t i n 0 t y where i denotes the i th ensemble member i 1 n η t i is the added noise to forcing data with covariance t u and t i is the noise added to the actual observations with predefined covariance t y for each timestep t when the observation becomes available the posterior model state ensemble can be computed based on a linear correction of the prior state ensemble b 5 x t i x t i k t y t i y t i where k t refers to the kalman gain matrix that corrects the model prediction depending on the accuracy of the observation and is quantified as b 6 k t t x h t h t x h t t y 1 where t x represents the prior state error covariance and can be estimated if the true state variables are known t x e x t x t true x t x t true t eq b 6 shows the standard form of kalman gain where the computation of t x is necessary in ensemble based approach enkf the kalman gain can be quantified as eq b 7 which is a modified version of the standard kalman gain eq b 6 evensen 2003 and the estimation of t x is not explicitly needed thereby making it easier to implement into systems with high nonlinear dynamics with relatively low computational complexity b 7 k t t x y t y t y 1 where t x y is the forecast cross covariance between the prior state variables x t i and the measurement prediction y t i and t y is the forecasts error covariance matrix of the measurement prediction y t i appendix c supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j jhydrol 2019 05 071 supplementary data the following are the supplementary data to this article supplementary data 1 
