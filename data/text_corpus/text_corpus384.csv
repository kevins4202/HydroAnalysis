index,text
1920,production of reactive oxygen species ros such as hydrogen peroxide h2o2 and hydroxyl radical oh has been increasingly discovered upon oxygenation of reduced species in anoxic soil and sediment pore waters we therefore hypothesize that h2o2 and oh can be produced during groundwater abstraction and discharging due to oxygenation to evaluate the capacities of h2o2 and oh accumulation during groundwater oxygenation here we measured h2o2 and oh accumulations during dark oxygenation of groundwater abstracted from different depths of 11 wells adjacent to the han river this abstraction could simulate the scenarios of groundwater abstraction by riverside pumping and also of groundwater discharging in hyporheic zones results showed that h2o2 and oh formed during oxygenation of the groundwater with low eh values 63 mv and only h2o2 3 37 μm formed for the groundwater with high eh values 63 206 5 mv statistical analysis indicated that dissolved fe ii was mainly accountable for the production of measurable oh in the low eh locations the aquifer conditions i e aquifer lithology and external environmental factors i e pumping disturbance within short term abstraction process had negligible influence on ros production the relationship between ros production and groundwater chemistry was further explored by multiple linear regression which deduced the quantitative models for estimating ros production upon oxygenation of groundwater from different sources with different chemistry using the abstracted groundwater in western bengal basin as an example the estimated results indicated that ros production had a great potential to oxidize the typical contaminant of as iii as ros particularly oh represents strong oxidants our findings implicate an overlooked oxidative capacity during groundwater abstraction and discharging in hyporheic zones or other areas which could lead to the oxidative transformation of substances and the oxidative stress of microbial metabolism and associated biogeochemical processes in the environments suffering from groundwater oxygenation this oxidative capacity is particularly important when the groundwater with low eh values i e under strongly reductive conditions were abstracted and oxygenated in the surface keywords groundwater abstraction groundwater discharging hyporheic zone hydrogen peroxide hydroxyl radicals oxidative capacity data availability data will be made available on request 1 introduction groundwater is the world s largest freshwater resource on the demand of irrigation industry and the municipality hanasaki et al 2018 scanlon et al 2023 globally total groundwater withdrawal was estimated to be 789 km3 yr hanasaki et al 2018 which means the abstraction of about 2 16 109 m3 groundwater per day groundwater abstraction and discharging are important forms of groundwater consumption scanlon et al 2023 wada et al 2014 which lead to the input of oxygen o2 to groundwater and or sink of redox sensitive elements i e fe c n in hyporheic zones bardini et al 2012 liu et al 2017 trauth and fleckenstein 2017 wallis et al 2020 previous works have pointed out that reduced species i e fe and organic matter can activate o2 to produce reactive oxygen species ros i e hydrogen peroxide h2o2 and hydroxyl radicals oh in waters from o2 perturbed aquifers page et al 2013 tong et al 2016 yuan et al 2017 zhang et al 2020 when the abstracted discharged groundwater is exposed to air above ground it is rationale to hypothesize ros production by the interaction of reduced species in groundwater and o2 in air ros in the environment are of considerable importance due to their extremely high reactivity in transforming elements and contaminants mopper and zhou 1990 gligorovski et al 2015 kim et al 2015 trusiak et al 2018 because of the strong oxidative ability of h2o2 and oh particularly the later mopper and zhou 1990 goldstone et al 2002 and massive groundwater abstraction discharging investigation of ros production and related oxidative capacity during abstraction discharging is essential for implicating an underlying pathway for contaminant and element transformation which has not been well recognized because of the transient nature of ros it is a challenge to directly measure their production capacity in subsurface environment the studies over the past decade have discovered the formation of ros in waters from o2 perturbed aquifers dias et al 2016 page et al 2013 tong et al 2016 trusiak et al 2018 yuan et al 2017 zhang et al 2020 in these studies the samples came from arctic soil page et al 2013 trusiak et al 2018 redox fluctuated aquifers tong et al 2016 salt marsh systems dias et al 2016 and floodplain aquifers yuan et al 2017 zhang et al 2020 as summarized in table s1 the depths of the sample ranged from tens of centimeters to several meters however the depth of groundwater abstraction discharging varies largely depending on the aquifer conditions and engineering types scanlon et al 2023 for example groundwater is oftentimes abstracted from confined aquifers de graaf et al 2017 mukherjee et al 2011 which is normally under reductive conditions whereas for the groundwater abstraction by riverside pumping or discharging in hyporheic zones the groundwater chemistry particularly the redox chemistry varies at different time and different locations wallis et al 2020 besides the aquifer lithology is potential to influence the distribution of dissolved components and the permeability of the aquifer which impacts the immobilization capacity of redox species from floodplain sediments zhang et al 2020 and the magnitude of groundwater discharge luijendijk et al 2020 as for sampling and ros analysis in these reports table s1 groundwater abstraction was only applied in the floodplain aquifers for measuring steady state h2o2 concentrations yuan et al 2017 zhang et al 2020 the above studies document the existence of ros in natural subsurface environments however the influence of aquifer conditions in hyporheic zones i e depth and lithology and external environmental factors i e pumping disturbance on the generation of different types of ros during groundwater abstraction discharging is not clear further in these o2 perturbed aquifers both h2o2 and oh generation have been attributed to aphotic and abiotic mechanisms the production has been mainly attributed to the fenton or fenton like processes in which reduced species in subsurface donate electrons to o2 with sequential generation of superoxide o2 h2o2 and oh king et al 1995 gligorovski et al 2015 page et al 2013 tong et al 2016 yuan et al 2017 trusiak et al 2018 among the reduced species fe ii and organic matter are proposed to be the main contributors page et al 2013 tong et al 2016 zhang et al 2020 zhang et al 2022 for example cory s group showed the different dependences of oh production on dissolved fe ii and dissolved organic matter dom concentrations during oxygenation of soil water samples page et al 2013 trusiak et al 2018 yuan et al 2017 also considered reduced elements particularly fe ii and organic matters as the contributing species for the occurrence of steady state h2o2 in hyporheic zones our recent work has pointed out that anoxic biogeochemical process may regenerate the reduced species i e fe ii and reduced organic matters in hyporheic zones which fuels a sustainable h2o2 production in the aquifer during groundwater table fluctuations zhang et al 2020 for the relationship between h2o2 and oh production our recent work has discovered that the composition of fe ii and reduced organic matters that is c fe ratio could lead to various yield of oh relative to h2o2 zhang et al 2022 which means the difference of oxidative capacity due to ros production with different groundwater chemistry because groundwater abstraction discharging carries various compositions of dissolved substances it is of significance to comprehensively evaluate the dependence of the capacities of h2o2 and oh production on groundwater chemistry to our knowledge the influence of aquifer conditions and groundwater chemistry on h2o2 and oh production during groundwater abstraction discharging have not been well investigated filling this knowledge gap will benefit the accurate evaluation of oxidizing impact caused by groundwater abstraction discharging the objectives of this study are therefore 1 to evaluate the capacity of ros h2o2 and oh production upon oxygenation of groundwater under different aquifer conditions and 2 to identify the dependence of h2o2 and oh production capacities on groundwater chemistry to meet the goals we carried out groundwater abstraction in a hyporheic zone in a floodplain adjacent to han river we simultaneously measured the cumulative h2o2 and oh production upon dark oxygenation of groundwater abstracted from 11 wells at different points with different depths in aquifer we also analyzed each sample for eh the number of electrons released dissolved fe ii dissolved organic carbon doc and other groundwater chemistry we further performed correlation analysis to link h2o2 and oh accumulations with groundwater chemistry we finally evaluated the oxidative capacity due to ros production during groundwater abstraction discharging 2 materials and methods 2 1 chemicals 10 acetyl 3 7 dihydroxyphenoxazine adhp was purchased from beijing solarbio science technology co ltd china coumarin cou 99 and 7 hydroxycoumarin 7 hcou 98 were obtained from aladdin horseradish peroxidase hrp 300 units mg and diammonium 2 2 azino bis 3 ethylbenzothiazoline 6 sulfonate abts diammonium salt 98 were obtained from shanghai yuanye bio technology co ltd china catalase cat from bovine liver 2000 5000 units mg protein was obtained from sigma hydrogen peroxide aqueous solution h2o2 30 potassium persulfate k2s2o8 99 and other analytical grade chemicals were purchased from sinopharm chemical reagent co ltd china all solutions were prepared using deionized water 18 2 mω cm which was from a heal force nw ultrapure water system to prepare solutions containing dissolved abts equal volumes of 3 6 mm abts and 1 4 mm k2s2o8 were mixed for 12 h in an anaerobic glovebox coy usa filled with 92 n2 and 8 h2 in the dark page et al 2013 before field measurement 3 ml of abts solution was filled in each of 5 ml serum bottles in the glovebox the serum bottles were firstly capped with thick butyl rubber stoppers and aluminum caps and then were sealed in 2 layered plastic bags under vacuum to minimize o2 in the bottles these serum bottles were transported in the dark at 4 and stored for 72 h before usage all other reagents were of analytical grade 2 2 sampling area the sampling area was a hyporheic zone in a floodplain belongs to jianghan plain adjacent to the middle of a meander in the lower reaches of han river in duobao town tianmen city central china 112 68 e 30 58 n fig 1 a han river is the largest branch of the yangtze river and the average annual temperature of sampling area is 12 16 liu et al 2016 we chose one aquifer profile perpendicular to the river flow to collect groundwater samples from nov 13 to nov 16 2019 fig 1a according to our recent publication lu et al 2022 the general aquifer lithology of the area is clay and sand layers the river and groundwater levels in the duration of sampling were monitored to be 8 2 9 2 m which was presented as absolute elevation values and the river water level was lower than the groundwater level thus the groundwater discharging dominates the flow direction from aquifer to river in the sampling area our measurement did not include groundwater discharging process which requires groundwater pumping from deeper confined aquifers or surface water withdrawals de graaf et al 2019 scanlon et al 2023 2 3 field sampling the sampling locations were set in the vertical profiles along the riverbank in the hyporheic zone the distances for 4 locations l1 l4 to the river were 12 162 65 266 94 and 397 54 m respectively fig 1b a total of 11 sampling wells with different depths and relatively wide depth interval 2 m were drilled at the 4 locations to make a representative assessment on oh and h2o2 production fig 1b at one location the distance between the wells at different depths was 3 5 m to avoid groundwater mixing caused by sampling in detail the depths of wells in l1 were 2 7 m w1 4 7 m w2 and 6 7 m w3 in l2 were 7 7 m w4 and 9 7 m w5 in l3 were 5 8 m w6 7 8 m w7 and 9 8 m w8 and in l4 were 6 7 m w9 8 7 m w10 and 10 7 m w11 all the depth values were relative to the ground surface the bottom 30 cm of each well was perforated and wrapped with gauze for groundwater flow before sampling 4 18 l of groundwater 3 folds of the pipe volume was slowly pumped out at 0 5 l min by peristaltic sampling pump geopump geotech usa to a gastight and flow through chamber to minimize contact with air and different probes were installed in the chamber for groundwater chemistry measurement stabilization of groundwater chemistry was judged by the stabilization of dissolved oxygen do concentration which was in situ measured by a do meter jpb 607a leici china then groundwater was pumped at near 50 ml min and the do redox potential eh solution ph temperature and electric conductivity ec were measured by the probes in gastight chamber groundwater samples were collected and filtered through a 0 45 μm membrane into 50 ml serum bottles which were rinsed at least three times with the groundwater sample during groundwater collection the concentration of do in the pumped out groundwater was stable and below 0 1 mg l in order to prevent oxidation of reduced species in the samples the serum bottle was continuously filled with abstracted groundwater for at least 5 min to fully replace the air in the bottle the serum bottles were then rapidly capped with thick butyl rubber stoppers and aluminum caps and were sealed in plastic bags under vacuum the groundwater samples in one well were collected in four 50 ml serum bottles for different analyses the first one was used for measuring the concentrations of dissolved fe ii total mn co3 2 and hco3 and the number of electron released the second one was for analyses of h2o2 and oh accumulations the third one was acidified with 1 m hcl for doc analysis in lab and the last one was frozen by dry ice during transport for other cations and anions measurement in lab 2 4 groundwater analysis the measurements of h2o2 and oh accumulation and redox chemistry i e electrons released during oxygenation dissolved fe ii concentration were completed in the field by determining the fluorescence or absorbance of sample after coloration this on site analysis avoids potential changes on the redox properties of sample due to long term storage and transportation back to the lab the details for groundwater analysis were described as below cumulative h2o2 we exposed groundwater to o2 and quantified cumulative h2o2 production based on the hrp catalyzed oxidation of adhp to highly fluorescent resorufin by h2o2 zhou et al 1997 due to the reactions between h2o2 and reduced species i e fe ii and dissolved organic matter as well as the competition between adhp and reduced species for the hrp catalyzed h2o2 reaction wang et al 2017 the final concentration of adhp reacted with sample was set to be sufficient 10 μm the groundwater sample in the serum bottle was withdrawn by syringe about 20 ml of 0 45 μm filtered groundwater was injected into either 1 5 ml of hrp final concentration 20 mg l and adhp mixed solution or 1 5 ml of cat final concentration 10 mg l and adhp mixed solution in a 25 ml serum bottle in order to ensure oxygenation the samples in 25 ml serum bottles were exposed to air in the dark for about 6 7 h then the fluorescence was measured at an excitation wavelength of 571 nm and an emission wavelength of 585 nm by a fluorescence spectrophotometer f96pro lengguang china the cumulative h2o2 concentrations were determined by applying the calibration factors to the blank fluorescence intensities calibration factor was obtained by preparing a series of standard h2o2 solutions before sample analysis in order to eliminate the potential interference from background solution on calibration factor the final mixture for standard solution in the cuvette 4 ml contained 10 μm adhp 20 mg l hrp 0 45 μm filtered oxidized groundwater treated with adhp and cat from each well and a desired concentration of h2o2 the above mixtures without addition of h2o2 were used as the blanks all the above experiments were carried out in duplicate the detection limit of h2o2 was 58 nm cumulative oh similarly we exposed groundwater to o2 and quantified cumulative oh production by the reaction with the added probe of cou as described previously setsukinai et al 2000 louit et al 2005 han et al 2019 oh reacts with cou at 1 0 145 stoichiometry to yield 7 hcou tokumura et al 2011 about 20 ml of 0 45 μm filtered groundwater was injected into 1 5 ml of cou final concentration 2 mm cou in a 25 ml serum bottle the process of oxygenation was the same as that for h2o2 analysis the sample fluorescence was measured at an excitation wavelength of 350 nm and an emission wavelength of 460 nm calibration factor was obtained by preparing a series of standard 7 hcou solutions before sample analysis the potential interference from background solution was eliminated by mixing 2 mm cou 0 45 μm filtered oxidized groundwater untreated with cou from each well and a desired concentration of 7 hcou the above mixtures without addition of 7 hcou were used as the blanks all the above experiments were carried out in duplicate the detection limit of oh was 88 nm electrons released during oxygenation abts was employed to quantify the number of electrons released during oxygenation chin et al 1998 page et al 2013 the electron donating capacity edc of sample was equal to the consumption of abts which was detected by one electron transfer between abts and abts aeschbacher et al 2012 the difference in edc before and after oxygenation was calculated and used as the number of electrons released for the measurement of the number of electrons released during groundwater oxygenation 50 μl of samples before and after air exposure were mixed with 1 ml of anoxic abts solution the mixed solutions were kept in the sealed serum bottles under the dark condition for 20 min so that abts accepted one electron to form abts meanwhile 50 μl of anoxic deionized water which had been purged with n2 99 999 for 30 min to remove do was added into another 1 ml of anoxic abts solution as the blank the absorbances of the samples and blank were measured at 734 nm by a portable spectrophotometer dr1900 hach usa groundwater chemistry the eh vs standard hydrogen ph temperature and ec values were measured using a portable meter hq40d field case hach usa the dissolved fe ii concentration was measured within 5 min in site after coloration with 1 10 phenanthroline by the portable spectrophotometer total mn was determined in site by potassium periodate photometry the sum of co3 2 and hco3 was determined by titrating the samples with standard hcl solution doc was determined by a toc analyzer shimadzu toc l cph japan cations and anions were determined by an ion chromatography metrohm 925 switzerland 2 5 evaluation of ros production capacity during groundwater abstraction redundancy analysis rda can evaluate the relationship between a set of variables and other multivariate data zhang et al 2014 the accumulations of h2o2 and oh were set as response variables and the groundwater chemistry such as eh the number of electron released initial concentrations of dissolved fe ii and doc and c fe ii molar ratio were set as explaining variables before rda detrended correspondence analysis dca was performed to determine if the data sets were suitable for rda if the gradient lengths of the 4 axes calculated from dca are 3 then rda was applicable besides the significance of correlations between h2o2 and oh accumulations with different groundwater chemistry were analyzed through pearson correlation by using spss software to quantify the relationship between the capacity of ros production and groundwater chemistry stepwise multiple linear regression analysis was applied by using spss y1 and y2 were the dependent variables representing h2o2 and oh accumulations respectively the potential impact factors obtained by redundancy analysis were set as a series of independent variables x1 xn table s2 the data for dependent variables and independent variables were collected from the groundwater chemistry in table 1 in this study and the average values for arctic soil water or sediment pore water samples from previous studies table s2 page et al 2013 tong et al 2016 trusiak et al 2018 the model is specified as follows 1 y n b 0 b 1 x 1 b 2 x 2 b n x n where yn represent y1 or y2 b0 is the intercept b1 b2 bn are the respective coefficients of independent variables x1 x2 xn based on the aquation 1 obtained by stepwise multiple linear regression we further employed the groundwater chemistry from the groundwater samples reported for western bengal basin mukherjee and fryar 2008 to estimate the capacities of h2o2 and oh production during groundwater abstraction the data for groundwater chemistry were collected from 53 well locations in that study and the average concentrations were used as the values of different independent variables for calculation 3 results and discussion 3 1 capacity of h2o2 production upon groundwater oxygenation the hyporheic zone as shown in fig 1 is adjacent to the han river and the sediments are mainly sandy in the site during the field measurement period the river water levels were around 8 2 m lower than the groundwater table fig 1b we simultaneously measured the cumulative h2o2 and oh concentrations from 6 to 7 h oxygenation of all the abstracted groundwater samples n 11 the cumulative h2o2 concentrations ranged from 0 34 to 7 93 μm with an average of 4 77 2 82 μm fig 2 a table 1 and table 2 which were all significantly above the detection limit 58 nm fig 2a clearly demonstrates that the cumulative h2o2 concentration generally increased with the depths of wells in each location expect location 3 w6 w8 in location 3 the highest cumulative h2o2 concentration was in the depth of 7 8 m w7 rather than 9 8 m w9 fig 2a the concentrations of do in the samples before oxygenation were all around 0 mg l table 2 which reflects the anoxic conditions the eh value varied in different wells but ranged from 2 5 to 206 5 mv fig 2c it is worth noting that less h2o2 was produced from the samples abstracted w1 w4 w6 and w9 with higher eh values 63 206 5 mv and more h2o2 was produced with lower eh values 25 mv fig 2a and c the linear relationship between the vertical h2o2 accumulation and the eh distribution was analyzed fig 3 a the sample from w1 in location 1 was regarded as an outlier blue dot in fig 3a in general the negative correlation between h2o2 accumulation and eh distribution was insignificant slope 0 06 r2 0 712 p 0 057 0 05 fig 3a 3 2 capacity of oh production upon groundwater oxygenation for the capacity of oh production upon abstracted groundwater oxygenation the cumulative oh ranged from lower than the detection limit 88 nm to 1 72 μm with an average of 0 53 0 60 μm fig 2b table 1 and table 2 regarding the vertical distribution at one location the cumulative concentration of oh increased with the depth of wells only in locations 2 and 4 and was around the detection limit in the sample from the shallow well in each location w1 w4 w6 and w9 in fig 2b h2o2 is often considered as a precursor of oh in the environment rose and waite 2002 page et al 2012 miller et al 2013 compared with closed peak concentration of cumulative h2o2 from location 1 to 3 the peak concentration of cumulative oh increased from location 1 to 3 fig 2a and b suggesting the difference of spatial distribution of h2o2 and oh production it is interesting to discover that the eh of around 63 mv was noted to be the boundary for oh production or not below which oh production was significant fig 2 and table 2 similar boundary of eh was also observed for h2o2 production but the difference is that h2o2 could be still produced at eh higher than 63 mv fig 2 and table 2 besides the significantly negative correlation of oh accumulation with eh distribution slope 0 011 r2 0 471 p 0 016 0 05 fig 3b reflects the stronger impact of eh in oh production than in h2o2 production in summary different capacities of h2o2 and oh production distributed in vertical and horizontal space of the aquifer were influenced by eh distribution and thus the role of variation of electron source in groundwater and spatial characters of aquifer on ros production needs to be further evaluated 3 3 influence of groundwater chemistry on ros production it is known that eh values rely on the concentrations of redox sensitive groundwater constituents rodríguez escales et al 2020 in order to evaluate the overall influence of reduced species on ros production the electrons released during oxygenation were quantified as shown in table 1 the average number of electrons released upon oxygenation was 92 8 54 2 μm the number of electrons released upon oxygenation increased with the depths of wells only in locations 2 and 4 and was the highest in the abstracted sample from w2 and w7 in locations 1 and 3 respectively fig s1a the electrons released was in significantly positive correlation with the concentrations of cumulative oh slope 0 010 r2 0 748 p 0 000 0 05 fig 4 b but not with h2o2 accumulation slope 0 044 r2 0 673 p 0 176 0 05 fig 4a it is noted that oh production became noticeable when the released electrons were higher than 56 μm black dots in fig 4b for the groundwater samples with released electrons less than 56 μm the dissolved fe ii concentrations were lower than 5 μm and the doc concentrations were around 110 μm solid dots in fig s1 the initial fe ii and doc concentrations in the groundwater samples were positively correlated with the electrons released fig s2 on the basis that one mole fe ii oxidation can theoretically contribute one mole electrons the number of electrons released from fe ii oxygenation was incomplete for the samples abstracted from w3 w7 and w8 fig s1b and s2a among the 11 wells the initial fe ii concentrations were higher 100 μm and the c fe ii ratios were lower 1 5 for the samples abstracted from w3 w7 and w8 table 2 in these three samples the electrons released data points below the red line in fig s2b were only 71 1 87 5 of the initial fe ii concentrations positive correlations between oh production and fe ii or doc concentrations were obtained blue lines in fig 4d and f besides the c fe ii ratios were high 26 in the samples with low h2o2 and oh accumulations and were low 3 in the samples with high h2o2 and oh accumulations fig s3 therefore both fe ii and reduced dom acted as the important reduced species contributing to ros production especially oh the other groundwater chemistry that may influence the distribution of electron source were further evaluated the neutral ph and similar temperature 20 were supposed to have negligible impact on oxygenation of reduced species fig s4 additional electron donors might include reduced manganese sulfur and nitrogen species the average concentration of total manganese mn was 38 7 10 5 μm which was lower than the average number of electrons released and the average concentration of dissolved fe ii table 1 suggesting that mn was less important than fe ii as the electron donor the average concentrations of nh4 no3 and so4 2 were 86 4 4 4 1 0 1 and 348 3 2 8 μm respectively table 1 for the 11 groundwater samples very weak linear correlation was obtained between the four species and h2o2 production r2 0 3 fig s5 or oh production r2 0 32 fig s6 which indicate the minimal influence of these species on ros production is insignificant 3 4 influences of aquifer conditions and external environmental factors during abstraction on ros production generally the compositions of groundwater chemistry are closely related to aquifer and external environmental conditions barbieri et al 2023 gejl et al 2019 wallis et al 2020 the aquifer conditions are dominated by sediment lithology and the external environmental conditions include disturbance from abstraction climate geography and so on compared with reported influences of aquifer conditions and external environmental factors during decades of abstraction on groundwater chemistry in previous studies barbieri et al 2023 choi et al 2013 gejl et al 2019 the short term abstraction for several days are supposed to make negligible impact to the compositions of groundwater chemistry in this study which are supported by the following analyses for the aquifer conditions the aquifer lithology can influence the water rock interaction which is an important factor altering groundwater chemistry in aquifers according to the sediment lithology obtained in our recent publication lu et al 2022 the sampling profile was dominated by medium and fine sand in 4 locations except for sandy loam interlayer in location 3 in detail the sediments around w4 w7 and w9 were fine sand and around other wells were medium sand and the sandy loam interlayer distributed between w6 and w7 with less than 1 m of thickness in comparison the permeability of sandy loam was lower than medium and fine sand and the sorption was higher for sandy loam because of fine grain size gandy et al 2007 schapel et al 2017 in this way the residence time of groundwater was relatively longer and the immobilization capacity towards solutes was relatively higher around sandy loam interlayer which could cause water rock interaction adimalla 2019 choi et al 2013 the previous studies have pointed out that the water rock interaction enriched dissolved inorganic carbon dic up to 10 44 mm by denitrification and fe reduction or increased organic matter up to 2 35 mm doc and geogenic ammonium up to 2 39 mm as n contents in aquifers choi et al 2013 du et al 2020 xiao et al 2022 these studies reflect the impacts from water rock interaction on c n and fe which are involved in the compositions of reduced species in aquifers in our short term measurement there were big differences on the concentrations of doc hco3 and dissolved fe ii in the groundwater abstracted from w7 and w6 fig s1b c and table 2 thus the presence of sandy loam interlayer plays an insignificant role on water rock interaction the same relationship existed for the concentrations of cumulative h2o2 and oh in the groundwater abstracted from w6 and w7 fig 2a and b as a result the influence of aquifer lithology on ros production is much less pronounced during short term groundwater abstraction as for the influence of external environmental factors the abstraction process can cause the decline of groundwater table and sediment oxygenation by o2 intrusion however during our short term abstraction the do concentrations in all the pumped out groundwater were stable and below 0 1 mg l which suggests a minimal influence of sediment oxygenation on ros production the impacts from external meteorological and geographical factors on groundwater chemistry were further evaluated climate change has been used to explain the variation of groundwater doc in response to the changes in rainfall and temperature mcdonough et al 2020 the topography related to local groundwater table could influence the ratio of groundwater discharge to recharge schaller and fan 2009 for the climate during the short term abstraction the average temperature was around 20 and no rainfall happened for the geographical factor the groundwater level gradient along the sampling profile was within 1 m and the flow direction was from aquifer to river lu et al 2022 the above results confirm that the influences of aquifer conditions and external environmental factors during short term groundwater abstraction on ros production are negligible in this study in a general sense the impacts of the above aquifer conditions and external environmental conditions on groundwater quality have been widely assessed previously akurugu et al 2022 döll et al 2014 gejl et al 2019 the sediment lithology is known to release dissolved ions along groundwater flow path by silicate weathering ion exchange and sorption desorption akurugu et al 2022 wallis et al 2020 which potentially enriches dissolved fe ii around fe bearing sediments and increases the capacity of ros production upon groundwater oxygenation wallis et al 2020 zhang et al 2020 the long term abstraction process is mainly considered to cause the decline of groundwater table and alter groundwater chemistry in pumping wells by o2 intrusion gejl et al 2019 su et al 2018 for example su et al 2018 found that the mean rate of groundwater table decline was about 1 3 m year and the concentrations of sulfate and nitrate were increased by less than 2 fold in abstracted groundwater during 30 years of groundwater withdrawal which reflects the shift in redox conditions during groundwater abstraction for the climate change the increase in temperature during rainy or dry season has been found to increase or decrease groundwater doc contents respectively mcdonough et al 2020 which could further influence the reduced dom contents besides large regional relief favors stronger regional flow due to enhanced hydraulic gradient at larger scales schaller and fan 2009 which may favor the interaction between groundwater flow and aquifers or surface water and facilitate oxygenation of reduced species to produce ros to sum up the impacts of aquifer conditions and external environmental factors on groundwater chemistry and ros production cannot be ignored during long term groundwater abstraction which need further field analysis 3 5 difference between h2o2 and oh production during groundwater oxygenation different capacities of h2o2 and oh production were shown below and above the boundary eh of 63 mv fig 2 the relationship between h2o2 and oh accumulations also reflected two sets divided by the eh value fig 5 in one set with higher eh values 63 206 5 mv blue triangles oh accumulation was below the detection limit and the cumulative h2o2 concentrations were lower than 3 37 μm in another set with lower eh values 63 mv red circles measurable oh was produced and the cumulative h2o2 concentrations were higher than 3 37 μm taking together oh and h2o2 formed in the groundwater with low eh values otherwise only h2o2 could be produced during oxygenation based on the above analysis the groundwater chemistry especially reduced species rather than aquifer conditions control h2o2 and oh production to clarify the impact of different groundwater redox chemistry in h2o2 and oh accumulations rda was applied for the data with or without high eh values wells w1 w4 w6 and w9 fig 6 a and c the significance of correlation was analyzed through pearson correlation fig 6b and d the greatest impacts reflected by rda were from eh dissolved fe ii doc c fe ii and the number of electrons released δedc fig 6a the acute angles between red arrows for δedc dissolved fe ii and doc with oh accumulation reflected the positive correlations and the obtuse angles between red arrows for eh and c fe ii with h2o2 and oh accumulations indicate the negative correlations fig 6a besides the acute and obtuse angles between the red arrows for nh4 and so4 2 with oh accumulation reflected corresponding positive and negative correlations respectively fig 6a the significance of correlations between the above environmental factors and h2o2 and oh accumulations were reflected in fig 6b p 0 05 for h2o2 accumulation significant correlation is only observed for eh fig 6b but for oh accumulation the 7 environmental factors mentioned above that is eh δedc dissolved fe ii doc c fe ii nh4 and so4 2 were significantly correlated with oh production in comparison for the groundwater with low eh values excluding w1 w4 w6 and w9 the greatest impacts are from dissolved fe ii δedc c fe ii eh and so4 2 fig 6c the significant correlations are only found between δedc dissolved fe ii and oh accumulation fig 6d p 0 05 and the correlation was insignificant between all these environmental factors and h2o2 accumulation fig 6c and d p 0 05 in summary the results of rda reflect that dissolved fe ii mainly influences oh production which explains the minimal oh formation for the groundwater with high eh values and low fe ii concentrations besides previous studies have pointed out that h2o2 is necessarily decomposed to oh under environmental conditions hug and leupin 2003 zhang et al 2016 as multiple pathways controlled h2o2 production and decomposition and only dissolved fe ii controlled oh production the difference occurs between h2o2 and oh accumulations under different eh values 3 6 hydrological and environmental implications the cumulative oh concentrations produced in this study are close to those produced upon oxygenation of soil or sediment pore waters in previous studies table 1 page et al 2013 tong et al 2016 trusiak et al 2018 in order to predict ros production upon oxygenation of groundwater with different chemistry it is necessary to develop a quantitative relationship between groundwater chemistry and the capacities of h2o2 and oh production as a consequence we analyzed the available data for the 11 wells in this study and reported for ros accumulation during oxygenation of waters page et al 2013 tong et al 2016 trusiak et al 2018 by stepwise multiple linear regression according to the rda analysis above the environmental factors redox chemistry total mn so4 2 nh4 no3 and ec correlated with ros production were included in the multiple linear regression model besides various ph in different samples was also included the details for 2 dependent variables and 11 independent variables were displayed in table s2 linear regression models were thus obtained as follows 2 y 1 2 35 0 011 x 4 r 2 0 811 3 y 2 7 193 0 005 x 1 0 002 x 4 1 014 x 9 r 2 0 895 where y1 represents h2o2 accumulation y2 represents oh accumulation x1 represents dissolved fe ii content x4 represents doc content x9 represents ph value the units for these variables are all μm the variables included in the final models for h2o2 and oh accumulations are statistically significant at 0 001 confidence level tables s3 the above models are then applied to predict ros production upon groundwater oxygenation we employed the reported groundwater chemistry for the samples abstracted from western bengal basin west bengal india mukherjee and fryar 2008 into equations 2 and 3 to obtain potential h2o2 and oh accumulations it has been reported that the groundwater with as exceeding the who limit is largely abstracted in the bengal basin swartz et al 2004 as rich anoxic groundwater is normally associated with microbially reductive dissolution of fe oxyhydroxides harvey et al 2002 islam et al 2004 which can supply fe ii for generating ros during groundwater oxygenation based on the groundwater chemistry for the samples from 53 well locations the average concentrations of dissolved fe ii doc and ph were 20 24 μm 59 53 μm and 7 16 respectively table s4 thus the potential h2o2 and oh accumulations can be calculated to be 3 00 μm and 0 29 μm respectively the average concentration of as iii was 0 27 μm in the groundwater from the area table s3 both h2o2 and oh can act as strong oxidizing agents for arsenic pettine et al 1999 vione et al 2006 tong et al 2016 with the reaction rate constants for as iii and h2o2 at 5 5 10 3 m 1 s 1 ph 7 5 and for as iii and oh at 8 5 109 m 1 s 1 dutta et al 2005 thus there is a great potential to oxidize as iii by ros formed during groundwater abstraction in the western bengal basin in addition the dom in groundwater can be oxidized by oh to generate carbon dioxide co2 which gives rise to carbon emission in the surface environment macdougall et al 2012 trusiak et al 2018 another important influence related to groundwater abstraction discharging is that the generated ros may lead to bacteria inactivation and variation of the microbial community structure due to oxidative stress in receiving environments i e hyporheic zones chen et al 2018 ma et al 2019 therefore an underlying oxidative capacity due to ros production should be taken into account during groundwater abstraction discharging for the biogeochemical transformation of inorganic organic species in subsurface environments which may in turn affect the functioning of the ecosystem 4 conclusions this study estimated the capacities of h2o2 and oh accumulations during groundwater abstraction discharging according to the quantitative relationship between ros production and groundwater chemistry compared with previous field measurement of ros distribution from long term hydrological process in subsurface table s1 this study emphasized the influence of groundwater chemistry in hyporheic zones on different type of ros generation within a short term abstraction discharging process the main conclusions can be drawn as follows 1 the capacities of h2o2 and oh accumulations varied with the value of eh in the groundwater with high eh values 63 206 5 mv minimal oh produced while h2o2 accumulated to be lower than 3 37 μm in the groundwater with lower eh values 63 mv measurable oh and higher than 3 37 μm of h2o2 were produced 2 the groundwater chemistry rather than aquifer conditions and related external environmental factors determined different capacities of h2o2 and oh accumulations within short term abstraction process results of the stepwise multiple linear regression model indicate the quantify relationships between h2o2 and oh accumulations and different groundwater chemistry the concentration of h2o2 accumulation was mainly influenced by the concentration of doc and the slope for doc content was 0 011 oh accumulation was mainly influenced by ph and dissolved fe ii and doc concentrations and the slopes for ph dissolved fe ii and doc contents were 1 014 0 005 and 0 002 respectively the presence of dissolved fe ii was mainly accountable for the production of measurable oh in the low eh locations 3 the stepwise multiple linear regression models were further used to predict ros production upon oxygenation of as rich groundwater from western bengal basin based on the groundwater chemistry in this field the capacities of h2o2 and oh production were estimated to have a great potential to oxidize as iii during groundwater abstraction in the western bengal basin 4 according to the capacities of ros production during groundwater oxygenation we suggest that an oxidative ability occurs in groundwater abstraction and discharging activities particularly for the groundwater with low eh values special attention must be paid to the role of oxidation in substance transformation and of oxidative stress in microbial metabolism and associated biogeochemical processes in the environments suffering from groundwater oxygenation credit authorship contribution statement yanting zhang data curation investigation methodology visualization writing original draft na zhang methodology chenglong yu investigation methodology hui liu data curation resources writing review editing songhu yuan conceptualization resources supervision writing review editing declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests songhu yuan reports financial support was provided by the natural science foundation of china no 42025703 and 41830862 acknowledgments this work was supported by the natural science foundation of china no 42025703 and 41830862 we appreciate the kind help from zhang wen yiming li shengjun mao ziwei guo chen chen zichao zhu and yiru cao at china university of geosciences wuhan for well installation data availability data will be made available on request appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129551 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
1920,production of reactive oxygen species ros such as hydrogen peroxide h2o2 and hydroxyl radical oh has been increasingly discovered upon oxygenation of reduced species in anoxic soil and sediment pore waters we therefore hypothesize that h2o2 and oh can be produced during groundwater abstraction and discharging due to oxygenation to evaluate the capacities of h2o2 and oh accumulation during groundwater oxygenation here we measured h2o2 and oh accumulations during dark oxygenation of groundwater abstracted from different depths of 11 wells adjacent to the han river this abstraction could simulate the scenarios of groundwater abstraction by riverside pumping and also of groundwater discharging in hyporheic zones results showed that h2o2 and oh formed during oxygenation of the groundwater with low eh values 63 mv and only h2o2 3 37 μm formed for the groundwater with high eh values 63 206 5 mv statistical analysis indicated that dissolved fe ii was mainly accountable for the production of measurable oh in the low eh locations the aquifer conditions i e aquifer lithology and external environmental factors i e pumping disturbance within short term abstraction process had negligible influence on ros production the relationship between ros production and groundwater chemistry was further explored by multiple linear regression which deduced the quantitative models for estimating ros production upon oxygenation of groundwater from different sources with different chemistry using the abstracted groundwater in western bengal basin as an example the estimated results indicated that ros production had a great potential to oxidize the typical contaminant of as iii as ros particularly oh represents strong oxidants our findings implicate an overlooked oxidative capacity during groundwater abstraction and discharging in hyporheic zones or other areas which could lead to the oxidative transformation of substances and the oxidative stress of microbial metabolism and associated biogeochemical processes in the environments suffering from groundwater oxygenation this oxidative capacity is particularly important when the groundwater with low eh values i e under strongly reductive conditions were abstracted and oxygenated in the surface keywords groundwater abstraction groundwater discharging hyporheic zone hydrogen peroxide hydroxyl radicals oxidative capacity data availability data will be made available on request 1 introduction groundwater is the world s largest freshwater resource on the demand of irrigation industry and the municipality hanasaki et al 2018 scanlon et al 2023 globally total groundwater withdrawal was estimated to be 789 km3 yr hanasaki et al 2018 which means the abstraction of about 2 16 109 m3 groundwater per day groundwater abstraction and discharging are important forms of groundwater consumption scanlon et al 2023 wada et al 2014 which lead to the input of oxygen o2 to groundwater and or sink of redox sensitive elements i e fe c n in hyporheic zones bardini et al 2012 liu et al 2017 trauth and fleckenstein 2017 wallis et al 2020 previous works have pointed out that reduced species i e fe and organic matter can activate o2 to produce reactive oxygen species ros i e hydrogen peroxide h2o2 and hydroxyl radicals oh in waters from o2 perturbed aquifers page et al 2013 tong et al 2016 yuan et al 2017 zhang et al 2020 when the abstracted discharged groundwater is exposed to air above ground it is rationale to hypothesize ros production by the interaction of reduced species in groundwater and o2 in air ros in the environment are of considerable importance due to their extremely high reactivity in transforming elements and contaminants mopper and zhou 1990 gligorovski et al 2015 kim et al 2015 trusiak et al 2018 because of the strong oxidative ability of h2o2 and oh particularly the later mopper and zhou 1990 goldstone et al 2002 and massive groundwater abstraction discharging investigation of ros production and related oxidative capacity during abstraction discharging is essential for implicating an underlying pathway for contaminant and element transformation which has not been well recognized because of the transient nature of ros it is a challenge to directly measure their production capacity in subsurface environment the studies over the past decade have discovered the formation of ros in waters from o2 perturbed aquifers dias et al 2016 page et al 2013 tong et al 2016 trusiak et al 2018 yuan et al 2017 zhang et al 2020 in these studies the samples came from arctic soil page et al 2013 trusiak et al 2018 redox fluctuated aquifers tong et al 2016 salt marsh systems dias et al 2016 and floodplain aquifers yuan et al 2017 zhang et al 2020 as summarized in table s1 the depths of the sample ranged from tens of centimeters to several meters however the depth of groundwater abstraction discharging varies largely depending on the aquifer conditions and engineering types scanlon et al 2023 for example groundwater is oftentimes abstracted from confined aquifers de graaf et al 2017 mukherjee et al 2011 which is normally under reductive conditions whereas for the groundwater abstraction by riverside pumping or discharging in hyporheic zones the groundwater chemistry particularly the redox chemistry varies at different time and different locations wallis et al 2020 besides the aquifer lithology is potential to influence the distribution of dissolved components and the permeability of the aquifer which impacts the immobilization capacity of redox species from floodplain sediments zhang et al 2020 and the magnitude of groundwater discharge luijendijk et al 2020 as for sampling and ros analysis in these reports table s1 groundwater abstraction was only applied in the floodplain aquifers for measuring steady state h2o2 concentrations yuan et al 2017 zhang et al 2020 the above studies document the existence of ros in natural subsurface environments however the influence of aquifer conditions in hyporheic zones i e depth and lithology and external environmental factors i e pumping disturbance on the generation of different types of ros during groundwater abstraction discharging is not clear further in these o2 perturbed aquifers both h2o2 and oh generation have been attributed to aphotic and abiotic mechanisms the production has been mainly attributed to the fenton or fenton like processes in which reduced species in subsurface donate electrons to o2 with sequential generation of superoxide o2 h2o2 and oh king et al 1995 gligorovski et al 2015 page et al 2013 tong et al 2016 yuan et al 2017 trusiak et al 2018 among the reduced species fe ii and organic matter are proposed to be the main contributors page et al 2013 tong et al 2016 zhang et al 2020 zhang et al 2022 for example cory s group showed the different dependences of oh production on dissolved fe ii and dissolved organic matter dom concentrations during oxygenation of soil water samples page et al 2013 trusiak et al 2018 yuan et al 2017 also considered reduced elements particularly fe ii and organic matters as the contributing species for the occurrence of steady state h2o2 in hyporheic zones our recent work has pointed out that anoxic biogeochemical process may regenerate the reduced species i e fe ii and reduced organic matters in hyporheic zones which fuels a sustainable h2o2 production in the aquifer during groundwater table fluctuations zhang et al 2020 for the relationship between h2o2 and oh production our recent work has discovered that the composition of fe ii and reduced organic matters that is c fe ratio could lead to various yield of oh relative to h2o2 zhang et al 2022 which means the difference of oxidative capacity due to ros production with different groundwater chemistry because groundwater abstraction discharging carries various compositions of dissolved substances it is of significance to comprehensively evaluate the dependence of the capacities of h2o2 and oh production on groundwater chemistry to our knowledge the influence of aquifer conditions and groundwater chemistry on h2o2 and oh production during groundwater abstraction discharging have not been well investigated filling this knowledge gap will benefit the accurate evaluation of oxidizing impact caused by groundwater abstraction discharging the objectives of this study are therefore 1 to evaluate the capacity of ros h2o2 and oh production upon oxygenation of groundwater under different aquifer conditions and 2 to identify the dependence of h2o2 and oh production capacities on groundwater chemistry to meet the goals we carried out groundwater abstraction in a hyporheic zone in a floodplain adjacent to han river we simultaneously measured the cumulative h2o2 and oh production upon dark oxygenation of groundwater abstracted from 11 wells at different points with different depths in aquifer we also analyzed each sample for eh the number of electrons released dissolved fe ii dissolved organic carbon doc and other groundwater chemistry we further performed correlation analysis to link h2o2 and oh accumulations with groundwater chemistry we finally evaluated the oxidative capacity due to ros production during groundwater abstraction discharging 2 materials and methods 2 1 chemicals 10 acetyl 3 7 dihydroxyphenoxazine adhp was purchased from beijing solarbio science technology co ltd china coumarin cou 99 and 7 hydroxycoumarin 7 hcou 98 were obtained from aladdin horseradish peroxidase hrp 300 units mg and diammonium 2 2 azino bis 3 ethylbenzothiazoline 6 sulfonate abts diammonium salt 98 were obtained from shanghai yuanye bio technology co ltd china catalase cat from bovine liver 2000 5000 units mg protein was obtained from sigma hydrogen peroxide aqueous solution h2o2 30 potassium persulfate k2s2o8 99 and other analytical grade chemicals were purchased from sinopharm chemical reagent co ltd china all solutions were prepared using deionized water 18 2 mω cm which was from a heal force nw ultrapure water system to prepare solutions containing dissolved abts equal volumes of 3 6 mm abts and 1 4 mm k2s2o8 were mixed for 12 h in an anaerobic glovebox coy usa filled with 92 n2 and 8 h2 in the dark page et al 2013 before field measurement 3 ml of abts solution was filled in each of 5 ml serum bottles in the glovebox the serum bottles were firstly capped with thick butyl rubber stoppers and aluminum caps and then were sealed in 2 layered plastic bags under vacuum to minimize o2 in the bottles these serum bottles were transported in the dark at 4 and stored for 72 h before usage all other reagents were of analytical grade 2 2 sampling area the sampling area was a hyporheic zone in a floodplain belongs to jianghan plain adjacent to the middle of a meander in the lower reaches of han river in duobao town tianmen city central china 112 68 e 30 58 n fig 1 a han river is the largest branch of the yangtze river and the average annual temperature of sampling area is 12 16 liu et al 2016 we chose one aquifer profile perpendicular to the river flow to collect groundwater samples from nov 13 to nov 16 2019 fig 1a according to our recent publication lu et al 2022 the general aquifer lithology of the area is clay and sand layers the river and groundwater levels in the duration of sampling were monitored to be 8 2 9 2 m which was presented as absolute elevation values and the river water level was lower than the groundwater level thus the groundwater discharging dominates the flow direction from aquifer to river in the sampling area our measurement did not include groundwater discharging process which requires groundwater pumping from deeper confined aquifers or surface water withdrawals de graaf et al 2019 scanlon et al 2023 2 3 field sampling the sampling locations were set in the vertical profiles along the riverbank in the hyporheic zone the distances for 4 locations l1 l4 to the river were 12 162 65 266 94 and 397 54 m respectively fig 1b a total of 11 sampling wells with different depths and relatively wide depth interval 2 m were drilled at the 4 locations to make a representative assessment on oh and h2o2 production fig 1b at one location the distance between the wells at different depths was 3 5 m to avoid groundwater mixing caused by sampling in detail the depths of wells in l1 were 2 7 m w1 4 7 m w2 and 6 7 m w3 in l2 were 7 7 m w4 and 9 7 m w5 in l3 were 5 8 m w6 7 8 m w7 and 9 8 m w8 and in l4 were 6 7 m w9 8 7 m w10 and 10 7 m w11 all the depth values were relative to the ground surface the bottom 30 cm of each well was perforated and wrapped with gauze for groundwater flow before sampling 4 18 l of groundwater 3 folds of the pipe volume was slowly pumped out at 0 5 l min by peristaltic sampling pump geopump geotech usa to a gastight and flow through chamber to minimize contact with air and different probes were installed in the chamber for groundwater chemistry measurement stabilization of groundwater chemistry was judged by the stabilization of dissolved oxygen do concentration which was in situ measured by a do meter jpb 607a leici china then groundwater was pumped at near 50 ml min and the do redox potential eh solution ph temperature and electric conductivity ec were measured by the probes in gastight chamber groundwater samples were collected and filtered through a 0 45 μm membrane into 50 ml serum bottles which were rinsed at least three times with the groundwater sample during groundwater collection the concentration of do in the pumped out groundwater was stable and below 0 1 mg l in order to prevent oxidation of reduced species in the samples the serum bottle was continuously filled with abstracted groundwater for at least 5 min to fully replace the air in the bottle the serum bottles were then rapidly capped with thick butyl rubber stoppers and aluminum caps and were sealed in plastic bags under vacuum the groundwater samples in one well were collected in four 50 ml serum bottles for different analyses the first one was used for measuring the concentrations of dissolved fe ii total mn co3 2 and hco3 and the number of electron released the second one was for analyses of h2o2 and oh accumulations the third one was acidified with 1 m hcl for doc analysis in lab and the last one was frozen by dry ice during transport for other cations and anions measurement in lab 2 4 groundwater analysis the measurements of h2o2 and oh accumulation and redox chemistry i e electrons released during oxygenation dissolved fe ii concentration were completed in the field by determining the fluorescence or absorbance of sample after coloration this on site analysis avoids potential changes on the redox properties of sample due to long term storage and transportation back to the lab the details for groundwater analysis were described as below cumulative h2o2 we exposed groundwater to o2 and quantified cumulative h2o2 production based on the hrp catalyzed oxidation of adhp to highly fluorescent resorufin by h2o2 zhou et al 1997 due to the reactions between h2o2 and reduced species i e fe ii and dissolved organic matter as well as the competition between adhp and reduced species for the hrp catalyzed h2o2 reaction wang et al 2017 the final concentration of adhp reacted with sample was set to be sufficient 10 μm the groundwater sample in the serum bottle was withdrawn by syringe about 20 ml of 0 45 μm filtered groundwater was injected into either 1 5 ml of hrp final concentration 20 mg l and adhp mixed solution or 1 5 ml of cat final concentration 10 mg l and adhp mixed solution in a 25 ml serum bottle in order to ensure oxygenation the samples in 25 ml serum bottles were exposed to air in the dark for about 6 7 h then the fluorescence was measured at an excitation wavelength of 571 nm and an emission wavelength of 585 nm by a fluorescence spectrophotometer f96pro lengguang china the cumulative h2o2 concentrations were determined by applying the calibration factors to the blank fluorescence intensities calibration factor was obtained by preparing a series of standard h2o2 solutions before sample analysis in order to eliminate the potential interference from background solution on calibration factor the final mixture for standard solution in the cuvette 4 ml contained 10 μm adhp 20 mg l hrp 0 45 μm filtered oxidized groundwater treated with adhp and cat from each well and a desired concentration of h2o2 the above mixtures without addition of h2o2 were used as the blanks all the above experiments were carried out in duplicate the detection limit of h2o2 was 58 nm cumulative oh similarly we exposed groundwater to o2 and quantified cumulative oh production by the reaction with the added probe of cou as described previously setsukinai et al 2000 louit et al 2005 han et al 2019 oh reacts with cou at 1 0 145 stoichiometry to yield 7 hcou tokumura et al 2011 about 20 ml of 0 45 μm filtered groundwater was injected into 1 5 ml of cou final concentration 2 mm cou in a 25 ml serum bottle the process of oxygenation was the same as that for h2o2 analysis the sample fluorescence was measured at an excitation wavelength of 350 nm and an emission wavelength of 460 nm calibration factor was obtained by preparing a series of standard 7 hcou solutions before sample analysis the potential interference from background solution was eliminated by mixing 2 mm cou 0 45 μm filtered oxidized groundwater untreated with cou from each well and a desired concentration of 7 hcou the above mixtures without addition of 7 hcou were used as the blanks all the above experiments were carried out in duplicate the detection limit of oh was 88 nm electrons released during oxygenation abts was employed to quantify the number of electrons released during oxygenation chin et al 1998 page et al 2013 the electron donating capacity edc of sample was equal to the consumption of abts which was detected by one electron transfer between abts and abts aeschbacher et al 2012 the difference in edc before and after oxygenation was calculated and used as the number of electrons released for the measurement of the number of electrons released during groundwater oxygenation 50 μl of samples before and after air exposure were mixed with 1 ml of anoxic abts solution the mixed solutions were kept in the sealed serum bottles under the dark condition for 20 min so that abts accepted one electron to form abts meanwhile 50 μl of anoxic deionized water which had been purged with n2 99 999 for 30 min to remove do was added into another 1 ml of anoxic abts solution as the blank the absorbances of the samples and blank were measured at 734 nm by a portable spectrophotometer dr1900 hach usa groundwater chemistry the eh vs standard hydrogen ph temperature and ec values were measured using a portable meter hq40d field case hach usa the dissolved fe ii concentration was measured within 5 min in site after coloration with 1 10 phenanthroline by the portable spectrophotometer total mn was determined in site by potassium periodate photometry the sum of co3 2 and hco3 was determined by titrating the samples with standard hcl solution doc was determined by a toc analyzer shimadzu toc l cph japan cations and anions were determined by an ion chromatography metrohm 925 switzerland 2 5 evaluation of ros production capacity during groundwater abstraction redundancy analysis rda can evaluate the relationship between a set of variables and other multivariate data zhang et al 2014 the accumulations of h2o2 and oh were set as response variables and the groundwater chemistry such as eh the number of electron released initial concentrations of dissolved fe ii and doc and c fe ii molar ratio were set as explaining variables before rda detrended correspondence analysis dca was performed to determine if the data sets were suitable for rda if the gradient lengths of the 4 axes calculated from dca are 3 then rda was applicable besides the significance of correlations between h2o2 and oh accumulations with different groundwater chemistry were analyzed through pearson correlation by using spss software to quantify the relationship between the capacity of ros production and groundwater chemistry stepwise multiple linear regression analysis was applied by using spss y1 and y2 were the dependent variables representing h2o2 and oh accumulations respectively the potential impact factors obtained by redundancy analysis were set as a series of independent variables x1 xn table s2 the data for dependent variables and independent variables were collected from the groundwater chemistry in table 1 in this study and the average values for arctic soil water or sediment pore water samples from previous studies table s2 page et al 2013 tong et al 2016 trusiak et al 2018 the model is specified as follows 1 y n b 0 b 1 x 1 b 2 x 2 b n x n where yn represent y1 or y2 b0 is the intercept b1 b2 bn are the respective coefficients of independent variables x1 x2 xn based on the aquation 1 obtained by stepwise multiple linear regression we further employed the groundwater chemistry from the groundwater samples reported for western bengal basin mukherjee and fryar 2008 to estimate the capacities of h2o2 and oh production during groundwater abstraction the data for groundwater chemistry were collected from 53 well locations in that study and the average concentrations were used as the values of different independent variables for calculation 3 results and discussion 3 1 capacity of h2o2 production upon groundwater oxygenation the hyporheic zone as shown in fig 1 is adjacent to the han river and the sediments are mainly sandy in the site during the field measurement period the river water levels were around 8 2 m lower than the groundwater table fig 1b we simultaneously measured the cumulative h2o2 and oh concentrations from 6 to 7 h oxygenation of all the abstracted groundwater samples n 11 the cumulative h2o2 concentrations ranged from 0 34 to 7 93 μm with an average of 4 77 2 82 μm fig 2 a table 1 and table 2 which were all significantly above the detection limit 58 nm fig 2a clearly demonstrates that the cumulative h2o2 concentration generally increased with the depths of wells in each location expect location 3 w6 w8 in location 3 the highest cumulative h2o2 concentration was in the depth of 7 8 m w7 rather than 9 8 m w9 fig 2a the concentrations of do in the samples before oxygenation were all around 0 mg l table 2 which reflects the anoxic conditions the eh value varied in different wells but ranged from 2 5 to 206 5 mv fig 2c it is worth noting that less h2o2 was produced from the samples abstracted w1 w4 w6 and w9 with higher eh values 63 206 5 mv and more h2o2 was produced with lower eh values 25 mv fig 2a and c the linear relationship between the vertical h2o2 accumulation and the eh distribution was analyzed fig 3 a the sample from w1 in location 1 was regarded as an outlier blue dot in fig 3a in general the negative correlation between h2o2 accumulation and eh distribution was insignificant slope 0 06 r2 0 712 p 0 057 0 05 fig 3a 3 2 capacity of oh production upon groundwater oxygenation for the capacity of oh production upon abstracted groundwater oxygenation the cumulative oh ranged from lower than the detection limit 88 nm to 1 72 μm with an average of 0 53 0 60 μm fig 2b table 1 and table 2 regarding the vertical distribution at one location the cumulative concentration of oh increased with the depth of wells only in locations 2 and 4 and was around the detection limit in the sample from the shallow well in each location w1 w4 w6 and w9 in fig 2b h2o2 is often considered as a precursor of oh in the environment rose and waite 2002 page et al 2012 miller et al 2013 compared with closed peak concentration of cumulative h2o2 from location 1 to 3 the peak concentration of cumulative oh increased from location 1 to 3 fig 2a and b suggesting the difference of spatial distribution of h2o2 and oh production it is interesting to discover that the eh of around 63 mv was noted to be the boundary for oh production or not below which oh production was significant fig 2 and table 2 similar boundary of eh was also observed for h2o2 production but the difference is that h2o2 could be still produced at eh higher than 63 mv fig 2 and table 2 besides the significantly negative correlation of oh accumulation with eh distribution slope 0 011 r2 0 471 p 0 016 0 05 fig 3b reflects the stronger impact of eh in oh production than in h2o2 production in summary different capacities of h2o2 and oh production distributed in vertical and horizontal space of the aquifer were influenced by eh distribution and thus the role of variation of electron source in groundwater and spatial characters of aquifer on ros production needs to be further evaluated 3 3 influence of groundwater chemistry on ros production it is known that eh values rely on the concentrations of redox sensitive groundwater constituents rodríguez escales et al 2020 in order to evaluate the overall influence of reduced species on ros production the electrons released during oxygenation were quantified as shown in table 1 the average number of electrons released upon oxygenation was 92 8 54 2 μm the number of electrons released upon oxygenation increased with the depths of wells only in locations 2 and 4 and was the highest in the abstracted sample from w2 and w7 in locations 1 and 3 respectively fig s1a the electrons released was in significantly positive correlation with the concentrations of cumulative oh slope 0 010 r2 0 748 p 0 000 0 05 fig 4 b but not with h2o2 accumulation slope 0 044 r2 0 673 p 0 176 0 05 fig 4a it is noted that oh production became noticeable when the released electrons were higher than 56 μm black dots in fig 4b for the groundwater samples with released electrons less than 56 μm the dissolved fe ii concentrations were lower than 5 μm and the doc concentrations were around 110 μm solid dots in fig s1 the initial fe ii and doc concentrations in the groundwater samples were positively correlated with the electrons released fig s2 on the basis that one mole fe ii oxidation can theoretically contribute one mole electrons the number of electrons released from fe ii oxygenation was incomplete for the samples abstracted from w3 w7 and w8 fig s1b and s2a among the 11 wells the initial fe ii concentrations were higher 100 μm and the c fe ii ratios were lower 1 5 for the samples abstracted from w3 w7 and w8 table 2 in these three samples the electrons released data points below the red line in fig s2b were only 71 1 87 5 of the initial fe ii concentrations positive correlations between oh production and fe ii or doc concentrations were obtained blue lines in fig 4d and f besides the c fe ii ratios were high 26 in the samples with low h2o2 and oh accumulations and were low 3 in the samples with high h2o2 and oh accumulations fig s3 therefore both fe ii and reduced dom acted as the important reduced species contributing to ros production especially oh the other groundwater chemistry that may influence the distribution of electron source were further evaluated the neutral ph and similar temperature 20 were supposed to have negligible impact on oxygenation of reduced species fig s4 additional electron donors might include reduced manganese sulfur and nitrogen species the average concentration of total manganese mn was 38 7 10 5 μm which was lower than the average number of electrons released and the average concentration of dissolved fe ii table 1 suggesting that mn was less important than fe ii as the electron donor the average concentrations of nh4 no3 and so4 2 were 86 4 4 4 1 0 1 and 348 3 2 8 μm respectively table 1 for the 11 groundwater samples very weak linear correlation was obtained between the four species and h2o2 production r2 0 3 fig s5 or oh production r2 0 32 fig s6 which indicate the minimal influence of these species on ros production is insignificant 3 4 influences of aquifer conditions and external environmental factors during abstraction on ros production generally the compositions of groundwater chemistry are closely related to aquifer and external environmental conditions barbieri et al 2023 gejl et al 2019 wallis et al 2020 the aquifer conditions are dominated by sediment lithology and the external environmental conditions include disturbance from abstraction climate geography and so on compared with reported influences of aquifer conditions and external environmental factors during decades of abstraction on groundwater chemistry in previous studies barbieri et al 2023 choi et al 2013 gejl et al 2019 the short term abstraction for several days are supposed to make negligible impact to the compositions of groundwater chemistry in this study which are supported by the following analyses for the aquifer conditions the aquifer lithology can influence the water rock interaction which is an important factor altering groundwater chemistry in aquifers according to the sediment lithology obtained in our recent publication lu et al 2022 the sampling profile was dominated by medium and fine sand in 4 locations except for sandy loam interlayer in location 3 in detail the sediments around w4 w7 and w9 were fine sand and around other wells were medium sand and the sandy loam interlayer distributed between w6 and w7 with less than 1 m of thickness in comparison the permeability of sandy loam was lower than medium and fine sand and the sorption was higher for sandy loam because of fine grain size gandy et al 2007 schapel et al 2017 in this way the residence time of groundwater was relatively longer and the immobilization capacity towards solutes was relatively higher around sandy loam interlayer which could cause water rock interaction adimalla 2019 choi et al 2013 the previous studies have pointed out that the water rock interaction enriched dissolved inorganic carbon dic up to 10 44 mm by denitrification and fe reduction or increased organic matter up to 2 35 mm doc and geogenic ammonium up to 2 39 mm as n contents in aquifers choi et al 2013 du et al 2020 xiao et al 2022 these studies reflect the impacts from water rock interaction on c n and fe which are involved in the compositions of reduced species in aquifers in our short term measurement there were big differences on the concentrations of doc hco3 and dissolved fe ii in the groundwater abstracted from w7 and w6 fig s1b c and table 2 thus the presence of sandy loam interlayer plays an insignificant role on water rock interaction the same relationship existed for the concentrations of cumulative h2o2 and oh in the groundwater abstracted from w6 and w7 fig 2a and b as a result the influence of aquifer lithology on ros production is much less pronounced during short term groundwater abstraction as for the influence of external environmental factors the abstraction process can cause the decline of groundwater table and sediment oxygenation by o2 intrusion however during our short term abstraction the do concentrations in all the pumped out groundwater were stable and below 0 1 mg l which suggests a minimal influence of sediment oxygenation on ros production the impacts from external meteorological and geographical factors on groundwater chemistry were further evaluated climate change has been used to explain the variation of groundwater doc in response to the changes in rainfall and temperature mcdonough et al 2020 the topography related to local groundwater table could influence the ratio of groundwater discharge to recharge schaller and fan 2009 for the climate during the short term abstraction the average temperature was around 20 and no rainfall happened for the geographical factor the groundwater level gradient along the sampling profile was within 1 m and the flow direction was from aquifer to river lu et al 2022 the above results confirm that the influences of aquifer conditions and external environmental factors during short term groundwater abstraction on ros production are negligible in this study in a general sense the impacts of the above aquifer conditions and external environmental conditions on groundwater quality have been widely assessed previously akurugu et al 2022 döll et al 2014 gejl et al 2019 the sediment lithology is known to release dissolved ions along groundwater flow path by silicate weathering ion exchange and sorption desorption akurugu et al 2022 wallis et al 2020 which potentially enriches dissolved fe ii around fe bearing sediments and increases the capacity of ros production upon groundwater oxygenation wallis et al 2020 zhang et al 2020 the long term abstraction process is mainly considered to cause the decline of groundwater table and alter groundwater chemistry in pumping wells by o2 intrusion gejl et al 2019 su et al 2018 for example su et al 2018 found that the mean rate of groundwater table decline was about 1 3 m year and the concentrations of sulfate and nitrate were increased by less than 2 fold in abstracted groundwater during 30 years of groundwater withdrawal which reflects the shift in redox conditions during groundwater abstraction for the climate change the increase in temperature during rainy or dry season has been found to increase or decrease groundwater doc contents respectively mcdonough et al 2020 which could further influence the reduced dom contents besides large regional relief favors stronger regional flow due to enhanced hydraulic gradient at larger scales schaller and fan 2009 which may favor the interaction between groundwater flow and aquifers or surface water and facilitate oxygenation of reduced species to produce ros to sum up the impacts of aquifer conditions and external environmental factors on groundwater chemistry and ros production cannot be ignored during long term groundwater abstraction which need further field analysis 3 5 difference between h2o2 and oh production during groundwater oxygenation different capacities of h2o2 and oh production were shown below and above the boundary eh of 63 mv fig 2 the relationship between h2o2 and oh accumulations also reflected two sets divided by the eh value fig 5 in one set with higher eh values 63 206 5 mv blue triangles oh accumulation was below the detection limit and the cumulative h2o2 concentrations were lower than 3 37 μm in another set with lower eh values 63 mv red circles measurable oh was produced and the cumulative h2o2 concentrations were higher than 3 37 μm taking together oh and h2o2 formed in the groundwater with low eh values otherwise only h2o2 could be produced during oxygenation based on the above analysis the groundwater chemistry especially reduced species rather than aquifer conditions control h2o2 and oh production to clarify the impact of different groundwater redox chemistry in h2o2 and oh accumulations rda was applied for the data with or without high eh values wells w1 w4 w6 and w9 fig 6 a and c the significance of correlation was analyzed through pearson correlation fig 6b and d the greatest impacts reflected by rda were from eh dissolved fe ii doc c fe ii and the number of electrons released δedc fig 6a the acute angles between red arrows for δedc dissolved fe ii and doc with oh accumulation reflected the positive correlations and the obtuse angles between red arrows for eh and c fe ii with h2o2 and oh accumulations indicate the negative correlations fig 6a besides the acute and obtuse angles between the red arrows for nh4 and so4 2 with oh accumulation reflected corresponding positive and negative correlations respectively fig 6a the significance of correlations between the above environmental factors and h2o2 and oh accumulations were reflected in fig 6b p 0 05 for h2o2 accumulation significant correlation is only observed for eh fig 6b but for oh accumulation the 7 environmental factors mentioned above that is eh δedc dissolved fe ii doc c fe ii nh4 and so4 2 were significantly correlated with oh production in comparison for the groundwater with low eh values excluding w1 w4 w6 and w9 the greatest impacts are from dissolved fe ii δedc c fe ii eh and so4 2 fig 6c the significant correlations are only found between δedc dissolved fe ii and oh accumulation fig 6d p 0 05 and the correlation was insignificant between all these environmental factors and h2o2 accumulation fig 6c and d p 0 05 in summary the results of rda reflect that dissolved fe ii mainly influences oh production which explains the minimal oh formation for the groundwater with high eh values and low fe ii concentrations besides previous studies have pointed out that h2o2 is necessarily decomposed to oh under environmental conditions hug and leupin 2003 zhang et al 2016 as multiple pathways controlled h2o2 production and decomposition and only dissolved fe ii controlled oh production the difference occurs between h2o2 and oh accumulations under different eh values 3 6 hydrological and environmental implications the cumulative oh concentrations produced in this study are close to those produced upon oxygenation of soil or sediment pore waters in previous studies table 1 page et al 2013 tong et al 2016 trusiak et al 2018 in order to predict ros production upon oxygenation of groundwater with different chemistry it is necessary to develop a quantitative relationship between groundwater chemistry and the capacities of h2o2 and oh production as a consequence we analyzed the available data for the 11 wells in this study and reported for ros accumulation during oxygenation of waters page et al 2013 tong et al 2016 trusiak et al 2018 by stepwise multiple linear regression according to the rda analysis above the environmental factors redox chemistry total mn so4 2 nh4 no3 and ec correlated with ros production were included in the multiple linear regression model besides various ph in different samples was also included the details for 2 dependent variables and 11 independent variables were displayed in table s2 linear regression models were thus obtained as follows 2 y 1 2 35 0 011 x 4 r 2 0 811 3 y 2 7 193 0 005 x 1 0 002 x 4 1 014 x 9 r 2 0 895 where y1 represents h2o2 accumulation y2 represents oh accumulation x1 represents dissolved fe ii content x4 represents doc content x9 represents ph value the units for these variables are all μm the variables included in the final models for h2o2 and oh accumulations are statistically significant at 0 001 confidence level tables s3 the above models are then applied to predict ros production upon groundwater oxygenation we employed the reported groundwater chemistry for the samples abstracted from western bengal basin west bengal india mukherjee and fryar 2008 into equations 2 and 3 to obtain potential h2o2 and oh accumulations it has been reported that the groundwater with as exceeding the who limit is largely abstracted in the bengal basin swartz et al 2004 as rich anoxic groundwater is normally associated with microbially reductive dissolution of fe oxyhydroxides harvey et al 2002 islam et al 2004 which can supply fe ii for generating ros during groundwater oxygenation based on the groundwater chemistry for the samples from 53 well locations the average concentrations of dissolved fe ii doc and ph were 20 24 μm 59 53 μm and 7 16 respectively table s4 thus the potential h2o2 and oh accumulations can be calculated to be 3 00 μm and 0 29 μm respectively the average concentration of as iii was 0 27 μm in the groundwater from the area table s3 both h2o2 and oh can act as strong oxidizing agents for arsenic pettine et al 1999 vione et al 2006 tong et al 2016 with the reaction rate constants for as iii and h2o2 at 5 5 10 3 m 1 s 1 ph 7 5 and for as iii and oh at 8 5 109 m 1 s 1 dutta et al 2005 thus there is a great potential to oxidize as iii by ros formed during groundwater abstraction in the western bengal basin in addition the dom in groundwater can be oxidized by oh to generate carbon dioxide co2 which gives rise to carbon emission in the surface environment macdougall et al 2012 trusiak et al 2018 another important influence related to groundwater abstraction discharging is that the generated ros may lead to bacteria inactivation and variation of the microbial community structure due to oxidative stress in receiving environments i e hyporheic zones chen et al 2018 ma et al 2019 therefore an underlying oxidative capacity due to ros production should be taken into account during groundwater abstraction discharging for the biogeochemical transformation of inorganic organic species in subsurface environments which may in turn affect the functioning of the ecosystem 4 conclusions this study estimated the capacities of h2o2 and oh accumulations during groundwater abstraction discharging according to the quantitative relationship between ros production and groundwater chemistry compared with previous field measurement of ros distribution from long term hydrological process in subsurface table s1 this study emphasized the influence of groundwater chemistry in hyporheic zones on different type of ros generation within a short term abstraction discharging process the main conclusions can be drawn as follows 1 the capacities of h2o2 and oh accumulations varied with the value of eh in the groundwater with high eh values 63 206 5 mv minimal oh produced while h2o2 accumulated to be lower than 3 37 μm in the groundwater with lower eh values 63 mv measurable oh and higher than 3 37 μm of h2o2 were produced 2 the groundwater chemistry rather than aquifer conditions and related external environmental factors determined different capacities of h2o2 and oh accumulations within short term abstraction process results of the stepwise multiple linear regression model indicate the quantify relationships between h2o2 and oh accumulations and different groundwater chemistry the concentration of h2o2 accumulation was mainly influenced by the concentration of doc and the slope for doc content was 0 011 oh accumulation was mainly influenced by ph and dissolved fe ii and doc concentrations and the slopes for ph dissolved fe ii and doc contents were 1 014 0 005 and 0 002 respectively the presence of dissolved fe ii was mainly accountable for the production of measurable oh in the low eh locations 3 the stepwise multiple linear regression models were further used to predict ros production upon oxygenation of as rich groundwater from western bengal basin based on the groundwater chemistry in this field the capacities of h2o2 and oh production were estimated to have a great potential to oxidize as iii during groundwater abstraction in the western bengal basin 4 according to the capacities of ros production during groundwater oxygenation we suggest that an oxidative ability occurs in groundwater abstraction and discharging activities particularly for the groundwater with low eh values special attention must be paid to the role of oxidation in substance transformation and of oxidative stress in microbial metabolism and associated biogeochemical processes in the environments suffering from groundwater oxygenation credit authorship contribution statement yanting zhang data curation investigation methodology visualization writing original draft na zhang methodology chenglong yu investigation methodology hui liu data curation resources writing review editing songhu yuan conceptualization resources supervision writing review editing declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests songhu yuan reports financial support was provided by the natural science foundation of china no 42025703 and 41830862 acknowledgments this work was supported by the natural science foundation of china no 42025703 and 41830862 we appreciate the kind help from zhang wen yiming li shengjun mao ziwei guo chen chen zichao zhu and yiru cao at china university of geosciences wuhan for well installation data availability data will be made available on request appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129551 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
1921,flow measurement using weirs as an engineered hydraulic control has been well studied and understood but the presence of vegetation on the weir crest or top of weir like structures in natural waterway has rarely been considered this technical note presents a quantitative assessment of the effects of crest vegetation roughness on flow estimation experiments are carried out to record the discharge coefficient reduction of finite crest length weirs when the weir crests are covered by flexible artificial vegetation the effects of equivalent roughness height of the vegetation canopy on the weir discharge capacity are evaluated in addition to the variation of flow rate and weir crest length according to the ratio of upstream head to vegetated crest length the tested flows are classified as broad crested and narrow crested weir flows and some change in discharge coefficient deterioration rate is observed for the two types of weir flows empirical equations are proposed for prediction of discharge coefficient thus flow estimate correction by taking into account the vegetation resistance effects the results may contribute to improve the accuracy of hydrological modeling and flood forecasting although vegetation degradation during floods is not considered keywords weir discharge coefficient vegetation vegetated crested weir data availability data will be made available on request 1 introduction flow estimation in mountain streams provides critical calibration and validation data for hydrological modeling and forecasting of torrential floods however it is practically challenging in remote field environments in manmade and semi natural channels weirs and check dams are built for convenient flow control and measurement requiring simply an upstream water level reading 1 q c d b 2 g h 3 2 where q flow rate cd discharge coefficient b weir width g gravitational acceleration and h total head above weir crest which is often replaced by the upstream water depth h measured from the weir crest level with accordingly adjusted cd for practical convenience henderson 1966 similar practice is also possible in the flood paths in mountain areas with the aid of weir like instream structures these structures are often covered by vegetation growing in dry seasons which reduces the discharge capacity and changing the discharge head relationship during floods in other scenarios the concrete surfaces of existing weirs are being replaced by eco friendly materials such as rocks and vegetation to facilitate fish migration over the weir and restore aquatic habitat connectivity fig 1 shows some examples of vegetation covered weir structures all these applications require proper calibration of cd for the extra flow resistance due to the increasing barrier roughness to guarantee reliable flow measurement or estimation for a simplified rectangular weir p in height l in streamwise length the type of overflow depends mainly on the relative length of the weir crest h l horton 1907 govinda rao and muralidhar 1963 proposed classification of long crested weir h l 0 1 broad crested weir 0 1 h l 0 4 narrow crested weir 0 4 h l 1 5 and sharp crested weir h l 1 5 extensive experimental studies have been carried out on the discharge coefficient for various engineered weir geometries and water heads doeringsfeld and barker 1941 smith 1958 hager and schwalt 1994 johnson 2000 felder and chanson 2012 chaokitka and chanson 2022 for instance ramamurthy et al 1988 and azimi and rajaratnam 2009 investigated cd for broad crested weirs with square edged and rounded entrances fritz and hager 1998 sargison and percy 2009 and azimi et al 2013 studied the effects of upstream and downstream ramps the discharge coefficient is commonly expressed as a function of the head ratio h l for simple weir geometries chaokitka and chanson 2022 but simple direct and generalized discharge relations cannot always be established for complicated inflow and outflow conditions azimi et al 2013 none of the existing studies have considered the flow conveyance deterioration caused by the presence of flexible vegetation roughness on the weir crest while the flow velocity and turbulence modification due to submerged vegetation has been widely studied for subcritical flow conditions järvelä 2002 nepf 2012 vargas luna et al 2015 the flow regime on a broad crested weir that typically experiences a transition from upstream subcritical flow to downstream supercritical falling jet has not been well attended the increase in skin friction factor that links to the ratio of submerged vegetation height to water depth is believed to result in reduction of discharge coefficient guo and zhang 2016 the phenomenon should be studied quantitatively before the mechanism of vegetation induced flow reduction is understood the present study aims to take a step forward by investigating the effects of flexible vegetation roughness on flow conveyance over broad crested weirs experiments were conducted for rectangular weirs with sharp edged crest covered by artificial vegetation of different plant types and canopy densities the discharge coefficient cd was documented with consideration of the effects of vegetation resistance in addition to the water head and weir crest length for a given equivalent vegetation roughness height empirical correlation of the discharge coefficient is proposed to assist with practical flow estimation under the interference of crest vegetation 2 method experiments were carried out in a horizontal rectangular glass flume that was 7 0 m in length 0 4 m in width and 0 5 m in height water was pumped from an underground reservoir into a large head pool and overflew into the flume a 0 2 m high full width rectangular weir model was fixed in the middle section of the flume with its upstream vertical face at 3 5 m downstream of the entrance to the flume three different weir crest lengths l 0 2 m 0 5 m and 1 0 m were tested without any outflow control the free falling water was collected in a tail pool leading back to the reservoir fig 2 shows a scheme of the experimental lay out the flow free surface level was measured using a pointer gauge along the channel centerline with an accuracy of 0 02 mm the measuring section extended to an upstream distance of at least 4 times the free flow depth from the upstream side of the weir ending somewhere beyond the downstream edge of the weir crest over the falling drop the flow rate was measured with a rectangular sharp crested weir upstream of the head pool with an estimated accuracy of 1 the value was double checked against the integrated velocity profile measured with a pitot tube in the uniform flow upstream of the tested broad crested weir yielding discrepancies 4 a total of seven crest roughness configurations were tested including one smooth invert as painted timber surface one vegetated invert covered by artificial turf and five vegetated inverts covered by the same kind of artificial plants of different plant densities all artificial vegetation elements were uniformly distributed covering the whole weir crest area the artificial turf was made of 15 mm long plastic grasses fig 2 with the zero vertical position defined at the permeable base of the grasses the plastic plant element was composed of a 70 mm long flexible stem and six pairs of rigid oval leaves that were 8 to 12 mm in length and 10 mm in width please find further details about the artificial turf and plant elements in bai et al 2022 each plant cluster consisted of three such elements fig 2 and the plant clusters were fixed uniformly on a sheet of plastic mesh base with 60 60 mm2 square holes nailed tightly on the timber invert four of the five artificial plant configurations had different longitudinal and transverse spacings δx and δz between neighbouring plant clusters as specified in table 1 for the sparsest cluster distribution the canopy density was further reduced by removing two elements from each plant cluster the zero vertical position was defined at the top of the mesh base which was about 1 mm above the timber crest invert fig 3 illustrates the vegetation configurations listed in table 1 for all roughness configurations vertical velocity distributions were measured with a pitot tube above the longest tested weir crest l 1 m in the middle section where the free surface of the near critical flow was almost horizontal and the pressure was quasi hydrostatic the equivalent sand roughness height ks was determined by fitting the velocity profiles to the universal law of the wall for steady uniform flows kaimal and finnigan 1994 2 u y u κ ln y y m k s 30 where y upward normal distance ym virtual position where the idealized velocity profile approaches smoothly to zero the von karman constant κ 0 4 the friction velocity u gs h ym s friction slop and h flow depth fig 4 shows selected comparisons between eq 2 and measured velocity profiles for a variety of tested discharges the average equivalent roughness heights tested in the present study are summarized in table 1 the range of investigated flow rates for each weir geometry is showed in table 2 3 results for three different crest lengths the relative headwater levels tested in this work varied over a wide range for 0 075 h l 1 3 covering narrow crested broad crested and long crested weir conditions according to govinda rao and muralidhar 1963 visual observation showed that the presence of vegetation cover on the crest changed significantly the overflow depth and free surface curvature as illustrated in fig 5 fig 5 shows three pairs of pictures of the different flow patterns over smooth and vegetated weir crests respectively under the same crest length and flow rates while the flows in fig 5a and 5b are classified to narrow crested weir overflow and the flows in fig 5e and 5f both belong to broad crested weir overflow the broad crested weir overflow in fig 5c becomes a narrow crested weir overflow after the introduction of vegetation resistance in fig 5d besides the effect of increasing flow resistance the streamwise deflection of the flexible plants form some better streamlined flow boundary shape similar to rounded edges at both upstream and downstream ends of the crest therefore the deflected vegetation tends to reduce the chance of flow separation at the square edges thus slightly compensate for the loss of discharge capacity please note that no ventilation was allowed below the outflow jet at the downstream side of the weir spanwise jet contraction apart from the sidewalls as reported by toombes et al 2008 was not observed either at the relatively small jet velocities the free surface profiles recorded for a variety of upstream heads above crest are plotted in fig 6 for three crest roughness configurations with the depth d and longitudinal position normalized by the crest length l the flow depth rapidly decreased upstream of the weir entrance as the flow froude number approaches unity for a smooth crested weir fig 6a 6c a constant depth section was achieved on the crest for approximately h l 0 3 for h l 0 3 the water depth kept decreasing gradually along the weir crest until a sharp flow acceleration near the end of the crest fig 6d 6f and 6g 6i present two groups of data above vegetated weir crests with different plant cluster densities the rise in upstream water level due to the vegetation was generally insignificant increasing gently with both increasing plant density and length of vegetation cover the presence of vegetation roughness also made the constant depth section vanish at smaller h l for instance the broad crested weir overflow in fig 6i shows monotonically decreasing depth for 0 2 h l 0 25 over the dense vegetation layer while a horizontal free surface is shown over the smooth crest under very similar flow rates it is known that the plants hold a low speed flow layer and produce a shear layer at the top of the canopy where vertical momentum exchange takes place between the fast and slow flows all the way along the crest furthermore it is noteworthy that the disturbance of sparsely distributed plant clusters on a relatively long weir crest resulted in some standing waves at small flow rates fig 6f the standing waves moved gradually towards the downstream end of the crest with increasing h l and disappeared at h l 0 22 the discharge coefficient cd was derived from eq 1 for all tests a dimensional analysis suggests the relevance of weir height p weir crest length l upstream depth above crest h and equivalent roughness height of the vegetation cover ks yielding dimensionless length scales h l h h p and h ks that affect cd the raw data of h q cd relation for all crest lengths are provided in the appendix the corresponding relationships are plotted in fig 7 a 7c fig 7a showes that cd increased monotonically with increasing h l for a given crest roughness condition similar to the previous observations on smooth crested weirs e g azimi and rajaratnam 2009 for example the present smooth crest data indicate that cd increased from cd 0 35 to 0 44 when the relative upstream depth to crest length increased from h l 0 1 to 1 33 in good agreement with the predictions of hager and schwalt 1994 the weirs of the same crest surface condition but different crest lengths showed consistent increasing trends for the cd h l relationship which are characterized by a change in the increasing rate of cd around h l 0 4 that is with increasing h l the relatively low discharge coefficient of broad crested weir flow 0 1 h l 0 4 increased faster than that of narrow crested weir flow 0 4 h l 1 5 did in the present study a constant weir height p 0 2 m was adopted and the dimensionless flow rate is characterized by the relative upstream depth above crest to total depth in a range of 0 17 h h p 0 6 fig 7b shows that cd increased with increasing h h p for a given weir model the increasing slope was mildest for the smooth crest and became steeper as the crest surface was roughened by vegetation of increasing roughness height ks for most datasets a simplistic linear correlation is able to achieve a correlation coefficient r 2 0 88 for a given roughness condition the effect of smooth or roughened crest length l on cd can be noted between the datasets of the same symbol shape showing a reduced level of cd over an elongated crest for a certain flow rate which can be also told from fig 7a both fig 7a and 7b suggest remarkable reduction of cd at high vegetation densities e g ks 147 and 318 mm this reflects a deterioration of weir discharge capacity due to the additional flow resistance associated with the flexible plants fig 7c demonstrates the variation of cd with dimensionless roughness height h ks that varies for different roughness types and flow rates for each weir model cd decayed significantly if the roughness height became greater with reference to the approach head thus reducing h ks for instance of the vegetated weirs with the crest length l 1 0 m the cd h ks relationship is plotted in the small window for clarity drastic reduction of cd from 0 36 to 0 16 is shown for h ks 5 that corresponded to the high density plant cluster configurations indeed when the canopy was dense and flow rate was small the majority of the overflow column had to fight its way through the porous vegetation layer at very low velocity where the discharge capacity was sensitive to the drag forces by stems and leaves when the flow rate was increased so that most additional flow was conveyed over the vegetation layer at much higher velocity the friction force by the submerged vegetation roughness became predominant and the influence of flow rate variation on the variation of cd was less significant 4 discussion the present results indicated that in addition to the relative upstream head to crest length and equivalent roughness height the discharge coefficient cd was also affected by the height length ratio of weir p l for a broad crested weir with 0 1 h l 0 4 and by the weir roughness height ratio p ks for a narrow crested weir with 0 4 h l 1 5 the discharge coefficient of a rectangular vegetated crested weir may be then approximated in the following forms for 0 1 h l 0 4 and 0 4 h l 1 5 respectively 3 c d 0 36 tanh 3 5 h l 0 1 h k s 0 4 p l 0 8 f o r 0 1 h l 0 4 4 c d 0 39 h l 2 h k s 0 85 p k s 0 58 0 09 f o r 0 4 h l 1 5 the correlation coefficients are r 2 0 84 and 0 91 fig 8 a and 8b compare eqs 3 and 4 with all measured data where f 1 tanh 3 5 h l 0 1 h ks 0 4 p l 0 8 and f 2 h l 2 h ks 0 85 p l 0 58 0 09 fig 8c shows a direct comparison between all calculated and measured cd values the shallow area marks an uncertainty range of 10 for prediction by the equations covering most data points the quantitative probability distribution of the calculation error relative to the measured values is presented in fig 8d for all 194 tests it is shown that 72 7 of the predictions had errors 5 and the percentages for errors 10 15 and 20 were 90 7 96 9 and 98 5 respectively the total flow resistance is related to the height front area and rigidity of single vegetation elements as well as to the accumulative effects determined by element density arrangement and total coverage area in this study the flow resistance effect is simplistically characterized by ks which is a further function of these vegetation characteristics quantitative description of their relationship requires detailed boundary layer measurement that is beyond the scope of this work the present results imply that for the tested range of vegetation resistance the loss of weir discharge capacity can be subject to different impacts of the vegetation height and area for broad and narrow crested weirs and their effects are sensitive to the upstream water head in reality vegetation can be washed away once the flow velocity exceeds some critical value leading to risk of sudden rise in weir discharge for flow measurement based on the upstream water level it is important to accurately estimate the equivalent roughness height of flexible vegetation which is usually difficult in field environment therefore flow estimation over vegetated weir or weir like structures should be only carried out for sufficiently large flow rates with preference of narrow weir crest the finding may also provide implication for predicting flow change caused by soft debris accumulation behind instream structures 5 conclusions this work presents an experimental investigation of discharge coefficient for finite crest length weirs with the crest surface roughened by flexible artificial vegetation the tested vegetation configurations were characterized by equivalent roughness height ranging from ks 18 to 318 mm compared to the smooth crested weir a vegetated crested weir required a longer crest or lower flow rate to achieve a horizontal free surface section above the crest and standing waves were observed on the crest for small discharges passing over sparsely distributed plant elements although the flexible plants reduced flow separation at the crest edges the flow resistance introduced by the vegetation layer resulted in significant decrease in the discharge coefficient cd the weir flows tested in the present study belonged to broad crested weir flow 0 1 h l 0 4 and narrow crested weir flow 0 4 h l 1 5 and a change in the deterioration rate of cd with decreasing h l was observed around h l 0 4 in addition to the flow rate and total crest length cd was found to be sensitive to the equivalent roughness height of the vegetation canopy associated with the variation of vegetation type density and element arrangement particularly at small flow rates given a proper estimate of the vegetation equivalent roughness height two empirical correlation formulae were proposed for discharge coefficient correction over vegetated crested weirs of different crest lengths so that flow estimation was possible at relatively large flow rates with practically acceptable accuracy credit authorship contribution statement ruidi bai conceptualization methodology visualization writing original draft maolin zhou investigation formal analysis zhou yan investigation formal analysis jianmin zhang resources supervision funding acquisition hang wang conceptualization methodology validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported financially by the national natural science foundation of china grant no 52130904 51709192 and the natural science foundation of sichuan province grant no 2022nsfsc0970 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129552 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
1921,flow measurement using weirs as an engineered hydraulic control has been well studied and understood but the presence of vegetation on the weir crest or top of weir like structures in natural waterway has rarely been considered this technical note presents a quantitative assessment of the effects of crest vegetation roughness on flow estimation experiments are carried out to record the discharge coefficient reduction of finite crest length weirs when the weir crests are covered by flexible artificial vegetation the effects of equivalent roughness height of the vegetation canopy on the weir discharge capacity are evaluated in addition to the variation of flow rate and weir crest length according to the ratio of upstream head to vegetated crest length the tested flows are classified as broad crested and narrow crested weir flows and some change in discharge coefficient deterioration rate is observed for the two types of weir flows empirical equations are proposed for prediction of discharge coefficient thus flow estimate correction by taking into account the vegetation resistance effects the results may contribute to improve the accuracy of hydrological modeling and flood forecasting although vegetation degradation during floods is not considered keywords weir discharge coefficient vegetation vegetated crested weir data availability data will be made available on request 1 introduction flow estimation in mountain streams provides critical calibration and validation data for hydrological modeling and forecasting of torrential floods however it is practically challenging in remote field environments in manmade and semi natural channels weirs and check dams are built for convenient flow control and measurement requiring simply an upstream water level reading 1 q c d b 2 g h 3 2 where q flow rate cd discharge coefficient b weir width g gravitational acceleration and h total head above weir crest which is often replaced by the upstream water depth h measured from the weir crest level with accordingly adjusted cd for practical convenience henderson 1966 similar practice is also possible in the flood paths in mountain areas with the aid of weir like instream structures these structures are often covered by vegetation growing in dry seasons which reduces the discharge capacity and changing the discharge head relationship during floods in other scenarios the concrete surfaces of existing weirs are being replaced by eco friendly materials such as rocks and vegetation to facilitate fish migration over the weir and restore aquatic habitat connectivity fig 1 shows some examples of vegetation covered weir structures all these applications require proper calibration of cd for the extra flow resistance due to the increasing barrier roughness to guarantee reliable flow measurement or estimation for a simplified rectangular weir p in height l in streamwise length the type of overflow depends mainly on the relative length of the weir crest h l horton 1907 govinda rao and muralidhar 1963 proposed classification of long crested weir h l 0 1 broad crested weir 0 1 h l 0 4 narrow crested weir 0 4 h l 1 5 and sharp crested weir h l 1 5 extensive experimental studies have been carried out on the discharge coefficient for various engineered weir geometries and water heads doeringsfeld and barker 1941 smith 1958 hager and schwalt 1994 johnson 2000 felder and chanson 2012 chaokitka and chanson 2022 for instance ramamurthy et al 1988 and azimi and rajaratnam 2009 investigated cd for broad crested weirs with square edged and rounded entrances fritz and hager 1998 sargison and percy 2009 and azimi et al 2013 studied the effects of upstream and downstream ramps the discharge coefficient is commonly expressed as a function of the head ratio h l for simple weir geometries chaokitka and chanson 2022 but simple direct and generalized discharge relations cannot always be established for complicated inflow and outflow conditions azimi et al 2013 none of the existing studies have considered the flow conveyance deterioration caused by the presence of flexible vegetation roughness on the weir crest while the flow velocity and turbulence modification due to submerged vegetation has been widely studied for subcritical flow conditions järvelä 2002 nepf 2012 vargas luna et al 2015 the flow regime on a broad crested weir that typically experiences a transition from upstream subcritical flow to downstream supercritical falling jet has not been well attended the increase in skin friction factor that links to the ratio of submerged vegetation height to water depth is believed to result in reduction of discharge coefficient guo and zhang 2016 the phenomenon should be studied quantitatively before the mechanism of vegetation induced flow reduction is understood the present study aims to take a step forward by investigating the effects of flexible vegetation roughness on flow conveyance over broad crested weirs experiments were conducted for rectangular weirs with sharp edged crest covered by artificial vegetation of different plant types and canopy densities the discharge coefficient cd was documented with consideration of the effects of vegetation resistance in addition to the water head and weir crest length for a given equivalent vegetation roughness height empirical correlation of the discharge coefficient is proposed to assist with practical flow estimation under the interference of crest vegetation 2 method experiments were carried out in a horizontal rectangular glass flume that was 7 0 m in length 0 4 m in width and 0 5 m in height water was pumped from an underground reservoir into a large head pool and overflew into the flume a 0 2 m high full width rectangular weir model was fixed in the middle section of the flume with its upstream vertical face at 3 5 m downstream of the entrance to the flume three different weir crest lengths l 0 2 m 0 5 m and 1 0 m were tested without any outflow control the free falling water was collected in a tail pool leading back to the reservoir fig 2 shows a scheme of the experimental lay out the flow free surface level was measured using a pointer gauge along the channel centerline with an accuracy of 0 02 mm the measuring section extended to an upstream distance of at least 4 times the free flow depth from the upstream side of the weir ending somewhere beyond the downstream edge of the weir crest over the falling drop the flow rate was measured with a rectangular sharp crested weir upstream of the head pool with an estimated accuracy of 1 the value was double checked against the integrated velocity profile measured with a pitot tube in the uniform flow upstream of the tested broad crested weir yielding discrepancies 4 a total of seven crest roughness configurations were tested including one smooth invert as painted timber surface one vegetated invert covered by artificial turf and five vegetated inverts covered by the same kind of artificial plants of different plant densities all artificial vegetation elements were uniformly distributed covering the whole weir crest area the artificial turf was made of 15 mm long plastic grasses fig 2 with the zero vertical position defined at the permeable base of the grasses the plastic plant element was composed of a 70 mm long flexible stem and six pairs of rigid oval leaves that were 8 to 12 mm in length and 10 mm in width please find further details about the artificial turf and plant elements in bai et al 2022 each plant cluster consisted of three such elements fig 2 and the plant clusters were fixed uniformly on a sheet of plastic mesh base with 60 60 mm2 square holes nailed tightly on the timber invert four of the five artificial plant configurations had different longitudinal and transverse spacings δx and δz between neighbouring plant clusters as specified in table 1 for the sparsest cluster distribution the canopy density was further reduced by removing two elements from each plant cluster the zero vertical position was defined at the top of the mesh base which was about 1 mm above the timber crest invert fig 3 illustrates the vegetation configurations listed in table 1 for all roughness configurations vertical velocity distributions were measured with a pitot tube above the longest tested weir crest l 1 m in the middle section where the free surface of the near critical flow was almost horizontal and the pressure was quasi hydrostatic the equivalent sand roughness height ks was determined by fitting the velocity profiles to the universal law of the wall for steady uniform flows kaimal and finnigan 1994 2 u y u κ ln y y m k s 30 where y upward normal distance ym virtual position where the idealized velocity profile approaches smoothly to zero the von karman constant κ 0 4 the friction velocity u gs h ym s friction slop and h flow depth fig 4 shows selected comparisons between eq 2 and measured velocity profiles for a variety of tested discharges the average equivalent roughness heights tested in the present study are summarized in table 1 the range of investigated flow rates for each weir geometry is showed in table 2 3 results for three different crest lengths the relative headwater levels tested in this work varied over a wide range for 0 075 h l 1 3 covering narrow crested broad crested and long crested weir conditions according to govinda rao and muralidhar 1963 visual observation showed that the presence of vegetation cover on the crest changed significantly the overflow depth and free surface curvature as illustrated in fig 5 fig 5 shows three pairs of pictures of the different flow patterns over smooth and vegetated weir crests respectively under the same crest length and flow rates while the flows in fig 5a and 5b are classified to narrow crested weir overflow and the flows in fig 5e and 5f both belong to broad crested weir overflow the broad crested weir overflow in fig 5c becomes a narrow crested weir overflow after the introduction of vegetation resistance in fig 5d besides the effect of increasing flow resistance the streamwise deflection of the flexible plants form some better streamlined flow boundary shape similar to rounded edges at both upstream and downstream ends of the crest therefore the deflected vegetation tends to reduce the chance of flow separation at the square edges thus slightly compensate for the loss of discharge capacity please note that no ventilation was allowed below the outflow jet at the downstream side of the weir spanwise jet contraction apart from the sidewalls as reported by toombes et al 2008 was not observed either at the relatively small jet velocities the free surface profiles recorded for a variety of upstream heads above crest are plotted in fig 6 for three crest roughness configurations with the depth d and longitudinal position normalized by the crest length l the flow depth rapidly decreased upstream of the weir entrance as the flow froude number approaches unity for a smooth crested weir fig 6a 6c a constant depth section was achieved on the crest for approximately h l 0 3 for h l 0 3 the water depth kept decreasing gradually along the weir crest until a sharp flow acceleration near the end of the crest fig 6d 6f and 6g 6i present two groups of data above vegetated weir crests with different plant cluster densities the rise in upstream water level due to the vegetation was generally insignificant increasing gently with both increasing plant density and length of vegetation cover the presence of vegetation roughness also made the constant depth section vanish at smaller h l for instance the broad crested weir overflow in fig 6i shows monotonically decreasing depth for 0 2 h l 0 25 over the dense vegetation layer while a horizontal free surface is shown over the smooth crest under very similar flow rates it is known that the plants hold a low speed flow layer and produce a shear layer at the top of the canopy where vertical momentum exchange takes place between the fast and slow flows all the way along the crest furthermore it is noteworthy that the disturbance of sparsely distributed plant clusters on a relatively long weir crest resulted in some standing waves at small flow rates fig 6f the standing waves moved gradually towards the downstream end of the crest with increasing h l and disappeared at h l 0 22 the discharge coefficient cd was derived from eq 1 for all tests a dimensional analysis suggests the relevance of weir height p weir crest length l upstream depth above crest h and equivalent roughness height of the vegetation cover ks yielding dimensionless length scales h l h h p and h ks that affect cd the raw data of h q cd relation for all crest lengths are provided in the appendix the corresponding relationships are plotted in fig 7 a 7c fig 7a showes that cd increased monotonically with increasing h l for a given crest roughness condition similar to the previous observations on smooth crested weirs e g azimi and rajaratnam 2009 for example the present smooth crest data indicate that cd increased from cd 0 35 to 0 44 when the relative upstream depth to crest length increased from h l 0 1 to 1 33 in good agreement with the predictions of hager and schwalt 1994 the weirs of the same crest surface condition but different crest lengths showed consistent increasing trends for the cd h l relationship which are characterized by a change in the increasing rate of cd around h l 0 4 that is with increasing h l the relatively low discharge coefficient of broad crested weir flow 0 1 h l 0 4 increased faster than that of narrow crested weir flow 0 4 h l 1 5 did in the present study a constant weir height p 0 2 m was adopted and the dimensionless flow rate is characterized by the relative upstream depth above crest to total depth in a range of 0 17 h h p 0 6 fig 7b shows that cd increased with increasing h h p for a given weir model the increasing slope was mildest for the smooth crest and became steeper as the crest surface was roughened by vegetation of increasing roughness height ks for most datasets a simplistic linear correlation is able to achieve a correlation coefficient r 2 0 88 for a given roughness condition the effect of smooth or roughened crest length l on cd can be noted between the datasets of the same symbol shape showing a reduced level of cd over an elongated crest for a certain flow rate which can be also told from fig 7a both fig 7a and 7b suggest remarkable reduction of cd at high vegetation densities e g ks 147 and 318 mm this reflects a deterioration of weir discharge capacity due to the additional flow resistance associated with the flexible plants fig 7c demonstrates the variation of cd with dimensionless roughness height h ks that varies for different roughness types and flow rates for each weir model cd decayed significantly if the roughness height became greater with reference to the approach head thus reducing h ks for instance of the vegetated weirs with the crest length l 1 0 m the cd h ks relationship is plotted in the small window for clarity drastic reduction of cd from 0 36 to 0 16 is shown for h ks 5 that corresponded to the high density plant cluster configurations indeed when the canopy was dense and flow rate was small the majority of the overflow column had to fight its way through the porous vegetation layer at very low velocity where the discharge capacity was sensitive to the drag forces by stems and leaves when the flow rate was increased so that most additional flow was conveyed over the vegetation layer at much higher velocity the friction force by the submerged vegetation roughness became predominant and the influence of flow rate variation on the variation of cd was less significant 4 discussion the present results indicated that in addition to the relative upstream head to crest length and equivalent roughness height the discharge coefficient cd was also affected by the height length ratio of weir p l for a broad crested weir with 0 1 h l 0 4 and by the weir roughness height ratio p ks for a narrow crested weir with 0 4 h l 1 5 the discharge coefficient of a rectangular vegetated crested weir may be then approximated in the following forms for 0 1 h l 0 4 and 0 4 h l 1 5 respectively 3 c d 0 36 tanh 3 5 h l 0 1 h k s 0 4 p l 0 8 f o r 0 1 h l 0 4 4 c d 0 39 h l 2 h k s 0 85 p k s 0 58 0 09 f o r 0 4 h l 1 5 the correlation coefficients are r 2 0 84 and 0 91 fig 8 a and 8b compare eqs 3 and 4 with all measured data where f 1 tanh 3 5 h l 0 1 h ks 0 4 p l 0 8 and f 2 h l 2 h ks 0 85 p l 0 58 0 09 fig 8c shows a direct comparison between all calculated and measured cd values the shallow area marks an uncertainty range of 10 for prediction by the equations covering most data points the quantitative probability distribution of the calculation error relative to the measured values is presented in fig 8d for all 194 tests it is shown that 72 7 of the predictions had errors 5 and the percentages for errors 10 15 and 20 were 90 7 96 9 and 98 5 respectively the total flow resistance is related to the height front area and rigidity of single vegetation elements as well as to the accumulative effects determined by element density arrangement and total coverage area in this study the flow resistance effect is simplistically characterized by ks which is a further function of these vegetation characteristics quantitative description of their relationship requires detailed boundary layer measurement that is beyond the scope of this work the present results imply that for the tested range of vegetation resistance the loss of weir discharge capacity can be subject to different impacts of the vegetation height and area for broad and narrow crested weirs and their effects are sensitive to the upstream water head in reality vegetation can be washed away once the flow velocity exceeds some critical value leading to risk of sudden rise in weir discharge for flow measurement based on the upstream water level it is important to accurately estimate the equivalent roughness height of flexible vegetation which is usually difficult in field environment therefore flow estimation over vegetated weir or weir like structures should be only carried out for sufficiently large flow rates with preference of narrow weir crest the finding may also provide implication for predicting flow change caused by soft debris accumulation behind instream structures 5 conclusions this work presents an experimental investigation of discharge coefficient for finite crest length weirs with the crest surface roughened by flexible artificial vegetation the tested vegetation configurations were characterized by equivalent roughness height ranging from ks 18 to 318 mm compared to the smooth crested weir a vegetated crested weir required a longer crest or lower flow rate to achieve a horizontal free surface section above the crest and standing waves were observed on the crest for small discharges passing over sparsely distributed plant elements although the flexible plants reduced flow separation at the crest edges the flow resistance introduced by the vegetation layer resulted in significant decrease in the discharge coefficient cd the weir flows tested in the present study belonged to broad crested weir flow 0 1 h l 0 4 and narrow crested weir flow 0 4 h l 1 5 and a change in the deterioration rate of cd with decreasing h l was observed around h l 0 4 in addition to the flow rate and total crest length cd was found to be sensitive to the equivalent roughness height of the vegetation canopy associated with the variation of vegetation type density and element arrangement particularly at small flow rates given a proper estimate of the vegetation equivalent roughness height two empirical correlation formulae were proposed for discharge coefficient correction over vegetated crested weirs of different crest lengths so that flow estimation was possible at relatively large flow rates with practically acceptable accuracy credit authorship contribution statement ruidi bai conceptualization methodology visualization writing original draft maolin zhou investigation formal analysis zhou yan investigation formal analysis jianmin zhang resources supervision funding acquisition hang wang conceptualization methodology validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported financially by the national natural science foundation of china grant no 52130904 51709192 and the natural science foundation of sichuan province grant no 2022nsfsc0970 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129552 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
1922,lake extraction from remote sensing images is an important approach to monitoring water resources it provides guidance for aiding in maintaining natural ecological balance through the artificial adjustment of lake water resources cloud shadows are common interference factors in lake extraction from optical images in this paper we proposed a deep learning network based on a novel transformer architecture to extract lakes from sentinel 2 imagery to determine how training datasets affect misclassifications of cloud shadows we produced five training datasets that contained different proportions of cloud shadows to train the network the highest proportion of cloud shadows among them was 4 we found that when the training dataset contained 4 cloud shadows the obtained model could effectively reduce the misclassification of cloud shadows and improve the accuracy of lake extraction and with this model the evaluation results over the validation dataset achieved an overall accuracy oa of 0 9954 and a kappa of 0 9568 in addition the transformer based network was applied in the endorheic basin of tibetan plateau to further evaluate the generalization ability of the network over a large area the global surface water gsw dataset from the european commission joint research centre was used as a reference to validate our results in this area our experiment and results demonstrated the underlying potential of the transformer based network for improving image classification of optical imagery by reducing cloud shadow inferences keywords lake extraction deep learning cloud shadow transformer semantic segmentation 1 introduction lakes are important natural resources related to human survival and development they regulate river runoff provide irrigation water and maintain biodiversity adrian et al 2009 zhang et al 2019a b lakes rapidly change under the influence of human beings and the climate ma et al 2010 moser et al 2019 song et al 2014a b zhu et al 2020 therefore accurate extraction of lakes to master their changing states is a necessary basis for studies on natural environmental protection restoration and land cover change woolway et al 2020 with the advantages of fast and large scale observations using satellite borne sensors studies have increasingly extracted lakes using satellite remote sensing images differences in spectral characteristics of these remote sensing images are usually used to separate lakes from other ground objects shrestha and di 2013 xu et al 2021a b traditional methods of lake extraction include the single band threshold method the multiband spectral relationship method and the water index method feyisa et al 2014 with the development of deep learning technology in the remote sensing field deep learning models have also been utilized for lake extraction compared with traditional methods methods based on deep learning models are able to learn more complex and nonlinear characteristics of lakes ghosh et al 2020 kansizoglou et al 2021 minaee et al 2022 existing deep learning based lake extraction studies have primarily utilized convolutional neural networks cnns chen et al 2018 james et al 2021 li et al 2019a b pu et al 2019 cnns have dominated in the computer vision cv field for a long time and are well developed neural networks alzubaidi et al 2021 zhang and zhu 2018 however novel vision transformers have been rapidly developing in the cv field in recent years han et al 2023 vaswani et al 2017 and have demonstrated better performance parameters and results than cnn based models as such they have begun to replace cnns and attention enhanced cnns bazi et al 2021 dosovitskiy et al 2021 he et al 2021 unlike attention enhanced cnns khan et al 2022 vision transformers are fully attention based networks thereby better imitating the human visual attention mechanism aleissaee et al 2022 however in the remote sensing field few vision transformer networks have been investigated for lake extraction from remote sensing images chen et al 2021 zhang et al 2021 in addition due to the similarity between lakes and cloud shadows in terms of spectral characteristics amin et al 2013 cloud shadows are often misclassified as lakes during lake extraction three approaches to address cloud shadow interference in lake extraction have been investigated in past studies including directly utilizing cloud free images utilizing all available images with cloud shadow masks and utilizing all available images based on end to end methods that distinguish lakes from cloud shadows cheng et al 2020 jia et al 2021 yuan et al 2020 zhu et al 2022 the approach to directly utilize cloud free images is relatively simple when selecting images cloud free images can be obtained by screening according to the cloud coverage wang et al 2020 li et al 2021a b or by combining multiple images yuan et al 2021 this method avoids the influence of cloud shadows at the beginning however obtaining cloud free images is difficult in areas that are covered by clouds all year round in addition for deep learning based methods lake extraction models trained by cloud free images may not be suitable for images with cloud shadows which results in poor generalization ability the approach to utilize all available images with cloud shadow masks includes two stages cloud shadow mask acquisition and lake extraction the cloud shadow masks are used to exclude areas covered by cloud shadows in other words cloud shadow masks are used as a priori knowledge to avoid misclassifying cloud shadows as lakes thus cloud shadow masks are critical information for this approach some cloud shadow masks can be obtained from the source of the remote sensing images coluzzi et al 2018 hu et al 2020 they can be also obtained using cloud shadow detection algorithms cloud shadow detection algorithms can be divided into traditional algorithms and deep learning based algorithms li et al 2021a b yan et al 2018 traditional algorithms can be divided into threshold based algorithms li et al 2017 such as fmask function of mask zhu and woodcock 2012 and multi temporal based algorithms zhang et al 2020 zhu and helmer 2018 such as tmask multitemporal mask zhu and woodcock 2014 zhu et al 2015 additionally deep learning based cloud shadow detecting algorithms utilize models trained by cloud shadow samples to predict cloud shadows in images hughes and hayes 2014 li et al 2019a b zhan et al 2017 however the approach i e utilizing all available images with cloud shadow masks to extract lakes takes extra time and requires additional procedures e g acquiring cloud shadow masks and using them to exclude areas covered by cloud shadows thus it is not an efficient method to extract lakes the approach to utilize all available images based on end to end methods is to distinguish lakes from cloud shadows during the process of extracting lakes thus this approach is the most efficient and has demonstrated potential in large scale lake extraction from remote sensing images with cloud shadows to achieve end to end lake extraction deep learning networks are often employed sit et al 2020 however few studies have focused on evaluating the feasibility of addressing cloud shadow interference using deep learning networks as the deep learning based method is a data driven method shorten and khoshgoftaar 2019 and the representativeness and quality of samples in the training dataset greatly affect the performance of the model we hypothesized that the cloud shadow interference issue cohen et al 2019 gao et al 2019 could be addressed by investigating how the training data affected the accuracy of lake extraction therefore in this study we built a neural network based on the novel transformer architecture liu et al 2021 to extract lakes from remote sensing images we produced five training datasets that contained different proportions of cloud shadows in order to training the proposed lake extraction network so that we could explore how cloud shadows affected the accuracy of lake extraction based on the five different training datasets the performance of the transformer based lake extraction network and the ability to address the interference of cloud shadows were illustrated in this study finally the proposed network was applied to the endorheic basin of tibetan plateau to demonstrate its generalization capabilities for large scale and automatic lake extraction 2 methodology 2 1 study area our study area was the endorheic basin of tibetan plateau located between 78 66 93 66 e and 29 66 38 63 n fig 1 the endorheic basin has the largest proportion of lakes in tibetan plateau there are approximately 1700 lakes widely and densely distributed in the endorheic basin kang et al 2010 the lakes in this area affect the global energy and water cycle and they also reflect the degree of regional precipitation and melting glaciers zhang et al 2011 the environmental changes of this area also affect the natural ecological conditions of the world therefore monitoring the dynamic changes of these lakes is very important song et al 2014a b zhang et al 2017 however due to the complex terrain and the influence of multiple monsoons thick clouds often occur in the endorheic basin which leads to difficulty of acquiring clear sky images therefore it was a favorable case study area for evaluation of the transformer based lake extraction network and exploration of how the training datasets which contained different proportions of cloud shadows affected the accuracy of lake extraction 2 2 data source the data sources in this study included sentinel 2 imagery european space agency esa worldcover 10 m 2020 product zanaga et al 2021 and global surface water gsw dataset pekel et al 2016 sentinel 2 imagery which is a popular data source for land and ocean monitoring drusch et al 2012 was utilized to produce the image data for training and testing of the network s capability for large scale automatic lake extraction the sentinel 2 image had spatial resolution bands of 10 m with 5 days revisiting period thus it was helpful when producing training data with high spatial and temporal resolution esa worldcover 10 m 2020 product was utilized as a reference to assist lake labeling in this study as it was also generated based on the sentinel 2 images in 2020 its spatial resolution was 10 m the esa worldcover product included 11 different land cover classes the class permanent water bodies was used in our study the global surface water gsw dataset from the european commission joint research centre was selected to compare with our network s lake extraction results in order to validate its accuracy the gsw dataset was a global water body product with a relatively high degree of recognition the gsw dataset was retrieved from landsat images thus the spatial resolution of the gsw dataset was 30 m the seasonality map of the gsw dataset in 2021 was used in this study it showed permanent and seasonal water and the number of months water was present in 2021 2 3 transformer based lake extraction network a transformer network is a deep learning network that implements attention by dispensing with traditional recurrence and convolutions and alternatively relying entirely on a self attention mechanism the self attention mechanism allows the inputs to interact with each other self and find out who they should pay more attention to attention the outputs are aggregates of these interactions and attention scores thus the transformer network is a backbone network and was used to better capture the overall connection and differences between lakes and other ground objects in this study the overall structure of the transformer based lake extraction network is shown in fig 2 it was in general an encoder decoder structure ji et al 2021 the encoder was established based on the swin transformer the swin transformer is a hierarchical vison transformer it computes self attention with shifted windows and the shifted window brings greater efficiency by limiting self attention computation to non overlapping local windows while achieving cross window connection liu et al 2021 the efficiency improvement is beneficial to remote sensing images since such images are larger in size and require an efficient method to compute self attention the encoder was composed of four stages each stage achieved a self attention calculation globally using swin transformer blocks between the swin transformer blocks a patch merging module was introduced to produce a hierarchical representation by merging the patches produced by the swin transformer blocks in addition a patch partition module was introduced to reshape the original images into a sequence of flattened 2d patches since the swin transformer block received a sequence of token embeddings a linear embedding module was used to transform the image patches into a sequence of patch tokens with the four stages of swin transform blocks the encoder output four different scales of feature maps the sizes were 1 16 1 32 1 64 and 1 128 of the input size respectively and they formed a set of multi scale feature maps that contained different detailed lake features the decoder included a pyramid pooling module ppm and a feature pyramid network fpn to parse and integrate the self attention based feature maps xiao et al 2018 the function of ppm was to produce scene level features the four scales of object level feature maps that came from the encoder were combined with scene level features by the fpn lin et al 2017 which then formed the multi level integrated features in this study the patch size of images was set to 2 the embedding dimension was set to 96 for the 3 channel inputs of swir nir and red and the size of the shifted window was set to 9 the number of layers in each stage was set to 2 2 6 2 and the number of heads of multihead self attention was set to 3 6 12 24 the pyramid pooling of ppm in the decoder had four levels and the scales of them were set to 1 2 3 and 6 respectively which meant ppm calculated the average value for each patch sized 1 1 pixel 2 2 pixels 3 3 pixels and 6 6 pixels these parameter settings allowed us to obtain relatively high accuracy with relatively short training times 2 4 training datasets sentinel 2 imagery and the esa worldcover 10 m 2020 product were the data sources used to make training datasets the process of making training datasets is shown in fig 3 including image data production and the ground truth data production to produce the image data of the training datasets three water sensitive bands zhang et al 2019a b short wave infrared swir near infrared nir and red were utilized since water bodies are strongly absorbed at these three bands the swir was 20 m and the nir and red were 10 m in spatial resolution thus the 20 m swir image was upsampled to 10 m using the nearest neighboring algorithm and stacked with nir image and red image in addition the sentinel 2 images from 2020 were selected to make training data in this study as that was the year of the esa worldcover data product to produce the ground truth data of the training data efficiently the esa worldcover 10 m 2020 product was utilized to assist lake labeling the esa worldcover 10 m 2020 product represented land cover status at the yearly scale so the lake boundaries from the esa worldcover data had to be checked and manually modified based on the selected sentinel 2 images when modifying the lakes the lakes which were covered by cloud shadows from thin clouds were also labeled in addition to accurately calculate the proportion of cloud shadows in the training data we manually labeled the cloud shadows using visual interpretation no cloud data or cloud shadow mask data were used in labeling the cloud shadows when labeling cloud shadows those cast by higher clouds onto lower clouds were also labeled because such shadows have been easily misclassified as lakes in lake extraction to explore how different proportions of cloud shadows affected the accuracy of lake extraction we generated five training datasets no cloudshadow cloudshadow 1 cloudshadow 2 cloudshadow 3 and cloudshadow 4 as shown in table 1 the proportions of cloud shadows for the five training datasets were 0 1 2 3 and 4 respectively the proportion was calculated by counting pixels of cloud shadows the proportion values of lakes in the five training datasets were the same 15 41 which ensured that differences in accuracy were not created by or attributable to differences of lake proportion to ensure that the accuracy of lake extraction was not affected by differences in sample sizes or number of samples each sample in all five training datasets had the same size 272 272 pixels the total number of samples for each training dataset was 5000 all samples in the training datasets came from five scenes of sentinel 2 images the locations of these are shown in fig 4 the images contained typical large sized and small sized lakes including selincuo lake cuo e lake bangecuo lake qixiangcuo lake e yacuoqiong lake and so on the validation dataset was produced using two additional sentinel 2 images table 2 which contained 220 samples with sized 272 272 pixels the 220 samples contained differently sized lakes and different types of cloud shadows so as to evaluate the ability of the proposed network to address cloud shadow interference 2 5 training settings we selected the adaptive moment estimation adam as the optimizer to train the network and the number of training epochs was 200 linear learning rate was applied the initial learning rate was set to 0 000003 and it reached 0 00006 by linearly changing small multiplicative factor after 10 epochs to prevent overfitting we set the weight decay to 0 01 and the batch size was set to 4 based on the size of the gpu memory 2 6 evaluation metrics the evaluation metrics used in this study included the overall accuracy oa precision recall intersection over union iou and kappa oa is the ratio of the sum of different types of correctly predicted pixels to the total number of pixels it was used to evaluate the prediction effect of the lake extraction network on the whole the calculation formula of oa can be represented as 1 oa tp t n tp f p t n f n oa was calculated by the confusion matrix where tp fp fn and tn are the number of true positives correctly predicted number of lake pixels false positives incorrectly predicted number of lake pixels false negatives unpredicted number of lake pixels and true negatives correctly predicted number of not lake pixels respectively in the confusion matrix precision is the ratio of the correctly predicted lake pixels to the total number of pixels predicted as lake it reflects the correct degree of pixels prediction the calculation formula of precision can be represented as 2 precision tp tp f p precision can be calculated by a confusion matrix where tp and fp have identical meanings to tp and fp as used in oa recall is the ratio of the correctly predicted lake pixels to the total number of true lake pixels it reflects the complete degree of pixels prediction the calculation formula of recall can be represented as 3 recall tp tp f n recall can be calculated by a confusion matrix where tp and fn have identical meanings to tp and fn as used in oa iou is the intersection ratio between the pixels predicted as lake and the true lake pixels it reflects the degree of coincidence of the predicted lake images and true boundaries of lakes the calculation formula of the iou is 4 iou tp tp f n f p iou can also be calculated by a confusion matrix where tp fp and fn have identical meanings to tp fp and fn as used in oa kappa measures the consistency between the number of predicted pixels of elements of different classes and the real number of pixels cohen 1960 the calculation formula of kappa is 5 kappa po p e 1 p e in the formula po is the oa when the numbers of true pixels in each class were a1 a2 a x the predicted numbers of samples in each class were b1 b2 bx additionally n is the total number of pixels pe in the formula can be represented as 6 pe a 1 b 1 a 2 b 2 a x b x n n 3 results 3 1 accuracy evaluation results the proposed transform based lake extraction network was evaluated on the validation dataset presented in section 3 1 table 3 shows the evaluation results of five models acquired by training the proposed network using the five training datasets presented in table 1 respectively as shown in table 3 the transformer based lake extraction network achieved good performance in the experiment the results of oa precision recall iou and kappa were satisfied in general which showed that the proposed transformer based network was able to successfully extract lakes from remote sensing images secondly the oa precision recall iou and kappa of model 1 to model 4 were higher than those of model 0 this indicated that the prediction accuracy of the network was greatly improved by the training datasets containing cloud shadows additionally the proportions of the cloud shadows in the five training datasets were far lower than the proportion of the lakes which showed that a small number of cloud shadows in the training data improved the prediction accuracy of the network thirdly training the network using the datasets containing different proportions of cloud shadows led to different results the higher the proportion of cloud shadows in the training dataset the higher the prediction accuracy measured by oa precision recall iou and kappa 3 2 prediction result analysis we analyzed the prediction results with three cases as follows including comparisons of cloud shadow misclassification among different models the prediction results for large sized lakes and the prediction results for small sized lakes 3 2 1 comparison of cloud shadow misclassification among different models when cloud shadows were not included in the training dataset i e the no cloudshadow dataset in table 1 the model i e model 0 could not effectively distinguish between lakes and cloud shadows thus many cloud shadows were misclassified as lakes whether these were large sized as shown in fig 5 b or small sized cloud shadows as shown in fig 6 b did not matter when the proportion of cloud shadows in the training dataset was set to 1 i e the cloudshadow 1 dataset in table 1 the number of the cloud shadows misclassified as lakes significantly decreased as shown in fig 5 c for large sized cloud shadows and fig 6 c for small sized cloud shadows although such misclassifications still occurred more often with larger cloud shadows the trained network i e model 1 was able to distinguish between lakes and cloud shadows in most situations when the proportion of cloud shadows was increased to 2 i e the cloudshadow 2 dataset in table 1 few small sized cloud shadows were misclassified as lakes fig 6 d however some large sized cloud shadow pixels were still misclassified as lake pixels fig 5 d when the proportion of cloud shadows was increased to 3 i e the cloudshadow 3 dataset in table 1 the trained network i e model 3 was nearly able to address cloud shadow interference as shown in fig 5 e for large sized cloud shadows and fig 6 e for small sized cloud shadows a small amount of misclassification occurred with large sized cloud shadows and misclassified pixels were further decreased when the proportion of cloud shadows reached 4 i e the cloudshadow 4 dataset in table 1 which was the highest proportion in the experiment the trained network i e model 4 addressed the interference of cloud shadows in the lake extraction very well as shown in fig 5 f and fig 6 f the best prediction result was also obtained by this model with this network model 4 neither small sized nor large sized cloud shadows were misclassified 3 2 2 analysis for the prediction result of large sized lake we classified lakes larger than 10 km2 as large sized lakes and lakes smaller than 10 km2 as small sized lakes the prediction result for the large sized lakes is shown in fig 7 the proposed lake extraction network successfully classified all of the large sized lakes due to their size shape and relatively apparent boundaries and the boundaries of the predicted large sized lakes were clear and accurate therefore the proposed network shows very excellent performance in extracting large sized lakes in the experiment by comparing the prediction results of the large sized lakes we found that training the proposed network using different proportions of cloud shadows did not affect the prediction results for large sized lakes this demonstrated that the prediction result for the large sized lakes was determined by the ability of the proposed network and the proportion of lakes in the training dataset and was not impacted by the proportion of cloud shadows in the training dataset in the experiment the proportion of lakes in the training dataset was set to 15 41 and the prediction result showed that this proportion was able to satisfy the demands of large sized lake extraction 3 2 3 analysis of the prediction result of small sized lakes the prediction results for small sized lakes are shown in fig 8 most of the small sized lakes were correctly predicted by the proposed network however due to their smaller sizes and the fact that they were easily covered by cloud shadows several small sized lakes were missed during extraction some pixels on the edge of the small sized lakes were also missed additionally the small sized lakes were not only small in shape but also shallow in depth meaning that the signals received by the sensors were weak therefore small sized lake extraction was a challenge to the proposed network comparing the prediction results for small sized lakes we found that the prediction results were not affected by the proportion of cloud shadows in the training dataset this showed that the prediction results for the small sized lakes were also determined by the ability of the network and the proportion of lakes in the training dataset the proportion of lakes in the training dataset i e 15 41 was sufficient for the extraction for most small sized lakes for the omission of lake pixels we believe it could be improved by increasing the proportion of small sized lakes and adding more types of small sized lakes in the training dataset 4 application in the endorheic basin of tibetan plateau 4 1 data and procedure the proposed network was also applied to lake extraction in a large area we used model 4 which performed best in our experiment to extract lakes in the endorheic basin of tibetan plateau from sentinel 2 imagery the endorheic basin of tibetan plateau covers 112 tiles of sentinel 2 imagery as shown in fig 9 we utilized images from between july and september 2021 to extract lakes since the volume of the lakes was largest during this period xu et al 2021a b fang et al 2023 these images contained different proportions of cloud shadows and no cloud shadow or cloud removal methods were utilized all images were directly used by the model to extract lakes from sentinel 2 images and no pre process or post process measures were undertaken to refine the extraction results we obtained 609 scenes of sentinel 2 imagery in total and each of them was used to predict lakes using model 4 thus we obtained 609 scenes of lake prediction results for the 112 tiles the lake extraction results from the same tile were composited using a maximum area algorithm then the composited results were merged to form the lake extraction result in the whole area to validate the prediction result we also composited and merged rgb bands to generate a true color image for this area using google earth engine and overlaid the lake extraction results on top of it as shown in fig 10 4 2 lake extraction results as shown in fig 10 the extracted lakes were consistent with the lakes of sentinel 2 images in the lake distribution and extent which showed that the proposed network could be applied in large areas for automatic lake extraction additionally nearly no cloud shadows were misclassified as lakes in the large scale lake extraction this was a benefit of using training datasets with a certain proportion of cloud shadows to train the network we further observed the extraction results of four lakes including selincuo lake cuo e lake zhari namco lake and ayagekumukuli lake they were all clear and accurate with complete boundaries as shown in fig 11 4 3 comparison with the global surface water gsw dataset the lake extraction result was compared with the gsw dataset in terms of the area of lake extraction intersecting area spatial distribution and spatial resolution the area of the extracted lakes and the area of gsw dataset in the endorheic basin of tibetan plateau are shown in table 4 they were 37861 897 km2 and 42226 615 km2 respectively and the intersecting area was 37116 147 km2 accounting for 98 030 of the total lake area extracted by the network and 87 898 of the water body area of the gsw dataset this showed that the lake extraction result was almost consistent with the gsw dataset we believed that the difference of 1 970 between the intersecting area and the total extracted area was mostly attributable to small lakes we observed that our lake extraction network extracted more small lakes as shown in fig 15 for the gsw dataset the reason that the proportion 87 898 of intersecting area accounted for less was that the gsw dataset included both lakes and rivers in addition the lake extraction result by the proposed network was consistent with the gsw dataset in spatial distribution as shown in fig 12 the boundary of extracted lakes was also consistent with the maximum water extent of the lakes in gsw dataset as shown in fig 13 in addition our results outperformed the gsw dataset in spatial resolution since the remote sensing image we used was 10 m the lakes extracted using our network were more refined than those obtained via the gsw dataset as shown in fig 14 additionally as a benefit of having used sentinel 2 images with higher spatial resolutions more very small lakes were extracted by our model as shown in fig 15 5 discussion and conclusion many existing studies have improved lake extraction capabilities by innovating network structure and adjusting the parameters of networks but training data have often been ignored differing from these studies we not only developed a network based on a novel transformer architecture to extract lakes from sentinel 2 imagery but also explored the performance of the network from the perspective of training data we designed five training datasets that contained different proportions of cloud shadows to train the network to explore how cloud shadows in training datasets affect lake extraction results our results proved that the training data should be given the same attention as the networks in addition the proposed network was applied in a large area to further evaluate its generalization ability and exploit the application prospects of the network in automatic lake extraction in such an area the transformer based network demonstrated very good performance in the lake extraction from sentinel 2 imagery as confirmed from the accuracy evaluation results and prediction results in the endorheic basin of tibetan plateau with the transformer based network lakes could be directly extracted from remote sensing images with no additional pre or post processes required to refine the lake extraction results therefore the transformer based network could be applied in large scale areas for automatic lake extraction the cloud shadow interference issue in lake extraction could also be addressed by the proposed network the training dataset contained a certain proportion of cloud shadows which illustrated once more the important role played by the training dataset in deep learning based methods we found that increasing the proportion of cloud shadows in the training dataset was an effective way to avoid cloud shadows being misclassified as lakes when the proportion of cloud shadows in the training dataset reached 4 we obtained this study s best accuracy evaluation results they were 0 9954 of oa precision of 0 9797 recall of 0 9397 0 9217 of iou and 0 9568 of kappa additionally we observed that the higher the proportion of cloud shadows in the training dataset the higher the accuracy of the trained network in addition we also found that boundary accuracy for the extracted lakes was not impacted by the proportion of cloud shadows in the training dataset the experiment showed that no matter whether the training data contained cloud shadows and irrespective of their proportions i e higher or lower there were no significant differences in the lake boundaries for the extracted lakes we assumed that increasing cloud shadows in the training dataset helped the network learn more features of cloud shadows thereby avoiding misclassification but the accuracy of the lake boundary was still determined by the lake features in the training dataset the proportions of lakes in the training datasets were all the same in this study thus the prediction results showed nearly the same accuracy result in all extracted lakes in summary the proposed transformer based network demonstrated excellent performance in lake extraction from remote sensing images by adding a certain proportion of cloud shadows to the training dataset the network was better able to address the interference of cloud shadows thus we did not need to select clear sky images or eliminate the interference of cloud shadows by additional processing methods when extracting lakes the trained network could also be used for automatic lake extraction in a large area due to its robustness in addition this study also showed that transformer based networks could have great application potential in remote sensing image classification in the future we will apply our network to extract lakes in a larger area and improve its generalization ability by adding more types of training samples to handle the interference of other factors that affect lake extraction data availability the training datasets validation dataset and prediction results in the study are available at https doi org 10 6084 m9 figshare 21529245 v1 the sentinel 2 images used in the study were obtained through the copernicus open access hub scihub esa worldcover 10m 2020 product was through its official website https esa worldcover org en and the global surface water dataset was obtained through the global surface water explorer https global surface water appspot com credit authorship contribution statement xiangbing yan methodology validation writing original draft data curation jia song conceptualization methodology writing review editing funding acquisition software supervision resources yangxiaoyue liu writing review editing shanlong lu writing review editing yuyue xu writing review editing chenyan ma writing review editing supervision resources yunqiang zhu writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the national key research and development program of china 2021yfe0117800 2022yff0711602 the 14th five year informatization plan of chinese academy of sciences cas wx2021sf 0106 and the national data sharing infrastructure of earth system science http www geodata cn 
1922,lake extraction from remote sensing images is an important approach to monitoring water resources it provides guidance for aiding in maintaining natural ecological balance through the artificial adjustment of lake water resources cloud shadows are common interference factors in lake extraction from optical images in this paper we proposed a deep learning network based on a novel transformer architecture to extract lakes from sentinel 2 imagery to determine how training datasets affect misclassifications of cloud shadows we produced five training datasets that contained different proportions of cloud shadows to train the network the highest proportion of cloud shadows among them was 4 we found that when the training dataset contained 4 cloud shadows the obtained model could effectively reduce the misclassification of cloud shadows and improve the accuracy of lake extraction and with this model the evaluation results over the validation dataset achieved an overall accuracy oa of 0 9954 and a kappa of 0 9568 in addition the transformer based network was applied in the endorheic basin of tibetan plateau to further evaluate the generalization ability of the network over a large area the global surface water gsw dataset from the european commission joint research centre was used as a reference to validate our results in this area our experiment and results demonstrated the underlying potential of the transformer based network for improving image classification of optical imagery by reducing cloud shadow inferences keywords lake extraction deep learning cloud shadow transformer semantic segmentation 1 introduction lakes are important natural resources related to human survival and development they regulate river runoff provide irrigation water and maintain biodiversity adrian et al 2009 zhang et al 2019a b lakes rapidly change under the influence of human beings and the climate ma et al 2010 moser et al 2019 song et al 2014a b zhu et al 2020 therefore accurate extraction of lakes to master their changing states is a necessary basis for studies on natural environmental protection restoration and land cover change woolway et al 2020 with the advantages of fast and large scale observations using satellite borne sensors studies have increasingly extracted lakes using satellite remote sensing images differences in spectral characteristics of these remote sensing images are usually used to separate lakes from other ground objects shrestha and di 2013 xu et al 2021a b traditional methods of lake extraction include the single band threshold method the multiband spectral relationship method and the water index method feyisa et al 2014 with the development of deep learning technology in the remote sensing field deep learning models have also been utilized for lake extraction compared with traditional methods methods based on deep learning models are able to learn more complex and nonlinear characteristics of lakes ghosh et al 2020 kansizoglou et al 2021 minaee et al 2022 existing deep learning based lake extraction studies have primarily utilized convolutional neural networks cnns chen et al 2018 james et al 2021 li et al 2019a b pu et al 2019 cnns have dominated in the computer vision cv field for a long time and are well developed neural networks alzubaidi et al 2021 zhang and zhu 2018 however novel vision transformers have been rapidly developing in the cv field in recent years han et al 2023 vaswani et al 2017 and have demonstrated better performance parameters and results than cnn based models as such they have begun to replace cnns and attention enhanced cnns bazi et al 2021 dosovitskiy et al 2021 he et al 2021 unlike attention enhanced cnns khan et al 2022 vision transformers are fully attention based networks thereby better imitating the human visual attention mechanism aleissaee et al 2022 however in the remote sensing field few vision transformer networks have been investigated for lake extraction from remote sensing images chen et al 2021 zhang et al 2021 in addition due to the similarity between lakes and cloud shadows in terms of spectral characteristics amin et al 2013 cloud shadows are often misclassified as lakes during lake extraction three approaches to address cloud shadow interference in lake extraction have been investigated in past studies including directly utilizing cloud free images utilizing all available images with cloud shadow masks and utilizing all available images based on end to end methods that distinguish lakes from cloud shadows cheng et al 2020 jia et al 2021 yuan et al 2020 zhu et al 2022 the approach to directly utilize cloud free images is relatively simple when selecting images cloud free images can be obtained by screening according to the cloud coverage wang et al 2020 li et al 2021a b or by combining multiple images yuan et al 2021 this method avoids the influence of cloud shadows at the beginning however obtaining cloud free images is difficult in areas that are covered by clouds all year round in addition for deep learning based methods lake extraction models trained by cloud free images may not be suitable for images with cloud shadows which results in poor generalization ability the approach to utilize all available images with cloud shadow masks includes two stages cloud shadow mask acquisition and lake extraction the cloud shadow masks are used to exclude areas covered by cloud shadows in other words cloud shadow masks are used as a priori knowledge to avoid misclassifying cloud shadows as lakes thus cloud shadow masks are critical information for this approach some cloud shadow masks can be obtained from the source of the remote sensing images coluzzi et al 2018 hu et al 2020 they can be also obtained using cloud shadow detection algorithms cloud shadow detection algorithms can be divided into traditional algorithms and deep learning based algorithms li et al 2021a b yan et al 2018 traditional algorithms can be divided into threshold based algorithms li et al 2017 such as fmask function of mask zhu and woodcock 2012 and multi temporal based algorithms zhang et al 2020 zhu and helmer 2018 such as tmask multitemporal mask zhu and woodcock 2014 zhu et al 2015 additionally deep learning based cloud shadow detecting algorithms utilize models trained by cloud shadow samples to predict cloud shadows in images hughes and hayes 2014 li et al 2019a b zhan et al 2017 however the approach i e utilizing all available images with cloud shadow masks to extract lakes takes extra time and requires additional procedures e g acquiring cloud shadow masks and using them to exclude areas covered by cloud shadows thus it is not an efficient method to extract lakes the approach to utilize all available images based on end to end methods is to distinguish lakes from cloud shadows during the process of extracting lakes thus this approach is the most efficient and has demonstrated potential in large scale lake extraction from remote sensing images with cloud shadows to achieve end to end lake extraction deep learning networks are often employed sit et al 2020 however few studies have focused on evaluating the feasibility of addressing cloud shadow interference using deep learning networks as the deep learning based method is a data driven method shorten and khoshgoftaar 2019 and the representativeness and quality of samples in the training dataset greatly affect the performance of the model we hypothesized that the cloud shadow interference issue cohen et al 2019 gao et al 2019 could be addressed by investigating how the training data affected the accuracy of lake extraction therefore in this study we built a neural network based on the novel transformer architecture liu et al 2021 to extract lakes from remote sensing images we produced five training datasets that contained different proportions of cloud shadows in order to training the proposed lake extraction network so that we could explore how cloud shadows affected the accuracy of lake extraction based on the five different training datasets the performance of the transformer based lake extraction network and the ability to address the interference of cloud shadows were illustrated in this study finally the proposed network was applied to the endorheic basin of tibetan plateau to demonstrate its generalization capabilities for large scale and automatic lake extraction 2 methodology 2 1 study area our study area was the endorheic basin of tibetan plateau located between 78 66 93 66 e and 29 66 38 63 n fig 1 the endorheic basin has the largest proportion of lakes in tibetan plateau there are approximately 1700 lakes widely and densely distributed in the endorheic basin kang et al 2010 the lakes in this area affect the global energy and water cycle and they also reflect the degree of regional precipitation and melting glaciers zhang et al 2011 the environmental changes of this area also affect the natural ecological conditions of the world therefore monitoring the dynamic changes of these lakes is very important song et al 2014a b zhang et al 2017 however due to the complex terrain and the influence of multiple monsoons thick clouds often occur in the endorheic basin which leads to difficulty of acquiring clear sky images therefore it was a favorable case study area for evaluation of the transformer based lake extraction network and exploration of how the training datasets which contained different proportions of cloud shadows affected the accuracy of lake extraction 2 2 data source the data sources in this study included sentinel 2 imagery european space agency esa worldcover 10 m 2020 product zanaga et al 2021 and global surface water gsw dataset pekel et al 2016 sentinel 2 imagery which is a popular data source for land and ocean monitoring drusch et al 2012 was utilized to produce the image data for training and testing of the network s capability for large scale automatic lake extraction the sentinel 2 image had spatial resolution bands of 10 m with 5 days revisiting period thus it was helpful when producing training data with high spatial and temporal resolution esa worldcover 10 m 2020 product was utilized as a reference to assist lake labeling in this study as it was also generated based on the sentinel 2 images in 2020 its spatial resolution was 10 m the esa worldcover product included 11 different land cover classes the class permanent water bodies was used in our study the global surface water gsw dataset from the european commission joint research centre was selected to compare with our network s lake extraction results in order to validate its accuracy the gsw dataset was a global water body product with a relatively high degree of recognition the gsw dataset was retrieved from landsat images thus the spatial resolution of the gsw dataset was 30 m the seasonality map of the gsw dataset in 2021 was used in this study it showed permanent and seasonal water and the number of months water was present in 2021 2 3 transformer based lake extraction network a transformer network is a deep learning network that implements attention by dispensing with traditional recurrence and convolutions and alternatively relying entirely on a self attention mechanism the self attention mechanism allows the inputs to interact with each other self and find out who they should pay more attention to attention the outputs are aggregates of these interactions and attention scores thus the transformer network is a backbone network and was used to better capture the overall connection and differences between lakes and other ground objects in this study the overall structure of the transformer based lake extraction network is shown in fig 2 it was in general an encoder decoder structure ji et al 2021 the encoder was established based on the swin transformer the swin transformer is a hierarchical vison transformer it computes self attention with shifted windows and the shifted window brings greater efficiency by limiting self attention computation to non overlapping local windows while achieving cross window connection liu et al 2021 the efficiency improvement is beneficial to remote sensing images since such images are larger in size and require an efficient method to compute self attention the encoder was composed of four stages each stage achieved a self attention calculation globally using swin transformer blocks between the swin transformer blocks a patch merging module was introduced to produce a hierarchical representation by merging the patches produced by the swin transformer blocks in addition a patch partition module was introduced to reshape the original images into a sequence of flattened 2d patches since the swin transformer block received a sequence of token embeddings a linear embedding module was used to transform the image patches into a sequence of patch tokens with the four stages of swin transform blocks the encoder output four different scales of feature maps the sizes were 1 16 1 32 1 64 and 1 128 of the input size respectively and they formed a set of multi scale feature maps that contained different detailed lake features the decoder included a pyramid pooling module ppm and a feature pyramid network fpn to parse and integrate the self attention based feature maps xiao et al 2018 the function of ppm was to produce scene level features the four scales of object level feature maps that came from the encoder were combined with scene level features by the fpn lin et al 2017 which then formed the multi level integrated features in this study the patch size of images was set to 2 the embedding dimension was set to 96 for the 3 channel inputs of swir nir and red and the size of the shifted window was set to 9 the number of layers in each stage was set to 2 2 6 2 and the number of heads of multihead self attention was set to 3 6 12 24 the pyramid pooling of ppm in the decoder had four levels and the scales of them were set to 1 2 3 and 6 respectively which meant ppm calculated the average value for each patch sized 1 1 pixel 2 2 pixels 3 3 pixels and 6 6 pixels these parameter settings allowed us to obtain relatively high accuracy with relatively short training times 2 4 training datasets sentinel 2 imagery and the esa worldcover 10 m 2020 product were the data sources used to make training datasets the process of making training datasets is shown in fig 3 including image data production and the ground truth data production to produce the image data of the training datasets three water sensitive bands zhang et al 2019a b short wave infrared swir near infrared nir and red were utilized since water bodies are strongly absorbed at these three bands the swir was 20 m and the nir and red were 10 m in spatial resolution thus the 20 m swir image was upsampled to 10 m using the nearest neighboring algorithm and stacked with nir image and red image in addition the sentinel 2 images from 2020 were selected to make training data in this study as that was the year of the esa worldcover data product to produce the ground truth data of the training data efficiently the esa worldcover 10 m 2020 product was utilized to assist lake labeling the esa worldcover 10 m 2020 product represented land cover status at the yearly scale so the lake boundaries from the esa worldcover data had to be checked and manually modified based on the selected sentinel 2 images when modifying the lakes the lakes which were covered by cloud shadows from thin clouds were also labeled in addition to accurately calculate the proportion of cloud shadows in the training data we manually labeled the cloud shadows using visual interpretation no cloud data or cloud shadow mask data were used in labeling the cloud shadows when labeling cloud shadows those cast by higher clouds onto lower clouds were also labeled because such shadows have been easily misclassified as lakes in lake extraction to explore how different proportions of cloud shadows affected the accuracy of lake extraction we generated five training datasets no cloudshadow cloudshadow 1 cloudshadow 2 cloudshadow 3 and cloudshadow 4 as shown in table 1 the proportions of cloud shadows for the five training datasets were 0 1 2 3 and 4 respectively the proportion was calculated by counting pixels of cloud shadows the proportion values of lakes in the five training datasets were the same 15 41 which ensured that differences in accuracy were not created by or attributable to differences of lake proportion to ensure that the accuracy of lake extraction was not affected by differences in sample sizes or number of samples each sample in all five training datasets had the same size 272 272 pixels the total number of samples for each training dataset was 5000 all samples in the training datasets came from five scenes of sentinel 2 images the locations of these are shown in fig 4 the images contained typical large sized and small sized lakes including selincuo lake cuo e lake bangecuo lake qixiangcuo lake e yacuoqiong lake and so on the validation dataset was produced using two additional sentinel 2 images table 2 which contained 220 samples with sized 272 272 pixels the 220 samples contained differently sized lakes and different types of cloud shadows so as to evaluate the ability of the proposed network to address cloud shadow interference 2 5 training settings we selected the adaptive moment estimation adam as the optimizer to train the network and the number of training epochs was 200 linear learning rate was applied the initial learning rate was set to 0 000003 and it reached 0 00006 by linearly changing small multiplicative factor after 10 epochs to prevent overfitting we set the weight decay to 0 01 and the batch size was set to 4 based on the size of the gpu memory 2 6 evaluation metrics the evaluation metrics used in this study included the overall accuracy oa precision recall intersection over union iou and kappa oa is the ratio of the sum of different types of correctly predicted pixels to the total number of pixels it was used to evaluate the prediction effect of the lake extraction network on the whole the calculation formula of oa can be represented as 1 oa tp t n tp f p t n f n oa was calculated by the confusion matrix where tp fp fn and tn are the number of true positives correctly predicted number of lake pixels false positives incorrectly predicted number of lake pixels false negatives unpredicted number of lake pixels and true negatives correctly predicted number of not lake pixels respectively in the confusion matrix precision is the ratio of the correctly predicted lake pixels to the total number of pixels predicted as lake it reflects the correct degree of pixels prediction the calculation formula of precision can be represented as 2 precision tp tp f p precision can be calculated by a confusion matrix where tp and fp have identical meanings to tp and fp as used in oa recall is the ratio of the correctly predicted lake pixels to the total number of true lake pixels it reflects the complete degree of pixels prediction the calculation formula of recall can be represented as 3 recall tp tp f n recall can be calculated by a confusion matrix where tp and fn have identical meanings to tp and fn as used in oa iou is the intersection ratio between the pixels predicted as lake and the true lake pixels it reflects the degree of coincidence of the predicted lake images and true boundaries of lakes the calculation formula of the iou is 4 iou tp tp f n f p iou can also be calculated by a confusion matrix where tp fp and fn have identical meanings to tp fp and fn as used in oa kappa measures the consistency between the number of predicted pixels of elements of different classes and the real number of pixels cohen 1960 the calculation formula of kappa is 5 kappa po p e 1 p e in the formula po is the oa when the numbers of true pixels in each class were a1 a2 a x the predicted numbers of samples in each class were b1 b2 bx additionally n is the total number of pixels pe in the formula can be represented as 6 pe a 1 b 1 a 2 b 2 a x b x n n 3 results 3 1 accuracy evaluation results the proposed transform based lake extraction network was evaluated on the validation dataset presented in section 3 1 table 3 shows the evaluation results of five models acquired by training the proposed network using the five training datasets presented in table 1 respectively as shown in table 3 the transformer based lake extraction network achieved good performance in the experiment the results of oa precision recall iou and kappa were satisfied in general which showed that the proposed transformer based network was able to successfully extract lakes from remote sensing images secondly the oa precision recall iou and kappa of model 1 to model 4 were higher than those of model 0 this indicated that the prediction accuracy of the network was greatly improved by the training datasets containing cloud shadows additionally the proportions of the cloud shadows in the five training datasets were far lower than the proportion of the lakes which showed that a small number of cloud shadows in the training data improved the prediction accuracy of the network thirdly training the network using the datasets containing different proportions of cloud shadows led to different results the higher the proportion of cloud shadows in the training dataset the higher the prediction accuracy measured by oa precision recall iou and kappa 3 2 prediction result analysis we analyzed the prediction results with three cases as follows including comparisons of cloud shadow misclassification among different models the prediction results for large sized lakes and the prediction results for small sized lakes 3 2 1 comparison of cloud shadow misclassification among different models when cloud shadows were not included in the training dataset i e the no cloudshadow dataset in table 1 the model i e model 0 could not effectively distinguish between lakes and cloud shadows thus many cloud shadows were misclassified as lakes whether these were large sized as shown in fig 5 b or small sized cloud shadows as shown in fig 6 b did not matter when the proportion of cloud shadows in the training dataset was set to 1 i e the cloudshadow 1 dataset in table 1 the number of the cloud shadows misclassified as lakes significantly decreased as shown in fig 5 c for large sized cloud shadows and fig 6 c for small sized cloud shadows although such misclassifications still occurred more often with larger cloud shadows the trained network i e model 1 was able to distinguish between lakes and cloud shadows in most situations when the proportion of cloud shadows was increased to 2 i e the cloudshadow 2 dataset in table 1 few small sized cloud shadows were misclassified as lakes fig 6 d however some large sized cloud shadow pixels were still misclassified as lake pixels fig 5 d when the proportion of cloud shadows was increased to 3 i e the cloudshadow 3 dataset in table 1 the trained network i e model 3 was nearly able to address cloud shadow interference as shown in fig 5 e for large sized cloud shadows and fig 6 e for small sized cloud shadows a small amount of misclassification occurred with large sized cloud shadows and misclassified pixels were further decreased when the proportion of cloud shadows reached 4 i e the cloudshadow 4 dataset in table 1 which was the highest proportion in the experiment the trained network i e model 4 addressed the interference of cloud shadows in the lake extraction very well as shown in fig 5 f and fig 6 f the best prediction result was also obtained by this model with this network model 4 neither small sized nor large sized cloud shadows were misclassified 3 2 2 analysis for the prediction result of large sized lake we classified lakes larger than 10 km2 as large sized lakes and lakes smaller than 10 km2 as small sized lakes the prediction result for the large sized lakes is shown in fig 7 the proposed lake extraction network successfully classified all of the large sized lakes due to their size shape and relatively apparent boundaries and the boundaries of the predicted large sized lakes were clear and accurate therefore the proposed network shows very excellent performance in extracting large sized lakes in the experiment by comparing the prediction results of the large sized lakes we found that training the proposed network using different proportions of cloud shadows did not affect the prediction results for large sized lakes this demonstrated that the prediction result for the large sized lakes was determined by the ability of the proposed network and the proportion of lakes in the training dataset and was not impacted by the proportion of cloud shadows in the training dataset in the experiment the proportion of lakes in the training dataset was set to 15 41 and the prediction result showed that this proportion was able to satisfy the demands of large sized lake extraction 3 2 3 analysis of the prediction result of small sized lakes the prediction results for small sized lakes are shown in fig 8 most of the small sized lakes were correctly predicted by the proposed network however due to their smaller sizes and the fact that they were easily covered by cloud shadows several small sized lakes were missed during extraction some pixels on the edge of the small sized lakes were also missed additionally the small sized lakes were not only small in shape but also shallow in depth meaning that the signals received by the sensors were weak therefore small sized lake extraction was a challenge to the proposed network comparing the prediction results for small sized lakes we found that the prediction results were not affected by the proportion of cloud shadows in the training dataset this showed that the prediction results for the small sized lakes were also determined by the ability of the network and the proportion of lakes in the training dataset the proportion of lakes in the training dataset i e 15 41 was sufficient for the extraction for most small sized lakes for the omission of lake pixels we believe it could be improved by increasing the proportion of small sized lakes and adding more types of small sized lakes in the training dataset 4 application in the endorheic basin of tibetan plateau 4 1 data and procedure the proposed network was also applied to lake extraction in a large area we used model 4 which performed best in our experiment to extract lakes in the endorheic basin of tibetan plateau from sentinel 2 imagery the endorheic basin of tibetan plateau covers 112 tiles of sentinel 2 imagery as shown in fig 9 we utilized images from between july and september 2021 to extract lakes since the volume of the lakes was largest during this period xu et al 2021a b fang et al 2023 these images contained different proportions of cloud shadows and no cloud shadow or cloud removal methods were utilized all images were directly used by the model to extract lakes from sentinel 2 images and no pre process or post process measures were undertaken to refine the extraction results we obtained 609 scenes of sentinel 2 imagery in total and each of them was used to predict lakes using model 4 thus we obtained 609 scenes of lake prediction results for the 112 tiles the lake extraction results from the same tile were composited using a maximum area algorithm then the composited results were merged to form the lake extraction result in the whole area to validate the prediction result we also composited and merged rgb bands to generate a true color image for this area using google earth engine and overlaid the lake extraction results on top of it as shown in fig 10 4 2 lake extraction results as shown in fig 10 the extracted lakes were consistent with the lakes of sentinel 2 images in the lake distribution and extent which showed that the proposed network could be applied in large areas for automatic lake extraction additionally nearly no cloud shadows were misclassified as lakes in the large scale lake extraction this was a benefit of using training datasets with a certain proportion of cloud shadows to train the network we further observed the extraction results of four lakes including selincuo lake cuo e lake zhari namco lake and ayagekumukuli lake they were all clear and accurate with complete boundaries as shown in fig 11 4 3 comparison with the global surface water gsw dataset the lake extraction result was compared with the gsw dataset in terms of the area of lake extraction intersecting area spatial distribution and spatial resolution the area of the extracted lakes and the area of gsw dataset in the endorheic basin of tibetan plateau are shown in table 4 they were 37861 897 km2 and 42226 615 km2 respectively and the intersecting area was 37116 147 km2 accounting for 98 030 of the total lake area extracted by the network and 87 898 of the water body area of the gsw dataset this showed that the lake extraction result was almost consistent with the gsw dataset we believed that the difference of 1 970 between the intersecting area and the total extracted area was mostly attributable to small lakes we observed that our lake extraction network extracted more small lakes as shown in fig 15 for the gsw dataset the reason that the proportion 87 898 of intersecting area accounted for less was that the gsw dataset included both lakes and rivers in addition the lake extraction result by the proposed network was consistent with the gsw dataset in spatial distribution as shown in fig 12 the boundary of extracted lakes was also consistent with the maximum water extent of the lakes in gsw dataset as shown in fig 13 in addition our results outperformed the gsw dataset in spatial resolution since the remote sensing image we used was 10 m the lakes extracted using our network were more refined than those obtained via the gsw dataset as shown in fig 14 additionally as a benefit of having used sentinel 2 images with higher spatial resolutions more very small lakes were extracted by our model as shown in fig 15 5 discussion and conclusion many existing studies have improved lake extraction capabilities by innovating network structure and adjusting the parameters of networks but training data have often been ignored differing from these studies we not only developed a network based on a novel transformer architecture to extract lakes from sentinel 2 imagery but also explored the performance of the network from the perspective of training data we designed five training datasets that contained different proportions of cloud shadows to train the network to explore how cloud shadows in training datasets affect lake extraction results our results proved that the training data should be given the same attention as the networks in addition the proposed network was applied in a large area to further evaluate its generalization ability and exploit the application prospects of the network in automatic lake extraction in such an area the transformer based network demonstrated very good performance in the lake extraction from sentinel 2 imagery as confirmed from the accuracy evaluation results and prediction results in the endorheic basin of tibetan plateau with the transformer based network lakes could be directly extracted from remote sensing images with no additional pre or post processes required to refine the lake extraction results therefore the transformer based network could be applied in large scale areas for automatic lake extraction the cloud shadow interference issue in lake extraction could also be addressed by the proposed network the training dataset contained a certain proportion of cloud shadows which illustrated once more the important role played by the training dataset in deep learning based methods we found that increasing the proportion of cloud shadows in the training dataset was an effective way to avoid cloud shadows being misclassified as lakes when the proportion of cloud shadows in the training dataset reached 4 we obtained this study s best accuracy evaluation results they were 0 9954 of oa precision of 0 9797 recall of 0 9397 0 9217 of iou and 0 9568 of kappa additionally we observed that the higher the proportion of cloud shadows in the training dataset the higher the accuracy of the trained network in addition we also found that boundary accuracy for the extracted lakes was not impacted by the proportion of cloud shadows in the training dataset the experiment showed that no matter whether the training data contained cloud shadows and irrespective of their proportions i e higher or lower there were no significant differences in the lake boundaries for the extracted lakes we assumed that increasing cloud shadows in the training dataset helped the network learn more features of cloud shadows thereby avoiding misclassification but the accuracy of the lake boundary was still determined by the lake features in the training dataset the proportions of lakes in the training datasets were all the same in this study thus the prediction results showed nearly the same accuracy result in all extracted lakes in summary the proposed transformer based network demonstrated excellent performance in lake extraction from remote sensing images by adding a certain proportion of cloud shadows to the training dataset the network was better able to address the interference of cloud shadows thus we did not need to select clear sky images or eliminate the interference of cloud shadows by additional processing methods when extracting lakes the trained network could also be used for automatic lake extraction in a large area due to its robustness in addition this study also showed that transformer based networks could have great application potential in remote sensing image classification in the future we will apply our network to extract lakes in a larger area and improve its generalization ability by adding more types of training samples to handle the interference of other factors that affect lake extraction data availability the training datasets validation dataset and prediction results in the study are available at https doi org 10 6084 m9 figshare 21529245 v1 the sentinel 2 images used in the study were obtained through the copernicus open access hub scihub esa worldcover 10m 2020 product was through its official website https esa worldcover org en and the global surface water dataset was obtained through the global surface water explorer https global surface water appspot com credit authorship contribution statement xiangbing yan methodology validation writing original draft data curation jia song conceptualization methodology writing review editing funding acquisition software supervision resources yangxiaoyue liu writing review editing shanlong lu writing review editing yuyue xu writing review editing chenyan ma writing review editing supervision resources yunqiang zhu writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the national key research and development program of china 2021yfe0117800 2022yff0711602 the 14th five year informatization plan of chinese academy of sciences cas wx2021sf 0106 and the national data sharing infrastructure of earth system science http www geodata cn 
1923,although degradation of phosphorus containing natural organic matter nom is an important process associated with geogenic phosphorus p enrichment the detailed mechanism underlying the association remains unclear herein we used molecular characteristics of p containing dissolved organic matter dom coupled with hydrogeochemistry and carbon isotopes to unravel this controlling mechanism results indicate that p containing dom is indeed an important factor controlling groundwater p enrichment further one p atom 1p and two p atom 2p compounds were widely detected compared to 1p compounds 2p compounds have greater numbers of n s containing compounds smaller proportions of highly unsaturated and aliphatic compounds larger proportions of polyphenols and polycyclic aromatics lower h c and nominal oxidation state of carbon nosc values and higher m z o c p c n c double bond equivalents dbe and modified aromaticity index aimod values at the molecular level p containing dom degradation overall results in an increase in h c and a decrease in o c and a processing gradient is observed from 2p to 1p compounds during which dissolved inorganic phosphorus dip was gradually accumulated and retained eventually becoming the predominating p pool in groundwater to our knowledge this is the first study to reveal geogenic p enrichment from a molecular perspective in groundwater systems worldwide keywords dissolved organic matter phosphorus degradation groundwater ft icr ms data availability data will be made available on request 1 introduction eutrophication due to excessive phosphorus p in water bodies has caused environmental disasters such as harmful algal blooms fish deaths and biodiversity loss elser et al 2007 johnson et al 2010 sun et al 2022 recent studies indicate that high concentrations of p in groundwater may serve as an important p source for surface water through groundwater discharge which may exacerbate eutrophication and complicate restoration efforts lewandowski et al 2015 kazmierczak et al 2020 2021 in addition as high p may negatively impact cardiovascular bone and kidney function dietary reference intake of p 40 mg kg body weight per day and can promote toxic arsenic mobilization it may pose a health risk to residents who rely on groundwater grimm et al 2001 dhingra et al 2007 yoo et al 2016 wallis et al 2020 fulgoni et al 2022 therefore it is crucial to understand the sources and cycling of p in the subsurface environment when assessing potential ecological and health threats arising from high p groundwater high concentrations of p in groundwater are commonly attributed to anthropogenic activities such as agricultural fertilization industrial wastewater discharge and mining sanchez et al 2019 ančić et al 2020 li et al 2021 in recent years elevated concentrations of p in groundwater have also been found to have geogenic sources they originate from the matrices of aquifers and are subsequently enriched by complex hydrogeochemical processes neidhardt et al 2018 2021 kazmierczak et al 2021 tao et al 2022 li et al 2022a zhou et al 2022 existing studies have demonstrated that the degradation of p containing natural organic matter nom from the aquifer plays an important role in the enrichment of geogenic p especially p in the form of orthophosphate for example in their study of arsenic pollution mechanisms in the deltaic plain of the ganges meghna brahmaputra rivers mcarthur et al 2001 found that high p concentrations up to 5 mg l were driven by microbial degradation of buried peat deposits in their investigation of the p fate in pristine groundwater ecosystems neidhardt et al 2018 revealed that nom served both as a potential source and electron donor in the mobilization of p they found that the microbially mediated oxidation of nom was coupled with a rapid depletion in terminal electron acceptors such as iron oxyhydroxides in a recent study on geogenic p li et al 2022a presented field data under changing redox conditions and concluded that the degradation of nom was the dominant process that mobilized considerable amounts of p in groundwater under oxic suboxic conditions however these studies only identified the occurrence of p containing nom degradation coupled with geogenic p enrichment detailed mechanisms responsible for the coupling remain unknown additionally p containing dissolved organic matter dom molecules constitute an important fraction of dom yoshimura et al 2014 in general dom mainly consists of c h o n p and s whereas other elements can be disregarded for a general examination of molecular structures in dom koch and dittmar 2006 p containing dom molecules refer to all dom compounds containing p atoms which could be further classified into chop chonp chosp and chonsp compounds however due to its own complexity and the limitations of analytical techniques the biogeochemical behavior of p containing dom has not been well studied worsfold et al 2008 van der veen and de boer 2012 although recent technological advances have yielded some novel insights into it in surface waters farmland soil and ocean environments baldwin 2013 huang et al 2017 kour et al 2021 pu et al 2023 there has been no specific study on it in groundwater systems therefore characterizing p containing dom in groundwater can greatly improve our understanding of the mechanism for the enrichment of geogenic p in groundwater environments fourier transform ion cyclotron resonance mass spectrometry ft icr ms is a robust mass spectrometry technology for characterization of organic molecules in studying the molecular composition distribution or transformation bahureksa et al 2021 shen et al 2022 it has been increasingly used in recent years for studies on dom didonato et al 2016 zhang et al 2019 qiao et al 2021a maqbool et al 2022 including p containing dom in various aquatic environments such as natural surface water llewelyn et al 2002 cooper et al 2005 pollutant source water brooker et al 2018 water extractable lake sediments ni et al 2021 pu et al 2023 and agricultural runoff yang et al 2022 however no work has been done to use ft icr ms to characterize p containing dom in the groundwater environment except for liu et al 2023 high concentrations of p in groundwater were reported in alluvial pluvial and lacustrine environments such as the bengal delta plain in bangladesh as total dissolved phosphorus tdp and orthophosphate neidhardt et al 2018 red river delta in vietnam as orthophosphate neidhardt et al 2021 mississippi river valley plain in america as tdp welch et al 2010 spree river plain in germany as orthophosphate lewandowski and nutzmann 2010 jianghan plain as tdp dongting plain as tdp and hetao basin in china as tdp and orthophosphate tao et al 2020 2022 li et al 2022a in these locations p enrichment had been found to be closely related to abundant nom buried in aquifer sediments the area for this study is located along the yangtze river in the southern part of the jianghan plain which is a typical alluvial lacustrine plain with large amounts of plant and animal residues that were buried in pleistocene and holocene epoch duan 2016 chen 2020 an extensive and continuous low permeability layer that serves as an aquitard covers the surface of the study area and this layer can effectively prevent anthropogenic p transport from the surface to the underlying aquifers consequently this area is an ideal natural laboratory to study the geogenic p enrichment in groundwater systems although our recent work has detected high concentrations of tdp 4 mg l in aquifer systems in this region li et al 2022b zhou et al 2022 the relevant hydrogeochemical processes have not been well understood this study aims to characterize the molecular properties of p containing dom in the p rich quaternary aquifer system in the central yangtze river basin using ft icr ms coupled with conventional hydrogeochemical and carbon isotopic analyses so as to investigate the controlling mechanisms for the geogenic p enrichment in groundwater systems this research provides a new perspective and evidence for discerning and comprehending naturally occurring p in groundwater which has been underestimated or ignored in understanding the biogeochemical cycle of p in aquatic environments to date 2 materials and methods 2 1 study area and groundwater sampling groundwater samples were collected from aquifers of the southern part of the jianghan plain where reducing conditions driven by organic matter degradation prevail huang et al 2012 du et al 2020 the jianghan plain is a typical alluvial lacustrine plain that consists of sediments derived from the yangtze and han rivers fig 1 a it has a subtropical monsoon climate with an average annual temperature of 15 17 c and annual precipitation and evaporation of 1269 and 1200 mm respectively deng et al 2014 duan 2016 the shallow groundwater system in the plain consists of two layers the upper part is an aquitard composed of clay or silty clay locally interlaced silt with a thickness of 15 20 m the deeper part is a porous aquifer consisting of fine to coarse grained sand and gravel with a thickness of 50 80 m and most of our samples were collected in the upper part of the porous aquifer duan 2016 fig s1 in july 2018 and july 2020 41 groundwater samples were collected from the private wells in the study area the wells were purged for approximately 15 min prior to sampling until measurements of in situ parameters were stabilized samples were collected for analysis of cations trace elements anions dissolved organic carbon doc stable carbon isotope compositions δ 13c of dissolved inorganic carbon dic and doc dissolved gas ch4 dissolved p pools tdp dissolved inorganic phosphorus dip and dissolved organic phosphorus dop and ft icr ms all dissolved gas samples obtained from groundwater were stored in the dark and at 25 c until analysis in the laboratory within 7 days all liquid samples were stored in the dark and refrigerated at 4 c until analysis in the laboratory within 10 days liquid samples for ft icr ms analysis were subject to solid phase extraction for concentrating organic matter within 36 h and all solid phase extraction cartridges were preserved at 18 c in the dark before the elution procedure in the laboratory the elution procedures and analysis of eluted samples were completed within 10 days the supplementary materials contain more details on groundwater sampling and preservation and preparation for ft icr ms analysis 2 2 water chemistry and isotopic analyses temperature t ph redox potential eh electrical conductivity ec and dissolved oxygen do were determined in situ with a hach hq40d multimeter as redox sensitive components concentrations of ferrous ion fe2 and ammonium nh4 n were determined in situ with a portable spectrophotometer hach dr2800 usa using methylene blue and 1 10 phenanthroline methods respectively hach company 2002 alkalinity was determined within 24 h of sampling via hydrochloric acid titration with methyl orange or phenolphthalein as a dye indicator reger et al 2009 concentrations of major cations and trace elements were measured using inductively coupled plasma optical emission spectrometry icp oes iris intrepid ii xsp thermo electric company and inductively coupled plasma mass spectrometry icp ms nexion 350d perkinelmer respectively with a precision of 0 5 anions were analyzed via ion chromatography ic 761compactic metrohm ag with a precision of 3 0 ion charge imbalances between major cations and anions were largely better than 5 doc concentrations were determined using a total organic carbon toc analyzer elementar vario toc germany with measurement uncertainties of 3 ch4 concentrations were analyzed using gas chromatography flame ionization detection gc fid thermo scientific with measurement uncertainties of 5 all of the above chemical analyses were conducted at the school of environmental studies china university of geosciences at wuhan the carbon isotope ratios in dic were determined by an isotope ratio mass spectrometry irms thermo fisher scientific mat 253 at the chinese academy of agricultural sciences caas in beijing the carbon isotope results were reported with delta δ values as deviations in per million from the vpdb vienne pee dee belemnite standard the measured δ 13c dic values were verified using the certified iaea ch3 sucrose a standard na2co3 solution was prepared with a known δ 13c value of 10 8 0 2 the precision based on replicate analysis was 0 2 for δ13c dic the details of δ 13c dic measurement methods are described in wang et al 2014 the δ 13c values in doc was measured by a toc irms isoprime elementar germany at the third institute of oceanography ministry of natural resources the measured δ 13c doc values were verified using the certified iaea ch6 sucrose repeated measurements of an internal standard had a precision of 0 2 for δ 13c doc the details of δ 13c doc measurement methods can be found in lee and kim 2018 2 3 measurement of dissolved phosphorus pools in groundwater one of the most common simple and reliable chemical analyses of p pool concentrations in natural aquatic environments to date is the standard molybdenum blue colorimetric method concentrations of tdp pool were determined using the conventional molybdenum blue technique after digestion zhang et al 2010 the dip pool reported in this study is the molybdate reactive p i e orthophosphate as phosphorus and their concentrations were determined using an adaptation of the molybdate blue method without digestion murphy and riley 1962 although real dip pool also includes condensed phosphates this form of dip is widely found in waste waters and has low concentrations in natural aquatic environments halliwell et al 1996 packa et al 2019 in addition dip is subtracted from tdp to get the concentration of the dop pool zhang et al 2010 concentrations of dip and tdp were measured at a wavelength of 700 nm using a uv 1800 pc uv vis spectrophotometer thermo scientific with results compared to a blank spectrum obtained from ultrapure 18 2 mω milli q water prior to sample analysis an instrument baseline correction was done analyses were performed in triplicate to assess their reproducibility and the resulting standard deviations were better than 9 2 4 molecular characterization using ft icr ms the procedure for preparation of dom samples for ft icr ms is provided in the supplementary materials all extracted and concentrated samples were examined at the research center for eco environmental sciences chinese academy of sciences using a bruker apex ultra ft icr ms outfitted with a 15 t superconducting magnet the results were collected using an apollo ii electrospray ionization device in negative mode more information on the ft icr ms settings for data acquisition and its mass calibration can be found elsewhere lv et al 2016 during ft icr ms data processing all compounds with 13c 15n 18o and 34s were eliminated from the dataset since they represented duplicates of the c n o and s parent molecules respectively based on the chemical criteria kujawinski and behn 2006 a previously published software was used to calculate the molecular formulas of compounds containing elements c h o n s and p freely available at chemrxiv https doi org 10 26434 chemrxiv 9917399 more details about an accurate and efficient formula assignment from a number of mass data especially the assignment of p containing compounds can be found in fu et al 2020 the normalized peak intensity was used to calculate the mass to charge ratios m z and elemental ratios h c o c p c and n c the double bond equivalents dbe modified aromaticity index aimod and nominal oxidation state of carbon nosc were calculated based on elemental formulas koch and dittmar 2006 larowe and van cappellen 2011 spencer et al 2014 boye et al 2017 in addition it should be pointed out that the ratios of the compounds were calculated from the entire molecular dataset of ten ft icr ms samples collected in this study rather than one or several ft icr ms samples 2 5 statistical analysis ibm spss statistics v25 0 0 and matlab r2018 were used for statistical analysis and data handling respectively the distributions of the dataset variables were analyzed to establish how closely the sample data adhered to the assumption of normality for a 95 confidence interval simple correlation was performed to establish relationships between two parameters for correlation analysis both spearman correlation coefficients and p values were provided the mann whitney u test was used to assess whether there is a statistical difference between two sample groups e g high p groundwater and low p groundwater groups corresponding to tdp 1 mg l and tdp 1 mg l in addition the data were graphed using origin 2021 and r statistics v4 2 0 3 results and discussion 3 1 sources and fate of p in groundwater dissolved p pools in groundwater had wide ranges tdp 0 01 4 50 mg l dip 0 01 3 66 mg l dop 0 01 1 80 mg l fig 1 and table s1 dip accounted for 25 nearly 100 average 77 median 83 of the corresponding tdp concentrations and a highly positive correlation was observed between dip and tdp concentrations r 0 95 p 0 001 suggesting that dip was the predominant p pool in groundwater other data regarding hydrogeochemistry and isotopes are also listed in table s1 high p groundwater tdp 1 mg l had lower eh values average 136 3 mv from 163 4 to 115 9 mv than low p groundwater average 79 9 mv from 171 1 to 153 9 mv p 0 05 ec values in high p groundwater average 1300 μs cm median 1190 μs cm were higher than those in low p groundwater average 878 μs cm median 932 μs cm p 0 001 this indicated that high p groundwater was commonly found in a reducing hydrogeologic environment with a slow flow and a long term water rock interaction no3 so4 2 and cl concentrations were lower in high p groundwater tdp 1 mg l average 3 60 mg l 0 36 mg l 2 25 mg l than those in low p groundwater tdp 1 mg l average 5 44 mg l 15 91 mg l 8 45 mg l p 0 05 elevated concentrations of no3 so4 2 and cl can be regarded as indicators to anthropogenic pollution of groundwater in humid inland areas e g rotiroti et al 2017 du et al 2020 and the positive correlations among these three ions implied that they should have the same source table s2 therefore elevated groundwater p concentrations in the studied aquifer are less related to anthropogenic inputs and geogenic p released from aquifer matrices warrants special attention naturally occurring p in groundwater is generally attributed to the release of p bearing minerals mainly as p rich iron or calcareous minerals and the degradation of p containing nom orihel et al 2017 neidhardt et al 2018 the rapid dissolution of p rich calcareous minerals such as apatite tends to appear in acidic groundwater environments thus their contribution to p enrichment should be quite low in the circum neutral zone the ph range of the study area 6 70 7 81 sjöberg and rickard 1984 fulmer et al 2002 wang et al 2005 this assumption can be supported by the lack of a correlation between dip and ca concentrations table s2 a good positive correlation r 0 70 p 0 001 between dip and fe2 concentrations suggested that the p bearing fe minerals could be a nonnegligible source of groundwater p the dissolution include reductive fe iii oxyhydr oxides and non reductive vivianite or desorption of p rich fe minerals could release orthophosphate into ambient groundwater nevertheless the dip fe2 molar ratio of around 1 10 in our groundwater samples was 2 5 times the ratios found at recent lacustrine sediments typical sediment water interfaces 0 2 0 5 lijklema 1980 gunnars et al 2002 katsev and dittrich 2013 the dip fe2 ratio should be 0 67 even if vivianite is the only source of dip in groundwater eq 1 the much higher dip fe2 ratio in our data indicated that there should be other important source of groundwater orthophosphate this other source must be p containing nom from the aquifer sediments eq 2 groundwater samples contain amounts of ammonium and dip that reflect the maximum ratio likely to be found in common wetland vegetation fig 2 b redfield ratio n p molar ratio 16 redfield 1963 mcarthur et al 2001 zhang et al 2017 suggesting that both come from this source it should be noted here that while the redfield ratio was originally derived from marine ecology a growing research have shown that n p in om including wetland vegetation is close to that in seawater a relationship maintained through a set of biological feedbacks fitter and hillebrand 2009 gruber and deutsch 2014 vivianite dissolution kazmierczak et al 2021 1 fe3 po4 2 8h2o 2hpo4 2 h2po4 aq 3fe2 aq 8h2o p containing nom degradation 2 ch2onxpy mn ⅳ fe iii so4 2 xnh4 aq yhpo4 2 h2po4 aq hco3 aq mn ⅱ fe ⅱ s ii from fig 2b we estimate in approximately 66 of the groundwater samples n p molar ratio 16 p comes from p containing nom degradation it therefore seems likely that p containing nom degradation was an important source of groundwater p furthermore the release of p into groundwater via p containing nom degradation could be supported by the results of hydrochemistry and carbon isotopes the statistically significant correlations among dip hco3 nh4 n and doc concentrations fig 2a b table s2 indicated a mobilization of p via p containing nom degradation pathway as described by eq 1 the cl br mass ratio is a useful parameter for distinguishing components of natural origin 250 from those of wastewater origin up to several thousands in groundwater davis et al 1998 mcarthur et al 2012 this is mainly because om degradation concentrates br rather than cl whereas leachates from human sewage have high cl br ratios due to addition of common salt such as cl evaporation concentration during recharge may also receive additional br mcarthur et al 2016 however in such a humid plain the evaporation intensity is not strong enough for cl to precipitate therefore evaporation is not the main reason for the low cl br phenomenon in this study area compared with groundwater samples with lower dip levels 0 50 mg l groundwater samples with higher dip levels 0 50 mg l have fairly low cl br mass ratios p 0 01 which further suggests p containing nom degradation as source of dip in groundwater fig s3 the signatures of carbon isotopes responded to the same p mobilization pathway groundwater samples with higher dip levels 0 50 mg l typically exhibited higher δ 13c values in doc from 30 5 to 24 5 whereas those with lower dip levels 0 50 mg l exhibited lower δ 13c values in doc from 39 1 to 28 7 fig 2c this finding suggests that intense p containing nom degradation would have taken place in the groundwater with high dip levels because 12c in the reactant doc is preferentially taken up into the product dic during microbial degradation and the residual reactant doc is correspondingly enriched in the heavier 13c clark and fritz 1997 xue et al 2019 in addition the δ 13c values in dic suggested that extremely intensive nom degradation has occurred even progressing to the stage of methane production fig 2d ch4 concentrations of detected samples shown this is due to the fact that different methanogenic pathways can all enrich 13c in produced or residual dic therefore yielding a positive δ 13c dic value blaser and conrad 2016 du et al 2020 3 2 molecular characteristics of p containing dom in groundwater the molecular compositions of dom concentrated and isolated from 10 groundwater samples with different ranges of tdp levels 0 50 0 50 1 00 1 01 2 00 and 2 00 mg l were characterized by ft icr ms analysis overall a total of 3218 6200 species of elemental combinations were detected in dom and the identified p containing compounds 208 1534 species could be further divided into one p atom 1p compounds 174 1109 species and two p atom 2p compounds 46 425 species table s3 s4 s5 and s6 detailed statistical parameters related to dom p containing dom 1p and 2p compounds from the molecular characterization of each groundwater sample can be found in supplementary materials considerable differences were observed across different organic compounds especially between dom and p containing dom or between 1p and 2p compounds these differences were based on three aspects heteroatom category compound class and chemical property c h o and p are the basic constituent atoms of p containing dom so n and s are assigned as heteroatoms which make molecules more diverse and complex according to the heteroatom category the identified p containing dom could be classified into four compound species namely chop chonp chosp and chonsp compounds as seen in the right part of fig 3 a chop compounds were dominant accounting for 64 3 followed by chonp 17 0 chosp 10 9 and chonsp compounds 7 8 moreover among the chop compounds 1p compounds were significantly more abundant than 2p compounds 62 vs 3 this suggests that larger numbers of cho 1p compounds are preserved than that of cho 2p compounds implying a possible transformation gradient from cho 2p compounds to cho 1p compounds in the compounds that contained only n or s i e chonp or chosp the proportion of 2p compounds was greater compared with chop but still lower than that of 1p compounds in contrast among the chonsp compounds the proportion of 2p compounds exceeded that of 1p compounds fig 3a this indicated that a greater number of n s containing compounds were present among the 2p compounds and their compositions were more complex notably c h and o are the basic constituent atoms of dom and p should be also assigned as a heteroatom along with n and s p containing dom only accounts for 17 3 of dom 1p compounds 14 1 2p compounds 3 2 which suggests that the elemental abundance of p in dom is low this is consistent with other reports the concentration of p containing molecules is very low and the dominant background of dom is dissolved organic c n and o compounds dissolved organic p is remineralized twice as rapidly as dissolved organic c which may be an important reason for this phenomenon kruse et al 2015 duhamel et al 2021 the van krevelen diagram can be used to visualize the ft icr ms data kim et al 2003 which shows the relationship between the h c and o c for all observed compounds fig s4 the relative location of each compound in the diagram indicates the class to which that compound belongs aliphatic compounds 1 5 h c 2 highly unsaturated compounds aimod 0 5 and h c 1 5 polyphenols 0 5 aimod 0 66 polycyclic aromatics aimod 0 66 and saturated compounds aimod 0 5 and h c 2 detailed descriptions of the classes can be found in spencer et al 2014 to highlight the differences across organic species the weighted average relative abundances within all samples of five different compound classes were tallied fig 3b highly unsaturated and aliphatic compounds were the most abundant compound classes in all organic species together accounting for 81 8 90 2 of all identified compounds both compound classes mainly contain labile organic components and are generally considered as intermediates or end products of nom biodegradation mcdonough et al 2020a qiao et al 2021b the total proportion of these two compound classes in p containing dom is higher than that in dom 88 6 vs 82 4 and so is 1p compounds than 2p compounds 90 2 vs 81 8 in contrast polyphenols and polycyclic aromatics mainly contain stable or recalcitrant organic components which are frequently leached from organic horizons rich in vascular plant matter these substances can also be accumulated in the subsurface through sedimentary inputs mcdonough et al 2020b qiao et al 2021a the total proportion of these two compound classes in p containing dom is much lower than that in dom 2 8 vs 15 2 and 1p compounds also exhibit the same comparing result relative to 2p compounds 1 7 vs 7 7 the chemical properties of different organic compounds are further characterized using the values or numbers of the following parameters m z c h o n s dbe aimod nosc o c h c p c n c fig 4 in the 10 groundwater samples the weighted average of m z m zwa values of dom 393 82 449 78 da average 426 98 da were higher than those of p containing dom 389 28 434 98 da average 414 76 da moreover the m z wa values of 2p compounds 402 95 471 88 da average 428 72 da were also higher than those of 1p compounds 378 81 434 98 da average 411 48 da in terms of the number of different atoms p containing dom contains fewer cwa atoms more hwa atoms fewer owa atoms more nwa atoms and more swa atoms than dom this is likely because relatively simple cho compounds constitute the majority accounting for 56 2 of dom components fig 3a whereas p containing dom are more complex and may undergo cross polymerization via the linking of n and s functional groups turner et al 2005 1p compounds have fewer cwa atoms more hwa atoms more owa atoms fewer nwa atoms and fewer swa atoms than 2p compounds this can be attributed to the more complex and diverse molecular architecture of 2p compounds for example s atoms can occupy the sites of o atoms in the structure of p o or p o forming phosphorodithioate turner et al 2005 this is supported by the higher dbewa and aimod wa values in 2p compounds than those in 1p compounds higher dbe values suggest a greater number of double bonds and rings in compounds and higher aimod values signify a greater number of aromatic structures in compounds du et al 2020 additionally the relative changes in the o c h c p c n c and nosc values can be used to infer the degradation process of organic species pracht et al 2018 yu et al 2020 du et al 2021 mcdonough et al 2022 which is explored further in the following section thus the chemical properties of different organic compounds are considerably impacted by the combined effects of the molecules themselves and p containing dom degradation 3 3 p containing dom degradation and p enrichment in groundwater the van krevelen diagrams depict 128 and 547 compounds which are significantly associated with dip and dop concentrations respectively in our groundwater samples i e p 0 05 fig 5 a plots with more detailed subdivisions for various heteroatom categories with strong positive correlations are provided in fig s5 i e r 0 5 p 0 05 the degradation of p containing dom produces phosphate and anoxic conditions and the absence of photodegradation lead to very low biodegradation rates of p containing dom in the subsurface mcdonough et al 2022 thus compounds that exhibit significantly positive correlations with dop concentrations represent the products of some degree of original p containing dom degradation furthermore such compounds could be further degraded to form compounds with strong molecular level associations with dip concentrations therefore the differences between compounds with strong positive correlations with dop concentrations and those with strong positive correlations with dip concentrations confirm that an overall increase in h c and a decrease in o c occur as a result of the processing of p containing dom fig 5a this is further supported by the p c and n c values in compounds which are positively associated with dip concentrations are lower than those in compounds that are positively associated with dop concentrations fig 5b c this is because the degradation process of nom would result in the decrease in the number of p or n atoms in the molecular structure which corresponds to a significant decrease in p c or n c value yu et al 2020 du et al 2021 p containing dom degradation leading to the breaking of the phosphoester bond mainly including monoester p o c and diester c o p o c could further explain this processing pathway from the mechanistic perspective when the phosphoester bonds are cleaved during biodegradation or abiotic degradation h atoms are added into the processed organic molecules forming alcohol groups and phosphate groups are removed from the original organic molecules taking away the o atoms bonded to p atoms turner et al 2005 taft et al 2009 diez castellnou et al 2017 phosphohydrolases produced by microorganisms e g phosphomonoesterase phytase are the extracellular enzymes that play an important role in this biogeochemical p cycle turner et al 2005 consequently one large original p containing dom molecule is cleaved into one or multiple smaller molecules and the processed organic molecules demonstrate an increase in h c and a decrease in o c fig 6 phosphonates are another organic form of p they contain a direct c p bond and are less prevalent in freshwater ecosystems than they are in marine ecosystems cade menun et al 2006 baldwin 2013 additionally p containing dom degradation is an essential part of dom degradation and the p containing dom degradation pathways suggested herein i e an overall increase in h c and a decrease in o c with processed are also consistent with those identified about dom in other studies kellerman et al 2015 mcdonough et al 2022 in comparison to 2p compounds 1p compounds showed increased h cwa and decreased o cwa p cwa and n cwa the subscript wa refers to weighted average value which is in agreement with the trend discussed earlier this suggests that the transformation of 2p compounds to 1p compounds may occur during p containing dom degradation three other differences in molecular characteristics between 1p and 2p compounds further reflect this processing pathway firstly the molecular weight m zwa of 1p compounds is lower than that of 2p compounds because large molecules are broken into multiple smaller molecules during degradation processes schmidt et al 2009 seidel et al 2014 secondly the noscwa of 1p compounds is higher than that of 2p compounds compounds with higher nosc values are thermodynamically more favorable for oxidization and could be targeted easily by microorganisms in anaerobic environments pracht et al 2018 compared with 1p compounds 2p compounds have undergone a greater degree of degradation by microbes at an earlier stage therefore relative recalcitrant 2p compounds are preserved with lower nosc values 1p compounds with higher nosc values could be further degraded thirdly the total proportion of highly unsaturated and aliphatic compounds considered as intermediates or end products of biodegradation of 1p compounds is higher than that of 2p compounds and the total proportion of polyphenols and polycyclic aromatics considered as sedimentary inputs from terrestrial vascular plants of 1p compounds is lower than that of 2p compounds it has been demonstrated that nom is degraded along a gradient from polyphenols and polycyclic aromatics to highly unsaturated compounds and aliphatic compounds in groundwater environments kellerman et al 2015 mcdonough et al 2020b 2022 which is consistent with the processing pathway from 2p to 1p compounds furthermore the p cwa ratios are positively correlated with the percentages of the number of 1p compounds relative to p containing dom in 10 groundwater samples r 0 874 p 0 001 indicating that the number of 1p compounds is relatively increasing and the number of 2p compounds is relatively decreasing during degradation this processing pathway also is in accordance with the concept of ni et al 2021 who proposed that 2p compounds are possibly preferentially degraded in lake sediments in summary a comprehensive mechanism dominated by p containing dom may be identified as being in charge of the enrichment of geogenic p in alluvial lacustrine aquifer systems large volumes of wetland plant remnants were quickly deposited during the evolution of the rivers and lakes in the study area and they were thereafter buried in subsurface sediments which are hence rich in p containing nom the dissolution or mineralization of p containing nom can release dissolved p into ambient groundwater which may raise dop and dip concentrations in groundwater however underlying mechanisms should be further explored although the subsurface environment is anaerobic and photodegradation does not occur the active degradation of p containing dom depending on the thermodynamic conditions could still take place by detailed characterization at the molecular level p containing dom degradation overall resulted in an increase in h c and a decrease in o c and a processing gradient is observed from 2p to 1p compounds during these cascades of p containing dom degradation dip was gradually accumulated and retained in the subsurface environment eventually becoming the predominating p pool in groundwater fig 6 4 conclusion global median estimates of groundwater borne p transport associated with lacustrine groundwater discharge and submarine groundwater discharge are 45 and 1000 mg p m 2 per year lewandowski et al 2015 santos et al 2021 in contrast to groundwater p pollution due to anthropogenic inputs the release of geogenic p is continuous and is difficult to be surveilled thus it is both essential and challenging to elucidate the biogeochemical mobilization of geogenic p in the subsurface our results demonstrate p containing dom is a quite important factor controlling groundwater p enrichment in the study area furthermore an increasing body of work has been conducted on the molecular characterization of p containing dom in surface waters and marine environments baldwin 2013 brooker et al 2018 pu et al 2023 however to date there has been no research on it in aquifer systems this study used ft icr ms to characterize the detailed molecular characteristics of p containing dom in alluvial lacustrine aquifer systems in terms of heteroatom category compound class and chemical property on this basis two processing pathways were proposed at the molecular level p containing dom degradation overall results in an increase in h c and a decrease in o c and a processing gradient is observed from 2p to 1p compounds during which dip was gradually accumulated and retained eventually becoming the predominating p pool in groundwater these findings not only address a knowledge gap about p containing dom research in aquatic systems but also provide new insights into the anomalous concentrations of p in groundwater of alluvial lacustrine sandy aquifer systems especially two processing pathways of p containing dom proposed in this study would be of much merit in similar aquifer systems around the world and similar processing pathways have been found in the studies of groundwater dom du et al 2021 mcdonough et al 2022 in further study characterizing organic p in solid sediments and carrying out indoor water sediment incubation experiments are needed to delineate the p containing om processing pathways in high p groundwater systems in more detail credit authorship contribution statement yanqiu tao conceptualization investigation methodology formal analysis writing original draft writing review editing yao du conceptualization supervision funding acquisition writing review editing yamin deng data curation project administration writing review editing teng ma funding acquisition yanxin wang project administration writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research work was financially supported by the project of hubei provincial key research and development no 2020bca088 national key research and development program of china no 2021yfa0715900 the national natural science foundation of china no u21a2026 no 42177181 no 4201001051 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129513 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 
1923,although degradation of phosphorus containing natural organic matter nom is an important process associated with geogenic phosphorus p enrichment the detailed mechanism underlying the association remains unclear herein we used molecular characteristics of p containing dissolved organic matter dom coupled with hydrogeochemistry and carbon isotopes to unravel this controlling mechanism results indicate that p containing dom is indeed an important factor controlling groundwater p enrichment further one p atom 1p and two p atom 2p compounds were widely detected compared to 1p compounds 2p compounds have greater numbers of n s containing compounds smaller proportions of highly unsaturated and aliphatic compounds larger proportions of polyphenols and polycyclic aromatics lower h c and nominal oxidation state of carbon nosc values and higher m z o c p c n c double bond equivalents dbe and modified aromaticity index aimod values at the molecular level p containing dom degradation overall results in an increase in h c and a decrease in o c and a processing gradient is observed from 2p to 1p compounds during which dissolved inorganic phosphorus dip was gradually accumulated and retained eventually becoming the predominating p pool in groundwater to our knowledge this is the first study to reveal geogenic p enrichment from a molecular perspective in groundwater systems worldwide keywords dissolved organic matter phosphorus degradation groundwater ft icr ms data availability data will be made available on request 1 introduction eutrophication due to excessive phosphorus p in water bodies has caused environmental disasters such as harmful algal blooms fish deaths and biodiversity loss elser et al 2007 johnson et al 2010 sun et al 2022 recent studies indicate that high concentrations of p in groundwater may serve as an important p source for surface water through groundwater discharge which may exacerbate eutrophication and complicate restoration efforts lewandowski et al 2015 kazmierczak et al 2020 2021 in addition as high p may negatively impact cardiovascular bone and kidney function dietary reference intake of p 40 mg kg body weight per day and can promote toxic arsenic mobilization it may pose a health risk to residents who rely on groundwater grimm et al 2001 dhingra et al 2007 yoo et al 2016 wallis et al 2020 fulgoni et al 2022 therefore it is crucial to understand the sources and cycling of p in the subsurface environment when assessing potential ecological and health threats arising from high p groundwater high concentrations of p in groundwater are commonly attributed to anthropogenic activities such as agricultural fertilization industrial wastewater discharge and mining sanchez et al 2019 ančić et al 2020 li et al 2021 in recent years elevated concentrations of p in groundwater have also been found to have geogenic sources they originate from the matrices of aquifers and are subsequently enriched by complex hydrogeochemical processes neidhardt et al 2018 2021 kazmierczak et al 2021 tao et al 2022 li et al 2022a zhou et al 2022 existing studies have demonstrated that the degradation of p containing natural organic matter nom from the aquifer plays an important role in the enrichment of geogenic p especially p in the form of orthophosphate for example in their study of arsenic pollution mechanisms in the deltaic plain of the ganges meghna brahmaputra rivers mcarthur et al 2001 found that high p concentrations up to 5 mg l were driven by microbial degradation of buried peat deposits in their investigation of the p fate in pristine groundwater ecosystems neidhardt et al 2018 revealed that nom served both as a potential source and electron donor in the mobilization of p they found that the microbially mediated oxidation of nom was coupled with a rapid depletion in terminal electron acceptors such as iron oxyhydroxides in a recent study on geogenic p li et al 2022a presented field data under changing redox conditions and concluded that the degradation of nom was the dominant process that mobilized considerable amounts of p in groundwater under oxic suboxic conditions however these studies only identified the occurrence of p containing nom degradation coupled with geogenic p enrichment detailed mechanisms responsible for the coupling remain unknown additionally p containing dissolved organic matter dom molecules constitute an important fraction of dom yoshimura et al 2014 in general dom mainly consists of c h o n p and s whereas other elements can be disregarded for a general examination of molecular structures in dom koch and dittmar 2006 p containing dom molecules refer to all dom compounds containing p atoms which could be further classified into chop chonp chosp and chonsp compounds however due to its own complexity and the limitations of analytical techniques the biogeochemical behavior of p containing dom has not been well studied worsfold et al 2008 van der veen and de boer 2012 although recent technological advances have yielded some novel insights into it in surface waters farmland soil and ocean environments baldwin 2013 huang et al 2017 kour et al 2021 pu et al 2023 there has been no specific study on it in groundwater systems therefore characterizing p containing dom in groundwater can greatly improve our understanding of the mechanism for the enrichment of geogenic p in groundwater environments fourier transform ion cyclotron resonance mass spectrometry ft icr ms is a robust mass spectrometry technology for characterization of organic molecules in studying the molecular composition distribution or transformation bahureksa et al 2021 shen et al 2022 it has been increasingly used in recent years for studies on dom didonato et al 2016 zhang et al 2019 qiao et al 2021a maqbool et al 2022 including p containing dom in various aquatic environments such as natural surface water llewelyn et al 2002 cooper et al 2005 pollutant source water brooker et al 2018 water extractable lake sediments ni et al 2021 pu et al 2023 and agricultural runoff yang et al 2022 however no work has been done to use ft icr ms to characterize p containing dom in the groundwater environment except for liu et al 2023 high concentrations of p in groundwater were reported in alluvial pluvial and lacustrine environments such as the bengal delta plain in bangladesh as total dissolved phosphorus tdp and orthophosphate neidhardt et al 2018 red river delta in vietnam as orthophosphate neidhardt et al 2021 mississippi river valley plain in america as tdp welch et al 2010 spree river plain in germany as orthophosphate lewandowski and nutzmann 2010 jianghan plain as tdp dongting plain as tdp and hetao basin in china as tdp and orthophosphate tao et al 2020 2022 li et al 2022a in these locations p enrichment had been found to be closely related to abundant nom buried in aquifer sediments the area for this study is located along the yangtze river in the southern part of the jianghan plain which is a typical alluvial lacustrine plain with large amounts of plant and animal residues that were buried in pleistocene and holocene epoch duan 2016 chen 2020 an extensive and continuous low permeability layer that serves as an aquitard covers the surface of the study area and this layer can effectively prevent anthropogenic p transport from the surface to the underlying aquifers consequently this area is an ideal natural laboratory to study the geogenic p enrichment in groundwater systems although our recent work has detected high concentrations of tdp 4 mg l in aquifer systems in this region li et al 2022b zhou et al 2022 the relevant hydrogeochemical processes have not been well understood this study aims to characterize the molecular properties of p containing dom in the p rich quaternary aquifer system in the central yangtze river basin using ft icr ms coupled with conventional hydrogeochemical and carbon isotopic analyses so as to investigate the controlling mechanisms for the geogenic p enrichment in groundwater systems this research provides a new perspective and evidence for discerning and comprehending naturally occurring p in groundwater which has been underestimated or ignored in understanding the biogeochemical cycle of p in aquatic environments to date 2 materials and methods 2 1 study area and groundwater sampling groundwater samples were collected from aquifers of the southern part of the jianghan plain where reducing conditions driven by organic matter degradation prevail huang et al 2012 du et al 2020 the jianghan plain is a typical alluvial lacustrine plain that consists of sediments derived from the yangtze and han rivers fig 1 a it has a subtropical monsoon climate with an average annual temperature of 15 17 c and annual precipitation and evaporation of 1269 and 1200 mm respectively deng et al 2014 duan 2016 the shallow groundwater system in the plain consists of two layers the upper part is an aquitard composed of clay or silty clay locally interlaced silt with a thickness of 15 20 m the deeper part is a porous aquifer consisting of fine to coarse grained sand and gravel with a thickness of 50 80 m and most of our samples were collected in the upper part of the porous aquifer duan 2016 fig s1 in july 2018 and july 2020 41 groundwater samples were collected from the private wells in the study area the wells were purged for approximately 15 min prior to sampling until measurements of in situ parameters were stabilized samples were collected for analysis of cations trace elements anions dissolved organic carbon doc stable carbon isotope compositions δ 13c of dissolved inorganic carbon dic and doc dissolved gas ch4 dissolved p pools tdp dissolved inorganic phosphorus dip and dissolved organic phosphorus dop and ft icr ms all dissolved gas samples obtained from groundwater were stored in the dark and at 25 c until analysis in the laboratory within 7 days all liquid samples were stored in the dark and refrigerated at 4 c until analysis in the laboratory within 10 days liquid samples for ft icr ms analysis were subject to solid phase extraction for concentrating organic matter within 36 h and all solid phase extraction cartridges were preserved at 18 c in the dark before the elution procedure in the laboratory the elution procedures and analysis of eluted samples were completed within 10 days the supplementary materials contain more details on groundwater sampling and preservation and preparation for ft icr ms analysis 2 2 water chemistry and isotopic analyses temperature t ph redox potential eh electrical conductivity ec and dissolved oxygen do were determined in situ with a hach hq40d multimeter as redox sensitive components concentrations of ferrous ion fe2 and ammonium nh4 n were determined in situ with a portable spectrophotometer hach dr2800 usa using methylene blue and 1 10 phenanthroline methods respectively hach company 2002 alkalinity was determined within 24 h of sampling via hydrochloric acid titration with methyl orange or phenolphthalein as a dye indicator reger et al 2009 concentrations of major cations and trace elements were measured using inductively coupled plasma optical emission spectrometry icp oes iris intrepid ii xsp thermo electric company and inductively coupled plasma mass spectrometry icp ms nexion 350d perkinelmer respectively with a precision of 0 5 anions were analyzed via ion chromatography ic 761compactic metrohm ag with a precision of 3 0 ion charge imbalances between major cations and anions were largely better than 5 doc concentrations were determined using a total organic carbon toc analyzer elementar vario toc germany with measurement uncertainties of 3 ch4 concentrations were analyzed using gas chromatography flame ionization detection gc fid thermo scientific with measurement uncertainties of 5 all of the above chemical analyses were conducted at the school of environmental studies china university of geosciences at wuhan the carbon isotope ratios in dic were determined by an isotope ratio mass spectrometry irms thermo fisher scientific mat 253 at the chinese academy of agricultural sciences caas in beijing the carbon isotope results were reported with delta δ values as deviations in per million from the vpdb vienne pee dee belemnite standard the measured δ 13c dic values were verified using the certified iaea ch3 sucrose a standard na2co3 solution was prepared with a known δ 13c value of 10 8 0 2 the precision based on replicate analysis was 0 2 for δ13c dic the details of δ 13c dic measurement methods are described in wang et al 2014 the δ 13c values in doc was measured by a toc irms isoprime elementar germany at the third institute of oceanography ministry of natural resources the measured δ 13c doc values were verified using the certified iaea ch6 sucrose repeated measurements of an internal standard had a precision of 0 2 for δ 13c doc the details of δ 13c doc measurement methods can be found in lee and kim 2018 2 3 measurement of dissolved phosphorus pools in groundwater one of the most common simple and reliable chemical analyses of p pool concentrations in natural aquatic environments to date is the standard molybdenum blue colorimetric method concentrations of tdp pool were determined using the conventional molybdenum blue technique after digestion zhang et al 2010 the dip pool reported in this study is the molybdate reactive p i e orthophosphate as phosphorus and their concentrations were determined using an adaptation of the molybdate blue method without digestion murphy and riley 1962 although real dip pool also includes condensed phosphates this form of dip is widely found in waste waters and has low concentrations in natural aquatic environments halliwell et al 1996 packa et al 2019 in addition dip is subtracted from tdp to get the concentration of the dop pool zhang et al 2010 concentrations of dip and tdp were measured at a wavelength of 700 nm using a uv 1800 pc uv vis spectrophotometer thermo scientific with results compared to a blank spectrum obtained from ultrapure 18 2 mω milli q water prior to sample analysis an instrument baseline correction was done analyses were performed in triplicate to assess their reproducibility and the resulting standard deviations were better than 9 2 4 molecular characterization using ft icr ms the procedure for preparation of dom samples for ft icr ms is provided in the supplementary materials all extracted and concentrated samples were examined at the research center for eco environmental sciences chinese academy of sciences using a bruker apex ultra ft icr ms outfitted with a 15 t superconducting magnet the results were collected using an apollo ii electrospray ionization device in negative mode more information on the ft icr ms settings for data acquisition and its mass calibration can be found elsewhere lv et al 2016 during ft icr ms data processing all compounds with 13c 15n 18o and 34s were eliminated from the dataset since they represented duplicates of the c n o and s parent molecules respectively based on the chemical criteria kujawinski and behn 2006 a previously published software was used to calculate the molecular formulas of compounds containing elements c h o n s and p freely available at chemrxiv https doi org 10 26434 chemrxiv 9917399 more details about an accurate and efficient formula assignment from a number of mass data especially the assignment of p containing compounds can be found in fu et al 2020 the normalized peak intensity was used to calculate the mass to charge ratios m z and elemental ratios h c o c p c and n c the double bond equivalents dbe modified aromaticity index aimod and nominal oxidation state of carbon nosc were calculated based on elemental formulas koch and dittmar 2006 larowe and van cappellen 2011 spencer et al 2014 boye et al 2017 in addition it should be pointed out that the ratios of the compounds were calculated from the entire molecular dataset of ten ft icr ms samples collected in this study rather than one or several ft icr ms samples 2 5 statistical analysis ibm spss statistics v25 0 0 and matlab r2018 were used for statistical analysis and data handling respectively the distributions of the dataset variables were analyzed to establish how closely the sample data adhered to the assumption of normality for a 95 confidence interval simple correlation was performed to establish relationships between two parameters for correlation analysis both spearman correlation coefficients and p values were provided the mann whitney u test was used to assess whether there is a statistical difference between two sample groups e g high p groundwater and low p groundwater groups corresponding to tdp 1 mg l and tdp 1 mg l in addition the data were graphed using origin 2021 and r statistics v4 2 0 3 results and discussion 3 1 sources and fate of p in groundwater dissolved p pools in groundwater had wide ranges tdp 0 01 4 50 mg l dip 0 01 3 66 mg l dop 0 01 1 80 mg l fig 1 and table s1 dip accounted for 25 nearly 100 average 77 median 83 of the corresponding tdp concentrations and a highly positive correlation was observed between dip and tdp concentrations r 0 95 p 0 001 suggesting that dip was the predominant p pool in groundwater other data regarding hydrogeochemistry and isotopes are also listed in table s1 high p groundwater tdp 1 mg l had lower eh values average 136 3 mv from 163 4 to 115 9 mv than low p groundwater average 79 9 mv from 171 1 to 153 9 mv p 0 05 ec values in high p groundwater average 1300 μs cm median 1190 μs cm were higher than those in low p groundwater average 878 μs cm median 932 μs cm p 0 001 this indicated that high p groundwater was commonly found in a reducing hydrogeologic environment with a slow flow and a long term water rock interaction no3 so4 2 and cl concentrations were lower in high p groundwater tdp 1 mg l average 3 60 mg l 0 36 mg l 2 25 mg l than those in low p groundwater tdp 1 mg l average 5 44 mg l 15 91 mg l 8 45 mg l p 0 05 elevated concentrations of no3 so4 2 and cl can be regarded as indicators to anthropogenic pollution of groundwater in humid inland areas e g rotiroti et al 2017 du et al 2020 and the positive correlations among these three ions implied that they should have the same source table s2 therefore elevated groundwater p concentrations in the studied aquifer are less related to anthropogenic inputs and geogenic p released from aquifer matrices warrants special attention naturally occurring p in groundwater is generally attributed to the release of p bearing minerals mainly as p rich iron or calcareous minerals and the degradation of p containing nom orihel et al 2017 neidhardt et al 2018 the rapid dissolution of p rich calcareous minerals such as apatite tends to appear in acidic groundwater environments thus their contribution to p enrichment should be quite low in the circum neutral zone the ph range of the study area 6 70 7 81 sjöberg and rickard 1984 fulmer et al 2002 wang et al 2005 this assumption can be supported by the lack of a correlation between dip and ca concentrations table s2 a good positive correlation r 0 70 p 0 001 between dip and fe2 concentrations suggested that the p bearing fe minerals could be a nonnegligible source of groundwater p the dissolution include reductive fe iii oxyhydr oxides and non reductive vivianite or desorption of p rich fe minerals could release orthophosphate into ambient groundwater nevertheless the dip fe2 molar ratio of around 1 10 in our groundwater samples was 2 5 times the ratios found at recent lacustrine sediments typical sediment water interfaces 0 2 0 5 lijklema 1980 gunnars et al 2002 katsev and dittrich 2013 the dip fe2 ratio should be 0 67 even if vivianite is the only source of dip in groundwater eq 1 the much higher dip fe2 ratio in our data indicated that there should be other important source of groundwater orthophosphate this other source must be p containing nom from the aquifer sediments eq 2 groundwater samples contain amounts of ammonium and dip that reflect the maximum ratio likely to be found in common wetland vegetation fig 2 b redfield ratio n p molar ratio 16 redfield 1963 mcarthur et al 2001 zhang et al 2017 suggesting that both come from this source it should be noted here that while the redfield ratio was originally derived from marine ecology a growing research have shown that n p in om including wetland vegetation is close to that in seawater a relationship maintained through a set of biological feedbacks fitter and hillebrand 2009 gruber and deutsch 2014 vivianite dissolution kazmierczak et al 2021 1 fe3 po4 2 8h2o 2hpo4 2 h2po4 aq 3fe2 aq 8h2o p containing nom degradation 2 ch2onxpy mn ⅳ fe iii so4 2 xnh4 aq yhpo4 2 h2po4 aq hco3 aq mn ⅱ fe ⅱ s ii from fig 2b we estimate in approximately 66 of the groundwater samples n p molar ratio 16 p comes from p containing nom degradation it therefore seems likely that p containing nom degradation was an important source of groundwater p furthermore the release of p into groundwater via p containing nom degradation could be supported by the results of hydrochemistry and carbon isotopes the statistically significant correlations among dip hco3 nh4 n and doc concentrations fig 2a b table s2 indicated a mobilization of p via p containing nom degradation pathway as described by eq 1 the cl br mass ratio is a useful parameter for distinguishing components of natural origin 250 from those of wastewater origin up to several thousands in groundwater davis et al 1998 mcarthur et al 2012 this is mainly because om degradation concentrates br rather than cl whereas leachates from human sewage have high cl br ratios due to addition of common salt such as cl evaporation concentration during recharge may also receive additional br mcarthur et al 2016 however in such a humid plain the evaporation intensity is not strong enough for cl to precipitate therefore evaporation is not the main reason for the low cl br phenomenon in this study area compared with groundwater samples with lower dip levels 0 50 mg l groundwater samples with higher dip levels 0 50 mg l have fairly low cl br mass ratios p 0 01 which further suggests p containing nom degradation as source of dip in groundwater fig s3 the signatures of carbon isotopes responded to the same p mobilization pathway groundwater samples with higher dip levels 0 50 mg l typically exhibited higher δ 13c values in doc from 30 5 to 24 5 whereas those with lower dip levels 0 50 mg l exhibited lower δ 13c values in doc from 39 1 to 28 7 fig 2c this finding suggests that intense p containing nom degradation would have taken place in the groundwater with high dip levels because 12c in the reactant doc is preferentially taken up into the product dic during microbial degradation and the residual reactant doc is correspondingly enriched in the heavier 13c clark and fritz 1997 xue et al 2019 in addition the δ 13c values in dic suggested that extremely intensive nom degradation has occurred even progressing to the stage of methane production fig 2d ch4 concentrations of detected samples shown this is due to the fact that different methanogenic pathways can all enrich 13c in produced or residual dic therefore yielding a positive δ 13c dic value blaser and conrad 2016 du et al 2020 3 2 molecular characteristics of p containing dom in groundwater the molecular compositions of dom concentrated and isolated from 10 groundwater samples with different ranges of tdp levels 0 50 0 50 1 00 1 01 2 00 and 2 00 mg l were characterized by ft icr ms analysis overall a total of 3218 6200 species of elemental combinations were detected in dom and the identified p containing compounds 208 1534 species could be further divided into one p atom 1p compounds 174 1109 species and two p atom 2p compounds 46 425 species table s3 s4 s5 and s6 detailed statistical parameters related to dom p containing dom 1p and 2p compounds from the molecular characterization of each groundwater sample can be found in supplementary materials considerable differences were observed across different organic compounds especially between dom and p containing dom or between 1p and 2p compounds these differences were based on three aspects heteroatom category compound class and chemical property c h o and p are the basic constituent atoms of p containing dom so n and s are assigned as heteroatoms which make molecules more diverse and complex according to the heteroatom category the identified p containing dom could be classified into four compound species namely chop chonp chosp and chonsp compounds as seen in the right part of fig 3 a chop compounds were dominant accounting for 64 3 followed by chonp 17 0 chosp 10 9 and chonsp compounds 7 8 moreover among the chop compounds 1p compounds were significantly more abundant than 2p compounds 62 vs 3 this suggests that larger numbers of cho 1p compounds are preserved than that of cho 2p compounds implying a possible transformation gradient from cho 2p compounds to cho 1p compounds in the compounds that contained only n or s i e chonp or chosp the proportion of 2p compounds was greater compared with chop but still lower than that of 1p compounds in contrast among the chonsp compounds the proportion of 2p compounds exceeded that of 1p compounds fig 3a this indicated that a greater number of n s containing compounds were present among the 2p compounds and their compositions were more complex notably c h and o are the basic constituent atoms of dom and p should be also assigned as a heteroatom along with n and s p containing dom only accounts for 17 3 of dom 1p compounds 14 1 2p compounds 3 2 which suggests that the elemental abundance of p in dom is low this is consistent with other reports the concentration of p containing molecules is very low and the dominant background of dom is dissolved organic c n and o compounds dissolved organic p is remineralized twice as rapidly as dissolved organic c which may be an important reason for this phenomenon kruse et al 2015 duhamel et al 2021 the van krevelen diagram can be used to visualize the ft icr ms data kim et al 2003 which shows the relationship between the h c and o c for all observed compounds fig s4 the relative location of each compound in the diagram indicates the class to which that compound belongs aliphatic compounds 1 5 h c 2 highly unsaturated compounds aimod 0 5 and h c 1 5 polyphenols 0 5 aimod 0 66 polycyclic aromatics aimod 0 66 and saturated compounds aimod 0 5 and h c 2 detailed descriptions of the classes can be found in spencer et al 2014 to highlight the differences across organic species the weighted average relative abundances within all samples of five different compound classes were tallied fig 3b highly unsaturated and aliphatic compounds were the most abundant compound classes in all organic species together accounting for 81 8 90 2 of all identified compounds both compound classes mainly contain labile organic components and are generally considered as intermediates or end products of nom biodegradation mcdonough et al 2020a qiao et al 2021b the total proportion of these two compound classes in p containing dom is higher than that in dom 88 6 vs 82 4 and so is 1p compounds than 2p compounds 90 2 vs 81 8 in contrast polyphenols and polycyclic aromatics mainly contain stable or recalcitrant organic components which are frequently leached from organic horizons rich in vascular plant matter these substances can also be accumulated in the subsurface through sedimentary inputs mcdonough et al 2020b qiao et al 2021a the total proportion of these two compound classes in p containing dom is much lower than that in dom 2 8 vs 15 2 and 1p compounds also exhibit the same comparing result relative to 2p compounds 1 7 vs 7 7 the chemical properties of different organic compounds are further characterized using the values or numbers of the following parameters m z c h o n s dbe aimod nosc o c h c p c n c fig 4 in the 10 groundwater samples the weighted average of m z m zwa values of dom 393 82 449 78 da average 426 98 da were higher than those of p containing dom 389 28 434 98 da average 414 76 da moreover the m z wa values of 2p compounds 402 95 471 88 da average 428 72 da were also higher than those of 1p compounds 378 81 434 98 da average 411 48 da in terms of the number of different atoms p containing dom contains fewer cwa atoms more hwa atoms fewer owa atoms more nwa atoms and more swa atoms than dom this is likely because relatively simple cho compounds constitute the majority accounting for 56 2 of dom components fig 3a whereas p containing dom are more complex and may undergo cross polymerization via the linking of n and s functional groups turner et al 2005 1p compounds have fewer cwa atoms more hwa atoms more owa atoms fewer nwa atoms and fewer swa atoms than 2p compounds this can be attributed to the more complex and diverse molecular architecture of 2p compounds for example s atoms can occupy the sites of o atoms in the structure of p o or p o forming phosphorodithioate turner et al 2005 this is supported by the higher dbewa and aimod wa values in 2p compounds than those in 1p compounds higher dbe values suggest a greater number of double bonds and rings in compounds and higher aimod values signify a greater number of aromatic structures in compounds du et al 2020 additionally the relative changes in the o c h c p c n c and nosc values can be used to infer the degradation process of organic species pracht et al 2018 yu et al 2020 du et al 2021 mcdonough et al 2022 which is explored further in the following section thus the chemical properties of different organic compounds are considerably impacted by the combined effects of the molecules themselves and p containing dom degradation 3 3 p containing dom degradation and p enrichment in groundwater the van krevelen diagrams depict 128 and 547 compounds which are significantly associated with dip and dop concentrations respectively in our groundwater samples i e p 0 05 fig 5 a plots with more detailed subdivisions for various heteroatom categories with strong positive correlations are provided in fig s5 i e r 0 5 p 0 05 the degradation of p containing dom produces phosphate and anoxic conditions and the absence of photodegradation lead to very low biodegradation rates of p containing dom in the subsurface mcdonough et al 2022 thus compounds that exhibit significantly positive correlations with dop concentrations represent the products of some degree of original p containing dom degradation furthermore such compounds could be further degraded to form compounds with strong molecular level associations with dip concentrations therefore the differences between compounds with strong positive correlations with dop concentrations and those with strong positive correlations with dip concentrations confirm that an overall increase in h c and a decrease in o c occur as a result of the processing of p containing dom fig 5a this is further supported by the p c and n c values in compounds which are positively associated with dip concentrations are lower than those in compounds that are positively associated with dop concentrations fig 5b c this is because the degradation process of nom would result in the decrease in the number of p or n atoms in the molecular structure which corresponds to a significant decrease in p c or n c value yu et al 2020 du et al 2021 p containing dom degradation leading to the breaking of the phosphoester bond mainly including monoester p o c and diester c o p o c could further explain this processing pathway from the mechanistic perspective when the phosphoester bonds are cleaved during biodegradation or abiotic degradation h atoms are added into the processed organic molecules forming alcohol groups and phosphate groups are removed from the original organic molecules taking away the o atoms bonded to p atoms turner et al 2005 taft et al 2009 diez castellnou et al 2017 phosphohydrolases produced by microorganisms e g phosphomonoesterase phytase are the extracellular enzymes that play an important role in this biogeochemical p cycle turner et al 2005 consequently one large original p containing dom molecule is cleaved into one or multiple smaller molecules and the processed organic molecules demonstrate an increase in h c and a decrease in o c fig 6 phosphonates are another organic form of p they contain a direct c p bond and are less prevalent in freshwater ecosystems than they are in marine ecosystems cade menun et al 2006 baldwin 2013 additionally p containing dom degradation is an essential part of dom degradation and the p containing dom degradation pathways suggested herein i e an overall increase in h c and a decrease in o c with processed are also consistent with those identified about dom in other studies kellerman et al 2015 mcdonough et al 2022 in comparison to 2p compounds 1p compounds showed increased h cwa and decreased o cwa p cwa and n cwa the subscript wa refers to weighted average value which is in agreement with the trend discussed earlier this suggests that the transformation of 2p compounds to 1p compounds may occur during p containing dom degradation three other differences in molecular characteristics between 1p and 2p compounds further reflect this processing pathway firstly the molecular weight m zwa of 1p compounds is lower than that of 2p compounds because large molecules are broken into multiple smaller molecules during degradation processes schmidt et al 2009 seidel et al 2014 secondly the noscwa of 1p compounds is higher than that of 2p compounds compounds with higher nosc values are thermodynamically more favorable for oxidization and could be targeted easily by microorganisms in anaerobic environments pracht et al 2018 compared with 1p compounds 2p compounds have undergone a greater degree of degradation by microbes at an earlier stage therefore relative recalcitrant 2p compounds are preserved with lower nosc values 1p compounds with higher nosc values could be further degraded thirdly the total proportion of highly unsaturated and aliphatic compounds considered as intermediates or end products of biodegradation of 1p compounds is higher than that of 2p compounds and the total proportion of polyphenols and polycyclic aromatics considered as sedimentary inputs from terrestrial vascular plants of 1p compounds is lower than that of 2p compounds it has been demonstrated that nom is degraded along a gradient from polyphenols and polycyclic aromatics to highly unsaturated compounds and aliphatic compounds in groundwater environments kellerman et al 2015 mcdonough et al 2020b 2022 which is consistent with the processing pathway from 2p to 1p compounds furthermore the p cwa ratios are positively correlated with the percentages of the number of 1p compounds relative to p containing dom in 10 groundwater samples r 0 874 p 0 001 indicating that the number of 1p compounds is relatively increasing and the number of 2p compounds is relatively decreasing during degradation this processing pathway also is in accordance with the concept of ni et al 2021 who proposed that 2p compounds are possibly preferentially degraded in lake sediments in summary a comprehensive mechanism dominated by p containing dom may be identified as being in charge of the enrichment of geogenic p in alluvial lacustrine aquifer systems large volumes of wetland plant remnants were quickly deposited during the evolution of the rivers and lakes in the study area and they were thereafter buried in subsurface sediments which are hence rich in p containing nom the dissolution or mineralization of p containing nom can release dissolved p into ambient groundwater which may raise dop and dip concentrations in groundwater however underlying mechanisms should be further explored although the subsurface environment is anaerobic and photodegradation does not occur the active degradation of p containing dom depending on the thermodynamic conditions could still take place by detailed characterization at the molecular level p containing dom degradation overall resulted in an increase in h c and a decrease in o c and a processing gradient is observed from 2p to 1p compounds during these cascades of p containing dom degradation dip was gradually accumulated and retained in the subsurface environment eventually becoming the predominating p pool in groundwater fig 6 4 conclusion global median estimates of groundwater borne p transport associated with lacustrine groundwater discharge and submarine groundwater discharge are 45 and 1000 mg p m 2 per year lewandowski et al 2015 santos et al 2021 in contrast to groundwater p pollution due to anthropogenic inputs the release of geogenic p is continuous and is difficult to be surveilled thus it is both essential and challenging to elucidate the biogeochemical mobilization of geogenic p in the subsurface our results demonstrate p containing dom is a quite important factor controlling groundwater p enrichment in the study area furthermore an increasing body of work has been conducted on the molecular characterization of p containing dom in surface waters and marine environments baldwin 2013 brooker et al 2018 pu et al 2023 however to date there has been no research on it in aquifer systems this study used ft icr ms to characterize the detailed molecular characteristics of p containing dom in alluvial lacustrine aquifer systems in terms of heteroatom category compound class and chemical property on this basis two processing pathways were proposed at the molecular level p containing dom degradation overall results in an increase in h c and a decrease in o c and a processing gradient is observed from 2p to 1p compounds during which dip was gradually accumulated and retained eventually becoming the predominating p pool in groundwater these findings not only address a knowledge gap about p containing dom research in aquatic systems but also provide new insights into the anomalous concentrations of p in groundwater of alluvial lacustrine sandy aquifer systems especially two processing pathways of p containing dom proposed in this study would be of much merit in similar aquifer systems around the world and similar processing pathways have been found in the studies of groundwater dom du et al 2021 mcdonough et al 2022 in further study characterizing organic p in solid sediments and carrying out indoor water sediment incubation experiments are needed to delineate the p containing om processing pathways in high p groundwater systems in more detail credit authorship contribution statement yanqiu tao conceptualization investigation methodology formal analysis writing original draft writing review editing yao du conceptualization supervision funding acquisition writing review editing yamin deng data curation project administration writing review editing teng ma funding acquisition yanxin wang project administration writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research work was financially supported by the project of hubei provincial key research and development no 2020bca088 national key research and development program of china no 2021yfa0715900 the national natural science foundation of china no u21a2026 no 42177181 no 4201001051 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129513 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 
1924,climate change has significantly impacted hydrology including extreme precipitation and changing precipitation patterns that could lead to an increase in flooding life and property benefit from accurate and reliable multi step flood forecasting recently recurrent neural network rnn have become increasingly popular among hydrology researchers for their ability to capture historical dependencies simplify computations by ignoring intermediate hydrological processes and provide higher prediction accuracy than traditional models however rnn based flood prediction models face two significant challenges firstly due to their strict time serial rnn suffer from gradient issues such as vanishing and exploding gradients which can make training rnn models difficult to address this issue we propose a residual long short term memory reslstm model that incorporates time residual connections into the time connections of lstm secondly most flood prediction models output a deterministic value but the natural hydrological characteristics of the basin are a nonlinear and complex system with many influencing factors that have some randomness this requires the use of probabilistic methods to modeling thus we introduce the probabilistic forecasting model autoregressive recurrent networks deepar into our flood prediction model which outputs a prediction interval rather than a deterministic value then we build four flood probability prediction models by combining deepar and four enhanced rnn including reslstm ours long short term memory lstm gate recurrent unit gru and time feedforward connections simple gate recurrent unit tfc sgru the performance of these models is evaluated by the long term hydrologic data of the passaic and ramapo river basins in the united states the results demonstrate that the prediction interval of the four models is more adaptive to flood uncertainties and the accuracy of peak flow prediction is nearly 100 within a 90 prediction probability interval the temporal residual based model is more accurate and robust than the original lstm and gru we believe this study fills a research gap in multi step ahead flood probability prediction and improves the accuracy and reliability of flood prediction models keywords residual long short term memory flood forecasting rainfall runoff time series task probability distribution data availability data will be made available on request 1 introduction according to the united nations world water development report unesco 2020 74 of the world s disasters over the past two decades were water related effective flood forecasting is essential for mitigating flood risk and managing water resource systems hydrodynamic models based on physics and machine learning ml models based on data have been developed to study flood risk hydraulic and hydrodynamic models are commonly used in flood research wen et al 2013 shrestha et al 2020 although hydraulic and hydrodynamic models are incredibly efficient they require precise boundary conditions and complex calculations jodhani et al 2021 thus more and more researchers have recently focused on ml ml has been applied to the analysis of various natural hazard types such as floods campolo et al 1999 li et al 2011 utilizing techniques such as support vector regression choubin et al 2019 yu et al 2006 decision trees bui et al 2019 khosravi et al 2018 random forest tang et al 2021 zahura et al 2020 genetic algorithms arturo et al 2021 wang et al 2011 optimally pruned extreme learning machine op elm adnan et al 2019 adnan et al 2020 and two ml training strategies for self organizing maps to address the issue of non convergence during clustering of high dimensional datasets chang et al 2021 unlike physics driven models ml does not require precise boundary conditions and complicated physical calculations nonetheless flood analysis is a dynamic process with a temporal variation ml type models lack mechanisms to capture long term dependencies deep learning dl based on ml has come to the attention of researchers the recurrent neural network rnn is a type of dl used to perform time series tasks rnn can extract spatial temporal features from data and is advantageous for predicting flood risks yaseen et al 2015 rnn predicts flooding by mining historical data for driver factors thus rnn has been successfully applied to many earth science problems reichstein et al 2019 wang et al 2020 ikram et al 2023 and related applications such as hydrology munawar et al 2021 le et al le et al 2019 proposed a model for flood prediction based on long short term memory lstm the results demonstrated that the lstm s predictive ability was quite remarkable fang et al used the lstm to predict flood susceptibility with dependable accuracy fang et al 2021 the authors proposed a hybrid neural network model for flood forecasting by combining a convolutional neural network cnn with an lstm chen et al 2022 google provides a neural network alternative for hydraulic modeling of flood inundations the lstm model is used for real time flood warnings nevo et al 2022 the results showed that the lstm is more accurate than the conventional model in most catchments the rnn models provide a more accurate functional representation of rainfall runoff than the ml models feng et al 2020 kratzert et al 2019 although rnn has significant advantages in various time series tasks liu et al 2019 mikolov et al 2010 singh et al 2017 rnn remains a huge challenge because the time serial dependencies limit the accuracy the time serial of rnn refers to the process of unraveling the recurrent connections of the network over time by unrolling the network over time we create a temporal sequence of connected neural network layers that can be trained with backpropagation through time to learn complex temporal dependencies rnn time series dependencies can cause difficulties in training flood prediction models based on rnn as the repeated multiplication of gradients over time can result in the vanishing and exploding gradients issues bengio et al 1994 lstm gers et al 2000 hochreiter and schmidhuber 1997 and gate recurrent unit gru cho et al 2014 have been proposed to address gradient issues with gates strategies an lstm cell consists of an input gate an output gate and a forget gate consequently a gru cell comprises an update gate and a reset gate although lstm and gru improve the gradient issues in rnn by employing gates strategies the problem of vanishing and exploding gradients resulting from the time serial dependencies of rnn still persists and has not been fundamentally resolved however most rnn based flood prediction models utilize the original model without addressing its limitations such as hybrid long short term memory neural network and ant lion optimizer model lstm alo yuan et al 2018 lstm ed multi step ahead flood forecasting by combining the advantages of encoder decoder and lstm kao et al 2020 sae rnn by combining stacked autoencoders sae with rnn kao et al 2021 adnan proposed an improved adaptive neuro fuzzy system anfis model called anfis gbo which enhances the model s performance through various model heterogeneity methods using gradient based optimization techniques adnan et al 2022 wang et al 2023 proposed the time feedforward connections simple gate recurrent unit tfc sgru by introducing highway networks hn srivastava et al 2015 to improve the time series dependencies the tfc sgru model incorporates shortcut connections between time steps t 2 and t to enable direct information flow without the need for nonlinear transformations at time step t thereby altering the time series dependencies of traditional rnn hn is a time residual scheme that incorporates parameters however due to the high computational complexity of lstm pascanu et al 2013 a no parameter residual strategy may be superior to hn inspired by tfc sgru and anfis gbo we propose a novel rnn architecture called time residual lstm reslstm to address the gradient problem caused by the time series dependencies of rnn unlike tfc sgru reslstm adopts a no parameter residual scheme by introducing a no parameter residual resnet he et al 2016 yue et al 2018 the natural temporal systems are often impacted by multiple uncertain factors and randomness which makes accurate predictions challenging nevertheless the probabilistic models enable the prediction of the range and probability distribution to address the probabilistic forecasting issue in rnn researchers proposed a probabilistic forecasting approach based on autoregressive recurrent networks deepar salinas et al 2020 deepar is a deep learning based time series probabilistic forecasting model the aim of flood prediction is to get the future water level or peak streamflow at a specific time however basin river systems hydrological characteristics are nonlinear and complex influenced by several factors future values are often affected by numerous uncertainties such as future rainfall infiltration terrain basin characteristics etc as a result accurate single value of future flood peak streamflow is often challenging a more appropriate approach would be to estimate the possible range of values and probability distribution of future flood peak streamflow using a probabilistic model which would better reflect the system characteristics here the deepar model is introduced to solve the problem of flood probability distribution we propose a novel temporal residual long short term memory model for flood probability prediction based on deepar and reslstm finally we employ three powerful optimization techniques namely data cleaning normalization and feature filtering to enhance the performance of the flood probability prediction model based on these approaches our model is not only capable of capturing the attribution information of flood conditioning factors and the local spatial information of flood data but it also has powerful sequential modeling capabilities to handle the spatial temporal relationship of floods the main contributions of this paper are summarized as follows we proposed a reslstm that can improve the gradient problem of lstm by breaking the time serial we introduced the probability forecasting deepar to reslstm to solve the flood probability distribution we presented a multi step ahead model for predicting the probability of flooding we constructed four flood probability prediction models by integrating deepar and four enhanced rnn including reslstm lstm gru and tfc sgru the rest of this paper is organized as follows section 2 presents the rnn deepar models and computational methods section 3 describes the studied basin and data section 4 introduces our reslstm and the structure of the flood probability prediction model section 5 provides the experimental results based on the hydrologic data of the passaic river and ramapo river basin in the united states section 6 concludes this paper 2 methodology 2 1 recurrent neural network rnn is a common deep neural network dnn used to handle time series tasks chung et al 2014 rnn was first proposed in 1990 elman 1990 we can express it as follows 1 h t t a n h w x t v h t 1 b where t is the time step x t and h t represent the input matrix and hidden state respectively h t 1 denotes the previous hidden state w v b represent the input weight the hidden weight and the bias respectively t a n h x e x e x e x e x in contrast to dnn the input of each rnn cell comprises input from the current time as well as output from the previous time therefore rnn are more powerful than dnns in learning sequences however traditional rnn are difficult to train due to gradients that vanish and explode to solve this issue lstm is proposed 2 f t s i g m o d w f x t v f h t 1 b f 3 i t s i g m o d w i x t v i h t 1 b i 4 o t s i g m o i d w o x t v o h t 1 b o 5 g t t a n h w g x t v g h t 1 b g 6 c t i t g t f t c t 1 7 h t o t t a n h c t where f t i t o t c t h t represent the forget gate the input gate the output gate the memory state and the hidden output state respectively memory state is intended to capture long term memory the input gate is used to filter the input information the forget gate can filter out noise from the past the output gate is the final output checkpoint w v b represent the input weight the hidden weight and the bias respectively is the hadamard product the activate function s i g m o d x 1 1 e x while the performance of lstm has improved its computational complexity has increased proportionally then a simplified gated lstm denoted bygru is proposed 8 z t s i g m o d w z x t v z h t 1 b z 9 r t s i g m o d w r x t v r h t 1 b r 10 h t t a n h w x t r t h t 1 11 h t 1 z t h t 1 z t h t where z t r t represent the update gate and the reset gate respectively h t h t represent the hidden output state and the transition state respectively w v b represent the input weight the hidden weight and the bias respectively gru reduces training parameters by eliminating lstm s output gate nonetheless the performance of lstm and gru is still constrained by the time serial dependence alone the rnn models are trained using backpropagation through time bptt continuous multiplication is used to update gradients which limits the performance of the gate method thus the authors proposed a time residual simple gru by introducing the hn named tfc sgru as expressed as follows 12 z t s i g m o d w z x t v z h t 1 b z 13 s t s i g m o d w s x t v s h t 2 b s 14 h t t a n h w x t z t h t 1 15 y t 1 z t h t 1 z t h t 16 h t 1 s t h t 2 s t y t where z t s t represent the update gate and carry gate respectively h t h t 1 and h t 2 represent hidden output at time t t 1 and t 2 respectively due to the time shortcut of tfc sgru gradient update is achieved by a sum expression instead of continuous multiplication tfc sgru enhances feed forward connections between time steps thereby enabling the gradient from t 2 to t without the nonlinear transformation at time t tfc sgru can improve the gradient issuein horizontal rnn propagation 2 2 probabilistic forecasting model deepar is a probabilistic model for forecasting time series data we can receive both a predicted value and a probability distribution deepar is an embedded autoregressive recurrent network rnn set a sequential series z t t 0 t and the index t 0 1 2 t 0 1 are the conditioning range and t 0 t 1 t are the prediction range the deepar is shown in fig 1 h t is the hidden output of rnn at time t x t and z t are the input series and output values at time t respectively l t represents the likelihood function the gaussian likelihood for real valued data then we set the likelihood as follows 17 l z μ σ 1 σ 2 π e x p z μ 2 2 σ 2 18 μ t ω μ t h t b μ 19 σ t ω σ t h t b σ where μ is the mean σ is the variance ω is the weight matrix and b is the bias deepar learns the internal characteristics of the different periods to improve the accuracy of predictions in contrast to non probabilistic models this network predicts distribution parameters rather than a single value there are two benefits to output distribution 1 since most nonlinear systems have random properties the output probability distribution is closer to nature 2 it can evaluate the forecast s uncertainty and risk 2 3 evaluation of model performance in this paper the aggregate performance of our models is evaluated using statistical error metrics such as the root mean square error rmse the mean absolute error mae and the mean absolute scaled error mase as illustrated in eqs 20 to 22 20 rmse 1 n i 1 n y i y i 2 21 mae 1 n i 1 n y i y i 22 mase mae 1 t 1 t 2 t y t y t 1 where n represents the number of samples and y i y i denote the predicted and observed values respectively t 1 2 t is the time of training sets rmse also referred to as the standard error is calculated as the square root of the ratio between the sum of squared deviations of observed values from true values and the number of observations it is commonly used to quantify the deviation between observed and true values and is particularly sensitive to both large and small errors within a set of measurements thus making it an effective measure of precision however one major limitation of rmse is also its susceptibility to outliers which can distort the results and lead to misleading conclusions in addition rmse may be less intuitive to interpret since it measures errors in squared units which may not be directly comparable to the original units of the data mae is a commonly used metric for assessing prediction accuracy it calculates the average of the absolute differences between predicted values and actual values mae is a robust measure that is not affected by outliers since it considers only the absolute error between the predicted and actual values regardless of the direction of the error for stable prediction models mae provides a reliable measure of the error however the disadvantage of mae is that it treats all errors equally irrespective of their magnitude this drawback can lead to scenarios where mae does not effectively capture the magnitude of the prediction error moreover mae does not indicate the direction of the error mase is calculated by dividing the mean error by a scaling factor which is determined by the seasonal value m selected based on the forecasting frequency a lower mase value indicates a higher accuracy of the forecasting model mase is particularly suitable for datasets that exhibit periodic or seasonal characteristics considering the seasonal effects can improve the accuracy of forecasting floods with low rainfall during the rainy season and less rainfall during the dry season 3 studied basin and data our research is focused on a watershed located at the confluence of the passaic river and ramapo river we use data from the passaic river and the ramapo river in new jersey and new york in the united states as shown in fig 2 a c the passaic river basin is located below millington canyon and covers about 881 square miles the united states geological survey usgs monitors this river from four different hydrologic observation stations along the passaic river as shown in fig 2 c by the yellow circles the ramapo river is monitored by four distinct usgs hydrologic observation stations as depicted by the orange circles in fig 2 c the red circle in fig 2 c represents the forecast objective station usgs 01389500 on the left bank of the passaic river at little falls new jersey 0 6 miles downstream of beatties dam in little falls and 1 0 mile upstream of peckman river fig 3 depicts the streamflow and precipitation for usgs 01389500 the green line on the left y axis represents the streamflow while the orange line on the right y axis represents the precipitation the hydrological features include daily precipitation and streamflow from 25 hydrological stations spanning the 32 year record from 1990 01 01 to 2021 12 31which are downloaded from the usgs website the average annual discharge of the objective station is 17 98 m3 s according to fig 3 the first half of the year is the wet season and the second half is the dry season typically april may and june are the busiest months of the year consequently the streamflow of usgs 01389500 is zero every november based on the data collected from hydrological stations we have determined that the average annual precipitation in the passaic and ramapo river watershed between 1990 and 2021 was 1258 mm day while the target station s average annual flow rate was 1 4 mm day to gain a deeper understanding of the station s multi year monthly flow rates we used statistical calculations to determine the multi year average flow rate for each month specifically by analyzing the watershed streamflow monthly average distribution chart in fig 4 we discovered that the multi year average streamflow in march was the highest at 2 46 mm day while june had the lowest average streamflow at 0 66 mm day these findings indicate that the watershed faces significant rainfall pressure in march and requires measures to prevent flooding fig 5 4 our proposed flood forecast model 4 1 residual long short term memory resnet is a cnn architecture that is well known for its ability to train cnns effectively with the capability to train networks with up to 152 layers training cnns with many layers before resnet was difficult due to vanishing gradients leading to poor performance and making it challenging for networks to learn from input data to address this issue residual learning was proposed which involves allowing the network to learn the residual mapping between the input and output by adding a shortcut connection on top of the original single connection between the layers the shortcut connection is a simple identity mapping that directly passes inputs to outputs without modification by weight layers despite the emergence of many rnn models lstm remains the best performing one jozefowicz et al 2015 however lstm has limitations such as too many training parameters and time serial dependencies that can decrease its accuracy to address this we propose a time residual lstm by incorporating shortcut connections from resnet into the time serial connections of lstm as shown in fig 6 this allows the hidden output h t 2 to be directly inputted to the cell at time t without the nonlinear transformation at time t 1 to maximize the spatial temporal information of streamflow and precipitation we enhance the residual network structure of the lstm cell as with the gru model we begin by erasing the lstm forget gate to reduce the number of parameters and accelerate convergence the internal structure of the reslstm cell is illustrated in fig 7 the time residual of reslstm is reflected in eq 27 the reslstm cell consists of an input gate and an output gate each gate of the reslstm cell connects the information of the input and the output h t of the hidden state eqs 23 27 provide the principle of the reslstm model 23 i t s i g m o d w i x t v i h t 1 b i 24 o t s i g m o i d w o x t v o h t 1 b o 25 g t t a n h w g x t v g h t 1 b g 26 c t i t g t f t c t 1 27 h t o t t a n h c t 1 o t t a n h h t 2 where i t o t c t g t a n d h t represent the input gate the output gate the memory state the internal state and the hidden output state at time t respectively w v a n d b represent the input weight the hidden weight and the bias respectively is the hadamard product like the lstm model the input gate filters the input information and c t is responsible for capturing long term memory we remove the forget gate of lstm and add the short term information h t 2 as the time shortcut to break the time serial dependency significantly the time shortcut permits the gradient at step t 1 to be transferred to step t 1 without the nonlinear transformation at step t more importantly we use the no parameter residual method instead of the parametric residuals in tfc sgru so there are no training parameters 4 2 flood probability forecast model design suppose there is an n k steps time series task where m represents the number of features in a single time step one day n represents the input time steps s denotes the predicted start time k represents the predicted time steps and p s 1 s k is the predicted sequence as shown in fig 8 our flood probability forecast model consists of four layers the input layer the rnn layer the likelihood layer and the output layer the rnn layer captures the temporal dependencies of the input array and identifies a more accurate functional representation of rainfall runoff the rnn layers depicted in fig 8 utilize reslstm but can be substituted with other models such as lstm and gru the output of the rnn is transferred to the likelihood layer which can search for possible output expression intervals the output layer outputs the prediction result p s 1 s k and probability intervals 4 3 input datasets the hydrological features include daily precipitation and discharge from 25 hydrological stations three powerful optimization techniques data cleaning normalization and features filter are adapted to further enhance the model s performance for predicting the probability of a flood the dataset is then divided into three subsets 1 data cleaning due to equipment failures the original dataset contains incomplete or missing data missing data which is a common occurrence can have a significant impact on the model s performance brunner et al 2021 as shown in eq 28 we use the mean of the still noise to handle the missing or low level outlier 28 x t x t 1 x t 1 2 where x t 1 and x t 1 are the values of the time t 1 and the time t 1 x t is the missing value 2 normalization we standardize input features to the range 0 1 with max min normalization as shown in eq 29 29 x norm x x min x max x min where x max and x min represent the maximum and minimum respectively 3 features filter we evaluate the correlation between each input feature and the streamflow of usgs 01389500 using the pearson coefficient the pearson coefficient ρ r p of array r and p is defined as the covariance cov r p between array r and array p divided by the product of their respective standard deviations σ r σ p as is shown in eq 30 30 ρ r p c o v r p σ r σ p where ρ r p is the pearson coefficient cov r p represents the covariance of r and p and σ r is the standard deviation the pearson correlation coefficient is used to measure the strength and direction of the linear relationship between two variables and it ranges from 1 to 1 a value of 1 indicates a perfect positive correlation between the variables while a value of 1 indicates a perfect negative correlation a value of 0 indicates no linear relationship between the variables in neural network feature engineering the pearson correlation coefficient is commonly used in the steps of feature selection and feature engineering to help identify the most relevant features to the target variable it can be used to identify highly correlated feature variables and to help exclude those feature variables that have no linear relationship with the target variable fig 9 shows the result of the pearson coefficient of 50 input features of 25 hydrological stations the numbers on the y axis are the hydrological station id the higher score the greater the significance of the feature then we use the threshold score 0 04 to filter features with low correlation 4 split datasets the datasets cover daily precipitation and streamflow at each station the output is usgs 01389500 streamflow about 80 of the data in each dataset is used for training 10 for validating including 1080 steps and 10 for testing the test set contains 1080 time steps days of hydrologic data from 2019 01 17 to 2021 12 31 we determined two output strategies for our experiments one step prediction 1 day with 1080 repetitions and eighteen step prediction 18 days with 60 repetitions 5 experimental results and discussion 5 1 parameters setting our model for predicting flood probability is based on rnn and deepar the rnn layer is essential for obtaining the flood model s long term dependencies this study compares reslstm to three modified rnn models lstm gru and tfc sgru training an rnn model requires selecting appropriate hyperparameters hyperparameters are manually set parameters that cannot typically be learned from the training data and require experience and trial and error to determine their optimal values common hyperparameters include the context length the number of rnn layers the number of rnn cells in each layer the learning rate the learning rate decay factor and the number of training epochs however due to the large number and complexity of hyperparameters the search space can be vast to select the best hyperparameter combination techniques such as grid search random search and bayesian hyperparameter optimization algorithms can be used in this paper we utilize the optuna open source python library to search for the optimal hyperparameter combination using the bayesian optimization algorithm the bayesian optimization algorithm is a method for optimizing neural network model hyperparameters by continuously updating the prior distribution of hyperparameters during the training process to find the optimal hyperparameters table 1 shows the optimal hyperparameters for the four probabilistic prediction models under the two output strategies 5 2 performance evaluation 5 2 1 the two output strategies results for the experiments in this paper the model error is evaluated using the aggregate performance metrics rmse mase and mae the smaller the rmse mae and mase the smaller the error and the greater the aggregate performance therefore these three metrics can effectively evaluate the robustness and regression accuracy of the four models table 2 illustrates the evaluation metrics for streamflow prediction at various output stages for the four models the accuracy of all models is strongly correlated with the output time step as the number of output time steps increases the accuracy of the four models decreases the results show that reslstm achieves rmse of 0 213 for one step output but drops to 0 248 for eighteen steps mase drops from 0 374 to 0 667 and mae drops from 0 080 to 0 142 the same applies to the remaining models the reason is that the longer the prediction step the more memory the rnn needs reslstm performs marginally better than tfc sgru for single step output but there is no significant difference in addition the aggregate performance of the lstm model outperforms that of all other models across all metrics however the reslstm model performs better than the others for the eighteen step output reslstm and tfc sgru are residual based models that incorporate the resnet and highway networks the residual based model is more accurate and robust than the original lstm and gru for long term prediction the residual network can reduce the rmse mae and mase of lstm and gru indicating that the residual module influences the rnn positively in multi step prediction our proposed reslstm outperforms competing models mae is the mean absolute value of the sum of all individual observations deviations from the arithmetic mean since rmse is sensitive to outliers mae can assess the network s robustness more accurately table 2 demonstrates that the rmse is greater than the mae for both output strategies this can be due to the large variation in monthly stream flows and the extremely inhomogeneous temporal distribution of precipitation within the study basin 5 2 2 multi step ahead flood peak probability intervals prediction the steps of test datasets are 1080 while the output steps are 18 of multi step prediction so we need to run 60 times during the time period of the test datasets there are three floods the first flood occurred at the 52nd forecast on 2021 08 24 the second at the 53rd forecast on 2021 09 03 and the third at the 56th forecast on 2021 10 27 our model is intended to generate probabilistic predictions rather than point forecasts the output is a prediction interval figs 10 12 display the eighteen step prediction results for three flood events from the reslstm tfc sgru lstm and gru models each of these plots shows the observations the median prediction the 50 prediction interval and the 90 prediction interval fig 10 a d depict the 90 prediction interval the 50 prediction interval and the observed streamflow by the four models for the 10th 27th august 2021 flood event the four models predict a reliable occurrence time of the flood peak the tfc sgru model forecasted a flood peak that was one day late and underestimated the streamflow in the rising period see fig 10 b during ascent the reslstm and gru models perform better than the lstm and tfc sgru models however the reslstm lstm and gru models outperform the tfc sgru model during the recession the reslstm model outperforms the other models in terms of flood peak flow the observation and 50 prediction interval are in excellent agreement during periods of expansion and contraction see fig 10 a fig 11 a d display the 90 prediction interval the 50 prediction interval and the observed streamflow for the flood event that occurred from august 28 to september 14 in 2021 as predicted by four models the observed flood hygrograms are higher than the first flood due to the relatively concentrated precipitation there may be a correlation between the irregular fluctuations of peak prediction intervals and the spatial temporal distribution of precipitation the four models severely underestimate the high flow rate due to the small number of training samples of high flow rate peaks during the rise the 90 prediction interval of the tfc sgru model is less than the observed flow nevertheless the 90 prediction interval of the gru is less than the observed value during the recession the 90 prediction interval of reslstm and lstm covers the observed flood peaks the lstm model performs better than the other models in terms of flood peak magnitude whereas the reslstm model performs better overall fig 12 a d depict the 90 prediction interval the 50 prediction interval and the observed streamflow by the four models for the 2021 flood event that occurred from october 21 to november 7 the 50 prediction interval of the reslstm and tfc sgru models covers the observed hydrograph of the flood peak whereas the lstm and gru models underestimate the flood peak during the ascent the reslstm and tfc sgru models perform reasonably well the lstm and gru models perform adequately well during a recession the reslstm and lstm models perform reasonably well during the flood peak occurrence time 5 2 3 comparison of the impact of different quantiles on multi step ahead flood peak prediction probability intervals in flood prediction offer accurate and comprehensive information indicating uncertainty and aiding decision making our model using deepar generates probability intervals with an 18 step output strategy showing the potential range of streamflow values over the next 18 days derived from historical data these intervals reveal the expected range of future flood flow values different quantiles have varying accuracy for probability distribution to further analyze model precision we have identified optimal quantiles for four probability prediction models in three flood predictions as shown in table 3 under optimal quantile conditions the peak flood prediction errors for three floods were compared across four flood prediction models in fig 13 all models performed well with peak flood prediction error less than 8 31 reslstm had the smallest error less than 2 tfc sgru had lower errors than lstm and gru in the first and third peak flood predictions but had a higher error than gru in the second prediction lstm and gru had similar errors in the three peak flood predictions with gru slightly outperforming lstm indicating gru s slightly better performance on small data sets such as hydrological data fig 14 illustrates the impact of different quantiles on the accuracy of flood event predictions comparing three events using reslstm models a c display 18 step predictions at the 0 56 0 78 and 0 88 quantiles for the first flood event the 0 56 quantile matches well with observed streamflow during the rising period while the 0 78 quantile outperforms other results during the recession period fig 14 a for the second flood event the 0 88 quantile performs reasonably well during both rising and recession periods fig 14 b the accuracy of the 0 56 and 0 78 quantiles for the third flood event is not significantly different fig 14 c reslstm results indicate that for the first flood the peak of the 0 56 quantile is closer to observed peak streamflow compared to the 0 88 quantile for the second flood the peak value of the 0 88 quantile is closer to the observed peak streamflow for the third flood the peak streamflow of the 0 78 quantile is closer to the observed peak streamflow fig 14 d f depict the prediction quantiles 0 56 0 90 and 0 92 for the three flood events by the tfc sgru models in fig 14 d the forecast interval for the first flood s rising period is narrow indicating that there are few uncertainties thus each quantile specific result is highly consistent in contrast during the recession the result of quantile 0 92corresponds with observation see fig 14 d as with reslstm the 0 95 quantile of tfc sgru yields the best results for the second flood see fig 14 e for the third flood all three quantiles are close to the observed streamflow during the rising period whereas the 0 92 quantile is closer than the others during the recession period see fig 14 f the tfc sgru results indicate that the 0 90 quantile result is closer to the observed peak streamflow of the initial flood quantile 0 92 is closer to the observed peak streamflow for the second flood while quantile 0 90 is closer to the observed peak streamflow for the third flood fig 14 g i illustrate the prediction quantiles 0 52 0 82 and 0 90 for the three flood events by lstm models the quantiles 0 52 and 0 82 are close to the observed streamflow than the quantile 0 90 in the rising and recession periods for all flood events the results of the lstm algorithm indicate that the peak of the quantile 0 52 is closer to the observed peak flow of the initial flood quantile 0 82 is closer to the observed peak streamflow for the second flood quantile 0 82 is closer to the observed peak streamflow for the third flood fig 14 j l illustrate the prediction quantiles 0 40 0 74 and 0 92 for the three flood events by the gru models for the first and third floods the results of the gru model are comparable to those of the lstm model with the quantiles of 0 40 and 0 74 being closer to the observed streamflow than the quantile of 0 92 for the rising and recessions but for the second flood the result of quantile 0 92 is in good agreement with the observed streamflow see fig 14 k the gru results show that the peak of the quantile 0 40 is closer to the observed peak streamflow of the first flood the peak of quantile 0 92 is closer to the observed peak streamflow for the second flood the peak streamflow of quantile 0 74 is closer to the observed peak streamflow for the third flood fig 15 presents 12 violin plots that exhibit the 18 step multi step flood prediction results for three floods in the test set using four distinct flood prediction models a violin plot is a graphical tool used to compare the distribution of numerical variables across multiple groups by plotting several violins on the same graph differences between different groups can be readily visualized fig 14 includes 12 violin plots where each subplot contains four violins the leftmost violin displays the distribution of observed values while the other three violins show the distribution of predictions at different quantiles different quantiles used by different models for predicting different flood events are sourced from table 3 in the first flood prediction a d g j the predictions of all four models based on the smallest quantile are very close to the observed values including the median and maximum values this suggests that the predictions based on the smallest quantile are more accurate and the models have reliable prediction capability with high accuracy in peak flood prediction in the second flood prediction b e h k the largest quantile violins of all four models were very close to the observed value violin plot the violin shapes were very similar indicating that the predicted results had a consistent data distribution with the observed values however when comparing the peaks of the quantile violins and the observed value violin plot it was found that tfc sgru and gru models underestimated the peak while the lstm model overestimated it indicating that all three models had large prediction errors for the flood peak the reslstm model produced the best violin plot in the third flood prediction c f i l the peaks of the violin plots for all three quantiles results from the reslstm model are relatively close to the observed values indicating accurate flood peak prediction additionally the shapes of the reslstm s violin plots for all three quantiles results are similar to the observed values suggesting reliable prediction of river streamflow during the flood process the peaks of the last two quantiles results of lstm and gru s violin plots are roughly similar to the observed values but the distribution of the result is not consistent with the observed values once again reslstm performs the best our findings are in agreement with the previous analysis and provide additional evidence supporting the effectiveness of our improved reslstm model compared to other models specifically our results suggest that the flood probability prediction model we proposed which is based on rnn and deepar is better suited for handling flood uncertainty due to its superior adaptability 6 conclusion and future work this study proposes an effective multi step model for predicting the probability of flooding based on rnn and deepar first a reslstm is proposed to improve the lstm for flood prediction the temporal shortcut of reslstm can improve the gradient problem of lstm second the probabilistic model deepar is introduced to make flood uncertainty more adaptable the results demonstrate that probabilistic forecasting models are more adaptable to flood uncertainty and the temporal residual based model is more precise and robust than the original lstm and gru models although reslstm has shown promising results in solving the gradient problem its performance in parallel computing is still limited resulting in slow training speeds therefore it is worth exploring new algorithms to build flood prediction models such as the multi head attention mechanism in addition the use of advanced optimization algorithms such as adam and adagrad can also potentially improve the training speed of reslstm future research can focus on combining reslstm with these advanced techniques to further improve the performance of flood prediction models credit authorship contribution statement yongsong zou data curation methodology visualization software writing original draft jin wang conceptualization funding acquisition validation writing review editing peng lei investigation writing review editing resources yi li supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is supported by the national natural science foundation of china 62072056 
1924,climate change has significantly impacted hydrology including extreme precipitation and changing precipitation patterns that could lead to an increase in flooding life and property benefit from accurate and reliable multi step flood forecasting recently recurrent neural network rnn have become increasingly popular among hydrology researchers for their ability to capture historical dependencies simplify computations by ignoring intermediate hydrological processes and provide higher prediction accuracy than traditional models however rnn based flood prediction models face two significant challenges firstly due to their strict time serial rnn suffer from gradient issues such as vanishing and exploding gradients which can make training rnn models difficult to address this issue we propose a residual long short term memory reslstm model that incorporates time residual connections into the time connections of lstm secondly most flood prediction models output a deterministic value but the natural hydrological characteristics of the basin are a nonlinear and complex system with many influencing factors that have some randomness this requires the use of probabilistic methods to modeling thus we introduce the probabilistic forecasting model autoregressive recurrent networks deepar into our flood prediction model which outputs a prediction interval rather than a deterministic value then we build four flood probability prediction models by combining deepar and four enhanced rnn including reslstm ours long short term memory lstm gate recurrent unit gru and time feedforward connections simple gate recurrent unit tfc sgru the performance of these models is evaluated by the long term hydrologic data of the passaic and ramapo river basins in the united states the results demonstrate that the prediction interval of the four models is more adaptive to flood uncertainties and the accuracy of peak flow prediction is nearly 100 within a 90 prediction probability interval the temporal residual based model is more accurate and robust than the original lstm and gru we believe this study fills a research gap in multi step ahead flood probability prediction and improves the accuracy and reliability of flood prediction models keywords residual long short term memory flood forecasting rainfall runoff time series task probability distribution data availability data will be made available on request 1 introduction according to the united nations world water development report unesco 2020 74 of the world s disasters over the past two decades were water related effective flood forecasting is essential for mitigating flood risk and managing water resource systems hydrodynamic models based on physics and machine learning ml models based on data have been developed to study flood risk hydraulic and hydrodynamic models are commonly used in flood research wen et al 2013 shrestha et al 2020 although hydraulic and hydrodynamic models are incredibly efficient they require precise boundary conditions and complex calculations jodhani et al 2021 thus more and more researchers have recently focused on ml ml has been applied to the analysis of various natural hazard types such as floods campolo et al 1999 li et al 2011 utilizing techniques such as support vector regression choubin et al 2019 yu et al 2006 decision trees bui et al 2019 khosravi et al 2018 random forest tang et al 2021 zahura et al 2020 genetic algorithms arturo et al 2021 wang et al 2011 optimally pruned extreme learning machine op elm adnan et al 2019 adnan et al 2020 and two ml training strategies for self organizing maps to address the issue of non convergence during clustering of high dimensional datasets chang et al 2021 unlike physics driven models ml does not require precise boundary conditions and complicated physical calculations nonetheless flood analysis is a dynamic process with a temporal variation ml type models lack mechanisms to capture long term dependencies deep learning dl based on ml has come to the attention of researchers the recurrent neural network rnn is a type of dl used to perform time series tasks rnn can extract spatial temporal features from data and is advantageous for predicting flood risks yaseen et al 2015 rnn predicts flooding by mining historical data for driver factors thus rnn has been successfully applied to many earth science problems reichstein et al 2019 wang et al 2020 ikram et al 2023 and related applications such as hydrology munawar et al 2021 le et al le et al 2019 proposed a model for flood prediction based on long short term memory lstm the results demonstrated that the lstm s predictive ability was quite remarkable fang et al used the lstm to predict flood susceptibility with dependable accuracy fang et al 2021 the authors proposed a hybrid neural network model for flood forecasting by combining a convolutional neural network cnn with an lstm chen et al 2022 google provides a neural network alternative for hydraulic modeling of flood inundations the lstm model is used for real time flood warnings nevo et al 2022 the results showed that the lstm is more accurate than the conventional model in most catchments the rnn models provide a more accurate functional representation of rainfall runoff than the ml models feng et al 2020 kratzert et al 2019 although rnn has significant advantages in various time series tasks liu et al 2019 mikolov et al 2010 singh et al 2017 rnn remains a huge challenge because the time serial dependencies limit the accuracy the time serial of rnn refers to the process of unraveling the recurrent connections of the network over time by unrolling the network over time we create a temporal sequence of connected neural network layers that can be trained with backpropagation through time to learn complex temporal dependencies rnn time series dependencies can cause difficulties in training flood prediction models based on rnn as the repeated multiplication of gradients over time can result in the vanishing and exploding gradients issues bengio et al 1994 lstm gers et al 2000 hochreiter and schmidhuber 1997 and gate recurrent unit gru cho et al 2014 have been proposed to address gradient issues with gates strategies an lstm cell consists of an input gate an output gate and a forget gate consequently a gru cell comprises an update gate and a reset gate although lstm and gru improve the gradient issues in rnn by employing gates strategies the problem of vanishing and exploding gradients resulting from the time serial dependencies of rnn still persists and has not been fundamentally resolved however most rnn based flood prediction models utilize the original model without addressing its limitations such as hybrid long short term memory neural network and ant lion optimizer model lstm alo yuan et al 2018 lstm ed multi step ahead flood forecasting by combining the advantages of encoder decoder and lstm kao et al 2020 sae rnn by combining stacked autoencoders sae with rnn kao et al 2021 adnan proposed an improved adaptive neuro fuzzy system anfis model called anfis gbo which enhances the model s performance through various model heterogeneity methods using gradient based optimization techniques adnan et al 2022 wang et al 2023 proposed the time feedforward connections simple gate recurrent unit tfc sgru by introducing highway networks hn srivastava et al 2015 to improve the time series dependencies the tfc sgru model incorporates shortcut connections between time steps t 2 and t to enable direct information flow without the need for nonlinear transformations at time step t thereby altering the time series dependencies of traditional rnn hn is a time residual scheme that incorporates parameters however due to the high computational complexity of lstm pascanu et al 2013 a no parameter residual strategy may be superior to hn inspired by tfc sgru and anfis gbo we propose a novel rnn architecture called time residual lstm reslstm to address the gradient problem caused by the time series dependencies of rnn unlike tfc sgru reslstm adopts a no parameter residual scheme by introducing a no parameter residual resnet he et al 2016 yue et al 2018 the natural temporal systems are often impacted by multiple uncertain factors and randomness which makes accurate predictions challenging nevertheless the probabilistic models enable the prediction of the range and probability distribution to address the probabilistic forecasting issue in rnn researchers proposed a probabilistic forecasting approach based on autoregressive recurrent networks deepar salinas et al 2020 deepar is a deep learning based time series probabilistic forecasting model the aim of flood prediction is to get the future water level or peak streamflow at a specific time however basin river systems hydrological characteristics are nonlinear and complex influenced by several factors future values are often affected by numerous uncertainties such as future rainfall infiltration terrain basin characteristics etc as a result accurate single value of future flood peak streamflow is often challenging a more appropriate approach would be to estimate the possible range of values and probability distribution of future flood peak streamflow using a probabilistic model which would better reflect the system characteristics here the deepar model is introduced to solve the problem of flood probability distribution we propose a novel temporal residual long short term memory model for flood probability prediction based on deepar and reslstm finally we employ three powerful optimization techniques namely data cleaning normalization and feature filtering to enhance the performance of the flood probability prediction model based on these approaches our model is not only capable of capturing the attribution information of flood conditioning factors and the local spatial information of flood data but it also has powerful sequential modeling capabilities to handle the spatial temporal relationship of floods the main contributions of this paper are summarized as follows we proposed a reslstm that can improve the gradient problem of lstm by breaking the time serial we introduced the probability forecasting deepar to reslstm to solve the flood probability distribution we presented a multi step ahead model for predicting the probability of flooding we constructed four flood probability prediction models by integrating deepar and four enhanced rnn including reslstm lstm gru and tfc sgru the rest of this paper is organized as follows section 2 presents the rnn deepar models and computational methods section 3 describes the studied basin and data section 4 introduces our reslstm and the structure of the flood probability prediction model section 5 provides the experimental results based on the hydrologic data of the passaic river and ramapo river basin in the united states section 6 concludes this paper 2 methodology 2 1 recurrent neural network rnn is a common deep neural network dnn used to handle time series tasks chung et al 2014 rnn was first proposed in 1990 elman 1990 we can express it as follows 1 h t t a n h w x t v h t 1 b where t is the time step x t and h t represent the input matrix and hidden state respectively h t 1 denotes the previous hidden state w v b represent the input weight the hidden weight and the bias respectively t a n h x e x e x e x e x in contrast to dnn the input of each rnn cell comprises input from the current time as well as output from the previous time therefore rnn are more powerful than dnns in learning sequences however traditional rnn are difficult to train due to gradients that vanish and explode to solve this issue lstm is proposed 2 f t s i g m o d w f x t v f h t 1 b f 3 i t s i g m o d w i x t v i h t 1 b i 4 o t s i g m o i d w o x t v o h t 1 b o 5 g t t a n h w g x t v g h t 1 b g 6 c t i t g t f t c t 1 7 h t o t t a n h c t where f t i t o t c t h t represent the forget gate the input gate the output gate the memory state and the hidden output state respectively memory state is intended to capture long term memory the input gate is used to filter the input information the forget gate can filter out noise from the past the output gate is the final output checkpoint w v b represent the input weight the hidden weight and the bias respectively is the hadamard product the activate function s i g m o d x 1 1 e x while the performance of lstm has improved its computational complexity has increased proportionally then a simplified gated lstm denoted bygru is proposed 8 z t s i g m o d w z x t v z h t 1 b z 9 r t s i g m o d w r x t v r h t 1 b r 10 h t t a n h w x t r t h t 1 11 h t 1 z t h t 1 z t h t where z t r t represent the update gate and the reset gate respectively h t h t represent the hidden output state and the transition state respectively w v b represent the input weight the hidden weight and the bias respectively gru reduces training parameters by eliminating lstm s output gate nonetheless the performance of lstm and gru is still constrained by the time serial dependence alone the rnn models are trained using backpropagation through time bptt continuous multiplication is used to update gradients which limits the performance of the gate method thus the authors proposed a time residual simple gru by introducing the hn named tfc sgru as expressed as follows 12 z t s i g m o d w z x t v z h t 1 b z 13 s t s i g m o d w s x t v s h t 2 b s 14 h t t a n h w x t z t h t 1 15 y t 1 z t h t 1 z t h t 16 h t 1 s t h t 2 s t y t where z t s t represent the update gate and carry gate respectively h t h t 1 and h t 2 represent hidden output at time t t 1 and t 2 respectively due to the time shortcut of tfc sgru gradient update is achieved by a sum expression instead of continuous multiplication tfc sgru enhances feed forward connections between time steps thereby enabling the gradient from t 2 to t without the nonlinear transformation at time t tfc sgru can improve the gradient issuein horizontal rnn propagation 2 2 probabilistic forecasting model deepar is a probabilistic model for forecasting time series data we can receive both a predicted value and a probability distribution deepar is an embedded autoregressive recurrent network rnn set a sequential series z t t 0 t and the index t 0 1 2 t 0 1 are the conditioning range and t 0 t 1 t are the prediction range the deepar is shown in fig 1 h t is the hidden output of rnn at time t x t and z t are the input series and output values at time t respectively l t represents the likelihood function the gaussian likelihood for real valued data then we set the likelihood as follows 17 l z μ σ 1 σ 2 π e x p z μ 2 2 σ 2 18 μ t ω μ t h t b μ 19 σ t ω σ t h t b σ where μ is the mean σ is the variance ω is the weight matrix and b is the bias deepar learns the internal characteristics of the different periods to improve the accuracy of predictions in contrast to non probabilistic models this network predicts distribution parameters rather than a single value there are two benefits to output distribution 1 since most nonlinear systems have random properties the output probability distribution is closer to nature 2 it can evaluate the forecast s uncertainty and risk 2 3 evaluation of model performance in this paper the aggregate performance of our models is evaluated using statistical error metrics such as the root mean square error rmse the mean absolute error mae and the mean absolute scaled error mase as illustrated in eqs 20 to 22 20 rmse 1 n i 1 n y i y i 2 21 mae 1 n i 1 n y i y i 22 mase mae 1 t 1 t 2 t y t y t 1 where n represents the number of samples and y i y i denote the predicted and observed values respectively t 1 2 t is the time of training sets rmse also referred to as the standard error is calculated as the square root of the ratio between the sum of squared deviations of observed values from true values and the number of observations it is commonly used to quantify the deviation between observed and true values and is particularly sensitive to both large and small errors within a set of measurements thus making it an effective measure of precision however one major limitation of rmse is also its susceptibility to outliers which can distort the results and lead to misleading conclusions in addition rmse may be less intuitive to interpret since it measures errors in squared units which may not be directly comparable to the original units of the data mae is a commonly used metric for assessing prediction accuracy it calculates the average of the absolute differences between predicted values and actual values mae is a robust measure that is not affected by outliers since it considers only the absolute error between the predicted and actual values regardless of the direction of the error for stable prediction models mae provides a reliable measure of the error however the disadvantage of mae is that it treats all errors equally irrespective of their magnitude this drawback can lead to scenarios where mae does not effectively capture the magnitude of the prediction error moreover mae does not indicate the direction of the error mase is calculated by dividing the mean error by a scaling factor which is determined by the seasonal value m selected based on the forecasting frequency a lower mase value indicates a higher accuracy of the forecasting model mase is particularly suitable for datasets that exhibit periodic or seasonal characteristics considering the seasonal effects can improve the accuracy of forecasting floods with low rainfall during the rainy season and less rainfall during the dry season 3 studied basin and data our research is focused on a watershed located at the confluence of the passaic river and ramapo river we use data from the passaic river and the ramapo river in new jersey and new york in the united states as shown in fig 2 a c the passaic river basin is located below millington canyon and covers about 881 square miles the united states geological survey usgs monitors this river from four different hydrologic observation stations along the passaic river as shown in fig 2 c by the yellow circles the ramapo river is monitored by four distinct usgs hydrologic observation stations as depicted by the orange circles in fig 2 c the red circle in fig 2 c represents the forecast objective station usgs 01389500 on the left bank of the passaic river at little falls new jersey 0 6 miles downstream of beatties dam in little falls and 1 0 mile upstream of peckman river fig 3 depicts the streamflow and precipitation for usgs 01389500 the green line on the left y axis represents the streamflow while the orange line on the right y axis represents the precipitation the hydrological features include daily precipitation and streamflow from 25 hydrological stations spanning the 32 year record from 1990 01 01 to 2021 12 31which are downloaded from the usgs website the average annual discharge of the objective station is 17 98 m3 s according to fig 3 the first half of the year is the wet season and the second half is the dry season typically april may and june are the busiest months of the year consequently the streamflow of usgs 01389500 is zero every november based on the data collected from hydrological stations we have determined that the average annual precipitation in the passaic and ramapo river watershed between 1990 and 2021 was 1258 mm day while the target station s average annual flow rate was 1 4 mm day to gain a deeper understanding of the station s multi year monthly flow rates we used statistical calculations to determine the multi year average flow rate for each month specifically by analyzing the watershed streamflow monthly average distribution chart in fig 4 we discovered that the multi year average streamflow in march was the highest at 2 46 mm day while june had the lowest average streamflow at 0 66 mm day these findings indicate that the watershed faces significant rainfall pressure in march and requires measures to prevent flooding fig 5 4 our proposed flood forecast model 4 1 residual long short term memory resnet is a cnn architecture that is well known for its ability to train cnns effectively with the capability to train networks with up to 152 layers training cnns with many layers before resnet was difficult due to vanishing gradients leading to poor performance and making it challenging for networks to learn from input data to address this issue residual learning was proposed which involves allowing the network to learn the residual mapping between the input and output by adding a shortcut connection on top of the original single connection between the layers the shortcut connection is a simple identity mapping that directly passes inputs to outputs without modification by weight layers despite the emergence of many rnn models lstm remains the best performing one jozefowicz et al 2015 however lstm has limitations such as too many training parameters and time serial dependencies that can decrease its accuracy to address this we propose a time residual lstm by incorporating shortcut connections from resnet into the time serial connections of lstm as shown in fig 6 this allows the hidden output h t 2 to be directly inputted to the cell at time t without the nonlinear transformation at time t 1 to maximize the spatial temporal information of streamflow and precipitation we enhance the residual network structure of the lstm cell as with the gru model we begin by erasing the lstm forget gate to reduce the number of parameters and accelerate convergence the internal structure of the reslstm cell is illustrated in fig 7 the time residual of reslstm is reflected in eq 27 the reslstm cell consists of an input gate and an output gate each gate of the reslstm cell connects the information of the input and the output h t of the hidden state eqs 23 27 provide the principle of the reslstm model 23 i t s i g m o d w i x t v i h t 1 b i 24 o t s i g m o i d w o x t v o h t 1 b o 25 g t t a n h w g x t v g h t 1 b g 26 c t i t g t f t c t 1 27 h t o t t a n h c t 1 o t t a n h h t 2 where i t o t c t g t a n d h t represent the input gate the output gate the memory state the internal state and the hidden output state at time t respectively w v a n d b represent the input weight the hidden weight and the bias respectively is the hadamard product like the lstm model the input gate filters the input information and c t is responsible for capturing long term memory we remove the forget gate of lstm and add the short term information h t 2 as the time shortcut to break the time serial dependency significantly the time shortcut permits the gradient at step t 1 to be transferred to step t 1 without the nonlinear transformation at step t more importantly we use the no parameter residual method instead of the parametric residuals in tfc sgru so there are no training parameters 4 2 flood probability forecast model design suppose there is an n k steps time series task where m represents the number of features in a single time step one day n represents the input time steps s denotes the predicted start time k represents the predicted time steps and p s 1 s k is the predicted sequence as shown in fig 8 our flood probability forecast model consists of four layers the input layer the rnn layer the likelihood layer and the output layer the rnn layer captures the temporal dependencies of the input array and identifies a more accurate functional representation of rainfall runoff the rnn layers depicted in fig 8 utilize reslstm but can be substituted with other models such as lstm and gru the output of the rnn is transferred to the likelihood layer which can search for possible output expression intervals the output layer outputs the prediction result p s 1 s k and probability intervals 4 3 input datasets the hydrological features include daily precipitation and discharge from 25 hydrological stations three powerful optimization techniques data cleaning normalization and features filter are adapted to further enhance the model s performance for predicting the probability of a flood the dataset is then divided into three subsets 1 data cleaning due to equipment failures the original dataset contains incomplete or missing data missing data which is a common occurrence can have a significant impact on the model s performance brunner et al 2021 as shown in eq 28 we use the mean of the still noise to handle the missing or low level outlier 28 x t x t 1 x t 1 2 where x t 1 and x t 1 are the values of the time t 1 and the time t 1 x t is the missing value 2 normalization we standardize input features to the range 0 1 with max min normalization as shown in eq 29 29 x norm x x min x max x min where x max and x min represent the maximum and minimum respectively 3 features filter we evaluate the correlation between each input feature and the streamflow of usgs 01389500 using the pearson coefficient the pearson coefficient ρ r p of array r and p is defined as the covariance cov r p between array r and array p divided by the product of their respective standard deviations σ r σ p as is shown in eq 30 30 ρ r p c o v r p σ r σ p where ρ r p is the pearson coefficient cov r p represents the covariance of r and p and σ r is the standard deviation the pearson correlation coefficient is used to measure the strength and direction of the linear relationship between two variables and it ranges from 1 to 1 a value of 1 indicates a perfect positive correlation between the variables while a value of 1 indicates a perfect negative correlation a value of 0 indicates no linear relationship between the variables in neural network feature engineering the pearson correlation coefficient is commonly used in the steps of feature selection and feature engineering to help identify the most relevant features to the target variable it can be used to identify highly correlated feature variables and to help exclude those feature variables that have no linear relationship with the target variable fig 9 shows the result of the pearson coefficient of 50 input features of 25 hydrological stations the numbers on the y axis are the hydrological station id the higher score the greater the significance of the feature then we use the threshold score 0 04 to filter features with low correlation 4 split datasets the datasets cover daily precipitation and streamflow at each station the output is usgs 01389500 streamflow about 80 of the data in each dataset is used for training 10 for validating including 1080 steps and 10 for testing the test set contains 1080 time steps days of hydrologic data from 2019 01 17 to 2021 12 31 we determined two output strategies for our experiments one step prediction 1 day with 1080 repetitions and eighteen step prediction 18 days with 60 repetitions 5 experimental results and discussion 5 1 parameters setting our model for predicting flood probability is based on rnn and deepar the rnn layer is essential for obtaining the flood model s long term dependencies this study compares reslstm to three modified rnn models lstm gru and tfc sgru training an rnn model requires selecting appropriate hyperparameters hyperparameters are manually set parameters that cannot typically be learned from the training data and require experience and trial and error to determine their optimal values common hyperparameters include the context length the number of rnn layers the number of rnn cells in each layer the learning rate the learning rate decay factor and the number of training epochs however due to the large number and complexity of hyperparameters the search space can be vast to select the best hyperparameter combination techniques such as grid search random search and bayesian hyperparameter optimization algorithms can be used in this paper we utilize the optuna open source python library to search for the optimal hyperparameter combination using the bayesian optimization algorithm the bayesian optimization algorithm is a method for optimizing neural network model hyperparameters by continuously updating the prior distribution of hyperparameters during the training process to find the optimal hyperparameters table 1 shows the optimal hyperparameters for the four probabilistic prediction models under the two output strategies 5 2 performance evaluation 5 2 1 the two output strategies results for the experiments in this paper the model error is evaluated using the aggregate performance metrics rmse mase and mae the smaller the rmse mae and mase the smaller the error and the greater the aggregate performance therefore these three metrics can effectively evaluate the robustness and regression accuracy of the four models table 2 illustrates the evaluation metrics for streamflow prediction at various output stages for the four models the accuracy of all models is strongly correlated with the output time step as the number of output time steps increases the accuracy of the four models decreases the results show that reslstm achieves rmse of 0 213 for one step output but drops to 0 248 for eighteen steps mase drops from 0 374 to 0 667 and mae drops from 0 080 to 0 142 the same applies to the remaining models the reason is that the longer the prediction step the more memory the rnn needs reslstm performs marginally better than tfc sgru for single step output but there is no significant difference in addition the aggregate performance of the lstm model outperforms that of all other models across all metrics however the reslstm model performs better than the others for the eighteen step output reslstm and tfc sgru are residual based models that incorporate the resnet and highway networks the residual based model is more accurate and robust than the original lstm and gru for long term prediction the residual network can reduce the rmse mae and mase of lstm and gru indicating that the residual module influences the rnn positively in multi step prediction our proposed reslstm outperforms competing models mae is the mean absolute value of the sum of all individual observations deviations from the arithmetic mean since rmse is sensitive to outliers mae can assess the network s robustness more accurately table 2 demonstrates that the rmse is greater than the mae for both output strategies this can be due to the large variation in monthly stream flows and the extremely inhomogeneous temporal distribution of precipitation within the study basin 5 2 2 multi step ahead flood peak probability intervals prediction the steps of test datasets are 1080 while the output steps are 18 of multi step prediction so we need to run 60 times during the time period of the test datasets there are three floods the first flood occurred at the 52nd forecast on 2021 08 24 the second at the 53rd forecast on 2021 09 03 and the third at the 56th forecast on 2021 10 27 our model is intended to generate probabilistic predictions rather than point forecasts the output is a prediction interval figs 10 12 display the eighteen step prediction results for three flood events from the reslstm tfc sgru lstm and gru models each of these plots shows the observations the median prediction the 50 prediction interval and the 90 prediction interval fig 10 a d depict the 90 prediction interval the 50 prediction interval and the observed streamflow by the four models for the 10th 27th august 2021 flood event the four models predict a reliable occurrence time of the flood peak the tfc sgru model forecasted a flood peak that was one day late and underestimated the streamflow in the rising period see fig 10 b during ascent the reslstm and gru models perform better than the lstm and tfc sgru models however the reslstm lstm and gru models outperform the tfc sgru model during the recession the reslstm model outperforms the other models in terms of flood peak flow the observation and 50 prediction interval are in excellent agreement during periods of expansion and contraction see fig 10 a fig 11 a d display the 90 prediction interval the 50 prediction interval and the observed streamflow for the flood event that occurred from august 28 to september 14 in 2021 as predicted by four models the observed flood hygrograms are higher than the first flood due to the relatively concentrated precipitation there may be a correlation between the irregular fluctuations of peak prediction intervals and the spatial temporal distribution of precipitation the four models severely underestimate the high flow rate due to the small number of training samples of high flow rate peaks during the rise the 90 prediction interval of the tfc sgru model is less than the observed flow nevertheless the 90 prediction interval of the gru is less than the observed value during the recession the 90 prediction interval of reslstm and lstm covers the observed flood peaks the lstm model performs better than the other models in terms of flood peak magnitude whereas the reslstm model performs better overall fig 12 a d depict the 90 prediction interval the 50 prediction interval and the observed streamflow by the four models for the 2021 flood event that occurred from october 21 to november 7 the 50 prediction interval of the reslstm and tfc sgru models covers the observed hydrograph of the flood peak whereas the lstm and gru models underestimate the flood peak during the ascent the reslstm and tfc sgru models perform reasonably well the lstm and gru models perform adequately well during a recession the reslstm and lstm models perform reasonably well during the flood peak occurrence time 5 2 3 comparison of the impact of different quantiles on multi step ahead flood peak prediction probability intervals in flood prediction offer accurate and comprehensive information indicating uncertainty and aiding decision making our model using deepar generates probability intervals with an 18 step output strategy showing the potential range of streamflow values over the next 18 days derived from historical data these intervals reveal the expected range of future flood flow values different quantiles have varying accuracy for probability distribution to further analyze model precision we have identified optimal quantiles for four probability prediction models in three flood predictions as shown in table 3 under optimal quantile conditions the peak flood prediction errors for three floods were compared across four flood prediction models in fig 13 all models performed well with peak flood prediction error less than 8 31 reslstm had the smallest error less than 2 tfc sgru had lower errors than lstm and gru in the first and third peak flood predictions but had a higher error than gru in the second prediction lstm and gru had similar errors in the three peak flood predictions with gru slightly outperforming lstm indicating gru s slightly better performance on small data sets such as hydrological data fig 14 illustrates the impact of different quantiles on the accuracy of flood event predictions comparing three events using reslstm models a c display 18 step predictions at the 0 56 0 78 and 0 88 quantiles for the first flood event the 0 56 quantile matches well with observed streamflow during the rising period while the 0 78 quantile outperforms other results during the recession period fig 14 a for the second flood event the 0 88 quantile performs reasonably well during both rising and recession periods fig 14 b the accuracy of the 0 56 and 0 78 quantiles for the third flood event is not significantly different fig 14 c reslstm results indicate that for the first flood the peak of the 0 56 quantile is closer to observed peak streamflow compared to the 0 88 quantile for the second flood the peak value of the 0 88 quantile is closer to the observed peak streamflow for the third flood the peak streamflow of the 0 78 quantile is closer to the observed peak streamflow fig 14 d f depict the prediction quantiles 0 56 0 90 and 0 92 for the three flood events by the tfc sgru models in fig 14 d the forecast interval for the first flood s rising period is narrow indicating that there are few uncertainties thus each quantile specific result is highly consistent in contrast during the recession the result of quantile 0 92corresponds with observation see fig 14 d as with reslstm the 0 95 quantile of tfc sgru yields the best results for the second flood see fig 14 e for the third flood all three quantiles are close to the observed streamflow during the rising period whereas the 0 92 quantile is closer than the others during the recession period see fig 14 f the tfc sgru results indicate that the 0 90 quantile result is closer to the observed peak streamflow of the initial flood quantile 0 92 is closer to the observed peak streamflow for the second flood while quantile 0 90 is closer to the observed peak streamflow for the third flood fig 14 g i illustrate the prediction quantiles 0 52 0 82 and 0 90 for the three flood events by lstm models the quantiles 0 52 and 0 82 are close to the observed streamflow than the quantile 0 90 in the rising and recession periods for all flood events the results of the lstm algorithm indicate that the peak of the quantile 0 52 is closer to the observed peak flow of the initial flood quantile 0 82 is closer to the observed peak streamflow for the second flood quantile 0 82 is closer to the observed peak streamflow for the third flood fig 14 j l illustrate the prediction quantiles 0 40 0 74 and 0 92 for the three flood events by the gru models for the first and third floods the results of the gru model are comparable to those of the lstm model with the quantiles of 0 40 and 0 74 being closer to the observed streamflow than the quantile of 0 92 for the rising and recessions but for the second flood the result of quantile 0 92 is in good agreement with the observed streamflow see fig 14 k the gru results show that the peak of the quantile 0 40 is closer to the observed peak streamflow of the first flood the peak of quantile 0 92 is closer to the observed peak streamflow for the second flood the peak streamflow of quantile 0 74 is closer to the observed peak streamflow for the third flood fig 15 presents 12 violin plots that exhibit the 18 step multi step flood prediction results for three floods in the test set using four distinct flood prediction models a violin plot is a graphical tool used to compare the distribution of numerical variables across multiple groups by plotting several violins on the same graph differences between different groups can be readily visualized fig 14 includes 12 violin plots where each subplot contains four violins the leftmost violin displays the distribution of observed values while the other three violins show the distribution of predictions at different quantiles different quantiles used by different models for predicting different flood events are sourced from table 3 in the first flood prediction a d g j the predictions of all four models based on the smallest quantile are very close to the observed values including the median and maximum values this suggests that the predictions based on the smallest quantile are more accurate and the models have reliable prediction capability with high accuracy in peak flood prediction in the second flood prediction b e h k the largest quantile violins of all four models were very close to the observed value violin plot the violin shapes were very similar indicating that the predicted results had a consistent data distribution with the observed values however when comparing the peaks of the quantile violins and the observed value violin plot it was found that tfc sgru and gru models underestimated the peak while the lstm model overestimated it indicating that all three models had large prediction errors for the flood peak the reslstm model produced the best violin plot in the third flood prediction c f i l the peaks of the violin plots for all three quantiles results from the reslstm model are relatively close to the observed values indicating accurate flood peak prediction additionally the shapes of the reslstm s violin plots for all three quantiles results are similar to the observed values suggesting reliable prediction of river streamflow during the flood process the peaks of the last two quantiles results of lstm and gru s violin plots are roughly similar to the observed values but the distribution of the result is not consistent with the observed values once again reslstm performs the best our findings are in agreement with the previous analysis and provide additional evidence supporting the effectiveness of our improved reslstm model compared to other models specifically our results suggest that the flood probability prediction model we proposed which is based on rnn and deepar is better suited for handling flood uncertainty due to its superior adaptability 6 conclusion and future work this study proposes an effective multi step model for predicting the probability of flooding based on rnn and deepar first a reslstm is proposed to improve the lstm for flood prediction the temporal shortcut of reslstm can improve the gradient problem of lstm second the probabilistic model deepar is introduced to make flood uncertainty more adaptable the results demonstrate that probabilistic forecasting models are more adaptable to flood uncertainty and the temporal residual based model is more precise and robust than the original lstm and gru models although reslstm has shown promising results in solving the gradient problem its performance in parallel computing is still limited resulting in slow training speeds therefore it is worth exploring new algorithms to build flood prediction models such as the multi head attention mechanism in addition the use of advanced optimization algorithms such as adam and adagrad can also potentially improve the training speed of reslstm future research can focus on combining reslstm with these advanced techniques to further improve the performance of flood prediction models credit authorship contribution statement yongsong zou data curation methodology visualization software writing original draft jin wang conceptualization funding acquisition validation writing review editing peng lei investigation writing review editing resources yi li supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is supported by the national natural science foundation of china 62072056 
