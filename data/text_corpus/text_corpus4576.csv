index,text
22880,estimation of roll damping of ships from free roll decay experiments or using appropriate semi empirical formulae is a common practice the total roll damping of a ship or a barge can be strongly nonlinear consisting of linear and nonlinear components especially when bilge keel is fitted to the hull as a damping device and also when angles of roll are large cfd simulations of nonlinear roll motion with experimental validation is gaining acceptance in the recent past the present work reports three dimensional simulations of roll decay of a ship model both with and without bilge keel with experimental validation a good comparisons of roll damping natural period and added mass with experiments are obtained the use of large eddy simulation on this class of problems is explored and commented upon ikeda s semi empirical method over predicts roll damping at larger roll angles the pressure aft of bilge keel is found to be deviating whereas the pressure in front of bilge keel showed a close resemblance with semi empirical calculations effect of bilge keel thickness degrees of freedom and scaling on roll motion and damping is found to be insignificant for a barge like ship model chosen in this study keywords bilge keel free roll decay nonlinear roll damping urans les 1 introduction the prediction of roll damping of ships is both challenging as well as an extensively studied problem a ship may encounter extreme waves from beam or oblique directions that have periods close to its natural roll period thus leading to large amplitude roll motion that is inherently nonlinear this causes significant crew inefficiency and reduces the stability of the hull there by posing serious threat to the safety of the ship hence mitigation of roll motion is needed for smooth operation of ships and ship shaped floating platforms the popular roll mitigation devices used for ships and other floating systems are bilge keel u tube tank gyroscope rudder and active passive fins perez and blanke 2012 these devices are used one at a time or in combination depending on the initial cost maintenance range of operation and space constraints there had been a significant amount of work reported in the literature that addresses the efficiency of roll mitigation devices especially the bilge keel experiments of free roll decay and forced roll oscillations of ship models with and without appendages had been reported by many researchers chun et al 2001 downie et al 1988 haddara and leung 1994 na et al 2002 sarpkaya and o keefe 1996 tanaka and hishida 1957 tanaka and kitamura 1958 veer et al 2015 the effect of forward speed on roll motion and roll damping of ships free and forced oscillations both in calm sea and waves have also been reported in various works irvine et al 2013 wu et al 2005 zeraatgar et al 2010 early works in the field of roll damping and its prediction were summarized in himeno 1981 the contributions of a variety of factors that contribute to the total roll damping were discussed in the works of ikeda et al 1979 ikeda et al 1978a 1978b the semi empirical formulae for prediction of roll damping are widely used for conventional hull forms chakrabarti 2001 himeno 1981 ittc 2011a the main limitation with the empirical and semi empirical approaches in predicting roll damping is the need to use different equations formulae for different situations kawahara et al 2011 because such formulae have limited range of application and cannot be used for unconventional hull forms and appendages the use of numerical methods in predicting viscous flow around ships and other floating bodies started few decades ago vortex tracking method was used to study the effect of viscosity and separated flows around rectangular body with sharp corners braathen and faltinsen 1988 free surface random vortex method was used to simulate viscous and separated flows in the works of roddier et al 2000 thiagarajan and braddock 2010 yeung et al 1998 two dimensional 2d incompressible navier stokes solver had been used to simulate the viscous flow around a rolling hull avalos et al 2014 bangun et al 2010 irkal et al 2014 kinnas et al 2006 yu and kinnas 2009 wilson et al 2006 used a three dimensional 3d unsteady reynolds averaged navier stokes urans solver called cfd iowa paterson et al 2003 to simulate forced and free rolling motion of a naval combatant there are other researchers gokce and kinaci 2018 jiang and yeung 2017 zhou et al 2015 as well who had contributed to this field geometric design and orientation of bilge keel is best done using a 2d numerical model of a ship section because of low computational requirements however the estimation of roll damping of a ship due to bilge keel requires 3d calculations therefore the 2d and 3d calculations must be reconciled this is done in the present work using 3d calculations of the ship model for which extensive numerical 2d vs experimental comparisons of roll damping based on free roll decay are available in a recent paper by authors irkal et al 2016 the linear and nonlinear damping models are used in both 3d and 2d models additional issues which are absent in a 2d model arise in 3d calculations namely the effect of bilge keel length and effect of free degrees of freedom dof these issues are addressed in the present work especially the effect of dof seems to be handled unsatisfactorily in mancini et al 2018 the present work also attempts to throw light on scale effect on roll damping by performing 3d calculations of free roll decay both for model and prototype scales it further treats both blunt flat plate and sharp end designs of bilge keel to assess their performance albeit computationally finally this work presents a sample les vs rans comparison of free roll decay simulations the computational mesh for large amplitude motion such as roll with other dof of sway and heave requires chimera or overset mesh technique which had been used by few researchers araki et al 2014 chen et al 2002 jiang et al 2017 mancini et al 2018 most papers treated initial roll angles less than 15 and used deforming or remeshing mesh technique the calculations reported in this paper makes use of the overset mesh technique and treats large amplitude roll angles of up to 20 the advantages of overset grid in computing the resistance of high speed planing craft were also reported in sukas et al 2017 2 experimental investigation 2 1 test facility and model details the experiments were carried out in a glass flume which is 22 m in length 0 6 m wide and 0 8 m deep the water depth is 0 6 m the ship mid section data are given in table 1 a where length l beam b depth d draft d mass of the model w roll inertia i in air roll radius of gyration k xx metacentric radius bm height of center of gravity from keel kg metacentric height gm bilge keel width b bilge keel thickness t b bilge keel angle with horizontal θ and bilge radius r b are given the free roll decay measurements presented in this paper are for two configurations namely model without bilge keel bk00 and model with bilge keel bk10 a detailed description of the test facility and model may be found in irkal et al 2016 the bilge keel configuration is shown in fig 1 2 2 free roll decay and damping the 1 dof free roll decay test was conducted by subjecting the model to initial heel angle φ 0 the roll center of the model is at its center of gravity it may noted that usually the roll center lies between a ship s center of buoyancy and center of gravity but closer to center of gravity f two damping models that have been considered are 1 i a φ b l φ c φ 0 2 i a φ b 1 φ b 2 φ φ c φ 0 where φ is the roll angle as function of time t i is the roll moment of inertia a is the added inertia in roll b l is the linear roll damping coefficient in the linear model given by eq 1 b 1 and b 2 are the linear and quadratic roll damping coefficients respectively in the nonlinear model given by eq 2 and c is the roll restoring moment stiffness coefficient for small φ 0 one would expect eq 1 to be a good model since in practice a ship s roll damping is weakly nonlinear for small angles of roll for large φ 0 eq 2 is expected to be more realistic since a ship s roll damping in practice becomes strongly nonlinear for large angles of roll the roll decay test yields the roll decay curve which is a φ vs t plot with φ 0 φ 0 and φ 0 0 the linear damping b l was obtained using logarithmic decrement method averaging the first five positive peaks of the roll decay curve neglecting the first half cycle the linear b 1 and quadratic b 2 roll damping coefficients were obtained by fourier expansion chakrabarti 1994 faltinsen 1990 adopting eq 1 the linear damping model the damping coefficient can be estimated by the standard logarithmic decrement procedure if φ 1 and φ 2 are the two successive peaks in the roll decay curve the logarithmic decrement δ is given by δ ln φ 1 φ 2 which yields the nondimensional damping ratio ζ as 3 ζ 1 1 2 π δ 2 which is related to b l as 4 b l 2 i a ζ ω n ω n c i a 2 π t n where ω n is the natural roll frequency and t n is the corresponding natural roll period for roll motion the stiffness coefficient for small angles is given by c wggm where w is the mass displacement g is the acceleration due to gravity and gm is the metacentric height adopting eq 2 the quadratic damping model the damping coefficient can be estimated as described below if a set of peak roll angles either all positive or all negative are denoted φ k k 1 2 then calculate for k 1 2 a φ m k φ k φ k 1 2 b δ k ln φ k φ k 1 c ζ t k 1 1 2 π δ k 2 d b t k 2 i a ω n ζ t k e plot 8 3 π ω n φ m k v s b t k and get a linear fit so that the equation of the straight line is 5 b t b 1 b 2 8 3 π ω n φ m therefore the intercept and slope of this straight line equals b 1 and b 2 respectively if one chooses n positive peaks i e k 1 to n the number of points in the plot given by eqn 5 will be n 1 similarly negative peaks m in number should also be chosen i e k 1 to m yielding m 1 points in the plot the least square fit using n m 2 points will yield the straight line of eqn 5 3 numerical simulation 3 1 computational domain and boundary conditions the various ways to model a dynamic fluid body interaction problem of this type are sliding mesh technique for 1 dof motion deforming mesh remeshing and overset intersecting mesh techniques there are also other meshing or body representation methods for such problems the sliding mesh technique has an inner region including the body of interest which slides in the outer stationary region in deforming mesh the grid lines connecting the nodes behave like springs which deform according to the body motions remeshing method creates new cells and collapses old ones based on body motion overset mesh also called chimera mesh method has an inner moving region containing the moving body of interest and an outer stationary region there are intersection cells between the inner moving and outer stationary regions where new interpolation nodes are formed overset mesh method has advantage in simulating large amplitude motions in all directions such as motion of a floating body in waves overset mesh method was adopted in the present work since it has advantages over remeshing or deforming mesh techniques for high amplitude roll motion the overall computational domain is of rectangular box shape as shown in fig 2 a with dimensions l sr b sr and h sr in x y and z directions respectively the corners of the box are denoted by letters a to h with faces abcd x l sr 2 efgh x l sr 2 cdhg y b sr 2 baef y b sr 2 adhe z h sr 2 and bcgf z h sr 2 the domain has an inner moving region the so called overset region which is of cylindrical shape of length l or and radius r or the region excluding this overset region is the outer stationary region the center of cylindrical overset region coincides with the roll center of the ship model these two regions are linked with an overset mesh interface the inner overset i e rotating region was given an initial heel about the center of gravity or rotation of the ship model before the simulation was started linear interpolation scheme was adopted for the connection between the overset and stationary regions which is more accurate but time consuming as compared to distance averaged method used in the software cd adapco 2016 the boundary conditions are straightforward a no slip condition on ship surface b pressure outlet condition on faces baef and cdhg and c slip or zero shear stress condition on faces abcd efgh adhe and bcgf the air water interface is located at a height of h w from the face bcgf the 3d view of the domain with boundary conditions is shown in fig 2b three computational domains are considered in this work and these are i domain for scaled model of the mid section of the ship model 1 with which experiments were done see sec 2 1 which has dimensions l 0 58 m b 0 3 m d 0 2 m and d 0 12 m ii domain for scaled model with its length l extruded to full length of 1 74 m model 2 which is 3 times the length of model 1 all other dimensions i e b d and d remaining the same and iii domain of the full length prototype model model 3 with l 174 m b 30 m d 20 m and d 12 m for these three models the dimensions of both the model as well as of the computational domain are given in table 1b the model 2 is shown in fig 3 with a bilge keel length of l bk 0 3l in the simulations four bilge keel lengths were considered for this model namely l bk 0 3l 0 5l 0 75l l with their centres at midship the mass w and roll inertia i of the model 2 are three times the corresponding values of model 1 which are given in sec 2 1 the simulations of free roll decay were carried out using segregated solver with semi implicit method for pressure linked equation simple technique for pressure and velocity coupling volume of fluid vof method was used for multiphase flow with free surface between air and water as fluids implicit unsteady timestepping with second order upwind temporal discretization and a second order upwind scheme for convection was used a variable time step scheme based on the courant number was used with a minimum time step size of 10 6 s and the maximum time step does not exceed 0 001 s which is much smaller than the recommendation in ittc 2011b a mean courant number of 0 5 and target maximum courant number of 1 were used in simulation the convergence limit of 10 4 and below was achieved for the continuity momentum and turbulence solvers with ten iterations per time step the k ω sst model was used for turbulence modelling in all simulations except in les discussed in sec 4 4 where such a model is not required since it is suitable for separated flows from near wall the reynolds number re for a rolling hull is defined as re b 2 νt n where ν is kinematic viscosity of water 10 6 m2 s the re in the present study lies in the range of 75 000 80 000 on model scale the coupled motion of the ship model under fluid forces and moments was simulated using dynamic fluid body interaction model allowing only roll for 1 dof and all six motions for 6 dof simulations cd adapco 2016 3 2 meshing the meshing was carried out using three meshing models namely surface remesher trimmer and prism layers surface remesher is used to re triangulate the existing surface to optimize it for the volume mesh being generated it can also be used to alter the mesh size on a particular surface the trimmer meshing model creates predominantly hexahedral cells in the domain and it trims or cuts off the hexahedral cell according to the surface of the boundary in contact the resulting mesh is hybrid mesh composed of the structured hexahedral cells and polyhedral cells near the boundaries the mesh was locally refined near the free surface and bilge of the model using separate mesh blocks and surface remesher sizes prism layer mesher generates orthogonal prismatic cells near the boundaries used especially for walls with no slip condition it helps to simulate the near wall flow accurately and resolve the boundary layer and separated flow near the walls with no slip condition the thickness of the prism layer and the number of cells are decided according to the wall y desired in the flow simulation which is defined as y y ν τ w ρ where τ w is the mean wall shear stress ρ is the fluid density 998 kg m3 and y is the distance between grid points in the normal direction to the hull surface in the present simulations the average wall y was maintained below 5 for model scale simulations and 100 300 for full scale simulations with the wall treatment i e wall functions used for low as well as high wall y values the cases where the wall y is below 5 the low wall y function resolves the viscous sublayer without any modelling whereas for cases where the wall y is high full scale simulations or lies in buffer region wall functions based on equilibrium turbulent boundary layer theory are used the wall y for full scale simulations was maintained at higher values because of the computational expense required to resolve the flow with low y values fig 4 shows the mesh at cut y z plane for bk10 the refinement of mesh can be seen near the hull surface bilge keel and free surface 3 3 mesh sensitivity study the mesh sensitivity study was carried out by choosing three mesh sizes for the simulation of free roll decay of bk10 model 1 for φ 0 20 the base mesh sizes of both the stationary and the overset moving regions were changed the details of three sets of mesh sizes called fine medium and coarse are shown in table 2 the grid refinement ratio r g 2 was used to upscale the base sizes of mesh in the overset and stationary regions the total cell counts including the overset and stationary regions are also given in table 2 total cell number increases by 84 from coarse to medium mesh and 90 from medium to fine mesh the default cell growth ratio of 2 1 was used from a smaller to larger cell size throughout the domain excluding the prism layers the prism layer meshing to resolve boundary layer has growth ratio of 1 2 1 with geometric progression as stretching function the grid convergence index gci or factor of safety f s approach as recommended in ittc 2008 and roache 1998 was used to report the results of mesh sensitivity study the time step independence study was not carried out as the variable time step based on courant number was used as discussed earlier the roll decay motion for the first two cycles from the three meshes and its comparison with measurements are shown in fig 5 a second cycle of the roll motion and the error in the roll angle simulated between the fine and medium mesh ε fm and between medium and coarse mesh ε mc are shown in fig 5b a monotonic convergence is seen since ε f m ε m c the profile averaged convergence r g and order of accuracy p g are given by ittc 2008 roache 1998 6 r g ε f m 2 ε m c 2 7 p g ln ε m c 2 ε f m 2 ln r g where ε f m 2 and ε m c 2 are the l2 norm of the simulation errors ε fm and ε mc respectively taken from the second cycle of the roll decay motion see fig 5b the grid convergence index g c i f m for fine medium mesh and g c i m c for medium coarse mesh normalized with the φ 0 is calculated as 8 g c i f m f s ε f m 2 φ 0 r g p g 1 g c i m c f s ε m c 2 φ 0 r g p g 1 where φ 0 20 and f s is the factor of safety which equals 1 25 the convergence ratio order of accuracy and grid convergence indices are r g 0 286 p g 3 613 gci mc 10 61 and gci fm 3 03 the fact gci fm gci mc implies that the discretization error from the mesh are reduced and mesh independent solution is achieved the medium coarse value of gci mc is about 3 03 which is sufficiently low and hence the medium grid results are presented throughout the paper unless otherwise specified 4 results and discussion 4 1 linear damping from measurements and simulations the linear roll damping was obtained from eq 1 fig 6 shows the measured roll decay motion for bk10 for initial heel angles φ 0 5 10 15 and 20 the measured and simulated roll decay motion for bk00 and bk10 are shown in fig 7 for φ 0 5 and in fig 8 for φ 0 20 the simulated motion compares well with measurements for both large 20 and small 5 φ 0 at higher values of time when the roll angle φ becomes less than 1 5 the comparison becomes poorer and therefore the peaks below 1 5 have been neglected in the calculation of roll damping the comparisons of the measured and simulated average damping ratio ζ calculated from the first five positive peaks are shown in table 3 showing close resemblance from table 3 it is seen that ζ increases with φ 0 i e the reduction of roll angle is faster which can be seen in fig 6 as well the increase in ζ from φ 0 5 to φ 0 20 is 51 for bk10 and 22 for bk00 based on measurements this indicates higher nonlinearity in roll damping for bk10 as compared to bk00 which will be discussed in the subsequent section the presence of bilge keel and the flow separation around it causes this increase in nonlinearity in damping for larger φ 0 the vortex strengths are stronger as compared to smaller φ 0 the roll added mass coefficient c a a i and the roll natural period t n from experiments and simulations for bk00 and bk10 for φ 0 20 are presented in table 4 it can be seen that the roll natural period and added mass coefficient obtained from simulations have good comparison with measurements but slightly lower this could be attributed to the advantages of using overset mesh for such class of simulations as stated sukas et al 2017 and also seen in araki et al 2014 the presence of bilge keel increases the roll damping as well as the roll added inertia the measured and simulated roll damping increases by 133 and 141 respectively with the attachment of bilge keel the measured roll added mass increases by 81 and simulated roll added mass by 64 with the attachment of bilge keel the 3d numerical model used in this work is able to capture the key quantitative features of free roll motion with reasonably good accuracy which is sufficient for engineering decision making 4 2 comparison with ikeda s semi empirical method in a component type method of roll damping assessment the total roll damping b t is divided into various components arising from hull friction b f eddies formed due to roll motion b e wave radiation from the ship hull b w appendages bilge keel attached to the hull b bk and lift generated at forward speed b l total roll damping is given as an algebraic sum of all the components as follows 9 b t b f b e b w b b k b l the detailed description of the semi empirical formulae to calculate various components are reported in himeno 1981 ikeda et al 1979 ikeda et al 1978b 1978a the damping obtained from this method is compared with that obtained from experiments and simulations for model with and without bilge keel the wave radiation damping was obtained from 3d potential code ansys aqwa ansys 2012 and the lift damping b l is zero since there is no forward speed fig 9 shows the comparison of ζ vs φ m for bk00 and bk10 for initial heel φ 0 of 20 from measurements cfd simulations and ikeda s method it can be seen that the comparison of damping obtained from ikeda s method with experiments and simulations is reasonably good except it overestimates the damping at larger φ m particularly for model with bilge keel the pressures monitored from simulations near the bilge keel model 1 were compared with ikeda s method for the first roll cycle which has two zero crossing i e up crossing and down crossing fig 5a where the maximum roll velocity for the respective half cycle occurs the pressures then were converted to coefficient of pressure by the following formula 10 c p p 0 5 ρ l ω n φ m 2 the empirical value of the coefficient of pressure at the front face c p of bilge keel is 1 2 and at the back face c p is given by the following formula 11 c p 22 5 b π l φ m f 1 2 where l is the distance from center of roll to bilge keel tip and f is the correction factor for velocity correction near bilge keel it must be noted that the mean decay angle φ m i e the average of positive and negative peak for first half cycle and average of negative and positive peak for second half cycle was used to calculate c p instead of φ 0 fig 10 shows the location of pressure probes and fig 11 the variation of c p around the bilge keel for zero crossings in the first complete cycle it can be seen from fig 11a for down crossing the c p value in front of bilge keel tends towards the empirical value of 1 2 for both heel side as well as the opposite side whereas the negative c p behind the bilge keel is higher than the empirical values more on the opposite side and for the up crossing state in fig 11b the positive c p in front of bilge keel maintains the approach towards 1 2 but the negative c p behind the bilge keel has values much smaller than the empirical value this could be attributed to the fact the vortices generated from the bilge keel in free roll decay motion shed and decay much faster as compared to a steady state forced roll motion which was used to derive the empirical formulae it can be observed that the c p on front of bilge keel remains close to 1 2 both in down crossing and up crossing and also that the pressure in front of bilge keel decreases rapidly as opposed to behind bilge keel affirming the conclusions of ikeda et al 1979 4 3 nonlinear damping from measurements and simulations the nonlinear quadratic roll damping was obtained from eq 2 there are two parameters to quantify the nonlinear damping namely b 1 linear part and b 2 nonlinear part the linear regression applied to data obtained from the free decay experiments and simulations for four values of φ 0 are shown in fig 12 the intercept of the linear fit is the linear damping coefficient b 1 and its slope is the nonlinear damping coefficient b 2 the results are summarized in table 5 for both bk00 and bk10 it can be seen that the comparisons are good though experimental values of b 1 are somewhat higher than those from simulation the configuration bk00 has a small value of the slope α 2 tan 1 b 2 showing that the damping is essentially weakly nonlinear and hence the model represented by eq 1 is sufficiently accurate for this case for the configuration bk10 α 16 indicating the strong nonlinear contribution to roll damping introduced by bilge keel which is also the observation from table 3 the coefficient of determination of the least square fit is denoted r 2 a value of r 2 1 implies a perfect fit of data it can be seen that the r 2 value for bk00 is very small which implies that the damping is weakly nonlinear and this is corroborated by the small value of α 2 as discussed for bk10 the r 2 value is about 0 8 which implies reasonable fit of the experimental data 4 4 bilge keel thickness vorticity and comparison of urans les simulations to assess the effect of bilge keel thickness or the aspect ratio t b b a simulation with a sharp end of the bilge keel was carried out and compared with that of the thick blunt end bilge keel the base thickness at the attachment to the hull is the same in both cases i e 3 mm fig 13 shows the comparison of simulated roll decay for sharp and thick bilge keel for φ 0 10 and fig 14 shows the vorticity contour plots for the first cycle at four instants of roll motion the roll decay motion is the same in case of sharp as well as thick bilge keel ends except at very small angles 1 where the sharp bilge keel shows slightly smaller roll angles the damping and the vortex shedding pattern from bilge keel depends on keulegan carpenter number kc and the bilge keel aspect ratio a detailed study on heave plates for spars at low kc numbers was reported in tao and thiagarajan 2003a 2003b the kc πlφ 0 b number for the present study ranges between 18 64 0 93 corresponding the roll angles between 20 and 1 which is on higher side and along with the bilge keel aspect ratio t b b of 1 3 it exhibits unidirectional vortex shedding similar to the sharp bilge keel as can be seen in fig 14 hence the effect of bilge keel aspect ratio bilge keel thickness used in the experiments and corresponding simulations on roll damping is negligible for the range of kc numbers used fig 15 a shows the deformation in the vortex structure along the bilge keel span the vortex filament is represented with the iso surface of q criterion which is vortex identification criterion for t t n 0 50 of the roll decay motion it can be seen that the vortex filament curls near the ends of the bilge keel exhibiting three dimensional effect of the flow fig 15b shows the vorticity plots at three sections along the length of the model and it was observed that the vortex shapes and strengths are different at these three locations the mid section displays full grown positive vortex shed from the bilge keel whereas the rear and front sections show a smaller size positive vortex shed from the bilge keel the vorticity pattern shows a similarity between the rear and the front sections the large eddy simulation les of free roll decay of bk10 model 1 was carried out with φ 0 20 and compared with the urans simulation the finest grid resolution see table 2 was used for both the simulations for the purpose of comparison of these two methods where the average wall y was less than 1 the wall adapting local eddy viscosity subgrid scale model was used since it is more suitable for near wall flows nicoud and ducros 1999 the mesh requirements and convergence for a wall modelled les was achieved in accordance with the recommendations from georgiadis et al 2009 piomelli 2008 piomelli and balaras 2002 the stream wise cell size along the beam of the model in terms wall grid units x and span wise cell size along the roll axis of the model in terms of wall grid units z lie in between 50 100 and 15 40 respectively these conditions for cell sizes are satisfied near the area of influence of the model rolling in a free decay simulation the comparison of roll motion from these two simulations is shown in fig 16 showing very close match in other words les which needs more computational effort than urans is not required for prediction of roll damping in general les can predict more realistic features of vortex structures as compared to urans the comparison of vorticity from les and urans simulations is brought out in fig 17 fig 17a represents the comparison of iso surface of q criterion at t t n 0 5 for les and urans the q criterion iso surface is colored with vorticity along roll axis of the model fig 17b shows the vorticity plots at mid plane at t t n 0 5 obtained from both simulations the vortices from les are more disorganized and have slightly higher magnitudes of vorticity as compared to urans which are visible both in fig 17a and b the total hydrostatic pressure p t and vortex shedding pressure p vs were monitored at various points around the bilge keel as shown in fig 10 the variations of p t and p vs at initial heel side and also the opposite side for three points p2 p6 and p10 for the first roll cycle are shown in fig 18 it can be seen that the variations of pressure from les and urans are largely similar except for the point p6 i e tip of the bilge keel where les shows high frequency pressure fluctuations as compared to urans the pressure monitored are zeroed at the beginning of the roll decay and plotted for the first decay cycle 4 5 effect of bilge keel length the free roll of full length scaled model model 2 with four bilge keel lengths l bk 0 3l 0 5l 0 75l and l was simulated to assess the effect of bilge keel length on damping the simulation results are shown in fig 19 and table 6 table 6 shows the values of ζ t n and c a obtained from first five positive peaks increase in added mass coefficient c a and consequently the increase in t n can be seen with increase in bilge keel length which shows a clear shift of peaks to the right i e increasing time with larger bilge keel length fig 19a the plot of linear damping averaged from first five peaks ζ vs bilge keel length fig 19b shows a linear variation this could be because of averaging from first five peaks and the ship model is a uniform rectangular barge the variation of ζ with mean decay angle φ m φ 1 φ 2 2 for four bilge keel lengths and its comparison with the ikeda s method is shown in fig 19c the increase in the length of bilge keel increases the nonlinearity in damping as observed from fig 19c which is similar to the plots in fig 12 except that it has lesser data points just for φ 0 20 the first φ m for l bk 0 3l is around 15 and for l bk l is 12 exhibiting larger reduction in roll angle with increase in bilge keel length there is an overestimation in damping from ikeda s method for larger roll angles in all cases 4 6 effect of degrees of freedom and scaling all simulations discussed up to sec 4 5 use the 1 dof motion of the model it is of interest to reassess the results of these simulations by removing this artificial restriction towards this 6 dof simulations are carried out on model 2 scaled full length model and model 3 prototype model both with bilge keel length of 0 3l although the scale effects on roll decay motion for model with bilge keel are insignificant faltinsen 1990 faltinsen and sortland 1987 here the authors would like to present results of 0 3l long bilge keel on prototype scale the bilge keel thickness used in model experiments was 3 mm which when scaled up to full scale 1 100 becomes 300 mm but the simulations in full scale were carried out for 30 mm thick bilge keel fig 20 shows the comparison of 1 dof and 6 dof free roll decay curves showing practically no difference both at model scale and full scale hence the scale effect on roll motion is insignificant despite that the bilge keel is not throughout the length the motions of surge sway heave pitch and yaw which are not present in a 1 dof model are presented in fig 21 both for model 2 full length scaled model and model 3 full length prototype model where the model 2 results are scaled up using froude s similitude with 1 100 scaling all plots are for 4 roll cycles or about 50 s fig 21 shows that in 50 s the maximum values i e peaks of motion are approximately 1 cm in surge 50 cm in sway 10 cm in heave 0 0025 deg in pitch and 0 14 deg yaw the pattern i e variation with time of all motions are approximately similar in all dofs the peak values of motion are similar in surge and heave whereas the peak values sway pitch and yaw are lower for prototype model 3 than in scaled model model 2 after scaling up all these motions however have insignificantly low values that comes from numerical round off and accumulation errors hence there is practically no effect of considering additional degrees of freedom on roll decay motion both in model and full scale simulations for a barge like geometry 4 7 main observations several aspects of the roll damping problem of ships with and without bilge keel have been studied and discussed in sec 4 1 to 4 6 the main observations that emerge from the present work are a of the several alternatives of meshing namely sliding mesh technique deforming mesh technique remeshing technique and overset meshing technique see sec 3 it has been found that the overset meshing technique performs best vis à vis experimental data especially for large amplitude roll motion however choice of appropriate grid resolution and time step size continue to be important b in the model scale the present work finds that the chosen bilge keel thickness has no effect on roll damping and the related vortex shedding pattern it is obvious therefore in prototype scale the effect of bilge keel thickness will continue to be insignificant for the large roll amplitudes c the effect of keeping the degrees of freedom other than roll free i e active in simulation does not affect the roll motion for the barge like geometry chosen in other words the coupling of roll with sway and heave are negligible this can be attributed to the model s geometry and its high metacentric height nonetheless validation with experimental data for motion in other degrees of freedom for a different ship geometry may show these couplings and in such cases the numerical evaluation with only roll degree of freedom may yield erroneous results of roll damping this aspect requires further study d it has been found that both urans and les approaches yield identical results for all quantities of interest les however yields noticeable variation in the local flow behavior in terms of vorticity size and fluctuations of pressure near bilge keel though it may not be significant from a practical viewpoint e parametric study has been carried out to study the effect of bilge keel length on roll damping it shows that roll damping added inertia as well as the natural period increases with increase in bilge keel length f the numerically obtained roll damping values are usually compared with semi empirical results ikeda s method in several papers but pressure distribution in the bilge region with bilge keel has never been compared with semi empirical method for free roll decay the present work attempts this especially for large roll amplitudes it is found that the pressure distribution ahead the bilge keel surface facing the motion compares well with semi empirical values whereas the pressure distribution behind shows significant difference with semi empirical values 5 conclusion this paper presents results of three dimensional numerical simulation of free roll decay of a ship mid section both with and without bilge keel and validated with experimental results with success both linear and nonlinear roll damping models are used to extract roll damping from simulation data ikeda s empirical method was also compared with measurements and simulations the effect of bilge keel thickness blunt vs sharp end is found insignificant both on roll motion and vortex shedding pattern simulation by les method is shown to offer no advantage when compared with urans parametric study was carried out to study the effect of bilge keel length on roll damping the effect of allowing all degrees of freedom in numerical roll decay simulation is found to be insignificant no scale effect could be observed on roll motion and roll damping estimates by performing simulation both in model scale and prototype scale acknowledgement the authors would like to thank p g senapathy center for computing resource iit madras for allowing the use of virgo super cluster to carry out the numerical simulations 
22880,estimation of roll damping of ships from free roll decay experiments or using appropriate semi empirical formulae is a common practice the total roll damping of a ship or a barge can be strongly nonlinear consisting of linear and nonlinear components especially when bilge keel is fitted to the hull as a damping device and also when angles of roll are large cfd simulations of nonlinear roll motion with experimental validation is gaining acceptance in the recent past the present work reports three dimensional simulations of roll decay of a ship model both with and without bilge keel with experimental validation a good comparisons of roll damping natural period and added mass with experiments are obtained the use of large eddy simulation on this class of problems is explored and commented upon ikeda s semi empirical method over predicts roll damping at larger roll angles the pressure aft of bilge keel is found to be deviating whereas the pressure in front of bilge keel showed a close resemblance with semi empirical calculations effect of bilge keel thickness degrees of freedom and scaling on roll motion and damping is found to be insignificant for a barge like ship model chosen in this study keywords bilge keel free roll decay nonlinear roll damping urans les 1 introduction the prediction of roll damping of ships is both challenging as well as an extensively studied problem a ship may encounter extreme waves from beam or oblique directions that have periods close to its natural roll period thus leading to large amplitude roll motion that is inherently nonlinear this causes significant crew inefficiency and reduces the stability of the hull there by posing serious threat to the safety of the ship hence mitigation of roll motion is needed for smooth operation of ships and ship shaped floating platforms the popular roll mitigation devices used for ships and other floating systems are bilge keel u tube tank gyroscope rudder and active passive fins perez and blanke 2012 these devices are used one at a time or in combination depending on the initial cost maintenance range of operation and space constraints there had been a significant amount of work reported in the literature that addresses the efficiency of roll mitigation devices especially the bilge keel experiments of free roll decay and forced roll oscillations of ship models with and without appendages had been reported by many researchers chun et al 2001 downie et al 1988 haddara and leung 1994 na et al 2002 sarpkaya and o keefe 1996 tanaka and hishida 1957 tanaka and kitamura 1958 veer et al 2015 the effect of forward speed on roll motion and roll damping of ships free and forced oscillations both in calm sea and waves have also been reported in various works irvine et al 2013 wu et al 2005 zeraatgar et al 2010 early works in the field of roll damping and its prediction were summarized in himeno 1981 the contributions of a variety of factors that contribute to the total roll damping were discussed in the works of ikeda et al 1979 ikeda et al 1978a 1978b the semi empirical formulae for prediction of roll damping are widely used for conventional hull forms chakrabarti 2001 himeno 1981 ittc 2011a the main limitation with the empirical and semi empirical approaches in predicting roll damping is the need to use different equations formulae for different situations kawahara et al 2011 because such formulae have limited range of application and cannot be used for unconventional hull forms and appendages the use of numerical methods in predicting viscous flow around ships and other floating bodies started few decades ago vortex tracking method was used to study the effect of viscosity and separated flows around rectangular body with sharp corners braathen and faltinsen 1988 free surface random vortex method was used to simulate viscous and separated flows in the works of roddier et al 2000 thiagarajan and braddock 2010 yeung et al 1998 two dimensional 2d incompressible navier stokes solver had been used to simulate the viscous flow around a rolling hull avalos et al 2014 bangun et al 2010 irkal et al 2014 kinnas et al 2006 yu and kinnas 2009 wilson et al 2006 used a three dimensional 3d unsteady reynolds averaged navier stokes urans solver called cfd iowa paterson et al 2003 to simulate forced and free rolling motion of a naval combatant there are other researchers gokce and kinaci 2018 jiang and yeung 2017 zhou et al 2015 as well who had contributed to this field geometric design and orientation of bilge keel is best done using a 2d numerical model of a ship section because of low computational requirements however the estimation of roll damping of a ship due to bilge keel requires 3d calculations therefore the 2d and 3d calculations must be reconciled this is done in the present work using 3d calculations of the ship model for which extensive numerical 2d vs experimental comparisons of roll damping based on free roll decay are available in a recent paper by authors irkal et al 2016 the linear and nonlinear damping models are used in both 3d and 2d models additional issues which are absent in a 2d model arise in 3d calculations namely the effect of bilge keel length and effect of free degrees of freedom dof these issues are addressed in the present work especially the effect of dof seems to be handled unsatisfactorily in mancini et al 2018 the present work also attempts to throw light on scale effect on roll damping by performing 3d calculations of free roll decay both for model and prototype scales it further treats both blunt flat plate and sharp end designs of bilge keel to assess their performance albeit computationally finally this work presents a sample les vs rans comparison of free roll decay simulations the computational mesh for large amplitude motion such as roll with other dof of sway and heave requires chimera or overset mesh technique which had been used by few researchers araki et al 2014 chen et al 2002 jiang et al 2017 mancini et al 2018 most papers treated initial roll angles less than 15 and used deforming or remeshing mesh technique the calculations reported in this paper makes use of the overset mesh technique and treats large amplitude roll angles of up to 20 the advantages of overset grid in computing the resistance of high speed planing craft were also reported in sukas et al 2017 2 experimental investigation 2 1 test facility and model details the experiments were carried out in a glass flume which is 22 m in length 0 6 m wide and 0 8 m deep the water depth is 0 6 m the ship mid section data are given in table 1 a where length l beam b depth d draft d mass of the model w roll inertia i in air roll radius of gyration k xx metacentric radius bm height of center of gravity from keel kg metacentric height gm bilge keel width b bilge keel thickness t b bilge keel angle with horizontal θ and bilge radius r b are given the free roll decay measurements presented in this paper are for two configurations namely model without bilge keel bk00 and model with bilge keel bk10 a detailed description of the test facility and model may be found in irkal et al 2016 the bilge keel configuration is shown in fig 1 2 2 free roll decay and damping the 1 dof free roll decay test was conducted by subjecting the model to initial heel angle φ 0 the roll center of the model is at its center of gravity it may noted that usually the roll center lies between a ship s center of buoyancy and center of gravity but closer to center of gravity f two damping models that have been considered are 1 i a φ b l φ c φ 0 2 i a φ b 1 φ b 2 φ φ c φ 0 where φ is the roll angle as function of time t i is the roll moment of inertia a is the added inertia in roll b l is the linear roll damping coefficient in the linear model given by eq 1 b 1 and b 2 are the linear and quadratic roll damping coefficients respectively in the nonlinear model given by eq 2 and c is the roll restoring moment stiffness coefficient for small φ 0 one would expect eq 1 to be a good model since in practice a ship s roll damping is weakly nonlinear for small angles of roll for large φ 0 eq 2 is expected to be more realistic since a ship s roll damping in practice becomes strongly nonlinear for large angles of roll the roll decay test yields the roll decay curve which is a φ vs t plot with φ 0 φ 0 and φ 0 0 the linear damping b l was obtained using logarithmic decrement method averaging the first five positive peaks of the roll decay curve neglecting the first half cycle the linear b 1 and quadratic b 2 roll damping coefficients were obtained by fourier expansion chakrabarti 1994 faltinsen 1990 adopting eq 1 the linear damping model the damping coefficient can be estimated by the standard logarithmic decrement procedure if φ 1 and φ 2 are the two successive peaks in the roll decay curve the logarithmic decrement δ is given by δ ln φ 1 φ 2 which yields the nondimensional damping ratio ζ as 3 ζ 1 1 2 π δ 2 which is related to b l as 4 b l 2 i a ζ ω n ω n c i a 2 π t n where ω n is the natural roll frequency and t n is the corresponding natural roll period for roll motion the stiffness coefficient for small angles is given by c wggm where w is the mass displacement g is the acceleration due to gravity and gm is the metacentric height adopting eq 2 the quadratic damping model the damping coefficient can be estimated as described below if a set of peak roll angles either all positive or all negative are denoted φ k k 1 2 then calculate for k 1 2 a φ m k φ k φ k 1 2 b δ k ln φ k φ k 1 c ζ t k 1 1 2 π δ k 2 d b t k 2 i a ω n ζ t k e plot 8 3 π ω n φ m k v s b t k and get a linear fit so that the equation of the straight line is 5 b t b 1 b 2 8 3 π ω n φ m therefore the intercept and slope of this straight line equals b 1 and b 2 respectively if one chooses n positive peaks i e k 1 to n the number of points in the plot given by eqn 5 will be n 1 similarly negative peaks m in number should also be chosen i e k 1 to m yielding m 1 points in the plot the least square fit using n m 2 points will yield the straight line of eqn 5 3 numerical simulation 3 1 computational domain and boundary conditions the various ways to model a dynamic fluid body interaction problem of this type are sliding mesh technique for 1 dof motion deforming mesh remeshing and overset intersecting mesh techniques there are also other meshing or body representation methods for such problems the sliding mesh technique has an inner region including the body of interest which slides in the outer stationary region in deforming mesh the grid lines connecting the nodes behave like springs which deform according to the body motions remeshing method creates new cells and collapses old ones based on body motion overset mesh also called chimera mesh method has an inner moving region containing the moving body of interest and an outer stationary region there are intersection cells between the inner moving and outer stationary regions where new interpolation nodes are formed overset mesh method has advantage in simulating large amplitude motions in all directions such as motion of a floating body in waves overset mesh method was adopted in the present work since it has advantages over remeshing or deforming mesh techniques for high amplitude roll motion the overall computational domain is of rectangular box shape as shown in fig 2 a with dimensions l sr b sr and h sr in x y and z directions respectively the corners of the box are denoted by letters a to h with faces abcd x l sr 2 efgh x l sr 2 cdhg y b sr 2 baef y b sr 2 adhe z h sr 2 and bcgf z h sr 2 the domain has an inner moving region the so called overset region which is of cylindrical shape of length l or and radius r or the region excluding this overset region is the outer stationary region the center of cylindrical overset region coincides with the roll center of the ship model these two regions are linked with an overset mesh interface the inner overset i e rotating region was given an initial heel about the center of gravity or rotation of the ship model before the simulation was started linear interpolation scheme was adopted for the connection between the overset and stationary regions which is more accurate but time consuming as compared to distance averaged method used in the software cd adapco 2016 the boundary conditions are straightforward a no slip condition on ship surface b pressure outlet condition on faces baef and cdhg and c slip or zero shear stress condition on faces abcd efgh adhe and bcgf the air water interface is located at a height of h w from the face bcgf the 3d view of the domain with boundary conditions is shown in fig 2b three computational domains are considered in this work and these are i domain for scaled model of the mid section of the ship model 1 with which experiments were done see sec 2 1 which has dimensions l 0 58 m b 0 3 m d 0 2 m and d 0 12 m ii domain for scaled model with its length l extruded to full length of 1 74 m model 2 which is 3 times the length of model 1 all other dimensions i e b d and d remaining the same and iii domain of the full length prototype model model 3 with l 174 m b 30 m d 20 m and d 12 m for these three models the dimensions of both the model as well as of the computational domain are given in table 1b the model 2 is shown in fig 3 with a bilge keel length of l bk 0 3l in the simulations four bilge keel lengths were considered for this model namely l bk 0 3l 0 5l 0 75l l with their centres at midship the mass w and roll inertia i of the model 2 are three times the corresponding values of model 1 which are given in sec 2 1 the simulations of free roll decay were carried out using segregated solver with semi implicit method for pressure linked equation simple technique for pressure and velocity coupling volume of fluid vof method was used for multiphase flow with free surface between air and water as fluids implicit unsteady timestepping with second order upwind temporal discretization and a second order upwind scheme for convection was used a variable time step scheme based on the courant number was used with a minimum time step size of 10 6 s and the maximum time step does not exceed 0 001 s which is much smaller than the recommendation in ittc 2011b a mean courant number of 0 5 and target maximum courant number of 1 were used in simulation the convergence limit of 10 4 and below was achieved for the continuity momentum and turbulence solvers with ten iterations per time step the k ω sst model was used for turbulence modelling in all simulations except in les discussed in sec 4 4 where such a model is not required since it is suitable for separated flows from near wall the reynolds number re for a rolling hull is defined as re b 2 νt n where ν is kinematic viscosity of water 10 6 m2 s the re in the present study lies in the range of 75 000 80 000 on model scale the coupled motion of the ship model under fluid forces and moments was simulated using dynamic fluid body interaction model allowing only roll for 1 dof and all six motions for 6 dof simulations cd adapco 2016 3 2 meshing the meshing was carried out using three meshing models namely surface remesher trimmer and prism layers surface remesher is used to re triangulate the existing surface to optimize it for the volume mesh being generated it can also be used to alter the mesh size on a particular surface the trimmer meshing model creates predominantly hexahedral cells in the domain and it trims or cuts off the hexahedral cell according to the surface of the boundary in contact the resulting mesh is hybrid mesh composed of the structured hexahedral cells and polyhedral cells near the boundaries the mesh was locally refined near the free surface and bilge of the model using separate mesh blocks and surface remesher sizes prism layer mesher generates orthogonal prismatic cells near the boundaries used especially for walls with no slip condition it helps to simulate the near wall flow accurately and resolve the boundary layer and separated flow near the walls with no slip condition the thickness of the prism layer and the number of cells are decided according to the wall y desired in the flow simulation which is defined as y y ν τ w ρ where τ w is the mean wall shear stress ρ is the fluid density 998 kg m3 and y is the distance between grid points in the normal direction to the hull surface in the present simulations the average wall y was maintained below 5 for model scale simulations and 100 300 for full scale simulations with the wall treatment i e wall functions used for low as well as high wall y values the cases where the wall y is below 5 the low wall y function resolves the viscous sublayer without any modelling whereas for cases where the wall y is high full scale simulations or lies in buffer region wall functions based on equilibrium turbulent boundary layer theory are used the wall y for full scale simulations was maintained at higher values because of the computational expense required to resolve the flow with low y values fig 4 shows the mesh at cut y z plane for bk10 the refinement of mesh can be seen near the hull surface bilge keel and free surface 3 3 mesh sensitivity study the mesh sensitivity study was carried out by choosing three mesh sizes for the simulation of free roll decay of bk10 model 1 for φ 0 20 the base mesh sizes of both the stationary and the overset moving regions were changed the details of three sets of mesh sizes called fine medium and coarse are shown in table 2 the grid refinement ratio r g 2 was used to upscale the base sizes of mesh in the overset and stationary regions the total cell counts including the overset and stationary regions are also given in table 2 total cell number increases by 84 from coarse to medium mesh and 90 from medium to fine mesh the default cell growth ratio of 2 1 was used from a smaller to larger cell size throughout the domain excluding the prism layers the prism layer meshing to resolve boundary layer has growth ratio of 1 2 1 with geometric progression as stretching function the grid convergence index gci or factor of safety f s approach as recommended in ittc 2008 and roache 1998 was used to report the results of mesh sensitivity study the time step independence study was not carried out as the variable time step based on courant number was used as discussed earlier the roll decay motion for the first two cycles from the three meshes and its comparison with measurements are shown in fig 5 a second cycle of the roll motion and the error in the roll angle simulated between the fine and medium mesh ε fm and between medium and coarse mesh ε mc are shown in fig 5b a monotonic convergence is seen since ε f m ε m c the profile averaged convergence r g and order of accuracy p g are given by ittc 2008 roache 1998 6 r g ε f m 2 ε m c 2 7 p g ln ε m c 2 ε f m 2 ln r g where ε f m 2 and ε m c 2 are the l2 norm of the simulation errors ε fm and ε mc respectively taken from the second cycle of the roll decay motion see fig 5b the grid convergence index g c i f m for fine medium mesh and g c i m c for medium coarse mesh normalized with the φ 0 is calculated as 8 g c i f m f s ε f m 2 φ 0 r g p g 1 g c i m c f s ε m c 2 φ 0 r g p g 1 where φ 0 20 and f s is the factor of safety which equals 1 25 the convergence ratio order of accuracy and grid convergence indices are r g 0 286 p g 3 613 gci mc 10 61 and gci fm 3 03 the fact gci fm gci mc implies that the discretization error from the mesh are reduced and mesh independent solution is achieved the medium coarse value of gci mc is about 3 03 which is sufficiently low and hence the medium grid results are presented throughout the paper unless otherwise specified 4 results and discussion 4 1 linear damping from measurements and simulations the linear roll damping was obtained from eq 1 fig 6 shows the measured roll decay motion for bk10 for initial heel angles φ 0 5 10 15 and 20 the measured and simulated roll decay motion for bk00 and bk10 are shown in fig 7 for φ 0 5 and in fig 8 for φ 0 20 the simulated motion compares well with measurements for both large 20 and small 5 φ 0 at higher values of time when the roll angle φ becomes less than 1 5 the comparison becomes poorer and therefore the peaks below 1 5 have been neglected in the calculation of roll damping the comparisons of the measured and simulated average damping ratio ζ calculated from the first five positive peaks are shown in table 3 showing close resemblance from table 3 it is seen that ζ increases with φ 0 i e the reduction of roll angle is faster which can be seen in fig 6 as well the increase in ζ from φ 0 5 to φ 0 20 is 51 for bk10 and 22 for bk00 based on measurements this indicates higher nonlinearity in roll damping for bk10 as compared to bk00 which will be discussed in the subsequent section the presence of bilge keel and the flow separation around it causes this increase in nonlinearity in damping for larger φ 0 the vortex strengths are stronger as compared to smaller φ 0 the roll added mass coefficient c a a i and the roll natural period t n from experiments and simulations for bk00 and bk10 for φ 0 20 are presented in table 4 it can be seen that the roll natural period and added mass coefficient obtained from simulations have good comparison with measurements but slightly lower this could be attributed to the advantages of using overset mesh for such class of simulations as stated sukas et al 2017 and also seen in araki et al 2014 the presence of bilge keel increases the roll damping as well as the roll added inertia the measured and simulated roll damping increases by 133 and 141 respectively with the attachment of bilge keel the measured roll added mass increases by 81 and simulated roll added mass by 64 with the attachment of bilge keel the 3d numerical model used in this work is able to capture the key quantitative features of free roll motion with reasonably good accuracy which is sufficient for engineering decision making 4 2 comparison with ikeda s semi empirical method in a component type method of roll damping assessment the total roll damping b t is divided into various components arising from hull friction b f eddies formed due to roll motion b e wave radiation from the ship hull b w appendages bilge keel attached to the hull b bk and lift generated at forward speed b l total roll damping is given as an algebraic sum of all the components as follows 9 b t b f b e b w b b k b l the detailed description of the semi empirical formulae to calculate various components are reported in himeno 1981 ikeda et al 1979 ikeda et al 1978b 1978a the damping obtained from this method is compared with that obtained from experiments and simulations for model with and without bilge keel the wave radiation damping was obtained from 3d potential code ansys aqwa ansys 2012 and the lift damping b l is zero since there is no forward speed fig 9 shows the comparison of ζ vs φ m for bk00 and bk10 for initial heel φ 0 of 20 from measurements cfd simulations and ikeda s method it can be seen that the comparison of damping obtained from ikeda s method with experiments and simulations is reasonably good except it overestimates the damping at larger φ m particularly for model with bilge keel the pressures monitored from simulations near the bilge keel model 1 were compared with ikeda s method for the first roll cycle which has two zero crossing i e up crossing and down crossing fig 5a where the maximum roll velocity for the respective half cycle occurs the pressures then were converted to coefficient of pressure by the following formula 10 c p p 0 5 ρ l ω n φ m 2 the empirical value of the coefficient of pressure at the front face c p of bilge keel is 1 2 and at the back face c p is given by the following formula 11 c p 22 5 b π l φ m f 1 2 where l is the distance from center of roll to bilge keel tip and f is the correction factor for velocity correction near bilge keel it must be noted that the mean decay angle φ m i e the average of positive and negative peak for first half cycle and average of negative and positive peak for second half cycle was used to calculate c p instead of φ 0 fig 10 shows the location of pressure probes and fig 11 the variation of c p around the bilge keel for zero crossings in the first complete cycle it can be seen from fig 11a for down crossing the c p value in front of bilge keel tends towards the empirical value of 1 2 for both heel side as well as the opposite side whereas the negative c p behind the bilge keel is higher than the empirical values more on the opposite side and for the up crossing state in fig 11b the positive c p in front of bilge keel maintains the approach towards 1 2 but the negative c p behind the bilge keel has values much smaller than the empirical value this could be attributed to the fact the vortices generated from the bilge keel in free roll decay motion shed and decay much faster as compared to a steady state forced roll motion which was used to derive the empirical formulae it can be observed that the c p on front of bilge keel remains close to 1 2 both in down crossing and up crossing and also that the pressure in front of bilge keel decreases rapidly as opposed to behind bilge keel affirming the conclusions of ikeda et al 1979 4 3 nonlinear damping from measurements and simulations the nonlinear quadratic roll damping was obtained from eq 2 there are two parameters to quantify the nonlinear damping namely b 1 linear part and b 2 nonlinear part the linear regression applied to data obtained from the free decay experiments and simulations for four values of φ 0 are shown in fig 12 the intercept of the linear fit is the linear damping coefficient b 1 and its slope is the nonlinear damping coefficient b 2 the results are summarized in table 5 for both bk00 and bk10 it can be seen that the comparisons are good though experimental values of b 1 are somewhat higher than those from simulation the configuration bk00 has a small value of the slope α 2 tan 1 b 2 showing that the damping is essentially weakly nonlinear and hence the model represented by eq 1 is sufficiently accurate for this case for the configuration bk10 α 16 indicating the strong nonlinear contribution to roll damping introduced by bilge keel which is also the observation from table 3 the coefficient of determination of the least square fit is denoted r 2 a value of r 2 1 implies a perfect fit of data it can be seen that the r 2 value for bk00 is very small which implies that the damping is weakly nonlinear and this is corroborated by the small value of α 2 as discussed for bk10 the r 2 value is about 0 8 which implies reasonable fit of the experimental data 4 4 bilge keel thickness vorticity and comparison of urans les simulations to assess the effect of bilge keel thickness or the aspect ratio t b b a simulation with a sharp end of the bilge keel was carried out and compared with that of the thick blunt end bilge keel the base thickness at the attachment to the hull is the same in both cases i e 3 mm fig 13 shows the comparison of simulated roll decay for sharp and thick bilge keel for φ 0 10 and fig 14 shows the vorticity contour plots for the first cycle at four instants of roll motion the roll decay motion is the same in case of sharp as well as thick bilge keel ends except at very small angles 1 where the sharp bilge keel shows slightly smaller roll angles the damping and the vortex shedding pattern from bilge keel depends on keulegan carpenter number kc and the bilge keel aspect ratio a detailed study on heave plates for spars at low kc numbers was reported in tao and thiagarajan 2003a 2003b the kc πlφ 0 b number for the present study ranges between 18 64 0 93 corresponding the roll angles between 20 and 1 which is on higher side and along with the bilge keel aspect ratio t b b of 1 3 it exhibits unidirectional vortex shedding similar to the sharp bilge keel as can be seen in fig 14 hence the effect of bilge keel aspect ratio bilge keel thickness used in the experiments and corresponding simulations on roll damping is negligible for the range of kc numbers used fig 15 a shows the deformation in the vortex structure along the bilge keel span the vortex filament is represented with the iso surface of q criterion which is vortex identification criterion for t t n 0 50 of the roll decay motion it can be seen that the vortex filament curls near the ends of the bilge keel exhibiting three dimensional effect of the flow fig 15b shows the vorticity plots at three sections along the length of the model and it was observed that the vortex shapes and strengths are different at these three locations the mid section displays full grown positive vortex shed from the bilge keel whereas the rear and front sections show a smaller size positive vortex shed from the bilge keel the vorticity pattern shows a similarity between the rear and the front sections the large eddy simulation les of free roll decay of bk10 model 1 was carried out with φ 0 20 and compared with the urans simulation the finest grid resolution see table 2 was used for both the simulations for the purpose of comparison of these two methods where the average wall y was less than 1 the wall adapting local eddy viscosity subgrid scale model was used since it is more suitable for near wall flows nicoud and ducros 1999 the mesh requirements and convergence for a wall modelled les was achieved in accordance with the recommendations from georgiadis et al 2009 piomelli 2008 piomelli and balaras 2002 the stream wise cell size along the beam of the model in terms wall grid units x and span wise cell size along the roll axis of the model in terms of wall grid units z lie in between 50 100 and 15 40 respectively these conditions for cell sizes are satisfied near the area of influence of the model rolling in a free decay simulation the comparison of roll motion from these two simulations is shown in fig 16 showing very close match in other words les which needs more computational effort than urans is not required for prediction of roll damping in general les can predict more realistic features of vortex structures as compared to urans the comparison of vorticity from les and urans simulations is brought out in fig 17 fig 17a represents the comparison of iso surface of q criterion at t t n 0 5 for les and urans the q criterion iso surface is colored with vorticity along roll axis of the model fig 17b shows the vorticity plots at mid plane at t t n 0 5 obtained from both simulations the vortices from les are more disorganized and have slightly higher magnitudes of vorticity as compared to urans which are visible both in fig 17a and b the total hydrostatic pressure p t and vortex shedding pressure p vs were monitored at various points around the bilge keel as shown in fig 10 the variations of p t and p vs at initial heel side and also the opposite side for three points p2 p6 and p10 for the first roll cycle are shown in fig 18 it can be seen that the variations of pressure from les and urans are largely similar except for the point p6 i e tip of the bilge keel where les shows high frequency pressure fluctuations as compared to urans the pressure monitored are zeroed at the beginning of the roll decay and plotted for the first decay cycle 4 5 effect of bilge keel length the free roll of full length scaled model model 2 with four bilge keel lengths l bk 0 3l 0 5l 0 75l and l was simulated to assess the effect of bilge keel length on damping the simulation results are shown in fig 19 and table 6 table 6 shows the values of ζ t n and c a obtained from first five positive peaks increase in added mass coefficient c a and consequently the increase in t n can be seen with increase in bilge keel length which shows a clear shift of peaks to the right i e increasing time with larger bilge keel length fig 19a the plot of linear damping averaged from first five peaks ζ vs bilge keel length fig 19b shows a linear variation this could be because of averaging from first five peaks and the ship model is a uniform rectangular barge the variation of ζ with mean decay angle φ m φ 1 φ 2 2 for four bilge keel lengths and its comparison with the ikeda s method is shown in fig 19c the increase in the length of bilge keel increases the nonlinearity in damping as observed from fig 19c which is similar to the plots in fig 12 except that it has lesser data points just for φ 0 20 the first φ m for l bk 0 3l is around 15 and for l bk l is 12 exhibiting larger reduction in roll angle with increase in bilge keel length there is an overestimation in damping from ikeda s method for larger roll angles in all cases 4 6 effect of degrees of freedom and scaling all simulations discussed up to sec 4 5 use the 1 dof motion of the model it is of interest to reassess the results of these simulations by removing this artificial restriction towards this 6 dof simulations are carried out on model 2 scaled full length model and model 3 prototype model both with bilge keel length of 0 3l although the scale effects on roll decay motion for model with bilge keel are insignificant faltinsen 1990 faltinsen and sortland 1987 here the authors would like to present results of 0 3l long bilge keel on prototype scale the bilge keel thickness used in model experiments was 3 mm which when scaled up to full scale 1 100 becomes 300 mm but the simulations in full scale were carried out for 30 mm thick bilge keel fig 20 shows the comparison of 1 dof and 6 dof free roll decay curves showing practically no difference both at model scale and full scale hence the scale effect on roll motion is insignificant despite that the bilge keel is not throughout the length the motions of surge sway heave pitch and yaw which are not present in a 1 dof model are presented in fig 21 both for model 2 full length scaled model and model 3 full length prototype model where the model 2 results are scaled up using froude s similitude with 1 100 scaling all plots are for 4 roll cycles or about 50 s fig 21 shows that in 50 s the maximum values i e peaks of motion are approximately 1 cm in surge 50 cm in sway 10 cm in heave 0 0025 deg in pitch and 0 14 deg yaw the pattern i e variation with time of all motions are approximately similar in all dofs the peak values of motion are similar in surge and heave whereas the peak values sway pitch and yaw are lower for prototype model 3 than in scaled model model 2 after scaling up all these motions however have insignificantly low values that comes from numerical round off and accumulation errors hence there is practically no effect of considering additional degrees of freedom on roll decay motion both in model and full scale simulations for a barge like geometry 4 7 main observations several aspects of the roll damping problem of ships with and without bilge keel have been studied and discussed in sec 4 1 to 4 6 the main observations that emerge from the present work are a of the several alternatives of meshing namely sliding mesh technique deforming mesh technique remeshing technique and overset meshing technique see sec 3 it has been found that the overset meshing technique performs best vis à vis experimental data especially for large amplitude roll motion however choice of appropriate grid resolution and time step size continue to be important b in the model scale the present work finds that the chosen bilge keel thickness has no effect on roll damping and the related vortex shedding pattern it is obvious therefore in prototype scale the effect of bilge keel thickness will continue to be insignificant for the large roll amplitudes c the effect of keeping the degrees of freedom other than roll free i e active in simulation does not affect the roll motion for the barge like geometry chosen in other words the coupling of roll with sway and heave are negligible this can be attributed to the model s geometry and its high metacentric height nonetheless validation with experimental data for motion in other degrees of freedom for a different ship geometry may show these couplings and in such cases the numerical evaluation with only roll degree of freedom may yield erroneous results of roll damping this aspect requires further study d it has been found that both urans and les approaches yield identical results for all quantities of interest les however yields noticeable variation in the local flow behavior in terms of vorticity size and fluctuations of pressure near bilge keel though it may not be significant from a practical viewpoint e parametric study has been carried out to study the effect of bilge keel length on roll damping it shows that roll damping added inertia as well as the natural period increases with increase in bilge keel length f the numerically obtained roll damping values are usually compared with semi empirical results ikeda s method in several papers but pressure distribution in the bilge region with bilge keel has never been compared with semi empirical method for free roll decay the present work attempts this especially for large roll amplitudes it is found that the pressure distribution ahead the bilge keel surface facing the motion compares well with semi empirical values whereas the pressure distribution behind shows significant difference with semi empirical values 5 conclusion this paper presents results of three dimensional numerical simulation of free roll decay of a ship mid section both with and without bilge keel and validated with experimental results with success both linear and nonlinear roll damping models are used to extract roll damping from simulation data ikeda s empirical method was also compared with measurements and simulations the effect of bilge keel thickness blunt vs sharp end is found insignificant both on roll motion and vortex shedding pattern simulation by les method is shown to offer no advantage when compared with urans parametric study was carried out to study the effect of bilge keel length on roll damping the effect of allowing all degrees of freedom in numerical roll decay simulation is found to be insignificant no scale effect could be observed on roll motion and roll damping estimates by performing simulation both in model scale and prototype scale acknowledgement the authors would like to thank p g senapathy center for computing resource iit madras for allowing the use of virgo super cluster to carry out the numerical simulations 
22881,to build a compact data driven ship motion model for offshore operations that require high control safety it is necessary to select the most influential parameters and to analyze the uncertainty of the input parameters this paper proposes a framework of uncertainty and sensitivity analysis for ship motion data the framework consists of four components data cleaning surrogate model sensitivity and uncertainty analysis and results visualization data cleaning focuses on the removal of noise and necessary transformation for the easy analysis an artificial neural network ann based surrogate model is constructed on the basis of cleaned ship motion data the sensitivity and uncertainty analysis would be performed on the sample or weights which the ann based surrogate model generated the result of the sensitivity and uncertainty analysis can be beneficial to the optimization of data driven ship motion models three distinctive sensitivity analysis sa methods garson morris sobol and pdf based and cdf based uncertainty methods are investigated in two types of ship motion datasets with and without environmental factors the experimental results also demonstrate the proposed framework can be applied to estimate the sensitivity and uncertainty in different datasets keywords data driven uncertainty analysis sensitivity analysis ship motion offshore operations 1 introduction with the rapid development of the offshore industry the requirements for ship operations are increasing offshore operations are complex and hazardous due to the significant uncertainties and various operating conditions it is necessary to consider the accuracy of ship positioning and heading limited working space and collision avoidance between ships and floating structures li et al 2015 operational safety is the major issue and is easily challenged by harsh marine environments complex geological conditions and human and equipment factors operations around the oil drilling platform require very careful maneuvering of ships near the target and collision avoidance in designated areas and maneuvering in the limited space does not demand a fast approach but requires a high degree accuracy of positioning and heading thus establishing a suitable ship motion model for offshore operations is necessary to get a suitable model of ship motion in offshore operations the conventional method is to employ the mathematical modeling fossen 2002 however it is not an easy task to model the ship motion during the offshore operations because the model should be nonlinear dynamic over time and coupling with environmental factors like currents waves and wind which are random and unpredictable thus the conventional model based solutions which require an in depth knowledge of the offshore operations are impractical for complicated offshore operations with the wide deployment of sensors on ships it is possible to collect ship motion data and establish data based models the greatest challenge of data driven modeling for offshore operations is that environmental factors such as the current wave and wind tend to influence them the high uncertainty of environmental factors increases the difficulty of modeling thus studying the influence of environmental factors on the data based models stands to vastly improve safety as well as profit margins however to the best knowledge of the authors related researches on the impact of environmental factors on data driven modeling is still rare on the other hand there are also some other challenges for the data driven modeling for offshore operations 1 the sensor data used to be modelled are usually too large and high dimensional 2 they usually contain measurement induced noise redundant information and human factors which makes it difficult to use them for accurate analysis 3 it is not intuitive to interpret the data from multiple sensors as an aspect of uncertainty quantification the sensitivity analysis is defined as the investigation of how the uncertainty of the model output is apportioned to different sources of uncertainty in the model input factors saltelli 2002 sa is useful for obtaining reliable results and valuable information and increases the credibility of model results campolongo et al 2007 saltelli et al 2008 sa has been widely used for maritime applications with different purposes mainly including assessing the uncertainty calibrating the model and making robust decisions a derivative based sa is used to simplify the three layer structure of nonlinear autoregressive exogenous narx neural network for ship motion prediction li et al 2017 to construct a compact data driven ship motion prediction model zhang et al utilized the sum of square derivatives ssd to choose the inputs for the nonlinear autoregressive model with exogenous inputs narmax zhang and liu 2014 panagiotis proposed an sa to investigate various performance parameters affecting ship propulsion and maneuverability mizythras et al 2016 the influence of hydrodynamic coefficients on the maneuverability of submersibles is examined using sa on the basis of sea trials dong and rhee 2006 to study the influence of hydrodynamic coefficients for a four dof mathematical ship model an sa is performed on the basis of simulated data wang et al 2014 to determine the effect of the hydrodynamic derivatives on kvlcc2 maneuverability sa is conducted on the abkowitz type mathematical model kim et al 2017 uncertainty analysis of the circular motion test data was presented in ueno et al 2009 to investigate the hydrodynamic characteristics of ship maneuvering belenky et al provided a statistical uncertainty of ship motion data belenky et al 2015 although sa methods have been widely used in the analysis of mathematical models in the field of marine engineering no scheme has emerged that explains the uncertainty and sensitivity analysis of data driven models in this field our ongoing project aims to develop intelligent systems to support decision making for various maritime operations a new integrated platform including data analysis tools and data driven modeling technique is designed to serve the maritime industry by improving operational efficiency and safety in this paper we focus on the design of framework of uncertainty and sensitivity analysis for ship motion data in offshore operations to overcome the challenges of data driven modeling we first clean the raw data because sa methods cannot be applied to the sensor data directly a surrogate model is constructed uncertainty and sensitivity analysis is then performed on the basis of surrogate model to investigate the performance of the proposed framework three sa methods are compared in terms of importance ranking of the input parameters on two ship motion datasets with and without environmental factors the main contributions of this paper are first it proposes a novel uncertainty and sensitivity analysis framework making the sa methods be applicable to the analysis of ship motion datasets second it investigates the performance of different sa methods on different ship motion datasets in offshore operations the rest of the paper is organized as follows section 2 introduces the proposed framework for sensitivity and uncertainty analysis the methods to quantify the sensitivity and uncertainty are described in section 3 the proposed framework is examined in section 4 on the two ship motion datasets with and without environmental factors and the uncertainty analysis is provided after the sensitivity analysis finally discussion and conclusions are given 2 analysis of uncertainty and sensitivity on ship motion data this section introduces 1 the proposed system framework for sensitivity and uncertainty analysis 2 the source of sensor data data pre processing algorithm and the case ship 3 data driven surrogate modeling methods and 4 the concept of sensitivity and uncertainty and the working flow of the proposed framework 2 1 system framework a framework that integrates surrogate modeling technique uncertainty and sensitivity analysis methods to perform the sensitivity and uncertainty analysis is proposed the whole framework consists of four components data cleaning surrogate modeling sensitivity methods and results analysis which is depicted in fig 1 first the raw sensor data should be cleaned to minimize the effect of noisy and redundant information second surrogate based also called meta based methods offer an analytic approach to construct a mathematical model or prediction model from those sensor data third taking advantage of the surrogate model various uncertainty and sensitivity analysis methods can be performed for comparison study our framework is flexible such that we can employ surrogate models and sa methods to calculate the sensitivity and uncertainty results finally the sensitivity and uncertainty results can be employed to optimize the surrogate structure as the feedback arrow shown in fig 1 2 2 data source and data pre processing the offshore simulator centre as osc is an advanced training platform for offshore operation personnel the osc is developed by the norwegian university of science and technology ntnu and other research partners from the industry world osc has very powerful physical engine that can produce wind and waves that are almost the same as the real environment offshore simulator centre fig 2 shows the case ship equipped with two propellers with rudders and two tunnel thrusters at the stern and two tunnel thrusters at the bow the first step for analysis of sensitivity and uncertainty is to obtain a starting subset and to focus on specific parameters selecting those parameters is highly subjective which is based on the expert knowledge of the authors and a broad literature research in this context two data modules are monitored and stored the ship status module and the environment module as shown in table 1 considering that the original raw data may contain noisy discontinuous and redundant information it is necessary to clean up the data to minimize its impact on further analysis and modeling li et al 2016 noise reduction is always the first step in data cleaning which statistical estimation or median filtering methods could be utilized due to the physical definition there would be some jumping phenomenons in sensor data for example the definition of roll angle yaw angle and pitch angle is within 0 360 when the angle changes near the border the jumping phenomenon would occur inevitably to get rid of this type of discontinuity the algorithm is employed which is defined in our previous paper li et al 2016 to determine the effect of rudders it is necessary to make some transformations to obtain correct estimation in this paper the effect of rudder is transformed to the lift force and the calculation of the force is adopted from lindegaard and fossen 2003 in addition in order to accelerate the convergence speed of training and improve the accuracy of data driven surrogate model it is necessary to normalize all parameters the equation for normalizing all the parameters is shown in eq 1 1 x ˆ x μ x δ x ε where μ x denotes the mean of x δ x represents the variance of x ε is a very small value that makes the calculation possible when x is a constant to synchronize these data with different sampling frequency this paper also considers re sampling the data 2 3 data driven surrogate modeling method the process in nature usually can be simulated using some mathematical models the input of the model f describes the material properties external loads boundary conditions initial conditions etc tripathy and bilionis 2018 so that the model can describe complex natural behavior the input dimension is usually very large and may be hundreds or thousands it is feasible to construct a surrogate model that can reduce the computational burden of the original model while not sacrificing the accuracy the surrogate model can be considered as model of model the concept of a surrogate model is using a cheaper model to replace the original model fig 3 shows the concept of the surrogate model which can be built from the observed data of natural processes from the given input parameters of the natural process the mathematical model could be constructed which then yield the relevant data if the mathematical model is hard to build but only the measured data is available a surrogate model could be constructed to understand the underlying characteristics of the natural process this is also one of the objectives of machine learning samuel 1959 observed data whether from mathematical models or surrogate models can be applied to understand natural processes assuming there are n collected points which are formulated as f x y x is an n d matrix which can be represented by x x1 x2 xd y is the corresponding response the surrogate model y ˆ f ˆ x can be built to approximate the underlying relationship of collected data the widely used data driven models such as kriging kleijnen 2007 gaussian process oakley and o hagan 2004 the radial basis function todri et al 2014 support vector machine svm zhang et al 2017a ann model guevara et al 2015 and the deep learning model tripathy and bilionis 2018 can be effectively used for the construction of a surrogate model from measured data in our proposed framework in this paper the ann model is chosen as the surrogate model as shown in fig 1 to get the best structure of ann many optimization approaches such as genetic algorithm ga and particle swarm optimization pso can be used furthermore ann also can be employed to compute the sensitivity of input factors on the basis of the weight of the neurons in different layers in fig 1 the weights is used for the ann based sensitivity analysis e g garson the ann samples would be employed by performing global sensitivity analysis such as morris and sobol 2 4 sensitivity and uncertainty analysis the main purpose of the sa is to quantify the importance of all uncertain input parameters to a considered output in general sa methods can be roughly divided into local methods lsa which calculate quickly but only explore some sample points selected by users in the input space and the global method gsa of checking the influence of uncertain parameters on the whole parameter range pianosi et al 2016 the lsa and gsa have their own advantages and disadvantages and application areas the lsa which is computationally efficient is more applicable to the linear models while the gsa which is time consuming can be applied to both linear and nonlinear models both lsa and gsa can be used in this proposed framework according to different applications the results of sa are helpful for the removal of the less relevant inputs and optimizing the model structure fock 2014 uncertainty analysis is an important and necessary step for the data driven models usually there are two types of uncertainties aleatoric uncertainty and epistemic uncertainty li and mahadevan 2016 aleatoric uncertainty is often caused by the imprecise measurement in the data and epistemic uncertainty is caused by the parameter of the model first this paper focuses on the uncertainty caused by each input parameter second this paper also aims at the uncertainty analysis of the set of input parameters selected by the sa methods the process of the framework is as follows 1 cleaning the raw ship sensor data using the algorithm described in section 2 2 2 training the ann using the cleaned sensor data 3 generating the ann samples and obtaining the ann weights 4 calculating the sensitivity of different methods which is introduced in section 3 finally the sensitivity indices can help to improve the performance of the surrogate model 3 quantification of sensitivity and uncertainty the paper mainly introduces three types of sa methods with different computational time garson morris and sobol the garson method belongs to the lsa which is highly efficient it is a widely used method of sa in data based applications that is computed through the connection of different layers the morris method belongs to the gsa which means it has a medium computational burden it provides a qualitative ranking of the parameters that are based on their effect on the output of the model vanuytrecht et al 2014 the morris method provides a compromise scheme and represents a suitable gsa method for those computationally intensive models with large input parameters the sobol method belongs to the gsa which is computationally expensive the variance based sensitivity methods are also very popular for data driven applications in the literature fock 2014 fernández navarro et al 2017 3 1 garson the garson method is a special type of lsa that can be very useful to analyze the structure of ann which employs the connected weights of ann to calculate the sensitivity of each input parameter garson 1991 it can provide a quick and informative understanding of how the ann output can be attributed to its input parameters concretely the sensitivity of the i th uncertain input parameter to the k th output can be defined as follows 2 s i k j 1 l ω i j υ j k r 1 n ω r j r 1 n j 1 l ω i j υ j k r 1 n ω r j where s ik represents the sensitivity of the i th uncertain input to the k th output n and l are the number of the neurons in the input and hidden layer ω ij is the weight of the i th neuron in input layer and the j th neuron in the hidden layer υ jk is the weight of the j th neuron in the hidden layer and the k th neuron in the output layer 3 2 morris morris also known as elementary effect ee is a commonly used gsa and is usually used to identify the important uncertain input parameters in high dimensional models rather than to quantify sensitivity exactly saltelli et al 2008 song et al 2015 for a given model f x with n independent input parameters x 1 x 2 x n the morris sensitivity index of i th uncertain input parameter is defined as 3 e e i f x 1 x 2 x i δ x i δ 1 x n f x δ from the definition of equation 3 the one at a time oat design is employed to implement the global characteristic of morris the oat design should be repeated n times to measure the sensitivity the mean μ and standard deviation δ are used which can be computed by equation 4 4 μ i 1 n j 1 n e e i j δ i 1 n 1 j 1 n e e i j 1 n j 1 n e e i j in which ee i j is the elementary effect for input i using the j th base sample point the morris method uses the μ to estimate the significant effect on the output and uses the δ to estimate the non linearity and interactions between inputs if μ i is close to zero it indicates the parameter i is non influential if δ i is large this indicates the parameter i has a nonlinear effect on output or that interactions with other parameters exist 3 3 sobol the sobol method estimates the importance of uncertain input parameter on the basis of variance decomposition which has been widely used in many disciplines saltelli et al 1999 assuming the model form is f x f x 1 x m where x x 1 x m represents the model input which contains m independent parameters based on the theory of sobol saltelli and sobol 1995 the model output can be decomposed by different effects which is shown as follows 5 f x f 0 i 1 m f i x i 1 i j m f i j x i x j f 1 2 m x 1 x 2 x m some literature li et al 2002 2006 have argued that only the lower order terms are important so this paper considers only the two higher orders eq 5 can be re written as follows 6 f x f 0 i 1 m f i x i 1 i j m f i j x i x j assume the f x is square integrable squaring eq 6 and integrating over the input space the following equation can be obtained 7 f 2 x d x f 0 2 i 1 m f i 2 x i 1 i j m f i j 2 x i x j the left part in eq 7 is called the total variance 8 v f 2 x d x f 0 2 the right part in eq 7 is called the partial variance 9 v i i 1 m f i 2 x i v i j 1 i j m f i j 2 x i x j generally the global sensitivity index would be described by the ratio of partial variance and total variance zhang et al 2017b the first order main effect and total order sensitivity index for the i th variable x i can be defined by 10 s i v i v s t i 1 v i v the first order and total order sensitivity index are widely used in sobol if the value of total first order sensitivity index is close to zero the parameter can be considered to be non important 3 4 uncertainty analysis method the common way of quantifying uncertainty is to estimate the probability distribution function pdf tripathy and bilionis 2018 and cumulative distribution function cdf pianosi and wagener 2015 although current researches either focus on pdf or cdf the proposed framework takes advantages of both methods so that it can quantify the uncertainty of input parameters in two different perspectives assuming the group of input parameter x i of the data driven model is not known exactly the unconditional cumulative distribution function and probability distribution function of the model output are expressed as f y y and f y y when the group of input parameter x i is removed or is kept fixed the cumulative distribution function and probability distribution function of the model output then can be represented as f y xi y and f y xi y the distance df and df between f y y f y y and f y xi y f y xi y accounts for the uncertainty of a set of parameters x i which can be described as follows 11 d f x i f y y f y x i y 12 d f x i f y y f y x i y 3 5 detail algorithm description the algorithm used to investigate this research is illustrated in fig 4 first the ship sensor data would be cleaned using the methods as described in section 2 2 second the ann would be built on the basis of the training set and the model would be validated by three standard evaluation measurements mean absolute percentage error mape variance of absolute percentage error vape and root mean square error rmse if the testing results are not as expected the ann model will need to retrain to achieve the specified accuracy third the garson sensitivity index would be calculated on the basis of the coefficient of different layers of ann the morris and sobol methods would be computed by the ann samples finally in describing the model output uncertainty the importance of the input parameters of each sa method is quantified by sorting them in descending order 4 experiment in this section we present the sensitivity and uncertainty analysis on two type of datasets of random maneuvering with and without environment factors for simplicity the two datasets only record simple maneuvers in offshore operations in which only the two main thrusters as depicted in fig 2 are used to control ship motion in the dataset without environmental effect the surge sway and yaw velocity are within the range of 0 6 9 m s 0 63 0 44 m s and 2 57 2 64 deg s respectively these velocities in the other dataset are slightly different ranging within 0 45 7 3 m s 1 36 0 47 m s and 3 58 3 deg s respectively to investigate the influence of environmental factors in ship motion a wave from east to west with a significant wave height of 3 m is applied a three layer ann with 32 hidden nodes is created for the garson method and two five layer anns with hidden nodes 32 16 and 4 respectively are constructed for the morris and sobol methods to train the ann surrogate model almost 5000 samples are employed the experiment aims to model the ship heading therefore the output of the anns is ship heading and the rest of the parameters as defined in table 1 are the inputs the experiments are conducted in matlab r2018a with a computer equipped with 2 60 ghz i7 6700k cpu and 16 gb ram the two widely used global sa methods morris and sobol are adopted from the safe toolbox pianosi et al 2015 4 1 sensitivity analysis 4 1 1 sensitivity indices of garson method fig 5 shows the obtained garson sa results in the absence of environmental factors the most dominant parameters that show a higher garson value are the rudder and the power of the two thrusters while in the case of environmental factors the most significant factors are rpm of the two thrusters the rudder of the thruster 1 there are two other parameters for which the sensitivity index is greater than 0 05 apart from the two most influential parameters which also indicates significant influence on the model output without environmental factors however there are three other parameters for which the sensitivity index is greater than 0 05 apart from the most important parameters with environmental factors the parameters whose sensitivity index lower than 0 05 exhibit a very low garson sensitivity index indicating negligible impact on model output as shown in fig 5 the garson method detects that most of the parameters have an index of small value 0 05 due to these smaller values it is difficult to distinguish a parameter without any effect on the model output as fig 5 reflects the sensitivity index of environmental factor is zero in the absence of environmental factors however given the environmental factors the sum sensitivity index of the environmental factors wave direction and wave height has reached 0 11 moreover under the influence of environmental factors the position change of the ship has more influence on the heading in addition fig 5 shows that the garson method can identify the impact of environmental factors under the influence of environmental factors in the ship motion based on eq 2 it should be noted that the garson method only works for a three layer neural network this means that for some complicated data the three layer neural network cannot achieve sufficient accuracy which makes garson s calculation results unreliable 4 1 2 sensitivity indices of the morris method as previously described the performance of the morris method should be examined using a different number of trajectories to determine the number of trajectories needed for a robust ordering of the parameters fig 6 and fig 7 summarizes the 10 independent assessments of the morris method each of which has 500 trajectories the x axis and y axis of fig 6 and fig 7 represents the mean of elementary effect μ and standard deviation δ in the absence of environmental factors the highest μ values are found for the yaw velocity another set of parameters with lower values includes the sway velocity and two rudders the test parameter wave direction and wave height which has no effect on the model output is correctly determined as unimportant with zeros for μ and δ in contrast to the results from garson the environmental factors have identical influence 0 to the model output for the model with environmental factors the highest μ values are also found for the roll the force of thruster 1 and the power of thruster 2 both of which have lower sa index follows the test parameters wave direction and wave height have no impact on the output the reason is that in the simulated test the wave direction and wave height are constant but after the normalization the constant variable would be changed to 0 which will be considered no influence on the model output by the morris method according to the classification scheme proposed by sanchez et al 2014 menberg et al 2016 the ratio δ μ allows the model parameters to be characterized by non linear non monotonic or possibly parametric interactions for the model without environmental factors most of the parameters exhibit a ratio δ μ 1 for example the rudder 1 and rudder 2 almost have the same ratio in the non linear area which indicates these two parameters have a greater non linear relationship with heading however in the model with environmental factors almost all the parameters exhibit a ratio very close to 1 which indicates that most of the input parameters exhibit almost monotonic behavior with the interaction of other parameters or both 4 1 3 sensitivity indices of the sobol method the first order sensitivity index si and total order sensitivity index st i of the sobol method in the two ship motion with without environmental factors are illustrated in fig 8 and fig 9 as a measure of the importance of input parameters the first order sensitivity index si identifies that four of the parameters have greater impact on the model output in the ship motion without environmental factors fig 8 sway velocity yaw velocity rudder 2 power of the thruster 1 and power of the thruster 2 when the model output is affected by the environmental factors the first five influential input factors would be roll force of thruster 1 power of the thruster 2 pitch and force of thruster 2 which is shown in fig 9 as a measure of negligible input parameters of model the total order sensitivity index identifies four parameters as important in the model without environmental factors if the threshold is 0 1 sway velocity yaw velocity rudder 2 power of the thruster 1 and power of the thruster 2 but there are 15 important input variables in the model with environmental factors which indicate the model is more complicated with the environmental factors the wave direction and wave height are negligible clearly in both cases from figs 8 and 9 the reason for the influence of wave direction and height under the environmental factors is almost zero is the same with morris both the first order sensitivity index si and total order sensitivity index s t i can be used as the indicator for the input selection generally the ranking of total order sensitivity index st i is similar to the ranking of the first order sensitivity index si the total order sensitivity index is selected as the primary indicator to choose input parameters in contrast to other studies applying the first order sensitivity index for data driven modeling such as xu et al cheng et al 2017 who identify 12 parameters of 27 input parameters as influential with si 0 02 the value of the first order sensitivity index si close to zero indicates that these input parameters have no effect on the model output however they might have influence on the higher order interactions thus these input parameters might not be generally negligible taking the thrust1 force in fig 8 and thrust1 power in fig 9 as an example the first order sensitivity index of the two parameters is very small at the same time the total order sensitivity index is relatively larger which indicates the higher order interactions exist 4 1 4 performance comparison of sa methods table 2 gives detailed information about the ranking of the three sa methods in the two tests the numbers in table 2 represent the ranking order of each variable under different sa methods for example the variable thruster2 power with a value of 1 indicates the most importance among other variables whereas the variables wave direction with a value of 19 represents a minimum impact on the model output we use boldface to emphasize the top five most important variables of all methods in table 2 when compared to the three sa methods in the testing without environmental factors the ranking of the influential parameters has obtained almost good agreement it is worth noting that the garson method still has some inconsistencies with the other two methods such as those parameters thruster2 power rudder 1 the two environmental parameters wave height and wave direction are identified as non important parameters which is consistent with the three sa methods compared with the three sa methods in the ship motion with environmental factors only the morris method can rank the parameters in almost the same order as the sobol method however the performance of the garson method is decreased compared to the other two methods morris sobol as this local method is not capable of addressing information in this complex test an interesting finding of the testing with environmental factors is that the rankings of the environmental parameters wave direction and wave height of the three methods are very close the parameter ranking of the morris method and the total order effects of sobol is almost the same for most of the parameters in the two data sets which can be explained by a similar model of parameter variation in the sample matrix for calculation and both methods are intended to identify non influential parameters in addition a very interesting finding is that the difference between the st i sensitivity index of each parameter and the difference between the μ value of the morris method is very similar for almost all parameters the presence of higher order effects observed in the si and st i indices is also consistent with the high values of the standard deviation δ found by the morris method only the wave factors wave direction and height are investigated in the data driven modeling of ship motion the two tests with without environmental factors used in the analysis presented in this paper are both based on sensor data sets of offshore operations however ship motion is affected by several environmental factors like winds and currents using such a data set may result in incomplete experimental results in a future study it would be meaningful to apply a more complex and sophisticated data set of ship motion to investigate whether the sobol or morris methods can identify and rank the parameters in the similar order 4 1 5 structure optimization of ann to verify that our proposed method can be used to optimize the model structure and to understand the influence of different sa methods we investigate how the input number affect the model output in terms of mean square error the neural network is re constructed using the first 5 10 15 and 20 most influential input parameters which are selected by the three sa methods each comparison is repeated five times to ensure the predictive convergence the average comparative result is illustrated in table 3 minimum error for the three methods appears when the number of input parameters is 15 in both cases that is with and without environmental factors this indicates that the 15 most influential factors are good enough for ship heading modeling in addition the morris method show superior performance than the other two methods regardless of the number of input in either cases 4 2 uncertainty estimation as mentioned the input parameters have its initial conditions and certain ranges in the analysis of traditional mathematical models in this paper we characterize the uncertainty of each input parameter by varying all input parameters from their minimum value to their maximum value with uniform distribution next the latin hyper cube sampling lhs method is employed to generate inputs according to the distributions and then the well trained surrogate model would be used to generate model outputs throughout numerous iterations the underlying uncertainties would be represented by the distribution of model outputs based on eq 11 and eq 12 the uncertainties of the 20 input parameters in the two ship motion data sets e g with without environmental factors are depicted in fig 10 in the cases of without environmental factors the input parameters sway velocity yaw velocity and two rudders are significant uncertainty to the heading while in the case of environmental factors the five most uncertain parameters are sway velocity yaw velocity thruster1 rpm thruster2 force and roll when there are no environmental factors only a few input parameters have uncertain impact on the ship heading when the environmental factors exist roll and force and rpm of the two thrusters have significant uncertainty to the heading fig 11 and fig 12 represents the uncertainty of the first six input parameters it can be seen from fig 10 that the propulsion parameters bring more un certainty to the heading than those without environmental factors for example these parameters thruster1 percent thruster1 rpm thruster2 force thruster2 percent thruster1 rpm and thruster2 power are higher another noteworthy thing is that the uncertainty of the wave is not obvious but the uncertainty of the roll has changed considerably compared to the situation without the environment moreover the direction of wave is from west to east and the ship s heading angle is from south to north so we can conclude that the uncertainty of the wave is reflected in the roll the reason it is impossible to get the uncertainty directly from the wave data itself is that the wave is a constant in this experiment and the constant value is often recognized to be very small by the cdf based algorithm to investigate the uncertainty of the input parameters selected by the three sa methods we further compare the model output distribution with the first five important parameters removed and the model distribution of all parameters in two datasets fig 13 and fig 14 represent the comparison of distribution of model output in the two datasets with and without environmental factors in this paper the range of ship heading is from 200 to 200 in order to better compare the heading changes in this interval the pdf plot shows only this range while the cdf plot shows the whole output range for each method from the pdf of fig 13 we can see that the five most important parameters selected by the morris method can bring the greatest uncertainty to the model the uncertainty of the garson method and the sobol method in this data set is almost identical from the cdf in fig 13 the same conclusion can be obtained as well from fig 14 the variation of pdf of the three methods is significant it is difficult to analyze the uncertainty of each method just from the pdf alone but from the cdf in fig 14 it is very clear that garson s cdf coincides with that of the full parameters model the greatest uncertainty can be found from the morris method by calculating the distance between it and the model output of full parameters even though the cdf of sobol and morris vary significantly 5 conclusion the paper proposed a framework of sensitivity and uncertainty analysis for ship motion data aiming at the consistent and robust identification of important parameters the framework consists of four components data purification surrogate modeling sensitivity and uncertainty analysis methods and result representation the proposed framework is flexible for surrogate modeling and sensitivity and uncertainty analysis to illustrate the performance of the proposed framework three sa methods garson morris and sobol with increasing computational complexity are compared in two ship motion data sets with and without environmental factors the three sa methods were conducted on the basis on an ann model which is built on the basis of the sensor data of ship motion the paper demonstrated that the morris method has almost identical ranking and identification with the sobol method in both data sets the garson method achieves almost the same ranking with the other two methods in the testing of without environmental factors but in the testing with environmental factors the difference of importance ranking becomes larger the reason for this may be that the system become more complicated in the presence of environmental factors and the garson method may not be able to handle this non linear characteristic considering the computational complexity and the ranking of parameters the morris method is highly recommended to build a compact data driven ship motion model to determine the high degree of uncertainties of a data driven ship motion model constructed on the basis of sensor data pdf based and cdf based uncertainty analysis methods are employed the cdf based method is employed to quantify the uncertainty the combination of the cdf based and pdf based methods is used to evaluate the uncertainty of the group of parameters selected by the sa methods the comparison of the three widely used sa methods can provide us a descriptive example of the proposed framework the comparative results of the three methods provided in this study also can support the assessment and interpretation of the results this study further shows that the choice of dataset affects the output of all three applied sa methods mainly in terms of rankings the above conclusions are highly depending on the data and the conclusion could be different for another dataset acknowledgment this work was supported in part by the project sfi move and digital twins for vessel life cycle service project no 237929 and 280703 and in part by the national natural science foundation of china u1509207 the author xu cheng would like to thank the sponsorship of the chinese scholarship council for funding his research at norwegian university of science and technology the authors would like to thank the technical support from offshore simulator centre as 
22881,to build a compact data driven ship motion model for offshore operations that require high control safety it is necessary to select the most influential parameters and to analyze the uncertainty of the input parameters this paper proposes a framework of uncertainty and sensitivity analysis for ship motion data the framework consists of four components data cleaning surrogate model sensitivity and uncertainty analysis and results visualization data cleaning focuses on the removal of noise and necessary transformation for the easy analysis an artificial neural network ann based surrogate model is constructed on the basis of cleaned ship motion data the sensitivity and uncertainty analysis would be performed on the sample or weights which the ann based surrogate model generated the result of the sensitivity and uncertainty analysis can be beneficial to the optimization of data driven ship motion models three distinctive sensitivity analysis sa methods garson morris sobol and pdf based and cdf based uncertainty methods are investigated in two types of ship motion datasets with and without environmental factors the experimental results also demonstrate the proposed framework can be applied to estimate the sensitivity and uncertainty in different datasets keywords data driven uncertainty analysis sensitivity analysis ship motion offshore operations 1 introduction with the rapid development of the offshore industry the requirements for ship operations are increasing offshore operations are complex and hazardous due to the significant uncertainties and various operating conditions it is necessary to consider the accuracy of ship positioning and heading limited working space and collision avoidance between ships and floating structures li et al 2015 operational safety is the major issue and is easily challenged by harsh marine environments complex geological conditions and human and equipment factors operations around the oil drilling platform require very careful maneuvering of ships near the target and collision avoidance in designated areas and maneuvering in the limited space does not demand a fast approach but requires a high degree accuracy of positioning and heading thus establishing a suitable ship motion model for offshore operations is necessary to get a suitable model of ship motion in offshore operations the conventional method is to employ the mathematical modeling fossen 2002 however it is not an easy task to model the ship motion during the offshore operations because the model should be nonlinear dynamic over time and coupling with environmental factors like currents waves and wind which are random and unpredictable thus the conventional model based solutions which require an in depth knowledge of the offshore operations are impractical for complicated offshore operations with the wide deployment of sensors on ships it is possible to collect ship motion data and establish data based models the greatest challenge of data driven modeling for offshore operations is that environmental factors such as the current wave and wind tend to influence them the high uncertainty of environmental factors increases the difficulty of modeling thus studying the influence of environmental factors on the data based models stands to vastly improve safety as well as profit margins however to the best knowledge of the authors related researches on the impact of environmental factors on data driven modeling is still rare on the other hand there are also some other challenges for the data driven modeling for offshore operations 1 the sensor data used to be modelled are usually too large and high dimensional 2 they usually contain measurement induced noise redundant information and human factors which makes it difficult to use them for accurate analysis 3 it is not intuitive to interpret the data from multiple sensors as an aspect of uncertainty quantification the sensitivity analysis is defined as the investigation of how the uncertainty of the model output is apportioned to different sources of uncertainty in the model input factors saltelli 2002 sa is useful for obtaining reliable results and valuable information and increases the credibility of model results campolongo et al 2007 saltelli et al 2008 sa has been widely used for maritime applications with different purposes mainly including assessing the uncertainty calibrating the model and making robust decisions a derivative based sa is used to simplify the three layer structure of nonlinear autoregressive exogenous narx neural network for ship motion prediction li et al 2017 to construct a compact data driven ship motion prediction model zhang et al utilized the sum of square derivatives ssd to choose the inputs for the nonlinear autoregressive model with exogenous inputs narmax zhang and liu 2014 panagiotis proposed an sa to investigate various performance parameters affecting ship propulsion and maneuverability mizythras et al 2016 the influence of hydrodynamic coefficients on the maneuverability of submersibles is examined using sa on the basis of sea trials dong and rhee 2006 to study the influence of hydrodynamic coefficients for a four dof mathematical ship model an sa is performed on the basis of simulated data wang et al 2014 to determine the effect of the hydrodynamic derivatives on kvlcc2 maneuverability sa is conducted on the abkowitz type mathematical model kim et al 2017 uncertainty analysis of the circular motion test data was presented in ueno et al 2009 to investigate the hydrodynamic characteristics of ship maneuvering belenky et al provided a statistical uncertainty of ship motion data belenky et al 2015 although sa methods have been widely used in the analysis of mathematical models in the field of marine engineering no scheme has emerged that explains the uncertainty and sensitivity analysis of data driven models in this field our ongoing project aims to develop intelligent systems to support decision making for various maritime operations a new integrated platform including data analysis tools and data driven modeling technique is designed to serve the maritime industry by improving operational efficiency and safety in this paper we focus on the design of framework of uncertainty and sensitivity analysis for ship motion data in offshore operations to overcome the challenges of data driven modeling we first clean the raw data because sa methods cannot be applied to the sensor data directly a surrogate model is constructed uncertainty and sensitivity analysis is then performed on the basis of surrogate model to investigate the performance of the proposed framework three sa methods are compared in terms of importance ranking of the input parameters on two ship motion datasets with and without environmental factors the main contributions of this paper are first it proposes a novel uncertainty and sensitivity analysis framework making the sa methods be applicable to the analysis of ship motion datasets second it investigates the performance of different sa methods on different ship motion datasets in offshore operations the rest of the paper is organized as follows section 2 introduces the proposed framework for sensitivity and uncertainty analysis the methods to quantify the sensitivity and uncertainty are described in section 3 the proposed framework is examined in section 4 on the two ship motion datasets with and without environmental factors and the uncertainty analysis is provided after the sensitivity analysis finally discussion and conclusions are given 2 analysis of uncertainty and sensitivity on ship motion data this section introduces 1 the proposed system framework for sensitivity and uncertainty analysis 2 the source of sensor data data pre processing algorithm and the case ship 3 data driven surrogate modeling methods and 4 the concept of sensitivity and uncertainty and the working flow of the proposed framework 2 1 system framework a framework that integrates surrogate modeling technique uncertainty and sensitivity analysis methods to perform the sensitivity and uncertainty analysis is proposed the whole framework consists of four components data cleaning surrogate modeling sensitivity methods and results analysis which is depicted in fig 1 first the raw sensor data should be cleaned to minimize the effect of noisy and redundant information second surrogate based also called meta based methods offer an analytic approach to construct a mathematical model or prediction model from those sensor data third taking advantage of the surrogate model various uncertainty and sensitivity analysis methods can be performed for comparison study our framework is flexible such that we can employ surrogate models and sa methods to calculate the sensitivity and uncertainty results finally the sensitivity and uncertainty results can be employed to optimize the surrogate structure as the feedback arrow shown in fig 1 2 2 data source and data pre processing the offshore simulator centre as osc is an advanced training platform for offshore operation personnel the osc is developed by the norwegian university of science and technology ntnu and other research partners from the industry world osc has very powerful physical engine that can produce wind and waves that are almost the same as the real environment offshore simulator centre fig 2 shows the case ship equipped with two propellers with rudders and two tunnel thrusters at the stern and two tunnel thrusters at the bow the first step for analysis of sensitivity and uncertainty is to obtain a starting subset and to focus on specific parameters selecting those parameters is highly subjective which is based on the expert knowledge of the authors and a broad literature research in this context two data modules are monitored and stored the ship status module and the environment module as shown in table 1 considering that the original raw data may contain noisy discontinuous and redundant information it is necessary to clean up the data to minimize its impact on further analysis and modeling li et al 2016 noise reduction is always the first step in data cleaning which statistical estimation or median filtering methods could be utilized due to the physical definition there would be some jumping phenomenons in sensor data for example the definition of roll angle yaw angle and pitch angle is within 0 360 when the angle changes near the border the jumping phenomenon would occur inevitably to get rid of this type of discontinuity the algorithm is employed which is defined in our previous paper li et al 2016 to determine the effect of rudders it is necessary to make some transformations to obtain correct estimation in this paper the effect of rudder is transformed to the lift force and the calculation of the force is adopted from lindegaard and fossen 2003 in addition in order to accelerate the convergence speed of training and improve the accuracy of data driven surrogate model it is necessary to normalize all parameters the equation for normalizing all the parameters is shown in eq 1 1 x ˆ x μ x δ x ε where μ x denotes the mean of x δ x represents the variance of x ε is a very small value that makes the calculation possible when x is a constant to synchronize these data with different sampling frequency this paper also considers re sampling the data 2 3 data driven surrogate modeling method the process in nature usually can be simulated using some mathematical models the input of the model f describes the material properties external loads boundary conditions initial conditions etc tripathy and bilionis 2018 so that the model can describe complex natural behavior the input dimension is usually very large and may be hundreds or thousands it is feasible to construct a surrogate model that can reduce the computational burden of the original model while not sacrificing the accuracy the surrogate model can be considered as model of model the concept of a surrogate model is using a cheaper model to replace the original model fig 3 shows the concept of the surrogate model which can be built from the observed data of natural processes from the given input parameters of the natural process the mathematical model could be constructed which then yield the relevant data if the mathematical model is hard to build but only the measured data is available a surrogate model could be constructed to understand the underlying characteristics of the natural process this is also one of the objectives of machine learning samuel 1959 observed data whether from mathematical models or surrogate models can be applied to understand natural processes assuming there are n collected points which are formulated as f x y x is an n d matrix which can be represented by x x1 x2 xd y is the corresponding response the surrogate model y ˆ f ˆ x can be built to approximate the underlying relationship of collected data the widely used data driven models such as kriging kleijnen 2007 gaussian process oakley and o hagan 2004 the radial basis function todri et al 2014 support vector machine svm zhang et al 2017a ann model guevara et al 2015 and the deep learning model tripathy and bilionis 2018 can be effectively used for the construction of a surrogate model from measured data in our proposed framework in this paper the ann model is chosen as the surrogate model as shown in fig 1 to get the best structure of ann many optimization approaches such as genetic algorithm ga and particle swarm optimization pso can be used furthermore ann also can be employed to compute the sensitivity of input factors on the basis of the weight of the neurons in different layers in fig 1 the weights is used for the ann based sensitivity analysis e g garson the ann samples would be employed by performing global sensitivity analysis such as morris and sobol 2 4 sensitivity and uncertainty analysis the main purpose of the sa is to quantify the importance of all uncertain input parameters to a considered output in general sa methods can be roughly divided into local methods lsa which calculate quickly but only explore some sample points selected by users in the input space and the global method gsa of checking the influence of uncertain parameters on the whole parameter range pianosi et al 2016 the lsa and gsa have their own advantages and disadvantages and application areas the lsa which is computationally efficient is more applicable to the linear models while the gsa which is time consuming can be applied to both linear and nonlinear models both lsa and gsa can be used in this proposed framework according to different applications the results of sa are helpful for the removal of the less relevant inputs and optimizing the model structure fock 2014 uncertainty analysis is an important and necessary step for the data driven models usually there are two types of uncertainties aleatoric uncertainty and epistemic uncertainty li and mahadevan 2016 aleatoric uncertainty is often caused by the imprecise measurement in the data and epistemic uncertainty is caused by the parameter of the model first this paper focuses on the uncertainty caused by each input parameter second this paper also aims at the uncertainty analysis of the set of input parameters selected by the sa methods the process of the framework is as follows 1 cleaning the raw ship sensor data using the algorithm described in section 2 2 2 training the ann using the cleaned sensor data 3 generating the ann samples and obtaining the ann weights 4 calculating the sensitivity of different methods which is introduced in section 3 finally the sensitivity indices can help to improve the performance of the surrogate model 3 quantification of sensitivity and uncertainty the paper mainly introduces three types of sa methods with different computational time garson morris and sobol the garson method belongs to the lsa which is highly efficient it is a widely used method of sa in data based applications that is computed through the connection of different layers the morris method belongs to the gsa which means it has a medium computational burden it provides a qualitative ranking of the parameters that are based on their effect on the output of the model vanuytrecht et al 2014 the morris method provides a compromise scheme and represents a suitable gsa method for those computationally intensive models with large input parameters the sobol method belongs to the gsa which is computationally expensive the variance based sensitivity methods are also very popular for data driven applications in the literature fock 2014 fernández navarro et al 2017 3 1 garson the garson method is a special type of lsa that can be very useful to analyze the structure of ann which employs the connected weights of ann to calculate the sensitivity of each input parameter garson 1991 it can provide a quick and informative understanding of how the ann output can be attributed to its input parameters concretely the sensitivity of the i th uncertain input parameter to the k th output can be defined as follows 2 s i k j 1 l ω i j υ j k r 1 n ω r j r 1 n j 1 l ω i j υ j k r 1 n ω r j where s ik represents the sensitivity of the i th uncertain input to the k th output n and l are the number of the neurons in the input and hidden layer ω ij is the weight of the i th neuron in input layer and the j th neuron in the hidden layer υ jk is the weight of the j th neuron in the hidden layer and the k th neuron in the output layer 3 2 morris morris also known as elementary effect ee is a commonly used gsa and is usually used to identify the important uncertain input parameters in high dimensional models rather than to quantify sensitivity exactly saltelli et al 2008 song et al 2015 for a given model f x with n independent input parameters x 1 x 2 x n the morris sensitivity index of i th uncertain input parameter is defined as 3 e e i f x 1 x 2 x i δ x i δ 1 x n f x δ from the definition of equation 3 the one at a time oat design is employed to implement the global characteristic of morris the oat design should be repeated n times to measure the sensitivity the mean μ and standard deviation δ are used which can be computed by equation 4 4 μ i 1 n j 1 n e e i j δ i 1 n 1 j 1 n e e i j 1 n j 1 n e e i j in which ee i j is the elementary effect for input i using the j th base sample point the morris method uses the μ to estimate the significant effect on the output and uses the δ to estimate the non linearity and interactions between inputs if μ i is close to zero it indicates the parameter i is non influential if δ i is large this indicates the parameter i has a nonlinear effect on output or that interactions with other parameters exist 3 3 sobol the sobol method estimates the importance of uncertain input parameter on the basis of variance decomposition which has been widely used in many disciplines saltelli et al 1999 assuming the model form is f x f x 1 x m where x x 1 x m represents the model input which contains m independent parameters based on the theory of sobol saltelli and sobol 1995 the model output can be decomposed by different effects which is shown as follows 5 f x f 0 i 1 m f i x i 1 i j m f i j x i x j f 1 2 m x 1 x 2 x m some literature li et al 2002 2006 have argued that only the lower order terms are important so this paper considers only the two higher orders eq 5 can be re written as follows 6 f x f 0 i 1 m f i x i 1 i j m f i j x i x j assume the f x is square integrable squaring eq 6 and integrating over the input space the following equation can be obtained 7 f 2 x d x f 0 2 i 1 m f i 2 x i 1 i j m f i j 2 x i x j the left part in eq 7 is called the total variance 8 v f 2 x d x f 0 2 the right part in eq 7 is called the partial variance 9 v i i 1 m f i 2 x i v i j 1 i j m f i j 2 x i x j generally the global sensitivity index would be described by the ratio of partial variance and total variance zhang et al 2017b the first order main effect and total order sensitivity index for the i th variable x i can be defined by 10 s i v i v s t i 1 v i v the first order and total order sensitivity index are widely used in sobol if the value of total first order sensitivity index is close to zero the parameter can be considered to be non important 3 4 uncertainty analysis method the common way of quantifying uncertainty is to estimate the probability distribution function pdf tripathy and bilionis 2018 and cumulative distribution function cdf pianosi and wagener 2015 although current researches either focus on pdf or cdf the proposed framework takes advantages of both methods so that it can quantify the uncertainty of input parameters in two different perspectives assuming the group of input parameter x i of the data driven model is not known exactly the unconditional cumulative distribution function and probability distribution function of the model output are expressed as f y y and f y y when the group of input parameter x i is removed or is kept fixed the cumulative distribution function and probability distribution function of the model output then can be represented as f y xi y and f y xi y the distance df and df between f y y f y y and f y xi y f y xi y accounts for the uncertainty of a set of parameters x i which can be described as follows 11 d f x i f y y f y x i y 12 d f x i f y y f y x i y 3 5 detail algorithm description the algorithm used to investigate this research is illustrated in fig 4 first the ship sensor data would be cleaned using the methods as described in section 2 2 second the ann would be built on the basis of the training set and the model would be validated by three standard evaluation measurements mean absolute percentage error mape variance of absolute percentage error vape and root mean square error rmse if the testing results are not as expected the ann model will need to retrain to achieve the specified accuracy third the garson sensitivity index would be calculated on the basis of the coefficient of different layers of ann the morris and sobol methods would be computed by the ann samples finally in describing the model output uncertainty the importance of the input parameters of each sa method is quantified by sorting them in descending order 4 experiment in this section we present the sensitivity and uncertainty analysis on two type of datasets of random maneuvering with and without environment factors for simplicity the two datasets only record simple maneuvers in offshore operations in which only the two main thrusters as depicted in fig 2 are used to control ship motion in the dataset without environmental effect the surge sway and yaw velocity are within the range of 0 6 9 m s 0 63 0 44 m s and 2 57 2 64 deg s respectively these velocities in the other dataset are slightly different ranging within 0 45 7 3 m s 1 36 0 47 m s and 3 58 3 deg s respectively to investigate the influence of environmental factors in ship motion a wave from east to west with a significant wave height of 3 m is applied a three layer ann with 32 hidden nodes is created for the garson method and two five layer anns with hidden nodes 32 16 and 4 respectively are constructed for the morris and sobol methods to train the ann surrogate model almost 5000 samples are employed the experiment aims to model the ship heading therefore the output of the anns is ship heading and the rest of the parameters as defined in table 1 are the inputs the experiments are conducted in matlab r2018a with a computer equipped with 2 60 ghz i7 6700k cpu and 16 gb ram the two widely used global sa methods morris and sobol are adopted from the safe toolbox pianosi et al 2015 4 1 sensitivity analysis 4 1 1 sensitivity indices of garson method fig 5 shows the obtained garson sa results in the absence of environmental factors the most dominant parameters that show a higher garson value are the rudder and the power of the two thrusters while in the case of environmental factors the most significant factors are rpm of the two thrusters the rudder of the thruster 1 there are two other parameters for which the sensitivity index is greater than 0 05 apart from the two most influential parameters which also indicates significant influence on the model output without environmental factors however there are three other parameters for which the sensitivity index is greater than 0 05 apart from the most important parameters with environmental factors the parameters whose sensitivity index lower than 0 05 exhibit a very low garson sensitivity index indicating negligible impact on model output as shown in fig 5 the garson method detects that most of the parameters have an index of small value 0 05 due to these smaller values it is difficult to distinguish a parameter without any effect on the model output as fig 5 reflects the sensitivity index of environmental factor is zero in the absence of environmental factors however given the environmental factors the sum sensitivity index of the environmental factors wave direction and wave height has reached 0 11 moreover under the influence of environmental factors the position change of the ship has more influence on the heading in addition fig 5 shows that the garson method can identify the impact of environmental factors under the influence of environmental factors in the ship motion based on eq 2 it should be noted that the garson method only works for a three layer neural network this means that for some complicated data the three layer neural network cannot achieve sufficient accuracy which makes garson s calculation results unreliable 4 1 2 sensitivity indices of the morris method as previously described the performance of the morris method should be examined using a different number of trajectories to determine the number of trajectories needed for a robust ordering of the parameters fig 6 and fig 7 summarizes the 10 independent assessments of the morris method each of which has 500 trajectories the x axis and y axis of fig 6 and fig 7 represents the mean of elementary effect μ and standard deviation δ in the absence of environmental factors the highest μ values are found for the yaw velocity another set of parameters with lower values includes the sway velocity and two rudders the test parameter wave direction and wave height which has no effect on the model output is correctly determined as unimportant with zeros for μ and δ in contrast to the results from garson the environmental factors have identical influence 0 to the model output for the model with environmental factors the highest μ values are also found for the roll the force of thruster 1 and the power of thruster 2 both of which have lower sa index follows the test parameters wave direction and wave height have no impact on the output the reason is that in the simulated test the wave direction and wave height are constant but after the normalization the constant variable would be changed to 0 which will be considered no influence on the model output by the morris method according to the classification scheme proposed by sanchez et al 2014 menberg et al 2016 the ratio δ μ allows the model parameters to be characterized by non linear non monotonic or possibly parametric interactions for the model without environmental factors most of the parameters exhibit a ratio δ μ 1 for example the rudder 1 and rudder 2 almost have the same ratio in the non linear area which indicates these two parameters have a greater non linear relationship with heading however in the model with environmental factors almost all the parameters exhibit a ratio very close to 1 which indicates that most of the input parameters exhibit almost monotonic behavior with the interaction of other parameters or both 4 1 3 sensitivity indices of the sobol method the first order sensitivity index si and total order sensitivity index st i of the sobol method in the two ship motion with without environmental factors are illustrated in fig 8 and fig 9 as a measure of the importance of input parameters the first order sensitivity index si identifies that four of the parameters have greater impact on the model output in the ship motion without environmental factors fig 8 sway velocity yaw velocity rudder 2 power of the thruster 1 and power of the thruster 2 when the model output is affected by the environmental factors the first five influential input factors would be roll force of thruster 1 power of the thruster 2 pitch and force of thruster 2 which is shown in fig 9 as a measure of negligible input parameters of model the total order sensitivity index identifies four parameters as important in the model without environmental factors if the threshold is 0 1 sway velocity yaw velocity rudder 2 power of the thruster 1 and power of the thruster 2 but there are 15 important input variables in the model with environmental factors which indicate the model is more complicated with the environmental factors the wave direction and wave height are negligible clearly in both cases from figs 8 and 9 the reason for the influence of wave direction and height under the environmental factors is almost zero is the same with morris both the first order sensitivity index si and total order sensitivity index s t i can be used as the indicator for the input selection generally the ranking of total order sensitivity index st i is similar to the ranking of the first order sensitivity index si the total order sensitivity index is selected as the primary indicator to choose input parameters in contrast to other studies applying the first order sensitivity index for data driven modeling such as xu et al cheng et al 2017 who identify 12 parameters of 27 input parameters as influential with si 0 02 the value of the first order sensitivity index si close to zero indicates that these input parameters have no effect on the model output however they might have influence on the higher order interactions thus these input parameters might not be generally negligible taking the thrust1 force in fig 8 and thrust1 power in fig 9 as an example the first order sensitivity index of the two parameters is very small at the same time the total order sensitivity index is relatively larger which indicates the higher order interactions exist 4 1 4 performance comparison of sa methods table 2 gives detailed information about the ranking of the three sa methods in the two tests the numbers in table 2 represent the ranking order of each variable under different sa methods for example the variable thruster2 power with a value of 1 indicates the most importance among other variables whereas the variables wave direction with a value of 19 represents a minimum impact on the model output we use boldface to emphasize the top five most important variables of all methods in table 2 when compared to the three sa methods in the testing without environmental factors the ranking of the influential parameters has obtained almost good agreement it is worth noting that the garson method still has some inconsistencies with the other two methods such as those parameters thruster2 power rudder 1 the two environmental parameters wave height and wave direction are identified as non important parameters which is consistent with the three sa methods compared with the three sa methods in the ship motion with environmental factors only the morris method can rank the parameters in almost the same order as the sobol method however the performance of the garson method is decreased compared to the other two methods morris sobol as this local method is not capable of addressing information in this complex test an interesting finding of the testing with environmental factors is that the rankings of the environmental parameters wave direction and wave height of the three methods are very close the parameter ranking of the morris method and the total order effects of sobol is almost the same for most of the parameters in the two data sets which can be explained by a similar model of parameter variation in the sample matrix for calculation and both methods are intended to identify non influential parameters in addition a very interesting finding is that the difference between the st i sensitivity index of each parameter and the difference between the μ value of the morris method is very similar for almost all parameters the presence of higher order effects observed in the si and st i indices is also consistent with the high values of the standard deviation δ found by the morris method only the wave factors wave direction and height are investigated in the data driven modeling of ship motion the two tests with without environmental factors used in the analysis presented in this paper are both based on sensor data sets of offshore operations however ship motion is affected by several environmental factors like winds and currents using such a data set may result in incomplete experimental results in a future study it would be meaningful to apply a more complex and sophisticated data set of ship motion to investigate whether the sobol or morris methods can identify and rank the parameters in the similar order 4 1 5 structure optimization of ann to verify that our proposed method can be used to optimize the model structure and to understand the influence of different sa methods we investigate how the input number affect the model output in terms of mean square error the neural network is re constructed using the first 5 10 15 and 20 most influential input parameters which are selected by the three sa methods each comparison is repeated five times to ensure the predictive convergence the average comparative result is illustrated in table 3 minimum error for the three methods appears when the number of input parameters is 15 in both cases that is with and without environmental factors this indicates that the 15 most influential factors are good enough for ship heading modeling in addition the morris method show superior performance than the other two methods regardless of the number of input in either cases 4 2 uncertainty estimation as mentioned the input parameters have its initial conditions and certain ranges in the analysis of traditional mathematical models in this paper we characterize the uncertainty of each input parameter by varying all input parameters from their minimum value to their maximum value with uniform distribution next the latin hyper cube sampling lhs method is employed to generate inputs according to the distributions and then the well trained surrogate model would be used to generate model outputs throughout numerous iterations the underlying uncertainties would be represented by the distribution of model outputs based on eq 11 and eq 12 the uncertainties of the 20 input parameters in the two ship motion data sets e g with without environmental factors are depicted in fig 10 in the cases of without environmental factors the input parameters sway velocity yaw velocity and two rudders are significant uncertainty to the heading while in the case of environmental factors the five most uncertain parameters are sway velocity yaw velocity thruster1 rpm thruster2 force and roll when there are no environmental factors only a few input parameters have uncertain impact on the ship heading when the environmental factors exist roll and force and rpm of the two thrusters have significant uncertainty to the heading fig 11 and fig 12 represents the uncertainty of the first six input parameters it can be seen from fig 10 that the propulsion parameters bring more un certainty to the heading than those without environmental factors for example these parameters thruster1 percent thruster1 rpm thruster2 force thruster2 percent thruster1 rpm and thruster2 power are higher another noteworthy thing is that the uncertainty of the wave is not obvious but the uncertainty of the roll has changed considerably compared to the situation without the environment moreover the direction of wave is from west to east and the ship s heading angle is from south to north so we can conclude that the uncertainty of the wave is reflected in the roll the reason it is impossible to get the uncertainty directly from the wave data itself is that the wave is a constant in this experiment and the constant value is often recognized to be very small by the cdf based algorithm to investigate the uncertainty of the input parameters selected by the three sa methods we further compare the model output distribution with the first five important parameters removed and the model distribution of all parameters in two datasets fig 13 and fig 14 represent the comparison of distribution of model output in the two datasets with and without environmental factors in this paper the range of ship heading is from 200 to 200 in order to better compare the heading changes in this interval the pdf plot shows only this range while the cdf plot shows the whole output range for each method from the pdf of fig 13 we can see that the five most important parameters selected by the morris method can bring the greatest uncertainty to the model the uncertainty of the garson method and the sobol method in this data set is almost identical from the cdf in fig 13 the same conclusion can be obtained as well from fig 14 the variation of pdf of the three methods is significant it is difficult to analyze the uncertainty of each method just from the pdf alone but from the cdf in fig 14 it is very clear that garson s cdf coincides with that of the full parameters model the greatest uncertainty can be found from the morris method by calculating the distance between it and the model output of full parameters even though the cdf of sobol and morris vary significantly 5 conclusion the paper proposed a framework of sensitivity and uncertainty analysis for ship motion data aiming at the consistent and robust identification of important parameters the framework consists of four components data purification surrogate modeling sensitivity and uncertainty analysis methods and result representation the proposed framework is flexible for surrogate modeling and sensitivity and uncertainty analysis to illustrate the performance of the proposed framework three sa methods garson morris and sobol with increasing computational complexity are compared in two ship motion data sets with and without environmental factors the three sa methods were conducted on the basis on an ann model which is built on the basis of the sensor data of ship motion the paper demonstrated that the morris method has almost identical ranking and identification with the sobol method in both data sets the garson method achieves almost the same ranking with the other two methods in the testing of without environmental factors but in the testing with environmental factors the difference of importance ranking becomes larger the reason for this may be that the system become more complicated in the presence of environmental factors and the garson method may not be able to handle this non linear characteristic considering the computational complexity and the ranking of parameters the morris method is highly recommended to build a compact data driven ship motion model to determine the high degree of uncertainties of a data driven ship motion model constructed on the basis of sensor data pdf based and cdf based uncertainty analysis methods are employed the cdf based method is employed to quantify the uncertainty the combination of the cdf based and pdf based methods is used to evaluate the uncertainty of the group of parameters selected by the sa methods the comparison of the three widely used sa methods can provide us a descriptive example of the proposed framework the comparative results of the three methods provided in this study also can support the assessment and interpretation of the results this study further shows that the choice of dataset affects the output of all three applied sa methods mainly in terms of rankings the above conclusions are highly depending on the data and the conclusion could be different for another dataset acknowledgment this work was supported in part by the project sfi move and digital twins for vessel life cycle service project no 237929 and 280703 and in part by the national natural science foundation of china u1509207 the author xu cheng would like to thank the sponsorship of the chinese scholarship council for funding his research at norwegian university of science and technology the authors would like to thank the technical support from offshore simulator centre as 
22882,in previous study chen et al 2018 performances of a fixed pitch and a sinusoidal pitch h darrieus vertical axis turbine vat are compared by numerical simulations with an appropriate amplitude of sinusoidal pitching the power efficiency could be improved by 33 and the fluctuation in power output rotation speed and shaft torque are suppressed meanwhile in this study to reduce the hydrodynamic resistant torque the original sinusoidal pitching is modified to keep the pitch angle at zero or at a small initial angle in the downstream half of rotation cycle numerical simulation results show this modification increases power efficiency by 20 over that of an original sinusoidal pitch turbine furthermore systemically study confirms that as rotational inertia of rotor increases the power coefficient and tip speed ratio do not change much and the fluctuation in output torque can be dramatically reduced however a very large rotational inertia turbine would perform very poor unless the rotor be accelerated over a threshold speed with exterior assistance keywords vertical axis hydrokinetic turbine variable pitch rotational inertia numerical simulation 1 introduction the density of water is eight hundred times of that of air even though the water velocity is much less than the wind speeds the density of hydrokinetic power still could be an order of magnitude higher than that of wind power the hydrokinetic turbine could be much smaller than a wind turbine at same capacity level this is good because especially for a horizontal axis hydrokinetic turbine the size of the rotor is limited by the water depth nowadays the rotor s diameter of a typical megawatt level horizontal axis tidal turbine is usually smaller than 20 m for example the 16 m diameter rotor of sr2000 turbine of scotrenewables power orbital marine power ltd 2019 and the 20 m diameter rotor of seagen s 2 mw turbine jackson and persoons 2012 etc although no megawatt level vertical axis hydrokinetic turbine has been deployed so far to achieve the same capacity level with a horizontal axis turbine the size of a vat s rotor should be similar to that of a horizontal axis rotor because the power coefficients of them are in fact at the same level with the much smaller rotor size the structural problems in connection with large vertical axis wind turbine are diminished in the case of vertical axis hydrokinetic turbine this makes the latter an optional choice in the area of river and tidal current energy exploitation from the viewpoint of fluid dynamics the biggest difference between vats in wind and hydrokinetic current application lies in the tip speed ratios the optimal tip speed ratio of the former typically ranges from 4 to 6 whilst for latter it should be less than 2 5 to avoid serious cavitation effect as suggested by salter 2005 nevertheless apart from well known advantages of vat such as insensitive to flow direction changing and transmitting shaft torque directly above the water surface the problems of vat including relative lower overall efficiency shaking in operation due to continuously changing fluid dynamic forces as the turbine rotates poor self start performance etc are still need to be coped with kirke and lazauskas 2008 summarized the advantages and problems of vertical axis water turbines and commented on possible solutions to these problems they concluded that variable pitch have effects on almost all the problems especially it produce high starting torque and meanwhile maintain high peak efficiency whilst other solutions are less comprehensive for example using helical blades can eliminate shaking but cannot produce high starting torque the mechanisms for achieving variable pitch variation fall into two categories the first is passive pitch or so called self acting pitch in this case the blades are pitching around their pivots driven by fluid dynamic forces another one is active or forced pitch the blades are forced to pitch according to some predetermined schedule passive pitch is simple in mechanism hence is much easier to apply and is regard as more reliable in operational environment the kobold turbine has employed passive pitch control coiro et al 2005 but there are abrupt changes of pitch angle near downstream upstream transition points at the flight path of blades this could lead to structure fatigue in long term operation countermeasures such as using additional mass blocks or fluid dynamic forces to provide stabilizer moments are taken to smooth the pitch variation assessment of the performance of passive pitch can be found in many literature e g lazauskas 1992 hantoro et al 2011 lazauskas and kirke 2012 etc in the case of active pitch actuating system consist of hydraulic rams or cams are used to force the blades pitching in a predetermined pattern this implies that power consuming be required for blade pitching the strategies of variable pitch have been the objective of many studies in order to achieve an ideal betz rotor salter 2005 derive a pitch variation pattern looks like sine curve but with zero pitch segments near downstream upstream transition points a straightforward way to take full advantage of active pitch is the constant incidence law in which the blades local effective angle of attack а e is kept at a target angle usually the static stall angle а stall as long as possible gosselin 2015 report a 27 relative efficiency gain predicted by a two dimensional rans model bringing the 2d turbine efficiency close to the betz limit but constant incidence law introduces jumps of pitch variation at upstream downstream transition points hence leads to large pitch acceleration varies modifications are made to smooth the pitch variation near downstream upstream transitions performance of turbines with constant incidence law and or its modified version pitch variations can also be found in staelens et al 2003 and paillard et al 2013 etc paraschivoiu et al 2009 try to determine a general cyclical pitch variation of vertical axis wind turbine through a genetic algorithm optimizer but the performance enhancement domain around a design point is relatively narrower that means the polynomial optimal pitch variation has to be essentially reshaped as wind speed changing this heavily dependence on operational conditions make it difficult to be applied in practice similarly a constant incidence law and its modifications face the same difficulty in practice i e when operational conditions changed there is no simple way to adjust the pitch control accordingly alternatively sinusoidal and cycloidal pitch variations are very popular since they avoid large pitch acceleration and can be adjusted easily by modifying only one or two parameters both pitch variation patterns and performances of them are very similar besides studying stabilized self acting pitch turbines mentioned above lazauskas 1992 also analyze the performance of vertical axis wind turbines with a forced sinusoidal pitch variation he reports that either passive or active pitch control producing better starting torque broader operating range and greater efficiency than those of a fixed pitch turbine hwang et al 2009 use both cfd and water flume experiments to optimize the parameters of cycloidal turbine and reports its power coefficient achieved 0 36 which is 70 higher than a fixed pitch turbine then they apply a genetic algorithm to determine the optimal pitch angle curves for individual blade control at different tip speed ratios and reports a further 25 performance improvement compared to cycloidal turbine erickson et al 2011 reports that the maximum efficiency of a vat with sinusoidal pitch blades reaches up to 0 463 in wind tunnel experiments which is a 35 improvement over a fixed pitch turbine studied by a streamtube model paillard et al 2013 reports a maximum increase of 53 on the power coefficient for a sinusoidal pitch water turbine compared to that of a fixed pitch turbine whilst the power consumption required for blade pitching is lower than 1 a simple sine variation of pitch angle is called a first order harmonic sinusoidal pitching vandenberghe and dick 1986 1987 assess higher order sinusoidal pitch and conclude the performance gain from higher order harmonics is not worthwhile the mechanism complexity lazauskas and kirke 2012 adopt up to five harmonics and find the additional harmonics offer little advantage over a simple first order sinusoidal pitching in chen et al 2018 hereafter referred to as the previous study numerical simulations based on navier stokes equations and sst k ω model are carried out to assess the performance of a sinusoidal pitch h darrieus turbine rotating at variable speeds the turbine s diameter is 1 0 m with three naca0018 profile blades whose chord length is 0 15 m operating in a 1 0 m s ambient flow the turbine achieve maximum power efficiency at tip speed ratio 2 0 and its maximum tip speed ratio is just over 3 therefore the maximum blade reynolds is less than 6 105 the results shows that compared to fixed pitch turbine sinusoidal pitch increases the maximum power efficiency and torque output by more than 1 3 meanwhile lower the fluctuations in power output and rotational speed it is found that the benefits of variable pitching are gained mainly at the upstream half cycle of blades flight path where it delays stall however due to the high local tip speed ratio at the downstream half cycle too large pitch amplitude results in large resistant torque which nullifies the benefits gained at the upstream half cycle the optimum amplitude of sinusoidal pitch variation lies in 5 10 for the tested turbine based on the results of the previous study a simple modification on the sinusoidal pitch variation is suggested to lower the resistant torque induced by over pitch in the downstream half cycle of blades flight path a parametric study using numerical model has been carried out to evaluate the influence of the new pitch variation on the power coefficients tip speed ratio hydrodynamic loads on blades and fluctuations in operation etc furthermore to clarify long existed vague impressions of the influence of rotor s rotational inertia it is systematically investigated in this study 2 numerical model 2 1 flow model considering the geometric character of a vertical axis turbine a two dimensional numerical model is adequate as long as larger aspect ratio blades are used and the arm effects are insignificant li and calisal 2010 conclude that three dimensional effects are significant only when the turbine height is less than twice of the rotor s radius the relative error of maximum power coefficients predicted by 2d and 3d numerical simulations are roughly at 10 at this height to radius ratio this accuracy is acceptable in the early stage of turbine design considering the balance between accuracy and computation cost the same numerical model as that in the previous study is used in this study which features rans equations κ ω sst closure algorithm of semi implicit method for pressure linked equations simpe and cell based finite volume method incorporated in the commercial cfd software ansys fluent 2 2 rotor dynamics the blades of vertical axis turbine experience essentially periodic forces due to periodically changing angles of attack hence the turbine naturally rotate in pulsating manner unless electrical architecture and control system are sophisticatedly designed to maintain constant rotational speed therefore in the previous study the variable speed rotation is simulated by solving an equation of rotational motion the instantaneous loads that the electric generator and mechanical transmission system applied on the rotor is assumed to be linearly proportional to the rotor s instantaneous rotation speed in reality both electrical architecture and friction in mechanical system affect the relation between the load torque and the rotational speed a linear relation is a compromise between model simplicity and representativeness to the reality in summary the equation of the rotation of the rotor is 1 j z d ω d t q h t q l t where j z is the rotational inertia of the rotor ω is the angular velocity q h is the hydrodynamic torque q l represent the resistant torque including the effects of electromagnetic forces in the generator and friction in the mechanical system it is the reaction of the output shaft torque 2 q l t b ω t where the load coefficient b is a positive constant it is used to adjust the rotation speed of the turbine ranges 4 22 5 n m s in this study for convenience of comparison the results are presented in non dimensional form the non dimensional instantaneous rotation speed shaft torque and power output are defined as 3 ω ω r u 4 q l q l 1 2 ρ u 2 d h r b ω 1 2 ρ u 2 d h r 5 p p t 1 2 ρ u 3 d h b ω 2 1 2 ρ u 3 d h in which ρ is the water density u is the ambient current speed d and r are the diameter and radius of the rotor respectively h is height of the blade equals to unit length in this two dimensional model the tip speed ratio shaft torque coefficient and power coefficient are defined as time averaged non dimensional rotation speed shaft torque and power output respectively 6 λ ω r u ω 7 c q b ω 1 2 ρ u 2 d h r q l 8 c p b ω 2 1 2 ρ u 3 d h p in which the over bars on top of variables means time average the instantaneous rotation speed torque and power output exhibit periodic fluctuations ripple factors represent the fluctuation characteristics of these variables are defined as 9 r f f max f min f in which f represents those instantaneous variables f max f min and f are the maximum minimum and mean of the phase averaged values of these variables respectively in this paper depending on the tip speed ratios the maximum minimum and mean values are computed over 10 to 20 cycles at the quasi steady stage of operation in the previous study blades of the vertical axis turbine are forced to pitch following a simple sinusoidal variation as 10 ϕ ϕ a m p sin θ where φ is the instantaneous pitch angle of the blade which is positive when the leading edge of the blade points outwards the rotor φ amp is the amplitude of the pitch variation θ is azimuthal angle of the blade at θ 0 and 180 φ is set to zero as shown in fig 1 note that according to eq 10 the maximum pitch angle φ max equals to the amplitude of pitch variation φ amp 2 3 geometry computational domain and grid the parameters of the h darrieus turbine used in this study are given in table 1 the pivots of the blades are located at 1 10th of the chord from the leading edge the layout of the computation domain is shown in fig 2 not to scale the length of the computation domain is 266 chord lengths c and the width is 106c the distance from the inflow boundary to the centre of the rotor is 66c this size of the computational domain is comparable to that of kirke and paillard 2017 who used a domain size of 10 30 d 67c 200c where d is the diameter of the rotor the grid around the rotor moves following the rotation of the rotor and the grid around the blades rotates when the blades are pitching around their pivots to cope with these complex motions the grid is divided into several zones as shown in fig 2 including the blade zones around each blade a rotor zone around the rotor and containing all the blade zones an outer zone covering the whole computational domain and containing the rotor zone the grids in adjacent zones slide along the interfaces the rotor zone and blade zones are further divided into sub zones according to geometric features each zone or sub zone is mapped by a structural mesh with quadrilateral cells a uniform velocity is prescribed at the inlet boundary the fluid is accelerated from zero at rate a 1 0 m s2 until the steady speed u 1 0 m s is reached on the outflow boundary a zero reference pressure is set a symmetry boundary condition is used on the lateral boundaries no slip condition is applied on all the solid surfaces of the blades and on the shaft of the rotor both the rotation speed of the rotor ω and the azimuth angle θ are obtained by integrating eq 1 the latter is used to derive the pitching rotation speeds of the blades the derived rotation speeds are delivered to ansys fluent through user defined functions udf then the no slip condition on solid surfaces are enforced automatically by the software the turbulent kinetic energy k and the specific dissipation rate ω at the inlet are such that the turbulent intensity i is 5 and the ratio of turbulent viscosity μ t to the molecular viscosity μ is 10 at the wall boundaries the roughness height is zero which corresponds to smooth walls the performance of the above numerical model has been carefully assessed in the previous study the predicted power coefficients of both cases of hydrodynamic driven and forced rotation turbines are compared with existed experimental results the comparison shows that if mechanical losses such as frictions in bearings are taken into account the predictions agree very well with the experimental results otherwise the power coefficients are over predicted based on independence checks on grid and time resolution the adopted time step is 0 001 s and a grid with 219391 nodes is used in which y is less than 3 on most part of blades surface except at the leading edges where it is up to 5 the uncertainty at 95 confidence level due to the grid and time resolution in the computation of the tip speed ratio λ power coefficient c p and ripple factors of rotational speed r ω is assessed it is shown that the results are within an accuracy of 7 11 5 and 8 for λ c p and r ω respectively the performance of the numerical model is satisfactory the details of model validation is not shown here for brevity but can be found in chen et al 2018 the same grid and time step are adopted in this work 3 modification on pitch variation the results in the previous study of phase averaged hydrodynamic torque coefficients of a blade c qb in different φ amp cases are duplicated in fig 3 in the upstream half cycle 0 θ π of rotation the c qb curves of variable pitch cases are above that of the fixed pitch case in most occasions the hydrodynamic performance of blades are evidently improved by pitch variation in the downstream half cycle π θ 2π the story is different since the kinetic energy of the free stream flow is extracted by the upstream half rotor the velocity at the downstream half rotor has been greatly reduced consequently the local tip speed ratio at the downstream half rotor is much larger and the benefit of variable pitching decreases in fig 3 c qb in downstream half cycle is predominately negative i e the hydrodynamic torque plays a resistant role in the cases of φ amp 10 the resistant torques are larger in magnitude than that of fixed pitch turbine in summary the benefits of variable pitch are gained mainly from the upstream half cycle of rotation whilst in the downstream half cycle the profits from pitch variation are either insignificant or even negative in most cases it is reasonable to predict that the performance gain from pitch variation could be further improved if the negative effects in the downstream half cycle are relieved a simple and straightforward way to achieve this is to keep the blades at zero or small pitch angle in the downstream half cycle while in the upstream half cycle the sinusoidal pitching is retained it is also noticed in fig 3 that at the downstream upstream transition point θ 0 where the pitch angle φ 0 according to eq 10 c qb closes to 0 1 instead of zero it means there is apparent resistant hydrodynamic torque acting on a blade at that position which is supposed to be introduced by non zero local angle of attack to reduce this unexpected resistant torque a small initial pitch angle φ 0 is expected to align the blade chord with the local streamline at the downstream upstream transition point based on above discussion the pitch angle of blades at any azimuth position is defined as 11 ϕ ϕ 0 ϕ a m p sin θ 0 θ π ϕ ϕ 0 π θ 2 π note that the first equation in eq 11 has been used by other researchers though expressed in different symbols such as lazauskas 1992 and erickson et al 2011 etc although there is no evidence they linked φ 0 to resistant torque at downstream upstream transition point in their results φ 0 could close or even larger than φ amp for example lazauskas 1992 reported with φ 0 6⁰ and φ amp 3⁰ a local maximum power efficiency achieved which lead to an unusual result that the pitch angle has wrong sign on the downstream side of the rotor in this paper φ 0 is supposed to be much smaller than φ amp based on the logic mentioned above to avoid abrupt change in pitch angle at downstream upstream transition points pitch angle in the downstream half cycle is fixed to φ 0 instead of set to zero from the results of the previous study the optimal maximum pitch angle φ max lies in 5 10 in the case of φ max 5 turbine has a slightly wider operational tip speed ratio bandwidth while in the case of φ max 10 a little higher maximum power coefficient achieved in this study the φ max are kept at 10 therefore the relation between φ 0 and φ amp is set to be 12 ϕ max ϕ 0 ϕ a m p 10 thus φ amp is not an independent parameter any more in this paper φ 0 4 2 0 2 and 4 are used then φ amp is accordingly set to 14 12 10 8 and 6 respectively hereafter the variable pitch following eq 11 is referred to as modified pitch in this paper the examples of sinusoidal and modified pitch variations are shown in fig 4 4 results and discussions 4 1 overall performance of the turbine the power coefficients c p of a fixed pitch turbine an original sinusoidal pitch turbine and modified pitch turbines are shown in fig 5 as has reported in the previous study the maximum power coefficients c pmax of sinusoidal pitch turbine is more than 1 3 higher than that of a fixed pitch turbine without changing the optimum tip speed ratio significantly as shown in fig 5 a the modified pitch variation greatly improved vat s performance c pmax climbs up to around 0 45 which is 20 higher than that of the original sinusoidal pitch turbine or 63 higher than that of the fixed pitch turbine moreover the performance superiority gained by variable pitch maintains at large tip speed ratios for example c p of both fixed pitch turbine and sinusoidal pitch turbine are close to 0 15 at λ 3 0 while c p of modified pitch turbines are around 0 3 which is even higher than c pmax ever achieved by the fixed pitch turbine at the downstream half cycle of rotation pitch angle of modified pitch turbine is much smaller than that of sinusoidal pitch turbine therefore the resistant torque acting on the blades is also much smaller this effect is much more obvious at large tip speed ratios it is the mechanism behind the high performance of modified pitch turbine at large tip speed ratio to assess the influence of φ 0 the c p of modified pitch turbines around optimal tip speed ratio λ opt are plotted more clearly in fig 5 b the c pmax of all the modified pitch turbines ranges from 0 42 to 0 45 at 1 8 λ 2 2 in general turbines with φ 0 0 and 2 perform the best and should be recommended to practical application the former perform better at all λ values while the latter have the highest c pmax although the difference between their c pmax is less than 0 01 these small differences are within the numerical uncertainty in the computation of c pmax even if the uncertainty on the relative differences would be lower than that on the absolute values conclusions should be draw with caution the c pmax of φ 0 4 case is the lowest 0 42 remember the pitch angle is defined positive when the leading edge of the blade points outwards the rotor this means with the same φ max a slight toe in adjustment on the initial pitch angle helps the turbine performs better around λ opt but a toe out initial pitch angle is in the wrong direction of adjustment it results in resistant effect in the downstream half cycle and lead to relative lower power efficiency c p of φ 0 2 case are slightly lower than that of φ 0 0 case near λ opt while c p of φ 0 4 are apparently lower than the latter it should be mentioned that armstrong et al 2012 and gosselin et al 2016 report a fixed small toe out pitch angle increases the efficiency of the vats but in their studies the toe out pitch angle is actually used to reduce the angle of attack in the upstream half cycle since the premise and mechanism of their preset pitch angles are different with that in this study it is not surprise they draw different conclusions the shaft torque coefficient c q is shown in fig 6 it has been explained in the previous study that the maximum shaft torque coefficient appears before λ opt because the power output is proportional to the square of the rotation speed while the shaft torque varies linearly with the rotation speed at λ 2 c q of the fixed pitch turbine the sinusoidal pitch turbine with φ amp 10 and the modified pitch turbine with φ 0 0 are 0 13 0 18 and 0 22 respectively the modified pitch turbines output higher shaft torque than sinusoidal and fixed pitch turbines the superiority is even obvious at large tip speed ratios it is clear that both sinusoidal and modified pitch variations cause no apparently change on the turbine s optimal tip speed ratio the variable pitch variations provide larger shaft torque so that the turbine can drive heavier load and generate more power 4 2 features of hydrodynamic torque on a blade the coefficient of hydrodynamic torque acting on a blade is defined as 13 c q b q b 1 2 ρ u 2 d h r where q b is the hydrodynamic torque acting on the blade the comparison of phase averaged c qb of different pitch variations are shown in fig 7 the results of turbines operating around λ opt are shown in fig 7 a obviously the main contribution of driving torque comes from the upstream half cycle the maximum blade hydrodynamic torque coefficient c qbmax of all curves occurs at θ 2π 0 3 the sinusoidal pitch turbine has the highest c qbmax in most of the upstream half cycle 0 θ 2π 0 5 its c qb λ curve is above others unfortunately in most of the downstream half cycle 0 5 θ 2π 1 its curve is underneath others the negative effect in downstream half cycle cancels a large part gains from upstream half cycle results in a 0 37 c pmax apparently lower than those of all the modified pitch turbines in 0 θ 2π 0 5 c qb λ curves of modified pitch turbines with φ 0 4 2 0 2 and 4 lie in descending order on contrary in 0 5 θ 2π 1 they lie in ascending order the fixed pitch turbine s c qb curve has the narrowest positive hump in 0 θ 2π 0 5 reflects that the duration of its blade working in favorable angle of attack is shortest its c qb curve in 0 5 θ 2π 1 is among the lowest except than that of the sinusoidal pitch turbine hence c pmax of the fixed pitch turbine is the lowest approximately 0 27 at λ opt the results of turbines operating at λ 3 are shown in fig 7 b at this high tip speed ratio the order by magnitude of these turbines is almost the same with that in fig 7 a the sinusoidal pitch turbine has the highest c qbmax in upstream half cycle again and conspicuous lowest c qb in downstream half cycle due to the large hydrodynamic resistant effect in downstream half cycle its power coefficient is almost the same as that of the fixed pitch turbine note that although φ max of all variable pitch turbines are the same i e 10 their c qbmax are different at both optimal and high tip speed ratios the sinusoidal pitch turbine has the highest c qbmax the c qbmax obtained by turbines with toe out zero and toe in φ 0 decrease sequentially to explain this it is necessary to compare the angle of attack of different pitch variations turbines if the flow crossing the upstream half rotor is assumed undisturbed the angle of attack α is derived as a function of azimuth angle θ pitch angle φ and instantaneous non dimensional rotation speed ω 14 α α f i x ϕ arctan sin θ ω cos θ ϕ in which α fix is the angle of attack of a reference fixed pitch blade the lift coefficient c l of a blade is defined as 15 c l f l i f t 1 2 ρ v r 2 c where v r is the flow speed relative to the blade f lift is the lift acting on the blade which could be obtained from numerical predicted forces fig 8 shows the phase averaged variations of α and c l of a blade in the upstream half cycle of different pitch control turbines operating at λ 3 in the range of blade reynolds number of this study less than 6 105 the static stall angle of naca0018 airfoil is around 10 12 and the maximum c l is around 1 0 therefore α of the fixed pitch turbine exceeds the static stall angle in nearly 2 3 of the upstream half cycle whilst α of all the variable pitch turbines almost never exceeds the static stall angle a clear evidence of dynamic effects is the maximum c l in fig 8 b which is well above the quasi steady maximum c l this is due to the fast angle of attack increase which results in the delay of the boundary layer separation hence the boundary layer is still attached at angles of attack above the stall angle this effect is similar to the beginning of dynamic stall but here eventually the blade does not stall because of the rapid decrease of the angle of attack this dynamic effect is also shown by the trend of the c l curves for different φ in fact fig 8 a shows that for the majority of the azimuth positions α decreases as φ 0 varies from 4 to 4 and thus also c l decreases as shown in fig 8 b however around θ 2π 0 2 where the trend of α with φ 0 is reversed the trend of c l remains unchanged due to dynamic effects it should also be noted that for θ 2π from 0 to 0 5 the flow speed relative to the blade decreases hence as discussed in the following the hydrodynamic torque on the blade does not vary synchronously with α and c l finally the slope of c l changes abruptly when θ 2π is 0 and 0 5 this is the added mass effect due to the discontinuous change in pitch acceleration the instantaneous non dimensional vorticity distribution non dimensionalized by u d around sinusoidal and modified pitch rotors at the same phase are shown in fig 9 no apparent separation on blades surfaces are observed except the difference in strength and locations of shed vortices at lower right corners of the figures the flow patterns of both cases are quite similar the interaction between each blade with the wake of the proceeding blade is small it is hard to find one to one relation between instantaneous flow pattern and forces on a blade according to basic fluid dynamic theorem pressure at any point is affected by the vorticity distribution in whole flow field therefore small difference in vorticity distributions still lead to perceptible difference in pressure distributions along the blade surfaces of sinusoidal and modified pitch turbines as shown in fig 10 in which the pressure coefficient is defined as c p p p 1 2 ρ u 2 both the positive and negative pressure coefficients near the blade s leading edge of sinusoidal pitch turbine are stronger than those of modified pitch turbine the difference in pressure distribution leads to different forces exerting on the blades and eventually leads to the different driving torque as shown in both fig 7 a and b toe in φ 0 does help to reduce the magnitude of resistant hydrodynamic torque on a blade at downstream upstream transitions θ 2π 0 or 1 and toe out φ 0 create reverse effect but it seems this effect is not a decisive factor of performance improvement too much toe in adjustment e g change φ 0 from 2 to 4 would have negative effect because the c qb in the upstream half cycle drop too much it is necessary to compare the hydrodynamic torques on a blade at different tip speed ratios one may expect that the hydrodynamic torque on a blade is much small at higher λ than that at lower λ this could be true for the time averaged torque but not the case for the instantaneous torque fig 11 shows the examples of hydrodynamic torque coefficients at the λ 2 1 and that at λ 3 in the case of sinusoidal pitch turbine in the upstream half cycle c qb is slightly larger at higher λ than that at lower λ however in the downstream half cycle c qb is much lower at higher λ therefore the mean c qb in the whole cycle at higher λ is lower than that at lower λ in the case of modified pitch turbine with φ 0 0 similar story happens except the difference between c qb at the same phase at different λ are not so large reference to the c p λ relations in last section it is clear that large instantaneous hydrodynamic torque does not imply better performance of turbine and vice versa the average torque means more 4 3 features of hydrodynamic forces on a blade the coefficients of tangential and normal hydrodynamic forces acting on a blade are defined as 16 c f t b f t b 1 2 ρ u 2 c h c f n b f n b 1 2 ρ u 2 c h where f tb and f nb are the tangential and normal hydrodynamic forces respectively as shown in fig 1 the normal force is positive when it points inwards the rotor the tangential force is positive when it points from the trailing edge to the leading edge of the blade for sake of comparison the definition of the force coefficients here are different from the conventional definition of the aerodynamic coefficients of airfoils the characteristic speed used here is the undisturbed flow speed instead of the relative flow speed experienced by the blade section the phase averaged cf tb and cf nb are shown in fig 12 the magnitude of cf nb is larger than that of cf tb by an order in the case of fixed pitch turbine the normal force on blade hardly contribute to the driving torque because its arm of force relative to the shaft is negligible whilst in the case of variable pitch blade both tangential and normal forces could considerably contribute to the driving torque since both of them could have large arm of force which can be easily understood from fig 1 the previous study has indicated that a variable pitch blade could create larger driving torque than a fixed blade while bearing much lower tangential and normal forces than the latter it is shown in fig 12 a and b at a tip speed ratio close to λ opt the maximum tangential and normal forces coefficients cf tb max and cf nb max of a sinusoidal pitch blade are approximately 50 and 60 of that of a fixed blade respectively both cf tb max and cf nb max of φ 0 4 2 0 2 and 4 cases decreases successively and most of them are lower than those of sinusoidal pitch case except the cf tb max of φ 0 4 case is at the same level of the latter typically cf tb max and cf nb max of φ 0 0 case are 78 and 87 of that of sinusoidal pitch case it can be derived that the force fluctuation amplitudes on blades of modified pitch turbines are not higher than that of sinusoidal pitch turbine it is encouraging because the modified pitch turbines could perform 20 better than a sinusoidal pitch turbine without raising the risk of blade structural failure it is shown in fig 12 c and d the general variations of cf tb and cf nb at larger tip speed ratio are similar with that at the lower optimal tip speed ratio when λ increases the effective angle of attack decreases but the relative flow speed experienced by the blade increases the combined effects lead to lower cf tb and higher cf nb bear in mind these force coefficients are defined based on u since the normal force is much larger than the tangential force and the thickness of the blade is much smaller than its chord length this means the blades must be stronger if the turbine is designed to operate at higher tip speed ratio all the above discussion on the hydrodynamic torque normal and tangential forces on a blade shows that the instantaneous peak values of hydrodynamic loads have no direct relations with the turbine s performance the mean values of them really matter 4 4 fluctuation characteristics of turbine operation for a horizontal axis turbine operating in a uniform ambient flow the angles of attack of its blade elements are constant so the hydrodynamic forces on the blades and rotor are fairly stable the rotation speed of rotor is almost constant however the periodically varying hydrodynamic forces on the blades of a vertical axis turbine makes it operate in a fluctuate manner the power output the shaft torque and the rotation speed of a vat rotor naturally vary in cyclical manner if no special measures are taken for example fig 13 shows the time series of non dimensional rotation speed ω in the case of modified pitch variation with φ 0 0 and λ 1 95 the ripple factor of rotation speed r ω is in fact the ratio of the average rotation speed difference δω over the mean rotation speed ω mean i e the tip speed ratio λ the ripple factors of the power output r p of the shaft torque r q and of the rotation speed r ω are shown in fig 14 since the shaft torque equals to the rotation speed multiplying with a constant load coefficient the value of r q is exactly the same as r ω as discussed in the previous study a turbine operate in a discontinuous status at a very low tip speed ratio this operating status is far away from acceptable and should be avoid therefore the ripple factors at λ 1 are omitted in the figure all the ripple factors decrease as tip speed ratio increase the ripple factors of the variable pitch turbines are smaller than those of the fixed pitch turbine especially at λ λ opt at the λ opt 2 the ripple factor of power output r p of the fixed pitch turbine the sinusoidal pitch turbine and the modified pitch turbine with φ 0 0 are 1 57 0 99 and 0 69 respectively the ripple factor of the rotation speed r ω of the fixed pitch turbine the sinusoidal pitch turbine and the modified pitch turbine with φ 0 0 are 0 84 0 51 and 0 35 respectively so at the λ opt the fluctuations in operation of the modified pitch turbine are about 70 of that of the sinusoidal pitch turbine and 40 of that of the fixed pitch turbine 4 5 influence of rotor s rotational inertia different materials could be used to construct a blade that fulfilling the requirement of stiffness and strength steel is a relative cheap but heavy material whilst compound materials are usually light but very expensive lighter blades are easy to be delivered and installed but the lighter is not always the better since it lead to smaller rotational inertia of the rotor and small inertia rotor tends to fluctuate severely in above discussion of this paper and in most of the previous study an original rotational inertia j z0 1 5 kg m2 is used this value is derived from a blade design which consists of stainless steel skeleton and skin changing the design of blade changes the rotational inertia of the rotor in the previous study the performance of rotors with the rotational inertia equals to 2j z0 and 3j z0 are assessed the results show that the influence of rotational inertia on the average characteristics such as power coefficient and tip speed ratio are very small but larger inertia does make the turbine operate more stable when the rotational inertia is 3j z0 the ripple factors of power output and rotation speed are decreased by a half what would happen if the inertia increase is not limited to be caused by blade design but by installing additional mass block so that the inertia could be increased to whatever needed one might expect that if the rotational inertia is large enough the rotation speed of a vat rotor could be constant to clarify this long existed vague impression performances of modified pitch turbine whose rotational inertia ranges from 1 to 100 j z0 and the φ 0 and the load coefficient b are fixed to 0 and 14 n m s respectively are compared in simulations the vats start up gradually from rest under hydrodynamic driving torque this processes is called self start the results are shown in fig 15 it is shown that c p and λ do not change much when j z j z0 reaches up to 41 meanwhile r p and r ω are only 0 05 and 0 025 respectively the fluctuation in operation is dramatically depressed however a further increase in rotational inertia results in an abrupt falling in both c p and λ as c p and λ falling down r p and r ω suddenly jump up the data shows this is the combination effect of falling mean values and climbing fluctuation amplitudes the clue of what happed could be found in fig 15 c when a blade approaching the most upstream point θ 2π 0 25 the driving torque on it is climbing the rotor accelerates and reaches a peak rotation speed shortly after a peak driving torque reached as the blade runs to the upstream downstream transition point θ 2π 0 5 the driving torque lowers and the resistant load torque proportioned to rotation speed remains high the rotor decelerates until the next blade approaching the most upstream point then the rotor accelerates again in the case of low rotational inertia rotor could be accelerated quickly to an adequate speed so that the blades works in a favourite angle of attack and experiencing higher relative flow speed then generating peak driving torque higher than peak resistant torque the rotor speeds up eventually to a much higher speed at which the peak driving torque and peak resistant torque are finally balanced note a low inertia rotor decelerates quickly either then its operation exhibits higher fluctuation however if the rotational inertia of rotor is very high it cannot be fully speeded up in an acceleration period so that blades cannot generate adequate driving torque to overcome resistant torque in the following deceleration period the rotation speed drops to a fairly low level then the rotor always works at low speed for example in fig 15 c the peak non dimensional rotation speed ω max for j z j z0 41 cases are only at a level of 0 7 it is clear that for a self start vat the c p and λ are not continuous functions of rotational inertia performance of a vat with too large rotational inertia is very poor however if a turbine starts up with external help the story is different for example the turbine j z j z0 43 3 is started up through two different way the first one is the self start mentioned above in this way ω max of the rotor has once reached up to 1 07 but finally slow down to run at λ 0 7 the second is assisted start at first the self start of a lower inertia j z j z0 42 rotor is simulated to tu d 15 5 at that time ω has already been accelerated to 1 1 then the inertia is re set to j z j z0 43 3 and the simulation continued with existed flow field data the rotor keeps accelerating from then on finally operate at λ 1 97 with c p 0 44 and r p 0 024 it seems ω around 1 1 might be a threshold a turbine starts running on its own at an initial speed higher than this threshold would end in a much higher speed steady state otherwise it ends in a steady state with much lower speed to confirm this conclusion a j z j z0 100 turbine is started up in assisted start way after a long acceleration it runs at λ 1 95 with c p 0 43 and r p 0 021 the time series of ω of simulations discussed above is shown in fig 16 if the inertia is increased further to j z j z0 200 with assisted start it eventually operate stably at λ 1 94 with c p 0 42 and r p 0 011 quite close to a constant speed rotation this data is not included in the figure because it hasn t get to stable state until tu d 80 to get a whole picture of rotational inertia influence the performances of self start modified pitch variation turbines with φ 0 0 and varied load coefficients and inertias are compared in fig 17 for a turbine with given inertia as the load coefficient increases from a small value λ decreases monotonously c p increases at first and decreases after a maximum reached in the cases of small inertias e g j z j z0 1 2 and 3 the variation of c p versus λ are almost the same but if the loads are too heavy the turbines are hard to start they cannot operate stably at λ 1 so the data of small inertia turbines at λ 1 are omitted in the figures in the cases of fairly large inertias e g j z j z0 40 and 46 7 when c p reached maximum at λ opt a small increment in load coefficient results in suddenly collapse in both c p and λ variations c p drops to less than 0 05 and λ drops to less than 0 65 this is because the rotor cannot be accelerated to adequate speed in an acceleration period due to large inertia as analysed before the suddenly drop in rotation speed introduce a blank zone ranging from λ 0 7 to nearly 2 where no data of large inertia turbines locate there it is interesting to find that the large inertia turbines can rotate stably even at λ 0 7 because the large inertia helps to smooth out the fluctuations in operation it is found in fig 17 b and c that the ripple factors of power output rotation speed and shaft torque are apparently decreased as inertia increases at the optimal tip speed ratio when j z j z0 increases from 1 to 3 the ripple factors r p and r ω decease by almost 50 when j z j z0 increases to 40 the ripple factors are lowered to only 5 of the original values in general as rotational inertia increases in a fairly large range the power coefficient and the tip speed ratio of a self start turbine do not change much and the ripple factor of power output could be lowered to a level of 0 05 and the fluctuations in shaft torque and rotation speed could be as low as 0 025 but a very large inertia self start turbine would perform poorly since it could never reach an adequate speed so that the hydrodynamic potential of blades be fully exploited however if a very large inertia turbine could reach an initial ω at 1 1 by external assistance it would achieve good performance and operate at an almost constant speed although the price is employing mass units which might be hundred times heavier than a normally designed blades 5 conclusions the sinusoidal pitch variation of h darrieus turbine is modified on the purpose of reducing resistant hydrodynamic torque induced by over pitch especially at the downstream half cycle of rotor s rotation numerical simulations are conducted to assess the effect of this modified pitch the influence of rotational inertia on the vat s operation is systematically studied too by comparing the performance of a fixed pitch turbine a sinusoidal pitch turbine and modified pitch turbine with different parameter combinations the following conclusions are drawn 1 modified pitch variation greatly improved vat s performance turbines with φ 0 0 and 2 and accordingly φ amp 10 and 12 are recommended to practical applications c pmax achieved by these recommended modified pitch turbines is around 0 45 which is 20 higher than that of the original sinusoidal pitch turbine fluctuations in power output shaft torque and rotation speed of the modified pitch turbines are about 70 of those of the sinusoidal pitch turbine even at high tip speed ratio the performance of the sinusoidal pitch turbine falls to the same level of the fixed pitch turbine the modified pitch turbine still maintain performance superiority over them 2 variable pitch turbines provide larger shaft torque than a fixed pitch turbine so that they output higher power without apparently changing turbine s optimal tip speed ratio the modified pitch turbines provide the highest shaft torque than other turbines even at high tip speed ratios meanwhile the peak hydrodynamic loads on the blades of recommended modified pitch turbines are smaller than that on the blades of sinusoidal pitch turbine so that the performance is improved without raising the risk of blade structural failure it implies that the instantaneous peak hydrodynamic loads have no direct relations with the turbine s performance the mean values of them is the big matter 3 for a self start vat the power coefficient c p and tip speed ratio λ are not continuous functions of rotational inertia as the fluctuations in operation decreased quickly as the rotational inertia increases c p and λ do not change much but a very large inertia self start vat would operate at very low c p and λ though stably since it could never reach an adequate speed so that the hydrodynamic potential of blades be fully exploited however if a very large inertia vat could reach an adequate initial rotation speed by external assistance it would achieve good performance but the inertia needed to achieve an almost constant speed is extremely high dynamic effects have played important roles in determining the hydrodynamic loads on the blades so these effects will be studied in future work also note that three dimensional effects including those due to the arms and the finite length of the blades are not included in present work their inclusion would lead to a reduction in the predicted turbine efficiency acknowledgement this work is supported by the general program from the natural science foundation of china nsfc with grant no 51379036 and joint research usage for institute of ocean energy saga university japan with grant no 17c01 the calculations were performed on the supercomputer in the computation centre of dalian university of technology dalian china 
22882,in previous study chen et al 2018 performances of a fixed pitch and a sinusoidal pitch h darrieus vertical axis turbine vat are compared by numerical simulations with an appropriate amplitude of sinusoidal pitching the power efficiency could be improved by 33 and the fluctuation in power output rotation speed and shaft torque are suppressed meanwhile in this study to reduce the hydrodynamic resistant torque the original sinusoidal pitching is modified to keep the pitch angle at zero or at a small initial angle in the downstream half of rotation cycle numerical simulation results show this modification increases power efficiency by 20 over that of an original sinusoidal pitch turbine furthermore systemically study confirms that as rotational inertia of rotor increases the power coefficient and tip speed ratio do not change much and the fluctuation in output torque can be dramatically reduced however a very large rotational inertia turbine would perform very poor unless the rotor be accelerated over a threshold speed with exterior assistance keywords vertical axis hydrokinetic turbine variable pitch rotational inertia numerical simulation 1 introduction the density of water is eight hundred times of that of air even though the water velocity is much less than the wind speeds the density of hydrokinetic power still could be an order of magnitude higher than that of wind power the hydrokinetic turbine could be much smaller than a wind turbine at same capacity level this is good because especially for a horizontal axis hydrokinetic turbine the size of the rotor is limited by the water depth nowadays the rotor s diameter of a typical megawatt level horizontal axis tidal turbine is usually smaller than 20 m for example the 16 m diameter rotor of sr2000 turbine of scotrenewables power orbital marine power ltd 2019 and the 20 m diameter rotor of seagen s 2 mw turbine jackson and persoons 2012 etc although no megawatt level vertical axis hydrokinetic turbine has been deployed so far to achieve the same capacity level with a horizontal axis turbine the size of a vat s rotor should be similar to that of a horizontal axis rotor because the power coefficients of them are in fact at the same level with the much smaller rotor size the structural problems in connection with large vertical axis wind turbine are diminished in the case of vertical axis hydrokinetic turbine this makes the latter an optional choice in the area of river and tidal current energy exploitation from the viewpoint of fluid dynamics the biggest difference between vats in wind and hydrokinetic current application lies in the tip speed ratios the optimal tip speed ratio of the former typically ranges from 4 to 6 whilst for latter it should be less than 2 5 to avoid serious cavitation effect as suggested by salter 2005 nevertheless apart from well known advantages of vat such as insensitive to flow direction changing and transmitting shaft torque directly above the water surface the problems of vat including relative lower overall efficiency shaking in operation due to continuously changing fluid dynamic forces as the turbine rotates poor self start performance etc are still need to be coped with kirke and lazauskas 2008 summarized the advantages and problems of vertical axis water turbines and commented on possible solutions to these problems they concluded that variable pitch have effects on almost all the problems especially it produce high starting torque and meanwhile maintain high peak efficiency whilst other solutions are less comprehensive for example using helical blades can eliminate shaking but cannot produce high starting torque the mechanisms for achieving variable pitch variation fall into two categories the first is passive pitch or so called self acting pitch in this case the blades are pitching around their pivots driven by fluid dynamic forces another one is active or forced pitch the blades are forced to pitch according to some predetermined schedule passive pitch is simple in mechanism hence is much easier to apply and is regard as more reliable in operational environment the kobold turbine has employed passive pitch control coiro et al 2005 but there are abrupt changes of pitch angle near downstream upstream transition points at the flight path of blades this could lead to structure fatigue in long term operation countermeasures such as using additional mass blocks or fluid dynamic forces to provide stabilizer moments are taken to smooth the pitch variation assessment of the performance of passive pitch can be found in many literature e g lazauskas 1992 hantoro et al 2011 lazauskas and kirke 2012 etc in the case of active pitch actuating system consist of hydraulic rams or cams are used to force the blades pitching in a predetermined pattern this implies that power consuming be required for blade pitching the strategies of variable pitch have been the objective of many studies in order to achieve an ideal betz rotor salter 2005 derive a pitch variation pattern looks like sine curve but with zero pitch segments near downstream upstream transition points a straightforward way to take full advantage of active pitch is the constant incidence law in which the blades local effective angle of attack а e is kept at a target angle usually the static stall angle а stall as long as possible gosselin 2015 report a 27 relative efficiency gain predicted by a two dimensional rans model bringing the 2d turbine efficiency close to the betz limit but constant incidence law introduces jumps of pitch variation at upstream downstream transition points hence leads to large pitch acceleration varies modifications are made to smooth the pitch variation near downstream upstream transitions performance of turbines with constant incidence law and or its modified version pitch variations can also be found in staelens et al 2003 and paillard et al 2013 etc paraschivoiu et al 2009 try to determine a general cyclical pitch variation of vertical axis wind turbine through a genetic algorithm optimizer but the performance enhancement domain around a design point is relatively narrower that means the polynomial optimal pitch variation has to be essentially reshaped as wind speed changing this heavily dependence on operational conditions make it difficult to be applied in practice similarly a constant incidence law and its modifications face the same difficulty in practice i e when operational conditions changed there is no simple way to adjust the pitch control accordingly alternatively sinusoidal and cycloidal pitch variations are very popular since they avoid large pitch acceleration and can be adjusted easily by modifying only one or two parameters both pitch variation patterns and performances of them are very similar besides studying stabilized self acting pitch turbines mentioned above lazauskas 1992 also analyze the performance of vertical axis wind turbines with a forced sinusoidal pitch variation he reports that either passive or active pitch control producing better starting torque broader operating range and greater efficiency than those of a fixed pitch turbine hwang et al 2009 use both cfd and water flume experiments to optimize the parameters of cycloidal turbine and reports its power coefficient achieved 0 36 which is 70 higher than a fixed pitch turbine then they apply a genetic algorithm to determine the optimal pitch angle curves for individual blade control at different tip speed ratios and reports a further 25 performance improvement compared to cycloidal turbine erickson et al 2011 reports that the maximum efficiency of a vat with sinusoidal pitch blades reaches up to 0 463 in wind tunnel experiments which is a 35 improvement over a fixed pitch turbine studied by a streamtube model paillard et al 2013 reports a maximum increase of 53 on the power coefficient for a sinusoidal pitch water turbine compared to that of a fixed pitch turbine whilst the power consumption required for blade pitching is lower than 1 a simple sine variation of pitch angle is called a first order harmonic sinusoidal pitching vandenberghe and dick 1986 1987 assess higher order sinusoidal pitch and conclude the performance gain from higher order harmonics is not worthwhile the mechanism complexity lazauskas and kirke 2012 adopt up to five harmonics and find the additional harmonics offer little advantage over a simple first order sinusoidal pitching in chen et al 2018 hereafter referred to as the previous study numerical simulations based on navier stokes equations and sst k ω model are carried out to assess the performance of a sinusoidal pitch h darrieus turbine rotating at variable speeds the turbine s diameter is 1 0 m with three naca0018 profile blades whose chord length is 0 15 m operating in a 1 0 m s ambient flow the turbine achieve maximum power efficiency at tip speed ratio 2 0 and its maximum tip speed ratio is just over 3 therefore the maximum blade reynolds is less than 6 105 the results shows that compared to fixed pitch turbine sinusoidal pitch increases the maximum power efficiency and torque output by more than 1 3 meanwhile lower the fluctuations in power output and rotational speed it is found that the benefits of variable pitching are gained mainly at the upstream half cycle of blades flight path where it delays stall however due to the high local tip speed ratio at the downstream half cycle too large pitch amplitude results in large resistant torque which nullifies the benefits gained at the upstream half cycle the optimum amplitude of sinusoidal pitch variation lies in 5 10 for the tested turbine based on the results of the previous study a simple modification on the sinusoidal pitch variation is suggested to lower the resistant torque induced by over pitch in the downstream half cycle of blades flight path a parametric study using numerical model has been carried out to evaluate the influence of the new pitch variation on the power coefficients tip speed ratio hydrodynamic loads on blades and fluctuations in operation etc furthermore to clarify long existed vague impressions of the influence of rotor s rotational inertia it is systematically investigated in this study 2 numerical model 2 1 flow model considering the geometric character of a vertical axis turbine a two dimensional numerical model is adequate as long as larger aspect ratio blades are used and the arm effects are insignificant li and calisal 2010 conclude that three dimensional effects are significant only when the turbine height is less than twice of the rotor s radius the relative error of maximum power coefficients predicted by 2d and 3d numerical simulations are roughly at 10 at this height to radius ratio this accuracy is acceptable in the early stage of turbine design considering the balance between accuracy and computation cost the same numerical model as that in the previous study is used in this study which features rans equations κ ω sst closure algorithm of semi implicit method for pressure linked equations simpe and cell based finite volume method incorporated in the commercial cfd software ansys fluent 2 2 rotor dynamics the blades of vertical axis turbine experience essentially periodic forces due to periodically changing angles of attack hence the turbine naturally rotate in pulsating manner unless electrical architecture and control system are sophisticatedly designed to maintain constant rotational speed therefore in the previous study the variable speed rotation is simulated by solving an equation of rotational motion the instantaneous loads that the electric generator and mechanical transmission system applied on the rotor is assumed to be linearly proportional to the rotor s instantaneous rotation speed in reality both electrical architecture and friction in mechanical system affect the relation between the load torque and the rotational speed a linear relation is a compromise between model simplicity and representativeness to the reality in summary the equation of the rotation of the rotor is 1 j z d ω d t q h t q l t where j z is the rotational inertia of the rotor ω is the angular velocity q h is the hydrodynamic torque q l represent the resistant torque including the effects of electromagnetic forces in the generator and friction in the mechanical system it is the reaction of the output shaft torque 2 q l t b ω t where the load coefficient b is a positive constant it is used to adjust the rotation speed of the turbine ranges 4 22 5 n m s in this study for convenience of comparison the results are presented in non dimensional form the non dimensional instantaneous rotation speed shaft torque and power output are defined as 3 ω ω r u 4 q l q l 1 2 ρ u 2 d h r b ω 1 2 ρ u 2 d h r 5 p p t 1 2 ρ u 3 d h b ω 2 1 2 ρ u 3 d h in which ρ is the water density u is the ambient current speed d and r are the diameter and radius of the rotor respectively h is height of the blade equals to unit length in this two dimensional model the tip speed ratio shaft torque coefficient and power coefficient are defined as time averaged non dimensional rotation speed shaft torque and power output respectively 6 λ ω r u ω 7 c q b ω 1 2 ρ u 2 d h r q l 8 c p b ω 2 1 2 ρ u 3 d h p in which the over bars on top of variables means time average the instantaneous rotation speed torque and power output exhibit periodic fluctuations ripple factors represent the fluctuation characteristics of these variables are defined as 9 r f f max f min f in which f represents those instantaneous variables f max f min and f are the maximum minimum and mean of the phase averaged values of these variables respectively in this paper depending on the tip speed ratios the maximum minimum and mean values are computed over 10 to 20 cycles at the quasi steady stage of operation in the previous study blades of the vertical axis turbine are forced to pitch following a simple sinusoidal variation as 10 ϕ ϕ a m p sin θ where φ is the instantaneous pitch angle of the blade which is positive when the leading edge of the blade points outwards the rotor φ amp is the amplitude of the pitch variation θ is azimuthal angle of the blade at θ 0 and 180 φ is set to zero as shown in fig 1 note that according to eq 10 the maximum pitch angle φ max equals to the amplitude of pitch variation φ amp 2 3 geometry computational domain and grid the parameters of the h darrieus turbine used in this study are given in table 1 the pivots of the blades are located at 1 10th of the chord from the leading edge the layout of the computation domain is shown in fig 2 not to scale the length of the computation domain is 266 chord lengths c and the width is 106c the distance from the inflow boundary to the centre of the rotor is 66c this size of the computational domain is comparable to that of kirke and paillard 2017 who used a domain size of 10 30 d 67c 200c where d is the diameter of the rotor the grid around the rotor moves following the rotation of the rotor and the grid around the blades rotates when the blades are pitching around their pivots to cope with these complex motions the grid is divided into several zones as shown in fig 2 including the blade zones around each blade a rotor zone around the rotor and containing all the blade zones an outer zone covering the whole computational domain and containing the rotor zone the grids in adjacent zones slide along the interfaces the rotor zone and blade zones are further divided into sub zones according to geometric features each zone or sub zone is mapped by a structural mesh with quadrilateral cells a uniform velocity is prescribed at the inlet boundary the fluid is accelerated from zero at rate a 1 0 m s2 until the steady speed u 1 0 m s is reached on the outflow boundary a zero reference pressure is set a symmetry boundary condition is used on the lateral boundaries no slip condition is applied on all the solid surfaces of the blades and on the shaft of the rotor both the rotation speed of the rotor ω and the azimuth angle θ are obtained by integrating eq 1 the latter is used to derive the pitching rotation speeds of the blades the derived rotation speeds are delivered to ansys fluent through user defined functions udf then the no slip condition on solid surfaces are enforced automatically by the software the turbulent kinetic energy k and the specific dissipation rate ω at the inlet are such that the turbulent intensity i is 5 and the ratio of turbulent viscosity μ t to the molecular viscosity μ is 10 at the wall boundaries the roughness height is zero which corresponds to smooth walls the performance of the above numerical model has been carefully assessed in the previous study the predicted power coefficients of both cases of hydrodynamic driven and forced rotation turbines are compared with existed experimental results the comparison shows that if mechanical losses such as frictions in bearings are taken into account the predictions agree very well with the experimental results otherwise the power coefficients are over predicted based on independence checks on grid and time resolution the adopted time step is 0 001 s and a grid with 219391 nodes is used in which y is less than 3 on most part of blades surface except at the leading edges where it is up to 5 the uncertainty at 95 confidence level due to the grid and time resolution in the computation of the tip speed ratio λ power coefficient c p and ripple factors of rotational speed r ω is assessed it is shown that the results are within an accuracy of 7 11 5 and 8 for λ c p and r ω respectively the performance of the numerical model is satisfactory the details of model validation is not shown here for brevity but can be found in chen et al 2018 the same grid and time step are adopted in this work 3 modification on pitch variation the results in the previous study of phase averaged hydrodynamic torque coefficients of a blade c qb in different φ amp cases are duplicated in fig 3 in the upstream half cycle 0 θ π of rotation the c qb curves of variable pitch cases are above that of the fixed pitch case in most occasions the hydrodynamic performance of blades are evidently improved by pitch variation in the downstream half cycle π θ 2π the story is different since the kinetic energy of the free stream flow is extracted by the upstream half rotor the velocity at the downstream half rotor has been greatly reduced consequently the local tip speed ratio at the downstream half rotor is much larger and the benefit of variable pitching decreases in fig 3 c qb in downstream half cycle is predominately negative i e the hydrodynamic torque plays a resistant role in the cases of φ amp 10 the resistant torques are larger in magnitude than that of fixed pitch turbine in summary the benefits of variable pitch are gained mainly from the upstream half cycle of rotation whilst in the downstream half cycle the profits from pitch variation are either insignificant or even negative in most cases it is reasonable to predict that the performance gain from pitch variation could be further improved if the negative effects in the downstream half cycle are relieved a simple and straightforward way to achieve this is to keep the blades at zero or small pitch angle in the downstream half cycle while in the upstream half cycle the sinusoidal pitching is retained it is also noticed in fig 3 that at the downstream upstream transition point θ 0 where the pitch angle φ 0 according to eq 10 c qb closes to 0 1 instead of zero it means there is apparent resistant hydrodynamic torque acting on a blade at that position which is supposed to be introduced by non zero local angle of attack to reduce this unexpected resistant torque a small initial pitch angle φ 0 is expected to align the blade chord with the local streamline at the downstream upstream transition point based on above discussion the pitch angle of blades at any azimuth position is defined as 11 ϕ ϕ 0 ϕ a m p sin θ 0 θ π ϕ ϕ 0 π θ 2 π note that the first equation in eq 11 has been used by other researchers though expressed in different symbols such as lazauskas 1992 and erickson et al 2011 etc although there is no evidence they linked φ 0 to resistant torque at downstream upstream transition point in their results φ 0 could close or even larger than φ amp for example lazauskas 1992 reported with φ 0 6⁰ and φ amp 3⁰ a local maximum power efficiency achieved which lead to an unusual result that the pitch angle has wrong sign on the downstream side of the rotor in this paper φ 0 is supposed to be much smaller than φ amp based on the logic mentioned above to avoid abrupt change in pitch angle at downstream upstream transition points pitch angle in the downstream half cycle is fixed to φ 0 instead of set to zero from the results of the previous study the optimal maximum pitch angle φ max lies in 5 10 in the case of φ max 5 turbine has a slightly wider operational tip speed ratio bandwidth while in the case of φ max 10 a little higher maximum power coefficient achieved in this study the φ max are kept at 10 therefore the relation between φ 0 and φ amp is set to be 12 ϕ max ϕ 0 ϕ a m p 10 thus φ amp is not an independent parameter any more in this paper φ 0 4 2 0 2 and 4 are used then φ amp is accordingly set to 14 12 10 8 and 6 respectively hereafter the variable pitch following eq 11 is referred to as modified pitch in this paper the examples of sinusoidal and modified pitch variations are shown in fig 4 4 results and discussions 4 1 overall performance of the turbine the power coefficients c p of a fixed pitch turbine an original sinusoidal pitch turbine and modified pitch turbines are shown in fig 5 as has reported in the previous study the maximum power coefficients c pmax of sinusoidal pitch turbine is more than 1 3 higher than that of a fixed pitch turbine without changing the optimum tip speed ratio significantly as shown in fig 5 a the modified pitch variation greatly improved vat s performance c pmax climbs up to around 0 45 which is 20 higher than that of the original sinusoidal pitch turbine or 63 higher than that of the fixed pitch turbine moreover the performance superiority gained by variable pitch maintains at large tip speed ratios for example c p of both fixed pitch turbine and sinusoidal pitch turbine are close to 0 15 at λ 3 0 while c p of modified pitch turbines are around 0 3 which is even higher than c pmax ever achieved by the fixed pitch turbine at the downstream half cycle of rotation pitch angle of modified pitch turbine is much smaller than that of sinusoidal pitch turbine therefore the resistant torque acting on the blades is also much smaller this effect is much more obvious at large tip speed ratios it is the mechanism behind the high performance of modified pitch turbine at large tip speed ratio to assess the influence of φ 0 the c p of modified pitch turbines around optimal tip speed ratio λ opt are plotted more clearly in fig 5 b the c pmax of all the modified pitch turbines ranges from 0 42 to 0 45 at 1 8 λ 2 2 in general turbines with φ 0 0 and 2 perform the best and should be recommended to practical application the former perform better at all λ values while the latter have the highest c pmax although the difference between their c pmax is less than 0 01 these small differences are within the numerical uncertainty in the computation of c pmax even if the uncertainty on the relative differences would be lower than that on the absolute values conclusions should be draw with caution the c pmax of φ 0 4 case is the lowest 0 42 remember the pitch angle is defined positive when the leading edge of the blade points outwards the rotor this means with the same φ max a slight toe in adjustment on the initial pitch angle helps the turbine performs better around λ opt but a toe out initial pitch angle is in the wrong direction of adjustment it results in resistant effect in the downstream half cycle and lead to relative lower power efficiency c p of φ 0 2 case are slightly lower than that of φ 0 0 case near λ opt while c p of φ 0 4 are apparently lower than the latter it should be mentioned that armstrong et al 2012 and gosselin et al 2016 report a fixed small toe out pitch angle increases the efficiency of the vats but in their studies the toe out pitch angle is actually used to reduce the angle of attack in the upstream half cycle since the premise and mechanism of their preset pitch angles are different with that in this study it is not surprise they draw different conclusions the shaft torque coefficient c q is shown in fig 6 it has been explained in the previous study that the maximum shaft torque coefficient appears before λ opt because the power output is proportional to the square of the rotation speed while the shaft torque varies linearly with the rotation speed at λ 2 c q of the fixed pitch turbine the sinusoidal pitch turbine with φ amp 10 and the modified pitch turbine with φ 0 0 are 0 13 0 18 and 0 22 respectively the modified pitch turbines output higher shaft torque than sinusoidal and fixed pitch turbines the superiority is even obvious at large tip speed ratios it is clear that both sinusoidal and modified pitch variations cause no apparently change on the turbine s optimal tip speed ratio the variable pitch variations provide larger shaft torque so that the turbine can drive heavier load and generate more power 4 2 features of hydrodynamic torque on a blade the coefficient of hydrodynamic torque acting on a blade is defined as 13 c q b q b 1 2 ρ u 2 d h r where q b is the hydrodynamic torque acting on the blade the comparison of phase averaged c qb of different pitch variations are shown in fig 7 the results of turbines operating around λ opt are shown in fig 7 a obviously the main contribution of driving torque comes from the upstream half cycle the maximum blade hydrodynamic torque coefficient c qbmax of all curves occurs at θ 2π 0 3 the sinusoidal pitch turbine has the highest c qbmax in most of the upstream half cycle 0 θ 2π 0 5 its c qb λ curve is above others unfortunately in most of the downstream half cycle 0 5 θ 2π 1 its curve is underneath others the negative effect in downstream half cycle cancels a large part gains from upstream half cycle results in a 0 37 c pmax apparently lower than those of all the modified pitch turbines in 0 θ 2π 0 5 c qb λ curves of modified pitch turbines with φ 0 4 2 0 2 and 4 lie in descending order on contrary in 0 5 θ 2π 1 they lie in ascending order the fixed pitch turbine s c qb curve has the narrowest positive hump in 0 θ 2π 0 5 reflects that the duration of its blade working in favorable angle of attack is shortest its c qb curve in 0 5 θ 2π 1 is among the lowest except than that of the sinusoidal pitch turbine hence c pmax of the fixed pitch turbine is the lowest approximately 0 27 at λ opt the results of turbines operating at λ 3 are shown in fig 7 b at this high tip speed ratio the order by magnitude of these turbines is almost the same with that in fig 7 a the sinusoidal pitch turbine has the highest c qbmax in upstream half cycle again and conspicuous lowest c qb in downstream half cycle due to the large hydrodynamic resistant effect in downstream half cycle its power coefficient is almost the same as that of the fixed pitch turbine note that although φ max of all variable pitch turbines are the same i e 10 their c qbmax are different at both optimal and high tip speed ratios the sinusoidal pitch turbine has the highest c qbmax the c qbmax obtained by turbines with toe out zero and toe in φ 0 decrease sequentially to explain this it is necessary to compare the angle of attack of different pitch variations turbines if the flow crossing the upstream half rotor is assumed undisturbed the angle of attack α is derived as a function of azimuth angle θ pitch angle φ and instantaneous non dimensional rotation speed ω 14 α α f i x ϕ arctan sin θ ω cos θ ϕ in which α fix is the angle of attack of a reference fixed pitch blade the lift coefficient c l of a blade is defined as 15 c l f l i f t 1 2 ρ v r 2 c where v r is the flow speed relative to the blade f lift is the lift acting on the blade which could be obtained from numerical predicted forces fig 8 shows the phase averaged variations of α and c l of a blade in the upstream half cycle of different pitch control turbines operating at λ 3 in the range of blade reynolds number of this study less than 6 105 the static stall angle of naca0018 airfoil is around 10 12 and the maximum c l is around 1 0 therefore α of the fixed pitch turbine exceeds the static stall angle in nearly 2 3 of the upstream half cycle whilst α of all the variable pitch turbines almost never exceeds the static stall angle a clear evidence of dynamic effects is the maximum c l in fig 8 b which is well above the quasi steady maximum c l this is due to the fast angle of attack increase which results in the delay of the boundary layer separation hence the boundary layer is still attached at angles of attack above the stall angle this effect is similar to the beginning of dynamic stall but here eventually the blade does not stall because of the rapid decrease of the angle of attack this dynamic effect is also shown by the trend of the c l curves for different φ in fact fig 8 a shows that for the majority of the azimuth positions α decreases as φ 0 varies from 4 to 4 and thus also c l decreases as shown in fig 8 b however around θ 2π 0 2 where the trend of α with φ 0 is reversed the trend of c l remains unchanged due to dynamic effects it should also be noted that for θ 2π from 0 to 0 5 the flow speed relative to the blade decreases hence as discussed in the following the hydrodynamic torque on the blade does not vary synchronously with α and c l finally the slope of c l changes abruptly when θ 2π is 0 and 0 5 this is the added mass effect due to the discontinuous change in pitch acceleration the instantaneous non dimensional vorticity distribution non dimensionalized by u d around sinusoidal and modified pitch rotors at the same phase are shown in fig 9 no apparent separation on blades surfaces are observed except the difference in strength and locations of shed vortices at lower right corners of the figures the flow patterns of both cases are quite similar the interaction between each blade with the wake of the proceeding blade is small it is hard to find one to one relation between instantaneous flow pattern and forces on a blade according to basic fluid dynamic theorem pressure at any point is affected by the vorticity distribution in whole flow field therefore small difference in vorticity distributions still lead to perceptible difference in pressure distributions along the blade surfaces of sinusoidal and modified pitch turbines as shown in fig 10 in which the pressure coefficient is defined as c p p p 1 2 ρ u 2 both the positive and negative pressure coefficients near the blade s leading edge of sinusoidal pitch turbine are stronger than those of modified pitch turbine the difference in pressure distribution leads to different forces exerting on the blades and eventually leads to the different driving torque as shown in both fig 7 a and b toe in φ 0 does help to reduce the magnitude of resistant hydrodynamic torque on a blade at downstream upstream transitions θ 2π 0 or 1 and toe out φ 0 create reverse effect but it seems this effect is not a decisive factor of performance improvement too much toe in adjustment e g change φ 0 from 2 to 4 would have negative effect because the c qb in the upstream half cycle drop too much it is necessary to compare the hydrodynamic torques on a blade at different tip speed ratios one may expect that the hydrodynamic torque on a blade is much small at higher λ than that at lower λ this could be true for the time averaged torque but not the case for the instantaneous torque fig 11 shows the examples of hydrodynamic torque coefficients at the λ 2 1 and that at λ 3 in the case of sinusoidal pitch turbine in the upstream half cycle c qb is slightly larger at higher λ than that at lower λ however in the downstream half cycle c qb is much lower at higher λ therefore the mean c qb in the whole cycle at higher λ is lower than that at lower λ in the case of modified pitch turbine with φ 0 0 similar story happens except the difference between c qb at the same phase at different λ are not so large reference to the c p λ relations in last section it is clear that large instantaneous hydrodynamic torque does not imply better performance of turbine and vice versa the average torque means more 4 3 features of hydrodynamic forces on a blade the coefficients of tangential and normal hydrodynamic forces acting on a blade are defined as 16 c f t b f t b 1 2 ρ u 2 c h c f n b f n b 1 2 ρ u 2 c h where f tb and f nb are the tangential and normal hydrodynamic forces respectively as shown in fig 1 the normal force is positive when it points inwards the rotor the tangential force is positive when it points from the trailing edge to the leading edge of the blade for sake of comparison the definition of the force coefficients here are different from the conventional definition of the aerodynamic coefficients of airfoils the characteristic speed used here is the undisturbed flow speed instead of the relative flow speed experienced by the blade section the phase averaged cf tb and cf nb are shown in fig 12 the magnitude of cf nb is larger than that of cf tb by an order in the case of fixed pitch turbine the normal force on blade hardly contribute to the driving torque because its arm of force relative to the shaft is negligible whilst in the case of variable pitch blade both tangential and normal forces could considerably contribute to the driving torque since both of them could have large arm of force which can be easily understood from fig 1 the previous study has indicated that a variable pitch blade could create larger driving torque than a fixed blade while bearing much lower tangential and normal forces than the latter it is shown in fig 12 a and b at a tip speed ratio close to λ opt the maximum tangential and normal forces coefficients cf tb max and cf nb max of a sinusoidal pitch blade are approximately 50 and 60 of that of a fixed blade respectively both cf tb max and cf nb max of φ 0 4 2 0 2 and 4 cases decreases successively and most of them are lower than those of sinusoidal pitch case except the cf tb max of φ 0 4 case is at the same level of the latter typically cf tb max and cf nb max of φ 0 0 case are 78 and 87 of that of sinusoidal pitch case it can be derived that the force fluctuation amplitudes on blades of modified pitch turbines are not higher than that of sinusoidal pitch turbine it is encouraging because the modified pitch turbines could perform 20 better than a sinusoidal pitch turbine without raising the risk of blade structural failure it is shown in fig 12 c and d the general variations of cf tb and cf nb at larger tip speed ratio are similar with that at the lower optimal tip speed ratio when λ increases the effective angle of attack decreases but the relative flow speed experienced by the blade increases the combined effects lead to lower cf tb and higher cf nb bear in mind these force coefficients are defined based on u since the normal force is much larger than the tangential force and the thickness of the blade is much smaller than its chord length this means the blades must be stronger if the turbine is designed to operate at higher tip speed ratio all the above discussion on the hydrodynamic torque normal and tangential forces on a blade shows that the instantaneous peak values of hydrodynamic loads have no direct relations with the turbine s performance the mean values of them really matter 4 4 fluctuation characteristics of turbine operation for a horizontal axis turbine operating in a uniform ambient flow the angles of attack of its blade elements are constant so the hydrodynamic forces on the blades and rotor are fairly stable the rotation speed of rotor is almost constant however the periodically varying hydrodynamic forces on the blades of a vertical axis turbine makes it operate in a fluctuate manner the power output the shaft torque and the rotation speed of a vat rotor naturally vary in cyclical manner if no special measures are taken for example fig 13 shows the time series of non dimensional rotation speed ω in the case of modified pitch variation with φ 0 0 and λ 1 95 the ripple factor of rotation speed r ω is in fact the ratio of the average rotation speed difference δω over the mean rotation speed ω mean i e the tip speed ratio λ the ripple factors of the power output r p of the shaft torque r q and of the rotation speed r ω are shown in fig 14 since the shaft torque equals to the rotation speed multiplying with a constant load coefficient the value of r q is exactly the same as r ω as discussed in the previous study a turbine operate in a discontinuous status at a very low tip speed ratio this operating status is far away from acceptable and should be avoid therefore the ripple factors at λ 1 are omitted in the figure all the ripple factors decrease as tip speed ratio increase the ripple factors of the variable pitch turbines are smaller than those of the fixed pitch turbine especially at λ λ opt at the λ opt 2 the ripple factor of power output r p of the fixed pitch turbine the sinusoidal pitch turbine and the modified pitch turbine with φ 0 0 are 1 57 0 99 and 0 69 respectively the ripple factor of the rotation speed r ω of the fixed pitch turbine the sinusoidal pitch turbine and the modified pitch turbine with φ 0 0 are 0 84 0 51 and 0 35 respectively so at the λ opt the fluctuations in operation of the modified pitch turbine are about 70 of that of the sinusoidal pitch turbine and 40 of that of the fixed pitch turbine 4 5 influence of rotor s rotational inertia different materials could be used to construct a blade that fulfilling the requirement of stiffness and strength steel is a relative cheap but heavy material whilst compound materials are usually light but very expensive lighter blades are easy to be delivered and installed but the lighter is not always the better since it lead to smaller rotational inertia of the rotor and small inertia rotor tends to fluctuate severely in above discussion of this paper and in most of the previous study an original rotational inertia j z0 1 5 kg m2 is used this value is derived from a blade design which consists of stainless steel skeleton and skin changing the design of blade changes the rotational inertia of the rotor in the previous study the performance of rotors with the rotational inertia equals to 2j z0 and 3j z0 are assessed the results show that the influence of rotational inertia on the average characteristics such as power coefficient and tip speed ratio are very small but larger inertia does make the turbine operate more stable when the rotational inertia is 3j z0 the ripple factors of power output and rotation speed are decreased by a half what would happen if the inertia increase is not limited to be caused by blade design but by installing additional mass block so that the inertia could be increased to whatever needed one might expect that if the rotational inertia is large enough the rotation speed of a vat rotor could be constant to clarify this long existed vague impression performances of modified pitch turbine whose rotational inertia ranges from 1 to 100 j z0 and the φ 0 and the load coefficient b are fixed to 0 and 14 n m s respectively are compared in simulations the vats start up gradually from rest under hydrodynamic driving torque this processes is called self start the results are shown in fig 15 it is shown that c p and λ do not change much when j z j z0 reaches up to 41 meanwhile r p and r ω are only 0 05 and 0 025 respectively the fluctuation in operation is dramatically depressed however a further increase in rotational inertia results in an abrupt falling in both c p and λ as c p and λ falling down r p and r ω suddenly jump up the data shows this is the combination effect of falling mean values and climbing fluctuation amplitudes the clue of what happed could be found in fig 15 c when a blade approaching the most upstream point θ 2π 0 25 the driving torque on it is climbing the rotor accelerates and reaches a peak rotation speed shortly after a peak driving torque reached as the blade runs to the upstream downstream transition point θ 2π 0 5 the driving torque lowers and the resistant load torque proportioned to rotation speed remains high the rotor decelerates until the next blade approaching the most upstream point then the rotor accelerates again in the case of low rotational inertia rotor could be accelerated quickly to an adequate speed so that the blades works in a favourite angle of attack and experiencing higher relative flow speed then generating peak driving torque higher than peak resistant torque the rotor speeds up eventually to a much higher speed at which the peak driving torque and peak resistant torque are finally balanced note a low inertia rotor decelerates quickly either then its operation exhibits higher fluctuation however if the rotational inertia of rotor is very high it cannot be fully speeded up in an acceleration period so that blades cannot generate adequate driving torque to overcome resistant torque in the following deceleration period the rotation speed drops to a fairly low level then the rotor always works at low speed for example in fig 15 c the peak non dimensional rotation speed ω max for j z j z0 41 cases are only at a level of 0 7 it is clear that for a self start vat the c p and λ are not continuous functions of rotational inertia performance of a vat with too large rotational inertia is very poor however if a turbine starts up with external help the story is different for example the turbine j z j z0 43 3 is started up through two different way the first one is the self start mentioned above in this way ω max of the rotor has once reached up to 1 07 but finally slow down to run at λ 0 7 the second is assisted start at first the self start of a lower inertia j z j z0 42 rotor is simulated to tu d 15 5 at that time ω has already been accelerated to 1 1 then the inertia is re set to j z j z0 43 3 and the simulation continued with existed flow field data the rotor keeps accelerating from then on finally operate at λ 1 97 with c p 0 44 and r p 0 024 it seems ω around 1 1 might be a threshold a turbine starts running on its own at an initial speed higher than this threshold would end in a much higher speed steady state otherwise it ends in a steady state with much lower speed to confirm this conclusion a j z j z0 100 turbine is started up in assisted start way after a long acceleration it runs at λ 1 95 with c p 0 43 and r p 0 021 the time series of ω of simulations discussed above is shown in fig 16 if the inertia is increased further to j z j z0 200 with assisted start it eventually operate stably at λ 1 94 with c p 0 42 and r p 0 011 quite close to a constant speed rotation this data is not included in the figure because it hasn t get to stable state until tu d 80 to get a whole picture of rotational inertia influence the performances of self start modified pitch variation turbines with φ 0 0 and varied load coefficients and inertias are compared in fig 17 for a turbine with given inertia as the load coefficient increases from a small value λ decreases monotonously c p increases at first and decreases after a maximum reached in the cases of small inertias e g j z j z0 1 2 and 3 the variation of c p versus λ are almost the same but if the loads are too heavy the turbines are hard to start they cannot operate stably at λ 1 so the data of small inertia turbines at λ 1 are omitted in the figures in the cases of fairly large inertias e g j z j z0 40 and 46 7 when c p reached maximum at λ opt a small increment in load coefficient results in suddenly collapse in both c p and λ variations c p drops to less than 0 05 and λ drops to less than 0 65 this is because the rotor cannot be accelerated to adequate speed in an acceleration period due to large inertia as analysed before the suddenly drop in rotation speed introduce a blank zone ranging from λ 0 7 to nearly 2 where no data of large inertia turbines locate there it is interesting to find that the large inertia turbines can rotate stably even at λ 0 7 because the large inertia helps to smooth out the fluctuations in operation it is found in fig 17 b and c that the ripple factors of power output rotation speed and shaft torque are apparently decreased as inertia increases at the optimal tip speed ratio when j z j z0 increases from 1 to 3 the ripple factors r p and r ω decease by almost 50 when j z j z0 increases to 40 the ripple factors are lowered to only 5 of the original values in general as rotational inertia increases in a fairly large range the power coefficient and the tip speed ratio of a self start turbine do not change much and the ripple factor of power output could be lowered to a level of 0 05 and the fluctuations in shaft torque and rotation speed could be as low as 0 025 but a very large inertia self start turbine would perform poorly since it could never reach an adequate speed so that the hydrodynamic potential of blades be fully exploited however if a very large inertia turbine could reach an initial ω at 1 1 by external assistance it would achieve good performance and operate at an almost constant speed although the price is employing mass units which might be hundred times heavier than a normally designed blades 5 conclusions the sinusoidal pitch variation of h darrieus turbine is modified on the purpose of reducing resistant hydrodynamic torque induced by over pitch especially at the downstream half cycle of rotor s rotation numerical simulations are conducted to assess the effect of this modified pitch the influence of rotational inertia on the vat s operation is systematically studied too by comparing the performance of a fixed pitch turbine a sinusoidal pitch turbine and modified pitch turbine with different parameter combinations the following conclusions are drawn 1 modified pitch variation greatly improved vat s performance turbines with φ 0 0 and 2 and accordingly φ amp 10 and 12 are recommended to practical applications c pmax achieved by these recommended modified pitch turbines is around 0 45 which is 20 higher than that of the original sinusoidal pitch turbine fluctuations in power output shaft torque and rotation speed of the modified pitch turbines are about 70 of those of the sinusoidal pitch turbine even at high tip speed ratio the performance of the sinusoidal pitch turbine falls to the same level of the fixed pitch turbine the modified pitch turbine still maintain performance superiority over them 2 variable pitch turbines provide larger shaft torque than a fixed pitch turbine so that they output higher power without apparently changing turbine s optimal tip speed ratio the modified pitch turbines provide the highest shaft torque than other turbines even at high tip speed ratios meanwhile the peak hydrodynamic loads on the blades of recommended modified pitch turbines are smaller than that on the blades of sinusoidal pitch turbine so that the performance is improved without raising the risk of blade structural failure it implies that the instantaneous peak hydrodynamic loads have no direct relations with the turbine s performance the mean values of them is the big matter 3 for a self start vat the power coefficient c p and tip speed ratio λ are not continuous functions of rotational inertia as the fluctuations in operation decreased quickly as the rotational inertia increases c p and λ do not change much but a very large inertia self start vat would operate at very low c p and λ though stably since it could never reach an adequate speed so that the hydrodynamic potential of blades be fully exploited however if a very large inertia vat could reach an adequate initial rotation speed by external assistance it would achieve good performance but the inertia needed to achieve an almost constant speed is extremely high dynamic effects have played important roles in determining the hydrodynamic loads on the blades so these effects will be studied in future work also note that three dimensional effects including those due to the arms and the finite length of the blades are not included in present work their inclusion would lead to a reduction in the predicted turbine efficiency acknowledgement this work is supported by the general program from the natural science foundation of china nsfc with grant no 51379036 and joint research usage for institute of ocean energy saga university japan with grant no 17c01 the calculations were performed on the supercomputer in the computation centre of dalian university of technology dalian china 
22883,the traditional potential flow based hydroelasticity computation is unable to directly simulate the violent free surface deformation and slamming and has a lack of mutual interactions between rigid body and flexible motion parts in this paper the modified mps moving particle semi implicit and modal superposition methods are used for the time domain hydroelasticity computation of cylindrical shell and non uniform beam structures involving violent free surface deformation and slamming the improved modal superposition technique is revisited and extended to derive the time domain governing equations for flexible shell and non uniform beam motions which couples rigid body and flexible modes and considers the mutual interaction between them the modified mps method developed by the authors previously is first validated by the rigid cylinder water problem and then the flexible cylindrical shell water entry and ship hull structure slamming are simulated relatively good agreement has been obtained between current results and the available numerical and experimental data which shows the feasibility of the proposed model for the hydroelasticity computation involving violent free surface deformation keywords hydroelasticity mps moving particle semi implicit method modal superposition time domain 1 introduction the trend of larger and faster ships and marine structures makes the natural frequency of the structure and encountered wave frequency tend to fall in the same range this means the hydroelasticity effect is becoming more important for the overall and fatigue analysis of the marine structures one of the typical transient and highly non linear hydroelasticity phenomena is called whipping which is the transient vibration caused by impulsive hydrodynamic load induced by slamming the whipping effect could add high frequency vibration to the structure response in a regular base several accidents have been considered to be caused by whipping tuitman 2010 final report of committe 2015 the structure integrity analysis under such condition requires the simulation in time domain traditional potential flow based solver is not capable of directly simulating the violent free surface deformation during slamming which gives rise to the need of cfd based solver for the flow computation seng et al 2014 lakshmynarayanana et al 2015 as stated by hirdaris and temarel 2009 the use of rans cfd methods as part of or coupled to hydroelastic solutions is the ultimate goal compared to traditional mesh based cfd methods the particle method such as sph monaghan 1994 and mps koshizuka and oka 1996 is very suitable for the simulation of large free surface deformation since there is no mesh distortion problem and the flow is updated in a lagrangian way as one of the mainstream particle methods the mps method has been modified and applied to various violent fluid and structure interaction problems sun et al 2015 sun 2016 zhang and wan 2017 furthermore the typical motion of ships is large rigid body motion plus relatively small elastic deformations this means the modal superposition theory is accurate enough to simulate the flexible part however in the traditional hydroelasticity analysis kara 2015 the rigid body and flexible part are only linked in the sense of hydrodynamic coefficients for the cross terms the mutual interaction between rigid body and flexible modes themselves are not considered in this study the modified mps method and modal superposition technique are applied for the simulation of the dynamic response of shell and beam structure during slamming in the previous researches by the authors the mps method was modified to improve the accuracy of pressure computation and stability sun et al 2015 whilst the time domain coupled rigid body and flexible modes model was proposed to include the mutual effect between them the rest of the paper is organised as follows first the key points of the modified mps method is briefly illustrated second the coupled rigid body and flexible modes model previously developed by the authors are revisited and extended to derive the time domain governing equations for flexible shell and non uniform beam structures third the results and discussions of the developed hydroelasticity are presented and finally the conclusion and future work plan are given in the last session 2 methodology 2 1 fluid solver modified mps method the modified mps model that has been developed by the authors sun et al 2015 2019 was used here as fluid solver a brief description of the model is given below 2 1 1 governing equations and solving procedure the incompressible inviscid navier stokes equation and continuity equation in the langrangian frame are used in this study as shown in eq 2 1 1 2 1 1 d u d t g p ρ 1 u 0 2 where u p and ρ represent fluid velocity pressure and density g 0 g is the vector pointing to the gravity direction the velocity and pressure are decoupled by the classic projection method as follows firstly the flow is advanced to the intermediate state by just the inertia without considering the pressure as in eq 2 1 2 2 1 2 u u n δ t g 1 r r n δ t u 2 in which r is the position vector the variables with subscript and n mean intermediate and n th time step respectively secondly the pressure poisson equation is derived based on the continuity equation i e eq 2 1 1 2 as eq 2 1 3 2 1 3 2 p n 1 ρ u δ t α ρ n 0 n n n 0 δ t 2 where n 0 and n n are defined as particle density later in eq 2 1 9 for initial and nth time step respectively the coefficient α is defined in eq 2 1 4 2 1 4 α n 0 n n n 0 δ t u n n 0 n n u n 0 n 0 n n n 0 n 0 n n u n 0 the form of α requires no special calibration according to different problems which makes it a more robust model compared to other similar forms kondo and koshizuka 2011 lee et al 2011 lastly the position and velocity of the fluid are updated by the newly computed pressure as eq 2 1 5 2 1 5 u n 1 u δ t p n 1 ρ 0 r n 1 r n δ t u n 1 2 1 2 spatial discretization in mps method the continuous field is discretized by a set of particles and the gradient divergence and laplacian operators are modeled by a weighted averaging approach as in eq 2 1 6 2 1 6 ϕ r i d m n 0 j i n ϕ r j ϕ r i r i j 2 r j r i w r i j 1 2 ϕ r i 2 d m n 0 λ j i n ϕ r j ϕ r i w r i j 2 φ r i d m n 0 j i n φ r j φ r i r j r i r i j 2 w r i j 3 where ϕ and φ represent arbitrary scalar and vector variables d m is the dimension of the problems i e 2d or 3d n is the number of particles within the influence area of the concerned particle with radius of this circle r e chosen to be 2 1 r 0 and 4 0 r 0 r 0 is the initial distance of particles for the gradient divergence and laplacian respectively the weight function w r i j and parameter λ are defined as eq 2 1 7 2 1 8 2 1 7 w r i j r e r i j 1 0 r i j r e 2 1 8 λ j i n w r i j r i j 2 j i n w r i j the particle density aforementioned is defined in eq 2 1 9 2 1 9 n j i n w r i j in order to maintain more regular particle distribution to improve the stability and accuracy of the computation particle shifting and collision handling predominantly for free surface particles techniques were used in the modified mps model sun et al 2015 as in eq 2 1 10 2 1 11 respectively 2 1 10 δ r i j i r 0 r i j 2 r i r j r i j w h e n r i j r 0 2 1 11 δ u i j i ε r i j u τ i j w h e n r i j u τ i j δ t r m i n r m i n 0 3 r 0 where u τ i j is the tangential relative velocity between particle i and j and ε is chosen to be 0 5 and 1 0 for solid and fluid neighbor particles respectively the weighted averaging spatial discretization requires the information of neighbor particles within the influence circle since the fluid particles are under constant movement during the simulation and thus the neighbor particle information has to be updated every time step a more efficient cell link approach is proposed to conduct the neighbor particle searching in the modified mps model sun et al 2015 which only used roughly 2 5 9 of the original cell link approach 2 1 3 boundary conditions the boundary conditions for solving poisson equation i e eq 2 1 3 are listed below 1 solid boundary condition the neumann boundary condition is applied on the solid particles as in eq 2 1 12 2 1 12 n p n 1 ρ n g n u b n 1 ρ n g n u b n where u b n and u b n 1 are the acceleration of the solid boundary particles at nth and n 1 th time steps since u b n 1 is unknown when solving the fluid motion for n 1 th time step the value from last time step u b n is used instead as an approximation for the fluid particles close to solid boundary the discretizations in eq 2 1 6 are modified to make it consistent with eq 2 1 12 by considering the pressure value of virtual particles outside solid boundary furthermore also for these near boundary fluid particles the source term in poisson equation eq 2 1 3 will include the contribution from solid boundary particles in the influence domain as a consequent the intermediate velocities of the affected solid boundary particles are modified as in eq 2 1 13 for the same consistency reason 2 1 13 n u b n u b n 1 δ t n g n u b n τ u b τ u b n 1 δ t ρ 0 p n τ where u b and u b n 1 are the velocities of the solid boundary particles at intermediate and n 1 th time steps 2 free surface boundary condition the solving of the poisson equation eq 2 1 3 requires the identification of free surface particles and imposing zero pressure boundary condition on it for the 2d case the simplified version of the technique used by koh koh et al 2012 was developed in modified mps model more specifically a circle with radius of 1 05r 0 is assigned to each particle if the 360 points evenly distributed on the circle are covered by the circles of neighbor particles this particle will be recognized as inner fluid particle particle b in fig 1 a otherwise it will be recognized as free surface particle particle a in fig 1 a the checking process is conducted by going through each neighbor particle and identifying the overlapped points on the arc or patch in 3d case below of the concerned particle that is covered by each neighbor particle for the 3d case a two step approach is adopted first the potential free surface particles are detected by checking the neighbor particle number n p using eq 2 1 14 2 1 14 n p β 3 d n p 0 where n p 0 32 β 3 d 0 96 in this study secondly the searching is refined by establishing a sphere centered by the concerned particle with radius of 1 05r 0 as shown in fig 1 b more specifically a vector n z that points towards the most sparse particle distribution around the concerned particle is determined by a weighted averaging approach a circular patch around n z is then discretized by evenly distributed points as shown in fig 1 b similarly to the 2d cases if all these points are covered by the spheres of other neighbor particles the particle will be recognized as inner fluid particle otherwise it will be marked as free surface particle 2 2 structure solver improved modal superposition method the dynamic response of typical marine structures to wave impact can be characterized as large rigid body motion and relatively small elastic deformation which means the modal superposition approach is capable to handle the flexible motion part in this section an improved modal superposition model that has been developed by the authors sun et al 2016 is extended to solve the 2d circular cylinder and non uniform beam simplification for ship hull slamming problems 2 2 1 lagrangian equation the main feature of the model used in this study is that the rigid body and flexible modes are coupled in time domain their mutual interaction such as the inertia effect of rigid body motion on flexible deformation is considered this is an extension to the tradition hydroelasticity theory in which rigid body and flexible parts are only linked by hydrodynamic coefficients for corresponding cross terms the model is developed based on the following lagrangian equation 2 2 1 d d t t q j u q j t q j q j j 1 2 3 where t and u represent the kinetic and potential energy of the structure system respectively q j is the general coordinates corresponding to any rigid and flexible mode and q j represents the non conservative forces corresponding to j th coordinate the specific forms of t u q j and q j for cylinder shell and non uniform beam are given in the following subsections 2 2 2 special case 1 cylinder shell as shown in fig 2 the problem of circular cylinder dropping above calm water surface is investigated here two coordinate systems are used which are the fixed global x y system and body attached local x y system the normal and tangential deformations of the cylinder shell with respect to the undeformed middle plane of the shell are represented as w and v respectively the normal and tangential vectors on the shell surface are n and e the external diameter and middle plane radius thickness of the shell are represented as d r and h as shown in fig 2 the center of the cylinder also the origin of the local x y system is x r c the position of any point on the cylinder shell in the global system can be described as eq 2 2 2 2 2 2 x x r c x w n v e where x x y x r c x r c y r c x x y x is the position of the undeformed cylinder shell which does not change with time for a particular point the normal and tangential displacements of any point on the shell are described by eq 2 2 3 2 2 3 w w 0 1 v v 0 z r v 0 w 0 β 2 where w 0 and v 0 are the corresponding normal and tangential displacements of the middle plane β is the angle defined in fig 2 and z is the distance between any point on the shell and the middle plane along the normal direction which takes positive value towards the inner surface of the shell the strain of the shell is defined as eq 2 2 4 2 2 4 ε ε 0 z χ 0 where the strain of the middle plane ε 0 and parameter χ 0 are defined as 2 2 5 ε 0 1 r v 0 β w 0 2 2 6 χ 0 1 r 2 v 0 β 2 w 0 β 2 as a result the stress of the shell is defined as eq 2 2 7 2 2 7 σ e 1 γ 2 ε e 1 γ 2 ε 0 z χ 0 where e is the young s modulus γ is the poisson s ratio the normal and tangential displacements of the middle plane are then expanded as the summation of orthogonal modes in eq 2 2 8 2 2 8 w 0 a 0 n 2 a n cos n β 1 v 0 n 2 b n sin n β 2 where a n and b n are the general coordinates of the normal and tangential deformation modes for the normal mode the case n 0 represents the radial deformation which is very small under non symmetric loading as in the impact process in this study a discussion will be given in section 3 the case n 1 for w and v corresponds to the rigid body motion which has been taken into account separately by x r c by using eq 2 2 2 2 2 8 the kinetic and potential energies of the structure system can be derived as eq 2 2 9 2 2 10 2 2 9 t 0 2 π h 2 h 2 1 2 x t ρ s x r d z d β ρ s r 2 0 2 π h 2 h 2 x r c w n v e t x r c w n v e d z d β m 2 y r c 2 m 4 a t a b t b 2 a 0 2 d 3 b t b a t k 2 a 2 b t k 1 a 2 2 10 u m g y r c 0 2 π h 2 h 2 σ ε d z d β m g y r c 0 2 π h 2 h 2 e 1 γ 2 ε 0 z χ 0 2 d z d β m g y r c 2 π d 1 a 0 2 π d 1 b t k 2 b 2 a t k 1 b a t a π d 2 b t k 2 b 2 a t k 3 b a t k 4 a where ρ s is the density of the structure and a a 2 a 3 a 4 t b b 2 b 3 b 4 t are the column vectors of the general coordinates for w and v respectively k m d 1 d 2 and d 3 are defined in eq 2 2 11 and eq 2 2 12 respectively 2 2 11 k m d i a g n m n 2 3 4 2 2 12 d 1 e h 2 1 γ 2 r 1 d 2 e h 3 24 1 γ 2 r 3 2 d 3 ρ s π h 3 24 r 3 as can be seen in eq 2 2 12 d 3 is much smaller than d 1 and d 2 since the young s module e is in the order of 1010 for steel or other common mental materials hence its effect is expected to be negligible a discussion will be given in section 3 to show the effect of d 3 after substituting eq 2 2 9 2 2 10 into eq 2 2 1 the governing equations for the dynamic response of flexible cylinder shell are derived as in eq 2 2 13 2 2 13 m y r c m g q y r c m a 0 4 π d 1 a 0 q a 0 m 2 a t 2 d 3 a t k 2 b t k 1 2 π d 1 a t b t k 1 2 π d 2 a t k 4 b t k 3 q a m 2 b t 2 d 3 b t a t k 1 2 π d 1 b t k 2 a t k 1 2 π d 2 b t k 2 a t k 3 0 where q a q a 1 q a 2 q a 3 t q a 0 q a n and q y r c are defined in eq 2 2 14 2 2 16 2 2 14 q a 0 0 2 π p r d β 2 2 15 q a n 0 2 π p cos n β r d β n 1 2 3 2 2 16 q y r c 0 2 π p n y r d β where p is the pressure applied on the cylinder surface and n y is the y component of the local normal vector expressed in global system apart from the term with d 3 the governing equations eq 2 2 13 is the same as the ones used by other researcher e g sun 2007 and khabakhpasheva 2009 as aforementioned the effect of d 3 is very small and will be discussed later in section 3 moreover the rigid body and flexible modes are separated in this case this is mainly because the structure does not have angular motion as will be shown in section 2 2 3 the angular motion is the main reason that cross term between rigid body and flexible modes exist 2 2 3 special case 2 non uniform beam in this subsection the case of non uniform floating beam subjecting to wave impact as shown in fig 3 is studied similar to the cylinder shell case two coordinate systems are used here i e fixed global x y system and body attached local s η system the origin of the local system is chosen at the center of gravity of the beam θ is defined as the angle from axis o x to axis o s anticlockwise as a result the position of any point on the beam can be described by eq 2 3 1 2 3 1 x x r b r ξ t where the local coordinate ξ and rotation matrix r are defined in eq 2 3 2 2 3 3 2 3 2 ξ s η l η 0 2 3 3 r cos θ sin θ sin θ cos θ where η l and η 0 mean the coordinates of the undeformed structure and the deflection of the middle plane respectively therefore η l is constant for a particular point on the beam moreover based on the beam assumption in this case the deflection of any layer parallel to the middle plane is assigned with the same value of the middle plane following the modal superposition theory the deflection η 0 of the middle plane is expanded as eq 2 3 4 2 3 4 η 0 ϕ t q b where the column vectors of mode functions ϕ and corresponding general coordinate q b are defined in eq 2 3 5 2 3 6 2 3 5 ϕ φ 1 φ 2 φ 3 t 2 3 6 q b q b 1 q b 2 q b 3 t the following orthogonal relations are satisfied by the mode functions 2 3 7 s 1 s 2 ϕ ρ l ϕ t d s i i s u n i t m a t r i x 2 3 8 s 1 s 2 d 2 ϕ d s 2 e i d 2 ϕ t d s 2 d s λ λ d i a g ω i 2 i 1 2 3 where s 1 and s 2 are the lower and upper limits of the integration along s axis and ρ l is the line density of the beam the kinetic and potential energies can be derived by using eq 2 3 1 2 3 8 as follows 2 3 9 t 1 2 s 1 s 2 η 1 η 2 x t ρ s x d η d s 1 2 s 1 s 2 η 1 η 2 x r r u θ ξ r ξ t ρ s x r r u θ ξ r ξ d η d s 1 2 m x r 2 y r 2 θ 2 i b θ 2 q b t q b q b t q b 2 θ x r cos θ y r sin θ q b t ψ 0 2 x r sin θ y r cos θ q b t ψ 0 2 θ q b t ψ 1 2 3 10 u 1 2 s 1 s 2 d 2 η 0 d s 2 e i d 2 η 0 d s 2 d s m g y r 1 2 q b t s 1 s 2 d 2 ϕ d s 2 e i d 2 ϕ t d s 2 d s q b m g y r 1 2 q b t λ q b m g y r where η 1 and η 2 are the lower and upper limits of the integration along η axis and matrix u column vectors ψ 0 and ψ 1 are defined in eq 2 3 11 2 3 13 2 3 11 u 0 1 1 0 2 3 12 ψ 0 ψ 01 ψ 02 ψ 03 t s 1 s 2 ϕ ρ l d s 2 3 13 ψ 1 ψ 11 ψ 12 ψ 13 t s 1 s 2 s ϕ ρ l d s by substituting eq 2 3 9 2 3 10 into eq 2 2 1 the governing equations for dynamic response of flexible floating beam to wave impact are derived in eq 2 3 14 2 3 14 m x r b θ 2 sin θ ψ 0 t q b 2 θ cos θ ψ 0 t q b θ cos θ ψ 0 t q b sin θ ψ 0 t q b q x r b m y r b θ 2 cos θ ψ 0 t q b 2 θ sin θ ψ 0 t q b θ sin θ ψ 0 t q b cos θ ψ 0 t q b m g q y r b x r b cos θ y r b sin θ ψ 0 t q b i b θ θ q b t q b 2 θ q b t q b ψ 1 t q b q θ x r b sin θ y r b cos θ ψ 0 θ ψ 1 q b λ q b θ 2 q b q q b where the non conservative forces corresponding to the general coordinates of rigid body and flexible modes are given in eq 2 3 15 2 3 18 2 3 15 q x r b p n s d l 2 3 16 q y r b p n η d l 2 3 17 q θ p x p n η y p n s d l 2 3 18 q q b p n e η ϕ d l where n s and n η are the s and η components of the local normal vector expressed in global system x p and y p are the global x and y coordinates of the point where pressure p is applied and e η is the unit vector of the o η axis the integration is conducted around the perimeter of the beam as can be seen from eq 2 3 14 the angular motion is responsible for the mutual interaction between rigid body and flexible modes i e the cross terms this effect has been shown in ref sun et al 2016 for the uniform beam and flexible wedge cases 2 2 4 updating structure configuration and interaction with fluid solver the flexible deformation is updated based on the assumption that the layers parallel to neutral line of the structure undergoes the same deformation as the neutral line i e the particles on the structure surface are shifted perpendicular to the undeformed beam neutral line by the deflection value of the neutral line this means the original cross section of the beam will remain parallel to each other this way of updating structure position is helpful to maintain a roughly regular particle distribution compared to the way in which the cross section rotates with the deformed beam neutral line which will make structure surface particle distribution becomes denser or sparser on the up and bottom surface of bended structure also since the flexible deformation is relatively small the aforementioned two ways of particle updating will end up with a very similar final surface configuration however the first one will give a more regular particle distribution for the fluid and structure interaction process the standard iterative approach is adopted until certain criterion is met the detailed information can be found in reference sun et al 2016 and will not be listed here for simplicity reason 3 results and discussions 3 1 water entry of cylinder in this section the rigid and flexible cylinder shell water entry problems are simulated and compared with experimental results 3 1 1 rigid body case the experiment conducted by greenhow and lin 1983 was simulated in the experiment two cylinders with diameter d 0 11 m are dropped from a height of 0 5 m which means the entry speed is v 2 955 m s the weights of these two cylinders are chosen to be the whole and half of the buoyancy force applied on a totally submerged cylinders as a result they are marked as neutral buoyant and half buoyant in the later context respectively the experimental data was given from the entry time t 0 0 301s while the numerical simulation started from the moment just before entry the free surface first a convergence test about the particle resolution was performed for the half buoyant case the initial configuration of the simulation was the same as shown in fig 2 in which the tank length and water depth were set as l 1 m h 0 5 m respectively three different particle distances were simulated i e dr 0 0075 m 0 005 m 0 0025 m roughly 1 15 1 22 and 1 44 of the cylinder s diameter which results in 9045 20000 and 80200 fluid particles for each case the time intervals were controlled by cfl courant friedrich levy condition and the initial value was 0 0002s as is shown in fig 4 all the three simulations matched well with the experimental result and the maximum difference at about 0 44s between three cases was around 3 of the bem result at the corresponding time instant which means it is not sensitive to spatial resolution the mps result tends to converge to the boundary element method bem result by sun 2007 in order to achieve a balance between computational time and accuracy the particle distance dr 0 005 m was chosen for the neutral buoyancy case simulation the comprehensive comparison between mps bem and experimental results for both neutral and half buoyant cases were given in fig 5 reasonably agreement was achieved however the discrepancy between numerical both bem and mps and experimental results were relatively larger in the neutral buoyant case than that in half buoyant case especially at the time with a question mark greenhow and lin noticed this obvious deviation from the main trend and put this question mark in their report greenhow and lin 1983 also both bem and mps results for the neutral buoyant case was lower than experimental result this could be due to the 3d effect especially when the flow speed around cylinder is relatively larger in the neutral case in figs 6 and 7 the free surface profiles at some typical time instants from experiment bem and mps computation were compared generally a reasonable good agreement with both results was achieved the instability of the free surface in the cavity area above the cylinder in neutral buoyant case in fig 7 was not observed in mps or bem results which again could be explained that the 3d effect could not be captured by the current 2d model furthermore since the surface tension was not included in the current mps model the water splashing at the end of the jet could only be simulated by the inertia effect of the water particles which results in a sparser particle distribution in that area compared to experimental result apart from including surface tension model in the computation a better result can potentially be achieved by using more refined resolution as well but obviously this practice resolution will compromise the computational efficiency multi resolution technique was planned to be adopted in the future work to tackle this dilemma the pressure contours computed by the mps method show a smooth spatial distribution 3 1 2 flexible case in this subsection the cylinder shell water entry experiment conducted by shibue et al 1993 was simulated the parameters used in the experiment and numerical simulation were listed in table 1 since this was a 2d simulation the length of the cylinder was assumed to be 1 m so the mass was increased from 23 8 kg corresponding to the length of 0 6 m to 39 2 kg corresponding to the length of 1 m in the simulation as shown in table 1 the length l and water depth h of the tank as shown in fig 2 are chosen to be 2 m and 0 6 m respectively the initial particle distance is 0 0075 m about 1 42 of the cylinder s diameter which results in 21360 fluid particles the time interval is selected as 0 0002s and subject to cfl condition the elongation of the middle plane was investigated by comparing the strain in the inner surface of the shell i e z h 2 in eq 2 2 4 at β 0 with and without the strain of the middle plane ε 0 the mode number was chosen to be three in eq 2 2 13 as shown in fig 8 the value of ε 0 was negligible for the dynamic response of the cylinder shell impact problem which is consistent with the discussion by sun 2007 as mentioned in section 2 2 the parameter a 0 in eq 2 2 8 1 represents the radial deformation which is the elongation of the middle plane as shown in fig 9 the value of the strain at the same position inner surface β 0 presents no visible difference with red line and without green line a 0 which confirms that the middle plane elongation is negligible furthermore the effect of parameter d 3 in the governing equation eq 2 2 12 is shown in fig 9 it can be seen that the inner surface strain at β 0 was almost not affected by excluding d 3 in the computation red and blue line in fig 9 this is consistent with the discussion in section 2 2 for d 3 a more systematic comparison of the inner surface strain was given in fig 10 from a b the time histories of strain at β 0 10 20 30 were compared with experimental results four mode numbers i e 2 3 4 5 were used in the simulation although the main trend and time instants when peak value occurs match well with the experimental results the value of the peak in the simulation was significantly lower than that from the experiment the increase of mode number tended to produce slightly larger peak value but still smaller than experimental results this could be due to the underestimation of the pressure especially during the initial impact stage the pressure time history of the cylinder bottom β 0 is shown in fig 11 the pressure spatial distribution at typical time instants corresponding to a d in fig 10 are shown in fig 12 a relatively smooth pressure distribution was obtained by the mps simulation 3 2 slamming of 3d ship hull the final case was conducted to test the modified mps and non uniform beam model for practical complex geometry the 1 100 model of a 4600 tones oil tanker was used for the simulation of violent wave and ship interaction i e the impact of breaking dam to floating ship the dynamic response of the ship was assumed be to 2d i e only pitch heave and vertical bending are considered which makes the non uniform beam model in section 2 2 is applicable to this case the main parameters of the ship model are listed in table 2 the ship model was placed in a tank facing the impact from breaking dam and the initial configuration is shown in fig 13 the tank width and length are chosen to be about 3 times of the ship breadth and length respectively the body plan and final surface discretization are shown in fig 14 the particle distance on the ship surface was made roughly to the same as the fluid domain resolution i e 0 02 m about 1 90 of the ship length total particle number was 289417 in which 193284 of them were fluid particles the initial time step was 0 002s and subject to cfl condition the mass distribution of the ship was assumed to be the same as its occupied water volume and the hull thickness was chosen to be 0 05 m for the calculation of 2nd moment for cross section fig 15 shows the resultant mass and 2nd moment distribution of the model ship the mode shape function of this non uniform beam was calculated by myklestad s method myklestad 1944 and the first three mode shape functions are shown in fig 16 the young s modulus e 2 104 n m2 and the circular natural frequencies for the first three modes are ω 1 3 7857 ω 2 9 7777 ω 3 18 2063 the free surface profiles at some typical time instants are shown in fig 17 the free surface particles the ship surface above and under the free surface were marked as red blue and black respectively as can be seen in fig 17 there were no misidentified free surface particles under the free surface in this simulation the amplitude of the deformation was significantly larger than the normal ship structure this deliberately chosen low stiffness was to test the capability of the coupling between modified modal superposition and mps models fig 17 a b and c show the developing process of the impact wave caused by the breaking dam at different times the fact that the draught of the ship remains the same proves that the buoyancy force calculated by the mps was accurate and stable to support the ship weight the impact of the wave on the bow of ship occurs at t 0 418s in fig 17 c the crescent of the wave generates the largest bending moment as the wave propagating along the ship hull fig 17 d f and correspondingly causeed the largest deformations this qualitative analysis shows that the coupling between modified mps and the proposed structure model is capable of providing reasonable results for the simulation of wave and structure interaction a primary analysis of the general coordinates corresponding to each mode showed that the mode of lower order tends to take higher percentage of the total response as expected however more quantitative analysis by comparing against published experimental or numerical results would be required to further verify the reliability of this model in the future 4 conclusion and future work the modified mps and modal superposition methods were applied to compute the hydroelasticity response of typical marine structures i e cylindrical shell and ship hull in this study involving violent free surface deformation and slamming the fluid solver was first validated by the rigid body cylinder water entry problem and relatively good match was achieved between mps result and available data in the literature both numerical and experimental results the elastic cylindrical shell impact problem was then computed and compared against experimental result although the main trend of the shell deformation can be captured by the proposed model it shows an underestimation of the peak strain value the slamming of an oil tanker hull was then simulated to show the capability of the coupling model in directly computing slamming force and capturing large free surface structure displacement in time domain the future work of refining the current coupling model includes improving pressure accuracy and combing potential flow solver with mps in time or space domain one of the possible ways of improving pressure simulation accuracy and efficiency is by computing poisson equation in the background grid and the weakly coupling with potential flow solver mainly to improve the computational efficiency in time domain which has been realized by the authors sun et al 2017 in previous work is expected to extended for this simulation acknowledgement this work is supported by the national natural science foundation of china no 51639003 51809035 51679037 and 51579042 fundamental research funds for the central universities no dut17rc 3 017 and dut2017tb05 joint found for equipment pre research and china shipbuilding industry corporation 6141b04010103 and the supercomputing center of dalian university of technology to which the authors are most grateful 
22883,the traditional potential flow based hydroelasticity computation is unable to directly simulate the violent free surface deformation and slamming and has a lack of mutual interactions between rigid body and flexible motion parts in this paper the modified mps moving particle semi implicit and modal superposition methods are used for the time domain hydroelasticity computation of cylindrical shell and non uniform beam structures involving violent free surface deformation and slamming the improved modal superposition technique is revisited and extended to derive the time domain governing equations for flexible shell and non uniform beam motions which couples rigid body and flexible modes and considers the mutual interaction between them the modified mps method developed by the authors previously is first validated by the rigid cylinder water problem and then the flexible cylindrical shell water entry and ship hull structure slamming are simulated relatively good agreement has been obtained between current results and the available numerical and experimental data which shows the feasibility of the proposed model for the hydroelasticity computation involving violent free surface deformation keywords hydroelasticity mps moving particle semi implicit method modal superposition time domain 1 introduction the trend of larger and faster ships and marine structures makes the natural frequency of the structure and encountered wave frequency tend to fall in the same range this means the hydroelasticity effect is becoming more important for the overall and fatigue analysis of the marine structures one of the typical transient and highly non linear hydroelasticity phenomena is called whipping which is the transient vibration caused by impulsive hydrodynamic load induced by slamming the whipping effect could add high frequency vibration to the structure response in a regular base several accidents have been considered to be caused by whipping tuitman 2010 final report of committe 2015 the structure integrity analysis under such condition requires the simulation in time domain traditional potential flow based solver is not capable of directly simulating the violent free surface deformation during slamming which gives rise to the need of cfd based solver for the flow computation seng et al 2014 lakshmynarayanana et al 2015 as stated by hirdaris and temarel 2009 the use of rans cfd methods as part of or coupled to hydroelastic solutions is the ultimate goal compared to traditional mesh based cfd methods the particle method such as sph monaghan 1994 and mps koshizuka and oka 1996 is very suitable for the simulation of large free surface deformation since there is no mesh distortion problem and the flow is updated in a lagrangian way as one of the mainstream particle methods the mps method has been modified and applied to various violent fluid and structure interaction problems sun et al 2015 sun 2016 zhang and wan 2017 furthermore the typical motion of ships is large rigid body motion plus relatively small elastic deformations this means the modal superposition theory is accurate enough to simulate the flexible part however in the traditional hydroelasticity analysis kara 2015 the rigid body and flexible part are only linked in the sense of hydrodynamic coefficients for the cross terms the mutual interaction between rigid body and flexible modes themselves are not considered in this study the modified mps method and modal superposition technique are applied for the simulation of the dynamic response of shell and beam structure during slamming in the previous researches by the authors the mps method was modified to improve the accuracy of pressure computation and stability sun et al 2015 whilst the time domain coupled rigid body and flexible modes model was proposed to include the mutual effect between them the rest of the paper is organised as follows first the key points of the modified mps method is briefly illustrated second the coupled rigid body and flexible modes model previously developed by the authors are revisited and extended to derive the time domain governing equations for flexible shell and non uniform beam structures third the results and discussions of the developed hydroelasticity are presented and finally the conclusion and future work plan are given in the last session 2 methodology 2 1 fluid solver modified mps method the modified mps model that has been developed by the authors sun et al 2015 2019 was used here as fluid solver a brief description of the model is given below 2 1 1 governing equations and solving procedure the incompressible inviscid navier stokes equation and continuity equation in the langrangian frame are used in this study as shown in eq 2 1 1 2 1 1 d u d t g p ρ 1 u 0 2 where u p and ρ represent fluid velocity pressure and density g 0 g is the vector pointing to the gravity direction the velocity and pressure are decoupled by the classic projection method as follows firstly the flow is advanced to the intermediate state by just the inertia without considering the pressure as in eq 2 1 2 2 1 2 u u n δ t g 1 r r n δ t u 2 in which r is the position vector the variables with subscript and n mean intermediate and n th time step respectively secondly the pressure poisson equation is derived based on the continuity equation i e eq 2 1 1 2 as eq 2 1 3 2 1 3 2 p n 1 ρ u δ t α ρ n 0 n n n 0 δ t 2 where n 0 and n n are defined as particle density later in eq 2 1 9 for initial and nth time step respectively the coefficient α is defined in eq 2 1 4 2 1 4 α n 0 n n n 0 δ t u n n 0 n n u n 0 n 0 n n n 0 n 0 n n u n 0 the form of α requires no special calibration according to different problems which makes it a more robust model compared to other similar forms kondo and koshizuka 2011 lee et al 2011 lastly the position and velocity of the fluid are updated by the newly computed pressure as eq 2 1 5 2 1 5 u n 1 u δ t p n 1 ρ 0 r n 1 r n δ t u n 1 2 1 2 spatial discretization in mps method the continuous field is discretized by a set of particles and the gradient divergence and laplacian operators are modeled by a weighted averaging approach as in eq 2 1 6 2 1 6 ϕ r i d m n 0 j i n ϕ r j ϕ r i r i j 2 r j r i w r i j 1 2 ϕ r i 2 d m n 0 λ j i n ϕ r j ϕ r i w r i j 2 φ r i d m n 0 j i n φ r j φ r i r j r i r i j 2 w r i j 3 where ϕ and φ represent arbitrary scalar and vector variables d m is the dimension of the problems i e 2d or 3d n is the number of particles within the influence area of the concerned particle with radius of this circle r e chosen to be 2 1 r 0 and 4 0 r 0 r 0 is the initial distance of particles for the gradient divergence and laplacian respectively the weight function w r i j and parameter λ are defined as eq 2 1 7 2 1 8 2 1 7 w r i j r e r i j 1 0 r i j r e 2 1 8 λ j i n w r i j r i j 2 j i n w r i j the particle density aforementioned is defined in eq 2 1 9 2 1 9 n j i n w r i j in order to maintain more regular particle distribution to improve the stability and accuracy of the computation particle shifting and collision handling predominantly for free surface particles techniques were used in the modified mps model sun et al 2015 as in eq 2 1 10 2 1 11 respectively 2 1 10 δ r i j i r 0 r i j 2 r i r j r i j w h e n r i j r 0 2 1 11 δ u i j i ε r i j u τ i j w h e n r i j u τ i j δ t r m i n r m i n 0 3 r 0 where u τ i j is the tangential relative velocity between particle i and j and ε is chosen to be 0 5 and 1 0 for solid and fluid neighbor particles respectively the weighted averaging spatial discretization requires the information of neighbor particles within the influence circle since the fluid particles are under constant movement during the simulation and thus the neighbor particle information has to be updated every time step a more efficient cell link approach is proposed to conduct the neighbor particle searching in the modified mps model sun et al 2015 which only used roughly 2 5 9 of the original cell link approach 2 1 3 boundary conditions the boundary conditions for solving poisson equation i e eq 2 1 3 are listed below 1 solid boundary condition the neumann boundary condition is applied on the solid particles as in eq 2 1 12 2 1 12 n p n 1 ρ n g n u b n 1 ρ n g n u b n where u b n and u b n 1 are the acceleration of the solid boundary particles at nth and n 1 th time steps since u b n 1 is unknown when solving the fluid motion for n 1 th time step the value from last time step u b n is used instead as an approximation for the fluid particles close to solid boundary the discretizations in eq 2 1 6 are modified to make it consistent with eq 2 1 12 by considering the pressure value of virtual particles outside solid boundary furthermore also for these near boundary fluid particles the source term in poisson equation eq 2 1 3 will include the contribution from solid boundary particles in the influence domain as a consequent the intermediate velocities of the affected solid boundary particles are modified as in eq 2 1 13 for the same consistency reason 2 1 13 n u b n u b n 1 δ t n g n u b n τ u b τ u b n 1 δ t ρ 0 p n τ where u b and u b n 1 are the velocities of the solid boundary particles at intermediate and n 1 th time steps 2 free surface boundary condition the solving of the poisson equation eq 2 1 3 requires the identification of free surface particles and imposing zero pressure boundary condition on it for the 2d case the simplified version of the technique used by koh koh et al 2012 was developed in modified mps model more specifically a circle with radius of 1 05r 0 is assigned to each particle if the 360 points evenly distributed on the circle are covered by the circles of neighbor particles this particle will be recognized as inner fluid particle particle b in fig 1 a otherwise it will be recognized as free surface particle particle a in fig 1 a the checking process is conducted by going through each neighbor particle and identifying the overlapped points on the arc or patch in 3d case below of the concerned particle that is covered by each neighbor particle for the 3d case a two step approach is adopted first the potential free surface particles are detected by checking the neighbor particle number n p using eq 2 1 14 2 1 14 n p β 3 d n p 0 where n p 0 32 β 3 d 0 96 in this study secondly the searching is refined by establishing a sphere centered by the concerned particle with radius of 1 05r 0 as shown in fig 1 b more specifically a vector n z that points towards the most sparse particle distribution around the concerned particle is determined by a weighted averaging approach a circular patch around n z is then discretized by evenly distributed points as shown in fig 1 b similarly to the 2d cases if all these points are covered by the spheres of other neighbor particles the particle will be recognized as inner fluid particle otherwise it will be marked as free surface particle 2 2 structure solver improved modal superposition method the dynamic response of typical marine structures to wave impact can be characterized as large rigid body motion and relatively small elastic deformation which means the modal superposition approach is capable to handle the flexible motion part in this section an improved modal superposition model that has been developed by the authors sun et al 2016 is extended to solve the 2d circular cylinder and non uniform beam simplification for ship hull slamming problems 2 2 1 lagrangian equation the main feature of the model used in this study is that the rigid body and flexible modes are coupled in time domain their mutual interaction such as the inertia effect of rigid body motion on flexible deformation is considered this is an extension to the tradition hydroelasticity theory in which rigid body and flexible parts are only linked by hydrodynamic coefficients for corresponding cross terms the model is developed based on the following lagrangian equation 2 2 1 d d t t q j u q j t q j q j j 1 2 3 where t and u represent the kinetic and potential energy of the structure system respectively q j is the general coordinates corresponding to any rigid and flexible mode and q j represents the non conservative forces corresponding to j th coordinate the specific forms of t u q j and q j for cylinder shell and non uniform beam are given in the following subsections 2 2 2 special case 1 cylinder shell as shown in fig 2 the problem of circular cylinder dropping above calm water surface is investigated here two coordinate systems are used which are the fixed global x y system and body attached local x y system the normal and tangential deformations of the cylinder shell with respect to the undeformed middle plane of the shell are represented as w and v respectively the normal and tangential vectors on the shell surface are n and e the external diameter and middle plane radius thickness of the shell are represented as d r and h as shown in fig 2 the center of the cylinder also the origin of the local x y system is x r c the position of any point on the cylinder shell in the global system can be described as eq 2 2 2 2 2 2 x x r c x w n v e where x x y x r c x r c y r c x x y x is the position of the undeformed cylinder shell which does not change with time for a particular point the normal and tangential displacements of any point on the shell are described by eq 2 2 3 2 2 3 w w 0 1 v v 0 z r v 0 w 0 β 2 where w 0 and v 0 are the corresponding normal and tangential displacements of the middle plane β is the angle defined in fig 2 and z is the distance between any point on the shell and the middle plane along the normal direction which takes positive value towards the inner surface of the shell the strain of the shell is defined as eq 2 2 4 2 2 4 ε ε 0 z χ 0 where the strain of the middle plane ε 0 and parameter χ 0 are defined as 2 2 5 ε 0 1 r v 0 β w 0 2 2 6 χ 0 1 r 2 v 0 β 2 w 0 β 2 as a result the stress of the shell is defined as eq 2 2 7 2 2 7 σ e 1 γ 2 ε e 1 γ 2 ε 0 z χ 0 where e is the young s modulus γ is the poisson s ratio the normal and tangential displacements of the middle plane are then expanded as the summation of orthogonal modes in eq 2 2 8 2 2 8 w 0 a 0 n 2 a n cos n β 1 v 0 n 2 b n sin n β 2 where a n and b n are the general coordinates of the normal and tangential deformation modes for the normal mode the case n 0 represents the radial deformation which is very small under non symmetric loading as in the impact process in this study a discussion will be given in section 3 the case n 1 for w and v corresponds to the rigid body motion which has been taken into account separately by x r c by using eq 2 2 2 2 2 8 the kinetic and potential energies of the structure system can be derived as eq 2 2 9 2 2 10 2 2 9 t 0 2 π h 2 h 2 1 2 x t ρ s x r d z d β ρ s r 2 0 2 π h 2 h 2 x r c w n v e t x r c w n v e d z d β m 2 y r c 2 m 4 a t a b t b 2 a 0 2 d 3 b t b a t k 2 a 2 b t k 1 a 2 2 10 u m g y r c 0 2 π h 2 h 2 σ ε d z d β m g y r c 0 2 π h 2 h 2 e 1 γ 2 ε 0 z χ 0 2 d z d β m g y r c 2 π d 1 a 0 2 π d 1 b t k 2 b 2 a t k 1 b a t a π d 2 b t k 2 b 2 a t k 3 b a t k 4 a where ρ s is the density of the structure and a a 2 a 3 a 4 t b b 2 b 3 b 4 t are the column vectors of the general coordinates for w and v respectively k m d 1 d 2 and d 3 are defined in eq 2 2 11 and eq 2 2 12 respectively 2 2 11 k m d i a g n m n 2 3 4 2 2 12 d 1 e h 2 1 γ 2 r 1 d 2 e h 3 24 1 γ 2 r 3 2 d 3 ρ s π h 3 24 r 3 as can be seen in eq 2 2 12 d 3 is much smaller than d 1 and d 2 since the young s module e is in the order of 1010 for steel or other common mental materials hence its effect is expected to be negligible a discussion will be given in section 3 to show the effect of d 3 after substituting eq 2 2 9 2 2 10 into eq 2 2 1 the governing equations for the dynamic response of flexible cylinder shell are derived as in eq 2 2 13 2 2 13 m y r c m g q y r c m a 0 4 π d 1 a 0 q a 0 m 2 a t 2 d 3 a t k 2 b t k 1 2 π d 1 a t b t k 1 2 π d 2 a t k 4 b t k 3 q a m 2 b t 2 d 3 b t a t k 1 2 π d 1 b t k 2 a t k 1 2 π d 2 b t k 2 a t k 3 0 where q a q a 1 q a 2 q a 3 t q a 0 q a n and q y r c are defined in eq 2 2 14 2 2 16 2 2 14 q a 0 0 2 π p r d β 2 2 15 q a n 0 2 π p cos n β r d β n 1 2 3 2 2 16 q y r c 0 2 π p n y r d β where p is the pressure applied on the cylinder surface and n y is the y component of the local normal vector expressed in global system apart from the term with d 3 the governing equations eq 2 2 13 is the same as the ones used by other researcher e g sun 2007 and khabakhpasheva 2009 as aforementioned the effect of d 3 is very small and will be discussed later in section 3 moreover the rigid body and flexible modes are separated in this case this is mainly because the structure does not have angular motion as will be shown in section 2 2 3 the angular motion is the main reason that cross term between rigid body and flexible modes exist 2 2 3 special case 2 non uniform beam in this subsection the case of non uniform floating beam subjecting to wave impact as shown in fig 3 is studied similar to the cylinder shell case two coordinate systems are used here i e fixed global x y system and body attached local s η system the origin of the local system is chosen at the center of gravity of the beam θ is defined as the angle from axis o x to axis o s anticlockwise as a result the position of any point on the beam can be described by eq 2 3 1 2 3 1 x x r b r ξ t where the local coordinate ξ and rotation matrix r are defined in eq 2 3 2 2 3 3 2 3 2 ξ s η l η 0 2 3 3 r cos θ sin θ sin θ cos θ where η l and η 0 mean the coordinates of the undeformed structure and the deflection of the middle plane respectively therefore η l is constant for a particular point on the beam moreover based on the beam assumption in this case the deflection of any layer parallel to the middle plane is assigned with the same value of the middle plane following the modal superposition theory the deflection η 0 of the middle plane is expanded as eq 2 3 4 2 3 4 η 0 ϕ t q b where the column vectors of mode functions ϕ and corresponding general coordinate q b are defined in eq 2 3 5 2 3 6 2 3 5 ϕ φ 1 φ 2 φ 3 t 2 3 6 q b q b 1 q b 2 q b 3 t the following orthogonal relations are satisfied by the mode functions 2 3 7 s 1 s 2 ϕ ρ l ϕ t d s i i s u n i t m a t r i x 2 3 8 s 1 s 2 d 2 ϕ d s 2 e i d 2 ϕ t d s 2 d s λ λ d i a g ω i 2 i 1 2 3 where s 1 and s 2 are the lower and upper limits of the integration along s axis and ρ l is the line density of the beam the kinetic and potential energies can be derived by using eq 2 3 1 2 3 8 as follows 2 3 9 t 1 2 s 1 s 2 η 1 η 2 x t ρ s x d η d s 1 2 s 1 s 2 η 1 η 2 x r r u θ ξ r ξ t ρ s x r r u θ ξ r ξ d η d s 1 2 m x r 2 y r 2 θ 2 i b θ 2 q b t q b q b t q b 2 θ x r cos θ y r sin θ q b t ψ 0 2 x r sin θ y r cos θ q b t ψ 0 2 θ q b t ψ 1 2 3 10 u 1 2 s 1 s 2 d 2 η 0 d s 2 e i d 2 η 0 d s 2 d s m g y r 1 2 q b t s 1 s 2 d 2 ϕ d s 2 e i d 2 ϕ t d s 2 d s q b m g y r 1 2 q b t λ q b m g y r where η 1 and η 2 are the lower and upper limits of the integration along η axis and matrix u column vectors ψ 0 and ψ 1 are defined in eq 2 3 11 2 3 13 2 3 11 u 0 1 1 0 2 3 12 ψ 0 ψ 01 ψ 02 ψ 03 t s 1 s 2 ϕ ρ l d s 2 3 13 ψ 1 ψ 11 ψ 12 ψ 13 t s 1 s 2 s ϕ ρ l d s by substituting eq 2 3 9 2 3 10 into eq 2 2 1 the governing equations for dynamic response of flexible floating beam to wave impact are derived in eq 2 3 14 2 3 14 m x r b θ 2 sin θ ψ 0 t q b 2 θ cos θ ψ 0 t q b θ cos θ ψ 0 t q b sin θ ψ 0 t q b q x r b m y r b θ 2 cos θ ψ 0 t q b 2 θ sin θ ψ 0 t q b θ sin θ ψ 0 t q b cos θ ψ 0 t q b m g q y r b x r b cos θ y r b sin θ ψ 0 t q b i b θ θ q b t q b 2 θ q b t q b ψ 1 t q b q θ x r b sin θ y r b cos θ ψ 0 θ ψ 1 q b λ q b θ 2 q b q q b where the non conservative forces corresponding to the general coordinates of rigid body and flexible modes are given in eq 2 3 15 2 3 18 2 3 15 q x r b p n s d l 2 3 16 q y r b p n η d l 2 3 17 q θ p x p n η y p n s d l 2 3 18 q q b p n e η ϕ d l where n s and n η are the s and η components of the local normal vector expressed in global system x p and y p are the global x and y coordinates of the point where pressure p is applied and e η is the unit vector of the o η axis the integration is conducted around the perimeter of the beam as can be seen from eq 2 3 14 the angular motion is responsible for the mutual interaction between rigid body and flexible modes i e the cross terms this effect has been shown in ref sun et al 2016 for the uniform beam and flexible wedge cases 2 2 4 updating structure configuration and interaction with fluid solver the flexible deformation is updated based on the assumption that the layers parallel to neutral line of the structure undergoes the same deformation as the neutral line i e the particles on the structure surface are shifted perpendicular to the undeformed beam neutral line by the deflection value of the neutral line this means the original cross section of the beam will remain parallel to each other this way of updating structure position is helpful to maintain a roughly regular particle distribution compared to the way in which the cross section rotates with the deformed beam neutral line which will make structure surface particle distribution becomes denser or sparser on the up and bottom surface of bended structure also since the flexible deformation is relatively small the aforementioned two ways of particle updating will end up with a very similar final surface configuration however the first one will give a more regular particle distribution for the fluid and structure interaction process the standard iterative approach is adopted until certain criterion is met the detailed information can be found in reference sun et al 2016 and will not be listed here for simplicity reason 3 results and discussions 3 1 water entry of cylinder in this section the rigid and flexible cylinder shell water entry problems are simulated and compared with experimental results 3 1 1 rigid body case the experiment conducted by greenhow and lin 1983 was simulated in the experiment two cylinders with diameter d 0 11 m are dropped from a height of 0 5 m which means the entry speed is v 2 955 m s the weights of these two cylinders are chosen to be the whole and half of the buoyancy force applied on a totally submerged cylinders as a result they are marked as neutral buoyant and half buoyant in the later context respectively the experimental data was given from the entry time t 0 0 301s while the numerical simulation started from the moment just before entry the free surface first a convergence test about the particle resolution was performed for the half buoyant case the initial configuration of the simulation was the same as shown in fig 2 in which the tank length and water depth were set as l 1 m h 0 5 m respectively three different particle distances were simulated i e dr 0 0075 m 0 005 m 0 0025 m roughly 1 15 1 22 and 1 44 of the cylinder s diameter which results in 9045 20000 and 80200 fluid particles for each case the time intervals were controlled by cfl courant friedrich levy condition and the initial value was 0 0002s as is shown in fig 4 all the three simulations matched well with the experimental result and the maximum difference at about 0 44s between three cases was around 3 of the bem result at the corresponding time instant which means it is not sensitive to spatial resolution the mps result tends to converge to the boundary element method bem result by sun 2007 in order to achieve a balance between computational time and accuracy the particle distance dr 0 005 m was chosen for the neutral buoyancy case simulation the comprehensive comparison between mps bem and experimental results for both neutral and half buoyant cases were given in fig 5 reasonably agreement was achieved however the discrepancy between numerical both bem and mps and experimental results were relatively larger in the neutral buoyant case than that in half buoyant case especially at the time with a question mark greenhow and lin noticed this obvious deviation from the main trend and put this question mark in their report greenhow and lin 1983 also both bem and mps results for the neutral buoyant case was lower than experimental result this could be due to the 3d effect especially when the flow speed around cylinder is relatively larger in the neutral case in figs 6 and 7 the free surface profiles at some typical time instants from experiment bem and mps computation were compared generally a reasonable good agreement with both results was achieved the instability of the free surface in the cavity area above the cylinder in neutral buoyant case in fig 7 was not observed in mps or bem results which again could be explained that the 3d effect could not be captured by the current 2d model furthermore since the surface tension was not included in the current mps model the water splashing at the end of the jet could only be simulated by the inertia effect of the water particles which results in a sparser particle distribution in that area compared to experimental result apart from including surface tension model in the computation a better result can potentially be achieved by using more refined resolution as well but obviously this practice resolution will compromise the computational efficiency multi resolution technique was planned to be adopted in the future work to tackle this dilemma the pressure contours computed by the mps method show a smooth spatial distribution 3 1 2 flexible case in this subsection the cylinder shell water entry experiment conducted by shibue et al 1993 was simulated the parameters used in the experiment and numerical simulation were listed in table 1 since this was a 2d simulation the length of the cylinder was assumed to be 1 m so the mass was increased from 23 8 kg corresponding to the length of 0 6 m to 39 2 kg corresponding to the length of 1 m in the simulation as shown in table 1 the length l and water depth h of the tank as shown in fig 2 are chosen to be 2 m and 0 6 m respectively the initial particle distance is 0 0075 m about 1 42 of the cylinder s diameter which results in 21360 fluid particles the time interval is selected as 0 0002s and subject to cfl condition the elongation of the middle plane was investigated by comparing the strain in the inner surface of the shell i e z h 2 in eq 2 2 4 at β 0 with and without the strain of the middle plane ε 0 the mode number was chosen to be three in eq 2 2 13 as shown in fig 8 the value of ε 0 was negligible for the dynamic response of the cylinder shell impact problem which is consistent with the discussion by sun 2007 as mentioned in section 2 2 the parameter a 0 in eq 2 2 8 1 represents the radial deformation which is the elongation of the middle plane as shown in fig 9 the value of the strain at the same position inner surface β 0 presents no visible difference with red line and without green line a 0 which confirms that the middle plane elongation is negligible furthermore the effect of parameter d 3 in the governing equation eq 2 2 12 is shown in fig 9 it can be seen that the inner surface strain at β 0 was almost not affected by excluding d 3 in the computation red and blue line in fig 9 this is consistent with the discussion in section 2 2 for d 3 a more systematic comparison of the inner surface strain was given in fig 10 from a b the time histories of strain at β 0 10 20 30 were compared with experimental results four mode numbers i e 2 3 4 5 were used in the simulation although the main trend and time instants when peak value occurs match well with the experimental results the value of the peak in the simulation was significantly lower than that from the experiment the increase of mode number tended to produce slightly larger peak value but still smaller than experimental results this could be due to the underestimation of the pressure especially during the initial impact stage the pressure time history of the cylinder bottom β 0 is shown in fig 11 the pressure spatial distribution at typical time instants corresponding to a d in fig 10 are shown in fig 12 a relatively smooth pressure distribution was obtained by the mps simulation 3 2 slamming of 3d ship hull the final case was conducted to test the modified mps and non uniform beam model for practical complex geometry the 1 100 model of a 4600 tones oil tanker was used for the simulation of violent wave and ship interaction i e the impact of breaking dam to floating ship the dynamic response of the ship was assumed be to 2d i e only pitch heave and vertical bending are considered which makes the non uniform beam model in section 2 2 is applicable to this case the main parameters of the ship model are listed in table 2 the ship model was placed in a tank facing the impact from breaking dam and the initial configuration is shown in fig 13 the tank width and length are chosen to be about 3 times of the ship breadth and length respectively the body plan and final surface discretization are shown in fig 14 the particle distance on the ship surface was made roughly to the same as the fluid domain resolution i e 0 02 m about 1 90 of the ship length total particle number was 289417 in which 193284 of them were fluid particles the initial time step was 0 002s and subject to cfl condition the mass distribution of the ship was assumed to be the same as its occupied water volume and the hull thickness was chosen to be 0 05 m for the calculation of 2nd moment for cross section fig 15 shows the resultant mass and 2nd moment distribution of the model ship the mode shape function of this non uniform beam was calculated by myklestad s method myklestad 1944 and the first three mode shape functions are shown in fig 16 the young s modulus e 2 104 n m2 and the circular natural frequencies for the first three modes are ω 1 3 7857 ω 2 9 7777 ω 3 18 2063 the free surface profiles at some typical time instants are shown in fig 17 the free surface particles the ship surface above and under the free surface were marked as red blue and black respectively as can be seen in fig 17 there were no misidentified free surface particles under the free surface in this simulation the amplitude of the deformation was significantly larger than the normal ship structure this deliberately chosen low stiffness was to test the capability of the coupling between modified modal superposition and mps models fig 17 a b and c show the developing process of the impact wave caused by the breaking dam at different times the fact that the draught of the ship remains the same proves that the buoyancy force calculated by the mps was accurate and stable to support the ship weight the impact of the wave on the bow of ship occurs at t 0 418s in fig 17 c the crescent of the wave generates the largest bending moment as the wave propagating along the ship hull fig 17 d f and correspondingly causeed the largest deformations this qualitative analysis shows that the coupling between modified mps and the proposed structure model is capable of providing reasonable results for the simulation of wave and structure interaction a primary analysis of the general coordinates corresponding to each mode showed that the mode of lower order tends to take higher percentage of the total response as expected however more quantitative analysis by comparing against published experimental or numerical results would be required to further verify the reliability of this model in the future 4 conclusion and future work the modified mps and modal superposition methods were applied to compute the hydroelasticity response of typical marine structures i e cylindrical shell and ship hull in this study involving violent free surface deformation and slamming the fluid solver was first validated by the rigid body cylinder water entry problem and relatively good match was achieved between mps result and available data in the literature both numerical and experimental results the elastic cylindrical shell impact problem was then computed and compared against experimental result although the main trend of the shell deformation can be captured by the proposed model it shows an underestimation of the peak strain value the slamming of an oil tanker hull was then simulated to show the capability of the coupling model in directly computing slamming force and capturing large free surface structure displacement in time domain the future work of refining the current coupling model includes improving pressure accuracy and combing potential flow solver with mps in time or space domain one of the possible ways of improving pressure simulation accuracy and efficiency is by computing poisson equation in the background grid and the weakly coupling with potential flow solver mainly to improve the computational efficiency in time domain which has been realized by the authors sun et al 2017 in previous work is expected to extended for this simulation acknowledgement this work is supported by the national natural science foundation of china no 51639003 51809035 51679037 and 51579042 fundamental research funds for the central universities no dut17rc 3 017 and dut2017tb05 joint found for equipment pre research and china shipbuilding industry corporation 6141b04010103 and the supercomputing center of dalian university of technology to which the authors are most grateful 
22884,in this paper we address the vibration abatement problem of a flexible riser system preceded by nonlinear input saturation characteristic and uncertainties of the system by virtue of lyapunov theory auxiliary system and robust control strategy a boundary robust adaptive anti saturation control is developed to restrain the vibration remove the nonlinear input saturation effects and compensate for the uncertainties of system parameters and boundary disturbance applying the rigorous analysis without simplifying or discretizing the partial differential equation dynamics the controlled system is ensured to be uniformly bounded stable with the designed control law in the end simulation results are presented for control performance verification keywords vibration control flexible risers input saturation boundary control disturbance adaption nomenclature l length of the riser m mass of the vessel d a damping coefficient of the vessel ρ mass per unit length of the riser c damping coefficient of the riser t tension of the riser e i bending stiffness of the riser x z t deflection of the riser at the position z for time t d t external environmental disturbance on the vessel f z t ocean current distributed disturbance on the riser τ t boundary control input applied on the vessel 1 introduction as with exploitation of energy resources towards deepwater filed the role of flexible marine risers which are employed to transport the petroleum product and natural gas as a crucial part is becoming increasingly significant he et al 2011 2017a in face of the harsh ocean environment i e ocean current wind and wave and due to the riser s flexibility property the flexible riser will generate the deformation and vibration which will affect the normal production performance of the riser give rise to premature fatigue problems and even lead serious damage to risers liu et al 2017a he et al 2015 zhao et al 2018a it requires expensive maintenance costs and brings enormous losses to productive process and environment due to leakage of crude oil it is of necessity and significance to develop an effective activate control strategy for suppressing the vibrations of the riser and preventing fatigue damage to resolve the vibration suppression issue of the flexible marine riser system which is a distributed parameter system in nature many domestic and overseas experts and scholars devote themselves to the development of different control approaches for handling this problem guo and guo 2009 wu and wang 2014 cai and krstic 2016 wang et al 2018a ren et al 2014 boundary control is generally considered to be physically more realistic method for analyzing the vibration reduction issue of flexible marine risers due to the nonintrusive actuation and sensing krstic and smyshlyaev 2008 he et al 2018a wang et al 2018b compared with model reduction approach which is employed in different ways to extract a finite dimensional subsystem to be controlled while showing robustness to neglecting the remaining infinite dimensional dynamics in the design qiu et al 2015 2016 sun et al 2017 recently significant progress has been made in boundary control for vibrating flexible riser systems to mention a few in he et al 2011 an adaptive boundary control was designed to stabilize a vibrating flexible marine riser system in he et al 2017a the nonlinear drilling riser was globally stabilized by the construction of boundary control law and the explicit proof of exponential stability was presented in liu et al 2017a a barrier based boundary control was developed for suppressing the vibrational deflection and ensuring that the output constraint was not violated in he et al 2015 the authors exploited the integral barrier lyapunov function to generate an active boundary stabilizing control strategy for working out the restricted top tension problem in zhao et al 2018a a boundary adaptive output feedback control was constructed for the global stabilization of the riser system merging robust control strategy and high gain observer technique in do 2018 the boundary controller design was presented to stabilize transverse motion of flexible marine risers under stochastic loads induced by restoring membrane and fluid air velocity in guo et al 2018 the disturbance tracking and vibration abatement of a flexible marine riser system were achieved by utilizing the finite dimensional backstepping technique in addition considering the actuator dynamics of the flexible marine riser system the system analysis and control design were introduced in do and pan 2008 and the development of boundary control for stabilizing extensible risers in three dimensional space was documented in do 2017a 2017b boundary control has also been used to stabilize other distributed parameter systems e g heat equations huang et al 2013 wang et al 2015 belts zhao et al 2017a 2018b hoses liu et al 2017b cables he et al 2017b he and ge 2016 wings he and zhang 2017 paranjape et al 2013a 2013b manipulators endo et al 2017a 2017b liu et al 2018a he et al 2017c strings nguyen and hong 2010 2012 etc dead zone he et al 2017d saturation wen et al 2011 grimm et al 2003 hysteresis liu et al 2016 backlash he et al 2018b and so on are generally considered as nonsmooth nonlinearities which are ubiquitous in industrial control systems these nonlinear properties are typically derived from physical constraints inherent in the mechanical system and the actuating mechanisms which become the main limiting factors for the static and dynamic performance of the feedback control system in fact these nonsmooth nonlinearities bring some adverse effects on the system and often cause deterioration of system performance chen et al 2011 2018 zhou and wen 2008 which are often overlooked in the design of the controller in consequence it is very urgent to take into account these nonlinearities in the process of controller design to remove the input saturation effects much effort has been paid on the design and development of diverse boundary control techniques to figure out the issue for the riser system he et al 2016 zhao et al 2017b 2018c in he et al 2016 zhao et al 2018c a boundary control with auxiliary system was developed for suppressing the vibration and settling the input saturation or saturation deadzone issue for flexible marine riser systems in zhao et al 2017b the hyperbolic tangent and nussbaum function were fused to develop a boundary anti windup control scheme for regulating the riser system and limiting the control input however the approaches above mentioned are only confined to suppressing the vibrations and handling the saturation nonlinearity for the riser system with known parameters and the system uncertainties are not incorporated in the control design the mixed effects of nonlinear input saturation characteristic and uncertainties of system would make the control design and stability analysis more complex in this paper we will study a flexible marine riser system integrating input saturation nonlinearity with system parameter and disturbance uncertainties comparing with the existing research the main contributions are highlighted in the following first a boundary robust adaptive anti saturation control with online updating laws is presented to suppress the vibrational offset of the flexible marine riser and to compensate the uncertainties of system parameters and boundary disturbance second an auxiliary system is constructed and integrated into the control design to eliminate the effects of the input nonlinear input saturation characteristic and the σ modification is exploited to adjust the robustness of the system third under the developed robust control scheme the uniform convergence of the flexible marine riser system is obtained through rigorous lyapunov analysis without any model reduction the rest of this paper is arranged as follows the system model and preliminaries are introduced in section ii the design of adaptive robust anti saturation control for the riser system is presented in section iii numerical simulations using finite difference method proceed in section iv and we come to a conclusion in section v notations are defined as follows z t 2 z t 2 z 2 3 z 3 4 z 4 and 2 t 2 2 system model and preliminaries 2 1 system model in this study the dynamical model of the considered flexible marine riser system shown in fig 1 is presented as follows he et al 2011 1 ρ x e i x t x c x f 0 0 z l 2 x 0 t x 0 t x l t 0 3 m x l t t x l t e i x l t d a x l t τ t d t consider the input saturation of the actuator and the saturation nonlinearity is described as follows 4 τ t s a t u t u max u t u max u t u min u t u max u min u t u min with u max 0 and u min 0 max u max u min τ m being the saturation limits and u t being the control law to be developed 2 2 preliminaries for purpose of conducting control design and stability analysis it is necessary to list the following assumptions lemmas and remarks assumption 1 for disturbances f z t and d t we assume that there exist constants f m d m ℝ satisfying f z t f m z t 0 l 0 and d t d m t 0 it is a reasonable assumption as f z t and d t have finite energy and hence are bounded he et al 2018c assumption 2 for the expression of input saturation 4 we assume that there exists a positive constant ϱ satisfying u ϱ where u τ t u t lemma 1 let ε 1 z t ε 2 z t ℝ ν 0 with z t 0 l 0 then the following inequality holds zhao et al 2017b 5 ε 1 z t ε 2 z t ε 1 z t ε 2 z t 1 ν ε 1 z t ν ε 2 z t 1 ν ε 1 2 z t ν ε 2 2 z t lemma 2 let ε z t ℝ be a function defined on z t 0 l 0 satisfying ε 0 t 0 t 0 then we have zhao et al 2017b 6 ε 2 z t l 0 l ε 2 z t d z remark 1 for analyzing the stability of the closed loop system and deriving our main results we present the following inequality 7 x l t d t x l t tanh x l t d where d is a positive constant satisfying d d m 3 control design in this section on the basis of lyapunov s approach and robust control theory we introduce an auxiliary system to design an adaptive robust boundary control for suppressing the riser s vibration removing the effects of nonlinear input saturation and handling the uncertainties of the system 3 1 boundary control in order to handle the nonlinear input saturation we introduce the following auxiliary system 8 ϖ t k 1 ϖ t u i u 0 5 u 2 ϖ t u ϖ t ϖ 0 0 ϖ t ϖ 0 where k 1 0 ϖ t is the state of the auxiliary system u i is an auxiliary variable to be introduced in the following and ϖ 0 is a small positive constant then we define the auxiliary variable u i as 9 u i x l t k 2 x l t k 3 x l t where k 2 k 3 0 to stabilize vibrations and compensate for uncertainties of the system we propose the following robust adaptive control law 10 u t k 4 ϖ t k 5 u i t ˆ x l t e i ˆ x l t d ˆ a x l t m ˆ k 2 x l t k 3 x l t tanh u i d ˆ where k 4 k 5 0 and t ˆ e i ˆ d ˆ a m ˆ d ˆ are estimates of t e i d a m d respectively the online updating laws are thus presented as 11 t ˆ σ 1 β 1 t ˆ β 1 x l t u i 12 e i ˆ σ 2 β 2 e i ˆ β 2 x l t u i 13 d ˆ a σ 3 β 3 d ˆ a β 3 x l t u i 14 m ˆ σ 4 β 4 m ˆ β 4 k 2 x l t k 3 x l t u i 15 d ˆ σ 5 d ˆ u i tanh u i where σ 1 σ 5 β 1 β 4 0 the estimation errors are defined as 16 t t t ˆ 17 e i e i e i ˆ 18 d a d a d ˆ a 19 m m m ˆ 20 d d d ˆ differentiating 9 and substituting 3 and 10 we have 21 u i x l t k 2 x l t k 3 x l t 1 m τ t d t t x l t e i x l t d a x l t m k 2 x l t m k 3 x l t 1 m u d t t x l t e i x l t d a x l t m k 2 x l t k 3 x l t k 4 ϖ t k 5 u i tanh u i d ˆ remark 2 in the proposed control law 10 the signals x l t x l t and x l t can be measured by employing a laser displacement sensor an inclinometer and a shear force sensor and then the signals x l t x l t and x l t can be obtained by applying the backward difference algorithm to x l t x l t and x l t respectively define the lyapunov function candidate as 22 v t v e t v f t v g t where 23 v e t ψ 2 ρ 0 l x 2 z t d z ψ 2 t 0 l x 2 z t d z ψ 2 e i 0 l x 2 z t d z 24 v f t χ ρ 0 l z x z t x z t d z 25 v g t m 2 u i 2 1 2 β 1 t 2 1 2 β 2 e i 2 1 2 β 3 d a 2 1 2 β 4 m 2 1 2 d 2 1 2 ϖ 2 t with ψ χ 0 lemma 3 the lyapunov function candidate 22 is a positive function with the following form 26 0 ϕ 1 v e t v g t v t ϕ 2 v e t v g t where ϕ 1 ϕ 2 0 proof 1 invoking lemma 1 and combining 24 yields 27 v f t χ ρ l 2 0 l x 2 z t d z χ ρ l 2 0 l x 2 z t d z ϑ v a t where 28 ϑ χ ρ l min ψ ρ ψ t ψ e i by appropriately choosing ψ and χ we have 29 ϑ 1 1 χ ρ l min ψ ρ ψ t ψ e i 1 ν 0 ϑ 2 1 χ ρ l min ψ ρ ψ t ψ e i 1 ν 1 29 indicates 0 ϑ 1 then using 28 leads to 30 ψ χ ρ l min ρ t e i we then rearrange 27 to obtain 31 ϑ v e t v f t ϑ v e t substituting 29 into 31 gives 32 0 ϑ 1 v e t v e t v f t ϑ 2 v e t the combination of 22 results in 33 0 ϕ 1 v e t v g t v t ϕ 2 v e t v g t where ϕ 1 min ϑ 1 1 0 and ϕ 2 max ϑ 2 1 0 lemma 4 the time derivative of the lyapunov function candidate 22 can be upper bounded with 34 v t ϕ v t α where ϕ α 0 proof 2 taking the derivative of 22 we get 35 v t v e t v f t v g t differentiating v e t and substituting 1 leads to 36 v e t ψ t x l t e i x l t x l t ψ 0 l x f d z c ψ 0 l x 2 d z combining 9 we arrive at 37 u i 2 x 2 l t k 2 2 x 2 l t k 3 2 x 2 l t 2 k 2 x l t x l t 2 k 3 x l t x l t 2 k 2 k 3 x l t x l t invoking 36 and 37 yields 38 v e t ψ e i 2 k 3 u i 2 ψ e i 2 k 3 x 2 l t ψ e i k 2 2 2 k 3 x 2 l t ψ e i k 3 2 x 2 l t ψ t ψ e i k 2 k 3 x l t x l t k 2 ψ e i x l t x l t ψ 0 l f x d z c ψ 0 l x 2 d z applying lemma 1 on 38 we have 39 v e t ψ e i 2 k 3 u i 2 ψ e i 2 k 3 x 2 l t ψ e i k 2 2 2 k 3 x 2 l t ψ e i k 3 2 x 2 l t ψ t ψ e i k 2 k 3 x l t x l t k 2 ψ e i x l t x l t ψ ε 1 0 l f 2 d z ψ c ε 1 0 l x 2 d z where ε 1 0 differentiating v f t substituting 1 and employing lemma 1 we get 40 v f t l χ e i x l t x l t 3 χ e i 2 0 l x 2 d z l χ c ε 2 0 l x 2 d z χ ρ l 2 x 2 l t χ t 2 χ ε 2 c l χ ε 3 l 0 l x 2 d z l χ ε 3 0 l f 2 d x χ t l 2 x 2 l t where ε 2 ε 3 0 taking the derivative of v g t and substituting 8 11 15 21 and 10 combining remark 1 and utilizing lemma 1 we derive 41 v g t k 5 u i 2 u i tanh u i d ˆ u i d t k 4 ϖ t u i u i tanh u i d σ 5 2 d 2 σ 5 2 d 2 k 1 1 2 ϖ 2 t σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 k 5 k 4 2 u i 2 k 1 1 2 k 4 2 ϖ 2 t σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 σ 5 2 d 2 σ 5 2 d 2 σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 substituting 39 41 into 35 and then utilizing lemma 1 we obtain 42 v t k 5 k 4 2 ψ e i 2 k 3 u i 2 k 1 1 2 k 4 2 ϖ 2 t σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 ψ e i k 2 2 2 k 3 ψ k 3 t e i k 2 2 k 3 ε 4 e i k 2 ψ l χ ε 5 2 χ t l 2 x 2 l t ψ e i 2 k 3 ψ k 3 t e i k 2 ε 4 2 k 3 χ ρ l 2 x 2 l t ψ e i k 3 2 e i k 2 ψ l χ 2 ε 5 x 2 l t ψ c ψ ε 1 l χ c ε 2 0 l x 2 d z χ t 2 χ ε 2 c l χ ε 3 l 0 l x 2 d z 3 χ e i 2 0 l x 2 d z ψ ε 1 l χ ε 3 0 l f 2 d z σ 5 2 d 2 σ 5 2 d 2 σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 where ε 4 ε 5 0 and ψ χ k i ε i for i 1 5 are chosen to satisfy the following conditions 43 ψ e i k 2 2 2 k 3 ψ k 3 t e i k 2 2 k 3 ε 4 e i k 2 ψ l χ ε 5 2 χ t l 2 0 44 ψ e i 2 k 3 ψ k 3 t e i k 2 ε 4 2 k 3 χ ρ l 2 0 45 ψ e i k 3 2 e i k 2 ψ l χ 2 ε 5 0 46 λ 1 ψ c ψ ε 1 l χ c ε 2 0 47 λ 2 χ t 2 χ ε 2 c l χ ε 3 l 0 48 λ 3 k 5 k 4 2 ψ e i 2 k 3 0 49 λ 4 k 1 1 2 k 4 2 0 50 α ψ ε 1 l χ ε 3 l f m 2 σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 σ 5 2 d 2 applying 43 50 on 42 leads to 51 v t λ 1 0 l x 2 d z λ 2 0 l x 2 d z 3 χ e i 2 0 l x 2 d z λ 3 u i 2 λ 4 ϖ 2 t σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 σ 5 2 d 2 α ϕ 3 v e t v g t α where ϕ 3 min 2 λ 1 ψ ρ 2 λ 2 ψ t 3 χ ψ 2 λ 3 m 2 λ 4 m σ 1 β 1 σ 2 β 2 σ 3 β 3 σ 4 β 4 σ 5 combining 26 and 51 we further obtain 52 v t ϕ v t α where ϕ ϕ 3 ϕ 2 the proof is thus completed theorem 1 for the considered riser system described by 1 3 under the proposed control law 10 and assumption 1 provided that the initial conditions are bounded and the design parameters ψ χ k i δ i for i 1 5 are chosen such that the constraints specified in 43 50 hold then we can conclude that the closed loop system state x z t is uniformly ultimately bounded proof 3 we multiply 35 by e ϕ t to obtain 53 t v t e ϕ t α e ϕ t taking the integration operation of 53 results in 54 v t v 0 e ϕ t α ϕ 1 e ϕ t v 0 e ϕ t α ϕ combining v e t 26 and lemma 2 gives 55 ψ t 2 l x 2 z t ψ t 2 0 l x 2 z t d z v e t 1 ϕ 1 v t substituting 54 into 55 yields 56 x z t 2 l ψ ϕ 1 t v 0 e ϕ t α ϕ z t 0 l 0 from 56 we further derive 57 lim t x z t 2 l α ψ t ϕ 1 ϕ z 0 l the proof is completed it should be highlighted that the stability analysis for the considered riser system with input saturation were discussed based on the case when ϖ t ϖ 0 ϖ t k 1 ϖ t u i u 0 5 u 2 ϖ t u that is the system exists input saturation then an auxiliary system is exploited to eliminate the effects arising from nonlinear input saturation for the case ϖ t ϖ 0 ϖ t 0 it is obvious that the system does not exist input saturation and a boundary control scheme can be developed employing the previous design methods which ignore the input saturation in he et al 2011 zhao et al 2018a for completeness we present the proof of system stability for the case ϖ t ϖ 0 ϖ t 0 in the following invoking ϖ t 0 we derive v g t as 58 v g t k 5 k 4 2 1 2 u i 2 k 4 2 ϖ 2 t 1 2 u 2 σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 σ 5 2 d 2 σ 5 2 d 2 σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 substituting 39 40 and 58 into 35 combining assumption 2 and then utilizing lemma 1 we obtain 59 v t k 5 k 4 2 1 2 ψ e i 2 k 3 u i 2 1 2 ϖ 2 t k 4 1 2 ϖ 0 2 1 2 ϱ 2 σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 ψ e i k 2 2 2 k 3 ψ k 3 t e i k 2 2 k 3 ε 4 e i k 2 ψ l χ ε 5 2 χ t l 2 x 2 l t ψ e i 2 k 3 ψ k 3 t e i k 2 ε 4 2 k 3 χ ρ l 2 x 2 l t ψ e i k 3 2 e i k 2 ψ l χ 2 ε 5 x 2 l t ψ c ψ ε 1 l χ c ε 2 0 l x 2 d z χ t 2 χ ε 2 c l χ ε 3 l 0 l x 2 d z 3 χ e i 2 0 l x 2 d z ψ ε 1 l χ ε 3 0 l f 2 d z σ 5 2 d 2 σ 5 2 d 2 σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 where ε 4 ε 5 0 and ψ χ k i ε i for i 1 5 are chosen to satisfy the following conditions 60 ψ e i k 2 2 2 k 3 ψ k 3 t e i k 2 2 k 3 ε 4 e i k 2 ψ l χ ε 5 2 χ t l 2 0 61 ψ e i 2 k 3 ψ k 3 t e i k 2 ε 4 2 k 3 χ ρ l 2 0 62 ψ e i k 3 2 e i k 2 ψ l χ 2 ε 5 0 63 ω 1 ψ c ψ ε 1 l χ c ε 2 0 64 ω 2 χ t 2 χ ε 2 c l χ ε 3 l 0 65 ω 3 k 5 k 4 2 1 2 ψ e i 2 k 3 0 66 α α k 4 1 2 ϖ 0 2 1 2 ϱ 2 applying 60 66 on 59 gives 67 v t ω 1 0 l x 2 d z ω 2 0 l x 2 d z 3 χ e i 2 0 l x 2 d z ω 3 u i 2 1 2 ϖ 2 t σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 σ 5 2 d 2 α ϕ 4 v e t v g t α where ϕ 4 min 2 ω 1 ψ ρ 2 ω 2 ψ t 3 χ ψ 2 ω 3 m 1 σ 1 β 1 σ 2 β 2 σ 3 β 3 σ 4 β 4 σ 5 combining 26 and 67 we further have 68 v t ϕ v t α where ϕ ϕ 4 ϕ 2 applying the same analysis as presented in theorem 1 we derive 69 x z t 2 l ψ ϕ 1 t v 0 e ϕ t α ϕ z t 0 l 0 70 lim t x z t 2 l α ψ t ϕ 1 ϕ z 0 l invoking 69 and 70 we derive the closed loop system is also ultimately ultimately bounded stable when ϖ t ϖ 0 ϖ t 0 then combining theorem 1 we conclude that the closed loop system is ultimately ultimately bounded stable under the designed control law 10 and auxiliary system 8 remark 3 it is worth pointing out that the control design in this paper proceeds based on the original infinite dimensional partial differential equation which prevents the control spillover from modal method in a follow up study we will exploit the model reduction approach to conduct the neural network or learning based approaches yang et al 2017a 2017b 2018a 2018b xu et al 2017 dai et al 2018 zhang et al 2018a 2018b ma et al 2018 he et al 2017e 2018d cui et al 2017 for achieving the transient performance regulation of control systems 4 simulations in this section we find the approximate solution of the closed loop system by using the finite difference method he et al 2014 liu et al 2018b in order to verify the effectiveness of the proposed control 10 parameters of the riser system are given as l 1000 m ρ 500 kg m c 1 0 ns m 2 t 3 0 10 8 n e i 1 5 10 7 nm 2 m 9 6 10 6 kg d a 1 5 10 5 ns m the initial conditions of the system are presented as x z 0 15 z l x z 0 0 the ocean surface current velocity u t and distributed ocean current disturbance f z t are respectively formulated in he et al 2011 the expression of external environmental disturbance is presented as 71 d t 3 0 8 sin 0 7 t 0 2 sin 0 5 t 0 2 sin 0 9 t 10 5 for verifying the control performance of closed loop riser system with developed control 10 we consider three kinds of responses of the system in the following i without control the riser system is vibrating freely namely τ t 0 and the spatial time representation is shown in fig 2 ii with proposed control when the designed control 10 acts on the riser system by selecting the control parameters as k 1 k 3 β 1 β 2 β 3 β 4 1 k 2 20 k 4 0 01 k 5 8 10 7 σ 1 σ 2 σ 3 σ 4 1 10 4 σ 1 10 5 u m a x 3 10 5 and u m i n 2 10 5 the spatial time response is depicted in fig 3 iii with previous adaptive control in he et al 2011 when the previous boundary control proposed in he et al 2011 is exerted to the riser system choosing the control gains k 1 5 10 7 k 1 100 and k 2 1 and the 3d response is displayed in fig 4 the end offset x l t under no control developed control and previous control in he et al 2011 is illustrated in figs 5 and 6 respectively the time history of the designed auxiliary system state is presented in fig 7 the response diagram of boundary disturbance estimation error is depicted in fig 8 the time responses of the developed control command u t and saturated control input τ t are displayed in figs 9 and 10 the dynamic state of previous control in he et al 2011 is shown in fig 11 from figs 2 11 we observe that the riser s vibration is significantly suppressed under the developed control and previous control in he et al 2011 the control effect of previous control in he et al 2011 is not so good as that of proposed control 10 the disturbance estimation error is able to converge to a bounded value the nonlinear saturated input can be handled and limited in the specified range by adjusting the design control parameters and moreover the previous control in he et al 2011 can not achieve the anti saturation control issue in conclusion the proposed control works well in handling the nonlinear input saturation and uncertainties of the system as well as stabilizing vibrations of the riser system 5 conclusion this study was concerned with the vibration control and global stabilization of a distributed parameter flexible riser system in the presence of nonlinear input saturation and system uncertainties to realize the vibration suppression eliminate the nonlinear input saturation effects and compensate for system uncertainties the boundary robust adaptive control was constructed by integrating the auxiliary system with online updating laws the uniformly bounded stability of the controlled system was analyzed and demonstrated through rigorous lyapunov analysis without any model reduction finally simulation results were demonstrated for control performance verification in this paper we have addressed the anti saturation design problems of a flexible marine riser system future work includes control design for a flexible riser system with input deadzone or backlash in addition the extensions of the current approaches to the flexible riser systems in three dimensional space deserve further investigation and it is also a meaningful topic to conduct the practical experiment research for marine riser systems acknowledgment this work was supported in part by the national natural science foundation of china 61803109 11832009 61803111 and by the innovative school project of education department of guangdong 2017kqncx153 2017kzdxm060 
22884,in this paper we address the vibration abatement problem of a flexible riser system preceded by nonlinear input saturation characteristic and uncertainties of the system by virtue of lyapunov theory auxiliary system and robust control strategy a boundary robust adaptive anti saturation control is developed to restrain the vibration remove the nonlinear input saturation effects and compensate for the uncertainties of system parameters and boundary disturbance applying the rigorous analysis without simplifying or discretizing the partial differential equation dynamics the controlled system is ensured to be uniformly bounded stable with the designed control law in the end simulation results are presented for control performance verification keywords vibration control flexible risers input saturation boundary control disturbance adaption nomenclature l length of the riser m mass of the vessel d a damping coefficient of the vessel ρ mass per unit length of the riser c damping coefficient of the riser t tension of the riser e i bending stiffness of the riser x z t deflection of the riser at the position z for time t d t external environmental disturbance on the vessel f z t ocean current distributed disturbance on the riser τ t boundary control input applied on the vessel 1 introduction as with exploitation of energy resources towards deepwater filed the role of flexible marine risers which are employed to transport the petroleum product and natural gas as a crucial part is becoming increasingly significant he et al 2011 2017a in face of the harsh ocean environment i e ocean current wind and wave and due to the riser s flexibility property the flexible riser will generate the deformation and vibration which will affect the normal production performance of the riser give rise to premature fatigue problems and even lead serious damage to risers liu et al 2017a he et al 2015 zhao et al 2018a it requires expensive maintenance costs and brings enormous losses to productive process and environment due to leakage of crude oil it is of necessity and significance to develop an effective activate control strategy for suppressing the vibrations of the riser and preventing fatigue damage to resolve the vibration suppression issue of the flexible marine riser system which is a distributed parameter system in nature many domestic and overseas experts and scholars devote themselves to the development of different control approaches for handling this problem guo and guo 2009 wu and wang 2014 cai and krstic 2016 wang et al 2018a ren et al 2014 boundary control is generally considered to be physically more realistic method for analyzing the vibration reduction issue of flexible marine risers due to the nonintrusive actuation and sensing krstic and smyshlyaev 2008 he et al 2018a wang et al 2018b compared with model reduction approach which is employed in different ways to extract a finite dimensional subsystem to be controlled while showing robustness to neglecting the remaining infinite dimensional dynamics in the design qiu et al 2015 2016 sun et al 2017 recently significant progress has been made in boundary control for vibrating flexible riser systems to mention a few in he et al 2011 an adaptive boundary control was designed to stabilize a vibrating flexible marine riser system in he et al 2017a the nonlinear drilling riser was globally stabilized by the construction of boundary control law and the explicit proof of exponential stability was presented in liu et al 2017a a barrier based boundary control was developed for suppressing the vibrational deflection and ensuring that the output constraint was not violated in he et al 2015 the authors exploited the integral barrier lyapunov function to generate an active boundary stabilizing control strategy for working out the restricted top tension problem in zhao et al 2018a a boundary adaptive output feedback control was constructed for the global stabilization of the riser system merging robust control strategy and high gain observer technique in do 2018 the boundary controller design was presented to stabilize transverse motion of flexible marine risers under stochastic loads induced by restoring membrane and fluid air velocity in guo et al 2018 the disturbance tracking and vibration abatement of a flexible marine riser system were achieved by utilizing the finite dimensional backstepping technique in addition considering the actuator dynamics of the flexible marine riser system the system analysis and control design were introduced in do and pan 2008 and the development of boundary control for stabilizing extensible risers in three dimensional space was documented in do 2017a 2017b boundary control has also been used to stabilize other distributed parameter systems e g heat equations huang et al 2013 wang et al 2015 belts zhao et al 2017a 2018b hoses liu et al 2017b cables he et al 2017b he and ge 2016 wings he and zhang 2017 paranjape et al 2013a 2013b manipulators endo et al 2017a 2017b liu et al 2018a he et al 2017c strings nguyen and hong 2010 2012 etc dead zone he et al 2017d saturation wen et al 2011 grimm et al 2003 hysteresis liu et al 2016 backlash he et al 2018b and so on are generally considered as nonsmooth nonlinearities which are ubiquitous in industrial control systems these nonlinear properties are typically derived from physical constraints inherent in the mechanical system and the actuating mechanisms which become the main limiting factors for the static and dynamic performance of the feedback control system in fact these nonsmooth nonlinearities bring some adverse effects on the system and often cause deterioration of system performance chen et al 2011 2018 zhou and wen 2008 which are often overlooked in the design of the controller in consequence it is very urgent to take into account these nonlinearities in the process of controller design to remove the input saturation effects much effort has been paid on the design and development of diverse boundary control techniques to figure out the issue for the riser system he et al 2016 zhao et al 2017b 2018c in he et al 2016 zhao et al 2018c a boundary control with auxiliary system was developed for suppressing the vibration and settling the input saturation or saturation deadzone issue for flexible marine riser systems in zhao et al 2017b the hyperbolic tangent and nussbaum function were fused to develop a boundary anti windup control scheme for regulating the riser system and limiting the control input however the approaches above mentioned are only confined to suppressing the vibrations and handling the saturation nonlinearity for the riser system with known parameters and the system uncertainties are not incorporated in the control design the mixed effects of nonlinear input saturation characteristic and uncertainties of system would make the control design and stability analysis more complex in this paper we will study a flexible marine riser system integrating input saturation nonlinearity with system parameter and disturbance uncertainties comparing with the existing research the main contributions are highlighted in the following first a boundary robust adaptive anti saturation control with online updating laws is presented to suppress the vibrational offset of the flexible marine riser and to compensate the uncertainties of system parameters and boundary disturbance second an auxiliary system is constructed and integrated into the control design to eliminate the effects of the input nonlinear input saturation characteristic and the σ modification is exploited to adjust the robustness of the system third under the developed robust control scheme the uniform convergence of the flexible marine riser system is obtained through rigorous lyapunov analysis without any model reduction the rest of this paper is arranged as follows the system model and preliminaries are introduced in section ii the design of adaptive robust anti saturation control for the riser system is presented in section iii numerical simulations using finite difference method proceed in section iv and we come to a conclusion in section v notations are defined as follows z t 2 z t 2 z 2 3 z 3 4 z 4 and 2 t 2 2 system model and preliminaries 2 1 system model in this study the dynamical model of the considered flexible marine riser system shown in fig 1 is presented as follows he et al 2011 1 ρ x e i x t x c x f 0 0 z l 2 x 0 t x 0 t x l t 0 3 m x l t t x l t e i x l t d a x l t τ t d t consider the input saturation of the actuator and the saturation nonlinearity is described as follows 4 τ t s a t u t u max u t u max u t u min u t u max u min u t u min with u max 0 and u min 0 max u max u min τ m being the saturation limits and u t being the control law to be developed 2 2 preliminaries for purpose of conducting control design and stability analysis it is necessary to list the following assumptions lemmas and remarks assumption 1 for disturbances f z t and d t we assume that there exist constants f m d m ℝ satisfying f z t f m z t 0 l 0 and d t d m t 0 it is a reasonable assumption as f z t and d t have finite energy and hence are bounded he et al 2018c assumption 2 for the expression of input saturation 4 we assume that there exists a positive constant ϱ satisfying u ϱ where u τ t u t lemma 1 let ε 1 z t ε 2 z t ℝ ν 0 with z t 0 l 0 then the following inequality holds zhao et al 2017b 5 ε 1 z t ε 2 z t ε 1 z t ε 2 z t 1 ν ε 1 z t ν ε 2 z t 1 ν ε 1 2 z t ν ε 2 2 z t lemma 2 let ε z t ℝ be a function defined on z t 0 l 0 satisfying ε 0 t 0 t 0 then we have zhao et al 2017b 6 ε 2 z t l 0 l ε 2 z t d z remark 1 for analyzing the stability of the closed loop system and deriving our main results we present the following inequality 7 x l t d t x l t tanh x l t d where d is a positive constant satisfying d d m 3 control design in this section on the basis of lyapunov s approach and robust control theory we introduce an auxiliary system to design an adaptive robust boundary control for suppressing the riser s vibration removing the effects of nonlinear input saturation and handling the uncertainties of the system 3 1 boundary control in order to handle the nonlinear input saturation we introduce the following auxiliary system 8 ϖ t k 1 ϖ t u i u 0 5 u 2 ϖ t u ϖ t ϖ 0 0 ϖ t ϖ 0 where k 1 0 ϖ t is the state of the auxiliary system u i is an auxiliary variable to be introduced in the following and ϖ 0 is a small positive constant then we define the auxiliary variable u i as 9 u i x l t k 2 x l t k 3 x l t where k 2 k 3 0 to stabilize vibrations and compensate for uncertainties of the system we propose the following robust adaptive control law 10 u t k 4 ϖ t k 5 u i t ˆ x l t e i ˆ x l t d ˆ a x l t m ˆ k 2 x l t k 3 x l t tanh u i d ˆ where k 4 k 5 0 and t ˆ e i ˆ d ˆ a m ˆ d ˆ are estimates of t e i d a m d respectively the online updating laws are thus presented as 11 t ˆ σ 1 β 1 t ˆ β 1 x l t u i 12 e i ˆ σ 2 β 2 e i ˆ β 2 x l t u i 13 d ˆ a σ 3 β 3 d ˆ a β 3 x l t u i 14 m ˆ σ 4 β 4 m ˆ β 4 k 2 x l t k 3 x l t u i 15 d ˆ σ 5 d ˆ u i tanh u i where σ 1 σ 5 β 1 β 4 0 the estimation errors are defined as 16 t t t ˆ 17 e i e i e i ˆ 18 d a d a d ˆ a 19 m m m ˆ 20 d d d ˆ differentiating 9 and substituting 3 and 10 we have 21 u i x l t k 2 x l t k 3 x l t 1 m τ t d t t x l t e i x l t d a x l t m k 2 x l t m k 3 x l t 1 m u d t t x l t e i x l t d a x l t m k 2 x l t k 3 x l t k 4 ϖ t k 5 u i tanh u i d ˆ remark 2 in the proposed control law 10 the signals x l t x l t and x l t can be measured by employing a laser displacement sensor an inclinometer and a shear force sensor and then the signals x l t x l t and x l t can be obtained by applying the backward difference algorithm to x l t x l t and x l t respectively define the lyapunov function candidate as 22 v t v e t v f t v g t where 23 v e t ψ 2 ρ 0 l x 2 z t d z ψ 2 t 0 l x 2 z t d z ψ 2 e i 0 l x 2 z t d z 24 v f t χ ρ 0 l z x z t x z t d z 25 v g t m 2 u i 2 1 2 β 1 t 2 1 2 β 2 e i 2 1 2 β 3 d a 2 1 2 β 4 m 2 1 2 d 2 1 2 ϖ 2 t with ψ χ 0 lemma 3 the lyapunov function candidate 22 is a positive function with the following form 26 0 ϕ 1 v e t v g t v t ϕ 2 v e t v g t where ϕ 1 ϕ 2 0 proof 1 invoking lemma 1 and combining 24 yields 27 v f t χ ρ l 2 0 l x 2 z t d z χ ρ l 2 0 l x 2 z t d z ϑ v a t where 28 ϑ χ ρ l min ψ ρ ψ t ψ e i by appropriately choosing ψ and χ we have 29 ϑ 1 1 χ ρ l min ψ ρ ψ t ψ e i 1 ν 0 ϑ 2 1 χ ρ l min ψ ρ ψ t ψ e i 1 ν 1 29 indicates 0 ϑ 1 then using 28 leads to 30 ψ χ ρ l min ρ t e i we then rearrange 27 to obtain 31 ϑ v e t v f t ϑ v e t substituting 29 into 31 gives 32 0 ϑ 1 v e t v e t v f t ϑ 2 v e t the combination of 22 results in 33 0 ϕ 1 v e t v g t v t ϕ 2 v e t v g t where ϕ 1 min ϑ 1 1 0 and ϕ 2 max ϑ 2 1 0 lemma 4 the time derivative of the lyapunov function candidate 22 can be upper bounded with 34 v t ϕ v t α where ϕ α 0 proof 2 taking the derivative of 22 we get 35 v t v e t v f t v g t differentiating v e t and substituting 1 leads to 36 v e t ψ t x l t e i x l t x l t ψ 0 l x f d z c ψ 0 l x 2 d z combining 9 we arrive at 37 u i 2 x 2 l t k 2 2 x 2 l t k 3 2 x 2 l t 2 k 2 x l t x l t 2 k 3 x l t x l t 2 k 2 k 3 x l t x l t invoking 36 and 37 yields 38 v e t ψ e i 2 k 3 u i 2 ψ e i 2 k 3 x 2 l t ψ e i k 2 2 2 k 3 x 2 l t ψ e i k 3 2 x 2 l t ψ t ψ e i k 2 k 3 x l t x l t k 2 ψ e i x l t x l t ψ 0 l f x d z c ψ 0 l x 2 d z applying lemma 1 on 38 we have 39 v e t ψ e i 2 k 3 u i 2 ψ e i 2 k 3 x 2 l t ψ e i k 2 2 2 k 3 x 2 l t ψ e i k 3 2 x 2 l t ψ t ψ e i k 2 k 3 x l t x l t k 2 ψ e i x l t x l t ψ ε 1 0 l f 2 d z ψ c ε 1 0 l x 2 d z where ε 1 0 differentiating v f t substituting 1 and employing lemma 1 we get 40 v f t l χ e i x l t x l t 3 χ e i 2 0 l x 2 d z l χ c ε 2 0 l x 2 d z χ ρ l 2 x 2 l t χ t 2 χ ε 2 c l χ ε 3 l 0 l x 2 d z l χ ε 3 0 l f 2 d x χ t l 2 x 2 l t where ε 2 ε 3 0 taking the derivative of v g t and substituting 8 11 15 21 and 10 combining remark 1 and utilizing lemma 1 we derive 41 v g t k 5 u i 2 u i tanh u i d ˆ u i d t k 4 ϖ t u i u i tanh u i d σ 5 2 d 2 σ 5 2 d 2 k 1 1 2 ϖ 2 t σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 k 5 k 4 2 u i 2 k 1 1 2 k 4 2 ϖ 2 t σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 σ 5 2 d 2 σ 5 2 d 2 σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 substituting 39 41 into 35 and then utilizing lemma 1 we obtain 42 v t k 5 k 4 2 ψ e i 2 k 3 u i 2 k 1 1 2 k 4 2 ϖ 2 t σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 ψ e i k 2 2 2 k 3 ψ k 3 t e i k 2 2 k 3 ε 4 e i k 2 ψ l χ ε 5 2 χ t l 2 x 2 l t ψ e i 2 k 3 ψ k 3 t e i k 2 ε 4 2 k 3 χ ρ l 2 x 2 l t ψ e i k 3 2 e i k 2 ψ l χ 2 ε 5 x 2 l t ψ c ψ ε 1 l χ c ε 2 0 l x 2 d z χ t 2 χ ε 2 c l χ ε 3 l 0 l x 2 d z 3 χ e i 2 0 l x 2 d z ψ ε 1 l χ ε 3 0 l f 2 d z σ 5 2 d 2 σ 5 2 d 2 σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 where ε 4 ε 5 0 and ψ χ k i ε i for i 1 5 are chosen to satisfy the following conditions 43 ψ e i k 2 2 2 k 3 ψ k 3 t e i k 2 2 k 3 ε 4 e i k 2 ψ l χ ε 5 2 χ t l 2 0 44 ψ e i 2 k 3 ψ k 3 t e i k 2 ε 4 2 k 3 χ ρ l 2 0 45 ψ e i k 3 2 e i k 2 ψ l χ 2 ε 5 0 46 λ 1 ψ c ψ ε 1 l χ c ε 2 0 47 λ 2 χ t 2 χ ε 2 c l χ ε 3 l 0 48 λ 3 k 5 k 4 2 ψ e i 2 k 3 0 49 λ 4 k 1 1 2 k 4 2 0 50 α ψ ε 1 l χ ε 3 l f m 2 σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 σ 5 2 d 2 applying 43 50 on 42 leads to 51 v t λ 1 0 l x 2 d z λ 2 0 l x 2 d z 3 χ e i 2 0 l x 2 d z λ 3 u i 2 λ 4 ϖ 2 t σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 σ 5 2 d 2 α ϕ 3 v e t v g t α where ϕ 3 min 2 λ 1 ψ ρ 2 λ 2 ψ t 3 χ ψ 2 λ 3 m 2 λ 4 m σ 1 β 1 σ 2 β 2 σ 3 β 3 σ 4 β 4 σ 5 combining 26 and 51 we further obtain 52 v t ϕ v t α where ϕ ϕ 3 ϕ 2 the proof is thus completed theorem 1 for the considered riser system described by 1 3 under the proposed control law 10 and assumption 1 provided that the initial conditions are bounded and the design parameters ψ χ k i δ i for i 1 5 are chosen such that the constraints specified in 43 50 hold then we can conclude that the closed loop system state x z t is uniformly ultimately bounded proof 3 we multiply 35 by e ϕ t to obtain 53 t v t e ϕ t α e ϕ t taking the integration operation of 53 results in 54 v t v 0 e ϕ t α ϕ 1 e ϕ t v 0 e ϕ t α ϕ combining v e t 26 and lemma 2 gives 55 ψ t 2 l x 2 z t ψ t 2 0 l x 2 z t d z v e t 1 ϕ 1 v t substituting 54 into 55 yields 56 x z t 2 l ψ ϕ 1 t v 0 e ϕ t α ϕ z t 0 l 0 from 56 we further derive 57 lim t x z t 2 l α ψ t ϕ 1 ϕ z 0 l the proof is completed it should be highlighted that the stability analysis for the considered riser system with input saturation were discussed based on the case when ϖ t ϖ 0 ϖ t k 1 ϖ t u i u 0 5 u 2 ϖ t u that is the system exists input saturation then an auxiliary system is exploited to eliminate the effects arising from nonlinear input saturation for the case ϖ t ϖ 0 ϖ t 0 it is obvious that the system does not exist input saturation and a boundary control scheme can be developed employing the previous design methods which ignore the input saturation in he et al 2011 zhao et al 2018a for completeness we present the proof of system stability for the case ϖ t ϖ 0 ϖ t 0 in the following invoking ϖ t 0 we derive v g t as 58 v g t k 5 k 4 2 1 2 u i 2 k 4 2 ϖ 2 t 1 2 u 2 σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 σ 5 2 d 2 σ 5 2 d 2 σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 substituting 39 40 and 58 into 35 combining assumption 2 and then utilizing lemma 1 we obtain 59 v t k 5 k 4 2 1 2 ψ e i 2 k 3 u i 2 1 2 ϖ 2 t k 4 1 2 ϖ 0 2 1 2 ϱ 2 σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 ψ e i k 2 2 2 k 3 ψ k 3 t e i k 2 2 k 3 ε 4 e i k 2 ψ l χ ε 5 2 χ t l 2 x 2 l t ψ e i 2 k 3 ψ k 3 t e i k 2 ε 4 2 k 3 χ ρ l 2 x 2 l t ψ e i k 3 2 e i k 2 ψ l χ 2 ε 5 x 2 l t ψ c ψ ε 1 l χ c ε 2 0 l x 2 d z χ t 2 χ ε 2 c l χ ε 3 l 0 l x 2 d z 3 χ e i 2 0 l x 2 d z ψ ε 1 l χ ε 3 0 l f 2 d z σ 5 2 d 2 σ 5 2 d 2 σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 where ε 4 ε 5 0 and ψ χ k i ε i for i 1 5 are chosen to satisfy the following conditions 60 ψ e i k 2 2 2 k 3 ψ k 3 t e i k 2 2 k 3 ε 4 e i k 2 ψ l χ ε 5 2 χ t l 2 0 61 ψ e i 2 k 3 ψ k 3 t e i k 2 ε 4 2 k 3 χ ρ l 2 0 62 ψ e i k 3 2 e i k 2 ψ l χ 2 ε 5 0 63 ω 1 ψ c ψ ε 1 l χ c ε 2 0 64 ω 2 χ t 2 χ ε 2 c l χ ε 3 l 0 65 ω 3 k 5 k 4 2 1 2 ψ e i 2 k 3 0 66 α α k 4 1 2 ϖ 0 2 1 2 ϱ 2 applying 60 66 on 59 gives 67 v t ω 1 0 l x 2 d z ω 2 0 l x 2 d z 3 χ e i 2 0 l x 2 d z ω 3 u i 2 1 2 ϖ 2 t σ 1 2 t 2 σ 2 2 e i 2 σ 3 2 d a 2 σ 4 2 m 2 σ 5 2 d 2 α ϕ 4 v e t v g t α where ϕ 4 min 2 ω 1 ψ ρ 2 ω 2 ψ t 3 χ ψ 2 ω 3 m 1 σ 1 β 1 σ 2 β 2 σ 3 β 3 σ 4 β 4 σ 5 combining 26 and 67 we further have 68 v t ϕ v t α where ϕ ϕ 4 ϕ 2 applying the same analysis as presented in theorem 1 we derive 69 x z t 2 l ψ ϕ 1 t v 0 e ϕ t α ϕ z t 0 l 0 70 lim t x z t 2 l α ψ t ϕ 1 ϕ z 0 l invoking 69 and 70 we derive the closed loop system is also ultimately ultimately bounded stable when ϖ t ϖ 0 ϖ t 0 then combining theorem 1 we conclude that the closed loop system is ultimately ultimately bounded stable under the designed control law 10 and auxiliary system 8 remark 3 it is worth pointing out that the control design in this paper proceeds based on the original infinite dimensional partial differential equation which prevents the control spillover from modal method in a follow up study we will exploit the model reduction approach to conduct the neural network or learning based approaches yang et al 2017a 2017b 2018a 2018b xu et al 2017 dai et al 2018 zhang et al 2018a 2018b ma et al 2018 he et al 2017e 2018d cui et al 2017 for achieving the transient performance regulation of control systems 4 simulations in this section we find the approximate solution of the closed loop system by using the finite difference method he et al 2014 liu et al 2018b in order to verify the effectiveness of the proposed control 10 parameters of the riser system are given as l 1000 m ρ 500 kg m c 1 0 ns m 2 t 3 0 10 8 n e i 1 5 10 7 nm 2 m 9 6 10 6 kg d a 1 5 10 5 ns m the initial conditions of the system are presented as x z 0 15 z l x z 0 0 the ocean surface current velocity u t and distributed ocean current disturbance f z t are respectively formulated in he et al 2011 the expression of external environmental disturbance is presented as 71 d t 3 0 8 sin 0 7 t 0 2 sin 0 5 t 0 2 sin 0 9 t 10 5 for verifying the control performance of closed loop riser system with developed control 10 we consider three kinds of responses of the system in the following i without control the riser system is vibrating freely namely τ t 0 and the spatial time representation is shown in fig 2 ii with proposed control when the designed control 10 acts on the riser system by selecting the control parameters as k 1 k 3 β 1 β 2 β 3 β 4 1 k 2 20 k 4 0 01 k 5 8 10 7 σ 1 σ 2 σ 3 σ 4 1 10 4 σ 1 10 5 u m a x 3 10 5 and u m i n 2 10 5 the spatial time response is depicted in fig 3 iii with previous adaptive control in he et al 2011 when the previous boundary control proposed in he et al 2011 is exerted to the riser system choosing the control gains k 1 5 10 7 k 1 100 and k 2 1 and the 3d response is displayed in fig 4 the end offset x l t under no control developed control and previous control in he et al 2011 is illustrated in figs 5 and 6 respectively the time history of the designed auxiliary system state is presented in fig 7 the response diagram of boundary disturbance estimation error is depicted in fig 8 the time responses of the developed control command u t and saturated control input τ t are displayed in figs 9 and 10 the dynamic state of previous control in he et al 2011 is shown in fig 11 from figs 2 11 we observe that the riser s vibration is significantly suppressed under the developed control and previous control in he et al 2011 the control effect of previous control in he et al 2011 is not so good as that of proposed control 10 the disturbance estimation error is able to converge to a bounded value the nonlinear saturated input can be handled and limited in the specified range by adjusting the design control parameters and moreover the previous control in he et al 2011 can not achieve the anti saturation control issue in conclusion the proposed control works well in handling the nonlinear input saturation and uncertainties of the system as well as stabilizing vibrations of the riser system 5 conclusion this study was concerned with the vibration control and global stabilization of a distributed parameter flexible riser system in the presence of nonlinear input saturation and system uncertainties to realize the vibration suppression eliminate the nonlinear input saturation effects and compensate for system uncertainties the boundary robust adaptive control was constructed by integrating the auxiliary system with online updating laws the uniformly bounded stability of the controlled system was analyzed and demonstrated through rigorous lyapunov analysis without any model reduction finally simulation results were demonstrated for control performance verification in this paper we have addressed the anti saturation design problems of a flexible marine riser system future work includes control design for a flexible riser system with input deadzone or backlash in addition the extensions of the current approaches to the flexible riser systems in three dimensional space deserve further investigation and it is also a meaningful topic to conduct the practical experiment research for marine riser systems acknowledgment this work was supported in part by the national natural science foundation of china 61803109 11832009 61803111 and by the innovative school project of education department of guangdong 2017kqncx153 2017kzdxm060 
