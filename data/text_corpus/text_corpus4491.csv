index,text
22455,this paper addresses the path following of the autonomous wing sailed catamaran from two aspects i e guidance and control through the real time access to weather information and kinestates we develop a parallel guidance algorithm for the sailboat which comprises two modes namely tracking of waypoints and course keeping along the reference path in the first mode the characteristic tacking and gybing maneuvers of the sailboat are addressed by setting lanes in the second mode the serret frenet frame is established to acquire the desired heading angle and the line of sight los based modification mechanism is designed to prevent the large deviation from the reference path the proposed guidance is acceptable to the parameterized smooth reference path with arbitrary shapes in coherence with the guidance we further design a practical control scheme for the wing sailed catamaran with the fuzzy logic systems flss accounting for uncertainties the robust damping technique is adopted to reduce the algorithmic complexity the saturation nonlinearities of actuators are approximated by the sigmoid functions such that the backstepping approach can be applied to circumvent the frequent acting of actuators the ideology of event triggered control etc is introduced in the control scheme and the separate triggering conditions are designed for the wing and the rudder respectively the proposed control scheme can ensure all the errors in the closed loop system to be semi global uniformly ultimate bounded sguub besides the existence of minimum inter event times is proven finally numerical experiments are conducted to verify the feasibility of the proposed scheme keywords path following wing sailed catamaran parallel guidance saturation of actuators event triggered control 1 introduction due to the exhaustion of fossil resources in the coming decades it is urgent to seek for new and renewable resources in all the industrial fields especially in the ocean going conveyance the combustion engine powered ship occupied a fair chunk of global petroleum consumption as the wind energy is plentiful and widely distributed in most of the global sea the revival of wind assisted ship is very potential in the future shukla and ghosh 2009 another context consists in the prosperity of unmanned surface vessels usv it was reflected in the enactment of the international maritime organization imo who endorsed a scoping framework of the maritime autonomous surface ship mass in 2018 for the small scaled usv the wind assisted usv is more meritorious than the common powered one this is because the energy storage such as the battery and the fuel tank will limit adaptability of the common powered usv especially in long term and wide range tasks researchers have recognized the value of the wind assisted usv for the last two decades plenty of work has been conducted on the aerodynamic optimization of the wind assisted usv ma et al 2019a and many prototypes were built rynne and von ellenrieder 2009 by comparison the studies on the path following of the wind assisted usv developed relatively late and several challenging problems have not been solved as yet as a typical wind assisted usv the wing sailed catamaran is concerned in this paper which is more efficient in propulsion than the common sailboat besides the roll motion can be exempted from the mathematical model different with the common powered ship navigation of the sailboat is constrained by the direction of the wind a zigzag trajectory is required when the sailboat steers upwind and downwind so as to circumvent stall and enhance the surge speed these characteristic maneuvers are referred to as tacking and gybing of the sailboat stelzer et al 2007 to address these maneuvers several work was developed in the level of path planning in pêtrès et al 2012 plumet et al 2015 the hysteresis potential field was constructed to describe the no go zones and avert the frequent tacking and gybing based on voronoi diagram xiao et al 2011 proposed a real time planning algorithm with no informative demands on the wind less ard springett et al 2017 proposed a voting based mechanism to plan the current course which synthesized the waypoints tracking the tacking and gybing the collision avoidance and the channel constraint together in cruz and alves 2014 the mechanism to generate the reference path was dictated and the performance of navigation was analyzed by fabricating the cost function saoud et al 2015 developed a three level architecture to solve routing and course control of the sailboat nevertheless the above path planning schemes suffered from two shortages first the effective guidance to the planned routine was not provided that means the sailboat may head the no go zones in its way to the reference path second as the weather information was involved in the planning process they were not suitable for the path following task of a specified reference path in elkaim and kelbley 2006 and deng et al 2019c the waypoints based guidance principles were proposed for sailboat in the los frame which solved the first problem but the reference path was limited to straight lines and arcs they were not able to follow the curve paths while in special waters the tracking task of curve reference paths inevitably exists to control a sailboat the separate principle was usually accepted that means the surge motion is mainly controlled by the sail while the yaw motion the rudder on account of intricacy of the wind the existing studies on the surge motion mainly focused on the speed optimization such as herrero et al 2010 xiao et al 2012a corno et al 2016 deng et al 2019b although the surge speed of the sailboat can be maximized through these strategies it was uncontrollable however the speed regulation of the usv is usually required in nautical practice especially in the maneuver of collision avoidance ma et al 2018 as the aerodynamics of the rigid wing sail can be known in advance the control of the surge speed for the wing sailed usv is achievable nevertheless due to the constraints of wind force and direction the saturation of the control effort should be considered for the yaw motion there existed plenty of work in the level of course keeping with the model of the sailboat unknown or partly known we can refer to elkaim and kelbley 2006 and cruz and alves 2010 for the pid stelzer et al 2007 for the fuzzy control with the deterministic model herrero et al 2010 designed the controller for the rudder based on the feedback linearization technique xiao and jouffroy 2011 and he et al 2012 designed the backstepping control laws where he et al 2012 investigated the weight balancing system considering the uncertainties the model reference adaptive control was adopted in xiao et al 2012b with the yaw motion of the sailboat simplified as the first order nomoto model in xiao and jouffroy 2014 the uncertainties were offset by tuning parameters in deng et al 2019c the robust damping techniques were introduced to address the uncertainties nevertheless the saturation of the rudder angle was not considered in most of the above studies which is indispensable for implementation although jaulin and bars 2013 saoud et al 2015 viel et al 2018 added the saturation limit on the controller rigorous proofs were omitted to overcome this problem we can get enlightened from the studies on the common powered usv where the control for the sail is left out not to make an exhaustive survey one effective and convenient choice is to approximate the saturation uncertainty by the sigmoid function such as zhu and du 2018 deng et al 2019a ma et al 2019b for the gauss error function li and tong 2015 park et al 2017 for the hyperbolic tangent function another nontrivial problem for the control of usvs is to lower the acting frequency of the actuators as the processor with samplers and zero order holders zohs is widely employed in nautical practice the continuous control law is emulated in a discrete and periodical way katayama and aoki 2014 because high frequency acting of the actuator will increase the mechanical wear and shorten its service life it is more preferred to send the control command to the actuator with a lower frequency because the increment of the acting period may degrade the control performance a better way is to send signals only when it is necessary which conforms to the thought of etc the etc for the common nonlinear system has been widely studied in recent years such as li and yang 2018b a sahoo and narayanan 2019 narayanan et al 2019 guo et al 2019 wang et al 2019 in contrast it was not popular in the field of ship s motion control although the event triggered mechanism has already been introduced to several marine applications such as mirzaei et al 2017 liu et al 2017 they focused on the internal communication reduction and the control scheduling to our comprehension the etc for the usv is challenging because of its diverse practical requirements which constrains the portability of the etc for common nonlinear systems for instance the above etc studies required the iteration of all neural network weights to offset uncertainties which was not suitable for the usv besides the etc for nonlinear systems usually neglects the saturation constraint which may destroy the etc design in postoyan et al 2015 the etc for a unicycle robot was designed which was similar with the underactuated ship in jiao and wang 2016a b the etc for the fully actuated usv was developed nevertheless these designs required the deterministic model of the usv without the consideration of input saturation besides the control laws were not acceptable to actuators directly in our knowledge there are no other researches on the etc for the usv as yet let alone the wind assisted usv motivated by the above challenges this paper investigates both the path following guidance and the etc for the wing sailed catamaran the contributions are mainly fourfold 1 a so called parallel guidance is developed for the path following of the sailboat which extracts the advantages of the serret frenet frame and the los algorithm tacking and gybing maneuvers are also considered compared with the existing guidance principles for the sailboat the proposed one is applicable to the curved smooth reference path and is more general 2 compared with the existing control schemes for the sailboat the control law for the sheeting angle of the wing sail is devised and the surge speed is controllable 3 the etc technique is introduced and the derived triggering condition can guarantee the minimum inter event times of actuators compared with the continuous control schemes for the usv the proposed scheme can lower the acting frequencies of actuators without the degradation of control performance 4 the sigmoid functions are employed to release the saturation constraint which is compatible with the etc design it is meaningful in the level of nonlinear control the remainder is organized as follows in section 2 the preliminaries are provided section 3 and section 4 depict the designs for guidance and control respectively in section 5 stability of the closed loop system is analyzed in section 6 the numerical experiment is conducted to validate the proposed scheme section 7 concludes the entire work notations in this paper sign denotes the sign function of the discussed element denote the 2 norm and inf denotes the infimum 2 preliminaries 2 1 mathematical model according to xiao and jouffroy 2014 the mathematical model of a sailboat can be deemed as a newton lagrange mechanical system with 4 degrees of freedom dof as the catamaran is discussed in this paper the roll motion can be exempted thus a 3 dof model is established to describe the motions of the catamaran where the attitudes are described by eq 1 of the kinematic loop and the kinestates are described by eq 2 of the dynamic loop 1 x u cos ψ v sin ψ y u sin ψ v cos ψ ψ r 2 m u u f x s f x r f x h m v v r f w u m v v f y s f y r f y h m u u r f w v m r r m z s m z r m z h m u m v u v d r r m w r where the involved variables are defined in table 1 and their physical meanings are illustrated in fig 1 in eq 2 m i i u v r can be approximately calculated by empirical equations in fossen 2011 which are deemed to be known in this paper reasonably the time varying disturbances are supposed to be bounded by unknown positive constants namely f w u m u d w u f w v m v d w v and m w r m r d w r concerned with complex hydrodynamics of the rudder and the hull we assume d f x i f y i and m z i with i h r to be unknown in this paper conforming to the separate principle the yaw motion is mainly controlled by m z r in eq 2 while the surge motion controlled by f x s following deng et al 2019b we can rewrite m z r c r t δ r 2 where δ r 2 δ r δ r and c r t is a time varying gain bounded by c r c r t c r the saturation constraint of the rudder is described as eq 3 3 δ r 2 δ r 2 i f δ r 2 c δ r 2 δ r 2 c i f δ r 2 δ r 2 c δ r 2 δ r 2 i f δ r 2 c δ r 2 where δ r 2 c is the ideal control command δ r 2 is the constant upper bound because the wing sail is preselected its aerodynamic information is deemed to be known in this paper here we presume that the coe of the wind to the wing sail is fixed according to the geometrical relationships in fig 1 it is clear that α s α a w δ s and the transformation from u t w to u a w is described as eq 4 4 u a w x u t w cos ψ t w ψ u r y s u a w y u t w sin ψ t w ψ v r x s where u a w x and u a w y denote the speed components of u a w on the surge and the sway respectively x s and y s denote the coordinates of the wing sail in the body frame then we can render eq 5 5 u a w u a w u 2 u a w v 2 α a w arctan u a w v u a w u 90 sign u a w v u a w u 90 sign u a w v according to the aerodynamics of the wing sail xiao and jouffroy 2014 l s and d s in fig 1 can be calculated by eq 6 6 l s 1 2 ρ a a s u a w 2 c l s d s 1 2 ρ a a s u a w 2 c d s where ρ a is air density a s is the unilateral surface area of the wing sail c l s and c d s denote the coefficients of lift and drag according to stevens et al 2016 we can deem that c l s and c d s are irrelevant with u a w for the sailboat and they are the functions of α s with the known curves from the geometric relationships in fig 1 we can infer eq 7 7 f x s l s sin α a w d s cos α a w f y s l s cos α a w d s sin α a w m z s f y s x s f x s y s synthesizing eq 6 and eq 7 it renders 8 f x s 1 2 ρ a a s u a w 2 c l s sin α a w 1 2 ρ a a s u a w 2 c d s cos α a w because δ s α a w α s while α a w u a w and f x s are specified in eq 8 we can derive the value of δ s from the curves of c l s and c d s according to the curve features of c l s and c d s for wings stevens et al 2016 it is known from eq 8 that for specified α a w and u a w f x s is constrained from 0 to a time varying upper bound f x s α a w u a w in a connected set of δ s denoted as ω s δ s m i n δ s max in this set δ s o is defined to correspond to f x s divided into two cases the zoning of ω s is demonstrated in fig 2 then the saturation constraint of the wing sail can be described as eq 9 9 f x s f x s i f f x s c f x s f x s c i f f x s f x s c 0 0 i f f x s c 0 where f x s c is the ideal control command control objective through the saturation constraints of eq 3 and eq 9 design the control laws of δ r 2 c and f x s c that enables the wing sailed catamaran with kinetics of eq 1 and eq 2 to follow the reference path remark 1 we assume all the information of the wind and the kinestates of the catamaran is accessible in real time this assumption is tenable because u a w and α a w can be acquired by the anemoscope such that u t w and ψ t w can be conversely calculated from eq 4 and eq 5 besides the kinestates of the catamaran can be measured by the nautical apparatuses such as gps and compass remark 2 the second differential equation of eq 2 refers to the sway motion of the catamaran as it can be converted to a second order non integrable constraint its stabilization is also an underactuated problem by adopting the principle of passive boundedness li et al 2008 there is no need to consider this motion in the control design that means the sway speed will keep bounded once the surge speed and the yaw rate converge to their desired values physically this motion is constrained by the hydrodynamic damping 2 2 fls approximation according to wang 1994 the fls possesses the property of universal approximation to any continuous function in a compact set based on the base of fuzzy rules it can be divided into three steps to utilize the fls i e fuzzification fuzzy reasoning and defuzzification for a multi inputs single output system with x r n and y r 1 it can be described by the fls as eq 10 10 y x i 1 n w i s i x i 1 n s i x where there is totally n fuzzy rules w i denotes the weight of each rule s i x denotes the product of membership functions of each element of x in eq 10 φ i s i i 1 n s i is called the fuzzy basis function if we define w w 1 w n t and φ φ 1 φ n t eq 10 can be rewritten as y w t φ the approximating capability of the fls can be concluded as the following lemma lemma 1 deng et al 2019b for any continuous function of f x defined in the compact set of x ω one can always find a fls satisfying 11 f x w t φ x ε where ε ε always holds ε can be an arbitrarily small positive constant assumption 1 li and yang 2018b the fls is linearly parameterized such that φ x l x always holds where l is a positive constant furthermore φ x is bounded by a positive constant φ 3 parallel guidance the parallel guidance can be divided into two modes namely the tracking of the target waypoint and the course keeping along the reference path as a premise the reference path is parameterized such that all the information of it is available we can refer to the work in lekkas and fossen 2019 liu et al 2016 for this purpose thus the positional coordinates of the reference path is expressed as x d ω y d ω while ψ k ω denotes its path tangent angle where ω is a monotone increasing parameter from 0 for both modes the mechanism to segment the reference path is first established by comparing the direction of true wind ψ t w and the path tangent angle ψ k ω the reference path can be divided into three types of segments as shown in fig 3 the unnavigable segments are determined by satisfying the following condition where ψ k ω is located in no go zones 12 ψ k ω ψ t w 30 ψ t w 30 or ψ k ω ψ t w 225 ψ t w 155 where ω 0 ω end ω end is the parameter of the ending waypoint of the whole reference path the segments without satisfying the condition of eq 12 are classified as the navigable segment here we set the minimal length of this segment as s min if the length of the navigable segment is less than s min it is omitted and treated to be unnavigable seeing the violet one in fig 3 this setting is to circumvent the frequent switching between two modes of guidance discussed as follows mode 1 this mode is activated in two situations one is at the beginning of path following seeing the mode 1a in fig 3 the other is when the sailboat arrives at the ending point of the navigable segment seeing the mode 1b in fig 3 according to the above segmentation mechanism a target waypoint is generated at the center of the trigger zone where the trigger zone is constructed with the fixed width and the fixed length along the reference path from the closest starting waypoint of the navigable segment seeing the apricot strips in fig 3 with this target point the desired course angle is obtained as eq 13 13 ψ d c 1 sign x e sign y e 90 arctan y e ω t x e ω t where ω t is the parameter of the target waypoint x e ω t x d ω t x and y e ω t y d ω t y the desired heading angle can be further deduced as ψ d h ψ d c β if ψ d h is located in the no go zones the tacking or the gybing maneuver is needed then the lane attached to the target waypoint is established along the direction of the true wind with the width of l t the trajectory of the sailboat should be confined in this lane seeing the mode 1a in fig 3 in this situation the desired heading angle ψ d h is redefined to switch between ψ d h 1 ψ t w 225 and ψ d h 2 ψ t w 155 for the tacking maneuver between ψ d h 1 ψ t w 30 and ψ d h 2 ψ t w 30 for the gybing maneuver whenever the sailboat arrives either side of the lane tacking or gybing maneuver lasts until ψ d h calculated by eq 13 is located outside the no go zones defining the straight line distance between the target waypoint and the sailboat as z e ω t it has z e x e 2 y e 2 then we will check the convergence of the sailboat to the target waypoint we first assume that the devised control laws in the next section can ensure the convergence of ψ to ψ d h then by substituting eq 13 to eq 1 it renders 14 x u x e z e y u y e z e define the lyapunov candidate as v 1 z e 2 2 differentiating v 1 with eq 14 it renders 15 v 1 x e x e y e y e x e x d y e y d u z e u x d y d z e it can be inferred from eq 15 that v 1 is asymptotically stable while u x d y d this condition is tenable as the wind is deemed to be slowly time varying for the extreme condition of fast time varying wind almost all the control schemes will fail mode 2 this mode is activated when the sailboat arrives the trigger zone in fig 3 according to encarnacao et al 2000 we can always find the waypoint with the parameter ω s satisfying the following condition 16 x x d ω s y y d ω s arctan ψ k ω s if eq 16 has more than one root we choose the root corresponding to the waypoint closest to the starting waypoint of the current navigable segment which is to ensure the guidance principle can traverse all this segment then the serret frenet frame attached to x d ω s y d ω s is established as seen in the mode 2a and 2b of fig 3 where l c denotes the cross track error of the sailboat here we set a positive threshold of l c for l c if l c l c the sailboat is navigated parallel to the navigable segment seeing the mode 2a the desired heading angle is set as ψ d h ψ k ω s if l c l c a los based modification mechanism is activated seeing the mode 2b here the desired heading angle is set as eq 17 17 ψ d h ψ k ω s arctan l c δ where δ is the look ahead distance by tuning δ largely we can always guarantee that ψ d h is located in the no go zones then we will check the convergence of the sailboat to the navigable segment in the mode 2b according to encarnacao et al 2000 the evolution of l c satisfies eq 18 18 l c u sin ψ β ψ k ω s adopt the same assumption of ψ ψ d h as the mode 1 by substituting eq 17 to eq 18 it renders 19 l c u sin arctan l c δ β u l c l c 2 δ 2 cos β u δ l c 2 δ 2 sin β define the lyapunov candidate as v 2 l c 2 2 by differentiating v 2 with eq 19 it renders 20 v 2 u l c 2 l c 2 δ 2 cos β u l c δ l c 2 δ 2 sin β it can be inferred from eq 20 that v 2 is asymptotically stable while l c δ tan β according to the nautical practice tan β is a small value here we select l c δ tan β then it can be concluded that the sailboat will converge to the navigable segment once its cross track error satisfies l c l c the mode 2 functions until the origin of the serret frenet frame lands in the ending waypoint of the current navigable segment then the mode 1 functions by alternating these two modes the path following guidance for the sailboat is complete 4 control design in this section the control laws for both the rudder and the wing sail are devised as the etc is adopted the triggering conditions are also devised corresponding to the actuators it is divided into two subsections to unfold the designs 4 1 rudder this subsection aims to design the etc law for δ r 2 c that enables ψ to converge to ψ d h following the backstepping approach the virtual control law for r is devised as eq 21 21 α r k ψ ψ e ψ d h where k ψ is the tuning parameter and ψ e ψ ψ d h ψ d h can be smoothed and estimated by introducing the filters such as the dsc filter in deng et al 2019b then differentiating ψ e with eq 21 and eq 1 it renders 22 ψ e α r r e ψ d h k ψ ψ e r e where r e r α r is the tracking error according to li and tong 2015 park et al 2017 the saturation constraint of eq 3 can be approximated by the hyperbolic tangent function as eq 23 23 δ ˆ r 2 δ r 2 tanh δ r 2 c δ r 2 d r where δ ˆ r 2 is the continuous control command for δ r 2 d r is the approximating error with the upper bound d r d r according to the etc we set δ r 2 t δ ˆ r 2 t j r for t t j r t j 1 r where t j r j 0 n r 1 denote the triggering instants of the rudder the first triggering instant t 0 r is set to be the initial time t 0 of the voyage and n r is the total triggering times of the rudder along the voyage we define the control error as e r δ r 2 δ ˆ r 2 according to the lagrange mean value theorem of eq 23 δ r 2 can be rewritten as eq 24 24 δ r 2 h r δ r 2 c d r e r h r 1 cosh 2 s s 0 δ r 2 c δ r 2 because δ r 2 c will be bounded it is reasonable to presume that 0 h r h r 1 where h r is a positive constant according to lemma 1 we define a fls of eq 25 to approximate the uncertainties in yaw motion of eq 2 25 w r t φ r ν r ε r m z s m z h m u m v u v d r r m r α r where ν r u a w α a w δ s ψ d h ψ d h ψ d h u v r t by differentiating r e with eqs 2 3 24 and 25 it renders 26 r e w r t φ r ν r ε r m w r m r c r d r m r c r h r δ r 2 c m r c r e r m r according to the robust damping technique in deng et al 2019a we first define the damping term as φ r φ r 1 and the compressed weight of the fls as θ r max w r ε r d w r c r d r m r then the control law for δ r 2 c is devised as eq 27 27 δ r 2 c m r c r k r r e k f r r e where k r is the tuning parameter k f r is the damping parameter satisfying k f r λ r φ r 1 2 h r and λ r is a positive constant to proceed the design of the triggering condition define the lyapunov candidate as v r ψ e 2 2 r e 2 2 at first differentiating v r with eqs 22 26 and 27 and the young s inequality it renders 28 v r k ψ ψ e 2 r e ψ e θ r φ r r e c r e r r e m r k r h r r e 2 k f r h r r e 2 k ψ 1 2 ψ e 2 k r h r 1 r e 2 c r 2 e r 2 2 m r 2 θ r 2 4 λ r if we set a positive constant of a r satisfying a r min k ψ 0 5 k r h r 1 then eq 28 can be rewritten as eq 29 29 v r 2 a r v r c r 2 e r 2 2 m r 2 θ r 2 4 λ r according to eq 29 the triggering condition of eq 30 is devised to determine the next triggering instant 30 t j 1 r inf t r t t j r c r 2 e r 2 4 a r m r 2 1 γ r v r v r μ r where 0 γ r 1 and μ r is a positive constant concerning the ultimate bound of v r the setting of μ r is to support the existence of minimum inter event time of the rudder 4 2 wing sail it is well known that all the sailboats have a polar diagram of the maximum surge speed corresponding to its bearing angle to the wind thus the desire surge speed u d should always be located in the interval from 0 to the current maximum surge speed of the sailboat then our objective is to design the control law for f x s c that enables u to track u d here we assume u d is first order differentiable and define the tracking error as u e u u d similar with the rudder the sigmoid function of eq 31 is fabricated to approximate the saturation constraint of eq 9 31 f ˆ x s f x s u a w α a w 1 exp 2 4 f x s c f x s d u where f ˆ x s is the continuous signal to update f x s at triggering instants d u is the approximating error with the upper bound d u d u according to eq 8 f ˆ x s corresponds to a sole δ ˆ s in the range of δ s m i n δ s o ω s following the etc we set δ s t δ ˆ s t j u for t t j u t j 1 u where t j u j 0 n u 1 denote the triggering instants of the wing sail similarly t 0 u t 0 and n u denotes the total triggering times of the wing sail it can be inferred that f x s t j u f ˆ x s t j u at triggering instants here we define the control error as e u f x s f ˆ x s according to the lagrange mean value theorem f x s can be rewritten as eq 32 32 f x s h u f x s c σ u e u h u 4 exp 1 exp 2 4 s f x s 2 s 0 f x s c where σ u d u f x s 1 exp 2 and it is reasonable to set the upper bound of σ u σ u because f x s c will be bounded it always holds that 0 h u h u 1 where h u is a positive constant according to lemma 1 the fls of eq 33 is fabricated to approximate the uncertainties in the surge motion of eq 2 33 w u t φ u ν u ε u f x r f x h m v v r m u u d where ν u δ r u v r u d t by differentiating u e with eqs 2 32 and 33 it renders 34 u e w u t φ u ν u ε u f w u m u h u f x s c m u σ u m u e u m u according to the robust damping define the damping term as φ u φ u 1 and the compressed weight as θ u max w u ε u d w u σ u m u then the control law for f x s c is devised as eq 35 35 f x s c m u k u u e k f u u e where k u is the tuning parameter k f u λ u φ u 1 2 h u is the damping parameter and λ u is a positive constant to design the triggering condition we define the lyapunov candidate as v u u e 2 2 differentiating v u with eq 34 and the young s inequality it renders 36 v u k u h u u e 2 θ u φ u u e k f u h u u e 2 e u u e m u k u h u 1 u e 2 θ u 2 4 λ u e u 2 4 m u 2 if we set a u k u h u 1 where a u is a positive constant eq 36 can be rewritten as eq 37 37 v u 2 a u v u e u 2 4 m u 2 θ u 2 4 λ u then the next triggering instant is determined by satisfying the triggering condition of eq 38 38 t j 1 u inf t r t t j u e u 2 8 a u m u 2 1 γ u v u v u μ u or t j 1 u inf t r t t j u δ s t ω s where μ u is the positive constant and 0 γ u 1 remark 3 different with eq 30 the triggering condition of eq 38 does not aim to eliminate the zeno phenomenon because the wind is unpredictable and may meet the second equation of eq 38 continuously continuous updating of δ s is prone to happening when δ s is located at the boundary of ω s usually at the moment f x s 0 while the control in surge motion tends to be stable the etc mechanism works compared with the common continuous scheme the computational burden is still largely reduced as seen in the following simulation 5 stability analysis the outcome of this paper can be concluded as the following theorem theorem 1 assume that all the states of the wing sailed catamaran described by eq 1 and eq 2 are located in a compact set i e ω x y ψ u v r x 2 y 2 ψ 2 u 2 v 2 r 2 δ ω where δ ω is a positive constant for any parameterized smooth reference path the proposed guidance principle in subsection 3 is adopted while the desired heading angle ψ d h is tracked the convergence of the catamaran to the reference path is guaranteed the etc laws of eq 27 and eq 35 with the triggering conditions of eq 30 and eq 38 can ensure all the tracking errors in the closed loop system to be sguub and ψ and u can track ψ d h and u d with the arbitrary precisions besides the minimum inter event time of the rudder and that of the wing sail for the first equation of eq 38 always exist proof of sguub from eq 30 it knows that c r 2 e r 2 4 a r m r 2 1 γ r v r always holds for v r μ r substituting this condition to eq 29 it renders 39 v r 2 a r γ r v r θ r 2 4 λ r which further infers v r t v r t 0 exp 2 a r γ r t t 0 1 exp 2 a r γ r t t 0 θ r 2 8 a r γ r λ r it is clear that v r t is sguub by max μ r θ r 2 8 a r γ r λ r as the quadratic components are less than v r t it is clear that ψ e and r e are also sguub from eq 38 it knows that e u 2 8 a u m u 2 1 γ u v u always holds for v u μ u substituting this condition to eq 37 it renders 40 v u 2 a u γ u v u θ u 2 4 λ u which further infers v u t v u t 0 exp 2 a u γ u t t 0 1 exp 2 a u γ u t t 0 θ u 2 8 a u γ u λ u thus v u t is sguub by max μ u θ u 2 8 a u γ u λ u and u e is also sguub the proof is complete remark 4 it can be inferred from eq 39 and eq 40 that by increasing a i and γ i where i u r the fast convergence and high precision of the tracking errors are guaranteed by increasing λ i the high tracking precision is guaranteed nevertheless a i can not go to infinity by increasing k ψ and k i because the growth of k i and λ i will lead to the decrease of h i according to eq 24 and eq 32 which restrains the growth of a i from another point the increment of a i and λ i corresponds to large and high energy control inputs while the increment of γ i will lower the inter event time and lead to the frequent acting of actuators thus a trade off is needed to select these parameters in reality proof of minimum inter event time define the lyapunov candidate for the control error as w i e i 2 where i r u and the minimum inter event time as δ t i it is clear that w i t j i 0 where j 0 n i 1 differentiating w r it renders 41 w r 2 e r e r 2 δ ˆ r 2 e r 2 δ r 2 c e r according to eq 27 it is tenable that δ r 2 c l 1 r e where l 1 is a positive constant according to eqs 26 and 27 and the assumption 1 the following inequality always holds 42 r e θ r l r ν r 1 c r h r l 1 m r r e c r m r e r because all the states in the closed loop system are located in the compact set of ω it is tenable to assume ν r μ r 1 and r e μ r 2 where μ r 1 and μ r 2 are constants by substituting eq 42 to eq 41 and simplifying it we can obtain eq 43 43 w r 2 l 2 w r 2 l 3 w r where l 2 l 1 θ r l r μ r 1 l 1 θ r l 1 2 μ r 2 c r h r m r and l 3 l 1 c r m r by solving eq 43 with w r t j r 0 it renders 44 w r t l 2 l 3 e l 3 t t j r l 2 l 3 2 t t j r t j 1 r by substituting eq 30 to eq 44 the minimum inter event time for the rudder satisfies the following inequality 45 δ t r 1 l 3 ln 1 2 l 3 m r a r 1 γ r μ r l 2 c r it is obvious from eq 45 that δ t r 0 always holds differentiating w u it renders 46 w u 2 e u e u 2 f x s e u 2 f ˆ x s e u according to the saturation constraint of eq 9 it has f ˆ x s max f x s f x s c as the wind is assumed to be slowly time varying it is tenable that f x s l 4 and f x s l 5 where l 4 and l 5 are positive constants similarly it can be inferred from eq 35 that f x s c l 6 u e according to eqs 34 and 35 and assumption 1 the following inequality is rendered 47 u e θ u l u ν u 1 h u l 6 m u u e e u m u assuming ν u μ u 1 and u e μ u 2 and substituting eq 47 to eq 46 it renders 48 w u 2 l 4 w u 2 max l 5 l 7 l 8 w u w u where l 7 l 6 θ u l u μ u 1 l 6 θ u l 6 2 h u μ u 2 m u and l 8 l 6 m u by solving eq 48 with w u t j u 0 it renders 49 w u t max l 4 l 5 2 t t j u 2 l 4 l 7 l 8 e l 8 t t j u l 4 l 7 l 8 2 t t j u t j 1 u substituting eq 38 to eq 49 the minimum inter event time is derived to satisfy the following inequality 50 δ t u min 2 m u 2 a u 1 γ u μ u l 4 l 5 1 l 8 ln 1 2 m u l 8 2 a u 1 γ u μ u l 4 l 7 it is obvious from eq 50 that δ t u 0 always holds for the first equation of the triggering condition of eq 38 thus the proof is complete 6 numerical experiment to verify the effectiveness of the proposed scheme a numerical experiment is carried out here a prototype of the wing sailed catamaran is selected to be the control objective as shown in fig 4 it possesses the mass of 67 2 kg the length of 1 8m and the breadth of 1 3m the wing sail area is 1 4 m 2 and the rudder area is 0 3 m 2 according to the relevant empirical equations in jia and yang 1999 inertia of the catamaran is roughly estimated as m u 71 6 m v 138 3 and m r 15 5 the acting range of the rudder is set to be δ r 30 30 bounds of gain of the rudder are set to be c r 50 and c r 80 it is clear in fig 4 that two shuttle shaped wing sails are installed in the catamaran by referring to the computational fluid dynamics cfd examination in ma et al 2019a the lift and drag coefficients of this kind of wing sail can be obtained in the normal condition of navigation the coefficients corresponding to the attacking angle are provided in fig 5 according to fig 5 eq 8 and the mechanical limitation zoning of ω s in α a w 0 180 can be calculated as fig 6 because the wing sail possesses the symmetric deployment zoning in α a w 180 0 is also symmetric because the gybing maneuver will not cause the stall of the catamaran it is not considered in the mode 1 of the proposed guidance in the simulation only the tacking maneuver is addressed here in the simulation we assume the wind of beaufort scale 4 which rotates anticlockwise from ψ t w 180 with a constant rate of 0 025 s this is to emulate the slow time varying feature of wind the environmental disturbances here are described by the first order markov process as eq 51 51 f w u f w u 0 1 m u ω u f w v f w v 0 1 m v ω v m w r m w r 0 1 m r ω r where ω i i u v r denote three independent white noise with the variance of 1 in a curved form the reference path here is set as x d 30 sin π y d 30 40 the desired surge speed is set as u d 1 m s the initial attitudes of the catamaran are set as x y ψ 20 m 5 m 45 all the initial kinestates of the catamaran are set to be 0 the principal parameters of guidance and control are set as l t 10 m l c 1 m δ 20 m k ψ 0 5 k r 1 5 k u 2 and k f r k f u 15 to reveal the differences in acting frequencies resulting from the etc design we compare three catamarans marked as no 1 no 2 and no 3 respectively which are uniform in the principal parameters but different in the setting of triggering conditions namely 1 γ r γ u 1 2 γ r 0 5 γ u 0 8 3 γ r 0 8 γ u 0 5 it is observed that the triggering conditions will lose effect for the no 1 catamaran thus it is deemed as a continuous control scheme with no degradation of the stability the sampling period of 0 1s for the actuators is set in the no 1 catamaran which is to emulate the limitation of digital processors then the experiment is carried out and three catamarans are launched at the same time time evolution of the disturbances are shown in fig 7 the disturbances are calculated to achieve approximately 20 of the thrust and the turning torque thus the setting of eq 51 is reasonable fig 8 shows the trajectories of three catamarans with a slow time varying wind the guidance principle takes effects on the whole voyage for the three uphill slopes of the sinusoidal path the mode 1 is triggered where the tacking maneuver is conducted in the first one for the three downhill slopes the mode 2 is triggered it can be observed that large overshoots happen after the peaks and valleys of the path and the los modification in the mode 2 functions from fig 2 we found no significant difference in trajectories of three catamarans it suggests that the control performances are not degraded by the setting of etc in no 2 and no 3 catamarans in fig 9 the heading angle the surge and the sway speeds of catamarans are exhibited due to the influence of white noise fluctuations always exist in their evolution due to the changes of wind speed and direction the surge speed can not accurately track the desired value of u d 1 m s but converge to its neighborhood fig 10 provides the terminal control inputs of the rudder and the wing sail in fig 10 a the saturation for the rudder angle is observed when the catamaran turns the control design to deal with the saturation functions as the control inputs coincide in the mainstream it reveals that the setting of etc here will not increase the cost of acting energy in fig 10 b the difference of control inputs is observed while the continuous inputs of no 1 vary at every sampling instant those of no 2 and no 3 hold between two consecutive triggering instants to quantify this performance the minimal the maximal and the mean inter event times denoted as t m i n t m a x and t m e a n are collected in table 2 the accumulation of triggering times is shown in fig 11 because γ r of the no 2 catamaran is smaller than that of the no 3 t m i n t m a x and t m e a n of the no 2 catamaran are all bigger than those of the no 3 for the rudder correspondingly the growing rate of no 2 is lower than that of no 3 for the rudder in fig 11 contrary results can be obtained for the wing sail these results coincide with the analysis in remark 4 during the total voyage time of 483 6 s the no 2 catamaran will save 42 and 52 of triggering times for the rudder and the wing sail respectively while the no 3 will save 20 and 63 these numbers will be more considerable for a longer voyage in the long run the service life of actuators will be largely prolonged by the proposed control scheme 7 conclusion in this paper path following of the wing sail catamaran is addressed from both the aspects of guidance and control for the guidance we develop a so called parallel guidance principle which can be divided into two modes the first mode aims to guide the tracking of the waypoint while tacking and gybing maneuvers are solved by setting lanes the second mode establishes the serret frenet frame to guide the course keeping along the navigable segment while the los based modification mechanism is designed to prevent the deviation the stability of both modes is proved for the control we synthesize several practical considerations the sigmoid functions are fabricated to approximate the saturation constraint the robust fuzzy damping is designed to offset the uncertainties the etc is introduced to lower the acting frequencies of actuators finally both the good transient and stable performances are revealed in the numerical experiment of a catamaran prototype through the proposed scheme because the control objective is the catamaran the roll motion is not considered in this paper thus it is prospective to extend the proposed scheme to the path following of common sailboats for this purpose the limitation of roll should be involved in the control design acknowledgements this work is partially supported by the national science foundation of china no 51679024 the fundamental research funds for the central university no 3132019501 the national high technology research and development program of china no 2015aa016404 the university 111 project of china no b08046 the doctoral scientific research foundation of liaoning province no 20170520189 and the natural science foundation of liaoning province no 20180520039 the author would sincerely thank the anonymous reviewers for their pertinent and instructive suggestions to improve the quality of this paper 
22455,this paper addresses the path following of the autonomous wing sailed catamaran from two aspects i e guidance and control through the real time access to weather information and kinestates we develop a parallel guidance algorithm for the sailboat which comprises two modes namely tracking of waypoints and course keeping along the reference path in the first mode the characteristic tacking and gybing maneuvers of the sailboat are addressed by setting lanes in the second mode the serret frenet frame is established to acquire the desired heading angle and the line of sight los based modification mechanism is designed to prevent the large deviation from the reference path the proposed guidance is acceptable to the parameterized smooth reference path with arbitrary shapes in coherence with the guidance we further design a practical control scheme for the wing sailed catamaran with the fuzzy logic systems flss accounting for uncertainties the robust damping technique is adopted to reduce the algorithmic complexity the saturation nonlinearities of actuators are approximated by the sigmoid functions such that the backstepping approach can be applied to circumvent the frequent acting of actuators the ideology of event triggered control etc is introduced in the control scheme and the separate triggering conditions are designed for the wing and the rudder respectively the proposed control scheme can ensure all the errors in the closed loop system to be semi global uniformly ultimate bounded sguub besides the existence of minimum inter event times is proven finally numerical experiments are conducted to verify the feasibility of the proposed scheme keywords path following wing sailed catamaran parallel guidance saturation of actuators event triggered control 1 introduction due to the exhaustion of fossil resources in the coming decades it is urgent to seek for new and renewable resources in all the industrial fields especially in the ocean going conveyance the combustion engine powered ship occupied a fair chunk of global petroleum consumption as the wind energy is plentiful and widely distributed in most of the global sea the revival of wind assisted ship is very potential in the future shukla and ghosh 2009 another context consists in the prosperity of unmanned surface vessels usv it was reflected in the enactment of the international maritime organization imo who endorsed a scoping framework of the maritime autonomous surface ship mass in 2018 for the small scaled usv the wind assisted usv is more meritorious than the common powered one this is because the energy storage such as the battery and the fuel tank will limit adaptability of the common powered usv especially in long term and wide range tasks researchers have recognized the value of the wind assisted usv for the last two decades plenty of work has been conducted on the aerodynamic optimization of the wind assisted usv ma et al 2019a and many prototypes were built rynne and von ellenrieder 2009 by comparison the studies on the path following of the wind assisted usv developed relatively late and several challenging problems have not been solved as yet as a typical wind assisted usv the wing sailed catamaran is concerned in this paper which is more efficient in propulsion than the common sailboat besides the roll motion can be exempted from the mathematical model different with the common powered ship navigation of the sailboat is constrained by the direction of the wind a zigzag trajectory is required when the sailboat steers upwind and downwind so as to circumvent stall and enhance the surge speed these characteristic maneuvers are referred to as tacking and gybing of the sailboat stelzer et al 2007 to address these maneuvers several work was developed in the level of path planning in pêtrès et al 2012 plumet et al 2015 the hysteresis potential field was constructed to describe the no go zones and avert the frequent tacking and gybing based on voronoi diagram xiao et al 2011 proposed a real time planning algorithm with no informative demands on the wind less ard springett et al 2017 proposed a voting based mechanism to plan the current course which synthesized the waypoints tracking the tacking and gybing the collision avoidance and the channel constraint together in cruz and alves 2014 the mechanism to generate the reference path was dictated and the performance of navigation was analyzed by fabricating the cost function saoud et al 2015 developed a three level architecture to solve routing and course control of the sailboat nevertheless the above path planning schemes suffered from two shortages first the effective guidance to the planned routine was not provided that means the sailboat may head the no go zones in its way to the reference path second as the weather information was involved in the planning process they were not suitable for the path following task of a specified reference path in elkaim and kelbley 2006 and deng et al 2019c the waypoints based guidance principles were proposed for sailboat in the los frame which solved the first problem but the reference path was limited to straight lines and arcs they were not able to follow the curve paths while in special waters the tracking task of curve reference paths inevitably exists to control a sailboat the separate principle was usually accepted that means the surge motion is mainly controlled by the sail while the yaw motion the rudder on account of intricacy of the wind the existing studies on the surge motion mainly focused on the speed optimization such as herrero et al 2010 xiao et al 2012a corno et al 2016 deng et al 2019b although the surge speed of the sailboat can be maximized through these strategies it was uncontrollable however the speed regulation of the usv is usually required in nautical practice especially in the maneuver of collision avoidance ma et al 2018 as the aerodynamics of the rigid wing sail can be known in advance the control of the surge speed for the wing sailed usv is achievable nevertheless due to the constraints of wind force and direction the saturation of the control effort should be considered for the yaw motion there existed plenty of work in the level of course keeping with the model of the sailboat unknown or partly known we can refer to elkaim and kelbley 2006 and cruz and alves 2010 for the pid stelzer et al 2007 for the fuzzy control with the deterministic model herrero et al 2010 designed the controller for the rudder based on the feedback linearization technique xiao and jouffroy 2011 and he et al 2012 designed the backstepping control laws where he et al 2012 investigated the weight balancing system considering the uncertainties the model reference adaptive control was adopted in xiao et al 2012b with the yaw motion of the sailboat simplified as the first order nomoto model in xiao and jouffroy 2014 the uncertainties were offset by tuning parameters in deng et al 2019c the robust damping techniques were introduced to address the uncertainties nevertheless the saturation of the rudder angle was not considered in most of the above studies which is indispensable for implementation although jaulin and bars 2013 saoud et al 2015 viel et al 2018 added the saturation limit on the controller rigorous proofs were omitted to overcome this problem we can get enlightened from the studies on the common powered usv where the control for the sail is left out not to make an exhaustive survey one effective and convenient choice is to approximate the saturation uncertainty by the sigmoid function such as zhu and du 2018 deng et al 2019a ma et al 2019b for the gauss error function li and tong 2015 park et al 2017 for the hyperbolic tangent function another nontrivial problem for the control of usvs is to lower the acting frequency of the actuators as the processor with samplers and zero order holders zohs is widely employed in nautical practice the continuous control law is emulated in a discrete and periodical way katayama and aoki 2014 because high frequency acting of the actuator will increase the mechanical wear and shorten its service life it is more preferred to send the control command to the actuator with a lower frequency because the increment of the acting period may degrade the control performance a better way is to send signals only when it is necessary which conforms to the thought of etc the etc for the common nonlinear system has been widely studied in recent years such as li and yang 2018b a sahoo and narayanan 2019 narayanan et al 2019 guo et al 2019 wang et al 2019 in contrast it was not popular in the field of ship s motion control although the event triggered mechanism has already been introduced to several marine applications such as mirzaei et al 2017 liu et al 2017 they focused on the internal communication reduction and the control scheduling to our comprehension the etc for the usv is challenging because of its diverse practical requirements which constrains the portability of the etc for common nonlinear systems for instance the above etc studies required the iteration of all neural network weights to offset uncertainties which was not suitable for the usv besides the etc for nonlinear systems usually neglects the saturation constraint which may destroy the etc design in postoyan et al 2015 the etc for a unicycle robot was designed which was similar with the underactuated ship in jiao and wang 2016a b the etc for the fully actuated usv was developed nevertheless these designs required the deterministic model of the usv without the consideration of input saturation besides the control laws were not acceptable to actuators directly in our knowledge there are no other researches on the etc for the usv as yet let alone the wind assisted usv motivated by the above challenges this paper investigates both the path following guidance and the etc for the wing sailed catamaran the contributions are mainly fourfold 1 a so called parallel guidance is developed for the path following of the sailboat which extracts the advantages of the serret frenet frame and the los algorithm tacking and gybing maneuvers are also considered compared with the existing guidance principles for the sailboat the proposed one is applicable to the curved smooth reference path and is more general 2 compared with the existing control schemes for the sailboat the control law for the sheeting angle of the wing sail is devised and the surge speed is controllable 3 the etc technique is introduced and the derived triggering condition can guarantee the minimum inter event times of actuators compared with the continuous control schemes for the usv the proposed scheme can lower the acting frequencies of actuators without the degradation of control performance 4 the sigmoid functions are employed to release the saturation constraint which is compatible with the etc design it is meaningful in the level of nonlinear control the remainder is organized as follows in section 2 the preliminaries are provided section 3 and section 4 depict the designs for guidance and control respectively in section 5 stability of the closed loop system is analyzed in section 6 the numerical experiment is conducted to validate the proposed scheme section 7 concludes the entire work notations in this paper sign denotes the sign function of the discussed element denote the 2 norm and inf denotes the infimum 2 preliminaries 2 1 mathematical model according to xiao and jouffroy 2014 the mathematical model of a sailboat can be deemed as a newton lagrange mechanical system with 4 degrees of freedom dof as the catamaran is discussed in this paper the roll motion can be exempted thus a 3 dof model is established to describe the motions of the catamaran where the attitudes are described by eq 1 of the kinematic loop and the kinestates are described by eq 2 of the dynamic loop 1 x u cos ψ v sin ψ y u sin ψ v cos ψ ψ r 2 m u u f x s f x r f x h m v v r f w u m v v f y s f y r f y h m u u r f w v m r r m z s m z r m z h m u m v u v d r r m w r where the involved variables are defined in table 1 and their physical meanings are illustrated in fig 1 in eq 2 m i i u v r can be approximately calculated by empirical equations in fossen 2011 which are deemed to be known in this paper reasonably the time varying disturbances are supposed to be bounded by unknown positive constants namely f w u m u d w u f w v m v d w v and m w r m r d w r concerned with complex hydrodynamics of the rudder and the hull we assume d f x i f y i and m z i with i h r to be unknown in this paper conforming to the separate principle the yaw motion is mainly controlled by m z r in eq 2 while the surge motion controlled by f x s following deng et al 2019b we can rewrite m z r c r t δ r 2 where δ r 2 δ r δ r and c r t is a time varying gain bounded by c r c r t c r the saturation constraint of the rudder is described as eq 3 3 δ r 2 δ r 2 i f δ r 2 c δ r 2 δ r 2 c i f δ r 2 δ r 2 c δ r 2 δ r 2 i f δ r 2 c δ r 2 where δ r 2 c is the ideal control command δ r 2 is the constant upper bound because the wing sail is preselected its aerodynamic information is deemed to be known in this paper here we presume that the coe of the wind to the wing sail is fixed according to the geometrical relationships in fig 1 it is clear that α s α a w δ s and the transformation from u t w to u a w is described as eq 4 4 u a w x u t w cos ψ t w ψ u r y s u a w y u t w sin ψ t w ψ v r x s where u a w x and u a w y denote the speed components of u a w on the surge and the sway respectively x s and y s denote the coordinates of the wing sail in the body frame then we can render eq 5 5 u a w u a w u 2 u a w v 2 α a w arctan u a w v u a w u 90 sign u a w v u a w u 90 sign u a w v according to the aerodynamics of the wing sail xiao and jouffroy 2014 l s and d s in fig 1 can be calculated by eq 6 6 l s 1 2 ρ a a s u a w 2 c l s d s 1 2 ρ a a s u a w 2 c d s where ρ a is air density a s is the unilateral surface area of the wing sail c l s and c d s denote the coefficients of lift and drag according to stevens et al 2016 we can deem that c l s and c d s are irrelevant with u a w for the sailboat and they are the functions of α s with the known curves from the geometric relationships in fig 1 we can infer eq 7 7 f x s l s sin α a w d s cos α a w f y s l s cos α a w d s sin α a w m z s f y s x s f x s y s synthesizing eq 6 and eq 7 it renders 8 f x s 1 2 ρ a a s u a w 2 c l s sin α a w 1 2 ρ a a s u a w 2 c d s cos α a w because δ s α a w α s while α a w u a w and f x s are specified in eq 8 we can derive the value of δ s from the curves of c l s and c d s according to the curve features of c l s and c d s for wings stevens et al 2016 it is known from eq 8 that for specified α a w and u a w f x s is constrained from 0 to a time varying upper bound f x s α a w u a w in a connected set of δ s denoted as ω s δ s m i n δ s max in this set δ s o is defined to correspond to f x s divided into two cases the zoning of ω s is demonstrated in fig 2 then the saturation constraint of the wing sail can be described as eq 9 9 f x s f x s i f f x s c f x s f x s c i f f x s f x s c 0 0 i f f x s c 0 where f x s c is the ideal control command control objective through the saturation constraints of eq 3 and eq 9 design the control laws of δ r 2 c and f x s c that enables the wing sailed catamaran with kinetics of eq 1 and eq 2 to follow the reference path remark 1 we assume all the information of the wind and the kinestates of the catamaran is accessible in real time this assumption is tenable because u a w and α a w can be acquired by the anemoscope such that u t w and ψ t w can be conversely calculated from eq 4 and eq 5 besides the kinestates of the catamaran can be measured by the nautical apparatuses such as gps and compass remark 2 the second differential equation of eq 2 refers to the sway motion of the catamaran as it can be converted to a second order non integrable constraint its stabilization is also an underactuated problem by adopting the principle of passive boundedness li et al 2008 there is no need to consider this motion in the control design that means the sway speed will keep bounded once the surge speed and the yaw rate converge to their desired values physically this motion is constrained by the hydrodynamic damping 2 2 fls approximation according to wang 1994 the fls possesses the property of universal approximation to any continuous function in a compact set based on the base of fuzzy rules it can be divided into three steps to utilize the fls i e fuzzification fuzzy reasoning and defuzzification for a multi inputs single output system with x r n and y r 1 it can be described by the fls as eq 10 10 y x i 1 n w i s i x i 1 n s i x where there is totally n fuzzy rules w i denotes the weight of each rule s i x denotes the product of membership functions of each element of x in eq 10 φ i s i i 1 n s i is called the fuzzy basis function if we define w w 1 w n t and φ φ 1 φ n t eq 10 can be rewritten as y w t φ the approximating capability of the fls can be concluded as the following lemma lemma 1 deng et al 2019b for any continuous function of f x defined in the compact set of x ω one can always find a fls satisfying 11 f x w t φ x ε where ε ε always holds ε can be an arbitrarily small positive constant assumption 1 li and yang 2018b the fls is linearly parameterized such that φ x l x always holds where l is a positive constant furthermore φ x is bounded by a positive constant φ 3 parallel guidance the parallel guidance can be divided into two modes namely the tracking of the target waypoint and the course keeping along the reference path as a premise the reference path is parameterized such that all the information of it is available we can refer to the work in lekkas and fossen 2019 liu et al 2016 for this purpose thus the positional coordinates of the reference path is expressed as x d ω y d ω while ψ k ω denotes its path tangent angle where ω is a monotone increasing parameter from 0 for both modes the mechanism to segment the reference path is first established by comparing the direction of true wind ψ t w and the path tangent angle ψ k ω the reference path can be divided into three types of segments as shown in fig 3 the unnavigable segments are determined by satisfying the following condition where ψ k ω is located in no go zones 12 ψ k ω ψ t w 30 ψ t w 30 or ψ k ω ψ t w 225 ψ t w 155 where ω 0 ω end ω end is the parameter of the ending waypoint of the whole reference path the segments without satisfying the condition of eq 12 are classified as the navigable segment here we set the minimal length of this segment as s min if the length of the navigable segment is less than s min it is omitted and treated to be unnavigable seeing the violet one in fig 3 this setting is to circumvent the frequent switching between two modes of guidance discussed as follows mode 1 this mode is activated in two situations one is at the beginning of path following seeing the mode 1a in fig 3 the other is when the sailboat arrives at the ending point of the navigable segment seeing the mode 1b in fig 3 according to the above segmentation mechanism a target waypoint is generated at the center of the trigger zone where the trigger zone is constructed with the fixed width and the fixed length along the reference path from the closest starting waypoint of the navigable segment seeing the apricot strips in fig 3 with this target point the desired course angle is obtained as eq 13 13 ψ d c 1 sign x e sign y e 90 arctan y e ω t x e ω t where ω t is the parameter of the target waypoint x e ω t x d ω t x and y e ω t y d ω t y the desired heading angle can be further deduced as ψ d h ψ d c β if ψ d h is located in the no go zones the tacking or the gybing maneuver is needed then the lane attached to the target waypoint is established along the direction of the true wind with the width of l t the trajectory of the sailboat should be confined in this lane seeing the mode 1a in fig 3 in this situation the desired heading angle ψ d h is redefined to switch between ψ d h 1 ψ t w 225 and ψ d h 2 ψ t w 155 for the tacking maneuver between ψ d h 1 ψ t w 30 and ψ d h 2 ψ t w 30 for the gybing maneuver whenever the sailboat arrives either side of the lane tacking or gybing maneuver lasts until ψ d h calculated by eq 13 is located outside the no go zones defining the straight line distance between the target waypoint and the sailboat as z e ω t it has z e x e 2 y e 2 then we will check the convergence of the sailboat to the target waypoint we first assume that the devised control laws in the next section can ensure the convergence of ψ to ψ d h then by substituting eq 13 to eq 1 it renders 14 x u x e z e y u y e z e define the lyapunov candidate as v 1 z e 2 2 differentiating v 1 with eq 14 it renders 15 v 1 x e x e y e y e x e x d y e y d u z e u x d y d z e it can be inferred from eq 15 that v 1 is asymptotically stable while u x d y d this condition is tenable as the wind is deemed to be slowly time varying for the extreme condition of fast time varying wind almost all the control schemes will fail mode 2 this mode is activated when the sailboat arrives the trigger zone in fig 3 according to encarnacao et al 2000 we can always find the waypoint with the parameter ω s satisfying the following condition 16 x x d ω s y y d ω s arctan ψ k ω s if eq 16 has more than one root we choose the root corresponding to the waypoint closest to the starting waypoint of the current navigable segment which is to ensure the guidance principle can traverse all this segment then the serret frenet frame attached to x d ω s y d ω s is established as seen in the mode 2a and 2b of fig 3 where l c denotes the cross track error of the sailboat here we set a positive threshold of l c for l c if l c l c the sailboat is navigated parallel to the navigable segment seeing the mode 2a the desired heading angle is set as ψ d h ψ k ω s if l c l c a los based modification mechanism is activated seeing the mode 2b here the desired heading angle is set as eq 17 17 ψ d h ψ k ω s arctan l c δ where δ is the look ahead distance by tuning δ largely we can always guarantee that ψ d h is located in the no go zones then we will check the convergence of the sailboat to the navigable segment in the mode 2b according to encarnacao et al 2000 the evolution of l c satisfies eq 18 18 l c u sin ψ β ψ k ω s adopt the same assumption of ψ ψ d h as the mode 1 by substituting eq 17 to eq 18 it renders 19 l c u sin arctan l c δ β u l c l c 2 δ 2 cos β u δ l c 2 δ 2 sin β define the lyapunov candidate as v 2 l c 2 2 by differentiating v 2 with eq 19 it renders 20 v 2 u l c 2 l c 2 δ 2 cos β u l c δ l c 2 δ 2 sin β it can be inferred from eq 20 that v 2 is asymptotically stable while l c δ tan β according to the nautical practice tan β is a small value here we select l c δ tan β then it can be concluded that the sailboat will converge to the navigable segment once its cross track error satisfies l c l c the mode 2 functions until the origin of the serret frenet frame lands in the ending waypoint of the current navigable segment then the mode 1 functions by alternating these two modes the path following guidance for the sailboat is complete 4 control design in this section the control laws for both the rudder and the wing sail are devised as the etc is adopted the triggering conditions are also devised corresponding to the actuators it is divided into two subsections to unfold the designs 4 1 rudder this subsection aims to design the etc law for δ r 2 c that enables ψ to converge to ψ d h following the backstepping approach the virtual control law for r is devised as eq 21 21 α r k ψ ψ e ψ d h where k ψ is the tuning parameter and ψ e ψ ψ d h ψ d h can be smoothed and estimated by introducing the filters such as the dsc filter in deng et al 2019b then differentiating ψ e with eq 21 and eq 1 it renders 22 ψ e α r r e ψ d h k ψ ψ e r e where r e r α r is the tracking error according to li and tong 2015 park et al 2017 the saturation constraint of eq 3 can be approximated by the hyperbolic tangent function as eq 23 23 δ ˆ r 2 δ r 2 tanh δ r 2 c δ r 2 d r where δ ˆ r 2 is the continuous control command for δ r 2 d r is the approximating error with the upper bound d r d r according to the etc we set δ r 2 t δ ˆ r 2 t j r for t t j r t j 1 r where t j r j 0 n r 1 denote the triggering instants of the rudder the first triggering instant t 0 r is set to be the initial time t 0 of the voyage and n r is the total triggering times of the rudder along the voyage we define the control error as e r δ r 2 δ ˆ r 2 according to the lagrange mean value theorem of eq 23 δ r 2 can be rewritten as eq 24 24 δ r 2 h r δ r 2 c d r e r h r 1 cosh 2 s s 0 δ r 2 c δ r 2 because δ r 2 c will be bounded it is reasonable to presume that 0 h r h r 1 where h r is a positive constant according to lemma 1 we define a fls of eq 25 to approximate the uncertainties in yaw motion of eq 2 25 w r t φ r ν r ε r m z s m z h m u m v u v d r r m r α r where ν r u a w α a w δ s ψ d h ψ d h ψ d h u v r t by differentiating r e with eqs 2 3 24 and 25 it renders 26 r e w r t φ r ν r ε r m w r m r c r d r m r c r h r δ r 2 c m r c r e r m r according to the robust damping technique in deng et al 2019a we first define the damping term as φ r φ r 1 and the compressed weight of the fls as θ r max w r ε r d w r c r d r m r then the control law for δ r 2 c is devised as eq 27 27 δ r 2 c m r c r k r r e k f r r e where k r is the tuning parameter k f r is the damping parameter satisfying k f r λ r φ r 1 2 h r and λ r is a positive constant to proceed the design of the triggering condition define the lyapunov candidate as v r ψ e 2 2 r e 2 2 at first differentiating v r with eqs 22 26 and 27 and the young s inequality it renders 28 v r k ψ ψ e 2 r e ψ e θ r φ r r e c r e r r e m r k r h r r e 2 k f r h r r e 2 k ψ 1 2 ψ e 2 k r h r 1 r e 2 c r 2 e r 2 2 m r 2 θ r 2 4 λ r if we set a positive constant of a r satisfying a r min k ψ 0 5 k r h r 1 then eq 28 can be rewritten as eq 29 29 v r 2 a r v r c r 2 e r 2 2 m r 2 θ r 2 4 λ r according to eq 29 the triggering condition of eq 30 is devised to determine the next triggering instant 30 t j 1 r inf t r t t j r c r 2 e r 2 4 a r m r 2 1 γ r v r v r μ r where 0 γ r 1 and μ r is a positive constant concerning the ultimate bound of v r the setting of μ r is to support the existence of minimum inter event time of the rudder 4 2 wing sail it is well known that all the sailboats have a polar diagram of the maximum surge speed corresponding to its bearing angle to the wind thus the desire surge speed u d should always be located in the interval from 0 to the current maximum surge speed of the sailboat then our objective is to design the control law for f x s c that enables u to track u d here we assume u d is first order differentiable and define the tracking error as u e u u d similar with the rudder the sigmoid function of eq 31 is fabricated to approximate the saturation constraint of eq 9 31 f ˆ x s f x s u a w α a w 1 exp 2 4 f x s c f x s d u where f ˆ x s is the continuous signal to update f x s at triggering instants d u is the approximating error with the upper bound d u d u according to eq 8 f ˆ x s corresponds to a sole δ ˆ s in the range of δ s m i n δ s o ω s following the etc we set δ s t δ ˆ s t j u for t t j u t j 1 u where t j u j 0 n u 1 denote the triggering instants of the wing sail similarly t 0 u t 0 and n u denotes the total triggering times of the wing sail it can be inferred that f x s t j u f ˆ x s t j u at triggering instants here we define the control error as e u f x s f ˆ x s according to the lagrange mean value theorem f x s can be rewritten as eq 32 32 f x s h u f x s c σ u e u h u 4 exp 1 exp 2 4 s f x s 2 s 0 f x s c where σ u d u f x s 1 exp 2 and it is reasonable to set the upper bound of σ u σ u because f x s c will be bounded it always holds that 0 h u h u 1 where h u is a positive constant according to lemma 1 the fls of eq 33 is fabricated to approximate the uncertainties in the surge motion of eq 2 33 w u t φ u ν u ε u f x r f x h m v v r m u u d where ν u δ r u v r u d t by differentiating u e with eqs 2 32 and 33 it renders 34 u e w u t φ u ν u ε u f w u m u h u f x s c m u σ u m u e u m u according to the robust damping define the damping term as φ u φ u 1 and the compressed weight as θ u max w u ε u d w u σ u m u then the control law for f x s c is devised as eq 35 35 f x s c m u k u u e k f u u e where k u is the tuning parameter k f u λ u φ u 1 2 h u is the damping parameter and λ u is a positive constant to design the triggering condition we define the lyapunov candidate as v u u e 2 2 differentiating v u with eq 34 and the young s inequality it renders 36 v u k u h u u e 2 θ u φ u u e k f u h u u e 2 e u u e m u k u h u 1 u e 2 θ u 2 4 λ u e u 2 4 m u 2 if we set a u k u h u 1 where a u is a positive constant eq 36 can be rewritten as eq 37 37 v u 2 a u v u e u 2 4 m u 2 θ u 2 4 λ u then the next triggering instant is determined by satisfying the triggering condition of eq 38 38 t j 1 u inf t r t t j u e u 2 8 a u m u 2 1 γ u v u v u μ u or t j 1 u inf t r t t j u δ s t ω s where μ u is the positive constant and 0 γ u 1 remark 3 different with eq 30 the triggering condition of eq 38 does not aim to eliminate the zeno phenomenon because the wind is unpredictable and may meet the second equation of eq 38 continuously continuous updating of δ s is prone to happening when δ s is located at the boundary of ω s usually at the moment f x s 0 while the control in surge motion tends to be stable the etc mechanism works compared with the common continuous scheme the computational burden is still largely reduced as seen in the following simulation 5 stability analysis the outcome of this paper can be concluded as the following theorem theorem 1 assume that all the states of the wing sailed catamaran described by eq 1 and eq 2 are located in a compact set i e ω x y ψ u v r x 2 y 2 ψ 2 u 2 v 2 r 2 δ ω where δ ω is a positive constant for any parameterized smooth reference path the proposed guidance principle in subsection 3 is adopted while the desired heading angle ψ d h is tracked the convergence of the catamaran to the reference path is guaranteed the etc laws of eq 27 and eq 35 with the triggering conditions of eq 30 and eq 38 can ensure all the tracking errors in the closed loop system to be sguub and ψ and u can track ψ d h and u d with the arbitrary precisions besides the minimum inter event time of the rudder and that of the wing sail for the first equation of eq 38 always exist proof of sguub from eq 30 it knows that c r 2 e r 2 4 a r m r 2 1 γ r v r always holds for v r μ r substituting this condition to eq 29 it renders 39 v r 2 a r γ r v r θ r 2 4 λ r which further infers v r t v r t 0 exp 2 a r γ r t t 0 1 exp 2 a r γ r t t 0 θ r 2 8 a r γ r λ r it is clear that v r t is sguub by max μ r θ r 2 8 a r γ r λ r as the quadratic components are less than v r t it is clear that ψ e and r e are also sguub from eq 38 it knows that e u 2 8 a u m u 2 1 γ u v u always holds for v u μ u substituting this condition to eq 37 it renders 40 v u 2 a u γ u v u θ u 2 4 λ u which further infers v u t v u t 0 exp 2 a u γ u t t 0 1 exp 2 a u γ u t t 0 θ u 2 8 a u γ u λ u thus v u t is sguub by max μ u θ u 2 8 a u γ u λ u and u e is also sguub the proof is complete remark 4 it can be inferred from eq 39 and eq 40 that by increasing a i and γ i where i u r the fast convergence and high precision of the tracking errors are guaranteed by increasing λ i the high tracking precision is guaranteed nevertheless a i can not go to infinity by increasing k ψ and k i because the growth of k i and λ i will lead to the decrease of h i according to eq 24 and eq 32 which restrains the growth of a i from another point the increment of a i and λ i corresponds to large and high energy control inputs while the increment of γ i will lower the inter event time and lead to the frequent acting of actuators thus a trade off is needed to select these parameters in reality proof of minimum inter event time define the lyapunov candidate for the control error as w i e i 2 where i r u and the minimum inter event time as δ t i it is clear that w i t j i 0 where j 0 n i 1 differentiating w r it renders 41 w r 2 e r e r 2 δ ˆ r 2 e r 2 δ r 2 c e r according to eq 27 it is tenable that δ r 2 c l 1 r e where l 1 is a positive constant according to eqs 26 and 27 and the assumption 1 the following inequality always holds 42 r e θ r l r ν r 1 c r h r l 1 m r r e c r m r e r because all the states in the closed loop system are located in the compact set of ω it is tenable to assume ν r μ r 1 and r e μ r 2 where μ r 1 and μ r 2 are constants by substituting eq 42 to eq 41 and simplifying it we can obtain eq 43 43 w r 2 l 2 w r 2 l 3 w r where l 2 l 1 θ r l r μ r 1 l 1 θ r l 1 2 μ r 2 c r h r m r and l 3 l 1 c r m r by solving eq 43 with w r t j r 0 it renders 44 w r t l 2 l 3 e l 3 t t j r l 2 l 3 2 t t j r t j 1 r by substituting eq 30 to eq 44 the minimum inter event time for the rudder satisfies the following inequality 45 δ t r 1 l 3 ln 1 2 l 3 m r a r 1 γ r μ r l 2 c r it is obvious from eq 45 that δ t r 0 always holds differentiating w u it renders 46 w u 2 e u e u 2 f x s e u 2 f ˆ x s e u according to the saturation constraint of eq 9 it has f ˆ x s max f x s f x s c as the wind is assumed to be slowly time varying it is tenable that f x s l 4 and f x s l 5 where l 4 and l 5 are positive constants similarly it can be inferred from eq 35 that f x s c l 6 u e according to eqs 34 and 35 and assumption 1 the following inequality is rendered 47 u e θ u l u ν u 1 h u l 6 m u u e e u m u assuming ν u μ u 1 and u e μ u 2 and substituting eq 47 to eq 46 it renders 48 w u 2 l 4 w u 2 max l 5 l 7 l 8 w u w u where l 7 l 6 θ u l u μ u 1 l 6 θ u l 6 2 h u μ u 2 m u and l 8 l 6 m u by solving eq 48 with w u t j u 0 it renders 49 w u t max l 4 l 5 2 t t j u 2 l 4 l 7 l 8 e l 8 t t j u l 4 l 7 l 8 2 t t j u t j 1 u substituting eq 38 to eq 49 the minimum inter event time is derived to satisfy the following inequality 50 δ t u min 2 m u 2 a u 1 γ u μ u l 4 l 5 1 l 8 ln 1 2 m u l 8 2 a u 1 γ u μ u l 4 l 7 it is obvious from eq 50 that δ t u 0 always holds for the first equation of the triggering condition of eq 38 thus the proof is complete 6 numerical experiment to verify the effectiveness of the proposed scheme a numerical experiment is carried out here a prototype of the wing sailed catamaran is selected to be the control objective as shown in fig 4 it possesses the mass of 67 2 kg the length of 1 8m and the breadth of 1 3m the wing sail area is 1 4 m 2 and the rudder area is 0 3 m 2 according to the relevant empirical equations in jia and yang 1999 inertia of the catamaran is roughly estimated as m u 71 6 m v 138 3 and m r 15 5 the acting range of the rudder is set to be δ r 30 30 bounds of gain of the rudder are set to be c r 50 and c r 80 it is clear in fig 4 that two shuttle shaped wing sails are installed in the catamaran by referring to the computational fluid dynamics cfd examination in ma et al 2019a the lift and drag coefficients of this kind of wing sail can be obtained in the normal condition of navigation the coefficients corresponding to the attacking angle are provided in fig 5 according to fig 5 eq 8 and the mechanical limitation zoning of ω s in α a w 0 180 can be calculated as fig 6 because the wing sail possesses the symmetric deployment zoning in α a w 180 0 is also symmetric because the gybing maneuver will not cause the stall of the catamaran it is not considered in the mode 1 of the proposed guidance in the simulation only the tacking maneuver is addressed here in the simulation we assume the wind of beaufort scale 4 which rotates anticlockwise from ψ t w 180 with a constant rate of 0 025 s this is to emulate the slow time varying feature of wind the environmental disturbances here are described by the first order markov process as eq 51 51 f w u f w u 0 1 m u ω u f w v f w v 0 1 m v ω v m w r m w r 0 1 m r ω r where ω i i u v r denote three independent white noise with the variance of 1 in a curved form the reference path here is set as x d 30 sin π y d 30 40 the desired surge speed is set as u d 1 m s the initial attitudes of the catamaran are set as x y ψ 20 m 5 m 45 all the initial kinestates of the catamaran are set to be 0 the principal parameters of guidance and control are set as l t 10 m l c 1 m δ 20 m k ψ 0 5 k r 1 5 k u 2 and k f r k f u 15 to reveal the differences in acting frequencies resulting from the etc design we compare three catamarans marked as no 1 no 2 and no 3 respectively which are uniform in the principal parameters but different in the setting of triggering conditions namely 1 γ r γ u 1 2 γ r 0 5 γ u 0 8 3 γ r 0 8 γ u 0 5 it is observed that the triggering conditions will lose effect for the no 1 catamaran thus it is deemed as a continuous control scheme with no degradation of the stability the sampling period of 0 1s for the actuators is set in the no 1 catamaran which is to emulate the limitation of digital processors then the experiment is carried out and three catamarans are launched at the same time time evolution of the disturbances are shown in fig 7 the disturbances are calculated to achieve approximately 20 of the thrust and the turning torque thus the setting of eq 51 is reasonable fig 8 shows the trajectories of three catamarans with a slow time varying wind the guidance principle takes effects on the whole voyage for the three uphill slopes of the sinusoidal path the mode 1 is triggered where the tacking maneuver is conducted in the first one for the three downhill slopes the mode 2 is triggered it can be observed that large overshoots happen after the peaks and valleys of the path and the los modification in the mode 2 functions from fig 2 we found no significant difference in trajectories of three catamarans it suggests that the control performances are not degraded by the setting of etc in no 2 and no 3 catamarans in fig 9 the heading angle the surge and the sway speeds of catamarans are exhibited due to the influence of white noise fluctuations always exist in their evolution due to the changes of wind speed and direction the surge speed can not accurately track the desired value of u d 1 m s but converge to its neighborhood fig 10 provides the terminal control inputs of the rudder and the wing sail in fig 10 a the saturation for the rudder angle is observed when the catamaran turns the control design to deal with the saturation functions as the control inputs coincide in the mainstream it reveals that the setting of etc here will not increase the cost of acting energy in fig 10 b the difference of control inputs is observed while the continuous inputs of no 1 vary at every sampling instant those of no 2 and no 3 hold between two consecutive triggering instants to quantify this performance the minimal the maximal and the mean inter event times denoted as t m i n t m a x and t m e a n are collected in table 2 the accumulation of triggering times is shown in fig 11 because γ r of the no 2 catamaran is smaller than that of the no 3 t m i n t m a x and t m e a n of the no 2 catamaran are all bigger than those of the no 3 for the rudder correspondingly the growing rate of no 2 is lower than that of no 3 for the rudder in fig 11 contrary results can be obtained for the wing sail these results coincide with the analysis in remark 4 during the total voyage time of 483 6 s the no 2 catamaran will save 42 and 52 of triggering times for the rudder and the wing sail respectively while the no 3 will save 20 and 63 these numbers will be more considerable for a longer voyage in the long run the service life of actuators will be largely prolonged by the proposed control scheme 7 conclusion in this paper path following of the wing sail catamaran is addressed from both the aspects of guidance and control for the guidance we develop a so called parallel guidance principle which can be divided into two modes the first mode aims to guide the tracking of the waypoint while tacking and gybing maneuvers are solved by setting lanes the second mode establishes the serret frenet frame to guide the course keeping along the navigable segment while the los based modification mechanism is designed to prevent the deviation the stability of both modes is proved for the control we synthesize several practical considerations the sigmoid functions are fabricated to approximate the saturation constraint the robust fuzzy damping is designed to offset the uncertainties the etc is introduced to lower the acting frequencies of actuators finally both the good transient and stable performances are revealed in the numerical experiment of a catamaran prototype through the proposed scheme because the control objective is the catamaran the roll motion is not considered in this paper thus it is prospective to extend the proposed scheme to the path following of common sailboats for this purpose the limitation of roll should be involved in the control design acknowledgements this work is partially supported by the national science foundation of china no 51679024 the fundamental research funds for the central university no 3132019501 the national high technology research and development program of china no 2015aa016404 the university 111 project of china no b08046 the doctoral scientific research foundation of liaoning province no 20170520189 and the natural science foundation of liaoning province no 20180520039 the author would sincerely thank the anonymous reviewers for their pertinent and instructive suggestions to improve the quality of this paper 
22456,the accuracy of the estimated regional extreme quantiles off portugal determined by the regional frequency analysis is ascertained by constructing confidence intervals the regional frequency analysis was performed for significant wave height data from 35 sites in a grid of 0 25 x 0 25 off portugal extracted from the 44 years hipocas hindcast wave database the position and site statistics are used to form homogeneous regions or clusters by the regional frequency analysis algorithm the regions obtained by applying the regional frequency analysis to 35 points are used in this study for monte carlo simulations to determine the precision of the regional estimated quantiles from the actual data i e the hindcast data that have the same number of sites sample sizes of the sites and the regional averages of the actual data the between site differences in population for the simulated region are determined to be less than the sample of the actual data as the samples are more dispersed than the respective population due to sampling variability simulated regions also integrate heterogeneity misidentification of the frequency distribution and cross correlations of the sites of the actual data keywords regional frequency analysis l moments growth curve extreme quantiles monte carlo simulations error bounds 1 introduction significant wave height h s is the most important parameter influencing the extreme loads on marine structures like ship structures and fixed offshore structures so the design of these structures requires long term and extreme distributions of significant wave heights e g guedes soares and scotto 2001 2004 ferreira and guedes soares 2002 dong et al 2013 the 50 or 100 year maximum significant wave height is a reference value used for the design of ocean structures and hence several probabilistic models have been developed for its assessment typical approaches are to fit long term distributions to all significant wave heights data and then extrapolate to determine return periods e g isaacson and mackenzie 1981 haver 1985 muir and el shaarawi 1986 ferreira and guedes soares 2000 guedes soares and scotto 2001 for fatigue assessment this approach is appropriate to model the whole loading process guedes soares and moan 1991 but to estimate extreme significant wave heights extreme value theory is pertinent coles 2001 the peak over threshold pot method davison and smith 1990 became a standard approach for these predictions e g mathiesen et al 1994 ferreira and guedes soares 1998 elsinghorst et al 1998 caires and sterl 2005 since then several authors have suggested improvements to this basic approach e g sobey and orloff 1995 guedes soares and scotto 2004 stefanakos and athanassoulis 2006 scotto and guedes soares 2007 huerta and sansó 2007 petrov et al 2013 jonathan and ewans 2013 the damages associated with an extreme event are severe and hence it is very important to estimate the return period of an event of a determined intensity with utmost precision the knowledge of the frequency of the expected extreme wave heights extreme quantiles is very important to coastal and offshore structures the estimation of these frequencies is difficult because extreme event data are rare and thus they have to be predicted from fitting distributions to smaller samples of data fitting distributions of significant wave height can be very useful because they allow smoothing the histogram providing appropriate useful descriptions of it nevertheless fitting distribution of significant wave height may also allow the extrapolation of values of the variable outside of the range of the data estimating return values that correspond to high probability quantiles guedes soares and scotto 2004 by providing available data at the site of interest observed data can provide realizations of the magnitude of the event occurring at a given time and at a particular location extreme wave height modelling has been addressed by several researchers e g randell et al 2015 however these methods have been applied to data of a specific location without any information of the extent of the geographical area that can be described by the same probabilistic law this resulted from the absence of available wave data spatially distributed in wide areas the increased availability of hindcast data such as for instance era 40 european centre for medium range weather forecasts ecmwf caires and sterl 2005 and hipocas hindcast of dynamic processes of the ocean and coastal areas of europe guedes soares 2008 improved the situation the skill of which has been compared by campos and guedes soares 2016a b these data sets have wave and wind data on a spatial grid that allows performing extreme wave analysis at a large number of neighbouring sites and also allows studying the spatial variability of the wave climate the regional frequency analysis rfa has the ability to provide a method to deal with this problem as it uses data from various sites which have similar wave statistics to estimate the frequency distribution of a homogeneous region this procedure allows to increase the data sets by trading space for time i e it pools the data from the neighbouring sites evaluated as having similar frequency distributions to the site of interest in this approach a single distribution is fitted to data from several sites with similar wave statistics it is usually considered that a quantile or return period r p years can be estimated accurately from a data record of length n if r p n usually in several engineering applications based on annual data this condition is usually not satisfied normally n 50 and r p 50 or r p 100 hosking and wallis 1997 twelve methods of rfa were studied by cunnane 1988 and the one based on pwm came out best consequently this method is adopted for this study l moments hosking 1986 1990 are statistical quantities derived from pwms which increase the accuracy and use of the analyses based on these pwms the estimation process of the rfa approach uses l moments which have the theoretical advantages over the conventional moments as they are capable of characterising a wider range of distributions and they are also more robust to the presence of outliers in the data when estimated from a sample in comparison with the conventional moments l moments are less subjected to bias in estimation the l moment ratios the l cv t the l skewness t 3 the l kurtosis t 4 and t 5 characterize the shape of a distribution independently of its scale of measurement the aim of rfa is not to find out an exact distribution that fits the environmental data which is practically impossible as the data generating mechanism is complicated but to establish a probabilistic model that may yield sufficiently accurate quantiles even when the true at site frequency distribution deviates from the fitted frequency distribution then the above procedure is said to be robust in this study the uncertainty of extreme significant wave height quantile estimates lucas et al 2017 is assessed in a grid comprising 35 sites off portugal using regional frequency analysis algorithm based on l moments hosking and wallis 1997 and analysed by season winter spring summer and autumn since it is intended to analyse the seasonal variability in the rfa procedure a region comprising data of several sites are included for frequency analysis other than the data of the site of which quantile estimates are required the term region suggests a set of neighbouring sites but geographical proximity does not ensure similarity in the frequency distributions of the data of the member sites hence lucas et al 2017 used site characteristics latitude and longitude and site statistics l cv and l kurtosis in the cluster analysis algorithm to identify the regions by the heterogeneity criteria as these variables are assumed to affect the frequency distributions further frequency distributions of environmental data are usually heavy tailed houghton 1978 landwehr et al 1979 rossi et al 1984 ahmad et al 1988 hence moderate and heavy tailed distributions such as generalised logistic generalised pareto three parameter log normal pearson type 3 and generalised extreme value are considered as candidate frequency distributions for the significant wave height the wakeby distribution was also considered as it has five parameters and can mimic a wide range of candidate frequency distributions since in regional frequency analysis more information is included there is the possibility of greater precision in the final estimates of extreme quantiles than in an at site analysis using only a single site data even for a moderately heterogeneous region regional frequency analysis will still yield more precise quantile estimates than at site analysis lettenmaier and potter 1985 lettenmaier et al 1987 hosking and wallis 1988 potter and lettenmaier 1990 although the time series of h s shows significant serial dependency the correlation decreases as the time gap between the data points increases to have a proper fit of the distribution the dataset should be made of independent data mathiesen et al 1994 summarize the methods and criteria to use in the statistical analysis of extreme waves the data selection among the other criteria as to fit a candidate distribution to the observed data compute extreme return values from the fitted distribution and computation of the confidence intervals are essential and should be taken in consideration when performing the analysis lucas et al 2017 extracted every fifth day maximum significant wave heights from 44 years hipocas database pilar et al 2008 for a grid comprising 35 sites and seasonally grouped to perform the regional frequency analysis to estimate extreme significant wave heights previous studies of the autocorrelation in this type of time series ferreira and guedes soares 2000 have shown that choosing data every fifth day would ensure a low serial dependency among the data points landwehr et al 1979a and mcmahon and srikanthan 1982 observed that serial dependence caused only a small bias and insignificant increase in the standard error of the quantile estimates meteorological events such as storms typically affect a large area enough to contain more than one site the data at neighbouring sites are likely to be positively correlated hosking and wallis 1997 hosking and wallis 1997 state that statistical analysis results often exhibit inherent uncertainty and it is necessary to make some assessment of the degree of uncertainty for the maximum utility of the results the purpose of this work is to examine the applicability of rfa using l moment algorithms in order to evaluate the accuracy of estimated extreme quantiles the 90 error bounds formed by the simulation based procedure provides the magnitude of the errors that can reasonably be expected in the estimated regional extreme quantiles 2 methodology with the aim of mitigating the serial dependency and to ensure sufficient sample size for regional frequency analysis every fifth day maximum significant wave heights first day sixth day eleventh day were extracted from the 44 years hipocas database pilar et al 2008 and seasonally winter december january and february spring march april and may summer june july and august autumn september october and november grouped for 35 sites site dimensions 0 25 x 0 25 of a grid 35 45on 6 5 11 0ow offshore portugal in each site there are 8 records of 3 hourly estimated significant wave heights per day it starts off by describing the main features of rfa as will be used in this study 2 1 l moments the probability weighted moments pwm of a random variable z with cumulative distribution function f z p z z are defined by 1 m p r s e z p f z r 1 f z s to a distribution with a quantile function z u the above equation gives 2 α r m 1 0 r e z 1 f z r 3 β r m 1 r 0 e z f z r r 0 1 2 therefore in terms of probability weighted moments l moments are defined as 4 λ r 1 1 r k 0 r p r k a k k 0 r p r k β k r 0 1 wherein 5 p r k 1 r k r k r k k the l moment ratios are defined as 6 τ r λ r λ 2 r 3 4 where τ 3 is the l skewness and τ 4 the l kurtosis and the l coefficient of variation l cv is given by 7 τ λ 2 λ 1 which is analogous to the ordinary coefficient of variation 2 2 sample l moments the l moments were defined for continuous probability distributions here they are often estimated from a sample let x 1 n x 2 n x n n be the ordered sample of size n arranged in ascending order of magnitude thus the unbiased estimators of α r and β r are respectively a r and b r defined by landwehr et al 1979 8 a r n 1 j 1 n n j n j 1 n j r 1 n 1 n 2 n r x j n 9 b r n 1 j 1 n j 1 j 2 j r n 1 n 2 n r x j n the sample l moments are given by 10 l r 1 r k 0 r p r k a r k 0 r p r k b r r 0 1 n 1 where l r is an unbiased of λ r then the sample l moments ratios are defined as 11 t r l r l 2 where l 2 is the scale measure t 3 and t 4 are respectively the l skewness and the l kurtosis the sample l cv is defined by 12 t l 2 l 1 where l 1 is a measure of location and l 2 a measure of dispersion 2 3 regional frequency analysis steps to assess the precision of the regional extreme quantile estimates of the sub regions by season the various steps of the regional frequency analysis algorithm described in detail in lucas et al 2017 are briefly referred here a screening of the data the data to which the regional frequency analysis approach will be applied firstly needs to be analysed in order to be stationary i e the sampled data should be representative of the population which maintain its random characteristics constant over time the daily maximum significant wave heights from 44 years hipocas database are initially subjected to test criteria i e to identify discordant sites hosking and wallis 1997 suggesting that a site is considered discordant if the discordance measure d i 3 which is the critical value for a region with more than 15 sites those sites are discordant from the group as a whole discordance is measured based on the l moments ratios of the sites b identification of homogeneous regions a region consists of sites whose frequency distributions are considered to be approximately similar the sites that have similar site statistics i e l moments ratios form a region to assist in the constitution of regions it uses a cluster analysis based on wards method hosking and wallis 1997 which takes into account the site characteristics and the site statistics latitude longitude and l cv and l kurtosis respectively these two l moment ratios were considered in the cluster analysis because the heterogeneity measure is defined in terms of l cv and the goodness of fit measure the z test statistic of the fitted regional frequency distribution is defined in terms of l kurtosis the site characteristics are used to ensure that a sub region contains neighbouring points c a heterogeneity measure firstly the measure of heterogeneity is intended to estimate the degree of heterogeneity in a group of sites and verify if the sites are reasonably similar to be considered a homogeneous region this measure compares the between site variations in sample l moments for the group of sites with what would be expected for a homogeneous region the between site variation in l skewness and l kurtosis does not have as much effect as the between site variation in l cv let the suggested region have n sites with site i having a sample size n i and sample l moment ratios denoted by t i t 3 i and t 4 i l cv l skewness l kurtosis the regional average of the sample l moments is denoted by t r t 3 r and t 4 r which are weighted proportionally to the sites sample size thus 13 t r i 1 n n i t i i 1 n n i the weighted standard deviation of the at site sample l cvs is estimated by 14 v i 1 n n i t i t r 2 i 1 n n i 1 2 then to the regional average l moment ratios the kappa distribution is fitted this distribution has four parameters and includes the distributions generalised logistic generalised extreme value and the generalised pareto it is a special case of this distribution simulates a large number of n s i m of realizations of a region with n sites each having the kappa distribution as its frequency distribution the regions formed comprise individual locations having similar statistical characteristics and can be assumed to be homogeneous the combined sites have the same sample size as the sum of the sample sizes per location the weighted standard deviation v is calculated for each region d selection of the frequency distribution the selection of the frequency distribution is executed by the application of a goodness of fit test and involves estimating summary statistics from the data and test with the values from the candidate distribution so the quality of the fit is assessed by the difference between the l kurtosis of the fitted distribution t 4 f d and the regional average l kurtosis t 4 r thus to assess the significance of this difference the z test z f d is given by 15 z f d t 4 r τ 4 f d σ 4 where z f d is the goodness of fit measure for the frequency distribution t 4 r is the regional average l kurtosis τ 4 f d is the l kurtosis of the fitted frequency distribution and σ 4 is the standard deviation of t 4 r it is performed by repeated simulation monte carlo of a homogeneous region whose sites have the fitted frequency distribution and sample size the same as those of the observed data z statistics were calculated from 500 simulations the z statistic has approximately a standard normal distribution the criterion z 1 64 then corresponds to acceptance of the postulated distribution at a confidence level of 90 e estimation of the frequency distribution the estimation of the frequency distribution can be obtained through the estimation of the distribution discretely at each site and combining the at site estimates to give a regional average generalised logistic glo generalised extreme value gev three parameters lognormal ln3 pearson type iii pe3 and generalised pareto gp3 are the 5 distributions considered the wakeby distribution wak is a five parameter distribution and it is used when none of the 5 distributions previously mentioned is chosen by the z test because it mimics the shape of the most commonly used skew distributions hosking and wallis 1997 the probabilities of occurrence f of extreme quantiles are estimated by the expression given by muraleedharan et al 2007 as 16 f 1 1 t 1 n in which t is the return period in years of extreme wave height and n is the total number of maximum significant wave height in the sample 3 assessment of the accuracy of estimated extreme quantiles in conventional statistics confidence intervals of the estimated quantiles are constructed for the purpose assuming that all the model s assumptions are satisfied but such confidence intervals have restricted applicability when one is unsure if the choice of the model is appropriate the assumptions that substantiate the index flood procedure it consists of pooling summary statistics from different data samples are the observations at any given site are identically distributed and serially independent the observations in different sites are independent the frequency distributions in different sites are identical apart from a scale factor and the mathematical form of the regional growth curve is correctly specified hosking and wallis 1997 the index flood results from pooling summary statistics from different data samples and has a designation associated with the intended application of the method in hydrology quantifying the effects of rain in floods this method can be used with any kind of data hosking and wallis 1997 there are few applications of rfa on marine areas reported in the literature however vanem 2017 applied the regional frequency analysis on extreme significant wave heights in the north atlantic ocean for historical and projected ocean wave climates concluding that rfa can be very useful in the analysis of extreme ocean waves and this approach yields a narrower uncertainty bounds and therefore more robust estimation of extreme quantiles and corresponding to long return periods it is advantageous applying rfa using the l moment algorithm as it is effective even when not all of its assumptions are satisfied similar confidence intervals can also be constructed for quantile estimates in the homogeneous regions when sample l moments are assumed to be normally distributed for large sample approximations the confidence intervals in practice have a limited utility because it is not possible to be absolutely certain that the most correct model was used i e in the case of the regional l moment algorithm that all the assumptions are satisfied by the data a genuine assessment of the precision of the estimates should therefore make allowances for the plausibility of non homogeneity in the region misidentification of the frequency distribution and inter site correlations to an extent that is consistent with the data 4 estimation of the frequency distribution the monte carlo simulation is used in this study to assess the accuracy of the estimated regional extreme quantiles of the four seasons in the north atlantic ocean of a grid comprising 35 sites off portugal the simulations must correspond to the specific characteristics of the data from which the estimates are calculated simulated region the region used as the basis of simulation has the same number of sites record length at each site and regional average l moment ratios of the actual data hindcast data to harmonise with certain features of the data i e the simulated region region constructed from a homogeneous region that is generated by the regional l moment algorithm can include heterogeneity misspecification and some inter site dependence the dispersions between sites in the sample of l moment ratios for the simulated region were selected so that they are smaller than the sample l moment ratios of the actual data which is generated from the actual data obtained initially by the rfa algorithm the sample l moment ratios are more scattered than the respective population l moment ratios due to sampling variability also if the observed sample l moment ratios are considered as population l moment ratios of the simulated region then the simulated region will be much more heterogeneous than the actual region hosking and wallis 1997 at site frequency distributions of the simulated region are consistent with those of the sites of the actual region obtained by goodness of fit test statistic z test the statistics compared are obtained by an analysis on the clustered data and those based on the average of a similar analysis applied on individual at site locations forming a region for which the data are combined the average of the cross correlations of the sites is included in the l moment algorithm for simulations of the actual region the correlation matrix r used in the simulation of correlated data is defined as 17 r ρ 1 1 ρ 1 2 ρ 1 3 ρ 1 j ρ 2 1 ρ 2 2 ρ 2 3 ρ 2 j ρ 3 1 ρ 3 2 ρ 3 3 ρ 3 j ρ i 1 ρ i 2 ρ i 3 ρ i j where the first subscript i indexes the row number and the second subscript j index the column number if the correlation between sites i and j is ρ i j for i j then the average of the inter site correlations ρ of n sites is given by 18 ρ 1 2 n n 1 1 1 i j n ρ i j let the growth curve quantile function for the site i data be q i f defined by 19 q i f μ i q i f where μ i is the flood index i e the mean of the at site frequency distribution q i f are the quantiles at site i and q i f is the dimensionless quantile function which is the inverse function of the frequency distribution of the rescaled data q i f μ i at site i in a homogeneous region each q i f is equal to the regional growth curve q f in the simulation process the quantile estimates are estimated for several non exceedance probabilities at the mth iteration in the simulations suppose the i at site quantile is q ˆ i m f for a non exceedance probability f then the relative rmse approximated for large m repetitions is given by hosking and wallis 1997 20 r i f m 1 m 1 m q ˆ i m f q i f q i f 2 the average of r i f over all of the sites n in the region is the regional average relative rmse given by 21 r r f n 1 i 1 n r i f confidence intervals for the extreme quantile estimates are constructed by computing the ratios of estimated q ˆ i f to true values q i for example q ˆ i f q i f for at site quantiles and q ˆ f q i f for the growth curve averaging these values over the sites in the region and constructing a histogram of the ratios by accumulating over the different simulations for example if the non exceedance probability of an extreme quantile q f whose return period r p f 1 1 r p n n total frequency of the data muraleedharan et al 2007 is f it can be seen that 5 of the simulated values q ˆ f q f remain below some value l 05 f and 5 remain above some value u 05 f then 90 of the distribution of q ˆ f q f lies within the interval 22 l 05 f q ˆ f q f u 05 f or 23 q ˆ f u 05 f q f q ˆ f l 05 f this expression has the same form of a conventional statistical confidence interval as the distribution of q ˆ f q f depends only on the at site means and regional average l moment ratios in the l moment algorithm the limits q ˆ f u 05 f and q ˆ f l 05 f are also known as 90 error bounds for q ˆ f the error bounds formed by the simulation based procedure are less precise than the confidence intervals constructed by conventional statistics but they provide the magnitude of the errors that can reasonably be expected in the estimated at site and regional quantiles the accuracy of the errors depends on the number of simulations m even m 100 gives appropriate values for the magnitude of errors but m 1000 or 10 000 are recommended for a higher degree of accuracies hosking and wallis 1997 the regional average of the relative rmse of the estimated regional growth curve q ˆ f were computed from the simulations and quantiles of the distribution of 24 n 1 i 1 n q ˆ f q i f an average of the ratios of the estimated regional to the true of the actual data at site growth curve was estimated from a histogram accumulated along with the simulations the 90 error bound is also computed using equation 23 5 results and discussion fig 1 illustrates the algorithm executed in this study the sub regions in the study area were formed after performing several tests with various site configurations these sub regions were formed for the winter december january and february to spring march april and may to summer june july and august and finally to the autumn season composed by the months september october and november the objective is to group the sites with similar l moment ratios similar wave characteristics and therefore represented by the same frequency distribution allowing to estimate the regional extreme quantiles extreme significant wave heights the member sites of the sub regions of the four seasons winter spring summer and autumn of the coastal grid fig 2 exhibit significant inter site cross correlations ranging from 0 839 to 0 996 0 889 to 0 998 0 654 to 0 997 and 0 278 to 0 996 table 1 the range and variability of the inter site correlations among the sub regions and between the member sites of the sub regions are comparatively lower in winter and spring than in summer and autumn these observations can justify that in winter the prevailing sea state in the grid under investigation will be often under the influence of a storm that covers a large area the algorithm to execute a rfa to assess the accuracy of extreme significant wave height estimates of the seasons uses the average of the inter site cross correlations of the sub regions and fig 3 illustrates the seasonal distributions of the average cross correlations of the sites of the sub regions i e for the four seasons the application of r f a to the data i e every fifth day maximum significant wave height grouped by season i e winter spring summer and autumn samples with three months each from 35 sites presented three sub regions for winter and spring five sub regions for the summer and four to the autumn as shown in fig 2a d in the data of the sub region for simulations by three parameter distributions generalised logistic glo generalised extreme value gev three parameter log normal ln3 pearson type 3 pe3 the range of l cvs and the maximum value of at site lcvs of a sub region are chosen to generate regional extreme significant wave height estimates from simulated regions they are in proximity to the estimates from actual data hipocas of the regions and average heterogeneities of the simulated sub regions are higher than the actual regions the at site l cvs of the sub regions for simulations of the corresponding sub regions are in agreement with the distribution of the actual at site l cvs of the sub regions the averages of the actual at site l skewnesses of the sub regions are assigned to the at sites of the basic sub regions for simulations of five parameter wakeby distribution regions the averages of the l moment ratios l kurtosis and t 5 are also assigned to the at sites of the basic data of the region to be used for the construction of the 90 error bounds confidence intervals for the assessment of the accuracy of the h s e x t r e m e estimates 5 1 winter three sub regions were detected in winter by regional frequency analysis using l moment algorithms fig 2 note that in sub region 1 2 and 3 the range of the l cv values used in the basic data for simulations of the sub regions are 0 050 0 063 and 0 030 respectively and are considerably less than the corresponding actual range of sample l cv values 0 102 0 111 and 0 088 not all points are part of the sub regions formed these sites are identified as discordant sites d i 3 the critical value for a region of sites more than 15 while regional frequency analysis there are discordant sites in the winter sites 9 and 19 are very close to the coast and sites 31 to 35 are located in the south of portugal and close to the coast and are discordant fig 2a i e discordant sites statistics l moment ratios that are markedly different from the average for the other sites in the region and have discordancy measure d i greater than 3 the discordant sites are excluded from the formation of clusters sub regions the regional frequency distribution chosen for sub region 1 and 2 by z goodness of fit test statistic based on 500 simulations at a 90 level of significance is pearson type 3 distribution this result is consistent with those of lucas et al 2017 since the wakeby distribution is selected as the best fitting regional frequency distribution for sub region 3 as it mimics most of the positively skewed distributions the averages of the inter site cross correlations are found to be 0 946 0 971 and 0 969 respectively table 2 presents the frequency of distributions selected by z test statistic based on 500 simulations and actually chosen from 100 simulations each of the sub regions 1 and 2 by pearson type 3 the simulated regions are represented by pearson type 3 distribution as the pe3 is selected as the distribution for 83 of the simulations since wakeby distribution is chosen unanimously as the regional frequency distribution of sub region 3 result consistent with those of lucas et al 2017 the simulated regions are also assumed to follow the wakeby distribution and hence are not subjected to z test for the simulations of correlated pearson type 3 regions sub regions 1 and 2 and wakeby region sub region 3 with same sample sizes and number of sites of the actual regions at site l cvs vary respectively in the ranges of 0 050 from 1 00 to 0 95 0 063 from 0 880 to 0 817 and 0 030 from 0 850 to 0 820 table 3 provides the average heterogeneity measure h values based on 500 simulations by kappa distribution of the simulated sub regions and h measures of the actual sub regions table 3 also gives the averages of the relative root mean square errors rmse and absolute biases abs bias of the regional extreme significant wave height estimates of designated return periods 10 20 50 and 100 years from simulated data for the three sub regions in winter rmse 12 and abs bias 2 0 fig 4 a illustrates the averages of bias abs bias and rmse of 50 and 100 year at site extreme quantile and regional extreme quantile estimates from simulated regions table 4 furnishes regional extreme quantile estimates from the actual data of the sub regions and confidence intervals constructed for the regional extreme quantile estimates of return periods from the simulated data of the sub regions in winter the regional extreme quantile estimates from the original data are well within the limits of the confidence intervals fig 5 a demonstrates significant continuity between regional extreme quantile estimates against their respective return periods from simulated and actual data the degree of dispersion of the at site extreme quantile estimates from simulated data of the sub regions is comparatively lower than the dispersions of the values from the actual data figs 6 8 but the at site extreme quantile estimates of the actual sub regions are also within the 90 error bounds 5 2 spring the coastal grid under investigation also exhibits three sub regions in spring but with distinctive configurations of those of the sub regions in winter fig 2 the pearson type 3 distributions are selected by z test statistic as the regional growth curves quantile function for the re scaled data for sub regions 2 and 3 whereas a wakeby distribution is suggested for sub region 1 this result is consistent with those of lucas et al 2017 for a total of 100 simulations for each of the sub regions 2 and 3 by pearson type 3 regional growth curve pe3 is chosen in 81 and 76 cases respectively table 5 hence the regions can be confirmed as pearson type 3 sub regions the range of at site l cv values of the basic sub regions employed for simulations are accordingly 0 100 0 050 and 0 045 and are lower than the actual at site l cv ranges 0 102 0 072 and 0 060 of the sub regions the maximum at site l cvs 0 790 0 600 and 0 527 of the basic regions initial region is also lower than the at site maximum l cvs 0 876 0 773 and 0 676 of the actual sub regions in the spring there are twelve discordant sites 6 8 9 10 and 14 located in the north of portugal and 19 is very close to the coast in sines region the sites 25 and 31 to 35 are located in the south of portugal and are close to the coast the ranges and the l cv values ensure that regional extreme quantile estimates from simulations are in accordance with the estimates from actual data and higher average heterogeneity of the simulated regions than the actual regions the average relative root mean square errors rmse and absolute biases abs bias of the extreme quantile estimates of the sub regions from simulated data are less than 20 0 and 5 0 respectively for spring fig 4 b illustrates the averages of the rmse absolute bias and bias of all the 50 and 100 year at site extreme quantile and of the regional extreme quantile estimates of the simulated regions the 90 error bounds of the extreme quantile estimates from the simulations are in the range of the estimates from actual data table 6 fig 5 b reveals that regional extreme quantile estimates against return periods from simulated and actual data are consistent even though the actual at site extreme quantile estimates exhibit larger scatter than the simulated at site extreme quantile estimates the 90 confidence intervals constructed from simulated data also include at site extreme quantile estimates from actual data 5 3 summer in summer the grid under investigation has five sub regions the region under investigation with the total number of sites of 35 is more heterogeneous compared to winter and spring this may be due to the presence of a larger number of wave systems in the grid and hence the wave height distributions agree well with probabilistic laws than in summer and in winter in summer the grid also exhibits eight discordant sites 9 and 10 19 31 to 35 the discordant sites except 10 are close to the shore and influence of the continent may be one of the reasons for the sites to be discordant the ranges of the l cvs of the basic data of the sub regions 1 2 3 4 5 chosen for the execution of the simulations of the actual regions are less than the actual ranges of the l cvs of the sites and are of the order 0 010 0 036 0 035 0 0005 and 0 0005 the actual ranges of the l cvs of the sites of the sub regions are respectively 0 022 0 037 0 035 0 008 and 0 007 the maximum l cvs 0 300 0 430 0 400 0 300 and 0 280 of the basic regions for simulations of the actual sites are also less than the maximum l cvs of the sites of the actual sub regions 0 420 0 460 0 407 0 357 and 0 328 the actual sub regions in summer are sub region 1 is represented by a generalised extreme value distribution sub regions 2 and 3 are a wakeby distribution and sub regions 4 and 5 are represented by the three parameter log normal distribution table 4 lucas et al 2017 from 100 simulations for each of the actual of the sub regions with same number and sample size of the sites using corresponding regional growth curves the generalised extreme value distribution is chosen in 70 0 cases for sub regions 1 and three parameter log normal distribution is chosen in 53 0 and 44 0 cases for sub regions 4 and 5 respectively table 7 the best fitting distribution of the points in sub regions 2 and 3 all follow a wakeby because the other three parameter distributions were not selected by the z test statistic based on 500 simulations except pearson type 3 distribution in 4 0 cases for sub region 2 and 16 0 cases in maximum cases for sub region 3 the simulated sub regions retain higher heterogeneity than the actual sub regions and table 8 also provides the average absolute biases and rmses of the estimates of the regional extreme quantiles from simulated regions the maximum rmse and absolute bias is 18 4 in sub region 1 and 2 1 in sub region 3 respectively fig 4 c furnishes the averages of the biases absolute biases and rmses of the 50 and 100 year at site extreme quantile estimates of the simulated sub regions and the estimates of the corresponding simulated sub regions fig 9 exhibits the regional extreme quantile estimates from simulated and actual sub regions against designated return periods are consistent the actual extreme quantiles lie within the 90 confidence intervals constructed from the simulated regions table 9 see fig 10 14 see table 9b 5 4 autumn in autumn there are also eight discordant sites 9 and 10 19 31 to 35 the grid under investigation after eliminating the discordant sites comprises four sub regions fig 3 the at site l cvs and the ranges of the basic sub regions used as input for simulations of the sub regions with the same number and sample size of the sites of the actual inter site correlated sub regions 1 2 3 and 4 are able to generate more heterogeneous regions as required the average heterogeneity measures of the simulated regions based on 500 simulations are higher than the heterogeneity measures of the actual regions the regional average extreme quantile estimates from simulated regions are also compatible with the estimates from the actual region the highest at site l cvs of the basic regions and the ranges in parentheses are respectively 0 7200 0 068 0 5600 0 009 0 5000 0 0360 and 0 4500 0 009 and for the actual regions are 0 8814 0 0754 0 8018 0 097 0 6945 0 0556 and 0 6355 0 0366 the maximum significant wave height distributions of region 1 are best represented by pearson type 3 distribution and the distributions of wave heights of all other sub regions 2 3 and 4 are best represented by three parameter log normal distributions table 10 provides the frequency of the selected by z test based on 500 simulations distributions that are actually chosen from the 100 repetitions for each of the sub regions by the regional frequency distributions of the sub regions the highest most selected distributions are respectively pearson type 3 for sub region 1 in 85 0 cases 98 0 three parameter log normal distributions for sub regions 2 3 and 4 in 75 0 67 0 cases in 79 0 68 0 cases and in 76 0 59 0 cases hence from simulations it is confirmed that sub region 1 is best modelled by a pearson type 3 distribution and the other three regions by the three parameter log normal distribution the maximum values for the average rmse and absolute bias of the regional extreme quantile estimates from the simulations are respectively 9 7 in sub region 3 and 0 60 in sub region 4 fig 4 d also shows the average rmse absolute bias and bias of the 50 and 100 year regional extreme quantile estimates of the sub regions and the extreme quantile estimates of the member sites of the sub regions and are also insignificant fig 15 illustrates the comparison of the extreme quantile estimates from simulated and actual data versus the designated return periods table 11 gives the 90 error bounds of the regional extreme quantile estimates from simulated data and the extreme quantile estimates from actual data the h s e x t r e m e of the actual data are within the confidence intervals of the simulated data in autumn it was revealed that though the at site extreme quantile estimates from the actual data are more dispersed than the at site values from the actual data the at site h s e x t r e m e are also within the 90 confidence intervals this is not the case for sub region 1 the lower bounds are marginally higher than the lowest at site extreme quantile estimates of various designated return periods from actual data the diagrams also demonstrate the regional extreme quantile and their corresponding at site extreme quantile estimates from simulated and actual data see fig 16 see table 11b 6 conclusions this study highlights the usefulness of conducting regional frequency analysis using l moments to assess the uncertainty of the estimated extreme quantiles as a pre requisite for any ocean engineering activity the maximum significant wave heights extracted from a grid off portugal in the north atlantic ocean has been subjected to regional frequency analysis to form homogeneous regions to identify discordant sites to select appropriate regional growth curves and to estimate regional extreme quantiles with the required precision lucas et al 2017 since statistical analysis results often exhibit inherent uncertainty confidence intervals are constructed in this paper for quantile estimates in the homogeneous regions assuming that sample l moments are normally distributed in large samples there exists a significant inter site correlation between the sites that constitute the sub regions particularly in winter and spring the average of the inter site correlations is employed to generate the correlated sub regions the simulated regions have higher heterogeneity than the actual regions the between site dispersions in population l moment ratios of the simulated regions are chosen to be smaller than the sample l moment ratios of the actual data as sample l moment ratios are more spread out than the respective population l moment ratios due to sampling variability the wave height distributions of the simulated sub regions have similar best fitting probability distributions as the distributions of the actual regions the regional extreme quantile estimates from simulated data are consistent with the estimates from the actual data the average relative root mean square errors rmse and absolute bias of the regional and at site extreme quantile estimates from simulated data are insignificant ensuing sufficient accuracy on the extreme quantile estimates the regional extreme quantile estimates as well as the at site extreme quantile estimates from actual data are well within the 90 error bounds acknowledgement this work was performed within the strategic research plan of the centre for marine technology and ocean engineering which is financed by portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uid multi 00134 2013 lisboa 01 0145 feder 007629 
22456,the accuracy of the estimated regional extreme quantiles off portugal determined by the regional frequency analysis is ascertained by constructing confidence intervals the regional frequency analysis was performed for significant wave height data from 35 sites in a grid of 0 25 x 0 25 off portugal extracted from the 44 years hipocas hindcast wave database the position and site statistics are used to form homogeneous regions or clusters by the regional frequency analysis algorithm the regions obtained by applying the regional frequency analysis to 35 points are used in this study for monte carlo simulations to determine the precision of the regional estimated quantiles from the actual data i e the hindcast data that have the same number of sites sample sizes of the sites and the regional averages of the actual data the between site differences in population for the simulated region are determined to be less than the sample of the actual data as the samples are more dispersed than the respective population due to sampling variability simulated regions also integrate heterogeneity misidentification of the frequency distribution and cross correlations of the sites of the actual data keywords regional frequency analysis l moments growth curve extreme quantiles monte carlo simulations error bounds 1 introduction significant wave height h s is the most important parameter influencing the extreme loads on marine structures like ship structures and fixed offshore structures so the design of these structures requires long term and extreme distributions of significant wave heights e g guedes soares and scotto 2001 2004 ferreira and guedes soares 2002 dong et al 2013 the 50 or 100 year maximum significant wave height is a reference value used for the design of ocean structures and hence several probabilistic models have been developed for its assessment typical approaches are to fit long term distributions to all significant wave heights data and then extrapolate to determine return periods e g isaacson and mackenzie 1981 haver 1985 muir and el shaarawi 1986 ferreira and guedes soares 2000 guedes soares and scotto 2001 for fatigue assessment this approach is appropriate to model the whole loading process guedes soares and moan 1991 but to estimate extreme significant wave heights extreme value theory is pertinent coles 2001 the peak over threshold pot method davison and smith 1990 became a standard approach for these predictions e g mathiesen et al 1994 ferreira and guedes soares 1998 elsinghorst et al 1998 caires and sterl 2005 since then several authors have suggested improvements to this basic approach e g sobey and orloff 1995 guedes soares and scotto 2004 stefanakos and athanassoulis 2006 scotto and guedes soares 2007 huerta and sansó 2007 petrov et al 2013 jonathan and ewans 2013 the damages associated with an extreme event are severe and hence it is very important to estimate the return period of an event of a determined intensity with utmost precision the knowledge of the frequency of the expected extreme wave heights extreme quantiles is very important to coastal and offshore structures the estimation of these frequencies is difficult because extreme event data are rare and thus they have to be predicted from fitting distributions to smaller samples of data fitting distributions of significant wave height can be very useful because they allow smoothing the histogram providing appropriate useful descriptions of it nevertheless fitting distribution of significant wave height may also allow the extrapolation of values of the variable outside of the range of the data estimating return values that correspond to high probability quantiles guedes soares and scotto 2004 by providing available data at the site of interest observed data can provide realizations of the magnitude of the event occurring at a given time and at a particular location extreme wave height modelling has been addressed by several researchers e g randell et al 2015 however these methods have been applied to data of a specific location without any information of the extent of the geographical area that can be described by the same probabilistic law this resulted from the absence of available wave data spatially distributed in wide areas the increased availability of hindcast data such as for instance era 40 european centre for medium range weather forecasts ecmwf caires and sterl 2005 and hipocas hindcast of dynamic processes of the ocean and coastal areas of europe guedes soares 2008 improved the situation the skill of which has been compared by campos and guedes soares 2016a b these data sets have wave and wind data on a spatial grid that allows performing extreme wave analysis at a large number of neighbouring sites and also allows studying the spatial variability of the wave climate the regional frequency analysis rfa has the ability to provide a method to deal with this problem as it uses data from various sites which have similar wave statistics to estimate the frequency distribution of a homogeneous region this procedure allows to increase the data sets by trading space for time i e it pools the data from the neighbouring sites evaluated as having similar frequency distributions to the site of interest in this approach a single distribution is fitted to data from several sites with similar wave statistics it is usually considered that a quantile or return period r p years can be estimated accurately from a data record of length n if r p n usually in several engineering applications based on annual data this condition is usually not satisfied normally n 50 and r p 50 or r p 100 hosking and wallis 1997 twelve methods of rfa were studied by cunnane 1988 and the one based on pwm came out best consequently this method is adopted for this study l moments hosking 1986 1990 are statistical quantities derived from pwms which increase the accuracy and use of the analyses based on these pwms the estimation process of the rfa approach uses l moments which have the theoretical advantages over the conventional moments as they are capable of characterising a wider range of distributions and they are also more robust to the presence of outliers in the data when estimated from a sample in comparison with the conventional moments l moments are less subjected to bias in estimation the l moment ratios the l cv t the l skewness t 3 the l kurtosis t 4 and t 5 characterize the shape of a distribution independently of its scale of measurement the aim of rfa is not to find out an exact distribution that fits the environmental data which is practically impossible as the data generating mechanism is complicated but to establish a probabilistic model that may yield sufficiently accurate quantiles even when the true at site frequency distribution deviates from the fitted frequency distribution then the above procedure is said to be robust in this study the uncertainty of extreme significant wave height quantile estimates lucas et al 2017 is assessed in a grid comprising 35 sites off portugal using regional frequency analysis algorithm based on l moments hosking and wallis 1997 and analysed by season winter spring summer and autumn since it is intended to analyse the seasonal variability in the rfa procedure a region comprising data of several sites are included for frequency analysis other than the data of the site of which quantile estimates are required the term region suggests a set of neighbouring sites but geographical proximity does not ensure similarity in the frequency distributions of the data of the member sites hence lucas et al 2017 used site characteristics latitude and longitude and site statistics l cv and l kurtosis in the cluster analysis algorithm to identify the regions by the heterogeneity criteria as these variables are assumed to affect the frequency distributions further frequency distributions of environmental data are usually heavy tailed houghton 1978 landwehr et al 1979 rossi et al 1984 ahmad et al 1988 hence moderate and heavy tailed distributions such as generalised logistic generalised pareto three parameter log normal pearson type 3 and generalised extreme value are considered as candidate frequency distributions for the significant wave height the wakeby distribution was also considered as it has five parameters and can mimic a wide range of candidate frequency distributions since in regional frequency analysis more information is included there is the possibility of greater precision in the final estimates of extreme quantiles than in an at site analysis using only a single site data even for a moderately heterogeneous region regional frequency analysis will still yield more precise quantile estimates than at site analysis lettenmaier and potter 1985 lettenmaier et al 1987 hosking and wallis 1988 potter and lettenmaier 1990 although the time series of h s shows significant serial dependency the correlation decreases as the time gap between the data points increases to have a proper fit of the distribution the dataset should be made of independent data mathiesen et al 1994 summarize the methods and criteria to use in the statistical analysis of extreme waves the data selection among the other criteria as to fit a candidate distribution to the observed data compute extreme return values from the fitted distribution and computation of the confidence intervals are essential and should be taken in consideration when performing the analysis lucas et al 2017 extracted every fifth day maximum significant wave heights from 44 years hipocas database pilar et al 2008 for a grid comprising 35 sites and seasonally grouped to perform the regional frequency analysis to estimate extreme significant wave heights previous studies of the autocorrelation in this type of time series ferreira and guedes soares 2000 have shown that choosing data every fifth day would ensure a low serial dependency among the data points landwehr et al 1979a and mcmahon and srikanthan 1982 observed that serial dependence caused only a small bias and insignificant increase in the standard error of the quantile estimates meteorological events such as storms typically affect a large area enough to contain more than one site the data at neighbouring sites are likely to be positively correlated hosking and wallis 1997 hosking and wallis 1997 state that statistical analysis results often exhibit inherent uncertainty and it is necessary to make some assessment of the degree of uncertainty for the maximum utility of the results the purpose of this work is to examine the applicability of rfa using l moment algorithms in order to evaluate the accuracy of estimated extreme quantiles the 90 error bounds formed by the simulation based procedure provides the magnitude of the errors that can reasonably be expected in the estimated regional extreme quantiles 2 methodology with the aim of mitigating the serial dependency and to ensure sufficient sample size for regional frequency analysis every fifth day maximum significant wave heights first day sixth day eleventh day were extracted from the 44 years hipocas database pilar et al 2008 and seasonally winter december january and february spring march april and may summer june july and august autumn september october and november grouped for 35 sites site dimensions 0 25 x 0 25 of a grid 35 45on 6 5 11 0ow offshore portugal in each site there are 8 records of 3 hourly estimated significant wave heights per day it starts off by describing the main features of rfa as will be used in this study 2 1 l moments the probability weighted moments pwm of a random variable z with cumulative distribution function f z p z z are defined by 1 m p r s e z p f z r 1 f z s to a distribution with a quantile function z u the above equation gives 2 α r m 1 0 r e z 1 f z r 3 β r m 1 r 0 e z f z r r 0 1 2 therefore in terms of probability weighted moments l moments are defined as 4 λ r 1 1 r k 0 r p r k a k k 0 r p r k β k r 0 1 wherein 5 p r k 1 r k r k r k k the l moment ratios are defined as 6 τ r λ r λ 2 r 3 4 where τ 3 is the l skewness and τ 4 the l kurtosis and the l coefficient of variation l cv is given by 7 τ λ 2 λ 1 which is analogous to the ordinary coefficient of variation 2 2 sample l moments the l moments were defined for continuous probability distributions here they are often estimated from a sample let x 1 n x 2 n x n n be the ordered sample of size n arranged in ascending order of magnitude thus the unbiased estimators of α r and β r are respectively a r and b r defined by landwehr et al 1979 8 a r n 1 j 1 n n j n j 1 n j r 1 n 1 n 2 n r x j n 9 b r n 1 j 1 n j 1 j 2 j r n 1 n 2 n r x j n the sample l moments are given by 10 l r 1 r k 0 r p r k a r k 0 r p r k b r r 0 1 n 1 where l r is an unbiased of λ r then the sample l moments ratios are defined as 11 t r l r l 2 where l 2 is the scale measure t 3 and t 4 are respectively the l skewness and the l kurtosis the sample l cv is defined by 12 t l 2 l 1 where l 1 is a measure of location and l 2 a measure of dispersion 2 3 regional frequency analysis steps to assess the precision of the regional extreme quantile estimates of the sub regions by season the various steps of the regional frequency analysis algorithm described in detail in lucas et al 2017 are briefly referred here a screening of the data the data to which the regional frequency analysis approach will be applied firstly needs to be analysed in order to be stationary i e the sampled data should be representative of the population which maintain its random characteristics constant over time the daily maximum significant wave heights from 44 years hipocas database are initially subjected to test criteria i e to identify discordant sites hosking and wallis 1997 suggesting that a site is considered discordant if the discordance measure d i 3 which is the critical value for a region with more than 15 sites those sites are discordant from the group as a whole discordance is measured based on the l moments ratios of the sites b identification of homogeneous regions a region consists of sites whose frequency distributions are considered to be approximately similar the sites that have similar site statistics i e l moments ratios form a region to assist in the constitution of regions it uses a cluster analysis based on wards method hosking and wallis 1997 which takes into account the site characteristics and the site statistics latitude longitude and l cv and l kurtosis respectively these two l moment ratios were considered in the cluster analysis because the heterogeneity measure is defined in terms of l cv and the goodness of fit measure the z test statistic of the fitted regional frequency distribution is defined in terms of l kurtosis the site characteristics are used to ensure that a sub region contains neighbouring points c a heterogeneity measure firstly the measure of heterogeneity is intended to estimate the degree of heterogeneity in a group of sites and verify if the sites are reasonably similar to be considered a homogeneous region this measure compares the between site variations in sample l moments for the group of sites with what would be expected for a homogeneous region the between site variation in l skewness and l kurtosis does not have as much effect as the between site variation in l cv let the suggested region have n sites with site i having a sample size n i and sample l moment ratios denoted by t i t 3 i and t 4 i l cv l skewness l kurtosis the regional average of the sample l moments is denoted by t r t 3 r and t 4 r which are weighted proportionally to the sites sample size thus 13 t r i 1 n n i t i i 1 n n i the weighted standard deviation of the at site sample l cvs is estimated by 14 v i 1 n n i t i t r 2 i 1 n n i 1 2 then to the regional average l moment ratios the kappa distribution is fitted this distribution has four parameters and includes the distributions generalised logistic generalised extreme value and the generalised pareto it is a special case of this distribution simulates a large number of n s i m of realizations of a region with n sites each having the kappa distribution as its frequency distribution the regions formed comprise individual locations having similar statistical characteristics and can be assumed to be homogeneous the combined sites have the same sample size as the sum of the sample sizes per location the weighted standard deviation v is calculated for each region d selection of the frequency distribution the selection of the frequency distribution is executed by the application of a goodness of fit test and involves estimating summary statistics from the data and test with the values from the candidate distribution so the quality of the fit is assessed by the difference between the l kurtosis of the fitted distribution t 4 f d and the regional average l kurtosis t 4 r thus to assess the significance of this difference the z test z f d is given by 15 z f d t 4 r τ 4 f d σ 4 where z f d is the goodness of fit measure for the frequency distribution t 4 r is the regional average l kurtosis τ 4 f d is the l kurtosis of the fitted frequency distribution and σ 4 is the standard deviation of t 4 r it is performed by repeated simulation monte carlo of a homogeneous region whose sites have the fitted frequency distribution and sample size the same as those of the observed data z statistics were calculated from 500 simulations the z statistic has approximately a standard normal distribution the criterion z 1 64 then corresponds to acceptance of the postulated distribution at a confidence level of 90 e estimation of the frequency distribution the estimation of the frequency distribution can be obtained through the estimation of the distribution discretely at each site and combining the at site estimates to give a regional average generalised logistic glo generalised extreme value gev three parameters lognormal ln3 pearson type iii pe3 and generalised pareto gp3 are the 5 distributions considered the wakeby distribution wak is a five parameter distribution and it is used when none of the 5 distributions previously mentioned is chosen by the z test because it mimics the shape of the most commonly used skew distributions hosking and wallis 1997 the probabilities of occurrence f of extreme quantiles are estimated by the expression given by muraleedharan et al 2007 as 16 f 1 1 t 1 n in which t is the return period in years of extreme wave height and n is the total number of maximum significant wave height in the sample 3 assessment of the accuracy of estimated extreme quantiles in conventional statistics confidence intervals of the estimated quantiles are constructed for the purpose assuming that all the model s assumptions are satisfied but such confidence intervals have restricted applicability when one is unsure if the choice of the model is appropriate the assumptions that substantiate the index flood procedure it consists of pooling summary statistics from different data samples are the observations at any given site are identically distributed and serially independent the observations in different sites are independent the frequency distributions in different sites are identical apart from a scale factor and the mathematical form of the regional growth curve is correctly specified hosking and wallis 1997 the index flood results from pooling summary statistics from different data samples and has a designation associated with the intended application of the method in hydrology quantifying the effects of rain in floods this method can be used with any kind of data hosking and wallis 1997 there are few applications of rfa on marine areas reported in the literature however vanem 2017 applied the regional frequency analysis on extreme significant wave heights in the north atlantic ocean for historical and projected ocean wave climates concluding that rfa can be very useful in the analysis of extreme ocean waves and this approach yields a narrower uncertainty bounds and therefore more robust estimation of extreme quantiles and corresponding to long return periods it is advantageous applying rfa using the l moment algorithm as it is effective even when not all of its assumptions are satisfied similar confidence intervals can also be constructed for quantile estimates in the homogeneous regions when sample l moments are assumed to be normally distributed for large sample approximations the confidence intervals in practice have a limited utility because it is not possible to be absolutely certain that the most correct model was used i e in the case of the regional l moment algorithm that all the assumptions are satisfied by the data a genuine assessment of the precision of the estimates should therefore make allowances for the plausibility of non homogeneity in the region misidentification of the frequency distribution and inter site correlations to an extent that is consistent with the data 4 estimation of the frequency distribution the monte carlo simulation is used in this study to assess the accuracy of the estimated regional extreme quantiles of the four seasons in the north atlantic ocean of a grid comprising 35 sites off portugal the simulations must correspond to the specific characteristics of the data from which the estimates are calculated simulated region the region used as the basis of simulation has the same number of sites record length at each site and regional average l moment ratios of the actual data hindcast data to harmonise with certain features of the data i e the simulated region region constructed from a homogeneous region that is generated by the regional l moment algorithm can include heterogeneity misspecification and some inter site dependence the dispersions between sites in the sample of l moment ratios for the simulated region were selected so that they are smaller than the sample l moment ratios of the actual data which is generated from the actual data obtained initially by the rfa algorithm the sample l moment ratios are more scattered than the respective population l moment ratios due to sampling variability also if the observed sample l moment ratios are considered as population l moment ratios of the simulated region then the simulated region will be much more heterogeneous than the actual region hosking and wallis 1997 at site frequency distributions of the simulated region are consistent with those of the sites of the actual region obtained by goodness of fit test statistic z test the statistics compared are obtained by an analysis on the clustered data and those based on the average of a similar analysis applied on individual at site locations forming a region for which the data are combined the average of the cross correlations of the sites is included in the l moment algorithm for simulations of the actual region the correlation matrix r used in the simulation of correlated data is defined as 17 r ρ 1 1 ρ 1 2 ρ 1 3 ρ 1 j ρ 2 1 ρ 2 2 ρ 2 3 ρ 2 j ρ 3 1 ρ 3 2 ρ 3 3 ρ 3 j ρ i 1 ρ i 2 ρ i 3 ρ i j where the first subscript i indexes the row number and the second subscript j index the column number if the correlation between sites i and j is ρ i j for i j then the average of the inter site correlations ρ of n sites is given by 18 ρ 1 2 n n 1 1 1 i j n ρ i j let the growth curve quantile function for the site i data be q i f defined by 19 q i f μ i q i f where μ i is the flood index i e the mean of the at site frequency distribution q i f are the quantiles at site i and q i f is the dimensionless quantile function which is the inverse function of the frequency distribution of the rescaled data q i f μ i at site i in a homogeneous region each q i f is equal to the regional growth curve q f in the simulation process the quantile estimates are estimated for several non exceedance probabilities at the mth iteration in the simulations suppose the i at site quantile is q ˆ i m f for a non exceedance probability f then the relative rmse approximated for large m repetitions is given by hosking and wallis 1997 20 r i f m 1 m 1 m q ˆ i m f q i f q i f 2 the average of r i f over all of the sites n in the region is the regional average relative rmse given by 21 r r f n 1 i 1 n r i f confidence intervals for the extreme quantile estimates are constructed by computing the ratios of estimated q ˆ i f to true values q i for example q ˆ i f q i f for at site quantiles and q ˆ f q i f for the growth curve averaging these values over the sites in the region and constructing a histogram of the ratios by accumulating over the different simulations for example if the non exceedance probability of an extreme quantile q f whose return period r p f 1 1 r p n n total frequency of the data muraleedharan et al 2007 is f it can be seen that 5 of the simulated values q ˆ f q f remain below some value l 05 f and 5 remain above some value u 05 f then 90 of the distribution of q ˆ f q f lies within the interval 22 l 05 f q ˆ f q f u 05 f or 23 q ˆ f u 05 f q f q ˆ f l 05 f this expression has the same form of a conventional statistical confidence interval as the distribution of q ˆ f q f depends only on the at site means and regional average l moment ratios in the l moment algorithm the limits q ˆ f u 05 f and q ˆ f l 05 f are also known as 90 error bounds for q ˆ f the error bounds formed by the simulation based procedure are less precise than the confidence intervals constructed by conventional statistics but they provide the magnitude of the errors that can reasonably be expected in the estimated at site and regional quantiles the accuracy of the errors depends on the number of simulations m even m 100 gives appropriate values for the magnitude of errors but m 1000 or 10 000 are recommended for a higher degree of accuracies hosking and wallis 1997 the regional average of the relative rmse of the estimated regional growth curve q ˆ f were computed from the simulations and quantiles of the distribution of 24 n 1 i 1 n q ˆ f q i f an average of the ratios of the estimated regional to the true of the actual data at site growth curve was estimated from a histogram accumulated along with the simulations the 90 error bound is also computed using equation 23 5 results and discussion fig 1 illustrates the algorithm executed in this study the sub regions in the study area were formed after performing several tests with various site configurations these sub regions were formed for the winter december january and february to spring march april and may to summer june july and august and finally to the autumn season composed by the months september october and november the objective is to group the sites with similar l moment ratios similar wave characteristics and therefore represented by the same frequency distribution allowing to estimate the regional extreme quantiles extreme significant wave heights the member sites of the sub regions of the four seasons winter spring summer and autumn of the coastal grid fig 2 exhibit significant inter site cross correlations ranging from 0 839 to 0 996 0 889 to 0 998 0 654 to 0 997 and 0 278 to 0 996 table 1 the range and variability of the inter site correlations among the sub regions and between the member sites of the sub regions are comparatively lower in winter and spring than in summer and autumn these observations can justify that in winter the prevailing sea state in the grid under investigation will be often under the influence of a storm that covers a large area the algorithm to execute a rfa to assess the accuracy of extreme significant wave height estimates of the seasons uses the average of the inter site cross correlations of the sub regions and fig 3 illustrates the seasonal distributions of the average cross correlations of the sites of the sub regions i e for the four seasons the application of r f a to the data i e every fifth day maximum significant wave height grouped by season i e winter spring summer and autumn samples with three months each from 35 sites presented three sub regions for winter and spring five sub regions for the summer and four to the autumn as shown in fig 2a d in the data of the sub region for simulations by three parameter distributions generalised logistic glo generalised extreme value gev three parameter log normal ln3 pearson type 3 pe3 the range of l cvs and the maximum value of at site lcvs of a sub region are chosen to generate regional extreme significant wave height estimates from simulated regions they are in proximity to the estimates from actual data hipocas of the regions and average heterogeneities of the simulated sub regions are higher than the actual regions the at site l cvs of the sub regions for simulations of the corresponding sub regions are in agreement with the distribution of the actual at site l cvs of the sub regions the averages of the actual at site l skewnesses of the sub regions are assigned to the at sites of the basic sub regions for simulations of five parameter wakeby distribution regions the averages of the l moment ratios l kurtosis and t 5 are also assigned to the at sites of the basic data of the region to be used for the construction of the 90 error bounds confidence intervals for the assessment of the accuracy of the h s e x t r e m e estimates 5 1 winter three sub regions were detected in winter by regional frequency analysis using l moment algorithms fig 2 note that in sub region 1 2 and 3 the range of the l cv values used in the basic data for simulations of the sub regions are 0 050 0 063 and 0 030 respectively and are considerably less than the corresponding actual range of sample l cv values 0 102 0 111 and 0 088 not all points are part of the sub regions formed these sites are identified as discordant sites d i 3 the critical value for a region of sites more than 15 while regional frequency analysis there are discordant sites in the winter sites 9 and 19 are very close to the coast and sites 31 to 35 are located in the south of portugal and close to the coast and are discordant fig 2a i e discordant sites statistics l moment ratios that are markedly different from the average for the other sites in the region and have discordancy measure d i greater than 3 the discordant sites are excluded from the formation of clusters sub regions the regional frequency distribution chosen for sub region 1 and 2 by z goodness of fit test statistic based on 500 simulations at a 90 level of significance is pearson type 3 distribution this result is consistent with those of lucas et al 2017 since the wakeby distribution is selected as the best fitting regional frequency distribution for sub region 3 as it mimics most of the positively skewed distributions the averages of the inter site cross correlations are found to be 0 946 0 971 and 0 969 respectively table 2 presents the frequency of distributions selected by z test statistic based on 500 simulations and actually chosen from 100 simulations each of the sub regions 1 and 2 by pearson type 3 the simulated regions are represented by pearson type 3 distribution as the pe3 is selected as the distribution for 83 of the simulations since wakeby distribution is chosen unanimously as the regional frequency distribution of sub region 3 result consistent with those of lucas et al 2017 the simulated regions are also assumed to follow the wakeby distribution and hence are not subjected to z test for the simulations of correlated pearson type 3 regions sub regions 1 and 2 and wakeby region sub region 3 with same sample sizes and number of sites of the actual regions at site l cvs vary respectively in the ranges of 0 050 from 1 00 to 0 95 0 063 from 0 880 to 0 817 and 0 030 from 0 850 to 0 820 table 3 provides the average heterogeneity measure h values based on 500 simulations by kappa distribution of the simulated sub regions and h measures of the actual sub regions table 3 also gives the averages of the relative root mean square errors rmse and absolute biases abs bias of the regional extreme significant wave height estimates of designated return periods 10 20 50 and 100 years from simulated data for the three sub regions in winter rmse 12 and abs bias 2 0 fig 4 a illustrates the averages of bias abs bias and rmse of 50 and 100 year at site extreme quantile and regional extreme quantile estimates from simulated regions table 4 furnishes regional extreme quantile estimates from the actual data of the sub regions and confidence intervals constructed for the regional extreme quantile estimates of return periods from the simulated data of the sub regions in winter the regional extreme quantile estimates from the original data are well within the limits of the confidence intervals fig 5 a demonstrates significant continuity between regional extreme quantile estimates against their respective return periods from simulated and actual data the degree of dispersion of the at site extreme quantile estimates from simulated data of the sub regions is comparatively lower than the dispersions of the values from the actual data figs 6 8 but the at site extreme quantile estimates of the actual sub regions are also within the 90 error bounds 5 2 spring the coastal grid under investigation also exhibits three sub regions in spring but with distinctive configurations of those of the sub regions in winter fig 2 the pearson type 3 distributions are selected by z test statistic as the regional growth curves quantile function for the re scaled data for sub regions 2 and 3 whereas a wakeby distribution is suggested for sub region 1 this result is consistent with those of lucas et al 2017 for a total of 100 simulations for each of the sub regions 2 and 3 by pearson type 3 regional growth curve pe3 is chosen in 81 and 76 cases respectively table 5 hence the regions can be confirmed as pearson type 3 sub regions the range of at site l cv values of the basic sub regions employed for simulations are accordingly 0 100 0 050 and 0 045 and are lower than the actual at site l cv ranges 0 102 0 072 and 0 060 of the sub regions the maximum at site l cvs 0 790 0 600 and 0 527 of the basic regions initial region is also lower than the at site maximum l cvs 0 876 0 773 and 0 676 of the actual sub regions in the spring there are twelve discordant sites 6 8 9 10 and 14 located in the north of portugal and 19 is very close to the coast in sines region the sites 25 and 31 to 35 are located in the south of portugal and are close to the coast the ranges and the l cv values ensure that regional extreme quantile estimates from simulations are in accordance with the estimates from actual data and higher average heterogeneity of the simulated regions than the actual regions the average relative root mean square errors rmse and absolute biases abs bias of the extreme quantile estimates of the sub regions from simulated data are less than 20 0 and 5 0 respectively for spring fig 4 b illustrates the averages of the rmse absolute bias and bias of all the 50 and 100 year at site extreme quantile and of the regional extreme quantile estimates of the simulated regions the 90 error bounds of the extreme quantile estimates from the simulations are in the range of the estimates from actual data table 6 fig 5 b reveals that regional extreme quantile estimates against return periods from simulated and actual data are consistent even though the actual at site extreme quantile estimates exhibit larger scatter than the simulated at site extreme quantile estimates the 90 confidence intervals constructed from simulated data also include at site extreme quantile estimates from actual data 5 3 summer in summer the grid under investigation has five sub regions the region under investigation with the total number of sites of 35 is more heterogeneous compared to winter and spring this may be due to the presence of a larger number of wave systems in the grid and hence the wave height distributions agree well with probabilistic laws than in summer and in winter in summer the grid also exhibits eight discordant sites 9 and 10 19 31 to 35 the discordant sites except 10 are close to the shore and influence of the continent may be one of the reasons for the sites to be discordant the ranges of the l cvs of the basic data of the sub regions 1 2 3 4 5 chosen for the execution of the simulations of the actual regions are less than the actual ranges of the l cvs of the sites and are of the order 0 010 0 036 0 035 0 0005 and 0 0005 the actual ranges of the l cvs of the sites of the sub regions are respectively 0 022 0 037 0 035 0 008 and 0 007 the maximum l cvs 0 300 0 430 0 400 0 300 and 0 280 of the basic regions for simulations of the actual sites are also less than the maximum l cvs of the sites of the actual sub regions 0 420 0 460 0 407 0 357 and 0 328 the actual sub regions in summer are sub region 1 is represented by a generalised extreme value distribution sub regions 2 and 3 are a wakeby distribution and sub regions 4 and 5 are represented by the three parameter log normal distribution table 4 lucas et al 2017 from 100 simulations for each of the actual of the sub regions with same number and sample size of the sites using corresponding regional growth curves the generalised extreme value distribution is chosen in 70 0 cases for sub regions 1 and three parameter log normal distribution is chosen in 53 0 and 44 0 cases for sub regions 4 and 5 respectively table 7 the best fitting distribution of the points in sub regions 2 and 3 all follow a wakeby because the other three parameter distributions were not selected by the z test statistic based on 500 simulations except pearson type 3 distribution in 4 0 cases for sub region 2 and 16 0 cases in maximum cases for sub region 3 the simulated sub regions retain higher heterogeneity than the actual sub regions and table 8 also provides the average absolute biases and rmses of the estimates of the regional extreme quantiles from simulated regions the maximum rmse and absolute bias is 18 4 in sub region 1 and 2 1 in sub region 3 respectively fig 4 c furnishes the averages of the biases absolute biases and rmses of the 50 and 100 year at site extreme quantile estimates of the simulated sub regions and the estimates of the corresponding simulated sub regions fig 9 exhibits the regional extreme quantile estimates from simulated and actual sub regions against designated return periods are consistent the actual extreme quantiles lie within the 90 confidence intervals constructed from the simulated regions table 9 see fig 10 14 see table 9b 5 4 autumn in autumn there are also eight discordant sites 9 and 10 19 31 to 35 the grid under investigation after eliminating the discordant sites comprises four sub regions fig 3 the at site l cvs and the ranges of the basic sub regions used as input for simulations of the sub regions with the same number and sample size of the sites of the actual inter site correlated sub regions 1 2 3 and 4 are able to generate more heterogeneous regions as required the average heterogeneity measures of the simulated regions based on 500 simulations are higher than the heterogeneity measures of the actual regions the regional average extreme quantile estimates from simulated regions are also compatible with the estimates from the actual region the highest at site l cvs of the basic regions and the ranges in parentheses are respectively 0 7200 0 068 0 5600 0 009 0 5000 0 0360 and 0 4500 0 009 and for the actual regions are 0 8814 0 0754 0 8018 0 097 0 6945 0 0556 and 0 6355 0 0366 the maximum significant wave height distributions of region 1 are best represented by pearson type 3 distribution and the distributions of wave heights of all other sub regions 2 3 and 4 are best represented by three parameter log normal distributions table 10 provides the frequency of the selected by z test based on 500 simulations distributions that are actually chosen from the 100 repetitions for each of the sub regions by the regional frequency distributions of the sub regions the highest most selected distributions are respectively pearson type 3 for sub region 1 in 85 0 cases 98 0 three parameter log normal distributions for sub regions 2 3 and 4 in 75 0 67 0 cases in 79 0 68 0 cases and in 76 0 59 0 cases hence from simulations it is confirmed that sub region 1 is best modelled by a pearson type 3 distribution and the other three regions by the three parameter log normal distribution the maximum values for the average rmse and absolute bias of the regional extreme quantile estimates from the simulations are respectively 9 7 in sub region 3 and 0 60 in sub region 4 fig 4 d also shows the average rmse absolute bias and bias of the 50 and 100 year regional extreme quantile estimates of the sub regions and the extreme quantile estimates of the member sites of the sub regions and are also insignificant fig 15 illustrates the comparison of the extreme quantile estimates from simulated and actual data versus the designated return periods table 11 gives the 90 error bounds of the regional extreme quantile estimates from simulated data and the extreme quantile estimates from actual data the h s e x t r e m e of the actual data are within the confidence intervals of the simulated data in autumn it was revealed that though the at site extreme quantile estimates from the actual data are more dispersed than the at site values from the actual data the at site h s e x t r e m e are also within the 90 confidence intervals this is not the case for sub region 1 the lower bounds are marginally higher than the lowest at site extreme quantile estimates of various designated return periods from actual data the diagrams also demonstrate the regional extreme quantile and their corresponding at site extreme quantile estimates from simulated and actual data see fig 16 see table 11b 6 conclusions this study highlights the usefulness of conducting regional frequency analysis using l moments to assess the uncertainty of the estimated extreme quantiles as a pre requisite for any ocean engineering activity the maximum significant wave heights extracted from a grid off portugal in the north atlantic ocean has been subjected to regional frequency analysis to form homogeneous regions to identify discordant sites to select appropriate regional growth curves and to estimate regional extreme quantiles with the required precision lucas et al 2017 since statistical analysis results often exhibit inherent uncertainty confidence intervals are constructed in this paper for quantile estimates in the homogeneous regions assuming that sample l moments are normally distributed in large samples there exists a significant inter site correlation between the sites that constitute the sub regions particularly in winter and spring the average of the inter site correlations is employed to generate the correlated sub regions the simulated regions have higher heterogeneity than the actual regions the between site dispersions in population l moment ratios of the simulated regions are chosen to be smaller than the sample l moment ratios of the actual data as sample l moment ratios are more spread out than the respective population l moment ratios due to sampling variability the wave height distributions of the simulated sub regions have similar best fitting probability distributions as the distributions of the actual regions the regional extreme quantile estimates from simulated data are consistent with the estimates from the actual data the average relative root mean square errors rmse and absolute bias of the regional and at site extreme quantile estimates from simulated data are insignificant ensuing sufficient accuracy on the extreme quantile estimates the regional extreme quantile estimates as well as the at site extreme quantile estimates from actual data are well within the 90 error bounds acknowledgement this work was performed within the strategic research plan of the centre for marine technology and ocean engineering which is financed by portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uid multi 00134 2013 lisboa 01 0145 feder 007629 
22457,this paper concerns the estimation of 3 h short term dynamic responses of semi submersible system moored by two hybrid mooring systems the global maximum method which is applied by fitting 50 individual maximum observations by gumbel distributions is used to obtain extreme surge motion and mooting tensions the accuracy of the numerical model has been validated by the model tests the most probable maximum extreme mpme values of gumbel distribution fitted by l moments are adopted as the benchmarks and used to check the accuracy of the extrapolation methods the average conditional exceedance rate acer method as well as optimized peaks over threshold pot method combined with generalized pareto distribution gpd three parameters weibull distribution and generalized extreme value distribution gev are applied to study 3 h return levels the effects of threshold ensemble size and simulation duration on extreme values are investigated and suitable empirical thresholds are suggested a method to predict short term extreme values by combing 20 individual realizations is given the effects of parameters estimation method threshold and duration are discussed keywords semi submersible hybrid mooring system short term extreme value acer method optimized pot method l moments method bootstrapping method 1 introduction with the offshore oil and gas source exhausting the hydrocarbon exploration activities are pushing to deep and ultra deep waters consequently mooring tensions and dynamic responses of floating structure are more prominent fully coupled dynamic analysis garrett 2005 ormberg et al 2005 tahar and kim 2008 and model tests ji and xu 2014 should be carried out to capture dynamics of floating system precisely extreme responses which is one of the most important values in the design need to be estimated accurately the uncertainties resulting from the application of different methods to predict long term extreme significant wave height have been discussed by guedes soares and scotto 2001 an extensive review of extreme value analysis methods for marine design is provided by jonathan and ewans 2013 some design codes can be found for estimating short term extreme responses of floating structures api rp 2sk 2005 dnvgl 2015 where the extreme responses are obtained by linear summation of the individual first and second order responses the method to combine low frequency lf and wave frequency wf responses to predict extreme values can also be found in kinoshita and takase 1995 naess 1994 besides liu and bergdahl 1999 concluded that the modified srss square root of sum of squares formula gave better results than other combination formulas in addition to those simplified methods some rigorous statistical methods were presented in the literature liu and bergdahl 1998 studied the extreme cable tension due to wave frequency excitations by fitting envelope maxima by applying the mean crossing rate method naess 1984 naess et al 2007 to the responses simulated by hybrid time frequency coupled analysis approach it was found that the estimated extreme line tension and vessel motions were in good agreement with the values predicted by coupled time domain simulations low 2008 izadparast and duggal 2013 discussed rayleigh exponential stansberg s exponential three parameters weibull and three parameters rayleigh distributions to study the extreme statistics of mooring tension and vessel horizontal offset of a turret moored fpsos according to the experimental data the results showed that the rayleigh distribution underestimated extremes significantly while the three parameters rayleigh distribution and three parameters weibull distribution gave reasonable results cheng and kuang 2016 applied the gumbel model weibull model and winterstein jensen model to estimate the extreme responses of a spread moored fpso system in 250 m 500 m and 1000 m water depth the gumbel model sample consists of ten maximum values in 3 h which were obtained by the numerical simulations with random seed number the top 80 peaks were fitted by a weibull model to calculate the 3 h mpmes it was found that the gumbel method always provided consistent values and the results of weibull model and winterstein jensen model could be divergent recently a composite weibull distribution model was developed to predict the extreme mooring tension with snap loads considered hsu et al 2017 the acer method which is developed by naess and gaidai 2009 is a powerful method in extreme value estimation one of the advantages of this method is that the prediction is not sensitive to the threshold the exceedance rate is determined on the basis of cascade of conditional approximations it has been successfully implemented in wind speed and structure dynamic extreme values analysis naess et al 2013 2012 2010 naess and gaidai 2008 øiseth et al 2014 saha and naess 2010 and the accuracy was validated recently a bivariate acer method was developed to evaluate the extreme large cargo ship panel stresses gaidai et al 2016 other applications of the acer method to ship panels can be found in gaspar et al 2012 2014 xu et al 2018 applied the acer method to study extreme mooring tension reliability peak over threshold pot method is another efficient method pickands 1975 which is widely used in extreme value analysis such as extreme significant wave height analysis ferreira and guedes soares 1998 campos and guedes soares 2016 orimolade et al 2016 campos et al 2019 floating wind turbine extreme load analysis dimitrov 2016 ding and chen 2014 ragan and manuel 2008 toft et al 2011 wang 2017 wang et al 2013 this method is applied based on two assumptions first the sample global maxima satisfy the generalized extreme value gev distribution and the upcrossings over the threshold are poisson and the exceedance are independent one of the difficulties in applying this method is to select the appropriate threshold and make sure upcrossings over threshold are poisson and the exceedance are independent since too high threshold level may lead to the insufficient peaks to obtain statistic convergence while too low threshold level would include the points which do not follow tail probability model besides it is not easy to judge if the upcrossings over the threshold are poisson or not recently an optimal threshold searching method was proposed by using declustering algorithm and the dispersion index wang 2017 there are other alternatives to pot approach such as described in guedes soares and scotto 2004 scotto and guedes soares 2007 dong et al 2013 and petrov et al 2019 however the pot is presently a more widely used method so this will be the choice for this work another difficulty is the parameters estimation the l moments method which was developed by hosking 1990 can be defined for any random variables whose expected value exists the main advantage of this method is that it is much more robust to the existence of outliers than conventional moments and are very efficient and accurate for small sample which makes the l moments to be a very desirable choice for extreme value analysis lucas et al 2017 izadparast and duggal 2013 izadparast and niedzwecki 2010 pandey and van gelder 2001 the extreme responses of floating systems are the main concerns of ultimate limit states uls design which need to be estimated precisely and effectively the optimal pot method combined with extrapolation approach is applied for predicting the short term extreme vessel surge motion and mooring tension this approach has not yet been applied to study extreme mooring tension in the literature to the authors best knowledge besides to simplify the analysis procedure the empirical thresholds for extreme surge and mooring tension analysis are studied which are also not to be seen in the literature related to extreme mooring tension analysis the effects of threshold ensemble size and simulation durations on extreme values are discussed the suitable durations for extreme mooring tension analysis are given first furthermore the suitable distributions for excess points are discussed where the distribution parameters are fitted by the efficient l moments method and maximum product of spacing method mps method in addition to the pot method the sophisticated acer method is also used to study the 3 h extreme vessel surge motion and mooring tension the accuracy of extrapolation methods is then checked by the global maximum method 2 fully coupled dynamic analysis and model descriptions the fully coupled dynamic analysis is implemented in deepc to obtain the platform six degree of freedom dof motion responses and mooring tensions the governing equation is written as marintek 2015a 1 m a x c 1 x c 2 f x k x 0 t h t τ x τ d τ q t x x where m is the body mass matrix a is the infinite added mass matrix c 1 is the linear damping matrix c 2 is the quadratic damping matrix k is the stiffness matrix f is the vector function the element is given by 2 f i x i x i h τ is the retardation function which is computed by the frequency dependent added mass and damping transformation 3 h τ 1 π 0 c ω cos ω τ ω a ω sin ω τ d ω the right side of eq 1 is given as 4 q t x x f w f m where f w is the wave force f m is the mooring tensions the finite element method is applied to analyse mooring dynamics the governing equation of mooring dynamics is expressed as marintek 2015b 5 r i r r t r d r r t r s r t r e r r t where r i is the inertial force vector r d is the damping force vector r s is the inertial structure reaction force r e is the external force vector which accounts for weight and buoyance hydrodynamic drag force the newmark beta implicit integration method is applied to solve the eq 1 the relations between displacements velocity and acceleration vectors at time t and t δt are represented by 6 x t δ t x t 1 γ x t δ t γ x t δ t δ t 7 x t δ t x t x t δ t 0 5 β x t δ t 2 β x t δ t δ t 2 the fully coupled dynamic analysis is carried out to study a six generation deepwater semi submersible hysy 981 operates in south china sea and the main dimensions of this platform are shown in table 1 the irregular wave was modelled by the jonswap wave spectrum with a significant wave height 13 7 m a peak period of 16 s and a peak enhancement factor of 2 and only the head sea condition was considered the semi submersible which is moored by two hybrid mooring systems tmf and tmbf in 200 m water depth is numerically studied the dynamics of platform mooring system will be analysed by fully coupled dynamic analysis single tmf mooring line is composed by wire and five clump weights the clump weights which are installed on the end part of mooring line with the uniform distance and the weight decreasing from top to seafloor while the construction of tmbf is similar to tmf except for an additional buoy being fixed on the top region of mooring line the schematic of tmbf is shown in fig 1 the main parameters mooring line model are given in table 2 where ww is the submerged weight per unit length r is the mooring radius as described above five clump weights are installed on each mooring line these weights are attached on the last 100 m of mooring line with uniform distance of 20 m the position of cylinder buoy is 40 m away from fairlead the weight of each clump weight is given in table 3 where cwa is the weight in air cwm is the submerged weight the net buoyancy of buoy model is 196 kn the tangential and normal drag coefficients of mooring line were 0 6 and 1 85 and the inertial coefficients in tangential and normal directions were determined as 1 4 and 1 8 respectively in the numerical simulations xu et al 2018b as shown in fig 2 the mooring system comprises of 12 mooring lines which are arranged symmetrically and divided into four groups the azimuth angles between mooring line and x axis in one group are 250 450 650 the coordinates of fairleads in model tests are given in table 4 the origin z coordinate starts from the baseline the experimental study of these two systems are given in xu et al 2018a 2018b and the accuracy of numerical models have been validated in xu et al 2018b 3 global maximum method the global maximum method is a very accurate approach to estimate extreme value only the maximum value in the concerned duration is extracted from each individual simulation the obtained peaks are uncorrelated and independent as a consequence the extracted maximum values from an ensemble of simulations are assumed to satisfy the gumbel distribution generally the size of samples included in ensemble should be greater than 20 since the 3 h extreme value is interested in ocean engineering in this paper 50 3 h fully coupled dynamic analysis are carried out with different seed number the maximum surge response amplitude and mooring tension of each simulation are extracted and fitted to the gumbel distribution the cumulative distribution function of gumbel distribution is 8 f x μ l β l exp exp x μ l σ l where μ l is the location factor σ l is the scale factor the most probable maximum extreme mpme value which is the mode value has a 63 2 chance to be exceeded will be used as benchmark and compared to results of other extrapolation methods for the gumbel distribution this mpme is calculated as 9 x mp μ l β l ln ln f 1 0 632 μ l 4 extrapolation methods 4 1 acer method the acer method was proposed by naess and gaidai 2009 which calculates the exceedance probability on the basis of cascade of conditional approximation suppose over a time interval 0 t the stochastic process has n observations x 1 x n in the discrete times t 1 t n the goal is to accurately determine the distribution function of the extreme value m n max x j j 1 n specifically the value of p η prob m n η is the estimation of large values of η the definition of p η follows 10 p η prob x 1 η x n η prob x n η x 1 η x n 1 η prob x 1 η x n 1 η j 2 n prob x j η x 1 η x j 1 p x 1 η by assuming that all the x j are statistically independent the p η is approximated as 11 p η j 1 n p x j η the conditional exceedance probability is defined as 12 α k j prob x j η x j k 1 η x j 1 η where α kj denotes exceedance probability conditional on k 1 previous non exceedances assuming that the conditional exceedances events are independent and following a poisson process the extreme value distribution can be approximated as 13 p k η exp j k n α k j η where j k n α k j η is the expected effective number of independent exceedances provided by conditioning on k 1 previous observations the conditional average exceedance rate aer is defined as 14 ε k 1 n k 1 j k n α k j η k 1 2 for both stationary and non stationary time series the sample estimate of acer would be 15 ε ˆ k η 1 m m 1 m ε ˆ k m η where m is the number of samples index m refers to realization no m assuming the samples are independent the 95 confidence interval ci for acer is given as 16 ci η ε ˆ k η 1 96 s k η m where s k η is the standard deviation of ε ˆ k η 17 s k η 2 1 m 1 m 1 m ε ˆ k m η ε ˆ k η 2 assuming the mean exceedance rate in the tail is dominated by an exponential function it is approximated as 18 ε k η q k η exp a k η b k c k η η 1 where a k b k c k and q k are the parameters related to k η 1 equals to threshold the parameters a b c and q are determined by minimizing the following mean square error function with respect to all four arguments 19 f a b c q j 1 r w j log ε k η j log q a η j b c 2 where η 1 η r denotes the levels where acer function has been estimated w j denotes a weight factor it is given as 20 w j log c η j log c η j θ θ 1 or 2 in this study θ 2 is used the four parameters optimization problem can be simplified as two parameters by expressing a q in terms of b and c saha et al 2014 21 z j log ε k η j 22 y j η j b c 23 a b c j 1 r w j y j y z j z j 1 r w j y j y 2 24 log q b c z a b c y 25 y j 1 r w j y j j 1 r w j z j 1 r w j z j j 1 r w j now eq 19 is written as 26 f b c f a b c b c q b c to improve the robustness of results some constrains are applied 27 0 c 5 min x j b η 1 0 q 0 a the levenberg marquardt method is applied to solve eq 26 and find b c then a and q are calculated by substituting b and c to eqs 23 and 24 in order to estimate the confidence interval of the predicted return value provided by the optimal curve the empirical confidence band is re anchored to the optimal curve once the ε k η is determined the probability is calculated according to eq 13 the acer method was then developed by using matlab r2016 4 2 the peak over threshold method the pot method is based on generalized pareto distribution gpd under the assumption that the parent distribution belongs to the domain of attraction of one of the extreme value distributions and the excess values above threshold follow the gpd pickands 1975 by choosing the threshold level sufficiently high multiple important crests over threshold are extracted it is assumed that the exceedances are independent and pot are poisson then the selected peaks are fitted to the extreme value distribution generally the generalized pareto distribution gpd is the preferred model for pot however it was pointed out the three parameters weibull is a better choice dimitrov 2016 ragan and manuel 2008 in this paper the gpd weibull distribution and generalized extreme value distribution gev are applied to fit pot statistical characteristics the 3 h extreme values predicted by different methods are compared and discussed 4 2 1 optimal threshold selection and declustering since the distribution parameters are very sensitive to the threshold level it is necessary to take great care to choose the threshold value there are several methods available to determine threshold one of the generally used method is the mean residual life plot for the gpd distribution the mean exceedance over a level u is 28 e x u g x u g σ g ξ g u g 1 ξ g σ g ξ g u g 0 where σ g and ξ g are the scale and shape factor it is found that the mean exceedance is a linear function of u g by plotting mean exceedance against to the u g the proper u g value can be selected ragan and manuel 2008 proposed a procedure to search optimal threshold it was implemented by defining a series of spaced ranges of thresholds and the distribution parameters of pot are fitted for each threshold case the optimal threshold is determined when the loads from fitted distribution have the lowest mean square error with respect to the observed data at the same fractiles dimitrov 2016 presented a similar procedure to select optimal threshold by plotting the root mean square error of empirical data relative to the load predicted by gumbel distribution to the threshold the point where the root mean square error stops being monotonically decreasing was a proper choice for tail threshold level it is noticed that the pot method relies on two assumptions the selected peaks are poisson distributed and the exceedances should be approximately independent sometimes extreme values have a tendency to cluster declustering algorithm can be applied to identify the largest value in each of the clusters liu and bergdahl 1998 in this study the dispersion index is applied to select clusters and check the poisson character wang et al 2013 the dispersion index which is the ratio between the variance and expectations of the number of peak 29 d i σ e 2 μ e where σ e 2 is the variance of numbers of exceedances in the declustering period t b μ e is the mean number of exceedances in a fixed period t b in this study t b is set as equal to the response spectral peak wang 2017 30 t b 2 π s ω 4 d ω ω s ω 4 d ω the threshold value is determined by searching suitable dispersion index brodtkorb et al 2000 wang 2017 31 χ α 2 r 1 2 r 1 d i χ 1 α 2 r 1 2 r 1 where χ2 denotes the chi square distribution r is the total number of de clustering period α is the significant level χ2 α 2 r 1 is defined as the upper 100 α 2 percentage point of a chi square random variable u with r 1 degrees of freedom thus probability that χ2 exceeds this value is α 2 in detail 32 p χ 2 χ α 2 r 1 2 χ α 2 r 1 2 f u d u α 2 in this study the optimal threshold level is determined according to declustering algorithm in wafo brodtkorb et al 2000 4 2 2 generalized pareto distribution the gpd was first presented by pickands 1975 and the maximum of independent gpd variables has a gev distribution mathematically the cumulative distribution function gpd is defined as 33 f x μ g σ g ξ g 1 1 ξ g x μ g σ 1 ξ g ξ 0 1 exp x μ g σ g ξ 0 where the parameters μ g σ g and ξ g are the location scale and shape factor respectively 4 2 3 weibull distribution the cumulative distribution of three parameters weibull distribution is defined as 34 f x μ w σ w ξ w 1 exp x μ w σ w ξ w where the parameters μ w σ w and ξ w are the location scale and shape factor respectively 4 2 4 generalized extreme value distribution the cumulative distribution of gev is defined as 35 f x μ v σ v ξ v exp 1 ξ v x μ v σ v 1 ξ v where the parameters μ v σ v and ξ v are the location scale and shape factor respectively shape parameter ξ v governs the tail behaviour of the distribution for ξ v 0 the distribution corresponds to gumbel distribution 36 f x μ v σ v 0 e e x μ v σ v f o r x for ξ v 0 it corresponds to fréchet distribution 37 f x μ v σ v ξ v e y α y 0 0 y 0 where ξ v α 1 0 y 1 ξ v x μ v σ v for ξ 0 the mathematic form of cumulative distribution is 38 f x μ v σ v ξ v e y α y 0 0 y 0 where ξ v α 1 0 y 1 ξ v x μ v σ v 4 2 5 return value the relation between exceedance probability and return period λ is 39 λ 1 ζ prob x x r where ζ is the mean exceedance rate of threshold u which is calculated as 40 ζ n u t where n u is the number of data points above the threshold t is the duration of simulation the unit of t and λ should be identical then the probability of non exceedance can be presented as 41 pr o b x x r 1 1 λ ζ finally the return value x r can be obtained by calculating the quantiles of the given return period for the gpd distribution x r is written as 42 x r μ g σ g 1 λ ζ ξ g ξ g ξ g 0 μ g σ g ln λ ζ ξ g 0 for the weibull distribution x r is given as 43 x r μ w σ w ln λ ζ 1 ξ w for the gev distribution x r is 44 x r μ v σ v ξ v ln 1 1 λ ζ ξ v 1 ξ v 0 μ v σ v ln ln 1 1 λ ζ ξ v 0 5 estimation of distribution parameters 5 1 the l moments method l moments are linear combinations of probability weighted moments and they have been successfully developed for parameter estimation hosking 1990 the main advantage of l moments is that they are robust to the existence of outliers in the data and the bias are fairly small even for small samples besides it is much more efficient compared to other traditional techniques such as maximum likelihood method especially for small samples these advantages make l moments a good choice for parameters estimations of pot distributions since outliers may occur and sometimes the pot sample is relatively small recently the l moments method is widely used for extreme value analysis in different areas such as wave crest mooring and riser extreme value estimation cheng et al 2010 izadparast and niedzwecki 2009 liu and bergdahl 1998 the probability weighted moment is defined as 45 β r 0 1 x p p r d p where p is the probability for value x the first four l moments are defined as 46 λ 1 β 0 47 λ 2 2 β 1 β 0 48 λ 3 6 β 2 6 β 1 β 0 49 λ 4 20 β 3 30 β 2 12 β 1 β 0 usually the random sample is used to estimate l moments the sample x is first ordered as 50 x 1 n x 2 n x n n where n is the sample size the unbiased estimator of β r is calculated by the following formula 51 b r n 1 n 1 r 1 j r 1 n j 1 r x j n and the notation in the brackets denotes binomial coefficients for example 52 r j r j r j specifically 53 b 0 1 n j 1 n x j n 54 b 1 1 n j 2 n j 1 n 1 x j n 55 b 2 1 n j 3 n j 1 j 2 n 1 n 2 x j n in general 56 b r 1 n j r n j 1 j 2 j r n 1 n 2 n r x j n the first four l moments are written as 57 l 1 b 0 58 l 2 2 b 1 b 0 59 l 3 6 b 2 6 b 1 b 0 60 l 4 20 b 3 30 b 2 12 b 1 b 0 the sample l moment l r is defined universally 61 l r 1 j 0 r p r j b j r 0 1 n 1 where 62 p r j 1 r j r j r j j 1 r j r j j 2 r j the sample l coefficient of variation is 63 t l 2 l 1 the sample l skewness is 64 t 3 l 3 l 2 the sample l kurtosis is 65 t 4 l 4 l 2 5 1 1 gumbel distribution by applying the l moments method the scale and location factors are defined as bílková 2014 66 σ l l 2 ln 2 μ l l 1 γ σ l where γ is the euler s constant 5 1 2 generalized pareto distribution the three parameters of the gpd can be estimated by using three samples l moments pandey et al 2001 67 ξ g 3 t 3 1 t 3 1 σ g 1 ξ g 2 ξ g l 2 μ g l 1 2 ξ g l 2 for case when the location factor is fixed the first two l moments can be used to estimate the other two parameters pandey and van gelder 2001 68 ξ g 2 l 1 μ g l 2 σ g 1 ξ g l 1 μ g 5 1 3 weibull distribution the l moments and their ratio for a weibull distribution are goda et al 2010 69 λ 1 μ w σ w γ 1 1 ξ w 70 λ 2 σ w 1 2 1 ξ w γ 1 1 ξ w 71 τ 3 3 2 1 3 1 ξ w 1 2 1 ξ w 72 τ 4 5 1 4 1 ξ w 10 1 3 1 ξ w 6 1 2 1 ξ w 1 2 1 ξ w where γ denotes the gamma function the parameters are estimated by applying the sample l moments goda et al 2010 73 ξ w 285 3 t 3 6 658 6 t 3 5 622 8 t 3 4 317 2 t 3 3 98 52 t 3 2 21 256 t 3 3 516 74 σ w l 2 1 2 1 ξ w γ 1 1 ξ w 75 μ w l 1 σ w γ 1 1 ξ w 5 1 4 generalized extreme value distribution the parameters of gev are estimated by applying the l moments method bílková 2014 76 ξ v 7 8590 ν 2 9554 ν 2 77 σ v l 2 ξ v 1 2 ξ γ 1 ξ v 78 μ v l 1 σ v γ 1 ξ v 1 ξ v where 79 ν 2 3 t 3 ln 2 ln 3 5 2 the maximum product of spacing method the mps is another efficient method for parameters estimation and this method has a high asymptotic efficiency ranneby 1984 the independent and identically distributed iid sample x 1 x n with the cumulative distribution function f x θ 0 θ 0 are the distribution parameters need to be estimated the sample is first transformed to the ordered sample x 1 x n the spacing is defined as gaps between the values of the distribution function at adjacent ordered points 80 d i θ f x i θ f x i 1 θ i 1 n 1 then the maximum spacing estimator of θ 0 is defined as a value that maximizes the logarithm of the geometric mean of sample spacing 81 θ ˆ arg max θ θ u n θ where 82 u n θ 1 n 1 i 1 n 1 ln d i θ 6 estimation of 3 h extreme response for the extreme value analysis multiple realizations are needed to consider the uncertainty of wave train generally the number of realizations should be greater than 20 in this paper 50 fully coupled dynamic simulations are carried out for each mooring system with different seed number to consider random wave train the global maximum method will be first carried out to predict the 3 h extreme mooring tension and platform surge response for both mooring systems the extreme values calculated by global maximum method are used as the benchmarks then the extrapolation methods including acer and pot method based on ensemble pot method based on twenty individual realizations will be carried out to study the extreme responses of tmbf system some meaningful suggestions and results will be given finally the 3 h extreme values of tmf system are obtained by applying the refined extrapolation method from above discussions the results are then compared with tmbf system to discuss the influence of buoy on system short term extreme responses in the head sea condition the 1 mooring line is the most loaded one as a consequence our study concerns the fairlead tension of 1 mooring line the time series and response spectra of tmbf surge motion responses as well as mooring tension for the first seed number are shown in figs 3 and 4 respectively it can be clearly seen that both the surge motion and mooring tension are dominated by low frequency component the plots of kurtosis and skewness for tmbf surge motion and mooring tension are given in fig 5 it indicates that mooring tension exhibits a strong non gaussian nature due to strong nonlinearity comparatively speaking the surge motion is closer to gaussian than mooring tension 6 1 the gumbel method the maximum surge response amplitudes and mooring tensions of each 3 h simulations are plotted in figs 6 and 7 it can be seen the maximum values vary significantly with the seed number which demonstrates that the system dynamics are sensitive to the wave train and it is necessary to predict extreme value by considering different seed number the parameters of gumbel distributions are fitted by l moments method according to the 50 maximum response values to diagnose the accuracy of fitted gumbel distributions residual probability plot as well as residual quantile plot of maximum tmbf system dynamics are given in fig 8 in these figures it is observed that most points distribute along the reference line despite the discrepancies of the tail points it indicates that the estimated gumbel distributions match well to the empirical data the goodness of fits plots for tmf are similar to tmbf and will not be presented in this study for further study up on the accuracy of l moments method the mpmes predicted by the model fitted with l moments are compared with the values estimated by the model fitted by maximum likelihood estimation the results are given in table 5 where l refers to l moments ml is the maximum likelihood estimation ci is the 95 confidence interval which is evaluated by non parametric bootstrapping technique the size of bootstrapping sample is 10 000 as shown in table 5 the values predicted by these two methods are in good agreement which verifies the l moments method is a good choice to estimate gumbel parameters in the following study the mpmes estimated by gumbel distribution are acted as the benchmarks and the parameters are estimated by the l moments method 6 2 extrapolation methods based on ensemble as described above the acer method extrapolates extreme values on the basis of ensemble typically more than 20 realizations should be included in one ensemble in this study the effects of threshold on estimations of return levels by acer method and pot method are studied then the influence of ensemble size as well as the time duration on estimated extreme values are evaluated to check the accuracy the extreme values predicted by extrapolation methods are compared with the mpmes from gumbel distribution 6 2 1 effect of threshold in this section the ensemble which includes 20 realizations and each realization has 20 min duration with first 200s transient results neglected are used for extreme value analysis before carrying out the acer method it is essential to determine the k value fig 9 highlights the cascade of conditional acer estimates for different k values it can be seen that there are no substantial differences between different k values for both surge motion and mooring tension subsequent conditioning on more than one peaks does not cause clear differences of acer values k is chosen to be 3 in the further study to investigate the influence of threshold η 1 on the extreme value estimation of acer method different η 1 values are discussed 83 η 1 μ x n m σ x where μ x and σ x are the mean value and standard deviation of ensemble respectively the effects η 1 on 3 h extreme motion response are shown in fig 10 according to fig 10 no distinguishing differences between 3 h extreme surge motion response can be found by modifying the η 1 it indicates that the extreme surge motion is not very sensitivity to the η 1 which agrees with the results of naess et al 2013 for a better presentation of effects of η 1 the results are given in table 6 where the 95 ci are estimated according to eq 16 with m equals to 20 in table 6 it is observed that for all discussed nm values the 3 h extreme surge mainly stay in the similar level which equals to 28 m and are very close to the reference result and nm 2 is a proper choice the effects of threshold on 3 h mooring tension extreme value are studied and the results are shown in fig 11 and meanwhile table 7 shows the corresponding results for better comparisons a similar finding can be observed which is the effect of η 1 on 3 h extreme mooring tensions is negligible however the effect of η 1 is notable for the long return period overall it can be seen that the acer method provides very good estimations for 3 h extreme values for both surge motion and mooring tension which confirms that the accuracy of acer method for predicting extreme floating structure responses is good enough in this study the η 1 is set as μ 1 1σ for both surge motion and mooring tension one may argue that the nm should chose a relatively large value to obtain a good estimation of extreme mooring tension according to table 7 however it should be noticed that a high threshold means that most of empirical acer values are similar which may lead to instability of numerical optimization fitting one of the most essential parts in pot method is to determine the suitable threshold some detail procedures for searching suitable threshold can be found in extreme significant wave analysis pickands 1975 in the extreme wind turbine load analysis several different optimal threshold selecting methods were presented dimitrov 2016 ragan and manuel 2008 besides the empirical value which equals to μ 1 4σ is suggested by moriarty et al 2004 for extreme wind turbine loads analysis the accuracy of adopting the empirical value for extreme wind turbine loads analysis was validated toft et al 2011 in this study the threshold is first determined by an optimization method and the extreme values estimated by applying this threshold will be compared with the predicted results of other empirical thresholds the dispersion index plot of tmbf surge responses is shown in fig 12 the threshold is determined as 18 7 m then the gpd three parameters weibull and gev model are applied to fit pot by l moments method the 3 h extreme surge responses predicted by different threshods are shown in table 8 where u is the optimal selected threshold and the 95 ci is estimated by non parametric bootstrapping technique it can be found that the number of pots are reduced dramatically with threshold increasing however the estimated extreme surge responses are not very sensitivity to the threshold the values change slightly with the thresholds and are close to the benchmark estimated by global maximum method the extreme values estimated by gpd are close to weibull for all discussed thresholds while the results of gev are not as good as the other two distributions however the differences between them are reduced with the threshold increasing it suggests to set the threshold as μ 1 4σ to be the empirical value for predicting extreme surge responses which gives the most accurate extreme value the procedure of analysing the effects of threshold on mooring tension is the same to the discussion of extreme surge motion the dispersion index plot is given in fig 13 the 3 h extreme mooring tensions estimated by applying different empirical thresholds are given in table 9 similar to extreme surge responses it is seen that the extreme mooring tension is not sensitive to the threshold and the predicted extremes are very close to the benchmarks however the model adopts the optimal threshold gives the best predictions while the empirical value is recommended as μ σ according to the comparisons with benchmarks besides the extreme value estimated by gpd are very close to the weibull estimations the gev model overestimates the extreme tension considerably if a low threshold is adopted however it provides accurate result if the threshold is high enough 6 2 2 effect of sample numbers and duration the ensemble size as well as the duration for each simulation are closely related to the extreme value estimations in the wind turbine studies it is suggested to adopt 10 min durations for estimating 1 h extreme values dimitrov 2016 moriarty et al 2004 saha et al 2014 wang 2017 however for the floating production systems the 3 h extreme value is interested besides the study of the effect of ensemble size as well as duration on the estimation of floating production systems extreme value are not found in this study the ensemble with 20 30 and 50 realizations and each realization with three different durations 10 20 and 30 min will be analysed the realizations are randomly selected without replacement in figs 14 17 the results of parametric estimation of the 3 h return values and corresponding 95 ci for different sample sizes and durations by applying acer method are shown for a better presentation the extreme surge motions estimated by acer method as well as pot method with optimal threshold are given in table 10 where it is seen that all the calculated extreme values are not very sensitive to the sample size and duration especially for the gpd and weibull model for 10 min duration cases it can be seen that the extreme surge motion is reduced and then increased slightly when sample size increases from 20 to 50 as for the 20 min cases the extreme surge motion is reduced slightly with ensemble size increasing this interesting phenomenon can be found for both acer and pot method besides the acer method gpd and weibull model give very good predictions for 3 h surge motion return value as for the gev the results are acceptable but slightly poorer than other methods it is found that the ensemble with 20 realizations and each realization with 20 min durations is a good choice for predicting 3 h surge motions the results of extreme mooring tension are given in table 11 the influence of ensemble size and sample duration on extreme mooring tension are similar to the results of extreme surge motion discussed above the suitable choice is the ensemble of 20 realizations and each realization with 20 min durations the 20 realizations with 10 min durations may be also a good choice which estimates the extreme values accurately and costs less time however it is noticed that return level extracted from 10 min durations are more sensitive to the number of sample compared with 20 min simulation 6 3 pot method based on individual sample in the above study the pot method is carried out by combining the realizations with different seed number into one ensemble and then applying the optimization method to select the optimal threshold and declustering the pot in the following study the applicability of using multiple individual sample to predict extreme values will be studied twenty samples are used in this section then the pot method is applied to each sample and the average of these twenty extreme values is determined as the final 3 h return value 6 3 1 effect of parameters estimation method twenty realizations are selected randomly and the durations for each realization are 20 min the optimal pot method is applied to each sample to obtain extreme responses then the l moments and mps method are used to fit the parameters of gpd weibull and gev distributions the predicted extreme surge response and mooring tension values are shown in tables 12 and 13 respectively according to the results it is seen that mps method overestimates extreme values dramatically except for weibull model besides all the models fitted by l moments methods provide satisfactory results however it is found that the extreme value is fluctuated greatly for each seed number the gpd is the best choice while gev model always overestimate the return levels in the following study the l moments will be implemented in the pot method 6 3 2 effect of threshold the study of effect of different threshold values on 3 h extreme surge motion and mooring tension is carried out unlike the ensemble method here the pot method is applied to each realization in other word the number of data points is relatively small and the pot method could be failure if high threshold is used since the size of pot sample may be not large enough to fit a model properly to reveal this problem the pot plots for surge motion and mooring tension are shown in figs 18 and 19 for a random selected simulation id 44 in these two figures u is the optimal threshold μ and σ are the mean value and standard deviation of corresponding 20 min realizations the first 200s transient results are neglected in the head sea the maximum surge amplitude locates in x axis the fig 18 plots negative surge motion x for comparing conveniently it is seen that the number of pots is reduced significantly for both surge motion and mooring tension and the empirical value μ 1 4σ is not suitable in this case the 3 h extreme value and corresponding 95 ci for surge motion and mooring tension are given in tables 14 and 15 respectively and the 95 ci is calculated according to eq 16 both gpd and weibull present good estimation for 3 h return surge level while the gev model overestimates the extreme surge motion slightly as for the extreme mooring tension it is observed that the gpd is the best choice weibull model underestimates extreme value slightly however it still gives satisfactory estimations while gev overestimates the extreme mooring tension considerably besides it is found the estimated return levels are increasing with threshold overall the μ 0 5σ is recommended as suitable empirical value 6 3 3 effect of duration the ensemble with two different durations i e 20 and 30 min durations are discussed and the ensemble size is kept as 20 identical to table 14 as shown in tables 16 and 17 the influence of time durations on extreme values are limited for all discussed models the 20 min durations are suggested since it is accurate enough to estimate extreme responses besides it is more efficient than the case with 30 min durations 6 4 discussion of the results of two mooring systems in this section the extreme tmf surge and mooring tension are studied by applying the extrapolation procedures discussed above the results are compared with tmbf extreme values to discuss the differences between these two systems the acer plots of tmf are given in fig 20 and the 3 h return levels from different method are given in tables 18 and 19 as shown in table 18 both the acer method and pot method provide very good estimations to extreme surge values for pot method the gev model underestimate extreme level slightly besides it is found that the extreme surge motion of tmbf is slightly greater than tmf which is explained that the mooring restoring force is reduced once the buoys are installed similar to the results of surge motion response the extreme mooring tension are well estimated for all discussed methods however in contrast to the extreme surge response the extreme mooring tension is overestimated by gev model besides the extreme mooring load reduction is found by adding buoys to tmf mooring lines based on twenty individual realizations the pot method is used to predict extremes of tmf system and the average of these twenty extremes are acted as the final results the results are given in table 20 where it is showing that the gev is not suitable for extreme value analysis in this situation which overestimates the extreme tensions of both systems and tmbf surge motion considerably the gpd and weibull give similar estimations which overestimate the extreme surge motions slightly however gpd model presents very accurate estimation in extreme mooring tension while the underestimations can be found in weibull model for both tmf and tmbf 7 conclusions this paper studies several methods for estimating the short term extreme responses of semi submersible systems moored by two hybrid mooring systems a sample of 50 global maximum surge responses and mooring tensions are used as the observations of gumbel distribution the mpmes predicted by gumbel distribution play the role of benchmark values which are 28 8 m 4661 4 kn for surge and mooring tension respectively of tmbf system while these two values are 27 4 m and 4725 7 kn for tmf system the extrapolation methods including acer method and pot method are applied to estimate short term values based on the ensemble it is found that the extreme values predicted by acer method are not sensitive to the threshold the optimal threshold as well as empirical thresholds are studied to discuss the effects of threshold on short term extremes estimations it is found that both the extreme surge and mooring tension are not very sensitive to the discussed thresholds and μ 1 4σ is recommend as the empirical threshold to study extreme value of surge motion while the empirical threshold is suggested to be μ σ for mooring tension in these certain cases the ensemble size as well as realization duration could affect the estimated extreme values of all methods more or less the ensemble with 20 realizations and the duration sets as 20 min seems to be a suitable choice the method to take the average extreme value of 20 realizations as the finial extreme response is studied it is found that the mps method is not suitable for estimating extreme values for this method which could induce a significant error while the l moments method shows good performance besides the large empirical threshold may lead to the failure in the application of this method due to the insufficient number of pot the empirical threshold is suggested to be μ 0 5σ for both surge response and mooring tension furthermore by enlarging the duration from 20 min to 30 min does not help improving the accuracy of estimation however it should be noticed that obvious fluctuations of extreme values can be found for realization with different seed number overall the acer method as well as optimized pot method combined with gpd model and weibull model provide very good estimation of short term extreme value of surge motion and mooring tension the results of gev model are satisfactory but it is not the best choice which underestimates extreme surge motion slightly while the opposite results can be found in extreme mooring tension estimations while the gpd model shows better performance than the other two models the method by averaging extreme values of individual realization overestimates the extreme surge motion slightly however the extreme mooring tension is well estimated by gpd model by comparing the extreme values of these two mooring systems it is found the installed buoys help to reduce maximum mooring tension acknowledgement the work of the first author has been funded by the strategic research plan of the centre for marine technology and ocean engineering centec which is financed by the portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uid multi 00134 2013 lisboa 01 0145 feder 007629 gs2 the second author gratefully acknowledge financial support from the national natural science foundation of china grant no 51379092 which has made the experimental work possible 
22457,this paper concerns the estimation of 3 h short term dynamic responses of semi submersible system moored by two hybrid mooring systems the global maximum method which is applied by fitting 50 individual maximum observations by gumbel distributions is used to obtain extreme surge motion and mooting tensions the accuracy of the numerical model has been validated by the model tests the most probable maximum extreme mpme values of gumbel distribution fitted by l moments are adopted as the benchmarks and used to check the accuracy of the extrapolation methods the average conditional exceedance rate acer method as well as optimized peaks over threshold pot method combined with generalized pareto distribution gpd three parameters weibull distribution and generalized extreme value distribution gev are applied to study 3 h return levels the effects of threshold ensemble size and simulation duration on extreme values are investigated and suitable empirical thresholds are suggested a method to predict short term extreme values by combing 20 individual realizations is given the effects of parameters estimation method threshold and duration are discussed keywords semi submersible hybrid mooring system short term extreme value acer method optimized pot method l moments method bootstrapping method 1 introduction with the offshore oil and gas source exhausting the hydrocarbon exploration activities are pushing to deep and ultra deep waters consequently mooring tensions and dynamic responses of floating structure are more prominent fully coupled dynamic analysis garrett 2005 ormberg et al 2005 tahar and kim 2008 and model tests ji and xu 2014 should be carried out to capture dynamics of floating system precisely extreme responses which is one of the most important values in the design need to be estimated accurately the uncertainties resulting from the application of different methods to predict long term extreme significant wave height have been discussed by guedes soares and scotto 2001 an extensive review of extreme value analysis methods for marine design is provided by jonathan and ewans 2013 some design codes can be found for estimating short term extreme responses of floating structures api rp 2sk 2005 dnvgl 2015 where the extreme responses are obtained by linear summation of the individual first and second order responses the method to combine low frequency lf and wave frequency wf responses to predict extreme values can also be found in kinoshita and takase 1995 naess 1994 besides liu and bergdahl 1999 concluded that the modified srss square root of sum of squares formula gave better results than other combination formulas in addition to those simplified methods some rigorous statistical methods were presented in the literature liu and bergdahl 1998 studied the extreme cable tension due to wave frequency excitations by fitting envelope maxima by applying the mean crossing rate method naess 1984 naess et al 2007 to the responses simulated by hybrid time frequency coupled analysis approach it was found that the estimated extreme line tension and vessel motions were in good agreement with the values predicted by coupled time domain simulations low 2008 izadparast and duggal 2013 discussed rayleigh exponential stansberg s exponential three parameters weibull and three parameters rayleigh distributions to study the extreme statistics of mooring tension and vessel horizontal offset of a turret moored fpsos according to the experimental data the results showed that the rayleigh distribution underestimated extremes significantly while the three parameters rayleigh distribution and three parameters weibull distribution gave reasonable results cheng and kuang 2016 applied the gumbel model weibull model and winterstein jensen model to estimate the extreme responses of a spread moored fpso system in 250 m 500 m and 1000 m water depth the gumbel model sample consists of ten maximum values in 3 h which were obtained by the numerical simulations with random seed number the top 80 peaks were fitted by a weibull model to calculate the 3 h mpmes it was found that the gumbel method always provided consistent values and the results of weibull model and winterstein jensen model could be divergent recently a composite weibull distribution model was developed to predict the extreme mooring tension with snap loads considered hsu et al 2017 the acer method which is developed by naess and gaidai 2009 is a powerful method in extreme value estimation one of the advantages of this method is that the prediction is not sensitive to the threshold the exceedance rate is determined on the basis of cascade of conditional approximations it has been successfully implemented in wind speed and structure dynamic extreme values analysis naess et al 2013 2012 2010 naess and gaidai 2008 øiseth et al 2014 saha and naess 2010 and the accuracy was validated recently a bivariate acer method was developed to evaluate the extreme large cargo ship panel stresses gaidai et al 2016 other applications of the acer method to ship panels can be found in gaspar et al 2012 2014 xu et al 2018 applied the acer method to study extreme mooring tension reliability peak over threshold pot method is another efficient method pickands 1975 which is widely used in extreme value analysis such as extreme significant wave height analysis ferreira and guedes soares 1998 campos and guedes soares 2016 orimolade et al 2016 campos et al 2019 floating wind turbine extreme load analysis dimitrov 2016 ding and chen 2014 ragan and manuel 2008 toft et al 2011 wang 2017 wang et al 2013 this method is applied based on two assumptions first the sample global maxima satisfy the generalized extreme value gev distribution and the upcrossings over the threshold are poisson and the exceedance are independent one of the difficulties in applying this method is to select the appropriate threshold and make sure upcrossings over threshold are poisson and the exceedance are independent since too high threshold level may lead to the insufficient peaks to obtain statistic convergence while too low threshold level would include the points which do not follow tail probability model besides it is not easy to judge if the upcrossings over the threshold are poisson or not recently an optimal threshold searching method was proposed by using declustering algorithm and the dispersion index wang 2017 there are other alternatives to pot approach such as described in guedes soares and scotto 2004 scotto and guedes soares 2007 dong et al 2013 and petrov et al 2019 however the pot is presently a more widely used method so this will be the choice for this work another difficulty is the parameters estimation the l moments method which was developed by hosking 1990 can be defined for any random variables whose expected value exists the main advantage of this method is that it is much more robust to the existence of outliers than conventional moments and are very efficient and accurate for small sample which makes the l moments to be a very desirable choice for extreme value analysis lucas et al 2017 izadparast and duggal 2013 izadparast and niedzwecki 2010 pandey and van gelder 2001 the extreme responses of floating systems are the main concerns of ultimate limit states uls design which need to be estimated precisely and effectively the optimal pot method combined with extrapolation approach is applied for predicting the short term extreme vessel surge motion and mooring tension this approach has not yet been applied to study extreme mooring tension in the literature to the authors best knowledge besides to simplify the analysis procedure the empirical thresholds for extreme surge and mooring tension analysis are studied which are also not to be seen in the literature related to extreme mooring tension analysis the effects of threshold ensemble size and simulation durations on extreme values are discussed the suitable durations for extreme mooring tension analysis are given first furthermore the suitable distributions for excess points are discussed where the distribution parameters are fitted by the efficient l moments method and maximum product of spacing method mps method in addition to the pot method the sophisticated acer method is also used to study the 3 h extreme vessel surge motion and mooring tension the accuracy of extrapolation methods is then checked by the global maximum method 2 fully coupled dynamic analysis and model descriptions the fully coupled dynamic analysis is implemented in deepc to obtain the platform six degree of freedom dof motion responses and mooring tensions the governing equation is written as marintek 2015a 1 m a x c 1 x c 2 f x k x 0 t h t τ x τ d τ q t x x where m is the body mass matrix a is the infinite added mass matrix c 1 is the linear damping matrix c 2 is the quadratic damping matrix k is the stiffness matrix f is the vector function the element is given by 2 f i x i x i h τ is the retardation function which is computed by the frequency dependent added mass and damping transformation 3 h τ 1 π 0 c ω cos ω τ ω a ω sin ω τ d ω the right side of eq 1 is given as 4 q t x x f w f m where f w is the wave force f m is the mooring tensions the finite element method is applied to analyse mooring dynamics the governing equation of mooring dynamics is expressed as marintek 2015b 5 r i r r t r d r r t r s r t r e r r t where r i is the inertial force vector r d is the damping force vector r s is the inertial structure reaction force r e is the external force vector which accounts for weight and buoyance hydrodynamic drag force the newmark beta implicit integration method is applied to solve the eq 1 the relations between displacements velocity and acceleration vectors at time t and t δt are represented by 6 x t δ t x t 1 γ x t δ t γ x t δ t δ t 7 x t δ t x t x t δ t 0 5 β x t δ t 2 β x t δ t δ t 2 the fully coupled dynamic analysis is carried out to study a six generation deepwater semi submersible hysy 981 operates in south china sea and the main dimensions of this platform are shown in table 1 the irregular wave was modelled by the jonswap wave spectrum with a significant wave height 13 7 m a peak period of 16 s and a peak enhancement factor of 2 and only the head sea condition was considered the semi submersible which is moored by two hybrid mooring systems tmf and tmbf in 200 m water depth is numerically studied the dynamics of platform mooring system will be analysed by fully coupled dynamic analysis single tmf mooring line is composed by wire and five clump weights the clump weights which are installed on the end part of mooring line with the uniform distance and the weight decreasing from top to seafloor while the construction of tmbf is similar to tmf except for an additional buoy being fixed on the top region of mooring line the schematic of tmbf is shown in fig 1 the main parameters mooring line model are given in table 2 where ww is the submerged weight per unit length r is the mooring radius as described above five clump weights are installed on each mooring line these weights are attached on the last 100 m of mooring line with uniform distance of 20 m the position of cylinder buoy is 40 m away from fairlead the weight of each clump weight is given in table 3 where cwa is the weight in air cwm is the submerged weight the net buoyancy of buoy model is 196 kn the tangential and normal drag coefficients of mooring line were 0 6 and 1 85 and the inertial coefficients in tangential and normal directions were determined as 1 4 and 1 8 respectively in the numerical simulations xu et al 2018b as shown in fig 2 the mooring system comprises of 12 mooring lines which are arranged symmetrically and divided into four groups the azimuth angles between mooring line and x axis in one group are 250 450 650 the coordinates of fairleads in model tests are given in table 4 the origin z coordinate starts from the baseline the experimental study of these two systems are given in xu et al 2018a 2018b and the accuracy of numerical models have been validated in xu et al 2018b 3 global maximum method the global maximum method is a very accurate approach to estimate extreme value only the maximum value in the concerned duration is extracted from each individual simulation the obtained peaks are uncorrelated and independent as a consequence the extracted maximum values from an ensemble of simulations are assumed to satisfy the gumbel distribution generally the size of samples included in ensemble should be greater than 20 since the 3 h extreme value is interested in ocean engineering in this paper 50 3 h fully coupled dynamic analysis are carried out with different seed number the maximum surge response amplitude and mooring tension of each simulation are extracted and fitted to the gumbel distribution the cumulative distribution function of gumbel distribution is 8 f x μ l β l exp exp x μ l σ l where μ l is the location factor σ l is the scale factor the most probable maximum extreme mpme value which is the mode value has a 63 2 chance to be exceeded will be used as benchmark and compared to results of other extrapolation methods for the gumbel distribution this mpme is calculated as 9 x mp μ l β l ln ln f 1 0 632 μ l 4 extrapolation methods 4 1 acer method the acer method was proposed by naess and gaidai 2009 which calculates the exceedance probability on the basis of cascade of conditional approximation suppose over a time interval 0 t the stochastic process has n observations x 1 x n in the discrete times t 1 t n the goal is to accurately determine the distribution function of the extreme value m n max x j j 1 n specifically the value of p η prob m n η is the estimation of large values of η the definition of p η follows 10 p η prob x 1 η x n η prob x n η x 1 η x n 1 η prob x 1 η x n 1 η j 2 n prob x j η x 1 η x j 1 p x 1 η by assuming that all the x j are statistically independent the p η is approximated as 11 p η j 1 n p x j η the conditional exceedance probability is defined as 12 α k j prob x j η x j k 1 η x j 1 η where α kj denotes exceedance probability conditional on k 1 previous non exceedances assuming that the conditional exceedances events are independent and following a poisson process the extreme value distribution can be approximated as 13 p k η exp j k n α k j η where j k n α k j η is the expected effective number of independent exceedances provided by conditioning on k 1 previous observations the conditional average exceedance rate aer is defined as 14 ε k 1 n k 1 j k n α k j η k 1 2 for both stationary and non stationary time series the sample estimate of acer would be 15 ε ˆ k η 1 m m 1 m ε ˆ k m η where m is the number of samples index m refers to realization no m assuming the samples are independent the 95 confidence interval ci for acer is given as 16 ci η ε ˆ k η 1 96 s k η m where s k η is the standard deviation of ε ˆ k η 17 s k η 2 1 m 1 m 1 m ε ˆ k m η ε ˆ k η 2 assuming the mean exceedance rate in the tail is dominated by an exponential function it is approximated as 18 ε k η q k η exp a k η b k c k η η 1 where a k b k c k and q k are the parameters related to k η 1 equals to threshold the parameters a b c and q are determined by minimizing the following mean square error function with respect to all four arguments 19 f a b c q j 1 r w j log ε k η j log q a η j b c 2 where η 1 η r denotes the levels where acer function has been estimated w j denotes a weight factor it is given as 20 w j log c η j log c η j θ θ 1 or 2 in this study θ 2 is used the four parameters optimization problem can be simplified as two parameters by expressing a q in terms of b and c saha et al 2014 21 z j log ε k η j 22 y j η j b c 23 a b c j 1 r w j y j y z j z j 1 r w j y j y 2 24 log q b c z a b c y 25 y j 1 r w j y j j 1 r w j z j 1 r w j z j j 1 r w j now eq 19 is written as 26 f b c f a b c b c q b c to improve the robustness of results some constrains are applied 27 0 c 5 min x j b η 1 0 q 0 a the levenberg marquardt method is applied to solve eq 26 and find b c then a and q are calculated by substituting b and c to eqs 23 and 24 in order to estimate the confidence interval of the predicted return value provided by the optimal curve the empirical confidence band is re anchored to the optimal curve once the ε k η is determined the probability is calculated according to eq 13 the acer method was then developed by using matlab r2016 4 2 the peak over threshold method the pot method is based on generalized pareto distribution gpd under the assumption that the parent distribution belongs to the domain of attraction of one of the extreme value distributions and the excess values above threshold follow the gpd pickands 1975 by choosing the threshold level sufficiently high multiple important crests over threshold are extracted it is assumed that the exceedances are independent and pot are poisson then the selected peaks are fitted to the extreme value distribution generally the generalized pareto distribution gpd is the preferred model for pot however it was pointed out the three parameters weibull is a better choice dimitrov 2016 ragan and manuel 2008 in this paper the gpd weibull distribution and generalized extreme value distribution gev are applied to fit pot statistical characteristics the 3 h extreme values predicted by different methods are compared and discussed 4 2 1 optimal threshold selection and declustering since the distribution parameters are very sensitive to the threshold level it is necessary to take great care to choose the threshold value there are several methods available to determine threshold one of the generally used method is the mean residual life plot for the gpd distribution the mean exceedance over a level u is 28 e x u g x u g σ g ξ g u g 1 ξ g σ g ξ g u g 0 where σ g and ξ g are the scale and shape factor it is found that the mean exceedance is a linear function of u g by plotting mean exceedance against to the u g the proper u g value can be selected ragan and manuel 2008 proposed a procedure to search optimal threshold it was implemented by defining a series of spaced ranges of thresholds and the distribution parameters of pot are fitted for each threshold case the optimal threshold is determined when the loads from fitted distribution have the lowest mean square error with respect to the observed data at the same fractiles dimitrov 2016 presented a similar procedure to select optimal threshold by plotting the root mean square error of empirical data relative to the load predicted by gumbel distribution to the threshold the point where the root mean square error stops being monotonically decreasing was a proper choice for tail threshold level it is noticed that the pot method relies on two assumptions the selected peaks are poisson distributed and the exceedances should be approximately independent sometimes extreme values have a tendency to cluster declustering algorithm can be applied to identify the largest value in each of the clusters liu and bergdahl 1998 in this study the dispersion index is applied to select clusters and check the poisson character wang et al 2013 the dispersion index which is the ratio between the variance and expectations of the number of peak 29 d i σ e 2 μ e where σ e 2 is the variance of numbers of exceedances in the declustering period t b μ e is the mean number of exceedances in a fixed period t b in this study t b is set as equal to the response spectral peak wang 2017 30 t b 2 π s ω 4 d ω ω s ω 4 d ω the threshold value is determined by searching suitable dispersion index brodtkorb et al 2000 wang 2017 31 χ α 2 r 1 2 r 1 d i χ 1 α 2 r 1 2 r 1 where χ2 denotes the chi square distribution r is the total number of de clustering period α is the significant level χ2 α 2 r 1 is defined as the upper 100 α 2 percentage point of a chi square random variable u with r 1 degrees of freedom thus probability that χ2 exceeds this value is α 2 in detail 32 p χ 2 χ α 2 r 1 2 χ α 2 r 1 2 f u d u α 2 in this study the optimal threshold level is determined according to declustering algorithm in wafo brodtkorb et al 2000 4 2 2 generalized pareto distribution the gpd was first presented by pickands 1975 and the maximum of independent gpd variables has a gev distribution mathematically the cumulative distribution function gpd is defined as 33 f x μ g σ g ξ g 1 1 ξ g x μ g σ 1 ξ g ξ 0 1 exp x μ g σ g ξ 0 where the parameters μ g σ g and ξ g are the location scale and shape factor respectively 4 2 3 weibull distribution the cumulative distribution of three parameters weibull distribution is defined as 34 f x μ w σ w ξ w 1 exp x μ w σ w ξ w where the parameters μ w σ w and ξ w are the location scale and shape factor respectively 4 2 4 generalized extreme value distribution the cumulative distribution of gev is defined as 35 f x μ v σ v ξ v exp 1 ξ v x μ v σ v 1 ξ v where the parameters μ v σ v and ξ v are the location scale and shape factor respectively shape parameter ξ v governs the tail behaviour of the distribution for ξ v 0 the distribution corresponds to gumbel distribution 36 f x μ v σ v 0 e e x μ v σ v f o r x for ξ v 0 it corresponds to fréchet distribution 37 f x μ v σ v ξ v e y α y 0 0 y 0 where ξ v α 1 0 y 1 ξ v x μ v σ v for ξ 0 the mathematic form of cumulative distribution is 38 f x μ v σ v ξ v e y α y 0 0 y 0 where ξ v α 1 0 y 1 ξ v x μ v σ v 4 2 5 return value the relation between exceedance probability and return period λ is 39 λ 1 ζ prob x x r where ζ is the mean exceedance rate of threshold u which is calculated as 40 ζ n u t where n u is the number of data points above the threshold t is the duration of simulation the unit of t and λ should be identical then the probability of non exceedance can be presented as 41 pr o b x x r 1 1 λ ζ finally the return value x r can be obtained by calculating the quantiles of the given return period for the gpd distribution x r is written as 42 x r μ g σ g 1 λ ζ ξ g ξ g ξ g 0 μ g σ g ln λ ζ ξ g 0 for the weibull distribution x r is given as 43 x r μ w σ w ln λ ζ 1 ξ w for the gev distribution x r is 44 x r μ v σ v ξ v ln 1 1 λ ζ ξ v 1 ξ v 0 μ v σ v ln ln 1 1 λ ζ ξ v 0 5 estimation of distribution parameters 5 1 the l moments method l moments are linear combinations of probability weighted moments and they have been successfully developed for parameter estimation hosking 1990 the main advantage of l moments is that they are robust to the existence of outliers in the data and the bias are fairly small even for small samples besides it is much more efficient compared to other traditional techniques such as maximum likelihood method especially for small samples these advantages make l moments a good choice for parameters estimations of pot distributions since outliers may occur and sometimes the pot sample is relatively small recently the l moments method is widely used for extreme value analysis in different areas such as wave crest mooring and riser extreme value estimation cheng et al 2010 izadparast and niedzwecki 2009 liu and bergdahl 1998 the probability weighted moment is defined as 45 β r 0 1 x p p r d p where p is the probability for value x the first four l moments are defined as 46 λ 1 β 0 47 λ 2 2 β 1 β 0 48 λ 3 6 β 2 6 β 1 β 0 49 λ 4 20 β 3 30 β 2 12 β 1 β 0 usually the random sample is used to estimate l moments the sample x is first ordered as 50 x 1 n x 2 n x n n where n is the sample size the unbiased estimator of β r is calculated by the following formula 51 b r n 1 n 1 r 1 j r 1 n j 1 r x j n and the notation in the brackets denotes binomial coefficients for example 52 r j r j r j specifically 53 b 0 1 n j 1 n x j n 54 b 1 1 n j 2 n j 1 n 1 x j n 55 b 2 1 n j 3 n j 1 j 2 n 1 n 2 x j n in general 56 b r 1 n j r n j 1 j 2 j r n 1 n 2 n r x j n the first four l moments are written as 57 l 1 b 0 58 l 2 2 b 1 b 0 59 l 3 6 b 2 6 b 1 b 0 60 l 4 20 b 3 30 b 2 12 b 1 b 0 the sample l moment l r is defined universally 61 l r 1 j 0 r p r j b j r 0 1 n 1 where 62 p r j 1 r j r j r j j 1 r j r j j 2 r j the sample l coefficient of variation is 63 t l 2 l 1 the sample l skewness is 64 t 3 l 3 l 2 the sample l kurtosis is 65 t 4 l 4 l 2 5 1 1 gumbel distribution by applying the l moments method the scale and location factors are defined as bílková 2014 66 σ l l 2 ln 2 μ l l 1 γ σ l where γ is the euler s constant 5 1 2 generalized pareto distribution the three parameters of the gpd can be estimated by using three samples l moments pandey et al 2001 67 ξ g 3 t 3 1 t 3 1 σ g 1 ξ g 2 ξ g l 2 μ g l 1 2 ξ g l 2 for case when the location factor is fixed the first two l moments can be used to estimate the other two parameters pandey and van gelder 2001 68 ξ g 2 l 1 μ g l 2 σ g 1 ξ g l 1 μ g 5 1 3 weibull distribution the l moments and their ratio for a weibull distribution are goda et al 2010 69 λ 1 μ w σ w γ 1 1 ξ w 70 λ 2 σ w 1 2 1 ξ w γ 1 1 ξ w 71 τ 3 3 2 1 3 1 ξ w 1 2 1 ξ w 72 τ 4 5 1 4 1 ξ w 10 1 3 1 ξ w 6 1 2 1 ξ w 1 2 1 ξ w where γ denotes the gamma function the parameters are estimated by applying the sample l moments goda et al 2010 73 ξ w 285 3 t 3 6 658 6 t 3 5 622 8 t 3 4 317 2 t 3 3 98 52 t 3 2 21 256 t 3 3 516 74 σ w l 2 1 2 1 ξ w γ 1 1 ξ w 75 μ w l 1 σ w γ 1 1 ξ w 5 1 4 generalized extreme value distribution the parameters of gev are estimated by applying the l moments method bílková 2014 76 ξ v 7 8590 ν 2 9554 ν 2 77 σ v l 2 ξ v 1 2 ξ γ 1 ξ v 78 μ v l 1 σ v γ 1 ξ v 1 ξ v where 79 ν 2 3 t 3 ln 2 ln 3 5 2 the maximum product of spacing method the mps is another efficient method for parameters estimation and this method has a high asymptotic efficiency ranneby 1984 the independent and identically distributed iid sample x 1 x n with the cumulative distribution function f x θ 0 θ 0 are the distribution parameters need to be estimated the sample is first transformed to the ordered sample x 1 x n the spacing is defined as gaps between the values of the distribution function at adjacent ordered points 80 d i θ f x i θ f x i 1 θ i 1 n 1 then the maximum spacing estimator of θ 0 is defined as a value that maximizes the logarithm of the geometric mean of sample spacing 81 θ ˆ arg max θ θ u n θ where 82 u n θ 1 n 1 i 1 n 1 ln d i θ 6 estimation of 3 h extreme response for the extreme value analysis multiple realizations are needed to consider the uncertainty of wave train generally the number of realizations should be greater than 20 in this paper 50 fully coupled dynamic simulations are carried out for each mooring system with different seed number to consider random wave train the global maximum method will be first carried out to predict the 3 h extreme mooring tension and platform surge response for both mooring systems the extreme values calculated by global maximum method are used as the benchmarks then the extrapolation methods including acer and pot method based on ensemble pot method based on twenty individual realizations will be carried out to study the extreme responses of tmbf system some meaningful suggestions and results will be given finally the 3 h extreme values of tmf system are obtained by applying the refined extrapolation method from above discussions the results are then compared with tmbf system to discuss the influence of buoy on system short term extreme responses in the head sea condition the 1 mooring line is the most loaded one as a consequence our study concerns the fairlead tension of 1 mooring line the time series and response spectra of tmbf surge motion responses as well as mooring tension for the first seed number are shown in figs 3 and 4 respectively it can be clearly seen that both the surge motion and mooring tension are dominated by low frequency component the plots of kurtosis and skewness for tmbf surge motion and mooring tension are given in fig 5 it indicates that mooring tension exhibits a strong non gaussian nature due to strong nonlinearity comparatively speaking the surge motion is closer to gaussian than mooring tension 6 1 the gumbel method the maximum surge response amplitudes and mooring tensions of each 3 h simulations are plotted in figs 6 and 7 it can be seen the maximum values vary significantly with the seed number which demonstrates that the system dynamics are sensitive to the wave train and it is necessary to predict extreme value by considering different seed number the parameters of gumbel distributions are fitted by l moments method according to the 50 maximum response values to diagnose the accuracy of fitted gumbel distributions residual probability plot as well as residual quantile plot of maximum tmbf system dynamics are given in fig 8 in these figures it is observed that most points distribute along the reference line despite the discrepancies of the tail points it indicates that the estimated gumbel distributions match well to the empirical data the goodness of fits plots for tmf are similar to tmbf and will not be presented in this study for further study up on the accuracy of l moments method the mpmes predicted by the model fitted with l moments are compared with the values estimated by the model fitted by maximum likelihood estimation the results are given in table 5 where l refers to l moments ml is the maximum likelihood estimation ci is the 95 confidence interval which is evaluated by non parametric bootstrapping technique the size of bootstrapping sample is 10 000 as shown in table 5 the values predicted by these two methods are in good agreement which verifies the l moments method is a good choice to estimate gumbel parameters in the following study the mpmes estimated by gumbel distribution are acted as the benchmarks and the parameters are estimated by the l moments method 6 2 extrapolation methods based on ensemble as described above the acer method extrapolates extreme values on the basis of ensemble typically more than 20 realizations should be included in one ensemble in this study the effects of threshold on estimations of return levels by acer method and pot method are studied then the influence of ensemble size as well as the time duration on estimated extreme values are evaluated to check the accuracy the extreme values predicted by extrapolation methods are compared with the mpmes from gumbel distribution 6 2 1 effect of threshold in this section the ensemble which includes 20 realizations and each realization has 20 min duration with first 200s transient results neglected are used for extreme value analysis before carrying out the acer method it is essential to determine the k value fig 9 highlights the cascade of conditional acer estimates for different k values it can be seen that there are no substantial differences between different k values for both surge motion and mooring tension subsequent conditioning on more than one peaks does not cause clear differences of acer values k is chosen to be 3 in the further study to investigate the influence of threshold η 1 on the extreme value estimation of acer method different η 1 values are discussed 83 η 1 μ x n m σ x where μ x and σ x are the mean value and standard deviation of ensemble respectively the effects η 1 on 3 h extreme motion response are shown in fig 10 according to fig 10 no distinguishing differences between 3 h extreme surge motion response can be found by modifying the η 1 it indicates that the extreme surge motion is not very sensitivity to the η 1 which agrees with the results of naess et al 2013 for a better presentation of effects of η 1 the results are given in table 6 where the 95 ci are estimated according to eq 16 with m equals to 20 in table 6 it is observed that for all discussed nm values the 3 h extreme surge mainly stay in the similar level which equals to 28 m and are very close to the reference result and nm 2 is a proper choice the effects of threshold on 3 h mooring tension extreme value are studied and the results are shown in fig 11 and meanwhile table 7 shows the corresponding results for better comparisons a similar finding can be observed which is the effect of η 1 on 3 h extreme mooring tensions is negligible however the effect of η 1 is notable for the long return period overall it can be seen that the acer method provides very good estimations for 3 h extreme values for both surge motion and mooring tension which confirms that the accuracy of acer method for predicting extreme floating structure responses is good enough in this study the η 1 is set as μ 1 1σ for both surge motion and mooring tension one may argue that the nm should chose a relatively large value to obtain a good estimation of extreme mooring tension according to table 7 however it should be noticed that a high threshold means that most of empirical acer values are similar which may lead to instability of numerical optimization fitting one of the most essential parts in pot method is to determine the suitable threshold some detail procedures for searching suitable threshold can be found in extreme significant wave analysis pickands 1975 in the extreme wind turbine load analysis several different optimal threshold selecting methods were presented dimitrov 2016 ragan and manuel 2008 besides the empirical value which equals to μ 1 4σ is suggested by moriarty et al 2004 for extreme wind turbine loads analysis the accuracy of adopting the empirical value for extreme wind turbine loads analysis was validated toft et al 2011 in this study the threshold is first determined by an optimization method and the extreme values estimated by applying this threshold will be compared with the predicted results of other empirical thresholds the dispersion index plot of tmbf surge responses is shown in fig 12 the threshold is determined as 18 7 m then the gpd three parameters weibull and gev model are applied to fit pot by l moments method the 3 h extreme surge responses predicted by different threshods are shown in table 8 where u is the optimal selected threshold and the 95 ci is estimated by non parametric bootstrapping technique it can be found that the number of pots are reduced dramatically with threshold increasing however the estimated extreme surge responses are not very sensitivity to the threshold the values change slightly with the thresholds and are close to the benchmark estimated by global maximum method the extreme values estimated by gpd are close to weibull for all discussed thresholds while the results of gev are not as good as the other two distributions however the differences between them are reduced with the threshold increasing it suggests to set the threshold as μ 1 4σ to be the empirical value for predicting extreme surge responses which gives the most accurate extreme value the procedure of analysing the effects of threshold on mooring tension is the same to the discussion of extreme surge motion the dispersion index plot is given in fig 13 the 3 h extreme mooring tensions estimated by applying different empirical thresholds are given in table 9 similar to extreme surge responses it is seen that the extreme mooring tension is not sensitive to the threshold and the predicted extremes are very close to the benchmarks however the model adopts the optimal threshold gives the best predictions while the empirical value is recommended as μ σ according to the comparisons with benchmarks besides the extreme value estimated by gpd are very close to the weibull estimations the gev model overestimates the extreme tension considerably if a low threshold is adopted however it provides accurate result if the threshold is high enough 6 2 2 effect of sample numbers and duration the ensemble size as well as the duration for each simulation are closely related to the extreme value estimations in the wind turbine studies it is suggested to adopt 10 min durations for estimating 1 h extreme values dimitrov 2016 moriarty et al 2004 saha et al 2014 wang 2017 however for the floating production systems the 3 h extreme value is interested besides the study of the effect of ensemble size as well as duration on the estimation of floating production systems extreme value are not found in this study the ensemble with 20 30 and 50 realizations and each realization with three different durations 10 20 and 30 min will be analysed the realizations are randomly selected without replacement in figs 14 17 the results of parametric estimation of the 3 h return values and corresponding 95 ci for different sample sizes and durations by applying acer method are shown for a better presentation the extreme surge motions estimated by acer method as well as pot method with optimal threshold are given in table 10 where it is seen that all the calculated extreme values are not very sensitive to the sample size and duration especially for the gpd and weibull model for 10 min duration cases it can be seen that the extreme surge motion is reduced and then increased slightly when sample size increases from 20 to 50 as for the 20 min cases the extreme surge motion is reduced slightly with ensemble size increasing this interesting phenomenon can be found for both acer and pot method besides the acer method gpd and weibull model give very good predictions for 3 h surge motion return value as for the gev the results are acceptable but slightly poorer than other methods it is found that the ensemble with 20 realizations and each realization with 20 min durations is a good choice for predicting 3 h surge motions the results of extreme mooring tension are given in table 11 the influence of ensemble size and sample duration on extreme mooring tension are similar to the results of extreme surge motion discussed above the suitable choice is the ensemble of 20 realizations and each realization with 20 min durations the 20 realizations with 10 min durations may be also a good choice which estimates the extreme values accurately and costs less time however it is noticed that return level extracted from 10 min durations are more sensitive to the number of sample compared with 20 min simulation 6 3 pot method based on individual sample in the above study the pot method is carried out by combining the realizations with different seed number into one ensemble and then applying the optimization method to select the optimal threshold and declustering the pot in the following study the applicability of using multiple individual sample to predict extreme values will be studied twenty samples are used in this section then the pot method is applied to each sample and the average of these twenty extreme values is determined as the final 3 h return value 6 3 1 effect of parameters estimation method twenty realizations are selected randomly and the durations for each realization are 20 min the optimal pot method is applied to each sample to obtain extreme responses then the l moments and mps method are used to fit the parameters of gpd weibull and gev distributions the predicted extreme surge response and mooring tension values are shown in tables 12 and 13 respectively according to the results it is seen that mps method overestimates extreme values dramatically except for weibull model besides all the models fitted by l moments methods provide satisfactory results however it is found that the extreme value is fluctuated greatly for each seed number the gpd is the best choice while gev model always overestimate the return levels in the following study the l moments will be implemented in the pot method 6 3 2 effect of threshold the study of effect of different threshold values on 3 h extreme surge motion and mooring tension is carried out unlike the ensemble method here the pot method is applied to each realization in other word the number of data points is relatively small and the pot method could be failure if high threshold is used since the size of pot sample may be not large enough to fit a model properly to reveal this problem the pot plots for surge motion and mooring tension are shown in figs 18 and 19 for a random selected simulation id 44 in these two figures u is the optimal threshold μ and σ are the mean value and standard deviation of corresponding 20 min realizations the first 200s transient results are neglected in the head sea the maximum surge amplitude locates in x axis the fig 18 plots negative surge motion x for comparing conveniently it is seen that the number of pots is reduced significantly for both surge motion and mooring tension and the empirical value μ 1 4σ is not suitable in this case the 3 h extreme value and corresponding 95 ci for surge motion and mooring tension are given in tables 14 and 15 respectively and the 95 ci is calculated according to eq 16 both gpd and weibull present good estimation for 3 h return surge level while the gev model overestimates the extreme surge motion slightly as for the extreme mooring tension it is observed that the gpd is the best choice weibull model underestimates extreme value slightly however it still gives satisfactory estimations while gev overestimates the extreme mooring tension considerably besides it is found the estimated return levels are increasing with threshold overall the μ 0 5σ is recommended as suitable empirical value 6 3 3 effect of duration the ensemble with two different durations i e 20 and 30 min durations are discussed and the ensemble size is kept as 20 identical to table 14 as shown in tables 16 and 17 the influence of time durations on extreme values are limited for all discussed models the 20 min durations are suggested since it is accurate enough to estimate extreme responses besides it is more efficient than the case with 30 min durations 6 4 discussion of the results of two mooring systems in this section the extreme tmf surge and mooring tension are studied by applying the extrapolation procedures discussed above the results are compared with tmbf extreme values to discuss the differences between these two systems the acer plots of tmf are given in fig 20 and the 3 h return levels from different method are given in tables 18 and 19 as shown in table 18 both the acer method and pot method provide very good estimations to extreme surge values for pot method the gev model underestimate extreme level slightly besides it is found that the extreme surge motion of tmbf is slightly greater than tmf which is explained that the mooring restoring force is reduced once the buoys are installed similar to the results of surge motion response the extreme mooring tension are well estimated for all discussed methods however in contrast to the extreme surge response the extreme mooring tension is overestimated by gev model besides the extreme mooring load reduction is found by adding buoys to tmf mooring lines based on twenty individual realizations the pot method is used to predict extremes of tmf system and the average of these twenty extremes are acted as the final results the results are given in table 20 where it is showing that the gev is not suitable for extreme value analysis in this situation which overestimates the extreme tensions of both systems and tmbf surge motion considerably the gpd and weibull give similar estimations which overestimate the extreme surge motions slightly however gpd model presents very accurate estimation in extreme mooring tension while the underestimations can be found in weibull model for both tmf and tmbf 7 conclusions this paper studies several methods for estimating the short term extreme responses of semi submersible systems moored by two hybrid mooring systems a sample of 50 global maximum surge responses and mooring tensions are used as the observations of gumbel distribution the mpmes predicted by gumbel distribution play the role of benchmark values which are 28 8 m 4661 4 kn for surge and mooring tension respectively of tmbf system while these two values are 27 4 m and 4725 7 kn for tmf system the extrapolation methods including acer method and pot method are applied to estimate short term values based on the ensemble it is found that the extreme values predicted by acer method are not sensitive to the threshold the optimal threshold as well as empirical thresholds are studied to discuss the effects of threshold on short term extremes estimations it is found that both the extreme surge and mooring tension are not very sensitive to the discussed thresholds and μ 1 4σ is recommend as the empirical threshold to study extreme value of surge motion while the empirical threshold is suggested to be μ σ for mooring tension in these certain cases the ensemble size as well as realization duration could affect the estimated extreme values of all methods more or less the ensemble with 20 realizations and the duration sets as 20 min seems to be a suitable choice the method to take the average extreme value of 20 realizations as the finial extreme response is studied it is found that the mps method is not suitable for estimating extreme values for this method which could induce a significant error while the l moments method shows good performance besides the large empirical threshold may lead to the failure in the application of this method due to the insufficient number of pot the empirical threshold is suggested to be μ 0 5σ for both surge response and mooring tension furthermore by enlarging the duration from 20 min to 30 min does not help improving the accuracy of estimation however it should be noticed that obvious fluctuations of extreme values can be found for realization with different seed number overall the acer method as well as optimized pot method combined with gpd model and weibull model provide very good estimation of short term extreme value of surge motion and mooring tension the results of gev model are satisfactory but it is not the best choice which underestimates extreme surge motion slightly while the opposite results can be found in extreme mooring tension estimations while the gpd model shows better performance than the other two models the method by averaging extreme values of individual realization overestimates the extreme surge motion slightly however the extreme mooring tension is well estimated by gpd model by comparing the extreme values of these two mooring systems it is found the installed buoys help to reduce maximum mooring tension acknowledgement the work of the first author has been funded by the strategic research plan of the centre for marine technology and ocean engineering centec which is financed by the portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uid multi 00134 2013 lisboa 01 0145 feder 007629 gs2 the second author gratefully acknowledge financial support from the national natural science foundation of china grant no 51379092 which has made the experimental work possible 
22458,in the paper we study the problem of vibration control for offshore platform in nonideal network environment under wave and current forces based on the modified transformation we consider the wave and current synchronously and give a dynamical system for the outside loads the problem of time delay packet dropouts and disordering due to nonideal network are taken into account in the networked control model two buffers output the received packets according to time stamps and upper bound of time delay based on a transformation we reduce the time delay system into an equivalent delay free system taking the nonideal network communication conditions into account we design a modified transformation based on the past time data wave and current loads and received packets through network at current time the networked controller is presented to depress the vibration of structure in nonideal network communication environment based on the modified transformation an algorithm is given to simplify the computation of control law by recurrence the system stability under presented networked controller is analyzed based on lyapunov functional through the simulation results and comparison with other networked controllers we can see that the presented controller can reduce the oscillation of offshore platform effectively keywords networked system time delay dropouts offshore platform wave and current forces modified transformation 1 introduction in the modern world more and more oil and gas are drilled by offshore platforms due to the wave current wind and earthquake continual vibration of the offshore platforms affects the safety of structures to keep the structures healthy and high efficiency of production vibration control is a critical problem to be studied li et al 2003 ma et al 2006 zhang et al 2014a 2014b for the harsh ocean environment the remote monitoring and distributed control by using of network have attracted more and more attention in the recent decades and it is one of hot topics in control engineering agarwal and kishor 2014 wang et al 2018 zhang et al 2019a for networked control systems ncss different parts of control system are connected by network mo et al 2017 peng and han 2016 qiu et al 2018 in ncss we can complete distributed computation and system maintenance more effectively however the decrease of system performance due to time delay packet dropouts and disordering are inevitable in the networked system in recent decades there are fruitful results of the modeling and controller designing for ncss jungers et al 2018 park et al 2018 the ncss have been widely applied in the engineering and daily life for example the unmanned marine vehicles wang and han 2018 mobile robot networks lu and han 2019 sample data system ge et al 2018 and intelligent traffic system zhang and zhou 2018 as an important application the networked control for offshore platform have attracted more attention in recent years due to the severe ocean environment and large structure of offshore platform the sensors controller and actuator are not suitable to be fixed in same place as in traditional point to point control then the distributed network model can connect the control system efficiently however the severe ocean and work conditions make the network for offshore platform more unstable than network communication on land dinh et al 2017 therefore the problems and limitations of network communication should be considered carefully in the designing of networked control for offshore platforms zhang and han 2014 for the vibration control of jacket type offshore platform with time delay in sensor controller channel event triggered networked controllers are presented zhang et al 2016 based on the two channel and two buffer network system model for offshore platform the problem of time delay packet dropouts and disordering are solved by networked predictive feedforward and feedback optimal control ma et al 2019 briefly the networked control systems of offshore platforms bring more challenge items than that on land then we should pay more attention to the forward and backward network channels the real time data transmitted by network and the complementation of the networked controller considering the need of distributed computation the controller actuator network channel should be studied with the sensor controller channel synchronously and one can get two network channel model of ncss ma et al 2016 sun et al 2019 for stochastic systems active artificial delay in control is designed in network based h feedback controllers zhang and han 2015 and for a packet based networked control system a dual rate pid controller is presented alcaina et al 2019 considering the asynchronous data transmission predictive control is another kind of designing method in ncss li et al 2019 predict and select the future control values according to the time delays between controller and actuator for the t s system the event triggered control law is designed based on the prediction of control packets peng et al 2018 for dynamic stabilization of a dc microgrid the fuzzy model predictive control synthesis of networked controlled power buffer is investigated vafamand et al 2019 in recent years the controllers with considerations of time delay and packet dropouts are proposed more and more in literature li and chen 2019 jiang et al 2008 wu and lu 2018 buffers are widely adopted in network system li et al 2017 based on the received data in buffers the delayed lost or future information of control system can be modeled hamdan and mahmoud 2018 to reduce the size of buffers adaptive buffers are designed by using of adaptive grey fuzzy cognitive map technique dinh et al 2018 to save computation and limited network resources event triggered scheme has been widely adapted zhang et al 2017 generally speaking the event triggered control system consists of feedback controller and event trigger for the nonlinear systems the robust event triggered controller is completed by using of reinforcement learning method yang et al 2019 for the software defined networking a distributed sdn controller is proposed to provide maximum flexibility for event triggered control kohler et al 2018 to deal with the problem of time delay transformation based control is a useful approach for linear time invariant systems with distinct input delays artstein 1982 tsubakino et al 2016 the method has been applied in the point to point vibration control of offshore platform to design feedback and feedforward optimal control with memory ma et al 2009 for the networked multiple agents system with input delay a model reduction method is used to obtain delay free system based on a system model transformation then adaptive dynamic programming algorithm is adapted to obtain the data driven distributed optimal consensus control zhang et al 2019b in a dc microgrid with distributed battery energy storage systems a distributed multi agent finite time control strategy with time delays is proposed for the charge balancing and voltage restoration based on the artstein transformation zhang and hredzak 2019 for the best knowledge of the authors although the transformations can be applied in the networked control system with time delay to obtain the delay free system there are few results considering the packet dropouts and disordering in transformations additionally in most papers the transformations are based on the current system states directly instead of the received state data through network then the effect on performance of the transformed system due to time delay packet dropouts and disordering might not be considered totally in the ocean environment the wave and current are accompanied with each other in most cases the velocity of current is varying slowly in a long time then for the fixed offshore platform we can use the constant velocity of current in engineering the affection of wave and current to each other cannot be ignored especially in deep sea feng et al 2019 xu et al 2018 for the widely used linearized morison wave force equation the current is not considered then the outside force dynamics should be designed to include the wave and current at the same time as mentioned above we need a coupling outside loads model and a new system model transformation in network environment these motivate the research of this paper and we present a model of wave and current force give a modified transformation considering above mentioned nonideal network communication problems and design a networked controller based on the transformed delay free system in the imperfect network communication to solve the above problems in this paper we research the networked vibration control for offshore platform based on the model with two network channels and two communication buffers the outside disturbances are modeled to output wave and current forces acting on the offshore platform and the problems of time delay packet dropouts and disordering are solved synchronously in the work through a modified transformation the networked modified transformation based controller ntc for offshore platform is deigned to compensate the problems due to imperfect network conditions and depress the vibration of offshore platform the networked controller includes three important parts outside multiple loads sensor data transmitted by network and outputted from buffer and memory issues of states and control forces thus disturbances big time delay large packet dropouts and serious disordering can be solved by the presented controller to save the computation source an algorithm is given to update the control force more efficiently the stability of the system under controller is proved based on lyapunov function the simulation results illustrate the validity of the proposed controller by the comparison with other networked controllers the major contributions of the paper is generalized as follows 1 an external system of wave and current forces is constructed compared with the vibration control of offshore platform under wave forces only the wave and current forces system has wider applications 2 present a modified system transformation that taking nonideal network conditions into account the networked compensation scheme is based on the output of buffers and upper bounds of time delays in network communication 3 by introducing the current output of buffer through network communication and the past time information of control and outloads the modified transformation based controller can compensate the imperfect network conditions and depress the vibration an approach for updating controller is provided to reduce the computation time the rest of paper is organized as followings section 2 and section 3 present the dynamical functions of the networked control system of offshore platform and the outside loads section 4 presents the networked modified transformation based controller and section 5 gives the proof of the stability in section 6 the simulation results illustrate the validity of the presented controller including the performance analysis and comparison of different networked controllers the conclusions are given in section 7 2 modeling and problem formulation in this section we present networked vibration control system model for offshore platform for steel jacket type offshore platform with amd device li et al 2003 ma et al 2019 the structure sketch is shown in fig 1 the platform is modeled as a sdof system based on the first mode dynamical motion and the approximation is widely applied in vibration control taking t as sampling period discrete time control system motion is shown in 1 1 x k 1 a x k b u k d f k k 0 1 2 x 0 x 0 u k 0 k h h 1 1 where x is the system state x x 1 x 2 x 1 x 2 t u and f are control force and outside loads a r n n b r n m d r n p are constant matrices a exp a t b 0 t exp a t d t b d 0 t exp a t d t d a 0 0 1 0 0 0 0 1 ω 1 2 ω 2 2 m 2 m 1 ω 2 2 m 2 m 1 2 ξ 1 ω 1 ξ 2 ω 2 m 2 m 1 2 ξ 2 ω 2 m 2 m 1 ω 2 ω 2 2 ξ 2 ω 2 2 ξ 2 ω 2 b 0 0 1 m 1 1 m 2 t d 0 0 1 m 1 0 t in which x 1 is the corresponding modal coordinate that refers to the deck motion of the offshore platform x 2 is the displacement of amd device m 1 ω 1 and ξ 1 are modal mass natural frequency and damping ratio of the sdof system m 2 ω 2 and ξ 2 are mass natural frequency and damping ratio of the amd device we present the networked control system for offshore platform in fig 2 here the time delay packet dropouts and disordering due to nonideal network communication are considered synchronously from the latest successful transmission to current time k time delay between sensor and controller is τ k s c and continual d k s c packets lost between sensor and controller similarly τ k c a and d k c a are time delay and the number of continual packets dropped between controller and actuator from the latest successful transmission to current time k in the model of networked control system there are two buffers in two network channels where buffer 1 is between sensor and controller and buffer 2 is between controller and actuator x k u k x k and u k are outputs of sensor controller buffer 1 and actuator respectively because there is no time delay or packet dropout between buffer 2 and actuator u k equals to the output of buffer 2 in the network communication the packet disordering is caused by time delays or packet dropouts the packets generated earlier may arrive at the destination later or even be lost here the packets in network are transmitted with time stamps in the presented model the two buffers store the received packets and the packet generated earlier will be outputted earlier considering the upper bound of time delay between sensor and controller 0 τ k s c m s c we set the output of buffer 1 at time k x k x k m s c when d k s c 0 if the packet x k m s c is lost we have d k s c 0 and x k x k 1 similarly we get the output of buffer 2 u k at time k if d k c a 0 u k u k 1 if d k c a 0 u k u k m c a to make the model of ncss clearer we have the following assumptions assumption 1 the time delays packet dropouts and disordering exist in the channels of sensor controller and controller actuator assumption 2 the upper bounds of delays τ k s c τ k c a are known 0 τ k s c m s c 0 τ k c a m c a assumption 3 the sample period of sensors is t t 0 and the time stamps are capsuled in packets the time delay due to network may be bigger than sampling period t the dynamical equation of networked system is described as followings 2 x k 1 α x k b 1 u k d f k x k x 0 k k m s c m s c 1 0 u k u k m c a d k c a 0 u k 1 d k c a 0 u k 0 k m c a m c a 1 0 where x 0 k is the initial system state without control in this paper we describe the packet dropouts sensor controller and controller actuator as two independent bernoulli processes with probability distribution p r d k s c 1 δ 1 p r d k s c 0 1 δ 1 p r d k c a 1 δ 2 p r d k c a 0 1 δ 2 where the known constant δ 1 denotes the probability of the packet lost from sensor to controller and known constant δ 2 denotes that from controller to actuator 3 irregular outside forces due to wave and current in the ocean the wave and current exist synchronously the wave forces actions on offshore platforms are affected by current then in this paper we try to model the wave force and current force together the following assumptions are hold in the paper assumption 4 the platform has been idealized as a monopod structure assumption 5 the direction of x axis is the direction where the wave force is the strongest assumption 6 the velocity of current is constant for the vibration control of fixed offshore platform 3 1 wave force affected by current the outside forces acting on the offshore platform consist of irregular wave and current force the total irregular wave force f w t affected by current could be written as followings 3 f w t j 1 r f j t where f j t is the wave force of the j th wave component j 1 2 r from wave theory and measurement one can see that the velocity of wave is affected by current for the j th wave component the velocity of wave in direction of x axis affected by current can be shown as following 4 v j z t v j z t v c cos α where v j is horizontal velocity of the water particle affected by current in the j th wave component v j is horizontal velocity of the water particle without affection by current in the j th wave component v c is constant velocity of current α is the horizontal angle between main directions of wave force and current force then v c cos α is the velocity of current on x axis from 4 we can see that 5 v j v j 6 σ v j z σ v j z where σ v j and σ v j are the standard deviation of v j and v j at height z for the j th wave component j 1 2 r the wave force f j t is 7 f j t 0 d p j z t d z considering the affection of current in 4 p j z t could be calculated by following linearized morison equation 8 p j z t c d ρ d 8 π σ v j z v j z t 2 c m ρ π d 2 v j z t 4 c d ρ d 8 π σ v j z v j z t 2 c m ρ π d 2 v j z t 4 c d ρ d 8 π σ v j z v c cos α 2 where c d is the drag coefficient c m is the inertia coefficient ρ is the fluid density d is the diameter of the cylinder let v j t a j cos θ j then we have v j t ω j a j sin θ j where θ j ω j t ε j j 1 r ω j is the frequency of the j th wave component ε j is random value between 0 and 2 π and the horizontal velocity and acceleration of the water particle in the j th wave component can be expressed as followings 9 v j z d t a j cos θ j ω j ch k j z sh k j d t j ω j z d v j t 10 v j z d t a j s i n θ j ω j 2 ch k j z sh k j d t j ω j z d v j t 11 σ v j 2 0 t j 2 s η w d w where a j 2 s η ω j δ ω j s η is wave spectrum t j ω j z d ω j ch k j z sh k j d k j is the wave number of the j th wave component determined by the dispersion relationship 12 ω j 2 g k j tanh k j d in which g is the gravitational acceleration from 7 8 9 and 10 we can see that 13 f j t 0 d c d ρ d 8 π σ v j z t j w j z t v j t 2 d z 0 d c m ρ π d 2 t j w j z t v j t 4 d z 0 d c d ρ d 8 π σ v j z v c cos α 2 d z δ f 1 j t f 2 j t where f 1 j t t 1 j t 2 j v j t t v j t t t f 2 j t 0 d c d ρ d 8 π σ v j v c cos α 2 d z in which t 1 j 0 d c d ρ d 8 π σ v j z t j ω j z d 2 d z t 2 j 0 d c m ρ π d 2 t j ω j z d 4 d z then the wave force affected by current can be rewritten as 14 f w t j 1 r f j t j 1 r f 1 j t j 1 r f 2 j t δ f 1 t f 2 t where f 1 t j 1 r f 1 j t f 2 t j 1 r f 2 j t 3 2 the total wave and current force the current load acting on the structures is constant because velocity of current is constant in a relatively long time domain here we give the current force in the direction of x axis 15 f c 1 2 ρ c d d v c cos α 2 then we can get total external loads acting on the offshore platform induced by wave and current together 16 f t f w t f c f 1 t f 2 t f c δ f 1 t f c t where f c t is the outside forces relevant to current f c t f 2 t f c from 13 and 14 we can see that in a relatively long time f c t is constant function of time t and f c t f c let v t v 1 t v r t t then we get 17 v t ω 1 2 ω r 2 v t δ g a v t let w t v t t v t t t then 18 w t 0 i g a 0 w t δ g c w t where i r r r is unit matrix 0 r r r is zero matrix then f 1 t can be written as 19 f 1 t j 1 r t 1 j t 2 j v j t t v j t t t t 11 t 1 r t 21 t 2 r w t δ f w t therefore the total irregular wave forces not affected by current force could be generated by the following exosystem 20 w k 1 g w k k 0 1 2 f 1 k f w k w 0 v t 0 v t 0 t where g exp g c t the eigenvalues λ i g of g satisfy λ i g 1 i 1 2 2 r obviously the total wave and current loads acting on the offshore platform can be expressed by following discrete time form 21 f k f 1 k f c where f c f 2 f c remark 1 considering the loading of wave and current on the fixed offshore platform we present the coupling model of outside load the total external loads f k in 21 consists of two parts f 1 k and f c f 1 k is the wave force without considering the affection of current and f c k is the force due to current if not consider current we have f k f 1 k but for the most deep sea conditions the wave and current should be considered synchronously feng et al 2019 xu et al 2018 4 controller design 4 1 model transformation in the section we present the networked controller for the offshore platform under wave and current force consider the following control delay system with disturbance 22 x k 1 α x k b 1 u k m c a d f k x 0 x 0 subjected to the following performance index 23 j lim n 1 2 n k 0 n x t k u t k θ x t k u t k t where u k u t k u t k 1 u t k 2 u t k m c a t θ is symmetric positive semi definite matrix by the transformation ma et al 2009 24 z k x k j 0 m c a 1 a j m c a b 1 u k j 1 and let h 0 a m c a a 1 m c a a 1 b 1 i 1 1 0 0 0 then we have following equations based on 24 25 z k x k h u u k i 1 u k and we get a delay free system 26 z k 1 a z k b u k d f k k 1 2 z 0 x 0 0 where b a m c a b 1 for the transformed system 26 we consider the infinite time control index 27 j z lim n 1 2 n k 0 n z t k q z k u t k r u k to make the performance indices in 23 and 27 equivalent j j z the following equations should hold 28 x t k u t k θ x t k u t k t x t k θ 11 x k u t k θ 21 x k x t k θ 12 u k u t k θ 22 u k z t k q z k u t k r u k x t k q x k x t k q h u k u t k h t q x k u t k h t q h u k u t k i 1 t r i 1 u k then one can yield 29 θ 11 q θ 12 q h θ 21 h t q θ 22 h t q h i 1 t r i 1 when 29 holds the performance indices 23 and 27 are equivalent then we can design the networked controller based on the transformed system 26 and index 27 one can see that the system with control delay can be transformed into the delay free system by 24 the transformation based method 24 is effective and easy to complete for the point to point control system with time delay in control ma et al 2009 however for the networked control of offshore platform z k in the transformed delay free system 26 is just decided by initial system state z 0 x 0 0 and does not reflect network communication conditions correspondingly problems due to network such as packet dropouts and disordering cannot be compensated effectively by the controller based on 26 by the way the outside loads in most literature are irregular wave forces not affected by current and in the paper we consider the forces due to wave and current together in the followings based on the networked control model and the total wave current force model we will present the networked vibration controller suitable for offshore platform in the nonideal network communication 4 2 controller design based on the transformed system 26 and performance index 27 and taking time delay packet dropouts and disordering into account we get the following modified transformation based networked control ntc law theorem 1 considering networked vibration control for offshore platform described by 2 with time delays packet dropouts and disordering we present the following networked modified transformation based control ntc law 30 u k s 1 b t p 1 a a m s c x k i 0 m s c 1 a i b 1 u k i 1 m c a i 0 m s c 1 a i d f k 1 i j 0 m c a 1 a j m c a b 1 u k j 1 s 1 b t p 1 d f p 2 g w k s 1 b t p 1 d p 3 f c k u k u k m c a d k c a 0 u k 1 d k c a 0 u k 0 k m c a m c a 1 0 x k x k m s c d k s c 0 x k 1 d k s c 0 x k x 0 k m s c m s c 1 0 where s r b t p 1 b p 1 is the unique positive definite solution to the discrete riccati equation 31 a t p 1 a a t p 1 b s 1 b t p 1 a p 1 q 0 p 2 is the unique solution to sylvester equation 32 a t i p 1 b s 1 b t p 2 g p 2 a t i p 1 b s 1 b t p 1 d f 0 p 3 is the unique solution that depends on the value of p 1 33 p 3 a t i p 1 b s 1 b t p 1 d p 3 proof firstly we consider the networked control system 22 based on the transformation 24 we get the control system without delay in control 26 here the outside load f k consists of wave and current forces 21 applying the maximum principle to system 26 and quadratic function index 27 we get the optimal control law 34 u k r 1 b t λ k 1 k 0 1 2 where λ k is the solution to the following two point boundary value tpbv problem 35 z k 1 a z k b r 1 b t λ k 1 d f k λ k q z k a t λ k 1 k 0 1 2 z 0 x 0 λ 0 to solve 35 let 36 λ k p 1 z k p 2 w k p 3 f c k then the optimal control law 34 can be rewritten as 37 u k s 1 b t p 1 a z k p 1 d f p 2 g w k p 1 d p 3 f c k 0 1 2 where s r b t p 1 b and 38 λ k q a t i p 1 b s 1 b t p 1 a z k a t i p 1 b s 1 b t p 1 d f p 2 g w k a t i p 1 b s 1 b t p 1 d p 3 f c comparing the coefficients of 36 and 38 we obtain equations 31 33 in 37 the feedback item in control force u k is based on z k in 26 to reflect the network conditions in real time we introduce the output of buffer 1 and the past time information into the controller noting z k x k j 0 m c a 1 a j m c a b 1 u k j 1 and x k a m s c x k i 0 m s c 1 a i b 1 u k i 1 m c a i 0 m s c 1 a i d f k 1 i we get the following modified transformation suitable for the networked control system 39 z k a m s c x k i 0 m s c 1 a i b 1 u k i 1 m c a i 0 m s c 1 a i d f k i 1 i 0 m c a 1 a i m c a b 1 u k i 1 and the controller 37 can be rewritten as following equation 40 u k s 1 b t p 1 a a m s c x k i 0 m s c 1 a i b 1 u k i 1 m c a i 0 m s c 1 a i d f k 1 i j 0 m c a 1 a j m c a b 1 u k j 1 s 1 b t p 1 d f p 2 g w k s 1 b t p 1 d p 3 f c secondly we solve the problem of packet dropouts and disordering due to network considering the outputs of buffer 1 and buffer 2 we can obtain the networked modified transformation based controller 30 x k x k m s c d k s c 0 x k 1 d k s c 0 x k x 0 k k m s c m s c 1 0 u k u k m c a d k c a 0 u k 1 d k c a 0 u k 0 k m c a m c a 1 0 based on the time stamps the buffers can sort the packets received from network and we can deal with the problem of disordering by the networked vibration controller 30 the problem of time delay packet dropouts and disordering due to nonideal network can be solves step by step we can see that the controller is physical realizable this completes the proof remark 2 z k in 26 can be determined by m c a and x 0 0 but the packet dropouts and disordering are not considered in the transformation then in the paper we adopt the modified transformation 39 based on the z k in 39 the networked controller 30 is completed then the time delay packet dropouts and disordering are considered in the design of controller in the followings we consider the computation of the controller and design an algorithm to get efficient progress for updating of control values in the controller 30 there are three different sums i 0 m s c 1 a i b 1 u k i 1 m c a i 0 m s c 1 a i d f k 1 i and j 0 m c a 1 a j m c a b 1 u k j 1 one can yield that computation time of controller and the size of buffers depend on m c a and m s c for the severe sea environment and nonideal network communication the big time delay m c a and m s c may bring complex computation of controller for the controller 40 we have the following algorithm 1 to update the controller and simplify the computation let s 1 k i 0 m s c 1 a i b 1 u k i 1 m c a s 2 k i 0 m s c 1 a i d f k 1 i s 3 k j 0 m c a 1 a j m c a b 1 u k j 1 then z k a m s c x k s 1 k s 2 k s 3 k in algorithm 1 s i k i 1 2 3 are computed by sums of three items but not the sum of m s c items or m c a items as original definitions for the big time delays the complexity of computation can be reduced obviously algorithm 1 step 1 k m 2 s 1 k i 0 m s c 1 a i b 1 u k i 1 m c a s 2 k i 0 m s c 1 a i d f k 1 i s 3 k j 0 m c a 1 a j m c a b 1 u k j 1 m m s c m c a step 2 s 1 k 1 a s 1 k b 1 u k m c a a m s c b 1 u k m c a m s c s 2 k 1 a s 2 k d f k a m s c d f k m s c s 3 k 1 a s 3 k a m c a b 1 u k b 1 u k m c a step 3 if k n k k 1 return to step 2 n is the end of computation time else exit 5 stability analysis in this section we provide the bound stability condition of networked control system 2 theorem 2 the networked control system 2 is bound stable if there exit matrices p r n n and q r n n satisfying p q 0 0 p 0 proof for the transformed system 26 we define a lyapunov function 41 v z k v 1 z k v 2 z k where 42 v 1 x k z t k p z k v 2 x k s k d c a k k 1 z t s q z s let z k z t k w t k f c t then 43 z k i 0 0 z k δ λ 1 z k 44 z k 1 a b s 1 b t p 1 a z k d f b s 1 b t p 1 d f p 2 g w k d b s 1 b t p 1 d p 3 f c δ π 1 π 2 π 3 z k δ λ 2 z k where π 1 a b s 1 b t p 1 a π 2 d f b s 1 b t p 1 d f p 2 g π 3 d b s 1 b t p 1 d p 3 from 45 we get 45 z t k 1 p z k 1 z t k λ 2 t p λ 2 z k then 46 v 1 z k 1 v 1 z k z t k 1 p z k 1 z t k p z k z t k λ 2 t p λ 2 λ 1 t p λ 1 z k noticing that k 1 d c a k 1 k d c a k then one can yield 47 v 2 z k 1 v 2 z k s k 1 d c a k 1 k z t s q z s s k d c a k k 1 z t s q z s z t s q z s s k 1 d c a k 1 k 1 z t s q z s s k d c a k k 1 z t s q z s z t k q z k z t k λ 1 t q λ 1 z k therefore ncs 26 is asymptotically stable if following inequality holds 48 v x k 1 v x k z t k λ 2 t p λ 2 λ 1 t p λ 1 t λ 1 t q λ 1 z k z t k λ 1 t λ 2 t p q 0 0 p λ 1 λ 2 z k 0 it is obviously that 48 holds if there are positive definite matrices p and q making p q 0 0 p 0 that means ncs 26 is asymptotically stable from 24 and 37 we can see that 49 x k z k m c a max 0 j m c a 1 a j m c a b 1 s 1 b t p 1 a z k j 1 m c a max 0 j m c a 1 a j m c a b 1 s 1 b t p 1 d f p 2 g w k j 1 m c a max 0 j m c a 1 a j m c a b 1 s 1 b t p 1 d p 3 f c because z k w k and f c are bounded x k is bounded then the networked control system for offshore platform under the presented controller is stable this completes the proof from the theorem 2 we can see that the stability of the original system can be guaranteed by the stability of transformed system additionally when 29 hold the performance indices of 23 and 27 are equivalent j j z 6 simulation results and discussion in this section for the offshore platform in gulf of mexico ma et al 2019 validity of the networked vibration controller based on modified transformation will be verified by the simulation results the total height of offshore platform l 249 m diameter of four legs d 1 83 m the first modal mass m 1 7 825 307 kg natural frequency ω 1 2 0466 rad s structural damping ratio ξ 1 2 the mass of amd on the platform m 2 78 253 kg natural frequency ω 2 2 0074 rad s damping ratio ξ 2 20 the sea conditions are shown as followings wave depth d 218 m density of seawater ρ 1028 4 k g m 3 drag coefficient c d 1 0 inertia coefficient c m 1 5 in the paper we express the irregular wave by jonswap spectrum 50 s η ω 5 h s 2 16 ω 0 ω 0 ω 5 exp 1 25 ω ω 0 4 γ β where h s is significant wave height ω 0 is peak frequency ω is wave frequency σ is shape parameter σ 0 07 ω ω 0 σ 0 09 ω ω 0 β exp ω ω 0 2 2 σ 2 ω 0 2 γ is peakedness parameter here h s 7 m ω 0 0 79 rad s and γ 3 3 and we assume that the constant velocity of current v c 1 0 m s and the angle between current and wave forces α π 4 the power spectrum density psd of wave elevation is shown in fig 3 and the total outside force including wave and current in fig 4 in the paper we use the following infinite time control index j z lim n 1 n k 0 n z t k q z k u t k r u k where q 10 7 d i a g 1 0 1 0 r 10 5 n 210 t t 0 01 s 6 1 analysis of the modified transformation based networked controller ntc is the presented controller 30 in the paper in this subsection we focus on the performance analysis of the presented ntc in nonideal network conditions firstly we study the system performance with the fixed time delay upper bounds and varying packet dropouts rates secondly for the fixed packet dropouts rate we research the validity of the controller with varying upper time delay bounds 6 1 1 performance of the ntc with different packet dropouts rates in the subsection we consider different packet dropouts rates with large time delays in sensor controller and controller actuator channels let the upper bound of time delays due to network be m s c m c a 1 5 t 150 the packet dropouts rates are varying from 60 to 100 for the worst case the packet dropouts rate is 100 and there is no output packets received by the actuator the peak and standard deviation values of offshore platform under the presented ntc with different packet dropouts rates are shown in table 1 we can see that the peak and standard deviation values of the offshore platform increase with the packet dropout rates and the presented controller ntc can keep the system performance satisfied and no sharp increase occurs when the packet dropout rate increase from 0 to 95 when m s c m c a 1 5 t and δ 1 δ 2 0 97 99 the displacement and acceleration of the offshore platform are shown in figs 5 6 and the output of actuator u k is shown in fig 7 6 1 2 performance of the ntc with different time delays upper bounds and fixed packet dropouts rate to illustrate the affection of upper bound of time delay we assume that packet dropout rate is fixed as δ 1 δ 2 96 in table 2 m c a 1 5 t 150 and m s c is increasing from 20 to 420 in table 3 m s c 1 5 t 150 and m c a is increasing from 20 to 420 we can see that under the presented ntc with the increase of time delay the performance index j z of offshore platform shows the trend of worse comparing tables 2 and 3 one yields that the system performance is influenced more obviously by m c a than m s c 6 2 comparison with the other networked controllers in this subsection we compare the different networked controllers with ntc for the same sea conditions as subsection 6 1 we compare four different networked controller ntc ntc1 npffoc ma et al 2019 and npsfoc ma et al 2019 here ntc is the presented networked controller 30 in the paper and ntc1 is the controller 37 based on the transformed system 26 one can see that ntc is based on the modified transformation 39 and considers the network communication in the transformed system but ntc1 is completed based on the transformation 24 and delay free system 26 the transformation 24 does not include the information of network communication and the transformed system 26 is a time invariant delay free system that can be decided by initial value for the offshore platform under irregular wave force with time delay packet dropouts and disordering due to network npffoc is networked predictive feedback and feedforward optimal controller and npsfoc is networked predictive state feedback optimal controller ma et al 2019 the current force is not taken into account in npffoc and npsfoc for npffoc and npsfoc we use the following infinite time performance index j x lim n 1 n k 0 n x t k q x k u t k r u k where q 10 7 d i a g 1 0 1 0 r 10 5 n 210 t as table 4 illustrates ntc can bring improvements of system performance compared with ntc1 npffoc and npsfoc the performance of ntc and npffoc are close to each other because the two controllers include the outside forces upper bounds of time delays and output of buffer1 x k besides the outside wave force considered by npffoc ntc takes current force into account from simulation results we can see that ntc achieves better system performance with less control force compared with npffoc though ntc and ntc1 are designed based on transformations there are difference between the system performance and control force ntc depresses the vibration of offshore platform more efficiently than ntc1 with less control force because ntc is designed based on the modified transformation 39 but ntc1 is completed based on the transformation 24 that does not consider the packet dropouts of network transmission when the packet dropouts rate is big for example δ 1 δ 2 97 the control force of ntc1 is not sufficient enough to depress the vibration attitude compared with ntc 7 conclusions in this work we design a networked modified transformation based control law for offshore platform over sensor network with random time delay packet dropouts and disordering in sensor controller and controller actuator channels the wave and current forces acting on the offshore platform are modeled synchronously we design the networked vibration controller based on two buffers outside wave and current forces and the modified transformation the modified transformation takes the network communication into account then the presented networked controller can address the problems of big time delay continual packet dropouts and disordering due to unideal network communication and ensure the stability of networked control system simulation results demonstrate the validity of the developed controller and the comparison of different networked controller show the effectiveness of the presented ntc in the paper acknowledgements this work was supported by the national natural science foundation of china nsfc grants no 41276085 61379029 and 61572448 
22458,in the paper we study the problem of vibration control for offshore platform in nonideal network environment under wave and current forces based on the modified transformation we consider the wave and current synchronously and give a dynamical system for the outside loads the problem of time delay packet dropouts and disordering due to nonideal network are taken into account in the networked control model two buffers output the received packets according to time stamps and upper bound of time delay based on a transformation we reduce the time delay system into an equivalent delay free system taking the nonideal network communication conditions into account we design a modified transformation based on the past time data wave and current loads and received packets through network at current time the networked controller is presented to depress the vibration of structure in nonideal network communication environment based on the modified transformation an algorithm is given to simplify the computation of control law by recurrence the system stability under presented networked controller is analyzed based on lyapunov functional through the simulation results and comparison with other networked controllers we can see that the presented controller can reduce the oscillation of offshore platform effectively keywords networked system time delay dropouts offshore platform wave and current forces modified transformation 1 introduction in the modern world more and more oil and gas are drilled by offshore platforms due to the wave current wind and earthquake continual vibration of the offshore platforms affects the safety of structures to keep the structures healthy and high efficiency of production vibration control is a critical problem to be studied li et al 2003 ma et al 2006 zhang et al 2014a 2014b for the harsh ocean environment the remote monitoring and distributed control by using of network have attracted more and more attention in the recent decades and it is one of hot topics in control engineering agarwal and kishor 2014 wang et al 2018 zhang et al 2019a for networked control systems ncss different parts of control system are connected by network mo et al 2017 peng and han 2016 qiu et al 2018 in ncss we can complete distributed computation and system maintenance more effectively however the decrease of system performance due to time delay packet dropouts and disordering are inevitable in the networked system in recent decades there are fruitful results of the modeling and controller designing for ncss jungers et al 2018 park et al 2018 the ncss have been widely applied in the engineering and daily life for example the unmanned marine vehicles wang and han 2018 mobile robot networks lu and han 2019 sample data system ge et al 2018 and intelligent traffic system zhang and zhou 2018 as an important application the networked control for offshore platform have attracted more attention in recent years due to the severe ocean environment and large structure of offshore platform the sensors controller and actuator are not suitable to be fixed in same place as in traditional point to point control then the distributed network model can connect the control system efficiently however the severe ocean and work conditions make the network for offshore platform more unstable than network communication on land dinh et al 2017 therefore the problems and limitations of network communication should be considered carefully in the designing of networked control for offshore platforms zhang and han 2014 for the vibration control of jacket type offshore platform with time delay in sensor controller channel event triggered networked controllers are presented zhang et al 2016 based on the two channel and two buffer network system model for offshore platform the problem of time delay packet dropouts and disordering are solved by networked predictive feedforward and feedback optimal control ma et al 2019 briefly the networked control systems of offshore platforms bring more challenge items than that on land then we should pay more attention to the forward and backward network channels the real time data transmitted by network and the complementation of the networked controller considering the need of distributed computation the controller actuator network channel should be studied with the sensor controller channel synchronously and one can get two network channel model of ncss ma et al 2016 sun et al 2019 for stochastic systems active artificial delay in control is designed in network based h feedback controllers zhang and han 2015 and for a packet based networked control system a dual rate pid controller is presented alcaina et al 2019 considering the asynchronous data transmission predictive control is another kind of designing method in ncss li et al 2019 predict and select the future control values according to the time delays between controller and actuator for the t s system the event triggered control law is designed based on the prediction of control packets peng et al 2018 for dynamic stabilization of a dc microgrid the fuzzy model predictive control synthesis of networked controlled power buffer is investigated vafamand et al 2019 in recent years the controllers with considerations of time delay and packet dropouts are proposed more and more in literature li and chen 2019 jiang et al 2008 wu and lu 2018 buffers are widely adopted in network system li et al 2017 based on the received data in buffers the delayed lost or future information of control system can be modeled hamdan and mahmoud 2018 to reduce the size of buffers adaptive buffers are designed by using of adaptive grey fuzzy cognitive map technique dinh et al 2018 to save computation and limited network resources event triggered scheme has been widely adapted zhang et al 2017 generally speaking the event triggered control system consists of feedback controller and event trigger for the nonlinear systems the robust event triggered controller is completed by using of reinforcement learning method yang et al 2019 for the software defined networking a distributed sdn controller is proposed to provide maximum flexibility for event triggered control kohler et al 2018 to deal with the problem of time delay transformation based control is a useful approach for linear time invariant systems with distinct input delays artstein 1982 tsubakino et al 2016 the method has been applied in the point to point vibration control of offshore platform to design feedback and feedforward optimal control with memory ma et al 2009 for the networked multiple agents system with input delay a model reduction method is used to obtain delay free system based on a system model transformation then adaptive dynamic programming algorithm is adapted to obtain the data driven distributed optimal consensus control zhang et al 2019b in a dc microgrid with distributed battery energy storage systems a distributed multi agent finite time control strategy with time delays is proposed for the charge balancing and voltage restoration based on the artstein transformation zhang and hredzak 2019 for the best knowledge of the authors although the transformations can be applied in the networked control system with time delay to obtain the delay free system there are few results considering the packet dropouts and disordering in transformations additionally in most papers the transformations are based on the current system states directly instead of the received state data through network then the effect on performance of the transformed system due to time delay packet dropouts and disordering might not be considered totally in the ocean environment the wave and current are accompanied with each other in most cases the velocity of current is varying slowly in a long time then for the fixed offshore platform we can use the constant velocity of current in engineering the affection of wave and current to each other cannot be ignored especially in deep sea feng et al 2019 xu et al 2018 for the widely used linearized morison wave force equation the current is not considered then the outside force dynamics should be designed to include the wave and current at the same time as mentioned above we need a coupling outside loads model and a new system model transformation in network environment these motivate the research of this paper and we present a model of wave and current force give a modified transformation considering above mentioned nonideal network communication problems and design a networked controller based on the transformed delay free system in the imperfect network communication to solve the above problems in this paper we research the networked vibration control for offshore platform based on the model with two network channels and two communication buffers the outside disturbances are modeled to output wave and current forces acting on the offshore platform and the problems of time delay packet dropouts and disordering are solved synchronously in the work through a modified transformation the networked modified transformation based controller ntc for offshore platform is deigned to compensate the problems due to imperfect network conditions and depress the vibration of offshore platform the networked controller includes three important parts outside multiple loads sensor data transmitted by network and outputted from buffer and memory issues of states and control forces thus disturbances big time delay large packet dropouts and serious disordering can be solved by the presented controller to save the computation source an algorithm is given to update the control force more efficiently the stability of the system under controller is proved based on lyapunov function the simulation results illustrate the validity of the proposed controller by the comparison with other networked controllers the major contributions of the paper is generalized as follows 1 an external system of wave and current forces is constructed compared with the vibration control of offshore platform under wave forces only the wave and current forces system has wider applications 2 present a modified system transformation that taking nonideal network conditions into account the networked compensation scheme is based on the output of buffers and upper bounds of time delays in network communication 3 by introducing the current output of buffer through network communication and the past time information of control and outloads the modified transformation based controller can compensate the imperfect network conditions and depress the vibration an approach for updating controller is provided to reduce the computation time the rest of paper is organized as followings section 2 and section 3 present the dynamical functions of the networked control system of offshore platform and the outside loads section 4 presents the networked modified transformation based controller and section 5 gives the proof of the stability in section 6 the simulation results illustrate the validity of the presented controller including the performance analysis and comparison of different networked controllers the conclusions are given in section 7 2 modeling and problem formulation in this section we present networked vibration control system model for offshore platform for steel jacket type offshore platform with amd device li et al 2003 ma et al 2019 the structure sketch is shown in fig 1 the platform is modeled as a sdof system based on the first mode dynamical motion and the approximation is widely applied in vibration control taking t as sampling period discrete time control system motion is shown in 1 1 x k 1 a x k b u k d f k k 0 1 2 x 0 x 0 u k 0 k h h 1 1 where x is the system state x x 1 x 2 x 1 x 2 t u and f are control force and outside loads a r n n b r n m d r n p are constant matrices a exp a t b 0 t exp a t d t b d 0 t exp a t d t d a 0 0 1 0 0 0 0 1 ω 1 2 ω 2 2 m 2 m 1 ω 2 2 m 2 m 1 2 ξ 1 ω 1 ξ 2 ω 2 m 2 m 1 2 ξ 2 ω 2 m 2 m 1 ω 2 ω 2 2 ξ 2 ω 2 2 ξ 2 ω 2 b 0 0 1 m 1 1 m 2 t d 0 0 1 m 1 0 t in which x 1 is the corresponding modal coordinate that refers to the deck motion of the offshore platform x 2 is the displacement of amd device m 1 ω 1 and ξ 1 are modal mass natural frequency and damping ratio of the sdof system m 2 ω 2 and ξ 2 are mass natural frequency and damping ratio of the amd device we present the networked control system for offshore platform in fig 2 here the time delay packet dropouts and disordering due to nonideal network communication are considered synchronously from the latest successful transmission to current time k time delay between sensor and controller is τ k s c and continual d k s c packets lost between sensor and controller similarly τ k c a and d k c a are time delay and the number of continual packets dropped between controller and actuator from the latest successful transmission to current time k in the model of networked control system there are two buffers in two network channels where buffer 1 is between sensor and controller and buffer 2 is between controller and actuator x k u k x k and u k are outputs of sensor controller buffer 1 and actuator respectively because there is no time delay or packet dropout between buffer 2 and actuator u k equals to the output of buffer 2 in the network communication the packet disordering is caused by time delays or packet dropouts the packets generated earlier may arrive at the destination later or even be lost here the packets in network are transmitted with time stamps in the presented model the two buffers store the received packets and the packet generated earlier will be outputted earlier considering the upper bound of time delay between sensor and controller 0 τ k s c m s c we set the output of buffer 1 at time k x k x k m s c when d k s c 0 if the packet x k m s c is lost we have d k s c 0 and x k x k 1 similarly we get the output of buffer 2 u k at time k if d k c a 0 u k u k 1 if d k c a 0 u k u k m c a to make the model of ncss clearer we have the following assumptions assumption 1 the time delays packet dropouts and disordering exist in the channels of sensor controller and controller actuator assumption 2 the upper bounds of delays τ k s c τ k c a are known 0 τ k s c m s c 0 τ k c a m c a assumption 3 the sample period of sensors is t t 0 and the time stamps are capsuled in packets the time delay due to network may be bigger than sampling period t the dynamical equation of networked system is described as followings 2 x k 1 α x k b 1 u k d f k x k x 0 k k m s c m s c 1 0 u k u k m c a d k c a 0 u k 1 d k c a 0 u k 0 k m c a m c a 1 0 where x 0 k is the initial system state without control in this paper we describe the packet dropouts sensor controller and controller actuator as two independent bernoulli processes with probability distribution p r d k s c 1 δ 1 p r d k s c 0 1 δ 1 p r d k c a 1 δ 2 p r d k c a 0 1 δ 2 where the known constant δ 1 denotes the probability of the packet lost from sensor to controller and known constant δ 2 denotes that from controller to actuator 3 irregular outside forces due to wave and current in the ocean the wave and current exist synchronously the wave forces actions on offshore platforms are affected by current then in this paper we try to model the wave force and current force together the following assumptions are hold in the paper assumption 4 the platform has been idealized as a monopod structure assumption 5 the direction of x axis is the direction where the wave force is the strongest assumption 6 the velocity of current is constant for the vibration control of fixed offshore platform 3 1 wave force affected by current the outside forces acting on the offshore platform consist of irregular wave and current force the total irregular wave force f w t affected by current could be written as followings 3 f w t j 1 r f j t where f j t is the wave force of the j th wave component j 1 2 r from wave theory and measurement one can see that the velocity of wave is affected by current for the j th wave component the velocity of wave in direction of x axis affected by current can be shown as following 4 v j z t v j z t v c cos α where v j is horizontal velocity of the water particle affected by current in the j th wave component v j is horizontal velocity of the water particle without affection by current in the j th wave component v c is constant velocity of current α is the horizontal angle between main directions of wave force and current force then v c cos α is the velocity of current on x axis from 4 we can see that 5 v j v j 6 σ v j z σ v j z where σ v j and σ v j are the standard deviation of v j and v j at height z for the j th wave component j 1 2 r the wave force f j t is 7 f j t 0 d p j z t d z considering the affection of current in 4 p j z t could be calculated by following linearized morison equation 8 p j z t c d ρ d 8 π σ v j z v j z t 2 c m ρ π d 2 v j z t 4 c d ρ d 8 π σ v j z v j z t 2 c m ρ π d 2 v j z t 4 c d ρ d 8 π σ v j z v c cos α 2 where c d is the drag coefficient c m is the inertia coefficient ρ is the fluid density d is the diameter of the cylinder let v j t a j cos θ j then we have v j t ω j a j sin θ j where θ j ω j t ε j j 1 r ω j is the frequency of the j th wave component ε j is random value between 0 and 2 π and the horizontal velocity and acceleration of the water particle in the j th wave component can be expressed as followings 9 v j z d t a j cos θ j ω j ch k j z sh k j d t j ω j z d v j t 10 v j z d t a j s i n θ j ω j 2 ch k j z sh k j d t j ω j z d v j t 11 σ v j 2 0 t j 2 s η w d w where a j 2 s η ω j δ ω j s η is wave spectrum t j ω j z d ω j ch k j z sh k j d k j is the wave number of the j th wave component determined by the dispersion relationship 12 ω j 2 g k j tanh k j d in which g is the gravitational acceleration from 7 8 9 and 10 we can see that 13 f j t 0 d c d ρ d 8 π σ v j z t j w j z t v j t 2 d z 0 d c m ρ π d 2 t j w j z t v j t 4 d z 0 d c d ρ d 8 π σ v j z v c cos α 2 d z δ f 1 j t f 2 j t where f 1 j t t 1 j t 2 j v j t t v j t t t f 2 j t 0 d c d ρ d 8 π σ v j v c cos α 2 d z in which t 1 j 0 d c d ρ d 8 π σ v j z t j ω j z d 2 d z t 2 j 0 d c m ρ π d 2 t j ω j z d 4 d z then the wave force affected by current can be rewritten as 14 f w t j 1 r f j t j 1 r f 1 j t j 1 r f 2 j t δ f 1 t f 2 t where f 1 t j 1 r f 1 j t f 2 t j 1 r f 2 j t 3 2 the total wave and current force the current load acting on the structures is constant because velocity of current is constant in a relatively long time domain here we give the current force in the direction of x axis 15 f c 1 2 ρ c d d v c cos α 2 then we can get total external loads acting on the offshore platform induced by wave and current together 16 f t f w t f c f 1 t f 2 t f c δ f 1 t f c t where f c t is the outside forces relevant to current f c t f 2 t f c from 13 and 14 we can see that in a relatively long time f c t is constant function of time t and f c t f c let v t v 1 t v r t t then we get 17 v t ω 1 2 ω r 2 v t δ g a v t let w t v t t v t t t then 18 w t 0 i g a 0 w t δ g c w t where i r r r is unit matrix 0 r r r is zero matrix then f 1 t can be written as 19 f 1 t j 1 r t 1 j t 2 j v j t t v j t t t t 11 t 1 r t 21 t 2 r w t δ f w t therefore the total irregular wave forces not affected by current force could be generated by the following exosystem 20 w k 1 g w k k 0 1 2 f 1 k f w k w 0 v t 0 v t 0 t where g exp g c t the eigenvalues λ i g of g satisfy λ i g 1 i 1 2 2 r obviously the total wave and current loads acting on the offshore platform can be expressed by following discrete time form 21 f k f 1 k f c where f c f 2 f c remark 1 considering the loading of wave and current on the fixed offshore platform we present the coupling model of outside load the total external loads f k in 21 consists of two parts f 1 k and f c f 1 k is the wave force without considering the affection of current and f c k is the force due to current if not consider current we have f k f 1 k but for the most deep sea conditions the wave and current should be considered synchronously feng et al 2019 xu et al 2018 4 controller design 4 1 model transformation in the section we present the networked controller for the offshore platform under wave and current force consider the following control delay system with disturbance 22 x k 1 α x k b 1 u k m c a d f k x 0 x 0 subjected to the following performance index 23 j lim n 1 2 n k 0 n x t k u t k θ x t k u t k t where u k u t k u t k 1 u t k 2 u t k m c a t θ is symmetric positive semi definite matrix by the transformation ma et al 2009 24 z k x k j 0 m c a 1 a j m c a b 1 u k j 1 and let h 0 a m c a a 1 m c a a 1 b 1 i 1 1 0 0 0 then we have following equations based on 24 25 z k x k h u u k i 1 u k and we get a delay free system 26 z k 1 a z k b u k d f k k 1 2 z 0 x 0 0 where b a m c a b 1 for the transformed system 26 we consider the infinite time control index 27 j z lim n 1 2 n k 0 n z t k q z k u t k r u k to make the performance indices in 23 and 27 equivalent j j z the following equations should hold 28 x t k u t k θ x t k u t k t x t k θ 11 x k u t k θ 21 x k x t k θ 12 u k u t k θ 22 u k z t k q z k u t k r u k x t k q x k x t k q h u k u t k h t q x k u t k h t q h u k u t k i 1 t r i 1 u k then one can yield 29 θ 11 q θ 12 q h θ 21 h t q θ 22 h t q h i 1 t r i 1 when 29 holds the performance indices 23 and 27 are equivalent then we can design the networked controller based on the transformed system 26 and index 27 one can see that the system with control delay can be transformed into the delay free system by 24 the transformation based method 24 is effective and easy to complete for the point to point control system with time delay in control ma et al 2009 however for the networked control of offshore platform z k in the transformed delay free system 26 is just decided by initial system state z 0 x 0 0 and does not reflect network communication conditions correspondingly problems due to network such as packet dropouts and disordering cannot be compensated effectively by the controller based on 26 by the way the outside loads in most literature are irregular wave forces not affected by current and in the paper we consider the forces due to wave and current together in the followings based on the networked control model and the total wave current force model we will present the networked vibration controller suitable for offshore platform in the nonideal network communication 4 2 controller design based on the transformed system 26 and performance index 27 and taking time delay packet dropouts and disordering into account we get the following modified transformation based networked control ntc law theorem 1 considering networked vibration control for offshore platform described by 2 with time delays packet dropouts and disordering we present the following networked modified transformation based control ntc law 30 u k s 1 b t p 1 a a m s c x k i 0 m s c 1 a i b 1 u k i 1 m c a i 0 m s c 1 a i d f k 1 i j 0 m c a 1 a j m c a b 1 u k j 1 s 1 b t p 1 d f p 2 g w k s 1 b t p 1 d p 3 f c k u k u k m c a d k c a 0 u k 1 d k c a 0 u k 0 k m c a m c a 1 0 x k x k m s c d k s c 0 x k 1 d k s c 0 x k x 0 k m s c m s c 1 0 where s r b t p 1 b p 1 is the unique positive definite solution to the discrete riccati equation 31 a t p 1 a a t p 1 b s 1 b t p 1 a p 1 q 0 p 2 is the unique solution to sylvester equation 32 a t i p 1 b s 1 b t p 2 g p 2 a t i p 1 b s 1 b t p 1 d f 0 p 3 is the unique solution that depends on the value of p 1 33 p 3 a t i p 1 b s 1 b t p 1 d p 3 proof firstly we consider the networked control system 22 based on the transformation 24 we get the control system without delay in control 26 here the outside load f k consists of wave and current forces 21 applying the maximum principle to system 26 and quadratic function index 27 we get the optimal control law 34 u k r 1 b t λ k 1 k 0 1 2 where λ k is the solution to the following two point boundary value tpbv problem 35 z k 1 a z k b r 1 b t λ k 1 d f k λ k q z k a t λ k 1 k 0 1 2 z 0 x 0 λ 0 to solve 35 let 36 λ k p 1 z k p 2 w k p 3 f c k then the optimal control law 34 can be rewritten as 37 u k s 1 b t p 1 a z k p 1 d f p 2 g w k p 1 d p 3 f c k 0 1 2 where s r b t p 1 b and 38 λ k q a t i p 1 b s 1 b t p 1 a z k a t i p 1 b s 1 b t p 1 d f p 2 g w k a t i p 1 b s 1 b t p 1 d p 3 f c comparing the coefficients of 36 and 38 we obtain equations 31 33 in 37 the feedback item in control force u k is based on z k in 26 to reflect the network conditions in real time we introduce the output of buffer 1 and the past time information into the controller noting z k x k j 0 m c a 1 a j m c a b 1 u k j 1 and x k a m s c x k i 0 m s c 1 a i b 1 u k i 1 m c a i 0 m s c 1 a i d f k 1 i we get the following modified transformation suitable for the networked control system 39 z k a m s c x k i 0 m s c 1 a i b 1 u k i 1 m c a i 0 m s c 1 a i d f k i 1 i 0 m c a 1 a i m c a b 1 u k i 1 and the controller 37 can be rewritten as following equation 40 u k s 1 b t p 1 a a m s c x k i 0 m s c 1 a i b 1 u k i 1 m c a i 0 m s c 1 a i d f k 1 i j 0 m c a 1 a j m c a b 1 u k j 1 s 1 b t p 1 d f p 2 g w k s 1 b t p 1 d p 3 f c secondly we solve the problem of packet dropouts and disordering due to network considering the outputs of buffer 1 and buffer 2 we can obtain the networked modified transformation based controller 30 x k x k m s c d k s c 0 x k 1 d k s c 0 x k x 0 k k m s c m s c 1 0 u k u k m c a d k c a 0 u k 1 d k c a 0 u k 0 k m c a m c a 1 0 based on the time stamps the buffers can sort the packets received from network and we can deal with the problem of disordering by the networked vibration controller 30 the problem of time delay packet dropouts and disordering due to nonideal network can be solves step by step we can see that the controller is physical realizable this completes the proof remark 2 z k in 26 can be determined by m c a and x 0 0 but the packet dropouts and disordering are not considered in the transformation then in the paper we adopt the modified transformation 39 based on the z k in 39 the networked controller 30 is completed then the time delay packet dropouts and disordering are considered in the design of controller in the followings we consider the computation of the controller and design an algorithm to get efficient progress for updating of control values in the controller 30 there are three different sums i 0 m s c 1 a i b 1 u k i 1 m c a i 0 m s c 1 a i d f k 1 i and j 0 m c a 1 a j m c a b 1 u k j 1 one can yield that computation time of controller and the size of buffers depend on m c a and m s c for the severe sea environment and nonideal network communication the big time delay m c a and m s c may bring complex computation of controller for the controller 40 we have the following algorithm 1 to update the controller and simplify the computation let s 1 k i 0 m s c 1 a i b 1 u k i 1 m c a s 2 k i 0 m s c 1 a i d f k 1 i s 3 k j 0 m c a 1 a j m c a b 1 u k j 1 then z k a m s c x k s 1 k s 2 k s 3 k in algorithm 1 s i k i 1 2 3 are computed by sums of three items but not the sum of m s c items or m c a items as original definitions for the big time delays the complexity of computation can be reduced obviously algorithm 1 step 1 k m 2 s 1 k i 0 m s c 1 a i b 1 u k i 1 m c a s 2 k i 0 m s c 1 a i d f k 1 i s 3 k j 0 m c a 1 a j m c a b 1 u k j 1 m m s c m c a step 2 s 1 k 1 a s 1 k b 1 u k m c a a m s c b 1 u k m c a m s c s 2 k 1 a s 2 k d f k a m s c d f k m s c s 3 k 1 a s 3 k a m c a b 1 u k b 1 u k m c a step 3 if k n k k 1 return to step 2 n is the end of computation time else exit 5 stability analysis in this section we provide the bound stability condition of networked control system 2 theorem 2 the networked control system 2 is bound stable if there exit matrices p r n n and q r n n satisfying p q 0 0 p 0 proof for the transformed system 26 we define a lyapunov function 41 v z k v 1 z k v 2 z k where 42 v 1 x k z t k p z k v 2 x k s k d c a k k 1 z t s q z s let z k z t k w t k f c t then 43 z k i 0 0 z k δ λ 1 z k 44 z k 1 a b s 1 b t p 1 a z k d f b s 1 b t p 1 d f p 2 g w k d b s 1 b t p 1 d p 3 f c δ π 1 π 2 π 3 z k δ λ 2 z k where π 1 a b s 1 b t p 1 a π 2 d f b s 1 b t p 1 d f p 2 g π 3 d b s 1 b t p 1 d p 3 from 45 we get 45 z t k 1 p z k 1 z t k λ 2 t p λ 2 z k then 46 v 1 z k 1 v 1 z k z t k 1 p z k 1 z t k p z k z t k λ 2 t p λ 2 λ 1 t p λ 1 z k noticing that k 1 d c a k 1 k d c a k then one can yield 47 v 2 z k 1 v 2 z k s k 1 d c a k 1 k z t s q z s s k d c a k k 1 z t s q z s z t s q z s s k 1 d c a k 1 k 1 z t s q z s s k d c a k k 1 z t s q z s z t k q z k z t k λ 1 t q λ 1 z k therefore ncs 26 is asymptotically stable if following inequality holds 48 v x k 1 v x k z t k λ 2 t p λ 2 λ 1 t p λ 1 t λ 1 t q λ 1 z k z t k λ 1 t λ 2 t p q 0 0 p λ 1 λ 2 z k 0 it is obviously that 48 holds if there are positive definite matrices p and q making p q 0 0 p 0 that means ncs 26 is asymptotically stable from 24 and 37 we can see that 49 x k z k m c a max 0 j m c a 1 a j m c a b 1 s 1 b t p 1 a z k j 1 m c a max 0 j m c a 1 a j m c a b 1 s 1 b t p 1 d f p 2 g w k j 1 m c a max 0 j m c a 1 a j m c a b 1 s 1 b t p 1 d p 3 f c because z k w k and f c are bounded x k is bounded then the networked control system for offshore platform under the presented controller is stable this completes the proof from the theorem 2 we can see that the stability of the original system can be guaranteed by the stability of transformed system additionally when 29 hold the performance indices of 23 and 27 are equivalent j j z 6 simulation results and discussion in this section for the offshore platform in gulf of mexico ma et al 2019 validity of the networked vibration controller based on modified transformation will be verified by the simulation results the total height of offshore platform l 249 m diameter of four legs d 1 83 m the first modal mass m 1 7 825 307 kg natural frequency ω 1 2 0466 rad s structural damping ratio ξ 1 2 the mass of amd on the platform m 2 78 253 kg natural frequency ω 2 2 0074 rad s damping ratio ξ 2 20 the sea conditions are shown as followings wave depth d 218 m density of seawater ρ 1028 4 k g m 3 drag coefficient c d 1 0 inertia coefficient c m 1 5 in the paper we express the irregular wave by jonswap spectrum 50 s η ω 5 h s 2 16 ω 0 ω 0 ω 5 exp 1 25 ω ω 0 4 γ β where h s is significant wave height ω 0 is peak frequency ω is wave frequency σ is shape parameter σ 0 07 ω ω 0 σ 0 09 ω ω 0 β exp ω ω 0 2 2 σ 2 ω 0 2 γ is peakedness parameter here h s 7 m ω 0 0 79 rad s and γ 3 3 and we assume that the constant velocity of current v c 1 0 m s and the angle between current and wave forces α π 4 the power spectrum density psd of wave elevation is shown in fig 3 and the total outside force including wave and current in fig 4 in the paper we use the following infinite time control index j z lim n 1 n k 0 n z t k q z k u t k r u k where q 10 7 d i a g 1 0 1 0 r 10 5 n 210 t t 0 01 s 6 1 analysis of the modified transformation based networked controller ntc is the presented controller 30 in the paper in this subsection we focus on the performance analysis of the presented ntc in nonideal network conditions firstly we study the system performance with the fixed time delay upper bounds and varying packet dropouts rates secondly for the fixed packet dropouts rate we research the validity of the controller with varying upper time delay bounds 6 1 1 performance of the ntc with different packet dropouts rates in the subsection we consider different packet dropouts rates with large time delays in sensor controller and controller actuator channels let the upper bound of time delays due to network be m s c m c a 1 5 t 150 the packet dropouts rates are varying from 60 to 100 for the worst case the packet dropouts rate is 100 and there is no output packets received by the actuator the peak and standard deviation values of offshore platform under the presented ntc with different packet dropouts rates are shown in table 1 we can see that the peak and standard deviation values of the offshore platform increase with the packet dropout rates and the presented controller ntc can keep the system performance satisfied and no sharp increase occurs when the packet dropout rate increase from 0 to 95 when m s c m c a 1 5 t and δ 1 δ 2 0 97 99 the displacement and acceleration of the offshore platform are shown in figs 5 6 and the output of actuator u k is shown in fig 7 6 1 2 performance of the ntc with different time delays upper bounds and fixed packet dropouts rate to illustrate the affection of upper bound of time delay we assume that packet dropout rate is fixed as δ 1 δ 2 96 in table 2 m c a 1 5 t 150 and m s c is increasing from 20 to 420 in table 3 m s c 1 5 t 150 and m c a is increasing from 20 to 420 we can see that under the presented ntc with the increase of time delay the performance index j z of offshore platform shows the trend of worse comparing tables 2 and 3 one yields that the system performance is influenced more obviously by m c a than m s c 6 2 comparison with the other networked controllers in this subsection we compare the different networked controllers with ntc for the same sea conditions as subsection 6 1 we compare four different networked controller ntc ntc1 npffoc ma et al 2019 and npsfoc ma et al 2019 here ntc is the presented networked controller 30 in the paper and ntc1 is the controller 37 based on the transformed system 26 one can see that ntc is based on the modified transformation 39 and considers the network communication in the transformed system but ntc1 is completed based on the transformation 24 and delay free system 26 the transformation 24 does not include the information of network communication and the transformed system 26 is a time invariant delay free system that can be decided by initial value for the offshore platform under irregular wave force with time delay packet dropouts and disordering due to network npffoc is networked predictive feedback and feedforward optimal controller and npsfoc is networked predictive state feedback optimal controller ma et al 2019 the current force is not taken into account in npffoc and npsfoc for npffoc and npsfoc we use the following infinite time performance index j x lim n 1 n k 0 n x t k q x k u t k r u k where q 10 7 d i a g 1 0 1 0 r 10 5 n 210 t as table 4 illustrates ntc can bring improvements of system performance compared with ntc1 npffoc and npsfoc the performance of ntc and npffoc are close to each other because the two controllers include the outside forces upper bounds of time delays and output of buffer1 x k besides the outside wave force considered by npffoc ntc takes current force into account from simulation results we can see that ntc achieves better system performance with less control force compared with npffoc though ntc and ntc1 are designed based on transformations there are difference between the system performance and control force ntc depresses the vibration of offshore platform more efficiently than ntc1 with less control force because ntc is designed based on the modified transformation 39 but ntc1 is completed based on the transformation 24 that does not consider the packet dropouts of network transmission when the packet dropouts rate is big for example δ 1 δ 2 97 the control force of ntc1 is not sufficient enough to depress the vibration attitude compared with ntc 7 conclusions in this work we design a networked modified transformation based control law for offshore platform over sensor network with random time delay packet dropouts and disordering in sensor controller and controller actuator channels the wave and current forces acting on the offshore platform are modeled synchronously we design the networked vibration controller based on two buffers outside wave and current forces and the modified transformation the modified transformation takes the network communication into account then the presented networked controller can address the problems of big time delay continual packet dropouts and disordering due to unideal network communication and ensure the stability of networked control system simulation results demonstrate the validity of the developed controller and the comparison of different networked controller show the effectiveness of the presented ntc in the paper acknowledgements this work was supported by the national natural science foundation of china nsfc grants no 41276085 61379029 and 61572448 
22459,in this study the evolution of the propeller tip vortex and its effect on the rudder surface pressure fluctuation was investigated using large eddy simulation in this simulation the flow domain was discretized using a trimmed mesher an e779a propeller and a rudder with the naca0020 profile were used in the simulation the q criterion method was used to evaluate the wake of the propeller the numerical simulation results were verified via extensive convergence studies and using experimental data the relationship between the vortex flow field and advance ratio was studied the pressure fluctuation over the rudder surface was analyzed in the frequency domain simulation results showed that the propeller tip vortex became dislocated and shrank owing to its interactions with the propeller the effect of the blade tip vortex leads to a strong periodicity of the rudder surface pressure while that within the hub vortex is relatively random keywords propeller rudder interaction vortex rudder surface pressure frequency domain 1 introduction the interaction between a propeller and a rudder is a classical problem in naval hydrodynamics and is directly related with the speed and maneuverability of marine vessels strong interactions between the propeller and rudder will significantly affect the optimization process for achieving high propulsive efficiency badoe 2016 detailed studies on these interactions can also accelerate developments in terms of better energy saving appendages such as ducts fins and specialized rudders above all studying the hydrodynamic interactions between the propeller and rudder is critical and of considerable significance in the development of high performance marine vessels several experimental and numerical investigations have been conducted for studying the interactions between the propeller and rudder earlier studies were mainly aimed at improving the overall performance mainly the propulsive efficiency and maneuverability of a marine vessel veldhuis et al 2005 badoe used reynolds averaged navier stokes rans equations and analyzed propulsive efficiency flow straightening and rudder maneuvering good agreement was found between the experimental and computational results badoe et al 2015 badoe also demonstrated that power requirements can be reduced by optimizing the interaction between the rudder and propeller badoe et al 2012 muscari investigated the hull propeller rudder interactions for a twin screw twin rudder model using unsteady rans simulations particularly focusing on the asymmetry of the propeller rudder system muscari et al 2017b moreover a free running maneuvering simulation was also performed to gain more insight into the transient phase of the maneuver a comprehensive time accurate computational fluid dynamics cfd calculation based on rans equations requires significant computational resources results demonstrate that as long as the radial variation in axial and tangential momentums generated by the propeller are included the influence of the unsteady propeller flow can be removed and steady calculations were performed to evaluate the influence of the propeller on the rudder phillips et al 2009 besides the rans simulation the lifting surface method and panel method based on potential flow are also powerful tools for investigating the propeller rudder interaction basing on the panel method he and kinnas developed a numerical approach to simulate the unsteady interactions between the propeller and rudder using a fully unsteady wake alignment algorithm rosenhead moore core model and lamb oseen vortex model to avoid singularity instability and an unrealistically high induced velocity in the computation he et al 2017 li developed a nonlinear vortex lattice method vlm to predict the rudder forces during propeller rudder interactions in this method the slipstream location is calculated by satisfying the boundary condition of zero normal velocity li 1996 the strength density of the propeller free vortex sheet is determined by satisfying the boundary condition of equal pressure on the two sides of the free vortex sheet and solving the vorticity continuity and bernoulli equations by combining the advantages of both the potential flow method and viscous method an effective and economical coupled potential flow cfd approach is often used in more complicated cases using this approach berger et al performed a numerical simulation of propeller rudder interactions for non cavitating and cavitating flows berger et al 2015 mofidi simulated the zigzag maneuver of a kcs container ship the motions forces moments and mean flow field during the maneuver agreed well with experimental findings mofidi et al 2017 transient cavitation vibration and noise generation in the rudder lead problems in ship design that need to be addressed urgently all of these are related to the effect of the vortical flow in the propeller on the rudder especially vortex shedding from the hub and blade tip felli and calcagno investigated the evolution of the axial and radial velocity components behind a marine propeller the analysis demonstrated that within the near wake the tip vortices passage is the most important factor in generating the pressure field in the propeller flow if we focus on the transient force on the rudder then the unsteadiness and fluctuation of the vortical flow is critical in the present scenario felli et al 2006 calcagno et al 2003 felli performed a laser doppler velocimetry test to analyze the flow around a marine propeller and found that the effect of the unsteadiness of the propeller load caused a secondary structure shedding near the tip vortex whose intensity and direction changed owing to the modulation of the circulation under variable loading conditions felli et al 2005 the features of the wake were also investigated using the λ 2 c r i t e r i o n jeong et al 2006 it was found that the typical flow variables pressure velocity and vorticity of the instantaneous flow field were closely related to the evolution of the tip and hub vortices muscari et al 2017a mascio et al performed a numerical simulation to analyze the rudder surface pressure and its phase variation against propeller tip and hub vortex shedding for a single bladed propeller and an naca0020 rudder using the rans method mascio et al 2015 the propeller thrust and torque fluctuation coefficient peak in drift navigation are greater than that in straight line navigation and the negative drift angle is greater than the positive one the fluctuations in the peak variation coefficients of the side force and bending moment are different because of various reasons sun et al 2018a for the detailed vortex shedding problem it has been verified that rans simulation is too dissipative to capture the unsteady fluctuation of the flow although it gives very good prediction of global quantities such as thrust and torque muscari et al 2013 using stereo particle image velocimetry stereo piv to correlate the blade surface boundary layers and acoustic perturbation with the unsteady load variations in the rudder and shear layer fluctuations of the propeller stream shedding calcagno et al 2005 conversely the dynamics of the propeller tip and hub vortices underlies hydrodynamic perturbations felli et al 2014 structural stresses and induced vibrations in the rudder are mainly influenced by the perturbation of the propeller tip and hub vortices whose contributions dominate the hydrodynamic part of pressure fluctuations different from the hydrodynamic perturbations the tip and hub vortex passage do have a significant effect on the acoustic field felli et al 2013 the onset and nature of dynamic instabilities experienced by the wake of a marine propeller set in oblique flow were investigated via detached eddy simulations the spectra of the kinetic energy were considered this investigation aimed to broaden the knowledge from previous works regarding rotor wake instabilities focusing on the differences between ideal and actual operating conditions occurring in typical engineering applications mascio et al 2014 motivated by the completed work and the importance of the vortex rudder interactions a numerical simulation was performed to investigate the instantaneous vortical flow in a propeller and rudder based on extensive convergence studies vortex shedding and its effect on the rudder were studied using large eddy simulation les the vortical structures in turbulent flow were analyzed in detail a systematic analysis was performed in the frequency domain on the fluctuating pressure on the rudder which will definitely enable a deeper understanding of rudder vibrations and the resulting undesired noise 2 numerical methodology in 1970 james deardorff published a seminal study that initiated the concept of large eddy simulation les which the dynamics of fluid motion is analyzed separately at large and small scales with a boundary cut off length the large scale motion was explicitly computed while the small scale fluctuations was statistically modelled to separate the large scale motion and small scale fluctuation a spatial filtering of the instantaneous velocity was used in physical space the filter is a running average such as a three point running average replaces u x by 1 u x 1 4 u x δ x 2 u x u x δ x where the variable with indicates a filtered variable mori et al 2013 based this we can get an n point average replaces u x by 2 u x 1 2 n u x n δ x u x n δ x 2 2 u x u x δ x based the pade average a sharper filter can be constructed 3 u x α u x δ x u x δ x a u x 1 2 b u x δ x u x δ x 1 2 c u x 2 δ x u x 2 δ x according the lele s research for a fourth order accuracy the constant should be selected as 4 a 5 6 α 8 b 1 2 α 2 c 2 α 1 8 lele also shows that a filter that is flat for small k and cuts off sharply at large k will appears when α 0 45 based on that a more general weighted running average form can be obtained 5 u x j n n u x j δ x w j where the weight w j sum to unity which w j 1 then the general running average can be represented as an integral 6 u x δ f δ f f x ξ x u ξ d ξ the variable in the navier stokes equations can be instead by the variable with hat which means a filtered variable the filtered navier stokes equations are written as 7 u i t x j u i u j p ρ x i v x j u i x j τ i j x j where τ i j is the subgrid scale stress among explicit models the smagorinsky model is the most popular and was used in this simulation in this model an eddy viscosity v s g s and resolved rate of strain tensor s i j is used 8 τ i j 2 v s g s s i j the resolved rate of strain tensor s i j and eddy viscosity v s g s can be solved by 9 s i j 1 2 u j x i u i x j 10 v s g s c s δ 2 2 s 2 c s δ 2 2 s i j s j i the mixing length c s δ is proportional to the grid spacing and the c s is an empirical constant which can be calculated by kolmogorov constant c k 11 c s 1 π 3 2 c k 3 4 the grid spacing δ can be defined as δ δ x δ y δ z 1 3 on a cartesian grid based on the formula mentioned above the les can be achieved by the numerical method germano et al 1998 3 test case and computational mesh a propeller and finite rudder are considered the layout is similar to the experimental setup used in felli and falchi 2011a but the geometry adopted for the simulation does not model tunnel walls the propeller selected for this study is the insean e779a model the simulations were carried out under a moderate loading condition namely at j 0 88 which is representative of the actual propeller operating condition at cruise speed fig 1 shows the propeller rudder system and the essential geometric characteristics are summarized in table 1 fig 1 shows the inertial frame of reference used for the numerical simulations the x axis pointing downstream coincides with the propeller axis the z axis is directed upward and the y axis follows the right hand rule fig 2 the computational domain is a streamwise cylinder with a diameter thrice the propeller diameter and a length of 4 5 times the diameter the distance between propeller and rudder is 0 5 times the diameter the mesh used in the simulations consists of 1 79 million overlapping volumes for a total of approximately 12 90 million volumes the side of the flow domain was set as symmetry plane so there is no side wall effects see fig 2 with that the input boundary was set as velocity input with the synthetic turbulence specification and the synthetic turbulence mass flow scaling specification were turn off so there is no inflow turbulence defined the outlet was set as pressure outlet so the flow which arrive to the outlet have no effect to the flow in the flow domain moreover the portion of the rudder located in the propeller slipstream was discretized using finer cells to capture the details of the interaction between the primary vortex and rudder the outer portions of the rudder were discretized with a coarser mesh to reduce the computational cost the meshing strategy followed for the propeller blade and rudder is schematically represented in fig 3 the inlet velocity is 5 m s and outlet pressure is 101325 pa in the numerical simulations the rotational speed of the propeller was kept fixed at n 25 r p s 4 uncertainty analyses for des the flow field in the boundary layer was resolved by the rans where in the far field the flow field was simulated by s a the vortex shedding obtained by les and des under same gridding configuration in the propeller rudder system was compared and shown in fig 4 from fig 4 the disappearance of the vortex shedding by des is earlier than that by les this phenomenon not only appears when advance ratio j 0 88 it is commonly in the whole range of the advance ratio the vortex shedding in j 0 6 j 0 8 j 1 0 under des and les were shown in fig 5 the vorticity field obtained by des and les were compared in fig 6 from which it can be seen that the tip vortex by des dissipates much more rapidly than that by les fig 7 a and b show the pressure distribution on the rudder which obtained by des and les the frequency domain of the pressure fluctuation recorded by the probe located at z 0 1135 m x 0 1135 m y 0 m was compared in fig 7 c where k is the frequency and a is the amplitude the period and the amplitude of the pressure fluctuation by les and des are consistent with each other generally the tip vortex by les exists longer than that by des the pressure on rudder surface by des is larger than that by les in time domain but the fluctuation in frequency domain agree with each other very well it is important to verify the present numerical simulation by experimental data a b4 55propeller and a naca0020 rudder were used to verify the method and the comparison was shown in fig 8 the results obtained by simulation coincide very well with the results by experiment to obtain an estimation of the numerical uncertainty three grid levels were used because a further reduction of the coarse mesh would lead to a highly coarsened grid unable to resolve many important flow features whereas further refining of the fine mesh would have required extremely large computing resources according to the study by bensow 2010 a value of y 10 and a value of x 300 are enough for the simulation and the obtained vortex agrees very well with that by experiments in the present study a finer meshing is applied the grid in present research was set as y 6 with on the propeller on the rudder surface the y was set as 30 and x z 90 the growth of the layer thickness was set as 1 5 the different blocks add up to provide the total number of cells and their relative weight is detailed in table 2 roache stern and ittc have reported the method to determinate the uncertainty of the computation roache et al 1997 stern et al 2006 ittc 2002 the grid uncertainty analysis was carried out referring to the ittc procedure as time goes on the statistics become convergent and the curves become steady which can be seen from fig 9 where t s is the thrust on the single blade the period of revolution is 0 04 s for third cycle of the rotation t 0 08 0 12 s t s 69 8862 n for fourth cycle of the rotation t 0 12 0 16 s t s 69 9767 n the error of them is lower than 0 20 so present research have been convergent after t 0 12 s all the statistics begin recording when the simulation become convergent after t 0 12 s the thrust k t torque 10 k q force on the rudder 100 c l and pressure fluctuation c p 0 were considered the results were shown in the table 3 we first estimated the solution variation as ε f 2 f 1 and r g ε 21 ε 32 where f 1 is the coarse grid numerical solution obtained with grid spacing h 1 f 2 is the fine grid numerical solution obtained with grid spacing h 2 r g is the convergence ratio ε is the change between the results obtained by different three grid levels p is the formal order of the accuracy of the algorithm which can be obtained using p in f 3 f 2 f 2 f 1 in r δ ε 1 r g p 1 then the correction factor g can be obtained g r p 1 r p g 1 where r g is the refinement factor between the coarse and fine grid r g h 2 h 1 δ is the error p g is the estimate for the limiting order of accuracy p g 2 is recommended by ittc then uncertainty u g can be obtained as u g g δ 1 g δ the thrust coefficient k t torque coefficient 10 k q of the propeller and the resistance coefficient 100 c l pressure coefficient c p 0 of the rudder can be obtained by the equations k t t p n 2 d 4 k q q p n 2 d 5 c l l 1 2 p v a 2 s k t p 0 1 2 p v a 2 where t q is the thrust and torque of the propeller ρ is the density of the water n is the rotational speed of the propeller d is the diameter of the propeller l is the force on the rudder in x direction the v a is the advance velocity which corresponding to the advance ratio s l c 0 108 m 2 l is the chord length of the rudder l 0 18 m p 0 is the pressure on the probe which locates at z 0 1135 m x 0 1135 m y 0 m all values of the parameter were recording when the numerical simulation converges t 0 12 s all the parameters show monotonic convergence it can be observed from table 3 that the difference between the finer and coarser values is almost indistinguishable while 10 k q shows a greater sensitivity to mesh refinement 10 k q is more dependent on a correct estimation of the viscous forces in the boundary layer it can be concluded that from the viewpoint of global quantity estimation fine gridding can yield satisfying results on this basis the vorticity field at z 0 under different grid sizes is compared in fig 10 in which the q c r i t e r i o n is used and q 1000 s 2 zhang et al 2018 hunt et al 1988 from fig 10 it can be seen that as the grid size increases vortex shedding dissipates more rapidly at a distance from the propeller and the detailed turbulence structure is lost to a large extent it is clearly shown in fig 9 c that the contour is blurred behind the rudder in the simulation a fine grid size could satisfyingly reveal the details of the vortical structure for a more effective simulation a fine grid size was used apart from the grid size the time step is also very important for solving the transient problem because a large time step size makes divergence easier and it cannot capture the flow field in sufficient detail in previous studies the time step often corresponded to a rotation of one degree of the propeller δ t 1 11 10 4 muscari et al 2017a in the case of a finer grid size to analyze the influence of the time step size numerical simulations were carried out with four time step sizes δ t 5 10 5 δ t 1 10 4 δ t 2 10 4 and δ t 4 10 4 s which respectively correspond to rotational angles of 0 45 0 9 1 8 and 3 6 for a single propeller table 4 and fig 11 present the hydrodynamic forces at different time steps the results of the time steps uncertainty analysis are summarized in table 4 it can be observed that propeller loads computed at smaller time steps are very close to those at large time steps especially when time step was smaller than δ t 2 10 4 thus for performance prediction δ t 2 10 4 can be considered reliable however from fig 12 it can be seen that the vortex shedding are very different at different time steps at a large time step δ t 4 10 4 s the vortex shedding disappears at a very short distance from the propeller generally a simulation involving vortex shedding is more sensitive to the time step than that involving hydrodynamic loads of the propeller wang et al 2013 so the time steps was chose as δ t 1 10 4 s if not specified in the following numerical simulation the time step is chosen to be δ t 1 10 4 s the convergence of the simulation can also be verified by the periodicity of the problem for the convergence of results the simulations at every 90 should agree with each other for the four bladed propeller in present simulation as shown in fig 13 the characteristics are verified to a large extent for the tip vortex however for the hub vortex the simulation slightly diverges owing to its weaker strength and easier dissipation in the viscous flow and there is no vorticity in the inflow to the propeller 5 results based on previous convergence studies a fine grid size and δ t 1 10 4 s were used in the present simulation the unsteady hydrodynamic loads developed by the rudder were investigated both in terms of pressure distributions and the resultant loads during a complete period of revolution and were related to the featuring phases of the interaction between the tip vortex and rudder obviously the contact of the tip and hub vortex with the rudder will cause more complicated instantaneous loads on the rudder surface thus in this section the pressure distributions and resultant loads on the rudder during a vortex shedding rudder interaction are discussed 5 1 vortical structure at different advance ratio the analysis of the flow field is carried out for five values of the advance coefficient j 0 4 0 6 0 8 1 0 1 2 in this study the rotational speed of the propeller was set at n 25 rps and the different advance coefficients j v a n d were obtained by changing the inflow velocity v a numerical results obtained with a les simulation are presented in table 5 a lower j indicates stronger hydrodynamic loading and subsequently stronger vortex shedding vortex shedding at different j values are compared in fig 14 in which q c r i t e r i o n 1000 s 2 and the colour bar represents the magnitude of the axial velocity longitudinal views of the vortical structures in the near wake of the propeller for different advance ratios are shown in fig 14 regardless of the advance ratio the tip vortices originated owing to a pressure difference between the upper and lower surfaces of each propeller blade the trailing vortices appear within the tip of the propeller blade forming a cycloidal vortex shedding which is shown in the longitudinal views a hub vortex originated from the center of the hub and stretched downstream however the evolution and formation of the vortices along the axial direction depend on the advance ratio baek et al 2015 at lower advance ratios the tip vortices merge with each other and the neighboring trailing vortices forming a larger vortex downstream as shown in fig 13 a and b for j 0 4 and j 0 6 respectively this vortex merging was experimentally observed by felli for a different four bladed propeller felli et al 2008 after merging the shape of the tip vortex distorts the trailing vortices are rapidly diffused and successive vortex sheets disappear just behind the propeller which is clearly observed in the longitudinal view this type of quick diffusion and the distortion of the trailing vortices by the wake roll up process were reported by controni et al 2000 as the advance ratio increases to j 0 8 the merging of vortices is delayed further downstream which is consistent with the results of carrica et al and castro et al carrica et al 2010 castro et al 2011 consequently the periodical array of the consecutive tip vortices extends further downstream as shown in fig 13 c this can be supported by the distance between two consecutive tip vortices owing to a significant reduction in the perturbation velocity components as the advance ratio increases further the hydrodynamic load of the propeller becomes very weak and is more easily susceptible to viscous dissipation thus the vortex shedding disappears in the vicinity of the propeller as shown in fig 13 d and e 5 2 dislocation of the vertical flow in the simulation with j 0 8 the propeller tip vortices underwent a progressive deformation and spanwise outward dislocation when approaching the leading edge of the rudder during the interaction with the rudder the tip vortex split in two branches flowing on the opposite sides of the appendage these were linked by vortex lines embedded in the boundary which was defined as dislocation of the flow muscari et al 2017a for further analysis of the dislocation a simulation with j 0 88 was performed the vorticity and velocity at z 0 95 r plane were investigated and compared with experimental results obtained under the same conditions which finished by felli 2011b fig 15 shows the axial velocity at z 0 95 r the present numerical result agrees very well with that by experiment although he vortex core in the experiment is more distinct the high flow velocity area appears both at starboard side y 0 and port side y 0 of the rudder but the axial velocity at starboard side y 0 have a larger value compared to that at the port side y 0 fig 16 present the axial velocity at y 0 05 r and that at y 0 05 r from which it can be seen that the slipstream is actually dislocated by the rudder from fig 16b it is observed that the downstream wake at starboard side is lifted it also can be seen the propeller wake accelerates in the vicinity of the rudder in the port side the highest axial velocity appears in the upper part whereas in the starboard side it appears in the lower part as shown in fig 17 the numerical results are consistent with the experimental results but the tip vortex in the experiment is more slender than that obtained by simulation for the tip vortex of the propeller the vorticity at the starboard side y 0 is negative when that at the port side y 0 is positive on the rudder surface the vorticity is positive on starboard side and negative on port side due to the rotational wake by the propeller on port side the tip vortex upside the rudder is lowered under z 0 95r by the rudder and was not shown in the plane it can be seen from figs 15 17 that there is an outstanding dislocation in the flow field around the rudder 5 3 force acting on the rudder surface it was found that the rudder could complicate the flow evolution these complexities are reflected in the unsteadiness of the rudder loading the unsteadiness results in the time and space dependence of pressure fluctuations over the rudder surface the pressure coefficient at different time instants is shown in fig 18 the pressure coefficient c p can be obtained by c p p 1 2 ρ v a 2 where p is the pressure on the rudder surface the v a is the advance velocity which corresponding to the advance ratio to showing the pressure distribution more clearly the whole rudder isn t shown only the central part of the rudder is shown to analyze the details of the fluctuating rudder load the power spectral density psd of pressure on the surface of the rudder was considered according to the study finished by sun c the pressure on the rudder surface shows a very strong periodicity which corresponding to the blade frequencies sun et al 2018b psd analysis was performed to analyze the pressure fluctuation in the frequency domain the flow variables got from the simulation are collected for a period of approximately seven revolutions during the stabilized regime to capture the relevant statistical properties of the flow note that for the choice of reference quantities the non dimensional passing frequency of the blade corresponds to k 1 as shown in fig 19 the pressure on the rudder was monitored by probes positioned on the rudder surface at y 0 over the area covered by the propeller slipstream during the traveling phase eleven rows of probes were positioned along the span of the rudder each row consisting of six probes along the chord see fig 19 in particular the probes were clustered around the tip and hub vortex trajectories on both the suction z 0 and pressure z 0 sides each probe n m was identified using two indices n increasing with z and m increasing from the leading to the trailing edge among which 6 m m 1 2 3 6 is located behind the propeller hub z 0 m 2 m m 1 2 3 6 and 10 m m 1 2 3 6 were located behind the propeller tip z 0 1135 m n 1 n 1 2 3 11 were located at the front of the rudder n 6 m 1 2 3 11 were located at the trail of the rudder 5 3 1 psd analysis of pressure fluctuation psd analysis was performed for the pressure monitored by the probes shown in fig 19 the spectra were characterized by tonal components associated with the passage of the vortex the strongest harmonic being associated with k 1 the psds at representative probes m 1 on the suction and pressure side are shown in fig 19 where a is the amplitude of the pressure fluctuation from fig 20 it can be seen that the pressure at the probes n 2 10 within the tip vertical flow shows a clear periodicity while that at n 6 within hub vortical flow does not further it was found the pressure magnitude at n 4 and n 8 was much smaller than that at n 2 10 and n 6 which are located directly in the tip and hub vortexes this indicates that the propeller vortex shedding will significantly increase the pressure on the rudder surface this can verify partly that the hub and tip vortexes are separated to some extent salvatore et al 2009 although we generally assume that the tip vortex is stronger and emerge earlier than the hub vortex the pressure within the hub vortex is actually higher than that within the tip vortex this is because the hub vortex due to the blade root loading and hub rotation is twined and complicated at the hub end while the tip vortex is quite separated at the blade tips more interestingly it is found the pressures on the upper and lower parts on the rudder surface at same time instant are very different as observed in fig 18 however their psds are very symmetric as shown in fig 20 particularly for the probes outside of the shedding hub vortex this means the random and chaotic vibration of the rudder was mainly caused by the pressure fluctuation on the rudder surface due to the hub vortex shedding psd analysis for chordwise pressure fluctuation was performed as shown in fig 21 from the comparison of fig 21 a 21 f it was inferred that a more chaotic pressure fluctuation generally appears in two areas one is where the hub vortex passes and the other is where the vortex dissipates in fig 21 a the pressure psd at probes n 1 m 1 6 is presented in this case the probes n 1 m 1 4 are away from the hub vortex shedding and their psd show very clear blade frequency periodicity however for probes n 1 m 5 6 the pressure fluctuations are very chaotic which indicates that the tip vortex has started to dissipate comparing the psd at probe 1 5 in fig 21 a and that at probe 2 5 in fig 21 b we found the latter to be more periodic as probe 2 5 is more aligned with the tip vortex shedding this indicates that the dissipation starts from the outer region of the tip vortex and the vortex cube core is more immune to dissipation as the probes move close to the center of the rudder as shown in fig 21 c the periodicity again tends to be weaker as the probe moves away from the tip vortex the smallest pressure fluctuation appears at probes n 4 m 1 6 where the probes are just between the tip and hub vortex as the probe moves closer to the center of the rudder which is closer to the hub vortex the randomness of the pressure fluctuation increases and the magnitude of the pressure fluctuation increases this indicates that the hub vortex contributes more to the random vibration than the tip vortex generally from the above analysis we can infer that the tip vortex shedding tends to enhance the periodicity of the pressure fluctuation and the hub vortex shedding tends to weaken the periodicity of the pressure fluctuation fig 22 shows the comparisons of the pressure magnitude at different blade frequencies it can be easily concluded that as the frequency increases the pressure magnitude generally decreases comparing fig 22 a and b it can be seen the magnitudes are very much similar for the probes symmetric with respect to the chordwise center line of the rudder with the strongest harmonic being associated with k 1 5 3 2 psd analysis for the rudder surface behind a single bladed propeller the effect of the vortex shedding of a four bladed propeller on the rudder surface pressure is analyzed in the previous section which is very complex owing to the twined hub vortex and the interaction between the tip vortexes for simplicity and clarity psd analysis was performed for the rudder surface pressure with a single bladed propeller which is shown in figs 23 and 24 the probes are in the same locations shown in fig 19 generally the surface pressure behind a single bladed propeller shows stronger harmonic characteristics at blade frequencies comparing the pressure psd analysis at the same probes in figs 20 and 21 it is shown that the randomness is much stronger owing to the interaction between the four tip vortexes however it was found by comparing figs 21 and 23 that the fluctuation magnitude for a four bladed configuration was much smaller than that for a single bladed configuration this gives a very important suggestion that rudder vibration can be actually reduced by increasing the blade number of the propeller further it can be seen that on the suction side n 2 m 1 6 the amplitude of all the harmonic components gradually drop up to the midchord and then remain almost constant up to the trailing edge conversely on the pressure side n 10 m 1 6 we observed an abrupt reduction in the first and second harmonics immediately after the impact point and all the first six components remained constant along the profile this different behaviour was attributed to the differences in vortex stretching on the suction and pressure sides 6 conclusions the present paper deals with the propeller rudder interactions mechanisms and it is focused on the analysis of the evolution of the propeller vortical structures in a propeller under the influence of the rudder and its effect on surface pressure fluctuation of the rudder detailed knowledge of this flow is fundamental for the abatement of vibrations all these aspects were numerically investigated via les to this aim the flow was studied using a phenomenological approach by analyzing coherent structure evolution using the q criterion and quantitative approach by analyzing the psd of the pressure recorded at specific points located at different radial positions on the rudder wall the numerical simulation was verified using extensive convergence studies and experimental data for smaller j values the stronger the tip vortices the sooner they dissipated a different rate for the spanwise displacement was observed in the tip vortex filaments running on the pressure and suction sides of the rudder this difference is the consequence of the convective motion induced by the image vortex that occurs with a favourable adverse pressure gradient in the suction pressure side of the rudder some interesting conclusions can be drawn first the propeller tip vortex enhances the periodicity of the rudder surface pressure while the propeller hub vortex enhances the randomness of the pressure fluctuation however both will increase the fluctuation magnitude second the pressure fluctuation can be actually reduced by increasing the blade number of the propeller acknowledgement this work was supported by the national natural science foundation of china grant no 51679045 51579052 the fundamental research funds for the central universities grant no heucgf201814 and the foundation of equipment pre research grant no 6141b42862 61402100201 61402070503 6142204180408 6142407180108 
22459,in this study the evolution of the propeller tip vortex and its effect on the rudder surface pressure fluctuation was investigated using large eddy simulation in this simulation the flow domain was discretized using a trimmed mesher an e779a propeller and a rudder with the naca0020 profile were used in the simulation the q criterion method was used to evaluate the wake of the propeller the numerical simulation results were verified via extensive convergence studies and using experimental data the relationship between the vortex flow field and advance ratio was studied the pressure fluctuation over the rudder surface was analyzed in the frequency domain simulation results showed that the propeller tip vortex became dislocated and shrank owing to its interactions with the propeller the effect of the blade tip vortex leads to a strong periodicity of the rudder surface pressure while that within the hub vortex is relatively random keywords propeller rudder interaction vortex rudder surface pressure frequency domain 1 introduction the interaction between a propeller and a rudder is a classical problem in naval hydrodynamics and is directly related with the speed and maneuverability of marine vessels strong interactions between the propeller and rudder will significantly affect the optimization process for achieving high propulsive efficiency badoe 2016 detailed studies on these interactions can also accelerate developments in terms of better energy saving appendages such as ducts fins and specialized rudders above all studying the hydrodynamic interactions between the propeller and rudder is critical and of considerable significance in the development of high performance marine vessels several experimental and numerical investigations have been conducted for studying the interactions between the propeller and rudder earlier studies were mainly aimed at improving the overall performance mainly the propulsive efficiency and maneuverability of a marine vessel veldhuis et al 2005 badoe used reynolds averaged navier stokes rans equations and analyzed propulsive efficiency flow straightening and rudder maneuvering good agreement was found between the experimental and computational results badoe et al 2015 badoe also demonstrated that power requirements can be reduced by optimizing the interaction between the rudder and propeller badoe et al 2012 muscari investigated the hull propeller rudder interactions for a twin screw twin rudder model using unsteady rans simulations particularly focusing on the asymmetry of the propeller rudder system muscari et al 2017b moreover a free running maneuvering simulation was also performed to gain more insight into the transient phase of the maneuver a comprehensive time accurate computational fluid dynamics cfd calculation based on rans equations requires significant computational resources results demonstrate that as long as the radial variation in axial and tangential momentums generated by the propeller are included the influence of the unsteady propeller flow can be removed and steady calculations were performed to evaluate the influence of the propeller on the rudder phillips et al 2009 besides the rans simulation the lifting surface method and panel method based on potential flow are also powerful tools for investigating the propeller rudder interaction basing on the panel method he and kinnas developed a numerical approach to simulate the unsteady interactions between the propeller and rudder using a fully unsteady wake alignment algorithm rosenhead moore core model and lamb oseen vortex model to avoid singularity instability and an unrealistically high induced velocity in the computation he et al 2017 li developed a nonlinear vortex lattice method vlm to predict the rudder forces during propeller rudder interactions in this method the slipstream location is calculated by satisfying the boundary condition of zero normal velocity li 1996 the strength density of the propeller free vortex sheet is determined by satisfying the boundary condition of equal pressure on the two sides of the free vortex sheet and solving the vorticity continuity and bernoulli equations by combining the advantages of both the potential flow method and viscous method an effective and economical coupled potential flow cfd approach is often used in more complicated cases using this approach berger et al performed a numerical simulation of propeller rudder interactions for non cavitating and cavitating flows berger et al 2015 mofidi simulated the zigzag maneuver of a kcs container ship the motions forces moments and mean flow field during the maneuver agreed well with experimental findings mofidi et al 2017 transient cavitation vibration and noise generation in the rudder lead problems in ship design that need to be addressed urgently all of these are related to the effect of the vortical flow in the propeller on the rudder especially vortex shedding from the hub and blade tip felli and calcagno investigated the evolution of the axial and radial velocity components behind a marine propeller the analysis demonstrated that within the near wake the tip vortices passage is the most important factor in generating the pressure field in the propeller flow if we focus on the transient force on the rudder then the unsteadiness and fluctuation of the vortical flow is critical in the present scenario felli et al 2006 calcagno et al 2003 felli performed a laser doppler velocimetry test to analyze the flow around a marine propeller and found that the effect of the unsteadiness of the propeller load caused a secondary structure shedding near the tip vortex whose intensity and direction changed owing to the modulation of the circulation under variable loading conditions felli et al 2005 the features of the wake were also investigated using the λ 2 c r i t e r i o n jeong et al 2006 it was found that the typical flow variables pressure velocity and vorticity of the instantaneous flow field were closely related to the evolution of the tip and hub vortices muscari et al 2017a mascio et al performed a numerical simulation to analyze the rudder surface pressure and its phase variation against propeller tip and hub vortex shedding for a single bladed propeller and an naca0020 rudder using the rans method mascio et al 2015 the propeller thrust and torque fluctuation coefficient peak in drift navigation are greater than that in straight line navigation and the negative drift angle is greater than the positive one the fluctuations in the peak variation coefficients of the side force and bending moment are different because of various reasons sun et al 2018a for the detailed vortex shedding problem it has been verified that rans simulation is too dissipative to capture the unsteady fluctuation of the flow although it gives very good prediction of global quantities such as thrust and torque muscari et al 2013 using stereo particle image velocimetry stereo piv to correlate the blade surface boundary layers and acoustic perturbation with the unsteady load variations in the rudder and shear layer fluctuations of the propeller stream shedding calcagno et al 2005 conversely the dynamics of the propeller tip and hub vortices underlies hydrodynamic perturbations felli et al 2014 structural stresses and induced vibrations in the rudder are mainly influenced by the perturbation of the propeller tip and hub vortices whose contributions dominate the hydrodynamic part of pressure fluctuations different from the hydrodynamic perturbations the tip and hub vortex passage do have a significant effect on the acoustic field felli et al 2013 the onset and nature of dynamic instabilities experienced by the wake of a marine propeller set in oblique flow were investigated via detached eddy simulations the spectra of the kinetic energy were considered this investigation aimed to broaden the knowledge from previous works regarding rotor wake instabilities focusing on the differences between ideal and actual operating conditions occurring in typical engineering applications mascio et al 2014 motivated by the completed work and the importance of the vortex rudder interactions a numerical simulation was performed to investigate the instantaneous vortical flow in a propeller and rudder based on extensive convergence studies vortex shedding and its effect on the rudder were studied using large eddy simulation les the vortical structures in turbulent flow were analyzed in detail a systematic analysis was performed in the frequency domain on the fluctuating pressure on the rudder which will definitely enable a deeper understanding of rudder vibrations and the resulting undesired noise 2 numerical methodology in 1970 james deardorff published a seminal study that initiated the concept of large eddy simulation les which the dynamics of fluid motion is analyzed separately at large and small scales with a boundary cut off length the large scale motion was explicitly computed while the small scale fluctuations was statistically modelled to separate the large scale motion and small scale fluctuation a spatial filtering of the instantaneous velocity was used in physical space the filter is a running average such as a three point running average replaces u x by 1 u x 1 4 u x δ x 2 u x u x δ x where the variable with indicates a filtered variable mori et al 2013 based this we can get an n point average replaces u x by 2 u x 1 2 n u x n δ x u x n δ x 2 2 u x u x δ x based the pade average a sharper filter can be constructed 3 u x α u x δ x u x δ x a u x 1 2 b u x δ x u x δ x 1 2 c u x 2 δ x u x 2 δ x according the lele s research for a fourth order accuracy the constant should be selected as 4 a 5 6 α 8 b 1 2 α 2 c 2 α 1 8 lele also shows that a filter that is flat for small k and cuts off sharply at large k will appears when α 0 45 based on that a more general weighted running average form can be obtained 5 u x j n n u x j δ x w j where the weight w j sum to unity which w j 1 then the general running average can be represented as an integral 6 u x δ f δ f f x ξ x u ξ d ξ the variable in the navier stokes equations can be instead by the variable with hat which means a filtered variable the filtered navier stokes equations are written as 7 u i t x j u i u j p ρ x i v x j u i x j τ i j x j where τ i j is the subgrid scale stress among explicit models the smagorinsky model is the most popular and was used in this simulation in this model an eddy viscosity v s g s and resolved rate of strain tensor s i j is used 8 τ i j 2 v s g s s i j the resolved rate of strain tensor s i j and eddy viscosity v s g s can be solved by 9 s i j 1 2 u j x i u i x j 10 v s g s c s δ 2 2 s 2 c s δ 2 2 s i j s j i the mixing length c s δ is proportional to the grid spacing and the c s is an empirical constant which can be calculated by kolmogorov constant c k 11 c s 1 π 3 2 c k 3 4 the grid spacing δ can be defined as δ δ x δ y δ z 1 3 on a cartesian grid based on the formula mentioned above the les can be achieved by the numerical method germano et al 1998 3 test case and computational mesh a propeller and finite rudder are considered the layout is similar to the experimental setup used in felli and falchi 2011a but the geometry adopted for the simulation does not model tunnel walls the propeller selected for this study is the insean e779a model the simulations were carried out under a moderate loading condition namely at j 0 88 which is representative of the actual propeller operating condition at cruise speed fig 1 shows the propeller rudder system and the essential geometric characteristics are summarized in table 1 fig 1 shows the inertial frame of reference used for the numerical simulations the x axis pointing downstream coincides with the propeller axis the z axis is directed upward and the y axis follows the right hand rule fig 2 the computational domain is a streamwise cylinder with a diameter thrice the propeller diameter and a length of 4 5 times the diameter the distance between propeller and rudder is 0 5 times the diameter the mesh used in the simulations consists of 1 79 million overlapping volumes for a total of approximately 12 90 million volumes the side of the flow domain was set as symmetry plane so there is no side wall effects see fig 2 with that the input boundary was set as velocity input with the synthetic turbulence specification and the synthetic turbulence mass flow scaling specification were turn off so there is no inflow turbulence defined the outlet was set as pressure outlet so the flow which arrive to the outlet have no effect to the flow in the flow domain moreover the portion of the rudder located in the propeller slipstream was discretized using finer cells to capture the details of the interaction between the primary vortex and rudder the outer portions of the rudder were discretized with a coarser mesh to reduce the computational cost the meshing strategy followed for the propeller blade and rudder is schematically represented in fig 3 the inlet velocity is 5 m s and outlet pressure is 101325 pa in the numerical simulations the rotational speed of the propeller was kept fixed at n 25 r p s 4 uncertainty analyses for des the flow field in the boundary layer was resolved by the rans where in the far field the flow field was simulated by s a the vortex shedding obtained by les and des under same gridding configuration in the propeller rudder system was compared and shown in fig 4 from fig 4 the disappearance of the vortex shedding by des is earlier than that by les this phenomenon not only appears when advance ratio j 0 88 it is commonly in the whole range of the advance ratio the vortex shedding in j 0 6 j 0 8 j 1 0 under des and les were shown in fig 5 the vorticity field obtained by des and les were compared in fig 6 from which it can be seen that the tip vortex by des dissipates much more rapidly than that by les fig 7 a and b show the pressure distribution on the rudder which obtained by des and les the frequency domain of the pressure fluctuation recorded by the probe located at z 0 1135 m x 0 1135 m y 0 m was compared in fig 7 c where k is the frequency and a is the amplitude the period and the amplitude of the pressure fluctuation by les and des are consistent with each other generally the tip vortex by les exists longer than that by des the pressure on rudder surface by des is larger than that by les in time domain but the fluctuation in frequency domain agree with each other very well it is important to verify the present numerical simulation by experimental data a b4 55propeller and a naca0020 rudder were used to verify the method and the comparison was shown in fig 8 the results obtained by simulation coincide very well with the results by experiment to obtain an estimation of the numerical uncertainty three grid levels were used because a further reduction of the coarse mesh would lead to a highly coarsened grid unable to resolve many important flow features whereas further refining of the fine mesh would have required extremely large computing resources according to the study by bensow 2010 a value of y 10 and a value of x 300 are enough for the simulation and the obtained vortex agrees very well with that by experiments in the present study a finer meshing is applied the grid in present research was set as y 6 with on the propeller on the rudder surface the y was set as 30 and x z 90 the growth of the layer thickness was set as 1 5 the different blocks add up to provide the total number of cells and their relative weight is detailed in table 2 roache stern and ittc have reported the method to determinate the uncertainty of the computation roache et al 1997 stern et al 2006 ittc 2002 the grid uncertainty analysis was carried out referring to the ittc procedure as time goes on the statistics become convergent and the curves become steady which can be seen from fig 9 where t s is the thrust on the single blade the period of revolution is 0 04 s for third cycle of the rotation t 0 08 0 12 s t s 69 8862 n for fourth cycle of the rotation t 0 12 0 16 s t s 69 9767 n the error of them is lower than 0 20 so present research have been convergent after t 0 12 s all the statistics begin recording when the simulation become convergent after t 0 12 s the thrust k t torque 10 k q force on the rudder 100 c l and pressure fluctuation c p 0 were considered the results were shown in the table 3 we first estimated the solution variation as ε f 2 f 1 and r g ε 21 ε 32 where f 1 is the coarse grid numerical solution obtained with grid spacing h 1 f 2 is the fine grid numerical solution obtained with grid spacing h 2 r g is the convergence ratio ε is the change between the results obtained by different three grid levels p is the formal order of the accuracy of the algorithm which can be obtained using p in f 3 f 2 f 2 f 1 in r δ ε 1 r g p 1 then the correction factor g can be obtained g r p 1 r p g 1 where r g is the refinement factor between the coarse and fine grid r g h 2 h 1 δ is the error p g is the estimate for the limiting order of accuracy p g 2 is recommended by ittc then uncertainty u g can be obtained as u g g δ 1 g δ the thrust coefficient k t torque coefficient 10 k q of the propeller and the resistance coefficient 100 c l pressure coefficient c p 0 of the rudder can be obtained by the equations k t t p n 2 d 4 k q q p n 2 d 5 c l l 1 2 p v a 2 s k t p 0 1 2 p v a 2 where t q is the thrust and torque of the propeller ρ is the density of the water n is the rotational speed of the propeller d is the diameter of the propeller l is the force on the rudder in x direction the v a is the advance velocity which corresponding to the advance ratio s l c 0 108 m 2 l is the chord length of the rudder l 0 18 m p 0 is the pressure on the probe which locates at z 0 1135 m x 0 1135 m y 0 m all values of the parameter were recording when the numerical simulation converges t 0 12 s all the parameters show monotonic convergence it can be observed from table 3 that the difference between the finer and coarser values is almost indistinguishable while 10 k q shows a greater sensitivity to mesh refinement 10 k q is more dependent on a correct estimation of the viscous forces in the boundary layer it can be concluded that from the viewpoint of global quantity estimation fine gridding can yield satisfying results on this basis the vorticity field at z 0 under different grid sizes is compared in fig 10 in which the q c r i t e r i o n is used and q 1000 s 2 zhang et al 2018 hunt et al 1988 from fig 10 it can be seen that as the grid size increases vortex shedding dissipates more rapidly at a distance from the propeller and the detailed turbulence structure is lost to a large extent it is clearly shown in fig 9 c that the contour is blurred behind the rudder in the simulation a fine grid size could satisfyingly reveal the details of the vortical structure for a more effective simulation a fine grid size was used apart from the grid size the time step is also very important for solving the transient problem because a large time step size makes divergence easier and it cannot capture the flow field in sufficient detail in previous studies the time step often corresponded to a rotation of one degree of the propeller δ t 1 11 10 4 muscari et al 2017a in the case of a finer grid size to analyze the influence of the time step size numerical simulations were carried out with four time step sizes δ t 5 10 5 δ t 1 10 4 δ t 2 10 4 and δ t 4 10 4 s which respectively correspond to rotational angles of 0 45 0 9 1 8 and 3 6 for a single propeller table 4 and fig 11 present the hydrodynamic forces at different time steps the results of the time steps uncertainty analysis are summarized in table 4 it can be observed that propeller loads computed at smaller time steps are very close to those at large time steps especially when time step was smaller than δ t 2 10 4 thus for performance prediction δ t 2 10 4 can be considered reliable however from fig 12 it can be seen that the vortex shedding are very different at different time steps at a large time step δ t 4 10 4 s the vortex shedding disappears at a very short distance from the propeller generally a simulation involving vortex shedding is more sensitive to the time step than that involving hydrodynamic loads of the propeller wang et al 2013 so the time steps was chose as δ t 1 10 4 s if not specified in the following numerical simulation the time step is chosen to be δ t 1 10 4 s the convergence of the simulation can also be verified by the periodicity of the problem for the convergence of results the simulations at every 90 should agree with each other for the four bladed propeller in present simulation as shown in fig 13 the characteristics are verified to a large extent for the tip vortex however for the hub vortex the simulation slightly diverges owing to its weaker strength and easier dissipation in the viscous flow and there is no vorticity in the inflow to the propeller 5 results based on previous convergence studies a fine grid size and δ t 1 10 4 s were used in the present simulation the unsteady hydrodynamic loads developed by the rudder were investigated both in terms of pressure distributions and the resultant loads during a complete period of revolution and were related to the featuring phases of the interaction between the tip vortex and rudder obviously the contact of the tip and hub vortex with the rudder will cause more complicated instantaneous loads on the rudder surface thus in this section the pressure distributions and resultant loads on the rudder during a vortex shedding rudder interaction are discussed 5 1 vortical structure at different advance ratio the analysis of the flow field is carried out for five values of the advance coefficient j 0 4 0 6 0 8 1 0 1 2 in this study the rotational speed of the propeller was set at n 25 rps and the different advance coefficients j v a n d were obtained by changing the inflow velocity v a numerical results obtained with a les simulation are presented in table 5 a lower j indicates stronger hydrodynamic loading and subsequently stronger vortex shedding vortex shedding at different j values are compared in fig 14 in which q c r i t e r i o n 1000 s 2 and the colour bar represents the magnitude of the axial velocity longitudinal views of the vortical structures in the near wake of the propeller for different advance ratios are shown in fig 14 regardless of the advance ratio the tip vortices originated owing to a pressure difference between the upper and lower surfaces of each propeller blade the trailing vortices appear within the tip of the propeller blade forming a cycloidal vortex shedding which is shown in the longitudinal views a hub vortex originated from the center of the hub and stretched downstream however the evolution and formation of the vortices along the axial direction depend on the advance ratio baek et al 2015 at lower advance ratios the tip vortices merge with each other and the neighboring trailing vortices forming a larger vortex downstream as shown in fig 13 a and b for j 0 4 and j 0 6 respectively this vortex merging was experimentally observed by felli for a different four bladed propeller felli et al 2008 after merging the shape of the tip vortex distorts the trailing vortices are rapidly diffused and successive vortex sheets disappear just behind the propeller which is clearly observed in the longitudinal view this type of quick diffusion and the distortion of the trailing vortices by the wake roll up process were reported by controni et al 2000 as the advance ratio increases to j 0 8 the merging of vortices is delayed further downstream which is consistent with the results of carrica et al and castro et al carrica et al 2010 castro et al 2011 consequently the periodical array of the consecutive tip vortices extends further downstream as shown in fig 13 c this can be supported by the distance between two consecutive tip vortices owing to a significant reduction in the perturbation velocity components as the advance ratio increases further the hydrodynamic load of the propeller becomes very weak and is more easily susceptible to viscous dissipation thus the vortex shedding disappears in the vicinity of the propeller as shown in fig 13 d and e 5 2 dislocation of the vertical flow in the simulation with j 0 8 the propeller tip vortices underwent a progressive deformation and spanwise outward dislocation when approaching the leading edge of the rudder during the interaction with the rudder the tip vortex split in two branches flowing on the opposite sides of the appendage these were linked by vortex lines embedded in the boundary which was defined as dislocation of the flow muscari et al 2017a for further analysis of the dislocation a simulation with j 0 88 was performed the vorticity and velocity at z 0 95 r plane were investigated and compared with experimental results obtained under the same conditions which finished by felli 2011b fig 15 shows the axial velocity at z 0 95 r the present numerical result agrees very well with that by experiment although he vortex core in the experiment is more distinct the high flow velocity area appears both at starboard side y 0 and port side y 0 of the rudder but the axial velocity at starboard side y 0 have a larger value compared to that at the port side y 0 fig 16 present the axial velocity at y 0 05 r and that at y 0 05 r from which it can be seen that the slipstream is actually dislocated by the rudder from fig 16b it is observed that the downstream wake at starboard side is lifted it also can be seen the propeller wake accelerates in the vicinity of the rudder in the port side the highest axial velocity appears in the upper part whereas in the starboard side it appears in the lower part as shown in fig 17 the numerical results are consistent with the experimental results but the tip vortex in the experiment is more slender than that obtained by simulation for the tip vortex of the propeller the vorticity at the starboard side y 0 is negative when that at the port side y 0 is positive on the rudder surface the vorticity is positive on starboard side and negative on port side due to the rotational wake by the propeller on port side the tip vortex upside the rudder is lowered under z 0 95r by the rudder and was not shown in the plane it can be seen from figs 15 17 that there is an outstanding dislocation in the flow field around the rudder 5 3 force acting on the rudder surface it was found that the rudder could complicate the flow evolution these complexities are reflected in the unsteadiness of the rudder loading the unsteadiness results in the time and space dependence of pressure fluctuations over the rudder surface the pressure coefficient at different time instants is shown in fig 18 the pressure coefficient c p can be obtained by c p p 1 2 ρ v a 2 where p is the pressure on the rudder surface the v a is the advance velocity which corresponding to the advance ratio to showing the pressure distribution more clearly the whole rudder isn t shown only the central part of the rudder is shown to analyze the details of the fluctuating rudder load the power spectral density psd of pressure on the surface of the rudder was considered according to the study finished by sun c the pressure on the rudder surface shows a very strong periodicity which corresponding to the blade frequencies sun et al 2018b psd analysis was performed to analyze the pressure fluctuation in the frequency domain the flow variables got from the simulation are collected for a period of approximately seven revolutions during the stabilized regime to capture the relevant statistical properties of the flow note that for the choice of reference quantities the non dimensional passing frequency of the blade corresponds to k 1 as shown in fig 19 the pressure on the rudder was monitored by probes positioned on the rudder surface at y 0 over the area covered by the propeller slipstream during the traveling phase eleven rows of probes were positioned along the span of the rudder each row consisting of six probes along the chord see fig 19 in particular the probes were clustered around the tip and hub vortex trajectories on both the suction z 0 and pressure z 0 sides each probe n m was identified using two indices n increasing with z and m increasing from the leading to the trailing edge among which 6 m m 1 2 3 6 is located behind the propeller hub z 0 m 2 m m 1 2 3 6 and 10 m m 1 2 3 6 were located behind the propeller tip z 0 1135 m n 1 n 1 2 3 11 were located at the front of the rudder n 6 m 1 2 3 11 were located at the trail of the rudder 5 3 1 psd analysis of pressure fluctuation psd analysis was performed for the pressure monitored by the probes shown in fig 19 the spectra were characterized by tonal components associated with the passage of the vortex the strongest harmonic being associated with k 1 the psds at representative probes m 1 on the suction and pressure side are shown in fig 19 where a is the amplitude of the pressure fluctuation from fig 20 it can be seen that the pressure at the probes n 2 10 within the tip vertical flow shows a clear periodicity while that at n 6 within hub vortical flow does not further it was found the pressure magnitude at n 4 and n 8 was much smaller than that at n 2 10 and n 6 which are located directly in the tip and hub vortexes this indicates that the propeller vortex shedding will significantly increase the pressure on the rudder surface this can verify partly that the hub and tip vortexes are separated to some extent salvatore et al 2009 although we generally assume that the tip vortex is stronger and emerge earlier than the hub vortex the pressure within the hub vortex is actually higher than that within the tip vortex this is because the hub vortex due to the blade root loading and hub rotation is twined and complicated at the hub end while the tip vortex is quite separated at the blade tips more interestingly it is found the pressures on the upper and lower parts on the rudder surface at same time instant are very different as observed in fig 18 however their psds are very symmetric as shown in fig 20 particularly for the probes outside of the shedding hub vortex this means the random and chaotic vibration of the rudder was mainly caused by the pressure fluctuation on the rudder surface due to the hub vortex shedding psd analysis for chordwise pressure fluctuation was performed as shown in fig 21 from the comparison of fig 21 a 21 f it was inferred that a more chaotic pressure fluctuation generally appears in two areas one is where the hub vortex passes and the other is where the vortex dissipates in fig 21 a the pressure psd at probes n 1 m 1 6 is presented in this case the probes n 1 m 1 4 are away from the hub vortex shedding and their psd show very clear blade frequency periodicity however for probes n 1 m 5 6 the pressure fluctuations are very chaotic which indicates that the tip vortex has started to dissipate comparing the psd at probe 1 5 in fig 21 a and that at probe 2 5 in fig 21 b we found the latter to be more periodic as probe 2 5 is more aligned with the tip vortex shedding this indicates that the dissipation starts from the outer region of the tip vortex and the vortex cube core is more immune to dissipation as the probes move close to the center of the rudder as shown in fig 21 c the periodicity again tends to be weaker as the probe moves away from the tip vortex the smallest pressure fluctuation appears at probes n 4 m 1 6 where the probes are just between the tip and hub vortex as the probe moves closer to the center of the rudder which is closer to the hub vortex the randomness of the pressure fluctuation increases and the magnitude of the pressure fluctuation increases this indicates that the hub vortex contributes more to the random vibration than the tip vortex generally from the above analysis we can infer that the tip vortex shedding tends to enhance the periodicity of the pressure fluctuation and the hub vortex shedding tends to weaken the periodicity of the pressure fluctuation fig 22 shows the comparisons of the pressure magnitude at different blade frequencies it can be easily concluded that as the frequency increases the pressure magnitude generally decreases comparing fig 22 a and b it can be seen the magnitudes are very much similar for the probes symmetric with respect to the chordwise center line of the rudder with the strongest harmonic being associated with k 1 5 3 2 psd analysis for the rudder surface behind a single bladed propeller the effect of the vortex shedding of a four bladed propeller on the rudder surface pressure is analyzed in the previous section which is very complex owing to the twined hub vortex and the interaction between the tip vortexes for simplicity and clarity psd analysis was performed for the rudder surface pressure with a single bladed propeller which is shown in figs 23 and 24 the probes are in the same locations shown in fig 19 generally the surface pressure behind a single bladed propeller shows stronger harmonic characteristics at blade frequencies comparing the pressure psd analysis at the same probes in figs 20 and 21 it is shown that the randomness is much stronger owing to the interaction between the four tip vortexes however it was found by comparing figs 21 and 23 that the fluctuation magnitude for a four bladed configuration was much smaller than that for a single bladed configuration this gives a very important suggestion that rudder vibration can be actually reduced by increasing the blade number of the propeller further it can be seen that on the suction side n 2 m 1 6 the amplitude of all the harmonic components gradually drop up to the midchord and then remain almost constant up to the trailing edge conversely on the pressure side n 10 m 1 6 we observed an abrupt reduction in the first and second harmonics immediately after the impact point and all the first six components remained constant along the profile this different behaviour was attributed to the differences in vortex stretching on the suction and pressure sides 6 conclusions the present paper deals with the propeller rudder interactions mechanisms and it is focused on the analysis of the evolution of the propeller vortical structures in a propeller under the influence of the rudder and its effect on surface pressure fluctuation of the rudder detailed knowledge of this flow is fundamental for the abatement of vibrations all these aspects were numerically investigated via les to this aim the flow was studied using a phenomenological approach by analyzing coherent structure evolution using the q criterion and quantitative approach by analyzing the psd of the pressure recorded at specific points located at different radial positions on the rudder wall the numerical simulation was verified using extensive convergence studies and experimental data for smaller j values the stronger the tip vortices the sooner they dissipated a different rate for the spanwise displacement was observed in the tip vortex filaments running on the pressure and suction sides of the rudder this difference is the consequence of the convective motion induced by the image vortex that occurs with a favourable adverse pressure gradient in the suction pressure side of the rudder some interesting conclusions can be drawn first the propeller tip vortex enhances the periodicity of the rudder surface pressure while the propeller hub vortex enhances the randomness of the pressure fluctuation however both will increase the fluctuation magnitude second the pressure fluctuation can be actually reduced by increasing the blade number of the propeller acknowledgement this work was supported by the national natural science foundation of china grant no 51679045 51579052 the fundamental research funds for the central universities grant no heucgf201814 and the foundation of equipment pre research grant no 6141b42862 61402100201 61402070503 6142204180408 6142407180108 
